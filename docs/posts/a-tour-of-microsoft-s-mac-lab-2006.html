<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://davidweiss.blogspot.com/2006/04/tour-of-microsofts-mac-lab.html">Original</a>
    <h1>A Tour of Microsoft&#39;s Mac Lab (2006)</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Today I&#39;ll stop my <a href="http://davidweiss.blogspot.com/2006/04/excodewarrior.html">3rd person</a> <a href="http://davidweiss.blogspot.com/2006/04/program-managers-at-macbu.html">perspective</a>. I&#39;m going to write a little bit more about what I do to help MacBU ship great software and provide some color around what&#39;s it&#39;s like to work on Mac software at Microsoft. Often when we have press events or special visits from our MVPs I&#39;ll give them a tour of the Mac Lab and explain what we do. They&#39;ve always found it very interesting and so I thought I&#39;d share a virtual tour of our Mac Lab. Let&#39;s get started:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/LabDoor.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/LabDoor.jpg"/></a></p><center><b>Lab Door</b></center><p>We start with the door. The Mac Lab is about 2000 square feet of solid computers. The calendars you see down the side of the wall we use to mark team birthdays as well as special events. The CD on the door is an old Apple Software Restore CD from the last beige Mac Apple produced, the Power Macintosh G3.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacLabPlasma.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacLabPlasma.jpg"/></a></p><center><b>The &#34;Sandbox&#34; and Plasma display</b></center><p>The first area in the Mac Lab is what we call the Sandbox. This is where we keep all significant hardware configurations Apple has released that run our products. We&#39;ll use the Plasma display to, watch DVDs and play games, uh er, I mean, do important training presentations. ;-) It&#39;s actually very useful because everyone can be in front of a computer and still see the main screen and follow along. Often other groups at Microsoft (the games group, hardware drivers group and even the Windows media group) will come and schedule time in the Mac Lab to test their software on the different hardware configurations.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/LabTeam.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/LabTeam.jpg"/></a></p><center><b>Old iMacs and iBooks in the distance</b></center><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/SandBoxBackRow.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/SandBoxBackRow.jpg"/></a></p><center><b>More Macs</b></center><p>We have lots of Apple hardware. You can see here the old colorful iMacs along with some of the old iBooks. You can also see two of our Lab Technicians working on the backup systems, but more about that later. Up until a few months ago we had every significant hardware revision Apple has ever released since the dawn of time. We even had a section of the Lab we affectionately called the &#34;Mac Nursery&#34; where we kept all the older Macs going. We even had an old SE/30 and IIci and super expensive Mac II all connected via PhoneNet running <a href="http://www.d4.dion.ne.jp/~motohiko/spectre.htm">Spectre</a>, just for fun. It&#39;s always super fun to boot Word 1.0 or Excel 1.0 on these old machines and see how much things have changed. Due to lack of space in the Lab we had to put all of these older machines into storage and recycled the following:</p><ul>
<li>Macintosh (original)</li>
<li>Macintosh SE</li>
<li>Macintosh SE/30</li>
<li>Macintosh Classic</li>
<li>Macintosh Centris 610 &lt;-- I had this one in my room during high school</li>
<li>Macintosh IIci</li>
<li>Macintosh IIsi</li>
<li>Power Macintosh 7100/66</li>
<li>Power Macintosh 7100/80</li>
<li>Power Macintosh 7500/100</li>
<li>Quadra 650</li>
<li>Power Macintosh G3</li>
<li>Duo Dock with Powerbook Duo 2300c</li>
<li>Power Computing PowerCenter Pro 210</li></ul><p>May they rest in peace.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/ADICBackupRobots.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/ADICBackupRobots.jpg"/></a></p><center><b>ADIC Backup Robots</b></center><p>One of the realities of working with computers is that things fail. More often then you might think. We&#39;ve used different backup robots, but ever since we moved to ADIC we&#39;ve never had a robot failure. They just make great stuff. We have 3 robots and use <a href="http://www.symantec.com/enterprise/veritas/index.jsp">Veritas Backup Exec</a>. It works pretty well, as you can see:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/TapeBackups.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/TapeBackups.jpg"/></a></p><center><b>Lots of backup tapes</b></center><p>We also do offsite backups just incase &#34;The Big One&#34; hits, but for regular use these tapes work just great, except when they don&#39;t. Recently we had a failure and lost 400 GB of data! We restored it from the tapes and then discovered that the Mac version of the Backup Exec agent had a corruption bug causing the restores to be compromised! Veritas folk were super responsive and they should have a new Mac agent out soon. Backup software and file systems are in the class of software that simply must work, all the time. Alas, <a href="http://rentzsch.com/suck/backup3">this is not always the case</a>.</p><p>I&#39;m going to skip the &#34;Build Lab&#34; section of our Lab since it&#39;s very much in <a href="http://www.apple.com/universal/">transition</a>. Maybe I&#39;ll post about that later. For now, on to our automation system!</p><p>Mac Office is one of those &#34;software in the large&#34; projects. There&#39;s really no way a team of our size would be able to adequately test all of Office without the use of automated testing. Every day we get a new build of Office from the build machines, we copy it to our Xserve RAID connected to our dual G5 Xserve for access by our 249 automation machines. We then run thousands and thousands of tests on the new build. Typically we get 4 builds of Office each day: English Ship, English Debug, Japanese Ship and Japanese Debug. We run our entire battery of tests against all the builds and then report any failures to testers via email. The testers investigate the failures, log any bugs and then move on to their other duties as testers. This turns out to be very effective, if used properly, and over time it allows testers to focus on things humans do best, while letting computers verify the repetitious and mundane, but necessary, testing. It all started with our Blue and White G3s years ago. At first when testers would upgrade their test machines, instead of recycling the machines, &#34;The Lab&#34; would get them to add them to our automation machine pool. I think we had about 20 machines to begin with.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/OldBluies.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/OldBluies.jpg"/></a></p><center><b>Venerable Old Bluies</b></center><p>After some time we started getting Gray G4s...</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/GrayG4sAndMacLibrary.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/GrayG4sAndMacLibrary.jpg"/></a></p><center><b>Speedy G4s</b></center><p>Then we upgraded to some dual proc machines...</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/DualProcG5s.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/DualProcG5s.jpg"/></a></p><center><b>Dual G5s</b></center><p>Then Apple give us a special gift. :-) You&#39;d be probably be very surprised at the cost of running all these machines. There&#39;s the obvious electricity costs, but also cooling costs and even the physical space costs. Additionally, our system scales, not with CPU horsepower, but with quantity of machines. Most of the tests we run don&#39;t run significantly faster on a dual G5 vs. a single G4. So when Apple announced the Mac mini it wasn&#39;t minutes before we were considering how to use it for our automation system. The Mac mini has all the perfect qualifications:</p><ol><li>Low power</li><li>Low heat</li><li>Small</li><li>Easy to pack together</li><li>Inexpensive</li></ol><p>So we got a few to test things out...</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MixedAutomationRack.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MixedAutomationRack.jpg"/></a></p><center><b>Mixed Automation Rack</b></center><p>And then we made the big purchase:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacMinisView1.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacMinisView1.jpg"/></a></p><center><b>Rack A, B and C = 150 Mac minis!</b></center><p>These work extraordinarily well. You might wonder how we control all these Macs. We use two methods: KVM switch box and Apple Remote Desktop. Thanks to our Lab Manager&#39;s great relationship with the IOGear folk we have a very reliable solution these days. It seemed like it took for ever to find a USB KVM switch box that didn&#39;t leave the machines &#34;headless&#34; after random reboots. The 8 port USB KVM from IOGear has been rock solid. So what does it look like to sit in front of 64 Mac minis? Like this:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacMini64Control.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacMini64Control.jpg"/></a></p><center><b>64 Mac minis: 1 keyboard, monitor and mouse</b></center><p>This works very well when you must access the machines physically. Even so, just scanning each Mac for 1 second gets very old, very fast and Apple Remote Desktop comes to the rescue! When we need to see all the machines at once we just select them and BOOM! they&#39;re there. It also gives us what I believe is the one true reason Apple invented the 30 inch Display. ;-)</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/ARDand30InchDisplay.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/ARDand30InchDisplay.jpg"/></a></p><center><b>The 30 Inch Display: Fulfilling the measure of its creation.</b></center><p>ARD displays 50 machines at a time and when you have a capable machine, it uses the &#34;cube rotation&#34; effect to move from one group of 50 to the next. I got a picture of the effect mid rotation below:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/RotationInARD.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/RotationInARD.jpg"/></a></p><center><b>Rotates like butter!</b></center><p>So how does it all work? Like this: On each machine we have two volumes: ChangeOS and Mac OS X. The Mac OS X volume is where we install the different versions of the OS. We boot to the ChangeOS volume to free up the Mac OS X volume for modification. When we trigger an automation run we specify the OS version and language. Each machine then reboots to the ChangeOS partition, caches the OS .dmg locally and uses the asr command line tool to restore the image. The tool that does this work is one I wrote (in AppleScript Studio no less!) called Lab Assistant. We have images of the Mac OS from 8.1 all the way up to 10.4.6 in all the languages our products support. It&#39;s a lot of data which brings me to the backbone of our automation system:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/XserveXsanXRaid.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/XserveXsanXRaid.jpg"/></a></p><center><b>Our Xserve RAID and XSAN</b></center>
<p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/1MacTB.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/1MacTB.jpg"/></a></p><center><b>1 TB</b></center><p>Right now we&#39;ve just been testing out the XSAN stuff to see how we want to use it. That&#39;s why you see all the Xserves. Just one side of the top Xserve RAID is 1 TB of data. For a fun comparison this whole rack which is about 7 ft tall is full of old RAID arrays is also 1 TB of data storage. We call it the Big Mac Daddy.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/BigMacDaddy.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/BigMacDaddy.jpg"/></a></p><center><b>Big Mac Daddy</b></center><p>Other groups at Microsoft have hardware retention policies that force hardware upgrades every so often, but instead of just &#34;recycling&#34; these server machines, our Lab Manager intercepts them on the way out, and we use them for various things, storage, SQL server etc. We actually have some of the old MSN servers in our Mac Lab!</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacLabHallways.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacLabHallways.jpg"/></a></p><center><b>Hallways</b></center><p>When you have so many machines to maintain, being able to get behind the machines is very important.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacMiniCords.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacMiniCords.jpg"/></a></p><center><b>Lots o&#39; cables!</b></center><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacMinisOnTop.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacMinisOnTop.jpg"/></a></p><center><b>Top View</b></center><p>We like to pack in those Mac minis and the cords get pretty dense when we do. The hanging Mac mini box moves if the HVAC is working. If it&#39;s not working, we&#39;ve got to turn off the machines until it&#39;s fixed.</p><p>Our main automation Xserve has a habit of failing in some serious way once a year, always around Christmas time. :/ For the last 2 years I&#39;ve been in charge of fixing it and getting it back to operational. Most of our server racks are generic white enclosures, but we do have 1 black Dell rack. As punishment for bad behavior, we put the Xserve in the Dell rack. That&#39;ll teach it. ;-) This is what it looks like from the inside of the rack looking out on the world. Poor caged servers...</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/InTheRack.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/InTheRack.jpg"/></a></p><center><b>From the server&#39;s perspective</b></center><p>Of course our iWork/iLife balance is just fine as you can see by the following:</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/Tornado.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/Tornado.jpg"/></a></p><center><b>Tornado Foosball Table</b></center><p>One of our team members bought this awesome Tornado foosball table which we use along with and XBox and XBox 360 to relax after a hard days work.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacLoversOfMicrosoft.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacLoversOfMicrosoft.jpg"/></a></p><center><b>Published!</b></center><p>A while back the Seattle PI actually did a front page story on the Mac Business Unit and you can see from the picture in the Lab it was when we had only the G3s.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MissionStatement.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MissionStatement.jpg"/></a></p><center><b>Gotta have the Mission Statement</b></center><p>As you enter the kitchen we have our MacBU mission statement to remind us what it&#39;s all about. :)</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/FreePop.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/FreePop.jpg"/></a></p><center><b>Free drinks of course!</b></center><p>Just like everywhere at Microsoft, we get all-you-can-drink beverages.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MoraleEvents.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MoraleEvents.jpg"/></a></p><center><b>Fun Times!</b></center><p>Part of our team mantra is that we work hard, and play hard. So we do lots of fun morale events. We just take time off work and do stuff. We&#39;re good friends and enjoy &#34;just hanging out&#34; together.</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/MacLibrary.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/MacLibrary.jpg"/></a></p><center><b>The Mac Library</b></center><p>This is just a pretty picture to represent what is really a much bigger collection of 3rd Party software we use to test with Office. Most if it is stored on file servers, but this gives you an idea. (There&#39;s some old WWDC DVDs if you can find them!)</p><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/PrintLab1.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/PrintLab1.jpg"/></a></p><center><b>Printer Lab</b></center><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/PrintLab2.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/PrintLab2.jpg"/></a></p><center><b>More Printers</b></center><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/PrintLab3.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/PrintLab3.jpg"/></a></p><center><b>All connected for printer testing</b></center><p><a href="https://photos1.blogger.com/blogger/1955/1163/1600/PrintLab4.jpg"><img alt="" src="https://photos1.blogger.com/blogger/1955/1163/400/PrintLab4.jpg"/></a></p><center><b>They&#39;re beautiful</b></center><p>A big part of Office functionality is printing, and we do loads of print testing. We work really closely with the printer vendors and make sure the printed page looks great. WYSIWYG is fundamental to Mac ethos. All these printers are connected via USB hubs and Ethernet to a Mac OS X Server 10.4 which is the printer server.</p><p>I hope that gives you a better idea about what the Mac Lab is like and what it&#39;s like to work in the Macintosh Business Unit at Microsoft.</p>

</div></div>
  </body>
</html>
