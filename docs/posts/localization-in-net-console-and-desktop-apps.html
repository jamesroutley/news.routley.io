<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.axantum.com/2024/05/localizing-net-console-or-desktop.html">Original</a>
    <h1>Localization in .NET console and desktop apps</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-864311569885476037" itemprop="description articleBody">
<p>Having gone through countless different solutions to the ever present problem of localizing .NET applications, I think I&#39;ve finally found a good solution.</p><p>The main driver this time was the need to provide a convenient way to translate texts used in the <a href="https://www.axantum.com/" target="_blank">Xecrets Ez</a> desktop app for easier file encryption. This is developed with .NET 8 and <a href="https://avaloniaui.net/" rel="nofollow" target="_blank">Avalonia UI</a>, which apart from C# uses it&#39;s own <a href="https://learn.microsoft.com/en-us/visualstudio/xaml-tools/xaml-overview" rel="nofollow" target="_blank">XAML</a> format, <a href="https://docs.avaloniaui.net/docs/basics/user-interface/introduction-to-xaml" rel="nofollow" target="_blank">AXAML</a> with a need to reference translatable texts there too.</p><p>.NET has of course since forever supported localization, sort of, through the resource compiler, .resx files and satellite assemblies.</p><p>The problem has always been, and remains to this day, how do I get the actual translations done? Translation is often not done by the original developer, and often by people who definitely don&#39;t want to fire up Visual Studio and the resource editor. Never mind that it doesn&#39;t even have a proper translation view, with a source language and target language in the same view.</p><p>There have been various attempts to make resx-editors for translators, but they were typically Windows-only desktop applications. Translators often like apples.</p><p>Since maybe 10 years the number of web based translation services have been increasing year by year, but the support for the resx file format is often spotty or limited, or non-existing.</p><p>I&#39;ve long been looking at somehow leveraging the huge amount of services and software that use the .po format for texts, all based on the <a href="https://www.gnu.org/software/gettext/manual/html_node/index.html" rel="nofollow" target="_blank">gettext</a> utilities and specifications. However, the old C-style extraction of text from the source has never appealed to me, and also requires a lot of parsing of C#/.NET code that is just bound to go wrong. Not to mention various XAML dialects that might also need parsing for the <a href="https://www.gnu.org/software/gettext/manual/html_node/xgettext-Invocation.html" rel="nofollow" target="_blank">gettext extraction</a> process to work.</p><p>Then when looking for a library to work with .po files, thinking to roll my own somehow, deep inside a related sample project I found <a href="https://github.com/adams85/aspnetskeleton2/tree/master/tools/POTools" rel="nofollow" target="_blank">POTools</a>!</p><p>This little hidden gem can do a gettext-style extraction, but from a .resx file! Now things started to fall into place.</p><p>Doing the extraction, or discovery if you like, of translatable strings from a structured source like a .resx file is easy, solid and dependable - and fits the general development model of .NET better than wrapping all texts in <span>T()</span> method calls, similar to the original C-style gettext mode of operations. It also enables easy re-use of strings in multiple places without any problems.</p><p>With POTools I could now easily extract a template .pot file from the already existing <span>Resources.resx</span> file, and start looking for a suitable translation tool. There are many such out there, but for my purposes I went with <a href="https://localise.biz/" rel="nofollow" target="_blank">Loco</a>, which offers just the right set of capabilities at the right price. The real point is that once you go with the .po/.pot format for your translations, there&#39;s a huge eco system out there to help you out!</p><p>As a minor issue, I decided to create a separate resource file, <span>InvariantResources.resx</span>, to hold the texts that by definition should never be translated, but still are suitable to keep in a resource file.</p><p>So, now I have a bunch of translated .po files, as well as the original .resx file with the original texts. How to tie all this together?</p><p>Using another part of the .NET building blocks for localization, <span><a href="https://learn.microsoft.com/en-us/dotnet/api/microsoft.extensions.localization.istringlocalizer" rel="nofollow" target="_blank">IStringLocalizer</a></span> offers a nice interface that fits well. Using sample code from theÂ <a href="https://github.com/adams85/po" rel="nofollow" target="_blank">Karambolo.PO library</a> that can read .po files, it was trivial to create a <span><a href="https://github.com/xecrets/xecrets-localization" rel="nofollow" target="_blank">POStringLocalizer</a></span> implementation.</p><p>This is now available as a <a href="https://www.nuget.org/packages/Xecrets.Localization" rel="nofollow" target="_blank">nuget package</a> for your convenience! There&#39;s sample code there on how to wire it all up, as well as in the github <a href="https://github.com/xecrets/xecrets-localization" rel="nofollow" target="_blank">repository</a>.</p><p>So, we now can use the <a href="https://www.gnu.org/software/gettext/manual/html_node/PO-Files.html" rel="nofollow" target="_blank">Portable Object file format</a> and the <a href="https://www.gnu.org/software/gettext/manual/html_node/index.html" rel="nofollow" target="_blank">gettext</a> universe of tools and users, while still maintaining a good fit with .NET code and libraries.</p><p>Thanks go to the <a href="https://github.com/adams85" rel="nofollow" target="_blank">author</a> of Karambolo.PO library and POTools!</p>

</div></div>
  </body>
</html>
