<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cloud.google.com/blog/products/compute/trillium-tpu-is-ga">Original</a>
    <h1>Trillium TPU Is GA</h1>
    
    <div id="readability-page-1" class="page"><div jsname="tx2NYc"><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>The rise of large-scale AI models capable of processing diverse modalities like text and images presents a unique infrastructural challenge. These models require immense computational power and specialized hardware to efficiently handle training, fine-tuning, and inference. Over a decade ago, Google began developing custom AI accelerators, Tensor Processing Units (TPUs), to address the growing demands of AI workloads, paving the way for multimodal AI.</span></p>
<p><span>Earlier this year, we announced Trillium, our sixth-generation and most performant TPU to date. Today, it is generally available for Google Cloud customers. </span></p>
<p><span>We used Trillium TPUs to train the new </span><a href="https://blog.google/technology/google-deepmind/google-gemini-ai-update-december-2024" rel="noopener" target="_blank"><span>Gemini 2.0</span></a><span>, Google’s most capable AI model yet, and now enterprises and startups alike can take advantage of the same powerful, efficient, and sustainable infrastructure. </span></p>
<p><span>Trillium TPU is a key component of Google Cloud&#39;s AI Hypercomputer, a groundbreaking supercomputer architecture that employs an integrated system of performance-optimized hardware, open software, leading ML frameworks, and flexible consumption models. As part of the general availability of Trillium TPUs, we are also making key enhancements to AI Hypercomputer&#39;s open software layer, including optimizations to the XLA compiler and popular frameworks such as JAX, PyTorch and TensorFlow to achieve leading price-performance at scale across AI training, tuning, and serving. Additionally, features such as host-offloading using the massive host DRAM (complementing the High Bandwidth Memory, or HBM) deliver next-level efficiency. AI Hypercomputer enables you to extract maximum value from an unprecedented deployment of over 100,000 Trillium chips per Jupiter network fabric with </span><a href="https://cloud.google.com/blog/products/networking/speed-scale-reliability-25-years-of-data-center-networking?e=48754805"><span>13 Petabits/sec</span></a><span> of bisectional bandwidth, capable of scaling a single distributed training job to hundreds of thousands of accelerators. </span></p>
<p><span>Already, customers like AI21 Labs are using Trillium to deliver meaningful AI solutions to their customers faster:</span></p>
<p><span>“</span><span>At AI21, we constantly strive to enhance the performance and efficiency of our Mamba and Jamba language models. As long-time users of TPUs since v4, we&#39;re incredibly impressed with the capabilities of Google Cloud&#39;s Trillium. The advancements in scale, speed, and cost-efficiency are significant. We believe Trillium will be essential in accelerating the development of our next generation of sophisticated language models, enabling us to deliver even more powerful and accessible AI solutions to our customers.</span><span>&#34; </span><strong>- Barak Lenz, CTO, AI21 Labs</strong></p>
<p><span>Here are some of the key improvements that Trillium delivers over the prior generation:</span></p>
<ul>
<li>
<p><span>Over 4x improvement in training performance</span></p>
</li>
<li>
<p><span>Up to 3x increase in inference throughput</span></p>
</li>
<li>
<p><span>A 67% increase in energy efficiency</span></p>
</li>
<li>
<p><span>An impressive 4.7x increase in peak compute performance per chip</span></p>
</li>
<li>
<p><span>Double the High Bandwidth Memory (HBM) capacity</span></p>
</li>
<li>
<p><span>Double the Interchip Interconnect (ICI) bandwidth</span></p>
</li>
<li>
<p><span>100K Trillium chips in a single Jupiter network fabric</span></p>
</li>
<li>
<p><span>Up to 2.5x improvement in training performance per dollar and up to 1.4x improvement in inference performance per dollar</span></p>
</li>
</ul>
<p><span>These enhancements enable Trillium to excel across a wide range of AI workloads, including:</span></p>
<ul>
<li>
<p><span>Scaling AI training workloads</span></p>
</li>
<li>
<p><span>Training LLMs including dense and Mixture of Experts (MoE) models</span></p>
</li>
<li>
<p><span>Inference performance and collection scheduling</span></p>
</li>
<li>
<p><span>Embedding-intensive models</span></p>
</li>
<li>
<p><span>Delivering training and inference price-performance</span></p>
</li>
</ul>
<p><span>Let’s take a look at how Trillium performs for each of these workloads. </span></p>
<h3><strong>Scaling AI training workloads</strong></h3>
<p><span>Training large models like Gemini 2.0 requires massive amounts of data and computation. </span><span>Trillium&#39;s near-linear scaling capabilities allow these models to be trained significantly faster by distributing the workload effectively and efficiently across a multitude of Trillium hosts that are connected through a high-speed interchip interconnect within a 256-chip pod and our state-of-the-art </span><a href="https://cloud.google.com/blog/topics/systems/the-evolution-of-googles-jupiter-data-center-network"><span>Jupiter data center networking</span></a><span>. This is made possible by TPU multislice, and full-stack technology for large-scale training, and further optimized by </span><a href="https://cloud.google.com/blog/products/compute/titanium-underpins-googles-workload-optimized-infrastructure"><span>Titanium</span></a><span>, a system of dynamic data-center-wide offloads that range from host adapters to the network fabric. </span></p>
<p><span>Trillium achieves 99% scaling efficiency with a deployment of 12 pods consisting of 3072 chips, and demonstrates 94% scaling efficiency across 24 pods with 6144 chips to pre-train gpt3-175b, even when operating across a data-center network to pre-train gpt3-175b.</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/1_xvSCrwU.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/1_xvSCrwU.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/1_xvSCrwU.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/1_xvSCrwU.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 1. Source data: Google benchmark and MLPerf™ 4.1. n x Trillium-256 corresponds to n Trillium pods with 256 chips in one ICI domain</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>While in the graph above we use a 4-slice Trillium-256 chip pod as baseline, using a 1-slice trillium-256 chip pod as our baseline still results in over 90% scaling efficiency as you scale up to 24 pods. </span></p>
<p><span>When training the Llama-2-70B model, our tests demonstrate that Trillium achieves near-linear scaling from a 4-slice Trillium-256 chip pod to a 36-slice Trillium-256 chip pod at a 99% scaling efficiency.</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/2_PsVhLHt.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/2_PsVhLHt.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/2_PsVhLHt.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/2_PsVhLHt.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 2. Source data: Google benchmark using MaxText reference implementation on 4k Seq Length. n x Trillium-256 corresponds to n Trillium pods with 256 chips in one ICI domain.</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>Trillium TPUs exhibit significantly better scaling efficiency compared to prior generations. In the graph below, our tests demonstrate Trillium’s 99% scaling efficiency at 12-pod scale compared to a Cloud TPU v5p cluster of equivalent scale (total peak flops).</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/3_R9UTbOL.max-700x700.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/3_R9UTbOL.max-700x700.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/3_R9UTbOL.max-700x700.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/3_R9UTbOL.max-700x700.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 3. Source data: MLPerf™ 4.1 Training Closed results for Trillium (Preview) and v5p on GPT3-175b training task. As of November, 2024: Weak scaling comparison for Trillium and Cloud TPU v5p. v5p-4096 and 4xTrillium-256 are considered as base for scaling factor measurement. n x Trillium-256 corresponds to n Trillium pods with 256 chips in one ICI domain. v5p-n corresponds to n/2 v5p chips in a single ICI domain.</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><h3><strong>Training LLMs including dense and Mixture of Experts (MoE) models</strong></h3>
<p><span>LLMs like Gemini are inherently powerful and complex, with billions of parameters. Training such dense LLMs requires enormous computational power combined with co-designed software optimizations. Trillium delivers up to 4x faster training for dense LLMs like Llama-2-70b and gpt3-175b than the previous-generation Cloud TPU v5e.</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/4_iYpv9Od.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/4_iYpv9Od.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/4_iYpv9Od.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/4_iYpv9Od.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 4. Source data: Google benchmark on steptime run on v5e and Trillium</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>In addition to dense LLMs, training LLMs with a Mixture of Experts (MoE) architecture is an increasingly popular approach, incorporating multiple &#34;expert&#34; neural networks, each specialized in a different aspect of an AI task. Managing and coordinating these experts during training adds complexity compared to training a single monolithic model. Trillium delivers up to 3.8x faster training for MoE models than the previous-generation Cloud TPU v5e.</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/5_cFVrLgO.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/5_cFVrLgO.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/5_cFVrLgO.max-800x800.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/5_cFVrLgO.max-800x800.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 5. Source data: Google benchmark on steptime run on v5e and Trillium</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>Additionally, Trillium TPU offers 3x the host dynamic random-access memory (DRAM) compared to Cloud TPU v5e. This offloads some computation to the host, helping to maximize performance and </span><a href="https://cloud.google.com/blog/products/ai-machine-learning/goodput-metric-as-measure-of-ml-productivity"><span>Goodput</span></a><span> at scale. Trillium’s host-offloading capabilities deliver over a 50% improvement in performance when training the Llama-3.1-405B model, as measured in Model FLOPs Utilization (MFU).</span></p>
<h3><strong>Inference performance and collection scheduling</strong></h3>
<p><span>The growing importance of multi-step reasoning at inference time necessitates accelerators that can efficiently handle the increased computational demands. Trillium provides significant advancements for inference workloads, enabling faster and more efficient AI model deployment. In fact, Trillium delivers our best TPU inference performance for image diffusion and dense LLMs. Our tests demonstrate over 3x higher relative inference throughput (images per second) for Stable Diffusion XL, and nearly 2x higher relative inference throughput (tokens per second) for Llama2-70B compared to Cloud TPU v5e. </span></p>
<p><span>Trillium is our highest performing TPU for both offline and server inference use cases. The graph below demonstrates 3.1x higher relative throughput (images per second) for offline inference and 2.9x higher relative throughput for server inference for Stable Diffusion XL compared to Cloud TPU v5e.</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/6_v1.max-600x600.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/6_v1.max-600x600.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/6_v1.max-600x600.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/6_v1.max-600x600.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 6. Source data: Google benchmark on images/second for both offline and online SDXL use cases using MaxDiffusion reference implementation.</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>In addition to better performance, Trillium introduces a new collections scheduling capability. This feature allows Google&#39;s scheduling systems to make intelligent job-scheduling decisions to increase the overall availability and efficiency of inference workloads when there are multiple replicas in a collection. It offers a way to manage multiple TPU slices running a single-host or multi-host inference workload, including through Google Kubernetes Engine (GKE). Grouping these slices into a collection makes it simple to adjust the number of replicas to match the demand.</span></p>
<h3><strong>Embedding-intensive models</strong></h3>
<p><span>With the addition of third-generation </span><a href="https://cloud.google.com/tpu/docs/system-architecture-tpu-vm#sparsecore"><span>SparseCore</span></a><span>, Trillium delivers a 2x improvement in the performance of embedding-intensive models and a 5x improvement in </span><a href="https://cloud.google.com/tpu/docs/tutorials/dlrm-dcn-2.x"><span>DLRM DCNv2 </span></a><span>performance.</span></p>
<p><span>SparseCores are dataflow processors that provide a more adaptable architectural foundation for embedding-intensive workloads. Trillium’s third-generation SparseCore excels at accelerating dynamic and data-dependent operations, such as scatter-gather, sparse segment sum, and partitioning.</span></p>
<h3><strong>Delivering training and inference price-performance</strong></h3>
<p><span>In addition to the absolute performance and scale that is required to train some of the world’s largest AI workloads, Trillium is designed to optimize performance per dollar. To date, Trillium provides up to 2.1x increase in performance per dollar over Cloud TPU v5e and up to 2.5x increase in performance per dollar over Cloud TPU v5p in training dense LLMs like Llama2-70b and Llama3.1-405b.</span></p>
<p><span>Trillium excels at parallel processing of large models in a cost effective manner. It is designed to empower researchers and developers to serve robust and efficient image models at significantly lower cost than before. The cost to generate one thousand images on </span><span>Trillium is 27% less than Cloud TPU v5e for offline inference</span><span> and 22% less than Cloud TPU v5e for server inference on SDXL.</span></p></span></section><section><div><section><figure><section jscontroller="SCGBie" jsaction="rcuQ6b:npT2md"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/7_1lZdjLP.max-600x600.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/7_1lZdjLP.max-600x600.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/><section role="dialog" aria-modal="true"><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/7_1lZdjLP.max-600x600.png" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/7_1lZdjLP.max-600x600.png" jsname="P3Vluc" jsaction="click:HTIlC" loading="lazy"/></section></section></figure><p><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p>Figure 7. Source data: Google benchmark on images/second for both offline and online SDXL use cases using MaxDiffusion reference implementation.</p></span></p></section></div></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><h3><strong>Take AI innovation to the next level</strong></h3>
<p><span>Trillium represents a significant leap forward in Google Cloud’s AI infrastructure, delivering incredible performance, scalability, and efficiency for a wide range of AI workloads. With its ability to scale to hundreds of thousands of chips using world-class co-designed software, Trillium empowers you to achieve faster breakthroughs and deliver superior AI solutions. Furthermore, Trillium&#39;s exceptional price-performance makes it a cost-effective choice for organizations seeking to maximize the value of their AI investments. As the AI landscape continues to evolve, Trillium stands as a testament to Google Cloud&#39;s commitment to providing cutting-edge infrastructure that empowers businesses to unlock the full potential of AI.</span></p>
<p><span>We&#39;re excited to see how you will leverage Trillium and AI Hypercomputer to push the boundaries of AI innovation.</span><strong> </strong><span>Check out the announcement video that highlights how the Trillium system comes together to drive acceleration for your most demanding AI workloads. </span></p></span></section><section><section><div jsaction="rcuQ6b:npT2md" jscontroller="wJu6E" data-video-url="https://www.youtube.com/watch?v=RjRQ1DYnuJA"><div><picture><section><img src="https://storage.googleapis.com/gweb-cloudblog-publish/images/maxresdefault_wDtdNkE.max-1300x1300.jpg" alt="https://storage.googleapis.com/gweb-cloudblog-publish/images/maxresdefault_wDtdNkE.max-1300x1300.jpg" loading="lazy"/></section></picture></div></div></section></section><section><span jsaction="rcuQ6b:npT2md" jscontroller="YSybTb" data-track-type="" soy-skip="" ssk="5:kbe95"><p><span>To learn more about Trillium TPUs, visit </span><a href="http://g.co/tpu" rel="noopener" target="_blank"><span>g.co/tpu</span></a><span> or </span><a href="https://cloud.google.com/resources/content-promotion-ai-infra-contact?hl=en"><span>contact our sales team</span></a><span>.</span></p></span></section><section><section><span>Posted in</span><ul><li><a href="https://cloud.google.com/blog/products/compute" track-metadata-position="body" track-metadata-eventdetail="cloud.google.com/blog/products/compute" track-metadata-module="tag list" track-metadata-module_headline="posted in">Compute</a></li><li><a href="https://cloud.google.com/blog/products/ai-machine-learning" track-metadata-position="body" track-metadata-eventdetail="cloud.google.com/blog/products/ai-machine-learning" track-metadata-module="tag list" track-metadata-module_headline="posted in">AI &amp; Machine Learning</a></li></ul></section></section></div></div>
  </body>
</html>
