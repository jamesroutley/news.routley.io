<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/haampie/libtree">Original</a>
    <h1>Libtree: Turns ldd into a tree; explains why shared libraries are found or not</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/haampie/libtree/workflows/Test/badge.svg?branch=master"><img src="https://github.com/haampie/libtree/workflows/Test/badge.svg?branch=master" alt="Test"/></a>
<a href="https://aur.archlinux.org/packages/libtree/" rel="nofollow"><img src="https://camo.githubusercontent.com/7e7cc860b359b4e8c852178856fed7ba2f3ceb557ab7e2c021ab84d695412362/68747470733a2f2f696d672e736869656c64732e696f2f6175722f76657273696f6e2f6c6962747265653f6c6f676f3d417263682d4c696e7578" alt="AUR version" data-canonical-src="https://img.shields.io/aur/version/libtree?logo=Arch-Linux"/></a></p>

<p dir="auto">A tool that:</p>
<ul dir="auto">
<li><g-emoji alias="deciduous_tree" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f333.png">ğŸŒ³</g-emoji> turns <code>ldd</code> into a tree</li>
<li><g-emoji alias="point_up" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/261d.png">â˜ï¸</g-emoji> explains why shared libraries are found and why not</li>
<li><g-emoji alias="package" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4e6.png">ğŸ“¦</g-emoji> optionally deploys executables and dependencies into a single directory</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://www.stevegattuso.me/haampie/libtree/blob/master/doc/screenshot.png"><img src="https://www.stevegattuso.me/haampie/libtree/raw/master/doc/screenshot.png" alt="example"/></a></p>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<p dir="auto">Download the <a href="https://github.com/haampie/libtree/releases"><strong>latest release</strong></a> from Github.</p>
<p dir="auto"><strong>Static executable</strong></p>
<div data-snippet-clipboard-copy-content="wget -qO libtree https://github.com/haampie/libtree/releases/download/v2.0.0/libtree_x86_64
chmod +x libtree
./libtree $(which man)
"><pre>wget -qO libtree https://github.com/haampie/libtree/releases/download/v2.0.0/libtree_x86_64
chmod +x libtree
./libtree <span><span>$(</span>which man<span>)</span></span></pre></div>
<p dir="auto"><strong>Static executable + optional dependencies</strong></p>
<div data-snippet-clipboard-copy-content="wget -qO libtree.tar.gz https://github.com/haampie/libtree/releases/download/v2.0.0/libtree_x86_64.tar.gz
mkdir libtree
tar -xf libtree.tar.gz -C libtree
export PATH=&#34;$PWD/libtree:$PATH&#34;
libtree $(which man)
"><pre>wget -qO libtree.tar.gz https://github.com/haampie/libtree/releases/download/v2.0.0/libtree_x86_64.tar.gz
mkdir libtree
tar -xf libtree.tar.gz -C libtree
<span>export</span> PATH=<span><span>&#34;</span><span>$PWD</span>/libtree:<span>$PATH</span><span>&#34;</span></span>
libtree <span><span>$(</span>which man<span>)</span></span></pre></div>
<h2 dir="auto"><a id="user-content-deploying-binaries--dependencies-into-a-folder" aria-hidden="true" href="#deploying-binaries--dependencies-into-a-folder"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deploying binaries + dependencies into a folder</h2>
<div data-snippet-clipboard-copy-content="$ libtree $(which man) -d man.bundle --chrpath --strip
man
â”œâ”€â”€ libmandb-2.9.1.so [runpath]
â”‚   â”œâ”€â”€ libman-2.9.1.so [runpath]
â”‚   â”‚   â”œâ”€â”€ libpipeline.so.1 [ld.so.conf]
â”‚   â”‚   â””â”€â”€ libseccomp.so.2 [ld.so.conf]
â”‚   â””â”€â”€ libgdbm.so.6 [ld.so.conf]
â”œâ”€â”€ libman-2.9.1.so (collapsed) [runpath]
â””â”€â”€ libpipeline.so.1 (collapsed) [ld.so.conf]

Deploying to &#34;man.bundle/usr&#34;
&#34;/usr/bin/man&#34; =&gt; &#34;man.bundle/usr/bin/man&#34;
&#34;/usr/lib/man-db/libmandb-2.9.1.so&#34; =&gt; &#34;man.bundle/usr/lib/libmandb-2.9.1.so&#34;
&#34;/usr/lib/man-db/libman-2.9.1.so&#34; =&gt; &#34;man.bundle/usr/lib/libman-2.9.1.so&#34;
&#34;/usr/lib/x86_64-linux-gnu/libpipeline.so.1.5.2&#34; =&gt; &#34;man.bundle/usr/lib/libpipeline.so.1.5.2&#34;
  creating symlink &#34;man.bundle/usr/lib/libpipeline.so.1&#34;
&#34;/usr/lib/x86_64-linux-gnu/libseccomp.so.2.5.1&#34; =&gt; &#34;man.bundle/usr/lib/libseccomp.so.2.5.1&#34;
  creating symlink &#34;man.bundle/usr/lib/libseccomp.so.2&#34;
&#34;/usr/lib/x86_64-linux-gnu/libgdbm.so.6.0.0&#34; =&gt; &#34;man.bundle/usr/lib/libgdbm.so.6.0.0&#34;
  creating symlink &#34;man.bundle/usr/lib/libgdbm.so.6&#34;

$ tree man.bundle/
man.bundle/
â””â”€â”€ usr
    â”œâ”€â”€ bin
    â”‚Â Â  â””â”€â”€ man
    â””â”€â”€ lib
        â”œâ”€â”€ libgdbm.so.6 -&gt; libgdbm.so.6.0.0
        â”œâ”€â”€ libgdbm.so.6.0.0
        â”œâ”€â”€ libman-2.9.1.so
        â”œâ”€â”€ libmandb-2.9.1.so
        â”œâ”€â”€ libpipeline.so.1 -&gt; libpipeline.so.1.5.2
        â”œâ”€â”€ libpipeline.so.1.5.2
        â”œâ”€â”€ libseccomp.so.2 -&gt; libseccomp.so.2.5.1
        â””â”€â”€ libseccomp.so.2.5.1

3 directories, 9 files
"><pre>$ libtree <span><span>$(</span>which man<span>)</span></span> -d man.bundle --chrpath --strip
man
â”œâ”€â”€ libmandb-2.9.1.so [runpath]
â”‚   â”œâ”€â”€ libman-2.9.1.so [runpath]
â”‚   â”‚   â”œâ”€â”€ libpipeline.so.1 [ld.so.conf]
â”‚   â”‚   â””â”€â”€ libseccomp.so.2 [ld.so.conf]
â”‚   â””â”€â”€ libgdbm.so.6 [ld.so.conf]
â”œâ”€â”€ libman-2.9.1.so (collapsed) [runpath]
â””â”€â”€ libpipeline.so.1 (collapsed) [ld.so.conf]

Deploying to <span><span>&#34;</span>man.bundle/usr<span>&#34;</span></span>
<span><span>&#34;</span>/usr/bin/man<span>&#34;</span></span> =<span>&gt;</span> <span><span>&#34;</span>man.bundle/usr/bin/man<span>&#34;</span></span>
<span><span>&#34;</span>/usr/lib/man-db/libmandb-2.9.1.so<span>&#34;</span></span> =<span>&gt;</span> <span><span>&#34;</span>man.bundle/usr/lib/libmandb-2.9.1.so<span>&#34;</span></span>
<span><span>&#34;</span>/usr/lib/man-db/libman-2.9.1.so<span>&#34;</span></span> =<span>&gt;</span> <span><span>&#34;</span>man.bundle/usr/lib/libman-2.9.1.so<span>&#34;</span></span>
<span><span>&#34;</span>/usr/lib/x86_64-linux-gnu/libpipeline.so.1.5.2<span>&#34;</span></span> =<span>&gt;</span> <span><span>&#34;</span>man.bundle/usr/lib/libpipeline.so.1.5.2<span>&#34;</span></span>
  creating symlink <span><span>&#34;</span>man.bundle/usr/lib/libpipeline.so.1<span>&#34;</span></span>
<span><span>&#34;</span>/usr/lib/x86_64-linux-gnu/libseccomp.so.2.5.1<span>&#34;</span></span> =<span>&gt;</span> <span><span>&#34;</span>man.bundle/usr/lib/libseccomp.so.2.5.1<span>&#34;</span></span>
  creating symlink <span><span>&#34;</span>man.bundle/usr/lib/libseccomp.so.2<span>&#34;</span></span>
<span><span>&#34;</span>/usr/lib/x86_64-linux-gnu/libgdbm.so.6.0.0<span>&#34;</span></span> =<span>&gt;</span> <span><span>&#34;</span>man.bundle/usr/lib/libgdbm.so.6.0.0<span>&#34;</span></span>
  creating symlink <span><span>&#34;</span>man.bundle/usr/lib/libgdbm.so.6<span>&#34;</span></span>

$ tree man.bundle/
man.bundle/
â””â”€â”€ usr
    â”œâ”€â”€ bin
    â”‚Â Â  â””â”€â”€ man
    â””â”€â”€ lib
        â”œâ”€â”€ libgdbm.so.6 -<span>&gt;</span> libgdbm.so.6.0.0
        â”œâ”€â”€ libgdbm.so.6.0.0
        â”œâ”€â”€ libman-2.9.1.so
        â”œâ”€â”€ libmandb-2.9.1.so
        â”œâ”€â”€ libpipeline.so.1 -<span>&gt;</span> libpipeline.so.1.5.2
        â”œâ”€â”€ libpipeline.so.1.5.2
        â”œâ”€â”€ libseccomp.so.2 -<span>&gt;</span> libseccomp.so.2.5.1
        â””â”€â”€ libseccomp.so.2.5.1

3 directories, 9 files</pre></div>
<h2 dir="auto"><a id="user-content-verbose-output" aria-hidden="true" href="#verbose-output"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Verbose output</h2>
<p dir="auto">By default certain standard depenendencies are not shown. For more verbose output use</p>
<ul dir="auto">
<li><code>libtree -v $(which man)</code> to show skipped libraries without their children</li>
<li><code>libtree -a $(which apt-get)</code> to show the full recursive list of libraries</li>
</ul>
<p dir="auto">Use the <code>--path</code> or <code>-p</code> flags to show paths rather than sonames:</p>
<ul dir="auto">
<li><code>libtree -p $(which tar)</code></li>
</ul>
<h2 dir="auto"><a id="user-content-changing-search-paths" aria-hidden="true" href="#changing-search-paths"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Changing search paths</h2>
<p dir="auto"><code>libtree</code> follows the rules of <code>ld.so</code> to locate libraries, but does not use <code>ldconfig</code>&#39;s
cache. Instead it parses <code>/etc/ld.so.conf</code> at runtime. In fact you can change the search
path config by setting <code>--ldconf mylibs.conf</code>. Search paths can be added as well via
<code>LD_LIBRARY_PATH=&#34;path1:path2:$LD_LIBRARY_PATH&#34; libtree ...</code>.</p>
<h2 dir="auto"><a id="user-content-building" aria-hidden="true" href="#building"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Building</h2>
<ul dir="auto">
<li><strong>From source</strong>:
<div data-snippet-clipboard-copy-content="git clone https://github.com/haampie/libtree.git
cd libtree
mkdir build
cd build
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_PREFIX_PATH=&#34;/path/to/cxxopts;/path/to/elfio;/path/to/termcolor&#34; ..
make -j
make install
"><pre>git clone https://github.com/haampie/libtree.git
<span>cd</span> libtree
mkdir build
<span>cd</span> build
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_PREFIX_PATH=<span><span>&#34;</span>/path/to/cxxopts;/path/to/elfio;/path/to/termcolor<span>&#34;</span></span> ..
make -j
make install</pre></div>
</li>
<li><strong>Using <a href="https://github.com/spack/spack">spack</a></strong>:
<div data-snippet-clipboard-copy-content="spack install libtree +chrpath +strip
spack load libtree
"><pre><code>spack install libtree +chrpath +strip
spack load libtree
</code></pre></div>
</li>
</ul>
<h2 dir="auto"><a id="user-content-known-issues" aria-hidden="true" href="#known-issues"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Known issues</h2>
<ul dir="auto">
<li>When deploying libs with <code>libtree app -d folder.bundle --chrpath</code>, the runpaths are only
changed when the binaries already have an an rpath or runpath. This is a limitation of
<code>chrpath</code>. Another option is to use <code>patchelf</code> instead, but this tool is known to break
binaries sometimes.</li>
</ul>
</article>
        </div></div>
  </body>
</html>
