<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.tetraframework.com">Original</a>
    <h1>Tetra â€“ Full stack reactive component framework for Django using Alpine.js</h1>
    
    <div id="readability-page-1" class="page"><div>
              <p><b>components.py</b></p>
              <pre><code>from sourcetypes import javascript, css, django_html
from tetra import Component, public, Library
from .models import ToDo

default = Library()

@default.register
class ToDoList(Component):
    title = public(&#34;&#34;)

    def load(self):
        self.todos = ToDo.objects.filter(session_key=self.request.session.session_key)

    @public
    def add_todo(self, title):
        todo = ToDo(
            title=title,
            session_key=self.request.session.session_key,
        )
        todo.save()
        self.title = &#34;&#34;

    template: django_html = &#34;&#34;&#34;
    &lt;div&gt;
        &lt;div class=&#34;input-group mb-2&#34;&gt;
            &lt;input type=&#34;text&#34; x-model=&#34;title&#34; class=&#34;form-control&#34; 
                placeholder=&#34;New task...&#34; @keyup.enter=&#34;add_todo(title)&#34;&gt;
            &lt;button class=&#34;btn btn-primary&#34; @click=&#34;add_todo(title)&#34;&gt;Add&lt;/button&gt;
        &lt;/div&gt;
        &lt;div class=&#34;list-group&#34;&gt;
            {% for todo in todos %}
                {% @ to_do_item todo=todo key=todo.id / %}
            {% endfor %}
        &lt;/div&gt;
    &lt;/div&gt;
    &#34;&#34;&#34;

@default.register
class ToDoItem(Component):
    title = public(&#34;&#34;)
    done = public(False)

    def load(self, todo):
        self.todo = todo
        self.title = todo.title
        self.done = todo.done

    @public.watch(&#34;title&#34;, &#34;done&#34;).debounce(200)
    def save(self, value, old_value, attr):
        self.todo.title = self.title
        self.todo.done = self.done
        self.todo.save()

    @public(update=False)
    def delete_item(self):
        self.todo.delete()
        self.client.removeComponent()

    template: django_html = &#34;&#34;&#34;
    &lt;div class=&#34;list-group-item d-flex gap-1 p-1&#34; {% ... attrs %}&gt;
        &lt;label class=&#34;align-middle px-2 d-flex&#34;&gt;
            &lt;input class=&#34;form-check-input m-0 align-self-center&#34; type=&#34;checkbox&#34;
                x-model=&#34;done&#34;&gt;
        &lt;/label&gt;
        &lt;input 
            type=&#34;text&#34; 
            class=&#34;form-control border-0 p-0 m-0&#34;
            :class=&#34;{&#39;text-muted&#39;: done, &#39;todo-strike&#39;: done}&#34;
            x-model=&#34;title&#34;
            maxlength=&#34;80&#34;
            @keydown.backspace=&#34;inputDeleteDown()&#34;
            @keyup.backspace=&#34;inputDeleteUp()&#34;
        &gt;
        &lt;button @click=&#34;delete_item()&#34; class=&#34;btn btn-sm&#34;&gt;
            &lt;i class=&#34;fa-solid fa-trash&#34;&gt;&lt;/i&gt;
        &lt;/button&gt;
    &lt;/div&gt;
    &#34;&#34;&#34;

    script: javascript = &#34;&#34;&#34;
    export default {
        lastTitleValue: &#34;&#34;,
        inputDeleteDown() {
            this.lastTitleValue = this.title;
        },
        inputDeleteUp() {
            if (this.title === &#34;&#34; &amp;&amp; this.lastTitleValue === &#34;&#34;) {
                this.delete_item()
            }
        }
    }
    &#34;&#34;&#34;

    style: css = &#34;&#34;&#34;
    .todo-strike {
        text-decoration: line-through;
    }
    &#34;&#34;&#34;</code></pre>
              <p><b>models.py</b></p>
              <pre><code>from django.db import models

class ToDo(models.Model):
    session_key = models.CharField(max_length=40, db_index=True)
    title = models.CharField(max_length=80)
    done = models.BooleanField(default=False)</code></pre>
              <p><b>index.html</b></p>
              <pre><code>{% load tetra %}
&lt;h4&gt;Your to do list:&lt;/h4&gt;
{% @ to_do_list / %}</code></pre>
            </div></div>
  </body>
</html>
