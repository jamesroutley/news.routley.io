<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/epfLLM/meditron">Original</a>
    <h1>Meditron: A suite of open-source medical Large Language Models</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/epfLLM/meditron/blob/main/figures/meditron_LOGO.png"><img width="40%" src="https://github.com/epfLLM/meditron/raw/main/figures/meditron_LOGO.png" alt="MediTron logo" title="Meditron-logo"/></a></p>
<p dir="auto">Meditron is a suite of open-source medical Large Language Models (LLMs).</p>
<p dir="auto">We release Meditron-7B and Meditron-70B, which are adapted to the medical domain from Llama-2 through continued pretraining on a comprehensively curated medical corpus, including selected PubMed papers and abstracts, a new dataset of internationally-recognized medical guidelines, and a general domain corpus.</p>
<p dir="auto">Meditron-70B, finetuned on relevant data, outperforms Llama-2-70B, GPT-3.5 and Flan-PaLM on multiple medical reasoning tasks.</p>
<details open="">
  <summary><strong>Advisory Notice</strong></summary>
  <blockquote>
    While Meditron is designed to encode medical knowledge from sources of high-quality evidence, it is not yet adapted to deliver this knowledge appropriately, safely, or within professional actionable constraints. We recommend against using Meditron in medical applications without extensive use-case alignment, as well as additional testing, specifically including randomized controlled trials in real-world practice settings.
  </blockquote>
</details>
<h2 tabindex="-1" dir="auto"><a id="user-content-model-details" aria-hidden="true" tabindex="-1" href="#model-details"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Model Details</h2>
<ul dir="auto">
<li><strong>Developed by:</strong> <a href="https://huggingface.co/epfl-llm" rel="nofollow">EPFL LLM Team</a></li>
<li><strong>Model type:</strong> Causal decoder-only transformer language model</li>
<li><strong>Language(s):</strong> English (mainly)</li>
<li><strong>Model License:</strong> <a href="https://huggingface.co/meta-llama/Llama-2-70b/raw/main/LICENSE.txt" rel="nofollow">LLAMA 2 COMMUNITY LICENSE AGREEMENT</a></li>
<li><strong>Code License:</strong> <a href="https://github.com/epfLLM/meditron/blob/main/LICENSE">APACHE 2.0 LICENSE</a></li>
<li><strong>Continue-pretrained from model:</strong> <a href="https://huggingface.co/meta-llama/Llama-2-70b" rel="nofollow">Llama-2-70B</a></li>
<li><strong>Context length:</strong>  4k tokens</li>
<li><strong>Input:</strong>  Text only data</li>
<li><strong>Output:</strong>  Model generates text only</li>
<li><strong>Status:</strong> This is a static model trained on an offline dataset. Future versions of the tuned models will be released as we enhance model&#39;s performance.</li>
<li><strong>Knowledge Cutoff:</strong> August 2023</li>
<li><strong>Trainer:</strong> <a href="https://github.com/epfLLM/Megatron-LLM">epflLLM/Megatron-LLM</a></li>
<li><strong>Paper:</strong> <em><a href="https://arxiv.org/abs/2311.16079" rel="nofollow">Meditron-70B: Scaling Medical Pretraining for Large Language Models</a></em></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-how-to-use" aria-hidden="true" tabindex="-1" href="#how-to-use"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How to use</h2>
<p dir="auto">You can load Meditron model directly from the <a href="https://huggingface.co/epfl-llm/meditron-70B" rel="nofollow">HuggingFace model hub</a> as follows:</p>
<div dir="auto" data-snippet-clipboard-copy-content="from transformers import AutoTokenizer, AutoModelForCausalLM

tokenizer = AutoTokenizer.from_pretrained(&#34;epfl-llm/meditron-70B&#34;)
model = AutoModelForCausalLM.from_pretrained(&#34;epfl-llm/meditron-70B&#34;)"><pre><span>from</span> <span>transformers</span> <span>import</span> <span>AutoTokenizer</span>, <span>AutoModelForCausalLM</span>

<span>tokenizer</span> <span>=</span> <span>AutoTokenizer</span>.<span>from_pretrained</span>(<span>&#34;epfl-llm/meditron-70B&#34;</span>)
<span>model</span> <span>=</span> <span>AutoModelForCausalLM</span>.<span>from_pretrained</span>(<span>&#34;epfl-llm/meditron-70B&#34;</span>)</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/epfLLM/meditron/blob/main/figures/meditron-pipeline.png"><img width="100%" src="https://github.com/epfLLM/meditron/raw/main/figures/meditron-pipeline.png" alt="Pipeline" title="Pipeline"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-medical-training-data" aria-hidden="true" tabindex="-1" href="#medical-training-data"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Medical Training Data</h2>
<p dir="auto">We release code to download and pre-process the data used to train Meditron.</p>
<p dir="auto">MediTron’s domain-adaptive pre-training corpus <em>GAP-Replay</em> combines 48.1B tokens from four corpora:</p>
<ul dir="auto">
<li><strong>Clinical Guidelines</strong>: a new corpus of 46K clinical practice guidelines from various healthcare-related sources, including hospitals and international organizations,</li>
<li><strong>Paper Abstracts</strong>: 16.1M abstracts extracted from closed-access PubMed and PubMed Central papers,</li>
<li><strong>Medical Papers</strong>: full-text articles extracted from 5M publicly available PubMed and PubMed Central papers.</li>
<li><strong>Replay dataset</strong>: 400M tokens of general domain pretraining data sampled from <a href="https://huggingface.co/datasets/togethercomputer/RedPajama-Data-1T" rel="nofollow">RedPajama-v1</a>.</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-download-instructions" aria-hidden="true" tabindex="-1" href="#download-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Download instructions</h3>
<p dir="auto">You can download and pre-process the entire GAP-Replay corpus by running <code>./download.sh</code> in the <code>gap-replay</code> folder.</p>
<p dir="auto">You can download 36K open-access articles from our <em>Guidelines</em> corpus from the <a href="https://huggingface.co/datasets/epfl-llm/guidelines" rel="nofollow">HuggingFace datasets hub</a>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="from datasets import load_dataset

dataset = load_dataset(&#34;epfl-llm/guidelines&#34;)"><pre><span>from</span> <span>datasets</span> <span>import</span> <span>load_dataset</span>

<span>dataset</span> <span>=</span> <span>load_dataset</span>(<span>&#34;epfl-llm/guidelines&#34;</span>)</pre></div>
<p dir="auto">You can scrape and clean all 46K guidelines (including closed-access sources) by running <code>./download.sh</code> in the <code>guidelines</code> folder.</p>
<p dir="auto">More details can be found in the <a href="https://github.com/epfLLM/meditron/blob/main/gap-replay/README.md">GAP-Replay documentation</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-training-procedure" aria-hidden="true" tabindex="-1" href="#training-procedure"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Training Procedure</h2>
<p dir="auto">We used the <a href="https://github.com/epfLLM/Megatron-LLM">Megatron-LLM</a> distributed training library, a derivative of Nvidia&#39;s Megatron LM project, to optimize training efficiency.
Hardware consists of 16 nodes of 8x NVIDIA A100 (80GB) SXM GPUs connected by NVLink and NVSwitch with a single Nvidia ConnectX-6 DX network card and equipped with 2 x AMD EPYC 7543 32-Core Processors and 512 GB of RAM.
The nodes are connected via RDMA over Converged Ethernet.</p>
<p dir="auto">Our three-way parallelism scheme uses the following:</p>
<ul dir="auto">
<li>Data Parallelism (DP -- different GPUs process different subsets of the batches) of 2,</li>
<li>Pipeline Parallelism (PP -- different GPUs process different layers) of 8,</li>
<li>Tensor Parallelism (TP -- different GPUs process different subtensors for matrix multiplication) of 8.</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-training-hyperparameters-7b" aria-hidden="true" tabindex="-1" href="#training-hyperparameters-7b"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Training Hyperparameters (7B)</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>bf16</td>
<td>true</td>
</tr>
<tr>
<td>lr</td>
<td>3e-4</td>
</tr>
<tr>
<td>eps</td>
<td>1e-5</td>
</tr>
<tr>
<td>betas</td>
<td>[0.9, 0.95]</td>
</tr>
<tr>
<td>clip_grad</td>
<td>1</td>
</tr>
<tr>
<td>weight decay</td>
<td>0.1</td>
</tr>
<tr>
<td>DP size</td>
<td>16</td>
</tr>
<tr>
<td>TP size</td>
<td>4</td>
</tr>
<tr>
<td>PP size</td>
<td>1</td>
</tr>
<tr>
<td>seq length</td>
<td>2048</td>
</tr>
<tr>
<td>lr scheduler</td>
<td>cosine</td>
</tr>
<tr>
<td>min lr</td>
<td>1e-6</td>
</tr>
<tr>
<td>warmup iteration</td>
<td>2000</td>
</tr>
<tr>
<td>micro batch size</td>
<td>10</td>
</tr>
<tr>
<td>global batch size</td>
<td>1600</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 tabindex="-1" dir="auto"><a id="user-content-training-hyperparameters-70b" aria-hidden="true" tabindex="-1" href="#training-hyperparameters-70b"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Training Hyperparameters (70B)</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>bf16</td>
<td>true</td>
</tr>
<tr>
<td>lr</td>
<td>1.5e-4</td>
</tr>
<tr>
<td>eps</td>
<td>1e-5</td>
</tr>
<tr>
<td>betas</td>
<td>[0.9, 0.95]</td>
</tr>
<tr>
<td>clip_grad</td>
<td>1</td>
</tr>
<tr>
<td>weight decay</td>
<td>0.1</td>
</tr>
<tr>
<td>DP size</td>
<td>2</td>
</tr>
<tr>
<td>TP size</td>
<td>8</td>
</tr>
<tr>
<td>PP size</td>
<td>8</td>
</tr>
<tr>
<td>seq length</td>
<td>4096</td>
</tr>
<tr>
<td>lr scheduler</td>
<td>cosine</td>
</tr>
<tr>
<td>min lr</td>
<td>1e-6</td>
</tr>
<tr>
<td>warmup iteration</td>
<td>2000</td>
</tr>
<tr>
<td>micro batch size</td>
<td>2</td>
</tr>
<tr>
<td>global batch size</td>
<td>512</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p dir="auto">You can see the script we used to pretrain our models through Megatron-LLM here: <a href="https://github.com/epfLLM/meditron/blob/main/pretrain/finetune.sh">finetune.sh</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-supervised-finetuning" aria-hidden="true" tabindex="-1" href="#supervised-finetuning"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Supervised Finetuning</h2>
<p dir="auto">We again used the <a href="https://github.com/epfLLM/Megatron-LLM">Megatron-LLM</a> distributed training library for supervised finetuning (sinlge-node and multi-node).
We made a file, <code>sft.py</code>, that automatically handles the tokenization and finetuning process through Megatron-LLM. To start a multi-node finetuning process, here is an example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cd finetuning
python sft.py \
    --checkpoint=baseline \
    --size=70 \
    --run_name=cotmedqa \
    --data /pure-mlo-scratch/zechen/meditron/benchmarks/ft_preprocessed/medqa_cot_train.jsonl \
    --val /pure-mlo-scratch/zechen/meditron/benchmarks/ft_preprocessed/medqa_cot_validation.jsonl \
    --micro_batch=4
    --nodes=4 \
    --addr=&lt;RANK0_HOST_NAME&gt; \
    --save_interval=200 \
    --pp=4 \
    --seq 4096 \
    --rank=&lt;CURRENT_RANK&gt;"><pre><span>cd</span> finetuning
python sft.py \
    --checkpoint=baseline \
    --size=70 \
    --run_name=cotmedqa \
    --data /pure-mlo-scratch/zechen/meditron/benchmarks/ft_preprocessed/medqa_cot_train.jsonl \
    --val /pure-mlo-scratch/zechen/meditron/benchmarks/ft_preprocessed/medqa_cot_validation.jsonl \
    --micro_batch=4
    --nodes=4 \
    --addr=<span>&lt;</span>RANK0_HOST_NAME<span>&gt;</span> \
    --save_interval=200 \
    --pp=4 \
    --seq 4096 \
    --rank=<span>&lt;</span>CURRENT_RANK<span>&gt;</span></pre></div>
<p dir="auto">Run the above line of code at node rank-0, rank-1, rank-2, and rank3 to start a 4-node finetuning process.</p>
<p dir="auto"><strong>Important!</strong>: Make sure to have the proper paths defined in <code>sft.py</code> and <code>finetune_sft.sh</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-finetuning-hyperparameters" aria-hidden="true" tabindex="-1" href="#finetuning-hyperparameters"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Finetuning Hyperparameters</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>bf16</td>
<td>true</td>
</tr>
<tr>
<td>lr</td>
<td>2e-5</td>
</tr>
<tr>
<td>eps</td>
<td>1e-5</td>
</tr>
<tr>
<td>betas</td>
<td>[0.9, 0.95]</td>
</tr>
<tr>
<td>clip_grad</td>
<td>1</td>
</tr>
<tr>
<td>weight decay</td>
<td>0.1</td>
</tr>
<tr>
<td>DP size</td>
<td>16</td>
</tr>
<tr>
<td>TP size</td>
<td>4</td>
</tr>
<tr>
<td>PP size</td>
<td>1</td>
</tr>
<tr>
<td>seq length</td>
<td>2048 or 4096</td>
</tr>
<tr>
<td>lr scheduler</td>
<td>cosine</td>
</tr>
<tr>
<td>min lr</td>
<td>2e-6</td>
</tr>
<tr>
<td>warmup ratio</td>
<td>0.1</td>
</tr>
<tr>
<td>added tokens</td>
<td>[&lt;|im_start|&gt;, &lt;|im_end|&gt;]</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 tabindex="-1" dir="auto"><a id="user-content-uses" aria-hidden="true" tabindex="-1" href="#uses"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Uses</h2>
<p dir="auto">Meditron-70B is being made available for further testing and assessment as an AI assistant to enhance clinical decision-making and democratize access to an LLM for healthcare use. Potential use cases may include but are not limited to:</p>
<ul dir="auto">
<li>Medical exam question answering</li>
<li>Supporting differential diagnosis</li>
<li>Disease information (symptoms, cause, treatment) query</li>
<li>General health information query</li>
</ul>
<p dir="auto">It is possible to use this model to generate text, which is useful for experimentation and understanding its capabilities. It should not be used directly for production or work that may impact people.</p>
<p dir="auto">We do not recommend using this model for natural language generation in a production environment, finetuned or otherwise.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-downstream-use" aria-hidden="true" tabindex="-1" href="#downstream-use"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Downstream Use</h3>
<p dir="auto">Meditron-70B is a foundation model that can be finetuned, instruction-tuned, or RLHF-tuned for specific downstream tasks and applications.
The main way we have used this model is finetuning for downstream question-answering tasks, but we encourage using this model for additional applications.</p>
<p dir="auto">Specific formatting needs to be followed to prompt our finetuned models, including the  <code>&lt;|im_start|&gt;</code>, <code>&lt;|im_end|&gt;</code> tags, and  <code>system</code>, <code>question</code>, <code>answer</code>  identifiers.</p>
<div dir="auto" data-snippet-clipboard-copy-content="&#34;&#34;&#34;
&lt;|im_start|&gt;system
{system_message}&lt;|im_end|&gt;
&lt;|im_start|&gt;question
{prompt}&lt;|im_end|&gt;
&lt;|im_start|&gt;answer
&#34;&#34;&#34;"><pre><span>&#34;&#34;&#34;</span>
<span>&lt;|im_start|&gt;system</span>
<span>{system_message}&lt;|im_end|&gt;</span>
<span>&lt;|im_start|&gt;question</span>
<span>{prompt}&lt;|im_end|&gt;</span>
<span>&lt;|im_start|&gt;answer</span>
<span>&#34;&#34;&#34;</span></pre></div>
<p dir="auto"><strong>Note</strong>: the above formatting is not a requirement if you use your own formatting option for the finetuning of the model.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-medical-benchmark-inference--evaluation" aria-hidden="true" tabindex="-1" href="#medical-benchmark-inference--evaluation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Medical Benchmark Inference &amp; Evaluation</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-requirements" aria-hidden="true" tabindex="-1" href="#requirements"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Requirements</h3>
<p dir="auto">Before you start, please install the necessary packages:</p>
<div data-snippet-clipboard-copy-content="vllm &gt;= 0.2.1
transformers &gt;= 4.34.0
datasets &gt;= 2.14.6
torch &gt;= 2.0.1"><pre><code>vllm &gt;= 0.2.1
transformers &gt;= 4.34.0
datasets &gt;= 2.14.6
torch &gt;= 2.0.1
</code></pre></div>
<p dir="auto">For detailed instructions to run inference and evaluation with medical benchmarks, please read the documentation here <a href="https://github.com/epfLLM/meditron/blob/main/evaluation/README.md">inference &amp; evaluation instructions</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-model-deployment" aria-hidden="true" tabindex="-1" href="#model-deployment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Model Deployment</h2>
<p dir="auto">For detailed instructions to deploy meditron models and have an interactive chat session, please read the documentation here <a href="https://github.com/epfLLM/meditron/blob/main/deployment/README.md">Model Deployment</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-citation" aria-hidden="true" tabindex="-1" href="#citation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Citation</h2>
<p dir="auto">If you use this software or our paper, please cite them:</p>
<pre>@misc{chen2023meditron70b,
      title={MEDITRON-70B: Scaling Medical Pretraining for Large Language Models}, 
      author={Zeming Chen and Alejandro Hernández-Cano and Angelika Romanou and Antoine Bonnet and Kyle Matoba and Francesco Salvi and Matteo Pagliardini and Simin Fan and Andreas Köpf and Amirkeivan Mohtashami and Alexandre Sallinen and Alireza Sakhaeirad and Vinitra Swamy and Igor Krawczuk and Deniz Bayazit and Axel Marmet and Syrielle Montariol and Mary-Anne Hartley and Martin Jaggi and Antoine Bosselut},
      year={2023},
      eprint={2311.16079},
      archivePrefix={arXiv},
      primaryClass={cs.CL}
}

@software{epfmedtrn,
  author = {Zeming Chen and Alejandro Hernández-Cano and Angelika Romanou and Antoine Bonnet and Kyle Matoba and Francesco Salvi and Matteo Pagliardini and Simin Fan and Andreas Köpf and Amirkeivan Mohtashami and Alexandre Sallinen and Alireza Sakhaeirad and Vinitra Swamy and Igor Krawczuk and Deniz Bayazit and Axel Marmet and Syrielle Montariol and Mary-Anne Hartley and Martin Jaggi and Antoine Bosselut},
  title = {MediTron-70B: Scaling Medical Pretraining for Large Language Models},
  month = November,
  year = 2023,
  url = {https://github.com/epfLLM/meditron}
}
</pre>
</article>
          </div></div>
  </body>
</html>
