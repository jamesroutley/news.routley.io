<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/flonatel/pipexec">Original</a>
    <h1>Pipexec â€“ Handling pipe of commands like a single command</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Build a network of processes and connecting pipes - and have them act like a single process.</p>
<p dir="auto"><a href="https://github.com/flonatel/pipexec/actions/workflows/compile-check.yml"><img src="https://github.com/flonatel/pipexec/actions/workflows/compile-check.yml/badge.svg" alt="Build Status"/></a>
<a href="https://github.com/flonatel/pipexec/actions/workflows/codeql-analysis.yml"><img src="https://github.com/flonatel/pipexec/actions/workflows/codeql-analysis.yml/badge.svg" alt="Code Analysis"/></a>
<a href="https://github.com/flonatel/pipexec/releases/latest"><img src="https://camo.githubusercontent.com/79c3e9f6ec374359910971bcb55cf1e94807c3abab904b770fe13f9d57b99c4f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f666c6f6e6174656c2f706970657865632e737667" alt="Release" data-canonical-src="https://img.shields.io/github/release/flonatel/pipexec.svg"/></a>
<a href="#license"><img src="https://camo.githubusercontent.com/c2d1fc6741266dc6794199b496f009676e309a36f9681c0a0841e1e6039f7fe7/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f666c6f6e6174656c2f706970657865632e737667" alt="License" data-canonical-src="https://img.shields.io/github/license/flonatel/pipexec.svg"/></a>
<a href="https://github.com/flonatel/pipexec/issues"><img src="https://camo.githubusercontent.com/c1567dbbe3ae7ea51273b6edb3c2a2edc326ccd89d440337a123aa99fd6ae336/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732f666c6f6e6174656c2f706970657865632e737667" alt="Issues" data-canonical-src="https://img.shields.io/github/issues/flonatel/pipexec.svg"/></a></p>

<p dir="auto"><em>pipexec</em> has two major use cases.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Use Case 1: Handling Arbitrary Pipes between Processes</h2><a id="user-content-use-case-1-handling-arbitrary-pipes-between-processes" aria-label="Permalink: Use Case 1: Handling Arbitrary Pipes between Processes" href="#use-case-1-handling-arbitrary-pipes-between-processes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<p dir="auto">When it comes to pipes in shells many tutorials introduce
<code>stdin</code>, <code>stdout</code> and <code>stderr</code> which
map to file descriptors 0, 1 and 2 respectively.</p>
<p dir="auto">If you want to know how many lines contains the word <em>bird</em> in
chapter 1 and 2 of your text, you can use a command like:</p>
<div data-snippet-clipboard-copy-content="$ cat Chap1.txt Chap2.txt | grep bird | wc -l"><pre><code>$ cat Chap1.txt Chap2.txt | grep bird | wc -l
</code></pre></div>
<p dir="auto">And pictures like this are shown to explain what happens internally:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/flonatel/pipexec/blob/master/doc/imgs/PipeSimpel1.png"><img src="https://github.com/flonatel/pipexec/raw/master/doc/imgs/PipeSimpel1.png" alt="Simple Pipe"/></a></p>

<p dir="auto">The more advanced sections provide information how to use constructs
like <code>2&gt;&amp;1</code> to redirect <code>stderr</code> to
<code>stdout</code>.  And then you might come to the sections for the
pros and nerds. There is explained that you can build up a whole tree
of processes like</p>
<div data-snippet-clipboard-copy-content="$ find / 1&gt; &gt;(grep .txt) 2&gt; &gt;(wc &gt;/tmp/w.log)"><pre><code>$ find / 1&gt; &gt;(grep .txt) 2&gt; &gt;(wc &gt;/tmp/w.log)
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/flonatel/pipexec/blob/master/doc/imgs/PipeTree1.png"><img src="https://github.com/flonatel/pipexec/raw/master/doc/imgs/PipeTree1.png" alt="Simple Tree"/></a></p>
<div dir="auto"><h3 tabindex="-1" dir="auto">The Hidden Universe of File-Descriptors, Processes and Pipes</h3><a id="user-content-the-hidden-universe-of-file-descriptors-processes-and-pipes" aria-label="Permalink: The Hidden Universe of File-Descriptors, Processes and Pipes" href="#the-hidden-universe-of-file-descriptors-processes-and-pipes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Nobody will tell you:</p>
<ol dir="auto">
<li><code>stdin</code>, <code>stdout</code> and <code>stderr</code> are
artificial definitions.</li>
<li>Also the relation to file descriptors 0, 1 and 2 is artificial.</li>
<li>There are more than three file descriptors. On a typical Linux
system each process has by default 1024 - which can be increased if
needed.</li>
<li>From starting up processes and generating pipes between them there
is mostly no limitation on system level; shells only support this in a
very limited way.</li>
</ol>
<p dir="auto">This is the moment when <em>pipexec</em> drops in: with <em>pipexec</em> you can
start up any kind of processes and build up pipes between them as you want.</p>

<div data-snippet-clipboard-copy-content="$ pipexec -- [ A /usr/bin/cmd1 ] [ B /usr/bin/cmd2 ] &#34;{A:1&gt;B:0}&#34; &#34;{B:1&gt;A:0}&#34;"><pre><code>$ pipexec -- [ A /usr/bin/cmd1 ] [ B /usr/bin/cmd2 ] &#34;{A:1&gt;B:0}&#34; &#34;{B:1&gt;A:0}&#34;
</code></pre></div>
<p dir="auto">gives</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/flonatel/pipexec/blob/master/doc/imgs/PipexecCycle.png"><img src="https://github.com/flonatel/pipexec/raw/master/doc/imgs/PipexecCycle.png" alt="Pipexec Cycle"/></a></p>

<p dir="auto"><em>pipexec</em> supports any directed graph of processes and pipes like</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/flonatel/pipexec/blob/master/doc/imgs/PipexecComplex.png"><img src="https://github.com/flonatel/pipexec/raw/master/doc/imgs/PipexecComplex.png" alt="Pipexec Complex"/></a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Use Case 2: Handle Bunch of Processes like one single Process</h2><a id="user-content-use-case-2-handle-bunch-of-processes-like-one-single-process" aria-label="Permalink: Use Case 2: Handle Bunch of Processes like one single Process" href="#use-case-2-handle-bunch-of-processes-like-one-single-process"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Most systems to start and run processes during system start-up time do
not support pipe.  If you need to run a pipe of programs from an
/etc/init.d script you are mostly lost.</p>
<p dir="auto">Depending on your distribution you can be happy if it starts up - but
when it comes to stopping, at least the current Debian
start-stop-daemon and RHEL 6 daemon function fail.</p>
<p dir="auto">Also here <em>pipexec</em> comes in: it starts up processes piped together,
acts like a single process and supports pid file handling.</p>

<div data-snippet-clipboard-copy-content="$ ./pipexec -h
pipexec version 2.5.5
(c) 2014-2015,2022 by Andreas Florath &lt;andreas@florath.net&gt;
License GPLv2+: GNU GPL version 2 or later &lt;http://gnu.org/licenses/gpl.html&gt;.

Usage: pipexec [options] -- process-pipe-graph
Options:
 -h              display this help
 -k              kill all child processes when one 
                 terminates abnormally
 -l logfd        set fd which is used for logging
 -p pidfile      specify a pidfile
 -s sleep_time   time to wait before a restart

process-pipe-graph is a list of process descriptions
                   and pipe descriptions.
process description: &#39;[ NAME /path/to/proc ]&#39;
pipe description: &#39;{NAME1:fd1&gt;NAME2:fd2}&#39;"><pre><code>$ ./pipexec -h
pipexec version 2.5.5
(c) 2014-2015,2022 by Andreas Florath &lt;andreas@florath.net&gt;
License GPLv2+: GNU GPL version 2 or later &lt;http://gnu.org/licenses/gpl.html&gt;.

Usage: pipexec [options] -- process-pipe-graph
Options:
 -h              display this help
 -k              kill all child processes when one 
                 terminates abnormally
 -l logfd        set fd which is used for logging
 -p pidfile      specify a pidfile
 -s sleep_time   time to wait before a restart

process-pipe-graph is a list of process descriptions
                   and pipe descriptions.
process description: &#39;[ NAME /path/to/proc ]&#39;
pipe description: &#39;{NAME1:fd1&gt;NAME2:fd2}&#39;
</code></pre></div>
<p dir="auto">Example:</p>
<div data-snippet-clipboard-copy-content="$ pipexec -- [ LS /bin/ls -l ] [ GREP /bin/grep LIC ] &#39;{LS:1&gt;GREP:0}&#39;
-rw-r--r-- 1 florath florath 18025 Mar 16 19:36 LICENSE"><pre><code>$ pipexec -- [ LS /bin/ls -l ] [ GREP /bin/grep LIC ] &#39;{LS:1&gt;GREP:0}&#39;
-rw-r--r-- 1 florath florath 18025 Mar 16 19:36 LICENSE
</code></pre></div>
<p dir="auto">Be sure to escape pipe descriptions. Brackets for the command &#39;[]&#39; must be
separated by space! Definitions for pipes &#39;{}&#39; must not contain spaces!</p>
<p dir="auto">It is possible to specify a fd for logging.</p>
<div data-snippet-clipboard-copy-content="$ pipexec -l 2 -- [ LS /bin/ls -l ] [ GREP /bin/grep LIC ] &#39;{LS:1&gt;GREP:0}&#39;
2014-05-15 16:30:35;pipexec;23978;pipexec version 2.4
2014-05-15 16:30:35;pipexec;23978;Number of commands in command line [2]
2014-05-15 16:30:35;pipexec;23978;Number of pipes in command line [1]
2014-05-15 16:30:35;pipexec;23978;[LS] command_info path [/bin/ls]
2014-05-15 16:30:35;pipexec;23978;[GREP] command_info path [/bin/grep]
2014-05-15 16:30:35;pipexec;23978;{0} Pipe [LS] [1] &gt; [GREP] [0]
2014-05-15 16:30:35;pipexec;23978;Cannot set restart flag - process will terminate
2014-05-15 16:30:35;pipexec;23978;Start all [2] children
[...]"><pre><code>$ pipexec -l 2 -- [ LS /bin/ls -l ] [ GREP /bin/grep LIC ] &#39;{LS:1&gt;GREP:0}&#39;
2014-05-15 16:30:35;pipexec;23978;pipexec version 2.4
2014-05-15 16:30:35;pipexec;23978;Number of commands in command line [2]
2014-05-15 16:30:35;pipexec;23978;Number of pipes in command line [1]
2014-05-15 16:30:35;pipexec;23978;[LS] command_info path [/bin/ls]
2014-05-15 16:30:35;pipexec;23978;[GREP] command_info path [/bin/grep]
2014-05-15 16:30:35;pipexec;23978;{0} Pipe [LS] [1] &gt; [GREP] [0]
2014-05-15 16:30:35;pipexec;23978;Cannot set restart flag - process will terminate
2014-05-15 16:30:35;pipexec;23978;Start all [2] children
[...]
</code></pre></div>
<p dir="auto">Or</p>
<div data-snippet-clipboard-copy-content="$ pipexec -l 7 -- [ LS /bin/ls -l ] [ GREP /bin/grep LIC ] &#39;{LS:1&gt;GREP:0}&#39; 7&gt;/tmp/pipexec.log
-rw-r--r-- 1 florath florath 18025 Mar 16 19:53 LICENSE
$ head -2 /tmp/pipexec.log
2014-05-15 16:30:35;pipexec;23978;pipexec version 2.4
2014-05-15 16:30:35;pipexec;23978;Number of commands in command line [2]"><pre><code>$ pipexec -l 7 -- [ LS /bin/ls -l ] [ GREP /bin/grep LIC ] &#39;{LS:1&gt;GREP:0}&#39; 7&gt;/tmp/pipexec.log
-rw-r--r-- 1 florath florath 18025 Mar 16 19:53 LICENSE
$ head -2 /tmp/pipexec.log
2014-05-15 16:30:35;pipexec;23978;pipexec version 2.4
2014-05-15 16:30:35;pipexec;23978;Number of commands in command line [2]
</code></pre></div>


<p dir="auto">The following Linux distributions include the package.  You can
install pipexec with the distribution&#39;s package manager:</p>
<ul dir="auto">
<li><a href="https://packages.debian.org/stretch/pipexec" rel="nofollow">Debian</a></li>
<li><a href="http://packages.ubuntu.com/wily/pipexec" rel="nofollow">Ubuntu</a></li>
<li><a href="https://aur.archlinux.org/packages/pipexec" rel="nofollow">Archlinux</a></li>
<li><a href="https://www.raspbian.org/" rel="nofollow">Raspbian</a></li>
<li><a href="http://www.kali.org" rel="nofollow">Kali</a></li>
<li><a href="http://aos.ion.nu/buildwiki/pipexec.html" rel="nofollow">AOS</a></li>
</ul>

<p dir="auto"><a href="https://github.com/flonatel/pipexec/releases">Download the latest tar ball</a></p>
<div data-snippet-clipboard-copy-content="$ tar -xf pipexec-X.Y.Z.tar.xz
$ mkdir PIPEXECBUILD
$ cd PIPEXECBUILD
$ ${PWD}/../pipexec-X.Y.Z/configure
$ make"><pre><code>$ tar -xf pipexec-X.Y.Z.tar.xz
$ mkdir PIPEXECBUILD
$ cd PIPEXECBUILD
$ ${PWD}/../pipexec-X.Y.Z/configure
$ make
</code></pre></div>
<p dir="auto">There will be three binaries in the bin directory: pipexec, ptee and
peet.  You can copy / install them as you need.</p>

<p dir="auto">copyright 2015,2022 by Andreas Florath</p>
<p dir="auto">License: see LICENSE file</p>
</article></div></div>
  </body>
</html>
