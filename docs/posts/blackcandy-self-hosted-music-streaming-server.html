<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/blackcandy-org/blackcandy">Original</a>
    <h1>Blackcandy: Self hosted music streaming server</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
  <a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/blackcandy-org/black_candy/master/app/assets/images/logo.svg"><img alt="Black Candy logo" width="200" src="https://raw.githubusercontent.com/blackcandy-org/black_candy/master/app/assets/images/logo.svg"/></a>
</p>

<p dir="auto"><a href="https://github.com/blackcandy-org/black_candy/actions/workflows/ci.yml"><img src="https://github.com/blackcandy-org/black_candy/actions/workflows/ci.yml/badge.svg" alt="CI"/></a>
<a href="https://coveralls.io/github/blackcandy-org/black_candy?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/8ca1d878ecb6847c9042ccf042ef27695f509adff2c9545fdf367f41a8869545/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f626c61636b63616e64792d6f72672f626c61636b63616e64792f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/blackcandy-org/blackcandy/badge.svg?branch=master"/></a>
<a href="https://github.com/testdouble/standard"><img src="https://camo.githubusercontent.com/5338a68a0f130dc684279ff3e42e45c9c74006018a1bdeaac76905979b3ccd49/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64655f7374796c652d7374616e646172642d627269676874677265656e2e737667" alt="Ruby Style Guide" data-canonical-src="https://img.shields.io/badge/code_style-standard-brightgreen.svg"/></a>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/35a0f5dee1d6ea31fe1f598aa4be82b94628bd1f322a60ef969788f300794243/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f70756c6c732f626c61636b63616e64792f626c61636b63616e6479"><img src="https://camo.githubusercontent.com/35a0f5dee1d6ea31fe1f598aa4be82b94628bd1f322a60ef969788f300794243/68747470733a2f2f696d672e736869656c64732e696f2f646f636b65722f70756c6c732f626c61636b63616e64792f626c61636b63616e6479" alt="Docker Pulls" data-canonical-src="https://img.shields.io/docker/pulls/blackcandy/blackcandy"/></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/blackcandy-org/blackcandy/master/docs/images/screenshot_main.png"><img src="https://raw.githubusercontent.com/blackcandy-org/blackcandy/master/docs/images/screenshot_main.png" alt="Screenshot"/></a></p>
<p dir="auto">Black Candy is a self-hosted music streaming server, your personal music center.</p>

<p dir="auto">Please visit <a href="https://demo.blackcandy.org" rel="nofollow">https://demo.blackcandy.org</a> and use demo user (email: <a href="mailto:admin@admin.com">admin@admin.com</a>, password: foobar) to log in. And feel free to try it.</p>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p><p dir="auto">This demo user does not have administrator privileges. So you cannot experience all the features in Black Candy. And all music in the demo are from <a href="https://freemusicarchive.org/" rel="nofollow">Free Music Archive</a>. You can check their <a href="https://github.com/blackcandy-org/blackcandy/blob/master/docs/demo_music_licenses.md">licenses</a>.</p>
</div>

<p dir="auto">Black Candy uses docker image to install easily. You can run Black Candy like this.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -p 3000:3000 ghcr.io/blackcandy-org/blackcandy:latest 

# Or pull from Docker Hub.
docker run -p 3000:3000 blackcandy/blackcandy:latest "><pre>docker run -p 3000:3000 ghcr.io/blackcandy-org/blackcandy:latest 

<span><span>#</span> Or pull from Docker Hub.</span>
docker run -p 3000:3000 blackcandy/blackcandy:latest </pre></div>
<p dir="auto">That&#39;s all. Now, you can access either <a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a> or <a href="http://host-ip:3000" rel="nofollow">http://host-ip:3000</a> in a browser, and use initial admin user to log in (email: <a href="mailto:admin@admin.com">admin@admin.com</a>, password: foobar).</p>

<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p><p dir="auto">If you upgrade to a major version, you need to read the upgrade guide carefully before upgrade. Because there are some breaking changes in a major version.</p>
<ul dir="auto">
<li>See <a href="https://github.com/blackcandy-org/blackcandy/blob/master/docs/v3_upgrade.md">V3 Upgrade</a> for upgrade from V2 release.</li>
<li>See <a href="https://github.com/blackcandy-org/blackcandy/blob/master/docs/edge_upgrade.md">Edge Upgrade</a> for upgrade from edge release to latest stable release.</li>
</ul>
</div>
<p dir="auto">Upgrade Black Candy is pull new image from remote. Then remove an old container and create a new one.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker pull ghcr.io/blackcandy-org/blackcandy:latest
docker stop &lt;your_blackcandy_container&gt;
docker rm &lt;your_blackcandy_container&gt;
docker run &lt;OPTIONS&gt; ghcr.io/blackcandy-org/blackcandy:latest "><pre>docker pull ghcr.io/blackcandy-org/blackcandy:latest
docker stop <span>&lt;</span>your_blackcandy_container<span>&gt;</span>
docker rm <span>&lt;</span>your_blackcandy_container<span>&gt;</span>
docker run <span>&lt;</span>OPTIONS<span>&gt;</span> ghcr.io/blackcandy-org/blackcandy:latest </pre></div>
<p dir="auto">With docker compose, you can upgrade Black Candy like this:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker pull ghcr.io/blackcandy-org/blackcandy:latest
docker-compose down
docker-compose up"><pre>docker pull ghcr.io/blackcandy-org/blackcandy:latest
docker-compose down
docker-compose up</pre></div>

<p dir="auto">Black Candy mobile apps are available in the following app stores:</p>
<p dir="auto"><a href="https://apps.apple.com/app/blackcandy/id6444304071" rel="nofollow"><img src="https://raw.githubusercontent.com/blackcandy-org/ios/master/images/appstore_badge.png" alt="Get it on App Store" height="50"/></a>
<a href="https://f-droid.org/packages/org.blackcandy.android/" rel="nofollow"><img src="https://raw.githubusercontent.com/blackcandy-org/android/master/images/fdroid_badge.png" alt="Get it on F-Droid" height="50"/></a></p>
<p dir="auto">For Android app, you can also download APK from <a href="https://github.com/blackcandy-org/android/releases/latest">GitHub Release</a></p>


<p dir="auto">Black Candy exports the 3000 port. If you want to be able to access it from the host, you can use the <code>-p</code> option to map the port.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -p 3000:3000 ghcr.io/blackcandy-org/blackcandy:latest"><pre>docker run -p 3000:3000 ghcr.io/blackcandy-org/blackcandy:latest</pre></div>

<p dir="auto">You can mount media files from host to container and use <code>MEDIA_PATH</code> environment variable to set the media path for black candy.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -v /media_data:/media_data -e MEDIA_PATH=/media_data ghcr.io/blackcandy-org/blackcandy:latest   "><pre>docker run -v /media_data:/media_data -e MEDIA_PATH=/media_data ghcr.io/blackcandy-org/blackcandy:latest   </pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Use PostgreSQL As Database</h3><a id="user-content-use-postgresql-as-database" aria-label="Permalink: Use PostgreSQL As Database" href="#use-postgresql-as-database"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Black Candy use SQLite as database by default. Because SQLite can simplify the process of installation, and it&#39;s an ideal choice for self-hosted small server. If you think SQLite is not enough, or you are using some cloud service like heroku to host Black Candy, you can also use PostgreSQL as database.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -e DB_ADAPTER=postgresql -e DB_URL=postgresql://yourdatabaseurl ghcr.io/blackcandy-org/blackcandy:latest "><pre>docker run -e DB_ADAPTER=postgresql -e DB_URL=postgresql://yourdatabaseurl ghcr.io/blackcandy-org/blackcandy:latest </pre></div>

<p dir="auto">All the data that need to persist in Black Candy are stored in <code>/app/storage</code>, So you can mount this directory to host to persist data.</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir storage_data

docker run -v ./storage_data:/app/storage ghcr.io/blackcandy-org/blackcandy:latest "><pre>mkdir storage_data

docker run -v ./storage_data:/app/storage ghcr.io/blackcandy-org/blackcandy:latest </pre></div>

<p dir="auto">Black Candy supports use Nginx to delivery audio file to the client. It&#39;s a more effective way than handled by Black Candy backend. And Black Candy docker image is also ready for <a href="https://github.com/nginx-proxy/nginx-proxy">nginx-proxy</a>, which means you can set up a Nginx proxy for Black Candy easily.</p>
<p dir="auto">You can use docker-compose to set up those services. The docker-compose.yml file looks like this:</p>
<div dir="auto" data-snippet-clipboard-copy-content="version: &#39;3&#39;

services:
  nginx-proxy:
    image: nginxproxy/nginx-proxy
    ports:
      - &#34;80:80&#34;
    volumes:
      - ./blackcandy.local:/etc/nginx/vhost.d/blackcandy.local:ro
      - /var/run/docker.sock:/tmp/docker.sock:ro
      - /media_data:/media_data # Keep the path of media files in container the same as blackcandy container.

  app:
    image: ghcr.io/blackcandy-org/blackcandy:latest 
    volumes:
      - ./storage_data:/app/storage
      - /media_data:/media_data
    environment:
      VIRTUAL_HOST: blackcandy.local
      MEDIA_PATH: /media_data
      NGINX_SENDFILE: &#34;true&#34; # Don&#39;t forget to set `NGINX_SENDFILE` environment variable to true to enable nginx sendfile."><pre><span>version</span>: <span><span>&#39;</span>3<span>&#39;</span></span>

<span>services</span>:
  <span>nginx-proxy</span>:
    <span>image</span>: <span>nginxproxy/nginx-proxy</span>
    <span>ports</span>:
      - <span><span>&#34;</span>80:80<span>&#34;</span></span>
    <span>volumes</span>:
      - <span>./blackcandy.local:/etc/nginx/vhost.d/blackcandy.local:ro</span>
      - <span>/var/run/docker.sock:/tmp/docker.sock:ro</span>
      - <span>/media_data:/media_data </span><span><span>#</span> Keep the path of media files in container the same as blackcandy container.</span>

  <span>app</span>:
    <span>image</span>: <span>ghcr.io/blackcandy-org/blackcandy:latest </span>
    <span>volumes</span>:
      - <span>./storage_data:/app/storage</span>
      - <span>/media_data:/media_data</span>
    <span>environment</span>:
      <span>VIRTUAL_HOST</span>: <span>blackcandy.local</span>
      <span>MEDIA_PATH</span>: <span>/media_data</span>
      <span>NGINX_SENDFILE</span>: <span><span>&#34;</span>true<span>&#34;</span></span> <span><span>#</span> Don&#39;t forget to set `NGINX_SENDFILE` environment variable to true to enable nginx sendfile.</span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Get the default sendfile config for blackcandy. This file need to mount to nginx proxy container to add custom configuration for nginx.
curl https://raw.githubusercontent.com/blackcandy-org/blackcandy/v3.0.0/config/nginx/sendfile.conf &gt; blackcandy.local

docker-compose up"><pre><span><span>#</span> Get the default sendfile config for blackcandy. This file need to mount to nginx proxy container to add custom configuration for nginx.</span>
curl https://raw.githubusercontent.com/blackcandy-org/blackcandy/v3.0.0/config/nginx/sendfile.conf <span>&gt;</span> blackcandy.local

docker-compose up</pre></div>

<p dir="auto">Black Candy logs to <code>STDOUT</code> by default. So if you want to control the log, Docker already supports a lot of options to handle the log in the container. See: <a href="https://docs.docker.com/config/containers/logging/configure/" rel="nofollow">https://docs.docker.com/config/containers/logging/configure/</a>.</p>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Name</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DB_URL</td>
<td></td>
<td>The URL of PostgreSQL database. You must set this environment variable if you use PostgreSQL as database.</td>
</tr>
<tr>
<td>MEDIA_PATH</td>
<td></td>
<td>You can use this environment variable to set media path for Black Candy, otherwise you can set media path in settings page.</td>
</tr>
<tr>
<td>DB_ADAPTER</td>
<td>&#34;sqlite&#34;</td>
<td>There are two adapters are supported, &#34;sqlite&#34; and &#34;postgresql&#34;.</td>
</tr>
<tr>
<td>NGINX_SENDFILE</td>
<td>false</td>
<td>Whether enable Nginx sendfile.</td>
</tr>
<tr>
<td>SECRET_KEY_BASE</td>
<td></td>
<td>When the SECRET_KEY_BASE environment variable is not set, Black candy will generate SECRET_KEY_BASE environment variable every time when service start up. This will cause old sessions invalid, You can set your own SECRET_KEY_BASE environment variable on docker service to avoid it.</td>
</tr>
<tr>
<td>FORCE_SSL</td>
<td>false</td>
<td>Force all access to the app over SSL.</td>
</tr>
<tr>
<td>DEMO_MODE</td>
<td>false</td>
<td>Whether to enable demo mode, when demo mode is on, all users cannot access administrator privileges, even user is admin. And also users cannot change their profile.</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">The edge version of Black Candy base on master branch, which means it&#39;s not stable, you may encounter data loss or other issues. However, I don&#39;t recommend normal user using an edge version. But if you are a developer who wants to test or contribute to Black Candy, you can use the edge version.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker pull ghcr.io/blackcandy-org/blackcandy:edge"><pre>docker pull ghcr.io/blackcandy-org/blackcandy:edge</pre></div>


<ul dir="auto">
<li>Ruby 3.3</li>
<li>Node.js 20</li>
<li>libvips</li>
<li>FFmpeg</li>
</ul>
<p dir="auto">Make sure you have installed all those dependencies.</p>


<div dir="auto"><h3 tabindex="-1" dir="auto">Install JavaScript dependencies</h3><a id="user-content-install-javascript-dependencies" aria-label="Permalink: Install JavaScript dependencies" href="#install-javascript-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>


<div dir="auto" data-snippet-clipboard-copy-content="rails db:prepare
rails db:seed"><pre>rails db:prepare
rails db:seed</pre></div>

<p dir="auto">After you’ve set up everything, now you can run <code>./bin/dev</code> to start all services you need to develop.
Then visit <a href="http://localhost:3000" rel="nofollow">http://localhost:3000</a> use initial admin user to log in (email: <a href="mailto:admin@admin.com">admin@admin.com</a>, password: foobar).</p>

<div dir="auto" data-snippet-clipboard-copy-content="# Running all test
$ rails test:all 

# Running lint
$ rails lint:all"><pre><span><span>#</span> Running all test</span>
$ rails test:all 

<span><span>#</span> Running lint</span>
$ rails lint:all</pre></div>

<p dir="auto">Black Candy support get artist and album image from Discogs API. You can create an API token from Discogs and set Discogs token on Setting page to enable it.</p>

<p dir="auto">This project is supported by:</p>
<p dir="auto"><a href="https://www.digitalocean.com/" rel="nofollow"><img src="https://camo.githubusercontent.com/6fbfffc4bceb6b40e0f244330c13a2671e243a7c9e849033e20869b6445910a5/68747470733a2f2f6f70656e736f757263652e6e7963332e63646e2e6469676974616c6f6365616e7370616365732e636f6d2f6174747269627574696f6e2f6173736574732f5356472f444f5f4c6f676f5f686f72697a6f6e74616c5f626c75652e737667" width="200px" data-canonical-src="https://opensource.nyc3.cdn.digitaloceanspaces.com/attribution/assets/SVG/DO_Logo_horizontal_blue.svg"/></a>
<a href="https://www.jetbrains.com/community/opensource" rel="nofollow"><img src="https://camo.githubusercontent.com/61be5a726132ae9b0cd6c732c6b20acf80fde151b7530c9b798a7517c6d2f6dd/68747470733a2f2f7265736f75726365732e6a6574627261696e732e636f6d2f73746f726167652f70726f64756374732f636f6d70616e792f6272616e642f6c6f676f732f6a625f7371756172652e737667" data-canonical-src="https://resources.jetbrains.com/storage/products/company/brand/logos/jb_square.svg"/></a></p>
</article></div></div>
  </body>
</html>
