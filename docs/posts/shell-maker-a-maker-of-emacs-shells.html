<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://xenodium.com/a-shell-maker/">Original</a>
    <h1>Show HN: Shell-maker, a maker of Emacs shells</h1>
    
    <div id="readability-page-1" class="page"><div id="text-a-shell-maker">
<p>
A few weeks ago, I wrote about an experiment to bring <a href="https://xenodium.com/a-chatgpt-emacs-shell/">ChatGPT to Emacs as a shell</a>. I was fairly new to both <a href="https://openai.com/blog/chatgpt">ChatGPT</a> and building anything on top of <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Prompts.html">comint</a>. It was a fun exercise, which also generated some interest.
</p>

<p>
As mentioned in the previous post, I took inspiration in other Emacs packages (primarily <a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Interaction.html">ielm</a>) to figure out what I needed from comint. Soon, I got ChatGPT working.
</p>


<p><img src="https://xenodium.com/images/a-shell-maker/streamer.gif" alt="streamer.gif" width="80%"/>
</p>

<p>
As I was looking at <a href="https://openai.com">OpenAI</a> API docs, I learned about DALL-E: &#34;an AI system that can create realistic images and art from a description in natural language.&#34;
</p>

<p>
Like ChatGPT, they also offered an API to DALL-E, so I figured I may as well try to write a shell for that tooâ€¦ and I did.
</p>


<p><img src="https://xenodium.com/images/a-shell-maker/dalle.gif" alt="dalle.gif" width="60%"/>
</p>

<p>
There was quite a bit of code duplication between the two Emacs shells I had just written. At the same time, I started hearing from folks about integrating other tools, some cloud-based, some local, proprietary, open source.. There&#39;s <a href="https://about.sourcegraph.com/cody">Cody</a>, <a href="https://github.com/invoke-ai/InvokeAI">invoke-ai</a>,  <a href="https://github.com/ggerganov/llama.cpp">llama.cpp</a>, <a href="https://github.com/antimatter15/alpaca.cpp">alpaca.cpp</a>, and the list continues to grow.
</p>

<p>
With that in mind, I set out to reduce the code duplication and consolidate into a reusable package. And so <code>shell-maker</code> was born, a maker of Emacs shells.
</p>

<p>
<code>shell-maker</code>&#39;s internals aren&#39;t too different from the code I had before. It&#39;s still powered by comint, but instead offers a reusable convenience wrapper.
</p>

<p>
It takes little code to implement a shell, like the sophisticated new <code>greeter-shell</code> ;)
</p>


<p><img src="https://xenodium.com/images/a-shell-maker/maria.gif" alt="maria.gif" width="60%"/>
</p>

<div>
<pre>(<span>require</span> &#39;<span>shell-maker</span>)

(<span>defvar</span> <span>greeter-shell--config</span>
  (make-shell-maker-config
   <span>:name</span> <span>&#34;Greeter&#34;</span>
   <span>:execute-command</span>
   (<span>lambda</span> (command _history callback error-callback)
     (funcall callback
              (format <span>&#34;Hello \&#34;%s\&#34;&#34;</span> command)
              nil))))

(<span>defun</span> <span>greeter-shell</span> ()
  <span>&#34;Start a Greeter shell.&#34;</span>
  (<span>interactive</span>)
  (shell-maker-start greeter-shell--config))
</pre>
</div>

<p>
<a href="https://github.com/xenodium/chatgpt-shell#shell-maker">shell-maker</a> is available on GitHub and currently bundled with <a href="https://github.com/xenodium/chatgpt-shell">chatgpt-shell</a>. If there&#39;s enough interest and usage, I may just break it out into its own package. For now, it&#39;s convenient to keep with <code>chatgpt-shell</code> and <code>dall-e-shell</code>.
</p>

<p>
If you plug <code>shell-maker</code> into other tools, I&#39;d love to hear about it.
</p>

<p>
Happy shell making!
</p>
</div></div>
  </body>
</html>
