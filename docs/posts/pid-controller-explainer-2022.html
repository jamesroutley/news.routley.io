<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ben.bolte.cc/pid-controller">Original</a>
    <h1>PID Controller Explainer (2022)</h1>
    
    <div id="readability-page-1" class="page"><div id="blog-contents"><p>I was recently trying to explain PID controllers to someone and realized that I didn’t have a very good intuitive understanding of what they’re useful for and how they work. When looking around the web, I had trouble finding a straightforward explainer. So in this post, I’ll give (hopefully) simple answers to some basic questions that I had about PID controllers.</p><h2 id="what-is-a-pid-controller">What is a PID controller?</h2><p>A PID controller is a way to solve problems with the following formulation:</p><ul><li>You can change some input to the system, called the process variable</li><li>You have a sensor which monitors something about the system</li><li>You want the sensor measurement to be close to some target value, called the set point</li></ul><p>The PID controller is a good way to decide what the input to the system should be without knowing anything about the internal workings of the system, except that the change in output is roughly proportional to the input.</p><h3 id="example-use-cases">Example Use Cases</h3><h4 id="3d-printing">3D Printing</h4><p>When running a 3D printer, you want the nozzel end to be a specific temperature. You control the temperature by regulating the voltage through a hot end - higher voltage makes the temperature go up, whereas if you turn it off entirely the temperature will go down (sometimes helped by a fan next to the extruder). You likely want to change the temperature during the course of printing, and you want it to reach the target temperature as quickly as possible. Changing the voltage affects the <em>rate of change in temperature</em> rather than the temperature itself.</p><h4 id="vehicle-control">Vehicle Control</h4><p>When driving a car, you regulate the speed by controlling how much to open the throttle. Opening the throttle will cause the car to accelerate, while closing it will cause the car to decelerate. You want the car to reach some set speed as quickly as possible. Changing the throttle toggles the <em>acceleration</em> and not the <em>velocity</em>, but the variable you care about controlling is the <em>velocity</em>.</p><h4 id="medicine">Medicine</h4><p>When giving vasopressors to a patient in a hospital, you want them to reach some target blood pressure. After injecting a particular amount, the patient’s blood pressure will go up or down. Changing that amount will change the <em>rate of change</em> of their blood pressure. You want to reach the target blood pressure as quickly as possible without overshooting.</p><h2 id="how-do-pid-controllers-work">How do PID controllers work?</h2><p>To answer this question, I think the best way is to start off with an easy-to-understand controller, then add on top of it until we get to the final PID formulation.</p><h3 id="a-simple-controller">A Simple Controller</h3><p>You could write a control rule like this:</p><ul><li>If the sensor measurement is too low, set the system input to “positive” (try to make the sensor measurement higher)</li><li>If the sensor measurement is too high, set the system input to “negative” (try to make the sensor measurement lower)</li></ul><p>However, if the system has <em>inertia</em> (in other words, a delay between the change in input and the change in output), then this control algorithm will start oscillating as you repeatedly undershoot and overshoot. Inertia can happen in lots of different ways and is common in most systems that you would actually want to control. An improvement to this could be to scale the input relative to the <em>error</em>, so that as your error gets smaller, you decrease your input.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>error</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>target</mtext><mo>−</mo><mtext>sensor</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>input</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>K</mi><mi>p</mi></msub><mo>∗</mo><mtext>error</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} \text{error} &amp; = \text{target} - \text{sensor} \\ \text{input} &amp; = K_p * \text{error} \end{aligned} </annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>error</span></span></span></span><span><span></span><span><span><span>input</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span>target</span></span><span></span><span>−</span><span></span><span><span>sensor</span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>∗</span><span></span><span><span>error</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>In this case, we introduce an additional scaling constant <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, which relates the size of the error to the size of the input. For example, in the case of our 3D printer, our error is the difference between the target temperature and the observed temperature, while our input is the voltage, so we need to convert from degrees celcius to volts somehow.</p><p>We can try these out with some sample numbers to demonstrate the idea. Suppose our target temperature is <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>200</mn><mi>deg</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">200 \deg</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>0</span><span>0</span><span></span><span>de<span>g</span></span></span></span></span> and our current temperature is <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>175</mn><mi>deg</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">175 \deg</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span>7</span><span>5</span><span></span><span>de<span>g</span></span></span></span></span>. We can use some scaling constant <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub><mo>=</mo><mn>0.1</mn><mi>V</mi><mi mathvariant="normal">/</mi><mi>deg</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">K_p = 0.1 V / \deg</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span><span>.</span><span>1</span><span>V</span><span>/</span><span></span><span>de<span>g</span></span></span></span></span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>error</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>200</mn><mi>deg</mi><mo>⁡</mo><mo>−</mo><mn>175</mn><mi>deg</mi><mo>⁡</mo><mo>=</mo><mn>25</mn><mi>deg</mi><mo>⁡</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>input</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mn>0.1</mn><mi>V</mi><mi mathvariant="normal">/</mi><mi>deg</mi><mo>⁡</mo><mo stretchy="false">)</mo><mo>∗</mo><mn>25</mn><mi>deg</mi><mo>⁡</mo><mo>=</mo><mn>2.5</mn><mi>V</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} \text{error} &amp; = 200 \deg - 175 \deg = 25 \deg \\ \text{input} &amp;= (0.1 V / \deg) * 25 \deg = 2.5 V \end{aligned} </annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>error</span></span></span></span><span><span></span><span><span><span>input</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>2</span><span>0</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>−</span><span>1</span><span>7</span><span>5</span><span></span><span>de<span>g</span></span><span></span><span>=</span><span></span><span>2</span><span>5</span><span></span><span>de<span>g</span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>(</span><span>0</span><span>.</span><span>1</span><span>V</span><span>/</span><span></span><span>de<span>g</span></span><span>)</span><span></span><span>∗</span><span></span><span>2</span><span>5</span><span></span><span>de<span>g</span></span><span></span><span>=</span><span></span><span>2</span><span>.</span><span>5</span><span>V</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>After some time, the temperature increases to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>190</mn><mi>deg</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">190 \deg</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span><span>9</span><span>0</span><span></span><span>de<span>g</span></span></span></span></span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>error</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>200</mn><mi>deg</mi><mo>⁡</mo><mo>−</mo><mn>190</mn><mi>deg</mi><mo>⁡</mo><mo>=</mo><mn>10</mn><mi>deg</mi><mo>⁡</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>input</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mn>0.1</mn><mi>V</mi><mi mathvariant="normal">/</mi><mi>deg</mi><mo>⁡</mo><mo stretchy="false">)</mo><mo>∗</mo><mn>10</mn><mi>deg</mi><mo>⁡</mo><mo>=</mo><mn>1</mn><mi>V</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} \text{error} &amp; = 200 \deg - 190 \deg = 10 \deg \\ \text{input} &amp;= (0.1 V / \deg) * 10 \deg = 1 V \end{aligned} </annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>error</span></span></span></span><span><span></span><span><span><span>input</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>2</span><span>0</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>−</span><span>1</span><span>9</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>=</span><span></span><span>1</span><span>0</span><span></span><span>de<span>g</span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>(</span><span>0</span><span>.</span><span>1</span><span>V</span><span>/</span><span></span><span>de<span>g</span></span><span>)</span><span></span><span>∗</span><span></span><span>1</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>=</span><span></span><span>1</span><span>V</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>As expected, our input is smaller than when the error was larger, since we want to make the temperature delta smaller as we get closer to our target temperature.</p><p>Let’s say sometime later the system has gotten hotter, and now our temperature reading is <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>240</mn><mi>deg</mi><mo>⁡</mo></mrow><annotation encoding="application/x-tex">240 \deg</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>4</span><span>0</span><span></span><span>de<span>g</span></span></span></span></span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>error</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mn>200</mn><mi>deg</mi><mo>⁡</mo><mo>−</mo><mn>240</mn><mi>deg</mi><mo>⁡</mo><mo>=</mo><mo>−</mo><mn>40</mn><mi>deg</mi><mo>⁡</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>input</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mn>0.1</mn><mi>V</mi><mi mathvariant="normal">/</mi><mi>deg</mi><mo>⁡</mo><mo stretchy="false">)</mo><mo>∗</mo><mo>−</mo><mn>40</mn><mi>deg</mi><mo>⁡</mo><mo>=</mo><mo>−</mo><mn>4</mn><mi>V</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} \text{error} &amp; = 200 \deg - 240 \deg = -40 \deg \\ \text{input} &amp;= (0.1 V / \deg) * -40 \deg = -4 V \end{aligned} </annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>error</span></span></span></span><span><span></span><span><span><span>input</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>2</span><span>0</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>−</span><span>2</span><span>4</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>=</span><span></span><span>−</span><span>4</span><span>0</span><span></span><span>de<span>g</span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>(</span><span>0</span><span>.</span><span>1</span><span>V</span><span>/</span><span></span><span>de<span>g</span></span><span>)</span><span></span><span>∗</span><span></span><span>−</span><span>4</span><span>0</span><span></span><span>de<span>g</span></span><span></span><span>=</span><span></span><span>−</span><span>4</span><span>V</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>As expected, now that we’ve overshot our target temperature, we need to supply an input in the opposite direction. Note that the input voltage is relative to some zero point, since we can’t actually have a negative input voltage.</p><h3 id="using-this-controller">Using this Controller</h3><p>Here’s a simple program to simulate a 3D printer nozzel. Note that the heater simulator is only a very loose approximation to the behavior of the actual heater, and can stand in for any black box system that you might want to use a PID controller for.</p><div><div><pre><code><span>import</span> <span>argparse</span>

<span>import</span> <span>matplotlib.pyplot</span> <span>as</span> <span>plt</span>

<span>class</span> <span>SimpleController</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>trg_temp</span><span>:</span> <span>float</span><span>,</span> <span>kp</span><span>:</span> <span>float</span><span>,</span> <span>v_offset</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes a simple controller.

        Args:
            trg_temp: The target temperature
            kp: The P scaling constant
            v_offset: The zero point voltage
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>trg_temp</span> <span>=</span> <span>trg_temp</span>
        <span>self</span><span>.</span><span>kp</span> <span>=</span> <span>kp</span>
        <span>self</span><span>.</span><span>v_offset</span> <span>=</span> <span>v_offset</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>temperature</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span>&#34;&#34;&#34;Gets the target voltage for the current timestep.

        Args:
            temperature: The last observed temperature

        Returns:
            The input voltage for the next timestep
        &#34;&#34;&#34;</span>

        <span>error</span> <span>=</span> <span>self</span><span>.</span><span>trg_temp</span> <span>-</span> <span>temperature</span>
        <span>return</span> <span>self</span><span>.</span><span>kp</span> <span>*</span> <span>error</span> <span>+</span> <span>self</span><span>.</span><span>v_offset</span>

<span>class</span> <span>HeaterSimulator</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span>
        <span>self</span><span>,</span>
        <span>dt</span><span>:</span> <span>float</span><span>,</span>
        <span>amb_temp</span><span>:</span> <span>float</span><span>,</span>
        <span>min_voltage</span><span>:</span> <span>float</span><span>,</span>
        <span>max_voltage</span><span>:</span> <span>float</span><span>,</span>
        <span>heat_coeff</span><span>:</span> <span>float</span><span>,</span>
        <span>area</span><span>:</span> <span>float</span><span>,</span>
        <span>voltage_coeff</span><span>:</span> <span>float</span><span>,</span>
        <span>inertia</span><span>:</span> <span>float</span><span>,</span>
    <span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes the heater simulator.

        Args:
            dt: The timestep size, in seconds
            amb_temp: The ambient temperature
            min_voltage: The minimum input voltage
            max_voltage: The maximum input voltage
            heat_coeff: Heat transfer coefficient
            area: Heater surface area
            voltage_coeff: The voltage-to-temperature-delta coefficient
            inertia: System inertia
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>dt</span> <span>=</span> <span>dt</span>
        <span>self</span><span>.</span><span>amb_temp</span> <span>=</span> <span>amb_temp</span>
        <span>self</span><span>.</span><span>min_voltage</span> <span>=</span> <span>min_voltage</span>
        <span>self</span><span>.</span><span>max_voltage</span> <span>=</span> <span>max_voltage</span>
        <span>self</span><span>.</span><span>heat_coeff</span> <span>=</span> <span>heat_coeff</span>
        <span>self</span><span>.</span><span>area</span> <span>=</span> <span>area</span>
        <span>self</span><span>.</span><span>voltage_coeff</span> <span>=</span> <span>voltage_coeff</span>
        <span>self</span><span>.</span><span>inertia</span> <span>=</span> <span>inertia</span>

        <span># Heater temperatures starts at the ambient temperature.
</span>        <span>self</span><span>.</span><span>temperature</span> <span>=</span> <span>amb_temp</span>

        <span># Add some inertia to dtemp.
</span>        <span>self</span><span>.</span><span>dtemp</span> <span>=</span> <span>0.0</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>voltage</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Runs the simulator for one step.

        Args:
            voltage: The input voltage
        &#34;&#34;&#34;</span>

        <span>q_rate</span> <span>=</span> <span>self</span><span>.</span><span>heat_coeff</span> <span>*</span> <span>self</span><span>.</span><span>area</span> <span>*</span> <span>(</span><span>self</span><span>.</span><span>amb_temp</span> <span>-</span> <span>self</span><span>.</span><span>temperature</span><span>)</span>
        <span>v_rate</span> <span>=</span> <span>self</span><span>.</span><span>voltage_coeff</span> <span>*</span> <span>voltage</span>
        <span>trg_dtemp</span> <span>=</span> <span>q_rate</span> <span>+</span> <span>v_rate</span>

        <span>self</span><span>.</span><span>dtemp</span> <span>=</span> <span>self</span><span>.</span><span>inertia</span> <span>*</span> <span>self</span><span>.</span><span>dtemp</span> <span>+</span> <span>(</span><span>1</span> <span>-</span> <span>self</span><span>.</span><span>inertia</span><span>)</span> <span>*</span> <span>trg_dtemp</span>
        <span>self</span><span>.</span><span>temperature</span> <span>+=</span> <span>self</span><span>.</span><span>dtemp</span> <span>*</span> <span>self</span><span>.</span><span>dt</span>

<span>def</span> <span>main</span><span>()</span> <span>-&gt;</span> <span>None</span><span>:</span>
    <span>parser</span> <span>=</span> <span>argparse</span><span>.</span><span>ArgumentParser</span><span>(</span><span>description</span><span>=</span><span>&#34;Heater PID simulation&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--kp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;P scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--dt&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.01</span><span>,</span> <span>help</span><span>=</span><span>&#34;Timestep size&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--total-steps&#34;</span><span>,</span> <span>type</span><span>=</span><span>int</span><span>,</span> <span>default</span><span>=</span><span>10000</span><span>,</span> <span>help</span><span>=</span><span>&#34;Number of simulation steps&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--amb-temp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>20.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Ambient temperature&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--trg-temp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>210.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Target temperature&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--v-offset&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>3.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Offset voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--min-voltage&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Minimum voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--max-voltage&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>24.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Maximum voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--area&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>1e-4</span><span>,</span> <span>help</span><span>=</span><span>&#34;Surface area of the heater&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--heat-coeff&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>100.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Heat transfer coefficient&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--voltage-coeff&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>1.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Voltage coefficient&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--inertia&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.99</span><span>,</span> <span>help</span><span>=</span><span>&#34;System inertia&#34;</span><span>)</span>
    <span>args</span> <span>=</span> <span>parser</span><span>.</span><span>parse_args</span><span>()</span>

    <span># Plots the simulated temperatures.
</span>    <span>plt</span><span>.</span><span>figure</span><span>()</span>

    <span>for</span> <span>kp</span> <span>in</span> <span>args</span><span>.</span><span>kp</span><span>:</span>
        <span># Simulator.
</span>        <span>simulator</span> <span>=</span> <span>HeaterSimulator</span><span>(</span>
            <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
            <span>amb_temp</span><span>=</span><span>args</span><span>.</span><span>amb_temp</span><span>,</span>
            <span>min_voltage</span><span>=</span><span>args</span><span>.</span><span>min_voltage</span><span>,</span>
            <span>max_voltage</span><span>=</span><span>args</span><span>.</span><span>max_voltage</span><span>,</span>
            <span>heat_coeff</span><span>=</span><span>args</span><span>.</span><span>heat_coeff</span><span>,</span>
            <span>area</span><span>=</span><span>args</span><span>.</span><span>area</span><span>,</span>
            <span>voltage_coeff</span><span>=</span><span>args</span><span>.</span><span>voltage_coeff</span><span>,</span>
            <span>inertia</span><span>=</span><span>args</span><span>.</span><span>inertia</span><span>,</span>
        <span>)</span>

        <span># Controller.
</span>        <span>controller</span> <span>=</span> <span>SimpleController</span><span>(</span>
            <span>trg_temp</span><span>=</span><span>args</span><span>.</span><span>trg_temp</span><span>,</span>
            <span>kp</span><span>=</span><span>kp</span><span>,</span>
            <span>v_offset</span><span>=</span><span>args</span><span>.</span><span>v_offset</span><span>,</span>
        <span>)</span>

        <span># Heater starts at ambient temperature.
</span>        <span>temperatures</span> <span>=</span> <span>[</span><span>simulator</span><span>.</span><span>temperature</span><span>]</span>
        <span>voltages</span> <span>=</span> <span>[</span><span>0.0</span><span>]</span>
        <span>times</span> <span>=</span> <span>[</span><span>i</span> <span>*</span> <span>args</span><span>.</span><span>dt</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>args</span><span>.</span><span>total_steps</span> <span>+</span> <span>1</span><span>)]</span>

        <span>for</span> <span>_</span> <span>in</span> <span>times</span><span>:</span>
            <span>voltage</span> <span>=</span> <span>controller</span><span>.</span><span>step</span><span>(</span><span>simulator</span><span>.</span><span>temperature</span><span>)</span>
            <span>voltages</span><span>.</span><span>append</span><span>(</span><span>voltage</span><span>)</span>
            <span>simulator</span><span>.</span><span>step</span><span>(</span><span>voltage</span><span>)</span>
            <span>temperatures</span><span>.</span><span>append</span><span>(</span><span>simulator</span><span>.</span><span>temperature</span><span>)</span>

        <span>times</span> <span>=</span> <span>[</span><span>0.0</span><span>]</span> <span>+</span> <span>times</span>

        <span># Plot temperature.
</span>        <span>plt</span><span>.</span><span>plot</span><span>(</span><span>times</span><span>,</span> <span>temperatures</span><span>,</span> <span>label</span><span>=</span><span>f</span><span>&#34;Kp = </span><span>{</span><span>kp</span><span>:</span><span>.</span><span>4</span><span>g</span><span>}</span><span>&#34;</span><span>)</span>
        <span>plt</span><span>.</span><span>ylabel</span><span>(</span><span>&#34;Temperature&#34;</span><span>)</span>

        <span># Plot voltages.
</span>        <span># plt.plot(times, voltages, label=f&#34;Kp = {kp:.4g}&#34;)
</span>        <span># plt.ylabel(&#34;Voltage&#34;)
</span>
    <span>plt</span><span>.</span><span>xlabel</span><span>(</span><span>&#34;Time&#34;</span><span>)</span>
    <span>plt</span><span>.</span><span>legend</span><span>()</span>
    <span>plt</span><span>.</span><span>show</span><span>()</span>

<span>if</span> <span>__name__</span> <span>==</span> <span>&#34;__main__&#34;</span><span>:</span>
    <span>main</span><span>()</span>
</code></pre></div></div><p>Here is just the controller, without the boilerplate for running it.</p><div><div><pre><code><span>class</span> <span>SimpleController</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span><span>self</span><span>,</span> <span>trg_temp</span><span>:</span> <span>float</span><span>,</span> <span>kp</span><span>:</span> <span>float</span><span>,</span> <span>v_offset</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes a simple controller.

        Args:
            trg_temp: The target temperature
            kp: The P scaling constant
            v_offset: The zero point voltage
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>trg_temp</span> <span>=</span> <span>trg_temp</span>
        <span>self</span><span>.</span><span>kp</span> <span>=</span> <span>kp</span>
        <span>self</span><span>.</span><span>v_offset</span> <span>=</span> <span>v_offset</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>temperature</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span>&#34;&#34;&#34;Gets the target voltage for the current timestep.

        Args:
            temperature: The last observed temperature

        Returns:
            The input voltage for the next timestep
        &#34;&#34;&#34;</span>

        <span>error</span> <span>=</span> <span>self</span><span>.</span><span>trg_temp</span> <span>-</span> <span>temperature</span>
        <span>return</span> <span>self</span><span>.</span><span>kp</span> <span>*</span> <span>error</span> <span>+</span> <span>self</span><span>.</span><span>v_offset</span>
</code></pre></div></div><p>We can run this script using:</p><div><div><pre><code>python simulator.py <span>--kp</span> 0.05 0.1 0.2 0.4 0.8
</code></pre></div></div><p>You can try running this script yourself to see how playing with different parts of the system affect the temperature curves. In particular, <code>--v-offset</code> and <code>--inertia</code> are interesting parameters to play with.</p><p>The resulting temperature curves for the built-in configuration are as follows:</p><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="460.8pt" height="345.6pt" viewBox="0 0 460.8 345.6" version="1.1"><metadata> <rdf:rdf xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <cc:work> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type> <dc:date>2022-09-30T16:00:16.408020</dc:date> <dc:format>image/svg+xml</dc:format> <dc:creator> <cc:agent> <dc:title>Matplotlib v3.5.3, https://matplotlib.org/</dc:title> </cc:agent> </dc:creator> </cc:work> </rdf:rdf> </metadata> <defs></defs> <g id="figure_1"> <g id="patch_1"><path d="M 0 345.6 L 460.8 345.6 L 460.8 0 L 0 0 z "></path> </g> <g id="axes_1"> <g id="patch_2"><path d="M 57.6 307.584 L 414.72 307.584 L 414.72 41.472 L 57.6 41.472 z "></path> </g> <g id="matplotlib.axis_1"> <g id="xtick_1"> <g id="line2d_1"> <defs><path id="mca2dc301dc" d="M 0 0 L 0 3.5 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#mca2dc301dc" x="73.832727" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_1"> <g transform="translate(70.651477 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-30" d="M 2034 4250 Q 1547 4250 1301 3770 Q 1056 3291 1056 2328 Q 1056 1369 1301 889 Q 1547 409 2034 409 Q 2525 409 2770 889 Q 3016 1369 3016 2328 Q 3016 3291 2770 3770 Q 2525 4250 2034 4250 z M 2034 4750 Q 2819 4750 3233 4129 Q 3647 3509 3647 2328 Q 3647 1150 3233 529 Q 2819 -91 2034 -91 Q 1250 -91 836 529 Q 422 1150 422 2328 Q 422 3509 836 4129 Q 1250 4750 2034 4750 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-30"></use> </g> </g> </g> <g id="xtick_2"> <g id="line2d_2"> <g> <use xlink:href="#mca2dc301dc" x="138.763636" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_2"> <g transform="translate(132.401136 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-32" d="M 1228 531 L 3431 531 L 3431 0 L 469 0 L 469 531 Q 828 903 1448 1529 Q 2069 2156 2228 2338 Q 2531 2678 2651 2914 Q 2772 3150 2772 3378 Q 2772 3750 2511 3984 Q 2250 4219 1831 4219 Q 1534 4219 1204 4116 Q 875 4013 500 3803 L 500 4441 Q 881 4594 1212 4672 Q 1544 4750 1819 4750 Q 2544 4750 2975 4387 Q 3406 4025 3406 3419 Q 3406 3131 3298 2873 Q 3191 2616 2906 2266 Q 2828 2175 2409 1742 Q 1991 1309 1228 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_3"> <g id="line2d_3"> <g> <use xlink:href="#mca2dc301dc" x="203.694545" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_3"> <g transform="translate(197.332045 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-34" d="M 2419 4116 L 825 1625 L 2419 1625 L 2419 4116 z M 2253 4666 L 3047 4666 L 3047 1625 L 3713 1625 L 3713 1100 L 3047 1100 L 3047 0 L 2419 0 L 2419 1100 L 313 1100 L 313 1709 L 2253 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-34"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_4"> <g id="line2d_4"> <g> <use xlink:href="#mca2dc301dc" x="268.625455" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_4"> <g transform="translate(262.262955 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-36" d="M 2113 2584 Q 1688 2584 1439 2293 Q 1191 2003 1191 1497 Q 1191 994 1439 701 Q 1688 409 2113 409 Q 2538 409 2786 701 Q 3034 994 3034 1497 Q 3034 2003 2786 2293 Q 2538 2584 2113 2584 z M 3366 4563 L 3366 3988 Q 3128 4100 2886 4159 Q 2644 4219 2406 4219 Q 1781 4219 1451 3797 Q 1122 3375 1075 2522 Q 1259 2794 1537 2939 Q 1816 3084 2150 3084 Q 2853 3084 3261 2657 Q 3669 2231 3669 1497 Q 3669 778 3244 343 Q 2819 -91 2113 -91 Q 1303 -91 875 529 Q 447 1150 447 2328 Q 447 3434 972 4092 Q 1497 4750 2381 4750 Q 2619 4750 2861 4703 Q 3103 4656 3366 4563 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-36"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_5"> <g id="line2d_5"> <g> <use xlink:href="#mca2dc301dc" x="333.556364" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_5"> <g transform="translate(327.193864 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-38" d="M 2034 2216 Q 1584 2216 1326 1975 Q 1069 1734 1069 1313 Q 1069 891 1326 650 Q 1584 409 2034 409 Q 2484 409 2743 651 Q 3003 894 3003 1313 Q 3003 1734 2745 1975 Q 2488 2216 2034 2216 z M 1403 2484 Q 997 2584 770 2862 Q 544 3141 544 3541 Q 544 4100 942 4425 Q 1341 4750 2034 4750 Q 2731 4750 3128 4425 Q 3525 4100 3525 3541 Q 3525 3141 3298 2862 Q 3072 2584 2669 2484 Q 3125 2378 3379 2068 Q 3634 1759 3634 1313 Q 3634 634 3220 271 Q 2806 -91 2034 -91 Q 1263 -91 848 271 Q 434 634 434 1313 Q 434 1759 690 2068 Q 947 2378 1403 2484 z M 1172 3481 Q 1172 3119 1398 2916 Q 1625 2713 2034 2713 Q 2441 2713 2670 2916 Q 2900 3119 2900 3481 Q 2900 3844 2670 4047 Q 2441 4250 2034 4250 Q 1625 4250 1398 4047 Q 1172 3844 1172 3481 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-38"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_6"> <g id="line2d_6"> <g> <use xlink:href="#mca2dc301dc" x="398.487273" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_6"> <g transform="translate(388.943523 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-31" d="M 794 531 L 1825 531 L 1825 4091 L 703 3866 L 703 4441 L 1819 4666 L 2450 4666 L 2450 531 L 3481 531 L 3481 0 L 794 0 L 794 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="text_7"> <g transform="translate(223.926406 335.860562)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-54" d="M -19 4666 L 3928 4666 L 3928 4134 L 2272 4134 L 2272 0 L 1638 0 L 1638 4134 L -19 4134 L -19 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-69" d="M 603 3500 L 1178 3500 L 1178 0 L 603 0 L 603 3500 z M 603 4863 L 1178 4863 L 1178 4134 L 603 4134 L 603 4863 z " transform="scale(0.015625)"></path><path id="DejaVuSans-6d" d="M 3328 2828 Q 3544 3216 3844 3400 Q 4144 3584 4550 3584 Q 5097 3584 5394 3201 Q 5691 2819 5691 2113 L 5691 0 L 5113 0 L 5113 2094 Q 5113 2597 4934 2840 Q 4756 3084 4391 3084 Q 3944 3084 3684 2787 Q 3425 2491 3425 1978 L 3425 0 L 2847 0 L 2847 2094 Q 2847 2600 2669 2842 Q 2491 3084 2119 3084 Q 1678 3084 1418 2786 Q 1159 2488 1159 1978 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1356 3278 1631 3431 Q 1906 3584 2284 3584 Q 2666 3584 2933 3390 Q 3200 3197 3328 2828 z " transform="scale(0.015625)"></path><path id="DejaVuSans-65" d="M 3597 1894 L 3597 1613 L 953 1613 Q 991 1019 1311 708 Q 1631 397 2203 397 Q 2534 397 2845 478 Q 3156 559 3463 722 L 3463 178 Q 3153 47 2828 -22 Q 2503 -91 2169 -91 Q 1331 -91 842 396 Q 353 884 353 1716 Q 353 2575 817 3079 Q 1281 3584 2069 3584 Q 2775 3584 3186 3129 Q 3597 2675 3597 1894 z M 3022 2063 Q 3016 2534 2758 2815 Q 2500 3097 2075 3097 Q 1594 3097 1305 2825 Q 1016 2553 972 2059 L 3022 2063 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-69" x="57.958984"></use> <use xlink:href="#DejaVuSans-6d" x="85.742188"></use> <use xlink:href="#DejaVuSans-65" x="183.154297"></use> </g> </g> </g> <g id="matplotlib.axis_2"> <g id="ytick_1"> <g id="line2d_7"> <defs><path id="m08ca613f5d" d="M 0 0 L -3.5 0 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="289.545679" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_8"> <g transform="translate(37.875 293.344898)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-35" d="M 691 4666 L 3169 4666 L 3169 4134 L 1269 4134 L 1269 2991 Q 1406 3038 1543 3061 Q 1681 3084 1819 3084 Q 2600 3084 3056 2656 Q 3513 2228 3513 1497 Q 3513 744 3044 326 Q 2575 -91 1722 -91 Q 1428 -91 1123 -41 Q 819 9 494 109 L 494 744 Q 775 591 1075 516 Q 1375 441 1709 441 Q 2250 441 2565 725 Q 2881 1009 2881 1497 Q 2881 1984 2565 2268 Q 2250 2553 1709 2553 Q 1456 2553 1204 2497 Q 953 2441 691 2322 L 691 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> </g> </g> </g> <g id="ytick_2"> <g id="line2d_8"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="259.834075" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_9"> <g transform="translate(37.875 263.633294)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-35"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="ytick_3"> <g id="line2d_9"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="230.122471" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_10"> <g transform="translate(37.875 233.92169)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-37" d="M 525 4666 L 3525 4666 L 3525 4397 L 1831 0 L 1172 0 L 2766 4134 L 525 4134 L 525 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-37"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> </g> </g> </g> <g id="ytick_4"> <g id="line2d_10"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="200.410867" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_11"> <g transform="translate(31.5125 204.210086)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_5"> <g id="line2d_11"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="170.699263" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_12"> <g transform="translate(31.5125 174.498482)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-32" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="127.246094"></use> </g> </g> </g> <g id="ytick_6"> <g id="line2d_12"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="140.987659" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_13"> <g transform="translate(31.5125 144.786878)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_7"> <g id="line2d_13"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="111.276055" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_14"> <g transform="translate(31.5125 115.075274)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-37" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="127.246094"></use> </g> </g> </g> <g id="ytick_8"> <g id="line2d_14"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="81.564451" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_15"> <g transform="translate(31.5125 85.36367)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_9"> <g id="line2d_15"> <g> <use xlink:href="#m08ca613f5d" x="57.6" y="51.852847" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_16"> <g transform="translate(31.5125 55.652066)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-32" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="127.246094"></use> </g> </g> </g> <g id="text_17"> <g transform="translate(25.432812 206.197531)rotate(-90)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-70" d="M 1159 525 L 1159 -1331 L 581 -1331 L 581 3500 L 1159 3500 L 1159 2969 Q 1341 3281 1617 3432 Q 1894 3584 2278 3584 Q 2916 3584 3314 3078 Q 3713 2572 3713 1747 Q 3713 922 3314 415 Q 2916 -91 2278 -91 Q 1894 -91 1617 61 Q 1341 213 1159 525 z M 3116 1747 Q 3116 2381 2855 2742 Q 2594 3103 2138 3103 Q 1681 3103 1420 2742 Q 1159 2381 1159 1747 Q 1159 1113 1420 752 Q 1681 391 2138 391 Q 2594 391 2855 752 Q 3116 1113 3116 1747 z " transform="scale(0.015625)"></path><path id="DejaVuSans-72" d="M 2631 2963 Q 2534 3019 2420 3045 Q 2306 3072 2169 3072 Q 1681 3072 1420 2755 Q 1159 2438 1159 1844 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1341 3275 1631 3429 Q 1922 3584 2338 3584 Q 2397 3584 2469 3576 Q 2541 3569 2628 3553 L 2631 2963 z " transform="scale(0.015625)"></path><path id="DejaVuSans-61" d="M 2194 1759 Q 1497 1759 1228 1600 Q 959 1441 959 1056 Q 959 750 1161 570 Q 1363 391 1709 391 Q 2188 391 2477 730 Q 2766 1069 2766 1631 L 2766 1759 L 2194 1759 z M 3341 1997 L 3341 0 L 2766 0 L 2766 531 Q 2569 213 2275 61 Q 1981 -91 1556 -91 Q 1019 -91 701 211 Q 384 513 384 1019 Q 384 1609 779 1909 Q 1175 2209 1959 2209 L 2766 2209 L 2766 2266 Q 2766 2663 2505 2880 Q 2244 3097 1772 3097 Q 1472 3097 1187 3025 Q 903 2953 641 2809 L 641 3341 Q 956 3463 1253 3523 Q 1550 3584 1831 3584 Q 2591 3584 2966 3190 Q 3341 2797 3341 1997 z " transform="scale(0.015625)"></path><path id="DejaVuSans-74" d="M 1172 4494 L 1172 3500 L 2356 3500 L 2356 3053 L 1172 3053 L 1172 1153 Q 1172 725 1289 603 Q 1406 481 1766 481 L 2356 481 L 2356 0 L 1766 0 Q 1100 0 847 248 Q 594 497 594 1153 L 594 3053 L 172 3053 L 172 3500 L 594 3500 L 594 4494 L 1172 4494 z " transform="scale(0.015625)"></path><path id="DejaVuSans-75" d="M 544 1381 L 544 3500 L 1119 3500 L 1119 1403 Q 1119 906 1312 657 Q 1506 409 1894 409 Q 2359 409 2629 706 Q 2900 1003 2900 1516 L 2900 3500 L 3475 3500 L 3475 0 L 2900 0 L 2900 538 Q 2691 219 2414 64 Q 2138 -91 1772 -91 Q 1169 -91 856 284 Q 544 659 544 1381 z M 1991 3584 L 1991 3584 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-65" x="44.083984"></use> <use xlink:href="#DejaVuSans-6d" x="105.607422"></use> <use xlink:href="#DejaVuSans-70" x="203.019531"></use> <use xlink:href="#DejaVuSans-65" x="266.496094"></use> <use xlink:href="#DejaVuSans-72" x="328.019531"></use> <use xlink:href="#DejaVuSans-61" x="369.132812"></use> <use xlink:href="#DejaVuSans-74" x="430.412109"></use> <use xlink:href="#DejaVuSans-75" x="469.621094"></use> <use xlink:href="#DejaVuSans-72" x="533"></use> <use xlink:href="#DejaVuSans-65" x="571.863281"></use> </g> </g> </g> <g id="line2d_16"><path d="M 73.832727 295.488 L 74.254778 295.363282 L 74.74176 294.958079 L 75.326138 294.155582 L 76.072844 292.715701 L 77.014342 290.380899 L 78.248029 286.686793 L 79.968698 280.770614 L 82.825658 270.028056 L 89.675869 244.124534 L 93.409396 230.989374 L 96.980596 219.234674 L 100.486865 208.450853 L 103.993135 198.380486 L 107.499404 188.980768 L 111.005673 180.208626 L 114.544407 171.949554 L 118.083142 164.247592 L 121.654342 157.001638 L 125.258007 150.189651 L 128.894138 143.790273 L 132.562735 137.782846 L 136.263796 132.147419 L 139.997324 126.864749 L 143.795782 121.875223 L 147.626705 117.208048 L 151.52256 112.81024 L 155.483345 108.672709 L 159.509062 104.786083 L 163.632175 101.113 L 167.852684 97.650327 L 172.170589 94.394015 L 176.618356 91.317712 L 181.195985 88.421377 L 185.935942 85.68577 L 190.838225 83.113257 L 195.935302 80.689817 L 201.259636 78.405681 L 206.811229 76.266378 L 212.655011 74.253922 L 218.823447 72.36704 L 225.349004 70.605847 L 232.296611 68.964077 L 239.698735 67.445734 L 247.652771 66.043447 L 256.256116 64.755138 L 265.638633 63.578414 L 275.930182 62.515177 L 287.358022 61.561969 L 300.214342 60.717679 L 314.856262 59.984098 L 331.900625 59.358718 L 352.288931 58.840668 L 377.57952 58.429781 L 398.487273 58.215186 L 398.487273 58.215186 " clip-path="url(#pef3ce7175f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_17"><path d="M 73.832727 295.488 L 74.157382 295.354782 L 74.546967 294.89891 L 75.033949 293.928744 L 75.650793 292.155452 L 76.462429 289.07061 L 77.501324 284.181655 L 78.929804 276.305284 L 81.202385 262.363895 L 87.046167 226.15259 L 89.838196 210.455865 L 92.467898 196.924211 L 95.000204 185.034602 L 97.500044 174.339591 L 99.999884 164.607453 L 102.499724 155.761137 L 104.999564 147.724902 L 107.499404 140.427044 L 109.999244 133.80098 L 112.531549 127.711147 L 115.063855 122.189764 L 117.628625 117.122894 L 120.225862 112.479796 L 122.855564 108.231081 L 125.517731 104.34875 L 128.212364 100.806203 L 130.971927 97.541826 L 133.796422 94.542994 L 136.685847 91.796477 L 139.672669 89.262632 L 142.756887 86.936268 L 145.970967 84.790185 L 149.314909 82.823556 L 152.853644 81.001891 L 156.587171 79.332252 L 160.547956 77.805996 L 164.800931 76.40792 L 169.37856 75.139404 L 174.37824 73.98816 L 179.864902 72.956616 L 185.968407 72.03937 L 192.851084 71.234489 L 200.740189 70.540772 L 210.025309 69.954409 L 221.258356 69.476427 L 235.44576 69.105682 L 254.665309 68.839908 L 284.208873 68.675993 L 345.049135 68.606648 L 398.487273 68.600304 L 398.487273 68.600304 " clip-path="url(#pef3ce7175f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_18"><path d="M 73.832727 295.488 L 74.059985 295.360795 L 74.352175 294.888363 L 74.74176 293.767475 L 75.261207 291.506745 L 75.942982 287.428614 L 76.852015 280.466216 L 78.085702 269.094396 L 80.066095 248.439879 L 84.319069 203.802341 L 86.429324 184.178891 L 88.344785 168.357894 L 90.162851 155.120201 L 91.915985 143.922132 L 93.636655 134.315524 L 95.357324 125.952787 L 97.045527 118.830023 L 98.733731 112.657474 L 100.421935 107.321432 L 102.110138 102.717467 L 103.798342 98.75127 L 105.486545 95.338705 L 107.207215 92.353232 L 108.960349 89.752069 L 110.745949 87.494687 L 112.59648 85.511152 L 114.511942 83.781459 L 116.5248 82.261994 L 118.66752 80.924202 L 120.972567 79.750018 L 123.472407 78.72811 L 126.231971 77.841586 L 129.348655 77.076667 L 132.95232 76.426548 L 137.23776 75.887679 L 142.497164 75.459994 L 149.347375 75.138773 L 159.087011 74.922348 L 175.709324 74.805508 L 223.888058 74.77361 L 398.487273 74.773227 L 398.487273 74.773227 " clip-path="url(#pef3ce7175f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_19"><path d="M 73.832727 295.488 L 73.995055 295.35608 L 74.222313 294.817966 L 74.546967 293.38673 L 75.001484 290.212567 L 75.585862 284.423643 L 76.365033 274.341014 L 77.468858 256.850305 L 79.416785 221.694768 L 82.046487 175.198544 L 83.66976 150.414924 L 85.09824 131.892311 L 86.396858 117.810287 L 87.630545 106.766442 L 88.799302 98.239254 L 89.903127 91.740786 L 90.974487 86.70911 L 92.013382 82.874503 L 92.987345 80.083605 L 93.928844 78.016809 L 94.837876 76.520043 L 95.746909 75.434382 L 96.655942 74.689478 L 97.564975 74.222668 L 98.538938 73.968661 L 99.642764 73.916823 L 100.973847 74.091595 L 102.726982 74.562982 L 111.492655 77.237094 L 114.349615 77.700849 L 117.628625 77.998998 L 121.8816 78.14705 L 129.446051 78.146059 L 155.158691 78.084889 L 398.487273 78.086019 L 398.487273 78.086019 " clip-path="url(#pef3ce7175f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_20"><path d="M 73.832727 295.488 L 73.962589 295.315055 L 74.157382 294.556063 L 74.449571 292.36749 L 74.871622 287.207403 L 75.423535 277.435265 L 76.202705 259.155492 L 77.371462 225.654911 L 80.553076 131.98502 L 81.721833 105.047171 L 82.728262 86.620971 L 83.637295 73.831843 L 84.448931 65.352166 L 85.163171 59.993445 L 85.81248 56.655767 L 86.364393 54.83885 L 86.851375 53.92368 L 87.24096 53.603649 L 87.565615 53.587122 L 87.922735 53.804319 L 88.344785 54.3419 L 88.896698 55.433843 L 89.643404 57.458954 L 90.714764 61.082029 L 94.545687 74.603905 L 95.681978 77.574247 L 96.688407 79.624774 L 97.629905 81.056195 L 98.506473 81.996095 L 99.350575 82.582346 L 100.194676 82.899835 L 101.071244 82.99492 L 102.077673 82.87575 L 103.343825 82.488016 L 105.45408 81.567784 L 108.278575 80.393409 L 110.194036 79.848415 L 112.109498 79.537882 L 114.284684 79.41763 L 117.303971 79.494006 L 126.589091 79.845011 L 136.361193 79.80842 L 163.30752 79.80385 L 398.487273 79.803763 L 398.487273 79.803763 " clip-path="url(#pef3ce7175f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="patch_3"><path d="M 57.6 307.584 L 57.6 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_4"><path d="M 414.72 307.584 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_5"><path d="M 57.6 307.584 L 414.72 307.584 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_6"><path d="M 57.6 41.472 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="legend_1"> <g id="patch_7"><path d="M 325.812188 302.584 L 407.72 302.584 Q 409.72 302.584 409.72 300.584 L 409.72 228.193375 Q 409.72 226.193375 407.72 226.193375 L 325.812188 226.193375 Q 323.812188 226.193375 323.812188 228.193375 L 323.812188 300.584 Q 323.812188 302.584 325.812188 302.584 z " style="opacity: 0.8; stroke-linejoin: miter;"></path> </g> <g id="line2d_21"><path d="M 327.812188 234.291812 L 337.812188 234.291812 L 347.812188 234.291812 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_18"> <g transform="translate(355.812188 237.791812)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-4b" d="M 628 4666 L 1259 4666 L 1259 2694 L 3353 4666 L 4166 4666 L 1850 2491 L 4331 0 L 3500 0 L 1259 2247 L 1259 0 L 628 0 L 628 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-20" transform="scale(0.015625)"></path><path id="DejaVuSans-3d" d="M 678 2906 L 4684 2906 L 4684 2381 L 678 2381 L 678 2906 z M 678 1631 L 4684 1631 L 4684 1100 L 678 1100 L 678 1631 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2e" d="M 684 794 L 1344 794 L 1344 0 L 684 0 L 684 794 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-30" x="371.826172"></use> <use xlink:href="#DejaVuSans-35" x="435.449219"></use> </g> </g> <g id="line2d_22"><path d="M 327.812188 248.969937 L 337.812188 248.969937 L 347.812188 248.969937 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_19"> <g transform="translate(355.812188 252.469937)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-31" x="371.826172"></use> </g> </g> <g id="line2d_23"><path d="M 327.812188 263.648062 L 337.812188 263.648062 L 347.812188 263.648062 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_20"> <g transform="translate(355.812188 267.148062)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-32" x="371.826172"></use> </g> </g> <g id="line2d_24"><path d="M 327.812188 278.326188 L 337.812188 278.326188 L 347.812188 278.326188 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_21"> <g transform="translate(355.812188 281.826188)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-34" x="371.826172"></use> </g> </g> <g id="line2d_25"><path d="M 327.812188 293.004312 L 337.812188 293.004312 L 347.812188 293.004312 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_22"> <g transform="translate(355.812188 296.504312)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-38" x="371.826172"></use> </g> </g> </g> </g> </g> <defs> <clipPath id="pef3ce7175f"> <rect x="57.6" y="41.472" width="357.12" height="266.112"></rect> </clipPath> </defs> </svg><h3 id="proportional-integral-derivative">Proportional, Integral, Derivative</h3><p>PID stands for “proportional, integral, derivative” and is a way to address some issues with the above model. Namely, there are two issues that we want to address:</p><ol><li>Undershoot: Our input is too weak, and the output isn’t changing quickly enough in response to a change in input</li><li>Overshoot: Our input is too strong, and the output is changing too quickly</li></ol><p>Among the temperature curves above, the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">K_p = 0.8</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span><span>.</span><span>8</span></span></span></span> overshoots the most, while the <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub><mo>=</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">K_p = 0.05</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>0</span><span>.</span><span>0</span><span>5</span></span></span></span> undershoots the most.</p><h3 id="integral-control">Integral Control</h3><p>Consider the case in which we are <strong>undershooting</strong> our target value. We can detect that we’re undershooting if the error is accumulating too fast - in other words, our error isn’t going down fast enough. We can add another term to the controller which takes this into account, using the integral of the error.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo>=</mo><msub><mi>K</mi><mi>i</mi></msub><mo>∫</mo><msub><mtext>error</mtext><mi>t</mi></msub><mtext> </mtext><mi>d</mi><mtext> time</mtext></mrow><annotation encoding="application/x-tex">\text{input} = K_i \int \text{error}_t \, d \text{ time}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>input</span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>∫</span><span></span><span><span><span>error</span></span><span><span><span><span><span><span></span><span><span>t</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>d</span><span><span> time</span></span></span></span></span></span></p><p>We can approximate this by keeping track of our running error:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo>≈</mo><msub><mi>K</mi><mi>i</mi></msub><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mi>T</mi></munderover><msub><mtext>error</mtext><mi>t</mi></msub><mtext> </mtext><mi>d</mi><mtext> time</mtext></mrow><annotation encoding="application/x-tex">\text{input} \approx K_i \sum_{t = 0}^{T} \text{error}_t \, d \text{ time}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>input</span></span><span></span><span>≈</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>t</span><span>=</span><span>0</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>T</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span>error</span></span><span><span><span><span><span><span></span><span><span>t</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>d</span><span><span> time</span></span></span></span></span></span></p><p>This controller can work on it’s own, and will correct for undershooting. However, by itself it will naturally oscillate, because it has to accumulate error on the opposite side of the target value in order to start heading in the opposite direction.</p><p>Here’s a few temperature curves for an undershooting proportional controller, with different integral controller coefficients.</p><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="460.8pt" height="345.6pt" viewBox="0 0 460.8 345.6" version="1.1"><metadata> <rdf:rdf xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <cc:work> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type> <dc:date>2022-10-01T00:30:17.634713</dc:date> <dc:format>image/svg+xml</dc:format> <dc:creator> <cc:agent> <dc:title>Matplotlib v3.5.3, https://matplotlib.org/</dc:title> </cc:agent> </dc:creator> </cc:work> </rdf:rdf> </metadata> <defs></defs> <g id="figure_1"> <g id="patch_1"><path d="M 0 345.6 L 460.8 345.6 L 460.8 0 L 0 0 z "></path> </g> <g id="axes_1"> <g id="patch_2"><path d="M 57.6 307.584 L 414.72 307.584 L 414.72 41.472 L 57.6 41.472 z "></path> </g> <g id="matplotlib.axis_1"> <g id="xtick_1"> <g id="line2d_1"> <defs><path id="m5230638358" d="M 0 0 L 0 3.5 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#m5230638358" x="73.832727" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_1"> <g transform="translate(70.651477 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-30" d="M 2034 4250 Q 1547 4250 1301 3770 Q 1056 3291 1056 2328 Q 1056 1369 1301 889 Q 1547 409 2034 409 Q 2525 409 2770 889 Q 3016 1369 3016 2328 Q 3016 3291 2770 3770 Q 2525 4250 2034 4250 z M 2034 4750 Q 2819 4750 3233 4129 Q 3647 3509 3647 2328 Q 3647 1150 3233 529 Q 2819 -91 2034 -91 Q 1250 -91 836 529 Q 422 1150 422 2328 Q 422 3509 836 4129 Q 1250 4750 2034 4750 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-30"></use> </g> </g> </g> <g id="xtick_2"> <g id="line2d_2"> <g> <use xlink:href="#m5230638358" x="138.763636" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_2"> <g transform="translate(129.219886 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-32" d="M 1228 531 L 3431 531 L 3431 0 L 469 0 L 469 531 Q 828 903 1448 1529 Q 2069 2156 2228 2338 Q 2531 2678 2651 2914 Q 2772 3150 2772 3378 Q 2772 3750 2511 3984 Q 2250 4219 1831 4219 Q 1534 4219 1204 4116 Q 875 4013 500 3803 L 500 4441 Q 881 4594 1212 4672 Q 1544 4750 1819 4750 Q 2544 4750 2975 4387 Q 3406 4025 3406 3419 Q 3406 3131 3298 2873 Q 3191 2616 2906 2266 Q 2828 2175 2409 1742 Q 1991 1309 1228 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="xtick_3"> <g id="line2d_3"> <g> <use xlink:href="#m5230638358" x="203.694545" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_3"> <g transform="translate(194.150795 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-34" d="M 2419 4116 L 825 1625 L 2419 1625 L 2419 4116 z M 2253 4666 L 3047 4666 L 3047 1625 L 3713 1625 L 3713 1100 L 3047 1100 L 3047 0 L 2419 0 L 2419 1100 L 313 1100 L 313 1709 L 2253 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-34"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="xtick_4"> <g id="line2d_4"> <g> <use xlink:href="#m5230638358" x="268.625455" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_4"> <g transform="translate(259.081705 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-36" d="M 2113 2584 Q 1688 2584 1439 2293 Q 1191 2003 1191 1497 Q 1191 994 1439 701 Q 1688 409 2113 409 Q 2538 409 2786 701 Q 3034 994 3034 1497 Q 3034 2003 2786 2293 Q 2538 2584 2113 2584 z M 3366 4563 L 3366 3988 Q 3128 4100 2886 4159 Q 2644 4219 2406 4219 Q 1781 4219 1451 3797 Q 1122 3375 1075 2522 Q 1259 2794 1537 2939 Q 1816 3084 2150 3084 Q 2853 3084 3261 2657 Q 3669 2231 3669 1497 Q 3669 778 3244 343 Q 2819 -91 2113 -91 Q 1303 -91 875 529 Q 447 1150 447 2328 Q 447 3434 972 4092 Q 1497 4750 2381 4750 Q 2619 4750 2861 4703 Q 3103 4656 3366 4563 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-36"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="xtick_5"> <g id="line2d_5"> <g> <use xlink:href="#m5230638358" x="333.556364" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_5"> <g transform="translate(324.012614 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-38" d="M 2034 2216 Q 1584 2216 1326 1975 Q 1069 1734 1069 1313 Q 1069 891 1326 650 Q 1584 409 2034 409 Q 2484 409 2743 651 Q 3003 894 3003 1313 Q 3003 1734 2745 1975 Q 2488 2216 2034 2216 z M 1403 2484 Q 997 2584 770 2862 Q 544 3141 544 3541 Q 544 4100 942 4425 Q 1341 4750 2034 4750 Q 2731 4750 3128 4425 Q 3525 4100 3525 3541 Q 3525 3141 3298 2862 Q 3072 2584 2669 2484 Q 3125 2378 3379 2068 Q 3634 1759 3634 1313 Q 3634 634 3220 271 Q 2806 -91 2034 -91 Q 1263 -91 848 271 Q 434 634 434 1313 Q 434 1759 690 2068 Q 947 2378 1403 2484 z M 1172 3481 Q 1172 3119 1398 2916 Q 1625 2713 2034 2713 Q 2441 2713 2670 2916 Q 2900 3119 2900 3481 Q 2900 3844 2670 4047 Q 2441 4250 2034 4250 Q 1625 4250 1398 4047 Q 1172 3844 1172 3481 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-38"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="xtick_6"> <g id="line2d_6"> <g> <use xlink:href="#m5230638358" x="398.487273" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_6"> <g transform="translate(385.762273 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-31" d="M 794 531 L 1825 531 L 1825 4091 L 703 3866 L 703 4441 L 1819 4666 L 2450 4666 L 2450 531 L 3481 531 L 3481 0 L 794 0 L 794 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> <use xlink:href="#DejaVuSans-30" x="190.869141"></use> </g> </g> </g> <g id="text_7"> <g transform="translate(223.926406 335.860562)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-54" d="M -19 4666 L 3928 4666 L 3928 4134 L 2272 4134 L 2272 0 L 1638 0 L 1638 4134 L -19 4134 L -19 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-69" d="M 603 3500 L 1178 3500 L 1178 0 L 603 0 L 603 3500 z M 603 4863 L 1178 4863 L 1178 4134 L 603 4134 L 603 4863 z " transform="scale(0.015625)"></path><path id="DejaVuSans-6d" d="M 3328 2828 Q 3544 3216 3844 3400 Q 4144 3584 4550 3584 Q 5097 3584 5394 3201 Q 5691 2819 5691 2113 L 5691 0 L 5113 0 L 5113 2094 Q 5113 2597 4934 2840 Q 4756 3084 4391 3084 Q 3944 3084 3684 2787 Q 3425 2491 3425 1978 L 3425 0 L 2847 0 L 2847 2094 Q 2847 2600 2669 2842 Q 2491 3084 2119 3084 Q 1678 3084 1418 2786 Q 1159 2488 1159 1978 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1356 3278 1631 3431 Q 1906 3584 2284 3584 Q 2666 3584 2933 3390 Q 3200 3197 3328 2828 z " transform="scale(0.015625)"></path><path id="DejaVuSans-65" d="M 3597 1894 L 3597 1613 L 953 1613 Q 991 1019 1311 708 Q 1631 397 2203 397 Q 2534 397 2845 478 Q 3156 559 3463 722 L 3463 178 Q 3153 47 2828 -22 Q 2503 -91 2169 -91 Q 1331 -91 842 396 Q 353 884 353 1716 Q 353 2575 817 3079 Q 1281 3584 2069 3584 Q 2775 3584 3186 3129 Q 3597 2675 3597 1894 z M 3022 2063 Q 3016 2534 2758 2815 Q 2500 3097 2075 3097 Q 1594 3097 1305 2825 Q 1016 2553 972 2059 L 3022 2063 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-69" x="57.958984"></use> <use xlink:href="#DejaVuSans-6d" x="85.742188"></use> <use xlink:href="#DejaVuSans-65" x="183.154297"></use> </g> </g> </g> <g id="matplotlib.axis_2"> <g id="ytick_1"> <g id="line2d_7"> <defs><path id="mad4469f847" d="M 0 0 L -3.5 0 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#mad4469f847" x="57.6" y="269.078527" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_8"> <g transform="translate(37.875 272.877746)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-35" d="M 691 4666 L 3169 4666 L 3169 4134 L 1269 4134 L 1269 2991 Q 1406 3038 1543 3061 Q 1681 3084 1819 3084 Q 2600 3084 3056 2656 Q 3513 2228 3513 1497 Q 3513 744 3044 326 Q 2575 -91 1722 -91 Q 1428 -91 1123 -41 Q 819 9 494 109 L 494 744 Q 775 591 1075 516 Q 1375 441 1709 441 Q 2250 441 2565 725 Q 2881 1009 2881 1497 Q 2881 1984 2565 2268 Q 2250 2553 1709 2553 Q 1456 2553 1204 2497 Q 953 2441 691 2322 L 691 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-35"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="ytick_2"> <g id="line2d_8"> <g> <use xlink:href="#mad4469f847" x="57.6" y="225.062739" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_9"> <g transform="translate(31.5125 228.861958)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_3"> <g id="line2d_9"> <g> <use xlink:href="#mad4469f847" x="57.6" y="181.046951" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_10"> <g transform="translate(31.5125 184.84617)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_4"> <g id="line2d_10"> <g> <use xlink:href="#mad4469f847" x="57.6" y="137.031163" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_11"> <g transform="translate(31.5125 140.830381)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_5"> <g id="line2d_11"> <g> <use xlink:href="#mad4469f847" x="57.6" y="93.015375" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_12"> <g transform="translate(31.5125 96.814593)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_6"> <g id="line2d_12"> <g> <use xlink:href="#mad4469f847" x="57.6" y="48.999586" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_13"> <g transform="translate(31.5125 52.798805)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-33" d="M 2597 2516 Q 3050 2419 3304 2112 Q 3559 1806 3559 1356 Q 3559 666 3084 287 Q 2609 -91 1734 -91 Q 1441 -91 1130 -33 Q 819 25 488 141 L 488 750 Q 750 597 1062 519 Q 1375 441 1716 441 Q 2309 441 2620 675 Q 2931 909 2931 1356 Q 2931 1769 2642 2001 Q 2353 2234 1838 2234 L 1294 2234 L 1294 2753 L 1863 2753 Q 2328 2753 2575 2939 Q 2822 3125 2822 3475 Q 2822 3834 2567 4026 Q 2313 4219 1838 4219 Q 1578 4219 1281 4162 Q 984 4106 628 3988 L 628 4550 Q 988 4650 1302 4700 Q 1616 4750 1894 4750 Q 2613 4750 3031 4423 Q 3450 4097 3450 3541 Q 3450 3153 3228 2886 Q 3006 2619 2597 2516 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-33"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="text_14"> <g transform="translate(25.432812 206.197531)rotate(-90)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-70" d="M 1159 525 L 1159 -1331 L 581 -1331 L 581 3500 L 1159 3500 L 1159 2969 Q 1341 3281 1617 3432 Q 1894 3584 2278 3584 Q 2916 3584 3314 3078 Q 3713 2572 3713 1747 Q 3713 922 3314 415 Q 2916 -91 2278 -91 Q 1894 -91 1617 61 Q 1341 213 1159 525 z M 3116 1747 Q 3116 2381 2855 2742 Q 2594 3103 2138 3103 Q 1681 3103 1420 2742 Q 1159 2381 1159 1747 Q 1159 1113 1420 752 Q 1681 391 2138 391 Q 2594 391 2855 752 Q 3116 1113 3116 1747 z " transform="scale(0.015625)"></path><path id="DejaVuSans-72" d="M 2631 2963 Q 2534 3019 2420 3045 Q 2306 3072 2169 3072 Q 1681 3072 1420 2755 Q 1159 2438 1159 1844 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1341 3275 1631 3429 Q 1922 3584 2338 3584 Q 2397 3584 2469 3576 Q 2541 3569 2628 3553 L 2631 2963 z " transform="scale(0.015625)"></path><path id="DejaVuSans-61" d="M 2194 1759 Q 1497 1759 1228 1600 Q 959 1441 959 1056 Q 959 750 1161 570 Q 1363 391 1709 391 Q 2188 391 2477 730 Q 2766 1069 2766 1631 L 2766 1759 L 2194 1759 z M 3341 1997 L 3341 0 L 2766 0 L 2766 531 Q 2569 213 2275 61 Q 1981 -91 1556 -91 Q 1019 -91 701 211 Q 384 513 384 1019 Q 384 1609 779 1909 Q 1175 2209 1959 2209 L 2766 2209 L 2766 2266 Q 2766 2663 2505 2880 Q 2244 3097 1772 3097 Q 1472 3097 1187 3025 Q 903 2953 641 2809 L 641 3341 Q 956 3463 1253 3523 Q 1550 3584 1831 3584 Q 2591 3584 2966 3190 Q 3341 2797 3341 1997 z " transform="scale(0.015625)"></path><path id="DejaVuSans-74" d="M 1172 4494 L 1172 3500 L 2356 3500 L 2356 3053 L 1172 3053 L 1172 1153 Q 1172 725 1289 603 Q 1406 481 1766 481 L 2356 481 L 2356 0 L 1766 0 Q 1100 0 847 248 Q 594 497 594 1153 L 594 3053 L 172 3053 L 172 3500 L 594 3500 L 594 4494 L 1172 4494 z " transform="scale(0.015625)"></path><path id="DejaVuSans-75" d="M 544 1381 L 544 3500 L 1119 3500 L 1119 1403 Q 1119 906 1312 657 Q 1506 409 1894 409 Q 2359 409 2629 706 Q 2900 1003 2900 1516 L 2900 3500 L 3475 3500 L 3475 0 L 2900 0 L 2900 538 Q 2691 219 2414 64 Q 2138 -91 1772 -91 Q 1169 -91 856 284 Q 544 659 544 1381 z M 1991 3584 L 1991 3584 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-65" x="44.083984"></use> <use xlink:href="#DejaVuSans-6d" x="105.607422"></use> <use xlink:href="#DejaVuSans-70" x="203.019531"></use> <use xlink:href="#DejaVuSans-65" x="266.496094"></use> <use xlink:href="#DejaVuSans-72" x="328.019531"></use> <use xlink:href="#DejaVuSans-61" x="369.132812"></use> <use xlink:href="#DejaVuSans-74" x="430.412109"></use> <use xlink:href="#DejaVuSans-75" x="469.621094"></use> <use xlink:href="#DejaVuSans-72" x="533"></use> <use xlink:href="#DejaVuSans-65" x="571.863281"></use> </g> </g> </g> <g id="line2d_13"><path d="M 73.832727 295.488 L 73.910644 295.370452 L 74.069725 294.578857 L 74.404119 291.538991 L 75.381329 279.88198 L 77.439639 256.162682 L 79.361594 236.58835 L 81.283549 219.24224 L 83.208751 203.846342 L 85.133952 190.205858 L 87.0624 178.10147 L 88.994095 167.362417 L 90.929036 157.836666 L 92.87047 149.37558 L 94.815151 141.875089 L 96.769571 135.206685 L 98.733731 129.281835 L 100.710877 124.012857 L 102.701009 119.331173 L 104.710621 115.162254 L 106.746205 111.443711 L 108.814255 108.123076 L 110.921263 105.155992 L 113.076969 102.501002 L 115.291113 100.124 L 117.579927 97.99109 L 119.959645 96.076078 L 122.452992 94.354491 L 125.08594 92.806947 L 127.890956 91.417153 L 130.910243 90.17126 L 134.1925 89.059981 L 137.805905 88.074669 L 141.838115 87.209637 L 146.415744 86.459911 L 151.720599 85.82237 L 158.03513 85.294707 L 165.839825 84.874869 L 176.037225 84.561201 L 190.666159 84.35131 L 216.050897 84.240405 L 294.529641 84.21242 L 398.487273 84.212217 L 398.487273 84.212217 " clip-path="url(#p0e4281266f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_14"><path d="M 73.832727 295.488 L 73.910644 295.370413 L 74.069725 294.577957 L 74.404119 291.5291 L 75.345617 280.206478 L 77.647418 253.120277 L 79.74144 231.125183 L 81.819229 211.600302 L 83.877539 194.317392 L 85.916369 179.03976 L 87.935721 165.55541 L 89.932346 153.692608 L 91.906246 143.275069 L 93.85742 134.145399 L 95.785868 126.163047 L 97.688343 119.213602 L 99.568093 113.171108 L 101.421871 107.944345 L 103.249676 103.440869 L 105.054755 99.5719 L 106.837108 96.266815 L 108.596736 93.462485 L 110.340131 91.094374 L 112.07054 89.11257 L 113.791209 87.474131 L 115.515124 86.135304 L 117.252026 85.065131 L 119.0149 84.238558 L 120.81998 83.637261 L 122.686743 83.250188 L 124.637917 83.07386 L 126.70272 83.112677 L 128.913617 83.379764 L 131.309568 83.897014 L 133.945763 84.698457 L 136.893626 85.832863 L 140.266787 87.376192 L 144.269777 89.461504 L 149.363607 92.380032 L 157.629312 97.411196 L 169.001961 104.28271 L 175.936582 108.203605 L 182.202415 111.493693 L 188.205277 114.396144 L 194.11399 117.006855 L 200.029196 119.377654 L 206.028812 121.542557 L 212.174522 123.523242 L 218.528012 125.336364 L 225.154211 126.994683 L 232.118051 128.506597 L 239.503942 129.88048 L 247.406033 131.121704 L 255.947695 132.23535 L 265.288006 133.225368 L 275.637993 134.094719 L 287.299584 134.846271 L 300.71431 135.482235 L 316.583424 136.004858 L 336.104902 136.416198 L 361.590284 136.718525 L 398.454807 136.915096 L 398.487273 136.915198 L 398.487273 136.915198 " clip-path="url(#p0e4281266f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_15"><path d="M 73.832727 295.488 L 73.910644 295.370257 L 74.069725 294.574354 L 74.397626 291.560342 L 75.225495 281.327749 L 80.111546 219.25405 L 82.799686 188.19449 L 85.143692 163.600641 L 87.266932 143.589963 L 89.224599 127.18142 L 91.042665 113.756996 L 92.743855 102.795664 L 94.337908 93.922343 L 95.834566 86.802444 L 97.237073 81.169061 L 98.551924 76.772107 L 99.779119 73.412712 L 100.921903 70.90519 L 101.980276 69.094515 L 102.960733 67.837103 L 103.869766 67.016188 L 104.723607 66.533853 L 105.53849 66.322571 L 106.34688 66.342121 L 107.177996 66.588469 L 108.064303 67.0903 L 109.03502 67.905805 L 110.112873 69.113738 L 111.327081 70.823077 L 112.706863 73.166954 L 114.291177 76.316002 L 116.151447 80.532124 L 118.417536 86.249014 L 121.482275 94.634826 L 130.45248 119.528397 L 133.221783 126.364042 L 135.646953 131.776146 L 137.854604 136.175013 L 139.90642 139.781811 L 141.838115 142.740169 L 143.67566 145.157778 L 145.435287 147.113956 L 147.133231 148.676308 L 148.785722 149.90052 L 150.408995 150.830934 L 152.022528 151.502622 L 153.649047 151.940247 L 155.311279 152.157225 L 157.038441 152.157214 L 158.866246 151.932292 L 160.840145 151.461355 L 163.025071 150.70569 L 165.524911 149.597949 L 168.560431 147.997976 L 172.943267 145.409364 L 180.897303 140.699591 L 184.666543 138.752341 L 188.010484 137.271431 L 191.169373 136.113429 L 194.256838 135.217278 L 197.354042 134.549764 L 200.53241 134.093201 L 203.873105 133.840039 L 207.489757 133.792636 L 211.564172 133.967283 L 216.50866 134.411816 L 224.069865 135.344465 L 235.17305 136.683839 L 241.916125 137.258877 L 248.464407 137.592408 L 255.519151 137.724089 L 264.086784 137.650171 L 280.241594 137.231666 L 295.743849 136.937989 L 311.005859 136.887294 L 398.487273 137.025955 L 398.487273 137.025955 " clip-path="url(#p0e4281266f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_16"><path d="M 73.832727 295.488 L 73.910644 295.370063 L 74.069725 294.56985 L 74.39438 291.548368 L 75.141085 282.029026 L 77.319517 250.734105 L 83.650281 158.886299 L 85.793001 131.678674 L 87.614313 111.268393 L 89.227846 95.585846 L 90.682298 83.530411 L 92.003642 74.353272 L 93.204864 67.496115 L 94.295703 62.490919 L 95.282653 58.949939 L 96.165713 56.559262 L 96.948131 55.038057 L 97.636399 54.149889 L 98.243503 53.705336 L 98.788922 53.568482 L 99.314863 53.664517 L 99.870022 54.000732 L 100.490112 54.650721 L 101.204352 55.742022 L 102.028975 57.432288 L 102.986705 59.932256 L 104.100271 63.496173 L 105.405382 68.460401 L 106.963724 75.310644 L 108.921391 84.983918 L 111.853021 100.73183 L 116.567005 125.982285 L 118.842833 136.910622 L 120.742063 144.985856 L 122.41728 151.177605 L 123.93017 155.951528 L 125.306705 159.590364 L 126.569612 162.327909 L 127.731875 164.339806 L 128.803235 165.76968 L 129.796678 166.740235 L 130.72519 167.347828 L 131.60825 167.667078 L 132.471831 167.745764 L 133.348399 167.600908 L 134.270417 167.217988 L 135.270353 166.553542 L 136.377425 165.540601 L 137.630592 164.079429 L 139.075305 162.03771 L 140.79922 159.196035 L 143.000378 155.109126 L 146.967657 147.169351 L 150.438214 140.446463 L 152.76274 136.415849 L 154.73664 133.421997 L 156.509254 131.124545 L 158.13902 129.365148 L 159.668143 128.03282 L 161.122595 127.053547 L 162.528349 126.370029 L 163.911377 125.941749 L 165.300899 125.743633 L 166.722886 125.766217 L 168.216297 126.014666 L 169.826583 126.512406 L 171.61543 127.304729 L 173.686726 128.474574 L 176.296948 130.219837 L 181.553105 134.082793 L 185.117812 136.537525 L 187.796212 138.11759 L 190.179177 139.270402 L 192.42254 140.112043 L 194.607465 140.696023 L 196.795636 141.050933 L 199.045492 141.18945 L 201.431703 141.110592 L 204.058159 140.796388 L 207.13913 140.195316 L 211.388858 139.118646 L 219.937012 136.917849 L 223.771183 136.195525 L 227.32615 135.75113 L 230.890857 135.530922 L 234.689315 135.522824 L 239.085137 135.744092 L 245.331491 136.305288 L 255.882764 137.251337 L 261.765504 137.531009 L 267.784599 137.589743 L 275.258147 137.42529 L 296.516527 136.836212 L 307.178182 136.867712 L 338.734604 137.098402 L 392.419479 137.037854 L 398.487273 137.041293 L 398.487273 137.041293 " clip-path="url(#p0e4281266f)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="patch_3"><path d="M 57.6 307.584 L 57.6 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_4"><path d="M 414.72 307.584 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_5"><path d="M 57.6 307.584 L 414.72 307.584 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_6"><path d="M 57.6 41.472 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="legend_1"> <g id="patch_7"><path d="M 266.535625 302.584 L 407.72 302.584 Q 409.72 302.584 409.72 300.584 L 409.72 242.8715 Q 409.72 240.8715 407.72 240.8715 L 266.535625 240.8715 Q 264.535625 240.8715 264.535625 242.8715 L 264.535625 300.584 Q 264.535625 302.584 266.535625 302.584 z " style="opacity: 0.8; stroke-linejoin: miter;"></path> </g> <g id="line2d_17"><path d="M 268.535625 248.969937 L 278.535625 248.969937 L 288.535625 248.969937 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_15"> <g transform="translate(296.535625 252.469937)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-4b" d="M 628 4666 L 1259 4666 L 1259 2694 L 3353 4666 L 4166 4666 L 1850 2491 L 4331 0 L 3500 0 L 1259 2247 L 1259 0 L 628 0 L 628 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-20" transform="scale(0.015625)"></path><path id="DejaVuSans-3d" d="M 678 2906 L 4684 2906 L 4684 2381 L 678 2381 L 678 2906 z M 678 1631 L 4684 1631 L 4684 1100 L 678 1100 L 678 1631 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2e" d="M 684 794 L 1344 794 L 1344 0 L 684 0 L 684 794 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2c" d="M 750 794 L 1409 794 L 1409 256 L 897 -744 L 494 -744 L 750 256 L 750 794 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-30" x="371.826172"></use> <use xlink:href="#DejaVuSans-31" x="435.449219"></use> <use xlink:href="#DejaVuSans-2c" x="499.072266"></use> <use xlink:href="#DejaVuSans-20" x="530.859375"></use> <use xlink:href="#DejaVuSans-4b" x="562.646484"></use> <use xlink:href="#DejaVuSans-69" x="628.222656"></use> <use xlink:href="#DejaVuSans-20" x="656.005859"></use> <use xlink:href="#DejaVuSans-3d" x="687.792969"></use> <use xlink:href="#DejaVuSans-20" x="771.582031"></use> <use xlink:href="#DejaVuSans-30" x="803.369141"></use> </g> </g> <g id="line2d_18"><path d="M 268.535625 263.648062 L 278.535625 263.648062 L 288.535625 263.648062 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_16"> <g transform="translate(296.535625 267.148062)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-2d" d="M 313 2009 L 1997 2009 L 1997 1497 L 313 1497 L 313 2009 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-30" x="371.826172"></use> <use xlink:href="#DejaVuSans-31" x="435.449219"></use> <use xlink:href="#DejaVuSans-2c" x="499.072266"></use> <use xlink:href="#DejaVuSans-20" x="530.859375"></use> <use xlink:href="#DejaVuSans-4b" x="562.646484"></use> <use xlink:href="#DejaVuSans-69" x="628.222656"></use> <use xlink:href="#DejaVuSans-20" x="656.005859"></use> <use xlink:href="#DejaVuSans-3d" x="687.792969"></use> <use xlink:href="#DejaVuSans-20" x="771.582031"></use> <use xlink:href="#DejaVuSans-31" x="803.369141"></use> <use xlink:href="#DejaVuSans-65" x="866.992188"></use> <use xlink:href="#DejaVuSans-2d" x="928.515625"></use> <use xlink:href="#DejaVuSans-30" x="964.599609"></use> <use xlink:href="#DejaVuSans-36" x="1028.222656"></use> </g> </g> <g id="line2d_19"><path d="M 268.535625 278.326187 L 278.535625 278.326187 L 288.535625 278.326187 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_17"> <g transform="translate(296.535625 281.826187)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-30" x="371.826172"></use> <use xlink:href="#DejaVuSans-31" x="435.449219"></use> <use xlink:href="#DejaVuSans-2c" x="499.072266"></use> <use xlink:href="#DejaVuSans-20" x="530.859375"></use> <use xlink:href="#DejaVuSans-4b" x="562.646484"></use> <use xlink:href="#DejaVuSans-69" x="628.222656"></use> <use xlink:href="#DejaVuSans-20" x="656.005859"></use> <use xlink:href="#DejaVuSans-3d" x="687.792969"></use> <use xlink:href="#DejaVuSans-20" x="771.582031"></use> <use xlink:href="#DejaVuSans-35" x="803.369141"></use> <use xlink:href="#DejaVuSans-65" x="866.992188"></use> <use xlink:href="#DejaVuSans-2d" x="928.515625"></use> <use xlink:href="#DejaVuSans-30" x="964.599609"></use> <use xlink:href="#DejaVuSans-36" x="1028.222656"></use> </g> </g> <g id="line2d_20"><path d="M 268.535625 293.004312 L 278.535625 293.004312 L 288.535625 293.004312 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_18"> <g transform="translate(296.535625 296.504312)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-30" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-30" x="371.826172"></use> <use xlink:href="#DejaVuSans-31" x="435.449219"></use> <use xlink:href="#DejaVuSans-2c" x="499.072266"></use> <use xlink:href="#DejaVuSans-20" x="530.859375"></use> <use xlink:href="#DejaVuSans-4b" x="562.646484"></use> <use xlink:href="#DejaVuSans-69" x="628.222656"></use> <use xlink:href="#DejaVuSans-20" x="656.005859"></use> <use xlink:href="#DejaVuSans-3d" x="687.792969"></use> <use xlink:href="#DejaVuSans-20" x="771.582031"></use> <use xlink:href="#DejaVuSans-31" x="803.369141"></use> <use xlink:href="#DejaVuSans-65" x="866.992188"></use> <use xlink:href="#DejaVuSans-2d" x="928.515625"></use> <use xlink:href="#DejaVuSans-30" x="964.599609"></use> <use xlink:href="#DejaVuSans-35" x="1028.222656"></use> </g> </g> </g> </g> </g> <defs> <clipPath id="p0e4281266f"> <rect x="57.6" y="41.472" width="357.12" height="266.112"></rect> </clipPath> </defs> </svg><h3 id="derivative-control">Derivative Control</h3><p>Consider the case in which we are <strong>overshooting</strong> our target value. We can detect that we’re about to overshoot if the error is getting smaller too fast. We can add another term to the controller which takes this into account, using the derivative of the error. The desired behavior is to decrease the input if the error is getting smaller too quickly, and increase the input if the error is getting smaller too slowly. This can be expressed as a function of the derivative of the error:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo>=</mo><msub><mi>K</mi><mi>d</mi></msub><mfrac><mrow><mi>d</mi><mtext> </mtext><mtext>error</mtext></mrow><mrow><mi>d</mi><mtext> </mtext><mtext>time</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{input} = K_d \frac{d \, \text{error}}{d \, \text{time}}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>input</span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>d</span><span></span><span><span>time</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>d</span><span></span><span><span>error</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>We can approximate this by keeping track of our past error:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo>≈</mo><msub><mi>K</mi><mi>d</mi></msub><mfrac><mrow><mtext>error</mtext><mo>−</mo><mtext>prev error</mtext></mrow><mrow><mi>d</mi><mtext> </mtext><mtext>time</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{input} \approx K_d \frac{\text{error} - \text{prev error}}{d \, \text{time}}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>input</span></span><span></span><span>≈</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>d</span><span></span><span><span>time</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>error</span></span><span></span><span>−</span><span></span><span><span>prev error</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>This controller won’t work on it’s own, because the error shouldn’t change without changing the input. The power of this controller is to help correct for the overshooting behavior of our original controller.</p><p>Here’s a few temperature curves for an overshooting proportional controller, with different derivative controller coefficients.</p><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="460.8pt" height="345.6pt" viewBox="0 0 460.8 345.6" version="1.1"><metadata> <rdf:rdf xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <cc:work> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type> <dc:date>2022-09-30T17:07:26.871036</dc:date> <dc:format>image/svg+xml</dc:format> <dc:creator> <cc:agent> <dc:title>Matplotlib v3.5.3, https://matplotlib.org/</dc:title> </cc:agent> </dc:creator> </cc:work> </rdf:rdf> </metadata> <defs></defs> <g id="figure_1"> <g id="patch_1"><path d="M 0 345.6 L 460.8 345.6 L 460.8 0 L 0 0 z "></path> </g> <g id="axes_1"> <g id="patch_2"><path d="M 57.6 307.584 L 414.72 307.584 L 414.72 41.472 L 57.6 41.472 z "></path> </g> <g id="matplotlib.axis_1"> <g id="xtick_1"> <g id="line2d_1"> <defs><path id="md7a1ccaa18" d="M 0 0 L 0 3.5 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#md7a1ccaa18" x="73.832727" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_1"> <g transform="translate(65.881165 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-30" d="M 2034 4250 Q 1547 4250 1301 3770 Q 1056 3291 1056 2328 Q 1056 1369 1301 889 Q 1547 409 2034 409 Q 2525 409 2770 889 Q 3016 1369 3016 2328 Q 3016 3291 2770 3770 Q 2525 4250 2034 4250 z M 2034 4750 Q 2819 4750 3233 4129 Q 3647 3509 3647 2328 Q 3647 1150 3233 529 Q 2819 -91 2034 -91 Q 1250 -91 836 529 Q 422 1150 422 2328 Q 422 3509 836 4129 Q 1250 4750 2034 4750 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2e" d="M 684 794 L 1344 794 L 1344 0 L 684 0 L 684 794 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-30"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="95.410156"></use> </g> </g> </g> <g id="xtick_2"> <g id="line2d_2"> <g> <use xlink:href="#md7a1ccaa18" x="114.414545" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_2"> <g transform="translate(106.462983 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-32" d="M 1228 531 L 3431 531 L 3431 0 L 469 0 L 469 531 Q 828 903 1448 1529 Q 2069 2156 2228 2338 Q 2531 2678 2651 2914 Q 2772 3150 2772 3378 Q 2772 3750 2511 3984 Q 2250 4219 1831 4219 Q 1534 4219 1204 4116 Q 875 4013 500 3803 L 500 4441 Q 881 4594 1212 4672 Q 1544 4750 1819 4750 Q 2544 4750 2975 4387 Q 3406 4025 3406 3419 Q 3406 3131 3298 2873 Q 3191 2616 2906 2266 Q 2828 2175 2409 1742 Q 1991 1309 1228 531 z " transform="scale(0.015625)"></path><path id="DejaVuSans-35" d="M 691 4666 L 3169 4666 L 3169 4134 L 1269 4134 L 1269 2991 Q 1406 3038 1543 3061 Q 1681 3084 1819 3084 Q 2600 3084 3056 2656 Q 3513 2228 3513 1497 Q 3513 744 3044 326 Q 2575 -91 1722 -91 Q 1428 -91 1123 -41 Q 819 9 494 109 L 494 744 Q 775 591 1075 516 Q 1375 441 1709 441 Q 2250 441 2565 725 Q 2881 1009 2881 1497 Q 2881 1984 2565 2268 Q 2250 2553 1709 2553 Q 1456 2553 1204 2497 Q 953 2441 691 2322 L 691 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="95.410156"></use> </g> </g> </g> <g id="xtick_3"> <g id="line2d_3"> <g> <use xlink:href="#md7a1ccaa18" x="154.996364" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_3"> <g transform="translate(147.044801 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-35"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="95.410156"></use> </g> </g> </g> <g id="xtick_4"> <g id="line2d_4"> <g> <use xlink:href="#md7a1ccaa18" x="195.578182" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_4"> <g transform="translate(187.626619 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-37" d="M 525 4666 L 3525 4666 L 3525 4397 L 1831 0 L 1172 0 L 2766 4134 L 525 4134 L 525 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-37"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="95.410156"></use> </g> </g> </g> <g id="xtick_5"> <g id="line2d_5"> <g> <use xlink:href="#md7a1ccaa18" x="236.16" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_5"> <g transform="translate(225.027188 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-31" d="M 794 531 L 1825 531 L 1825 4091 L 703 3866 L 703 4441 L 1819 4666 L 2450 4666 L 2450 531 L 3481 531 L 3481 0 L 794 0 L 794 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-2e" x="127.246094"></use> <use xlink:href="#DejaVuSans-30" x="159.033203"></use> </g> </g> </g> <g id="xtick_6"> <g id="line2d_6"> <g> <use xlink:href="#md7a1ccaa18" x="276.741818" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_6"> <g transform="translate(265.609006 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-32" x="63.623047"></use> <use xlink:href="#DejaVuSans-2e" x="127.246094"></use> <use xlink:href="#DejaVuSans-35" x="159.033203"></use> </g> </g> </g> <g id="xtick_7"> <g id="line2d_7"> <g> <use xlink:href="#md7a1ccaa18" x="317.323636" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_7"> <g transform="translate(306.190824 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-2e" x="127.246094"></use> <use xlink:href="#DejaVuSans-30" x="159.033203"></use> </g> </g> </g> <g id="xtick_8"> <g id="line2d_8"> <g> <use xlink:href="#md7a1ccaa18" x="357.905455" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_8"> <g transform="translate(346.772642 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-37" x="63.623047"></use> <use xlink:href="#DejaVuSans-2e" x="127.246094"></use> <use xlink:href="#DejaVuSans-35" x="159.033203"></use> </g> </g> </g> <g id="xtick_9"> <g id="line2d_9"> <g> <use xlink:href="#md7a1ccaa18" x="398.487273" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_9"> <g transform="translate(387.35446 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-2e" x="127.246094"></use> <use xlink:href="#DejaVuSans-30" x="159.033203"></use> </g> </g> </g> <g id="text_10"> <g transform="translate(223.926406 335.860562)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-54" d="M -19 4666 L 3928 4666 L 3928 4134 L 2272 4134 L 2272 0 L 1638 0 L 1638 4134 L -19 4134 L -19 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-69" d="M 603 3500 L 1178 3500 L 1178 0 L 603 0 L 603 3500 z M 603 4863 L 1178 4863 L 1178 4134 L 603 4134 L 603 4863 z " transform="scale(0.015625)"></path><path id="DejaVuSans-6d" d="M 3328 2828 Q 3544 3216 3844 3400 Q 4144 3584 4550 3584 Q 5097 3584 5394 3201 Q 5691 2819 5691 2113 L 5691 0 L 5113 0 L 5113 2094 Q 5113 2597 4934 2840 Q 4756 3084 4391 3084 Q 3944 3084 3684 2787 Q 3425 2491 3425 1978 L 3425 0 L 2847 0 L 2847 2094 Q 2847 2600 2669 2842 Q 2491 3084 2119 3084 Q 1678 3084 1418 2786 Q 1159 2488 1159 1978 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1356 3278 1631 3431 Q 1906 3584 2284 3584 Q 2666 3584 2933 3390 Q 3200 3197 3328 2828 z " transform="scale(0.015625)"></path><path id="DejaVuSans-65" d="M 3597 1894 L 3597 1613 L 953 1613 Q 991 1019 1311 708 Q 1631 397 2203 397 Q 2534 397 2845 478 Q 3156 559 3463 722 L 3463 178 Q 3153 47 2828 -22 Q 2503 -91 2169 -91 Q 1331 -91 842 396 Q 353 884 353 1716 Q 353 2575 817 3079 Q 1281 3584 2069 3584 Q 2775 3584 3186 3129 Q 3597 2675 3597 1894 z M 3022 2063 Q 3016 2534 2758 2815 Q 2500 3097 2075 3097 Q 1594 3097 1305 2825 Q 1016 2553 972 2059 L 3022 2063 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-69" x="57.958984"></use> <use xlink:href="#DejaVuSans-6d" x="85.742188"></use> <use xlink:href="#DejaVuSans-65" x="183.154297"></use> </g> </g> </g> <g id="matplotlib.axis_2"> <g id="ytick_1"> <g id="line2d_10"> <defs><path id="me11969e699" d="M 0 0 L -3.5 0 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#me11969e699" x="57.6" y="264.693894" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_11"> <g transform="translate(37.875 268.493113)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-35"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="ytick_2"> <g id="line2d_11"> <g> <use xlink:href="#me11969e699" x="57.6" y="213.370384" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_12"> <g transform="translate(31.5125 217.169602)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_3"> <g id="line2d_12"> <g> <use xlink:href="#me11969e699" x="57.6" y="162.046873" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_13"> <g transform="translate(31.5125 165.846092)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_4"> <g id="line2d_13"> <g> <use xlink:href="#me11969e699" x="57.6" y="110.723363" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_14"> <g transform="translate(31.5125 114.522582)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_5"> <g id="line2d_14"> <g> <use xlink:href="#me11969e699" x="57.6" y="59.399853" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_15"> <g transform="translate(31.5125 63.199072)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="text_16"> <g transform="translate(25.432812 206.197531)rotate(-90)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-70" d="M 1159 525 L 1159 -1331 L 581 -1331 L 581 3500 L 1159 3500 L 1159 2969 Q 1341 3281 1617 3432 Q 1894 3584 2278 3584 Q 2916 3584 3314 3078 Q 3713 2572 3713 1747 Q 3713 922 3314 415 Q 2916 -91 2278 -91 Q 1894 -91 1617 61 Q 1341 213 1159 525 z M 3116 1747 Q 3116 2381 2855 2742 Q 2594 3103 2138 3103 Q 1681 3103 1420 2742 Q 1159 2381 1159 1747 Q 1159 1113 1420 752 Q 1681 391 2138 391 Q 2594 391 2855 752 Q 3116 1113 3116 1747 z " transform="scale(0.015625)"></path><path id="DejaVuSans-72" d="M 2631 2963 Q 2534 3019 2420 3045 Q 2306 3072 2169 3072 Q 1681 3072 1420 2755 Q 1159 2438 1159 1844 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1341 3275 1631 3429 Q 1922 3584 2338 3584 Q 2397 3584 2469 3576 Q 2541 3569 2628 3553 L 2631 2963 z " transform="scale(0.015625)"></path><path id="DejaVuSans-61" d="M 2194 1759 Q 1497 1759 1228 1600 Q 959 1441 959 1056 Q 959 750 1161 570 Q 1363 391 1709 391 Q 2188 391 2477 730 Q 2766 1069 2766 1631 L 2766 1759 L 2194 1759 z M 3341 1997 L 3341 0 L 2766 0 L 2766 531 Q 2569 213 2275 61 Q 1981 -91 1556 -91 Q 1019 -91 701 211 Q 384 513 384 1019 Q 384 1609 779 1909 Q 1175 2209 1959 2209 L 2766 2209 L 2766 2266 Q 2766 2663 2505 2880 Q 2244 3097 1772 3097 Q 1472 3097 1187 3025 Q 903 2953 641 2809 L 641 3341 Q 956 3463 1253 3523 Q 1550 3584 1831 3584 Q 2591 3584 2966 3190 Q 3341 2797 3341 1997 z " transform="scale(0.015625)"></path><path id="DejaVuSans-74" d="M 1172 4494 L 1172 3500 L 2356 3500 L 2356 3053 L 1172 3053 L 1172 1153 Q 1172 725 1289 603 Q 1406 481 1766 481 L 2356 481 L 2356 0 L 1766 0 Q 1100 0 847 248 Q 594 497 594 1153 L 594 3053 L 172 3053 L 172 3500 L 594 3500 L 594 4494 L 1172 4494 z " transform="scale(0.015625)"></path><path id="DejaVuSans-75" d="M 544 1381 L 544 3500 L 1119 3500 L 1119 1403 Q 1119 906 1312 657 Q 1506 409 1894 409 Q 2359 409 2629 706 Q 2900 1003 2900 1516 L 2900 3500 L 3475 3500 L 3475 0 L 2900 0 L 2900 538 Q 2691 219 2414 64 Q 2138 -91 1772 -91 Q 1169 -91 856 284 Q 544 659 544 1381 z M 1991 3584 L 1991 3584 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-65" x="44.083984"></use> <use xlink:href="#DejaVuSans-6d" x="105.607422"></use> <use xlink:href="#DejaVuSans-70" x="203.019531"></use> <use xlink:href="#DejaVuSans-65" x="266.496094"></use> <use xlink:href="#DejaVuSans-72" x="328.019531"></use> <use xlink:href="#DejaVuSans-61" x="369.132812"></use> <use xlink:href="#DejaVuSans-74" x="430.412109"></use> <use xlink:href="#DejaVuSans-75" x="469.621094"></use> <use xlink:href="#DejaVuSans-72" x="533"></use> <use xlink:href="#DejaVuSans-65" x="571.863281"></use> </g> </g> </g> <g id="line2d_15"><path d="M 73.832727 295.488 L 74.319709 295.265959 L 74.806691 294.718949 L 75.456 293.502508 L 76.105309 291.753146 L 76.916945 288.85751 L 77.890909 284.413134 L 79.0272 278.009555 L 80.325818 269.269177 L 81.786764 257.893782 L 83.572364 242.222627 L 86.007273 218.686181 L 94.772945 131.704912 L 96.8832 113.750269 L 98.831127 99.019104 L 100.616727 87.248673 L 102.24 78.073871 L 103.700945 71.091808 L 104.999564 65.904527 L 106.298182 61.666565 L 107.434473 58.721025 L 108.408436 56.747094 L 109.3824 55.265067 L 110.194036 54.392649 L 111.005673 53.837315 L 111.817309 53.586261 L 112.466618 53.595333 L 113.278255 53.857001 L 114.089891 54.382808 L 115.063855 55.340537 L 116.037818 56.628531 L 117.174109 58.510677 L 118.472727 61.105884 L 120.096 64.915045 L 122.043927 70.13834 L 124.641164 77.84217 L 132.757527 102.499192 L 135.030109 108.481857 L 136.978036 113.036792 L 138.763636 116.68839 L 140.386909 119.545087 L 142.010182 121.94761 L 143.471127 123.719164 L 144.932073 125.124893 L 146.230691 126.075029 L 147.529309 126.75365 L 148.827927 127.173313 L 150.126545 127.348814 L 151.425164 127.296838 L 152.723782 127.035605 L 154.184727 126.515791 L 155.808 125.691619 L 157.5936 124.532338 L 159.703855 122.893543 L 162.463418 120.451017 L 172.365382 111.402708 L 174.962618 109.470115 L 177.2352 108.038348 L 179.507782 106.870793 L 181.618036 106.030648 L 183.728291 105.423606 L 185.838545 105.04049 L 188.111127 104.860784 L 190.546036 104.908115 L 193.143273 105.19135 L 196.065164 105.736846 L 199.798691 106.671863 L 213.596509 110.363202 L 217.492364 111.045988 L 221.225891 111.473128 L 225.121745 111.687797 L 229.342255 111.687485 L 234.3744 111.447758 L 242.003782 110.823674 L 252.555055 109.996677 L 259.3728 109.700479 L 266.352873 109.622428 L 275.280873 109.759943 L 299.954618 110.250248 L 314.401745 110.211731 L 347.354182 110.069057 L 398.487273 110.114394 L 398.487273 110.114394 " clip-path="url(#p7910aeacdc)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_16"><path d="M 73.832727 295.488 L 74.319709 295.265974 L 74.806691 294.719077 L 75.456 293.503098 L 76.105309 291.754736 L 76.916945 288.861383 L 77.890909 284.421665 L 79.0272 278.026714 L 80.325818 269.301046 L 81.786764 257.948981 L 83.572364 242.316469 L 86.007273 218.850003 L 94.772945 132.221181 L 96.8832 114.352161 L 98.831127 99.692107 L 100.616727 87.977363 L 102.24 78.843461 L 103.700945 71.889173 L 104.999564 66.71877 L 106.298182 62.489945 L 107.434473 59.54586 L 108.408436 57.568257 L 109.3824 56.078017 L 110.194036 55.195315 L 111.005673 54.62662 L 111.817309 54.359191 L 112.466618 54.35305 L 113.278255 54.593141 L 114.089891 55.094636 L 114.901527 55.842129 L 115.875491 57.04149 L 117.011782 58.822148 L 118.3104 61.304583 L 119.771345 64.586173 L 121.556945 69.163816 L 123.829527 75.635432 L 128.050036 88.510322 L 131.783564 99.595767 L 134.218473 106.164462 L 136.328727 111.246426 L 138.276655 115.349194 L 140.062255 118.571713 L 141.685527 121.036579 L 143.146473 122.872299 L 144.607418 124.348431 L 145.906036 125.365306 L 147.204655 126.113627 L 148.503273 126.605057 L 149.801891 126.853539 L 151.100509 126.874939 L 152.399127 126.686704 L 153.860073 126.247667 L 155.483345 125.510475 L 157.268945 124.44217 L 159.3792 122.902791 L 161.976436 120.718199 L 166.846255 116.255359 L 170.904436 112.677841 L 173.664 110.525085 L 176.098909 108.888792 L 178.371491 107.615981 L 180.644073 106.603569 L 182.754327 105.899202 L 184.864582 105.416235 L 187.137164 105.129871 L 189.409745 105.064686 L 191.844655 105.20964 L 194.604218 105.595895 L 198.013091 106.31474 L 202.882909 107.600969 L 210.836945 109.705828 L 215.057455 110.577322 L 218.953309 111.153714 L 222.849164 111.498781 L 226.907345 111.628349 L 231.452509 111.542507 L 237.133964 111.200321 L 257.100218 109.806246 L 264.080291 109.658868 L 272.358982 109.717598 L 307.584 110.242546 L 379.170327 110.122822 L 398.487273 110.114311 L 398.487273 110.114311 " clip-path="url(#p7910aeacdc)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_17"><path d="M 73.832727 295.488 L 74.319709 295.266107 L 74.806691 294.720225 L 75.456 293.508392 L 76.105309 291.769006 L 76.916945 288.896101 L 77.890909 284.498014 L 79.0272 278.180018 L 80.325818 269.585254 L 81.949091 257.118782 L 83.897018 240.213114 L 86.494255 215.557049 L 93.636655 146.68464 L 95.909236 127.287642 L 97.857164 112.36261 L 99.642764 100.253515 L 101.266036 90.643776 L 102.726982 83.172691 L 104.187927 76.82872 L 105.486545 72.12971 L 106.785164 68.298323 L 107.921455 65.637275 L 108.895418 63.852211 L 109.869382 62.507231 L 110.681018 61.709084 L 111.492655 61.191709 L 112.304291 60.942541 L 113.115927 60.948375 L 113.927564 61.195462 L 114.7392 61.669608 L 115.713164 62.517799 L 116.849455 63.859916 L 118.148073 65.80818 L 119.609018 68.454564 L 121.394618 72.220218 L 123.504873 77.225312 L 126.751418 85.575428 L 131.783564 98.500966 L 134.3808 104.539467 L 136.491055 108.925354 L 138.438982 112.487121 L 140.224582 115.30699 L 141.847855 117.48674 L 143.471127 119.297346 L 144.932073 120.614496 L 146.393018 121.643382 L 147.853964 122.395305 L 149.314909 122.884808 L 150.775855 123.12914 L 152.2368 123.147727 L 153.860073 122.929327 L 155.483345 122.488934 L 157.431273 121.712036 L 159.541527 120.625115 L 162.301091 118.93036 L 166.846255 115.81513 L 171.716073 112.558209 L 174.800291 110.757197 L 177.559855 109.397775 L 180.157091 108.365401 L 182.754327 107.58288 L 185.351564 107.046635 L 187.9488 106.74204 L 190.708364 106.646174 L 193.792582 106.7739 L 197.363782 107.160391 L 202.071273 107.916524 L 214.895127 110.098563 L 219.764945 110.633617 L 224.634764 110.937822 L 229.829236 111.029609 L 235.997673 110.904267 L 246.711273 110.415733 L 257.911855 109.990632 L 267.326836 109.867736 L 279.663709 109.952494 L 306.285382 110.174993 L 398.487273 110.11302 L 398.487273 110.11302 " clip-path="url(#p7910aeacdc)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_18"><path d="M 73.832727 295.488 L 74.319709 295.267438 L 74.806691 294.731597 L 75.456 293.560305 L 76.105309 291.907579 L 76.916945 289.229262 L 77.890909 285.220519 L 79.0272 279.607867 L 80.488145 271.194577 L 82.273745 259.558211 L 84.870982 241.036973 L 91.688727 191.755195 L 94.285964 174.957239 L 96.558545 161.705157 L 98.6688 150.725577 L 100.616727 141.75677 L 102.402327 134.512227 L 104.187927 128.174836 L 105.8112 123.166117 L 107.434473 118.834014 L 109.057745 115.134265 L 110.681018 112.019098 L 112.141964 109.674157 L 113.602909 107.725621 L 115.063855 106.136849 L 116.5248 104.871887 L 117.985745 103.895898 L 119.446691 103.175496 L 121.069964 102.636351 L 122.693236 102.333007 L 124.478836 102.22694 L 126.426764 102.331559 L 128.699345 102.676479 L 131.621236 103.363774 L 135.841745 104.614001 L 144.445091 107.198513 L 148.827927 108.259783 L 153.048436 109.057167 L 157.431273 109.658372 L 162.138764 110.080394 L 167.657891 110.34556 L 174.637964 110.445331 L 186.000873 110.35203 L 212.460218 110.113083 L 250.931782 110.107435 L 398.487273 110.110546 L 398.487273 110.110546 " clip-path="url(#p7910aeacdc)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_19"><path d="M 73.832727 295.488 L 74.319709 295.280415 L 74.969018 294.646049 L 75.780655 293.491821 L 77.079273 291.213752 L 80.163491 285.183269 L 85.682618 274.502054 L 90.390109 265.884323 L 95.0976 257.717798 L 99.967418 249.719907 L 104.837236 242.155369 L 109.707055 235.000705 L 114.576873 228.233707 L 119.609018 221.626104 L 124.641164 215.388119 L 129.673309 209.499076 L 134.867782 203.765387 L 140.062255 198.362472 L 145.419055 193.116973 L 150.775855 188.183254 L 156.294982 183.406555 L 161.814109 178.922108 L 167.495564 174.592184 L 173.339345 170.422621 L 179.183127 166.522674 L 185.189236 162.777021 L 191.357673 159.188854 L 197.688436 155.760303 L 204.181527 152.492495 L 210.999273 149.312752 L 217.979345 146.304301 L 225.284073 143.402854 L 232.751127 140.677188 L 240.542836 138.070643 L 248.6592 135.591562 L 257.100218 133.246208 L 266.028218 131.000034 L 275.280873 128.902018 L 285.020509 126.920808 L 295.409455 125.037198 L 306.447709 123.266567 L 318.135273 121.620166 L 330.634473 120.086747 L 344.107636 118.661819 L 358.554764 117.359206 L 374.300509 116.164417 L 391.669527 115.073546 L 398.487273 114.701192 L 398.487273 114.701192 " clip-path="url(#p7910aeacdc)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="patch_3"><path d="M 57.6 307.584 L 57.6 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_4"><path d="M 414.72 307.584 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_5"><path d="M 57.6 307.584 L 414.72 307.584 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_6"><path d="M 57.6 41.472 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="legend_1"> <g id="patch_7"><path d="M 282.266875 302.584 L 407.72 302.584 Q 409.72 302.584 409.72 300.584 L 409.72 228.193375 Q 409.72 226.193375 407.72 226.193375 L 282.266875 226.193375 Q 280.266875 226.193375 280.266875 228.193375 L 280.266875 300.584 Q 280.266875 302.584 282.266875 302.584 z " style="opacity: 0.8; stroke-linejoin: miter;"></path> </g> <g id="line2d_20"><path d="M 284.266875 234.291812 L 294.266875 234.291812 L 304.266875 234.291812 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_17"> <g transform="translate(312.266875 237.791812)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-4b" d="M 628 4666 L 1259 4666 L 1259 2694 L 3353 4666 L 4166 4666 L 1850 2491 L 4331 0 L 3500 0 L 1259 2247 L 1259 0 L 628 0 L 628 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-20" transform="scale(0.015625)"></path><path id="DejaVuSans-3d" d="M 678 2906 L 4684 2906 L 4684 2381 L 678 2381 L 678 2906 z M 678 1631 L 4684 1631 L 4684 1100 L 678 1100 L 678 1631 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2c" d="M 750 794 L 1409 794 L 1409 256 L 897 -744 L 494 -744 L 750 256 L 750 794 z " transform="scale(0.015625)"></path><path id="DejaVuSans-64" d="M 2906 2969 L 2906 4863 L 3481 4863 L 3481 0 L 2906 0 L 2906 525 Q 2725 213 2448 61 Q 2172 -91 1784 -91 Q 1150 -91 751 415 Q 353 922 353 1747 Q 353 2572 751 3078 Q 1150 3584 1784 3584 Q 2172 3584 2448 3432 Q 2725 3281 2906 2969 z M 947 1747 Q 947 1113 1208 752 Q 1469 391 1925 391 Q 2381 391 2643 752 Q 2906 1113 2906 1747 Q 2906 2381 2643 2742 Q 2381 3103 1925 3103 Q 1469 3103 1208 2742 Q 947 2381 947 1747 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-32" x="276.416016"></use> <use xlink:href="#DejaVuSans-2c" x="340.039062"></use> <use xlink:href="#DejaVuSans-20" x="371.826172"></use> <use xlink:href="#DejaVuSans-4b" x="403.613281"></use> <use xlink:href="#DejaVuSans-64" x="469.189453"></use> <use xlink:href="#DejaVuSans-20" x="532.666016"></use> <use xlink:href="#DejaVuSans-3d" x="564.453125"></use> <use xlink:href="#DejaVuSans-20" x="648.242188"></use> <use xlink:href="#DejaVuSans-30" x="680.029297"></use> </g> </g> <g id="line2d_21"><path d="M 284.266875 248.969937 L 294.266875 248.969937 L 304.266875 248.969937 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_18"> <g transform="translate(312.266875 252.469937)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-32" x="276.416016"></use> <use xlink:href="#DejaVuSans-2c" x="340.039062"></use> <use xlink:href="#DejaVuSans-20" x="371.826172"></use> <use xlink:href="#DejaVuSans-4b" x="403.613281"></use> <use xlink:href="#DejaVuSans-64" x="469.189453"></use> <use xlink:href="#DejaVuSans-20" x="532.666016"></use> <use xlink:href="#DejaVuSans-3d" x="564.453125"></use> <use xlink:href="#DejaVuSans-20" x="648.242188"></use> <use xlink:href="#DejaVuSans-31" x="680.029297"></use> </g> </g> <g id="line2d_22"><path d="M 284.266875 263.648062 L 294.266875 263.648062 L 304.266875 263.648062 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_19"> <g transform="translate(312.266875 267.148062)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-32" x="276.416016"></use> <use xlink:href="#DejaVuSans-2c" x="340.039062"></use> <use xlink:href="#DejaVuSans-20" x="371.826172"></use> <use xlink:href="#DejaVuSans-4b" x="403.613281"></use> <use xlink:href="#DejaVuSans-64" x="469.189453"></use> <use xlink:href="#DejaVuSans-20" x="532.666016"></use> <use xlink:href="#DejaVuSans-3d" x="564.453125"></use> <use xlink:href="#DejaVuSans-20" x="648.242188"></use> <use xlink:href="#DejaVuSans-31" x="680.029297"></use> <use xlink:href="#DejaVuSans-30" x="743.652344"></use> </g> </g> <g id="line2d_23"><path d="M 284.266875 278.326188 L 294.266875 278.326188 L 304.266875 278.326188 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_20"> <g transform="translate(312.266875 281.826188)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-32" x="276.416016"></use> <use xlink:href="#DejaVuSans-2c" x="340.039062"></use> <use xlink:href="#DejaVuSans-20" x="371.826172"></use> <use xlink:href="#DejaVuSans-4b" x="403.613281"></use> <use xlink:href="#DejaVuSans-64" x="469.189453"></use> <use xlink:href="#DejaVuSans-20" x="532.666016"></use> <use xlink:href="#DejaVuSans-3d" x="564.453125"></use> <use xlink:href="#DejaVuSans-20" x="648.242188"></use> <use xlink:href="#DejaVuSans-31" x="680.029297"></use> <use xlink:href="#DejaVuSans-30" x="743.652344"></use> <use xlink:href="#DejaVuSans-30" x="807.275391"></use> </g> </g> <g id="line2d_24"><path d="M 284.266875 293.004312 L 294.266875 293.004312 L 304.266875 293.004312 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_21"> <g transform="translate(312.266875 296.504312)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-32" x="276.416016"></use> <use xlink:href="#DejaVuSans-2c" x="340.039062"></use> <use xlink:href="#DejaVuSans-20" x="371.826172"></use> <use xlink:href="#DejaVuSans-4b" x="403.613281"></use> <use xlink:href="#DejaVuSans-64" x="469.189453"></use> <use xlink:href="#DejaVuSans-20" x="532.666016"></use> <use xlink:href="#DejaVuSans-3d" x="564.453125"></use> <use xlink:href="#DejaVuSans-20" x="648.242188"></use> <use xlink:href="#DejaVuSans-31" x="680.029297"></use> <use xlink:href="#DejaVuSans-30" x="743.652344"></use> <use xlink:href="#DejaVuSans-30" x="807.275391"></use> <use xlink:href="#DejaVuSans-30" x="870.898438"></use> </g> </g> </g> </g> </g> <defs> <clipPath id="p7910aeacdc"> <rect x="57.6" y="41.472" width="357.12" height="266.112"></rect> </clipPath> </defs> </svg><h3 id="updating-our-controller">Updating our Controller</h3><p>We can put together each of our controllers into the final PID controller formulation shown below: <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>input</mtext><mo>=</mo><msub><mi>K</mi><mi>p</mi></msub><mtext>error</mtext><mo>+</mo><msub><mi>K</mi><mi>i</mi></msub><mtext>error</mtext><mtext> </mtext><mi>d</mi><mtext> time</mtext><mo>+</mo><msub><mi>K</mi><mi>d</mi></msub><mfrac><mrow><mi>d</mi><mtext>error</mtext></mrow><mrow><mi>d</mi><mtext> </mtext><mtext>time</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{input} = K_p \text{error} + K_i \text{error} \, d \text{ time} + K_d \frac{d \text{error}}{d \, \text{time}}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>input</span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>error</span></span><span></span><span>+</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>error</span></span><span></span><span>d</span><span><span> time</span></span><span></span><span>+</span><span></span></span><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>d</span><span></span><span><span>time</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>d</span><span><span>error</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> A Python implementation for this controller can be found below.</p><div><div><pre><code><span>import</span> <span>argparse</span>
<span>import</span> <span>itertools</span>
<span>from</span> <span>typing</span> <span>import</span> <span>Optional</span>

<span>import</span> <span>matplotlib.pyplot</span> <span>as</span> <span>plt</span>

<span>class</span> <span>PIDController</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span>
        <span>self</span><span>,</span>
        <span>dt</span><span>:</span> <span>float</span><span>,</span>
        <span>trg_temp</span><span>:</span> <span>float</span><span>,</span>
        <span>kp</span><span>:</span> <span>float</span><span>,</span>
        <span>ki</span><span>:</span> <span>float</span><span>,</span>
        <span>kd</span><span>:</span> <span>float</span><span>,</span>
        <span>v_offset</span><span>:</span> <span>float</span><span>,</span>
    <span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
    <span>&#34;&#34;&#34;Initializes a simple controller.

        Args:
            dt: The timestep size, in seconds
            trg_temp: The target temperature
            kp: The P scaling constant
            ki: The I scaling constant
            kd: The D scaling constant
            v_offset: The zero point voltage
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>dt</span> <span>=</span> <span>dt</span>
        <span>self</span><span>.</span><span>trg_temp</span> <span>=</span> <span>trg_temp</span>
        <span>self</span><span>.</span><span>kp</span> <span>=</span> <span>kp</span>
        <span>self</span><span>.</span><span>ki</span> <span>=</span> <span>ki</span>
        <span>self</span><span>.</span><span>kd</span> <span>=</span> <span>kd</span>
        <span>self</span><span>.</span><span>v_offset</span> <span>=</span> <span>v_offset</span>

        <span>self</span><span>.</span><span>prev_error</span><span>:</span> <span>Optional</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>None</span>
        <span>self</span><span>.</span><span>acc_error</span><span>:</span> <span>Optional</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>None</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>temperature</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span>&#34;&#34;&#34;Gets the target voltage for the current timestep.

        Args:
            temperature: The last observed temperature

        Returns:
            The input voltage for the next timestep
        &#34;&#34;&#34;</span>

        <span>error</span> <span>=</span> <span>self</span><span>.</span><span>trg_temp</span> <span>-</span> <span>temperature</span>

        <span># Proportional control.
</span>        <span>p_term</span> <span>=</span> <span>self</span><span>.</span><span>kp</span> <span>*</span> <span>error</span>

        <span># Integral control.
</span>        <span>acc_error</span> <span>=</span> <span>error</span> <span>if</span> <span>self</span><span>.</span><span>acc_error</span> <span>is</span> <span>None</span> <span>else</span> <span>error</span> <span>+</span> <span>self</span><span>.</span><span>acc_error</span>
        <span>self</span><span>.</span><span>acc_error</span> <span>=</span> <span>acc_error</span>
        <span>i_term</span> <span>=</span> <span>self</span><span>.</span><span>ki</span> <span>*</span> <span>acc_error</span>

        <span># Derivative control.
</span>        <span>delta_error</span> <span>=</span> <span>0.0</span> <span>if</span> <span>self</span><span>.</span><span>prev_error</span> <span>is</span> <span>None</span> <span>else</span> <span>error</span> <span>-</span> <span>self</span><span>.</span><span>prev_error</span>
        <span>self</span><span>.</span><span>prev_error</span> <span>=</span> <span>error</span>
        <span>d_term</span> <span>=</span> <span>self</span><span>.</span><span>kd</span> <span>*</span> <span>delta_error</span>

        <span>return</span> <span>p_term</span> <span>+</span> <span>i_term</span> <span>+</span> <span>d_term</span> <span>+</span> <span>self</span><span>.</span><span>v_offset</span>

<span>class</span> <span>HeaterSimulator</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span>
        <span>self</span><span>,</span>
        <span>dt</span><span>:</span> <span>float</span><span>,</span>
        <span>amb_temp</span><span>:</span> <span>float</span><span>,</span>
        <span>min_voltage</span><span>:</span> <span>float</span><span>,</span>
        <span>max_voltage</span><span>:</span> <span>float</span><span>,</span>
        <span>heat_coeff</span><span>:</span> <span>float</span><span>,</span>
        <span>area</span><span>:</span> <span>float</span><span>,</span>
        <span>voltage_coeff</span><span>:</span> <span>float</span><span>,</span>
        <span>inertia</span><span>:</span> <span>float</span><span>,</span>
    <span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes the heater simulator.

        Args:
            dt: The timestep size, in seconds
            amb_temp: The ambient temperature
            min_voltage: The minimum input voltage
            max_voltage: The maximum input voltage
            heat_coeff: Heat transfer coefficient
            area: Heater surface area
            voltage_coeff: The voltage-to-temperature-delta coefficient
            inertia: System inertia
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>dt</span> <span>=</span> <span>dt</span>
        <span>self</span><span>.</span><span>amb_temp</span> <span>=</span> <span>amb_temp</span>
        <span>self</span><span>.</span><span>min_voltage</span> <span>=</span> <span>min_voltage</span>
        <span>self</span><span>.</span><span>max_voltage</span> <span>=</span> <span>max_voltage</span>
        <span>self</span><span>.</span><span>heat_coeff</span> <span>=</span> <span>heat_coeff</span>
        <span>self</span><span>.</span><span>area</span> <span>=</span> <span>area</span>
        <span>self</span><span>.</span><span>voltage_coeff</span> <span>=</span> <span>voltage_coeff</span>
        <span>self</span><span>.</span><span>inertia</span> <span>=</span> <span>inertia</span>

        <span># Heater temperatures starts at the ambient temperature.
</span>        <span>self</span><span>.</span><span>temperature</span> <span>=</span> <span>amb_temp</span>

        <span># Add some inertia to dtemp.
</span>        <span>self</span><span>.</span><span>dtemp</span> <span>=</span> <span>0.0</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>voltage</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Runs the simulator for one step.

        Args:
            voltage: The input voltage
        &#34;&#34;&#34;</span>

        <span>q_rate</span> <span>=</span> <span>self</span><span>.</span><span>heat_coeff</span> <span>*</span> <span>self</span><span>.</span><span>area</span> <span>*</span> <span>(</span><span>self</span><span>.</span><span>amb_temp</span> <span>-</span> <span>self</span><span>.</span><span>temperature</span><span>)</span>
        <span>v_rate</span> <span>=</span> <span>self</span><span>.</span><span>voltage_coeff</span> <span>*</span> <span>voltage</span>
        <span>trg_dtemp</span> <span>=</span> <span>q_rate</span> <span>+</span> <span>v_rate</span>

        <span>self</span><span>.</span><span>dtemp</span> <span>=</span> <span>self</span><span>.</span><span>inertia</span> <span>*</span> <span>self</span><span>.</span><span>dtemp</span> <span>+</span> <span>(</span><span>1</span> <span>-</span> <span>self</span><span>.</span><span>inertia</span><span>)</span> <span>*</span> <span>trg_dtemp</span>
        <span>self</span><span>.</span><span>temperature</span> <span>+=</span> <span>self</span><span>.</span><span>dtemp</span> <span>*</span> <span>self</span><span>.</span><span>dt</span>

<span>def</span> <span>main</span><span>()</span> <span>-&gt;</span> <span>None</span><span>:</span>
    <span>parser</span> <span>=</span> <span>argparse</span><span>.</span><span>ArgumentParser</span><span>(</span><span>description</span><span>=</span><span>&#34;Heater PID simulation&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--kp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;P scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--ki&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;I scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--kd&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;D scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--dt&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.01</span><span>,</span> <span>help</span><span>=</span><span>&#34;Timestep size&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--total-steps&#34;</span><span>,</span> <span>type</span><span>=</span><span>int</span><span>,</span> <span>default</span><span>=</span><span>10000</span><span>,</span> <span>help</span><span>=</span><span>&#34;Number of simulation steps&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--amb-temp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>20.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Ambient temperature&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--trg-temp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>200.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Target temperature&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--v-offset&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>3.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Offset voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--min-voltage&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Minimum voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--max-voltage&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>24.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Maximum voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--area&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>1e-4</span><span>,</span> <span>help</span><span>=</span><span>&#34;Surface area of the heater&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--heat-coeff&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>100.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Heat transfer coefficient&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--voltage-coeff&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>1.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Voltage coefficient&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--inertia&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.99</span><span>,</span> <span>help</span><span>=</span><span>&#34;System inertia&#34;</span><span>)</span>
    <span>args</span> <span>=</span> <span>parser</span><span>.</span><span>parse_args</span><span>()</span>

    <span># Plots the simulated temperatures.
</span>    <span>plt</span><span>.</span><span>figure</span><span>()</span>

    <span>for</span> <span>kp</span><span>,</span> <span>ki</span><span>,</span> <span>kd</span> <span>in</span> <span>itertools</span><span>.</span><span>product</span><span>(</span><span>args</span><span>.</span><span>kp</span><span>,</span> <span>args</span><span>.</span><span>ki</span><span>,</span> <span>args</span><span>.</span><span>kd</span><span>):</span>
        <span># Simulator.
</span>        <span>simulator</span> <span>=</span> <span>HeaterSimulator</span><span>(</span>
            <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
            <span>amb_temp</span><span>=</span><span>args</span><span>.</span><span>amb_temp</span><span>,</span>
            <span>min_voltage</span><span>=</span><span>args</span><span>.</span><span>min_voltage</span><span>,</span>
            <span>max_voltage</span><span>=</span><span>args</span><span>.</span><span>max_voltage</span><span>,</span>
            <span>heat_coeff</span><span>=</span><span>args</span><span>.</span><span>heat_coeff</span><span>,</span>
            <span>area</span><span>=</span><span>args</span><span>.</span><span>area</span><span>,</span>
            <span>voltage_coeff</span><span>=</span><span>args</span><span>.</span><span>voltage_coeff</span><span>,</span>
            <span>inertia</span><span>=</span><span>args</span><span>.</span><span>inertia</span><span>,</span>
        <span>)</span>

        <span># Controller.
</span>        <span>controller</span> <span>=</span> <span>PIDController</span><span>(</span>
            <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
            <span>trg_temp</span><span>=</span><span>args</span><span>.</span><span>trg_temp</span><span>,</span>
            <span>kp</span><span>=</span><span>kp</span><span>,</span>
            <span>ki</span><span>=</span><span>ki</span><span>,</span>
            <span>kd</span><span>=</span><span>kd</span><span>,</span>
            <span>v_offset</span><span>=</span><span>args</span><span>.</span><span>v_offset</span><span>,</span>
        <span>)</span>

        <span># Heater starts at ambient temperature.
</span>        <span>temperatures</span> <span>=</span> <span>[</span><span>simulator</span><span>.</span><span>temperature</span><span>]</span>
        <span>voltages</span> <span>=</span> <span>[</span><span>0.0</span><span>]</span>
        <span>times</span> <span>=</span> <span>[</span><span>i</span> <span>*</span> <span>args</span><span>.</span><span>dt</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>args</span><span>.</span><span>total_steps</span> <span>+</span> <span>1</span><span>)]</span>

        <span>for</span> <span>_</span> <span>in</span> <span>times</span><span>:</span>
            <span>voltage</span> <span>=</span> <span>controller</span><span>.</span><span>step</span><span>(</span><span>simulator</span><span>.</span><span>temperature</span><span>)</span>
            <span>voltages</span><span>.</span><span>append</span><span>(</span><span>voltage</span><span>)</span>
            <span>simulator</span><span>.</span><span>step</span><span>(</span><span>voltage</span><span>)</span>
            <span>temperatures</span><span>.</span><span>append</span><span>(</span><span>simulator</span><span>.</span><span>temperature</span><span>)</span>

        <span>times</span> <span>=</span> <span>[</span><span>0.0</span><span>]</span> <span>+</span> <span>times</span>

        <span># Plot temperature.
</span>        <span>plt</span><span>.</span><span>plot</span><span>(</span><span>times</span><span>,</span> <span>temperatures</span><span>,</span> <span>label</span><span>=</span><span>f</span><span>&#34;Kp = </span><span>{</span><span>kp</span><span>:</span><span>.</span><span>4</span><span>g</span><span>}</span><span>, Ki = </span><span>{</span><span>ki</span><span>:</span><span>.</span><span>4</span><span>g</span><span>}</span><span>, Kd = </span><span>{</span><span>kd</span><span>:</span><span>.</span><span>4</span><span>g</span><span>}</span><span>&#34;</span><span>)</span>
        <span>plt</span><span>.</span><span>ylabel</span><span>(</span><span>&#34;Temperature&#34;</span><span>)</span>

        <span># Plot voltages.
</span>        <span># plt.plot(times, voltages, label=f&#34;Kp = {kp:.4g}&#34;)
</span>        <span># plt.ylabel(&#34;Voltage&#34;)
</span>
    <span>plt</span><span>.</span><span>xlabel</span><span>(</span><span>&#34;Time&#34;</span><span>)</span>
    <span>plt</span><span>.</span><span>legend</span><span>()</span>
    <span>plt</span><span>.</span><span>show</span><span>()</span>

<span>if</span> <span>__name__</span> <span>==</span> <span>&#34;__main__&#34;</span><span>:</span>
    <span>main</span><span>()</span>
</code></pre></div></div><p>The snippet below has just the code for the controller, without the boilerplate for running it.</p><div><div><pre><code><span>class</span> <span>PIDController</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span>
        <span>self</span><span>,</span>
        <span>dt</span><span>:</span> <span>float</span><span>,</span>
        <span>trg_temp</span><span>:</span> <span>float</span><span>,</span>
        <span>kp</span><span>:</span> <span>float</span><span>,</span>
        <span>ki</span><span>:</span> <span>float</span><span>,</span>
        <span>kd</span><span>:</span> <span>float</span><span>,</span>
        <span>v_offset</span><span>:</span> <span>float</span><span>,</span>
    <span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes a simple controller.

        Args:
            dt: The timestep size, in seconds
            trg_temp: The target temperature
            kp: The P scaling constant
            ki: The I scaling constant
            kd: The D scaling constant
            v_offset: The zero point voltage
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>dt</span> <span>=</span> <span>dt</span>
        <span>self</span><span>.</span><span>trg_temp</span> <span>=</span> <span>trg_temp</span>
        <span>self</span><span>.</span><span>kp</span> <span>=</span> <span>kp</span>
        <span>self</span><span>.</span><span>ki</span> <span>=</span> <span>ki</span>
        <span>self</span><span>.</span><span>kd</span> <span>=</span> <span>kd</span>
        <span>self</span><span>.</span><span>v_offset</span> <span>=</span> <span>v_offset</span>

        <span>self</span><span>.</span><span>prev_error</span><span>:</span> <span>Optional</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>None</span>
        <span>self</span><span>.</span><span>acc_error</span><span>:</span> <span>Optional</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>None</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>temperature</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span>&#34;&#34;&#34;Gets the target voltage for the current timestep.

        Args:
            temperature: The last observed temperature

        Returns:
            The input voltage for the next timestep
        &#34;&#34;&#34;</span>

        <span>error</span> <span>=</span> <span>self</span><span>.</span><span>trg_temp</span> <span>-</span> <span>temperature</span>

        <span># Proportional control.
</span>        <span>p_term</span> <span>=</span> <span>self</span><span>.</span><span>kp</span> <span>*</span> <span>error</span>

        <span># Integral control.
</span>        <span>acc_error</span> <span>=</span> <span>error</span> <span>if</span> <span>self</span><span>.</span><span>acc_error</span> <span>is</span> <span>None</span> <span>else</span> <span>error</span> <span>+</span> <span>self</span><span>.</span><span>acc_error</span>
        <span>self</span><span>.</span><span>acc_error</span> <span>=</span> <span>acc_error</span>
        <span>i_term</span> <span>=</span> <span>self</span><span>.</span><span>ki</span> <span>*</span> <span>acc_error</span>

        <span># Derivative control.
</span>        <span>delta_error</span> <span>=</span> <span>0.0</span> <span>if</span> <span>self</span><span>.</span><span>prev_error</span> <span>is</span> <span>None</span> <span>else</span> <span>error</span> <span>-</span> <span>self</span><span>.</span><span>prev_error</span>
        <span>self</span><span>.</span><span>prev_error</span> <span>=</span> <span>error</span>
        <span>d_term</span> <span>=</span> <span>self</span><span>.</span><span>kd</span> <span>*</span> <span>delta_error</span>

        <span>return</span> <span>p_term</span> <span>+</span> <span>i_term</span> <span>+</span> <span>d_term</span> <span>+</span> <span>self</span><span>.</span><span>v_offset</span>

</code></pre></div></div><h2 id="how-can-you-make-one-yourself">How Can you Make One Yourself?</h2><p>Now that we’ve figured out the basic formulation for PID controllers, how can we figure out the values for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">K_I</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>I</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> which give us the best behavior?</p><p>There are a few methods for doing this, and it depends a lot on the particular scenario. Some relevant questions:</p><ul><li>Can you run the control algorithm many times, or is it important to run it only a few times?</li><li>Is there a lot of noise in the system, or if you run the same control algorithm with the same parameters will the result be relatively similar each time?</li></ul><p>There are many packages and techniques which will figure out these parameters for you, but if you’re in a pinch you can follow the approach below.</p><ol><li>Choose an objective to minimize</li><li>Do a grid search over <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">K_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></li><li>Choose the values of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">K_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> which minimize that objective</li></ol><h3 id="define-the-objective-to-minimize">Define the Objective to Minimize</h3><p>For most PID controllers, you care about making the output reach the set point as quickly as possible, without overshoot. Different applications can tolerate different amount of overshoot and undershoot, so the metric might vary. However, in this application I’m going to choose a simple error function which optimizes for both quickly reaching the target and not overshooting, by taking the absolute error when the output is less than the set point and the squared error when the output is greater than the set point.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext>error</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mtext>set point</mtext><mo>−</mo><mtext>output</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>L</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>T</mi></msubsup><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mtext>error</mtext><mi>t</mi><mn>2</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if </mtext><msub><mtext>error</mtext><mi>t</mi></msub><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mtext>error</mtext><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>if otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex"> \begin{aligned} \text{error} &amp; = \text{set point} - \text{output} \\ L &amp; = \int_0^T \begin{cases} \text{error}_t^2 &amp; \text{if } \text{error}_t &lt; 0 \\ \text{error}_t &amp; \text{if } \text{otherwise} \end{cases} \end{aligned} dt </annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span>error</span></span></span></span><span><span></span><span><span>L</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span>set point</span></span><span></span><span>−</span><span></span><span><span>output</span></span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span>∫</span><span><span><span><span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>T</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span><span><span>{</span></span><span><span><span><span><span><span><span><span></span><span><span><span><span>error</span></span><span><span><span><span><span><span></span><span><span>t</span></span></span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span><span><span><span>error</span></span><span><span><span><span><span><span></span><span><span>t</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>if </span></span><span><span><span>error</span></span><span><span><span><span><span><span></span><span><span>t</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>&lt;</span><span></span><span>0</span></span></span><span><span></span><span><span><span>if </span></span><span><span>otherwise</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span>d</span><span>t</span></span></span></span></span></p><h3 id="do-a-grid-search-over-kpk_pkp-kik_iki-and-kdk_dkd">Do a Grid Search over <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">K_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></h3><p>I’ve included a script which can be used for sweeping different PID configurations for our original simulation.</p><div><div><pre><code><span>import</span> <span>argparse</span>
<span>import</span> <span>itertools</span>
<span>from</span> <span>typing</span> <span>import</span> <span>List</span><span>,</span> <span>Optional</span><span>,</span> <span>Tuple</span>

<span>import</span> <span>matplotlib.pyplot</span> <span>as</span> <span>plt</span>

<span>class</span> <span>PIDController</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span>
        <span>self</span><span>,</span>
        <span>dt</span><span>:</span> <span>float</span><span>,</span>
        <span>trg_temp</span><span>:</span> <span>float</span><span>,</span>
        <span>kp</span><span>:</span> <span>float</span><span>,</span>
        <span>ki</span><span>:</span> <span>float</span><span>,</span>
        <span>kd</span><span>:</span> <span>float</span><span>,</span>
        <span>v_offset</span><span>:</span> <span>float</span><span>,</span>
    <span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes a simple controller.

        Args:
            dt: The timestep size, in seconds
            trg_temp: The target temperature
            kp: The P scaling constant
            ki: The I scaling constant
            kd: The D scaling constant
            v_offset: The zero point voltage

        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>dt</span> <span>=</span> <span>dt</span>
        <span>self</span><span>.</span><span>trg_temp</span> <span>=</span> <span>trg_temp</span>
        <span>self</span><span>.</span><span>kp</span> <span>=</span> <span>kp</span>
        <span>self</span><span>.</span><span>ki</span> <span>=</span> <span>ki</span>
        <span>self</span><span>.</span><span>kd</span> <span>=</span> <span>kd</span>
        <span>self</span><span>.</span><span>v_offset</span> <span>=</span> <span>v_offset</span>

        <span>self</span><span>.</span><span>prev_error</span><span>:</span> <span>Optional</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>None</span>
        <span>self</span><span>.</span><span>acc_error</span><span>:</span> <span>Optional</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>None</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>temperature</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>Tuple</span><span>[</span><span>float</span><span>,</span> <span>float</span><span>]:</span>
        <span>&#34;&#34;&#34;Gets the target voltage for the current timestep.

        Args:
            temperature: The last observed temperature

        Returns:
            The input voltage for the next timestep
        &#34;&#34;&#34;</span>

        <span>error</span> <span>=</span> <span>self</span><span>.</span><span>trg_temp</span> <span>-</span> <span>temperature</span>

        <span># Proportional control.
</span>        <span>p_term</span> <span>=</span> <span>self</span><span>.</span><span>kp</span> <span>*</span> <span>error</span>

        <span># Integral control.
</span>        <span>acc_error</span> <span>=</span> <span>error</span> <span>if</span> <span>self</span><span>.</span><span>acc_error</span> <span>is</span> <span>None</span> <span>else</span> <span>error</span> <span>+</span> <span>self</span><span>.</span><span>acc_error</span>
        <span>self</span><span>.</span><span>acc_error</span> <span>=</span> <span>acc_error</span>
        <span>i_term</span> <span>=</span> <span>self</span><span>.</span><span>ki</span> <span>*</span> <span>acc_error</span>

        <span># Derivative control.
</span>        <span>delta_error</span> <span>=</span> <span>0.0</span> <span>if</span> <span>self</span><span>.</span><span>prev_error</span> <span>is</span> <span>None</span> <span>else</span> <span>error</span> <span>-</span> <span>self</span><span>.</span><span>prev_error</span>
        <span>self</span><span>.</span><span>prev_error</span> <span>=</span> <span>error</span>
        <span>d_term</span> <span>=</span> <span>self</span><span>.</span><span>kd</span> <span>*</span> <span>delta_error</span>

        <span>return</span> <span>p_term</span> <span>+</span> <span>i_term</span> <span>+</span> <span>d_term</span> <span>+</span> <span>self</span><span>.</span><span>v_offset</span><span>,</span> <span>error</span>

<span>class</span> <span>HeaterSimulator</span><span>:</span>
    <span>def</span> <span>__init__</span><span>(</span>
        <span>self</span><span>,</span>
        <span>dt</span><span>:</span> <span>float</span><span>,</span>
        <span>amb_temp</span><span>:</span> <span>float</span><span>,</span>
        <span>min_voltage</span><span>:</span> <span>float</span><span>,</span>
        <span>max_voltage</span><span>:</span> <span>float</span><span>,</span>
        <span>heat_coeff</span><span>:</span> <span>float</span><span>,</span>
        <span>area</span><span>:</span> <span>float</span><span>,</span>
        <span>voltage_coeff</span><span>:</span> <span>float</span><span>,</span>
        <span>inertia</span><span>:</span> <span>float</span><span>,</span>
    <span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Initializes the heater simulator.

        Args:
            dt: The timestep size, in seconds
            amb_temp: The ambient temperature
            min_voltage: The minimum input voltage
            max_voltage: The maximum input voltage
            heat_coeff: Heat transfer coefficient
            area: Heater surface area
            voltage_coeff: The voltage-to-temperature-delta coefficient
            inertia: System inertia
        &#34;&#34;&#34;</span>

        <span>self</span><span>.</span><span>dt</span> <span>=</span> <span>dt</span>
        <span>self</span><span>.</span><span>amb_temp</span> <span>=</span> <span>amb_temp</span>
        <span>self</span><span>.</span><span>min_voltage</span> <span>=</span> <span>min_voltage</span>
        <span>self</span><span>.</span><span>max_voltage</span> <span>=</span> <span>max_voltage</span>
        <span>self</span><span>.</span><span>heat_coeff</span> <span>=</span> <span>heat_coeff</span>
        <span>self</span><span>.</span><span>area</span> <span>=</span> <span>area</span>
        <span>self</span><span>.</span><span>voltage_coeff</span> <span>=</span> <span>voltage_coeff</span>
        <span>self</span><span>.</span><span>inertia</span> <span>=</span> <span>inertia</span>

        <span># Heater temperatures starts at the ambient temperature.
</span>        <span>self</span><span>.</span><span>temperature</span> <span>=</span> <span>amb_temp</span>

        <span># Add some inertia to dtemp.
</span>        <span>self</span><span>.</span><span>dtemp</span> <span>=</span> <span>0.0</span>

    <span>def</span> <span>step</span><span>(</span><span>self</span><span>,</span> <span>voltage</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>None</span><span>:</span>
        <span>&#34;&#34;&#34;Runs the simulator for one step.

        Args:
            voltage: The input voltage
        &#34;&#34;&#34;</span>

        <span>q_rate</span> <span>=</span> <span>self</span><span>.</span><span>heat_coeff</span> <span>*</span> <span>self</span><span>.</span><span>area</span> <span>*</span> <span>(</span><span>self</span><span>.</span><span>amb_temp</span> <span>-</span> <span>self</span><span>.</span><span>temperature</span><span>)</span>
        <span>v_rate</span> <span>=</span> <span>self</span><span>.</span><span>voltage_coeff</span> <span>*</span> <span>voltage</span>
        <span>trg_dtemp</span> <span>=</span> <span>q_rate</span> <span>+</span> <span>v_rate</span>

        <span>self</span><span>.</span><span>dtemp</span> <span>=</span> <span>self</span><span>.</span><span>inertia</span> <span>*</span> <span>self</span><span>.</span><span>dtemp</span> <span>+</span> <span>(</span><span>1</span> <span>-</span> <span>self</span><span>.</span><span>inertia</span><span>)</span> <span>*</span> <span>trg_dtemp</span>
        <span>self</span><span>.</span><span>temperature</span> <span>+=</span> <span>self</span><span>.</span><span>dtemp</span> <span>*</span> <span>self</span><span>.</span><span>dt</span>

<span>def</span> <span>main</span><span>()</span> <span>-&gt;</span> <span>None</span><span>:</span>
    <span>parser</span> <span>=</span> <span>argparse</span><span>.</span><span>ArgumentParser</span><span>(</span><span>description</span><span>=</span><span>&#34;Heater PID simulation&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--kp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;P scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--ki&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;I scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--kd&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>nargs</span><span>=</span><span>&#34;+&#34;</span><span>,</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;D scale&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--plot&#34;</span><span>,</span> <span>type</span><span>=</span><span>str</span><span>,</span> <span>choices</span><span>=</span><span>[</span><span>&#34;kp&#34;</span><span>,</span> <span>&#34;ki&#34;</span><span>,</span> <span>&#34;kd&#34;</span><span>],</span> <span>required</span><span>=</span><span>True</span><span>,</span> <span>help</span><span>=</span><span>&#34;Which to plot&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--num-samples&#34;</span><span>,</span> <span>type</span><span>=</span><span>int</span><span>,</span> <span>default</span><span>=</span><span>100</span><span>,</span> <span>help</span><span>=</span><span>&#34;Number of samples&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--dt&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.01</span><span>,</span> <span>help</span><span>=</span><span>&#34;Timestep size&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--total-steps&#34;</span><span>,</span> <span>type</span><span>=</span><span>int</span><span>,</span> <span>default</span><span>=</span><span>10000</span><span>,</span> <span>help</span><span>=</span><span>&#34;Number of simulation steps&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--amb-temp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>20.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Ambient temperature&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--trg-temp&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>200.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Target temperature&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--v-offset&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>3.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Offset voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--min-voltage&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Minimum voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--max-voltage&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>24.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Maximum voltage&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--area&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>1e-4</span><span>,</span> <span>help</span><span>=</span><span>&#34;Surface area of the heater&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--heat-coeff&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>100.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Heat transfer coefficient&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--voltage-coeff&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>1.0</span><span>,</span> <span>help</span><span>=</span><span>&#34;Voltage coefficient&#34;</span><span>)</span>
    <span>parser</span><span>.</span><span>add_argument</span><span>(</span><span>&#34;--inertia&#34;</span><span>,</span> <span>type</span><span>=</span><span>float</span><span>,</span> <span>default</span><span>=</span><span>0.99</span><span>,</span> <span>help</span><span>=</span><span>&#34;System inertia&#34;</span><span>)</span>
    <span>args</span> <span>=</span> <span>parser</span><span>.</span><span>parse_args</span><span>()</span>

    <span>def</span> <span>error_func</span><span>(</span><span>error</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span>return</span> <span>error</span> <span>if</span> <span>error</span> <span>&gt;</span> <span>0</span> <span>else</span> <span>error</span><span>**</span><span>2</span>

    <span>def</span> <span>get_error</span><span>(</span><span>kp</span><span>:</span> <span>float</span><span>,</span> <span>ki</span><span>:</span> <span>float</span><span>,</span> <span>kd</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
        <span># Simulator.
</span>        <span>simulator</span> <span>=</span> <span>HeaterSimulator</span><span>(</span>
            <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
            <span>amb_temp</span><span>=</span><span>args</span><span>.</span><span>amb_temp</span><span>,</span>
            <span>min_voltage</span><span>=</span><span>args</span><span>.</span><span>min_voltage</span><span>,</span>
            <span>max_voltage</span><span>=</span><span>args</span><span>.</span><span>max_voltage</span><span>,</span>
            <span>heat_coeff</span><span>=</span><span>args</span><span>.</span><span>heat_coeff</span><span>,</span>
            <span>area</span><span>=</span><span>args</span><span>.</span><span>area</span><span>,</span>
            <span>voltage_coeff</span><span>=</span><span>args</span><span>.</span><span>voltage_coeff</span><span>,</span>
            <span>inertia</span><span>=</span><span>args</span><span>.</span><span>inertia</span><span>,</span>
        <span>)</span>

        <span># Controller.
</span>        <span>controller</span> <span>=</span> <span>PIDController</span><span>(</span>
            <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
            <span>trg_temp</span><span>=</span><span>args</span><span>.</span><span>trg_temp</span><span>,</span>
            <span>kp</span><span>=</span><span>kp</span><span>,</span>
            <span>ki</span><span>=</span><span>ki</span><span>,</span>
            <span>kd</span><span>=</span><span>kd</span><span>,</span>
            <span>v_offset</span><span>=</span><span>args</span><span>.</span><span>v_offset</span><span>,</span>
        <span>)</span>

        <span>times</span> <span>=</span> <span>[</span><span>i</span> <span>*</span> <span>args</span><span>.</span><span>dt</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>args</span><span>.</span><span>total_steps</span> <span>+</span> <span>1</span><span>)]</span>
        <span>total_error</span> <span>=</span> <span>0.0</span>

        <span>for</span> <span>_</span> <span>in</span> <span>times</span><span>:</span>
            <span>voltage</span><span>,</span> <span>error</span> <span>=</span> <span>controller</span><span>.</span><span>step</span><span>(</span><span>simulator</span><span>.</span><span>temperature</span><span>)</span>
            <span>simulator</span><span>.</span><span>step</span><span>(</span><span>voltage</span><span>)</span>
            <span>total_error</span> <span>+=</span> <span>error_func</span><span>(</span><span>error</span><span>)</span> <span>*</span> <span>args</span><span>.</span><span>dt</span>

        <span>return</span> <span>total_error</span>

    <span>kps</span> <span>=</span> <span>args</span><span>.</span><span>kp</span>
    <span>kis</span> <span>=</span> <span>args</span><span>.</span><span>ki</span>
    <span>kds</span> <span>=</span> <span>args</span><span>.</span><span>kd</span>
    <span>index</span> <span>=</span> <span>0</span> <span>if</span> <span>args</span><span>.</span><span>plot</span> <span>==</span> <span>&#34;kp&#34;</span> <span>else</span> <span>1</span> <span>if</span> <span>args</span><span>.</span><span>plot</span> <span>==</span> <span>&#34;ki&#34;</span> <span>else</span> <span>2</span>

    <span>def</span> <span>linspace</span><span>(</span><span>vals</span><span>:</span> <span>List</span><span>[</span><span>float</span><span>])</span> <span>-&gt;</span> <span>List</span><span>[</span><span>float</span><span>]:</span>
        <span>assert</span> <span>len</span><span>(</span><span>vals</span><span>)</span> <span>==</span> <span>2</span><span>,</span> <span>f</span><span>&#34;Expected `</span><span>{</span><span>args</span><span>.</span><span>plot</span><span>}</span><span>` to have exactly two items, not </span><span>{</span><span>len</span><span>(</span><span>vals</span><span>)</span><span>}</span><span>&#34;</span>
        <span>min_val</span><span>,</span> <span>max_val</span> <span>=</span> <span>vals</span>
        <span>return</span> <span>[</span><span>i</span> <span>*</span> <span>(</span><span>max_val</span> <span>-</span> <span>min_val</span><span>)</span> <span>/</span> <span>(</span><span>args</span><span>.</span><span>num_samples</span> <span>-</span> <span>1</span><span>)</span> <span>+</span> <span>min_val</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>args</span><span>.</span><span>num_samples</span><span>)]</span>

    <span>if</span> <span>index</span> <span>==</span> <span>0</span><span>:</span>
        <span>kcs</span><span>,</span> <span>kas</span><span>,</span> <span>kbs</span> <span>=</span> <span>(</span><span>&#34;Kp&#34;</span><span>,</span> <span>linspace</span><span>(</span><span>kps</span><span>)),</span> <span>(</span><span>&#34;Ki&#34;</span><span>,</span> <span>kis</span><span>),</span> <span>(</span><span>&#34;Kd&#34;</span><span>,</span> <span>kds</span><span>)</span>
    <span>elif</span> <span>index</span> <span>==</span> <span>1</span><span>:</span>
        <span>kcs</span><span>,</span> <span>kas</span><span>,</span> <span>kbs</span> <span>=</span> <span>(</span><span>&#34;Ki&#34;</span><span>,</span> <span>linspace</span><span>(</span><span>kis</span><span>)),</span> <span>(</span><span>&#34;Kp&#34;</span><span>,</span> <span>kps</span><span>),</span> <span>(</span><span>&#34;Kd&#34;</span><span>,</span> <span>kds</span><span>)</span>
    <span>else</span><span>:</span>
        <span>kcs</span><span>,</span> <span>kas</span><span>,</span> <span>kbs</span> <span>=</span> <span>(</span><span>&#34;Kd&#34;</span><span>,</span> <span>linspace</span><span>(</span><span>kds</span><span>)),</span> <span>(</span><span>&#34;Kp&#34;</span><span>,</span> <span>kps</span><span>),</span> <span>(</span><span>&#34;Ki&#34;</span><span>,</span> <span>kis</span><span>)</span>

    <span>plt</span><span>.</span><span>figure</span><span>()</span>

    <span>for</span> <span>ka</span><span>,</span> <span>kb</span> <span>in</span> <span>itertools</span><span>.</span><span>product</span><span>(</span><span>kas</span><span>[</span><span>1</span><span>],</span> <span>kbs</span><span>[</span><span>1</span><span>]):</span>
        <span>values</span><span>:</span> <span>List</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>[]</span>
        <span>errors</span><span>:</span> <span>List</span><span>[</span><span>float</span><span>]</span> <span>=</span> <span>[]</span>
        <span>for</span> <span>kc</span> <span>in</span> <span>kcs</span><span>[</span><span>1</span><span>]:</span>
            <span>vals</span> <span>=</span> <span>{</span><span>kas</span><span>[</span><span>0</span><span>]:</span> <span>ka</span><span>,</span> <span>kbs</span><span>[</span><span>0</span><span>]:</span> <span>kb</span><span>,</span> <span>kcs</span><span>[</span><span>0</span><span>]:</span> <span>kc</span><span>}</span>
            <span>kp</span><span>,</span> <span>ki</span><span>,</span> <span>kd</span> <span>=</span> <span>vals</span><span>[</span><span>&#34;Kp&#34;</span><span>],</span> <span>vals</span><span>[</span><span>&#34;Ki&#34;</span><span>],</span> <span>vals</span><span>[</span><span>&#34;Kd&#34;</span><span>]</span>
            <span>values</span><span>.</span><span>append</span><span>(</span><span>kc</span><span>)</span>
            <span>errors</span><span>.</span><span>append</span><span>(</span><span>get_error</span><span>(</span><span>kp</span><span>,</span> <span>ki</span><span>,</span> <span>kd</span><span>))</span>
        <span>plt</span><span>.</span><span>plot</span><span>(</span><span>values</span><span>,</span> <span>errors</span><span>,</span> <span>label</span><span>=</span><span>f</span><span>&#34;</span><span>{</span><span>kas</span><span>[</span><span>0</span><span>]</span><span>}</span><span>: </span><span>{</span><span>ka</span><span>:</span><span>.</span><span>3</span><span>g</span><span>}</span><span>, </span><span>{</span><span>kbs</span><span>[</span><span>0</span><span>]</span><span>}</span><span>: </span><span>{</span><span>kb</span><span>:</span><span>.</span><span>3</span><span>g</span><span>}</span><span>&#34;</span><span>)</span>

    <span>plt</span><span>.</span><span>xlabel</span><span>([</span><span>&#34;Kp&#34;</span><span>,</span> <span>&#34;Ki&#34;</span><span>,</span> <span>&#34;Kd&#34;</span><span>][</span><span>index</span><span>])</span>
    <span>plt</span><span>.</span><span>ylabel</span><span>(</span><span>&#34;Error&#34;</span><span>)</span>
    <span>plt</span><span>.</span><span>semilogy</span><span>()</span>
    <span>plt</span><span>.</span><span>legend</span><span>()</span>
    <span>plt</span><span>.</span><span>show</span><span>()</span>

<span>if</span> <span>__name__</span> <span>==</span> <span>&#34;__main__&#34;</span><span>:</span>
    <span>main</span><span>()</span>
</code></pre></div></div><p>The snippet below contains just the code for the controller, without the code for running it.</p><div><div><pre><code><span>def</span> <span>error_func</span><span>(</span><span>error</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span>
    <span>return</span> <span>error</span> <span>if</span> <span>error</span> <span>&gt;</span> <span>0</span> <span>else</span> <span>error</span><span>**</span><span>2</span>

<span>def</span> <span>get_error</span><span>(</span><span>kp</span><span>:</span> <span>float</span><span>,</span> <span>ki</span><span>:</span> <span>float</span><span>,</span> <span>kd</span><span>:</span> <span>float</span><span>)</span> <span>-&gt;</span> <span>float</span><span>:</span> <span># Simulator.
</span>    <span>simulator</span> <span>=</span> <span>HeaterSimulator</span><span>(</span>
        <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
        <span>amb_temp</span><span>=</span><span>args</span><span>.</span><span>amb_temp</span><span>,</span>
        <span>min_voltage</span><span>=</span><span>args</span><span>.</span><span>min_voltage</span><span>,</span>
        <span>max_voltage</span><span>=</span><span>args</span><span>.</span><span>max_voltage</span><span>,</span>
        <span>heat_coeff</span><span>=</span><span>args</span><span>.</span><span>heat_coeff</span><span>,</span>
        <span>area</span><span>=</span><span>args</span><span>.</span><span>area</span><span>,</span>
        <span>voltage_coeff</span><span>=</span><span>args</span><span>.</span><span>voltage_coeff</span><span>,</span>
        <span>inertia</span><span>=</span><span>args</span><span>.</span><span>inertia</span><span>,</span>
    <span>)</span>

    <span># Controller.
</span>    <span>controller</span> <span>=</span> <span>PIDController</span><span>(</span>
        <span>dt</span><span>=</span><span>args</span><span>.</span><span>dt</span><span>,</span>
        <span>trg_temp</span><span>=</span><span>args</span><span>.</span><span>trg_temp</span><span>,</span>
        <span>kp</span><span>=</span><span>kp</span><span>,</span>
        <span>ki</span><span>=</span><span>ki</span><span>,</span>
        <span>kd</span><span>=</span><span>kd</span><span>,</span>
        <span>v_offset</span><span>=</span><span>args</span><span>.</span><span>v_offset</span><span>,</span>
    <span>)</span>

    <span>times</span> <span>=</span> <span>[</span><span>i</span> <span>*</span> <span>args</span><span>.</span><span>dt</span> <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>args</span><span>.</span><span>total_steps</span> <span>+</span> <span>1</span><span>)]</span>
    <span>total_error</span> <span>=</span> <span>0.0</span>

    <span>for</span> <span>_</span> <span>in</span> <span>times</span><span>:</span>
        <span>voltage</span><span>,</span> <span>error</span> <span>=</span> <span>controller</span><span>.</span><span>step</span><span>(</span><span>simulator</span><span>.</span><span>temperature</span><span>)</span>
        <span>simulator</span><span>.</span><span>step</span><span>(</span><span>voltage</span><span>)</span>
        <span>total_error</span> <span>+=</span> <span>error_func</span><span>(</span><span>error</span><span>)</span> <span>*</span> <span>args</span><span>.</span><span>dt</span>

    <span>return</span> <span>total_error</span>
</code></pre></div></div><p>The script can be run, for example, using the command below:</p><div><div><pre><code>python sweep.py <span>--kp</span> 0.0 3.0 <span>--ki</span> 0.0 <span>--kd</span> 0.0 10.0 50.0 100.0 <span>--plot</span> kp
</code></pre></div></div><p>Running this command gives the following plot of the error curves generated when varying <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> for different values of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>:</p><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="460.8pt" height="345.6pt" viewBox="0 0 460.8 345.6" version="1.1"><metadata> <rdf:rdf xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <cc:work> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type> <dc:date>2022-10-01T20:24:24.042291</dc:date> <dc:format>image/svg+xml</dc:format> <dc:creator> <cc:agent> <dc:title>Matplotlib v3.5.3, https://matplotlib.org/</dc:title> </cc:agent> </dc:creator> </cc:work> </rdf:rdf> </metadata> <defs></defs> <g id="figure_1"> <g id="patch_1"><path d="M 0 345.6 L 460.8 345.6 L 460.8 0 L 0 0 z "></path> </g> <g id="axes_1"> <g id="patch_2"><path d="M 57.6 307.584 L 414.72 307.584 L 414.72 41.472 L 57.6 41.472 z "></path> </g> <g id="matplotlib.axis_1"> <g id="xtick_1"> <g id="line2d_1"> <defs><path id="m57052cf74e" d="M 0 0 L 0 3.5 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#m57052cf74e" x="73.832727" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_1"> <g transform="translate(65.881165 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-30" d="M 2034 4250 Q 1547 4250 1301 3770 Q 1056 3291 1056 2328 Q 1056 1369 1301 889 Q 1547 409 2034 409 Q 2525 409 2770 889 Q 3016 1369 3016 2328 Q 3016 3291 2770 3770 Q 2525 4250 2034 4250 z M 2034 4750 Q 2819 4750 3233 4129 Q 3647 3509 3647 2328 Q 3647 1150 3233 529 Q 2819 -91 2034 -91 Q 1250 -91 836 529 Q 422 1150 422 2328 Q 422 3509 836 4129 Q 1250 4750 2034 4750 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2e" d="M 684 794 L 1344 794 L 1344 0 L 684 0 L 684 794 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-30"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="95.410156"></use> </g> </g> </g> <g id="xtick_2"> <g id="line2d_2"> <g> <use xlink:href="#m57052cf74e" x="127.941818" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_2"> <g transform="translate(119.990256 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-35" d="M 691 4666 L 3169 4666 L 3169 4134 L 1269 4134 L 1269 2991 Q 1406 3038 1543 3061 Q 1681 3084 1819 3084 Q 2600 3084 3056 2656 Q 3513 2228 3513 1497 Q 3513 744 3044 326 Q 2575 -91 1722 -91 Q 1428 -91 1123 -41 Q 819 9 494 109 L 494 744 Q 775 591 1075 516 Q 1375 441 1709 441 Q 2250 441 2565 725 Q 2881 1009 2881 1497 Q 2881 1984 2565 2268 Q 2250 2553 1709 2553 Q 1456 2553 1204 2497 Q 953 2441 691 2322 L 691 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-30"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="95.410156"></use> </g> </g> </g> <g id="xtick_3"> <g id="line2d_3"> <g> <use xlink:href="#m57052cf74e" x="182.050909" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_3"> <g transform="translate(174.099347 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-31" d="M 794 531 L 1825 531 L 1825 4091 L 703 3866 L 703 4441 L 1819 4666 L 2450 4666 L 2450 531 L 3481 531 L 3481 0 L 794 0 L 794 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="95.410156"></use> </g> </g> </g> <g id="xtick_4"> <g id="line2d_4"> <g> <use xlink:href="#m57052cf74e" x="236.16" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_4"> <g transform="translate(228.208438 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="95.410156"></use> </g> </g> </g> <g id="xtick_5"> <g id="line2d_5"> <g> <use xlink:href="#m57052cf74e" x="290.269091" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_5"> <g transform="translate(282.317528 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-32" d="M 1228 531 L 3431 531 L 3431 0 L 469 0 L 469 531 Q 828 903 1448 1529 Q 2069 2156 2228 2338 Q 2531 2678 2651 2914 Q 2772 3150 2772 3378 Q 2772 3750 2511 3984 Q 2250 4219 1831 4219 Q 1534 4219 1204 4116 Q 875 4013 500 3803 L 500 4441 Q 881 4594 1212 4672 Q 1544 4750 1819 4750 Q 2544 4750 2975 4387 Q 3406 4025 3406 3419 Q 3406 3131 3298 2873 Q 3191 2616 2906 2266 Q 2828 2175 2409 1742 Q 1991 1309 1228 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="95.410156"></use> </g> </g> </g> <g id="xtick_6"> <g id="line2d_6"> <g> <use xlink:href="#m57052cf74e" x="344.378182" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_6"> <g transform="translate(336.426619 322.182437)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="95.410156"></use> </g> </g> </g> <g id="xtick_7"> <g id="line2d_7"> <g> <use xlink:href="#m57052cf74e" x="398.487273" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_7"> <g transform="translate(390.53571 322.182437)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-33" d="M 2597 2516 Q 3050 2419 3304 2112 Q 3559 1806 3559 1356 Q 3559 666 3084 287 Q 2609 -91 1734 -91 Q 1441 -91 1130 -33 Q 819 25 488 141 L 488 750 Q 750 597 1062 519 Q 1375 441 1716 441 Q 2309 441 2620 675 Q 2931 909 2931 1356 Q 2931 1769 2642 2001 Q 2353 2234 1838 2234 L 1294 2234 L 1294 2753 L 1863 2753 Q 2328 2753 2575 2939 Q 2822 3125 2822 3475 Q 2822 3834 2567 4026 Q 2313 4219 1838 4219 Q 1578 4219 1281 4162 Q 984 4106 628 3988 L 628 4550 Q 988 4650 1302 4700 Q 1616 4750 1894 4750 Q 2613 4750 3031 4423 Q 3450 4097 3450 3541 Q 3450 3153 3228 2886 Q 3006 2619 2597 2516 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-33"></use> <use xlink:href="#DejaVuSans-2e" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="95.410156"></use> </g> </g> </g> <g id="text_8"> <g transform="translate(229.706875 335.860562)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-4b" d="M 628 4666 L 1259 4666 L 1259 2694 L 3353 4666 L 4166 4666 L 1850 2491 L 4331 0 L 3500 0 L 1259 2247 L 1259 0 L 628 0 L 628 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-70" d="M 1159 525 L 1159 -1331 L 581 -1331 L 581 3500 L 1159 3500 L 1159 2969 Q 1341 3281 1617 3432 Q 1894 3584 2278 3584 Q 2916 3584 3314 3078 Q 3713 2572 3713 1747 Q 3713 922 3314 415 Q 2916 -91 2278 -91 Q 1894 -91 1617 61 Q 1341 213 1159 525 z M 3116 1747 Q 3116 2381 2855 2742 Q 2594 3103 2138 3103 Q 1681 3103 1420 2742 Q 1159 2381 1159 1747 Q 1159 1113 1420 752 Q 1681 391 2138 391 Q 2594 391 2855 752 Q 3116 1113 3116 1747 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> </g> </g> </g> <g id="matplotlib.axis_2"> <g id="ytick_1"> <g id="line2d_8"> <defs><path id="m59bfd51bf0" d="M 0 0 L -3.5 0 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#m59bfd51bf0" x="57.6" y="227.556438" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_9"> <g transform="translate(33 231.355657)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31" transform="translate(0 0.765625)"></use> <use xlink:href="#DejaVuSans-30" transform="translate(63.623047 0.765625)"></use> <use xlink:href="#DejaVuSans-33" transform="translate(128.203125 39.046875)scale(0.7)"></use> </g> </g> </g> <g id="ytick_2"> <g id="line2d_9"> <g> <use xlink:href="#m59bfd51bf0" x="57.6" y="98.944361" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_10"> <g transform="translate(33 102.743579)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-34" d="M 2419 4116 L 825 1625 L 2419 1625 L 2419 4116 z M 2253 4666 L 3047 4666 L 3047 1625 L 3713 1625 L 3713 1100 L 3047 1100 L 3047 0 L 2419 0 L 2419 1100 L 313 1100 L 313 1709 L 2253 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-31" transform="translate(0 0.684375)"></use> <use xlink:href="#DejaVuSans-30" transform="translate(63.623047 0.684375)"></use> <use xlink:href="#DejaVuSans-34" transform="translate(128.203125 38.965625)scale(0.7)"></use> </g> </g> </g> <g id="ytick_3"> <g id="line2d_10"> <defs><path id="mfb3ce558c5" d="M 0 0 L -2 0 " style="stroke-width: 0.6;"></path> </defs> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="294.80496" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_4"> <g id="line2d_11"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="278.73633" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_5"> <g id="line2d_12"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="266.272532" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_6"> <g id="line2d_13"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="256.088867" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_7"> <g id="line2d_14"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="247.478701" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_8"> <g id="line2d_15"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="240.020236" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_9"> <g id="line2d_16"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="233.441404" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_10"> <g id="line2d_17"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="188.840345" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_11"> <g id="line2d_18"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="166.192882" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_12"> <g id="line2d_19"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="150.124252" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_13"> <g id="line2d_20"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="137.660454" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_14"> <g id="line2d_21"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="127.476789" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_15"> <g id="line2d_22"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="118.866623" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_16"> <g id="line2d_23"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="111.408159" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_17"> <g id="line2d_24"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="104.829326" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="ytick_18"> <g id="line2d_25"> <g> <use xlink:href="#mfb3ce558c5" x="57.6" y="60.228267" style="stroke-width: 0.6;"></use> </g> </g> </g> <g id="text_11"> <g transform="translate(26.920313 186.713156)rotate(-90)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-45" d="M 628 4666 L 3578 4666 L 3578 4134 L 1259 4134 L 1259 2753 L 3481 2753 L 3481 2222 L 1259 2222 L 1259 531 L 3634 531 L 3634 0 L 628 0 L 628 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-72" d="M 2631 2963 Q 2534 3019 2420 3045 Q 2306 3072 2169 3072 Q 1681 3072 1420 2755 Q 1159 2438 1159 1844 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1341 3275 1631 3429 Q 1922 3584 2338 3584 Q 2397 3584 2469 3576 Q 2541 3569 2628 3553 L 2631 2963 z " transform="scale(0.015625)"></path><path id="DejaVuSans-6f" d="M 1959 3097 Q 1497 3097 1228 2736 Q 959 2375 959 1747 Q 959 1119 1226 758 Q 1494 397 1959 397 Q 2419 397 2687 759 Q 2956 1122 2956 1747 Q 2956 2369 2687 2733 Q 2419 3097 1959 3097 z M 1959 3584 Q 2709 3584 3137 3096 Q 3566 2609 3566 1747 Q 3566 888 3137 398 Q 2709 -91 1959 -91 Q 1206 -91 779 398 Q 353 888 353 1747 Q 353 2609 779 3096 Q 1206 3584 1959 3584 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-45"></use> <use xlink:href="#DejaVuSans-72" x="63.183594"></use> <use xlink:href="#DejaVuSans-72" x="102.546875"></use> <use xlink:href="#DejaVuSans-6f" x="141.410156"></use> <use xlink:href="#DejaVuSans-72" x="202.591797"></use> </g> </g> </g> <g id="line2d_26"><path d="M 73.832727 115.94553 L 77.112066 53.568 L 80.391405 73.826492 L 83.670744 98.143769 L 86.950083 118.817774 L 90.229421 136.069904 L 93.50876 150.663262 L 96.788099 163.194349 L 100.067438 174.075376 L 103.346777 183.574331 L 106.626116 191.846284 L 109.905455 198.961184 L 113.184793 204.937328 L 116.464132 209.777506 L 119.743471 213.498158 L 123.02281 216.145869 L 126.302149 217.801122 L 129.581488 218.572517 L 132.860826 218.585868 L 136.140165 217.972225 L 139.419504 216.857846 L 142.698843 215.35724 L 145.978182 213.569594 L 149.257521 211.577602 L 152.53686 209.439032 L 155.816198 207.220909 L 159.095537 204.971122 L 162.374876 202.722664 L 165.654215 200.498945 L 168.933554 198.316414 L 172.212893 196.186287 L 175.492231 194.115992 L 178.77157 192.110033 L 182.050909 190.170894 L 185.330248 188.29944 L 188.609587 186.495504 L 191.888926 184.75808 L 195.168264 183.085626 L 198.447603 181.476185 L 201.726942 179.927621 L 205.006281 178.437621 L 208.28562 177.003808 L 211.564959 175.623759 L 214.844298 174.295141 L 218.123636 173.015612 L 221.402975 171.782882 L 224.682314 170.594795 L 227.961653 169.449228 L 231.240992 168.344203 L 234.520331 167.277813 L 237.799669 166.248189 L 241.079008 165.253667 L 244.358347 164.292465 L 247.637686 163.362656 L 250.917025 162.463085 L 254.196364 161.592479 L 257.475702 160.749577 L 260.755041 159.933172 L 264.03438 159.142115 L 267.313719 158.375304 L 270.593058 157.631703 L 273.872397 156.910283 L 277.151736 156.210126 L 280.431074 155.530366 L 283.710413 154.870094 L 286.989752 154.228563 L 290.269091 153.604964 L 293.54843 152.998631 L 296.827769 152.4088 L 300.107107 151.83488 L 303.386446 151.276234 L 306.665785 150.732247 L 309.945124 150.202384 L 313.224463 149.686121 L 316.503802 149.182927 L 319.78314 148.692307 L 323.062479 148.213823 L 326.341818 147.747035 L 329.621157 147.291529 L 332.900496 146.846894 L 336.179835 146.412752 L 339.459174 145.988744 L 342.738512 145.574514 L 346.017851 145.169737 L 349.29719 144.7741 L 352.576529 144.387278 L 355.855868 144.009007 L 359.135207 143.639001 L 362.414545 143.276994 L 365.693884 142.922724 L 368.973223 142.575905 L 372.252562 142.236273 L 375.531901 141.903663 L 378.81124 141.577865 L 382.090579 141.258677 L 385.369917 140.945874 L 388.649256 140.639285 L 391.928595 140.338753 L 395.207934 140.044092 L 398.487273 139.755091 " clip-path="url(#p1db046c7d6)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_27"><path d="M 73.832727 112.791348 L 77.112066 66.470819 L 80.391405 79.252158 L 83.670744 101.037725 L 86.950083 120.564686 L 90.229421 137.165548 L 93.50876 151.343365 L 96.788099 163.606171 L 100.067438 174.341842 L 103.346777 183.831733 L 106.626116 192.274367 L 109.905455 199.801956 L 113.184793 206.491267 L 116.464132 212.374395 L 119.743471 217.453531 L 123.02281 221.718676 L 126.302149 225.163936 L 129.581488 227.799007 L 132.860826 229.65465 L 136.140165 230.782846 L 139.419504 231.25291 L 142.698843 231.14558 L 145.978182 230.546502 L 149.257521 229.540488 L 152.53686 228.207169 L 155.816198 226.618345 L 159.095537 224.836514 L 162.374876 222.913346 L 165.654215 220.885824 L 168.933554 218.801181 L 172.212893 216.692157 L 175.492231 214.582611 L 178.77157 212.490238 L 182.050909 210.428057 L 185.330248 208.405556 L 188.609587 206.429343 L 191.888926 204.503973 L 195.168264 202.632285 L 198.447603 200.815904 L 201.726942 199.055462 L 205.006281 197.350859 L 208.28562 195.701496 L 211.564959 194.106377 L 214.844298 192.564213 L 218.123636 191.073464 L 221.402975 189.632605 L 224.682314 188.239844 L 227.961653 186.893498 L 231.240992 185.591826 L 234.520331 184.333082 L 237.799669 183.115547 L 241.079008 181.937543 L 244.358347 180.797496 L 247.637686 179.693766 L 250.917025 178.62491 L 254.196364 177.589434 L 257.475702 176.58594 L 260.755041 175.613112 L 264.03438 174.669669 L 267.313719 173.754393 L 270.593058 172.866121 L 273.872397 172.003383 L 277.151736 171.165286 L 280.431074 170.350917 L 283.710413 169.559435 L 286.989752 168.789955 L 290.269091 168.04156 L 293.54843 167.313536 L 296.827769 166.605011 L 300.107107 165.915341 L 303.386446 165.243712 L 306.665785 164.589545 L 309.945124 163.952133 L 313.224463 163.330858 L 316.503802 162.725172 L 319.78314 162.134504 L 323.062479 161.558268 L 326.341818 160.995992 L 329.621157 160.447192 L 332.900496 159.911394 L 336.179835 159.388139 L 339.459174 158.877012 L 342.738512 158.377597 L 346.017851 157.88949 L 349.29719 157.412334 L 352.576529 156.945761 L 355.855868 156.489421 L 359.135207 156.043002 L 362.414545 155.606165 L 365.693884 155.178629 L 368.973223 154.7601 L 372.252562 154.350302 L 375.531901 153.948967 L 378.81124 153.555836 L 382.090579 153.170658 L 385.369917 152.793161 L 388.649256 152.423164 L 391.928595 152.060451 L 395.207934 151.704801 L 398.487273 151.355986 " clip-path="url(#p1db046c7d6)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_28"><path d="M 73.832727 99.144569 L 77.112066 115.686591 L 80.391405 103.204078 L 83.670744 113.347423 L 86.950083 127.445863 L 90.229421 141.019757 L 93.50876 153.247876 L 96.788099 164.132426 L 100.067438 173.8423 L 103.346777 182.556803 L 106.626116 190.431288 L 109.905455 197.593443 L 113.184793 204.146792 L 116.464132 210.175233 L 119.743471 215.747021 L 123.02281 220.917917 L 126.302149 225.733563 L 129.581488 230.231212 L 132.860826 234.440895 L 136.140165 238.386155 L 139.419504 242.084412 L 142.698843 245.547121 L 145.978182 248.779964 L 149.257521 251.783279 L 152.53686 254.552942 L 155.816198 257.081644 L 159.095537 259.360431 L 162.374876 261.380262 L 165.654215 263.133419 L 168.933554 264.614609 L 172.212893 265.821759 L 175.492231 266.756474 L 178.77157 267.424093 L 182.050909 267.833578 L 185.330248 267.997104 L 188.609587 267.929495 L 191.888926 267.647681 L 195.168264 267.169958 L 198.447603 266.515385 L 201.726942 265.703214 L 205.006281 264.752402 L 208.28562 263.681192 L 211.564959 262.506933 L 214.844298 261.245724 L 218.123636 259.91236 L 221.402975 258.517955 L 224.682314 257.072188 L 227.961653 255.590169 L 231.240992 254.082992 L 234.520331 252.559707 L 237.799669 251.028067 L 241.079008 249.494494 L 244.358347 247.96441 L 247.637686 246.442398 L 250.917025 244.932326 L 254.196364 243.437303 L 257.475702 241.959953 L 260.755041 240.502275 L 264.03438 239.06601 L 267.313719 237.652465 L 270.593058 236.262613 L 273.872397 234.897164 L 277.151736 233.556726 L 280.431074 232.241536 L 283.710413 230.95184 L 286.989752 229.687578 L 290.269091 228.448754 L 293.54843 227.235199 L 296.827769 226.046641 L 300.107107 224.88276 L 303.386446 223.743209 L 306.665785 222.627583 L 309.945124 221.535472 L 313.224463 220.466427 L 316.503802 219.419991 L 319.78314 218.395684 L 323.062479 217.392903 L 326.341818 216.411297 L 329.621157 215.450292 L 332.900496 214.50938 L 336.179835 213.58811 L 339.459174 212.685947 L 342.738512 211.802417 L 346.017851 210.9371 L 349.29719 210.089391 L 352.576529 209.258946 L 355.855868 208.445322 L 359.135207 207.647983 L 362.414545 206.866545 L 365.693884 206.100611 L 368.973223 205.349759 L 372.252562 204.613591 L 375.531901 203.891729 L 378.81124 203.183737 L 382.090579 202.489295 L 385.369917 201.808041 L 388.649256 201.13964 L 391.928595 200.483733 L 395.207934 199.839994 L 398.487273 199.207951 " clip-path="url(#p1db046c7d6)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="line2d_29"><path d="M 73.832727 90.398865 L 77.112066 126.718779 L 80.391405 130.10986 L 83.670744 129.327486 L 86.950083 136.174947 L 90.229421 145.493593 L 93.50876 155.039851 L 96.788099 164.082048 L 100.067438 172.432999 L 103.346777 180.090884 L 106.626116 187.112004 L 109.905455 193.565831 L 113.184793 199.51951 L 116.464132 205.033105 L 119.743471 210.158756 L 123.02281 214.941204 L 126.302149 219.418724 L 129.581488 223.624087 L 132.860826 227.585435 L 136.140165 231.327029 L 139.419504 234.869873 L 142.698843 238.232232 L 145.978182 241.430062 L 149.257521 244.477349 L 152.53686 247.386408 L 155.816198 250.168114 L 159.095537 252.832093 L 162.374876 255.386889 L 165.654215 257.840088 L 168.933554 260.198425 L 172.212893 262.467869 L 175.492231 264.653675 L 178.77157 266.760438 L 182.050909 268.792109 L 185.330248 270.752003 L 188.609587 272.642791 L 191.888926 274.466479 L 195.168264 276.224387 L 198.447603 277.917132 L 201.726942 279.544624 L 205.006281 281.106101 L 208.28562 282.600169 L 211.564959 284.024898 L 214.844298 285.377914 L 218.123636 286.656538 L 221.402975 287.857882 L 224.682314 288.979037 L 227.961653 290.017145 L 231.240992 290.969557 L 234.520331 291.83391 L 237.799669 292.608227 L 241.079008 293.29099 L 244.358347 293.88112 L 247.637686 294.378178 L 250.917025 294.782216 L 254.196364 295.093798 L 257.475702 295.314136 L 260.755041 295.444816 L 264.03438 295.488 L 267.313719 295.446287 L 270.593058 295.322633 L 273.872397 295.120299 L 277.151736 294.842891 L 280.431074 294.494135 L 283.710413 294.078003 L 286.989752 293.598636 L 290.269091 293.060012 L 293.54843 292.466372 L 296.827769 291.821831 L 300.107107 291.130415 L 303.386446 290.396061 L 306.665785 289.622723 L 309.945124 288.814029 L 313.224463 287.9712 L 316.503802 287.097893 L 319.78314 286.19874 L 323.062479 285.277327 L 326.341818 284.336724 L 329.621157 283.379956 L 332.900496 282.409698 L 336.179835 281.428266 L 339.459174 280.438018 L 342.738512 279.441048 L 346.017851 278.439043 L 349.29719 277.433867 L 352.576529 276.427066 L 355.855868 275.420059 L 359.135207 274.414124 L 362.414545 273.41043 L 365.693884 272.410037 L 368.973223 271.413847 L 372.252562 270.422651 L 375.531901 269.437321 L 378.81124 268.458543 L 382.090579 267.486704 L 385.369917 266.522566 L 388.649256 265.566434 L 391.928595 264.618781 L 395.207934 263.679899 L 398.487273 262.750177 " clip-path="url(#p1db046c7d6)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="patch_3"><path d="M 57.6 307.584 L 57.6 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_4"><path d="M 414.72 307.584 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_5"><path d="M 57.6 307.584 L 414.72 307.584 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_6"><path d="M 57.6 41.472 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="legend_1"> <g id="patch_7"><path d="M 308.577812 108.1845 L 407.72 108.1845 Q 409.72 108.1845 409.72 106.1845 L 409.72 48.472 Q 409.72 46.472 407.72 46.472 L 308.577812 46.472 Q 306.577812 46.472 306.577812 48.472 L 306.577812 106.1845 Q 306.577812 108.1845 308.577812 108.1845 z " style="opacity: 0.8; stroke-linejoin: miter;"></path> </g> <g id="line2d_30"><path d="M 310.577812 54.570438 L 320.577812 54.570438 L 330.577812 54.570438 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_12"> <g transform="translate(338.577812 58.070438)scale(0.1 -0.1)"> <defs><path id="DejaVuSans-69" d="M 603 3500 L 1178 3500 L 1178 0 L 603 0 L 603 3500 z M 603 4863 L 1178 4863 L 1178 4134 L 603 4134 L 603 4863 z " transform="scale(0.015625)"></path><path id="DejaVuSans-3a" d="M 750 794 L 1409 794 L 1409 0 L 750 0 L 750 794 z M 750 3309 L 1409 3309 L 1409 2516 L 750 2516 L 750 3309 z " transform="scale(0.015625)"></path><path id="DejaVuSans-20" transform="scale(0.015625)"></path><path id="DejaVuSans-2c" d="M 750 794 L 1409 794 L 1409 256 L 897 -744 L 494 -744 L 750 256 L 750 794 z " transform="scale(0.015625)"></path><path id="DejaVuSans-64" d="M 2906 2969 L 2906 4863 L 3481 4863 L 3481 0 L 2906 0 L 2906 525 Q 2725 213 2448 61 Q 2172 -91 1784 -91 Q 1150 -91 751 415 Q 353 922 353 1747 Q 353 2572 751 3078 Q 1150 3584 1784 3584 Q 2172 3584 2448 3432 Q 2725 3281 2906 2969 z M 947 1747 Q 947 1113 1208 752 Q 1469 391 1925 391 Q 2381 391 2643 752 Q 2906 1113 2906 1747 Q 2906 2381 2643 2742 Q 2381 3103 1925 3103 Q 1469 3103 1208 2742 Q 947 2381 947 1747 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-69" x="65.576172"></use> <use xlink:href="#DejaVuSans-3a" x="93.359375"></use> <use xlink:href="#DejaVuSans-20" x="127.050781"></use> <use xlink:href="#DejaVuSans-30" x="158.837891"></use> <use xlink:href="#DejaVuSans-2c" x="222.460938"></use> <use xlink:href="#DejaVuSans-20" x="254.248047"></use> <use xlink:href="#DejaVuSans-4b" x="286.035156"></use> <use xlink:href="#DejaVuSans-64" x="351.611328"></use> <use xlink:href="#DejaVuSans-3a" x="415.087891"></use> <use xlink:href="#DejaVuSans-20" x="448.779297"></use> <use xlink:href="#DejaVuSans-30" x="480.566406"></use> </g> </g> <g id="line2d_31"><path d="M 310.577812 69.248563 L 320.577812 69.248563 L 330.577812 69.248563 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_13"> <g transform="translate(338.577812 72.748563)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-69" x="65.576172"></use> <use xlink:href="#DejaVuSans-3a" x="93.359375"></use> <use xlink:href="#DejaVuSans-20" x="127.050781"></use> <use xlink:href="#DejaVuSans-30" x="158.837891"></use> <use xlink:href="#DejaVuSans-2c" x="222.460938"></use> <use xlink:href="#DejaVuSans-20" x="254.248047"></use> <use xlink:href="#DejaVuSans-4b" x="286.035156"></use> <use xlink:href="#DejaVuSans-64" x="351.611328"></use> <use xlink:href="#DejaVuSans-3a" x="415.087891"></use> <use xlink:href="#DejaVuSans-20" x="448.779297"></use> <use xlink:href="#DejaVuSans-31" x="480.566406"></use> <use xlink:href="#DejaVuSans-30" x="544.189453"></use> </g> </g> <g id="line2d_32"><path d="M 310.577812 83.926688 L 320.577812 83.926688 L 330.577812 83.926688 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_14"> <g transform="translate(338.577812 87.426688)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-69" x="65.576172"></use> <use xlink:href="#DejaVuSans-3a" x="93.359375"></use> <use xlink:href="#DejaVuSans-20" x="127.050781"></use> <use xlink:href="#DejaVuSans-30" x="158.837891"></use> <use xlink:href="#DejaVuSans-2c" x="222.460938"></use> <use xlink:href="#DejaVuSans-20" x="254.248047"></use> <use xlink:href="#DejaVuSans-4b" x="286.035156"></use> <use xlink:href="#DejaVuSans-64" x="351.611328"></use> <use xlink:href="#DejaVuSans-3a" x="415.087891"></use> <use xlink:href="#DejaVuSans-20" x="448.779297"></use> <use xlink:href="#DejaVuSans-35" x="480.566406"></use> <use xlink:href="#DejaVuSans-30" x="544.189453"></use> </g> </g> <g id="line2d_33"><path d="M 310.577812 98.604813 L 320.577812 98.604813 L 330.577812 98.604813 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_15"> <g transform="translate(338.577812 102.104813)scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-69" x="65.576172"></use> <use xlink:href="#DejaVuSans-3a" x="93.359375"></use> <use xlink:href="#DejaVuSans-20" x="127.050781"></use> <use xlink:href="#DejaVuSans-30" x="158.837891"></use> <use xlink:href="#DejaVuSans-2c" x="222.460938"></use> <use xlink:href="#DejaVuSans-20" x="254.248047"></use> <use xlink:href="#DejaVuSans-4b" x="286.035156"></use> <use xlink:href="#DejaVuSans-64" x="351.611328"></use> <use xlink:href="#DejaVuSans-3a" x="415.087891"></use> <use xlink:href="#DejaVuSans-20" x="448.779297"></use> <use xlink:href="#DejaVuSans-31" x="480.566406"></use> <use xlink:href="#DejaVuSans-30" x="544.189453"></use> <use xlink:href="#DejaVuSans-30" x="607.8125"></use> </g> </g> </g> </g> </g> <defs> <clipPath id="p1db046c7d6"> <rect x="57.6" y="41.472" width="357.12" height="266.112"></rect> </clipPath> </defs> </svg><p>As this graph shows, the ideal value of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> (the lowest point in the error curve) increases as we increase our value for <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>. This makes sense intuitively; by increasing the derivative term, the temperature will not shoot up as quickly for the same value of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, but we can safely use a higher <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> without worrying about overshooting.</p><h3 id="choose-the-values-of-kpk_pkp-kik_iki-and-kdk_dkd-which-minimize-that-objective">Choose the values of <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">K_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> which minimize that objective</h3><p>Now that we’ve looked at a few different configurations, we can just choose the configuration which minimizes our objective.</p><p>We can plot the associated temperature curve using the command below:</p><div><div><pre><code>python printer.py <span>--kp</span> 1.65 <span>--ki</span> 0.0 <span>--kd</span> 100.0
</code></pre></div></div><p>It looks reasonable, and definitely better than our original curve.</p><svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="460.8pt" height="345.6pt" viewBox="0 0 460.8 345.6" version="1.1"><metadata> <rdf:rdf xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"> <cc:work> <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></dc:type> <dc:date>2022-10-01T23:05:47.246328</dc:date> <dc:format>image/svg+xml</dc:format> <dc:creator> <cc:agent> <dc:title>Matplotlib v3.6.0, https://matplotlib.org/</dc:title> </cc:agent> </dc:creator> </cc:work> </rdf:rdf> </metadata> <defs></defs> <g id="figure_1"> <g id="patch_1"><path d="M 0 345.6 L 460.8 345.6 L 460.8 0 L 0 0 z "></path> </g> <g id="axes_1"> <g id="patch_2"><path d="M 57.6 307.584 L 414.72 307.584 L 414.72 41.472 L 57.6 41.472 z "></path> </g> <g id="matplotlib.axis_1"> <g id="xtick_1"> <g id="line2d_1"> <defs><path id="m2daf9e8527" d="M 0 0 L 0 3.5 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#m2daf9e8527" x="73.832727" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_1"> <g transform="translate(70.651477 322.182437) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-30" d="M 2034 4250 Q 1547 4250 1301 3770 Q 1056 3291 1056 2328 Q 1056 1369 1301 889 Q 1547 409 2034 409 Q 2525 409 2770 889 Q 3016 1369 3016 2328 Q 3016 3291 2770 3770 Q 2525 4250 2034 4250 z M 2034 4750 Q 2819 4750 3233 4129 Q 3647 3509 3647 2328 Q 3647 1150 3233 529 Q 2819 -91 2034 -91 Q 1250 -91 836 529 Q 422 1150 422 2328 Q 422 3509 836 4129 Q 1250 4750 2034 4750 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-30"></use> </g> </g> </g> <g id="xtick_2"> <g id="line2d_2"> <g> <use xlink:href="#m2daf9e8527" x="138.763636" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_2"> <g transform="translate(132.401136 322.182437) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-32" d="M 1228 531 L 3431 531 L 3431 0 L 469 0 L 469 531 Q 828 903 1448 1529 Q 2069 2156 2228 2338 Q 2531 2678 2651 2914 Q 2772 3150 2772 3378 Q 2772 3750 2511 3984 Q 2250 4219 1831 4219 Q 1534 4219 1204 4116 Q 875 4013 500 3803 L 500 4441 Q 881 4594 1212 4672 Q 1544 4750 1819 4750 Q 2544 4750 2975 4387 Q 3406 4025 3406 3419 Q 3406 3131 3298 2873 Q 3191 2616 2906 2266 Q 2828 2175 2409 1742 Q 1991 1309 1228 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_3"> <g id="line2d_3"> <g> <use xlink:href="#m2daf9e8527" x="203.694545" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_3"> <g transform="translate(197.332045 322.182437) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-34" d="M 2419 4116 L 825 1625 L 2419 1625 L 2419 4116 z M 2253 4666 L 3047 4666 L 3047 1625 L 3713 1625 L 3713 1100 L 3047 1100 L 3047 0 L 2419 0 L 2419 1100 L 313 1100 L 313 1709 L 2253 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-34"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_4"> <g id="line2d_4"> <g> <use xlink:href="#m2daf9e8527" x="268.625455" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_4"> <g transform="translate(262.262955 322.182437) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-36" d="M 2113 2584 Q 1688 2584 1439 2293 Q 1191 2003 1191 1497 Q 1191 994 1439 701 Q 1688 409 2113 409 Q 2538 409 2786 701 Q 3034 994 3034 1497 Q 3034 2003 2786 2293 Q 2538 2584 2113 2584 z M 3366 4563 L 3366 3988 Q 3128 4100 2886 4159 Q 2644 4219 2406 4219 Q 1781 4219 1451 3797 Q 1122 3375 1075 2522 Q 1259 2794 1537 2939 Q 1816 3084 2150 3084 Q 2853 3084 3261 2657 Q 3669 2231 3669 1497 Q 3669 778 3244 343 Q 2819 -91 2113 -91 Q 1303 -91 875 529 Q 447 1150 447 2328 Q 447 3434 972 4092 Q 1497 4750 2381 4750 Q 2619 4750 2861 4703 Q 3103 4656 3366 4563 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-36"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_5"> <g id="line2d_5"> <g> <use xlink:href="#m2daf9e8527" x="333.556364" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_5"> <g transform="translate(327.193864 322.182437) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-38" d="M 2034 2216 Q 1584 2216 1326 1975 Q 1069 1734 1069 1313 Q 1069 891 1326 650 Q 1584 409 2034 409 Q 2484 409 2743 651 Q 3003 894 3003 1313 Q 3003 1734 2745 1975 Q 2488 2216 2034 2216 z M 1403 2484 Q 997 2584 770 2862 Q 544 3141 544 3541 Q 544 4100 942 4425 Q 1341 4750 2034 4750 Q 2731 4750 3128 4425 Q 3525 4100 3525 3541 Q 3525 3141 3298 2862 Q 3072 2584 2669 2484 Q 3125 2378 3379 2068 Q 3634 1759 3634 1313 Q 3634 634 3220 271 Q 2806 -91 2034 -91 Q 1263 -91 848 271 Q 434 634 434 1313 Q 434 1759 690 2068 Q 947 2378 1403 2484 z M 1172 3481 Q 1172 3119 1398 2916 Q 1625 2713 2034 2713 Q 2441 2713 2670 2916 Q 2900 3119 2900 3481 Q 2900 3844 2670 4047 Q 2441 4250 2034 4250 Q 1625 4250 1398 4047 Q 1172 3844 1172 3481 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-38"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="xtick_6"> <g id="line2d_6"> <g> <use xlink:href="#m2daf9e8527" x="398.487273" y="307.584" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_6"> <g transform="translate(388.943523 322.182437) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-31" d="M 794 531 L 1825 531 L 1825 4091 L 703 3866 L 703 4441 L 1819 4666 L 2450 4666 L 2450 531 L 3481 531 L 3481 0 L 794 0 L 794 531 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="text_7"> <g transform="translate(223.926406 335.860562) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-54" d="M -19 4666 L 3928 4666 L 3928 4134 L 2272 4134 L 2272 0 L 1638 0 L 1638 4134 L -19 4134 L -19 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-69" d="M 603 3500 L 1178 3500 L 1178 0 L 603 0 L 603 3500 z M 603 4863 L 1178 4863 L 1178 4134 L 603 4134 L 603 4863 z " transform="scale(0.015625)"></path><path id="DejaVuSans-6d" d="M 3328 2828 Q 3544 3216 3844 3400 Q 4144 3584 4550 3584 Q 5097 3584 5394 3201 Q 5691 2819 5691 2113 L 5691 0 L 5113 0 L 5113 2094 Q 5113 2597 4934 2840 Q 4756 3084 4391 3084 Q 3944 3084 3684 2787 Q 3425 2491 3425 1978 L 3425 0 L 2847 0 L 2847 2094 Q 2847 2600 2669 2842 Q 2491 3084 2119 3084 Q 1678 3084 1418 2786 Q 1159 2488 1159 1978 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1356 3278 1631 3431 Q 1906 3584 2284 3584 Q 2666 3584 2933 3390 Q 3200 3197 3328 2828 z " transform="scale(0.015625)"></path><path id="DejaVuSans-65" d="M 3597 1894 L 3597 1613 L 953 1613 Q 991 1019 1311 708 Q 1631 397 2203 397 Q 2534 397 2845 478 Q 3156 559 3463 722 L 3463 178 Q 3153 47 2828 -22 Q 2503 -91 2169 -91 Q 1331 -91 842 396 Q 353 884 353 1716 Q 353 2575 817 3079 Q 1281 3584 2069 3584 Q 2775 3584 3186 3129 Q 3597 2675 3597 1894 z M 3022 2063 Q 3016 2534 2758 2815 Q 2500 3097 2075 3097 Q 1594 3097 1305 2825 Q 1016 2553 972 2059 L 3022 2063 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-69" x="57.958984"></use> <use xlink:href="#DejaVuSans-6d" x="85.742188"></use> <use xlink:href="#DejaVuSans-65" x="183.154297"></use> </g> </g> </g> <g id="matplotlib.axis_2"> <g id="ytick_1"> <g id="line2d_7"> <defs><path id="m3861e12712" d="M 0 0 L -3.5 0 " style="stroke-width: 0.8;"></path> </defs> <g> <use xlink:href="#m3861e12712" x="57.6" y="288.925519" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_8"> <g transform="translate(37.875 292.724738) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-35" d="M 691 4666 L 3169 4666 L 3169 4134 L 1269 4134 L 1269 2991 Q 1406 3038 1543 3061 Q 1681 3084 1819 3084 Q 2600 3084 3056 2656 Q 3513 2228 3513 1497 Q 3513 744 3044 326 Q 2575 -91 1722 -91 Q 1428 -91 1123 -41 Q 819 9 494 109 L 494 744 Q 775 591 1075 516 Q 1375 441 1709 441 Q 2250 441 2565 725 Q 2881 1009 2881 1497 Q 2881 1984 2565 2268 Q 2250 2553 1709 2553 Q 1456 2553 1204 2497 Q 953 2441 691 2322 L 691 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> </g> </g> </g> <g id="ytick_2"> <g id="line2d_8"> <g> <use xlink:href="#m3861e12712" x="57.6" y="256.113115" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_9"> <g transform="translate(37.875 259.912334) scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-35"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> </g> </g> </g> <g id="ytick_3"> <g id="line2d_9"> <g> <use xlink:href="#m3861e12712" x="57.6" y="223.30071" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_10"> <g transform="translate(37.875 227.099929) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-37" d="M 525 4666 L 3525 4666 L 3525 4397 L 1831 0 L 1172 0 L 2766 4134 L 525 4134 L 525 4666 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-37"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> </g> </g> </g> <g id="ytick_4"> <g id="line2d_10"> <g> <use xlink:href="#m3861e12712" x="57.6" y="190.488306" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_11"> <g transform="translate(31.5125 194.287525) scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_5"> <g id="line2d_11"> <g> <use xlink:href="#m3861e12712" x="57.6" y="157.675902" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_12"> <g transform="translate(31.5125 161.47512) scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-32" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="127.246094"></use> </g> </g> </g> <g id="ytick_6"> <g id="line2d_12"> <g> <use xlink:href="#m3861e12712" x="57.6" y="124.863497" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_13"> <g transform="translate(31.5125 128.662716) scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-35" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="ytick_7"> <g id="line2d_13"> <g> <use xlink:href="#m3861e12712" x="57.6" y="92.051093" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_14"> <g transform="translate(31.5125 95.850312) scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-31"></use> <use xlink:href="#DejaVuSans-37" x="63.623047"></use> <use xlink:href="#DejaVuSans-35" x="127.246094"></use> </g> </g> </g> <g id="ytick_8"> <g id="line2d_14"> <g> <use xlink:href="#m3861e12712" x="57.6" y="59.238689" style="stroke-width: 0.8;"></use> </g> </g> <g id="text_15"> <g transform="translate(31.5125 63.037907) scale(0.1 -0.1)"> <use xlink:href="#DejaVuSans-32"></use> <use xlink:href="#DejaVuSans-30" x="63.623047"></use> <use xlink:href="#DejaVuSans-30" x="127.246094"></use> </g> </g> </g> <g id="text_16"> <g transform="translate(25.432812 206.197531) rotate(-90) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-70" d="M 1159 525 L 1159 -1331 L 581 -1331 L 581 3500 L 1159 3500 L 1159 2969 Q 1341 3281 1617 3432 Q 1894 3584 2278 3584 Q 2916 3584 3314 3078 Q 3713 2572 3713 1747 Q 3713 922 3314 415 Q 2916 -91 2278 -91 Q 1894 -91 1617 61 Q 1341 213 1159 525 z M 3116 1747 Q 3116 2381 2855 2742 Q 2594 3103 2138 3103 Q 1681 3103 1420 2742 Q 1159 2381 1159 1747 Q 1159 1113 1420 752 Q 1681 391 2138 391 Q 2594 391 2855 752 Q 3116 1113 3116 1747 z " transform="scale(0.015625)"></path><path id="DejaVuSans-72" d="M 2631 2963 Q 2534 3019 2420 3045 Q 2306 3072 2169 3072 Q 1681 3072 1420 2755 Q 1159 2438 1159 1844 L 1159 0 L 581 0 L 581 3500 L 1159 3500 L 1159 2956 Q 1341 3275 1631 3429 Q 1922 3584 2338 3584 Q 2397 3584 2469 3576 Q 2541 3569 2628 3553 L 2631 2963 z " transform="scale(0.015625)"></path><path id="DejaVuSans-61" d="M 2194 1759 Q 1497 1759 1228 1600 Q 959 1441 959 1056 Q 959 750 1161 570 Q 1363 391 1709 391 Q 2188 391 2477 730 Q 2766 1069 2766 1631 L 2766 1759 L 2194 1759 z M 3341 1997 L 3341 0 L 2766 0 L 2766 531 Q 2569 213 2275 61 Q 1981 -91 1556 -91 Q 1019 -91 701 211 Q 384 513 384 1019 Q 384 1609 779 1909 Q 1175 2209 1959 2209 L 2766 2209 L 2766 2266 Q 2766 2663 2505 2880 Q 2244 3097 1772 3097 Q 1472 3097 1187 3025 Q 903 2953 641 2809 L 641 3341 Q 956 3463 1253 3523 Q 1550 3584 1831 3584 Q 2591 3584 2966 3190 Q 3341 2797 3341 1997 z " transform="scale(0.015625)"></path><path id="DejaVuSans-74" d="M 1172 4494 L 1172 3500 L 2356 3500 L 2356 3053 L 1172 3053 L 1172 1153 Q 1172 725 1289 603 Q 1406 481 1766 481 L 2356 481 L 2356 0 L 1766 0 Q 1100 0 847 248 Q 594 497 594 1153 L 594 3053 L 172 3053 L 172 3500 L 594 3500 L 594 4494 L 1172 4494 z " transform="scale(0.015625)"></path><path id="DejaVuSans-75" d="M 544 1381 L 544 3500 L 1119 3500 L 1119 1403 Q 1119 906 1312 657 Q 1506 409 1894 409 Q 2359 409 2629 706 Q 2900 1003 2900 1516 L 2900 3500 L 3475 3500 L 3475 0 L 2900 0 L 2900 538 Q 2691 219 2414 64 Q 2138 -91 1772 -91 Q 1169 -91 856 284 Q 544 659 544 1381 z M 1991 3584 L 1991 3584 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-54"></use> <use xlink:href="#DejaVuSans-65" x="44.083984"></use> <use xlink:href="#DejaVuSans-6d" x="105.607422"></use> <use xlink:href="#DejaVuSans-70" x="203.019531"></use> <use xlink:href="#DejaVuSans-65" x="266.496094"></use> <use xlink:href="#DejaVuSans-72" x="328.019531"></use> <use xlink:href="#DejaVuSans-61" x="369.132812"></use> <use xlink:href="#DejaVuSans-74" x="430.412109"></use> <use xlink:href="#DejaVuSans-75" x="469.621094"></use> <use xlink:href="#DejaVuSans-72" x="533"></use> <use xlink:href="#DejaVuSans-65" x="571.863281"></use> </g> </g> </g> <g id="line2d_15"><path d="M 73.832727 295.488 L 73.930124 295.254917 L 74.124916 293.809439 L 74.417105 289.488282 L 74.839156 279.567925 L 75.488465 258.419237 L 76.787084 206.957734 L 78.31296 149.455932 L 79.351855 118.155428 L 80.260887 96.881478 L 81.104989 81.939227 L 81.88416 71.747509 L 82.630865 64.703504 L 83.31264 60.175879 L 83.961949 57.219044 L 84.578793 55.378689 L 85.130705 54.358287 L 85.650153 53.817628 L 86.1696 53.589759 L 86.721513 53.603286 L 87.370822 53.854336 L 88.31232 54.481476 L 91.851055 57.050636 L 93.214604 57.661185 L 94.675549 58.064988 L 96.396218 58.299331 L 98.831127 58.383692 L 107.694196 58.2928 L 142.529629 58.289896 L 398.487273 58.289896 L 398.487273 58.289896 " clip-path="url(#pd135bc5ed8)" style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="patch_3"><path d="M 57.6 307.584 L 57.6 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_4"><path d="M 414.72 307.584 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_5"><path d="M 57.6 307.584 L 414.72 307.584 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="patch_6"><path d="M 57.6 41.472 L 414.72 41.472 " style="fill: none; stroke-width: 0.8; stroke-linejoin: miter; stroke-linecap: square;"></path> </g> <g id="legend_1"> <g id="patch_7"><path d="M 235.935625 302.584 L 407.72 302.584 Q 409.72 302.584 409.72 300.584 L 409.72 286.905875 Q 409.72 284.905875 407.72 284.905875 L 235.935625 284.905875 Q 233.935625 284.905875 233.935625 286.905875 L 233.935625 300.584 Q 233.935625 302.584 235.935625 302.584 z " style="opacity: 0.8; stroke-linejoin: miter;"></path> </g> <g id="line2d_16"><path d="M 237.935625 293.004312 L 247.935625 293.004312 L 257.935625 293.004312 " style="fill: none; stroke-width: 1.5; stroke-linecap: square;"></path> </g> <g id="text_17"> <g transform="translate(265.935625 296.504312) scale(0.1 -0.1)"> <defs><path id="DejaVuSans-4b" d="M 628 4666 L 1259 4666 L 1259 2694 L 3353 4666 L 4166 4666 L 1850 2491 L 4331 0 L 3500 0 L 1259 2247 L 1259 0 L 628 0 L 628 4666 z " transform="scale(0.015625)"></path><path id="DejaVuSans-20" transform="scale(0.015625)"></path><path id="DejaVuSans-3d" d="M 678 2906 L 4684 2906 L 4684 2381 L 678 2381 L 678 2906 z M 678 1631 L 4684 1631 L 4684 1100 L 678 1100 L 678 1631 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2e" d="M 684 794 L 1344 794 L 1344 0 L 684 0 L 684 794 z " transform="scale(0.015625)"></path><path id="DejaVuSans-2c" d="M 750 794 L 1409 794 L 1409 256 L 897 -744 L 494 -744 L 750 256 L 750 794 z " transform="scale(0.015625)"></path><path id="DejaVuSans-64" d="M 2906 2969 L 2906 4863 L 3481 4863 L 3481 0 L 2906 0 L 2906 525 Q 2725 213 2448 61 Q 2172 -91 1784 -91 Q 1150 -91 751 415 Q 353 922 353 1747 Q 353 2572 751 3078 Q 1150 3584 1784 3584 Q 2172 3584 2448 3432 Q 2725 3281 2906 2969 z M 947 1747 Q 947 1113 1208 752 Q 1469 391 1925 391 Q 2381 391 2643 752 Q 2906 1113 2906 1747 Q 2906 2381 2643 2742 Q 2381 3103 1925 3103 Q 1469 3103 1208 2742 Q 947 2381 947 1747 z " transform="scale(0.015625)"></path> </defs> <use xlink:href="#DejaVuSans-4b"></use> <use xlink:href="#DejaVuSans-70" x="65.576172"></use> <use xlink:href="#DejaVuSans-20" x="129.052734"></use> <use xlink:href="#DejaVuSans-3d" x="160.839844"></use> <use xlink:href="#DejaVuSans-20" x="244.628906"></use> <use xlink:href="#DejaVuSans-31" x="276.416016"></use> <use xlink:href="#DejaVuSans-2e" x="340.039062"></use> <use xlink:href="#DejaVuSans-36" x="371.826172"></use> <use xlink:href="#DejaVuSans-35" x="435.449219"></use> <use xlink:href="#DejaVuSans-2c" x="499.072266"></use> <use xlink:href="#DejaVuSans-20" x="530.859375"></use> <use xlink:href="#DejaVuSans-4b" x="562.646484"></use> <use xlink:href="#DejaVuSans-69" x="628.222656"></use> <use xlink:href="#DejaVuSans-20" x="656.005859"></use> <use xlink:href="#DejaVuSans-3d" x="687.792969"></use> <use xlink:href="#DejaVuSans-20" x="771.582031"></use> <use xlink:href="#DejaVuSans-30" x="803.369141"></use> <use xlink:href="#DejaVuSans-2c" x="866.992188"></use> <use xlink:href="#DejaVuSans-20" x="898.779297"></use> <use xlink:href="#DejaVuSans-4b" x="930.566406"></use> <use xlink:href="#DejaVuSans-64" x="996.142578"></use> <use xlink:href="#DejaVuSans-20" x="1059.619141"></use> <use xlink:href="#DejaVuSans-3d" x="1091.40625"></use> <use xlink:href="#DejaVuSans-20" x="1175.195312"></use> <use xlink:href="#DejaVuSans-31" x="1206.982422"></use> <use xlink:href="#DejaVuSans-30" x="1270.605469"></use> <use xlink:href="#DejaVuSans-30" x="1334.228516"></use> </g> </g> </g> </g> </g> <defs> <clipPath id="pd135bc5ed8"> <rect x="57.6" y="41.472" width="357.12" height="266.112"></rect> </clipPath> </defs> </svg><p>We can do a much more careful job and get a better curve, but this is pretty reasonable for our toy problem. In fact, for the default parameters, we can just make <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">K_p</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">K_d</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>K</span><span><span><span><span><span><span></span><span><span>d</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> really large and get very close to an ideal curve. It’s kind of fun to play around with different values for <code>--heat-coeff</code>, <code>--voltage-coeff</code> and <code>--inertia</code> to see how that changes the ideal PID parameters.</p></div></div>
  </body>
</html>
