<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://vanillajsx.com/">Original</a>
    <h1>VanillaJSX.com</h1>
    
    <div id="readability-page-1" class="page"><div id="root"><p><small>(Because vanilla is actually delicious.)</small></p><p>What if JSX just returned DOM elements?</p><div data-sample="sample1"><div><p><a target="_blank" href="https://github.com/sdegutis/vanillajsx.com/blob/main/site/samples/sample1.tsx">View source</a></p><pre><code>export default function ClickMe() {
  let i = 0;
  const el = &lt;button&gt;Click me&lt;/button&gt; as HTMLButtonElement;
  el.onclick = (e) =&gt; {
    el.textContent = `Clicked ${++i} times`;
  };
  return el;
}
</code></pre></div></div><p>Would they be reusable?</p><p>Could they keep their own state?</p><div data-sample="sample2"><div><p><a target="_blank" href="https://github.com/sdegutis/vanillajsx.com/blob/main/site/samples/sample2.tsx">View source</a></p><pre><code>import ClickMe from &#34;./sample1.js&#34;;

export default () =&gt; &lt;&gt;
  &lt;p&gt;&lt;ClickMe /&gt;&lt;/p&gt;
  &lt;p&gt;&lt;ClickMe /&gt;&lt;/p&gt;
  &lt;p&gt;&lt;ClickMe /&gt;&lt;/p&gt;
&lt;/&gt;;
</code></pre></div></div><p>How would they work together?</p><p>Could they create an interactive DOM tree?</p><div data-sample="sample3"><div><p><a target="_blank" href="https://github.com/sdegutis/vanillajsx.com/blob/main/site/samples/sample3.tsx">View source</a></p><pre><code>function TodoInput(attrs: { add: (v: string) =&gt; void }) {
  const input = &lt;input /&gt; as HTMLInputElement;
  input.placeholder = &#39;Add todo item...&#39;;
  input.onkeydown = (e) =&gt; {
    if (e.key === &#39;Enter&#39;) {
      attrs.add(input.value);
      input.value = &#39;&#39;;
    }
  };
  return input;
}

class TodoList {
  ul = &lt;ul class=&#39;todolist&#39; /&gt; as HTMLUListElement;
  add(v: string) {
    const item = &lt;li&gt;{v}&lt;/li&gt; as HTMLLIElement;
    item.onclick = () =&gt; item.remove();
    this.ul.append(item);
  }
}

export default () =&gt; {
  const list = new TodoList();
  list.add(&#39;foo&#39;);
  list.add(&#39;bar&#39;);
  return &lt;&gt;
    &lt;TodoInput add={(v) =&gt; list.add(v)} /&gt;
    {list.ul}
  &lt;/&gt;;
};
</code></pre></div></div><p>How would they handle large data?</p><p>Could they be convenient without a virtual dom?</p><div data-sample="sample4"><div><p><a target="_blank" href="https://github.com/sdegutis/vanillajsx.com/blob/main/site/samples/sample4.tsx">View source</a></p><pre><code>import { data } from &#34;../fetch-dataset.js&#34;;
// Names of US citizens born in 1882 from ssa.gov

export default function FindNames() {
  const status = &lt;p style=&#39;margin:1em 0&#39; /&gt; as HTMLParagraphElement;
  const results = &lt;ul /&gt; as HTMLUListElement;
  const input = &lt;input
    value=&#39;.?mary?&#39;
    autocomplete=&#39;new-password&#39;
    oninput={updateMatches}
  /&gt; as HTMLInputElement;

  updateMatches();
  function updateMatches() {
    const regex = new RegExp(`(${input.value})`, &#39;gi&#39;);
    const matched = (data.entries()
      .filter(([k]) =&gt; k.match(regex))
      .toArray());

    const matches = (Iterator.from(matched)
      .map(match =&gt; &lt;Item regex={regex} match={match} /&gt;)
      .take(30));

    results.replaceChildren(...matches);
    status.textContent = `${matched.length} / ${data.size}`;
  }

  return &lt;div class=&#39;sample4&#39;&gt;
    {input}
    {status}
    {results}
  &lt;/div&gt;;
}

function Item(attrs: { match: [string, number], regex: RegExp }) {
  const [name, count] = attrs.match;
  const total = &lt;small style=&#39;color:#fff3&#39;&gt;({count})&lt;/small&gt;;
  return &lt;li&gt;
    &lt;span innerHTML={highlight(name, attrs.regex)} /&gt; {total}
  &lt;/li&gt;;
}

function highlight(str: string, regex: RegExp) {
  return str.replace(regex, &#39;&lt;span class=&#34;match&#34;&gt;$1&lt;/span&gt;&#39;);
}
</code></pre></div></div><p>How would they manage complex state?</p><p>How could parent components react to children?</p><div data-sample="sample5"><div><p><a target="_blank" href="https://github.com/sdegutis/vanillajsx.com/blob/main/site/samples/sample5.tsx">View source</a></p><pre><code>export default () =&gt; &lt;&gt;
  &lt;TodoList /&gt;
&lt;/&gt;;

function TodoList() {
  const list = new List();

  list.add(&#39;foo&#39;);
  list.add(&#39;bar&#39;).toggle();
  list.add(&#39;qux&#39;);

  const input = &lt;input class=&#39;next&#39; /&gt; as HTMLInputElement;
  input.onkeydown = (e) =&gt; {
    if (e.key === &#39;Enter&#39; &amp;&amp; input.value.trim().length &gt; 0) {
      list.add(input.value);
      input.value = &#39;&#39;;
    }
  };

  return &lt;div id=&#39;real-todolist&#39;&gt;
    &lt;div&gt;{input}&lt;/div&gt;
    &lt;div class=&#39;actions&#39;&gt;
      &lt;Counter list={list} /&gt;
      &lt;Button onclick={() =&gt; list.clearDone()}&gt;Clear&lt;/Button&gt;
      &lt;Button onclick={() =&gt; list.invertAll()}&gt;&lt;i&gt;Invert&lt;/i&gt;&lt;/Button&gt;
    &lt;/div&gt;
    {list.ul}
  &lt;/div&gt;;
}

class List extends EventTarget {

  ul = &lt;ul class=&#39;list&#39; /&gt; as HTMLUListElement;
  items: Item[] = [];

  add(text: string) {
    const item = new Item(this, text);
    this.items.push(item);
    this.ul.append(item.li);
    this.dispatchEvent(new Event(&#39;item-added&#39;));
    return item;
  }

  rem(item: Item) {
    this.items = this.items.filter(it =&gt; it !== item);
    this.dispatchEvent(new Event(&#39;item-removed&#39;));
  }

  clearDone() {
    this.doneItems().forEach(it =&gt; it.remove());
  }

  invertAll() {
    this.items.forEach(it =&gt; it.toggle());
  }

  doneItems() {
    return this.items.filter(it =&gt; it.done);
  }

  itemChanged() {
    this.dispatchEvent(new Event(&#39;item-toggled&#39;));
  }

}

class Item {

  done = false;
  #checkbox = &lt;input type=&#39;checkbox&#39; /&gt; as HTMLInputElement;
  li;

  constructor(private list: List, text: string) {
    this.li = (
      &lt;li class=&#39;item&#39;&gt;
        {this.#checkbox}
        &lt;span onclick={() =&gt; this.toggle()}&gt;{text}&lt;/span&gt;
        &lt;button class=&#39;close&#39; onclick={() =&gt; this.remove()}&gt;âœ•&lt;/button&gt;
      &lt;/li&gt; as HTMLLIElement
    );
    this.#checkbox.onclick = () =&gt; this.toggle();
  }

  remove() {
    this.li.remove();
    this.list.rem(this);
  }

  toggle() {
    this.done = !this.done;
    this.li.classList.toggle(&#39;done&#39;, this.done);
    this.#checkbox.checked = this.done;
    this.list.itemChanged();
  }

}

function Counter({ list }: { list: List }) {
  const span = &lt;span /&gt; as HTMLSpanElement;

  const updateText = () =&gt; {
    const done = list.doneItems().length;
    const total = list.items.length;
    span.textContent = `Done: ${done}/${total}`;
  };

  updateText();
  list.addEventListener(&#39;item-added&#39;, updateText);
  list.addEventListener(&#39;item-removed&#39;, updateText);
  list.addEventListener(&#39;item-toggled&#39;, updateText);

  return span;
}

function Button(attrs: { onclick: () =&gt; void }, children: any) {
  return &lt;a
    href=&#39;#&#39;
    class=&#39;action-button&#39;
    onclick={(e: Event) =&gt; {
      e.preventDefault();
      attrs.onclick();
    }}
  &gt;{children}&lt;/a&gt;;
}
</code></pre></div></div><p>This came out of my work on <a href="https://github.com/sdegutis/imlib">imlib</a>.</p><p>Also check out the <a href="https://github.com/sdegutis/vanillajsx.com/blob/main/site/index.html.tsx">source to this page</a>.</p></div></div>
  </body>
</html>
