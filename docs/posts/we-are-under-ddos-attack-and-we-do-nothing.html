<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tableplus.com/blog/2024/03/how-we-deal-with-ddos.html">Original</a>
    <h1>We are under DDoS attack and we do nothing</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
<div>
<article itemscope="" itemtype="http://schema.org/BlogPosting">

<div itemprop="articleBody">
<p><img src="https://tableplus.com/assets/images/ddos/fine.jpg" alt="fine"/></p>
<h3 id="were-under-ddos-attack">We’re under DDoS attack</h3>
<p>Someone has been attempting to DDoS us for weeks now. They have flooded our server with hundreds of millions of requests and attempted to download our setup file millions of times. (In the last 5 days alone, they tried to download it more than 800K times - our setup file is approximately 200MB per download.)</p>
<ul>
<li>Most of the traffic came from EU, specifically Germany and United Kingdom, here is the recently API call within 30 days.</li>
</ul>
<p><img src="https://tableplus.com/assets/images/ddos/traffic.png" alt="30-day"/></p>
<ul>
<li>
<p>They have attempted to download the setup file millions of times (800,126 times in the last 5 days, totaling approximately 6 million times in the latest 30 days).</p>
</li>
<li>
<p>The attack is still ongoing as we write this blog post.</p>
</li>
</ul>
<h3 id="what-we-do-in-this-hot-situation">What we do in this hot situation</h3>
<h4 id="we-do-nothing-except-watching-them-ddos">We do nothing, except watching them DDoS</h4>
<ul>
<li>We haven’t blocked any attacker IP addresses.</li>
<li>Although we use Cloudflare, we haven’t activated the “Under Attack” mode.</li>
<li>Our server CPUs are almost idle, typically at 0-1% usage most of the time during attack.</li>
<li>In general, we barely do anything.</li>
</ul>
<h4 id="why">Why?</h4>
<ul>
<li>Because our services are capable of handling billions of requests per month without any issues, and it isn’t cost much.</li>
<li>We have around 8 API services and its databases, all capable of handling billions of requests per month without caching.</li>
<li>We have unlimited bandwidth with Cloudflare.</li>
</ul>
<h4 id="how">How?</h4>
<ul>
<li>Our TablePlus apps design are simple, and this philosophy extends to our backend services, where we keep things as minimal as possible.</li>
<li>We avoid using third-party services like Vercel or Netlify for rendering, as they can become bottlenecks and surprise you with bills during attacks. Instead, we use our webservers, which have no limitations.</li>
<li>In the past, the monolith was a bottleneck due to weak VPS/processors. However, with today’s powerful VPS, multiple-core processors, and high RAM at low prices, a monolith service can handle billions of requests per month in a single instance if implemented correctly.</li>
</ul>
<p>=&gt; Thus, we build a monolith service for each app, which is easy to deploy and maintain. No Docker, no Kubernetes, no dependencies, no runtime environment - just a binary file that can be deployed on any newly created VPS.</p>
<h3 id="lets-talk-about-the-monolith">Let’s talk about the Monolith</h3>
<ul>
<li>Everyone tends to overcomplicate things, which isn’t an issue until you face pressure or limitations.</li>
<li>We “heete” complexity, so we opt for the monolith. We consolidate everything an app needs into a single service: API, Website, Email, Payment… everything in one service.</li>
<li>Deployment is straightforward: just one configuration file, build, and deploy. It’s lightning-fast when deploying or migrating services to another cloud vendor.</li>
<li>Fewer dependencies make it easier to debug and identify bottlenecks. When there is an error, you don’t need to check as much because there is only a single service or just a few of them.</li>
</ul>
<p>Monolith frameworks you can choose from include:</p>
<ul>
<li>Golang: Echo, Gin…</li>
<li>PHP: Laravel…</li>
<li>Ruby: Rails…</li>
<li>Rust: Actix, Rocket, Warp…</li>
</ul>
<h3 id="when-done-right-a-single-web-framework-of-go-or-rust-can-handle-billions-of-requests-per-month">When done right, a single Web Framework of Go or Rust can handle billions of requests per month</h3>
<ul>
<li>Choose a high-performance framework; we prefer Golang and Rust.</li>
<li>Index your databases to reduce fetching time, especially as the dataset grows.</li>
<li>Separate the main database (which remains unchanged or not increases size over time) from the log/usage database (which grows over time) to ensure your core business isn’t impacted by performance issues.</li>
<li>Use reverse proxy to handle and distribute requests to your core API. If you need multiple servers, it will greatly assist you. We use Nginx - which is powerful.</li>
<li>Put everything behind Cloudflare and configure it properly (enable cache, Argo, full SSL between Cloudfare and your servers…).</li>
<li>Use a CDN that has DDoS protection. We prefer Cloudflare R2 and its CDN over Amazon CloudFront + S3 for both cost savings and protection.</li>
</ul>
<h3 id="lets-talk-about-the-deployment">Let’s talk about the deployment</h3>
<ul>
<li>At TablePlus, we’ve simplified the deployment process as much as possible. We don’t use Docker, Kubernetes, or any containers, or need to setup the enviroment.</li>
<li>We use binaries. Binaries are fantastic; just copy them to any Linux server and run them as a process, just like running the TablePlus app on your macOS!</li>
<li>When using binaries, you can let Linux Systemctl handle the process (by monitoring the process and restarting it if any fatal errors occur). We use everything natively; that is the best way to optimize performance. There is no CPU/RAM wasted on middle layers such as VMs, virtualization, or third-party infrastructure managers.</li>
<li>We choose Golang and Rust because they’re not only high-performance languages but also capable of generating binary files for deployment.</li>
</ul>
<p><img src="https://tableplus.com/assets/images/ddos/tableplus-vs-hecker.png" alt="30-day"/></p>
</div>
</article>
</div>
</div></div>
  </body>
</html>
