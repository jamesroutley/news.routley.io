<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.veitheller.de/A_Better_Calculator.html">Original</a>
    <h1>A Better Calculator</h1>
    
    <div id="readability-page-1" class="page"><div>
      <p>Some of you might have heard of <a href="https://en.wikipedia.org/wiki/Bc_%28programming_language%29"><code>bc</code></a> before. I know that the people who attended my lightning talk at Recurse Center last Thursday have, and everyone whom I&#39;ve bothered by ranting about it before or after. I will write a quick blog post about it, followed by a shameless plug—hint: I&#39;ve been bitten by the <a href="https://github.com/hellerve/bc">reimplementation bug</a> yet again.</p>
<p><code>bc</code> is one of those commandline gems that are easy to overlook but are extremely handy if you know about them. It&#39;s a simple C-like programming language—how often do you see “simple” and “C” used in the same sentence?—that is mostly used from within shell scripts if one needs to do quick, yet possibly advanced calculations–a task that is not trivial in most shell languages. It is also, admittedly, not an all too common task.</p>
<pre><code>define int_gcd(x, y) {
  while (y &gt; 0) {
    r = x % y
    x = y
    y = r
  }
  return x
}</code></pre>
<p>
Fig. 1: A simple BC program for calculating the Greatest Common Denominator of two integers.
</p>
<p>It is a handy tool, however. Whenever you find yourself trying to pipe a string into Perl or Python to evaluate a mathematical instruction, I suggest you use <code>bc</code> instead. It has better startup time and is actually relatively fun to use; it mostly does what you would expect from a dynamically typed language with C-like syntax.</p>
<p>I have used <code>bc</code> as a calculator before, but wasn&#39;t really aware that it actually is a fully fledged programming language. That changed as soon as I started to reimplement the language, for the worst possible reason: I wanted to build a better REPL.</p>
<p><a href="https://asciinema.org/a/75ay3m4mx5i93tbfu7dahc55u"><img src="https://asciinema.org/a/75ay3m4mx5i93tbfu7dahc55u.png" alt="asciicast"/></a></p><p>
Fig. 2: A screencast of my <code>bc</code> reimplementation in action.
</p>
<p>The REPL features a nice realtime preview, readline capabilites, and tab completion—coming soon, courtesy of an <a href="https://github.com/hellerve/bc/pull/1">independent contributor</a>. It is a pleasure to use, even if the underlying <code>bc</code> implementation doesn&#39;t completely mimic the standard. Some of the deviations are bugs that I still have to fix, some of them deliberate design decisions. Time will tell which are which.</p>
<p>I had a lot of fun implementing this little language. It didn&#39;t require a lot of code, and my grasp on Haskell—the implementation language—has solidified greatly while doing it. The interpreter is written in a purely functional manner, without Monads or fancy tricks to mimic statefulness. I am somewhat pleased with how it turned out, even if it is a little rough around the edges.</p>
<p>If you toy around with it, do tell me what you think. I know there are some issues with the way whitespace is consumed by the parser—the less spaces you use the better—, and IO isn&#39;t implemented, which is one of the deliberate decisions on my part. I hope you enjoy it!</p>
      
    </div></div>
  </body>
</html>
