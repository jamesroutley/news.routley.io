<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/sjmurdoch/status/1638623990817103888">Original</a>
    <h1>Acropalypse: Windows Save File API is defective by design</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-143920" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623990817103888" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:38.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:38.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623990817103888" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623990817103888" itemprop="mainEntityOfPage"/><article aria-labelledby="id__6av9623yzen id__7yxhdpa79dq id__el7j6j70t2q id__uyxy8atwe4e id__e3kwavrqyyd id__ip9fy5nbl3b id__vkysqc5ayt id__nnpeytslfn id__btgx8dc1k6 id__fn23c1bytig id__g0kjh6jr4pk id__r55r41sxqwk id__v7c2x3wo67 id__x9odj08vuk id__ajqgmb156sf id__av5iwct4eab id__pbhx9wkzi9 id__bssyjfgofq id__mlfgfifnp4" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I did a little digging to see why Windows Snip and Sketch leaves part of the old image in a file when you crop a screenshot, potentially disclosing sensitive information (Acropalypse). It looks like the new Windows Save File API is defective by design. Why do I say this?</span><span>üßµ</span><span> 1/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623993220440074" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:38.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:38.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623993220440074" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623990817103888" itemprop="isPartOf"/><article aria-labelledby="id__fjdlfm6ey76 id__gicw3ctadpf id__xn4ezxznbmm id__kvaisx8fkg id__7grbreumwdm id__trjvm72r61f id__lu8od16xeq id__uohmvatts id__si8jjrvv0er id__cx9axk6rgzr id__a991y5gxb9 id__li1lmnn505i id__uh821a2d6qo id__vtviu6d0tk id__dibwkh9sg0f id__58pr3c38nw id__emwxzz6b6va id__343rdrddlu8 id__axnufdrz0tb" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The old Win32 API for saving a file was (roughly) to show a file picker, get the filename the user selected, and then open the file. To open a file, the programmer must specify whether to overwrite the file or not, and example code usually does overwrite the file. 2/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623995330174981" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:39.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623995330174981" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623993220440074" itemprop="isPartOf"/><article aria-labelledby="id__varo6fgkbg id__j0jdumxmrdp id__wnitl1t5po id__r8uelcnq7kh id__pyairr1oj4 id__p97rkmwlqrq id__on1pt9ofyj id__sy36mhufhd id__83znn3lnwu id__o7rk2qsxusi id__tsrcpvdr6hj id__fajwo4spfp7 id__8wth5yy64lm id__1ynkjxmqh6l id__xkimdrxwc5 id__ec0rsouuy7r id__5rx18jv9vsm id__1t2x491gv03 id__1umgith1do8" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>However, the new ‚Äúmore secure‚Äù Universal Windows Platform (UWP) sandboxes the file picker in a separate process, allowing neat features like capability-based access control. It returns a file handle which, if the selected file exists, will not overwrite the existing content! 3/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623998224244761" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:39.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623998224244761" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623995330174981" itemprop="isPartOf"/><article aria-labelledby="id__se9n3eauhw id__29v2yy5czk id__5gpxeyz0jjh id__k1yprkmuowq id__k4nrpcpcj28 id__09mpd5hf7b82 id__xlvh2rzev1 id__hfvmi6ncdsq id__f1ovammllag id__peiyh3jroil id__e5uaynuefx6 id__bns783memta id__h5xf0m648gc id__d136w40u8hq id__s8r05h3p61a id__d2owhdrhb54 id__gifmbeqi3to id__jz8pcuech5 id__di75zof9yh" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div aria-labelledby="id__rqxyqef3fae id__yi0uf0h5za9" id="id__h5xf0m648gc"><div><div><div><div><div><div role="button" tabindex="0"><div><div><div aria-label="Screenshot of linked StackOverflow post." data-testid="tweetPhoto"><p><img alt="Screenshot of linked StackOverflow post." draggable="true" src="https://pbs.twimg.com/media/Fr2KdDEWICglhc7?format=png&amp;name=medium"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624001147961344" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:40.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:40.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624001147961344" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623998224244761" itemprop="isPartOf"/><article aria-labelledby="id__3zr8exxiomp id__mvue5n8i7f id__kofrw6yewxo id__pgmip7a7xge id__fj39o33tywa id__goemovc2gl9 id__qd04oj2450n id__vjhgbp2905 id__72f4jmkdlym id__h1e2d7eshw8 id__kbmieuebq6h id__5ia89oxilt5 id__z712oh6nnjb id__0zxkacio685 id__d7s4tk4iy9r id__y98v3i0nlt id__9uohpmcowjw id__bkr2duokp9t id__dyb6f2lzvpp" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The documentation for FileSavePicker doesn‚Äôt mention the problem or truncate files in the example code. It is no surprise that the default behaviour of not truncating existing files is, therefore commonplace, despite being not what most people want. 5/9</span></p></div></div><div aria-labelledby="id__oifxrprxfsb id__01dw7rczs368" id="id__z712oh6nnjb"><div aria-labelledby="id__5im2ntzhxfb id__8tphwzje1j" id="id__01dw7rczs368" data-testid="card.wrapper"><div aria-hidden="true" id="id__5im2ntzhxfb" data-testid="card.layoutSmall.media"><a href="https://t.co/vrKASBQjzh" rel="noopener noreferrer nofollow" target="_blank" role="link" tabindex="-1"><div><div><div aria-label="Microsoft Logo"><p><img alt="Microsoft Logo" draggable="true" src="https://pbs.twimg.com/card_img/1638347109517647872/c7EY7kyI?format=png&amp;name=small"/></p></div></div></div></a></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624003592953856" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:41.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624003592953856" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624001147961344" itemprop="isPartOf"/><article aria-labelledby="id__rrzr3a6dui id__o9lbe1ypqmj id__anpm6zrj4zl id__bg89xym3hn id__hidf1eg9vbr id__id8ka03rvb id__nwslfx820h id__h2ol38g5mb id__ih43fwsrr29 id__tmmsh2zc7n8 id__uvwgoi6mrrj id__9zy9yib63h id__e01oswj2pe id__aybon9ehtul id__2c95kokqsfu id__ta8btzemu6d id__9y9o93m7bsa id__dg890hw3kg6 id__1fsios1uea2" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For some formats, the resulting file will be detected as corrupt, and the bug will be recognised. However, software often follows Postel‚Äôs Law ‚Äì ‚Äúbe conservative in what you send, be liberal in what you accept‚Äù and so quietly ignores the old data after the expected content. 6/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624005673328641" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:41.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624005673328641" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624003592953856" itemprop="isPartOf"/><article aria-labelledby="id__nb6sc78ezs id__zdq0t3nqks9 id__29d61ej6yqh id__7fxb8hqkadh id__09a6l2l4ctzk id__muhvdsoxfap id__edbi3il04v id__g1efz13mn3 id__i4y5x31kkf id__qre0l6uavxl id__m9o38z80fuk id__ithp86z5ie id__j9farc0029b id__eug8vtj7uk8 id__dkbdt0iasno id__g6p9uqb85z7 id__7v2atjp549e id__ho1t0ud8h86 id__vdk2a1qv7j" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The general lessons for this are not new, but bears repeating: secure defaults matter, including for APIs, and example code should be secure. Microsoft normally tries to do this, but something has obviously slipped through here. 7/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624007724343296" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="6" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:42.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:42.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624007724343296" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624005673328641" itemprop="isPartOf"/><article aria-labelledby="id__sq66t26kkh id__uvs0tuk0ex id__6a7nu9oidll id__xxtq3abckl id__l61t1vgsikf id__gsqmsysqgcf id__pla10b8utrm id__1lx3cp0rtsi id__lz57gnfq33g id__rrj5lxbp0ht id__jchx6vcz6c9 id__lnlhrx1gko8 id__no9kq2hg6s id__d5s8wn9n8gf id__hi7w0pebf7m id__l4e739pl01 id__quk9kh286t id__xy9wspgv5nd id__d4mvesswhbl" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Perhaps it is also time to move on from Postel‚Äôs Law. It was important for the growth of the Internet but is now becoming a liability. Rejecting invalid input can help identify problems earlier when they have had less opportunity to cause harm. 8/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624009775357952" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:42.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:42.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624009775357952" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624007724343296" itemprop="isPartOf"/><meta content="https://twitter.com/David3141593/status/1638222624084951040" itemprop="isBasedOn"/><article aria-labelledby="id__zdxu8pe9fy id__6uoeml0euw9 id__txhoi5cj1er id__r2ay7k4tl08 id__urlmwldidq id__f1ode6hk1x id__7bgrswfbb39 id__igmx8awlrqi id__re8pj09curh id__8aqkv0zvhji id__srriragsn7 id__jgod6kh6l8d id__t331b22xu5e id__hbqv9l89fsn id__dnq44p5pe4u id__lky6ux6aw39 id__7wnhsee0st id__094ire3y9txs id__ud71kgfl4o" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div aria-labelledby="id__sn5fvky1kka id__0f90vm0a9lft" id="id__t331b22xu5e"><div id="id__sn5fvky1kka"><p><span>Quote Tweet</span></p><div tabindex="0"><div><div><p><span>holy FUCK.

Windows Snipping Tool is vulnerable to Acropalypse too.

An entirely unrelated codebase.

The same exploit script works with minor changes (the pixel format is RGBA not RGB)

Tested myself on Windows 11 </span><span> twitter.com/ProgramMax/sta‚Ä¶</span></p><p><span>Show this thread</span></p></div><div><div><div><div><div><div><div><div><div aria-label="Image" data-testid="tweetPhoto"><p><img alt="Image" draggable="true" src="https://pbs.twimg.com/media/Frwit_wWIAIJqm8?format=jpg&amp;name=large"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671894940467201" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:39:59.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:39:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671894940467201" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624009775357952" itemprop="isPartOf"/><article aria-labelledby="id__e4ut9hbowct id__qcgfo4wtmxe id__qeawhjabj1a id__xp4siyp1be id__zsvi6jeldzg id__2mcw3woq5ih id__37jtfwdeh2s id__dd2tcqetuvj id__phnnqvjiejm id__a1n2xutsxs id__1y59y1qe569 id__p924cks1q6 id__xqvb0w9dv9h id__lxmgq2cakp id__vyx4a94s61 id__2qjzged33c id__nxph10fe97q id__klifvfdjffr id__ieoy4wy6jl" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I installed Visual Studio and kept on digging. It looks like if you only use FileIO to manipulate the opened file, it is OK, but if want to do anything more interesting you have to open the file as a stream and then the vulnerable default behaviour is a problem. 10/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671898472255488" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:00.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:00.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671898472255488" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671894940467201" itemprop="isPartOf"/><article aria-labelledby="id__4sc9p0xtf0s id__3aky9p7h122 id__ic2a1unvx5k id__km3ycfxilqb id__bei39tjaihm id__kylj3ivtvbq id__c93f20e0jcl id__9vufujp1sse id__1wq316osl0wi id__jiy9oa89bkr id__nyv4mpnr6re id__ln3jh3f5w4 id__y0tug9si05r id__csdfb54uuch id__7zhwf1wwa5 id__51g9bbbteob id__01l5qlf18m2u id__sfmw0bevc7r id__iiy8ulhe32c" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For example, FileIO.WriteBytesAsync() truncates the stream before writing. This example is closely based on the Windows UWP demonstration code. 11/n</span></p></div></div><div aria-labelledby="id__eikjxb79kbe id__dpz1qi1wgr" id="id__y0tug9si05r"><div><div><div><div><div><div><div><div><div role="button" tabindex="0"><div><div aria-label="Example code using FileIO.WriteBytesAsync()
" data-testid="tweetPhoto"><p><img alt="Example code using FileIO.WriteBytesAsync()
" draggable="true" src="https://pbs.twimg.com/media/Fr2z_XRWIAEa5DJ?format=jpg&amp;name=large"/></p></div></div></div></div></div><div><div><div role="button" tabindex="0"><div><div aria-label="Output file showing only 0x0A values." data-testid="tweetPhoto"><p><img alt="Output file showing only 0x0A values." draggable="true" src="https://pbs.twimg.com/media/Fr20XvIWcAEhDMx?format=png&amp;name=small"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671902393741312" itemprop="identifier"/><meta content="12" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:01.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:01.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671902393741312" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671898472255488" itemprop="isPartOf"/><article aria-labelledby="id__kdjh8v0vbc id__npb929m8fvl id__kb070vtit59 id__qqnrfioxohr id__qdfsz4klxso id__kg89hjce6k id__djdz402ozln id__23jrj2w39pe id__3bt7p4rh8ow id__l8kxqwzpxfh id__swilzofuio id__z69i5at11n8 id__9jceruz1h74 id__778bhpjq5l9 id__jhjpwkro8un id__4dkeiw3pn25 id__gmuhc4050za id__dk5wbzooo5j id__1fkjcalx9g5" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>But if we change the code to open the stream and write to it through a DataWriter, it does not truncate the file before writing. 12/n</span></p></div></div><div aria-labelledby="id__tcbwhyzgug id__ar6q2w9ihsk" id="id__9jceruz1h74"><div><div><div><div><div><div><div><div><div role="button" tabindex="0"><div><div aria-label="Example code using WriteBytes()" data-testid="tweetPhoto"><p><img alt="Example code using WriteBytes()" draggable="true" src="https://pbs.twimg.com/media/Fr202-6WwAAyKhW?format=jpg&amp;name=large"/></p></div></div></div></div></div><div><div><div role="button" tabindex="0"><div><div aria-label="Output file showing the beginning overwritten but text present in the rest of the file." data-testid="tweetPhoto"><p><img alt="Output file showing the beginning overwritten but text present in the rest of the file." draggable="true" src="https://pbs.twimg.com/media/Fr21MD8XsAAYq8q?format=png&amp;name=small"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671905627467776" itemprop="identifier"/><meta content="13" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:02.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:02.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671905627467776" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671902393741312" itemprop="isPartOf"/><article aria-labelledby="id__tisgh7y1lh id__aofbrphnele id__01qzwoowvdtq id__yyb7xy11h1 id__1sk5dfvx0xc id__qdjrpssxl id__s7baersgmgq id__jq4cpp77zyq id__gkpnvnsvx6 id__ahgcp5aawi id__rplhq9xh6i id__og4swl9jc6g id__lerc5s9ipb id__nyxc4l609k id__yj34qaehdqs id__r8d72nd9zmf id__hergbdhkdxp id__nx7n90wu4h id__1nfgf1iow2v" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div aria-labelledby="id__5itbv47faoo id__ex6p5mlvpgj" id="id__lerc5s9ipb"><div><div><div><div><div><div role="button" tabindex="0"><div><div><div aria-label="Uno source code showing fileStream.SetLength(0)" data-testid="tweetPhoto"><p><img alt="Uno source code showing fileStream.SetLength(0)" draggable="true" src="https://pbs.twimg.com/media/Fr21pHJXgAMoSYv?format=png&amp;name=900x900"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671909142544384" itemprop="identifier"/><meta content="14" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:02.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:02.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671909142544384" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671905627467776" itemprop="isPartOf"/><article aria-labelledby="id__d0m1sxwauyk id__js6xmxmgbza id__rqjo83fmop id__uwh3gbqi4af id__5zh09h36c5d id__grrgv8c8xp4 id__n8guh6k9yn id__ae3lq7a9wvh id__crn6van77h id__hp7n60o5stq id__x68ouu4kbc id__u3e60bkxkah id__6ssc5vkxhk8 id__e6xz2fufi1 id__oc9yadg1gr id__23u5vlgms8x id__ntpzjzu9an id__ksbuq31ukqh id__4kxmsoooytj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Overall I think my conclusions still hold. The example code works, but if modified in a way that should be expected, it is insecure. The API for opening a file selected by a picker will, by default, not overwrite an existing file, which is almost always not what is intended. 14/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671911210164224" itemprop="identifier"/><meta content="15" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:03.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671911210164224" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671909142544384" itemprop="isPartOf"/><article aria-labelledby="id__0y1ic8tqrt1e id__e01kti5dlw id__1tiku1f3hcm id__p3g6uz69w2j id__p059te310ag id__yr07ga8mkcs id__ggau1ksr9q id__ss1afhulnw id__s2kjuiyaxk id__4nhanwuq5ln id__d7phlga1vho id__d7a1aqq1jab id__v15cw3pqky id__nod8xs049h id__81yqz22k5mg id__zu0nnccs3gl id__od5lgq6df8 id__qp5fkr7c50k id__uf2svy7iygn" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>A safer API would be for the FileSavePicker to truncate existing files by default. Alternatively, OpenAsync() could have the option to open the stream for writing. Currently, it is only Read and ReadWrite, unlike the far richer Win32 CreateFile API. 15/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638675586221760513" itemprop="identifier"/><meta content="16" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:54:39.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:54:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638675586221760513" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671911210164224" itemprop="isPartOf"/><article aria-labelledby="id__7yru5p8m9h id__9fjozx4cq79 id__zlg2itoildj id__9u7en9bxi9c id__i2mlaf7o1j id__68mqq0ve8cf id__m560rtxr8hn id__x1yzxw3q1lf id__3jhnr579oxs id__vp03ygydtbd id__220jpj1zee6 id__5lkj2hbxbpb id__tpfb3ioge7 id__d7fbngozv9r id__rpcczbbn2g id__50bzd0i6p4f id__5xo389st1wc id__r5hfkjhbq5 id__iaksy3pd5j" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>As an aside, OpenAsync has a very anaemic API. Win32 CreateFile allows checking for an existing file before opening and setting security parameters. These steps are atomic with opening the file, but if UWP doesn‚Äôt support atomic operations could it cause race conditions? 16/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638681234648834049" itemprop="identifier"/><meta content="17" itemprop="position"/><meta content="4" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T23:17:06.000Z" itemprop="dateCreated"/><meta content="2023-03-22T23:17:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638681234648834049" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638675586221760513" itemprop="isPartOf"/><article aria-labelledby="id__erapm154uxu id__x257ymzvm4 id__e554d2q2vv8 id__z64florzq39 id__fqd2shvowdt id__rpgtv3u6jsn id__mvi7kavgttb id__yq12pcs7v2o id__xma9mhsj0aa id__9444ytstrwb id__jsofggrp91b id__ydbettska5p id__wbpq3fz7j6 id__wegcclhdhgi id__mbpvu9vhte8 id__biz7fvyq1g4 id__1t86xpfcapn id__dzrjsetreeo id__8m0cmhrgalj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://twitter.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I can see why programmers could be easily confused, even if they work for Microsoft. Here‚Äôs some documentation that presents the FileIO and OpenAsync as interchangeable approaches when only the former will safely truncate a file that already exists. 17/n</span></p></div></div><div aria-labelledby="id__r18rtgvz8p id__on182v4adrg" id="id__wbpq3fz7j6"><div aria-labelledby="id__6vqbrep9bii id__sj67krlt61" id="id__on182v4adrg" data-testid="card.wrapper"><div aria-hidden="true" id="id__6vqbrep9bii" data-testid="card.layoutSmall.media"><a href="https://t.co/5kq20I0WrK" rel="noopener noreferrer nofollow" target="_blank" role="link" tabindex="-1"><div><div><div aria-label="Microsoft Logo"><p><img alt="Microsoft Logo" draggable="true" src="https://pbs.twimg.com/card_img/1638347109517647872/c7EY7kyI?format=png&amp;name=small"/></p></div></div></div></a></div></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
