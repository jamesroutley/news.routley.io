<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/sjmurdoch/status/1638623990817103888">Original</a>
    <h1>Acropalypse: Windows Save File API is defective by design</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-86724" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623990817103888" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:38.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:38.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623990817103888" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623990817103888" itemprop="mainEntityOfPage"/><article aria-labelledby="id__dkgco0dpqm id__jksaztlahy id__iu9euu9wlil id__8jrud43sq0t id__iiz6axvxpq id__0qfdin0gdjx id__o9tp98eeoz id__bsqogns5inm id__mgznghrizc8 id__p5dqai1wu8c id__ekqt6lwk8gc id__3qjxd97ardg id__w4mmuluujk id__bgd30q420cv id__gjp62qsowjg id__znm2xl1trtr id__lyyo7jpr3 id__4e61g0vgt7z id__ptcx37yni4b" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I did a little digging to see why Windows Snip and Sketch leaves part of the old image in a file when you crop a screenshot, potentially disclosing sensitive information (Acropalypse). It looks like the new Windows Save File API is defective by design. Why do I say this?</span><span>üßµ</span><span> 1/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623993220440074" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:38.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:38.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623993220440074" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623990817103888" itemprop="isPartOf"/><article aria-labelledby="id__gtd9ql5047r id__sn3es7t8y3 id__dsg9saplucj id__e2g4v7d665j id__riwfbtyh6nl id__nh0zl6g4lqq id__5ak9ebrict4 id__fs3n8gtsczs id__hsly1j8qeh5 id__xp9qxr6nv8 id__7en0eda481g id__pxpzkfbaee id__ers3s1rrtnm id__5myg2kl4jeu id__o5f2fhfrqo9 id__ei6xdw9hdrv id__b28cyw47kd id__jihafxrpzhc id__1dln82sfenu" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The old Win32 API for saving a file was (roughly) to show a file picker, get the filename the user selected, and then open the file. To open a file, the programmer must specify whether to overwrite the file or not, and example code usually does overwrite the file. 2/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623995330174981" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:39.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623995330174981" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623993220440074" itemprop="isPartOf"/><article aria-labelledby="id__ftj34akhgoq id__pdrgdu3wxu9 id__ss7nk1319vn id__bwevciu26im id__q9swsli5zao id__cru7oiunwms id__ebclv8r352r id__wlhydhf2pc id__05kx1c3rpyaw id__o6rjawptkb9 id__ii8hzseu9r id__aijxtt8qnv6 id__ek1jiaq2h7g id__4f82e0mr6j1 id__13qzgvi0rxx id__otw2oye9n0g id__xqjr0k01eqr id__4ilfbba12kt id__u0mr5tvwzz" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>However, the new ‚Äúmore secure‚Äù Universal Windows Platform (UWP) sandboxes the file picker in a separate process, allowing neat features like capability-based access control. It returns a file handle which, if the selected file exists, will not overwrite the existing content! 3/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638623998224244761" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:39.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638623998224244761" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623995330174981" itemprop="isPartOf"/><article aria-labelledby="id__qq1vnzemkcm id__velxh3jy7ag id__25avipche8l id__x00mtreihdg id__hb3q2fyj5vi id__9fekntr486p id__o438vgmx0gc id__foc5gc9ju6l id__yy1ygr182v id__adqzr33v57p id__8ycit6pv4wo id__aa4q58yim5k id__yl6o77sj6vn id__9n6blfnd9cj id__58ulc08n7w7 id__m1syj9ng72r id__tr5cxpu2k2 id__zr1i139ohh id__lqclk5zh3r" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div aria-labelledby="id__7qtp9zgbvnn id__pu0xxooqr4" id="id__yl6o77sj6vn"><div><div><div><div><div><div role="button" tabindex="0"><div><div><div aria-label="Screenshot of linked StackOverflow post." data-testid="tweetPhoto"><p><img alt="Screenshot of linked StackOverflow post." draggable="true" src="https://pbs.twimg.com/media/Fr2KdDEWICglhc7?format=png&amp;name=medium"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624001147961344" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:40.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:40.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624001147961344" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638623998224244761" itemprop="isPartOf"/><article aria-labelledby="id__x279chmm49i id__p3kxda4svmk id__tiwd3wiqck id__t6a526fzoj8 id__sgi9v42raw id__v8fqh3vyho id__950e8g6c1e9 id__7toqr0hbpm6 id__sb3f8tmac3b id__jjuh739hs5 id__yzsscr1j9l id__ql5f3mik3j id__fm1vfnp3fr id__2bm90y3eqde id__3khx749svdr id__0rtaupg2pqb id__8raw3euz8s id__o7c26ni5n6o id__wxl6xdmkx4" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The documentation for FileSavePicker doesn‚Äôt mention the problem or truncate files in the example code. It is no surprise that the default behaviour of not truncating existing files is, therefore commonplace, despite being not what most people want. 5/9</span></p></div></div><div aria-labelledby="id__2854nw8n00a id__bqrqcf5ez6" id="id__fm1vfnp3fr"><div aria-labelledby="id__0c3x5a2fk65k id__7nuxppug716" id="id__bqrqcf5ez6" data-testid="card.wrapper"><div aria-hidden="true" id="id__0c3x5a2fk65k" data-testid="card.layoutSmall.media"><a href="https://t.co/vrKASBQjzh" rel="noopener noreferrer nofollow" target="_blank" role="link" tabindex="-1"><div><div><div aria-label="Microsoft Logo"><p><img alt="Microsoft Logo" draggable="true" src="https://pbs.twimg.com/card_img/1638347109517647872/c7EY7kyI?format=png&amp;name=small"/></p></div></div></div></a></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624003592953856" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:41.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624003592953856" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624001147961344" itemprop="isPartOf"/><article aria-labelledby="id__61bu6aubj2m id__1sbgdvov87u id__956lolhp3bh id__uvp2g31us3o id__f38o13i30p9 id__5rzeo8eq8ga id__6309sn0ut6c id__yg9yvckkzjb id__yau9qrooqvj id__336gydnchav id__p2wpq70vyve id__zw2lszvsrnf id__xs4un2vl2x id__3bxe1ljmp4 id__xizd0vzmbln id__jt2lmktfc7p id__vjfwa3vn4rq id__o0os7d3cfuq id__3apxlf91lwg" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For some formats, the resulting file will be detected as corrupt, and the bug will be recognised. However, software often follows Postel‚Äôs Law ‚Äì ‚Äúbe conservative in what you send, be liberal in what you accept‚Äù and so quietly ignores the old data after the expected content. 6/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624005673328641" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:41.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:41.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624005673328641" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624003592953856" itemprop="isPartOf"/><article aria-labelledby="id__njq27btdiqk id__qz68311vrt id__w4idfxm197h id__9vv4lx40th6 id__nx794ky0l6 id__4el04ihwhlz id__rwp8ik28xoh id__2lc8k819yj id__c1cvk7m3cqv id__h22agys6lgt id__sj5my1avhw id__xz97xygiqc id__39dlc5zvcx id__1idg7hr2d0n id__jdy7akz73oq id__00pbomx7lf5h id__ah1919kz54l id__3fqas4xwg1i id__rrlpfjvrau" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>The general lessons for this are not new, but bears repeating: secure defaults matter, including for APIs, and example code should be secure. Microsoft normally tries to do this, but something has obviously slipped through here. 7/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624007724343296" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="6" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:42.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:42.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624007724343296" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624005673328641" itemprop="isPartOf"/><article aria-labelledby="id__vmf8ro54vim id__h97qw0gh65o id__m43a5mz9is id__7herb3as90s id__l15lsous6rs id__rxmfr3aiowg id__4b9hjb8zb8h id__d8jbio14ojb id__al70cpeemxn id__m88n4xq0ynh id__o0v2qfa4zo id__ojikoehgn7 id__6hnbhk4x84k id__jq8ttxx1nd9 id__ghbc562m6h4 id__qwe6gmfe0g id__66imwekcn1n id__sy1p145keca id__vfornhp4x7" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Perhaps it is also time to move on from Postel‚Äôs Law. It was important for the growth of the Internet but is now becoming a liability. Rejecting invalid input can help identify problems earlier when they have had less opportunity to cause harm. 8/9</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638624009775357952" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T19:29:42.000Z" itemprop="dateCreated"/><meta content="2023-03-22T19:29:42.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638624009775357952" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624007724343296" itemprop="isPartOf"/><meta content="https://twitter.com/David3141593/status/1638222624084951040" itemprop="isBasedOn"/><article aria-labelledby="id__ik1f2cudz7m id__e8cj4fbn3k id__ewr4slcbz9j id__aeb6ztg3e8r id__1ioeefbkv6g id__jmurxvhmn0i id__xtm17exrncb id__ffcl4qxon74 id__lgvgctk3ot9 id__st0f28mrxbs id__wzc3fulnwme id__xbtw9u2k3cn id__r15ss2r1jn9 id__ywfn994qg0r id__dtddt5rin6 id__lf654l3bptn id__welpn3vpuzn id__p6y0jevcsrf id__i5hij448pk" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div aria-labelledby="id__femzgrzuf17 id__sgfphguztke" id="id__r15ss2r1jn9"><div id="id__femzgrzuf17"><p><span>Quote Tweet</span></p><div tabindex="0"><div><div><p><span>holy FUCK.

Windows Snipping Tool is vulnerable to Acropalypse too.

An entirely unrelated codebase.

The same exploit script works with minor changes (the pixel format is RGBA not RGB)

Tested myself on Windows 11 </span><span> twitter.com/ProgramMax/sta‚Ä¶</span></p><p><span>Show this thread</span></p></div><div><div><div><div><div><div><div><div><div aria-label="Image" data-testid="tweetPhoto"><p><img alt="Image" draggable="true" src="https://pbs.twimg.com/media/Frwit_wWIAIJqm8?format=jpg&amp;name=large"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671894940467201" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:39:59.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:39:59.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671894940467201" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638624009775357952" itemprop="isPartOf"/><article aria-labelledby="id__no6d77343dm id__6by7cnxczyw id__1v6vd5qk8r2j id__xfekaom0ngi id__kbgfjti62gh id__0mnd79qejh4 id__vmcbi50trbf id__k1whneqvwwj id__kvlr4cv8uer id__2a0o7emrgj9 id__hkpd3zorne id__9rwcc84luw8 id__rx96emjxcga id__oc9qyqx3i3 id__uoxkmaakuu id__qg1cjtj42c id__sdmg4ldnhw id__brldeoi14ni id__7z62m6o55qk" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I installed Visual Studio and kept on digging. It looks like if you only use FileIO to manipulate the opened file, it is OK, but if want to do anything more interesting you have to open the file as a stream and then the vulnerable default behaviour is a problem. 10/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671898472255488" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:00.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:00.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671898472255488" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671894940467201" itemprop="isPartOf"/><article aria-labelledby="id__srn4awopec id__hfblg59z3c7 id__k8ot2z8fmvi id__u3a97qhxqyr id__4ydliakykoa id__cvh8rylvoyn id__om74ggp4zsf id__ozadywmw4en id__l5wuii58zfn id__ihjdvktbzr id__4pgh4cycj5t id__wvkbspdslvk id__xcjea13360c id__lnwqaun11w8 id__2ax3t66zxa3 id__cwg5smzz3tj id__hf7x0j9lm7 id__9pzzrljy06t id__tmsibpog2m" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>For example, FileIO.WriteBytesAsync() truncates the stream before writing. This example is closely based on the Windows UWP demonstration code. 11/n</span></p></div></div><div aria-labelledby="id__6x2hou60guk id__0sglwrs9f71" id="id__xcjea13360c"><div><div><div><div><div><div><div><div><div role="button" tabindex="0"><div><div aria-label="Example code using FileIO.WriteBytesAsync()
" data-testid="tweetPhoto"><p><img alt="Example code using FileIO.WriteBytesAsync()
" draggable="true" src="https://pbs.twimg.com/media/Fr2z_XRWIAEa5DJ?format=jpg&amp;name=large"/></p></div></div></div></div></div><div><div><div role="button" tabindex="0"><div><div aria-label="Output file showing only 0x0A values." data-testid="tweetPhoto"><p><img alt="Output file showing only 0x0A values." draggable="true" src="https://pbs.twimg.com/media/Fr20XvIWcAEhDMx?format=png&amp;name=small"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671902393741312" itemprop="identifier"/><meta content="12" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:01.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:01.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671902393741312" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671898472255488" itemprop="isPartOf"/><article aria-labelledby="id__sv0k7hw8rwg id__hedprd8n4dk id__z2l4qkhhp7 id__n2m60jt4ejj id__6fvhxsjzhf id__y85h60a4kj id__1lfuf6v6x4e id__fb9j1if74vs id__n2c0yre6w3n id__u2t0ugpxccj id__zr6qs0g7vr id__gvm0gs0ppt6 id__37fthgx2qye id__d9opazkovsl id__fxkydzu1mtf id__5dgk43bnjkq id__xkzsiekfm99 id__ji8pezfj5kd id__flr3m8dc6qd" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>But if we change the code to open the stream and write to it through a DataWriter, it does not truncate the file before writing. 12/n</span></p></div></div><div aria-labelledby="id__jwyqv7oyg6a id__x3y228ndzrs" id="id__37fthgx2qye"><div><div><div><div><div><div><div><div><div role="button" tabindex="0"><div><div aria-label="Example code using WriteBytes()" data-testid="tweetPhoto"><p><img alt="Example code using WriteBytes()" draggable="true" src="https://pbs.twimg.com/media/Fr202-6WwAAyKhW?format=jpg&amp;name=large"/></p></div></div></div></div></div><div><div><div role="button" tabindex="0"><div><div aria-label="Output file showing the beginning overwritten but text present in the rest of the file." data-testid="tweetPhoto"><p><img alt="Output file showing the beginning overwritten but text present in the rest of the file." draggable="true" src="https://pbs.twimg.com/media/Fr21MD8XsAAYq8q?format=png&amp;name=small"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671905627467776" itemprop="identifier"/><meta content="13" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:02.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:02.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671905627467776" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671902393741312" itemprop="isPartOf"/><article aria-labelledby="id__p9wedds30rp id__n2l5uza31bf id__dy9npbng6oh id__btrx9x86s4u id__de0rpz83t5v id__6gai3hrdygt id__l1wwnmc3pgi id__zy0rcvyvx3 id__0szrslm3y9n id__yh40ceqgf2q id__x32h4xqp28 id__re5hg7cgkd id__5ous4xtfwce id__ij42diof3rj id__usas2taupgm id__e8di2sdoj97 id__tdpd8wsqwx id__s8k4nayrvbr id__5j50iiqd7pq" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div aria-labelledby="id__d9vgdb327t id__8gmh2jlk398" id="id__5ous4xtfwce"><div><div><div><div><div><div role="button" tabindex="0"><div><div><div aria-label="Uno source code showing fileStream.SetLength(0)" data-testid="tweetPhoto"><p><img alt="Uno source code showing fileStream.SetLength(0)" draggable="true" src="https://pbs.twimg.com/media/Fr21pHJXgAMoSYv?format=png&amp;name=900x900"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671909142544384" itemprop="identifier"/><meta content="14" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:02.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:02.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671909142544384" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671905627467776" itemprop="isPartOf"/><article aria-labelledby="id__enq7jxk0qww id__f21ia9lyhxt id__7shp0vdav7a id__q44damammpp id__2klacc1e346 id__t2qzp705qpf id__vz91y7agi1 id__ga1sk3t809k id__9zurp2kr7eq id__nef9ivejs6 id__cnn0q98bzd id__u7k3hqexnz9 id__esndilz4rg id__d4d8s2xuyqe id__96y1l4a3xr8 id__1zvn433q2cl id__vuiwdfz65ws id__gblw05ynnab id__hvp903pfug" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Overall I think my conclusions still hold. The example code works, but if modified in a way that should be expected, it is insecure. The API for opening a file selected by a picker will, by default, not overwrite an existing file, which is almost always not what is intended. 14/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638671911210164224" itemprop="identifier"/><meta content="15" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:40:03.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:40:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638671911210164224" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671909142544384" itemprop="isPartOf"/><article aria-labelledby="id__dr5s5lihuym id__bebpdxioryl id__q9mdoewoce id__60whknqxyo id__7iajj8wt4sa id__ztd92vktrae id__h9zh2aq5yr id__acj4umwve9r id__ggzfqurrri9 id__4twlf0g0awt id__xe5wi3y00q id__76zvscsdwwo id__kstdjhdxxro id__uo3ka1h710q id__pewrwzrkpap id__hixfwa9ehqj id__k3k9eqt7syn id__i7leacx9ylq id__5yh1cncmla" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>A safer API would be for the FileSavePicker to truncate existing files by default. Alternatively, OpenAsync() could have the option to open the stream for writing. Currently, it is only Read and ReadWrite, unlike the far richer Win32 CreateFile API. 15/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638675586221760513" itemprop="identifier"/><meta content="16" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T22:54:39.000Z" itemprop="dateCreated"/><meta content="2023-03-22T22:54:39.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638675586221760513" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638671911210164224" itemprop="isPartOf"/><article aria-labelledby="id__uws0eq4o8h id__2a9baawjzhp id__998zwzjo78m id__jgvbkc6q3xm id__8f4819wngzj id__bu32vxw0kn id__x3r61x8i7rf id__pm5d3sl71yi id__v9ktlj8wo3 id__ovuez7irmoe id__vwr8m4ev2to id__xul2291yq2s id__b9wo44o8yi5 id__96x43o1raqd id__vovgf9jyeqn id__45pzy11yki6 id__xqbrvh36fk id__1w392ccc2l7 id__y0esaf50ce" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>As an aside, OpenAsync has a very anaemic API. Win32 CreateFile allows checking for an existing file before opening and setting security parameters. These steps are atomic with opening the file, but if UWP doesn‚Äôt support atomic operations could it cause race conditions? 16/n</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1638681234648834049" itemprop="identifier"/><meta content="17" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-03-22T23:17:06.000Z" itemprop="dateCreated"/><meta content="2023-03-22T23:17:06.000Z" itemprop="datePublished"/><meta content="https://twitter.com/sjmurdoch/status/1638681234648834049" itemprop="url"/><meta content="https://twitter.com/sjmurdoch/status/1638675586221760513" itemprop="isPartOf"/><article aria-labelledby="id__e4wb7l4o9kn id__tg1kpmhf0uf id__cu8p2zzfear id__zdc5cmtmmur id__w3ebi2txli9 id__vbzu4sakg7g id__u8gx9jsng5 id__rf88cbb2epp id__xgaffyp1pb id__19b76hkre6 id__bapzkaf97ki id__mqx8mkon9o id__kb600w9tvss id__tbaf5ab4i6m id__8e0s0expzsl id__68v7anqaf89 id__jlspkq5p8yh id__fy6oton5cy9 id__4lf3b26x59j" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-sjmurdoch"><div><div><div><div><a href="https://www.recurse.com/sjmurdoch" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/641996073112735744/IzfDDqlw_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>I can see why programmers could be easily confused, even if they work for Microsoft. Here‚Äôs some documentation that presents the FileIO and OpenAsync as interchangeable approaches when only the former will safely truncate a file that already exists. 17/n</span></p></div></div><div aria-labelledby="id__vat5hbc1vr id__dps2mx0b5jc" id="id__kb600w9tvss"><div aria-labelledby="id__ade9olomf4a id__y5f39cstpsj" id="id__dps2mx0b5jc" data-testid="card.wrapper"><div aria-hidden="true" id="id__ade9olomf4a" data-testid="card.layoutSmall.media"><a href="https://t.co/5kq20I0WrK" rel="noopener noreferrer nofollow" target="_blank" role="link" tabindex="-1"><div><div><div aria-label="Microsoft Logo"><p><img alt="Microsoft Logo" draggable="true" src="https://pbs.twimg.com/card_img/1638347109517647872/c7EY7kyI?format=png&amp;name=small"/></p></div></div></div></a></div></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
