<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://palant.info/2023/02/06/weakening-tls-protection-south-korean-style/">Original</a>
    <h1>Weakening TLS protection, South Korean style</h1>
    
    <div id="readability-page-1" class="page"><div>
              <p><em>Note</em>: This article is also available <a href="https://github.com/alanleedev/KoreaSecurityApps/blob/main/03_weakening_tls_protection.md">in Korean</a>.</p>
<p>Normally, when you navigate to your bank’s website you have little reason to worry about impersonations. The browser takes care of verifying that you are really connected to the right server, and that your connection is safely encrypted. It will indicate this by showing a lock icon in the address bar.</p>
<p>So even if you are connected to a network you don’t trust (such as open WiFi), nothing can go wrong. If somebody tries to impersonate your bank, your browser will notice. And it will refuse connecting.</p>
<figure><img src="https://scattered-thoughts.net/2023/02/06/weakening-tls-protection-south-korean-style/ssl_error.png" alt="Screenshot of an error message: Did Not Connect: Potential Security Issue. Firefox detected a potential security threat and did not continue to www.citibank.co.kr because this website requires a secure connection." width="600" height="337"/></figure>

<p>This is achieved by means of a protocol called <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security (TLS)</a>. It relies on a number of trusted Certification Authorities (CAs) to issue certificates to websites. These certificates allow websites to prove their identity.</p>
<p>When investigating <a href="https://scattered-thoughts.net/2023/01/02/south-koreas-online-security-dead-end/">South Korea’s so-called security applications</a> I noticed that all of them add their own certification authorities that browsers have to trust. This weakens the protection provided by TLS considerably, as misusing these CAs allows impersonating any website towards a large chunk of South Korean population. This puts among other things the same banking transactions at risk that these applications are supposed to protect.</p>



<p>After doing online banking on your computer in South Korea, it’s worth taking a look at the trusted certification authorities of your computer. Most likely you will see names that have no business being there. Names like iniLINE, Interezen or Wizvera.</p>
<figure><img src="https://scattered-thoughts.net/2023/02/06/weakening-tls-protection-south-korean-style/authorities.png" alt="Screenshot of the Windows “Trusted Root Certification Authorities” list. Among names like GTE CyberTrust or Microsoft, also iniLINE and Interezen are listed." width="624" height="279"/></figure>

<p>None of these are normally trusted. They have rather been added to the operating system’s storage by the respective applications. These applications also add their certification authorities to Firefox which, unlike Google Chrome or Microsoft Edge, won’t use operating system’s settings.</p>
<p>So far I found the following certification authorities being installed by South Korean applications:</p>
<div><table>
<thead>
<tr>
<th>Name</th>
<th>Installing application(s)</th>
<th>Validity</th>
<th>Serial number</th>
</tr>
</thead>
<tbody>
<tr>
<td>ASTxRoot2</td>
<td>AhnLab Safe Transaction</td>
<td>2015-06-18 to 2038-06-12</td>
<td>009c786262fd7479bd</td>
</tr>
<tr>
<td>iniLINE CrossEX RootCA2</td>
<td>TouchEn nxKey</td>
<td>2018-10-10 to 2099-12-31</td>
<td>01</td>
</tr>
<tr>
<td>INTEREZEN CA</td>
<td>Interezen IPInside Agent</td>
<td>2021-06-09 to 2041-06-04</td>
<td>00d5412a38cb0e4a01</td>
</tr>
<tr>
<td>LumenSoft CA</td>
<td>KeySharp CertRelay</td>
<td>2012-08-08 to 2052-07-29</td>
<td>00e9fdfd6ee2ef74fc</td>
</tr>
<tr>
<td>WIZVERA-CA-SHA1</td>
<td>Wizvera Veraport</td>
<td>2019-10-23 to 2040-05-05</td>
<td>74b7009ee43bc78fce69 73ade1da8b18c5e8725a</td>
</tr>
<tr>
<td>WIZVERA-CA-SHA2</td>
<td>Wizvera Veraport, Wizvera Delfino</td>
<td>2019-10-23 to 2040-05-05</td>
<td>20bbeb748527aeaa25fb 381926de8dc207102b71</td>
</tr>
</tbody>
</table></div>
<p>And these certification authorities will stay there until removed manually. The applications’ uninstallers won’t remove them.</p>
<p>They are also enabled for all purposes. So one of these authorities being compromised will not merely affect web server identities but also application or email signatures for example.</p>
<h2 id="will-a-few-more-certification-authorities-really-hurt"><a href="#will-a-few-more-certification-authorities-really-hurt"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Will a few more certification authorities really hurt?</h2>
<p>If you look at the list of trusted certification authorities, there are more than 50 entries on it anyways. What’s the problem if a few more are added?</p>
<p>Running a Certificate Authority is a huge responsibility. Anyone with access to the private key of a trusted certification authority will be able to impersonate any website. Criminals and governments around the world would absolutely love to have this power. The former need it to impersonate your bank for example, the latter to <a href="https://www.theregister.com/2015/12/03/kazakhstan_to_maninthemiddle_all_internet_traffic/">spy on you undetected</a>.</p>
<p>That’s why there are <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/#2-certificate-authorities">strict rules for certification authorities</a>, making sure the access to the CA’s private key is restricted and properly secured. Running a certification authority also requires regular external audits to ensure that all the security parameters are still met.</p>
<p>Now with these South Korean applications installing their own Certificate Authorities on so many computers in South Korea, they become a huge target for hackers and governments alike. If a private key for one of these Certificate Authorities is compromised, TLS will provide very little protection in South Korea.</p>
<p>How do AhnLab, RaonSecure, Interezen, Wizvera deal with this responsibility? Do they store the private keys in a <a href="https://en.wikipedia.org/wiki/Hardware_security_module">Hardware Security Module (HSM)</a>? Are these in a secure location? Who has access? What certificates have been issued already? We have no answer to these questions. There are no external audits, no security practices that they have to comply with.</p>
<p>So people are supposed to simply trust these companies to keep the private key secure. As we’ve already seen from <a href="https://scattered-thoughts.net/categories/korea/">my previous articles</a> however, they have little expertise in keeping things secure.</p>
<h2 id="how-could-this-issue-be-solved"><a href="#how-could-this-issue-be-solved"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>How could this issue be solved?</h2>
<p>The reason for all these certificate authorities seems to be: the applications need to enable TLS on their local web server. Yet no real certificate authority will issue a certificate for 127.0.0.1, so they have to add their own.</p>
<p>If a certificate for 127.0.0.1 is all they need, there is a simple solution. Instead of adding the same CA on all computers, it should be a different CA for each computer.</p>
<p>So the applications should do the following during the installation:</p>
<ol>
<li>Generate a new (random) certificate authority and the corresponding private key.</li>
<li>Import this CA into the list of trusted certification authorities on the computer.</li>
<li>Generate a certificate for 127.0.0.1 and sign it with this CA. Application can now use it for its local web server.</li>
<li>Destroy the private key of the CA.</li>
</ol>
<p>In fact, Initech CrossWeb Ex V3 seems to do exactly that. You can easily recognize it because the displayed validity starts at the date of the installation. While it also installs its certificate authority, this one is valid for one computer only and thus unproblematic.</p>
<p>Oh, and one more thing to be taken care of: any CAs added should be removed when the application is uninstalled. Currently none of the applications seem to do it.</p>

            </div></div>
  </body>
</html>
