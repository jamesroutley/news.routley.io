<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.extremeelectronics.co.uk/pico-cray-small-scale-distributed-computing/">Original</a>
    <h1>Pico Cray – Small scale distributed computing</h1>
    
    <div id="readability-page-1" class="page"><div id="main-content">

	<div id="primary">
		<div id="content" role="main">

			
<article id="post-5871" class="page">
	<!-- .entry-header -->
	<div>
		
<p>The Pico Cray is a cluster of 8 Picos and a controller Pico. All Picos are connected in parallel by an I2C bus. The controller is designated by one GPIO being held low, the processor Pico’s addresses are allocated automatically. The Controller Pico has a 320x240px display connected by SPI and a couple of buttons. As all of the Picos run the same software updating the cluster is easy. </p>



<p>Currently the cluster is programmed to run a Mandelbrot program. With each processor Pico calculating 120 points before returning them to the Controller. </p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/c8a9c287bf6fda9e.jpg"><img decoding="async" width="768" height="1024" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/c8a9c287bf6fda9e-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/c8a9c287bf6fda9e-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/c8a9c287bf6fda9e-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/c8a9c287bf6fda9e-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/c8a9c287bf6fda9e.jpg 1247w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<p>The case of the cluster is built to mimic a classic Cray1 Supercomputer.  Including a padded seating area and the controller housed in a console desk (although not to scale with the cluster)</p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/9e8bd6cd5f7025ed.jpg"><img decoding="async" loading="lazy" width="768" height="1024" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/9e8bd6cd5f7025ed-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/9e8bd6cd5f7025ed-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/9e8bd6cd5f7025ed-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/9e8bd6cd5f7025ed-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/9e8bd6cd5f7025ed.jpg 1247w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<p><strong>Building the case.</strong></p>



<p>The case was made form a combination of transparent and red/black acrylic to mimic the original Cray1 design. To follow with this style the seating around the central column was padded with foam. </p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-scaled.jpg"><img decoding="async" loading="lazy" width="1024" height="768" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-1024x768.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-1024x768.jpg 1024w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-300x225.jpg 300w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-768x576.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-1536x1152.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230416_155036-2048x1536.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>To keep everything together, each acrylic piece was tabbed, and the bottom ring was also held together by being glued to a cardboard ring, this meant that I only needed 3 hands, out of the available 2, to try to get it all to join whilst the glue dried. </p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230412_165616-scaled.jpg"><img decoding="async" loading="lazy" width="2560" height="1920" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230412_165616-scaled.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230412_165616-scaled.jpg 2560w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230412_165616-300x225.jpg 300w" sizes="(max-width: 2560px) 100vw, 2560px"/></a></figure>



<p>The console was manufactured in the same way, pieces of black and red acrylic with tabbed were glues together to hold the display, a row of buttons and the controller Pico.</p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230414_133959-1-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230414_133959-1-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230414_133959-1-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230414_133959-1-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230414_133959-1-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230414_133959-1-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<p><strong>PCB</strong></p>



<p>The PCB for the Processors is constructed to hold the 8 Pico PCB’s in an octagon, In such a way that all of the Pico’s can be powered by the USB connector. The I2C bus and the “assert” line is extended around the Pico’s with a number of daughter PCB’s soldered together at a jaunty angle. </p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-scaled.jpg"><img decoding="async" loading="lazy" width="1024" height="577" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-1024x577.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-1024x577.jpg 1024w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-300x169.jpg 300w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-768x432.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-1536x865.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230304_234251-2048x1153.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></figure>



<p>The Base PCB is actually an 8 port hub, but due to issues with Linus/Windows and the Pico’s USB connection, it was found unworkable to use the hub for programming. </p>



<p><strong>Mandelbrot</strong></p>



<p>The test program for the distributed computer uses the Mandelbrot fractal for its test. This was chosen as its well known, easy to implement and gives a recognisable output. Also by its cartesian coordinate structure and as each point is stateless, very easy to split into a number of discrete calculations. Currently 120 points are calculated by each processor at a time in what Ive called “A Lump”]



</p><figure>
<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" data-id="5898" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-1536x2048.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194030_resized-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" data-id="5899" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-1536x2048.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194124_resized-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" data-id="5900" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-1536x2048.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194151_resized-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" data-id="5903" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-1536x2048.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194350_resized-2-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" data-id="5904" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-1536x2048.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_194424_resized-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" data-id="5905" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-1152x1536.jpg 1152w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-1536x2048.jpg 1536w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_193925_resized-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>
</figure>



<p><strong>Software</strong></p>



<p>Testing the software was done with a strip of vero standing in for the PCB, this enabled rapid reprogramming and the ability to see the USB serial on three processors and the controller all at once. </p>



<figure><a href="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230326_210626-scaled.jpg"><img decoding="async" loading="lazy" width="768" height="1024" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230326_210626-768x1024.jpg" alt="" srcset="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230326_210626-768x1024.jpg 768w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230326_210626-225x300.jpg 225w, https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230326_210626-scaled.jpg 1920w" sizes="(max-width: 768px) 100vw, 768px"/></a></figure>



<p>You can also see the termination resistors on one Pico, these were later changed to 2x 4K at each end of the I2C bus.</p>



<p>The Picos in the cluster are called Processors and Controller. The Controller is designated by GPIO22 being pulled low. </p>



<p>On turning on a Processor, it will wait a random amount of time, and if the assert line is not already high, it will set assert high, and listen on 0x17 on the I2C bus.  If the assert line is already high, the processor will wait a random amount of time </p>



<p>The Controller will see the assert bus high and know that a processor is waiting to be added, It will send  a free I2C address to that processor. (none of the others are listening) </p>



<p>On Receiving the I2C address the Processor will change its I2C address to the one given, set its state to READY and relinquish the Assert line. </p>



<p>Once there is at least one Processor in the READY the controller will send a task, currently this is an XY coordinate and a step value ( 3 doubles)  for the Mandelbrot calculation. The Lump size is currently compiled in as 120 calculations.  A note of which processor and which X &amp; Y coordinate it was sent is also saved. The Controller finishes by setting the processors BUSY flag.</p>



<p>The Processor will continue allocating tasks until there are no free Processors. </p>



<p>When the Processor has completed its task, it sets its DONE flag.</p>



<p>The Controller continues to scan each processor for its status, If it sees a DONE flag it will download the results, currently 120 unsigned chars representing the iterations of the Mandelbrot calculation. </p>



<p>A palette is applied to these values with a look up table to give a full 16 bits of colour that is then sent to the display as half a line (a full line is 240 pixels) </p>



<p><strong>Detailed Software information can be found at</strong></p>



<figure><video controls="" src="https://www.extremeelectronics.co.uk/wp-content/uploads/2023/04/20230420_211920_502837750796457.mp4"></video></figure>
	</div><!-- .entry-content -->
</article><!-- #post-5871 -->

		</div><!-- #content -->
	</div><!-- #primary -->
	<!-- #content-sidebar -->
</div></div>
  </body>
</html>
