<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://chipsandcheese.com/p/amds-strix-halo-under-the-hood">Original</a>
    <h1>AMD&#39;s Strix Halo â€“ Under the Hood</h1>
    
    <div id="readability-page-1" class="page"><div><div dir="auto"><p>Hello you fine Internet folks,</p><p>At CES 2025 I got the chance to sit down with Mahesh Subramony, AMD Senior Fellow, to talk about AMD&#39;s upcoming Strix Halo SoC which is a brand new type of product for AMD and is the big iGPU SoC that many of us have been waiting for from AMD for a long while.</p><div id="youtube2-yR4BwzgwQns" data-attrs="{&#34;videoId&#34;:&#34;yR4BwzgwQns&#34;,&#34;startTime&#34;:null,&#34;endTime&#34;:null}" data-component-name="Youtube2ToDOM"><p><iframe src="https://www.youtube-nocookie.com/embed/yR4BwzgwQns?rel=0&amp;autoplay=0&amp;showinfo=0&amp;enablejsapi=0" frameborder="0" loading="lazy" gesture="media" allow="autoplay; fullscreen" allowautoplay="true" allowfullscreen="true" width="728" height="409"></iframe></p></div><p>The transcript below has been lightly edited for readability and conciseness.</p><p><strong>George Cozma:</strong><span> Hello, you fine internet folks. </span></p><p>We&#39;re here at CES 2025 with AMD, and the big AMD announcement was this [points to an ASUS ROG Flow Z13]. Strix Halo being productized as AMD Ryzen AI Max and we happen to have a system with one in it. So, but not just that, I happen to have...</p><p><strong>Mahesh Subramony:</strong><span> I&#39;m Mahesh Subramony, Senior Fellow at AMD.</span></p><p><strong>George Cozma:</strong><span> And what do you do at AMD?</span></p><p><strong>Mahesh Subramony:</strong><span> I&#39;m a technology advisor for the client business unit. But for the better part of the last decade, I was an SOC architect for chips within AMD.</span></p><p><strong>George Cozma:</strong><span> So, let&#39;s start with Strix Halo. Let&#39;s start with the CPU side, what&#39;s different about the Zen 5 here compared to say, I don&#39;t know, desktop Zen 5?</span></p><p><strong>Mahesh Subramony:</strong><span> Yeah, I mean, first off, I think putting that chip together has been a life&#39;s dream over the time. I think ever since we did the merger a long time ago with ATI to bring graphics in-house, we&#39;ve always talked about building a big APU of sorts where we could match the CPU performance and the GPU performance on a single package and deliver that in the form factor that you see today. And took quite a few iterations to kind of get it to where it is right now to get that right value that we thought bring to the end user. And yeah, so it took four iterations to get here. And so we&#39;re glad we&#39;re here. And it had to check a lot of boxes because at the end of the day, it had to meet the needs of the consumer. And so we&#39;re very aware of that. The CPUs on here, they have the same DNA. It&#39;s still Zen 5. It&#39;s still the same architecture, but we needed to pay more attention to power.</span></p><p>So the CCDs that are featured to a first order in the desktop part, they have an actual PHY that connects the two dies. And so there is there&#39;s actually a distance that it needs to travel. It&#39;s a SERDES and you&#39;re able to go some distance between the two. That&#39;s how we&#39;ve always connected the two. And that&#39;s a low cost interface, if you will. It is a high bandwidth interface. But that had low power states that could only take it so far. And you had retraining and latency implications every time the chip went down and came back up and so on. So for an always on kind of a desktop kind of machine, that seemed like the best interconnect to connect that as we try to build this into an APU. The first thing we had to do was to change the interconnect between the two dies. And so the CCD that you see here, the core die that you see here, has a different item. That&#39;s the first change.</p><p>That&#39;s a sea of wires. We use fan out, we&#39;re for level fan out in order to connect the two dies. So you get the lower latency, the lower power, it&#39;s stateless. So we&#39;re able to just connect the data fabric through that connect interface into the CCD. So the first big change between a Granite or a 9950X3D and this the Strix Halo always the die to die interconnect. Low power, same high bandwidth, 32 bytes per cycle in both directions, lower latency. So everything that and almost instant on and off stateless because it&#39;s just a sea of wires going across. So it&#39;s a little [bit of a tradeoff] of course, the fabrication technology is more expensive than the one over there [points to a 9950X3D], but it meets the needs of the customer and the fact that it has to be a low power that can actually connect.</p><p><strong>George Cozma:</strong><span> And are the FPUs in the Strix Halo cores the full 512 bit FPU or is it like Strix Point where it&#39;s similar to Zen 4 where it&#39;s 256 bit?</span></p><p><strong>Mahesh Subramony:</strong><span> This machine is intended to be a workhorse. It is a workstation. I almost joke about it saying it&#39;s a Threadripper to put in the palm of your hands. So we didn&#39;t pull any punches. These have the 512 bit data path. It is a full desktop architecture. We have binned the parts for efficiency. So it might not hit the peak frequency that you would see on the desktop. That&#39;s one of the second differences in the cores you would find over here and the cores over there. They&#39;re colder, so you get the efficiency that you would like on these parts when you run multi thread workloads, you&#39;re able to get a higher effective frequency on these. But what you give up is some peak frequency, which I think in a thin form factor that you have today, you don&#39;t have the thick cooling solutions that you would see on a desktop part anyway. So the demand of the form factor says that you need cores that are cooler, if you will, lower in that FP curve where you can extract efficiency. So these are binned, the same architecture, the same set of pipes, the data parts are the same. The differences are in how we bin the part and how we connect the two parts.</span></p><p><strong>George Cozma:</strong><span> Now moving from the CPU over to the big huge SOC tile over here that holds your iGPU, now I know that this wasn&#39;t mentioned in the slide deck, but there&#39;s 32 megabytes of what&#39;s known as MALL or infinity cache. How does that react with the CPU cores? So can the CPU cores access that 32 megs of cache?</span></p><p><strong>Mahesh Subramony:</strong><span> It cannot. So let me make sure I make that statement very clear. The MALL exists to amplify graphics bandwidth. I think that&#39;s the intent of it. So the only compute engine right now, I mean, it&#39;s a flexible allocation policy. We should start with that. But the intended way it is configured right now is writes from source from the GPU installs into the MALL. CPU writes do not install into the MALL. Can we change that with a flip of a bit but we don&#39;t see an application right now where we need to amplify CPU bandwidth.</span></p><p>So we reserve and there were times when we have worked on carve outs for say display or video encode/decode to kind of say, hey, look, can I have two slices of the MALL kind of be a place where the VCN or the video encode decoder, the display can kind of play or even the inference engine to store some weights. So we have played around with what can and cannot allocate into that structure. And the way it is defined right now is where only the GPU installs into the MALL. Now, as we explore more and more applications, you know, it&#39;s a software release where we can release a firmware that says, hey, look, we have changed the configuration of how the MALL is going to be set up. So much will be reserved for the GPU. And hey, we decided to carve this out for another computer engine and NPU, the video encode decoder display.</p><p>And now you&#39;re going to get X amount of speed up X amount of battery life, you know, so on. So any agent can install into it. I want to make sure the flexibility in the architecture exists. But the way it is defined right now, we&#39;ve run a few use cases right now. We feel the best use of that MALL is for graphics to use it as a bandwidth amplifier. So graphics is the only compute engine with a flag set where all rights installed into the MALL. Now, the MALL is coherent. So when a CPU access comes in, it does check the MALL to say, is the line existing over there because it&#39;s a right that is waiting to be committed. And it either says no longer because somebody else asked the line. So let&#39;s just forward that that data over to whoever asked for it. So it stays coherent. It is part of the coherent fabric.</p><p>Every write to memory, there is a lookup into the MALL as well. It&#39;s a it&#39;s a it&#39;s a cache that we need to look up as well. But from a from a point of view as who gets the most benefit from that MALL, it is the GPU. It writes into the MALL. And depending on the traffic pattern, if there are more hits onto the MALL, you get that read bandwidth amplification, which in certain scenarios we&#39;ve seen that to be double digit. So we are going from a GDDR memory that exists in a discrete solution to LPDRR. So we understand we are undersized, but the MALL acts as that as that amplifier. So for a large for a large GPU that that we have over here, 40 40 compute units, you know, the perfect use of that MALL is to get that.</p><p><strong>George Cozma:</strong><span> Speaking of that coherency, is MALL acting as your last layer of coherency for all your compute units?</span></p><p><strong>Mahesh Subramony:</strong><span> No, that is still a block in our data fabric that sits right before the memory controller. OK. That acts as the place where as the point of coherence. OK. All memory accesses. So memory is divided up into, you know, based on its interleaving. Here are the different controllers that if you want to access this line, you have to go to this controller and the data fabric IP that sits right before it&#39;s a any access to whatever is behind me comes to me. I&#39;m the point of coherence for all lines below. OK. Now, I am going to check the profile structure to see if the CPU has the line. I&#39;m going to check the MALL to see if that has been installed in here by some point of coherence runs through those data fabric IPs that interface with the memory controllers. So that&#39;s that stays as the point of coherency.</span></p><p><strong>George Cozma:</strong><span> It&#39;s not the point of coherency and speaking to again to the data fabric, are you seeing any clock speed benefit from the fact that it&#39;s just a sea of wires connecting the CPU to the SOC tile?</span></p><p><strong>Mahesh Subramony:</strong><span> We are able to get power benefits. Because prior to that, we had a GMI PHY that lived in there and that consumed a whole lot of power in order to be able to send this over high frequencies over short distances. Here we are clocking it at a way less than the 20 gigs that the GMI was being clocked at. This is anywhere between, you know, one to two gigahertz. You know, really clock rate match to the data fabric itself. So there is no asynchronous interface here where you have to pay a whole lot. It&#39;s just mapped to directly the fabric. So at a lower voltage, you are able to because we used a sea of wires, you are able to get that that high bandwidth to match it. We spend the area in terms of the wires that need to come through but we&#39;re able to clock it at a meaningfully lower speed so you get the power benefit.</span></p><p>Can we clock this even faster? Well, there would be no need for it if we don&#39;t we are not able to clock memory faster as well. Remember, there is no DDR here like desktop where you have OC and you&#39;re able to push this higher and higher. So moving the fabric clock gets you some benefits. This is LPDDR. It&#39;s a little tense, tends to be less conducive to overclocking. So being rate matched to memory in a more power efficient way, that was the target rather than trying to push the clock. But yeah, we have more flexibility here if you wanted to.</p><p><strong>George Cozma:</strong><span> And so sort of to end this conversation back where we started at the CPU with that fabric, how much memory bandwidth can the single CCD access since it is 32 bytes per cycle reads?</span></p><p><strong>Mahesh Subramony:</strong><span> It does really comes down to. We can have a single CCD saturate them. You don&#39;t need both. You can have a single CCD saturate data bandwidth. You can have four cores, even two cores if you write the right stream benchmark and saturate data bandwidth, because the CPU can issue a request every cycle. The CCD CPU can request an issue every cycle. So you&#39;re going to see that eventually you&#39;re going to get picked back by how quickly a response can come back. And a response can come back once every depending on where it goes and how the response comes back. You&#39;re eventually going to get clogged by how quickly the memory requests are draining on the on the on the UMC side of the memory controller side. So we have one to two CPUs being able to get close to saturating the bandwidth they want to do with the right stream bandwidth going to open pages and so on and so forth. </span></p><p>So but again, with the right mix of the right mix of traffic between reads and writes, like I said, a couple of CPU threads can saturate bandwidth. So it&#39;s not. But again, when it comes to bandwidth, we believe that NPU and the GPU are the ones that benefit more than from a CPU standpoint. I think latency and latency under load, 15 to 20 percent load, but still not have that hockey stick in terms of latency just jumping up. So we&#39;re not faking it that only the first request gets the lowest latency and everybody else does not take the bypass parts and pairs base heavy penalty, making sure you have steady low latency for the CPU and high bandwidth for GPU.</p><p><strong>George Cozma:</strong><span> And to finish off, the most important question, what&#39;s your favorite type of cheese?</span></p><p><strong>Mahesh Subramony:</strong><span> Gorgonzola. Is that is that a is that an answer? It&#39;s a good answer. The Gorgonzola ravioli [as a] shout out to to do a restaurant back in back in my hometown.</span></p><p><strong>George Cozma:</strong><span> Thank you so much for this interview. Mahesh. </span></p><p><strong>Mahesh Subramony:</strong><span> Always a pleasure. George. </span></p><p><strong>George Cozma:</strong><span> Absolutely.</span></p><p><span>If you like the content then consider heading over to the </span><a href="https://www.patreon.com/ChipsandCheese" rel="">Patreon</a><span> or </span><a href="https://www.paypal.com/donate/?hosted_button_id=4EMPH66SBGVSQ" rel="">PayPal</a><span> if you want to toss a few bucks to Chips and Cheese. Also consider joining the </span><a href="https://discord.gg/TwVnRhxgY2" rel="">Discord</a><span> and subscribing to the </span><a href="https://www.youtube.com/@chipsandcheesecc" rel="">Chips and Cheese Youtube channel</a><span>.</span></p></div></div></div>
  </body>
</html>
