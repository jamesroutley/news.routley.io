<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nexy.blog/2025/07/27/how-i-hacked-my-washing-machine/">Original</a>
    <h1>I hacked my washing machine</h1>
    
    <div id="readability-page-1" class="page"><div data-md-component="container"> <main data-md-component="main"> <div>   <div data-md-component="content">  <article> <a href="https://git.nexy7574.co.uk/nex/blog/edit/dev/docs/posts/0006-How-I-hacked-my-washing-machine.md" title="Edit this page" rel="edit"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg> </a>  <p>If you&#39;ve known me for some amount of time you knew this was something that was bound to happen eventually. Yesterday (and technically today), me and a friend went on an endeavor to hack our washing machine, partially for the fun of it, and partially because there&#39;s actually a practical use for it.</p> <!-- more --> <div> <p>Don&#39;t take this article too seriously</p> <p>A lot of the response I&#39;ve seen to this post has been &#34;this was unnecessarily complicated&#34;.</p> <p>Since a lot of people don&#39;t seem to be reading the whole article, especially the last part, I just want to clarify: <strong>This was done for fun and as a challenge</strong>, the sheer absurdity of connecting our washing machine to our Discord to receive notifications when our cycles finish is what put this whole thing into motion. </p> <p>While there is practical use, I know it&#39;s limited, and that this could be done simply by using a smart plug or even just overestimating the time it&#39;ll take to finish the cycle. But come on, if we did that, you wouldn&#39;t be reading this hilarious article where I later explain how we reverse engineered a washing machine and further plan to &#34;hack&#34; our other dumber appliances.</p> <p>Plus, even if this was all pointless, at least I got to get some reverse engineering practice in a practical scenario :P</p> </div> <h2 id="some-background">Some background<a href="#some-background" title="Permanent link">¶</a></h2> <p>For context, I recently moved into a new house for uni, with some friends. This house was pre-furnished, so it came with all the appliances we needed, including a washing machine and whatnot. And, in true typical renting fashion, the washing machine is some cheap &#34;smart&#34; model, that features a Wi-Fi connection, and a mobile app to control it. Now, half of this house is populated by cybersecurity students, so naturally we were scoffing at the idea of putting the washing machine on the network.</p> <p>And then we did it.</p> <p>Turns out, this washing machine has the capability to send notifications to the mobile app whenever a load finishes. There&#39;s also some other stuff too like &#34;self clean&#34; or whatever, but nothing functional (the app is some cheap crappy HTML job crammed into a WebView). This was kinda funny, however, having notifications for when your &#34;three hour&#34; (usually like 4-5 hours) load finishes is actually really useful, especially when you&#39;re like me and forgot to... buy clothes, so have to keep the same set of clothes clean constantly. However, <em>only one person can be connected to the washing machine at a time</em>, so if someone else wanted notifications, you&#39;d have to disconnect the washing machine from your app, and then let them do the whole jig. Which involves reconnecting it to the Wi-Fi network, by the way.</p> <figure> <img alt="Washing machine app" src="https://slinkp.com/0006-How-I-hacked-my-washing-machine/hoover-wizard-app-small.avif"/> <figcaption> The front page of the washing machine app, after logging in. The app is called &#34;<a href="https://apps.apple.com/gb/app/hoover-wizard/id1004955716">Hoover Wizard</a>&#34;. </figcaption> </figure> <figure> <img alt="Wash cycle notifications" src="https://slinkp.com/0006-How-I-hacked-my-washing-machine/notifications-small.avif"/> <figcaption> Notifications received for when a wash cycle finishes. </figcaption> </figure> <h3 id="the-doorbell">The doorbell<a href="#the-doorbell" title="Permanent link">¶</a></h3> <p>Tangentally related, this house is an incredibly old victorian house, meaning the walls, floors, and doors are super thick. There&#39;s also only one person living on the ground floor near the door, so having someone knock on the door, or a doorbell that just rings near the door isn&#39;t helpful, since nobody will hear it. Luckily, however, this doorbell has a receiver that plugs in elsewhere, and the doorbell broadcasts a signal to it when pressed. This is a 433MHz doorbell, which is a common frequency for these types of devices.</p> <p>In short, my friend bought a cheap receiver that listens for these signals, and then uses that signal to send a notification in our Discord server, so that we all know when someone rang the doorbell. In future, it&#39;ll also probably be used in conjunction with a security camera, so we can see who rang the doorbell. Pretty neat, right?</p> <figure> <img alt="Doorbell alerts in the discord server" src="https://slinkp.com/0006-How-I-hacked-my-washing-machine/doorbell-bot.webp"/> <figcaption> The doorbell triggering a notification in our Discord server. </figcaption> </figure> <p>This does still, in addition, ring the actual doorbell receiver, so there&#39;s still an audible notification, but this is more of a backup.</p> <p>It was after seeing the success of this project that we had the bright idea - what if we could do the same thing with the washing machine? So we started plotting...</p> <h2 id="the-plan">The plan<a href="#the-plan" title="Permanent link">¶</a></h2> <p>Going into this, I had some experience with reverse engineering and hacking apps on my phone. I had previously done a bit of work on reverse engineering the attendance app for my university, which was fun, but ultimately didn&#39;t go anywhere because it started being more effort than fun. However, this lead me to the initial idea - see what the washing machine app connects to, and work out the API from there. This would&#39;ve been simple, just install some self-signed TLS certificate on my phone, and then use a tool like <code>tcpdump</code> and <code>mitmproxy</code> to capture DNS requests and other traffic.</p> <p>However, we realised that most of the work was done <em>by the washing machine itself</em>. This gave me the bright idea to just capture the traffic from the washing machine itself, and then reverse engineer that. And so, I went and grabbed an <a href="https://openwrt.org/">OpenWRT</a>-compatbile router I had laying around, flashed it, and set it up to listen on 2.4GHz (since that&#39;s all the washing machine worked with), and connect to WAN via 5GHz, with my laptop in the middle connected over Ethernet.</p> <p>After setting up the router, I broadcast a temporary SSID, and paired the washing machine to it. Grabbed the IP address of the washing machine, and then started capturing traffic with <code>tcpdump</code>. Unfortunately, I don&#39;t have any of those captures anymore.</p> <h2 id="who-is-my-washing-machine-talking-to">Who is my washing machine talking to<a href="#who-is-my-washing-machine-talking-to" title="Permanent link">¶</a></h2> <p>After tracing the traffic for a short while, I noticed four things:</p> <ol> <li>The washing machine REALLY liked talking to... itself? I don&#39;t think whoever engineered their networking stack knew what a loopback interface was, because it was sending a lot of traffic from itself to its own IP address. I didn&#39;t think this was relevant, so I ignored it.</li> <li>It really liked sending traffic to <code>255.255.255.255</code> every second, for some reason. Again, ignored.</li> <li>It occasionally contacted <code>simplyfimgmt.candy-hoover.com</code>. This is a CNAME to some herokudns domain, which I thought was odd, but also couldn&#39;t pull anything interesting from it. I did, however, see <code>&amp;encrypted=1</code> in the URL, which I thought <em>was</em> interesting, since this appliance was connecting to this server over <code>HTTP</code>, not <code>HTTPS</code>.</li> <li>The washing machine was <em>directly connecting</em> with the mobile app, with the app sending HTTP requests to port 80.</li> </ol> <p>Of all these four things, only the last one was particularly interesting, so I started looking into it. I assume the server contacting <code>simplyfimgmt.candy-hoover.com</code> was for notifications, but I couldn&#39;t get anything useful out of it. That&#39;s when my friend suggested that we just... poll the washing machine.</p> <p>What an insane sentence, by the way. Poll the washing machine?</p> <h2 id="reverse-engineering-the-washing-machines-api">Reverse engineering the washing machine&#39;s API<a href="#reverse-engineering-the-washing-machines-api" title="Permanent link">¶</a></h2> <p>So, trying to intercept notifications from the washing machine was pretty much out of the question. at least without a lot more effort. So, I started looking into how the app behaves when opened, and when I try to interact with the washing machine, etc.</p> <p>It looked like the app was only contacting two endpoints:</p> <ol> <li><code>/http-read.json?encrypted=1</code></li> <li><code>/http-write.json?encrypted=1</code></li> </ol> <p>There were possibly more, but those were the ones that stuck out to me, and were also repeatedly contacted by the app.</p> <p><code>http-write.json</code> looked like it was used to send commands to the washing machine, such as to start a self-clean, or whatever. This was thrown aside since we didn&#39;t want to talk to the washing machine, we wanted the washing machine to talk to us.</p> <p>Moving on to <code>http-read.json</code>, this looked like it was used to read the state of the washing machine, however, <em>it was encrypted!</em>. Your eyes do not deceive you, that <code>?encrypted=1</code> query parameter was actually doing something!</p> <p>In the most ugly manner possible, after loading up the endpoint in my browser, I was greeted to</p> <div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>HTTP/1.1 200 OK
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Content-Type: text/html
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>45D3EBF9E63886CD240D412B44973ECBCD96ADFF263D56E293C48B9F0C884D00...
</span></code></pre></div> <p>That&#39;s right, the washing machine was sending encrypted data... as hex... with a HTML content type. This was incredibly infuriating, because now I had to figure out how to decrypt this data.</p> <h3 id="breaking-the-encryption">Breaking the encryption<a href="#breaking-the-encryption" title="Permanent link">¶</a></h3> <div> <p>Couldn&#39;t you just set <code>encrypted=0</code>?</p> <p>I thought this too, however, setting <code>encrypted=0</code> returned the encrypted data still, <strong>or</strong> return a 400 Bad Request. No idea why, but also don&#39;t care.</p> </div> <p>In March, me and my friend had visited Lancaster University for the cybersecurity conference, <a href="https://hackademia.ac/">Hackademia 2025</a>. While I don&#39;t remember too much of that conference (although it was <em>amazing</em>, if you get the chance to go to it, I highly recommend it), I do remember one of the workshops we attended being about hacking an IoT camera, run by <a href="https://www.interruptlabs.co.uk/">Interrupt Labs</a>. Now, I didn&#39;t do very well at this - it was far lower-level than I was used to working at, so a lot of the concepts were lost on me. However, I did learn some fundamental concepts that would prove to be useful later on, namely the fact that most of these devices are insecure, have firmware just publicly available, are terrible for re-using credentials, and are pretty often poorly secured in general. I also learned that these devices will often have some incredibly simple home-grown encryption by just XORing data.</p> <p>This left me with two possible ideas to get the washing machine&#39;s XOR key - either pull the machine apart, read the firmware, and put it all back together (hard), or just try to brute-force the key (easy). I only had my laptop with me at this time, so brute-forcing a key with very little information on what we were looking for seemed suboptimal. But also, taking apart a whole ass washing machine just to read a short string seemed silly, so I got to work on brute-forcing the key with <a href="https://gchq.github.io/CyberChef/">CyberChef</a>.</p> <figure> <a href="https://slinkp.com/0006-How-I-hacked-my-washing-machine/cyberchef.avif"><img alt="CyberChef executing an XOR brute-force" src="https://slinkp.com/0006-How-I-hacked-my-washing-machine/cyberchef-small.avif"/></a> <figcaption> CyberChef churning away at an XOR brute-force on the washing machine&#39;s encrypted response. </figcaption> </figure> <p>Unfortunately, we were fighting an uphill battle with this one. We had no idea what a known string would be inside the decrypted data, and we had no idea how long the key was. As my laptop is some thin workbook, it has 8 cores (16 threads), so brute forcing a key of length 3 or more was taking FOREVER. It was during this time that my friend was researching if anyone else had managed to do this before, and sure enough, <a href="https://github.com/MelvinGr/CandySimplyFi-tool">MelvinGr/CandySimplyFi-tool</a> existed. This is a simple C++ program that <a href="https://github.com/MelvinGr/CandySimplyFi-tool/blob/d89c54b/CandySimplyFi.cpp#L204-L209">already knew some known strings</a>, and was able to brute-force the key in a matter of seconds. I was able to compile this on my laptop, and run it, and sure enough, it was able to decrypt the data in a matter of seconds.</p> <p>For now, I plugged this key into CyberChef, and was able to decrypt the data.</p> <figure> <a href="https://slinkp.com/0006-How-I-hacked-my-washing-machine/cyberchef-2.avif"><img alt="CyberChef decrypting the washing machine&#39;s response" src="https://slinkp.com/0006-How-I-hacked-my-washing-machine/cyberchef-2-small.avif"/></a> <figcaption> CyberChef decrypting the washing machine&#39;s response with the key we found. </figcaption> </figure> <p>And, luckily, subsequent requests to the machine returned the same format, so guess what, we now also had a schema! I ended up re-using some of the components of <a href="https://github.com/ofalvai/home-assistant-candy/blob/main/custom_components/candy/client/model.py">ofalvai/home-assistant-candy</a>, which meant I didn&#39;t need to spend too long figuring out what the data meant. Now, on to the fun bit.</p> <h3 id="prodding-the-machine">Prodding the machine<a href="#prodding-the-machine" title="Permanent link">¶</a></h3> <p>Now came the most fun part of all of this - poking the machine to see what changes.</p> <p>We started by simply just turning the washing machine on, and noting down what changed. And then turning on a cycle, letting it run for a bit, pausing it mid way, restarting it, and then letting it finish.</p> <p>After a while, we&#39;d got a pretty good idea of everything that changed, however, during our testing, we noticed a huge issue - the Wi-Fi chip in the washing machine <em>went to sleep</em> if it wasn&#39;t contacted <em>every 30 seconds</em>. Unless the washing machine woke it up to send a ping to the remote server, it would just stop responding to rqeuests periodically, which was incredibly annoying. My workaround for this is to just request the endpoint every three seconds.</p> <p>Anyway, we noticed the following things changed:</p> <ul> <li><code>Pr</code> changed whenever the program selection knob was turned, or when the washing machine was turned on. Obviously, this relates to the program selected.</li> <li><code>PrPh</code> changed during the wash cycle, so it looked like it represented the current phase of the wash cycle.</li> <li><code>Temp</code> changed whenever the program changed or when the temperature was manually set.</li> <li><code>SpinSp</code> changed whenever the spin speed was changed.</li> <li><code>RemTime</code> changed frequently during the wash cycle, and represented the remaining time of the wash in minutes.</li> </ul> <p>Interestingly, <code>RemTime</code> was fairly accurate, however, sometimes it would just drop to <code>10</code> for seemingly no reason. I still don&#39;t know for sure why this happens, but I assume it&#39;s some default value that the washing machine uses when it doesn&#39;t know how long is left. In my notification script (later), I just opted to ignore the value <code>10</code>. My washing machine will never be able to finish a wash in 10 minutes, only ever 9 minutes or 11.</p> <p>Additionally, <code>SpinSp</code> was only ever whatever the program selected dictated - not the machine&#39;s actual current spin speed. This is annoying because I really want to know when my washer is spinning at 1495 RPM instead of 1500, but whatever I guess.</p> <h2 id="creating-the-notification-script">Creating the notification script<a href="#creating-the-notification-script" title="Permanent link">¶</a></h2> <p>So, by this point, I now have</p> <ul> <li>The washing machine&#39;s API schema</li> <li>The washing machine&#39;s encryption key</li> <li>The ability to poll the washing machine</li> <li>The ability to decrypt the washing machine&#39;s responses</li> <li>The ability to read the washing machine&#39;s state</li> </ul> <p>Now, I just needed to write a script that would poll the washing machine, and then ping that over to a Discord webhook.</p> <p>I&#39;ll save you the details of how it works, you can read the source code here: <a href="https://git.nexy7574.co.uk/nex/washing-machine-bot">https://git.nexy7574.co.uk/nex/washing-machine-bot</a></p> <p>In summary, the functionality loop is as follows:</p> <ol> <li>Poll the washing machine</li> <li>If the response hasn&#39;t changed, sleep 3 seconds and repeat.</li> <li>If something has changed, attempt to edit the last webhook message</li> <li>If the webhook message doesn&#39;t exist, create a new one</li> <li>Wait 3 seconds and repeat</li> </ol> <p>In future I plan to add a way to set up personalised pings and also claim a wash cycle and whatnot, plus some fun stats tracking or something like that, but for now it does what I need it to do.</p> <figure> <img alt="Washing machine bot in action" src="https://slinkp.com/0006-How-I-hacked-my-washing-machine/washing-machine-notification.webp"/> <figcaption> The washing machine bot in action, showing the current state of the washing machine. </figcaption> </figure> <h2 id="what-next">What next?<a href="#what-next" title="Permanent link">¶</a></h2> <p>Oh buddy, it doesn&#39;t stop there. We&#39;ve currently got a doorbell pinging into our Discord, and the washing machine constantly updating too, but as my friend put it, we &#34;need more smart-home bullshit&#34;. So, what next?</p> <p>Well, the washing machine is the only &#34;smart&#34; Wi-Fi enabled appliance in the house. But, how do I know when my tumble dryer is done? Or my dishwasher? How am I going to control my TV without using the remote? It&#39;s 2025 people! I shouldn&#39;t have to use a remote to control my TV!</p> <p>The plan is, in future, since we can&#39;t hack something that doesn&#39;t have a brain, to instead attach a brain to it. The dishwasher is easy, we can just whack that on a smart plug and monitor when the power use surges and drops. The dryer is a bit more difficult, since they pull a LOT of power, and smart plugs typically either don&#39;t support that much power, or are incredibly expensive. So that&#39;s likely going to be some fancy vibration sensor-based thingy, and the TV can likely be controlled by some cheap IR blaster hooked up to a control board or something. We&#39;re also probably going to rig some awful webcam cameras up to the windows at the front and back of the house, in theory for security monitoring, but in reality, just for the love of the game.</p> <hr/> <p>Anyway, that&#39;s all I&#39;ve got for you this newsround. I hope you enjoyed the read! If you&#39;ve got any questions or feedback, feel free to contact me: <a href="https://timedout.uk/contact.html">https://timedout.uk/contact.html</a>. Also if you think I do cool things, I now have fee-free ways to buy me a beverage: <a href="https://timedout.uk/donate.html">https://timedout.uk/donate.html</a>.</p>  </article> </div>   </div>  </main>  </div></div>
  </body>
</html>
