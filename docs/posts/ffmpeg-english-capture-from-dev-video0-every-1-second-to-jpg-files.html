<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/dheera/scripts/blob/master/ffmpeg-english">Original</a>
    <h1>Show HN: ffmpeg-english &#34;capture from /dev/video0 every 1 second to jpg files&#34;</h1>
    
    <div id="readability-page-1" class="page"><div><div><div id="repos-sticky-header"><div><div><h2 data-testid="screen-reader-heading">File metadata and controls</h2><div><ul aria-label="File view"><li></li><li></li></ul><div><div><p><span>executable file</span></p><p><span>·</span></p><p><span>50 lines (39 loc) · 1.64 KB</span></p></div></div></div></div></div></div><div><section aria-labelledby="file-name-id-wide file-name-id-mobile"><div><div id="highlighted-line-menu-positioner"><div id="copilot-button-positioner"><div><div role="presentation" aria-hidden="true" data-tab-size="8" data-paste-markdown-skip="true" data-hpc="true"><div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17<span></span></p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31<span></span></p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p></div><div><div><div><p><span># Makes ffmpeg easier to use by accepting plain English. Usage:</span></p></div></div><div><div><p><span># ffmpeg-english &#34;capture video from the camera every 1 second and write it to jpg files&#34;</span></p></div></div><div><div><p><span># ffmpeg-english &#34;take all of the images ending with .jpg in this directory and make a 30fps timelapse of it&#34;</span></p></div></div><div><div><p><span># Ensure you have set your OpenAI API key as an environment variable</span></p></div></div><div><div><p><span>openai</span>.<span>api_key</span> <span>=</span> <span>os</span>.<span>getenv</span>(<span>&#34;OPENAI_API_KEY&#34;</span>)</p></div></div><div><div><p><span>def</span> <span>get_ffmpeg_command</span>(<span>task_description</span>):</p></div></div><div><div><p><span># Call the OpenAI API with the task description</span></p></div></div><div><div><p><span>response</span> <span>=</span> <span>client</span>.<span>chat</span>.<span>completions</span>.<span>create</span>(</p></div></div><div><div><p>            {<span>&#34;role&#34;</span>:<span>&#34;system&#34;</span>, <span>&#34;content&#34;</span>:<span>&#34;You are an expert in FFmpeg commands. Given the following English description of a task, you respond with the correct FFmpeg command. Do not include any other information in your response except for the command only.&#34;</span>},</p></div></div><div><div><p>            {<span>&#34;role&#34;</span>:<span>&#34;user&#34;</span>, <span>&#34;content&#34;</span>:<span>task_description</span>},</p></div></div><div><div><p><span>command</span> <span>=</span> <span>response</span>.<span>choices</span>[<span>0</span>].<span>message</span>.<span>content</span>.<span>strip</span>()</p></div></div><div><div><p><span>print</span>(<span>&#34;Usage: ffmpeg-english &lt;task_description&gt;&#34;</span>, <span>file</span><span>=</span><span>sys</span>.<span>stderr</span>)</p></div></div><div><div><p><span>task_description</span> <span>=</span> <span>&#34; &#34;</span>.<span>join</span>(<span>sys</span>.<span>argv</span>[<span>1</span>:])</p></div></div><div><div><p><span>ffmpeg_command</span> <span>=</span> <span>get_ffmpeg_command</span>(<span>task_description</span>)</p></div></div><div><div><p><span>assert</span>(<span>ffmpeg_command</span>.<span>startswith</span>(<span>&#34;ffmpeg&#34;</span>))</p></div></div><div><div><p><span>assert</span>(<span>&#34;;&#34;</span> <span>not</span> <span>in</span> <span>ffmpeg_command</span>)</p></div></div><div><div><p><span>assert</span>(<span>&#34;|&#34;</span> <span>not</span> <span>in</span> <span>ffmpeg_command</span>)</p></div></div><div><div><p><span>print</span>(<span>f&#34;Executing command: <span><span>{</span><span>ffmpeg_command</span><span>}</span></span> in 2 seconds (^C to cancel)&#34;</span>)</p></div></div><div><div><p><span>os</span>.<span>system</span>(<span>ffmpeg_command</span>)</p></div></div><div><div><p><span>if</span> <span>__name__</span> <span>==</span> <span>&#34;__main__&#34;</span>:</p></div></div></div></div></div></div></div></div></section></div></div></div></div>
  </body>
</html>
