<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://community.wolfram.com/groups/-/m/t/1793319">Original</a>
    <h1>Factorio – Visualizing construction material dependencies</h1>
    
    <div id="readability-page-1" class="page"><div>
		<td>
			<div>

				
				<p><img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=fd1f632099404d13bb4a9c2ce3f1284e92058e00078b28baf5e6858887e5c505_product_card_v2_mobile_slider_639.jpg&amp;userId=73716" alt="enter image description here"/></p>
<p>Factorio is a game where you crashed on a planet with your space-craft. You have to built a new rocket and leave this planet again. In order to do so you will need to mine metals and built yourself a factory, make labs to do research, and built machine that make other machines, and finally combine all of this to make rockets, satellites, rocket fuel, trains, flying robots, oil products, steam engines, plastics, electronic chips, iron, copper, uranium centrifuging, solar panels etc etc. An incredibly complicated game where the key idea is that you automate this entire process using machines in your factory.</p>
<p>See <a href="https://www.youtube.com/watch?v=KVvXv1Z6EY8">https://www.youtube.com/watch?v=KVvXv1Z6EY8</a> .</p>
<p>To do research you need to manufacture research-packs which are created from other resources, which might also be created from other resources etc. etc. </p>
<p>Here is some code that interprets the Factorio wiki:</p> 
<pre>baseurl = &#34;https://wiki.factorio.com&#34;;
ClearAll[GetImage]
ClearAll[FindDependencies]
GetImage[url_] := GetImage[url] = Import[url]
FindDependencies[url_String] := 
 FindDependencies[url] = Module[{xml, c, end, other, sel = 1},
   xml = Import[url, &#34;XMLObject&#34;];
   c = Cases[xml, 
     XMLElement[&#34;table&#34;, {}, {contents_}] :&gt; contents, \[Infinity]];
   c = Select[c, 
     MemberQ[#, XMLElement[&#34;p&#34;, {}, {&#34;Recipe\n&#34;}], \[Infinity]] &amp;];
   c = FirstCase[#, 
       XMLElement[
         &#34;tr&#34;, {}, {XMLElement[
           &#34;td&#34;, {___, 
            &#34;class&#34; -&gt; &#34;infobox-vrow-value&#34;}, {x__}]}] :&gt; {x}, 
       Missing[], \[Infinity]] &amp; /@ c;
   If[Length[c] &gt; 0,
    c = c[[sel]];
    c = Cases[c, 
      XMLElement[
        &#34;div&#34;, {&#34;class&#34; -&gt; &#34;factorio-icon&#34;, 
         &#34;style&#34; -&gt; &#34;background-color:#999;&#34;}, {XMLElement[
          &#34;a&#34;, {&#34;shape&#34; -&gt; &#34;rect&#34;, &#34;href&#34; -&gt; hrefurl_, 
           &#34;title&#34; -&gt; name_}, {XMLElement[
            &#34;img&#34;, {&#34;alt&#34; -&gt; _, &#34;src&#34; -&gt; imgurl_, &#34;width&#34; -&gt; &#34;32&#34;, 
             &#34;height&#34; -&gt; &#34;32&#34;,___}, {}]}], 
         XMLElement[
          &#34;div&#34;, {&#34;class&#34; -&gt; &#34;factorio-icon-text&#34;}, {num_}]}] :&gt; 
       FactorioObject[baseurl &lt;&gt; hrefurl, name, 
        GetImage[baseurl &lt;&gt; imgurl], 
        ToExpression@StringTrim[StringReplace[num, &#34;k&#34; -&gt; &#34;000&#34;]]], \[Infinity]];

    c = DeleteCases[c, FactorioObject[_, &#34;Time&#34;, _, _]];
    {{end}, other} = TakeDrop[c, -1];
    other -&gt; end,
    {}
    ]
   ]
ClearAll[FindDependencyTree]
FindDependencyTree[url_String, iterations_: 6] := 
 Module[{a, known, unknown, new, vlbls, vertices},
  a = FindDependencies[url];
  known = {a};
  Do[
   unknown = Join @@ known[[All, 1]];
   unknown = DeleteDuplicates[Complement[unknown, known[[All, 2]]]];
   new = DeleteDuplicates[FindDependencies@*First /@ unknown];
   new = DeleteCases[new, {}];
   known = DeleteDuplicates[Join[known, new]];
   ,
   {iterations}
   ];
  vlbls = 
   Cases[known, 
    FactorioObject[_, name_, 
      icon_, _] :&gt; (name -&gt; 
       Image[icon, ImageSize -&gt; 32]), \[Infinity]];
  vertices = 
   DeleteDuplicates[
    Join @@ Table[(# -&gt; k[[2, 2]]) &amp; /@ k[[1, All, 2]], {k, known}]];
  &lt;|&#34;LabelRules&#34; -&gt; vlbls, &#34;Vertices&#34; -&gt; vertices, 
   &#34;Dependencies&#34; -&gt; known|&gt;
  ]
</pre>
<p>Let&#39;s ask the dependency tree for the first science pack:</p> 
<pre>out1 = FindDependencyTree[&#34;https://wiki.factorio.com/Science_pack_1&#34;];
Graph[out1[&#34;Vertices&#34;], VertexShape -&gt; out1[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
</pre>
<p><img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=2381Factorio_1.png&amp;userId=73716" alt="enter image description here"/></p>
<p>To make Science pack 1, we need gears and copper plates. And to make gears we need iron plates. The iron and copper plates are made from iron and copper ore. </p>
<p>This is still relatively simple, let&#39;s look at the other science packs:</p> 
<pre>out2 = FindDependencyTree[
   &#34;https://wiki.factorio.com/Science_pack_2&#34;];
Graph[out2[&#34;Vertices&#34;], VertexShape -&gt; out2[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
out3 = FindDependencyTree[
   &#34;https://wiki.factorio.com/Science_pack_3&#34;];
Graph[out3[&#34;Vertices&#34;], VertexShape -&gt; out3[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
out4 = FindDependencyTree[
   &#34;https://wiki.factorio.com/Military_science_pack&#34;];
Graph[out4[&#34;Vertices&#34;], VertexShape -&gt; out4[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
out5 = FindDependencyTree[
   &#34;https://wiki.factorio.com/Production_science_pack&#34;];
Graph[out5[&#34;Vertices&#34;], VertexShape -&gt; out5[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
out6 = FindDependencyTree[
   &#34;https://wiki.factorio.com/High_tech_science_pack&#34;];
Graph[out6[&#34;Vertices&#34;], VertexShape -&gt; out6[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
</pre>
<p>Resulting in:</p>
<p><img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_2.png&amp;userId=73716" alt="enter image description here"/></p>
<p><img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_3.png&amp;userId=73716" alt="enter image description here"/> <img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_4.png&amp;userId=73716" alt="enter image description here"/> <img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_5.png&amp;userId=73716" alt="enter image description here"/> <img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_6.png&amp;userId=73716" alt="enter image description here"/></p>
<p>To summarize, let&#39;s combine all the graphs:</p> 
<pre>o = {out1, out2, out3, out4, out5, out6};
Graph[Union @@ o[[All, &#34;Vertices&#34;]], 
 VertexShape -&gt; Union @@ o[[All, &#34;LabelRules&#34;]], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.02}, ImageSize -&gt; 1000, 
 AspectRatio -&gt; 1/GoldenRatio]
</pre>
<p><img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_All.png&amp;userId=73716" alt="enter image description here"/></p>
<p>As you can see the dependencies are very complex to get all the research packs. Of course there are many things you need to create with your machines, think of transport belts, trains, mining, steam generation, and energy production, water and other chemicals etc etc. </p>
<p>One of the most expensive parts is a satellite (to guide your rocket):</p> 
<pre>out = FindDependencyTree[&#34;https://wiki.factorio.com/Satellite&#34;];
Graph[out[&#34;Vertices&#34;], VertexShape -&gt; out[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
</pre>
<p><img src="https://community.wolfram.com//c/portal/getImageAttachment?filename=Factorio_Satellite.png&amp;userId=73716" alt="enter image description here"/></p>
<p>I hope you like this little exploration on Graphs and Factorio. We could also use Mathematica&#39;s Graph technology to design balanced belt splitter designs: <a href="http://i.imgur.com/tz2Jc3p.png">http://i.imgur.com/tz2Jc3p.png</a> ! I will leave that for some other time. For now, explore the different buildings or parts, for example have a look at the rocket silo:</p> 
<pre>out = FindDependencyTree[&#34;https://wiki.factorio.com/Rocket_silo&#34;];
Graph[out[&#34;Vertices&#34;], VertexShape -&gt; out[&#34;LabelRules&#34;], 
 VertexSize -&gt; {&#34;Scaled&#34;, 0.05}]
</pre>
<p>If you haven&#39;t played already be careful it is an incredibly addicting game!</p>

				
					
				
				
			</div>
		</td>
	</div></div>
  </body>
</html>
