<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/gorhill/uBlock/commit/6acf97bf51">Original</a>
    <h1>uBlock Origin supports filtering CNAME cloaking sites on Firefox now</h1>
    
    <div id="readability-page-1" class="page"><div><pre>This commit makes the DNS resolution code better suited for both
filtering on cname and ip address. The change allows early availability
of ip address so that `ipaddress=` option can be matched at
onBeforeRequest time.

As a result, it is now possible to block root document using
`ipaddress=` option -- so long as an ip address can be extracted
before first onBeforeRequest() call.

Related issue:
<a data-error-text="Failed to load title" data-id="1875533514" data-permission-text="Title is private" data-url="https://github.com/uBlockOrigin/uBlock-issues/issues/2792" data-hovercard-type="issue" data-hovercard-url="/uBlockOrigin/uBlock-issues/issues/2792/hovercard" href="https://github.com/uBlockOrigin/uBlock-issues/issues/2792">uBlockOrigin/uBlock-issues#2792</a>

Caveat
------

the ip address used is the first one among the list of ip
addresses returned by dns.resolve() method. There is no way for uBO
to know which exact ip address will be used by the browser when
sending the request, so this is at most a best guess. The exact IP
address used by the browser is available at onHeadersReceived time,
and uBO will also filter according to this value, but by then the
network request has already been sent to the remote server.

Possibly a future improvement would make available the whole list
of ip addresses to the filtering engine, but even then it&#39;s impossible
to know with certainty which ip address will ultimately be used by the
browser -- it is entirely possible that the ip address used by the
browser might not be in the list received through dns.resolve().</pre></div></div>
  </body>
</html>
