<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/YousefED/Matrix-CRDT">Original</a>
    <h1>Show HN: Matrix-CRDT â€“ real-time collaborative apps using Matrix as backend</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto"><a href="https://discord.gg/aDQxXezfNj" rel="nofollow"><img alt="Discord" src="https://camo.githubusercontent.com/c9df1652b82f1b4cee803015bed8b37b3078e195757efbc0662a70af97fdd3cc/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f43686174206f6e20646973636f72642532302d2532333732383944412e7376673f267374796c653d666f722d7468652d6261646765266c6f676f3d646973636f7264266c6f676f436f6c6f723d7768697465" data-canonical-src="https://img.shields.io/badge/Chat on discord%20-%237289DA.svg?&amp;style=for-the-badge&amp;logo=discord&amp;logoColor=white"/></a> <a href="https://matrix.to/#/#beyond-chat:matrix.org" rel="nofollow"><img alt="Matrix" src="https://camo.githubusercontent.com/54f3181464ca5996eefb7d3556d8b2e18d37f7fe7025fc729b4c0e5088eacf5c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f43686174206f6e206d61747269782532302d2532333030302e7376673f267374796c653d666f722d7468652d6261646765266c6f676f3d6d6174726978266c6f676f436f6c6f723d7768697465" data-canonical-src="https://img.shields.io/badge/Chat on matrix%20-%23000.svg?&amp;style=for-the-badge&amp;logo=matrix&amp;logoColor=white"/></a></p>
<p dir="auto"><a href="https://badge.fury.io/js/matrix-crdt" rel="nofollow"><img src="https://camo.githubusercontent.com/2d3d40ae99a0bd8c11e9f955a5c6702889f30173905fba8f2720733e0056aee0/68747470733a2f2f62616467652e667572792e696f2f6a732f6d61747269782d637264742e737667" alt="npm version" data-canonical-src="https://badge.fury.io/js/matrix-crdt.svg"/></a> <a href="https://coveralls.io/github/YousefED/Matrix-CRDT?branch=main" rel="nofollow"><img src="https://camo.githubusercontent.com/62cedf92e956624435f589a9891ca530542645a7d5142a711372719a3861e4b4/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f596f7573656645442f4d61747269782d435244542f62616467652e7376673f6272616e63683d6d61696e" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/YousefED/Matrix-CRDT/badge.svg?branch=main"/></a></p>
<p dir="auto">Matrix-CRDT enables you to use <a href="https://matrix.org/" rel="nofollow">Matrix</a> as a backend for distributed, real-time collaborative web applications that sync automatically.</p>
<p dir="auto">The MatrixProvider is a sync provider for <a href="https://github.com/yjs/yjs">Yjs</a>, a proven, high performance CRDT implementation.</p>
<h2 dir="auto"><a id="user-content-tldr" aria-hidden="true" href="#tldr"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TL;DR</h2>
<p dir="auto">Create apps like this:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/YousefED/Matrix-CRDT/blob/main/examples/rich-text-tiptap/richtext.gif"><img src="https://github.com/YousefED/Matrix-CRDT/raw/main/examples/rich-text-tiptap/richtext.gif" alt="screencapture"/></a></p>
<p dir="auto">And connect <a href="https://matrix.org/" rel="nofollow">Matrix</a> as transport + backend storage. Instead of chat messages (primary use-case of Matrix), we send an event stream of data model updates (for the rich-text demo, these are <em>document edits</em>) to Matrix.</p>
<h2 dir="auto"><a id="user-content-live-demo" aria-hidden="true" href="#live-demo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Live demo</h2>
<p dir="auto">In the <a href="https://github.com/YousefED/Matrix-CRDT/blob/main/examples">examples</a> directory, you&#39;ll find some live examples:</p>
<ul dir="auto">
<li><a href="https://github.com/YousefED/Matrix-CRDT/blob/main/examples/todo-simple-react">Collaborative Todo list</a></li>
<li><a href="https://github.com/YousefED/Matrix-CRDT/blob/main/examples/rich-text-tiptap">Collaborative rich text editing</a></li>
</ul>
<h2 dir="auto"><a id="user-content-motivation" aria-hidden="true" href="#motivation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Motivation</h2>
<p dir="auto"><a href="https://crdt.tech/" rel="nofollow">CRDTs</a> (<em>Conflict-free Replicated Data Types</em>) make it easy to build <strong>decentralized</strong>, <strong>fast</strong>, <strong>collaborative</strong> <strong>local-first</strong> applications.</p>
<blockquote>
<p dir="auto">Read more about <a href="https://www.inkandswitch.com/local-first.html" rel="nofollow">the benefits of Local-first software in this essay</a></p>
</blockquote>
<p dir="auto">When building local-first software on top of CRDTs, you probably still need a backend so users can access their data across devices and collaborate with each other.</p>
<p dir="auto">While <a href="https://www.matrix.org" rel="nofollow">Matrix</a> is primarily designed for messaging (chat), it&#39;s versatile enough to use as a backend for collaborative applications (see <a href="#architecture">Architecture</a>). The idea is that by building on top of Matrix, developers can focus on building clients and get the following benefits from the Matrix ecosystem out-of-the-box:</p>
<ul dir="auto">
<li>An open standard and active community</li>
<li>Multiple server implementations (including hosted servers)</li>
<li>Authentication (including support for SSO and 3rd party providers)</li>
<li>Access control via Rooms and Spaces</li>
<li>E2EE</li>
<li>A decentralized architecture with support for federation</li>
</ul>

<p dir="auto">Matrix-CRDT currently works with <a href="https://github.com/yjs/yjs">Yjs</a> or <a href="https://www.syncedstore.org" rel="nofollow">SyncedStore</a>.</p>
<h2 dir="auto"><a id="user-content-usage-with-yjs" aria-hidden="true" href="#usage-with-yjs"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage with Yjs</h2>
<p dir="auto">To setup Matrix-CRDT, 3 steps are needed:</p>
<ul dir="auto">
<li>Create a <a href="https://github.com/yjs/yjs">Yjs</a> <code>Y.Doc</code></li>
<li>Create and authenticate a client from <a href="https://matrix.org/docs/guides/usage-of-the-matrix-js-sdk" rel="nofollow">matrix-js-sdk</a></li>
<li>Create and initialize your Matrix-CRDT <code>MatrixProvider</code></li>
</ul>
<div data-snippet-clipboard-copy-content="import { MatrixProvider } from &#34;matrix-crdt&#34;;
import * as Y from &#34;yjs&#34;;
import sdk from &#34;matrix-js-sdk&#34;;

// See https://matrix.org/docs/guides/usage-of-the-matrix-js-sdk
// for login methods
const matrixClient = sdk.createClient({
  baseUrl: &#34;https://matrix.org&#34;,
  accessToken: &#34;....MDAxM2lkZW50aWZpZXIga2V5CjAwMTBjaWQgZ2Vu....&#34;,
  userId: &#34;@USERID:matrix.org&#34;,
});

// Create a new Y.Doc and connect the MatrixProvider
const ydoc = new Y.Doc();
const provider = new MatrixProvider(ydoc, matrixClient, {
  type: &#34;alias&#34;,
  alias: &#34;matrix-room-alias&#34;,
});
provider.initialize();

// array of numbers which produce a sum
const yarray = ydoc.getArray(&#34;count&#34;);

// observe changes of the sum
yarray.observe((event) =&gt; {
  // print updates when the data changes
  console.log(&#34;new sum: &#34; + yarray.toArray().reduce((a, b) =&gt; a + b));
});

// add 1 to the sum
yarray.push([1]); // =&gt; &#34;new sum: 1&#34;"><pre><span>import</span> <span>{</span> <span>MatrixProvider</span> <span>}</span> <span>from</span> <span>&#34;matrix-crdt&#34;</span><span>;</span>
<span>import</span> <span>*</span> <span>as</span> <span>Y</span> <span>from</span> <span>&#34;yjs&#34;</span><span>;</span>
<span>import</span> <span>sdk</span> <span>from</span> <span>&#34;matrix-js-sdk&#34;</span><span>;</span>

<span>// See https://matrix.org/docs/guides/usage-of-the-matrix-js-sdk</span>
<span>// for login methods</span>
<span>const</span> <span>matrixClient</span> <span>=</span> <span>sdk</span><span>.</span><span>createClient</span><span>(</span><span>{</span>
  <span>baseUrl</span>: <span>&#34;https://matrix.org&#34;</span><span>,</span>
  <span>accessToken</span>: <span>&#34;....MDAxM2lkZW50aWZpZXIga2V5CjAwMTBjaWQgZ2Vu....&#34;</span><span>,</span>
  <span>userId</span>: <span>&#34;@USERID:matrix.org&#34;</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>// Create a new Y.Doc and connect the MatrixProvider</span>
<span>const</span> <span>ydoc</span> <span>=</span> <span>new</span> <span>Y</span><span>.</span><span>Doc</span><span>(</span><span>)</span><span>;</span>
<span>const</span> <span>provider</span> <span>=</span> <span>new</span> <span>MatrixProvider</span><span>(</span><span>ydoc</span><span>,</span> <span>matrixClient</span><span>,</span> <span>{</span>
  <span>type</span>: <span>&#34;alias&#34;</span><span>,</span>
  <span>alias</span>: <span>&#34;matrix-room-alias&#34;</span><span>,</span>
<span>}</span><span>)</span><span>;</span>
<span>provider</span><span>.</span><span>initialize</span><span>(</span><span>)</span><span>;</span>

<span>// array of numbers which produce a sum</span>
<span>const</span> <span>yarray</span> <span>=</span> <span>ydoc</span><span>.</span><span>getArray</span><span>(</span><span>&#34;count&#34;</span><span>)</span><span>;</span>

<span>// observe changes of the sum</span>
<span>yarray</span><span>.</span><span>observe</span><span>(</span><span>(</span><span>event</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>// print updates when the data changes</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span>&#34;new sum: &#34;</span> <span>+</span> <span>yarray</span><span>.</span><span>toArray</span><span>(</span><span>)</span><span>.</span><span>reduce</span><span>(</span><span>(</span><span>a</span><span>,</span> <span>b</span><span>)</span> <span>=&gt;</span> <span>a</span> <span>+</span> <span>b</span><span>)</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span>

<span>// add 1 to the sum</span>
<span>yarray</span><span>.</span><span>push</span><span>(</span><span>[</span><span>1</span><span>]</span><span>)</span><span>;</span> <span>// =&gt; &#34;new sum: 1&#34;</span></pre></div>
<h2 dir="auto"><a id="user-content-syncedstore" aria-hidden="true" href="#syncedstore"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>SyncedStore</h2>
<p dir="auto">You can also use <a href="https://syncedstore.org/docs/" rel="nofollow">SyncedStore</a> and use Matrix-CRDT as SyncProvider.</p>
<h2 dir="auto"><a id="user-content-api" aria-hidden="true" href="#api"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>API</h2>
<p dir="auto"><strong>new MatrixProvider</strong> (<code>doc</code>, <code>matrixClient</code>, <code>room</code>, <code>awareness?</code>, <code>opts?</code>): <code>MatrixProvider</code></p>
<p dir="auto">The <code>MatrixProvider</code> syncs a Matrix room with a Yjs document.</p>
<h4 dir="auto"><a id="user-content-parameters" aria-hidden="true" href="#parameters"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>doc</code></td>
<td><code>Y.Doc</code></td>
<td>The <code>Y.Doc</code> to sync over the Matrix room.</td>
</tr>
<tr>
<td><code>matrixClient</code></td>
<td><code>MatrixClient</code></td>
<td>A <code>matrix-js-sdk</code> client with permissions to read (and/or write) from the room.</td>
</tr>
<tr>
<td><code>room</code></td>
<td><code>{ type: &#34;id&#34;; id: string; }</code> or <code>{ type: &#34;alias&#34;; alias: string }</code></td>
<td>The room ID or Alias to sync with.</td>
</tr>
<tr>
<td><code>awareness</code> (optional)</td>
<td><code>awarenessProtocol.Awareness</code></td>
<td>A <code>y-protocols</code> Awareness instance that can be used to sync &#34;awareness&#34; data over the experimental webrtc bridge.</td>
</tr>
<tr>
<td><code>opts</code> (optional)</td>
<td><code>MatrixProviderOptions</code> (see below)</td>
<td>Configure advanced properties, see below.</td>
</tr>
</tbody>
</table>
<p dir="auto"><strong>MatrixProviderOptions</strong></p>
<p dir="auto">Additional configuration options that can be passed to the <code>MatrixProvider</code> constructor.</p>
<p dir="auto">Defaults to:</p>
<div data-snippet-clipboard-copy-content="{
  // Options for `ThrottledMatrixWriter`
  writer: {
    // throttle flushing write events to matrix by 500ms
    flushInterval: number = 500,
    // if writing to the room fails, wait 30 seconds before retrying
    retryIfForbiddenInterval: number = 30000
  },
  // Options for `MatrixCRDTEventTranslator`
  translator: {
    // set to true to send everything encapsulated in a m.room.message,
    // so you can view and debug messages easily in element or other matrix clients
    updatesAsRegularMessages: false,
    // The event type to use for updates
    updateEventType: &#34;matrix-crdt.doc_update&#34;,
    // The event type to use for snapshots
    snapshotEventType: &#34;matrix-crdt.doc_snapshot&#34;,
  }
  // Experimental; we can use WebRTC to sync updates instantly over WebRTC.
  // See SignedWebrtcProvider.ts for more details + motivation
  enableExperimentalWebrtcSync: boolean = false
  // Options for MatrixReader
  reader: {
    // How often to send a summary snapshot (defaults to once every 30 events)
    snapshotInterval: number = 30,
  },
}"><pre><span>{</span>
  <span>// Options for `ThrottledMatrixWriter`</span>
  <span>writer</span>: <span>{</span>
    <span>// throttle flushing write events to matrix by 500ms</span>
    <span>flushInterval</span>: <span>number</span> <span>=</span> <span>500</span><span>,</span>
    <span>// if writing to the room fails, wait 30 seconds before retrying</span>
    <span>retryIfForbiddenInterval</span>: <span>number</span> <span>=</span> <span>30000</span>
  <span>}</span><span>,</span>
  <span>// Options for `MatrixCRDTEventTranslator`</span>
  <span>translator</span>: <span>{</span>
    <span>// set to true to send everything encapsulated in a m.room.message,</span>
    <span>// so you can view and debug messages easily in element or other matrix clients</span>
    <span>updatesAsRegularMessages</span>: <span>false</span><span>,</span>
    <span>// The event type to use for updates</span>
    <span>updateEventType</span>: <span>&#34;matrix-crdt.doc_update&#34;</span><span>,</span>
    <span>// The event type to use for snapshots</span>
    <span>snapshotEventType</span>: <span>&#34;matrix-crdt.doc_snapshot&#34;</span><span>,</span>
  <span>}</span>
  <span>// Experimental; we can use WebRTC to sync updates instantly over WebRTC.</span>
  <span>// See SignedWebrtcProvider.ts for more details + motivation</span>
  <span>enableExperimentalWebrtcSync</span>: boolean <span>=</span> <span>false</span>
  <span>// Options for MatrixReader</span>
  <span>reader</span>: <span>{</span>
    <span>// How often to send a summary snapshot (defaults to once every 30 events)</span>
    <span>snapshotInterval</span>: <span>number</span> <span>=</span> <span>30</span><span>,</span>
  <span>}</span><span>,</span>
<span>}</span></pre></div>

<p dir="auto">CRDT updates (in our case, Yjs document updates) are very similar to (chat) Messages, that Matrix has been optimized for.</p>
<p dir="auto">Matrix-CRDT bridges Yjs <code>documents</code> to Matrix <code>Rooms</code>. and Yjs <code>updates</code> to Matrix <code>events</code> (regular chat messages are also a specific event type in Matrix). Yjs document updates are sent as base64-encoded events to the Matrix room.</p>
<p dir="auto">When registering a <code>MatrixProvider</code>, we:</p>
<ul dir="auto">
<li>Listen to new <code>matrix-crdt.doc_update</code> events in the Matrix Room, and apply updates to the Yjs document.</li>
<li>Listen to Yjs document updates and send these to the Matrix room as <code>matrix-crdt.doc_update</code> events.</li>
</ul>
<p dir="auto">CRDTs are specifically designed to be <em>eventually consistent</em>. This means that the state of your data is eventually reconciled, regardless of the order of update events that reach each client or server (as long as you eventually get all updates).</p>
<p dir="auto">This makes it possible to work offline, or for servers / clients to be out of sync for a while.</p>
<h2 dir="auto"><a id="user-content-snapshots" aria-hidden="true" href="#snapshots"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Snapshots</h2>
<p dir="auto">To reconstruct your application state (that is, the Yjs document), we eventually need to access all previous events. When there have been a lot of updates, it would be inefficient to read the entire document / room history from Matrix.</p>
<p dir="auto">Matrix-CRDT sends periodic snapshots that contain a summary of all previous events. When retrieving a snapshot (stored as a Matrix event with type <code>matrix-crdt.doc_snapshot</code>), clients can reconstruct application state from that snapshot and don&#39;t need to fetch events occuring before that snapshots <code>last_event_id</code> (stored on the event).</p>
<h2 dir="auto"><a id="user-content-webrtc-experimental" aria-hidden="true" href="#webrtc-experimental"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>WebRTC (experimental)</h2>
<p dir="auto">Matrix-CRDT by default throttles sent events every 500ms (for example, to prevent sending an event every keystroke when building a rich text editor). It also does not support Yjs <code>Awareness</code> updates (for presence information, etc) over Matrix.</p>
<p dir="auto">You can use the (experimental) <code>WebRTC</code> provider to connect to peers over WebRTC and send updates (regular and Awareness updates) instantly.</p>
<p dir="auto">Ideally, we&#39;d replace this with Matrix Custom Ephemeral events when that <a href="https://github.com/matrix-org/matrix-doc/pull/2477">Spec</a> has landed.</p>

<p dir="auto">See <a href="https://github.com/YousefED/Matrix-CRDT/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> for instructions how to work with this repo (e.g.: installing and building using lerna).</p>

<p dir="auto">Matrix-CRDT is built as part of <a href="https://www.typecell.org" rel="nofollow">TypeCell</a>. TypeCell is proudly sponsored by the renowned <a href="https://nlnet.nl/foundation/" rel="nofollow">NLNet foundation</a> who are on a mission to support an open internet, and protect the privacy and security of internet users. Check them out!</p>
<p dir="auto"><a href="https://nlnet.nl" rel="nofollow"><img src="https://camo.githubusercontent.com/b28721c6de4ae842fbac7e414ad49669a8e2b7f7455319e7c7717df945a45f11/68747470733a2f2f6e6c6e65742e6e6c2f696d6167652f6c6f676f732f4e47494173737572655f7461672e737667" alt="NLNet" width="100" data-canonical-src="https://nlnet.nl/image/logos/NGIAssure_tag.svg"/></a></p>
</article>
        </div></div>
  </body>
</html>
