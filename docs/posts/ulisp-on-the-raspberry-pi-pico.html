<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://www.ulisp.com/show?3KN3">Original</a>
    <h1>uLisp on the Raspberry Pi Pico</h1>
    
    <div id="readability-page-1" class="page"><div id="content">

<p>The Raspberry Pi Pico is a board based on the RP2040, a brand new microcontroller chip designed by Raspberry Pi in the UK. The RP2040 is a dual-core ARM Cortex M0+ running at 133 MHz which provides 16 MB of off-chip flash and 246 KB on-chip RAM. It has 30 GPIO pins, 4 of which can be used as analogue inputs, two UARTs, two SPI controllers, two I2C controllers, and 16 PWM channels.</p>
<p>Other manufacturers, including Adafruit, Sparkfun, and Pimoroni, have also designed boards based on the RP2040. These boards all have similar performance when running uLisp; for example, they run the Tak benchmark in 8 secs; see <a href="http://www.ulisp.com/show?36M3">Performance</a>.</p>
<h4>Saving the workspace</h4>
<p>The Raspberry Pi Pico and other RP2040 boards allow you to save the entire workspace using <strong>save-image</strong>, using the external QSPI flash.</p>
<h4>ARM assembler</h4>
<p>The ARM version of uLisp includes an ARM assembler that allows you to generate machine-code functions, integrated with Lisp, written in ARM thumb code. The assembler itself is written in Lisp to make it easy to extend it or add new instructions. For more information see <a href="http://www.ulisp.com/show?2YRU">ARM assembler overview</a>.</p>
<h3>Installing uLisp from the Arduino IDE</h3>
<ul>
<li>First download the latest ARM version of uLisp from the <a href="http://www.ulisp.com/show?1AA0">Download uLisp</a> page.</li>
<li>In the Arduino IDE install the <strong>Arduino Mbed OS RP2040 Boards</strong> core from <strong>Boards Manager.</strong></li>
</ul>
<p>You need version 2.1.0 or later. There are problems running uLisp on 2.0.0.</p>
<ul>
<li>Select <strong>Raspberry Pi Pico</strong> from the <strong>Board</strong> menu.</li>
<li>Select the Raspberry Pi Pico from the <strong>Port</strong> menu.</li>
<li>Upload uLisp to the Raspberry Pi Pico board.</li>
</ul>
<p>You should then be able to select <strong>Serial Monitor</strong> from the <strong>Tools</strong> menu, and enter Lisp commands.</p>
<h3>Raspberry Pi Pico</h3>
<p>The Raspberry Pi Pico <sup id="cite_ref1"><a href="#cite_note1">[1]</a></sup> is about the same size as Adafruit&#39;s feather boards:</p>
<p><img src="http://www.ulisp.com/pictures/3j/raspberrypipico.jpg" alt="RaspberryPiPico.jpg" width="600" height="275"/></p>
<p>To install uLisp use the <strong>Raspberry Pi Pico</strong> board definition in the <strong>Arduino Mbed OS RP2040 Boards</strong> package.</p>
<h4 id="pinout">Pinout</h4>
<p>The following diagram shows the pinout of the peripherals available from uLisp with the Raspberry Pi Pico:</p>
<p><img src="http://www.ulisp.com/pictures/3j/pico-pinout.gif" alt="Pico-Pinout.gif" width="400" height="498"/></p>
<h4>LEDs</h4>
<p>The Raspberry Pi Pico has a green LED connected to the digital pin 25 which you can flash with the following program:</p>
<pre>(defun blink (&amp;optional x)
  (pinmode 25 t)
  (digitalwrite 25 x)
  (delay 1000)
  (blink (not x)))</pre>
<p>Run it by typing:</p>
<pre>(blink)</pre>
<p>All pins can also be used for analogue (PWM) output, so you can pulsate the LED slowly on and off with the program:</p>
<pre>(defun pulse ()
  (let (down)
    (loop
     (dotimes (x 256) 
       (delay 5) 
       (analogwrite 25 (if down (- 255 x) x)))
     (setq down (not down)))))</pre>
<p>Run it by typing:</p>
<pre>(pulse)</pre>
<p>Exit from either program by entering ~.</p>
<h4>Analogue inputs</h4>
<p>The Raspberry Pi Pico has three analogue inputs which you can access on digital pins 26, 27, and 28. By default they have 10-bit precision, but you can increase the precision to 12 bits with:</p>
<pre>(analogreadresolution 12)</pre>
<h4>Analogue outputs</h4>
<p>You can generate an analogue output using PWM on any of the digital pins 0 to 28. By default the precision is 8 bits.</p>
<h4>Playing notes</h4>
<p>You can use the note function to play tunes on any pin. For example, the following function <strong>scale</strong> plays the scale of C on the specified pin:</p>
<pre>(defun scale (pin) 
  (mapc 
   (lambda (n) (note pin n 4) (delay 500))
   &#39;(0 2 4 5 7 9 11 12)) 
  (note))</pre>
<p>For example, connect a piezo speaker between digital pin 10 and GND, and evaluate:</p>
<pre>(scale 10)</pre>
<h3>Adafruit Feather RP2040</h3>
<p>Adafruit have made an RP2040-based board in their Feather format. It includes a NeoPixel LED and an 8 MByte DataFlash chip:</p>
<p><img src="http://www.ulisp.com/pictures/3j/featherrp2040.jpg" alt="FeatherRP2040.jpg" width="600" height="275"/></p>
<p>There&#39;s currently no Arduino core for the Feather RP2040, but you can use the board with the <strong>Arduino Mbed OS RP2040 Boards</strong> core.</p><hr/>
<ol>
<li id="cite_note1"><a href="#cite_ref1">^</a> <a href="https://www.adafruit.com/product/3727" target="_blank">Adafruit ItsyBitsy M0 Express</a> on Adafruit.</li>
</ol>

</div></div>
  </body>
</html>
