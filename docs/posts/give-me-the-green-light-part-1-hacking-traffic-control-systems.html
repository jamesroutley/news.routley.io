<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.redthreatsec.com/blog/greenlightspart1">Original</a>
    <h1>Give Me the Green Light Part 1: Hacking Traffic Control Systems</h1>
    
    <div id="readability-page-1" class="page"><div data-block-type="2" data-border-radii="{&#34;topLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;topRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0}}" id="block-58568f7c117b4d202662"><div>

<div>
  <p>In this series of blog posts I’ll be discussing my finding dealing with traffic controllers and other traffic systems. I had hoped to present the information at DefCon but my CFP wasn’t accepted. This multi part series will start with my attempt at responsible disclosure, finding vulnerabilities in traffic controllers, sourcing hardware and getting it running in a lab, and just how broken and behind the technology curve the traffic industry is. </p><p><strong>How this all started</strong></p><p>I was invited to speak at the Intelligent Transportation Society of America Conference in Arizona on Traffic Systems through the eyes of an attacker. While I’ve had several engagements with government entities and Departments of Transportation, I had never been engaged where the scope was explicitly traffic control systems. Thanks to the generosity of one of our OT Partners, I was given access to their lab that included a fully working traffic cabinet and technical resources to bounce ideas off, I was able to learn how Traffic Control Systems worked in a safe environment.</p><p>After getting familiar with how Traffic Control Systems worked, I knew I needed to expand my research and so began my quest to purchase Controller Hardware. I’ll be detailing the steps of how to purchase used equipment and get it running in my next blog.</p><p><strong>What does a Traffic Controller do</strong></p><p>A traffic signal controller is a crucial component in the management of road traffic at intersections. Its primary function is to control the sequence of traffic lights (red, yellow, and green) to ensure the orderly and safe flow of vehicles and pedestrians. A technician configures the traffic controller with the sequence that determines how long a light stays green or red as well as who gets to go when. There are several other components that are also crucial for this system to work that will be covered in a later blog. </p><p><strong>Finding a Vulnerability</strong></p><p>The correct way to do this write-up would be to start from the boring and mundane parts of acquiring hardware and figuring out how to power it on and get it running, but sometimes it’s okay to eat your dessert before dinner and get to the good stuff first.</p><p>I’d love to write a long detailed blog about getting a root shell via UART or extracting the firmware via JTAG and then reversing it, but the honest truth is I found a vulnerability in the webapp in the first 15 minutes of having the unit online and it was the first thing I tried.</p><p><strong>Vulnerability Details</strong></p><p>It should come as no surprise that Critical National Infrastructure is exposed to the open internet without any protection, for this reason I wanted to start with a traffic controller that has a web interface. I started with the Intelight X-1 because it was the cheapest and most readily available controller I had access to. </p>
</div>




















  
  



</div></div><div data-block-type="2" data-border-radii="{&#34;topLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;topRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomLeft&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0},&#34;bottomRight&#34;:{&#34;unit&#34;:&#34;px&#34;,&#34;value&#34;:0.0}}" id="block-yui_3_17_2_1_1720717671813_9867"><div>

<div>
  <p><strong>My Response</strong></p><p>I thought long and hard about how I should respond to the letter. Should I pass it on to my attorney? Should I send them the screenshots of my eBay purchases? Should I notify US-CERT? Should I reply with the exact text of the CFA that includes a provision for Security Researchers acting in “Good Faith”. In the end I decided the best response was no response, as my report was unsolicited and the manufacturer clearly didn’t want to work with me there was no point in pushing the issue. While some will say disclosing an authentication bypass in an end-of-life controller is a risk to National Security, I’ll be honest and tell you that the majority of these traffic controllers exposed to the internet don’t even have authentication enabled.</p><p>I posted a redacted version of the vendors response on my LinkedIn and was blown away by the outpouring of support. Outside of 2 or 3 comments the overwhelming majority supported me and were equally appalled by the manufacturer’s response. This support encouraged me to keep pushing the issue and not let a big company attempt to silence me with legal threats.</p><p>I knew my next step would be to get a CVE for the issue. This is my first time submitting a CVE and it was interesting trying to navigate the process. After a lengthy back and forth with MITRE I received my first CVE “CVE-2024-38944”</p><p>That’s the end of this story. However, in the next series of blogs we’ll dive into how to acquire and setup your own traffic controllers at home and why authentication bypasses are completely irrelevant because of a little-known protocol NTC/IP. </p>
</div>




















  
  



</div></div></div>
  </body>
</html>
