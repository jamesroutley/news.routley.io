<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/aperturerobotics/bifrost">Original</a>
    <h1>Bifrost: A peer-to-peer communications engine with pluggable transports</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://teonbrooks.com/aperturerobotics/bifrost/blob/master/doc/img/bifrost-logo.png"><img src="https://teonbrooks.com/aperturerobotics/bifrost/raw/master/doc/img/bifrost-logo.png" alt="Bifrost"/></a></p>
<h2 tabindex="-1" id="user-content-introduction" dir="auto"><a href="#introduction">Introduction<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto"><strong>Bifrost</strong> is a peer-to-peer communications engine with pluggable transports:</p>
<ul dir="auto">
<li><strong>Cross-platform</strong>: supports web browsers, servers, desktop, mobile, ...</li>
<li><strong>Efficient</strong>: multiplex many simultaneous streams over a single Link.</li>
<li><strong>Encryption</strong>: identify, authenticate, and encrypt each Link between peers.</li>
<li><strong>Flexible</strong>: use multiple transports, protocols, simultaneously.</li>
<li><strong>Meshing</strong>: supports multi-hop routing to a desired target peer w/ circuits.</li>
<li><strong>PubSub</strong>: publish/subscribe channels with pluggable implementations.</li>
<li><strong>Robust</strong>: uses Quic for reliable connections over lossy transports.</li>
</ul>
<p dir="auto">Bifrost uses <a href="https://github.com/aperturerobotics/controllerbus">ControllerBus</a> controllers and directives to manage links between
peers, transports, routing, and other higher-level processes with extensive and
flexible configuration.</p>
<h2 tabindex="-1" id="user-content-overview" dir="auto"><a href="#overview">Overview<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto"><a href="https://pkg.go.dev/github.com/aperturerobotics/bifrost" rel="nofollow"><img src="https://camo.githubusercontent.com/509662881c9f4b39099fa4f2a6ce2e3e8ae00a9df1198c8ebe4c25575d8fed80/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f6170657274757265726f626f746963732f626966726f73742e737667" alt="Go Reference Widget" data-canonical-src="https://pkg.go.dev/badge/github.com/aperturerobotics/bifrost.svg"/></a> <a href="https://goreportcard.com/report/github.com/aperturerobotics/bifrost" rel="nofollow"><img src="https://camo.githubusercontent.com/c3cd23e8defc7517ba0007870539248a2d702bc7c1aefaf359b76321eabb4869/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f6170657274757265726f626f746963732f626966726f7374" alt="Go Report Card Widget" data-canonical-src="https://goreportcard.com/badge/github.com/aperturerobotics/bifrost"/></a></p>
<p dir="auto">Bifrost is designed around the following core concepts:</p>
<ul dir="auto">
<li><strong>Peer</strong>: a routable process or device with a keypair.</li>
<li><strong>Transport</strong>: a protocol which can create Links with other peers.</li>
<li><strong>Link</strong>: a connection between two peers over a Transport.</li>
<li><strong>Stream</strong>: channel of data between two Peer with a protocol type.</li>
<li><strong>RPC</strong>: request/reply and bidirectional streaming remote calls.</li>
<li><strong>PubSub</strong>: at-least-once delivery of messages to named topics.</li>
</ul>
<p dir="auto">Integrates with networking, pubsub, and RPC libraries like <a href="https://libp2p.io/" rel="nofollow">libp2p</a>, <a href="https://github.com/perlin-network/noise">noise</a>,
<a href="https://github.com/storj/drpc">drpc</a>, <a href="https://github.com/aperturerobotics/starpc">starpc</a> and <a href="https://nats.io" rel="nofollow">nats</a>.</p>
<p dir="auto">The <a href="https://teonbrooks.com/aperturerobotics/bifrost/blob/master/sim">network simulator</a>, <a href="https://teonbrooks.com/aperturerobotics/bifrost/blob/master/testbed">testbed</a>, and <a href="https://teonbrooks.com/aperturerobotics/bifrost/blob/master/transport/inproc">in-proc transport</a> can be used to write
end-to-end tests as Go unit tests. The mock transports use identical code to the
real transports, and appear the same to the application code.</p>
<p dir="auto">The <a href="https://teonbrooks.com/aperturerobotics/bifrost/blob/master/http">http</a> packages provide a http server and a mechanism for attaching http
handlers to the controller bus and using them to serve requests. There is also
an implementation of attaching and looking up http clients on the bus.</p>
<p dir="auto"><a href="https://github.com/aperturerobotics/entitygraph">EntityGraph</a> exposes the internal state representation of Bifrost to
visualizers and instrumentation via a graph-based inter-connected entity model.</p>
<p dir="auto">Configuring each component as an independent controller makes it easy to adapt
application code to different operating environments and protocols.</p>
<h2 tabindex="-1" id="user-content-examples" dir="auto"><a href="#examples">Examples<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto"><a href="https://discord.gg/KJutMESRsT" rel="nofollow"><img src="https://camo.githubusercontent.com/395ce51bd33ecb4c6e7b9645e591f745428689ca28905104913242873169bcde/68747470733a2f2f696d672e736869656c64732e696f2f646973636f72642f3830333832353835383539393035393438372e7376673f6c6162656c3d446973636f7264266c6f676f3d446973636f726426636f6c6f72423d373238396461267374796c653d666f722d7468652d6261646765" alt="Support Server" data-canonical-src="https://img.shields.io/discord/803825858599059487.svg?label=Discord&amp;logo=Discord&amp;colorB=7289da&amp;style=for-the-badge"/></a></p>
<p dir="auto">Bifrost can be used as either a Go library or a command-line / daemon.</p>
<p dir="auto">The <a href="https://teonbrooks.com/aperturerobotics/bifrost/blob/master/examples">examples</a> directory contains yaml files to configure the
daemon, as well as &#34;toys&#34; which are self-contained Go program examples.</p>
<p dir="auto">To install the CLI and daemon:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Clone the repo and install.
git clone https://github.com/aperturerobotics/bifrost
cd ./bifrost/cmd/bifrost
go install -v

# Alternatively:
# Note: this currently fails on go &gt;= 1.16 due to replace directives.
# See: https://github.com/golang/go/issues/44840
GO111MODULE=on go install -v github.com/aperturerobotics/bifrost/cmd/bifrost@master"><pre><span><span>#</span> Clone the repo and install.</span>
git clone https://github.com/aperturerobotics/bifrost
<span>cd</span> ./bifrost/cmd/bifrost
go install -v

<span><span>#</span> Alternatively:</span>
<span><span>#</span> Note: this currently fails on go &gt;= 1.16 due to replace directives.</span>
<span><span>#</span> See: https://github.com/golang/go/issues/44840</span>
GO111MODULE=on go install -v github.com/aperturerobotics/bifrost/cmd/bifrost@master</pre></div>
<p dir="auto">Access help by adding the &#34;-h&#34; tag or running &#34;bifrost help.&#34;</p>
<p dir="auto">As a basic example, launch the daemon:</p>
<div data-snippet-clipboard-copy-content="bifrost daemon \
  --write-config \
  --hold-open-links \
  --pubsub nats  \
  --api-listen :5110 \
  --udp-listen :5112"><pre><code>bifrost daemon \
  --write-config \
  --hold-open-links \
  --pubsub nats  \
  --api-listen :5110 \
  --udp-listen :5112
</code></pre></div>
<h3 tabindex="-1" id="user-content-yaml-configuration" dir="auto"><a href="#yaml-configuration">YAML Configuration<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">An example of a ConfigSet in YAML format for the daemon: <code>bifrost_daemon.yaml</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Start a UDP listener on port 5112.
my-udp:
  id: bifrost/udp
  config:
    listenAddr: :5112

# Use the floodsub driver for PubSub.
pubsub:
  id: bifrost/floodsub
  config: {}"><pre><span><span>#</span> Start a UDP listener on port 5112.</span>
<span>my-udp</span>:
  <span>id</span>: <span>bifrost/udp</span>
  <span>config</span>:
    <span>listenAddr</span>: <span>:5112</span>

<span><span>#</span> Use the floodsub driver for PubSub.</span>
<span>pubsub</span>:
  <span>id</span>: <span>bifrost/floodsub</span>
  <span>config</span>: <span>{}</span></pre></div>
<h3 tabindex="-1" id="user-content-daemon-cli" dir="auto"><a href="#daemon-cli">Daemon CLI<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The Bifrost daemon is configured with a YAML ConfigSet and/or via the API.</p>
<div data-snippet-clipboard-copy-content="NAME:
   bifrost daemon - run a bifrost daemon

OPTIONS:
   --hold-open-links         if set, hold open links without an inactivity timeout [$BIFROST_HOLD_OPEN_LINKS]
   --websocket-listen value  if set, will listen on address for websocket connections, ex :5111 [$BIFROST_WS_LISTEN]
   --udp-listen value        if set, will listen on address for udp connections, ex :5112 [$BIFROST_UDP_LISTEN]
   --xbee-device-path value  xbee device path to open, if set [$BIFROST_XBEE_PATH]
   --xbee-device-baud value  xbee device baudrate to use, defaults to 115200 (default: 115200) [$BIFROST_XBEE_BAUD]
   --establish-peers value   if set, request establish links to list of peer ids [$BIFROST_ESTABLISH_PEERS]
   --xbee-peers value        list of peer-id@address known XBee peers [$BIFROST_XBEE_PEERS]
   --udp-peers value         list of peer-id@address known UDP peers [$BIFROST_UDP_PEERS]
   --websocket-peers value   list of peer-id@address known WebSocket peers [$BIFROST_WS_PEERS]
   --pubsub value            if set, will configure pubsub from options: [floodsub, nats] [$BIFROST_PUBSUB]
   --config value, -c value  path to configuration yaml file (default: &#34;bifrost_daemon.yaml&#34;) [$BIFROST_CONFIG]
   --write-config            write the daemon config file on startup [$BIFROST_WRITE_CONFIG]
   --node-priv value         path to node private key, will be generated if doesn&#39;t exist (default: &#34;bifrost_daemon.pem&#34;) [$BIFROST_NODE_PRIV]
   --api-listen value        if set, will listen on address for API connections, ex :5110 (default: &#34;:5110&#34;) [$BIFROST_API_LISTEN]
   --prof-listen value       if set, debug profiler will be hosted on the port, ex :8080 [$BIFROST_PROF_LISTEN]"><pre><code>NAME:
   bifrost daemon - run a bifrost daemon

OPTIONS:
   --hold-open-links         if set, hold open links without an inactivity timeout [$BIFROST_HOLD_OPEN_LINKS]
   --websocket-listen value  if set, will listen on address for websocket connections, ex :5111 [$BIFROST_WS_LISTEN]
   --udp-listen value        if set, will listen on address for udp connections, ex :5112 [$BIFROST_UDP_LISTEN]
   --xbee-device-path value  xbee device path to open, if set [$BIFROST_XBEE_PATH]
   --xbee-device-baud value  xbee device baudrate to use, defaults to 115200 (default: 115200) [$BIFROST_XBEE_BAUD]
   --establish-peers value   if set, request establish links to list of peer ids [$BIFROST_ESTABLISH_PEERS]
   --xbee-peers value        list of peer-id@address known XBee peers [$BIFROST_XBEE_PEERS]
   --udp-peers value         list of peer-id@address known UDP peers [$BIFROST_UDP_PEERS]
   --websocket-peers value   list of peer-id@address known WebSocket peers [$BIFROST_WS_PEERS]
   --pubsub value            if set, will configure pubsub from options: [floodsub, nats] [$BIFROST_PUBSUB]
   --config value, -c value  path to configuration yaml file (default: &#34;bifrost_daemon.yaml&#34;) [$BIFROST_CONFIG]
   --write-config            write the daemon config file on startup [$BIFROST_WRITE_CONFIG]
   --node-priv value         path to node private key, will be generated if doesn&#39;t exist (default: &#34;bifrost_daemon.pem&#34;) [$BIFROST_NODE_PRIV]
   --api-listen value        if set, will listen on address for API connections, ex :5110 (default: &#34;:5110&#34;) [$BIFROST_API_LISTEN]
   --prof-listen value       if set, debug profiler will be hosted on the port, ex :8080 [$BIFROST_PROF_LISTEN]
</code></pre></div>
<p dir="auto">These CLI flags are provided for convenience to quickly configure a daemon, and
the resulting config can be written to a file with <code>--write-config</code> for further
adjustments to be made. Note, however, that additional controllers are available
which are not yet exposed via these flags.</p>
<h3 tabindex="-1" id="user-content-client-cli" dir="auto"><a href="#client-cli">Client CLI<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">Most Bifrost functionality is exposed on the client CLI and RPC API:</p>
<ul dir="auto">
<li>Mount a peer by loading a private key into the daemon.</li>
<li>Forward incoming streams with a protocol ID to a multiaddress</li>
<li>Proxy incoming connections to a listener to a remote peer</li>
<li>Open a stream with a remote peer and a given protocol ID</li>
<li>Accept a stream for a local peer with a given protocol ID</li>
</ul>
<p dir="auto">The client CLI has the following help output:</p>
<div data-snippet-clipboard-copy-content="bifrost client command [command options] [arguments...]

COMMANDS:
   local-peers           returns local peer info
   identify              Private key will be loaded with a peer controller
   subscribe             Subscribe to a pubsub channel with a private key or mounted peer and publish base64 w/ newline delim from stdin.
   forward               Protocol ID will be forwarded to the target multiaddress
   accept                Single incoming stream with Protocol ID will be accepted
   dial                  Single outgoing stream with Protocol ID will be dialed
   listen                Listen on the multiaddress and forward the connection to a remote stream.
   controller-bus, cbus  ControllerBus system sub-commands."><pre><code>bifrost client command [command options] [arguments...]

COMMANDS:
   local-peers           returns local peer info
   identify              Private key will be loaded with a peer controller
   subscribe             Subscribe to a pubsub channel with a private key or mounted peer and publish base64 w/ newline delim from stdin.
   forward               Protocol ID will be forwarded to the target multiaddress
   accept                Single incoming stream with Protocol ID will be accepted
   dial                  Single outgoing stream with Protocol ID will be dialed
   listen                Listen on the multiaddress and forward the connection to a remote stream.
   controller-bus, cbus  ControllerBus system sub-commands.
</code></pre></div>
<p dir="auto">With the above operations, all stream handling and interaction with the network
is exposed to the API and command line. Some examples:</p>
<div dir="auto" data-snippet-clipboard-copy-content="  # Note: you can edit bifrost_daemon.yaml to change settings.
  # Once the daemon configuration exists, you can now just run:
  bifrost daemon

  # While the command is executing, the private key will be attached.
  bifrost client identify --peer-priv priv-key.pem

  # While the command is executing, a forwarding controller will be running.
  # Protocol ID will be forwarded to the target multiaddress
  # Handles HandleMountedStream directives by contacting the target.
  # HTTP can be easily proxied through an encrypted stream this way.
  bifrost client forward \
    --peer-id &lt;agent-id&gt; \
    --protocol-id /x/myproto \
    --target /ip4/127.0.0.1/tcp/8000

  # While the command is executing, a proxying controller will be running.
  # Protocol ID will be proxied from the listen multiaddress to the target peer.
  # Calls OpenStream to build a stream from &lt;source-peer-id&gt; to &lt;target-peer-id&gt;.
  # HTTP can be easily proxied through an encrypted stream this way.
  bifrost client listen \
    --peer-id &lt;target-peer-id&gt; \
    --from-peer-id &lt;source-peer-id&gt; \
    --protocol-id /x/myproto \
    --listen /ip4/127.0.0.1/tcp/8001

  # Wait for a stream to be opened to the mounted peer with the protocol ID /x/myproto
  # Standard output is the incoming data stream, standard input is the outgoing data stream.
  # Standard error is used for logging.
  bifrost client accept \
    --local-peer-id &lt;peer-id&gt; \
    --protocol-id /x/myproto 

  # Establish a stream.
  # Standard output is the incoming data stream, standard input is the outgoing data stream.
  # Standard error is used for logging.
  bifrost client dial \
    --peer-id &lt;target-peer-id&gt; \
    --local-peer-id &lt;local-peer-id&gt; \
    --protocol-id /x/myproto"><pre>  <span><span>#</span> Note: you can edit bifrost_daemon.yaml to change settings.</span>
  <span><span>#</span> Once the daemon configuration exists, you can now just run:</span>
  bifrost daemon

  <span><span>#</span> While the command is executing, the private key will be attached.</span>
  bifrost client identify --peer-priv priv-key.pem

  <span><span>#</span> While the command is executing, a forwarding controller will be running.</span>
  <span><span>#</span> Protocol ID will be forwarded to the target multiaddress</span>
  <span><span>#</span> Handles HandleMountedStream directives by contacting the target.</span>
  <span><span>#</span> HTTP can be easily proxied through an encrypted stream this way.</span>
  bifrost client forward \
    --peer-id <span>&lt;</span>agent-id<span>&gt;</span> \
    --protocol-id /x/myproto \
    --target /ip4/127.0.0.1/tcp/8000

  <span><span>#</span> While the command is executing, a proxying controller will be running.</span>
  <span><span>#</span> Protocol ID will be proxied from the listen multiaddress to the target peer.</span>
  <span><span>#</span> Calls OpenStream to build a stream from &lt;source-peer-id&gt; to &lt;target-peer-id&gt;.</span>
  <span><span>#</span> HTTP can be easily proxied through an encrypted stream this way.</span>
  bifrost client listen \
    --peer-id <span>&lt;</span>target-peer-id<span>&gt;</span> \
    --from-peer-id <span>&lt;</span>source-peer-id<span>&gt;</span> \
    --protocol-id /x/myproto \
    --listen /ip4/127.0.0.1/tcp/8001

  <span><span>#</span> Wait for a stream to be opened to the mounted peer with the protocol ID /x/myproto</span>
  <span><span>#</span> Standard output is the incoming data stream, standard input is the outgoing data stream.</span>
  <span><span>#</span> Standard error is used for logging.</span>
  bifrost client accept \
    --local-peer-id <span>&lt;</span>peer-id<span>&gt;</span> \
    --protocol-id /x/myproto 

  <span><span>#</span> Establish a stream.</span>
  <span><span>#</span> Standard output is the incoming data stream, standard input is the outgoing data stream.</span>
  <span><span>#</span> Standard error is used for logging.</span>
  bifrost client dial \
    --peer-id <span>&lt;</span>target-peer-id<span>&gt;</span> \
    --local-peer-id <span>&lt;</span>local-peer-id<span>&gt;</span> \
    --protocol-id /x/myproto</pre></div>
<h3 tabindex="-1" id="user-content-example-forward-http-traffic-between-peers" dir="auto"><a href="#example-forward-http-traffic-between-peers">Example: forward HTTP traffic between peers<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The following is a basic example of using the CLI to forward encrypted traffic
between a local port and a remote peer port, similar to SSH port forwarding:</p>
<div dir="auto" data-snippet-clipboard-copy-content="  # note the peer id in the logs
  ./bifrost daemon \
            --write-config \
            --udp-listen :5000 \
            --node-priv daemon_node_priv_2.pem \
            --websocket-listen &#34;:5111&#34; \
            --prof-listen &#34;:6201&#34;

  # forward incoming connections to port 8000
  # example: &#34;python3 -m http.server 8080&#34;
  ./bifrost client forward \
            --protocol-id &#34;test/protocol&#34; \
            --target /ip4/127.0.0.1/tcp/8000

  # replace PEER-ID-HERE with the peer ID from the first daemon.
  # start a second daemon (in a new shell).
  ./bifrost daemon \
            --udp-listen :5001 \
            --udp-peers &#34;PEER-ID-HERE@127.0.0.1:5000&#34; \
            --api-listen &#34;:5112&#34;

  # tell it to listen on port 8082 and forward to the other peer.
  # try browsing to http://localhost:8082
  ./bifrost client --dial-addr 127.0.0.1:5112 listen \
            --peer-id &#34;PEER-ID-HERE&#34; \
            --protocol-id test/protocol \
            --listen /ip4/127.0.0.1/tcp/8002"><pre>  <span><span>#</span> note the peer id in the logs</span>
  ./bifrost daemon \
            --write-config \
            --udp-listen :5000 \
            --node-priv daemon_node_priv_2.pem \
            --websocket-listen <span><span>&#34;</span>:5111<span>&#34;</span></span> \
            --prof-listen <span><span>&#34;</span>:6201<span>&#34;</span></span>

  <span><span>#</span> forward incoming connections to port 8000</span>
  <span><span>#</span> example: &#34;python3 -m http.server 8080&#34;</span>
  ./bifrost client forward \
            --protocol-id <span><span>&#34;</span>test/protocol<span>&#34;</span></span> \
            --target /ip4/127.0.0.1/tcp/8000

  <span><span>#</span> replace PEER-ID-HERE with the peer ID from the first daemon.</span>
  <span><span>#</span> start a second daemon (in a new shell).</span>
  ./bifrost daemon \
            --udp-listen :5001 \
            --udp-peers <span><span>&#34;</span>PEER-ID-HERE@127.0.0.1:5000<span>&#34;</span></span> \
            --api-listen <span><span>&#34;</span>:5112<span>&#34;</span></span>

  <span><span>#</span> tell it to listen on port 8082 and forward to the other peer.</span>
  <span><span>#</span> try browsing to http://localhost:8082</span>
  ./bifrost client --dial-addr 127.0.0.1:5112 listen \
            --peer-id <span><span>&#34;</span>PEER-ID-HERE<span>&#34;</span></span> \
            --protocol-id test/protocol \
            --listen /ip4/127.0.0.1/tcp/8002</pre></div>
<p dir="auto">This example shows how to run two daemons with information on how to contact
each other, and then &#34;tell&#34; the second daemon to listen on port 8002 and forward
any incoming connections to the remote peer with the given peer ID.</p>
<p dir="auto">When someone connects to port 8002 the EstablishLinkWithPeer directive is added
and the UDP transport opens the connection with the peer (on-demand.) The stream
is then negotiated. The remote daemon uses HandleMountedStream which is handled
by the &#34;forwarding&#34; controller, which forwards the stream to localhost at 8000.</p>
<h2 tabindex="-1" id="user-content-transports-and-links" dir="auto"><a href="#transports-and-links">Transports and Links<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">A Link is a packet stream between two Peer. Links are created by Transports,
which are associated with a local private keypair.</p>
<p dir="auto">Transports are responsible for handshaking their identity and providing stream
multiplexing, encryption, and ordering. The Bifrost codebase contains common
implementations for packet-based and stream-based transports, based primarily on
the <a href="https://github.com/quic-go/quic-go">quic-go</a> implementation of the Quic UDP protocol.</p>
<p dir="auto">The HandleMountedStream directive contains incoming protocol and peer info. The
appropriate controller for the protocol responds to the directive and handles
the incoming stream. This decouples the transport layers from the protocols.</p>
<h2 tabindex="-1" id="user-content-pubsub" dir="auto"><a href="#pubsub">PubSub<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">A PubSub is a controller that supports topic-based at-least-once delivery.</p>
<p dir="auto">Nats and floodsub are currently supported as PubSub protocols.</p>
<h2 tabindex="-1" id="user-content-support" dir="auto"><a href="#support">Support<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Please open a <a href="https://github.com/aperturerobotics/bifrost/issues/new">GitHub issue</a> with any questions / issues.</p>
<p dir="auto">... or feel free to reach out on <a href="https://matrix.to/#/#aperturerobotics:matrix.org" rel="nofollow">Matrix Chat</a> or <a href="https://discord.gg/KJutMESRsT" rel="nofollow">Discord</a>.</p>
<h2 tabindex="-1" id="user-content-license" dir="auto"><a href="#license">License<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Apache 2.0</p>
</article>
          </div></div>
  </body>
</html>
