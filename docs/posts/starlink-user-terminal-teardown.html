<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/">Original</a>
    <h1>Starlink User Terminal Teardown</h1>
    
    <div id="readability-page-1" class="page"><div><blockquote><p>I think the human race has no future if it doesn’t go to space. —— Stephen Hawking</p></blockquote><p>Starlink is a low Earth orbit (LEO) satellite internet service provided by SpaceX. Users connect to near-Earth orbit satellites through a user terminal, which then connects to the internet via ground gateways.</p><p><img alt="Basic architecture of the Starlink system [1]" loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/d48521bc-861b-4050-82df-1366d6bc01d2.png"/></p><p>As the new generation of satellites gradually incorporates laser links, some satellites can communicate with each other via laser. This both reduces reliance on ground stations and improves transmission efficiency, enhancing global coverage.</p><p><img alt="Starlink terminals in Ukraine access the Internet via satellite and gateways in neighboring countries" loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/62ba1b39-218f-4887-9dab-7957d3f342fe.png" title=" =593.6x434"/></p><p>Even on the Ukrainian battlefield where there are no local ground stations, Starlink user terminals can indirectly access gateways in neighboring countries through inter-satellite links [1].</p><p>In this article, we provide a concise overview of DARKNAVY’s recent preliminary investigation into the Starlink user terminal.</p><hr/><h2 id="hardware-analysis">Hardware Analysis</h2><p>A complete Starlink user terminal consists of two parts: a router and an antenna. This article focuses on the antenna component (User Terminal Antenna, hereafter referred to as “UTA”). DARKNAVY purchased a Starlink Standard Actuated (also known as Rev3 or GenV2) user terminal in Singapore and disassembled its antenna portion.</p><p><img alt="Starlink UTA Rev3 PCB (full view)" loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/7beb1f43-a758-4a5c-ad1e-73fc65157927.png"/></p><p>As shown above, after disassembly, we found that the UTA’s PCB is almost as large as its outer shell. Most of the board is occupied by RF front-end chips produced by STMicroelectronics (left side in the photo), while the core control components are mainly concentrated on one side of the PCB.</p><p><img loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/49fe99e2-633f-46a8-82b4-d5dc91fcdb49.png" title=" =2070x775"/></p><p><em>Starlink Rev3 PCB (core area)</em></p><p>Aside from the RF antenna, the overall design of the UTA’s core area is quite similar to that of a standard IoT device. The main SoC, custom-made by ST for SpaceX, is a quad-core Cortex-A53. Currently, the hardware and datasheet for this chip are confidential and unavailable to the public.</p><p>At Black Hat USA 2022, Dr. Lennert Wouters from KU Leuven demonstrated a fault-injection attack against the first-generation Starlink antenna (GenV1) to obtain a root shell of the device. In response, SpaceX disabled the UART debug interface on the PCB via a firmware update to enhance fault-attack resistance. However, Wouters subsequently managed to break in again by refining his approach [2].</p><hr/><h2 id="firmware-extraction-and-analysis">Firmware Extraction and Analysis</h2><p>To analyze the UTA in depth, DARKNAVY directly dumped the firmware from the eMMC chip. Since no obvious eMMC debug pins exist on the Rev3 board, we had to desolder the eMMC chip from the PCB and read it using a programmer. Once extracted, we discovered that most of the firmware contents were unencrypted, revealing the boot chain (excluding BootROM), kernel, and the unencrypted portions of the filesystem. Further analysis showed that after the kernel starts, it reads most of the runtime environment from the eMMC and unpacks it to the <code>/sx/local/runtime</code> directory.</p><p><img alt="Core runtime of the UTA" loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/80819cd3-d929-4e20-a1e9-77f65b3ccb33.png"/></p><p>As shown above, the <code>bin</code> directory contains the executables required by the Starlink software stack, while <code>dat</code> stores configuration files, and <code>revision_info</code> records the current software and hardware version. Other than <code>user_terminal_frontend</code> (written in Go) for handling user communications, most programs are statically compiled C++ executables without symbols. Drawing on existing research [3], our preliminary analysis of these programs and configurations suggests that the network stack architecture is somewhat similar to DPDK [4], mainly relying on a user-space C++ program to bypass the kernel for handling network packets. The Linux kernel’s primary role is to provide basic hardware drivers and process management.</p><p>Interestingly, the core software extracted from the UTA also includes some functionalities that seemingly belong on satellites or ground gateways. Our initial reverse-engineering indicates that, during startup, the system identifies the device type based on hardware peripherals and then loads and executes the corresponding logic.</p><hr/><h2 id="emulation">Emulation</h2><p>For convenient ongoing analysis of the UTA, DARKNAVY built a basic QEMU-based emulation environment for the Rev3 firmware:</p><p>Within this environment, we successfully ran and debugged parts of the software, including <code>httpd</code>, <code>WebSocket</code>, and <code>gRPC</code> services that interact with external entities.</p><p><img alt="Debugging the user_terminal_frontend program" loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/91f681b3-25c3-4487-a2db-518aedba9a22.png"/></p><hr/><h2 id="security-chip">Security Chip</h2><p>Besides the main SoC, the UTA also features a dedicated security chip, <code>STSAFE-A110</code>, which claims a CC EAL5+ security rating [5]. Unlike the custom SoC, this chip can be legally purchased under an NDA. In the UTA firmware, a user-space program named <code>stsafe_cli</code> handles interactions with this chip. Reverse-engineering suggests that STSAFE primarily provides:</p><ul><li>A unique identifier (UUID) for each device</li><li>Management of a public key certificate (<code>stsafe_leaf.pem</code>), presumably used for satellite communication authentication</li><li>Derivation of symmetric encryption keys for user data transmission</li></ul><p>Overall, this chip serves as an additional root of trust independent of the SoC’s secure boot mechanism, which aligns with modern embedded security design practices.</p><hr/><h2 id="easter-egg-is-elon-watching-you">Easter Egg: Is Elon Watching You?</h2><p>During the analysis, DARKNAVY stumbled upon a program labeled <strong>Ethernet Data Recorder</strong>, which naturally raises suspicions of a backdoor capturing user data.</p><p><img alt="Ethernet Data Recorder" loading="lazy" src="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/attachments/a451b9c1-5be5-4d8f-a77a-f17edef85653.png"/></p><p>This program’s name and functionality hint at potential packet logging. Closer inspection reveals that it leverages a <code>pcap_filter</code>-like mechanism to record certain network packets, with capture rules resembling:</p><div><pre tabindex="0"><code data-lang="cpp"><span><span><span># name            track   options                type    interfaces       pcap_filter
</span></span></span><span><span><span></span><span>diagnostics</span>       <span>0</span>       <span>compress</span><span>,</span><span>ipcompress</span>    <span>telem</span>   <span>lo</span>               <span>udp</span> <span>and</span> <span>dst</span> <span>port</span> <span>10017</span> <span>and</span> <span>(</span><span>dst</span> <span>host</span> <span>239.26.7.131</span> <span>or</span> <span>dst</span> <span>host</span> <span>239.26.7.130</span><span>)</span>
</span></span></code></pre></div><p>Based on other clues in the firmware, these packets are related to satellite telemetry. All captured traffic is also encrypted using hardware keys fused into the SoC. From the information we have so far, it does not appear to collect user privacy data.</p><p>During device initialization, if the system identifies itself as a user terminal, the initialization script automatically writes 41 SSH public keys into <code>/root/.ssh/authorized_keys</code>. Notably, port 22 on the UTA remains open to the local network at all times. Having such a large number of unknown login keys on a user product certainly raises eyebrows.</p><hr/><p>As satellite technology continues to evolve and find applications across diverse industries, every component of Starlink—and other satellite internet systems—may become a critical battleground for future offensive and defensive operations. In space security, developers and hackers contend not only in the digital realm but also against the constraints of cosmic physics: one wrong move could mean losing contact with the target forever.</p><h2 id="references">References</h2><ul><li>[1] <a href="https://www.ciscolive.com/c/dam/r/ciscolive/global-event/docs/2024/pdf/BRKSEC-2150.pdf">https://www.ciscolive.com/c/dam/r/ciscolive/global-event/docs/2024/pdf/BRKSEC-2150.pdf</a></li><li>[2] <a href="https://i.blackhat.com/USA-22/Wednesday/US-22-Wouters-Glitched-On-Earth.pdf">https://i.blackhat.com/USA-22/Wednesday/US-22-Wouters-Glitched-On-Earth.pdf</a></li><li>[3] <a href="https://blog.quarkslab.com/starlink.html">https://blog.quarkslab.com/starlink.html</a></li><li>[4] <a href="https://www.dpdk.org/">https://www.dpdk.org/</a></li><li>[5] <a href="https://www.st.com/en/secure-mcus/stsafe-a110.html">https://www.st.com/en/secure-mcus/stsafe-a110.html</a></li></ul></div></div>
  </body>
</html>
