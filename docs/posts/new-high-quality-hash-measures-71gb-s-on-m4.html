<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Nicoshev/rapidhash">Original</a>
    <h1>New high-quality hash measures 71GB/s on M4</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">The fastest recommended hash function by <a href="https://github.com/rurban/smhasher?tab=readme-ov-file#summary">SMHasher</a>.</p>
<p dir="auto">The fastest passing hash in <a href="https://gitlab.com/fwojcik/smhasher3/-/blob/main/results/README.md#passing-hashes" rel="nofollow">SMHasher3</a>.</p>
<p dir="auto">rapidhash is <a href="https://github.com/wangyi-fudan/wyhash">wyhash</a>&#39; official successor, with improved speed, quality and compatibility.</p>
<p dir="auto"><strong>Fast</strong></p>
<p dir="auto"><strong>Universal</strong></p>
<p dir="auto"><strong>Excellent</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Input Len</th>
<th>Nb Hashes</th>
<th>Expected</th>
<th>Nb Collisions</th>
</tr>
</thead>
<tbody>
<tr>
<td>8</td>
<td>15 Gi</td>
<td>7.0</td>
<td>3</td>
</tr>
<tr>
<td>12</td>
<td>15 Gi</td>
<td>7.0</td>
<td>4</td>
</tr>
<tr>
<td>16</td>
<td>15 Gi</td>
<td>7.0</td>
<td>8</td>
</tr>
<tr>
<td>24</td>
<td>15 Gi</td>
<td>7.0</td>
<td>7</td>
</tr>
<tr>
<td>32</td>
<td>15 Gi</td>
<td>7.0</td>
<td>3</td>
</tr>
<tr>
<td>40</td>
<td>15 Gi</td>
<td>7.0</td>
<td>3</td>
</tr>
<tr>
<td>64</td>
<td>15 Gi</td>
<td>7.0</td>
<td>8</td>
</tr>
<tr>
<td>80</td>
<td>15 Gi</td>
<td>7.0</td>
<td>6</td>
</tr>
<tr>
<td>120</td>
<td>15 Gi</td>
<td>7.0</td>
<td>5</td>
</tr>
<tr>
<td>128</td>
<td>15 Gi</td>
<td>7.0</td>
<td>6</td>
</tr>
<tr>
<td>160</td>
<td>15 Gi</td>
<td>7.0</td>
<td>9</td>
</tr>
<tr>
<td>1024</td>
<td>15 Gi</td>
<td>7.0</td>
<td>7</td>
</tr>
<tr>
<td>4096</td>
<td>15 Gi</td>
<td>7.0</td>
<td>8</td>
</tr>
<tr>
<td>8</td>
<td>62 Gi</td>
<td>120.1</td>
<td>123</td>
</tr>
<tr>
<td>12</td>
<td>62 Gi</td>
<td>120.1</td>
<td>108</td>
</tr>
<tr>
<td>16</td>
<td>62 Gi</td>
<td>120.1</td>
<td>102</td>
</tr>
<tr>
<td>24</td>
<td>62 Gi</td>
<td>120.1</td>
<td>112</td>
</tr>
<tr>
<td>32</td>
<td>62 Gi</td>
<td>120.1</td>
<td>137</td>
</tr>
<tr>
<td>48</td>
<td>62 Gi</td>
<td>120.1</td>
<td>149</td>
</tr>
<tr>
<td>64</td>
<td>62 Gi</td>
<td>120.1</td>
<td>161</td>
</tr>
<tr>
<td>120</td>
<td>62 Gi</td>
<td>120.1</td>
<td>172</td>
</tr>
<tr>
<td>128</td>
<td>62 Gi</td>
<td>120.1</td>
<td>187</td>
</tr>
<tr>
<td>160</td>
<td>62 Gi</td>
<td>120.1</td>
<td>183</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">More results can be found in the <a href="https://github.com/Nicoshev/rapidhash/tree/master/collisions">collisions folder</a></p>

<p dir="auto">Average latency when hashing keys of 4, 8 and 16 bytes</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Hash</th>
<th>M1 Pro</th>
<th>M3 Pro</th>
<th>Neoverse V2</th>
<th>AMD Turin</th>
</tr>
</thead>
<tbody>
<tr>
<td>rapidhash</td>
<td>1.79ns</td>
<td>1.38ns</td>
<td>2.07ns</td>
<td>2.31ns</td>
</tr>
<tr>
<td>xxh3</td>
<td>1.92ns</td>
<td>1.50ns</td>
<td>2.15ns</td>
<td>2.35ns</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">Peak throughput when hashing files of 16Kb-2Mb</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Hash</th>
<th>M1 Pro</th>
<th>M3 Pro</th>
<th>M3 Ultra</th>
<th>M4</th>
<th>Neoverse V2</th>
</tr>
</thead>
<tbody>
<tr>
<td>rapidhash</td>
<td>47GB/s</td>
<td>57GB/s</td>
<td>61GB/s</td>
<td>71GB/s</td>
<td>37GB/s</td>
</tr>
<tr>
<td>xxh3</td>
<td>37GB/s</td>
<td>43GB/s</td>
<td>47GB/s</td>
<td>49GB/s</td>
<td>34GB/s</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">The benchmarking program can be found in the <a href="https://github.com/Nicoshev/rapidhash/tree/master/bench">bench folder</a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Collision-based hash quality study</h2><a id="user-content-collision-based-hash-quality-study" aria-label="Permalink: Collision-based hash quality study" href="#collision-based-hash-quality-study"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A perfect hash function distributes its domain uniformly onto the image.</p>
<p dir="auto">If we compute <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="5e1fe976359c1db487e9e0807a2aef17">$n$</math-renderer> hashes, the expected amount of collisions should be the number of unique input pairs times the probability of producing a given hash.</p>
<p dir="auto">We present an experiment in which we use rapidhash to hash <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="5e1fe976359c1db487e9e0807a2aef17">$77$</math-renderer> datasets of <math-renderer data-static-url="https://github.githubassets.com/static" data-run-id="5e1fe976359c1db487e9e0807a2aef17">$15*2^{30}$</math-renderer> (15Gi) keys each.</p>
</article></div></div>
  </body>
</html>
