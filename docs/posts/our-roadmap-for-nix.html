<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.tweag.io/blog/2022-08-04-tweag-and-nix-future/">Original</a>
    <h1>Our Roadmap for Nix</h1>
    
    <div id="readability-page-1" class="page"><div><div><p>I lead Tweagâ€™s Nix team.</p>
<p>The Nix ecosystem is at a turning point in its evolution. After more than a decade of slow but steady growth, Nix gained a lot of traction in the past few years, leading the community to expand at an astonishing rate.
But this growth hasnâ€™t been without issue.</p>
<p>As consultants, we see that nearly all of our clients that are using Nix are, at best, annoyed by the accidental complexity that comes with it.
Some of them even decide to back off because of that, left with a nondescript feeling that Nix is not ready for them.</p>
<p>We care about Nix, and we want it to thrive.</p>
<p>The way to get there is to strengthen Nixâ€™s core as much as possible.
Instead of getting lost in many exciting things that Nix <em>could</em> do, we must take a pragmatic approach in ensuring that the core functionality of Nix works well, and is available to everyone.</p>
<p>In particular, weâ€™d like to focus on making Nix a great developer tool. We think that requires Nix to:</p>
<ul>
<li>solve peopleâ€™s problems,</li>
<li>work reliably everywhere, and</li>
<li>be ubiquitous.</li>
</ul>
<h2 id="we-want-nix-to-solve-peoples-problems"><a href="#we-want-nix-to-solve-peoples-problems" aria-label="we want nix to solve peoples problems permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>We want Nix to solve peopleâ€™s problems</h2>
<p>I love the Nix model.
Coming from a theoretical CS background, the principles behind Nix are those the whole computing industry should have adopted, and I long for the day when they become the standard.
But real-lifeâ„¢ is also a thing, and despite my partiality towards Nix, I occasionally have to admit that, well, itâ€™s just not good-enough in practice for what I want to do.
And if I have to admit that, it means that most people who donâ€™t care about the theoretical side of things will just give up on it, and rightfully so. Why should anyone use a tool that doesnâ€™t solve their problem?</p>
<p>So we want Nix to provide a clear path towards solving clear problems.
Identifying these problems is already a non-trivial part of the work, but from our past experience we can sketch out some broad axes along which to improve.</p>
<h3 id="development-environments"><a href="#development-environments" aria-label="development environments permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Development environments</h3>
<p>Veterans Nix users generally consider <code>nix-shell</code> or its successor <code>nix develop</code> to be a nice byproduct of the broader Nix world: <em>If</em> you package your program to be built with Nix, then you also incidentally get this nifty environment that you can use to develop it.
And thatâ€™s actually how <code>nix-shell</code> started â€” a quick hack for debugging packaging issues.</p>
<p>But the truth is that these developments environments are incredibly valuable by themselves.
Even if you donâ€™t have a proper clean Nix packaging, you can just drop in a <code>shell.nix</code>/<code>flake.nix</code> somewhere and get all of your dependencies magically pulled-in for you.</p>
<p>We want to rethink this functionality to directly address the needs of people, rather than having its usefulness be a mere incidental nicety.
This means:</p>
<ul>
<li>Actually trying to understand why and how people are using it, and how they could benefit more from it â€“ be it through principled user-studies or by listening to the feedback of the community and our clients.</li>
<li>From this high-level vision, rethink <code>nix develop</code> to better answer these needs, using a documentation-driven approach to keep the end-user in the center of the loop, maybe building on or drawing inspiration from other projects like Numtideâ€™s <a href="https://numtide.github.io/devshell/">devshell</a> or <a href="https://github.com/maralorn/nix-output-monitor">nix-output-monitor</a>.</li>
</ul>
<h3 id="better-distributed-pipelines"><a href="#better-distributed-pipelines" aria-label="better distributed pipelines permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Better distributed pipelines</h3>
<p>Be it as a backend for their development environments or because they are more hooked into Nix, a number of Nix users need more than just being able to run a Nix command on their own machine.
Even a reasonably simple Nix setup might quickly require running Nix on the CI, with a binary cache, maybe even distributed builds, etc.
And even simple instances of this are generally a huge pain to do properly.</p>
<p>Some projects like the awesome <a href="https://www.cachix.org/">cachix</a> and the related <a href="https://github.com/search?q=action+user%3Acachix&amp;type=repositories">github actions</a> or <a href="https://nixbuild.net/">nixbuild.net</a> provide some of this infrastructure as a service, but they arenâ€™t always an acceptable option, nor are they an excuse for a bad out-of-the-box experience.
Besides, thereâ€™s only so much that they can do, and some problems (performance in particular) can only be solved at the root â€“ the Nix implementation itself.</p>
<p>Solving this issue in its full generality is a hard problem, however we can ensure that the simplest and most common use cases are properly covered â€“ as simply as possible and thoroughly documented.</p>
<h2 id="we-want-nix-to-work-reliably-everywhere"><a href="#we-want-nix-to-work-reliably-everywhere" aria-label="we want nix to work reliably everywhere permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>We want Nix to work reliably everywhere</h2>
<p>In the simplest scenarios, Nix works great. Nix on NixOS is a breeze, Nix on Ubuntu works well 99% of the time, and Debian even makes Nix available in its own repositories.
The other scenarios range from OK to awful (any Mac users around? ðŸ‘‹).</p>
<p>This is a sad state, but not a fatality.
We (the community) have the resources to make Nix a success story everywhere it can be, and we (Tweagers) hope to be a driving force for that effort.</p>
<p>This means in particular:</p>
<ul>
<li>Improving the Nix installer. It is a tiny but crucial piece of the ecosystem â€“ being generally the very first thing that people run before using Nix on a system â€“ yet it is one of the least loved parts of the Nix codebase.</li>
<li>Fostering more efforts to keep nixpkgs healthy on MacOS. The <a href="https://discourse.nixos.org/t/2022-nix-survey-results/18983">Nix
community survey</a> reports that thereâ€™s more than
three time more Linux users than MacOS users in the
Nix community. Compare with developers in general: there are only <a href="https://survey.stackoverflow.co/2022/#section-most-popular-technologies-operating-system">slightly fewer Mac users than Linux users</a> according to the Stack Overflow survey.</li>
<li>Allowing Nix to run in restricted corporate environments, for example with no or restricted root access, or using access-control systems like SELinux.</li>
</ul>
<h2 id="we-want-nix-to-be-ubiquitous"><a href="#we-want-nix-to-be-ubiquitous" aria-label="we want nix to be ubiquitous permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>We want Nix to be ubiquitous</h2>
<p>Being simple and reliable is great. But know whatâ€™s better? Being everywhere.</p>
<p>Take the good old shell script.
Itâ€™s not simple for anything beyond just sequencing a few commands.
Itâ€™s arguably not reliable either in that it has so many traps that most shell scripts in the wild are bound to blow up given anything as malicious as a filename with spaces or an empty parameter.
Yet everyone â€” myself included â€” uses shell script for so many things, because itâ€™s just the de facto standard, so we know that it will be available and that people will understand whatâ€™s going on.
Even when people try to replace it, they keep it as a point of reference or even try to stay compatible with it.</p>
<p>Likewise, we want Nix to be everywhere.
We want a world where finding a <code>flake.nix</code> at the root of a software project is not a pleasant surprise but something expected and common.
And we want the people who design tomorrowâ€™s software distribution mechanism to at least know and recognize the Nix model, and take that into account.</p>
<p>To get there, we plan to:</p>
<ul>
<li>keep the marketing team efforts going, to make more people aware of Nix and give the community tool to talk about it,</li>
<li>keep writing and talking about Nix in public,</li>
<li>participate or help organize conferences and workshops.</li>
</ul>
<hr/>
<p>This is obviously a broad roadmap, and bound to evolve.
Some of that, like the <a href="https://discourse.nixos.org/t/marketing-team-can-we-present-nix-nixos-better/6249">marketing team efforts</a> or the work on the Nix package manager has already been going on for some time.
Undertakings like the <a href="https://discourse.nixos.org/t/documentation-team-flattening-the-learning-curve/20003">coordinated documentation effort</a> or the <a href="https://github.com/nixpkgs-architecture/">nixpkgs-architecture team</a> is just getting started.
Some have yet to begin.
However, we hope that it will help shed light on the work that Tweag does and intends to do for the Nix community, and maybe also serve as an inspiration both for a potential community-wide roadmap and for individual contributions.</p>
<p>We also intend to regularly publish a shorter-term roadmap on <a href="https://discourse.nixos.org">discourse</a> alongside our usual dev updates. So stay tuned!</p></div></div></div>
  </body>
</html>
