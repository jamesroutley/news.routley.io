<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://eoinmurray.info/boltzmann-machine">Original</a>
    <h1>A Tiny Boltzmann Machine</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><p>A Boltzmann Machine is a type of neural network that tries to learn patterns by mimicking
how energy works in physics.</p><p>Each neuron can be on or off, the machine is made up of many of these neurons connected to each other.</p><p>Some neurons are <span></span> visible (we can see them and even set their state), and some are <span></span> hidden (we can&#39;t see them).</p><p>The connections between neurons are called weights, and they can be <span></span> positive or <span></span> negative.</p></div><div><svg width="400" height="400"><g><circle cx="200" cy="360" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="200" y="364" font-size="8" fill="#000" text-anchor="middle">v0</text></g><g><circle cx="145.27677706789302" cy="350.35081932574536" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="145.27677706789302" y="354.35081932574536" font-size="8" fill="#000" text-anchor="middle">v1</text></g><g><circle cx="97.1539824501537" cy="322.5671108990365" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="97.1539824501537" y="326.5671108990365" font-size="8" fill="#000" text-anchor="middle">v2</text></g><g><circle cx="61.43593539448983" cy="280.00000000000006" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="61.43593539448983" y="284.00000000000006" font-size="8" fill="#000" text-anchor="middle">v3</text></g><g><circle cx="42.43075951804673" cy="227.78370842670884" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="42.43075951804673" y="231.78370842670884" font-size="8" fill="#000" text-anchor="middle">v4</text></g><g><circle cx="42.4307595180467" cy="172.2162915732912" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="42.4307595180467" y="176.2162915732912" font-size="8" fill="#000" text-anchor="middle">v5</text></g><g><circle cx="61.435935394489775" cy="120.00000000000004" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="61.435935394489775" y="124.00000000000004" font-size="8" fill="#000" text-anchor="middle">v6</text></g><g><circle cx="97.15398245015368" cy="77.43288910096354" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="97.15398245015368" y="81.43288910096354" font-size="8" fill="#000" text-anchor="middle">v7</text></g><g><circle cx="145.27677706789302" cy="49.64918067425464" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="145.27677706789302" y="53.64918067425464" font-size="8" fill="#000" text-anchor="middle">v8</text></g><g><circle cx="199.99999999999997" cy="40" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="199.99999999999997" y="44" font-size="8" fill="#000" text-anchor="middle">v9</text></g><g><circle cx="200" cy="40" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="200" y="44" font-size="8" fill="#000" text-anchor="middle">h0</text></g><g><circle cx="254.723222932107" cy="49.649180674254666" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="254.723222932107" y="53.649180674254666" font-size="8" fill="#000" text-anchor="middle">h1</text></g><g><circle cx="302.8460175498463" cy="77.43288910096352" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="302.8460175498463" y="81.43288910096352" font-size="8" fill="#000" text-anchor="middle">h2</text></g><g><circle cx="338.56406460551017" cy="120" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="338.56406460551017" y="124" font-size="8" fill="#000" text-anchor="middle">h3</text></g><g><circle cx="357.5692404819533" cy="172.21629157329113" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="357.5692404819533" y="176.21629157329113" font-size="8" fill="#000" text-anchor="middle">h4</text></g><g><circle cx="357.5692404819533" cy="227.78370842670887" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="357.5692404819533" y="231.78370842670887" font-size="8" fill="#000" text-anchor="middle">h5</text></g><g><circle cx="338.5640646055102" cy="280" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="338.5640646055102" y="284" font-size="8" fill="#000" text-anchor="middle">h6</text></g><g><circle cx="302.84601754984635" cy="322.5671108990365" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="302.84601754984635" y="326.5671108990365" font-size="8" fill="#000" text-anchor="middle">h7</text></g><g><circle cx="254.723222932107" cy="350.3508193257453" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="254.723222932107" y="354.3508193257453" font-size="8" fill="#000" text-anchor="middle">h8</text></g><g><circle cx="200" cy="360" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="200" y="364" font-size="8" fill="#000" text-anchor="middle">h9</text></g></svg><p>Hover over the neurons to highlight their connections.</p></div></div></div><div><div><div><p>General Boltzmann Machine</p><svg width="400" height="400"><g><circle cx="200" cy="360" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="200" y="364" font-size="8" fill="#000" text-anchor="middle">v0</text></g><g><circle cx="145.27677706789302" cy="350.35081932574536" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="145.27677706789302" y="354.35081932574536" font-size="8" fill="#000" text-anchor="middle">v1</text></g><g><circle cx="97.1539824501537" cy="322.5671108990365" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="97.1539824501537" y="326.5671108990365" font-size="8" fill="#000" text-anchor="middle">v2</text></g><g><circle cx="61.43593539448983" cy="280.00000000000006" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="61.43593539448983" y="284.00000000000006" font-size="8" fill="#000" text-anchor="middle">v3</text></g><g><circle cx="42.43075951804673" cy="227.78370842670884" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="42.43075951804673" y="231.78370842670884" font-size="8" fill="#000" text-anchor="middle">v4</text></g><g><circle cx="42.4307595180467" cy="172.2162915732912" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="42.4307595180467" y="176.2162915732912" font-size="8" fill="#000" text-anchor="middle">v5</text></g><g><circle cx="61.435935394489775" cy="120.00000000000004" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="61.435935394489775" y="124.00000000000004" font-size="8" fill="#000" text-anchor="middle">v6</text></g><g><circle cx="97.15398245015368" cy="77.43288910096354" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="97.15398245015368" y="81.43288910096354" font-size="8" fill="#000" text-anchor="middle">v7</text></g><g><circle cx="145.27677706789302" cy="49.64918067425464" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="145.27677706789302" y="53.64918067425464" font-size="8" fill="#000" text-anchor="middle">v8</text></g><g><circle cx="199.99999999999997" cy="40" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="199.99999999999997" y="44" font-size="8" fill="#000" text-anchor="middle">v9</text></g><g><circle cx="200" cy="40" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="200" y="44" font-size="8" fill="#000" text-anchor="middle">h0</text></g><g><circle cx="254.723222932107" cy="49.649180674254666" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="254.723222932107" y="53.649180674254666" font-size="8" fill="#000" text-anchor="middle">h1</text></g><g><circle cx="302.8460175498463" cy="77.43288910096352" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="302.8460175498463" y="81.43288910096352" font-size="8" fill="#000" text-anchor="middle">h2</text></g><g><circle cx="338.56406460551017" cy="120" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="338.56406460551017" y="124" font-size="8" fill="#000" text-anchor="middle">h3</text></g><g><circle cx="357.5692404819533" cy="172.21629157329113" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="357.5692404819533" y="176.21629157329113" font-size="8" fill="#000" text-anchor="middle">h4</text></g><g><circle cx="357.5692404819533" cy="227.78370842670887" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="357.5692404819533" y="231.78370842670887" font-size="8" fill="#000" text-anchor="middle">h5</text></g><g><circle cx="338.5640646055102" cy="280" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="338.5640646055102" y="284" font-size="8" fill="#000" text-anchor="middle">h6</text></g><g><circle cx="302.84601754984635" cy="322.5671108990365" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="302.84601754984635" y="326.5671108990365" font-size="8" fill="#000" text-anchor="middle">h7</text></g><g><circle cx="254.723222932107" cy="350.3508193257453" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="254.723222932107" y="354.3508193257453" font-size="8" fill="#000" text-anchor="middle">h8</text></g><g><circle cx="200" cy="360" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="200" y="364" font-size="8" fill="#000" text-anchor="middle">h9</text></g></svg><p>Hover over the neurons to highlight their connections.</p><p>A General Boltzmann Machine has connections between all neurons. This makes it powerful, but its training involves calculating an <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^n)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>O</span><span>(</span><span><span>2</span><span><span><span><span><span><span></span><span><span>n</span></span></span></span></span></span></span></span><span>)</span></span></span></span> term.</p></div><div><p>Restricted Boltzmann Machine</p><svg width="400" height="400"><g><circle cx="50" cy="36.36363636363637" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="40.36363636363637" font-size="8" fill="#000" text-anchor="middle">v0</text></g><g><circle cx="50" cy="72.72727272727273" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="76.72727272727273" font-size="8" fill="#000" text-anchor="middle">v1</text></g><g><circle cx="50" cy="109.0909090909091" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="113.0909090909091" font-size="8" fill="#000" text-anchor="middle">v2</text></g><g><circle cx="50" cy="145.45454545454547" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="149.45454545454547" font-size="8" fill="#000" text-anchor="middle">v3</text></g><g><circle cx="50" cy="181.81818181818184" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="185.81818181818184" font-size="8" fill="#000" text-anchor="middle">v4</text></g><g><circle cx="50" cy="218.1818181818182" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="222.1818181818182" font-size="8" fill="#000" text-anchor="middle">v5</text></g><g><circle cx="50" cy="254.54545454545456" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="258.54545454545456" font-size="8" fill="#000" text-anchor="middle">v6</text></g><g><circle cx="50" cy="290.90909090909093" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="294.90909090909093" font-size="8" fill="#000" text-anchor="middle">v7</text></g><g><circle cx="50" cy="327.2727272727273" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="331.2727272727273" font-size="8" fill="#000" text-anchor="middle">v8</text></g><g><circle cx="50" cy="363.6363636363637" r="20" fill="rgb(255, 255, 255)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="50" y="367.6363636363637" font-size="8" fill="#000" text-anchor="middle">v9</text></g><g><circle cx="350" cy="36.36363636363637" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="40.36363636363637" font-size="8" fill="#000" text-anchor="middle">h0</text></g><g><circle cx="350" cy="72.72727272727273" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="76.72727272727273" font-size="8" fill="#000" text-anchor="middle">h1</text></g><g><circle cx="350" cy="109.0909090909091" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="113.0909090909091" font-size="8" fill="#000" text-anchor="middle">h2</text></g><g><circle cx="350" cy="145.45454545454547" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="149.45454545454547" font-size="8" fill="#000" text-anchor="middle">h3</text></g><g><circle cx="350" cy="181.81818181818184" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="185.81818181818184" font-size="8" fill="#000" text-anchor="middle">h4</text></g><g><circle cx="350" cy="218.1818181818182" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="222.1818181818182" font-size="8" fill="#000" text-anchor="middle">h5</text></g><g><circle cx="350" cy="254.54545454545456" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="258.54545454545456" font-size="8" fill="#000" text-anchor="middle">h6</text></g><g><circle cx="350" cy="290.90909090909093" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="294.90909090909093" font-size="8" fill="#000" text-anchor="middle">h7</text></g><g><circle cx="350" cy="327.2727272727273" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="331.2727272727273" font-size="8" fill="#000" text-anchor="middle">h8</text></g><g><circle cx="350" cy="363.6363636363637" r="20" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1" style="cursor:pointer"></circle><text x="350" y="367.6363636363637" font-size="8" fill="#000" text-anchor="middle">h9</text></g></svg><p>A Restricted Boltzmann Machine is a special case where the visible and hidden neurons are not connected within the same layer. This makes it faster to train and understand.</p></div></div></div><div><div><div><p>The energy of a configuration of the visible and hidden units is defined as:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>b</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>c</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">  E(v,h) = -\sum_{i=1}^{m} \sum_{j=1}^{n} w_{ij} v_i h_j - \sum_{i=1}^{m} b_i v_i - \sum_{j=1}^{n} c_j h_j</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>E</span><span>(</span><span>v</span><span>,</span><span></span><span>h</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>−</span><span></span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>m</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>j</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>m</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>b</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>j</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>c</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></p><p>where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>v</span></span></span></span> is the visible layer, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>h</span></span></span></span> is the hidden layer, <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>w</span></span></span></span> is the weight matrix, and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>b</span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>c</span></span></span></span> are the biases for the visible
and hidden layers, respectively.</p><p>The visualisation on the right randomises the weights, biases and activation values of a Boltzmann machine and calculates its energy.</p></div></div></div><div><div><div><p>During training it is given examples (e.g., images, text) and the machine adjusts its
weights to lower the energy of those samples.</p><p>It effectively learns <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(v)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>P</span><span>(</span><span>v</span><span>)</span></span></span></span>, the probability of visible units <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>v</span></span></span></span>, which
is proportional to <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-E(v)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span>.</p><p>After training, it can sample new data from the learned distribution using Gibbs sampling.</p><p>These samples are new, never-before-seen, but statistically similar to the training data.</p></div><div><div><p>Here is our training data.</p><p>We want the network to learn how to make similar samples to these.</p></div></div></div></div><div><div id="trainer"><div><p>Simulator</p><p>Press the &#34;Run Simulation&#34; button to start training the RBM. If you let the simulation run for a while, you will see the weights of the RBM converge to a stable state. The energy loss will also decrease over time.</p><p><strong>You can compare the input and output states of the RBM by pausing the simulation</strong>.</p><p>In the beginning, the input and output states will be dissimilar. As the simulation progresses, the input and output states will become more similar.</p></div><div><div><p><svg width="400" height="400"><g><circle cx="50" cy="72.72727272727272" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="76.72727272727272" font-size="12" fill="#000" text-anchor="middle">v0</text></g><g><circle cx="50" cy="105.45454545454545" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="109.45454545454545" font-size="12" fill="#000" text-anchor="middle">v1</text></g><g><circle cx="50" cy="138.1818181818182" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="142.1818181818182" font-size="12" fill="#000" text-anchor="middle">v2</text></g><g><circle cx="50" cy="170.9090909090909" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="174.9090909090909" font-size="12" fill="#000" text-anchor="middle">v3</text></g><g><circle cx="50" cy="203.63636363636363" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="207.63636363636363" font-size="12" fill="#000" text-anchor="middle">v4</text></g><g><circle cx="50" cy="236.36363636363637" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="240.36363636363637" font-size="12" fill="#000" text-anchor="middle">v5</text></g><g><circle cx="50" cy="269.0909090909091" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="273.0909090909091" font-size="12" fill="#000" text-anchor="middle">v6</text></g><g><circle cx="50" cy="301.8181818181818" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="305.8181818181818" font-size="12" fill="#000" text-anchor="middle">v7</text></g><g><circle cx="50" cy="334.54545454545456" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="338.54545454545456" font-size="12" fill="#000" text-anchor="middle">v8</text></g><g><circle cx="50" cy="367.27272727272725" r="15" fill="rgb(200, 200, 200)" stroke="#000" stroke-width="1"></circle><text x="50" y="371.27272727272725" font-size="12" fill="#000" text-anchor="middle">v9</text></g><g><circle cx="350" cy="72.72727272727272" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="76.72727272727272" font-size="12" fill="#000" text-anchor="middle">h0</text></g><g><circle cx="350" cy="105.45454545454545" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="109.45454545454545" font-size="12" fill="#000" text-anchor="middle">h1</text></g><g><circle cx="350" cy="138.1818181818182" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="142.1818181818182" font-size="12" fill="#000" text-anchor="middle">h2</text></g><g><circle cx="350" cy="170.9090909090909" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="174.9090909090909" font-size="12" fill="#000" text-anchor="middle">h3</text></g><g><circle cx="350" cy="203.63636363636363" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="207.63636363636363" font-size="12" fill="#000" text-anchor="middle">h4</text></g><g><circle cx="350" cy="236.36363636363637" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="240.36363636363637" font-size="12" fill="#000" text-anchor="middle">h5</text></g><g><circle cx="350" cy="269.0909090909091" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="273.0909090909091" font-size="12" fill="#000" text-anchor="middle">h6</text></g><g><circle cx="350" cy="301.8181818181818" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="305.8181818181818" font-size="12" fill="#000" text-anchor="middle">h7</text></g><g><circle cx="350" cy="334.54545454545456" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="338.54545454545456" font-size="12" fill="#000" text-anchor="middle">h8</text></g><g><circle cx="350" cy="367.27272727272725" r="15" fill="rgb(50, 50, 50)" stroke="#000" stroke-width="1"></circle><text x="350" y="371.27272727272725" font-size="12" fill="#000" text-anchor="middle">h9</text></g></svg></p></div></div></div></div><div><div id="appendix"><div><p>Appendix: Contrastive Divergence</p><p>Starting with a Boltzmann machine as defined earlier, we
want to derive the contrastive divergence algorithm for training.
The goal is to adjust the weights of the network to minimize the energy of the training data.</p><p>We have:</p><ul>
<li>A visible layer <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>v</span></span></span></span> and a hidden layer <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>h</span></span></span></span>.</li>
<li>A weight matrix <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>W</span></span></span></span> that connects the visible and hidden layers.</li>
<li>A bias vector <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>b</span></span></span></span> for the visible layer and a bias vector <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>c</span></span></span></span> for the hidden layer.</li>
</ul><p>Energy function in matrix form:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>b</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>c</mi><mi>j</mi></msub><msub><mi>h</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">E(v,h) = -\sum_{i=1}^{m} \sum_{j=1}^{n} w_{ij} v_i h_j - \sum_{i=1}^{m} b_i v_i - \sum_{j=1}^{n} c_j h_j</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>E</span><span>(</span><span>v</span><span>,</span><span></span><span>h</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>−</span><span></span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>m</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>j</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>i</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>m</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>b</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>j</span><span>=</span><span>1</span></span></span></span><span><span></span><span><span>∑</span></span></span><span><span></span><span><span><span>n</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>c</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></p><p>Joint distribution:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">P(v,h) = \frac{1}{Z} e^{-E(v,h)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>P</span><span>(</span><span>v</span><span>,</span><span></span><span>h</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>Z</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>,</span><span>h</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>Where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Z</span></span></span></span> is the partition function, which normalizes the distribution.</p></div><div><p>We train the RBM by maximizing the likelihood of the training data, i.e. maximizing <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>log</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{log}(P(v))</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>log</span></span><span>(</span><span>P</span><span>(</span><span>v</span><span>))</span></span></span></span>.</p><p>The marginal likelihood of the visible layer is given by:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>∑</mo><mi>h</mi></munder><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(v) = \sum_{h} P(v,h)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>P</span><span>(</span><span>v</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>h</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span>P</span><span>(</span><span>v</span><span>,</span><span></span><span>h</span><span>)</span></span></span></span></span></p><p>Then the log-likelihood is:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>log</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mtext>log</mtext><munder><mo>∑</mo><mi>h</mi></munder><mfrac><mn>1</mn><mi>Z</mi></mfrac><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mtext>log</mtext><munder><mo>∑</mo><mi>h</mi></munder><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi>v</mi><mo separator="true">,</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mtext>log</mtext><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{log}(P(v)) = \text{log}\sum_{h} \frac{1}{Z} e^{-E(v,h)} = \text{log}\sum_{h} e^{-E(v,h)} - \text{log}(Z)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>log</span></span><span>(</span><span>P</span><span>(</span><span>v</span><span>))</span><span></span><span>=</span><span></span></span><span><span></span><span><span>log</span></span><span></span><span><span><span><span><span><span></span><span><span><span>h</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>Z</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>,</span><span>h</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>log</span></span><span></span><span><span><span><span><span><span></span><span><span><span>h</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>,</span><span>h</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>−</span><span></span></span><span><span></span><span><span>log</span></span><span>(</span><span>Z</span><span>)</span></span></span></span></span></p><p>Differentiating with respect to the weights <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> gives:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><munder><mo>∑</mo><mi mathvariant="bold">h</mi></munder><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac><munder><mo>∑</mo><mi mathvariant="bold">h</mi></munder><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo fence="true">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="1em"></mspace><mo>−</mo><mfrac><mn>1</mn><mi>Z</mi></mfrac><munder><mo>∑</mo><mrow><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi></mrow></munder><mrow><mo fence="true">(</mo><mo>−</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo fence="true">)</mo></mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo separator="true">,</mo><mi mathvariant="bold">h</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\frac{\partial \log P(\mathbf{v})}{\partial w_{ij}} 
&amp;= \frac{1}{\sum_{\mathbf{h}} e^{-E(\mathbf{v}, \mathbf{h})}} 
\sum_{\mathbf{h}} \left( -\frac{\partial E(\mathbf{v}, \mathbf{h})}{\partial w_{ij}} \right) e^{-E(\mathbf{v}, \mathbf{h})} \\
&amp;\quad - \frac{1}{Z} \sum_{\mathbf{v}, \mathbf{h}} \left( -\frac{\partial E(\mathbf{v}, \mathbf{h})}{\partial w_{ij}} \right) e^{-E(\mathbf{v}, \mathbf{h})}
\end{align*}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span></span><span>lo<span>g</span></span><span></span><span>P</span><span>(</span><span>v</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span></span><span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>∑</span><span><span><span><span><span><span></span><span><span><span>h</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>,</span><span>h</span><span>)</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>h</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span>(</span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>E</span><span>(</span><span>v</span><span>,</span><span></span><span>h</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>,</span><span>h</span><span>)</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span><span></span><span></span><span></span><span>−</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>Z</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span><span><span><span><span><span></span><span><span><span>v</span><span>,</span><span>h</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span>(</span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span>E</span><span>(</span><span>v</span><span>,</span><span></span><span>h</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span><span>e</span><span><span><span><span><span><span></span><span><span><span>−</span><span>E</span><span>(</span><span>v</span><span>,</span><span>h</span><span>)</span></span></span></span></span></span></span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>Similar forms exist for the biases <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>b</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">c_j</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>c</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>.</p><p>Since we are performing gradient ascent:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>←</mo><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\Delta w_{ij} \leftarrow \Delta w_{ij} + \eta \frac{\partial \log P(v)}{\partial w_{ij}}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>←</span><span></span></span><span><span></span><span>Δ</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>+</span><span></span></span><span><span></span><span>η</span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span></span><span>lo<span>g</span></span><span></span><span>P</span><span>(</span><span>v</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>Therefore we get our weight update rule:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>η</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mi>η</mi><mrow><mo fence="true">(</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta w_{ij} = \eta \frac{\partial \log P(v)}{\partial w_{ij}} = \eta \left( \langle v_i h_j \rangle_{data} - \langle v_i h_j \rangle_{model} \right)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span><span></span><span><span><span><span><span><span></span><span><span>∂</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>∂</span><span></span><span>lo<span>g</span></span><span></span><span>P</span><span>(</span><span>v</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span></span><span><span>(</span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span></span></p></div><div><p>A similar process can be followed for the biases <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>b</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">c_j</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>c</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><mi>η</mi><mrow><mo fence="true">(</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta b_i = \eta \left( \langle v_i \rangle_{data} - \langle v_i \rangle_{model} \right)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>b</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span></span><span><span>(</span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>c</mi><mi>j</mi></msub><mo>=</mo><mi>η</mi><mrow><mo fence="true">(</mo><mo stretchy="false">⟨</mo><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta c_j = \eta \left( \langle h_j \rangle_{data} - \langle h_j \rangle_{model} \right)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>c</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span></span><span><span>(</span><span>⟨</span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>⟨</span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span></span></p><p>Where <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><mo>⋅</mo><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\langle \cdot \rangle_{data}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>⟨</span><span>⋅</span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the expectation with respect to the training data and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⟨</mo><mo>⋅</mo><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\langle \cdot \rangle_{model}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>⟨</span><span>⋅</span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span> is the expectation with respect to the model distribution.</p><p>The next step is to approximate the model expectation using Gibbs sampling.</p><ol>
<li>Positive phase: Sample <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">h</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup><mo>≈</mo><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold">h</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="bold">v</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mtext>data</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{h}^{(0)} \approx P(\mathbf{h}|\mathbf{v}^{(0)} = \text{data})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>h</span><span><span><span><span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>≈</span><span></span></span><span><span></span><span>P</span><span>(</span><span>h</span><span>∣</span><span><span>v</span><span><span><span><span><span><span></span><span><span><span>(</span><span>0</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>data</span></span><span>)</span></span></span></span></li>
<li>Negative phase: Run k steps of Gibbs sampling:</li>
</ol><ul>
<li>Alternating between <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">v</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>≈</mo><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="bold">h</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{v}^{(t+1)} \approx P(\mathbf{v}|\mathbf{h}^{(t)})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>v</span><span><span><span><span><span><span></span><span><span><span>(</span><span>t</span><span>+</span><span>1</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>≈</span><span></span></span><span><span></span><span>P</span><span>(</span><span>v</span><span>∣</span><span><span>h</span><span><span><span><span><span><span></span><span><span><span>(</span><span>t</span><span>)</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span></li>
<li>and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">h</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>≈</mo><mi>P</mi><mo stretchy="false">(</mo><mi mathvariant="bold">h</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="bold">v</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{h}^{(t+1)} \approx P(\mathbf{h}|\mathbf{v}^{(t)})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>h</span><span><span><span><span><span><span></span><span><span><span>(</span><span>t</span><span>+</span><span>1</span><span>)</span></span></span></span></span></span></span></span></span><span></span><span>≈</span><span></span></span><span><span></span><span>P</span><span>(</span><span>h</span><span>∣</span><span><span>v</span><span><span><span><span><span><span></span><span><span><span>(</span><span>t</span><span>)</span></span></span></span></span></span></span></span></span><span>)</span></span></span></span></li>
</ul><p>Once those steps are done we update the weights and biases according to:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>η</mi><mrow><mo fence="true">(</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta w_{ij} = \eta \left( \langle v_i h_j \rangle_{data} - \langle v_i h_j \rangle_{model} \right)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>w</span><span><span><span><span><span><span></span><span><span><span>ij</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span></span><span><span>(</span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><mi>η</mi><mrow><mo fence="true">(</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>v</mi><mi>i</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta b_i = \eta \left( \langle v_i \rangle_{data} - \langle v_i \rangle_{model} \right)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>b</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span></span><span><span>(</span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>⟨</span><span><span>v</span><span><span><span><span><span><span></span><span><span>i</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span></span><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>c</mi><mi>j</mi></msub><mo>=</mo><mi>η</mi><mrow><mo fence="true">(</mo><mo stretchy="false">⟨</mo><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi></mrow></msub><mo>−</mo><mo stretchy="false">⟨</mo><msub><mi>h</mi><mi>j</mi></msub><msub><mo stretchy="false">⟩</mo><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta c_j = \eta \left( \langle h_j \rangle_{data} - \langle h_j \rangle_{model} \right)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Δ</span><span><span>c</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span>η</span><span></span><span><span>(</span><span>⟨</span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>d</span><span>a</span><span>t</span><span>a</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>−</span><span></span><span>⟨</span><span><span>h</span><span><span><span><span><span><span></span><span><span>j</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span>⟩</span><span><span><span><span><span><span></span><span><span><span>m</span><span>o</span><span>d</span><span>e</span><span>l</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></span></span></p></div></div></div></div>
  </body>
</html>
