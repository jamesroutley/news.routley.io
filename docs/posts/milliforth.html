<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/fuzzballcat/milliForth">Original</a>
    <h1>milliForth</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">A FORTH in 380 bytes — the smallest real programming language ever, as of yet.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/57006511/280563430-ef3d48cf-1581-4574-8625-8d97b00acaca.gif"><img src="https://user-images.githubusercontent.com/57006511/280563430-ef3d48cf-1581-4574-8625-8d97b00acaca.gif" alt="milliFORTH_justhelloworld" data-animated-image=""/></a>
<em>The code in the above gif, that of [an older version of] <code>hello_world.FORTH</code>, is a modified version of the hello world program used by sectorFORTH (see below)</em></p>
<h2 tabindex="-1" id="user-content-bytes" dir="auto"><a href="#bytes">bytes?<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">Yes, bytes.  This is a FORTH so small it fits in a 512-byte boot sector.  This isn&#39;t new — sectorFORTH<sup><a href="#user-content-fn-1-fe0a5a75100c23cd68503a9062b3758d" id="user-content-fnref-1-fe0a5a75100c23cd68503a9062b3758d" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup> successfully fit a FORTH within the boot sector.  However, milliFORTH appears to be <em>the smallest</em> &#34;real&#34; programming language implementation ever, beating out sectorLISP<sup><a href="#user-content-fn-2-fe0a5a75100c23cd68503a9062b3758d" id="user-content-fnref-2-fe0a5a75100c23cd68503a9062b3758d" data-footnote-ref="" aria-describedby="footnote-label">2</a></sup>, a mind-blowing 436 byte implementation of LISP, by 56 bytes.  (&#34;real&#34; excludes esolangs and other non-production languages - for example, the sectorLISP author&#39;s implementation of BF is just 99 bytes, but it clearly isn&#39;t used to any serious capacity.)</p>
<h2 tabindex="-1" id="user-content-language" dir="auto"><a href="#language">Language<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">sectorFORTH<sup><a href="#user-content-fn-1-fe0a5a75100c23cd68503a9062b3758d" id="user-content-fnref-1-2-fe0a5a75100c23cd68503a9062b3758d" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup> was an extensive guide throughout the process of implementing milliFORTH, and milliFORTH&#39;s design actually converged on sectorFORTH unintentionally in a few areas.  That said, the language implemented is intentionally very similar, being the &#39;minimal FORTH&#39;.</p>
<p dir="auto">FORTH itself will not be explained here (prior understanding assumed).  Being so small, milliFORTH contains just a handful of words:</p>
<table>
<thead>
<tr>
<th>Word</th>
<th>Signature</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>@</code></td>
<td><code>( addr -- value )</code></td>
<td>Get a value at an address</td>
</tr>
<tr>
<td><code>!</code></td>
<td><code>( value addr -- )</code></td>
<td>Store a value at an address</td>
</tr>
<tr>
<td><code>sp@</code></td>
<td><code>( -- sp )</code></td>
<td>Get pointer to top of the data stack</td>
</tr>
<tr>
<td><code>rp@</code></td>
<td><code>( -- rp )</code></td>
<td>Get pointer to top of the return stack</td>
</tr>
<tr>
<td><code>0=</code></td>
<td><code>( value -- flag )</code></td>
<td>Check if a value equals zero (-1 = TRUE, 0 = FALSE)</td>
</tr>
<tr>
<td><code>+</code></td>
<td><code>( a b -- a+b )</code></td>
<td>Sum two numbers</td>
</tr>
<tr>
<td><code>nand</code></td>
<td><code>( a b -- aNANDb )</code></td>
<td>NAND two numbers</td>
</tr>
<tr>
<td><code>exit</code></td>
<td><code>( r:addr -- )</code></td>
<td>Pop from the return stack, resume execution at the popped address</td>
</tr>
<tr>
<td><code>key</code></td>
<td><code>( -- key )</code></td>
<td>Read a keystroke</td>
</tr>
<tr>
<td><code>emit</code></td>
<td><code>( char -- )</code></td>
<td>Print out an ASCII character</td>
</tr>
<tr>
<td><code>s@</code></td>
<td><code>( -- s@ )</code></td>
<td>The &#34;state struct&#34; pointer.  The cells of this struct are, in order: <ul dir="auto"><li><code>state</code>: The state of the interpreter (0 = compile words, 1 = execute words)</li><li><code>&gt;in</code>: Pointer to the current offset into the terminal input buffer</li><li><code>latest</code>: The pointer to the most recent dictionary space</li><li><code>here</code>: The pointer to the next available space in the dictionary</li></ul></td>
</tr>
</tbody>
</table>
<p dir="auto">On a fundamental level, milliFORTH the same FORTH as implemented by sectorFORTH, with a few modifications:</p>
<ul dir="auto">
<li>All of the interpreter state words are bundled into a single struct (<code>s@</code>).</li>
<li>Words don&#39;t get hidden while you are defining them.  This doesn&#39;t really hinder your actual ability to write programs, but rather makes it possible to hang the interpreter if you do something wrong in this respect.</li>
<li>There&#39;s no <code>tib</code> (terminal input buffer) word, because <code>tib</code> always starts at <code>0x0000</code>, so you can just use <code>&gt;in</code> and don&#39;t need to add anything to it.</li>
<li>In the small (production) version, the delete key doesn&#39;t work.  I think this is fair since sectorLISP doesn&#39;t handle backspace either; even if you add it back, milliFORTH is still smaller by a few bytes.</li>
<li>Error handling is even sparser.  Successful input results in nothing (no familiar <code>ok.</code>).  Erroneous input prints an extra blank line between the previous input and the next prompt.</li>
</ul>
<h2 tabindex="-1" id="user-content-use" dir="auto"><a href="#use">Use<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">sector.bin is an assembled binary of sector.asm.  You can run it using <code>make emulate</code>, which invokes (and thus requires) <code>qemu-system-i386</code>, or by using any emulator of your choice.</p>
<p dir="auto">Alternatively, <code>make</code> will reassemble sector.asm, then run the above qemu emulator.</p>
<p dir="auto"><strong>Included in this repo is a pyautogui script</strong> which can be run to automatically type in the <code>hello_world.FORTH</code> file into your qemu emulator.  A very useful tool.  It is self-explaining, but usage involves simply starting the QEMU emulator, running the python script, and putting your cursor into the QEMU emulator again.</p>
<p dir="auto"><code>make sizecheck</code> is a utility which assembles sector.asm into sector.bin and then lists out the size of sector.bin for you.  Note that this automatically removes the padding from the .bin (as a working bootloader must be exactly 512 bytes).</p>
<h2 tabindex="-1" id="user-content-references" dir="auto"><a href="#references">References<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<section data-footnotes="">
<ol dir="auto">
<li id="user-content-fn-1-fe0a5a75100c23cd68503a9062b3758d">
<p dir="auto">The immensely inspirational sectorForth, to which much credit is due: <a href="https://github.com/cesarblum/sectorforth/">https://github.com/cesarblum/sectorforth/</a>. <a href="#user-content-fnref-1-fe0a5a75100c23cd68503a9062b3758d" data-footnote-backref="" aria-label="Back to reference 1">↩</a> <a href="#user-content-fnref-1-2-fe0a5a75100c23cd68503a9062b3758d" data-footnote-backref="" aria-label="Back to reference 1-2">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-2-fe0a5a75100c23cd68503a9062b3758d">
<p dir="auto">Mind-blowing sectorLISP: <a href="https://justine.lol/sectorlisp2/">https://justine.lol/sectorlisp2/</a>, <a href="https://github.com/jart/sectorlisp">https://github.com/jart/sectorlisp</a>. <a href="#user-content-fnref-2-fe0a5a75100c23cd68503a9062b3758d" data-footnote-backref="" aria-label="Back to reference 2">↩</a></p>
</li>
</ol>
</section>
</article>
          </div></div>
  </body>
</html>
