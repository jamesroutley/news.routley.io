<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ai.facebook.com/blog/meta-training-inference-accelerator-AI-MTIA/">Original</a>
    <h1>MTIA v1: Metaâ€™s first-generation AI inference accelerator</h1>
    
    <div id="readability-page-1" class="page"><div><p>The MTIA software (SW) stack aims to provide developer efficiency and high performance. It integrates fully with PyTorch, providing a familiar developer experience. Using PyTorch with MTIA is as easy as using PyTorch for CPUs or GPUs. The MTIA SW stack benefits from the flourishing PyTorch developer ecosystem and tooling. The compiler performs model-level transformations and optimizations using PyTorch FX IR and low-level optimizations using <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fllvm.org%2Fdocs%2FLangRef.html&amp;h=AT1RG2AWIAjulTbD7mAWT2HH5j_gmTVQMd7eLHvi6Ij0PD_KIcLR4VsF3MNVkXGLtVeU-017oVQDnluDgc6CGivkkWmhQXoqkqh8mP36EcP7MEyBRkUPO4mwqEBh8JE1FtIVqWSI04cS-iwP" rel="nofollow" target="_blank" data-lynx-mode="hover">LLVM IR</a>, with extensions to support the custom architecture and ISA of the MTIA accelerator.</p><p>The PyTorch runtime for MTIA manages on-device execution and features such as MTIA tensors, memory management, and the APIs for scheduling operators on the accelerator. The runtime and firmware perform communication to the accelerator device. The SW stack supports different modes of execution, such as eager mode and <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fpytorch.org%2Fblog%2Foptimizing-production-pytorch-performance-with-graph-transformations%2F&amp;h=AT228i7zMd_mn_lI2IlQSaXfj4KR0-csF79cWkU3Dvx3AXbbparDbkwG_99AoNFGlP80ii-sTLjUVfh1p0Lh5o7LEQTcRBKFc2R9N1YjmHcCn3hAfXZkFTZO5gVP6m7GMxDtYeLbcdTt00yd" rel="nofollow" target="_blank" data-lynx-mode="hover">graph mode</a>, and allows workloads to be partitioned across multiple accelerator cards. In the latter case, the SW stack also provides the necessary synchronization and communication between multiple accelerator boards.</p></div><p>The MTIA software stack.</p><div><p>There are multiple ways to author compute kernels that can run on the accelerator, including using PyTorch, C/C++ (for hand-tuned, very optimized kernels), and a new domain-specific language called KNYFE, which takes a short, high-level description of an ML operator as input and generates optimized, low-level C++ kernel code that is the implementation of this operator for MTIA.</p><p>Low-level code generation and optimizations leverage the open source LLVM compiler toolchain with MTIA extensions. The LLVM compiler then takes care of the next level of optimization and code generation to produce efficient executables that run on the processor cores within the PEs.</p><p>As part of the SW stack, we have also developed a library of hand-tuned and highly optimized kernels for performance-critical ML kernels, such as fully connected and embedding-bag operators. The higher levels of the SW stack can choose to instantiate and use these highly optimized kernels during the compilation and code generation process.</p><p>The MTIA SW stack continues to evolve with integration to <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Fpytorch.org%2Fget-started%2Fpytorch-2.0%2F&amp;h=AT1Tw-ThDwD3cQ_iurUY9Hri-bs2fYoEaChoD5dPmBBBuK46ad3Gbtj9mDEiAPVHtbT3KTrP2MvddYYYVpasxpL18adUxJi0E2dawcZqzOpUpYF26MgT9raQd_se5A4SWTBdyMz6qp-JBS7F" rel="nofollow" target="_blank" data-lynx-mode="hover">PyTorch 2.0</a>, which is faster and more Pythonic, yet as dynamic as ever. This will enable new features such as TorchDynamo and TorchInductor. We are also extending Triton DSL to support MTIA accelerators and using MLIR for internal representations and advanced optimizations. </p></div></div>
  </body>
</html>
