<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.zulip.com/2022/02/25/zulip-cloud-invitation-vulnerability/">Original</a>
    <h1>Zulip Cloud security vulnerability with reusable invitation links</h1>
    
    <div id="readability-page-1" class="page"><div id="site-main">
    <article>

        <header>

            <section>
                <a href="https://blog.zulip.com/tag/security/">Security</a>
            </section>

            


            <div>
                <section>
                    <ul>
                        <li>
                            <a href="https://blog.zulip.com/author/alex/">
                                <img src="https://www.gravatar.com/avatar/6040af6e26d481c0e5fd4ac2fe4ea460?s=250&amp;d=mm&amp;r=x" alt="Alex Vandiver"/>
                            </a>
                        </li>
                    </ul>
                    <div>
                        
                        <p><time datetime="2022-02-25">Feb 25, 2022</time>
                            <span><span>•</span> 1 min read</span>
                        </p>
                    </div>
                </section>
            </div>

        </header>

        <section>
            <!--kg-card-begin: markdown--><p>An internal investigation recently uncovered a vulnerability (identified as CVE-2022-21706) in Zulip’s invitation links. Specifically, a <a href="https://zulip.com/help/invite-new-users#send-invitations">reusable invitation link</a> could be used to join a different organization than the one it was created for. As a result, there was a potential for users to join any organization without an invitation (and bypassing <a href="https://zulip.com/help/invite-new-users#enable-email-signup">domain restrictions</a>).</p>
<p>This vulnerability was discovered by the Zulip security team, and has now been fixed for all Zulip Cloud organizations. It has been present since the first reusable invitation links were created in October 2017, though only a handful of such links existed before the menu option for creating them was introduced in February 2019.</p>
<p>It was also possible to use this vulnerability to join an organization with elevated permissions (e.g. in a moderator or administrator role). However, we are confident that there were no instances of this happening on Zulip Cloud.</p>
<h2 id="was-my-organization-was-affected-by-this-vulnerability">Was my organization was affected by this vulnerability?</h2>
<p>We have performed an extensive examination of all Zulip Cloud audit logs, and have identified 4 instances where it looks like users may have accidentally exploited this vulnerability. These users joined an organization for which they had a legitimate invite by accidentally using a <em>second</em> invitation not from that organization.</p>
<p><strong>Our investigation did not find any evidence that this vulnerability was ever discovered by someone outside the Zulip security team, or exploited on purpose.</strong> However, we have contacted all organizations for which our audit cannot prove conclusively that they were not affected. If you receive an email from us and your organization was invite-only at any point, we recommend reviewing the attached list of users to confirm that everything is as expected.</p>
<p><strong>If you administer a Zulip Cloud organization and do not receive an email from us today, your organization was not affected by this vulnerability.</strong></p>
<h2 id="parting-thoughts">Parting thoughts</h2>
<p>For self-hosted installations of Zulip, this vulnerability is fixed in the Zulip 4.10 release and discussed in the <a href="https://blog.zulip.com/2022/02/25/zulip-server-4-10-security-release/">release blog post</a>. Most self-hosted Zulip servers are not affected because they only host a single organization.</p>
<p>On behalf of Kandra Labs, I’d like to apologize for this security vulnerability. Keeping data that users have entrusted to us safe is the single most important thing we do, and we consider this category of incident unacceptable.</p>
<p>If you have any questions or concerns, or discover any unexpected accounts, please reach out to us at <a href="mailto:security@zulip.com">security@zulip.com</a>.</p>
<!--kg-card-end: markdown-->
        </section>


    </article>
</div></div>
  </body>
</html>
