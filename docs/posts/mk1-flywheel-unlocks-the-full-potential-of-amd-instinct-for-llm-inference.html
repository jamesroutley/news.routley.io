<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mkone.ai/blog/mk1-flywheel-amd">Original</a>
    <h1>MK1 Flywheel Unlocks the Full Potential of AMD Instinct for LLM Inference</h1>
    
    <div id="readability-page-1" class="page"><div id="siteWrapper">
      
        
      

      



















      <main id="page" role="main">
        
          
<article id="sections" data-page-sections="64b8303ac41a0b266f5cf399">
  
  
    
    


  


<section data-test="page-section" data-section-theme="white-bold" data-section-id="64b8303ac41a0b266f5cf39b" data-controller="SectionWrapperController" data-current-styles="{
&#34;imageOverlayOpacity&#34;: 0.15,
&#34;backgroundWidth&#34;: &#34;background-width--full-bleed&#34;,
&#34;sectionHeight&#34;: &#34;section-height--medium&#34;,
&#34;customSectionHeight&#34;: 10,
&#34;horizontalAlignment&#34;: &#34;horizontal-alignment--center&#34;,
&#34;verticalAlignment&#34;: &#34;vertical-alignment--middle&#34;,
&#34;contentWidth&#34;: &#34;content-width--wide&#34;,
&#34;customContentWidth&#34;: 50,
&#34;sectionTheme&#34;: &#34;white-bold&#34;,
&#34;sectionAnimation&#34;: &#34;none&#34;,
&#34;backgroundMode&#34;: &#34;image&#34;
}" data-current-context="{
&#34;video&#34;: {
&#34;playbackSpeed&#34;: 0.5,
&#34;filter&#34;: 1,
&#34;filterStrength&#34;: 0,
&#34;zoom&#34;: 0,
&#34;videoSourceProvider&#34;: &#34;none&#34;
},
&#34;backgroundImageId&#34;: null,
&#34;backgroundMediaEffect&#34;: null,
&#34;divider&#34;: null,
&#34;typeName&#34;: &#34;blog-alternating-side-by-side&#34;
}" data-animation="none">
  
  <div>
    <div>
      
      
      
      
      
      
      <div data-content-field="main-content" data-item-id="">
  <article id="article-">
  
    <div>
      

      <div>
        <div><div data-layout-label="Post Body" data-type="item" id="item-658df418b8869920dc8d49c0"><div><div><div data-block-type="2" id="block-yui_3_17_2_1_1704218286521_10924"><div>

<div>
  <h2>Summary</h2><p>With the release of our new inference engine MK1 Flywheel, we are excited to report that AMD Instinct Series can achieve comparable performance to a compute-matched NVIDIA GPU. We&#39;ve designed MK1 Flywheel for maximum performance on AMD and NVIDIA hardware: our benchmarks demonstrate up to 3.7x higher throughput compared to vLLM.</p>
</div>




















  
  



</div></div><div data-block-type="5" id="block-yui_3_17_2_1_1704233801889_10521"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png" data-image="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png" data-image-dimensions="1224x1005" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png" width="1224" height="1005" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/7de6883e-6569-4313-90cc-e022d9bdc75f/Blog+Charts+-+IQ70+%283%29.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

                
            </p>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1703802076508_12216"><div>

<div>
  <h3>AMD Enters AI Market with Instinct Series Accelerators</h3><p>The 2023 holiday season marked a significant milestone for the AI community with the launch of AMD’s eagerly anticipated Instinct MI300 series accelerator, showcasing their advanced CDNA 3 architecture. On paper, the MI300 has the potential to challenge NVIDIA’s market dominance for cloud AI workloads, bringing hope for genuine performance competition and leveling the playing field. AMD’s Achilles heel up to this point has been its lagging software ecosystem, however, recently there have been inroads into natively supporting AMD hardware on popular AI frameworks.</p>
</div>




















  
  



</div></div><div><div><div data-block-type="5" id="block-yui_3_17_2_1_1703802231758_3467"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png" data-image="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png" data-image-dimensions="1327x585" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png" width="1327" height="585" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 66.66666666666666vw, 66.66666666666666vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/f0533956-b983-471e-a5e0-91c9821f2786/Screenshot+2023-12-28+at+2.25.21%E2%80%AFPM.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

                
            </p>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div></div></div><div data-block-type="2" id="block-yui_3_17_2_1_1703802231758_5288"><div>

<div>
  <p>Once we realized what the AMD Instinct series cards were capable of, we challenged ourselves to port our LLM inference engine MK1 Flywheel to AMD. Having just achieved the best inference performance on NVIDIA hardware (see <a href="https://mkone.ai/blog/mk1-flywheel-race-tuned-and-track-ready">our companion post</a>), we rolled up our sleeves and got to work.</p><p>To jump straight to the conclusion: we believe that with Flywheel, AMD looks to be a force to be reckoned with. For now, our results are on the AMD Instinct MI210, and we are excited to benchmark on MI300 as they become widely available.</p><h3>How does AMD Stack Up to NVIDIA? </h3><p>Before we take you through our journey with AMD Instinct and ROCm, let&#39;s start with the results. </p><p>For reasons explained later on, we profiled the AMD Instinct MI100 and MI210 cards, and here focus on the newer MI210 for comparison. On the NVIDIA side, we chose the RTX A6000 since it has a similar hardware specification based on TFLOPS, memory and power. </p>
</div>




















  
  



</div></div><div data-block-type="23" id="block-yui_3_17_2_1_1703804955513_6798"><div><center>
<table>
<thead>
<tr>
<th></th>
<th>AMD Instinct MI100</th>
<th>AMD Instinct MI210</th>
<th>NVIDIA RTX A6000</th>
</tr>
</thead>
<tbody>
<tr>
<td>Architecture</td>
<td>CDNA 1</td>
<td>CDNA 2</td>
<td>Ampere</td>
</tr>
<tr>
<td>FP16 TFLOPS</td>
<td>184.6</td>
<td>181</td>
<td>154.8</td>
</tr>
<tr>
<td>Power</td>
<td>300 W</td>
<td>300 W</td>
<td>300 W</td>
</tr>
<tr>
<td>Memory</td>
<td>32GB HBM2</td>
<td>64GB HBM2e</td>
<td>48GB GDDR6</td>
</tr>
</tbody>
</table>
</center></div></div><div data-block-type="2" id="block-yui_3_17_2_1_1704576951001_27949"><div>

<div>
  <p><em>Inference performance for MK1 Flywheel and vLLM  (v0.2.6) for Llama-2-13B. The benchmarks measure the throughput (requests/second) against average latency (end-to-end round trip time to service the request) across an increasing number of asynchronous workers (mimicking users) for a given input prompt and output generation distribution. Typical distribution (left) has a max token context of 960 and max token generations of 80; Long prompt distribution (right) has max token context of 1800 and a max token generation of 120. </em></p><p>The results are clear: MK1 Flywheel on an AMD Instinct MI210 now rivals a compute-matched NVIDIA GPU (also running Flywheel). Moreover, Flywheel shows higher throughput across all tested workloads on both AMD and NVIDIA compared to vLLM. The increased performance translates into significant cost savings as the same GPU instance can now service more users. </p><p>For clients considering using AMD Instinct for LLM inference workloads at scale, <strong>please reach out.</strong></p><h3>Recap of MK1 Flywheel</h3><p>In <a href="https://mkone.ai/blog/mk1-flywheel-race-tuned-and-track-ready">our companion post</a>, we introduced MK1 Flywheel, our enterprise LLM inference engine built for real-world enterprise applications. Working with our early adopters, we forged a performant inference solution that is now in commercial use servicing millions of active users for LLM chat applications. As a quick recap, Flywheel has</p><ol data-rte-list="default"><li><p>Unparalleled Throughput vs Latency characteristics.</p></li><li><p>Rapid auto scaling for optimized scaling up of inference on cloud platforms.</p></li><li><p>For enterprise customers: seamless integration into your stack with native PyTorch compatibility, and a drop in replacement for inference backends like vLLM, TensorRT-LLM or Hugging Face TGI. </p></li></ol><p>You can take Flywheel for a spin on <a href="https://aws.amazon.com/marketplace/seller-profile?id=seller-wkonsb76xsee6"><strong>AWS SageMaker</strong></a><strong>. </strong>Currently it runs on NVIDIA backend, and we look forward to offering Flywheel on AMD backends.</p><p>Next up, we want to give you a behind-the-scenes journey of building the hardware and software components that brought Flywheel to life on AMD. Hope you have as much fun reading it as we had doing it!</p>
</div>




















  
  



</div></div><div data-block-type="5" id="block-yui_3_17_2_1_1703804286743_5680"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg" data-image="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg" data-image-dimensions="4080x3072" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg" width="4080" height="3072" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=100w 100w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=300w 300w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=500w 500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=750w 750w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/2da86353-b055-44b9-89bf-3f36a84baac4/PXL_20231229_002906175.jpg?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

                
            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p><em>Our first chimera system with AMD Instinct MI100 for AI acceleration, NVIDIA TitanX for video output and Intel Xeon CPU. The MI100 is cooled with a Silverstone FHS 80X mounted on a 3D printed fan hood.</em></p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1703804286743_15230"><div>

<div>
  <h3>Our Journey: Building out the Hardware</h3><p>Our early exploration of the AMD Instinct series began with the harsh reality check that these cards aren’t ubiquitous across cloud platforms (for now). In order to chalk up a quick existential proof, we grabbed an MI100 (CDNA 1 architecture) from the bargain bin on eBay. The exercise was fairly touch-and-go at the start. Since the card does not have active cooling, we jury-rigged a 3D-printed fan hood onto the card to boot the card on our typical workstation desktops. Once everything was plugged in, only then did we realize that the system had no video output! Fortunately, we rummaged a relic in the form of an NVIDIA TitanX, and strapped it in. The workstation was rounded out with an Intel Xeon CPU, for reasons that will require its own blog post. Once we had this chimera of a system up and running, the absurdly loud high-static pressure fan did nothing to curb our enthusiasm when we generated text off a LLama-2-7B. We have come a long way since then.</p><p>A few weeks later we were able to land an MI210 (CDNA 2 architecture). With the lessons learned from the MI100, we had it up and running in no time!</p><h3>Our Journey: Building out the Software</h3><p>AMD has truly stepped up their game on their ROCm software stack over the past year, and it shows. We now have tight integration into bread and butter AI frameworks like PyTorch and TensorFlow. And, for the first time, you can effortlessly run LLMs right off of Hugging Face with a few lines of python. </p><p>As we designed MK1 Flywheel for the NVIDIA platform, we learned priceless lessons along the way and grew the intuition and engineering necessary to distinctly push NVIDIA GPUs to their limits. Energized by the momentum we saw on the AMD platform and community, we challenged ourselves to put our theories and engineering to the test. Once again, staying true to our performance-obsessed nature, we took no shortcuts and built the framework backend from first principles for the AMD stack.</p><p>While the interesting idiosyncrasies of the CDNA architecture flavored our ROCm kernel stack to be understandably different from our CUDA stack, the fundamentals that unlocked the true potential of the GPU hardware remained consistent. To start, we had to grok the CDNA architecture and its history (GCN - Graphics Core Next), alongside the complementary graphics-forward RDNA architecture. In parallel, we had to discover the strengths and limits of the compiler, especially on a compute pipeline that relies on instruction counting. Certain system-level techniques like optimized kernel scheduling worked right away due to being platform agnostic by nature. However, all core device kernels that used platform-specific features (say, NVIDIA Tensor Cores) had to be written from scratch to use the equivalent on the AMD hardware (AMD Matrix Cores).</p><p>In our experience so far, ROCm is in great shape to build <em>functional</em> kernels right off the bat on AMD hardware. Yet, to extract the most out of the CDNA architecture, we&#39;ve had to go full manual, in comparison to our experience with CUDA. In all fairness, this can be marked up to the fact that NVIDIA has had a significant head start with CUDA for AI workloads. We believe what our work demonstrates, is that after equalizing the playing field on the software front with MK1 Flywheel, the AMD Instinct Series is a serious contender for today’s cloud inference workloads. We are excited to continue developing on ROCm, and extending Flywheel for MI300, as well as further optimizing for finetuning and training workloads. </p><h3>Results: MK1 Flywheel on AMD Instinct MI210 and MI100 </h3><p>We further benchmarked Flywheel on AMD Instinct across Mistral-7B and Llama-2-13B for various workloads. These results confirm that Flywheel has excellent performance across different LLM use cases.</p>
</div>




















  
  



</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1704576951001_125452"><div>

<div>
  <p><em>Inference performance for MK1 Flywheel and vLLM  (v0.2.6) for popular models. Data distribution characteristics are described further in </em><a href="https://mkone.ai/blog/mk1-flywheel-race-tuned-and-track-ready"><em>our companion post</em></a><em> . MI100 measurements are only provided for MK1 Flywheel, since vLLM does not officially support the CDNA 1 architecture.</em></p><h3>Dev Notes for ROCm</h3><p>There are a few things that we do miss from the CUDA stack. For example, the tight-loop performance debugging afforded by NVIDIA Nsight Compute was invaluable as we developed our inference stack for NVIDIA. Omnitrace and Omniperf on the ROCm stack got us some of the way but weren’t as polished as their counterparts. The documentation could use some love as well, as our current experience working on the ROCm stack was like driving a stick shift. On the plus side, the fact that ROCm toolkit and the AMD LLVM project are entirely open source allowed us to parse the true nature of the hardware and build design patterns. Conversely, CUDA is entirely closed.</p><p>The ROCm platform offers <a href="https://github.com/ROCm/HIPIFY">HIPIFY</a>, a convenient utility that converts CUDA code to cross-platform HIP code. However, to extract the most out of the CDNA architecture, we couldn’t “<em>hipify</em>” our CUDA kernels tuned for current NVIDIA architectures. This is where our efforts of building a framework from first principles really paid off, as we applied our learnings and theories onto the new architecture and reaped the results. </p><h3>What&#39;s next?</h3><p>The journey has only begun, and there is a lot more work to be done. Despite the VRMs screeching for their dear lives, the GPUs are not on fire… yet. As indicated in <a href="https://mkone.ai/blog/mk1-flywheel-race-tuned-and-track-ready">our companion post</a>, there are a good deal of stack optimizations left on the table in order to maximize inference performance. MK1 Flywheel aims to be platform agnostic, offering performance parity across GPUs with similar hardware specifications, i.e. <em>you will get your TFLOPs worth</em>. This opens up a wider range of cloud hardware platforms and economic mobility to serve your inference applications, while retaining the familiar frontend and user experience. For users planning enterprise deployments, we have different options for integrating MK1 Flywheel natively into your production stack, regardless of platform. <a href="https://mkone.ai/contact"><strong>Don&#39;t hesitate to reach out!</strong></a></p><p>We are eager to explore the MI300X accelerator, and in theory, MK1 Flywheel should perform out-of-the-box for CDNA3, as we have prepared for it. The bigger hurdle is access to the new hardware. The MI300A APU has us looking forward to the converged strength of the Zen4 CPU and CDNA3 GPU.</p>
</div>




















  
  



</div></div><div data-block-type="5" id="block-yui_3_17_2_1_1704517194203_200852"><div>










































  

    
  
    <div data-test="image-block-inline-outer-wrapper">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png" data-image="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png" data-image-dimensions="2172x1430" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png" width="2172" height="1430" alt="" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" onload="this.classList.add(&#34;loaded&#34;)" srcset="https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/64b82ec2cac59465c6dd7813/c9bc323b-2bbc-4edd-b3f8-182d89d5a565/troll_guard.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs"/>

                
            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>Inference performance on the NVIDIA A100 and AMD Instinct MI210 with MK1 Flywheel and vLLM v0.2.6</p>
          </figcaption>
        
      
        </figure>
      

    </div>
  


  


</div></div><div data-block-type="2" id="block-yui_3_17_2_1_1704517194203_204206"><div>

<div>
  <p>A <a href="https://embeddedllm.com/blog/vllm_rocm/">post from EmbeddedLLM dated Oct-27-2023</a> claims that AMD Instinct MI210 achieves LLM inference parity with the NVIDIA A100. There seems to be an unexplained discrepancy, considering that the NVIDIA A100 has 312 TFLOPS compared to the 181 TFLOPS of the Instinct MI210. In contrast, MK1 Flywheel achieves a proportional increase in performance on the A100 which has 1.7x the horsepower of the Instinct MI210, which can be seen in Throughput vs Latency comparisons. </p><p>We believe the EmbeddedLLM results may simply be out-of-date as an older version of vLLM (v0.1.4) was used as the base to develop ROCm support, and may not have included performance improvements from more recent versions. As of <a href="https://docs.vllm.ai/en/latest/getting_started/amd-installation.html">v0.2.4</a>, vLLM natively supports AMD Instinct MI200 series GPUs.</p>
</div>




















  
  



</div></div></div></div></div></div>

        

        
        
          
        
      </div>

      
    </div>
  
</article>

</div>
    </div>
  
  </div>
  
</section>

  
</article>


          

          
            
              

            
          
        
      </main>
      

      
        

      
    </div></div>
  </body>
</html>
