<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/marcan42/status/1494213855387734019">Original</a>
    <h1>Apple&#39;s custom NVMes are amazingly fast â€“ if you don&#39;t care about data integrity</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-24078" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213855387734019" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="28" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:18.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:18.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213855387734019" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213855387734019" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__mkm5xk931dc id__erzgq7bm1dd id__fk3gwkhxoev id__wdoym2z60y id__rp3rmmubp5a id__nc3vpnws5wl id__rhsvipm97nr id__ol6ukrr31c id__11bwxgdcn5ua id__293s8xukze7 id__k61vv7xyajo id__9rtphri5tsa id__6z3o49nkjeb id__yds7p3zwlqa" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__nc3vpnws5wl"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody"><div><p><span>Well, this is unfortunate. It turns out Apple&#39;s custom NVMe drives are amazingly fast - if you don&#39;t care about data integrity.

If you do, they drop down to HDD performance. Thread.</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213859594616834" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:19.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:19.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213859594616834" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213855387734019" itemprop="isPartOf"/><div><article aria-labelledby="id__p0arvou1k1g id__q9hgxdm1khe id__q20e27r5xe8 id__r8z9j8fx9am id__ac94z777joe id__82zdbqb7qg7 id__plpvjlljrmq id__s2l723idt1 id__3rdfw575vhs id__9l1d0mpkn37 id__tgpxdgj8uv8 id__eiiok72hi0g id__7zmn7whgumk id__wxgdxocf9bl" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__82zdbqb7qg7"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>For a while, we&#39;ve noticed that random write performance with fsync (data integrity) on Asahi Linux (and also on Linux on T2 Macs) was terrible. As in 46 IOPS terrible. That&#39;s slower than many modern HDDs.

We thought we were missing something, since this didn&#39;t happen on macOS.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213862970707969" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="8" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:20.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:20.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213862970707969" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213859594616834" itemprop="isPartOf"/><div><article aria-labelledby="id__3yz4elq7iqx id__v72ugptpfy id__bj7sf0qttgv id__urbue6u5qsm id__7ezwyeftuhl id__g9rfvsegyf9 id__84ptxl2vrpw id__figt2aurgu id__orc2z9mj549 id__3vd4rviemay id__jt8gqclhyo id__vucolfoj id__ai1ccn6iwg9 id__wmsx9gl5uub" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__g9rfvsegyf9"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>As it turns out, macOS cheats. On Linux, fsync() will both flush writes to the drive, and ask it to flush its write cache to stable storage.

But on macOS, fsync() only flushes writes to the drive. Instead, they provide an F_FULLSYNC operation to do what fsync() does on Linux.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213865613426688" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:21.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213865613426688" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213862970707969" itemprop="isPartOf"/><div><article aria-labelledby="id__7vjpqvsoekk id__vy6u40fk8ea id__q8uqsp256jh id__qzr481b4eu id__k22qoepppv id__oe6pqa58gr id__v1q5mel3qe9 id__o77bqzuvq9 id__scgg8u665z id__hj8vzgs753 id__m2wzp18bfuc id__vifegnid4t id__ggoi6ak9zdv id__yo3uusvpcyc" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__oe6pqa58gr"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So effectively macOS cheats on benchmarks; fio on macOS does not give numbers comparable to Linux, and databases and other applications requiring data integrity on macOS need to special case it and use F_FULLSYNC.

How bad is it if you use F_FULLSYNC? It&#39;s bad.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213868201324546" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:21.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213868201324546" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213865613426688" itemprop="isPartOf"/><div><article aria-labelledby="id__6b38gyxsg03 id__4ptftidjklw id__gfjd12bb4mp id__61rjfdsh02m id__njaqdmjt46s id__cguezohcycv id__bwgv1d17h5 id__pzf8i1txi59 id__b5293gzai4l id__9xlgml9cuwe id__yk6bd8xmji id__zcxrdgwjz6 id__vy5gf7rsqtl id__nzvwnzl2w5" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__cguezohcycv"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Single threaded, simple Python file rewrite test:

Macbook Air M1 (macOS):
- flushing: 46 IOPS
- not: 40000 IOPS

x86 iMac + WD SN550 1TB NVMe (Linux):
- flushing: 2000 IOPS
- not: 20000 IOPS

x86 laptop + Samsung SSD 860 EVO 500GB SATA:
- flushing: 143 IOPS
- not: 5000 IOPS</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213871149940737" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:22.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213871149940737" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213868201324546" itemprop="isPartOf"/><div><article aria-labelledby="id__co59pg3htgd id__b8eaq0m9gsk id__y2zulxqjph id__o3pz77118co id__m63vk9g4t9p id__kn207me1n1r id__og8frsufuk id__jlmkjn5nnk id__fwh22vtb1cf id__of9hn4mgh6 id__zdgt0lwxnt id__2e4lv8rflp8 id__8v2ua03843j id__ypfpd8l6u0h" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__kn207me1n1r"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So, effectively, Apple&#39;s drive is faster than all the others without cache flushes, but it is more than 3 times slower than a lowly SATA SSD at flushing its cache. Even if all you wrote is a couple of sectors. You pay a huge flush penalty if you do *any* writes.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213873993682946" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:23.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213873993682946" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213871149940737" itemprop="isPartOf"/><div><article aria-labelledby="id__bq8n74ifwta id__eqjvalmascs id__b77esai0uf id__nq2wg3qijis id__whhkwtin0a id__x5icabc40z id__oa11uazumgq id__e46j2grsci id__gzyzl7pc904 id__yps55yrxc2k id__r74druijl4j id__vimfif1qmmk id__ok78xr663oc id__5bshhc2ucsr" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__x5icabc40z"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Here, &#34;flushing&#34; on macOS means F_FULLSYNC and &#34;not&#34; means fsync(); on Linux both are fsync(), but &#34;not flushing&#34; is measured by telling Linux that the drive write cache is write-through (which stops it from issuing cache flushes).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213876657049600" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:24.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:24.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213876657049600" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213873993682946" itemprop="isPartOf"/><div><article aria-labelledby="id__h2u5das6saa id__jrmewbtl2m id__seslhj6gx8 id__qou99vvn3f id__75aav0o61kp id__3lk0gk9o9cl id__olmg9z0m12k id__h2ph31vxt6l id__lg8z3r2hoxr id__h7i8ym8ozxi id__sg8mj7shkaq id__jkgq9ejuxba id__vnlkks0qrs id__1zf4n6zh6z7" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__3lk0gk9o9cl"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Note that the numbers are filesystem-dependent (and encryption makes things more complicated); e.g. the SATA SSD numbers double on VFAT vs. my root filesystem (ext4 on LVM on dm-crypt), but the pattern is clear.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213879089737729" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="4" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:24.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:24.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213879089737729" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213876657049600" itemprop="isPartOf"/><div><article aria-labelledby="id__hhu5lplqo3c id__yc27pqss5z id__kcxl2jupms id__xbxxkao0xrb id__bntwt1hi0lt id__sz4vtb7c45 id__wqqxalewzo id__3n9dy6tqin6 id__z0xb0o6ff9 id__m7n3ekapzyc id__sgij49155wc id__6d588wya1k id__rekumkvc2q id__ldv6y7ucwwc" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__sz4vtb7c45"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>macOS doesn&#39;t even seem to try to proactively issue syncs; you can write a file on macOS, fsync() it, wait 5 seconds, issue a hard reboot (e.g. via USB-PD command), and the data is gone. That&#39;s pretty bad.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213881509875712" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="8" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:25.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213881509875712" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213879089737729" itemprop="isPartOf"/><div><article aria-labelledby="id__i81xf6pei6 id__8tpgh3j4gd id__d0gb5ps8mu id__rvql8wy0bpq id__6yocqibch1d id__jihi6l29h8a id__x8i7ljpdrt id__qkq3vhobdj id__kkpwd61xh9d id__gwrozqfjk86 id__2hoqn9eazl9 id__vvvmd23v87 id__vfh2113spg id__t1brwg4iz1" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__jihi6l29h8a"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Of course, in normal usage, this is basically never an issue on laptops; given the right software hooks, they should never run out of power before the OS has a chance to issue a disk flush command. But it certainly is for desktops. And it&#39;s a bit fragile re: panics and such.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213883976101888" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:25.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213883976101888" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213881509875712" itemprop="isPartOf"/><div><article aria-labelledby="id__zxclc9waasb id__kollav34c7 id__zv8c87y794f id__i5rt5rr42ff id__zi92mnphbs id__cyg5qio7t67 id__9ly6mmmtt6 id__e489zq792uv id__ajkgutqx52l id__lgnt2yu8p9 id__c91sludk2al id__2ltfoc2tb9a id__dbplzq4y2 id__xk982vzyciq" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__cyg5qio7t67"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Unfortunately, this manifests itself as quite visible issues on Linux. For example, apt-get on Asahi Linux is noticeably slow. Making fsync() not really flush on macOS is not fair; lots of portable software is written to assume fsync() means your data is safe.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213886928908288" itemprop="identifier"/><meta content="12" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:26.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:26.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213886928908288" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213883976101888" itemprop="isPartOf"/><div><article aria-labelledby="id__kk09ox3n91 id__76obm3vp9zx id__oxbkchkk1j id__rg41qf83ap id__vz59d1cb8ce id__1s1e0suxqqni id__sxig08h00q id__b9wmijbbsjj id__344vus0ew9i id__dk80kmiazi id__8pgqtj3qz8x id__4rxqnkq2ohl id__7hpa8w3eyuo id__5ycf2g6g4h" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__1s1e0suxqqni"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Our current thinking is we&#39;re going to add a knob to the NVMe driver to defer flush requests up to a maximum time of e.g. 1 second. That would ensure that a hard shutdown never loses you more than 1 second of data, which is better than what macOS can claim right now.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213889646796802" itemprop="identifier"/><meta content="13" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:27.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213889646796802" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213886928908288" itemprop="isPartOf"/><div><article aria-labelledby="id__7k2hqiqhkin id__zf18onoibhk id__efq64mfpd0a id__m74elxidf2 id__9xelczt27v id__490z6ys3sxg id__etmu7zeqwwh id__j3qyi6lonpa id__ezrvj5xd45 id__3ndm8emaoca id__hj5nysmjdd id__es5uxy524m4 id__cz41kfnngz4 id__n1hac61nu1m" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__490z6ys3sxg"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Alas, that&#39;s still not quite safe. Not flushing means we cannot guarantee ordering of writes, which means you could end up with actual data corruption in e.g. a database, not just data loss. There&#39;s no good way around this other than doing full flushes.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213892331163649" itemprop="identifier"/><meta content="14" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:27.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213892331163649" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213889646796802" itemprop="isPartOf"/><div><article aria-labelledby="id__ifnls51lkf id__cxs0apo5txn id__emom7gtxotq id__tq62dpnl9i id__3nuw7mjdbje id__gzr83yc16oi id__mlsn1s04vs id__vk65yobkner id__7yai9ff2oj6 id__r7ger2kluv id__p0l76l8qa7 id__lbff8uvdkbq id__moen4cdpy3g id__4cq3nlim7dy" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__gzr83yc16oi"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So the unfortunate conclusion is that if you&#39;re e.g. running a transactional database on Apple hardware, and you need to be able to survive a hard poweroff without data corruption, you&#39;re never going to get more than ~46 TPS.

Unless Apple improves their ANS firmware to fix this.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494215160218939392" itemprop="identifier"/><meta content="15" itemprop="position"/><meta content="7" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:40:30.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:40:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494215160218939392" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213892331163649" itemprop="isPartOf"/><div><article aria-labelledby="id__k212syy5ku id__vs58njnbk7j id__1mkcqtbswoj id__9lxkm5w06yc id__rhzfd8oy09 id__ca9v6ki52yp id__rylu3jbqdno id__dxcf1m96s45 id__fs2ekxzigre id__7jmf52cgnzh id__y8ywxynelna id__g20k0nzb9yn id__x7a51ge66os id__x5ec2wqwvhk" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__ca9v6ki52yp"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>And for what it&#39;s worth, I inadvertently triggered a data consistency issue in macOS while testing this. Before running any tests I had GarageBand open. I closed it without saving the open project. After the first hard reboot later, it tried to reopen it and threw up an error.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494215321125007362" itemprop="identifier"/><meta content="16" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:41:08.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:41:08.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494215321125007362" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494215160218939392" itemprop="isPartOf"/><div><article aria-labelledby="id__yj7kqupa88p id__rqhu709nes9 id__3oejqmgmq7d id__7htfb79ujic id__ljw4xeawp2 id__etba6p0bm9d id__0xjeu0uwwd8 id__gho4ffrsj7 id__4nu8clg2e98 id__gznm8rae4k5 id__lrg3vwvz1x id__dxqtf8dafxr id__g9anaerou2j id__mjq4upxeul" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__etba6p0bm9d"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So I guess the unsaved project file got (partially?) deleted, but not the state that tells it to reopen the currently open file on startup.

Data consistency matters.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494221053220257795" itemprop="identifier"/><meta content="17" itemprop="position"/><meta content="10" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T08:03:55.000Z" itemprop="dateCreated"/><meta content="2022-02-17T08:03:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494221053220257795" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494215321125007362" itemprop="isPartOf"/><div><article aria-labelledby="id__hlpf8teomr id__yk1ktq4n2hk id__meuavsma6k8 id__dti29hkl7pm id__eavcvap7bpa id__9z016kkjzk id__ju8z6p0cby id__qq8v7i0hmh id__34eb0nu1bvx id__k74ctmff5sb id__7ggslc5yuuy id__bolm3485wea id__nd8xtw56pjb id__52v5qlz9bz8" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__9z016kkjzk"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Update: tested on the Mac Mini by pulling the plug (which is a &#34;normal&#34; case; the USB-PD thing was a bit special). Still lost seconds of fsync()ed data. There is no (working) last-gasp flush mechanism.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494255642202484743" itemprop="identifier"/><meta content="18" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:21:21.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:21:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494255642202484743" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494221053220257795" itemprop="isPartOf"/><div><article aria-labelledby="id__99b1rge3hy8 id__sghussqbfbb id__3fe9ezobiwr id__gd1xae8xe6h id__ec04yzjd09s id__7mgvi3vxgzl id__bym3xya35om id__mv0uyqxfvk8 id__el0jm3uyl id__gi1fdzfct25 id__bcqj2657hv9 id__q7rqh6uch4e id__392jhztj2x6 id__zrr98s5l2n" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__7mgvi3vxgzl"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Further testing: doing this on FAT32 (to avoid APFS write amplification, which is a separate problem...) doesn&#39;t help with the IOPS on flush, but then I can look at powermetrics bandwidth stats to see what NVMe is doing.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494255645612474369" itemprop="identifier"/><meta content="19" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:21:22.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:21:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494255645612474369" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494255642202484743" itemprop="isPartOf"/><div><article aria-labelledby="id__vaiew7m2juo id__7ojythbhpzc id__umps3hb3xq id__c481acu3ac7 id__pmbps2up73 id__8v5x1qad78e id__97a4ser5fy8 id__0gtsbyuxraes id__ld0r76pp72i id__ywupn4kg8l8 id__zko72g6on2i id__7795zszq968 id__rxigtmtmu7j id__uczns9jxkll" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__8v5x1qad78e"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Artificially throttled ~30 IOPS without full cache flushes, I get 93.52 ops/s 397.77 KBytes/s disk IO, which is reasonable, and:

ANS2 RD                         : 0.328 MB/s
ANS2 WR                         : 0.399 MB/s

That&#39;s NVMe controller DRAM bandwidth. Reasonable.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494255649026625537" itemprop="identifier"/><meta content="20" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:21:23.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:21:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494255649026625537" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494255645612474369" itemprop="isPartOf"/><div><article aria-labelledby="id__do1ddra25r id__c7nzy516r7 id__xx75di6usba id__rom3donsic id__enkutpljigk id__ht7misz12u id__gft5dmt4trl id__4j8zgagzl89 id__2d184kxib34 id__rsir23919x id__u3todaolcc id__ccbaeupswm8 id__43bwwvdtbsi id__n7k0xqrkcj" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__ht7misz12u"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>But doing flushes, this jumps to:

ANS2 RD                         : 6.248 MB/s
ANS2 WR                         : 9.909 MB/s

So that NVMe controller is doing *something* memory-intensive on flush commands. Maybe it does a linear scan over a large cache hashtable?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494256049150640129" itemprop="identifier"/><meta content="21" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:22:58.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:22:58.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494256049150640129" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494255649026625537" itemprop="isPartOf"/><div><article aria-labelledby="id__hvgjax6ovbu id__jbj5r12s84p id__dntpklrsrr5 id__zbduvjiuzn id__vz62gwrqoi id__zpb59r8wle id__iu9tk5h0rkc id__pwnav9wbhtf id__hz1hi81l09n id__pnqaqs81znc id__sr257znqqt id__oftdgzbwops id__u1pohsoj5i id__pl7b8x5kp9p" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__zpb59r8wle"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>I can get these stats because the NVMe controller is integrated into the SoC and &#34;drive cache&#34; is just normal memory (it&#39;s unified just like GPU memory), and Apple have very good instrumentation of things like DRAM bandwidth utilization from different SoC agents.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293060020506626" itemprop="identifier"/><meta content="22" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:02.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:02.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293060020506626" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494256049150640129" itemprop="isPartOf"/><div><article aria-labelledby="id__2qtjh6rhlbe id__qq32vf3i5pp id__acz9zliz0qc id__e8zzuc7nrvt id__ubwn5oxq0to id__s3duqtv13be id__bpz5bmf2d5h id__x4mln81hq7 id__79nj6ugrm9t id__746610tgo6 id__psfnyruo0wb id__htnakpmgvt id__h4ljvcu4b8i id__c60vwnhyrgv" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__s3duqtv13be"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Uh, guys? I&#39;m not saying &#34;the machines are only fast because they cheat on data durability&#34;. I&#39;m saying there&#39;s a stupid, unfortunate performance bug when you *do* want durability that most people won&#39;t notice because macOS gives you poor durability by default.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293064579686400" itemprop="identifier"/><meta content="23" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:03.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293064579686400" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293060020506626" itemprop="isPartOf"/><div><article aria-labelledby="id__xlao6cz1j6 id__4a7iz2e27t6 id__91oju1inxso id__l9gm3ye2zl id__djnm1joi9gl id__gzrfwrdbhqt id__23q32h1bz23 id__g3bpbczsdg id__ju7cgxvs8nm id__lrronvlxlng id__1hkm11b3stm id__8vizsjplsbc id__um12kdgcy1 id__uzs1icgd6b" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__gzrfwrdbhqt"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>These SSDs are still fast for many use cases, and on laptops you don&#39;t care about this issue because there&#39;s a battery backup anyway.

And besides, Apple can almost certainly fix this in a firmware upgrade.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293067771564040" itemprop="identifier"/><meta content="24" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:04.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:04.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293067771564040" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293064579686400" itemprop="isPartOf"/><div><article aria-labelledby="id__27wd5s8et6n id__uugc2mc887 id__gowkv1rsc36 id__2flli2t2wpz id__fy7rpkzttka id__5qbu41xhjhm id__57jxvkli2wk id__iojl0cvxiyg id__9agpm2z7ay id__8v5z6hlq96t id__30cpaidf8le id__mmmwsatvq8l id__v3h4koha46h id__y9skkxqjfmb" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__5qbu41xhjhm"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Chances are this happened because this design came from iDevices, where there&#39;s always a battery, so software will never hit drive cache related consistency/durability issues, so probably ~no iOS software ever uses a full sync, so nobody noticed it&#39;s slow.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293071118614529" itemprop="identifier"/><meta content="25" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:05.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:05.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293071118614529" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293067771564040" itemprop="isPartOf"/><div><article aria-labelledby="id__p2umhjmdawi id__fg06rc0kzpq id__ln0hr1fu4mo id__rbbbhg4vot id__uhc5cj3g2os id__0zoo54ljx2jb id__bs0981mmfm id__88k50l3la97 id__5uoh5d72ko5 id__crusjhge3wv id__bfs1bpjna1g id__yz91mzho238 id__nl8ncv3lpsg id__db8xu0r0khs" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__0zoo54ljx2jb"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>And I&#39;m just the Nth guy to facepalm when I found out that macOS makes data durability double-opt-in with a nonstandard request. That&#39;s dumb, but it has nothing to do with the machines. It&#39;s just the reason why fio was magically fast on macOS and not on Linux.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293769134690305" itemprop="identifier"/><meta content="26" itemprop="position"/><meta content="4" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:52:51.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:52:51.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293769134690305" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293071118614529" itemprop="isPartOf"/><div><article aria-labelledby="id__zd6d4u97et id__e73qt6iapwh id__jyqr8kj8yg id__sp0o7cqf3f id__sb5ze3i1djh id__md39aiuri79 id__cetjp8ajfzr id__of06bruofc id__5nwut3uqjnm id__671ftyg5f4c id__wzfwnayv1e id__1p51wtaeflh id__7k33xudo41t id__pfta1eoqmyk" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__md39aiuri79"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Note that the NVMe controller behaves in a perfectly spec-compliant way as far as data durability. It&#39;s just (ridiculously) slow when you ask for it. Probably a bug.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494307439906533376" itemprop="identifier"/><meta content="27" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T13:47:11.000Z" itemprop="dateCreated"/><meta content="2022-02-17T13:47:11.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494307439906533376" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293769134690305" itemprop="isPartOf"/><div><article aria-labelledby="id__21grwlwta6nj id__iqfqyl0f6e id__iw7m11m6js id__jpet21po01 id__wikbc5r7fog id__2olg4uw168v id__jeqbg6jugwk id__3jf95oovtmd id__37qgp2ctw8d id__x5k261drlyg id__wu4cmva96qi id__4f8wpuqn4nu id__68wqn0az0wg id__c77q1ycrce" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__2olg4uw168v"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>But since incessant people on HN made me do another test, and for giggles:

FAT32 on internal NVMe with F_FULLFSYNC: 58 IOPS
FAT32 on a cheapo USB3 flash drive with the same: 223 IOPS.

If you run a durable database on an M1 today, try a cheap flash drive. It&#39;ll be faster :-)</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494307794182631424" itemprop="identifier"/><meta content="28" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T13:48:35.000Z" itemprop="dateCreated"/><meta content="2022-02-17T13:48:35.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494307794182631424" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494307439906533376" itemprop="isPartOf"/><div><article aria-labelledby="id__zpz43hrdoko id__gczob106olg id__h8evu6oo5gr id__cmjos9p4k9f id__f3z0znqvcv id__x9cjwcimrrf id__ocaufwj2xmm id__z4q1y72a01f id__fc8tm2frw0t id__ymecyoigdrb id__z8mxkwnnk3l id__9owpi4o6jq9 id__9uifb431e3i id__4qivkuvxfx8" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__x9cjwcimrrf"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Of course, the flash drive doesn&#39;t have a cache at all, so it remains at 223 IOPS with fsync() vs. 60000 IOPS or so on NVMe - so make sure you go with NVMe if you&#39;re on a laptop where it&#39;s safe, only use the cheapo drive on Mac Minis and iMacs! </span><span>ðŸ˜‡</span></p></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
