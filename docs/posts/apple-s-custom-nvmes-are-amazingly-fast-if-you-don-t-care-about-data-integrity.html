<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/marcan42/status/1494213855387734019">Original</a>
    <h1>Apple&#39;s custom NVMes are amazingly fast â€“ if you don&#39;t care about data integrity</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-19" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213855387734019" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="33" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:18.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:18.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213855387734019" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213855387734019" itemprop="mainEntityOfPage"/><div><article aria-labelledby="id__kgbtidrpe3j id__zqeibaphfhb id__pl0miyiamad id__d2zcorfzyy id__anghjo0fdeb id__4rgz61emizn id__mhzdfpj9uml id__z034eyc0mg id__zyvmvgtgagn id__5nm409izbxb id__kgrcgdy0dzd id__uqz11p8nc3 id__o1rbs84echc id__xof2omkvc4s" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__4rgz61emizn"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody"><div><p><span>Well, this is unfortunate. It turns out Apple&#39;s custom NVMe drives are amazingly fast - if you don&#39;t care about data integrity.

If you do, they drop down to HDD performance. Thread.</span></p></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213859594616834" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:19.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:19.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213859594616834" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213855387734019" itemprop="isPartOf"/><div><article aria-labelledby="id__pi2z88qz6h id__h3kmwx5u6w id__uy0jq4dyd9a id__54utu30vqtg id__fh4ytt2z147 id__abs2d1kzyeu id__p9brnhqto2 id__wyeoym3icfn id__h44pyhrdlqg id__18160xsadnh id__hg6zqvd5c4 id__d63fxdye865 id__5c3303eaykb id__apwu4giigzu" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__abs2d1kzyeu"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>For a while, we&#39;ve noticed that random write performance with fsync (data integrity) on Asahi Linux (and also on Linux on T2 Macs) was terrible. As in 46 IOPS terrible. That&#39;s slower than many modern HDDs.

We thought we were missing something, since this didn&#39;t happen on macOS.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213862970707969" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="10" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:20.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:20.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213862970707969" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213859594616834" itemprop="isPartOf"/><div><article aria-labelledby="id__vekh5b2mxr id__fqmmtmb5ost id__fab4ikmqkwv id__24ogiodn5tq id__x3n3murko4d id__4jr9cxs13yv id__n22xrfcvipq id__ob3ohpvx9pq id__zz4te92hkb id__0prr17bgo06m id__usqsqpkb1h id__dzdu6bn1ppr id__v6e87vbru3p id__317tsf0kw55" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__4jr9cxs13yv"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>As it turns out, macOS cheats. On Linux, fsync() will both flush writes to the drive, and ask it to flush its write cache to stable storage.

But on macOS, fsync() only flushes writes to the drive. Instead, they provide an F_FULLSYNC operation to do what fsync() does on Linux.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213865613426688" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:21.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213865613426688" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213862970707969" itemprop="isPartOf"/><div><article aria-labelledby="id__2s6vkb573zk id__ufw2gxjadbs id__pujn36pah9q id__kuszjtk22m id__bvybo9pjkye id__4ykxmk9kn5b id__f3jzlrg7jeq id__mzbwgh7yarg id__iegp76py3p id__l8ibspy36s id__gdou03tl0bk id__647b5jvg73u id__zs8ry11qsro id__pfir13o4um" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__4ykxmk9kn5b"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So effectively macOS cheats on benchmarks; fio on macOS does not give numbers comparable to Linux, and databases and other applications requiring data integrity on macOS need to special case it and use F_FULLSYNC.

How bad is it if you use F_FULLSYNC? It&#39;s bad.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213868201324546" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:21.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213868201324546" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213865613426688" itemprop="isPartOf"/><div><article aria-labelledby="id__hxlg3708f7i id__86zp84nugwf id__3p39pp2pr0h id__h136294v1a id__s5xlkyf3lk id__o23e9olfu9 id__yramfqc5j2b id__ba6hlqwhmar id__q6b6lodjl9g id__ay39yrqvo9k id__qf241atkbf id__edff5nkgz9g id__ey529fp2yta id__za4dnzvnrn" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__o23e9olfu9"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Single threaded, simple Python file rewrite test:

Macbook Air M1 (macOS):
- flushing: 46 IOPS
- not: 40000 IOPS

x86 iMac + WD SN550 1TB NVMe (Linux):
- flushing: 2000 IOPS
- not: 20000 IOPS

x86 laptop + Samsung SSD 860 EVO 500GB SATA:
- flushing: 143 IOPS
- not: 5000 IOPS</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213871149940737" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:22.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213871149940737" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213868201324546" itemprop="isPartOf"/><div><article aria-labelledby="id__f3w07wggho5 id__h082r4augkr id__9tcrn8fhwxi id__hgnwt6zm2oe id__icth7uz3oik id__3q63l53vo92 id__apg3ah89cq id__nw9r60tflt id__08f5x96ddcxi id__q230lrf5yr id__4s5yqb36wsx id__6o4eiit4pm id__xt13wjn6t08 id__a1m1cc8met" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__3q63l53vo92"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So, effectively, Apple&#39;s drive is faster than all the others without cache flushes, but it is more than 3 times slower than a lowly SATA SSD at flushing its cache. Even if all you wrote is a couple of sectors. You pay a huge flush penalty if you do *any* writes.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213873993682946" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:23.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213873993682946" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213871149940737" itemprop="isPartOf"/><div><article aria-labelledby="id__4d4n9yttydn id__41hjaer6g22 id__ry589vubzwl id__j5ez1e6htpi id__uhb6bvwqqq id__j2ez48689l id__iupqcklwq3 id__kswl80bbwom id__84ws793hht id__uzs0oocwvrc id__szt95k1s0u id__4te8qyaisjf id__k9buug1vaxj id__rtcrx819qjm" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__j2ez48689l"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Here, &#34;flushing&#34; on macOS means F_FULLSYNC and &#34;not&#34; means fsync(); on Linux both are fsync(), but &#34;not flushing&#34; is measured by telling Linux that the drive write cache is write-through (which stops it from issuing cache flushes).</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213876657049600" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:24.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:24.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213876657049600" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213873993682946" itemprop="isPartOf"/><div><article aria-labelledby="id__z0oex3mcja id__kh01k35j85 id__4853ac7yjwy id__15m157cjeio id__9nd9u9awpcj id__ili7ajily9l id__51ifm4tsmw2 id__28zq26yp5xu id__xh8s8suyp1 id__cvkn95sbjsh id__hrgjimqsuou id__5jolnmzi5a id__whvjrh4gtxl id__z01or1t4zc" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__ili7ajily9l"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Note that the numbers are filesystem-dependent (and encryption makes things more complicated); e.g. the SATA SSD numbers double on VFAT vs. my root filesystem (ext4 on LVM on dm-crypt), but the pattern is clear.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213879089737729" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="4" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:24.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:24.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213879089737729" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213876657049600" itemprop="isPartOf"/><div><article aria-labelledby="id__hvczvc67p6w id__xvip922epuq id__jkuj6bif0vj id__wlqns4z8r9 id__ewdajqjqcz9 id__bn57ay7ez0b id__p71xyvldb7h id__9x9azct0rwj id__l4sx3vv397e id__gs94dbqq9ss id__0oc7gcdjdf9b id__pl6mf7fzbun id__qk06l3tgosh id__8bw34l98qml" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__bn57ay7ez0b"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>macOS doesn&#39;t even seem to try to proactively issue syncs; you can write a file on macOS, fsync() it, wait 5 seconds, issue a hard reboot (e.g. via USB-PD command), and the data is gone. That&#39;s pretty bad.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213881509875712" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="8" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:25.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213881509875712" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213879089737729" itemprop="isPartOf"/><div><article aria-labelledby="id__7i1s4dz2n53 id__3ugjdqfk3iq id__0lvyf3giuj3 id__anlk7wec3e5 id__uqaev0b06fk id__71wg7sm9mv id__vhlboxnhr8d id__tddu6rp24t id__cwqhlxy99a6 id__hs4if4bd3o id__klp8xhbqevj id__ut8253fhvbh id__37kecm6a298 id__80ubdxe4kiy" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__71wg7sm9mv"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Of course, in normal usage, this is basically never an issue on laptops; given the right software hooks, they should never run out of power before the OS has a chance to issue a disk flush command. But it certainly is for desktops. And it&#39;s a bit fragile re: panics and such.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213883976101888" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:25.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:25.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213883976101888" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213881509875712" itemprop="isPartOf"/><div><article aria-labelledby="id__stjn9th630i id__p34jbzyu0r id__wra9z1ic9p id__bnmel283gtb id__u1uzs1v40y id__bogbfyo1srr id__iihn4q3kqjd id__mivecaxrni9 id__q77gqbflofq id__nj2gecp9k1l id__wf6th5w6up id__gcd9dy3yz2q id__dgozq3xl39m id__5lums8hh5sm" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__bogbfyo1srr"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Unfortunately, this manifests itself as quite visible issues on Linux. For example, apt-get on Asahi Linux is noticeably slow. Making fsync() not really flush on macOS is not fair; lots of portable software is written to assume fsync() means your data is safe.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213886928908288" itemprop="identifier"/><meta content="12" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:26.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:26.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213886928908288" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213883976101888" itemprop="isPartOf"/><div><article aria-labelledby="id__p8vlza3a1ga id__6ztsv5b3nxt id__ri38bm5w8vi id__kdxc0vozjnr id__0rxj8uu4djj id__fvg2q7aq82f id__z1yit1fn4np id__wys5aqatke id__cclz9lzi8zu id__r2z2useorl id__un4jmcb3rx id__aq8lg33wmgf id__u1ow3zkn8jk id__hsmtvowpg9n" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__fvg2q7aq82f"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Our current thinking is we&#39;re going to add a knob to the NVMe driver to defer flush requests up to a maximum time of e.g. 1 second. That would ensure that a hard shutdown never loses you more than 1 second of data, which is better than what macOS can claim right now.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213889646796802" itemprop="identifier"/><meta content="13" itemprop="position"/><meta content="4" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:27.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213889646796802" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213886928908288" itemprop="isPartOf"/><div><article aria-labelledby="id__06k5ku20e4d id__w72tez92xqi id__v3dly4tbp5 id__d6ed9sm9vd id__xlbyzxcbm7 id__4292i69dqgy id__wyfjsoik2c id__fef5p8zjan id__7d7w1ivkr4p id__95yos3bd28s id__ar2x4oil6fi id__6nu7405p47f id__cq6anxnmmq7 id__ymp6h4877ga" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__4292i69dqgy"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Alas, that&#39;s still not quite safe. Not flushing means we cannot guarantee ordering of writes, which means you could end up with actual data corruption in e.g. a database, not just data loss. There&#39;s no good way around this other than doing full flushes.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494213892331163649" itemprop="identifier"/><meta content="14" itemprop="position"/><meta content="6" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:35:27.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:35:27.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494213892331163649" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213889646796802" itemprop="isPartOf"/><div><article aria-labelledby="id__n5i7053oew id__6wckrd2ehlm id__qvj4md2cgft id__3te5qzpkkip id__dw8jjduhpu7 id__fwl9njf25aq id__1yrf73k0zzm id__spjfpjtrajn id__9y23cjuat8m id__2gtgdm5hkoq id__sh7nqamc6p id__4q3u5yrbq8t id__1evstj7b7mm id__ax28reo7t4" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__fwl9njf25aq"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So the unfortunate conclusion is that if you&#39;re e.g. running a transactional database on Apple hardware, and you need to be able to survive a hard poweroff without data corruption, you&#39;re never going to get more than ~46 TPS.

Unless Apple improves their ANS firmware to fix this.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494215160218939392" itemprop="identifier"/><meta content="15" itemprop="position"/><meta content="7" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:40:30.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:40:30.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494215160218939392" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494213892331163649" itemprop="isPartOf"/><div><article aria-labelledby="id__l0pye0py0ao id__4cvhn3z2c27 id__xgcitkao99 id__u47zeixf63 id__zm01262r1bp id__e59c1ygra8s id__plidwo6mm2 id__u8cr28ro2a8 id__n71m1nb0i9t id__x34am4bgawa id__nh6ngbdafyb id__4lfafiehxec id__c6xtd3lqwbg id__yph54vnxl8" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__e59c1ygra8s"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>And for what it&#39;s worth, I inadvertently triggered a data consistency issue in macOS while testing this. Before running any tests I had GarageBand open. I closed it without saving the open project. After the first hard reboot later, it tried to reopen it and threw up an error.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494215321125007362" itemprop="identifier"/><meta content="16" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T07:41:08.000Z" itemprop="dateCreated"/><meta content="2022-02-17T07:41:08.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494215321125007362" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494215160218939392" itemprop="isPartOf"/><div><article aria-labelledby="id__qhd4au0nygc id__rgkm7ghg3a id__mb5mzyhajsl id__83sl77tzv9 id__vv9j0xwdz3g id__qpxsakqtpi id__iqd1rpjpz2 id__a80v9i11ww8 id__1g2gsv1kvb4 id__vo1sclv1wer id__bidg7yjgej9 id__l5b222w5wa9 id__4stsfefrji id__m3bn2h66lpk" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__qpxsakqtpi"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>So I guess the unsaved project file got (partially?) deleted, but not the state that tells it to reopen the currently open file on startup.

Data consistency matters.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494221053220257795" itemprop="identifier"/><meta content="17" itemprop="position"/><meta content="10" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T08:03:55.000Z" itemprop="dateCreated"/><meta content="2022-02-17T08:03:55.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494221053220257795" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494215321125007362" itemprop="isPartOf"/><div><article aria-labelledby="id__1ecqxp47fjh id__e4f36nxud75 id__v8gymotb4sd id__4x7fqm56eyc id__g4ktwimnjsh id__fvcws7kzl4s id__u0xts7ljqjl id__vom7q1cabm id__tj3qbdgtzlk id__ih8x6lw8ylq id__hhsgjgh7q2u id__hvh552oxp86 id__ea4l9wij81q id__ufy6q6af86r" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__fvcws7kzl4s"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Update: tested on the Mac Mini by pulling the plug (which is a &#34;normal&#34; case; the USB-PD thing was a bit special). Still lost seconds of fsync()ed data. There is no (working) last-gasp flush mechanism.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494255642202484743" itemprop="identifier"/><meta content="18" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:21:21.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:21:21.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494255642202484743" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494221053220257795" itemprop="isPartOf"/><div><article aria-labelledby="id__3srrbppk5ps id__ouyu3daw38 id__srom72a7sq9 id__dtyvhchzo3g id__xngl59g7oq id__0h6zslgw9rx9 id__0lrx4v42wut id__g1hjpdx77n id__as3ih2cybai id__xuy3u2b1nyb id__r9bfv9bouce id__tqzlyqh39vg id__9ukouhihr5 id__ig13ku7fv6" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__0h6zslgw9rx9"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Further testing: doing this on FAT32 (to avoid APFS write amplification, which is a separate problem...) doesn&#39;t help with the IOPS on flush, but then I can look at powermetrics bandwidth stats to see what NVMe is doing.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494255645612474369" itemprop="identifier"/><meta content="19" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:21:22.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:21:22.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494255645612474369" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494255642202484743" itemprop="isPartOf"/><div><article aria-labelledby="id__w9mtjfzo1z id__ac641ws99se id__s3m4ptwfwbr id__51kyyum0dbo id__keemmwlcsu id__wsu1xtuhat7 id__phde4xsqloh id__k4s443r1fgo id__qcruo1jojkn id__skfjn6nynx id__6n9kpqppx43 id__lkfk8cqjout id__4issrmqsw1p id__7fl13h6019a" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__wsu1xtuhat7"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Artificially throttled ~30 IOPS without full cache flushes, I get 93.52 ops/s 397.77 KBytes/s disk IO, which is reasonable, and:

ANS2 RD                         : 0.328 MB/s
ANS2 WR                         : 0.399 MB/s

That&#39;s NVMe controller DRAM bandwidth. Reasonable.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494255649026625537" itemprop="identifier"/><meta content="20" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:21:23.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:21:23.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494255649026625537" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494255645612474369" itemprop="isPartOf"/><div><article aria-labelledby="id__iomml8asepk id__qh2qgxhmocl id__wlcpkpnswfa id__7530s8okfjw id__qe7p3l9piig id__fzyl7vqg6nt id__lt4di6re7s id__ljulvejq0bf id__aya6tr5l7zd id__chkiqciyvxo id__ij0ywgfmqm id__kgzv0jbuuyf id__tv6u31c16re id__lwxmdton63h" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__fzyl7vqg6nt"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>But doing flushes, this jumps to:

ANS2 RD                         : 6.248 MB/s
ANS2 WR                         : 9.909 MB/s

So that NVMe controller is doing *something* memory-intensive on flush commands. Maybe it does a linear scan over a large cache hashtable?</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494256049150640129" itemprop="identifier"/><meta content="21" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T10:22:58.000Z" itemprop="dateCreated"/><meta content="2022-02-17T10:22:58.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494256049150640129" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494255649026625537" itemprop="isPartOf"/><div><article aria-labelledby="id__qobbsqrxi1k id__ds1xe0pq034 id__hjfc1i3ff3v id__6ofyequpohd id__ly7hvxgkqlo id__xlh4glf66z id__wjsif2dc2o id__fjgltae8udg id__2a1w3jd6zcj id__f4jz5b0f4n6 id__igyi6exb8i id__n472v98m9o9 id__rua4b835vo id__32impcrcclc" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__xlh4glf66z"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>I can get these stats because the NVMe controller is integrated into the SoC and &#34;drive cache&#34; is just normal memory (it&#39;s unified just like GPU memory), and Apple have very good instrumentation of things like DRAM bandwidth utilization from different SoC agents.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293060020506626" itemprop="identifier"/><meta content="22" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:02.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:02.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293060020506626" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494256049150640129" itemprop="isPartOf"/><div><article aria-labelledby="id__24zntsyldp7 id__9rt8zp6t5h5 id__lx8b8sovi2a id__x8d8yynlez id__usib9p8jy2 id__ospga5evxmq id__4nyp8erhedu id__tm76hgvhsb9 id__0kfl4mnko2m id__sevt4vrs4vj id__xoyzz0gewl8 id__w9z2jyrra6 id__6pin6jcciud id__4v940nwgywk" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__ospga5evxmq"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Uh, guys? I&#39;m not saying &#34;the machines are only fast because they cheat on data durability&#34;. I&#39;m saying there&#39;s a stupid, unfortunate performance bug when you *do* want durability that most people won&#39;t notice because macOS gives you poor durability by default.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293064579686400" itemprop="identifier"/><meta content="23" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:03.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293064579686400" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293060020506626" itemprop="isPartOf"/><div><article aria-labelledby="id__ld1olvhpga id__qseg1blspa id__dheans6cc1s id__jr3sgqr989l id__gdbhe9y7ecc id__dbpw8vkijql id__7x5bgwarel5 id__kcrrb2movbp id__qorchh7ywf id__w8cqdijajvp id__6cvy09qjeyq id__ki69petifdn id__pf14zposqu id__pwbxu4i87x" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__dbpw8vkijql"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>These SSDs are still fast for many use cases, and on laptops you don&#39;t care about this issue because there&#39;s a battery backup anyway.

And besides, Apple can almost certainly fix this in a firmware upgrade.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293067771564040" itemprop="identifier"/><meta content="24" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:04.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:04.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293067771564040" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293064579686400" itemprop="isPartOf"/><div><article aria-labelledby="id__mnjjy83jfkm id__bahfootdsgr id__z2la0iatvtl id__8r5liomvjx4 id__vicnpv6zdma id__o4ldhurw3v id__t5684s2akv id__61735bhi0wi id__n0b40yz2l1q id__a2xpvtra7mw id__moxd6ts25hc id__ec67oxd7285 id__f8tswgll8ym id__l0vkijpxd7" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__o4ldhurw3v"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Chances are this happened because this design came from iDevices, where there&#39;s always a battery, so software will never hit drive cache related consistency/durability issues, so probably ~no iOS software ever uses a full sync, so nobody noticed it&#39;s slow.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293071118614529" itemprop="identifier"/><meta content="25" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:50:05.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:50:05.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293071118614529" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293067771564040" itemprop="isPartOf"/><div><article aria-labelledby="id__n7uz1qnqwzb id__kjgpghvrq0f id__htoqqiv1zw id__htto8b8702 id__ai1su0vval id__rpeh84n6hrk id__19i62s5y0v1 id__dni5sgr8xal id__mrbucr5wmz id__nhdlz1n1mae id__l0tqsyu1rw id__whvrfrd3lh id__ewjr7f2vxkd id__88h3tckr2uu" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__rpeh84n6hrk"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>And I&#39;m just the Nth guy to facepalm when I found out that macOS makes data durability double-opt-in with a nonstandard request. That&#39;s dumb, but it has nothing to do with the machines. It&#39;s just the reason why fio was magically fast on macOS and not on Linux.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494293769134690305" itemprop="identifier"/><meta content="26" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T12:52:51.000Z" itemprop="dateCreated"/><meta content="2022-02-17T12:52:51.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494293769134690305" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293071118614529" itemprop="isPartOf"/><div><article aria-labelledby="id__vb3w9vqs5x id__7rj5s83s1jp id__dpz3wxyz1hl id__jwax9njs75 id__o8yo10f7p7t id__n24jdh0lkak id__e06teweiath id__7y9clgnxgfx id__96qw6zpa56 id__h7hil3yt8x id__n5qhqc92t0b id__0ei06dfhnng id__jo9rovp2h8a id__uysfx3xtmds" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__n24jdh0lkak"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Note that the NVMe controller behaves in a perfectly spec-compliant way as far as data durability. It&#39;s just (ridiculously) slow when you ask for it. Probably a bug.</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494307439906533376" itemprop="identifier"/><meta content="27" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T13:47:11.000Z" itemprop="dateCreated"/><meta content="2022-02-17T13:47:11.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494307439906533376" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494293769134690305" itemprop="isPartOf"/><div><article aria-labelledby="id__c5jl2p2ssq id__kk33hdrtx id__gcwkwilg9l id__vk51nzuo7sr id__428fq7ojuml id__8ve2dfz8ov2 id__u6tdoeb7h2i id__3d7ksar816 id__xjz4rku2g2 id__zh2q2bloeaq id__qq9sxl1ole id__nkstb024aed id__4m4iku2jg2d id__mr2ju0u5yfl" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__8ve2dfz8ov2"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>But since incessant people on HN made me do another test, and for giggles:

FAT32 on internal NVMe with F_FULLFSYNC: 58 IOPS
FAT32 on a cheapo USB3 flash drive with the same: 223 IOPS.

If you run a durable database on an M1 today, try a cheap flash drive. It&#39;ll be faster :-)</span></p></div></div></div></div></div></div></div></div></article></div></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1494307794182631424" itemprop="identifier"/><meta content="28" itemprop="position"/><meta content="6" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2022-02-17T13:48:35.000Z" itemprop="dateCreated"/><meta content="2022-02-17T13:48:35.000Z" itemprop="datePublished"/><meta content="https://twitter.com/marcan42/status/1494307794182631424" itemprop="url"/><meta content="https://twitter.com/marcan42/status/1494307439906533376" itemprop="isPartOf"/><div><article aria-labelledby="id__51nrd3s7pmj id__ulut8bf774 id__xfkql3k36l id__prbnfnn9t6s id__x2zfsy5p4u id__jip60m9sbtb id__o1g3wf2qbgr id__sjxvucb7znc id__l91y6q4bu68 id__4j1gq4cvi4r id__klrktz1eoye id__xokyh0yht3b id__1jzf7ey05pf id__d3z4n4l9mg" role="article" data-testid="tweet"><div><div><div><div><div><div><div><div id="id__jip60m9sbtb"><div><div><div><div><a href="https://twitter.com/marcan42" role="link"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/642190731122114560/oXAYC93Z_400x400.png"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div><div><div><div><div itemprop="articleBody"><p><span>Of course, the flash drive doesn&#39;t have a cache at all, so it remains at 223 IOPS with fsync() vs. 60000 IOPS or so on NVMe - so make sure you go with NVMe if you&#39;re on a laptop where it&#39;s safe, only use the cheapo drive on Mac Minis and iMacs! </span><span>ðŸ˜‡</span></p></div></div></div></div></div></div></div></div></article></div></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
