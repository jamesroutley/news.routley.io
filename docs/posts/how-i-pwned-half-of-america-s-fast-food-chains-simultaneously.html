<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mrbruh.com/chattr/">Original</a>
    <h1>How I pwned half of America&#39;s fast food chains, simultaneously</h1>
    
    <div id="readability-page-1" class="page"><div>
  
<p><em>Also checkout <a href="https://kibty.town/blog/chattr/">Eva’s blogpost</a> of this event.</em></p>
<p>With an upbeat <em>pling</em> my console alerted me that my script had finished running, to be precise it was searching for exposed Firebase credentials on any of the hundreds of recent AI startups.</p>
<p>This was achieved through a public list of sites using the <code>.ai</code> TLD and parsing the site data (and any referenced .js bundles) for references to common Firebase initialisation variables.</p>
<div><pre tabindex="0"><code data-lang="js"><span><span><span>Production</span><span>:</span> {
</span></span><span><span>    <span>apiKey</span><span>:</span> <span>&#34;AIza&lt;Insert_Funny_Joke_Here&gt;&#34;</span>,
</span></span><span><span>    <span>authDomain</span><span>:</span> <span>&#34;KFC.firebaseapp.com&#34;</span>,
</span></span><span><span>    <span>databaseURL</span><span>:</span> <span>&#34;https://KFC.firebaseio.com&#34;</span>,
</span></span><span><span>    <span>projectId</span><span>:</span> <span>&#34;KFC&#34;</span>,
</span></span><span><span>    <span>storageBucket</span><span>:</span> <span>&#34;KFC.appspot.com&#34;</span>,
</span></span><span><span>    <span>messagingSenderId</span><span>:</span> <span>&#34;123456789&#34;</span>
</span></span><span><span>}
</span></span></code></pre></div><p>My hunch was that in the rush to push their new shiny product, someone would take a shortcut and forget to implement proper security rules.</p>
<p><strong>The hunch was right, and it was worse than I could’ve ever guessed.</strong></p>
<h2 id="meet-chattrai">Meet Chattr.ai</h2>
<p>…The self proclaimed AI hiring system that claims to shave 88% of the time off hiring new people.</p>
<p>They provide their services to a massive number of fast food chains and other hourly employers around the United States, including but not limited to:</p>
<ul>
<li>Applebees</li>
<li>Arbys</li>
<li>Chickfila</li>
<li>Dunkin</li>
<li>IHOP</li>
<li>KFC</li>
<li>Shoneys</li>
<li>Subway</li>
<li>Tacobell</li>
<li>Target</li>
<li>Wendys</li>
</ul>
<h2 id="the-vulnerability">The Vulnerability</h2>
<p>If you drop the Firebase configuration from the JS bundle into Firepwn, you start out with zero permissions as you can see in the following screenshot.
<img src="https://mrbruh.com/chattr/firebase.avif" alt=""/></p>
<p><strong>But</strong> if you use Firebase’s registration feature to create a new user (you cannot register on their site), you get full privileges (read/write) to the Firebase DB.
<img src="https://mrbruh.com/chattr/firebase_logged_in.avif" alt=""/></p>
<p>The data it exposes includes and is not limited to:</p>
<ul>
<li>Names</li>
<li>Phone numbers</li>
<li>Emails</li>
<li><strong>Plaintext passwords</strong> <em>(Only some account’s had exposed passwords)</em></li>
<li>Locations of branches</li>
<li>Confidential messages</li>
<li>Shifts</li>
</ul>
<p>For the following:</p>
<ul>
<li>Chattr employees</li>
<li>Franchisee managers</li>
<li>Job applicants</li>
</ul>
<h2 id="it-gets-worse">It Gets… Worse?!</h2>
<p>Yeah, it somehow manages to get even worse.</p>
<p>If you grab the list of admin users from <code>/orgs/0/users</code>, you can splice a new entry into it giving you full access to their Administrator dashboard.</p>
<p>As you can see below, it allows for <strong>even more control</strong> over their systems including accepting/denying applicants or even <strong>refunding payments made to Chattr.</strong>
<img src="https://mrbruh.com/chattr/organizations.avif" alt=""/>
<img src="https://mrbruh.com/chattr/super_admins.avif" alt=""/>
<img src="https://mrbruh.com/chattr/dialog_manager.avif" alt=""/>
<img src="https://mrbruh.com/chattr/applicant_messages.avif" alt=""/>
<img src="https://mrbruh.com/chattr/accept_or_decline.avif" alt=""/>
<img src="https://mrbruh.com/chattr/refund_payments.avif" alt=""/></p>
<h2 id="timeline-ddmm">Timeline (DD/MM)</h2>
<ul>
<li>06/01 - Vulnerability Discovered</li>
<li>09/01 - Write-up completed &amp; Emailed to them</li>
<li>10/01 - Vulnerability patched</li>
<li><em>No contact or thanks has been received back so far, I will amend this comment if/when they do so :)</em></li>
</ul>
<h2 id="credits">Credits</h2>
<p><em>To my friends who assisted me with this pentest and responsible disclosure of such</em></p>
<ul>
<li>Logykk</li>
<li>Eva - <a href="https://kibty.town/blog/chattr">https://kibty.town/blog/chattr</a></li>
</ul>

</div></div>
  </body>
</html>
