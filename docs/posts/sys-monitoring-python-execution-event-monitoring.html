<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://docs.python.org/3/library/sys.monitoring.html">Original</a>
    <h1>Sys.monitoring: Python Execution event monitoring</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
        <div>
          <div role="main">
            
  <section id="module-sys.monitoring">
<span id="sys-monitoring-execution-event-monitoring"></span>
<p><span>New in version 3.12.</span></p>
<hr/>
<div>
<p>Note</p>
<p><a href="#module-sys.monitoring" title="sys.monitoring: Access and control event monitoring"><code><span>sys.monitoring</span></code></a> is a namespace within the <a href="https://docs.python.org/3/library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code><span>sys</span></code></a> module,
not an independent module, so there is no need to
<code><span>import</span> <span>sys.monitoring</span></code>, simply <code><span>import</span> <span>sys</span></code> and then use
<code><span>sys.monitoring</span></code>.</p>
</div>
<p>This namespace provides access to the functions and constants necessary to
activate and control event monitoring.</p>
<p>As programs execute, events occur that might be of interest to tools that
monitor execution. The <a href="#module-sys.monitoring" title="sys.monitoring: Access and control event monitoring"><code><span>sys.monitoring</span></code></a> namespace provides means to
receive callbacks when events of interest occur.</p>
<p>The monitoring API consists of three components:</p>
<ul>
<li><p><a href="#tool-identifiers">Tool identifiers</a></p></li>
<li><p><a href="#events">Events</a></p></li>
<li><p><a href="#callbacks"><span>Callbacks</span></a></p></li>
</ul>
<section id="tool-identifiers">
<h2>Tool identifiers<a href="#tool-identifiers" title="Permalink to this headline">¶</a></h2>
<p>A tool identifier is an integer and the associated name.
Tool identifiers are used to discourage tools from interfering with each
other and to allow multiple tools to operate at the same time.
Currently tools are completely independent and cannot be used to
monitor each other. This restriction may be lifted in the future.</p>
<p>Before registering or activating events, a tool should choose an identifier.
Identifiers are integers in the range 0 to 5 inclusive.</p>
<section id="registering-and-using-tools">
<h3>Registering and using tools<a href="#registering-and-using-tools" title="Permalink to this headline">¶</a></h3>
<dl>
<dt id="sys.monitoring.use_tool_id">
<span><span>sys.monitoring.</span></span><span><span>use_tool_id</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>name</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="str"><span>str</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.use_tool_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Must be called before <em>tool_id</em> can be used.
<em>tool_id</em> must be in the range 0 to 5 inclusive.
Raises a <a href="https://docs.python.org/3/library/exceptions.html#ValueError" title="ValueError"><code><span>ValueError</span></code></a> if <em>tool_id</em> is in use.</p>
</dd></dl>

<dl>
<dt id="sys.monitoring.free_tool_id">
<span><span>sys.monitoring.</span></span><span><span>free_tool_id</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.free_tool_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Should be called once a tool no longer requires <em>tool_id</em>.</p>
</dd></dl>

<div>
<p>Note</p>
<p><a href="#sys.monitoring.free_tool_id" title="sys.monitoring.free_tool_id"><code><span>free_tool_id()</span></code></a> will not disable global or local events associated
with <em>tool_id</em>, nor will it unregister any callback functions. This
function is only intended to be used to notify the VM that the
particular <em>tool_id</em> is no longer in use.</p>
</div>
<dl>
<dt id="sys.monitoring.get_tool">
<span><span>sys.monitoring.</span></span><span><span>get_tool</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="str"><span>str</span></a><span> </span><span><span>|</span></span><span> </span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.get_tool" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the tool if <em>tool_id</em> is in use,
otherwise it returns <code><span>None</span></code>.
<em>tool_id</em> must be in the range 0 to 5 inclusive.</p>
</dd></dl>

<p>All IDs are treated the same by the VM with regard to events, but the
following IDs are pre-defined to make co-operation of tools easier:</p>
<div><div><pre><span></span><span>sys</span><span>.</span><span>monitoring</span><span>.</span><span>DEBUGGER_ID</span> <span>=</span> <span>0</span>
<span>sys</span><span>.</span><span>monitoring</span><span>.</span><span>COVERAGE_ID</span> <span>=</span> <span>1</span>
<span>sys</span><span>.</span><span>monitoring</span><span>.</span><span>PROFILER_ID</span> <span>=</span> <span>2</span>
<span>sys</span><span>.</span><span>monitoring</span><span>.</span><span>OPTIMIZER_ID</span> <span>=</span> <span>5</span>
</pre></div>
</div>
<p>There is no obligation to set an ID, nor is there anything preventing a tool
from using an ID even it is already in use.
However, tools are encouraged to use a unique ID and respect other tools.</p>
</section>
</section>
<section id="events">
<h2>Events<a href="#events" title="Permalink to this headline">¶</a></h2>
<p>The following events are supported:</p>
<dl>
<dt id="monitoring-event-BRANCH">
<span><span>sys.monitoring.events.</span></span><span><span>BRANCH</span></span><a href="#monitoring-event-BRANCH" title="Permalink to this definition">¶</a></dt>
<dd><p>A conditional branch is taken (or not).</p>
</dd></dl>

<dl>
<dt id="monitoring-event-CALL">
<span><span>sys.monitoring.events.</span></span><span><span>CALL</span></span><a href="#monitoring-event-CALL" title="Permalink to this definition">¶</a></dt>
<dd><p>A call in Python code (event occurs before the call).</p>
</dd></dl>

<dl>
<dt id="monitoring-event-C_RAISE">
<span><span>sys.monitoring.events.</span></span><span><span>C_RAISE</span></span><a href="#monitoring-event-C_RAISE" title="Permalink to this definition">¶</a></dt>
<dd><p>An exception raised from any callable, except for Python functions (event occurs after the exit).</p>
</dd></dl>

<dl>
<dt id="monitoring-event-C_RETURN">
<span><span>sys.monitoring.events.</span></span><span><span>C_RETURN</span></span><a href="#monitoring-event-C_RETURN" title="Permalink to this definition">¶</a></dt>
<dd><p>Return from any callable, except for Python functions (event occurs after the return).</p>
</dd></dl>

<dl>
<dt id="monitoring-event-EXCEPTION_HANDLED">
<span><span>sys.monitoring.events.</span></span><span><span>EXCEPTION_HANDLED</span></span><a href="#monitoring-event-EXCEPTION_HANDLED" title="Permalink to this definition">¶</a></dt>
<dd><p>An exception is handled.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-INSTRUCTION">
<span><span>sys.monitoring.events.</span></span><span><span>INSTRUCTION</span></span><a href="#monitoring-event-INSTRUCTION" title="Permalink to this definition">¶</a></dt>
<dd><p>A VM instruction is about to be executed.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-JUMP">
<span><span>sys.monitoring.events.</span></span><span><span>JUMP</span></span><a href="#monitoring-event-JUMP" title="Permalink to this definition">¶</a></dt>
<dd><p>An unconditional jump in the control flow graph is made.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-LINE">
<span><span>sys.monitoring.events.</span></span><span><span>LINE</span></span><a href="#monitoring-event-LINE" title="Permalink to this definition">¶</a></dt>
<dd><p>An instruction is about to be executed that has a different line number from the preceding instruction.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-PY_RESUME">
<span><span>sys.monitoring.events.</span></span><span><span>PY_RESUME</span></span><a href="#monitoring-event-PY_RESUME" title="Permalink to this definition">¶</a></dt>
<dd><p>Resumption of a Python function (for generator and coroutine functions), except for <code><span>throw()</span></code> calls.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-PY_RETURN">
<span><span>sys.monitoring.events.</span></span><span><span>PY_RETURN</span></span><a href="#monitoring-event-PY_RETURN" title="Permalink to this definition">¶</a></dt>
<dd><p>Return from a Python function (occurs immediately before the return, the callee’s frame will be on the stack).</p>
</dd></dl>

<dl>
<dt id="monitoring-event-PY_START">
<span><span>sys.monitoring.events.</span></span><span><span>PY_START</span></span><a href="#monitoring-event-PY_START" title="Permalink to this definition">¶</a></dt>
<dd><p>Start of a Python function (occurs immediately after the call, the callee’s frame will be on the stack)</p>
</dd></dl>

<dl>
<dt id="monitoring-event-PY_THROW">
<span><span>sys.monitoring.events.</span></span><span><span>PY_THROW</span></span><a href="#monitoring-event-PY_THROW" title="Permalink to this definition">¶</a></dt>
<dd><p>A Python function is resumed by a <code><span>throw()</span></code> call.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-PY_UNWIND">
<span><span>sys.monitoring.events.</span></span><span><span>PY_UNWIND</span></span><a href="#monitoring-event-PY_UNWIND" title="Permalink to this definition">¶</a></dt>
<dd><p>Exit from a Python function during exception unwinding.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-PY_YIELD">
<span><span>sys.monitoring.events.</span></span><span><span>PY_YIELD</span></span><a href="#monitoring-event-PY_YIELD" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield from a Python function (occurs immediately before the yield, the callee’s frame will be on the stack).</p>
</dd></dl>

<dl>
<dt id="monitoring-event-RAISE">
<span><span>sys.monitoring.events.</span></span><span><span>RAISE</span></span><a href="#monitoring-event-RAISE" title="Permalink to this definition">¶</a></dt>
<dd><p>An exception is raised, except those that cause a <a href="#monitoring-event-STOP_ITERATION"><code><span>STOP_ITERATION</span></code></a> event.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-RERAISE">
<span><span>sys.monitoring.events.</span></span><span><span>RERAISE</span></span><a href="#monitoring-event-RERAISE" title="Permalink to this definition">¶</a></dt>
<dd><p>An exception is re-raised, for example at the end of a <a href="https://docs.python.org/3/reference/compound_stmts.html#finally"><code><span>finally</span></code></a> block.</p>
</dd></dl>

<dl>
<dt id="monitoring-event-STOP_ITERATION">
<span><span>sys.monitoring.events.</span></span><span><span>STOP_ITERATION</span></span><a href="#monitoring-event-STOP_ITERATION" title="Permalink to this definition">¶</a></dt>
<dd><p>An artificial <a href="https://docs.python.org/3/library/exceptions.html#StopIteration" title="StopIteration"><code><span>StopIteration</span></code></a> is raised; see <a href="#the-stop-iteration-event">the STOP_ITERATION event</a>.</p>
</dd></dl>

<p>More events may be added in the future.</p>
<p>These events are attributes of the <code><span>sys.monitoring.events</span></code> namespace.
Each event is represented as a power-of-2 integer constant.
To define a set of events, simply bitwise or the individual events together.
For example, to specify both <a href="#monitoring-event-PY_RETURN"><code><span>PY_RETURN</span></code></a> and <a href="#monitoring-event-PY_START"><code><span>PY_START</span></code></a>
events, use the expression <code><span>PY_RETURN</span> <span>|</span> <span>PY_START</span></code>.</p>
<dl>
<dt id="monitoring-event-NO_EVENTS">
<span><span>sys.monitoring.events.</span></span><span><span>NO_EVENTS</span></span><a href="#monitoring-event-NO_EVENTS" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for <code><span>0</span></code> so users can do explict comparisions like:</p>
<div><div><pre><span></span><span>if</span> <span>get_events</span><span>(</span><span>DEBUGGER_ID</span><span>)</span> <span>==</span> <span>NO_EVENTS</span><span>:</span>
    <span>...</span>
</pre></div>
</div>
</dd></dl>

<p>Events are divided into three groups:</p>
<section id="local-events">
<h3>Local events<a href="#local-events" title="Permalink to this headline">¶</a></h3>
<p>Local events are associated with normal execution of the program and happen
at clearly defined locations. All local events can be disabled.
The local events are:</p>
<ul>
<li><p><a href="#monitoring-event-PY_START"><code><span>PY_START</span></code></a></p></li>
<li><p><a href="#monitoring-event-PY_RESUME"><code><span>PY_RESUME</span></code></a></p></li>
<li><p><a href="#monitoring-event-PY_RETURN"><code><span>PY_RETURN</span></code></a></p></li>
<li><p><a href="#monitoring-event-PY_YIELD"><code><span>PY_YIELD</span></code></a></p></li>
<li><p><a href="#monitoring-event-CALL"><code><span>CALL</span></code></a></p></li>
<li><p><a href="#monitoring-event-LINE"><code><span>LINE</span></code></a></p></li>
<li><p><a href="#monitoring-event-INSTRUCTION"><code><span>INSTRUCTION</span></code></a></p></li>
<li><p><a href="#monitoring-event-JUMP"><code><span>JUMP</span></code></a></p></li>
<li><p><a href="#monitoring-event-BRANCH"><code><span>BRANCH</span></code></a></p></li>
<li><p><a href="#monitoring-event-STOP_ITERATION"><code><span>STOP_ITERATION</span></code></a></p></li>
</ul>
</section>
<section id="ancillary-events">
<h3>Ancillary events<a href="#ancillary-events" title="Permalink to this headline">¶</a></h3>
<p>Ancillary events can be monitored like other events, but are controlled
by another event:</p>
<ul>
<li><p><a href="#monitoring-event-C_RAISE"><code><span>C_RAISE</span></code></a></p></li>
<li><p><a href="#monitoring-event-C_RETURN"><code><span>C_RETURN</span></code></a></p></li>
</ul>
<p>The <a href="#monitoring-event-C_RETURN"><code><span>C_RETURN</span></code></a> and <a href="#monitoring-event-C_RAISE"><code><span>C_RAISE</span></code></a> events
are controlled by the <a href="#monitoring-event-CALL"><code><span>CALL</span></code></a> event.
<a href="#monitoring-event-C_RETURN"><code><span>C_RETURN</span></code></a> and <a href="#monitoring-event-C_RAISE"><code><span>C_RAISE</span></code></a> events will only be seen if the
corresponding <a href="#monitoring-event-CALL"><code><span>CALL</span></code></a> event is being monitored.</p>
</section>
<section id="other-events">
<h3>Other events<a href="#other-events" title="Permalink to this headline">¶</a></h3>
<p>Other events are not necessarily tied to a specific location in the
program and cannot be individually disabled.</p>
<p>The other events that can be monitored are:</p>
<ul>
<li><p><a href="#monitoring-event-PY_THROW"><code><span>PY_THROW</span></code></a></p></li>
<li><p><a href="#monitoring-event-PY_UNWIND"><code><span>PY_UNWIND</span></code></a></p></li>
<li><p><a href="#monitoring-event-RAISE"><code><span>RAISE</span></code></a></p></li>
<li><p><a href="#monitoring-event-EXCEPTION_HANDLED"><code><span>EXCEPTION_HANDLED</span></code></a></p></li>
</ul>
</section>
<section id="the-stop-iteration-event">
<h3>The STOP_ITERATION event<a href="#the-stop-iteration-event" title="Permalink to this headline">¶</a></h3>
<p><span id="index-0"></span><a href="https://peps.python.org/pep-0380/#use-of-stopiteration-to-return-values"><strong>PEP 380</strong></a>
specifies that a <a href="https://docs.python.org/3/library/exceptions.html#StopIteration" title="StopIteration"><code><span>StopIteration</span></code></a> exception is raised when returning a value
from a generator or coroutine. However, this is a very inefficient way to
return a value, so some Python implementations, notably CPython 3.12+, do not
raise an exception unless it would be visible to other code.</p>
<p>To allow tools to monitor for real exceptions without slowing down generators
and coroutines, the <a href="#monitoring-event-STOP_ITERATION"><code><span>STOP_ITERATION</span></code></a> event is provided.
<a href="#monitoring-event-STOP_ITERATION"><code><span>STOP_ITERATION</span></code></a> can be locally disabled, unlike <a href="#monitoring-event-RAISE"><code><span>RAISE</span></code></a>.</p>
</section>
</section>
<section id="turning-events-on-and-off">
<h2>Turning events on and off<a href="#turning-events-on-and-off" title="Permalink to this headline">¶</a></h2>
<p>In order to monitor an event, it must be turned on and a corresponding callback
must be registered.
Events can be turned on or off by setting the events either globally or
for a particular code object.</p>
<section id="setting-events-globally">
<h3>Setting events globally<a href="#setting-events-globally" title="Permalink to this headline">¶</a></h3>
<p>Events can be controlled globally by modifying the set of events being monitored.</p>
<dl>
<dt id="sys.monitoring.get_events">
<span><span>sys.monitoring.</span></span><span><span>get_events</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></span><a href="#sys.monitoring.get_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code><span>int</span></code> representing all the active events.</p>
</dd></dl>

<dl>
<dt id="sys.monitoring.set_events">
<span><span>sys.monitoring.</span></span><span><span>set_events</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>event_set</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.set_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Activates all events which are set in <em>event_set</em>.
Raises a <a href="https://docs.python.org/3/library/exceptions.html#ValueError" title="ValueError"><code><span>ValueError</span></code></a> if <em>tool_id</em> is not in use.</p>
</dd></dl>

<p>No events are active by default.</p>
</section>
<section id="per-code-object-events">
<h3>Per code object events<a href="#per-code-object-events" title="Permalink to this headline">¶</a></h3>
<p>Events can also be controlled on a per code object basis.</p>
<dl>
<dt id="sys.monitoring.get_local_events">
<span><span>sys.monitoring.</span></span><span><span>get_local_events</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>code</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/types.html#types.CodeType" title="types.CodeType"><span>CodeType</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></span><a href="#sys.monitoring.get_local_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the local events for <em>code</em></p>
</dd></dl>

<dl>
<dt id="sys.monitoring.set_local_events">
<span><span>sys.monitoring.</span></span><span><span>set_local_events</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>code</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/types.html#types.CodeType" title="types.CodeType"><span>CodeType</span></a></span></em>, <em><span><span>event_set</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.set_local_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Activates all the local events for <em>code</em> which are set in <em>event_set</em>.
Raises a <a href="https://docs.python.org/3/library/exceptions.html#ValueError" title="ValueError"><code><span>ValueError</span></code></a> if <em>tool_id</em> is not in use.</p>
</dd></dl>

<p>Local events add to global events, but do not mask them.
In other words, all global events will trigger for a code object,
regardless of the local events.</p>
</section>
<section id="disabling-events">
<h3>Disabling events<a href="#disabling-events" title="Permalink to this headline">¶</a></h3>
<dl>
<dt id="sys.monitoring.DISABLE">
<span><span>sys.monitoring.</span></span><span><span>DISABLE</span></span><a href="#sys.monitoring.DISABLE" title="Permalink to this definition">¶</a></dt>
<dd><p>A special value that can be returned from a callback function to disable
events for the current code location.</p>
</dd></dl>

<p>Local events can be disabled for a specific code location by returning
<a href="#sys.monitoring.DISABLE" title="sys.monitoring.DISABLE"><code><span>sys.monitoring.DISABLE</span></code></a> from a callback function. This does not change
which events are set, or any other code locations for the same event.</p>
<p>Disabling events for specific locations is very important for high
performance monitoring. For example, a program can be run under a
debugger with no overhead if the debugger disables all monitoring
except for a few breakpoints.</p>
<dl>
<dt id="sys.monitoring.restart_events">
<span><span>sys.monitoring.</span></span><span><span>restart_events</span></span><span>(</span><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.restart_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable all the events that were disabled by <a href="#sys.monitoring.DISABLE" title="sys.monitoring.DISABLE"><code><span>sys.monitoring.DISABLE</span></code></a>
for all tools.</p>
</dd></dl>

</section>
</section>
<section id="registering-callback-functions">
<span id="callbacks"></span><h2>Registering callback functions<a href="#registering-callback-functions" title="Permalink to this headline">¶</a></h2>
<p>To register a callable for events call</p>
<dl>
<dt id="sys.monitoring.register_callback">
<span><span>sys.monitoring.</span></span><span><span>register_callback</span></span><span>(</span><em><span><span>tool_id</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>event</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/functions.html#int" title="int"><span>int</span></a></span></em>, <em><span><span>func</span></span><span><span>:</span></span><span> </span><span><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="collections.abc.Callable"><span>Callable</span></a><span> </span><span><span>|</span></span><span> </span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></em>, <em><span><span>/</span></span></em><span>)</span> <span><span>→</span> <span><a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="collections.abc.Callable"><span>Callable</span></a><span> </span><span><span>|</span></span><span> </span><a href="https://docs.python.org/3/library/constants.html#None" title="None"><span>None</span></a></span></span><a href="#sys.monitoring.register_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers the callable <em>func</em> for the <em>event</em> with the given <em>tool_id</em></p>
<p>If another callback was registered for the given <em>tool_id</em> and <em>event</em>,
it is unregistered and returned.
Otherwise <a href="#sys.monitoring.register_callback" title="sys.monitoring.register_callback"><code><span>register_callback()</span></code></a> returns <code><span>None</span></code>.</p>
</dd></dl>

<p>Functions can be unregistered by calling
<code><span>sys.monitoring.register_callback(tool_id,</span> <span>event,</span> <span>None)</span></code>.</p>
<p>Callback functions can be registered and unregistered at any time.</p>
<p>Registering or unregistering a callback function will generate a <a href="https://docs.python.org/3/library/sys.html#sys.audit" title="sys.audit"><code><span>sys.audit()</span></code></a> event.</p>
<section id="callback-function-arguments">
<h3>Callback function arguments<a href="#callback-function-arguments" title="Permalink to this headline">¶</a></h3>
<dl>
<dt id="sys.monitoring.MISSING">
<span><span>sys.monitoring.</span></span><span><span>MISSING</span></span><a href="#sys.monitoring.MISSING" title="Permalink to this definition">¶</a></dt>
<dd><p>A special value that is passed to a callback function to indicate
that there are no arguments to the call.</p>
</dd></dl>

<p>When an active event occurs, the registered callback function is called.
Different events will provide the callback function with different arguments, as follows:</p>
<ul>
<li><p><a href="#monitoring-event-PY_START"><code><span>PY_START</span></code></a> and <a href="#monitoring-event-PY_RESUME"><code><span>PY_RESUME</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>instruction_offset</span><span>:</span> <span>int</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
</li>
<li><p><a href="#monitoring-event-PY_RETURN"><code><span>PY_RETURN</span></code></a> and <a href="#monitoring-event-PY_YIELD"><code><span>PY_YIELD</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>instruction_offset</span><span>:</span> <span>int</span><span>,</span> <span>retval</span><span>:</span> <span>object</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
</li>
<li><p><a href="#monitoring-event-CALL"><code><span>CALL</span></code></a>, <a href="#monitoring-event-C_RAISE"><code><span>C_RAISE</span></code></a> and <a href="#monitoring-event-C_RETURN"><code><span>C_RETURN</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>instruction_offset</span><span>:</span> <span>int</span><span>,</span> <span>callable</span><span>:</span> <span>object</span><span>,</span> <span>arg0</span><span>:</span> <span>object</span> <span>|</span> <span>MISSING</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
<p>If there are no arguments, <em>arg0</em> is set to <a href="#sys.monitoring.MISSING" title="sys.monitoring.MISSING"><code><span>sys.monitoring.MISSING</span></code></a>.</p>
</li>
<li><p><a href="#monitoring-event-RAISE"><code><span>RAISE</span></code></a>, <a href="#monitoring-event-RERAISE"><code><span>RERAISE</span></code></a>, <a href="#monitoring-event-EXCEPTION_HANDLED"><code><span>EXCEPTION_HANDLED</span></code></a>,
<a href="#monitoring-event-PY_UNWIND"><code><span>PY_UNWIND</span></code></a>, <a href="#monitoring-event-PY_THROW"><code><span>PY_THROW</span></code></a> and <a href="#monitoring-event-STOP_ITERATION"><code><span>STOP_ITERATION</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>instruction_offset</span><span>:</span> <span>int</span><span>,</span> <span>exception</span><span>:</span> <span>BaseException</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
</li>
<li><p><a href="#monitoring-event-LINE"><code><span>LINE</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>line_number</span><span>:</span> <span>int</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
</li>
<li><p><a href="#monitoring-event-BRANCH"><code><span>BRANCH</span></code></a> and <a href="#monitoring-event-JUMP"><code><span>JUMP</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>instruction_offset</span><span>:</span> <span>int</span><span>,</span> <span>destination_offset</span><span>:</span> <span>int</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
<p>Note that the <em>destination_offset</em> is where the code will next execute.
For an untaken branch this will be the offset of the instruction following
the branch.</p>
</li>
<li><p><a href="#monitoring-event-INSTRUCTION"><code><span>INSTRUCTION</span></code></a>:</p>
<div><div><pre><span></span><span>func</span><span>(</span><span>code</span><span>:</span> <span>CodeType</span><span>,</span> <span>instruction_offset</span><span>:</span> <span>int</span><span>)</span> <span>-&gt;</span> <span>DISABLE</span> <span>|</span> <span>Any</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
</section>


            
          </div>
        </div>
      </div>
      
      
    </div></div>
  </body>
</html>
