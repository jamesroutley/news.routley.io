<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bugwhisperer.dev/blog/setup-fingerprint-reader-login-wayland-swaylock/">Original</a>
    <h1>Setup Fingerprint Reader Login With Wayland swaylock</h1>
    
    <div id="readability-page-1" class="page"><div id="main-content"><p><span><a href="https://bugwhisperer.dev/tags/os">OS</a></span></p><p>My laptop came with a fingerprint reader for logging into its original Windows OS. I installed Linux on it 10 minutes after getting home from the store and proceeded to forget about the fingerprint reader for the next 5 years. Then one night while bored, I happened to glance at the reader and decided to see if it would work on Linux (Fedora in my case). It turns out that it did and that was pretty darn easy to do! Read on to find out how you can set up a fingerprint reader device on your Linux machine.</p><h2 id="step-1-check-that-your-fingerprint-reader-is-compatible">Step 1. Check that your fingerprint reader is compatible</h2><p>Run: <code>lsusb</code>. If you see your fingerprint reader in the output list you‚Äôre good to go. Look for devices containing keywords like the following for common manufacturers and models:</p><ul><li>Goodix (very common in modern laptops): Shenzhen Goodix Technology Co.,Ltd.</li><li>Synaptics: Synaptics, Inc. - often shows as ‚ÄúMetallica MIS Touch Fingerprint Reader‚Äù</li><li>Validity/Synaptics: Validity Sensors or ‚ÄúVFS‚Äù (ex. VFS495, VFS5011)</li><li>AuthenTec (older devices): AuthenTec, Inc.</li><li>Elan: ELAN Microelectronics Corp.</li><li>FocalTech: FocalTech Systems Co.,Ltd.</li><li>Realtek: Look for ‚ÄúBiometric‚Äù or ‚ÄúFingerprint‚Äù</li></ul><p><strong>üî• Hot Tip!</strong> Use grep to search lsusb output for the above keywords:</p><p><code>lsusb | grep -i -e Goodix -e Fingerprint -e VFS -e AuthenTec -e ELAN -e FocalTech -e Biometric</code></p><p>For me, my reader hardware was a more common one (Goodix), and was listed as:</p><p><code>Bus 003 Device 002: ID 27c6:639c Shenzhen Goodix Technology Co.,Ltd. Goodix USB2.0 MISC</code></p><h2 id="step-2-install-the-fingerprint-reader-daemon-fprintd-package">Step 2. Install the fingerprint reader daemon ‚Äúfprintd‚Äù package</h2><p>Fedora: <code>sudo dnf install fprintd</code></p><p>Ubuntu: <code>sudo apt-get install fprintd</code></p><p>Debian: <code>sudo apt install fprintd</code></p><p>Red Hat: <code>sudo yum install fprintd</code></p><h2 id="step-3-setup-enroll-your-fingerprint-s">Step 3. Setup ‚ÄúEnroll‚Äù your fingerprint(s)</h2><p>To add (read: enroll) a fingerprint you run: <code>sudo fprintd-enroll -f &lt;finger&gt; [&lt;username&gt;]</code>. You will be prompted to touch the reader with your finger/thumb several times to get a good read.</p><p><strong>‚ö†Ô∏è NOTE:</strong> If you <em>don‚Äôt</em> put a username the fingerprint will be assigned to the <strong>root</strong> user. I made this mistake and only realized it when I had to run <code>sudo</code> to try and verify. I then had to delete the fingerprint from root and start over again to add it to my user. Having duplicate prints for different users wasn‚Äôt allowed.</p><p>The <code>&lt;finger&gt;</code> argument must be one of the following: left-thumb, left-index-finger, left-middle-finger, left-ring-finger, left-little-finger, right-thumb, right-index-finger, right-middle-finger, right-ring-finger, right-little-finger</p><h2 id="step-4-verify-that-your-prints-are-detected">Step 4. Verify that your prints are detected</h2><p>Run <code>fprintd-verify</code>. You should see OK messages if your fingerprints are read correctly.</p><h2 id="step-5-set-up-swaylock-to-accept-either-a-typed-password-or-a-fingerprint">Step 5. Set up swaylock to accept either a typed password OR a fingerprint</h2><p>If you don‚Äôt do anything else <code>swaylock</code> exhibits some strange behavior when you try to login at the lock screen. It will force you to use the fingerprint to login, even if you‚Äôve typed your password and pressed enter.</p><p>The fix for this is to edit the pam.d swaylock file (<code>sudoedit /etc/pam.d/swaylock</code>) and add the following two lines to the top of the file:</p><pre><code><span>auth            sufficient      pam_unix.so try_first_pass likeauth nullok
</span><span>auth            sufficient      pam_fprintd.so
</span></code></pre><p>Now you should be able to log in at the lock screen via:</p><ol><li>entering your password and pressing Return OR</li><li>pressing Return and then using your fingerprint</li></ol><hr/><p>That‚Äôs it! It‚Äôs a pretty straightforward setup. An added bonus is you can use the fingerprint reader for <code>sudo/doas</code> now instead of typing out your password. I hope this helps someone take advantage of their fingerprint reader on Linux! :)</p></div></div>
  </body>
</html>
