<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tweedegolf.nl/en/blog/137/rust-is-rolling-off-the-volvo-assembly-line">Original</a>
    <h1>Rust is rolling off the Volvo assembly line</h1>
    
    <div id="readability-page-1" class="page"><p><strong>In my job I get to speak to lots of people about Rust. Some are just starting out, some have barely ever heard of it, and then some people are running Rust silently in production at a very large company in a very serious product.</strong></p><div><p>A while back, I had the fortune to talk with <a href="https://www.linkedin.com/in/julius-gustavsson/">Julius Gustavsson</a> from Sweden and he squarely falls in the last category of people. From 2019 onwards, he has been the main software architect for the low-power processor ECU (electronic control unit) at <a href="https://www.volvo.com/en/">Volvo</a>.</p><p>This ECU is responsible for the (low) power management of the car. Electric cars obviously have massive high-voltage batteries, but the classic 12 volt lines are still there. Those lines are always on and can drain the battery if there&#39;s any power usage, so you want all car systems to be turned off when you&#39;re away from your car. The ECU is responsible for waking up the electric system when needed, for example when you approach the car.</p><p>This ECU was not actively being worked on in 2019 and so Julius became part of a new dedicated team. But even back in 2017, when Julius joined Volvo, he already knew about Rust and saw its potential to replace existing C and C++ code.</p><p>It turned out the low-power processor was a perfect fit for using Rust! It was not classified as a safety-critical component and it was an Arm Cortex-M processor, so there was no technical or bureaucratic blocker for using Rust.</p><p>And so it has come to be that, at this moment, EX90s and Polestar 3s are rolling off the assembly line that would not work without their Rust components.</p><p>I think that&#39;s a great milestone for Rust!</p><p>I wanted to know more about this and thought the world would too, so Julius has kindly agreed to let me interview him. Here&#39;s everything we talked about:</p><h3 id="q-why-did-you-pick-rust">Q: Why did you pick Rust?</h3><p>Julius told me his first job was building air traffic control software, where a lot of Ada is used. A competitor was even required to use Ada by the US Air Force. &#34;The language is amazing in its own way. However, the consensus at the company was that Ada was both too arcane and to proprietary for them, at that time.&#34;</p><p>And so he used a mixture of C and C++ for about 15 years. &#34;At all different companies I worked at they all had different strategies and strictness, but memory-related bugs were always a problem&#34;.</p><p>&#34;It always felt unsafe; Most codebases have a bunch of invariants and assumptions that are not written down but everyone must uphold. As the project grows in complexity and especially team size, this will inevitably fail at some point. After debugging the umpteenth bug, the thought came, &#39;Is this it? Isn&#39;t there a better way?&#39;&#34;</p><p>He had discovered Rust before its 1.0 release in 2015, and began paying more attention to it after the release. So when he joined Volvo Julius had a little bit of hobby experience. He had found it tricky to pick up the Rust concepts and had to read the O&#39;Reilly book twice. However, &#34;once it clicked, I got very enthusiastic.&#34;</p><p>Picking Rust for the ECU project didn&#39;t come out of the blue.</p><p>&#34;When we were prototyping the precursor to the project, and doing interop with Android, I created a vehicle HAL in Rust using futures 0.1, back in the days before async, for Android that spoke grpc to the Rust system,&#34; he explained.</p><p>Describing the project, he said: &#34;We&#39;d have buttons on the screen to control the fans of the car. I had to write a lot of code before I could compile it all, a big jenga tower. But once it compiled, the fans started to work! Very impressed.&#34;</p><p>It was difficult to figure out how to build Rust for use with Android, which was the platform this prototype ran on. Today much more effort has been put in tooling around this, but Julius was there very early.</p><p>With this prototype he proved to himself and the people around him that Rust could be a serious option for production code; It delivered on its promises.</p><h3 id="q-how-did-it-go">Q: How did it go?</h3><p>Aside from the project being a good fit for Rust due to it not being safety-critical and running on common hardware, it was also quite straightforward due to its limited feature set.</p><p>In 2020 they had made a first proof-of-concept in C before continuing the project with Rust. What wasn&#39;t so straightforward was that the ECU had to communicate over CAN with the other systems in the car and they had to implement all diagnostics systems and port over the standard Volvo protocols.</p><p>So they needed to reimplement a lot of things. According to Julius though, they &#34;got much higher quality&#34;. And they found they were writing far fewer bugs compared to C and C++.</p><p>Julius wasn&#39;t the only one really liking Rust. One of his colleagues had to leave and said: &#34;It&#39;s hard to think about having to go back to something that&#39;s not Rust&#34;. Still, a healthy dose of scepticism remained. As Julius put it: &#34;I always had the feeling, is Rust too good to be true? I&#39;m always looking for the big pitfall. So far I have not found anything bad. Only some small things like const generics not being fully done.&#34;</p><p>As the project progressed, they got &#34;a bigger and bigger pile of proof that Rust does actually work well&#34;.</p><p>There were regular cross-team meetings where team leads could discuss their problems. As time went on it became more and more noticeable that Julius didn&#39;t bring up many issues at all and when he showed his results, his colleagues were often left impressed.</p><h3 id="q-would-you-recommend-rust-to-others">Q: Would you recommend Rust to others?</h3><p>&#34;Definitely&#34;, Julius answered promptly.</p><p>He continues: &#34;For any project where you have very strict reliability and availability requirements, and you want to be confident that what you deploy is actually correct, then Rust is an excellent choice! Also <code>cargo</code> and all the other available tooling make the whole cycle of developing high quality software a really nice experience.&#34;</p><p>Rust also works great for teams with high turnover because there&#39;s a lot of confidence in the code. &#34;Other people can just take over the code and fiddle around safely because when it compiles, it almost always works&#34;.</p><p>&#34;For prototyping, then maybe it&#39;s not the best option because things are rigid. The compiler forces you to work more on the edge cases and minute details up front, something you are not always interested in doing at that particular point&#34;, he noted. This, of course, is an often expressed sentiment.</p><p>But to put that in perspective, Julius says: &#34;Rust would work for most of the software I&#39;ve worked on professionally. There are absolutely cases where Rust is not the best fit. But I think we&#39;re at that point where instead of asking &#39;Can we use Rust for this?&#39;, we should be asking &#39;Why can&#39;t we use Rust for this?&#39; And then you have the discussion.&#34;</p><h3 id="q-whats-missing-that-got-in-the-way">Q: What&#39;s missing that got in the way?</h3><p>It wasn&#39;t easy to create the software so that it properly fit the requirements, according to Julius. This is mostly a tooling issue.</p><p>For example, it was hard to run the unit tests on the embedded target. Other challenges included code coverage, runtime profiling, software BOM and license tracking. This is my personal experience as well, although the state of these issues has much improved over the last couple of years.</p><p>Julius and I agreed that it would be very valuable to build more and better tooling. He said: &#34;Most are halfway there, but you still need to do a lot yourself&#34;.</p><p>During the project, things got better. Julius explicitly mentioned the <a href="https://github.com/knurling-rs">Knurling</a> project, for example, and that those tools helped a lot.</p><h3 id="q-are-you-going-to-use-rust-in-the-future">Q: Are you going to use Rust in the future?</h3><p>&#34;Yes.&#34;</p><p>In fact, Julius is actively cheerleading for other projects to pick up Rust. And there seems to be an overall enthusiasm for Rust at many  layers in the company.</p><p>A couple of days before my meeting with Julius, he had the final project presentation with the management. The result of that meeting was a common consensus among management to look into using Rust in more places.</p><h3 id="conclusion">Conclusion</h3><p>From our conversation it seems that using Rust has been a great success at Volvo thus far. People are happy, the quality of the product is high, and the company seems poised to use more Rust in the future.</p><p>It&#39;s obvious that there&#39;s more work to be done still, but with more safety-critical tooling like <a href="https://ferrocene.dev/en/">Ferrocene</a> becoming available, Rust is readier than ever for use in the automotive industry.</p></div></div>
  </body>
</html>
