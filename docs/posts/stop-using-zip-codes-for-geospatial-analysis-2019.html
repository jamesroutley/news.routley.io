<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://carto.com/blog/zip-codes-spatial-analysis">Original</a>
    <h1>Stop Using Zip Codes for Geospatial Analysis (2019)</h1>
    
    <div id="readability-page-1" class="page"><div><p>The last time you used your <a href="https://www.gislounge.com/understanding-and-playing-with-zip-codes/">zip code</a>, you were most likely entering your address into a website to make a purchase, finding a store near your home or office, or filling out some other online form. You likely found the answer you were looking for and didn&#39;t stop to think further about that five-digit code you&#39;d just typed out.</p><p>However, lots of companies, marketers and data analysts spend hours looking at zip codes. They are deciding how to use data tied to those zip codes to understand trends, run their businesses, and find new ways to reach you - all using that same five-digit code.</p><p>Even though there are different place associations that probably mean more to you as an individual, such as a neighborhood, street, or the block you live on, the zip code is, in many organizations, the geographic unit of choice. It is used to make major decisions for marketing, opening or closing stores, providing services, and making decisions that can have a massive financial impact.</p><p>The problem is that zip codes are not a good representation of real human behavior, and when used in data analysis, often mask real, underlying insights, and may ultimately lead to bad outcomes. To understand why this is, we first need to understand a little more about the zip code itself.</p><p>Looking to learn more about Spatial Data Science? Check out our range of <a href="https://spatial-data-science-conference.com/">Spatial Data Science events</a>!</p><h3>The Zip Code: A Brief History</h3><p>The predecessor to the zip code was the postal zone  which represented a post office department for a specific city. For example:</p><p><strong>Mr. John Smith</strong></p><p>&#34;16&#34; represents the postal zone in a Minneapolis. But with more and more mail being sent, in 1963 the Postal Service decided to roll out the <strong>Zone Improvement Plan</strong>  which transformed addresses to look like the following:</p><p><strong>Mr. John Smith</strong></p><p>The five digit code represents a part of the country (5_ _ _ _ )  a sectional center facility ( _ 5 4 _ _ )  and the associate post office or delivery area (_ _ _ 1 6). </p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/66b9cffc5d14b6e5ca213d33_639c39c9c67f664c8539d8da_zip-first-digit.png" alt="First digit of every zip code" loading="lazy"/></p></figure><p>The first digit for every zip code for the states in the contiguous United States</p><p>By 1967 ZIP codes were made mandatory for bulk mailers and continued to be adopted by almost anyone sending mail in the US. Over time, the ZIP+4 was added to add more granularity to the zip code to denote specific locations  even buildings for postal workers to deliver. The Postal Service even created a character, <a href="https://en.wikipedia.org/wiki/Mr._ZIP">Mr. Zip</a>, to promote the use of ZIP codes, who was featured on stamps, <a href="https://www.youtube.com/watch?v=Tf71PHyOfR0">commercials</a>  and <a href="https://www.youtube.com/watch?v=ojn6U2kP_pQ">songs</a>.</p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/639c39c9c67f66731639d8de_mr-zip.jpeg" alt="Mr. Zip" loading="lazy"/></p></figure><p>ZIP codes themselves do not actually represent an area, rather a collection of routes:</p><p>Despite the geographic derivation of most ZIP Codes, the codes themselves do not represent geographic regions; in general, they correspond to address groups or delivery routes. As a consequence  ZIP Code &#34;areas&#34; can overlap  be subsets of each other, or be artificial constructs with no geographic area (such as 095 for mail to the Navy  which is not geographically fixed). In similar fashion, in areas without regular postal routes (<a href="https://en.wikipedia.org/wiki/Rural_delivery_service">rural route</a> areas) or no mail delivery (undeveloped areas)  ZIP Codes are not assigned or are based on sparse delivery routes  and hence the boundary between ZIP Code areas is undefined.</p><p>The US Census provides data for <a href="https://www.census.gov/programs-surveys/geography/guidance/geo-areas/zctas.html">ZIP Code Tabulation Areas</a>, or geographic files:</p><p>ZIP Code Tabulation Areas (ZCTAs) are generalized areal representations of United States Postal Service (USPS) ZIP Code service areas.The USPS ZIP Codes identify the individual post office or metropolitan area delivery station associated with mailing addresses. USPS ZIP Codes are not areal features but a collection of mail delivery routes.</p><p>Here we find our first problem with ZIP Codes, that they do not represent an actual area on a map, but rather a collection of routes that help postal workers effectively deliver mail. They aren&#39;t designed to measure sociodemographic trends  as a business would generally want to do. You can actually look up <a href="https://www.melissa.com/v2/lookups/mapcartzip/zipcode?zipcode=10009">individual delivery routes</a>  like the one below:</p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/639c39c9c67f66975339d8e4_zip-route-nyc.png" alt="One zip code route in New York&#39;s East Village" loading="lazy"/></p></figure><p>One zip code route in New York&#39;s East Village</p><p>We are only scratching the surface of the issue here. Similar issues exist around the world, with postal codes representing strange boundaries</p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/639c39c9c67f66abda39d8dc_global-zip-shapes.png" alt="Postal Codes in London  Toronto  and Sydney" loading="lazy"/></p></figure><p>Postal Codes in London, Toronto, and Sydney.</p><h3>Using ZIP codes for data analysis</h3><p>Fast forward to today, where many companies can easily look into their database and find a dataset with a zip_code column in it, which allows them to group and aggregate data to see trends and business performance metrics. As stated earlier, the problem with ZIP Codes is that:</p><ol role="list"><li>They don&#39;t represent real boundaries  but rather routes</li><li>They don&#39;t represent how humans behave</li></ol><p>The later represents two specific issues in using spatial data: spatial scale of observations and spatial scale support (you can learn more about this in this lecture from UChicago&#39;s Luc Anselin, <a href="https://youtu.be/MmCYeJ27DsA?t=326">here</a>). The first is that humans don&#39;t behave based on <a href="https://carto.com/spatial-data-catalog/boundary-data">administrative units</a> such as zip codes, or even census units. Their behavior is influenced much more by their neighbors, or areas such as a neighborhoods or high activity areas (such as central business districts). The second is that spatial data is provided at multiple scales, and many times those boundaries are overlapping or nested within another boundary. </p><p>Let&#39;s look at an example of this in one specific area in Dallas.</p><p>In this map, we can see large white boundaries, which represent <a href="https://carto.com/spatial-data-catalog/browser/dataset/acs_sociodemogr_716c8567/">ZIP code boundaries</a>, and below them are boundaries for <a href="https://carto.com/spatial-data-catalog/browser/geography/tigr_blockgroup_688551c7/">US Census Block Groups</a>. The darker green represents higher income, as provided by the US Census. You can access both of these datasets - with associated sociodemographic data - via our <a href="https://carto.com/spatial-data-catalog/browser">Spatial Data Catalog</a>.</p><p>When we look at one specific ZIP Code we can see that income data in even more detail:</p><p>What we can see is that 12 month median household income in this single zip code (75206) ranges from $9,700 to $227,000 when we look at block groups that completely or partially fall within this single ZIP Code, which the Census lists as having a median household income of $63,392.</p><p>Median Income is one way to evaluate the range of values within a ZIP Code (keep in mind these are ZCTA boundaries) but we can likely see variance like this in population, employment, and other relevant metrics for data analysis. </p><p>Sticking with median household income, we decided to expand this analysis to the entire United States, to see which areas are the least and most in-equal when you look at ZIP Codes and the Census Block Groups that intersect with the ZCTA Boundaries.</p><p><strong>The most unequal zip code is 33139 in Miami Beach  FL</strong></p><ol role="list"><li>33139: Miami  FL ($241,344 Difference)</li><li>44120: Cleveland  OH ($237,501 Difference)</li><li>10013: New York  NY ($233,559 Difference)</li><li>10023: New York  NY ($233,157 Difference)</li><li>11201: Brooklyn  NY ($233,031 Difference)</li><li>10601: White Plains  NY ($232,813 Difference)</li><li>33141: Miami  FL ($232,633 Difference)</li><li>92648: Huntington Beach  CA ($231,290 Difference)</li><li>98105: Seattle  WA ($230,906 Difference)</li><li>33143: Miami  FL ($230,626 Difference)</li></ol><p><strong>The most similar* zip code is in Chesapeake  WV</strong></p><ol role="list"><li>25315: Chesapeake  WV ($2 Difference)</li><li>79357: Cone  TX ($4 Difference)</li><li>65052: Linn Creek  MO ($9 Difference)</li><li>73093: Washington  OK ($12 Difference)</li><li>68370: Hebron  NE ($13 Difference)</li><li>19541: Mohrsville  PA ($15 Difference)</li><li>05340: Bondville  VT ($18 Difference)</li><li>12958: Mooers  NY ($26 Difference)</li><li>19941: Ellendale  DE ($37 Difference)</li><li>54896: Loretta  WI ($38 Difference)</li></ol><p><em>* similar where the difference is greater than 0</em></p><p>We can quickly use <a href="https://carto.com/workflows">CARTO Workflows</a> to perform this analysis for all of the United States without code. If you&#39;d like to have a go yourself, you can sign up for a free 14-day CARTO trial <a href="https://app.carto.com/signup/">here</a>. </p><p>In this workflow (see below), we used a <a href="https://docs.carto.com/carto-user-manual/workflows/components/joins#spatial-join">Spatial Join</a> to establish which census blocks intersect each Zip Code. Next, the <a href="https://docs.carto.com/carto-user-manual/workflows/components/joins#spatial-join">Group By</a> component was used to calculate the minimum and maximum income for each zip code, after which the Create Column component was used to calculate the difference between the two. </p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/66b9cffc5d14b6e5ca213d37_65609c448a3c55d4b787852c_zip_codes_workflow.png" loading="lazy" alt="A screenshot of CARTO Workflows being used to analyze zip codes "/></p></figure><p>After creating this as a new table we can see that the majority of the most unequal zip codes tend to be in cities or larger metro areas and more equal zip codes tend to be in rural areas around the country.</p><p><a href="https://clausa.app.carto.com/map/29fd0873-64cb-42a6-a90d-c83a8840bbfe">Check out the full map.</a></p><p> <a href="https://carto.com/signup/" target="_blank">Sign me up for a FREE account</a></p><p>Learn more about how organisations are changing the way they perform spatial analysis with our FREE ebook <a href="https://go.carto.com/state-spatial-data-science-2024">The State of Spatial Data Science 2024</a>!</p><figure><a href="https://go.carto.com/state-spatial-data-science-2024" target="_blank"><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/66b9cffc5d14b6e5ca213d1b_66b9cfe8dd3bc64e0fcb225b_State%2520of%2520Spatial%2520Data%2520Science%2520202%2520-%2520Email%2520620x280.png" loading="lazy" alt="A promotional imagefor the report"/></p></a></figure><h3>So why do we use ZIP Codes?</h3><p>In practice, it is easy to use zip codes as a geospatial unit. As we stated earlier, almost any e-commerce or delivery service, or app that uses location or needs to locate their users in any way will collect a zip code. Additionally  everyone is familiar with zip codes  as they are part of any address in most countries. </p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/639c39c9c67f669fdb39d8db_zip-lookup.png" alt="&#39;Find A Store&#39; on Target.com" loading="lazy"/></p></figure><p>&#39;Find A Store&#39; on Target.com</p><p>Terms like Census Block Group or Tract are less familiar to those who don&#39;t work with geospatial data on a regular basis  and they can be more difficult to find and harder to work with  especially if you aren&#39;t familiar with terms like Shapefile, FTP, and ETL. Even then you have to go through the US Census FTP website,, download geographic files state by state  and join those files to census measures.</p><p>Finally, most people know  without looking at a map that zip codes represent a smaller area than a city, but larger than say a neighborhood. Conceptually, they feel small enough to get a very focused view of the world, and big enough to capture enough of a sample size of trends.</p><p><strong>The short answer is that zip codes are easy to find, familiar, and provide a granular enough view of the world (or so we thought).</strong></p><p>With that said there are real world problems that arise from using zip codes in geospatial analysis. One example is in real estate where, in many cities or areas, there are homes listed in a  zip code  even though as we know those boundaries are arbitrary. <a href="https://hbr.org/2019/04/research-when-airbnb-listings-in-a-city-increase-so-do-rent-prices">This article</a> from the Harvard Business Review also describes a similar phenomenon with Airbnb listings and rising rent prices.</p><p>In simple terms  we argue that if a zip code is &#34;touristy,&#34; meaning it has a lot of restaurants and bars, and if awareness of Airbnb increases  which we measure using the Google search index for the keyword &#34;Airbnb,&#34; then any jump in Airbnb supply in that zip code is likely driven by an increase in demand for short-term rentals through Airbnb  rather than local economic conditions.</p><p>More importantly, using zip codes for analysis can mask serious conditions that are taking place at a different spatial scale. The Flint water crisis was one of these cases. This article by Richard Casey Sadler, an Assistant Professor at Michigan State University describes the problem in great detail and raises similar points about zip codes (the full article is well worth reading):</p><p>Dr. Tony Grubesic, an Arizona State University professor  has called them &#34;one of the <a href="http://www.sciencedirect.com/science/article/pii/S0038012106000516">quirkier &#39;geographies&#39;</a> in the world.&#34; Dr. Nancy Krieger, a Harvard University professor  and colleagues have called out their <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1447194/">unacceptability</a> for small-area analyses.</p><p>Ultimately the state used zip codes to analyze the blood lead statistics in aggregate, which effectively masked the actual issue. This is because:</p><p>In Flint&#39;s case, the state&#39;s error was introduced because &#34;Flint ZIP codes&#34; do not align well with the city of Flint or its water system. The city and water system are almost 100 percent coterminous – that is  they share the same boundaries…  In total, Flint ZIP codes used in the state&#39;s analysis blanket parts of eight different municipalities (seven townships and one city) surrounding Flint.</p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/639c39c9c67f66616a39d8e1_flint-zip-misallignment.jpeg" alt="&#39;Map by Richard Casey Sadler" loading="lazy"/></p></figure><p>Map by Richard Casey Sadler</p><p>In the case of Flint  simply looking at a different spatial scale or analysis may have shown the problem more clearly. For fields like public health and critical services  understanding and using appropriate spatial scale is critically important.</p><h3>What else can we do?</h3><p>So if you are compelled to do away with zip code analysis, the good news is that there are several different options available.</p><h4>Use Addresses</h4><p>The first and foremost recommendation would be to use real world addresses. When you know an address string, you can use a geocoder - or the service that Google or other map search engines use to take an address and transform it into latitude and longitude. Most every major service offers an API and wrappers for different languages to do this. Keep in mind there are generally some <a href="https://docs.mapbox.com/help/troubleshooting/address-geocoding-format-guide/">best practices</a> for cleaning your data  and you will need valid address strings to do so. Other tools like <a href="https://github.com/openvenues/libpostal">Libpostal</a> can help you normalize and parse your address strings.</p><h4>Use Census Units</h4><p>You can also use Census units such as a Census Block Group or Tract. As I mentioned it has not always been easy to find and collect this data at scale  but there are many new tools that are becoming available to use. <a href="https://github.com/cenpy-devs/cenpy">CenPy</a> is a Python library that allows you to connect and find Census data (good <a href="https://medium.com/@mswhitetoyou/scraping-us-census-data-via-cenpy-9aeab12c877e">tutorial here</a>) where you can find measures from the decennial census or American Community Survey. CARTO also provides Census and ACS through the <a href="https://carto.com/developers/data-observatory/">Data Observatory</a>  which was used in the notebook for the full US analysis.</p><p>You can also find out Census geometry IDs for a specific address location using the <a href="https://www.census.gov/data/developers/data-sets/Geocoding-services.html">US Census Geocoder</a>. You can pass in a variety of parameters via the API or use it in Python with the <a href="https://pypi.org/project/censusgeocode/">censusgeocode</a> package.</p><p>As your gather address data, you can easily add in a Census Tract or Block Group ID to that entry  and use that rather than the zip code field in your data. This will allow you to do the same aggregation you were doing  except at a more appropriate geographic scale.</p><h4>Use your own Spatial Index</h4><p>Finally - and arguably the best option - is to use a Spatial Index.</p><p>Spatial Indexes like <a href="https://eng.uber.com/h3/">H3</a> and <a href="http://s2geometry.io/&gt;S2 cells&lt;/a&gt;  you can use &lt;a href=">quadkey</a> are global, multi-resolution grid systems which are geolocated by a short reference ID, rather than a complex geometry. This makes them super lightweight to store and lightning-fast to analyze. The grid cells have the same shape (although their size varies by latitude), meaning data is evenly geographically distributed - avoiding boundary and visual bias which is often caused by irregular grids like zip code; read more <a href="https://carto.com/blog/hexagons-for-location-intelligence">here</a>. </p><p>‍</p><p>A key benefit here is the anonymization of sensitive data. Given that address data can be sensitive  you can create a data pipeline that simply reads incoming addresses  geocodes them, assigns a spatial index, then passes that indexed data into a separate table, then you can store or delete the address data as needed.</p><figure><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/639c39c9c67f66ae7839d8df_uber-h3-cells.png" alt="Uber H3 Cells" loading="lazy"/></p></figure><p>Want to learn more about Spatial Indexes? Check out our ebook: <a href="https://go.carto.com/report-spatial-indexes-101">Spatial Indexes 101</a>! </p><figure><a href="https://go.carto.com/report-spatial-indexes-101" target="_blank"><p><img src="https://cdn.prod.website-files.com/63483ad423421bd16e7a7ae7/66b9cffc5d14b6e5ca213d93_63c91e55e5a6b9697ea829e3_Spatial%2520Indexes%2520101%2520-%2520Social%2520Asset%2520-%2520Twitter_Animated.gif" loading="lazy" alt=""/></p></a></figure><p>Working with spatial data can be difficult  but the availability of data and tools has made it more accessible. By using the correct spatial scale and discarding analysis at the zip code level  you can improve the quality of your insights and create more meaningful outcomes and analysis.</p><p> Want to see how it might work with your data? </p></div></div>
  </body>
</html>
