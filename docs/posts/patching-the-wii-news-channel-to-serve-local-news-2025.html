<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://raulnegron.me/2025/wii-news-pr/">Original</a>
    <h1>Patching the Wii News Channel to serve local news (2025)</h1>
    
    <div id="readability-page-1" class="page"><div>


<article>
  
  <span>August 25, 2025</span>
  

  
<p>üéß <a href="https://share.m.nintendo.com/en-US/US/tracks/d0ef0907-3709-4850-af8a-b1cf5c63cc6e">Now Playing: Menu (News Channel) via Nintendo Music App</a></p>
<img src="https://debamitro.github.io/img/wiinews-pr/wii-news-pr.png" alt="wii system plus PR flag and rolled up newspaper emoji"/>
<p>In keeping with my passion (?) for <a href="https://github.com/rnegron/noticias-pr-cli">displaying local news articles in unexpected places</a>, I figured it would be a fun project to try and see what it would take to display current local news on the Nintendo Wii console‚Äôs <a href="https://en.wikipedia.org/wiki/Wii_system_software#News_Channel">News Channel</a>.</p>
<p>Here‚Äôs a sneak peek at the result:</p>
<img src="https://debamitro.github.io/img/wiinews-pr/wiinewspr-article.png" alt="Wii News Channel showing a contemporary news article from El Nuevo D√≠a"/>
<p>In this post, I‚Äôd like to share my research and process for getting this all to work.</p>
 <details>
  <summary><strong>tl;dr - click to expand (spoilers)</strong></summary>
<ul>
<li>
<p>Patched the News Channel‚Äôs hardcoded Nintendo URL to point to an S3 storage bucket using Go and <code>wadlib</code> to extract the necessary binary file and edit it in-memory</p>
</li>
<li>
<p>Modified WiiLink‚Äôs open-source news file generator to add ‚ÄúEl Nuevo D√≠a‚Äù as a news source</p>
</li>
<li>
<p>Set up AWS Lambda + EventBridge to regenerate the necessary news binary files hourly</p>
</li>
<li>
<p>Source code: <a href="https://github.com/rnegron/WiiNewsPR">WiiNewsPR</a> and
<a href="https://github.com/rnegron/WiiNewsPR-Patcher">WiiNewsPR-Patcher</a></p>
</li>
</ul>
  </details>
<!-- We'll get a chance to see console-specific file storage formats, proxy the Wii's HTTP requests, search for strings in binary files  -->
<h2 id="the-wiis-news-channel">The Wii‚Äôs News Channel</h2>
<p>The News Channel debuted in North America on January 26, 2007, a little over two months after the Wii‚Äôs launch. Since that date, it mostly came pre-installed with Wii consoles and was a novel way to read news from all over the world. Together with other ‚Äúutility‚Äù channels like the Forecast Channel, it tried to position the Wii as more than just a gaming console.</p>
<p>Check out a video recording of the service from right before it was discontinued on June 27th, 2013:</p>
<p>
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="lazy" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/vP70ioijK6U?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=15" title="YouTube video"></iframe>
    </p>

<h3 id="how-the-news-channel-fetches-content">How the News Channel fetches content</h3>
<p>Before we can consider displaying custom news on it, we have to figure out how the News Channel actually fetches content. We know that it must have fetched news somehow since it displays a ‚ÄúDownloading‚Ä¶‚Äù splash screen on startup.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/downloading.png" alt="wii news channel downloading splash screen"/>
<p>Luckily for us, the Wii natively supports proxying via its internet connection configuration settings! Meaning we can set up something like <a href="https://www.mitmproxy.org/">mitmproxy</a> on a local machine and observe its HTTP behavior.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/proxy-settings.png" alt="wii system internet connection menu showing available proxy settings"/>
<p>We can start <code>mitmproxy</code>‚Äôs web interface for a more screenshot-friendly UI:</p>
<div><pre tabindex="0"><code data-lang="bash"><span><span>mitmweb --listen-port <span>8080</span>
</span></span></code></pre></div><p>If we run a man-in-the-middle proxy for the News Channel on an unmodified Wii, we will observe that, on channel startup, it attempts to obtain a <code>news.bin.00</code> file from <code>http://news.wapp.wii.com/v2/1/049/news.bin.00</code> via a plain HTTP request.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/original-requests.png" alt="mitmproxy web showing two HTTP requests from the Wii to http://news.wapp.wii.com/v2/1/049/news.bin.00"/>
<blockquote>
<p>URL path explainer (we‚Äôll see later how I found this out):</p>
<ul>
<li>
<p><code>1</code> corresponds to ‚ÄúEnglish‚Äù as the configured console language. See <a href="https://github.com/devkitPro/libogc/blob/9d99fec85cbc27b6ab4f3d785764de611112dbaf/gc/ogc/conf.h#L108">conf.h</a> in <code>devkitPro</code> (the Wii homebrew community‚Äôs de-facto development toolchain) for the possible values.</p>
</li>
<li>
<p><code>049</code> is the Wii‚Äôs country code for ‚ÄúUnited States‚Äù. Check out the full list of Wii country codes on <a href="https://wiibrew.org/wiki/Country_Codes">wiibrew.org</a>.</p>
</li>
</ul>
</blockquote>
<p>Once it fails to fetch this file, the News Channel displays an error. What might these binary files be? In any case, seeing the Wii perform an HTTP request to fetch news data is a good sign for us. It means we might be able to serve our own data.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/wiiconnect24-error.png" alt="wii news channel error screen"/>
<hr/>
<p>By the way, if you run an internet connection test after configuring the proxy settings correctly, you‚Äôll spot the Wii performing an HTTP request to <a href="http://conntest.nintendowifi.net">http://conntest.nintendowifi.net</a>. Turns out, this page is actually still online (see for yourself!)</p>
<img src="https://debamitro.github.io/img/wiinews-pr/conn-check.png" alt="mitmproxy web showing an HTTP requests from the Wii to http://conntest.nintendowifi.net"/>
<p>The Wii‚Äôs internet connection test still passes to this day without any modification required. Thanks, Nintendo!</p>
<hr/>

<p>Up to this point, this is how we would expect the Wii would behave if you were running a stock console. More than 12 years ago, <a href="https://www.nintendo.com/en-gb/Support/Wii/Wii-Channels/Wii-Network-Services-Partial-Discontinuation/Wii-Network-Services-Partial-Discontinuation-748396.html">Nintendo discontinued support</a> for the online functionality of the News Channel.</p>
<p>But as expected for a beloved retro console, community efforts have sprung up to try and preserve the previously existing functionality and allow users to continue enjoying these systems well past their intended expiration date. These sorts of unofficial software for gaming consoles are commonly referred to as ‚Äúhomebrew‚Äù.</p>
<p>Importantly for this project, the <a href="https://wiilink.ca/#intro/">WiiLink</a> team maintains servers and develops software that allows us to experience the Wii‚Äôs online connectivity features even today.</p>
<blockquote>
<p>By the way, if you‚Äôre curious about how to get started with Wii console homebrew, check out <a href="https://wii.hacks.guide">https://wii.hacks.guide</a>.</p>
</blockquote>
<p>Thanks to WiiLink, we can <a href="https://wiilink.ca/guide/news/">revive the News Channel</a> and browse up-to-date news! Just not the local news, which is our real goal.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/wiilink-news-tech.png" alt="wii news channel showing technology stories after patching with wiilink"/>
<h3 id="how-wiilink-patches-the-news-channel">How WiiLink patches the News Channel</h3>
<p>After going through the WiiLink install process, if we fire up <code>mitmproxy</code> and take a look at what the Wii is doing now, we‚Äôll see that it‚Äôs actually requesting files from a different domain: ‚Äúnews.wiilink.ca‚Äù. But this time, it manages to fetch <code>news.bin.00</code> and keeps requesting files all the way up to <code>news.bin.23</code>.</p>
<p>The News Channel just successfully fetched 24 hours worth of news from this server.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/wiilink-requests.png" alt="mitmproxy web showing HTTP requests from the Wii to http://news.wiilink.ca/v2/1/049/news.bin.00, etc."/>
<p>Great! Somehow, the WiiLink folks got this all to work. And, best of all, they‚Äôve opened-sourced their work (<a href="https://github.com/WiiLink24">GitHub</a>). The plan is looking really feasible at this point!</p>
<p>At a high-level, there are two steps to tackle, then:</p>
<ol>
<li>We have to make the News Channel fetch files from a server we control</li>
<li>We need to actually generate binary files with the content we want</li>
</ol>
<h2 id="step-1-patching-the-news-channel-to-redirect-to-our-domain">Step 1: Patching the News Channel to redirect to our domain</h2>
<p>If we follow along with <a href="https://wiilink.ca/guide/install/">WiiLink‚Äôs installation guide</a>, the critical step seems to be installing a patched version of the News Channel. Looking at their GitHub org, we find a <a href="https://github.com/WiiLink24/WiiLink24-Patcher/">WiiLink24-Patcher</a> project. Searching for the ‚ÄúNews Channel‚Äù in the source code, we find <a href="https://github.com/WiiLink24/WiiLink24-Patcher/blob/033ccb9a3be574dad76f57ac82f3af226eef0fdb/WiiLink-Patcher-CLI/patch.cs#L538">this line in patch.cs</a> which references a <a href="https://en.wikipedia.org/wiki/VCDIFF">VCDIFF</a> encoded <code>News_1.delta</code> patch.</p>
<blockquote>
<p>Side note - it‚Äôs only while writing this blog post that I realized I had been looking at the ‚Äúwrong‚Äù repo; WiiLink‚Äôs guide now recommends using the Python-based <a href="https://github.com/WiiLink24/WiiLink-Patcher-GUI">WiiLink-Patcher-GUI</a> instead of the CLI patcher.</p>
</blockquote>
<!-- > This newer repo which uses a `bsdiff` based patch (see [news channel specific data](https://github.com/WiiLink24/WiiLink-Patcher-GUI/blob/master/data/patches.json#L89) in JSON, used by the [download_patch](https://github.com/WiiLink24/WiiLink-Patcher-GUI/blob/6a51dff3c28aa5d2687ff0f97c18aa2eb93f047a/setup/download.py#L274) function). -->
<p>After downloading the <code>.delta</code> file locally, we can use the <a href="https://en.wikipedia.org/wiki/Xdelta">xdelta</a> CLI to print out some information on what the patch is supposed to do:</p>
<div><pre tabindex="0"><code data-lang="bash"><span><span>xdelta3 printdelta News_1.delta
</span></span><span><span>
</span></span><span><span>VCDIFF version:               <span>0</span>
</span></span><span><span>VCDIFF header size:           <span>29</span>
</span></span><span><span>VCDIFF header indicator:      VCD_APPHEADER
</span></span><span><span>VCDIFF secondary compressor:  lzma
</span></span><span><span>VCDIFF application header:    news.dol//0000000b.app/
</span></span><span><span>XDELTA filename <span>(</span>output<span>)</span>:     news.dol
</span></span><span><span>XDELTA filename <span>(</span><span>source</span><span>)</span>:     0000000b.app
</span></span><span><span>...
</span></span></code></pre></div><p>Okay, so we‚Äôre looking for a <code>0000000b.app</code> file and want to save the patched binary as <code>news.dol</code>. Based on the WiiLink install instructions, we know we should be dealing with a <code>WAD</code> file, so let‚Äôs keep digging to see if we can find out where <code>0000000b.app</code> might be hiding.</p>
<blockquote>
<p>Learn more about the WAD file format on <a href="https://wiibrew.org/wiki/WAD_files">wiibrew.org</a>.</p>
</blockquote>
<p>From the repo‚Äôs <code>README.md</code>, we know the patcher uses <a href="https://github.com/TheShadowEevee/libWiiSharp">libWiiSharp</a> for it‚Äôs WAD file management during the file patching processing (<a href="(https://github.com/WiiLink24/WiiLink24-Patcher/blob/033ccb9a3be574dad76f57ac82f3af226eef0fdb/WiiLink-Patcher-CLI/patch.cs#L396)">source</a>). But at this point, I‚Äôd rather avoid using C# if I can. And besides, I know for a fact we‚Äôll want to use Go in order to more easily leverage existing tooling from the WiiLink team.</p>
<p>Thankfully, there‚Äôs a really handy Go library called <a href="https://pkg.go.dev/github.com/wii-tools/wadlib">wadlib</a> that comes to the rescue here. We‚Äôll be using it for all our WAD management needs.</p>
<p>So, where is <code>0000000b.app</code>? Looking at LibWiiSharp‚Äôs <code>WAD.cs</code> file, we can spot how it unpacks <code>.app</code> files from a WAD file. Namely, it defaults to using the numeric ‚ÄúContent ID‚Äù inside each ‚ÄúContent‚Äù metadata and then converts it to an 8-digit hexadecimal string (<a href="https://github.com/TheShadowEevee/libWiiSharp/blob/23d477a3f83d0400d73393b2febde7912968b1dc/WAD.cs#L863-L874">source</a>).</p>
<blockquote>
<p>You can read more about Title metadata (‚ÄúTMD‚Äù) and Content metadata (‚ÄúCMD‚Äù) on <a href="https://wiibrew.org/wiki/Title_metadata#Content_metadata_(CMD)">wiibrew.org</a></p>
</blockquote>
<p>Armed with this knowledge, we can use <code>wadlib</code> to create a quick file extraction script and see if we can find our <code>0000000b.app</code>. It can go something like this:</p>
<div><pre tabindex="0"><code data-lang="go"><span><span><span>// ignore error handling for brevity</span><span>
</span></span></span><span><span><span>wad</span><span>,</span><span> </span><span>_</span><span> </span><span>:=</span><span> </span><span>wadlib</span><span>.</span><span>LoadWADFromFile</span><span>(</span><span>&#34;news.wad&#34;</span><span>)</span><span>
</span></span></span><span><span><span>titleMetadata</span><span> </span><span>:=</span><span> </span><span>wad</span><span>.</span><span>TMD</span><span>
</span></span></span><span><span><span>contentMetadata</span><span> </span><span>:=</span><span> </span><span>titleMetadata</span><span>.</span><span>Contents</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>outputDir</span><span> </span><span>:=</span><span> </span><span>&#34;extracted_wad/&#34;</span><span>
</span></span></span><span><span><span>os</span><span>.</span><span>MkdirAll</span><span>(</span><span>outputDir</span><span>,</span><span> </span><span>0755</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>for</span><span> </span><span>i</span><span> </span><span>:=</span><span> </span><span>0</span><span>;</span><span> </span><span>i</span><span> </span><span>&lt;</span><span> </span><span>len</span><span>(</span><span>wad</span><span>.</span><span>Data</span><span>);</span><span> </span><span>i</span><span>++</span><span> </span><span>{</span><span>
</span></span></span><span><span><span>  </span><span>data</span><span>,</span><span> </span><span>_</span><span> </span><span>:=</span><span> </span><span>wad</span><span>.</span><span>GetContent</span><span>(</span><span>i</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>  </span><span>contentID</span><span> </span><span>:=</span><span> </span><span>contentMetadata</span><span>[</span><span>i</span><span>].</span><span>ID</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>  </span><span>// &#34;%08x&#34; means 0-padded 8 digit hex</span><span>
</span></span></span><span><span><span>  </span><span>filename</span><span> </span><span>:=</span><span> </span><span>filepath</span><span>.</span><span>Join</span><span>(</span><span>outputDir</span><span>,</span><span> </span><span>fmt</span><span>.</span><span>Sprintf</span><span>(</span><span>&#34;%08x.app&#34;</span><span>,</span><span> </span><span>contentID</span><span>))</span><span>
</span></span></span><span><span><span>  </span><span>_</span><span> </span><span>=</span><span> </span><span>os</span><span>.</span><span>WriteFile</span><span>(</span><span>filename</span><span>,</span><span> </span><span>data</span><span>,</span><span> </span><span>0644</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>  </span><span>log</span><span>.</span><span>Printf</span><span>(</span><span>&#34;Extracted: %08x.app (size: %d bytes)&#34;</span><span>,</span><span>
</span></span></span><span><span><span>    </span><span>contentID</span><span>,</span><span> </span><span>len</span><span>(</span><span>data</span><span>))</span><span>
</span></span></span><span><span><span>}</span><span>
</span></span></span></code></pre></div><!--  ([obtainable from Vimm's lair](https://vimm.net/vault/36744)) -->
<p>When <code>news.wad</code> is the official (v7) News Channel WAD file, this script successfully extracts 12 <code>.app</code> files.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/extracted-wads.png" alt="macos finder view showing extracted files"/>
<p>There‚Äôs definitely a <code>0000000b.app</code> there, but could it be the file we‚Äôre looking for?</p>
<p>What we really need to do at this point is go ahead and apply the <code>News_1.delta</code> patch to this <code>0000000b.app</code> file manually. That way, we can compare the before/after binaries and see what changed. We can use <code>xdelta</code> again to actually apply the patch. Running <code>xdelta3 --help</code> says:</p>
<div><pre tabindex="0"><code data-lang="bash"><span><span>apply patch:
</span></span><span><span>  xdelta3.exe -d -s old_file delta_file decoded_new_file
</span></span></code></pre></div><p>So we can go ahead and run:</p>
<div><pre tabindex="0"><code data-lang="bash"><span><span>xdelta3 -d -s extracted_wad/0000000b.app News_1.delta news.dol
</span></span></code></pre></div><p>And that‚Ä¶ seemed to work? We have a <code>news.dol</code> file, as expected. Now what?</p>
<h3 id="investigating-binary-file-changes">Investigating binary file changes</h3>
<p>We could do a binary diff of these files and start going through each change, but we already know at least one thing that should have changed based on our previous <code>mitmproxy</code> experiments: instead of performing requests to ‚Äúnews.wapp.wii.com‚Äù, the patched WAD should instead use ‚Äúnews.wiilink.ca‚Äù.</p>
<p>Using a tool like <a href="https://hexfiend.com/">Hex Fiend</a> (which also has binary diffing capabilities in case we need them), we can try searching for text inside the binary. If we try searching for ‚Äúnews.wapp.wii.com‚Äù on the original <code>0000000b.app</code> file, we can actually find a match!</p>
<img src="https://debamitro.github.io/img/wiinews-pr/original-url-in-binary.png" alt="hex fiend UI showing original Wii News Channel data URL in search results"/>
<p>Sure enough, if we inspect the patched <code>news.dol</code> file we will find no mention of the original URL. Instead, the ‚Äú<a href="http://news.wiilink.ca">http://news.wiilink.ca</a>‚Äù domain is visible at the same location (offset <code>0x1AC37C</code>).</p>
<img src="https://debamitro.github.io/img/wiinews-pr/patched-url-in-binary.png" alt="hex fiend UI showing modified Wii News Channel data URL in search results"/>
<blockquote>
<p>Note that the URL contains only two printf-style format strings (<code>%d</code> and <code>%03d</code>); the News Channel itself must be appending the hourly suffix (like <code>.00</code>) when fetching data.</p>
</blockquote>
<p>If we‚Äôre lucky, simply overwriting the binary file‚Äôs original URL with our own custom URL might do the trick. It‚Äôs worth a try!</p>
<p>In order to validate this hypothesis, I wrote a small Go utility for performing the necessary text replacement. Here‚Äôs an excerpt of the important bits:</p>
<div><pre tabindex="0"><code data-lang="go"><span><span><span>// ignoring error handling for brevity</span><span>
</span></span></span><span><span><span>const</span><span> </span><span>OriginalURL</span><span> </span><span>=</span><span> </span><span>&#34;http://news.wapp.wii.com/v2/%d/%03d/news.bin&#34;</span><span>
</span></span></span><span><span><span>const</span><span> </span><span>NewURL</span><span> </span><span>=</span><span> </span><span>&#34;http://wii.rauln.com/news/%d/%03d/news.bin&#34;</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>wad</span><span>,</span><span> </span><span>_</span><span> </span><span>:=</span><span> </span><span>wadlib</span><span>.</span><span>LoadWADFromFile</span><span>(</span><span>wadPath</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// Get decrypted content at index 1 (record with ID &#34;0000000b&#34;)</span><span>
</span></span></span><span><span><span>content</span><span>,</span><span> </span><span>_</span><span> </span><span>:=</span><span> </span><span>wad</span><span>.</span><span>GetContent</span><span>(</span><span>1</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// byte slice of 44 bytes</span><span>
</span></span></span><span><span><span>originalContent</span><span> </span><span>:=</span><span> </span><span>[]</span><span>byte</span><span>(</span><span>OriginalURL</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// 43 bytes in our URL&#39;s case</span><span>
</span></span></span><span><span><span>newContent</span><span> </span><span>:=</span><span> </span><span>[]</span><span>byte</span><span>(</span><span>NewURL</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// Pad the new URL to match original length (44 bytes)</span><span>
</span></span></span><span><span><span>paddedURL</span><span> </span><span>:=</span><span> </span><span>make</span><span>([]</span><span>byte</span><span>,</span><span> </span><span>len</span><span>(</span><span>originalContent</span><span>))</span><span>
</span></span></span><span><span><span>copy</span><span>(</span><span>paddedURL</span><span>,</span><span> </span><span>newContent</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// Find the offset (index) of the URL to patch inside the byte slice</span><span>
</span></span></span><span><span><span>offset</span><span> </span><span>:=</span><span> </span><span>bytes</span><span>.</span><span>Index</span><span>(</span><span>content</span><span>,</span><span> </span><span>originalContent</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// Patch the URL</span><span>
</span></span></span><span><span><span>copy</span><span>(</span><span>content</span><span>[</span><span>offset</span><span>:</span><span>offset</span><span>+</span><span>len</span><span>(</span><span>originalContent</span><span>)],</span><span> </span><span>paddedURL</span><span>)</span><span>
</span></span></span><span><span><span>_</span><span> </span><span>=</span><span> </span><span>wad</span><span>.</span><span>UpdateContent</span><span>(</span><span>1</span><span>,</span><span> </span><span>content</span><span>)</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>// Save the updated WAD file</span><span>
</span></span></span><span><span><span>_</span><span> </span><span>=</span><span> </span><span>os</span><span>.</span><span>WriteFile</span><span>(</span><span>outputPath</span><span>,</span><span> </span><span>wadBytes</span><span>,</span><span> </span><span>0644</span><span>)</span><span>
</span></span></span></code></pre></div><blockquote>
<p>Check out the full source on GitHub: <a href="https://github.com/rnegron/WiiNewsPR-Patcher">WiiNewsPR-Patcher</a></p>
</blockquote>
<p>If we run the utility like:</p>
<div><pre tabindex="0"><code data-lang="bash"><span><span>go build
</span></span><span><span>wiinewspr-patcher news.wad patched_news.wad
</span></span></code></pre></div><p>It should perform the URL rewriting in memory and provide us with a valid WAD file (<code>patched_news.wad</code>) we can then go ahead and install on Wii hardware.</p>
<p>We can install the patched WAD on our Wii console using <a href="https://wii.hacks.guide/yawmme">YAWM (ModMii Edition)</a>.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/yawm-patched.png" alt="yawmme showing patched WAD installation succeeded"/>
<p>Finally, we can go back to running <code>mitmproxy</code> and opening the newly patched News Channel. Once the channel shows the ‚ÄúDownloading‚Ä¶‚Äù splash screen, we‚Äôll spot requests going out to our expected domain.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/custom-request-failed.png" alt="mitmproxy showing http 404 on our custom server from a News Channel request"/>
<p>It works! Now all we need is to‚Ä¶ actually generate valid news files for the News Channel to work.</p>
<h2 id="step-2-generating-news-channel-compatible-news-files">Step 2: Generating News Channel compatible news files</h2>
<p>I mentioned previously that I knew using Go would come in handy later, and it‚Äôs specifically because the WiiLink team has a project called <a href="https://github.com/WiiLink24/NewsChannel">NewsChannel</a> written in Go which contains the source code for generating the binary news files they serve from ‚Äúnews.wiilink.ca‚Äù.</p>
<p>I‚Äôm not going to go over all the implementation details here. I just want to highlight some of the main file creation steps in case you‚Äôd like to read more:</p>
<ul>
<li>obtain country-specific configuration (<a href="https://github.com/WiiLink24/NewsChannel/blob/cd676d7aa8f9b80ab9ee4fa32c21a80d3a65c38d/countries.json">source</a>)</li>
<li>obtain articles and metadata from configured sources (like NHK, <a href="https://github.com/WiiLink24/NewsChannel/blob/cd676d7aa8f9b80ab9ee4fa32c21a80d3a65c38d/news/nhk/articles.go#L7-L46">source</a>)</li>
<li>process all data in a specific order into a bytes buffer (<a href="https://github.com/WiiLink24/NewsChannel/blob/cd676d7aa8f9b80ab9ee4fa32c21a80d3a65c38d/main.go#L77-L90">source</a>)</li>
<li>compress the data using LZ10, sign it with RSA, then write to disk (<a href="https://github.com/WiiLink24/NewsChannel/blob/cd676d7aa8f9b80ab9ee4fa32c21a80d3a65c38d/main.go#L126-L142">source</a>)
<ul>
<li>the file name is written using a specific string interpolation (<a href="https://github.com/WiiLink24/NewsChannel/blob/cd676d7aa8f9b80ab9ee4fa32c21a80d3a65c38d/main.go#L108">source</a>, this is how I first found out about the language/country codes used in the News Channel data URL!)</li>
</ul>
</li>
</ul>
<blockquote>
<p>Fun fact: LZ10 is apparently a Nintendo-specific variant of the <a href="https://en.wikipedia.org/wiki/LZ77_and_LZ78">LZ77</a> compression algorithm, used in some form or another on Game Boy Advance, Nintendo DS and Wii systems. <a href="https://github.com/wii-tools/lzx/blob/4c1183c96cc616e6b3312072e7f1ad984edd109f/lz10/compress.go">wii-tools/lzx</a> has the Go source for the LZ10 compression used here.</p>
</blockquote>
<p>In any case, for our purposes, it‚Äôs doing more than we need in terms of source handling: it can generate news binaries from a variety of sources and supports different languages and regions.</p>
<p>For this project, I am making the following assumptions and tradeoffs:</p>
<ul>
<li>
<p>I will be using ‚ÄúEnglish‚Äù as the language and ‚ÄúUS‚Äù as the country code for the source URL path since my Wii console is configured as such. There is no separate Puerto Rico country code option, which is curious considering that there is a separate option for the US Virgin Islands.</p>
</li>
<li>
<p>I am not interested in supporting any other news sources from around the world, so the ‚ÄúGlobe‚Äù feature for the News Channel will not be useful.</p>
</li>
<li>
<p>I‚Äôm hardcoding the latitude and longitude of Puerto Rico‚Äôs capital into the binary file to avoid having to process or guess location data from each article entry.</p>
</li>
</ul>
<h3 id="modifying-wiilinks-generator-to-support-puerto-rican-news">Modifying WiiLink‚Äôs generator to support Puerto Rican news</h3>
<p>I went ahead and forked the <code>NewsChannel</code> repo into <a href="https://github.com/rnegron/WiiNewsPR">WiiNewsPR</a>, added flag support to control article caching and binary output paths (you‚Äôll see why this was necessary soon), removed all the existing sources and added a new one: <a href="https://www.elnuevodia.com/">El Nuevo D√≠a (‚ÄúENDI‚Äù)</a>.</p>
<p>I picked ENDI only because it‚Äôs the only local newspaper website I could find which still <a href="https://www.elnuevodia.com/rss/">supports RSS</a>. Unfortunately, the feeds only contain a snippet of the actual article. On the bright side, most articles do contain images and we can use separate feeds to help categorize articles in the News Channel (<a href="https://github.com/rnegron/WiiNewsPR/blob/11df0e242bb1f4134e61ff0b35587372a5fd0564/news/endi/articles.go#L72-L79">source</a>).</p>
<blockquote>
<p>By the way, I experimented with <a href="https://github.com/advancedlogic/GoOse">GoOse</a> for (spanish language) article extraction on other news websites and the results were‚Ä¶ unsatisfying, to say the least.</p>
</blockquote>
<h3 id="final-setup-requirements-for-proper-news-channel-support">Final setup requirements for proper News Channel support</h3>
<p>Two quick things we‚Äôll need in order to get this all to work:</p>
<ol>
<li>We need to sign each binary news file with a custom RSA key for the Wii to process the file (<a href="https://github.com/rnegron/WiiNewsPR/blob/11df0e242bb1f4134e61ff0b35587372a5fd0564/utils.go#L20">source</a>). We can use <code>openssl</code> for this (note the <code>-traditional</code> option):</li>
</ol>
<div><pre tabindex="0"><code data-lang="bash"><span><span> openssl genrsa -traditional -out Private.pem <span>2048</span>
</span></span></code></pre></div><ol start="2">
<li>We need a (really) low quality logo for our source. <a href="https://imagemagick.org/script/command-line-processing.php">ImageMagick</a> easily solves for this:</li>
</ol>
<div><pre tabindex="0"><code data-lang="bash"><span><span>magick logo.svg -quality <span>30</span> -resize 200x200 -strip logo.jpg
</span></span></code></pre></div><p>Then, we can use <a href="https://pkg.go.dev/embed">Go embeds</a> to include the logo in the Go binary (<a href="https://github.com/rnegron/WiiNewsPR/blob/11df0e242bb1f4134e61ff0b35587372a5fd0564/news/endi/articles.go#L18-L19">source</a>).</p>
<p>Finally, we can build the Go binary and run it in order to generate a news binary in <code>./v2/1/049</code>:</p>
<p>This successfully generates a <code>news.bin.NN</code> file.</p>
<p>Now we just need 24 of these, since the News Channel will actually fail to load if not provided with all 24 files. We could run this script every hour for the next 24 hours‚Ä¶ or, we could take the shortcut of copying the current hour‚Äôs file into all other hourly values.</p>
<p>Regardless, it‚Äôs about time to test out all this effort. With 24 files uploaded to our storage provider (AWS S3), and the patched News Channel configured to fetch these from our custom domain, we can start up the channel and observe the fruits of our labor.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/custom-requests-success.png" alt="mitmproxy showing successful http 200 requests on our custom server from a News Channel request"/>
<p>After the (slow!) requests finish one by one, seeing the articles pop up was immensely satisfying. Being able to tinker with and learn more about these nostalgic consoles so many years later is a real joy for me.</p>
<img src="https://debamitro.github.io/img/wiinews-pr/wiinewspr-business-section.png" alt=""/>
<h2 id="bonus-step-automating-hourly-news-updates-with-aws-lambda">Bonus step: Automating hourly news updates with AWS Lambda</h2>
<p>Copying files into the S3 storage bucket is all well and good, but it would be great to have a continuously-updating, hands-off solution that generates the news binaries for us. A simple (and basically free) way to solve for this would be to bundle up the <code>WiiNewsPR</code> Go executable into an AWS Lambda function and have that run hourly via EventBride, and then uploading the generated news binaries over to our storage bucket.</p>
<p>Here is where the extra flags for <code>WiiNewsPR</code> come in: we need to be able to control file creation because <code>/tmp</code> is a Lambda‚Äôs only writeable file system.</p>
<p>Here is a snippet of the Lambda handler logic:</p>
<div><pre tabindex="0"><code data-lang="go"><span><span><span>func</span><span> </span><span>Handler</span><span>(</span><span>ctx</span><span> </span><span>context</span><span>.</span><span>Context</span><span>)</span><span> </span><span>error</span><span> </span><span>{</span><span>
</span></span></span><span><span><span>  </span><span>cmd</span><span> </span><span>:=</span><span> </span><span>exec</span><span>.</span><span>CommandContext</span><span>(</span><span>ctx</span><span>,</span><span> </span><span>&#34;./WiiNewsPR&#34;</span><span>,</span><span> </span><span>&#34;-o&#34;</span><span>,</span><span> </span><span>&#34;/tmp&#34;</span><span>,</span><span> </span><span>&#34;-c&#34;</span><span>,</span><span> </span><span>&#34;/tmp/cache&#34;</span><span>)</span><span>
</span></span></span><span><span><span>  </span><span>// ...</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>  </span><span>_</span><span>,</span><span> </span><span>err</span><span> </span><span>=</span><span> </span><span>uploader</span><span>.</span><span>Upload</span><span>(</span><span>ctx</span><span>,</span><span> </span><span>&amp;</span><span>s3</span><span>.</span><span>PutObjectInput</span><span>{</span><span>
</span></span></span><span><span><span>		</span><span>Bucket</span><span>:</span><span>      </span><span>aws</span><span>.</span><span>String</span><span>(</span><span>bucketName</span><span>),</span><span>
</span></span></span><span><span><span>		</span><span>Key</span><span>:</span><span>         </span><span>aws</span><span>.</span><span>String</span><span>(</span><span>fmt</span><span>.</span><span>Sprintf</span><span>(</span><span>&#34;%snews.bin.%s&#34;</span><span>,</span><span> </span><span>keyPrefix</span><span>,</span><span> </span><span>hour</span><span>)),</span><span>
</span></span></span><span><span><span>		</span><span>Body</span><span>:</span><span>        </span><span>file</span><span>,</span><span>
</span></span></span><span><span><span>		</span><span>ContentType</span><span>:</span><span> </span><span>aws</span><span>.</span><span>String</span><span>(</span><span>&#34;application/octet-stream&#34;</span><span>),</span><span>
</span></span></span><span><span><span>	</span><span>})</span><span>
</span></span></span><span><span><span>  </span><span>// ...</span><span>
</span></span></span><span><span><span>}</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>func</span><span> </span><span>main</span><span>()</span><span> </span><span>{</span><span>
</span></span></span><span><span><span>  </span><span>lambda</span><span>.</span><span>Start</span><span>(</span><span>Handler</span><span>)</span><span>
</span></span></span><span><span><span>}</span><span>
</span></span></span></code></pre></div><blockquote>
<p>See full Lambda handler source on GitHub: <a href="https://github.com/rnegron/WiiNewsPR/blob/master/deploy/handler.go">handler.go</a></p>
</blockquote>
<p>We can then leverage the <a href="https://www.serverless.com/">Serverless</a> framework for a quick infra-as-code setup. Here is a snippet of the configuration:</p>
<div><pre tabindex="0"><code data-lang="yml"><span><span><span>service</span><span>:</span><span> </span><span>wiinewspr-generator</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>provider</span><span>:</span><span>
</span></span></span><span><span><span>  </span><span>name</span><span>:</span><span> </span><span>aws</span><span>
</span></span></span><span><span><span>  </span><span># ...</span><span>
</span></span></span><span><span><span>  </span><span>environment</span><span>:</span><span>
</span></span></span><span><span><span>    </span><span># ...</span><span>
</span></span></span><span><span><span>    </span><span>TZ</span><span>:</span><span> </span><span>America/Puerto_Rico</span><span> </span><span># we need Lambda to generate files postfixed with the correct &#34;currentHour&#34;</span><span>
</span></span></span><span><span><span>    </span><span># ...</span><span>
</span></span></span><span><span><span>    </span><span>events</span><span>:</span><span>
</span></span></span><span><span><span>      </span>- <span>schedule</span><span>:</span><span>
</span></span></span><span><span><span>          </span><span>rate</span><span>:</span><span> </span><span>cron(30 * * * ? *)</span><span> </span><span># run every hour:30</span><span>
</span></span></span><span><span><span>          </span><span>name</span><span>:</span><span> </span><span>wiinewspr-every-30pasthour</span><span>
</span></span></span><span><span><span>          </span><span>description</span><span>:</span><span> </span><span>Generate Wii News PR binary file every hour at 30 minutes past</span><span>
</span></span></span><span><span><span>package</span><span>:</span><span>
</span></span></span><span><span><span>  </span><span>patterns</span><span>:</span><span>
</span></span></span><span><span><span>    </span>- <span>bootstrap</span><span> </span><span># compiled Lambda handler</span><span>
</span></span></span><span><span><span>    </span>- <span>WiiNewsPR</span><span> </span><span># compiled binary news generator</span><span>
</span></span></span><span><span><span>    </span>- <span>../Private.pem</span><span> </span><span># we need to include the Private.pem file for file signing</span><span>
</span></span></span></code></pre></div><blockquote>
<p>See full <code>serverless</code> configuration on GitHub: <a href="https://github.com/rnegron/WiiNewsPR/blob/master/deploy/serverless.yml">serverless.yml</a></p>
</blockquote>
<p>Some things to call out here:</p>
<ul>
<li>We want to make sure to run the Lambda in Puerto Rico‚Äôs timezone so that <code>time.Now()</code> returns the expected hourly integer.</li>
<li>We want to give the Lambda a higher than expected <code>memorySize</code> so that its CPU scales accordingly; it turns out that <code>lz10</code> compression is a big bottleneck on the smallest supported Lambda CPU and can easily time out at 30 seconds.</li>
</ul>
<p>If we leave this setup running for 24 hours, our storage bucket will get populated with 24 files and continuously be updated with the latest news!</p>
<img src="https://debamitro.github.io/img/wiinews-pr/hourly-generated-files.png" alt="s3 bucket view showing binary news files generated automatically at hourly intervals"/>
<p>Now I can get up in the morning, grab a coffee, and browse the local news on my Nintendo Wii like it‚Äôs 2007.</p>
<p>Thanks for reading!</p>
<h2 id="credits">Credits</h2>
<p>This experiment would have likely ended in disappointment if not for the amazing work by the Wii homebrew community, specifically: <a href="https://github.com/riiconnect24">RiiConnect24 Team</a>, <a href="https://github.com/wiilink24">WiiLink Team</a> and <a href="https://wiibrew.org/wiki/Main_Page">wiibrew.org Contributors</a>.</p>
<!--
* The `main` package contains the `news` type t
* `sources.go` defines the `GetNewsArticles` method for the `news` type, along with source-specific metadata like logo
* The [news/](https://github.com/WiiLink24/NewsChannel/tree/cd676d7aa8f9b80ab9ee4fa32c21a80d3a65c38d/news) subdirectory contains code for implement the `GetArticles`
* The News Channel reads binary files containing (created using methods like `MakeSourceTable` and `MakeArticleTable`) -->
<!-- ### Dolphin

- `Tools` -&gt; `Perform Online System Update`

- `Tools` -&gt; `Install WAD...`

- `Tools` -&gt; `Load Wii System Menu 4.3U`

The Dolphin emulator

- Enable System Menu and update -->

</article>

      </div></div>
  </body>
</html>
