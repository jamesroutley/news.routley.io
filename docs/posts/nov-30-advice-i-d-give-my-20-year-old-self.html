<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://tinylogger.com/max/8cS06BuAXXDBOo1a">Original</a>
    <h1>Nov 30: Advice I&#39;d Give my 20-year Old Self</h1>
    
    <div id="readability-page-1" class="page"><div><p>SQLite is cool now. DHH uses it, Laravel defaults to it. Here is a list of
<em>sensible defaults</em> when using sqlite.</p>
<!-- more -->
<h2>The whys?</h2>
<pre tabindex="0"><code><span><span>PRAGMA journal_mode </span><span>=</span><span> WAL;</span></span></code></pre>
<p><strong>Why?</strong>: Allows concurrent reads and writes, making it more suitable for web applications with multiple users accessing the database simultaneously.</p>
<pre tabindex="0"><code><span><span>PRAGMA synchronous </span><span>=</span><span> NORMAL;</span></span></code></pre>
<p><strong>Why?</strong>: Balances performance and data safety by ensuring that data is written to disk in a reasonable time frame without slowing down writes as much as <code>FULL</code> mode.</p>
<pre tabindex="0"><code><span><span>PRAGMA busy_timeout </span><span>=</span><span> 5000</span><span>;</span></span></code></pre>
<p><strong>Why?</strong>: Prevents &#34;database is locked&#34; errors by giving SQLite 5 seconds to wait for a locked resource before returning an error, useful for handling multiple concurrent accesses.</p>
<pre tabindex="0"><code><span><span>PRAGMA cache_size </span><span>=</span><span> -</span><span>20000</span><span>;</span></span></code></pre>
<p><strong>Why?</strong>: Sets the cache size to 20MB, allowing more data to be cached in memory, improving query performance by reducing the number of disk reads.</p>
<pre tabindex="0"><code><span><span>PRAGMA foreign_keys </span><span>=</span><span> ON</span><span>;</span></span></code></pre>
<p><strong>Why?</strong>: Ensures referential integrity by enforcing foreign key constraints, critical for maintaining consistent relationships between tables (e.g., users, posts, and comments).</p>
<pre tabindex="0"><code><span><span>PRAGMA auto_vacuum </span><span>=</span><span> INCREMENTAL</span><span>;</span></span></code></pre>
<p><strong>Why?</strong>: Reclaims disk space gradually as rows are deleted, instead of performing a full vacuum, reducing performance impact during database operations.</p>
<pre tabindex="0"><code><span><span>PRAGMA temp_store </span><span>=</span><span> MEMORY;</span></span></code></pre>
<p><strong>Why?</strong>: Stores temporary tables and other temporary data in memory, improving the performance of operations like sorting and indexing that are common in web applications.</p>
<pre tabindex="0"><code><span><span>PRAGMA mmap_size </span><span>=</span><span> 2147483648</span><span>;</span></span></code></pre>
<p><strong>Why?</strong>: Uses memory-mapped I/O with a size of 2GB, which can speed up database access by reducing disk I/O, especially beneficial for large databases with frequent reads and writes.</p>
<pre tabindex="0"><code><span><span>PRAGMA page_size </span><span>=</span><span> 8192</span><span>;</span></span></code></pre>
<p><strong>Why?</strong>: Sets a page size of 8KB, which provides a balance between memory usage and disk I/O performance for a forum database that handles many reads and writes.</p>
<h2>Copy paste</h2>
<p>For your convenience.</p>
<pre tabindex="0"><code><span><span>-- Set the journal mode to Write-Ahead Logging for concurrency</span></span>
<span><span>PRAGMA journal_mode </span><span>=</span><span> WAL;</span></span>
<span></span>
<span><span>-- Set synchronous mode to NORMAL for performance and data safety balance</span></span>
<span><span>PRAGMA synchronous </span><span>=</span><span> NORMAL;</span></span>
<span></span>
<span><span>-- Set busy timeout to 5 seconds to avoid &#34;database is locked&#34; errors</span></span>
<span><span>PRAGMA busy_timeout </span><span>=</span><span> 5000</span><span>;</span></span>
<span></span>
<span><span>-- Set cache size to 20MB for faster data access</span></span>
<span><span>PRAGMA cache_size </span><span>=</span><span> -</span><span>20000</span><span>;</span></span>
<span></span>
<span><span>-- Enable foreign key constraint enforcement</span></span>
<span><span>PRAGMA foreign_keys </span><span>=</span><span> ON</span><span>;</span></span>
<span></span>
<span><span>-- Enable auto vacuuming and set it to incremental mode for gradual space reclaiming</span></span>
<span><span>PRAGMA auto_vacuum </span><span>=</span><span> INCREMENTAL</span><span>;</span></span>
<span></span>
<span><span>-- Store temporary tables and data in memory for better performance</span></span>
<span><span>PRAGMA temp_store </span><span>=</span><span> MEMORY;</span></span>
<span></span>
<span><span>-- Set the mmap_size to 2GB for faster read/write access using memory-mapped I/O</span></span>
<span><span>PRAGMA mmap_size </span><span>=</span><span> 2147483648</span><span>;</span></span>
<span></span>
<span><span>-- Set the page size to 8KB for balanced memory usage and performance</span></span>
<span><span>PRAGMA page_size </span><span>=</span><span> 8192</span><span>;</span></span></code></pre>
</div></div>
  </body>
</html>
