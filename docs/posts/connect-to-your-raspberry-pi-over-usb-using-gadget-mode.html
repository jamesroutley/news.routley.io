<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://howchoo.com/pi/raspberry-pi-gadget-mode">Original</a>
    <h1>Connect to your Raspberry Pi over USB using gadget mode</h1>
    
    <div id="readability-page-1" class="page"><div><div><article><header><p><img alt="Raspberry Pi Gadget Mode" height="230" src="https://howchoo.com/images/placeholder-rectangle.svg" width="414"/></p><section id="intro"><div><p>We&#39;ve written previously about how to configure <a href="https://howchoo.com/g/ndy1zte2yjn/how-to-set-up-wifi-on-your-raspberry-pi-without-ethernet">WiFi</a> and <a href="https://howchoo.com/g/ote0ywmzywj/how-to-enable-ssh-on-raspbian-without-a-screen">SSH</a> on your Raspberry Pi without having to connect any peripheral devices (headless). As long as you&#39;re comfortable on the command line, this makes it much easier to work with your Pi.</p>
<nav></nav>
<p>Now, I&#39;ve been doing projects with Raspberry Pi&#39;s since the first version, and I only recently found out about a Linux feature that allows you to connect to the Pi directly over USB: it&#39;s called <strong>USB gadget mode</strong>. With &#34;gadget mode&#34; enabled, we don&#39;t need to configure the WiFi network or connect any peripheral devices, we simply connect the Pi to our computer with a USB cable, and now we&#39;ve got SSH access.</p>
<p>In this guide, I&#39;ll show you how enable gadget mode and connect to your Pi via USB.</p>
<p><em>Note: I believe this feature was initially enabled for the Pi Zero, and it does not work on earlier versions of the Pi. I have, however, tested with the Raspberry Pi 4, and it works as long as you connect via the USB-C connector.</em></p></div></section><div><div><p><i aria-hidden="true"></i> Howchoo is reader-supported. As an Amazon Associate, we may earn a small affiliate commission at no cost to you when you buy through our links.</p></div></div><nav id="table-of-contents"></nav></header></article><article><section></section><section><div><div><div><p>With Raspberry Pi OS installed on the SD card (and the SD card still mounted on your computer), you can use Finder or a shell to navigate to the boot directory. Now edit the file called <code>config.txt</code>, and append the following:</p>
<pre><code>dtoverlay=dwc2</code></pre>
<p>Save and exit.</p></div></div></div></section><section><div><div><div><p>We can SSH by simply adding an empty file called <code>ssh</code> directly in the boot directory.</p>
<p>On the command line, you can navigate to the boot directory and run:</p>
<pre><code>touch ssh</code></pre>
<p><em>Note: The file must be called &#34;ssh&#34; not &#34;SSH&#34; or &#34;ssh.txt&#34; or anything other than &#34;ssh&#34;.</em></p></div></div></div></section><section><div><div><div><p>Now, edit the file called <code>cmdline.txt</code>. Look for <code>rootwait</code>, and add <code>modules-load=dwc2,g_ether</code> immediately after. </p>
<p><em>Note the formatting of cmdline.txt is very strict. Commands are separated by spaces, and newlines are not allowed.</em></p>
<p>Here&#39;s an example of what my <code>cmdline.txt</code> file looks like, but you should not copy this. Simply add the required command mentioned above.</p>
<pre><code>console=serial0,115200 console=tty1 root=PARTUUID=6c586e13-02 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait modules-load=dwc2,g_ether quiet init=/usr/lib/raspi-config/init_resize.sh</code></pre>
<p>Save and exit.</p></div></div></div></section><section><div><div><div><p>That&#39;s it for configuration! Now you can eject the SD card, and insert it into the the Pi. Using a USB cable, connect to the Raspberry Pi from your computer.</p>
<p>After the Pi boots up (this will take a while initially), the Pi should appear as a USB Ethernet device, and you can SSH into it using:</p>
<pre><code>ssh pi@raspberrypi.local</code></pre>
<p>Enjoy!</p></div></div></div></section><div><div><div><p><img alt="Raspberry Pi Wireless Access Point" height="232" src="https://howchoo.com/images/placeholder-rectangle.svg" width="414"/></p><section id="next-up-preview"><p>Most users will be looking to use the on-board Wi-Fi to connect a Raspberry Pi to existing wireless networks.</p></section></div></div></div></article></div></div></div>
  </body>
</html>
