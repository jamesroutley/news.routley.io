<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://oldvcr.blogspot.com/2023/11/the-apple-network-servers-all-too.html">Original</a>
    <h1>The Apple Network Server&#39;s all-too-secret weapon (featuring PPC Toolbox)</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-2165139990214191915" itemprop="description articleBody"><p>
Most of my systems are microcomputers (and commensurately sized), though I do have some moderately larger beasts: you&#39;ve met </p><tt>homer</tt><p>, my <a href="http://oldvcr.blogspot.com/2021/04/refurb-weekend-hewlett-packard-9000350.html">1987 HP 9000/350 rack system</a>, and Floodgap is powered by </p><tt>uppsala</tt><p>, a 2U-in-a-tower IBM POWER6 520 running AIX. But my first &#34;large&#34; machine, and indeed the first Unix server I ever personally owned, was this Apple Network Server 500. Its name is </p><tt>stockholm</tt><p>.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhpXhjafEOb7fQe9Xfw5e3ZJuiGHvA9YBQF5clc5wAmz_xJvE-qsPbBcz6LYLP5Cas_b0LyhXqGvCbKZnsDNoQd-le8S75-CyXv6SS8EK8dwPoqmwHjxmgvrfQ4HRcQ9bzSX4RzvT8_O8tfJjsWF9MLmdeA2MLqEaMRWcKMkyKvQVkpKDf6J-w7tzqid4A/s4080/PXL_20231104_223157360.jpg"><img alt="" data-original-height="4080" data-original-width="3072" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhpXhjafEOb7fQe9Xfw5e3ZJuiGHvA9YBQF5clc5wAmz_xJvE-qsPbBcz6LYLP5Cas_b0LyhXqGvCbKZnsDNoQd-le8S75-CyXv6SS8EK8dwPoqmwHjxmgvrfQ4HRcQ9bzSX4RzvT8_O8tfJjsWF9MLmdeA2MLqEaMRWcKMkyKvQVkpKDf6J-w7tzqid4A/s320/PXL_20231104_223157360.jpg"/></a></p><p>

A mini-fridge-sized server with its famous translucent blinkenlight-friendly front sliding door and oodles of drive trays, this $11,000+ box (almost $22,000 in 2023 dollars) sat forlorn and unused at the University I was employed with as an IT working stiff in 1997. The bookstore had bought it at a substantial academic discount for their UniVerse-based (a Pick descendant, now Rocket U2) point-of-sale system, but the vendor wouldn&#39;t support the hardware anymore after then-CEO Gil Amelio cancelled the ANS line, so it got dumped off as surplus in the service bay where it lurked in a corner.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEibXTA33dAdTp6GOmOlAA8O70Pi425eyPwb9W8MA32a0l2dhUGyJ2ngX9DyEqQcZ4wDB3V3HWYBfybVXi5W0sdmt8POZuzGVyCGLmma9lMPY6KeA7MUw-AhO2TndHXcfwqmfZaLmKyfWf6Y8rhlwgkDgg5dpC5dmjfyMV62jisCOZsYwUypkjeFQf64OCc/s1280/ansx.jpg"><img alt="" data-original-height="960" data-original-width="1280" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEibXTA33dAdTp6GOmOlAA8O70Pi425eyPwb9W8MA32a0l2dhUGyJ2ngX9DyEqQcZ4wDB3V3HWYBfybVXi5W0sdmt8POZuzGVyCGLmma9lMPY6KeA7MUw-AhO2TndHXcfwqmfZaLmKyfWf6Y8rhlwgkDgg5dpC5dmjfyMV62jisCOZsYwUypkjeFQf64OCc/s320/ansx.jpg" width="320"/></a></p><p>

As it was just sitting around, I got to use it as my personal server, shown here circa 1998 in my old office on a bad scan from a bad Polaroid. In this picture it&#39;s acting as a terminal server for my Commodore SX-64 with a CMD SwiftLink 6551 ACIA serial cartridge (the SX-64 is sitting on a parallel port switchbox because its handle got busted).
</p><p>
About a year later the University said they&#39;d throw it in with my consultant compensation because they wanted to get rid of it anyway, so it became officially mine, and I was delighted to have it. That machine, later upgraded to 200MHz and 512MB of parity FPM RAM, variously powered my E-mail and the Floodgap gopher and webservers from 2000 to 2012, and still does backup duty when the POWER6 has to be down for repairs.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHJOMHKDPgLHUOkUmGXCGiCqRoucNBtiT3SOLtpbkhXN62IKDlMnWmTL39wMFPC5_4rOdA-6WJNfeyiY4MLKtQrCyl-PyJPhnwJn6WYZhd9eKakLnoNS_wZHXo35DwcV022avqxIGTAGuQR3URP2_-Z91wEaP672MEEX2vTza0SuwSedJ8q6SKa3wjg0s/s2476/gw.jpg"><img alt="" data-original-height="2476" data-original-width="1920" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiHJOMHKDPgLHUOkUmGXCGiCqRoucNBtiT3SOLtpbkhXN62IKDlMnWmTL39wMFPC5_4rOdA-6WJNfeyiY4MLKtQrCyl-PyJPhnwJn6WYZhd9eKakLnoNS_wZHXo35DwcV022avqxIGTAGuQR3URP2_-Z91wEaP672MEEX2vTza0SuwSedJ8q6SKa3wjg0s/s320/gw.jpg"/></a></p><p>

That&#39;s because the POWER6 runs everything the ANS did — because the ANS <em>also</em> runs AIX. The ANS 500 and 700 were not Apple&#39;s first Unix-specific servers (that would be the Apple Workgroup Server 95, a Quadra 950 using a special PDS card that only worked with A/UX, Apple&#39;s own Unix with a bolted-on Mac compatibility layer), but they were Apple&#39;s first Mac derivatives that could not boot classic Mac OS at all and natively ran a non-Apple operating system. Indeed, most people treated it as exactly that, <a href="http://www.floodgap.com/retrobits/ans/reviews/macuser/">a big Unix server</a> from Apple, and at the time I did too.
</p><p>
However, there was a secret weapon hidden in ANS AIX most of us at the time never knew about. Built-in to the operating system was a fully Unix-native AppleTalk stack and support for receiving and sending Apple Events, surfaced in the form of Apple&#39;s disk administration tools and AppleShare. But Apple had a much more expansive vision for this feature: full server-client &#34;symbiotic&#34; applications that could do their number-crunching on the ANS and present the results on a desktop Mac. Using the Program-to-Program Communication Toolbox (&#34;PPCToolbox&#34;), and because AIX&#39;s throughput far exceeded anything the classic Mac OS ever could ever handle, an ANS could augment a whole bunch of Macs at once that didn&#39;t have to stop to do the work themselves.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiXa3nZy8VmxPDdJKi1R75LnQQcmGehut05BlQBJibDZ3mpmFH6jRiCYWCGQQ5B_9wjif0ohyphenhyphenb_uS89pLULVAnMTP1mKKfJ10Dgx28kAgD6JwBc9M6grVR2p-NnFCp94gHJv013nmXeIdfJ7GKnZXB9P7xXX_yDTVmcj2pZum2Z_NmlhVDGiS5u9EZHCEU/s2560/IMG_20231104_161054_HDR.jpg"><img alt="" data-original-height="2560" data-original-width="1920" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiXa3nZy8VmxPDdJKi1R75LnQQcmGehut05BlQBJibDZ3mpmFH6jRiCYWCGQQ5B_9wjif0ohyphenhyphenb_uS89pLULVAnMTP1mKKfJ10Dgx28kAgD6JwBc9M6grVR2p-NnFCp94gHJv013nmXeIdfJ7GKnZXB9P7xXX_yDTVmcj2pZum2Z_NmlhVDGiS5u9EZHCEU/s320/IMG_20231104_161054_HDR.jpg"/></a></p><p>

Well, today we&#39;re going to write one of those &#34;symbiotic&#34; applications doing something this little Mystic Color Classic could never efficiently do itself — accessing and processing a JSON API over TLS 1.3 — and demonstrate not only how such an client application looked on the Mac side, but also how the server component worked on the AIX side. If you&#39;re lucky enough to have an ANS running AIX too, you can even compile and run it yourself. But before we do that, it might be a little instructive to talk about how the Apple Network Server came to run AIX in the first place.
</p><p>
<a name="more"></a>

IBM AIX is nearly as old as the Mac OS, originating for the IBM RT PC in 1986, though early versions also ran on PS/2 systems and System/370 and /390 mainframes. AIX started as an early port of UNIX System V and is thus a true Unix descendent, but also merged in some code from BSD 4.2 and 4.3. The RT PC was powered by the IBM 801, considered to be the first modern RISC design, and in 1985 IBM Austin embarked on the AMERICA project to develop a successor. In 1990 IBM introduced the first RISC System/6000 machines, the desktop 7012-320, deskside 7013-530 and server 7015-920, all using a POWER1 CPU at 20MHz to run the new AIX 3.x.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh17fth5izC1ajSlb36ifS_CQrd4Zggsf9SaEFVQH7GWNdhI884sbf1-nyzBnsb2YSBqvriftB2D6fnK9B_TswG7_4In00rEAkYusUMffquh3IzybAX7XUAI-_bpQJSTaX8yyMhDv9Tg8R02a0kn84viMdTpfBbsPCVUwYiGqUV8e1GwEc6zEOvr6AOeQE/s2466/1991-07-08-content5.jpg"><img alt="" data-original-height="2466" data-original-width="1920" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh17fth5izC1ajSlb36ifS_CQrd4Zggsf9SaEFVQH7GWNdhI884sbf1-nyzBnsb2YSBqvriftB2D6fnK9B_TswG7_4In00rEAkYusUMffquh3IzybAX7XUAI-_bpQJSTaX8yyMhDv9Tg8R02a0kn84viMdTpfBbsPCVUwYiGqUV8e1GwEc6zEOvr6AOeQE/s320/1991-07-08-content5.jpg"/></a></p><p>

Over in Cupertino, Macintosh System 7 had just emerged in 1991 from shorter-term upgrades implemented by the Blue team, with longer-term ideas deferred to Pink, each famously named for the coloured index cards the concepts were written on. In July, industry rag front pages frothed breathlessly over IBM and Apple&#39;s partnership to turn Pink into a new object-oriented operating system, which would run on chips based on the RS/6000 POWER architecture via Motorola as a junior partner (yes, the AIM alliance was, at least initially, <em>not</em> the biggest news). This new architecture, of course, was what would become PowerPC. Apple promised a PowerPC-based Mac in less than three years (i.e., 1994) between $2000 and $3000, running Mac OS, A/UX and the &#34;Pink OS&#34; (what would become Taligent). At the same time, it would continue developing 68K Macs, and enhance the Mac OS using object-oriented features from the C++-based MacApp framework.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicrN414R_iJfQ1PG2JXbELn_8958YO8LMUPkAw-j2ETPtFzDvVg826ToUT1KdYvI-WltDMalTD2KXPTIF4qrtELKETYlUsE-mMTIl2MyScPPOtmh2sVbtnJXaq6NK0xKu4BTD1nBlauwQUPMEIZ9sCHcL_t65Steco01wff8jSJO2pel-NWqnGRax8K18/s1177/appleplusibmequalsibm.jpg"><img alt="" data-original-height="1063" data-original-width="1177" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEicrN414R_iJfQ1PG2JXbELn_8958YO8LMUPkAw-j2ETPtFzDvVg826ToUT1KdYvI-WltDMalTD2KXPTIF4qrtELKETYlUsE-mMTIl2MyScPPOtmh2sVbtnJXaq6NK0xKu4BTD1nBlauwQUPMEIZ9sCHcL_t65Steco01wff8jSJO2pel-NWqnGRax8K18/s320/appleplusibmequalsibm.jpg" width="320"/></a></p><p>

There were also wild ideas about their operating systems cross-pollinating each other. IBM incorporating AppleTalk seemed logical, but on the outlandish side Pink was supposed to be able to run OS/2 applications, likely on the questionable advice of IBM Grand Unified Theory of Systems insiders in their quest for a unified microkernel OS. (This particular concept eventually became the Workplace OS, culminating in the doomed OS/2 prototype for PowerPC that never ran on Apple hardware, and its cancellation in 1995.)

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjUSVzPkMPVFW-Kg-ulIihxtvhZYIjae21GFlwnw54BpWZ9KFqfa8h22BMP9CvTBLQptEBBLUqLUBw9a22DU0atuLJbqcnBrbz_el5G8cz2qq0UKDr9EFacl-Vdts4jPt3QgOH-Wr-G2EfStmS3W0RZNhiiS__twhiOceZcQKP6Kuf5SYvIUR1shXmHv7E/s800/aux4.jpg"><img alt="" data-original-height="605" data-original-width="800" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjUSVzPkMPVFW-Kg-ulIihxtvhZYIjae21GFlwnw54BpWZ9KFqfa8h22BMP9CvTBLQptEBBLUqLUBw9a22DU0atuLJbqcnBrbz_el5G8cz2qq0UKDr9EFacl-Vdts4jPt3QgOH-Wr-G2EfStmS3W0RZNhiiS__twhiOceZcQKP6Kuf5SYvIUR1shXmHv7E/s320/aux4.jpg" width="320"/></a></p><p>

The other weird announcement at the time was IBM and Apple codeveloping a new version of AIX that incorporated the Macintosh Toolbox. If that sounded a lot like a new <em>A/UX</em> instead, you get a prize. In November 1991 Apple announced A/UX 3.0 and detailed their plans for A/UX 4.x, intended to use an OSF/1 Mach kernel running on PowerPC, and by employing the same ABI (application binary interface) the new operating system could incorporate AIX compatibility. While IBM and Apple would continue to sell products <em>named</em> A/UX and AIX, they would instead be rebrands and value-adds (&#34;personalities&#34;) on top of the same core OS, internally named PowerOpen. (Note the QuickTime racecar video in this screenshot appropriately named &#34;openpower.&#34;)

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEji42iZCdRHa1eHNv16otgUsKxITk6u6TK-K-UVl9PZ5ip-OX3194lw5sWRuvzUX33o64aSVNaDxMyvHss5RfjOyTMO7PMVya3E1CGbbghb8ZS2ECeq0StO4J5Wrjm7ONSmkpgPcxlywMnC56Yafe_q7WvvfABhE5paP8ebeSGHQSREHjMsxi9FFmus8s0/s1800/appleready.jpg"><img alt="" data-original-height="789" data-original-width="1800" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEji42iZCdRHa1eHNv16otgUsKxITk6u6TK-K-UVl9PZ5ip-OX3194lw5sWRuvzUX33o64aSVNaDxMyvHss5RfjOyTMO7PMVya3E1CGbbghb8ZS2ECeq0StO4J5Wrjm7ONSmkpgPcxlywMnC56Yafe_q7WvvfABhE5paP8ebeSGHQSREHjMsxi9FFmus8s0/s320/appleready.jpg" width="320"/></a></p><p>

Subsequently, in late 1993 Apple made their first public announcement of a PowerPC Apple server. Up to this time the Workgroup Servers, produced by the Server Group under John Sculley, had all been rebadged desktop Macs with additional software and peripherals such as tape backup (or, in the AWS 95&#39;s case, its fast PDS cache-SCSI card). While Apple still planned to create such a server to run System 7.x, a higher end model would run PowerOpen A/UX 4 as a direct successor to the AWS 95. Early announcements like this one even claimed it would be Apple&#39;s first 64-bit system by using the new PowerPC 620. (The 620 was ultimately a disappointing performer and ended up eclipsed by the 604.)

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhaWJBxUuM6NK5yqO_mphJNxJArFdOIKLnL70-9xudM87kxr7eiut_mMhRyqdkhKmWDsK6FOzwzuTldtMcaeAwwppt899WxaAvMYTIwPpcs2uv1zPU3-O2Mwxo3lSVP4oY-wGDP7nhMwwWS8f96YTAVvhYS-JlPFhVOnpoa6fww4rI76NiKJU7fgYo47eo/s690/netware.jpg"><img alt="" data-original-height="611" data-original-width="690" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhaWJBxUuM6NK5yqO_mphJNxJArFdOIKLnL70-9xudM87kxr7eiut_mMhRyqdkhKmWDsK6FOzwzuTldtMcaeAwwppt899WxaAvMYTIwPpcs2uv1zPU3-O2Mwxo3lSVP4oY-wGDP7nhMwwWS8f96YTAVvhYS-JlPFhVOnpoa6fww4rI76NiKJU7fgYo47eo/s320/netware.jpg" width="320"/></a></p><p>

Around this time Apple&#39;s choice of server operating system made a sudden detour into, unexpectedly, Novell NetWare. In 1989 Novell introduced Portable NetWare, a &#34;userspace&#34; version of their network operating system that instead ran as an application on other operating systems. It provided all the standard NetWare file, print and network management services to NetWare clients, but was written in portable C and could be compiled from source with minimal changes by an OEM. The first ports were for Prime&#39;s 80386 Unix systems as well as NCR&#39;s port to Motorola 68000 machines. In 1991, IBM jumped on board, porting it to the new RS/6000s under AIX.
</p><p>
Novell had previous dealings with Apple, including as partners on the 1992 Star Trek project intended to &#34;boldly go where no Mac has gone before&#34; by porting System 7.1 to x86 on top of DR-DOS. Team members Fred Monroe and Fred Huxham later went on to work on <a href="http://oldvcr.blogspot.com/2023/07/apples-interactive-television-box.html">the Apple Interactive Television Box</a>. Star Trek was technologically successful but widely derided by industry observers, and when Michael Spindler became CEO in 1993, he cancelled it as a potential threat to the looming PowerPC transition.
</p><p>
The first Power Mac was the PowerPC 601-based Piltdown Man, descended from the Cognac project&#39;s famous RISC LC prototype, which became the Power Macintosh 6100 in March 1994 along with its sibling 7100 and 8100 systems. These first 601s were fabricated on a 600nm process with 2.8 million transistors; the later 601+ was <a href="http://oldvcr.blogspot.com/2019/11/how-far-weve-come-in-power-isa.html">a process shrink to 500nm</a>. The 6100 and 8100 were reworked into the Workgroup Server 6150 and 8150 respectively (&#34;Starbucks&#34;), running System 7 as promised, while the AWS 95 successor (&#34;Green Giant&#34;) was forged by merging a similar case and slot layout with the fastest 80MHz 601 then available, along with its characteristic low-mounted floppy to accommodate the two 5.25&#34; drive bays and a top-mounted CD-ROM.
</p><p>
Unfortunately for Apple, the new AIX-a/k/a-PowerOpen A/UX was nowhere near ready in late 1993, and Pink had metastasized by then into various Taligent platforms (OS/2 and AIX, and Apple&#39;s Copland) which weren&#39;t at all suitable either. Instead, Apple used their existing relationship with Novell to fit the Green Giant prototype with a PowerPC build of Portable NetWare, using some of IBM&#39;s porting work but running under System 7. Christened Wormhole, Mac Portable NetWare bombed with testers who were openly sceptical of the choice, and the Server Group launched Green Giant along with Starbucks in April 1994 as the <a href="http://www.floodgap.com/retrobits/ans/9150/">Workgroup Server 9150</a> — running Mac OS. Nevertheless, Apple promised at the same time to port Portable NetWare&#39;s successor, Processor Independent NetWare, to the Power Macintosh, and Spindler vowed at least one system would support it.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdp5M4EutIbfOl7P-JfCZ3W96-kzJbRvN6I5nc7G0rLGY9AswGLljr0bPSGgJh-1qSbfzsu_xLFpO4pPR3TpPJ924KcWgUtFz2wzTH1NvO8NM2-tF7_qWfCmDwSbeJRIbpjUXwPKVakKK3l5hyphenhyphenohzpI71SLtGwUysth3q4EVpY4NRxZ1yfC2Z9JTTPGHs/s1400/wgs.jpg"><img alt="" data-original-height="793" data-original-width="1400" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhdp5M4EutIbfOl7P-JfCZ3W96-kzJbRvN6I5nc7G0rLGY9AswGLljr0bPSGgJh-1qSbfzsu_xLFpO4pPR3TpPJ924KcWgUtFz2wzTH1NvO8NM2-tF7_qWfCmDwSbeJRIbpjUXwPKVakKK3l5hyphenhyphenohzpI71SLtGwUysth3q4EVpY4NRxZ1yfC2Z9JTTPGHs/s320/wgs.jpg" width="320"/></a></p><p>

But Apple had not forgotten about AIX. Although Gary Davidian&#39;s 68K emulator was intended to run the bulk of existing Mac software, there was no way it could efficiently run A/UX 3.x. The future was still (supposedly) the new AIX in whatever form that ended up taking, and native PowerPC apps thus used the same PowerOpen ABI as AIX in System 7 such that when (if) the new OS became available, PowerPC Mac applications would &#34;just work.&#34; While all of the new PowerPC Workgroup Servers ran System 7.1.2 as shipped, Apple promised at rollout that both Starbucks and Green Giant would be able to run AIX 4.1 when it became available, and would continue to provide the AWS 95 for customers who wanted old school A/UX.
</p><p>
In the meantime, IBM had become impatient with Apple and determined that development delays were stunting the technological growth of the RS/6000 line. On top of that, Apple&#39;s headlong rush to market had fractured IBM&#39;s attempts to build a common PowerPC Reference Platform (PReP), leaving market-majority Power Mac hardware only able to run System 7, and market-minority IBM hardware only able to run everything <em>but</em> System 7 (including Windows NT and OS/2). To recover control IBM decided to unilaterally retake the reins.
</p><p>
In February 1994 IBM announced AIX 4, which would add symmetric multitasking to the kernel for the first time and was designed to run on anything from PowerPC desktop workstations to large POWER servers. Additionally, as the industry was moving <i>en masse</i> to Intel&#39;s new PCI standard, IBM also made the jump from MicroChannel to PCI, starting with the Type 7020 series running the PowerPC 601 in October 1994. While MicroChannel would remain supported in AIX and PReP, PCI was the future, and IBM wouldn&#39;t support NuBus. Apple followed suit and announced they would move to PCI as well (not without controversy; an InfoWorld columnist in October 1994 argued that compared to NuBus &#34;PCI is a cleverly disguised trap [by Intel] and Apple is walking right into it&#34;), introducing the &#34;Tsunami&#34; Power Macintosh 9500 as the first PCI Mac in June 1995. It came with the new high-performance PowerPC 604 up to 150MHz, fabricated on a 500nm process with 3.6 million transistors.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhS4K-d7SzRO_sbQ8MG1qvsniuEOhATO-RtXsCUickdcNk2QZsAExljw2J7OgFKQslhgAhyphenhyphenGvaOYn45VzWi35PHI-rPoszKvm6EOiD8U5NKaKWcO66TftU5UjuBFDsSPAfZWQ6bTdWej1nSz6LBTTXuEC7rKPRGWP8VobSSmmqEm_uPauoxV61zUAiPMRY/s800/taligentyo.jpg"><img alt="" data-original-height="594" data-original-width="800" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhS4K-d7SzRO_sbQ8MG1qvsniuEOhATO-RtXsCUickdcNk2QZsAExljw2J7OgFKQslhgAhyphenhyphenGvaOYn45VzWi35PHI-rPoszKvm6EOiD8U5NKaKWcO66TftU5UjuBFDsSPAfZWQ6bTdWej1nSz6LBTTXuEC7rKPRGWP8VobSSmmqEm_uPauoxV61zUAiPMRY/s320/taligentyo.jpg" width="320"/></a></p><p>

While desktop users were delighted, Apple&#39;s enterprise customers started grumbling even louder. Apple still had open promises to them about AIX, Taligent (as CommonPoint, shown here in a beta screenshot) was furthest along on AIX and Apple still had an arrangement for AIX, but neither Copland nor new-A/UX were happening, and IBM made clear that AIX on NuBus wasn&#39;t going to happen either. At this point Apple simply abandoned PowerOpen and concluded it would never ship as such: if this mythical high-end Apple server was going to run AIX at all, it would have to run it straight up. There was no way to magically turn Green Giant into a PCI box, and phoning in a &#34;Workgroup Server 9550&#34; (no such model ever existed, for the record) would cause a buyer revolt, so the Server Group took Tsunami back to the shop and reworked it instead.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdgWbvrtf-67wms-72j2Cy88MLuDh36eUSJuczjDINaHiPt4r2aRoE4KG7tjAghX1jBFKfDBbxVcf81wXvyreTBGamSzElHcHp4kDmVjNtAUqfe-VZvu_40P7946b0QPMUfZDicwCxfMqvKetpl98NfPS21U_GaTM-l_hl6_F3J6DU3ktzoK4kIiapDH0/s4080/PXL_20231105_004057899.jpg"><img alt="" data-original-height="4080" data-original-width="3072" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjdgWbvrtf-67wms-72j2Cy88MLuDh36eUSJuczjDINaHiPt4r2aRoE4KG7tjAghX1jBFKfDBbxVcf81wXvyreTBGamSzElHcHp4kDmVjNtAUqfe-VZvu_40P7946b0QPMUfZDicwCxfMqvKetpl98NfPS21U_GaTM-l_hl6_F3J6DU3ktzoK4kIiapDH0/s320/PXL_20231105_004057899.jpg"/></a></p>

<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoH8WIBs3smLqBvF61SP3qrMy9BzAqVOKBeA0hLC_noKt62KVq7jMBmrFsX-l7uEm0SK42HmVlLT0XGiCbLU50hPw0Y9VHtZc6dcZdchoYXdwcaXjXz2kzROPawSbZ978R1QiFVh5jz0pXYv2L8ZQgZWjUA__IKV8NYIvg8QL1T2WMSN8okaOPp2AiovY/s2048/DSCN5883.JPG"><img alt="" data-original-height="1536" data-original-width="2048" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhoH8WIBs3smLqBvF61SP3qrMy9BzAqVOKBeA0hLC_noKt62KVq7jMBmrFsX-l7uEm0SK42HmVlLT0XGiCbLU50hPw0Y9VHtZc6dcZdchoYXdwcaXjXz2kzROPawSbZ978R1QiFVh5jz0pXYv2L8ZQgZWjUA__IKV8NYIvg8QL1T2WMSN8okaOPp2AiovY/s320/DSCN5883.JPG" width="320"/></a></p><p>

This task was primarily done in Austin, where the new machine picked up its codename &#34;Shiner&#34; after the developers&#39; favourite brand of beer, along with additional work at DeAnza 3 in Cupertino. Shiner&#39;s on-board hardware was reorganized to boot AIX directly and Apple contracted design firm Lunar <a href="http://www.floodgap.com/retrobits/ans/brags/lunar/">to design its unique chassis</a> with hot-swappable drives, fans and redundant power supplies, a backlit status LCD, a sliding drawer for the logic board, and a front locking translucent door. The top image is my 500 in operation; the bottom was the bare chassis when I had to strip it down a number of years ago to figure out a hardware problem. It&#39;s big, beefy and beautiful.
</p><p>
Unfortunately, other glitches delayed Shiner&#39;s release. As AIX was SMP-capable, Apple planned to offer Shiner with multiple processors, but the original 604 was found to have a serious hardware bug that impaired cache coherency when more than two processors were present. While this didn&#39;t affect designs like DayStar Digital&#39;s <em>asymmetric</em> multi-processor Power Macs, it seriously affected IBM, Groupe Bull and Zenith, who retreated to the 601, and stalled out Shiner. Motorola did not start sampling a fixed CPU until October 1995.
</p><p>
However, the software turned out to be a far bigger problem. Spindler&#39;s ill-advised promises around Processor Independent NetWare bloated the development schedule, as PIN was an actual operating system the machine had to boot instead of userspace server daemons like Portable NetWare was, and the arrangement wasn&#39;t cancelled until late in 1995 when Novell decided to develop for the new CHRP PowerPC machines instead. (This was the Cygnus port of NetWare to PowerPC, and ended up little used, since it never ran on Macs. Novell abandoned PIN completely with NetWare 5 in 1998.)
</p><p>
After that, AIX remained the leading choice for Shiner, but IBM and Apple continued to fight over how Macintosh applications would work under Shiner&#39;s specific flavour of AIX, codenamed &#34;Harpoon.&#34; While Apple&#39;s existing Macintosh Application Environment (MAE) was well known for running 68K Mac applications in emulation under Solaris and HP/UX, its absence on AIX had long been considered conspicuous. As promised, an early prototype environment called Macintosh Application Services for AIX (MAS) could run some Power Mac applications natively on Harpoon using a ported Toolbox and system libraries — keep that fun fact in the back of your head for a moment — but Apple could not sustain the development of MAS and cancelled it in March 1995. Meanwhile, Apple internal sources reported in August that neither Apple nor IBM were willing to pay the development costs even for a straightforward MAE port. As a trial balloon Apple ended up developing a version of Mac OS specifically for Shiner and actually demonstrated it, but the great confusion it elicited in potential buyers caused Apple to scrap it before the machine&#39;s début. AIX was the last OS standing, so Shiner ran AIX applications, and nothing but.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDPgwbKVprvsYRDriqpM5Z9-UVbw_78iTVN8ZX-kCYrP_0dURj1X-y9eeKaqCMPFTsHhWxJsu7ecjxoDHg2UpQu5prNrhjdnqibXlJXz7EcAFd2kyO4qauxcyZzNxROhmq2n0I5UphPjeiw6rQgLV-23SuuOdyFcGpZ7yW87nXIXLFoN1mNWXtxiA7H7s/s2048/DSCN0778.JPG"><img alt="" data-original-height="1536" data-original-width="2048" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjDPgwbKVprvsYRDriqpM5Z9-UVbw_78iTVN8ZX-kCYrP_0dURj1X-y9eeKaqCMPFTsHhWxJsu7ecjxoDHg2UpQu5prNrhjdnqibXlJXz7EcAFd2kyO4qauxcyZzNxROhmq2n0I5UphPjeiw6rQgLV-23SuuOdyFcGpZ7yW87nXIXLFoN1mNWXtxiA7H7s/s320/DSCN0778.JPG" width="320"/></a></p><p>

Eventually Shiner prototypes made it to testers — I have <a href="http://oldvcr.blogspot.com/2021/10/shiner-esb-apple-network-server.html">a non-functional EVT ANS prototype that used to be at Netscape</a> — and Apple announced it in two flavours, the &#34;low end&#34; Shiner LE (minus extra bays and with only a single power supply) that became the ANS 500 and the canonical &#34;high end&#34; Shiner HE that became the ANS 700. (I have an ANS 700 as well, which is quite logically named </p><tt>holmstock</tt><p>, but the 500 is the system in normal operation and the one we&#39;ll demonstrate here.) Prices for the configurations ranged from $10,969 for a low-end (ahem) 500/132 with 32MB of RAM (about $21,000 in 2023) to $14,999 for a 700/150 with 48MB of RAM (about $30,000), <em>plus</em> the two-user AIX license adding another $1,498 ($3,000), <em>and</em> $1,399 ($2,800) to upgrade that license to unlimited users if you needed it. Alongside the full-size machines Apple developed a rackmount prototype called Deep Dish intended to become the ANS 300, but decided not to release it, even though I know of at least two that still exist and casually drive by their houses a lot.
</p><p>
The ANS 500 and 700 finally reached market in February 1996 as one of the first new products under Gil Amelio, who replaced Spindler that month after his removal by the Apple board of directors. The systems got very positive reviews in the press, but their exorbitant price tags did not go unnoticed — a story we&#39;ll pick up at the end.
</p><p>
I gave you all that history to point out that RS/6000 AIX and the classic Mac OS, at least for a period of time, ended up influencing each other in surprising ways (just wait until we get to what snuck into IBM&#39;s C compiler), and that there was also some period of time in which AIX was going to <em>be</em> the next Mac OS. The history helps us understand it&#39;s no accident they use the same ABI for registers and calling conventions, slightly different from the PowerPC SysV ABI used by operating systems like Linux and the BSDs, and support the same XCOFF objects, at least at first (MPW used it as an intermediary in early versions). Although XCOFF was gradually obsoleted in MacOS as a binary format, New World Macs can still boot XCOFF from Open Firmware, and the PowerOpen ABI persisted into the Mac OS X era through the very last day Leopard on PowerPC was supported. This sort of low-level integration would not have made any sense, even as a colossal coincidence, unless both AIX and Mac OS were intended to have the same underlying foundation, and that observation makes it much less strange that the ANS would have ended up running it.
</p><p>
ANS AIX runs virtually everything that IBM AIX can run with the exception of certain device drivers and stuff that depends on MicroChannel — it ran all the binaries the local 3.2.5 systems had at the University without recompiling them, for example — but the reverse may not be true, even for userland applications, if those applications take advantage of what Apple added to it. Indeed, the work that went into making a Macintosh Toolbox that could run on AIX, and porting core Mac OS libraries to also run natively on AIX, did not go entirely wasted. Aside from Mac-specific hardware support like ADB, three specific portions ultimately shipped on every Harpoon CD.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgyENV4W4NARYpvCWMzc0mSGtmmdLSe6DTz1EpWQMXw_JneP_blrmuPEaZmyx_ykPUDDVabvP8Mt8ADQ_RWi07b4A2j8KZNuS1b0huT7qDI88rfvRe3as6ka00DDZDe-sS0ZOyqLXmQaqNuZFDW0JL3lpy_wg4D293xZpIZ_mjX94xsq0FPx2KFysf1pl4/s1024/nu-vlcsnap-2023-11-04-15h39m09s420.png"><img alt="" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgyENV4W4NARYpvCWMzc0mSGtmmdLSe6DTz1EpWQMXw_JneP_blrmuPEaZmyx_ykPUDDVabvP8Mt8ADQ_RWi07b4A2j8KZNuS1b0huT7qDI88rfvRe3as6ka00DDZDe-sS0ZOyqLXmQaqNuZFDW0JL3lpy_wg4D293xZpIZ_mjX94xsq0FPx2KFysf1pl4/s320/nu-vlcsnap-2023-11-04-15h39m09s420.png" width="320"/></a></p><p>

The first portion was AppleTalk. For those unfamiliar with AIX, this is </p><tt>smit</tt><p> on the ANS in TTY mode (&#34;</p><tt>smit</tt><p> happens,&#34; as we say in the biz), the System Management Interface Tool used as AIX&#39;s central configuration interface. It comes in both this text version for terminals or in a native X11 version that&#39;s point-and-click to at least some degree. Apple created an entire menu within SMIT to support AppleTalk so that AIX administrators could manage it in the fashion to which they were already accustomed. Here we&#39;re on the ANS&#39; console, which AIX calls the Low Function Terminal or LFT; I took these screenshots from the ANS&#39;s VGA port using an INOGENI VGA2USB3, cropping and slightly correcting the aspect ratio.
</p><p>
The implementation of AppleTalk in ANS AIX was mostly complete, including support for NBP (AppleTalk Name Binding Protocol), AFP (AppleTalk Filing Protocol, including modern AFP-over-TCP in Harpoon 4.1.5), and ADSP (the AppleTalk Data Stream Protocol) among others. Daemons provided AppleTalk routing and printing services, though a glaring deficiency was direct support for AppleShare, which required a third-party package. Apple included two demonstration disks with the ANS, IPT uShare and Helios EtherShare.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgGfxCT3WFULjhHPVN8zsLoT6yXRcd0odbgBJWD3joHl8cIDSCAdAqsL3d162ZKNLspGzizw_rbMwVGznYBsUXjY7hz7baUZxxWyu73VsCwyP0RlJiIrPeMXhmQuarj2tR2oXrz3nIjX-ReEZMQG5Mbtanw6r47qp2DG3MmNb0ZD6dRuQB2AbpYSf5YM5w/s1024/nu-vlcsnap-2023-11-04-15h39m46s896.png"><img alt="" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgGfxCT3WFULjhHPVN8zsLoT6yXRcd0odbgBJWD3joHl8cIDSCAdAqsL3d162ZKNLspGzizw_rbMwVGznYBsUXjY7hz7baUZxxWyu73VsCwyP0RlJiIrPeMXhmQuarj2tR2oXrz3nIjX-ReEZMQG5Mbtanw6r47qp2DG3MmNb0ZD6dRuQB2AbpYSf5YM5w/s320/nu-vlcsnap-2023-11-04-15h39m46s896.png" width="320"/></a></p><p>

Notably, the AppleTalk version in Harpoon 4.1.5 is given as 2.0. The AppleTalk stack could run on any port (here on </p><tt>et1</tt><p>, the 10/100 PCI card connected to the secured wired network) or route between multiple ports. Besides the daemons, Apple included an AIX AppleTalk library applications could link with, as well as a subset of Apple&#39;s Universal Interface headers tweaked for AIX.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgv0KRu62tlmtO_7UJQL745q4m0kuctYYmkcG-6Hhcy3awk3JfJkiudfIuyUJYzghtfluJYFbSH9c9r92-9IQalYzy-ujByy6WpysIj5yvJTsSGb5gUbhxHcTEfiM9tC9yB02D3tPTCwW71-2LHQwltS11UCtF2BfnV2t8MnHfGrqF6KQWoDuDJXLZRa2c/s1024/nu-vlcsnap-2023-11-04-15h40m02s127.png"><img alt="" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgv0KRu62tlmtO_7UJQL745q4m0kuctYYmkcG-6Hhcy3awk3JfJkiudfIuyUJYzghtfluJYFbSH9c9r92-9IQalYzy-ujByy6WpysIj5yvJTsSGb5gUbhxHcTEfiM9tC9yB02D3tPTCwW71-2LHQwltS11UCtF2BfnV2t8MnHfGrqF6KQWoDuDJXLZRa2c/s320/nu-vlcsnap-2023-11-04-15h40m02s127.png" width="320"/></a></p><p>

The other two portions were a full send-and-receive implementation of Apple events, also implemented as a native AIX library with headers, and running on top of that an AIX native version of the Program-to-Program Communications Toolbox called </p><tt>ppcd</tt><p>. In this article we&#39;ll make use of all three.
</p><p>
The PPC Toolbox, which has nothing to do with PowerPC and works on 68K Macs as well, was introduced with System 7.0 and allows applications to exchange messages with other applications, either on the same Mac or across the network. To this end it runs on top of Apple events and AppleTalk (the actual transport) and provides a browser to find available systems and willing applications running there, plus services for authenticating to those remote systems.
</p><p>
PPC Toolbox&#39;s primary purpose on the Mac itself was as the underlying mechanism for program linking, an unfortunate term, since this feature was distinct from simply running an application present on a shared volume. When program linking was active (from the Sharing Setup control panel), it was possible to receive Apple events from another Mac to control applications running on your Mac. When a PPC Toolbox-aware application is running and registered, it becomes visible to other Macs when they ask through their local PPC Toolbox browser about what network services are available. WebSTAR was <a href="https://www.nzdl.org/cgi-bin/library?e=d-00000-00---off-0tidbits--00-0----0-10-0---0---0direct-10---4-------0-1l--11-en-50---20-about---00-0-1-00-0--4----0-0-11-10-0utfZz-8-10&amp;cl=CL1.18&amp;d=HASH01381c73e66fc26a090a8fbc.3&amp;gt=0">one such example</a>, where the WebSTAR webserver was often running on a separate machine, and when the WebSTAR Admin application started up it asked on the network what WebSTAR servers were present that it could control. As unrestricted remote access of that sort would pose an obvious security hole, the administrator had to first authenticate to the desired server and then could manipulate it remotely. Many power users wrote AppleScript to accomplish something similar, since AppleScript to this day is all about sending Apple events to applications, and the core concept is still part of modern macOS.
</p><p>
Harpoon <tt>ppcd</tt> expands on this notion, almost like an Apple event-aware <tt>inetd</tt>. It presents itself just like any other remote Mac and responds to queries with its list of available services; it&#39;s just that these services are actually entries in its configuration file, along with provision for more sophisticated daemons that can deal with clients directly. When a client Mac requests a service, it authenticates to the ANS just like it would authenticate to any other Mac, and then <tt>ppcd</tt> executes the desired service which exchanges data with the client over AppleTalk — just like any other Mac.
</p><p>
Some of you will have asked whether A/UX 3.x can do such a thing, and the answer is yes, but only in the same way another remote Mac can; i.e., there&#39;s no special A/UX <em>Unix-side</em> support like there is in ANS AIX, and the PPC Toolbox is only available on A/UX if you&#39;re running the A/UX Finder. The A/UX documentation makes that plain: &#34;The A/UX Program-to-Program Communications (PPC) Toolbox is identical to the Macintosh OS PPC Toolbox.&#34; A/UX had its own style of hybrid applications that could offload work to a separate Unix process but those sorts of applications all ran locally. Only ANS AIX was capable of what we&#39;re going to show here.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhlbcn4VDd7-sNTOk4tjtGM2l3xKdVNBF3k7DPlOBDlCa8pmu5Y_MaRsWj5hJTcqNCNCG7Za0nhcRZhMknmnorqOcojnzwkX7Pp9c52gYHcvYfzQp4_6C10v4wZ3Vcc-d-563-Q76Q21NCdQQGKZld4ZdsI5iY9KLZiQ1A76n0gC807src1VEN7lcJ3_K8/s832/Picture%204.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhlbcn4VDd7-sNTOk4tjtGM2l3xKdVNBF3k7DPlOBDlCa8pmu5Y_MaRsWj5hJTcqNCNCG7Za0nhcRZhMknmnorqOcojnzwkX7Pp9c52gYHcvYfzQp4_6C10v4wZ3Vcc-d-563-Q76Q21NCdQQGKZld4ZdsI5iY9KLZiQ1A76n0gC807src1VEN7lcJ3_K8/s320/Picture%204.png" width="320"/></a></p><p>

Apple included several clients and servers with ANS AIX, mostly demos, but a couple of eminently useful ones. The Mac clients themselves were on a floppy disk that came in the ANS&#39; accessory box, though fortunately if yours didn&#39;t come with one Apple also includes them under </p><tt>/usr/lpp/apple.remoteutils/clients</tt><p>. Irritatingly, not all of them provide source code.
</p><p>
To install and run them, only one extension is absolutely required: the <tt>Network Server Passwd Tool</tt>, which handles authentication to your ANS. Drop it into your Extensions folder and reboot, and when prompted by the client, enter your regular ANS AIX login and password. Note that your password is <em>not</em> transmitted encrypted — everything is cleartext — and thus you should only play around with these programs on a secured local network. In particular, do <em>not</em> run the ANS AppleTalk stack on an interface connected to a WAN. You don&#39;t know where it&#39;s been, so don&#39;t put it in your mouth.
</p><p>
I should also note before we continue that these clients don&#39;t appear to work properly with Mac OS 9 (nor Classic except possibly 8.6 under Rhapsody Blue Box), which added support for the PPC Toolbox <a href="http://www.stuartcheshire.org/quicktime/ppctb.html">to run over TCP/IP as well as AppleTalk</a>. Harpoon&#39;s implementation only supports AppleTalk and interacting with it seemed to unsettle my OS 9 machines, so you should run these clients on Mac OS 8.6 or earlier, or A/UX 3.x.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz48cyIdpjOdhfacyh0UsEi_nuWpO_TluDDAatpY9hFHiy_f5dWZkGENCWL-sA_BzBrB2oDZSlluwvhM9HBiIeE89QXItJjDFiIxV5qLnCUq_NBKjexhp5ilqIyWg51TbnuQ97_ThV-Kz5RC4teY7YitV_-xQXFABX8Ch3keZJr2EliIvjQubgw0tun7o/s2560/IMG_20231104_161134_HDR.jpg"><img alt="" data-original-height="2560" data-original-width="1920" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz48cyIdpjOdhfacyh0UsEi_nuWpO_TluDDAatpY9hFHiy_f5dWZkGENCWL-sA_BzBrB2oDZSlluwvhM9HBiIeE89QXItJjDFiIxV5qLnCUq_NBKjexhp5ilqIyWg51TbnuQ97_ThV-Kz5RC4teY7YitV_-xQXFABX8Ch3keZJr2EliIvjQubgw0tun7o/s320/IMG_20231104_161134_HDR.jpg"/></a></p><p>

Let&#39;s demonstrate how this works in practice by going back to our little compact friend. While our usual 68K workhorse is my hard-truckin&#39; clockchipped Quadra 800, we&#39;re going to constrain things a bit more with this Mystic Colour Classic. Now, this is still a fairly beefy 68K Mac, since a Mystic is actually a Colour Classic with an LC 575 logic board swapped in, and this one was further upgraded with a 25MHz full &#39;040 and 64MB of RAM (though mostly wasted right now due to 24-bit addressing for its Apple IIe Card).

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEibI-xvASPGDJQQMWfg_ElsgEWdXMuP4Gy22gHnx6SBR9vAtgn9w14o3IOvNLgzk5SgcO9sCBlfVhuSkAOSTGS6-7d-2BdKkoVmoBfzTgyDc7W5vfzBozUtaeVNNjE9Kqq3CSPnmY8KpLBiPpwlXljM1T8zBfeaiguEM9BwLDDb3brta_F9XU1raBEZpJA/s4080/PXL_20231104_231349444.jpg"><img alt="" data-original-height="3072" data-original-width="4080" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEibI-xvASPGDJQQMWfg_ElsgEWdXMuP4Gy22gHnx6SBR9vAtgn9w14o3IOvNLgzk5SgcO9sCBlfVhuSkAOSTGS6-7d-2BdKkoVmoBfzTgyDc7W5vfzBozUtaeVNNjE9Kqq3CSPnmY8KpLBiPpwlXljM1T8zBfeaiguEM9BwLDDb3brta_F9XU1raBEZpJA/s320/PXL_20231104_231349444.jpg" width="320"/></a></p><p>

But I picked this one specifically because it has no Ethernet connection: everything we&#39;ll do on it is over LocalTalk, where AppleTalk is its <i>raison d&#39;être</i>. I&#39;ll have up the Network control panel so that you can see I&#39;m not cheating with MacIP, and I&#39;ve chosen to take actual photographs of the screen instead of screenshots (except in one specific case) to prove there&#39;s nothing up my blogger sleeve. To allow the Mystic to actually see the ANS, the LocalTalk segment is bridged to EtherTalk by a Dayna EtherPrint-T, though things like a Shiva FastPath, GatorBox or even a software LocalTalk bridge will also work for this purpose.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixF8CyI-fVvP2TVq_iICAxSa-y3K79iRdBEpQGtAzJg55rOdqRdTSZnNiFOh1Yt6srHwgOBolDF9Ey_0xJp_SdQvNIDvS9BWkMQHuqszSmFQ1Rzq82LkU4YGJ6iib8dzpegt3V-3OsOrntzitD2hlzejHzgMg4skex4dV6IcrhOqAWjY3DLsGgT2Ind_k/s2560/IMG_20231104_161555_HDR.jpg"><img alt="" data-original-height="1920" data-original-width="2560" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixF8CyI-fVvP2TVq_iICAxSa-y3K79iRdBEpQGtAzJg55rOdqRdTSZnNiFOh1Yt6srHwgOBolDF9Ey_0xJp_SdQvNIDvS9BWkMQHuqszSmFQ1Rzq82LkU4YGJ6iib8dzpegt3V-3OsOrntzitD2hlzejHzgMg4skex4dV6IcrhOqAWjY3DLsGgT2Ind_k/s320/IMG_20231104_161555_HDR.jpg" width="320"/></a></p><p>

Of the two actually useful client-server services Apple included, probably the most useful is the CommandShell. This one requires the included </p><tt>CommandShell VT102</tt><p> extension to be installed, but you might have it installed already as this is the same one many other applications use, and it&#39;s not required at all on A/UX because it already has it for A/UX&#39;s own command line.
</p><p>
When we start the Command Shell, the PPC Browser window pops up first and prompts us to &#34;Select a CommandShell server&#34; (this message is configurable). A list of running Macs or suitable Mac substitutes participating in PPC is populated in the upper left corner, and if you had any AppleTalk zones to choose between (I don&#39;t), you&#39;d see them on the lower right. We see two here, the Colour Classic itself (&#34;CC&#34;) and <tt>stockholm</tt>.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvhcq2RWV0vk8YUC7vGzzp_Yp1y7aBczTefg7dg7YzQZ40XycAvcWs1RDlYyFj_J3AzKqeffgm0DDsOfuf8fjtbUYm_eRufywELTEltU7eFswK90D49eb0iHhDyEv4nbmCYU89a_AN7rji6pD4RY4hval3IQZNt8l3I-IaA-9WJq9Wr5ZZ1u3d2qOgCd4/s2560/IMG_20231104_161650_HDR.jpg"><img alt="" data-original-height="1920" data-original-width="2560" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvhcq2RWV0vk8YUC7vGzzp_Yp1y7aBczTefg7dg7YzQZ40XycAvcWs1RDlYyFj_J3AzKqeffgm0DDsOfuf8fjtbUYm_eRufywELTEltU7eFswK90D49eb0iHhDyEv4nbmCYU89a_AN7rji6pD4RY4hval3IQZNt8l3I-IaA-9WJq9Wr5ZZ1u3d2qOgCd4/s320/IMG_20231104_161650_HDR.jpg" width="320"/></a></p><p>

When we choose </p><tt>stockholm</tt><p>, a list of services that answer to the desired signature (</p><tt>CmdS</tt><p>, an </p><tt>OSType</tt><p>-style FourCC) appear. There is just one that </p><tt>ppcd</tt><p> offers, the CommandShell service itself.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhYYltx8IBzHHP8x-YhcCzuFriAItF1SE8xI_cGd1W5ASbfO6Dq4aV2U16xFX57fbE2JXAkuksPpKPspSn-rs_gB_MskBtVkdgK5Rtb18efbTwQ84hB4bg4vYfTMwnDiOr6y3kizoznOJ-vveG0XsPAW67KB0TG2o3GZqIM_zYoE1yIFErUoRCPWXh275M/s2560/IMG_20231104_161745_HDR.jpg"><img alt="" data-original-height="1920" data-original-width="2560" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhYYltx8IBzHHP8x-YhcCzuFriAItF1SE8xI_cGd1W5ASbfO6Dq4aV2U16xFX57fbE2JXAkuksPpKPspSn-rs_gB_MskBtVkdgK5Rtb18efbTwQ84hB4bg4vYfTMwnDiOr6y3kizoznOJ-vveG0XsPAW67KB0TG2o3GZqIM_zYoE1yIFErUoRCPWXh275M/s320/IMG_20231104_161745_HDR.jpg" width="320"/></a></p><p>

We select that and are prompted for our AIX login and password.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg4B4mYyXXXcuHVQ8uUhfGkTOx0pdsqyr7VuIr0MENTbWWx7JA7cTnOtqW6MDaZgH5eymu7kP6MyoAnZ-TqsDgxobz1cMh-WSOLn32w306ahC4R08hxk1akBjhILqBePkAZPK9OeUfTtZrA-hTvtdDNTEmQwT6l03-kruEBxchsm3-II3bgKHXJP946Is4/s2560/IMG_20231104_162139_HDR.jpg"><img alt="" data-original-height="1920" data-original-width="2560" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg4B4mYyXXXcuHVQ8uUhfGkTOx0pdsqyr7VuIr0MENTbWWx7JA7cTnOtqW6MDaZgH5eymu7kP6MyoAnZ-TqsDgxobz1cMh-WSOLn32w306ahC4R08hxk1akBjhILqBePkAZPK9OeUfTtZrA-hTvtdDNTEmQwT6l03-kruEBxchsm3-II3bgKHXJP946Is4/s320/IMG_20231104_162139_HDR.jpg" width="320"/></a></p><p>

And, lo and behold, a terminal window pops up. But this connection isn&#39;t over Telnet or even traditional serial: it&#39;s ADSP, using the pseudo-hostname </p><tt>cmdshell</tt><p>. You can even open multiple connections, which </p><tt>ppcd</tt><p> will multiplex.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDe3NYDasUBNoOXqqehoCyKoA2_UB6-o6bUIrbyl3V8J7MpOTYQK4Pog1PmTpOckiFxqAIEVux7LqFKUw1DThWqXmf4TZVlwZmxwEnjQV7HC5QNewMKhULlVymt-Jmud4VsuM5vCdBuPDlOSQwaaCj3aw9-q7rOYJ8DMTNl3PcVwUkvTEPPiML5GMtO2A/s2560/IMG_20231104_162235_HDR.jpg"><img alt="" data-original-height="1920" data-original-width="2560" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDe3NYDasUBNoOXqqehoCyKoA2_UB6-o6bUIrbyl3V8J7MpOTYQK4Pog1PmTpOckiFxqAIEVux7LqFKUw1DThWqXmf4TZVlwZmxwEnjQV7HC5QNewMKhULlVymt-Jmud4VsuM5vCdBuPDlOSQwaaCj3aw9-q7rOYJ8DMTNl3PcVwUkvTEPPiML5GMtO2A/s320/IMG_20231104_162235_HDR.jpg" width="320"/></a></p><p>

A less practical, but actually rather more impressive, demonstration of what this mechanism is capable of is the Fractal Demo. Some of you on the other side of the pond may remember the <a href="https://www.c64-wiki.de/wiki/Mandelbrot-Construction-Set">Mandelbrot Construction Set</a> (auf Deutsch) from 64&#39;er October 1991, which computed the Mandelbrot fractal set on a Commodore 64 while using the 6502 in a connected Commodore 1541 disk drive as a coprocessor. But the C64&#39;s 6510 and the 1541&#39;s 6502 ran at approximately the same clock speed (1MHz), whereas here we&#39;re going to shunt the work from a 25MHz 68040 to a 200MHz 604e.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEje-vjX87IGmyGlVMKBWgFhleW7Q32S4gUdvXz6oUUYDJMEIqXBkdOur4GpJFSeahAa3bP3QarqltCJPNZeI94fEdycoS_o0TV1NJkas55pO8mBlINVt57gW2WO_ZHmtN9ICVsF4IxPTPbbVtHIwcdtlHJ0ZIKx-5tATzyhgC8sBO6007ZB-tUUSeDrvwk/s512/FPicture-1.png"><img alt="" data-original-height="384" data-original-width="512" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEje-vjX87IGmyGlVMKBWgFhleW7Q32S4gUdvXz6oUUYDJMEIqXBkdOur4GpJFSeahAa3bP3QarqltCJPNZeI94fEdycoS_o0TV1NJkas55pO8mBlINVt57gW2WO_ZHmtN9ICVsF4IxPTPbbVtHIwcdtlHJ0ZIKx-5tATzyhgC8sBO6007ZB-tUUSeDrvwk/s320/FPicture-1.png" width="320"/></a></p><p>

For these shots I&#39;ve switched to screen grabs so you can see the generated image at full quality. The Colour Classic ordinarily has a 512x384 screen (the Apple IIe modes notwithstanding) but the application will generate at nearly any window size or one of the prespecified ones. You can also adjust the lookahead and the square size of each transaction from the server.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEihYncfTn4JILckWMWIvuxQOaCrxJW7d7QiGihY3hjCNxW6wnYy9_447f03c6x0enLI_EFMyHfBBhUgPEa-qPB09CNhoKzDTiJG01SqryMgI2wkchtQODVn_Zkd-f-CaQGZiCMyPTIpD9VSIkBBph5HF7vczpp_OiCNe6Wy1uU9JxZPsWz1pKb2VR_GN3I/s512/FPicture-2.png"><img alt="" data-original-height="384" data-original-width="512" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEihYncfTn4JILckWMWIvuxQOaCrxJW7d7QiGihY3hjCNxW6wnYy9_447f03c6x0enLI_EFMyHfBBhUgPEa-qPB09CNhoKzDTiJG01SqryMgI2wkchtQODVn_Zkd-f-CaQGZiCMyPTIpD9VSIkBBph5HF7vczpp_OiCNe6Wy1uU9JxZPsWz1pKb2VR_GN3I/s320/FPicture-2.png" width="320"/></a></p><p>

When a screen is rendered, you can zoom in by drawing a box around it, and the ANS will send back a zoomed view.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBjI1GlYc0y2_2DC2WsS6461_jnDunSEj60cuYOq7G2kRHLe_dKE8rTcrXUQ1ZGh2si6_9Emfnx86FQu0eduD1i6ldQnd2aLgkQ7YKcwxKj-gmLnFVbSVWPkhF2kgemSDZ7A3hh9X3y6HIz6kyi4P2_kAZJhzBicTXOa7elGMSW1NinZTVCjGvETlelZk/s512/FPicture-3.png"><img alt="" data-original-height="384" data-original-width="512" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBjI1GlYc0y2_2DC2WsS6461_jnDunSEj60cuYOq7G2kRHLe_dKE8rTcrXUQ1ZGh2si6_9Emfnx86FQu0eduD1i6ldQnd2aLgkQ7YKcwxKj-gmLnFVbSVWPkhF2kgemSDZ7A3hh9X3y6HIz6kyi4P2_kAZJhzBicTXOa7elGMSW1NinZTVCjGvETlelZk/s320/FPicture-3.png" width="320"/></a></p><p>

This particular client-server pair has full source code for both ends. It seems to date from rather early in development: the Mandelbrot generation code is credited to Mark Maxham at the Apple Advanced Technology Group, dated February 1992, while the rest of the server is credited to Scott Mulligan and dated 1993 and 1994, though the actual file modification times are 1995 and 1997 (the latter from the 4.1.5 upgrade).
</p><p>
Once the server gets a request from the Mac client, it confirms that both the client and server are speaking a compatible protocol version (there was only ever one publicly released), and then receives a request specifying the square size, which square, and over what interval, to which it replies with a byte array of graphic data corresponding to the requested square. Zoom requests are received as new intervals. These are all structured Apple events, even the array of bytes, which is simply transmitted as a block of raw data within the Apple event reply. A system of periodic heartbeat events roughly every 30 seconds lets the two sides know that the other is still present.
</p>
<p>
To give you an idea how quickly this scheme could operate, even over LocalTalk, here&#39;s a realtime (not time-lapse) video of the process. Initially we use the smallest square size, but at this size the overhead of handling the Apple events dominates compared to the amount of data actually generated, and the process is relatively slow. When we jump to the largest square size, however, we generate a much larger set per transaction and the window fills up in seconds. Let&#39;s hear it for making someone else do the work!
</p><p>
This demonstration also points out something important about the architecture. The classic Mac OS, as beloved as I find its interface, is a well-known dog&#39;s breakfast under the hood with little provision for memory protection and relying on MultiFinder-era cooperative multitasking. Even in the era of the 8.6 nanokernel and Multiprocessing Services, where you could at least theoretically have preemptive tasks, those tasks still had to have a presence in the UI and that part of the system remained cooperative.
</p><p>
If we were doing the math locally, the calculations would have dragged the system down and impaired its ability to service its own interface effectively, let alone any other application running at the same time. But by deferring the calculations to the ANS, we&#39;ve almost completely fixed this problem: the ANS does it faster, the ANS does it <em>asynchronously</em> (the system gives you a callback when the data arrives and until then you can just blissfully yield with <tt>WaitNextEvent</tt>, keeping the rest of the user interface responsive), and the ANS can service multiple clients because it <em>does</em> preemptively multitask, meaning your entire LAN is covered.
</p><p>
Remember, in the 1995 timeframe when all this was being developed, Copland (and therefore Taligent) was a Bataan death march and PowerOpen-A/UX 4-whatever was waiting for its death certificate, and while BeOS had SheepShaver, it was third-party software on a low-volume OS made by a quirky company best known for <a href="http://oldvcr.blogspot.com/2021/03/when-you-have-too-much-memory-for.html">a strange blue machine</a>. If you were willing to forgo Mac software compatibility completely, Windows NT and Solaris could run on PowerPC but not on Power Macs, the OS/2 port is best not mentioned, running stuff on/with NetWare was a cruel joke (<em>and</em> it was cooperatively multitasked, too), and if you dared suggest Apple could buy NeXT, remember that NeXTSTEP and OpenSTEP <em>never</em> ran on PowerPC until Rhapsody. Plus, Be and NeXT carried additional institutional baggage by having controversial ex-Apple execs at their helms.
</p><p>
Here, on the other hand, was a way you could solve the entire problem by just grafting libraries onto an existing operating system Apple already had an arrangement to use. When you think about the idea in that context, &#34;symbiotic&#34; applications like this one looked like an easy transitional solution to the classic Mac OS&#39;s deficiencies.
</p><p>
For the next couple demonstrations, having made the point on the Mystic, we&#39;ll move back to the Quadra so that we have a little more visual real estate.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4BJ8pDDxnaK9XC8WzdpHSSADReoQp752UC8DoZF3KlNrJP63NLHPvcHAuXs1v4vOzOW7pc5wT40F7nF6hXaC6-LUKEcSVOW_B8AaPGvDLogAPmmU9Z8CCY8I5HpMIrzgP3MYiiHCCg_fFYfEf4y9UXqK-oEw94443y18t2xpfD6kyqFBKXtn8gY6zRe8/s832/Picture%202.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi4BJ8pDDxnaK9XC8WzdpHSSADReoQp752UC8DoZF3KlNrJP63NLHPvcHAuXs1v4vOzOW7pc5wT40F7nF6hXaC6-LUKEcSVOW_B8AaPGvDLogAPmmU9Z8CCY8I5HpMIrzgP3MYiiHCCg_fFYfEf4y9UXqK-oEw94443y18t2xpfD6kyqFBKXtn8gY6zRe8/s320/Picture%202.png" width="320"/></a></p><p>

The next, more practical use of this technology (and also lacking source code) is the Disk Management Utility. That&#39;s like it sounds: you can manipulate JFS logical volumes, physical disks and AIX volume groups natively from a controlling Mac. Naturally you&#39;ll have to authenticate as </p><tt>root</tt><p> (remember there&#39;s no encryption!), and once you do, there is a minor pause while the client gets the system information. It will not allow multiple administrators to connect simultaneously. This machine has only one partitioned disk, a full-height Fujitsu 18GB SCSI-2 drive which was quite large for the time, but the Utility could reputedly handle fairly complex topologies.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcYUH_xK3AGX7rFhgBhR456u1m7WdPu-ZXW1B-AkzUIwI68kP6GJ-UIa4xMDMZnvB5wwYTOb1gXk5HQmvAOVIBlzXizFxRXejGmLEuBYERFcE1LzKbXP75zWr79CqO_UQ_PCgZON7TMWmda6fxBqnoMmvkNdl18qjrrKlBz59Pvq0-p2DqpvZRcSpUL5Q/s832/Picture%203.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcYUH_xK3AGX7rFhgBhR456u1m7WdPu-ZXW1B-AkzUIwI68kP6GJ-UIa4xMDMZnvB5wwYTOb1gXk5HQmvAOVIBlzXizFxRXejGmLEuBYERFcE1LzKbXP75zWr79CqO_UQ_PCgZON7TMWmda6fxBqnoMmvkNdl18qjrrKlBz59Pvq0-p2DqpvZRcSpUL5Q/s320/Picture%203.png" width="320"/></a></p><p>

Given a particular disk, you could drill down to individual partitions and adjust their permissions and sizes or do other administrative tasks, including those on logical disks hosted on the supported Apple RAID solution. I have a long personal history with AIX, so even in 1998 I did all my admin tasks from the LFT console, but this would have been very attractive to Mac admins new to the operating system. Of course, the chief problem with this otherwise well-designed application is that it cast the fact you had to do <em>literally everything else</em> in </p><tt>smit</tt><p> into very sharp relief.
</p><p>
The copyright date in the About box is 1992, though I can&#39;t determine from this if that was for MacApp generally (that is, Apple&#39;s attempt at their own object-oriented framework for the classic Mac OS) or for the Utility itself. If the Utility actually hailed from 1995 as other services do, then it would have been a very late application even for C++ MacApp, as CodeWarrior&#39;s equivalent PowerPlant framework was already eating its lunch by then and Apple was itself using PowerPlant in some of its own software. Although MacApp 3.0 apparently had very good Apple event handling, our project for this article will use PowerPlant.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjhJFlErDaNTAVc4kuy7zUqwTOACvSq6BxyAexCtPuhLhMnc9B_xmd-KEhhEbjl5CfhFbqwaYWo_d_lVUOf-DZkt_xjlPvEVpgDAr6vqYXsE0Sr8pgteb0v1CF6kkiFTEZe6f-PpvU5LC8mXs8At_QEHT3c5kj2nJHHPBR7V2DCsQ9yIE7pN_hDTjxtEo/s832/Picture%205.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjhJFlErDaNTAVc4kuy7zUqwTOACvSq6BxyAexCtPuhLhMnc9B_xmd-KEhhEbjl5CfhFbqwaYWo_d_lVUOf-DZkt_xjlPvEVpgDAr6vqYXsE0Sr8pgteb0v1CF6kkiFTEZe6f-PpvU5LC8mXs8At_QEHT3c5kj2nJHHPBR7V2DCsQ9yIE7pN_hDTjxtEo/s320/Picture%205.png" width="320"/></a></p><p>

That brings us to our last demonstration, and the one we&#39;re going to hijack, because both client and server source code exists for it too. The server source code on 4.1.5 is credited to Chris Jalbert with a &#34;1996-1997&#34; copyright date, updated from the earlier 4.1.4.1 release of what was called </p><tt>javelind</tt><p>. It&#39;s purportedly a basic system monitoring application, but the concept is generalizeable to something much more than that.
</p><p>
There are actually two applications left, the Status-Who Demo (&#34;trident&#34;) and the Status Demo (&#34;javelin&#34;), but the Status Demo is completely subsumed by the Status-Who Demo, so we&#39;ll show that as the client. You can choose the desired view from the File Menu, either the &#34;who&#34; view (which shows a multiline, automatically refreshed list of current users and their locations, much like <tt>/usr/bin/who</tt>), or the &#34;uptime&#34; view (which shows the time, number of users and system load, much like <tt>/usr/bin/uptime</tt>). Both can run at once. The Status Demo solely displays the &#34;uptime&#34; view.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuaafFiLg-gqDDmL5qtVlhd-nluA5oJt6CpD9Z_5P0Dyk1iJQIqgvv0Dj6sjvLG7nP49joJt5d-QgB-iz58xW7KA6TJKQ9H_5-owVt0sLEwhaTsM6oKSV4bPZMxtjcc406libXXMesm4tJeQQUH7DRL-40YpqYp_MuwKLhYUiRvGr6141FpPECPcQY7QU/s832/Picture%206.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiuaafFiLg-gqDDmL5qtVlhd-nluA5oJt6CpD9Z_5P0Dyk1iJQIqgvv0Dj6sjvLG7nP49joJt5d-QgB-iz58xW7KA6TJKQ9H_5-owVt0sLEwhaTsM6oKSV4bPZMxtjcc406libXXMesm4tJeQQUH7DRL-40YpqYp_MuwKLhYUiRvGr6141FpPECPcQY7QU/s320/Picture%206.png" width="320"/></a></p><p>

For the &#34;who&#34; view, the signature will bring up a Login Demo service. (Notice the PPC Browser window asks you to &#34;Select a Unix Server.&#34;) In this mode, the server <em>pushes</em> the current userlist to the client as an array of strings in an Apple event, updating that list if it sees that </p><tt>/etc/utmp</tt><p> has changed. On the client end, it idles, yielding to other apps, until it gets that Apple event with which it updates the text in the window.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVMqpMiBeQfzSrAPgmD3Y8Wu039fNoXmLZozosA2ROlbmXt706BOV09_PZMTpOOV4HjXhRusDDN-Vji-XIJ_Nx4ep-ARyii8WbTON8kbiWM6djG7bL7W-l_gFv_ias24WjuIDEfB8c0oQMtyZSb8kuZnH_Od3QdMPT52gQfO55Es45fr9he8i6rR_p04U/s832/Picture%207.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVMqpMiBeQfzSrAPgmD3Y8Wu039fNoXmLZozosA2ROlbmXt706BOV09_PZMTpOOV4HjXhRusDDN-Vji-XIJ_Nx4ep-ARyii8WbTON8kbiWM6djG7bL7W-l_gFv_ias24WjuIDEfB8c0oQMtyZSb8kuZnH_Od3QdMPT52gQfO55Es45fr9he8i6rR_p04U/s320/Picture%207.png" width="320"/></a></p><p>

However, the &#34;uptime&#34; view brings up <em>two</em> services with matching signatures. They appear to work the same, but there&#39;s an internal difference between them we&#39;ll get to when we discuss the backend.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoiVOtSq_9fYrhW5AucwTD1FIVlVX6DDereUeTikCFg_-xg-LuWcNmruFDQswCdM-9JuAmm-2jzhU2JURaHB-kYW9r4m_QKXyLN8n9JP2Tfds3ap18xkpAPz6RbrRwA1Mhqf4ccqjWI0tWZu-XnsrnKjl2AGy9Mm-bevQ1rDL-MtPInutnSa_iocnlKC0/s832/Picture%209.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjoiVOtSq_9fYrhW5AucwTD1FIVlVX6DDereUeTikCFg_-xg-LuWcNmruFDQswCdM-9JuAmm-2jzhU2JURaHB-kYW9r4m_QKXyLN8n9JP2Tfds3ap18xkpAPz6RbrRwA1Mhqf4ccqjWI0tWZu-XnsrnKjl2AGy9Mm-bevQ1rDL-MtPInutnSa_iocnlKC0/s320/Picture%209.png" width="320"/></a></p><p>

The chief difference between the uptime view and the who-view — between the single line of text and the multiple lines, that is — is that you can specify the interval for the uptime view, whereas the who-view rate is determined by the server. Both can run at once, though you can have multiple uptime views, and the system will multiplex their events. The uptime view also maintains a history so you can scroll back through the load averages and see when your box was blowing up.
</p><p>
Let&#39;s have a look at the backend now.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheHcBo4btX0bOM_gOkJ12X_NlLCjWbhJlvYAs_KdTGH5x_ir4obsroj_LFykCq9aVvlL8AZOEV0PznUOrN305hXKsAdquj5yMKZE0IneFaJTYpkpnHOSb9EnmPWe7tedcipsscJgO8zlMNLcmfVQ8NrCPxsndmv7CKccXHQLPV2ewIn2_X1IGuo5CLXjU/s1024/nu-vlcsnap-2023-11-04-15h40m17s509.png"><img alt="" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheHcBo4btX0bOM_gOkJ12X_NlLCjWbhJlvYAs_KdTGH5x_ir4obsroj_LFykCq9aVvlL8AZOEV0PznUOrN305hXKsAdquj5yMKZE0IneFaJTYpkpnHOSb9EnmPWe7tedcipsscJgO8zlMNLcmfVQ8NrCPxsndmv7CKccXHQLPV2ewIn2_X1IGuo5CLXjU/s320/nu-vlcsnap-2023-11-04-15h40m17s509.png" width="320"/></a></p><p>

Harpoon </p><tt>ppcd</tt><p> has its own SMIT menu where you can start and stop the daemon or modify its services. This can all be done from the command line, and you can just edit </p><tt>/etc/ppcd.conf</tt><p> and bounce the daemon to add or remove services, but I&#39;ll show you SMIT&#39;s interface to service configuration for completeness here.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjfVocidEtrUlWDX28oPPIKMoXIewq6m8UO5SynD2g-bY1Ph5Mr3TGoB2Xh8Wuc7jHnkAOnhp_GIrVT6I3jNo60N32es1zJtoHarGgYbaoDRW5Aix6N-CsaqJ7KuBQEFbeq52eHvnPTSV7YhwotRafcMqWu4ZmiLgRSoAhUbZrOhKFiaKVlvGG6ZD5SbYw/s1024/nu-vlcsnap-2023-11-04-15h41m15s392.png"><img alt="" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjfVocidEtrUlWDX28oPPIKMoXIewq6m8UO5SynD2g-bY1Ph5Mr3TGoB2Xh8Wuc7jHnkAOnhp_GIrVT6I3jNo60N32es1zJtoHarGgYbaoDRW5Aix6N-CsaqJ7KuBQEFbeq52eHvnPTSV7YhwotRafcMqWu4ZmiLgRSoAhUbZrOhKFiaKVlvGG6ZD5SbYw/s320/nu-vlcsnap-2023-11-04-15h41m15s392.png" width="320"/></a></p><p>

I mentioned previously that there are two ways a service can be set up. As it happens, the two services we saw for the uptime view are the same daemon built both ways. The most complex, but also the most flexible, way is to register yourself with </p><tt>ppcd</tt><p> and open your own listening ports (specified by name and either a matching string or a type and creator; we use the latter to specify the </p><tt>OSType</tt><p> signature). This is the only way to have multiple port types registered to a single daemon, and both the who-view (creator &#34;signature&#34; is </p><tt>JVLN</tt><p> and type is </p><tt>who </tt><p> with a trailing space) and the &#34;New Status View&#34; for uptime (</p><tt>JVLN updt</tt><p>) are handled by this one, appropriately named </p><tt>/usr/bin/flexibled</tt><p>.
</p><p>
On the other hand, it also requires your daemon be running all the time when <tt>ppcd</tt> is, and <tt>ppcd</tt> in this configuration basically only acts as your bootstrap. So that you don&#39;t have to busywait, however, the <tt>select()</tt> call is expanded in Harpoon to not only terminate with time left for regular POSIX signals but also on Apple events (which you retrieve with <tt>WaitNextAppleEvent</tt> and dispatch with <tt>WaitNextAppleEvent</tt> to handlers you previously defined with <tt>AEInstallEventHandler</tt>), and additionally works with things like ADSP connections as well as more typical TCP/IP network sockets.
</p><p>
So where did the other Status View service answering to <tt>JVLN</tt> come from? It came from the <em>other</em> way we can set up a service.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKNIpcJA1PMc5i974ZzpchsebWzOJzGg0Yg8upFyWSkwjNwQIh5YVmpww6AAzBUgpRK02a67egYXUjIJRfcF4kn2FgURw9Ohsso-fLGOUcv2zVV0A4qkllIpn3RzKG9u5SC-poEXKSGNaiEJih7_vzXTvnPpg7tZI6_PaZAYgchcRSC85rkb10GmzYwL0/s1024/nu-vlcsnap-2023-11-04-15h40m53s030.png"><img alt="" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKNIpcJA1PMc5i974ZzpchsebWzOJzGg0Yg8upFyWSkwjNwQIh5YVmpww6AAzBUgpRK02a67egYXUjIJRfcF4kn2FgURw9Ohsso-fLGOUcv2zVV0A4qkllIpn3RzKG9u5SC-poEXKSGNaiEJih7_vzXTvnPpg7tZI6_PaZAYgchcRSC85rkb10GmzYwL0/s320/nu-vlcsnap-2023-11-04-15h40m53s030.png" width="320"/></a></p><p>

The easier way to write a service is to let </p><tt>ppcd</tt><p> do the work of looking for events for the signature you&#39;re watching for and managing authentication. You can only specify one signature and you can only handle a single generic port type for it, but your daemon doesn&#39;t need to run until </p><tt>ppcd</tt><p> finds something you&#39;re looking for. At that point your daemon is started, you handle events and AppleTalk connections for as long as you want to, and then you terminate.
</p><p>
This screen shows the configuration for the Fractal Demo service. The service name is what is used in the port the Harpoon <tt>ppcd</tt> advertises, as well as the signature (here, <tt>Mndl</tt> is reported as the creator, with an implied wildcard for the port type in these simplified servers). Authentication is required if the guest connections without password are not allowed, or if you removed the <tt>guest</tt> user account, as I have since it was a production system. If you authenticate and you&#39;re in the list of privileged users, the specified daemon will be started with the uid and gid you provide as if it were <tt>setuid</tt>; if you&#39;re not, then it assumes yours. Once all that happens, <em>then</em> <tt>ppcd</tt> starts your daemon.
</p><p>
In most cases, a given Mac application&#39;s creator code and its PPC Toolbox signature were the same <tt>OSType</tt> FourCC. While AIX daemons wouldn&#39;t have a creator code, the general correspondence of PPC Toolbox signatures to creator codes meant you were also supposed to register your desired signature with Apple like you would for an application. Somehow I don&#39;t think Apple got a lot of requests for this. A generic signature of <tt>UNIX</tt> was always available and explicitly defined as free for all.
</p><p>
By default, there are five services listed in <tt>/etc/ppcd.conf</tt>.
</p><div><pre>CommandShell:0:NONE:/usr/sbin/cmdshld:CmdS:noguest:*
Disk Management Utility:0:NONE:/usr/sbin/diskmand:DSCS:guest:NONE
Status Demo:100:100:/usr/sbin/simpled:JVLN:guest:*
Fractal Demo:100:100:/usr/sbin/fractald:Mndl:guest:*
:::/usr/sbin/flexibled::guest:
</pre></div>
<p>
You can see what the Fractal Demo SMIT screen corresponds to in the actual configuration file, including its port name, default uid and gid (always used, since the set of privileged users is an asterisk), path to the daemon, signature, whether guest is allowed, and the privileged user list (or an asterisk for everybody).
</p><p>
You can also see the simpler Status Demo (<tt>/usr/sbin/simpled</tt>, naturally), which responds to <tt>JVLN</tt> as well, but only can offer a single port type and its programmers chose the uptime view. <tt>flexibled</tt>, on the other hand, specifies no port name and no signature (or anything else for that matter), so <tt>ppcd</tt> always brings it up so that it can open its own ports and listen for its own Apple events. It responds to <tt>JVLN</tt> too, but that&#39;s because it itself created its own PPC Toolbox port for it. However, all of the other PPC services are &#34;simplified,&#34; including the major ones like the Command Shell and Disk Management Utility.
</p><p>
The source code for the Status-Who and Status Demos is actually a single pile of source that&#39;s quadruple-headed: it can be built as either the flexible daemon (both who and uptime) or simple (just uptime), and either for AIX or for Mac OS (in which case most of the status updates are just dummy strings but the app allegedly works). We&#39;ll only deal with building it on AIX. Although I&#39;ve placed a slightly tweaked version up <a href="https://github.com/classilla/hnae/blob/main/nutridentd/">on Github</a> you can follow along with, here&#39;s the relevant portion from <a href="https://github.com/classilla/hnae/blob/main/nutridentd/Makefile.xlc">the original <tt>Makefile</tt></a>:
</p><div><pre>PROGRAMS        = flexibled simpled

FOBJS           = fobjs/tridentd.o fobjs/ppcstuff.o fobjs/client.o \
                        fobjs/status.o fobjs/handlers.o
SOBJS           = sobjs/tridentd.o sobjs/client.o sobjs/status.o \
                        sobjs/handlers.o
LDFLAGS         = -L../../../../export/power/usr/lib
LIBS            = -lae -lat
HEADERS         = tridentd.h debug.h AIXAESuite.h
INCFLAGS        = -I/usr/include/mac

DEBUG           = -D_DEBUG=0 -w
OSVERSION       = -DAIX4_x

CFLAGS          = ${DEBUG} ${OSVERSION} -D_XOPEN_SOURCE -DSYS_V \
                -qcpluscmt -qextchk -qfullpath -qinfo -qmacpstr -qproto \
                -qlanglvl=ansi -qtune=604
</pre></div>
<p>
<tt>libae.a</tt> and <tt>libat.a</tt> are the Apple events and AppleTalk libraries respectively, and <a href="https://github.com/classilla/hnae/blob/main/nutridentd/AIXAESuite.h"><tt>AIXAESuite.h</tt></a> (part of the project) contains the FourCCs for the Apple event messages and their subparameters this daemon understands, namely ones for quitting, heartbeats, version check (accepts version, returns error or no error), interval (for uptime only, specifies the refresh frequency), and actual message events where data is passed.
</p><p>
The C compiler defaults to generic <tt>cc</tt>, but those <tt>-q*</tt> options betray what compiler was actually expected: IBM&#39;s own C compiler for AIX, <tt>xlC</tt>. To link against, Apple included a tweaked subset of its header files with Harpoon in <tt>/usr/include/mac</tt>, though most of the files are generally unchanged, and only a few reference AIX specifically:
</p><div><pre>/usr/include/mac/% grep AIX *
AppleEvents.h:/*    AIX can&#39;t deal with enums that large - DJP */
AppleEvents.h:/*    AIX can&#39;t deal with enums that large - DJP */
AppleEvents.h:/* Required call for AIX implementations. */
AppleEvents.h:#ifdef _AIX
AppleEvents.h:#endif        /* _AIX */
ConditionalMacros.h:        for copiling code to be run under AIX
ConditionalMacros.h:/*      There is no pascal linkage in AIX. Null out the keyword
PPCToolBox.h:/* These are additions specific to the AIX implementation. */
PPCToolBox.h:#ifdef _AIX
PPCToolBox.h:#endif /* _AIX */
</pre></div>
<p>
This means that very few of the C structs defined in those files were altered from their Mac OS originals. To be able to emit Apple event and AppleTalk structures compatible with Mac OS, <tt>xlC</tt> has to be able to pack structs <em>in the way a 68K Mac would pack them</em>, or they won&#39;t be compatible over the wire. In general, such 68K-packed structs are smaller than the way a PowerPC-native compiler would pack them for maximum efficiency on PowerPC.
</p><p>
And, well, it turns out it <em>can</em>. I mentioned before that there were weird things in <tt>xlC</tt> related to Mac compatibility which could have only come about from AIX and Mac OS being entangled for so long, and those things are <tt>-qmacpstr</tt>, which allows the <tt>\p</tt> shorthand for turning a <tt>char *</tt> literal into a Pascal string, as well as support for <tt>#pragma options align=mac68k</tt>, which causes the compiler to obey Mac 68K alignment rules until turned off with <tt>#pragma options align=reset</tt>. Those options are of no value on regular AIX; they would only be good for writing AIX programs that interact with classic Mac data structures, and they would only have had a reason to exist if AIX and Mac OS were to be more tightly intertwined. This compiler support doesn&#39;t seem to have been specific to Apple, either: the <tt>xlC</tt> you got for the ANS was vanilla IBM, and to this day IBM still documents and supports <a href="https://www.ibm.com/docs/en/xl-c-and-cpp-aix/16.1?topic=aggregates-alignment-examples">Mac 68K alignment</a> and <a href="https://www.ibm.com/docs/en/xl-c-and-cpp-aix/16.1?topic=descriptions-qmacpstr">Mac Pascal strings</a> in the most recent version of <tt>xlC</tt>, 16.1 as of this writing.
</p><p>
What do we do if we don&#39;t have <tt>xlC</tt>? I used to have access to it at the University but I never had a license for it on my own hardware as I never needed it; <tt>gcc</tt> was more than sufficient. Unfortunately, <tt>gcc</tt> on non-Darwin platforms (because I guess Apple and IBM didn&#39;t read RMS into the grand plan) doesn&#39;t support Mac Pascal strings or 68K alignment. You can work around the Pascal string problem by hand-encoding them (a Pascal-compatible <tt>Str255</tt> simply encodes the length into the first byte instead of being null-terminated), but there&#39;s no way, or at least not with the old <tt>gcc/egcs</tt> 2.x for AIX 4, to make it pack things the way you want them without manually spelling the alignments out with things like <tt>char[]</tt>. I did actually try doing that, but to get the alignments from my Tiger G4, I ran into the fact that even good old 32-bit Carbon didn&#39;t support any of this nonsense by then:
</p><div><pre>% cat /Developer/SDKs/MacOSX10.4u.sdk/Developer/Headers/FlatCarbon/PPCToolbox.h
#warning PPCToolbox.h is not available on Mac OS X
% cat /Developer/SDKs/MacOSX10.4u.sdk/Developer/Headers/FlatCarbon/AppleTalk.h
#warning AppleTalk.h is not available on Mac OS X
</pre></div>
<p>
I ended up installing the <em>AIX</em> Mac headers on the G4 and managed to fish out the corrected alignments of all the AppleTalk structures, and it compiled, but it still didn&#39;t work. I&#39;ve left this attempt as <a href="https://github.com/classilla/hnae/blob/main/nutridentd/ppcpacked.h"><tt>ppchacked.h</tt></a> and <a href="https://github.com/classilla/hnae/blob/main/nutridentd/ppcpacked.c"><tt>ppchacked.c</tt></a> for messing with another day.
</p><p>
Fortunately, it turns out we don&#39;t really need it for the simple form of this daemon. Only the flexible form needs to talk directly to clients and thus must create and populate Apple data structures, and you&#39;ll notice that in the <tt>Makefile</tt> for the simple form there&#39;s no <tt>ppcstuff.o</tt> (that&#39;s Program-to-Program Communication, not PowerPC), which is where <a href="https://github.com/classilla/hnae/blob/main/nutridentd/ppcstuff.c">all of that lives</a>. Everywhere else only deals in Apple events,  and those functions treat it as an opaque data type using accessor methods like <tt>AEGetAttributePtr</tt> and <tt>AEGetParamPtr</tt> instead of manipulating the struct directly. As such code doesn&#39;t depend on having its own bytewise understanding of the struct, that much we can compile with <tt>gcc</tt>. As long as we only require one port type for this service, the simple form will suffice, so we can still create the backend with a freely available compiler.
</p><p>
So what are we going to create? The Status-Who demo is the most straightforward shell to take over since it displays text to the client. What we want to do should be textual, approach some level of utility, and be something that would take the local Mac much more memory and/or CPU capacity to do itself than it would ordinarily have available.
</p><p>
With that in mind, let&#39;s use the existing <a href="https://github.com/HackerNews/API">Firebase API</a> to display an auto-updating list of the top stories on Hacker News. (Attention Lobste.rs and Two Stop Bits: if you have a functioning API I&#39;ll support that too.) I think this is an excellent test case, because why not have it in the background while you do your distraction-free writing or something, nothing running on native 68K Mac OS speaks TLS 1.3 (<a href="https://github.com/classilla/cryanc">well, not yet</a>, anyway), and even if there were it would take a good few seconds to actually download and parse <em>every single</em> API call because of the crypto overhead on a 68040. For that matter, on the 200MHz 604e it still takes a few seconds to get all the article titles together, but there are ways to make that more efficient, AIX handles the tasks, <em>and</em> the client Mac isn&#39;t throttled up doing all this while you&#39;re trying to do something else.
</p><p>
We want this to be multi-line, so the first order of business is to write a new simplified daemon that responds with the who-list instead of uptime, which I&#39;ve grandiosely called <tt>hnd</tt>. The original source code has a define <tt>SIMPLIFIED</tt> to elide all the unneeded flexible code but I&#39;ve stripped it down to only run as simplified in this tree. It assumes all requests it gets are for the who-view and responds accordingly.
</p><p>
The function <a href="https://github.com/classilla/hnae/blob/main/nutridentd/status.c#L242"><tt>GetWhoString</tt> in <tt>status.c</tt></a> emits the who blob, limited to <tt>BUFSIZ</tt> bytes (for the classic Mac OS, this value is 1024 by default, or 1KiB), which <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/status.c#L65">in our stripped version is now called <tt>GetString</tt></a>. I&#39;ve left hooks for making the interval irregular or more efficient (see <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/status.c#L112"><tt>StringUpdated</tt> in <tt>status.c</tt></a>, which currently always returns true), but right now it does a full check every time the recheck interval comes around.
</p><p>
Speaking of intervals, there are three timing intervals running to keep everything happy. <tt>HEARTBEAT_CHECK</tt>, <a href="https://github.com/classilla/hnae/blob/main/nutridentd/client.c#L32">originally in <tt>client.c</tt></a> and <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/tridentd.h#L18">now in <tt>tridentd.h</tt></a>, is the expected frequency at which we would get Apple events from a connected client telling us it&#39;s still there. <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/client.c#L44"><tt>HEARTBEAT_SEND</tt>, in <tt>client.c</tt></a>, is how long after the last Apple event we&#39;ll send a heartbeat <em>to</em> to the client, if no events have been passed in the meantime. Finally, <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/client.c#L53"><tt>DEFAULT_INTERVAL</tt> in <tt>client.c</tt> </a>is how often we&#39;ll actually try to update the string we send (i.e., check the Hacker News API for what&#39;s on the front page) — whatever we do should optimally take less than <tt>HEARTBEAT_CHECK</tt> seconds to complete so we don&#39;t queue up too many client heartbeats while we&#39;re blocked on an operation. In <tt>hnd</tt>, these values are 30 seconds, 120 seconds and 60 seconds respectively.
</p><p>
Finally, we&#39;ll put it into <tt>/etc/ppcd.conf</tt> with the signature <tt>HCKN</tt> (you could change <tt>kSignature</tt> in <tt>tridentd.h</tt> just to make it clean, but this is never actually used in the simplified version of the daemon since <tt>ppcd</tt> handles all the signature stuff). We&#39;ll run it under my uid, though you could also run it under the guest user if you still have that. On my system this will always authenticate but there&#39;s no reason not to let a guest on your network query this ... right?
</p><div><pre>Hacker News:1000:1000:/usr/src/hnd/hnd:HCKN:guest:NONE
</pre></div>
<p>
Restart <tt>ppcd</tt>, either from SMIT or the command line, and it will now be available for that service.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvazxqRWSh42NliD5sEC4GI_FbkCPod0lExmNzhZEBWTXsn9QxdKX-ECIjNq4HQZlQbYhAC_Rj3o1UB7zFMoURed8FJfFmYN_fmkgQQFL7iWTpGH_dlWRxHucuPyE0u-00ytKiysOiO2XO5vXn3GUugVnfXHUTUjCjZoxP4zMeutonWdRQdgDgxMzea1I/s832/Picture%201.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhvazxqRWSh42NliD5sEC4GI_FbkCPod0lExmNzhZEBWTXsn9QxdKX-ECIjNq4HQZlQbYhAC_Rj3o1UB7zFMoURed8FJfFmYN_fmkgQQFL7iWTpGH_dlWRxHucuPyE0u-00ytKiysOiO2XO5vXn3GUugVnfXHUTUjCjZoxP4zMeutonWdRQdgDgxMzea1I/s320/Picture%201.png" width="320"/></a></p><p>

Now for the client. Apple provided source for Fractal Demo, Javelin (i.e., Status Demo) and Trident (Status-Who Demo) in inconsistent formats, respectively MPW 3.3/MacApp 3.0, CodeWarrior Gold 11 with PowerPlant <em>and</em> MPW 3.3/MacApp 3.0, and just plain CodeWarrior Gold 10 (not 11) with PowerPlant, which is the one we&#39;re using. The first order of business is pulling up the CodeWarrior version to the version of the compiler I use locally on the Q800 for <a href="http://oldvcr.blogspot.com/search/label/lynx">MacLynx</a>, which is CodeWarrior Pro 2, and generating it as a 68K build instead of a fat binary since it&#39;s a Quadra, after all. This particular version of CodeWarrior is available from a veritable Garden of various Macintosh software sites but it should also work with later compilers.
</p><p>
We&#39;ll first get it to compile and running against the regular flexible daemon. I&#39;ve provided this version separately as &#34;New Trident Demo&#34;; just unstuff and open the project. The main changes, besides completely reconstructing the project file from scratch, were slight adjustments for the later PowerPlant and rewriting CodeWarrior Gold&#39;s C++ <tt>inherited::</tt> idiom, which CW Pro 2 doesn&#39;t seem to understand.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRAncEg4bqgqb_aHqpLvESifeaHoa__MXZXAgznbqgGLO1aPlRtH4BqSHqcbXoYQCYcYNitBXZsXEFX7asqBsNgVTLnESc_1A4qxFa0Lo0oxonGZM_C2dO2_BJcd5VeaY3p1ZE4oRYICNNR9_-vBbhaUmxxysoRGCTg1wfhhhbZr6s1NkHaLTXlXedXkw/s832/Picture%208.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRAncEg4bqgqb_aHqpLvESifeaHoa__MXZXAgznbqgGLO1aPlRtH4BqSHqcbXoYQCYcYNitBXZsXEFX7asqBsNgVTLnESc_1A4qxFa0Lo0oxonGZM_C2dO2_BJcd5VeaY3p1ZE4oRYICNNR9_-vBbhaUmxxysoRGCTg1wfhhhbZr6s1NkHaLTXlXedXkw/s320/Picture%208.png" width="320"/></a></p><p>

The major guts of the MacOS client are in </p><tt>CTridentwhoView.cp</tt><p> and </p><tt>CTridentCmds.cp</tt><p>. There&#39;s lots of commented-out code in here, but that&#39;s as it came, so don&#39;t blame me. Fortunately, to switch it over to the Hacker News daemon, all we need to do is change the </p><tt>JVLN</tt><p> signature to </p><tt>HCKN</tt><p>.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj-whSh7JFO1VzzdiWjKl0wxiD45WxbMs6sZ91yQ-SeO3SXXjbx0Kw79FwR_vZJAiN1qSqRaO0I7xXUhKpZxS-tG5bSSHpAWOtarx28XrdFetmiZGc0uc7C4Jfn6JLeGlLhkuW5tR_Jr_qE0ypxEUz1E1_MQgNgLvC0KPi8Jja6UPREph-BAbwpw1amO7c/s832/Picture%2010.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj-whSh7JFO1VzzdiWjKl0wxiD45WxbMs6sZ91yQ-SeO3SXXjbx0Kw79FwR_vZJAiN1qSqRaO0I7xXUhKpZxS-tG5bSSHpAWOtarx28XrdFetmiZGc0uc7C4Jfn6JLeGlLhkuW5tR_Jr_qE0ypxEUz1E1_MQgNgLvC0KPi8Jja6UPREph-BAbwpw1amO7c/s320/Picture%2010.png" width="320"/></a></p><p>

Back in </p><tt>hnd</tt><p> (we can now make changes to it live and have them reflected in the output: remember, </p><tt>ppcd</tt><p> is like </p><tt>inetd</tt><p>, just with Apple events) </p><a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/status.c#L69">I modified <tt>GetString</tt> to return a static multiline string</a><p> as a proof of concept ... and, with the client in &#34;who&#34; mode, it worked! (If you do this with &#34;uptime&#34; mode, you get a note saying it got back a chunked response.)
</p><p>
The next step is to make this a little easier to work on. I&#39;d rather have the C code call out to a script that it can take the output of rather than juggle all this work in the daemon itself (it&#39;s probably safer that way, too), so we&#39;ll add a little section of code <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/status.c#L73">to <tt>popen()</tt> a pipe to Perl and have Perl run a script</a>. The initial sample script will just <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/simple_hn.pl">display the local time</a> to show that the updates are happening regularly.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSwsYtUD3xpSp_ivJLFaNlIXRbE4Gy1_TOYMUiVV66BwyWn2c61iDcmcshzCbjQn0nETDRPCxDxSsNDCXxbGH1YSUywzcMM3oNLxTjd_AEibUvTRLOuIHxTCLtrSyRhtWVV7nS_aRCPSVyoGfILPO5-sWa7or8LphruKwUAPMZ2iyR6nt94fQ5MT2aPnA/s832/Picture%2011.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiSwsYtUD3xpSp_ivJLFaNlIXRbE4Gy1_TOYMUiVV66BwyWn2c61iDcmcshzCbjQn0nETDRPCxDxSsNDCXxbGH1YSUywzcMM3oNLxTjd_AEibUvTRLOuIHxTCLtrSyRhtWVV7nS_aRCPSVyoGfILPO5-sWa7or8LphruKwUAPMZ2iyR6nt94fQ5MT2aPnA/s320/Picture%2011.png" width="320"/></a></p><p>

And they do, leaving our last step on the server side to actually write something that parses the API. <a href="https://github.com/classilla/hnae/blob/a79ed189fc70bbc8ce848df868c8d81be39d3176/hnd/hn.pl">In this Perl script</a>, using </p><tt>carl</tt><p> from <a href="https://github.com/classilla/cryanc">Crypto Ancienne</a> as a HTTPS-enabled </p><tt>curl</tt><p> substitute and some trivial regexes to pull out fields from the returned JSON, we can populate the top ten list of stories with their titles and current point level.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgEACtCOJ0A0EH-xTkkFIhP-zAKAMSParIBcCRQTSsztBH_fHntb6ndbgUFU1DpkpXfpvEsQYlIYxFD5Bn76xAgb5bgwZUxorq49BssbfJ-BYleBCPL0V63wDET297baB2jtACG6QjBv_oDuzCu5LzK-eO5cJITBN3vdHCm_RHTaImzscyP7kP4llAGGL0/s832/Picture%2012.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgEACtCOJ0A0EH-xTkkFIhP-zAKAMSParIBcCRQTSsztBH_fHntb6ndbgUFU1DpkpXfpvEsQYlIYxFD5Bn76xAgb5bgwZUxorq49BssbfJ-BYleBCPL0V63wDET297baB2jtACG6QjBv_oDuzCu5LzK-eO5cJITBN3vdHCm_RHTaImzscyP7kP4llAGGL0/s320/Picture%2012.png" width="320"/></a></p><p>

Ta-daa! And we&#39;re still using the Quadra normally. All it has to do is redraw the window when it gets the reply from the ANS; otherwise the Mac isn&#39;t tied up every 60 seconds while we have the live display in the background.
</p><p>
For the final run, we will remove the option to open an uptime window (it won&#39;t work), change the names, add a proper &#34;about&#34; window, and add some code for a proper title bar on the window. To change the resources, first go into ResEdit and remove the <tt>ckid</tt> resource (it will complain it&#39;s checked out read only from an MPW project; ResEdit will let you change things but PowerPlant Constructor won&#39;t), then open the resource file in Constructor to make the other changes so that everything remains up to date with the source code.
</p><p>
Let&#39;s take it for a spin!

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvJ3Yi4quNjyMA-qeaxuhCS9W3XH3gszEFFtwgHP30ZRfbs8AjVzC6cbYmXQxfBZAJnF8na3Zcd0p7-ipw7e6U8LLMXQ_VGgv6n1y28pHl02uajykKcCIs5owfQxKb81fcTXnxkb2MNV6nxmrWFbad1DJOIw3T1iJXJ5jW3cqqkS8QLGoKfEGwQXFAaw4/s832/Picture%2013.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvJ3Yi4quNjyMA-qeaxuhCS9W3XH3gszEFFtwgHP30ZRfbs8AjVzC6cbYmXQxfBZAJnF8na3Zcd0p7-ipw7e6U8LLMXQ_VGgv6n1y28pHl02uajykKcCIs5owfQxKb81fcTXnxkb2MNV6nxmrWFbad1DJOIw3T1iJXJ5jW3cqqkS8QLGoKfEGwQXFAaw4/s320/Picture%2013.png" width="320"/></a></p><p>

Dear server: I would like to snarf Hacker News top stories in the background plz thx bye

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFOyUKXJcdHzXTskM7IiUBEDvr2-nFSYtR0kdxxNSotDav2hXSOPzgPLcpZ3y3xTD0eNCsgNrmkKpYEIiW_-DfdEk_WCoqddhmhv4gdUn-ng5oe1sXQS91DWY7l6Ww4TLPpFJ-dGnFUUOF2ymcKUK_YJPV-x187Y4bvT2RRM-W7Gg6srMI9TUAD39Tbk4/s832/Picture%2014.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFOyUKXJcdHzXTskM7IiUBEDvr2-nFSYtR0kdxxNSotDav2hXSOPzgPLcpZ3y3xTD0eNCsgNrmkKpYEIiW_-DfdEk_WCoqddhmhv4gdUn-ng5oe1sXQS91DWY7l6Ww4TLPpFJ-dGnFUUOF2ymcKUK_YJPV-x187Y4bvT2RRM-W7Gg6srMI9TUAD39Tbk4/s320/Picture%2014.png" width="320"/></a></p><p>

Select your symbiont! (Though there&#39;s only one.)

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhul3zqhndqbHJ6qjq7NfD5XO4bAqJ77LQtwd88BockqdurvDKb0WTF72QOqHeLxze0qOnjxvT5NJ9nAyiK1nBCBpJUrGpwhjATcderMM1KCoEPu4kasDbnKhL3ayzto6VDZQJ0lGDtpFl1P_F7xRK0mixo6RW8gpcURf8JDMalaQEFJbgm1Pk-77L35pc/s832/Picture%2015.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhul3zqhndqbHJ6qjq7NfD5XO4bAqJ77LQtwd88BockqdurvDKb0WTF72QOqHeLxze0qOnjxvT5NJ9nAyiK1nBCBpJUrGpwhjATcderMM1KCoEPu4kasDbnKhL3ayzto6VDZQJ0lGDtpFl1P_F7xRK0mixo6RW8gpcURf8JDMalaQEFJbgm1Pk-77L35pc/s320/Picture%2015.png" width="320"/></a></p><p>

And after a few seconds to gather the data, we have a display!

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4YwcIB8OjaUl45jbvmLRcsLV8vsPjSNZA0oA25ydA7gwx9q7raqLMZyXmFKd6s3O2sGfgPmy93Ghd-sKxFbz1G6YF4VOmv53J3XHnyNr-7rRrv4OKOw38k95R7-o_YFmgNkmlppUq7woBBfA4M-l6iSk2tMZzLkDqx7pHFOc1IZE4quWdckrcXrL8uI0/s2560/IMG_20231104_182352_HDR.jpg"><img alt="" data-original-height="2560" data-original-width="1920" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4YwcIB8OjaUl45jbvmLRcsLV8vsPjSNZA0oA25ydA7gwx9q7raqLMZyXmFKd6s3O2sGfgPmy93Ghd-sKxFbz1G6YF4VOmv53J3XHnyNr-7rRrv4OKOw38k95R7-o_YFmgNkmlppUq7woBBfA4M-l6iSk2tMZzLkDqx7pHFOc1IZE4quWdckrcXrL8uI0/s320/IMG_20231104_182352_HDR.jpg"/></a></p><p>

I copied it over to the Color Classic and it works there too. Naturally both the Quadra and the Mystic can be fetching at the same time with no interference. An enhancement might be to have a common cache so that multiple sessions don&#39;t need to be pulling the same data over and over on the same box, but I&#39;ll leave that as an exercise to the reader.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVm64EzxCetNwbqI_MJaImZ6keAXZfFAYzDInIoPHQRvavJvPMO2yhSwjM2H-5RhNIqYzGntfRA9DyWtlOdjuyGLsV1BksMTnBfowVG5H5bw_V8ZNQNVx9VFlmvx4ulFBU7mIAQPEBz_0HaTPqxt0ywVjqwT3QRZl2NghVaBFtiStChl3krmmLrlHJm0o/s832/Picture%2016.png"><img alt="" data-original-height="624" data-original-width="832" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVm64EzxCetNwbqI_MJaImZ6keAXZfFAYzDInIoPHQRvavJvPMO2yhSwjM2H-5RhNIqYzGntfRA9DyWtlOdjuyGLsV1BksMTnBfowVG5H5bw_V8ZNQNVx9VFlmvx4ulFBU7mIAQPEBz_0HaTPqxt0ywVjqwT3QRZl2NghVaBFtiStChl3krmmLrlHJm0o/s320/Picture%2016.png" width="320"/></a></p><p>

As a parenthetical note, look at how little memory this requires. You could run this easily on a much less powerful Mac; it should run just fine on a Macintosh Plus as long as the Plus has enough RAM to boot System 7, since that&#39;s the earliest OS version that has the PPC Toolbox.
</p><p>
Unfortunately the source code as given is only known to work on Harpoon and I&#39;m not aware of anything that emulates a Network Server, not even QEMU, so you&#39;ll need the real hardware to run this right now. That said, it should be possible (mutatis mutandis) to mimic a similar setup on early versions of Mac OS X still supporting EtherTalk with appropriate modifications, and with Mac OS 9&#39;s PPC Toolbox over TCP/IP you should still be able to do it on more recent ones as the Apple Event Manager <a href="https://developer.apple.com/documentation/applicationservices/apple_event_manager?language=objc">remains part of macOS</a> and supported in both Objective-C and Swift. I may do this myself if I get some time to, but I look forward to people exploring the concept more. The calls this backend uses should be easy to translate to modern code with few changes.
</p><p>
But the symbiotic application concept, which will be completely new to many of you, didn&#39;t set the world on fire back then either. I know of very few third-party programs that took advantage of it on the ANS; one exception was IPT uShare, which had a scriptable AppleShare administration tool (<tt>IPT ScriptableAdmin:0:0:/ushare/Admin/iptosad:Sndr:guest:*</tt>). Part of this was no doubt because the ANS was incredibly expensive and Apple ended up selling very few of them. This was made even more acute by the fact that the planned multiprocessor ANS, which might have appealed to the well-heeled buyers who could afford it, was only prototyped and never sold; I know at least one of these cards is out there and wouldn&#39;t mind getting my hands on another. As a poor substitute, Apple offered the 200MHz 604e single processor version as both an upgrade card and as a complete 700/200 system with 48MB of RAM and two 4GB drives for $16,129, or about $32,000 in 2023. On the software side Harpoon only got a single upgrade to 4.1.5, which is the last version that you can run on an ANS (IBM AIX doesn&#39;t work, nor do many IBM APARs, which Apple released separately in ANS-specific versions on their own FTP site <tt>fixdist.apple.com</tt>, now lost). It&#39;s hard to say if the line was actually profitable, and I&#39;ve heard arguments about this both ways because there was a lot of sunk RandD despite having big margins on a per-unit basis, but it&#39;s beyond dispute that the installed base was very small.

</p><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhW2UgSdMK-eKrjF6oQmoBVw78gr_TeP1XclcGxRhzZssNVGMLYW4tTieWY_B_VdJ4QZnDzslqjGxG4jK8vkRoOIqthJYbB6RcWEK6311F8trXy_7aN5V8UT8xxGSNaM4_GvnP2hbPq969_AUoqIBUA6-jAuFaF4dPuoeY06C8ICTMViS72dxU3Z-hPuRw/s2394/1997-02-17-content21.jpg"><img alt="" data-original-height="2394" data-original-width="1920" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhW2UgSdMK-eKrjF6oQmoBVw78gr_TeP1XclcGxRhzZssNVGMLYW4tTieWY_B_VdJ4QZnDzslqjGxG4jK8vkRoOIqthJYbB6RcWEK6311F8trXy_7aN5V8UT8xxGSNaM4_GvnP2hbPq969_AUoqIBUA6-jAuFaF4dPuoeY06C8ICTMViS72dxU3Z-hPuRw/s320/1997-02-17-content21.jpg"/></a></p><p>

Meanwhile, Amelio hired his old comrade Ellen Hancock away from National Semiconductor in June 1996 as CTO and tasked her with finding Apple&#39;s new operating system direction. At Comdex in November 1996, Hancock announced to shocked Vegas attendees that the Network Server would run Windows NT <em>and</em> MacOS after all, as well as AIX, and planned to ship a ROM upgrade to make this possible. It&#39;s not clear the idea was ever technically feasible, but it didn&#39;t end up mattering anyhow: Apple bought NeXT just a month later in December (against Hancock&#39;s recommendation), and in April 1997 Amelio, on the advice of the newly returned Steve Jobs, cancelled both <a href="http://oldvcr.blogspot.com/2023/10/teaching-apple-cyberdog-10-new-tricks.html">OpenDoc</a> and the Network Server line on the same day. That&#39;s sad and the end of one of the weirdest chapters during Apple&#39;s weirdest period, but I suppose I have Steve-O to thank for me getting my first big server, because I probably wouldn&#39;t have wound up with it otherwise.
</p><p>
Fortunately, even after their cancellation many of the ANSes at Apple remained in operation serving content, some as late as 2005, and happily some of these old warhorse systems have also wound up in the hands of collectors. An Apple Network Server isn&#39;t a small system to house, but it&#39;s hardly a white elephant, and it&#39;s capable of tricks no other Apple system at the time could match. Plus, isn&#39;t it interesting to think of what an AIX Mac might have looked like? (Hey, wanna send me an SMP card for my 500? Please?) Apple would not have a true enterprise-grade server in its lineup again until the Xserve G4 in 2002.
</p><p>
The source code for the server daemons (original and Hacker News) and the clients (original and Hacker News) <a href="https://github.com/classilla/hnae">is on Github</a>. Compatible versions of Perl and <tt>gcc</tt> for AIX 4, which are prerequisites, are on <a href="gopher://gopher.floodgap.com/1/archive/ans-aixpdslib-aix-4">our partial Gopher mirror</a> of the former AIXPDSLIB, and Crypto Ancienne <tt>carl</tt> is available <a href="https://github.com/classilla/cryanc">on Github</a>.
</p>
</div></div>
  </body>
</html>
