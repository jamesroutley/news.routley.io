<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tip.golang.org/doc/fuzz/">Original</a>
    <h1>Go Fuzzing</h1>
    
    <div id="readability-page-1" class="page"><div>
  


<article>












<p>Go supports fuzzing in its standard toolchain beginning in Go 1.18.</p>
<h2 id="overview">Overview</h2>
<p>Fuzzing is a type of automated testing which continuously manipulates inputs to
a program to find bugs. Go fuzzing uses coverage guidance to intelligently walk
through the code being fuzzed to find and report failures to the user. Since it
can reach edge cases which humans often miss, fuzz testing can be particularly
valuable for finding security exploits and vulnerabilities.</p>
<p>Below is an example of a <a href="#glos-fuzz-test">fuzz test</a>, highlighting itâ€™s main
components.</p>
<img alt="Example code showing the overall fuzz test, with a fuzz target within it. Before the fuzz target is a corpus addition with f.Add, and the parameters of the fuzz target are highlighted as the fuzzing arguments." src="https://tip.golang.org/doc/fuzz/example.png"/>
<h2 id="writing-and-running-fuzz-tests">Writing and running fuzz tests</h2>
<h3 id="requirements">Requirements</h3>
<p>Below are rules that fuzz tests must follow.</p>
<ul>
<li>A fuzz test must be a function named like <code>FuzzXxx</code>, which accepts only a
<code>*testing.F</code>, and has no return value.</li>
<li>Fuzz tests must be in *_test.go files to run.</li>
<li>A <a href="#glos-fuzz-target">fuzz target</a> must be a method call to
<code><a href="https://pkg.go.dev/testing#F.Fuzz" rel="noreferrer" target="_blank">(*testing.F).Fuzz</a></code> which
accepts a <code>*testing.T</code> as the first parameter, followed by the fuzzing
arguments. There is no return value.</li>
<li>There must be exactly one fuzz target per fuzz test.</li>
<li>All <a href="#glos-seed-corpus">seed corpus</a> entries must have types which are
identical to the <a href="#fuzzing-arguments">fuzzing arguments</a>, in the same order.
This is true for calls to
<code><a href="https://pkg.go.dev/testing#F.Add" rel="noreferrer" target="_blank">(*testing.F).Add</a></code> and any
corpus files in the testdata/fuzz directory of the fuzz test.</li>
<li>The fuzzing arguments can only be the following types:
<ul>
<li>string, []byte</li>
<li>int, int8, int16, int32/rune, int64</li>
<li>uint, uint8/byte, uint16, uint32, uint64</li>
<li>float32, float64</li>
<li>bool</li>
</ul>
</li>
</ul>
<h3 id="suggestions">Suggestions</h3>
<p>Below are suggestions that will help you get the most out of fuzzing.</p>
<ul>
<li>Fuzzing should be run on a platform that supports coverage instrumentation
(currently AMD64 and ARM64) so that the corpus can meaningfully grow as it
runs, and more code can be covered while fuzzing.</li>
<li>Fuzz targets should be fast and deterministic so the fuzzing engine can work
efficiently, and new failures and code coverage can be easily reproduced.</li>
<li>Since the fuzz target is invoked in parallel across multiple workers and in
nondeterministic order, the state of a fuzz target should not persist past
the end of each call, and the behavior of a fuzz target should not depend on
global state.</li>
</ul>
<h3 id="custom-settings">Custom settings</h3>
<p>The default go command settings should work for most use cases of fuzzing. So
typically, an execution of fuzzing on the command line should look like this:</p>
<pre><code>$ go test -fuzz={FuzzTestName}
</code></pre>
<p>However, the <code>go</code> command does provide a few settings when running fuzzing.
These are documented in the <a href="https://pkg.go.dev/cmd/go" rel="noreferrer" target="_blank"><code>cmd/go</code> package docs</a>.</p>
<p>To highlight a few:</p>
<ul>
<li><code>-fuzztime</code>: the total time or number of iterations that the fuzz target
will be executed before exiting, default indefinitely.</li>
<li><code>-fuzzminimizetime</code>: the time or number of iterations that the fuzz target
will be executed during each minimization attempt, default 60sec. You can
completely disable minimization by setting <code>-fuzzminimizetime 0</code> when fuzzing.</li>
<li><code>-parallel</code>: the number of fuzzing processes running at once, default
<code>$GOMAXPROCS</code>. Currently, setting -cpu during fuzzing has no effect.</li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><strong>Tutorial</strong>:
<ul>
<li>For an introductory tutorial of fuzzing with Go, please see <a href="https://go.dev/blog/fuzz-beta" rel="noreferrer" target="_blank">the blog
post</a>.</li>
<li>More to come soon!</li>
</ul>
</li>
<li><strong>Documentation</strong>:
<ul>
<li>The <a href="https://pkg.go.dev//testing#hdr-Fuzzing" rel="noreferrer" target="_blank"><code>testing</code></a> package docs
describes the <code>testing.F</code> type which is used when writing fuzz tests.</li>
<li>The <a href="https://pkg.go.dev/cmd/go" rel="noreferrer" target="_blank"><code>cmd/go</code></a> package docs describe the flags
associated with fuzzing.</li>
</ul>
</li>
<li><strong>Technical details</strong>:
<ul>
<li><a href="https://golang.org/s/draft-fuzzing-design" rel="noreferrer" target="_blank">Design draft</a></li>
<li><a href="https://golang.org/issue/44551" rel="noreferrer" target="_blank">Proposal</a></li>
</ul>
</li>
</ul>
<h2 id="glossary">Glossary</h2>
<p><a id="glos-corpus-entry"></a>
<strong>corpus entry:</strong> An input in the corpus which can be used while fuzzing. This
can be a specially-formatted file, or a call to
<code><a href="https://pkg.go.dev/testing#F.Add" rel="noreferrer" target="_blank">(*testing.F).Add</a></code>.</p>
<p><a id="glos-coverage-guidance"></a>
<strong>coverage guidance:</strong> A method of fuzzing which uses expansions in code
coverage to determine which corpus entries are worth keeping for future use.</p>
<p><a id="glos-fuzz-target"></a>
<strong>fuzz target:</strong> The function of the fuzz test which is executed for corpus
entries and generated values while fuzzing. It is provided to the fuzz test by
passing the function to
<code><a href="https://pkg.go.dev/testing#F.Fuzz" rel="noreferrer" target="_blank">(*testing.F).Fuzz</a></code>.</p>
<p><a id="glos-fuzz-test"></a>
<strong>fuzz test:</strong> A function in a test file of the form <code>func FuzzXxx(*testing.F)</code>
which can be used for fuzzing.</p>
<p><a id="glos-fuzzing"></a>
<strong>fuzzing:</strong> A type of automated testing which continuously manipulates inputs
to a program to find issues such as bugs or
<a href="#glos-vulnerability">vulnerabilities</a> to which the code may be susceptible.</p>
<p><a id="glos-fuzzing-arguments"></a>
<strong>fuzzing arguments:</strong> The types which will be passed to the fuzz target, and
mutated by the <a href="#glos-mutator">mutator</a>.</p>
<p><a id="glos-fuzzing-engine"></a>
<strong>fuzzing engine:</strong> A tool that manages fuzzing, including maintaining the
corpus, invoking the mutator, identifying new coverage, and reporting failures.</p>
<p><a id="glos-generated-corpus"></a>
<strong>generated corpus:</strong> A corpus which is maintained by the fuzzing engine over
time while fuzzing to keep track of progress. It is stored in <code>$GOCACHE</code>/fuzz.</p>
<p><a id="glos-mutator"></a>
<strong>mutator:</strong> A tool used while fuzzing which randomly manipulates corpus entries
before passing them to a fuzz target.</p>
<p><a id="glos-package"></a>
<strong>package:</strong> A collection of source files in the same directory that are
compiled together. See the <a href="https://tip.golang.org/ref/spec#Packages">Packages section</a> in the Go
Language Specification.</p>
<p><a id="glos-seed-corpus"></a>
<strong>seed corpus:</strong> A user-provided corpus for a fuzz test which can be used to
guide the fuzzing engine. It is composed of the corpus entries provided by f.Add
calls within the fuzz test, and the files in the testdata/fuzz/{FuzzTestName}
directory within the package.</p>
<p><a id="glos-test-file"></a>
<strong>test file:</strong> A file of the format xxx_test.go that may contain tests, benchmarks, examples and fuzz tests.</p>
<p><a id="glos-vulnerability"></a>
<strong>vulnerability:</strong> A security-sensitive weakness in code which can be exploited
by an attacker.</p>
<h2 id="feedback">Feedback</h2>
<p>If you experience any problems or have an idea for a feature, please <a href="https://github.com/golang/go/issues/new?&amp;labels=fuzz" rel="noreferrer" target="_blank">file an
issue</a>.</p>
<p>For discussion and general feedback about the feature, you can also participate
in the <a href="https://gophers.slack.com/archives/CH5KV1AKE" rel="noreferrer" target="_blank">#fuzzing channel</a> in
Gophers Slack.</p>


</article>



</div></div>
  </body>
</html>
