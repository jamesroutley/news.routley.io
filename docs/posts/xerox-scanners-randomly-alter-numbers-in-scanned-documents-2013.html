<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.dkriesel.com/en/blog/2013/0802_xerox-workcentres_are_switching_written_numbers_when_scanning">Original</a>
    <h1>Xerox scanners randomly alter numbers in scanned documents (2013)</h1>
    
    <div id="readability-page-1" class="page"><div id="writr__main" role="main">

                                        
                                        <!-- wikipage start -->
                    <!-- TOC START -->

<!-- TOC END -->


<p>
<em>Please see the “condensed time line” section (the next one) for a time line of how the Xerox saga unfolded. <strong>It for example depicts that I did not push the thing to the public right away, but gave Xerox a lot of time before I did so.</strong> Personally, I think this is important. I will post updates and links to the relevant blog posts in there in order not to make total crap out of this article&#39;s outline.  In this way, I keep this article up-to-date for future visitors and also write new blog posts on the topic for RSS users.</em>
</p>

<h2 id="video_of_my_talk_lies_damned_lies_and_scans">Video of my Talk &#34;Lies, damned lies and scans&#34;</h2>
<div>

<p>

<iframe width="700" height="394" src="https://www.youtube.com/embed/c0O6UXrOZJo" frameborder="0" allowfullscreen=""></iframe>

</p>

<p>
<em>This FrOSCon Talk (August 2015) is a native english version of the quite popular CCC talk (December 2014), so I embed this instead of the live translation by CCC.</em>
</p>

<p>
<a href="https://www.dkriesel.com/_media/blog/2014/xerox-ccc-davidkriesel.pdf" target="_blank" title="blog:2014:xerox-ccc-davidkriesel.pdf (3.8 MB)" rel="noopener">Here you can download the slides.</a>
</p>

<p>
<a href="https://frab.cccv.de/en/31c3/public/events/6558/feedback/new" target="_blank" title="https://frab.cccv.de/en/31c3/public/events/6558/feedback/new" rel="nofollow noopener">Here you can send me feedback on the talk!</a> Thank you! <img src="https://www.dkriesel.com/lib/images/smileys/icon_smile.gif" alt=":-)"/>
</p>

</div>

<h2 id="introduction">Introduction</h2>
<div>

<p>
In this article I present in which way scanners / copiers of the Xerox WorkCentre Line randomly alter written numbers in pages that are scanned. This is not an OCR problem (as we switched off OCR on purpose), it is a lot worse – patches of the pixel data are randomly replaced in a very subtle and dangerous way: The scanned images look correct at first glance, even though numbers may actually be incorrect. Without a fuss, this may cause scenarios like: 
</p>
<ol>
<li><p> Incorrect invoices</p>
</li>
<li><p> Construction plans with incorrect numbers (as will be shown later in the article) even though they look right</p>
</li>
<li><p> Other incorrect construction plans, for example for bridges (danger of life may be the result!)</p>
</li>
<li><p> Incorrect metering of medicine, even worse, I think. </p>
</li>
</ol>

<p>
The errors are caused by an eight (!) year old bug in widely used WorkCentre and ColorQube scan copier families of the manufacturer Xerox – according to reseller data, hundreds of thousands of those machines are used across the planet. As a result, anyone having used machines of the named families has to ask himself:
</p>
<ul>
<li><p> How many incorrect documents (even though they look correct!) did I produce during the last years by scanning with xerox machines? Did I even give them to others?</p>
</li>
<li><p> What dangers are imposed by such possible document errors? Is there a danger of life for someone?</p>
</li>
<li><p> Can I be sued for such errors?</p>
</li>
</ul>

<p>
Before the bug was covered in my blog, it was not discovered or published, nor was its montrosity visible to Xerox or me. It unleashed itself across several blog articles I wrote that were then spread further by the mass media. What happened in which order can be seen in the time line below. It has been an interesting time, I promise. <img src="https://www.dkriesel.com/lib/images/smileys/icon_smile.gif" alt=":-)"/> Originally, this blog article was published in the fear the bug would be dangerous enough to put lifes at risk and in the believe Xerox would not take the bug report serious. 
</p>

<p>
The rest of the article is organized as follows.
</p>
<ul>
<li><p> First, there is a time line for you to see how the saga unfolded</p>
</li>
<li><p> By showing some real world examples I outline how we got aware of the issue, and how subtle it is. As it is hard to believe that scan copiers randomly alter written numbers, picture evidence is provided. </p>
</li>
<li><p> After that, there is a list of affected devices.</p>
</li>
<li><p> In the next section, there is a a short manual for you to reproduce the error and see of you are affected. </p>
</li>
<li><p> The last section contains a short, amateurish legal evaluation. Upshot:  The last 8 years of PDF scans of affected devices may not only contain arrors, but also I think they might be of no legal value alltogether, regardless if they are actually proven to contain errors. </p>
</li>
</ul>



</div>

<h2 id="condensed_time_line">Condensed time line</h2>
<div>

<p>
Due to the mass of the blog articles, I keep getting asked for a comprehensive time line. Here it is. The relevant blog posts are linked (barely visible, though, hm). This list will be updated as used, the current status is always marked with a <img src="https://www.dkriesel.com/lib/images/smileys/icon_exclaim.gif" alt=":!:"/>.
</p>
<div><table>
	<thead>
	<tr>
		<th> Date </th><th> What happened </th>
	</tr>
	</thead>
	<tbody><tr>
		<td> July 24th, 2013  </td><td> Number mangling discovered </td>
	</tr>
	<tr>
		<td> July 25th  </td><td> Told Xerox about number mangling in pixel data. During the next days, neither the Xerox support levels we had phoned, nor the Xerox helpdesks visiting, did know that character substitutions could occur at all and were amazed to see this. The Xerox helpdesk guys even set out replicating the “bug” at their devices and managed to do so. I think this is important as it depicts that I <em>first</em> went to Xerox and gave them about a week of time, before I posted it on my blog.  <em>Later I was to learn that the number mangling was known to Xerox.</em> </td>
	</tr>
	<tr>
		<td> August 1    </td><td> No solution from Xerox yet, nearly one week, across all support levels. They either do not believe us or look amazed. I think this is scary and write this blog post.   </td>
	</tr>
	<tr>
		<td> August 2    </td><td> The blog post goes around the planet. From now on, I get emails of people being able to replicate the “bug” around the world, as well as informations that JBIG2 compression can cause this. I update this blog post a lot. </td>
	</tr>
	<tr>
		<td> August 6,  morning   </td><td> A reader tells me there is a small notice in his copier&#39;s admin panel about character substitution. On his device, the “bug” can be avoided by setting compression from “normal” to higher. As a consequence, the issue must have been known by Xerox – so why was nobody telling us? As the notice only occurs when adjusting the setting in the admin panel, the implications, however, stay the same. People may create false figures without knowing. Anyway, I write a blog post <a href="https://www.dkriesel.com/en/blog/2013/0806_work_around_for_character_substitutions_in_xerox_machines" title="en:blog:2013:0806_work_around_for_character_substitutions_in_xerox_machines">presenting this workaround.</a>   </td>
	</tr>
	<tr>
		<td> August 6, afternoon  </td><td> <a href="https://www.dkriesel.com/blog/2013/0806_conference_call_with_xerox" title="blog:2013:0806_conference_call_with_xerox"> Conference call with Rick Dastin and Francis Tse.</a> Rick Dastin, Vice President at Xerox, is the first one actually working at Xerox being able to tell me that character substitutions actually can occur and Xerox knows (in contrast to their support). They also tell me that this is wanted. I criticize that this compression mode is called “normal”. I also learn that there are two notices in the (300 page) manuals also, telling about character substitution, also with respect to “normal”.  </td>
	</tr>
	<tr>
		<td> during the conference call </td><td> Xerox publishes <a href="http://realbusinessatxerox.blogs.xerox.com/2013/08/06/always-listening-to-our-customers-clarification-on-scanning-issue/#.UgEqCERCBiE" target="_blank" title="http://realbusinessatxerox.blogs.xerox.com/2013/08/06/always-listening-to-our-customers-clarification-on-scanning-issue/#.UgEqCERCBiE" rel="nofollow noopener">their first press statement</a>. “For data integrity purposes, we recommend the use of the factory defaults with a quality level set to “higher.”” Aside from this, they confirm the work around and tell the customers about the small notice. </td>
	</tr>
	<tr>
		<td> August 7   </td><td> <a href="http://realbusinessatxerox.blogs.xerox.com/2013/08/07/update-on-scanning-issue-software-patches-to-come/" target="_blank" title="http://realbusinessatxerox.blogs.xerox.com/2013/08/07/update-on-scanning-issue-software-patches-to-come/" rel="nofollow noopener">Second Statement</a>, Software patch announced, reads like the “normal” setting will be entirely eliminated by the patch. Xerox states most clearly: “You will not see a character substitution issue when scanning with the factory default settings.” In a further document, these factory settings are defined: Compression “higher”, at least 200 DPI.   </td>
	</tr>
	<tr>
		<td> August 9  </td><td> With Compression “higher” (even advised in the Xerox press statements) and an even more generous resolution 300 DPI I reproduced number mangling on a Xerox device. As I think this <em>is</em> a big deal as anyone could be affected, I told Xerox and wait until they confirmed to see number mangling with the same settings, too. They confirm, and after that <a href="https://www.dkriesel.com/blog/2013/0810_xerox_investigating_latest_mangling_test_findings" title="blog:2013:0810_xerox_investigating_latest_mangling_test_findings"> I wrote a detailed blog post about this</a>.   </td>
	</tr>
	<tr>
		<td> August 11  </td><td> On a Xerox WorkCentre 7545, <em>all three</em>  compression modes seem to be affected. A user reports the same using a WC 7655. In these cases, numbers seem to be mangled independently from the compression mode, which makes the issue hard to avoid. <a href="https://www.dkriesel.com/en/blog/2013/0811_all_three_compression_modes_mangling_numbers_on_xerox_workcentre_7545" title="en:blog:2013:0811_all_three_compression_modes_mangling_numbers_on_xerox_workcentre_7545">See blog post.</a>  </td>
	</tr>
	<tr>
		<td> August 12 </td><td> <a href="https://www.dkriesel.com/en/blog/2013/0812_xerox_scanning_issue_fully_confirmed" title="en:blog:2013:0812_xerox_scanning_issue_fully_confirmed">Xerox scanning issue fully confirmed</a>. They indeed implemented a software bug, eight years ago, and indeed, numbers could be mangled across <em>all</em> compression modes. They have to roll out a patch for hundreds of thousands of devices world-wide. On one hand, the implications might be of vital significance for Xerox now. On the other hand, I am glad not to go down in history as the guy too dumb to read the manual. <img src="https://www.dkriesel.com/lib/images/smileys/icon_cool.gif" alt="8-)"/> <a href="http://realbusinessatxerox.blogs.xerox.com/2013/08/07/update-on-scanning-issue-software-patches-to-come/" target="_blank" title="http://realbusinessatxerox.blogs.xerox.com/2013/08/07/update-on-scanning-issue-software-patches-to-come/" rel="nofollow noopener">Here is their press statement.</a>  </td>
	</tr>
	<tr>
		<td> August 19 </td><td> <a href="https://www.dkriesel.com/en/blog/2013/0819_xerox_patch_tested" title="en:blog:2013:0819_xerox_patch_tested">Pretested the Xerox number mangling patch today.</a> Looks good. Pattern matching completely eliminated, hundreds of thousands of devices affected.    </td>
	</tr>
	<tr>
		<td> August 22 </td><td> <a href="https://www.dkriesel.com/en/blog/2013/0822_xerox_scanning_bug_patch_released" title="en:blog:2013:0822_xerox_scanning_bug_patch_released">First patches for Xerox scanning bug releasted.</a> Because of the large number of affected device types, the patches are going to be released in several waves.    </td>
	</tr>
	<tr>
		<td> <strong>Sept 11</strong> </td><td> <strong>I keep getting asked why I did not demand money from Xerox: There are reasons for this way of proceeding. <a href="https://www.dkriesel.com/en/blog/2013/0909_xerox_money" title="en:blog:2013:0909_xerox_money">Click here for a blog post on this.</a></strong>   </td>
	</tr>
	<tr>
		<td> From this day on  </td><td> Xerox has a decentral way of selling. As a result, there is no central customer list. Consequently it is unclear  how many devices have been patched yet. I would suspect there are still hundreds of thousends devices out there, producing subtly incorrect documents for 9 years now. So: Spread the word.  </td>
	</tr>
	<tr>
		<td> March 2015  </td><td> The German Federal Office for Safety in Information Technology bans JBIG2 from being used for archival purposes.  </td>
	</tr>
</tbody></table></div>

</div>

<h2 id="examples_and_how_we_found_out">Examples and how we found out</h2>
<div>

<p>
We got aware of the problem by scanning some construction plan last Wednesday and printing it again. Construction problems contain a boxed square meter number per room. Now in some rooms, we found beautifully lay-outed, but utterly wrong square meter numbers. You really have to read the numbers to find out; this is why it is so hard to find out. In the present case, we found out because one room in the construction plan was – as the copy told us – about 22 square meters large, whereas the next room, a lot larger, was assigned a label with 14 square meters. 
</p>

<p>
Firstly, I present to you a complete <em>original version</em> of the affected construction plan part. After this, the wrong numbers will be presented. Click to enlarge. I added the yellow marks myself to show you where the errors will occur. Let us name the upper one “place 1”, the lower left “place 2” and the lower right “place 3”.
</p>

<p>
<a href="https://www.dkriesel.com/_media/blog/2013/originalzensiert.png" target="_blank" title="blog:2013:originalzensiert.png" rel="noopener"><img src="https://www.dkriesel.com/_media/blog/2013/originalzensiert.png?w=500&amp;tok=7b76b8" alt="" width="500"/></a>
</p>

<p>
Now, let us scan the construction plan and get a PDF file from it. No OCR, just plain image. Then, we get wrong square meter numbers at the three places <img src="https://www.dkriesel.com/lib/images/smileys/icon_eek.gif" alt="8-O"/> (Yeah, couldn&#39;t believe it, too). The screen shots of the erroneous places are organized in the below table. There is one additional line in the table for the original patches. The Xerox WorkCentre 7535 always produced the same errors; this is why we only need one line for it in the table. In contrast, the WorkCentre 7556 randomly produced different numbers, this is why I present three lines for three runs with different errors.
</p>


<p>
I know that the resolution is not too fine, but the numbers are clearly readable. Additionally, obviously,  these are no simple wrong pixels, but whole image patches are mixed up or copied. I repeat: This is not an OCR problem, but of course, I can&#39;t have a look into the software itself, maybe OCR is still fiddling with the data even though we switched it off.
</p>

<p>
Next example: Some cost table, scanned on the WorkCentre 7535. As we are used to, a correct-looking scan at the first glance, but take a closer look. This error was found because usually, in such cost tables, the numbers are sorted ascending. 
</p>


<p>
The 65 became an 85 (second column, third line). <em>Edit: I&#39;m getting emails telling me that also a 60 in the upper right region of the image became a 80. Thanks!</em> This is not a simple pixel error either, one can clearly see the characteristic dent the 8 has on the left side in contrast to a 6. This scan is several weeks old – no one can say how many wrong documents have been produced by the Xerox machines in the mean time.   
</p>

</div>

<h2 id="affected_devices">Affected Devices</h2>
<div>

<p>
As the saga unfolded itself, in this section I built up a “hearsay list of affected devices” according to mails my readers sent to me. As the bug is confirmed by xerox in the meantime, I was able to remove the word “hearsay”. The letter <em>x</em> can be substituted by arbitrary digits in cases where whole device families are affected. 
</p>
<div><table>
	<tbody><tr>
		<th>WorkCentre  </th><td>  232, 238, 245, 255, 265, 275, 5030, 5050, 51xx, 56xx, 57xx, 58xx, 6400, 7220, 7225, 75xx, 76xx, 77xx, 78xx  </td>
	</tr>
	<tr>
		<th>WorkCentre Bookmark  </th><td>  40, 55  </td>
	</tr>
	<tr>
		<th>WorkCentre Pro   </th><td>  232, 238, 245, 255, 265, 275  </td>
	</tr>
	<tr>
		<th>ColorQube  </th><td>  8700, 8900, 92xx, 93xx  </td>
	</tr>
</tbody></table></div>

</div>

<h2 id="reproducing_the_error">Reproducing the error</h2>
<div>

<p>
After the cost table, I printed some numbers, scanned them, OCRed them and compared them to the original ones. As the OCR produces errors, by itself, one obviously has to check by hand for false positives when performing this. I took Arial, 7pt as a test font, and the WorkCentre 7535 with the newer of the aboved named Software version as a test machine. The scan settings were like above. And again, a lot of sixes were replaced by eights: (only a few of the errors are marked yellow for the sake for laziness):
</p>


<p>
Observe how the sixes around the false eights look correct. Also the false eights contain the characteristic dent again, so whole image patches have been replaced again. 
</p>

<p>
In case you want to have a look for yourself:
</p>
<ul>
<li>
</li>
<li><p><a href="https://www.dkriesel.com/_media/blog/2013/7535-zahlenkolonnen-nachher.pdf" target="_blank" title="blog:2013:7535-zahlenkolonnen-nachher.pdf (602.9 KB)" rel="noopener">The first page of the PDF scan</a>  with a few marked false eights mixed in by the 7535 WorkCentre. The OCR was added by me later to be able to mark the numbers nicely, so be aware it may not be the original file, even though the image data in it is.</p>
</li>
<li><p> Due to the popular demand: <a href="https://www.dkriesel.com/_media/blog/2013/7535-7pt.pdf" target="_blank" title="blog:2013:7535-7pt.pdf (705.8 KB)" rel="noopener">All pages of the PDF scan</a> without any post processing, just like they came out of the 7535. Lots of pages. </p>
</li>
</ul>

</div>

<h2 id="cause_of_error_and_legal_implications">Cause of error and legal implications</h2>
<div>

<p>
The error does occur because image segments, that are considered as identical by the <em>pattern matching</em> engine of the Xerox scan copiers, are only saved once and getting reused across the page. If the pattern matching engine works not accurately, image segments get replaced by other segments that are not identical at all, e.g. a 6 gets replaced by an 8. In contrast to what Xerox suggests in their PR, this may also happen on characters, that were perfectly readable on the original, even though they were small.
</p>

<p>
It is important to notice that the image format used in the affected PDFs, JBIG2, is an <em>image format</em> and not a <em>compression algorithm</em>. It is no instruction of how to compress an image, it only defines in what format it should be saved afterwards. So to say, it is a <em>de</em>compression instruction. How you compress depends on you. JBIG2 has been created to save images that contain scanned text in an efficient way and in this way it is widely used. That allows us to nevertheless have look at how compression is done usually, even though we can&#39;t look in the source code of the Xerox or other machines. In particular we will see that encoding can be done lossless or lossy. 
<strong>Consequently, the error cause described in the following is a wrong parameter setting during ancoding. The error cause is not JBIG2 itself. Because of a software bug, loss of information was introduced where none should have been.</strong>
</p>

<p>
JBIG2, the image format used in the affected PDFs, usually has lossless and lossy operation modes. Pattern Matching &amp; Substitution“ (PM&amp;S) is one of the standard operation modes for lossy JBIG2, and “Soft Pattern Matching” (SPM) for lossless JBIG2 (<a href="http://en.wikipedia.org/wiki/JBIG2" target="_blank" title="http://en.wikipedia.org/wiki/JBIG2" rel="nofollow noopener">Read here</a> or read the papery by Paul Howard et al.<sup><a href="#fn__1" id="fnt__1">1)</a></sup>). In the <a href="http://www.itu.int/rec/T-REC-T.88-200002-I/en" target="_blank" title="http://www.itu.int/rec/T-REC-T.88-200002-I/en" rel="nofollow noopener">JBIG2 standard</a>, the named techniques are called “Symbol Matching”.
</p>

<p>
PM&amp;S works lossy, SPM lossless. Both operation modes have the basics in common: Images are cut into small segments, which are grouped by similarity. For every group only a representative segment is is saved that gets reused instead of other group members, which may cause character substitution. Different to PM&amp;S, SPM corrects such errors by additionally saving difference images containing the differences of the reused symbols in comparison to the original image. This correction step seems to have been left out by Xerox.
</p>

<p>
<strong>For PDFs that were scanned with the named Xerox devices during the last 8 years, it cannot be proven what characters were on the original sheet of paper at the places that are now defined by reused patches. Therefore, these patches have no legal value at all. Please note that it is irrelevant if errors actually occured in a specific scan – the legal value is zero once it is proven that lossy jbig 2 is used.</strong>
</p>

</div>

<h2 id="is_your_company_affected_by_the_xerox_scanning_bug">Is your company affected by the Xerox Scanning Bug?</h2>
<div>

<p>
More and more known enterprises reach out ot me these days, asking theirselves if they have a huge problem with their scanned documents. Others are already certain thay actually <em>have</em> a huge problem, some of them in security critical contexts. All have in common that they understandably are afraid of publicity. Affected companies normally have three goals: 
</p>
<ol>
<li><p> They want to solve the problem, if possible, retroactively</p>
</li>
<li><p> They don&#39;t want publicity, enterprises with lots of employees don&#39;t even want the information published internally</p>
</li>
<li><p> They want to stay eligible for compensations, i.e. they have to be careful not to destroy evidence by solving the problem. </p>
</li>
</ol>

<p>
At a closer look, these goals may contradict each other; even large and well-organized enterprises are prone for beginner&#39;s mistakes here. Thus, in general: <strong>Everyone who gets in touch with me requesting help to evaluate their own situation can be certain not to get his identity made public by me.</strong> I acted this way across the entire xerox saga and I won&#39;t stop this way of acting now. My contact data can be found in the <a href="https://www.dkriesel.com/en/imprint" title="en:imprint">imprint</a>.
</p>

</div>


                    <!-- wikipage stop -->

                                                        </div><p><bdi>en/blog/2013/0802_xerox-workcentres_are_switching_written_numbers_when_scanning.txt</bdi> · Last modified: 2015/09/02 12:31 by <bdi>david</bdi></p></div>
  </body>
</html>
