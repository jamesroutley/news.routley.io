<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mjtsai.com/blog/2022/09/20/zeroing-freed-memory/">Original</a>
    <h1>System memory allocator free operation zeroes out deallocated blocks in iOS 16</h1>
    
    <div id="readability-page-1" class="page"><div>

<p><a href="https://developer.apple.com/documentation/ios-ipados-release-notes/ios-16_1-release-notes">Apple</a>:</p>
<blockquote cite="https://developer.apple.com/documentation/ios-ipados-release-notes/ios-16_1-release-notes"><p>The system memory allocator free operation zeroes out all deallocated blocks in iOS 16.1 beta or later. Invalid accesses to free memory might result in new crashes or corruption, including <code>NULL</code>-pointer dereferences and non-zero memory being returned from <code>calloc</code>.</p></blockquote>
<p>There’s a corresponding change <a href="https://developer.apple.com/documentation/macos-release-notes/macos-13-release-notes">in macOS Ventura</a>.</p>

<p><a href="https://twitter.com/Catfish_Man/status/1572297086242271232">David Smith</a>:</p>
<blockquote cite="https://twitter.com/Catfish_Man/status/1572297086242271232">
<p><code>malloc</code> folks spent a while optimizing to compensate [for the performance regression]</p>
</blockquote>

<p><a href="https://twitter.com/astrange_e/status/1572298064039407617">mvb</a>:</p>
<blockquote cite="https://twitter.com/astrange_e/status/1572298064039407617">
<p>There’s also a performance improvement, because it makes the memory compressor work better</p>
</blockquote>

<p><a href="https://twitter.com/marcoarment/status/1572291258386903040">Marco Arment</a>:</p>
<blockquote cite="https://twitter.com/marcoarment/status/1572291258386903040">
<p>I love this, frankly, but I bet it’s going to uncover a good deal of bugs and crashes that worked until now because of luck.</p>
</blockquote>

<p>Hopefully you aren’t relying on any abandoned software.</p>

<p id="zeroing-freed-memory-update-2022-09-22">Update (2022-09-22): See also: <a href="https://news.ycombinator.com/item?id=32921910">Hacker News</a>.</p>

<p><a href="https://twitter.com/DavidAns/status/1572467498037186560">David Anson</a>:</p>
<blockquote cite="https://twitter.com/DavidAns/status/1572467498037186560"><p>Any reason Apple couldn’t restrict the new memory zeroing behavior to newly-compiled binaries to avoid the risk of breaking legacy software?</p></blockquote>

<p>I was wondering about that, too. Usually, though <a href="https://mjtsai.com/blog/2022/09/14/ios-16-text-view-breakage/">not always</a>, potentially breaking changes like this are called out in the release notes as taking effect when you compile with a new SDK. That was not the case here, so I assume there’s no linked-on-or-after check.</p><p><a rel="tag" href="https://mjtsai.com/blog/tag/ios/">iOS</a> <a rel="tag" href="https://mjtsai.com/blog/tag/ios-16/">iOS 16</a> <a rel="tag" href="https://mjtsai.com/blog/tag/mac/">Mac</a> <a rel="tag" href="https://mjtsai.com/blog/tag/macos-13-ventura/">macOS 13 Ventura</a> <a rel="tag" href="https://mjtsai.com/blog/tag/memory-management/">Memory Management</a> <a rel="tag" href="https://mjtsai.com/blog/tag/optimization/">Optimization</a> <a rel="tag" href="https://mjtsai.com/blog/tag/programming/">Programming</a> <a rel="tag" href="https://mjtsai.com/blog/tag/security/">Security</a></p>









<p>Stay up-to-date by subscribing to the <a href="https://mjtsai.com/blog/2022/09/20/zeroing-freed-memory/feed/">Comments RSS Feed</a> for this post.</p>







</div></div>
  </body>
</html>
