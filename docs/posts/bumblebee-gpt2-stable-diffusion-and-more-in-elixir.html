<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://news.livebook.dev/announcing-bumblebee-gpt2-stable-diffusion-and-more-in-elixir-3Op73O">Original</a>
    <h1>Bumblebee: GPT2, Stable Diffusion, and More in Elixir</h1>
    
    <div id="readability-page-1" class="page"><div id="app"><div><header><div><p><a href="https://www.eviau.net/"><img src="https://img.announcekit.app/1dfce53933be9b63f5e617396c8bca87?w=500&amp;s=df41449fe8763f1e3c4b9705a4017cbc" alt="Livebook.dev The Livebook Blog logo"/></a></p></div></header><nav><a target="_blank" rel="_noopener" href="https://announcekit.app/?utm_source=3IFREyQ&amp;utm_medium=feed&amp;utm_campaign=poweredby"><span>Powered️ by</span><img src="https://announcekit.app/images/feed-logo@3x.png" alt="AnnounceKit"/><p>Create yours, for free!</p></a></nav><section><div><div><p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjc1MCIgaGVpZ2h0PSIxNTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIyNzUwIiBoZWlnaHQ9IjE1MDAiIGZpbGw9Im5vbmUiIC8+PC9zdmc+" width="2750" height="1500" data-loading-src="https://img.announcekit.app/d72c14ae799fe88b23e2116fdc9c2097?q=1&amp;fm=png&amp;fit=max&amp;w=100&amp;blur=20&amp;s=0e6371dec74d096875fb159b0a69e42d" data-src="https://img.announcekit.app/d72c14ae799fe88b23e2116fdc9c2097?w=1200&amp;s=baef78376286c0c453bd939c60d7ca3d"/></p></div><a href="https://www.eviau.net/announcing-bumblebee-gpt2-stable-diffusion-and-more-in-elixir-3Op73O"></a><div><div><p><span>We are glad to announce a variety of Neural Networks models are now available to the Elixir community via </span><a href="https://github.com/elixir-nx/bumblebee" rel="nofollow noopener" target="_blank"><span>the Bumblebee project</span></a><span>.</span></p><p><span>We have implemented several models, from GPT2 to Stable Diffusion, in pure Elixir, and you can download </span><span>training parameters</span><span> for said models directly from </span><a href="https://huggingface.co/" rel="nofollow noopener" target="_blank"><span>Hugging Face</span></a><span>.</span></p><p><span>To run your first Machine Learning model in Elixir, all you need is three clicks, thanks to </span><a href="https://github.com/livebook-dev/kino_bumblebee" rel="nofollow noopener" target="_blank"><span>our integration between Livebook and Bumblebee</span></a><span>. You can also easily embed and run said models within existing Elixir projects.</span></p><p><span>Watch the video by José Valim covering all of these topics and features:</span></p><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Running-Machine-Learning-models-with-Livebook" target="_blank" rel="nofollow noopener"></a></h2><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Running-Machine-Learning-models-with-Livebook" target="_blank" rel="nofollow noopener"></a>Running Machine Learning models with Livebook</h2><p>Here are some examples of what it looks like to use <a href="https://github.com/livebook-dev/kino_bumblebee" rel="nofollow noopener" target="_blank">Livebook to run Machine Learning models</a>:</p><h3><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Text-to-image" target="_blank" rel="nofollow noopener"></a></h3><h3><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Text-to-image" target="_blank" rel="nofollow noopener"></a>Text to image</h3><p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTg1MiIgaGVpZ2h0PSIxNzEzIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxODUyIiBoZWlnaHQ9IjE3MTMiIGZpbGw9Im5vbmUiIC8+PC9zdmc+" width="1852" height="1713" data-loading-src="https://img.announcekit.app/4f31bcb99f5122396cc87568b57b4a4b?q=1&amp;fm=png&amp;fit=max&amp;w=50&amp;blur=20&amp;s=e29d756b9ba542971719d00292dc196a" data-src="https://img.announcekit.app/4f31bcb99f5122396cc87568b57b4a4b?w=1200&amp;s=26d0c132d4b40e942966f854e71b9b31"/></p><h3><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Image-classification" target="_blank" rel="nofollow noopener"></a><span>Image classification</span></h3><p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTg1MiIgaGVpZ2h0PSIxNDUwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxODUyIiBoZWlnaHQ9IjE0NTAiIGZpbGw9Im5vbmUiIC8+PC9zdmc+" alt="" width="1852" height="1450" data-loading-src="https://img.announcekit.app/821589e5d630d01e90534c134b00e9ac?q=1&amp;fm=png&amp;fit=max&amp;w=50&amp;blur=20&amp;s=d5e7391d88405703c40d17474da540eb" data-src="https://img.announcekit.app/821589e5d630d01e90534c134b00e9ac?w=1200&amp;s=8e0cc7c2b785294918661c117a67c5f5"/></p><h3><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Text-classification" target="_blank" rel="nofollow noopener"></a><span>Text classification</span></h3><p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTg1MiIgaGVpZ2h0PSIxMTI5IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxODUyIiBoZWlnaHQ9IjExMjkiIGZpbGw9Im5vbmUiIC8+PC9zdmc+" width="1852" height="1129" data-loading-src="https://img.announcekit.app/06d616aa1909a0bb909398d00a03b9c9?q=1&amp;fm=png&amp;fit=max&amp;w=50&amp;blur=20&amp;s=b3d327e6870be2bc44b3155a27a48c55" data-src="https://img.announcekit.app/06d616aa1909a0bb909398d00a03b9c9?w=1200&amp;s=7e2acf25d1a844ba0d5d9fef255c0419"/></p><h3><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Text-generation" target="_blank" rel="nofollow noopener"></a><span>Text generation</span></h3><p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTg1MiIgaGVpZ2h0PSI3ODUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjE4NTIiIGhlaWdodD0iNzg1IiBmaWxsPSJub25lIiAvPjwvc3ZnPg==" alt="" width="1852" height="785" data-loading-src="https://img.announcekit.app/767c5627d11f41e59393cfc950152445?q=1&amp;fm=png&amp;fit=max&amp;w=50&amp;blur=20&amp;s=41f0e5e1fe2965d880b29842f9bf3ca7" data-src="https://img.announcekit.app/767c5627d11f41e59393cfc950152445?w=1200&amp;s=1223bbc98c99ac90c96185280d57db44"/></p><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Incorporating-models-into-any-Elixir-project" target="_blank" rel="nofollow noopener"></a></h2><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Incorporating-models-into-any-Elixir-project" target="_blank" rel="nofollow noopener"></a>Incorporating models into any Elixir project</h2><p><span>Thanks to the new </span><a href="https://hexdocs.pm/nx/Nx.Serving.html" rel="nofollow noopener" target="_blank"><span>Nx.Serving</span></a><span> functionality, you should be able to incorporate those models into any existing project with little effort and run them at scale.</span></p><p><span>You should be able to embed and serve these models as part of your existing Phoenix web applications, integrate them into data processing pipelines with Broadway, and deploy them alongside Nerves embedded systems - without needing 3rd-party dependencies.</span></p><p><span>Here’s </span><a href="https://github.com/elixir-nx/bumblebee/blob/main/examples/phoenix/image_classification.exs" rel="nofollow noopener" target="_blank"><span>an example</span></a><span> of using Bumblebee to run an image classification model inside a Phoenix app:</span></p><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Integration-with-Hugging-Face" target="_blank" rel="nofollow noopener"></a></h2><h2>Integration with Hugging Face</h2><p><span>Bumblebee allows you to download and use</span><span> trained models</span><span> directly from Hugging Face. Let’s see </span><a href="https://github.com/elixir-nx/bumblebee/blob/main/notebooks/examples.livemd#text-generation" rel="nofollow noopener" target="_blank"><span>an example</span></a><span> of how we can generate text continuation using the popular GPT-2 model:</span></p><div><pre>{<span>:ok</span>, gpt2} <span>=</span> <span>Bumblebee</span><span>.</span>load_model({<span>:hf</span>, <span>&#34;gpt2&#34;</span>})
{<span>:ok</span>, tokenizer} <span>=</span> <span>Bumblebee</span><span>.</span>load_tokenizer({<span>:hf</span>, <span>&#34;gpt2&#34;</span>})

serving <span>=</span> <span>Bumblebee</span><span>.</span><span>Text</span><span>.</span>generation(gpt2, tokenizer, <span>max_new_tokens:</span> <span>10</span>)

text <span>=</span> <span>&#34;Yesterday, I was reading a book and&#34;</span>
<span>Nx</span><span>.</span><span>Serving</span><span>.</span>run(serving, text)

<span>#=&gt; %{</span>
<span>#=&gt;    results: [</span>
<span>#=&gt;        %{</span>
<span>#=&gt;            text: &#34;Yesterday I was reading a book and I was thinking, &#39;What&#39;s going on?&#39;&#34;</span>
<span>#=&gt;        }</span>
<span>#=&gt;    ]</span>
<span>#=&gt; }</span></pre></div><p><span>As you can see, we just load the model data and use a high-level function designed for the text generation task, that’s it!</span></p><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Compiling-to-CPUGPU" target="_blank" rel="nofollow noopener"></a>Compiling to CPU/GPU</h2><p><span>All of our Neural Networks can be compiled to the CPU/GPU, thanks to projects such as </span><a href="https://github.com/elixir-nx/nx/tree/main/exla" rel="nofollow noopener" target="_blank"><span>EXLA</span></a><span> (based on Google XLA) and </span><a href="https://github.com/elixir-nx/nx/tree/main/torchx" rel="nofollow noopener" target="_blank"><span>Torchx</span></a><span> (based on Libtorch).</span></p><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#A-massive-milestone-in-our-Numerical-Elixir-effort" target="_blank" rel="nofollow noopener"></a></h2><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#A-massive-milestone-in-our-Numerical-Elixir-effort" target="_blank" rel="nofollow noopener"></a>A massive milestone in our Numerical Elixir effort</h2><p><span>This release is a huge milestone in our Numerical Elixir effort, which started almost two years ago. These new features, in particular, are possible thanks to the enormous efforts </span><span>of</span><span> José Valim, Jonatan Kłosko, Sean Moriarity, and Paulo Valente. We are also thankful to Hugging Face for enabling collaborative Machine Learning across communities and tools, which played an essential role in bringing the Elixir ecosystem up to speed.</span></p><p><span>Next, we plan to focus on training and transfer learning of Neural Networks in Elixir, allowing developers to augment and specialize pre-trained models according to the needs of their businesses and applications. We also hope to publish more on our progress in developing traditional Machine Learning algorithms.</span></p><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Your-turn" target="_blank" rel="nofollow noopener"></a></h2><h2><a href="https://hackmd.io/bLlg58ouRgS4ARur_VMQ7g?view#Your-turn" target="_blank" rel="nofollow noopener"></a>Your turn</h2><p><span>If you want to give Bumblebee a try, you can:</span></p><ul><li><span>Download </span><a href="https://livebook.dev/" rel="nofollow noopener" target="_blank"><span>Livebook v0.8</span></a><span> and automatically generate “Neural Networks tasks” from the “+ Smart” cell menu inside your notebooks.</span></li><li><span>We have also written </span><a href="https://github.com/elixir-nx/bumblebee/tree/main/examples/phoenix" rel="nofollow noopener" target="_blank"><span>single-file Phoenix applications</span></a><span> as examples of Bumblebee models inside Phoenix (+ LiveView) apps. Those should provide the necessary building blocks to integrate Bumblebee into your production app.</span></li><li><span>For a more hands-on approach, read some of our </span><a href="https://github.com/elixir-nx/bumblebee/tree/main/notebooks" rel="nofollow noopener" target="_blank"><span>notebooks</span></a><span>.</span></li></ul><p><span>If you want to help us build the Machine Learning ecosystem for Elixir, check out the projects above, and give them a try. There are many exciting areas, from compiler development to model building. For instance, pull requests that bring more models and architectures to Bumblebee are welcome. The future is concurrent, distributed, and fun!</span></p></div></div></div></section></div></div></div>
  </body>
</html>
