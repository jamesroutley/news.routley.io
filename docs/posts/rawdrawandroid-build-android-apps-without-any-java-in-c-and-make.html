<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/cnlohr/rawdrawandroid">Original</a>
    <h1>Rawdrawandroid â€“ Build Android apps without any Java, in C and Make</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a href="https://github.com/dreua/rawdrawandroid/actions/workflows/install.yml"><img src="https://github.com/cnlohr/rawdrawandroid/actions/workflows/install.yml/badge.svg" alt="rawdrawandroid"/></a></p>


<ul dir="auto">
<li><a href="#rawdrawandroid">rawdrawandroid</a></li>
<li><a href="#why">why?</a></li>
<li><a href="#development-environment">Development Environment</a>
<ul dir="auto">
<li><a href="#linux-install-android-studio-with-ndk">Linux install Android Studio with NDK.</a></li>
<li><a href="#steps-for-gui-less-install-windows-wsl">Steps for GUI-less install (Windows, WSL)</a>
<ul dir="auto">
<li><a href="#extra-note-for-actually-deploying-to-device-in-windows">Extra note for actually deploying to device in Windows</a></li>
<li><a href="#rest-of-steps">Rest of steps</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#if-you-are-going-to-use-this">If you are going to use this</a></li>
<li><a href="#helper-functions">Helper functions</a></li>
<li><a href="#departures-from-regular-rawdraw">Departures from regular rawdraw.</a></li>
<li><a href="#google-play">Google Play</a>
<ul dir="auto">
<li><a href="#part-0-changes-to-your-app">Part 0: Changes to your app.</a></li>
<li><a href="#keys--you-will-want-a-key-for-yourself-thats-a-real-key--not-the-fake-one">Keys: You will want a key for yourself that&#39;s a real key. Not the fake one.</a></li>
<li>Let Google create and manage my app signing key (recommended)</li>
<li><a href="#export-and-upload-a-key-and-certificate-from-a-java-keystore">Export and upload a key and certificate from a Java keystore</a></li>
<li><a href="#prepping-your-app-for-upload">Prepping your app for upload.</a></li>
<li><a href="#pre-sdk-32-tools">Pre-SDK-32-Tools</a></li>
</ul>
</li>
<li><a href="#todo">TODO</a></li>
</ul>

<p dir="auto">Ever wanted to write C code and run it on Android?  Sick of multi-megabyte
packages just to do the most basic of things.  Well, this is a demo of how
to make your own APKs and build, install and automatically run them in about
2 seconds, and with an apk size of about 25kB (with API 26).  API 30 (Android R+)
is unfortunately at 45kB to support ARM64 + ARM32.</p>
<p dir="auto">With this framework you get a demo which has:</p>
<ul dir="auto">
<li>To make a window with OpenGL ES support</li>
<li>Accelerometer/gyro input, multi-touch</li>
<li>An android keyboard for key input</li>
<li>Ability to store asset files in your APK and read them with <code>AAssetManager</code></li>
<li>Permissions support for using things like sound. Example in <a href="https://github.com/cnlohr/cnfa">https://github.com/cnlohr/cnfa</a> / <a href="https://github.com/cntools/cnfa/blob/d271e0196d81412032eeffa634a94a1aaf0060a7/CNFA_android.c#L305">https://github.com/cntools/cnfa/blob/d271e0196d81412032eeffa634a94a1aaf0060a7/CNFA_android.c#L305</a></li>
<li>Directly access USB devices.  Example in <a href="https://github.com/cnlohr/androidusbtest">https://github.com/cnlohr/androidusbtest</a></li>
</ul>
<p dir="auto"><a href="http://www.youtube.com/watch?v=Cz_LvaN36Ag" rel="nofollow"><img src="https://camo.githubusercontent.com/54f7dbce64ccfcbd22155f1bca0f5fee2f1da05d2f40bb705cae1cb1a67c823b/687474703a2f2f696d672e796f75747562652e636f6d2f76692f437a5f4c76614e333641672f302e6a7067" alt="Youtube Video" data-canonical-src="http://img.youtube.com/vi/Cz_LvaN36Ag/0.jpg"/></a></p>
<p dir="auto">DISCLAIMER: I take no warranty or responsibility for this code.  Use at your own risk.  I&#39;ve never released an app on the app store, so there may be some fundamental issue with using this toolset to make commercial apps!</p>
<p dir="auto">For support, we have a Discord, but it is not public at the moment, feel free to reach out to @cnlohr on Discord, with a short message as to why you&#39;d like to join, and he can send you an invite!</p>

<p dir="auto">Because sometimes you want to do things that don&#39;t fit into the normal way of doing it and all the discussions online revolve around doing it with all the normal processes.  And those processes change, making it difficult to keep up and do specific things.  By using <code>Makefile</code>s it&#39;s easy to see what exact commands are executed and add custom rules and tweak your build.  C is a universal language.  Rawdraw operates on everything from an ESP8266, to RaspberryPi, Windows Linux and now, even Android.  Write code once, use it everywhere.</p>
<p dir="auto">When you don&#39;t fill your build process with hills of beans, you end up being left with the parts that are important, and not the frivilous parts. This makes it easier to develop, deploy, etc, because everything takes much less time.</p>
<p dir="auto">A little bit of this also has to do to stick it to all those Luddites on the internet who post &#34;that&#39;s impossible&#34; or &#34;you&#39;re doing it wrong&#34; to Stack Overflow questions... Requesting permissions in the JNI &#34;oh you <strong>have</strong> to do that in Java&#34; or other dumb stuff like that.  I am completely uninterested in your opinions of what is or is not possible.  This is computer science.  There aren&#39;t restrictions.  I can do anything I want.  It&#39;s just bits.  You don&#39;t own me.</p>
<p dir="auto">P.S. If you want a bunch of examples of how to do a ton of things in C on Android that you &#34;need&#34; java for, scroll to the bottom of this file: <a href="https://github.com/cntools/rawdraw/blob/master/CNFGEGLDriver.c">https://github.com/cntools/rawdraw/blob/master/CNFGEGLDriver.c</a> - it shows how to use the JNI to marshall a ton of stuff to/from the Android API without needing to jump back into Java/Kotlin land.</p>

<p dir="auto">Most of the testing was done on Linux, however @AEFeinstein has done at least cursory testing in Windows.  You still need some components of Android studio set up to use this, so it&#39;s generally easier to just install Android studio completely, but there are instructions on sort of how to do it piecemeal for Windows.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Linux install Android Studio with NDK.</h2><a id="user-content-linux-install-android-studio-with-ndk" aria-label="Permalink: Linux install Android Studio with NDK." href="#linux-install-android-studio-with-ndk"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This set of steps describes how to install Android Studio with NDK support in Linux.  It uses the graphical installer and installs a lot more stuff than the instructions below.  You may be able to mix-and-match these two sets of instructions.  For instance if you are on Linux but don&#39;t want to sacrifice 6 GB of disk to the Googs.</p>
<p dir="auto"><strong>NOTE</strong> You probably should use the WSL instructions instead of these instructions as it will produc a more lean installation.</p>
<ol dir="auto">
<li>Install prerequisites:</li>
</ol>
<div data-snippet-clipboard-copy-content="sudo apt install openjdk-11-jdk-headless adb"><pre><code>sudo apt install openjdk-11-jdk-headless adb
</code></pre></div>
<ol start="2" dir="auto">
<li>Download Android Studio: <a href="https://developer.android.com/studio" rel="nofollow">https://developer.android.com/studio</a></li>
<li>Start &#39;studio.sh&#39; in android-studio/bin</li>
<li>Let it install the SDK.</li>
<li>Go to sdkmanager (&#34;Configure&#34; button in bottom right)</li>
<li>Probably want to use Android 24, so select that from the list.</li>
<li>Select &#34;SDK Tools&#34; -&gt; &#34;NDK (Side-by-side)&#34;</li>
<li>Download this repo</li>
</ol>
<div data-snippet-clipboard-copy-content="git clone https://github.com/cnlohr/rawdrawandroid --recurse-submodules
cd rawdrawandroid"><pre><code>git clone https://github.com/cnlohr/rawdrawandroid --recurse-submodules
cd rawdrawandroid
</code></pre></div>
<ol start="9" dir="auto">
<li>Turn on developer mode on your phone (will vary depending on android version)</li>
<li>Make your own key</li>
</ol>

<ol start="11" dir="auto">
<li>Go into developer options on your phone and enable &#34;USB debugging&#34; make sure to select always allow.</li>
<li>Plug your phone into the computer.</li>
<li>Run your program.</li>
</ol>

<div dir="auto"><h2 tabindex="-1" dir="auto">Steps for GUI-less install (Windows, WSL)</h2><a id="user-content-steps-for-gui-less-install-windows-wsl" aria-label="Permalink: Steps for GUI-less install (Windows, WSL)" href="#steps-for-gui-less-install-windows-wsl"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you&#39;re developing in Windows Subsystem for Linux (WSL), follow the &#34;Steps for GUI-less install&#34; to install the Android components from the command line, without any GUI components.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Extra note for actually deploying to device in Windows</h3><a id="user-content-extra-note-for-actually-deploying-to-device-in-windows" aria-label="Permalink: Extra note for actually deploying to device in Windows" href="#extra-note-for-actually-deploying-to-device-in-windows"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In order to push the APK to your phone, you need <code>adb</code> installed in Windows as well.  You can do that by getting the full Android Studio from <a href="https://developer.android.com/studio#downloads" rel="nofollow">https://developer.android.com/studio#downloads</a> or directly <a href="https://dl.google.com/android/repository/platform-tools_r24.0.4-windows.zip" rel="nofollow">https://dl.google.com/android/repository/platform-tools_r24.0.4-windows.zip</a>. Installing the full Android Studio is easier, but you can also get the &#34;Command line tools only&#34; and install <code>adb</code> from there.  The steps below outline how to do this with the direct link.</p>

<ol dir="auto">
<li>
<p dir="auto">Install Windows Subsystem for Linux (WSL).  You can find instructions here: <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="nofollow">https://docs.microsoft.com/en-us/windows/wsl/install-win10</a> - we use &#34;Ubuntu&#34; for this.</p>
</li>
<li>
<p dir="auto">Install prerequisites:</p>
</li>
</ol>
<div data-snippet-clipboard-copy-content="sudo apt install openjdk-17-jdk-headless adb unzip zip"><pre><code>sudo apt install openjdk-17-jdk-headless adb unzip zip
</code></pre></div>
<ol start="2" dir="auto">
<li>Download &#34;Command line tools only&#34;: <a href="https://developer.android.com/studio#downloads" rel="nofollow">https://developer.android.com/studio#downloads</a> - you can get a URL and use <code>wget</code> in WSL to download the tools by clicking on the <strong>&#34;Linux&#34;</strong> toolset, then right-clicking on the accept link and saying copy link to location.  Then you can say <code>wget &lt;link&gt;</code> in WSL.</li>
<li>Create a folder for the Android SDK and export it. You may want to add that export to your <code>~/.bashrc</code>:</li>
</ol>
<div data-snippet-clipboard-copy-content="mkdir ~/android-sdk
export ANDROID_HOME=~/android-sdk
printf &#34;\nexport ANDROID_HOME=~/android-sdk\n&#34; &gt;&gt; ~/.bashrc"><pre><code>mkdir ~/android-sdk
export ANDROID_HOME=~/android-sdk
printf &#34;\nexport ANDROID_HOME=~/android-sdk\n&#34; &gt;&gt; ~/.bashrc
</code></pre></div>
<ol start="4" dir="auto">
<li>Unzip the &#34;Command line tools only&#34; file so that <code>tools</code> is in your brand new <code>android-sdk</code> folder.</li>
<li>Install the SDK and NDK components:</li>
</ol>
<p dir="auto">For earler versions of tools see note for pre-SDK-32-Tools.</p>
<p dir="auto">If your platform command-line tools are <strong>30</strong>, the command-line tools will be placed in the cmdline-tools folder. So, you will need to execute the following:</p>
<div data-snippet-clipboard-copy-content="yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;30.0.2&#34; &#34;cmake;3.10.2.4988404&#34; &#34;ndk;21.3.6528147&#34; &#34;platform-tools&#34; &#34;platforms;android-30&#34; &#34;tools&#34;"><pre><code>yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;30.0.2&#34; &#34;cmake;3.10.2.4988404&#34; &#34;ndk;21.3.6528147&#34; &#34;platform-tools&#34; &#34;platforms;android-30&#34; &#34;tools&#34;
</code></pre></div>
<p dir="auto">If you want to target Android 34 (not recommended in 2024, for device compatibility, you will need to execute the following):</p>
<div data-snippet-clipboard-copy-content="yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;34.0.0&#34; &#34;ndk;26.2.11394342&#34; &#34;platform-tools&#34; &#34;platforms;android-34&#34; &#34;tools&#34; &#34;cmake;3.10.2.4988404&#34;"><pre><code>yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;34.0.0&#34; &#34;ndk;26.2.11394342&#34; &#34;platform-tools&#34; &#34;platforms;android-34&#34; &#34;tools&#34; &#34;cmake;3.10.2.4988404&#34;
</code></pre></div>
<p dir="auto"><strong>NOTE</strong> If you are upgrading NDK versions, you may need to remove old versions, this Makefile does not necessarily do the best job at auto-selecting NDK versions.</p>
<p dir="auto">You can see all avialable versions of software with this command:</p>
<div data-snippet-clipboard-copy-content="$ANDROID_HOME/cmdline-tools/bin/sdkmanager --list --sdk_root=${ANDROID_HOME}"><pre><code>$ANDROID_HOME/cmdline-tools/bin/sdkmanager --list --sdk_root=${ANDROID_HOME}
</code></pre></div>
<ol start="6" dir="auto">
<li>Install the Windows ADB toolset.</li>
</ol>
<div data-snippet-clipboard-copy-content="mkdir -p $ANDROID_HOME/windows
cd $ANDROID_HOME/windows
wget https://dl.google.com/android/repository/platform-tools_r24.0.4-windows.zip
unzip platform-tools_r24.0.4-windows.zip
export ADB=$ANDROID_HOME/windows/platform-tools/adb.exe
printf &#34;\nexport ADB=$ANDROID_HOME/windows/platform-tools/adb.exe\n&#34; &gt;&gt; ~/.bashrc"><pre><code>mkdir -p $ANDROID_HOME/windows
cd $ANDROID_HOME/windows
wget https://dl.google.com/android/repository/platform-tools_r24.0.4-windows.zip
unzip platform-tools_r24.0.4-windows.zip
export ADB=$ANDROID_HOME/windows/platform-tools/adb.exe
printf &#34;\nexport ADB=$ANDROID_HOME/windows/platform-tools/adb.exe\n&#34; &gt;&gt; ~/.bashrc
</code></pre></div>
<p dir="auto">Alternatively, you may want to use <a href="https://dl.google.com/android/repository/platform-tools_r30.0.5-windows.zip" rel="nofollow">https://dl.google.com/android/repository/platform-tools_r30.0.5-windows.zip</a> for r30.</p>
<ol start="6" dir="auto">
<li>NOTE: because of updates to environment variables, you may want to close and re-open your WSL terminal.</li>
<li>Download this repo</li>
</ol>
<div data-snippet-clipboard-copy-content="git clone https://github.com/cnlohr/rawdrawandroid --recurse-submodules
cd rawdrawandroid"><pre><code>git clone https://github.com/cnlohr/rawdrawandroid --recurse-submodules
cd rawdrawandroid
</code></pre></div>
<ol start="8" dir="auto">
<li>Turn on developer mode on your phone (will vary depending on android version)</li>
<li>Go into developer options on your phone and enable &#34;USB debugging&#34; make sure to select always allow.</li>
<li>Plug your phone into the computer.</li>
<li>Make your keystore.</li>
</ol>

<ol start="12" dir="auto">
<li>Compile and run your program.</li>
</ol>


<ul dir="auto">
<li>
<p dir="auto">Check out the example here: <a href="https://github.com/cnlohr/rawdrawandroidexample">https://github.com/cnlohr/rawdrawandroidexample</a></p>
</li>
<li>
<p dir="auto">You may want to copy-and-paste this project, but, you could probably use it as a submodule.  You may also want to copy-and-paste the submodule.</p>
</li>
<li>
<p dir="auto">You <em>MUST</em> override the app name.</p>
<ul dir="auto">
<li>See in Makefile <code>APPNAME</code> and <code>PACKAGENAME</code> you should be able to include this project&#39;s makefile and override that.</li>
<li>You must also update <code>AndroidManifest.xml</code> with whatever name and org you plan to use.</li>
<li>You will need to update: <code>package</code> in <code>&lt;manifest&gt;</code> to be your <code>PACKAGENAME</code> variable in Makefile.</li>
<li>Both <code>android:label</code> labels need to reflect your new app name.  They are in your <code>&lt;application&gt;</code> and <code>&lt;activity&gt;</code> sections.</li>
<li>Update the <code>android:value</code> field in <code>android.app.lib_name</code></li>
</ul>
</li>
<li>
<p dir="auto">If you are using permission you have to prompt for, you must both add it to your <code>AndroidManifest.xml</code> as well as check if you have it, and if not, prompt the user.  See helper functions below.  You can see an example of this with <code>sound_android.c</code> from ColorChord.  <a href="https://github.com/cnlohr/colorchord/blob/master/colorchord2/sound_android.c">https://github.com/cnlohr/colorchord/blob/master/colorchord2/sound_android.c</a></p>
</li>
<li>
<p dir="auto">Be sure to uninstall any previously installed apps which would look like this app, if you have a different build by the same name signed with another key, bad things will happen.</p>
</li>
<li>
<p dir="auto">You can see your log with:</p>
</li>
</ul>

<ul dir="auto">
<li>If your app opens and closes instantly, try seeing if there are any missing symbols:</li>
</ul>
<div data-snippet-clipboard-copy-content="adb logcat | grep UnsatisfiedLinkError"><pre><code>adb logcat | grep UnsatisfiedLinkError
</code></pre></div>

<p dir="auto">Because we are doing this entirelly in the NDK, with the JNI, we won&#39;t have the luxury of writing any Java/Kotlin code and calling it.  That means all of the examples online have to be heavily marshalled.  In rawdraw&#39;s EGL driver, we have many examples of how to do that.  That said, you can use the following functions which get you most of the way there.</p>
<p dir="auto"><code>struct android_app * gapp;</code></p>
<p dir="auto"><code>int AndroidHasPermissions(const char* perm_name);</code></p>
<p dir="auto"><code>void AndroidRequestAppPermissions(const char * perm);</code></p>
<p dir="auto"><code>void AndroidDisplayKeyboard(int pShow);</code></p>
<p dir="auto"><code>int AndroidGetUnicodeChar( int keyCode, int metaState );</code></p>
<p dir="auto"><code>int android_width, android_height;</code></p>
<p dir="auto"><code>extern int android_sdk_version; //Derived at start from property ro.build.version.sdk</code></p>

<p dir="auto">Also, above and beyond rawdraw, you <em>must</em> implement the following two functions to handle when your apps is suspended, resumed or has its window terminated.</p>
<p dir="auto"><code>void HandleResume();</code>
<code>void HandleSuspend();</code>
<code>void HandleWindowTermination();</code></p>
<p dir="auto">In addition to that, the syntax of <code>HandleMotion(...)</code> is different, in that instead of the <code>mask</code> variable being a mask, it is simply updating that specific pointer.</p>

<p dir="auto">As it turns out, Google somehow lets apps built with this onto the store.  Like ColorChord <a href="https://github.com/cnlohr/colorchord">https://github.com/cnlohr/colorchord</a>.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Part 0: Changes to your app.</h2><a id="user-content-part-0-changes-to-your-app" aria-label="Permalink: Part 0: Changes to your app." href="#part-0-changes-to-your-app"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ol dir="auto">
<li>Make sure you are using the newest SDK.</li>
<li>You will need to add a versionCode to your <code>AndroidManifest.xml</code>.  In your <code>AndroidManifest.xml</code>, add <code>android:versionCode=&#34;integer&#34;</code> to the tag where &#34;integer&#34; is a version number.</li>
<li>In your <code>AndroidManifest.xml</code>, change <code>android:debuggable</code> to false.</li>
<li>You may want to support multiple platforms natively.  Add the following to your <code>Makefile</code>: <code>TARGETS:=makecapk/lib/arm64-v8a/lib$(APPNAME).so makecapk/lib/armeabi-v7a/lib$(APPNAME).so makecapk/lib/x86/lib$(APPNAME).so makecapk/lib/x86_64/lib$(APPNAME).so</code></li>
<li>You will need to specify target and Min SDK in your <code>AndroidManifest.xml</code>  See: <code>&lt;uses-sdk android:minSdkVersion=&#34;22&#34; android:targetSdkVersion=&#34;28&#34; /&gt;</code></li>
<li>Those target / min versions must match your Makefile.  Note that without a <code>minSdkVerson</code> google will wrongfully assume 1.  This is dangerous.  Be sure to test your app on a device with whichever minSdkVersion you&#39;ve specified.</li>
<li>You will need to disable the debuggable flag in your app.  See <code>&lt;application android:debuggable=&#34;false&#34; ...&gt;</code></li>
</ol>
<p dir="auto">Get a google play account.  Details surrounding app creation are outside the scope of this readme.  When getting ready to upload your APK.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Keys:  You will want a key for yourself that&#39;s a real key.  Not the fake one.</h2><a id="user-content-keys--you-will-want-a-key-for-yourself-thats-a-real-key--not-the-fake-one" aria-label="Permalink: Keys:  You will want a key for yourself that&#39;s a real key.  Not the fake one." href="#keys--you-will-want-a-key-for-yourself-thats-a-real-key--not-the-fake-one"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">First you will need to make a real key.  This can be accomplished by deleting our fake key <code>my-release-key.keystore</code> and executing the following command (being careful to fill <code>####</code> in with real info):</p>
<p dir="auto"><code>make keystore STOREPASS=#### DNAME=&#34;\&#34;CN=####, OU=ID, O=####, L=####, S=####, C=####\&#34;&#34; ALIASNAME=####</code></p>
<p dir="auto">The alias name will be <code>standkey</code>. You will want to verify you can build your app with this key.  Be sure to fill in STOREPASS the same.</p>
<p dir="auto"><code>make clean run  STOREPASS=####</code></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Let Google create and manage my app signing key (recommended)</h2><a id="user-content-let-google-create-and-manage-my-app-signing-key-recommended" aria-label="Permalink: Let Google create and manage my app signing key (recommended)" href="#let-google-create-and-manage-my-app-signing-key-recommended"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Export and upload a key and certificate from a Java keystore</h2><a id="user-content-export-and-upload-a-key-and-certificate-from-a-java-keystore" aria-label="Permalink: Export and upload a key and certificate from a Java keystore" href="#export-and-upload-a-key-and-certificate-from-a-java-keystore"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">If you want to use the play store key with &#34;Export and upload a key and certificate from a Java keystore&#34; Instead of <code>Let Google create and manage my app signing key (recommended)</code> and follow PEKP instructions.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Prepping your app for upload.</h2><a id="user-content-prepping-your-app-for-upload" aria-label="Permalink: Prepping your app for upload." href="#prepping-your-app-for-upload"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You MUST have aligned ZIPs for the Play store.  You must run the following command:</p>
<p dir="auto"><code>zipalign -c -v 8 makecapk.apk</code></p>
<p dir="auto">Upload your APK <code>makecapk.apk</code> made with your key.</p>

<p dir="auto">If you are using <strong>Android 29 or older</strong>, do this.</p>
<div data-snippet-clipboard-copy-content="yes | $ANDROID_HOME/tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;29.0.3&#34; &#34;cmake;3.10.2.4988404&#34; &#34;ndk;21.1.6352462&#34; &#34;patcher;v4&#34; &#34;platform-tools&#34; &#34;platforms;android-30&#34; &#34;tools&#34;"><pre><code>yes | $ANDROID_HOME/tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;29.0.3&#34; &#34;cmake;3.10.2.4988404&#34; &#34;ndk;21.1.6352462&#34; &#34;patcher;v4&#34; &#34;platform-tools&#34; &#34;platforms;android-30&#34; &#34;tools&#34;
</code></pre></div>
<p dir="auto">If your platform command-line tools are <strong>30</strong>, the command-line tools will be placed in the cmdline-tools folder. So, you will need to execute the following:</p>
<div data-snippet-clipboard-copy-content="yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;30.0.2&#34; &#34;cmake;3.10.2.4988404&#34; &#34;ndk;21.3.6528147&#34; &#34;patcher;v4&#34; &#34;platform-tools&#34; &#34;platforms;android-30&#34; &#34;tools&#34;"><pre><code>yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;30.0.2&#34; &#34;cmake;3.10.2.4988404&#34; &#34;ndk;21.3.6528147&#34; &#34;patcher;v4&#34; &#34;platform-tools&#34; &#34;platforms;android-30&#34; &#34;tools&#34;
</code></pre></div>
<p dir="auto">If your platform command-line tools are <strong>32</strong>, the command-line tools will be placed in the cmdline-tools folder. So, you will need to execute the following (This appears to be backwards compatbile to some degree with Android 30):</p>
<div data-snippet-clipboard-copy-content="yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;32.0.0&#34; &#34;cmake;3.22.1&#34; &#34;ndk;25.1.8937393&#34; &#34;platforms;android-32&#34; &#34;patcher;v4&#34; &#34;platform-tools&#34; &#34;tools&#34;"><pre><code>yes | $ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} --licenses
$ANDROID_HOME/cmdline-tools/bin/sdkmanager --sdk_root=${ANDROID_HOME} &#34;build-tools;32.0.0&#34; &#34;cmake;3.22.1&#34; &#34;ndk;25.1.8937393&#34; &#34;platforms;android-32&#34; &#34;patcher;v4&#34; &#34;platform-tools&#34; &#34;tools&#34;
</code></pre></div>

<p dir="auto">Try a bunch of these cool priveleges, see what they all do.</p>
<ul dir="auto">
<li>permission.ACCESS</li>
<li>permission.INTERNET</li>
<li>permission.HIDE_NON_SYSTEM_OVERLAY_WINDOWS</li>
<li>permission.ACCESS_NETWORK_STATE</li>
<li>permission.WRITE_EXTERNAL_STORAGE</li>
<li>permission.READ_PHONE_STATE</li>
<li>permission.GET_TASKS</li>
<li>permission.REORDER_TASKS</li>
<li>permission.WRITE_APN_SETTINGS</li>
<li>permission.READ_SECURE_SETTINGS</li>
<li>permission.READ_SETTINGS</li>
<li>permission.REAL_GET_TASKS</li>
<li>permission.INTERACT_ACROSS_USERS</li>
<li>permission.MANAGE_USERS</li>
<li>permission.INSTALL_PACKAGES</li>
<li>permission.DELETE_PACKAGES</li>
<li>permission.INTERACT_ACROSS_USERS_FULL</li>
<li>permission.READ_MEDIA_STORAGE</li>
<li>permission.WRITE_MEDIA_STORAGE</li>
<li>android.permission.VR</li>
<li>android.permission.INSTALL_PACKAGES</li>
</ul>
</article></div></div>
  </body>
</html>
