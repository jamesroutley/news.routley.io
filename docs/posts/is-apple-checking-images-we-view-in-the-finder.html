<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://eclecticlight.co/2023/01/18/is-apple-checking-images-we-view-in-the-finder/">Original</a>
    <h1>Is Apple checking images we view in the Finder?</h1>
    
    <div id="readability-page-1" class="page"><div data-first_letter="E">
		<p>Ever since Apple was <a href="https://eclecticlight.co/2021/08/09/how-apple-intends-checking-images-for-csam/">unwise enough to suggest</a> that it might check certain images to see whether they were Child Sexual Abuse Material (CSAM), rumours have been rife that it has pressed ahead and now does that. I gather a new claim is being pushed out that this is performed in Ventura 13.1, so this article is an attempt to determine whether there’s any truth in that.</p>
<p>This claim boils down to Apple automatically being sent identifiers of images that a user has simply ‘browsed in the Finder’ without that user’s consent or awareness. I should make it clear that this hasn’t been demonstrated: as far as I’m aware the only evidence provided is that a Mac on which images were being ‘browsed in the Finder’ tried to make an outgoing connection from <code>mediaanalysisd</code> to an Apple server at that time, as revealed by the software firewall Little Snitch.</p>
<p>When Apple was intending to check for CSAM, it kindly <a href="https://eclecticlight.co/2021/08/09/how-apple-intends-checking-images-for-csam/">explained how</a> it aimed to do that, by generating identifiers, known as neural hashes, for images. A moment’s thought should indicate that uploading every image is neither sensible nor practical; instead, some form of concise identifier is essential. Unlike normal hashes, which are intended to amplify the smallest change in the source file, neural hashes are intended to distinguish images according to their content and characteristics.</p>
<p>Not only did Apple explain the principles of its intended detection system, but it gave us a free demonstration of those in macOS Monterey, with Visual Look Up (VLU). That enables your Mac, with a little help from Apple’s servers to match neural hashes, to identify paintings, breeds of dog and cat, and sundry other subjects in images.</p>
<p>I have taken <a href="https://eclecticlight.co/2022/03/25/how-visual-look-up-works-in-detail-2-object-recognition-and-live-text/">a deep look</a> inside the processes involved in VLU, to the point where one of my free apps, <a href="https://eclecticlight.co/mints-a-multifunction-utility/">Mints</a>, can easily obtain a full account of them from the Unified log. I therefore performed a series of tests in a macOS 13.1 virtual machine running in <a href="https://eclecticlight.co/virtualisation-on-apple-silicon/">Viable</a> on my Mac Studio M1 Max, to discover what might explain the observation reported, and whether that supported the claim being made.</p>
<h4>Gallery browsing</h4>
<p><span><img data-attachment-id="69870" data-permalink="https://eclecticlight.co/vlu01/" data-orig-file="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg" data-orig-size="1615,915" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="vlu01" data-image-description="" data-image-caption="" data-medium-file="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=300" data-large-file="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=940" src="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=940" alt="vlu01" srcset="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=940 940w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=150 150w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=300 300w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=768 768w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg?w=1024 1024w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu01.jpg 1615w" sizes="(max-width: 940px) 100vw, 940px"/></span></p>
<p>To get an idea of whether <code>mediaanalysisd</code> or any other component involved in image analysis or neural hash generation was active when looking through images in a Gallery window in the Finder, I loaded 18 assorted images in different formats into the ~/Documents folder of my VM, opened a gallery view of them, and looked through them for a period of one minute. I then captured all log entries for that period, a total of more than 40,000, and saved that excerpt to a file, using <a href="https://eclecticlight.co/consolation-t2m2-and-log-utilities/">Ulbow</a>. Not only was there no evidence of any image analysis taking place, but in that period there were no log entries from <code>mediaanalysisd</code> at all. Not one.</p>
<p>I repeated this over a period of 30 seconds, this time using Mints to display all log entries associated with VLU and Live Text. There were none at all in that period.</p>
<h4>Visual Look Up</h4>
<p>Although I studied <a href="https://eclecticlight.co/2022/03/25/how-visual-look-up-works-in-detail-2-object-recognition-and-live-text/">VLU and Live Text in detail</a> in Monterey, before going any further I wanted to confirm that they behave similarly in macOS 13.1, and write similar sequences of messages in the log. I therefore obtained a log extract using Mints for single image VLU using Preview. This confirmed that messages and processes appear very similar to those I had analysed before. These are summarised in the following diagram.</p>
<p><span><img data-attachment-id="64546" data-permalink="https://eclecticlight.co/visuallookup1-2/" data-orig-file="https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png" data-orig-size="1964,2428" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="VisualLookUp1" data-image-description="" data-image-caption="" data-medium-file="https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=243" data-large-file="https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=828" src="https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=940" alt="VisualLookUp1" srcset="https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=940 940w, https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=1880 1880w, https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=121 121w, https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=243 243w, https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=768 768w, https://eclecticlightdotcom.files.wordpress.com/2022/03/visuallookup1.png?w=828 828w" sizes="(max-width: 940px) 100vw, 940px"/></span></p>
<p>Note that <code>mediaanalysisd</code> doesn’t contact Apple’s servers until late in the process, to perform matching of the neural hashes generated by the preceding image analysis. The response from those servers then enables VLU results to be displayed in a window over the image.</p>
<h4>QuickLook Preview</h4>
<p>Although the original description given was ‘Finder browsing’, for some that might include the display of images as QuickLook Previews, by selecting the image and pressing the Spacebar. In my previous examination of VLU and Live Text, this wasn’t a feature that I had investigated. I therefore obtained log excerpts for two images being opened in QuickLook Preview. One of those images contained some handwritten text, the other did not.</p>
<p><span><img data-attachment-id="69871" data-permalink="https://eclecticlight.co/vlu02/" data-orig-file="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg" data-orig-size="1604,688" data-comments-opened="1" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="vlu02" data-image-description="" data-image-caption="" data-medium-file="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=300" data-large-file="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=940" src="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=940" alt="vlu02" srcset="https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=940 940w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=150 150w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=300 300w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=768 768w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg?w=1024 1024w, https://eclecticlightdotcom.files.wordpress.com/2023/01/vlu02.jpg 1604w" sizes="(max-width: 940px) 100vw, 940px"/></span></p>
<p>For both images, VisionKit initiated image analysis when the image was being opened in its preview window. For the image which didn’t contain text, this completed in a total processing time of 615 ms, failed to recover any text from that image, and attempted no remote connections. The image containing text took longer, 881 ms, and returned text of length 65 ‘DD’ (as given in the log) after a considerably more elaborate series of processes, including one outgoing secure TCP or Quic connection by <code>mediaanalysisd</code> lasting 58 ms, before the completion of Visual Search Gating.</p>
<p>This is consistent with <a href="https://eclecticlight.co/2022/06/01/inside-live-text/">the briefer task</a> used in Live Text, and quite different from VLU. There is thus no evidence of the generation of neural hashes or any search query by PegasusKit typical of the later stages of VLU.</p>
<h4>Conclusions</h4>
<ul>
<li>There is no evidence that local images on a Mac have identifiers computed and uploaded to Apple’s servers when viewed in Finder windows.</li>
<li>Local images that are viewed in QuickLook Preview undergo normal analysis for Live Text, and text recognition where possible, but that doesn’t generate identifiers that could be uploaded to Apple’s servers.</li>
<li>Images viewed in apps supporting VLU have neural hashes computed, and those are uploaded to Apple’s servers to perform look up and return its results to the user, as <a href="https://eclecticlight.co/2022/03/25/how-visual-look-up-works-in-detail-2-object-recognition-and-live-text/">previously detailed</a>.</li>
<li>VLU can be disabled by disabling <strong>Siri Suggestions</strong> in System Settings &gt; Siri &amp; Spotlight, as <a href="https://eclecticlight.co/2022/04/08/how-to-enable-use-and-fix-visual-look-up/">previously explained</a>.</li>
<li>Users who want to block all such external <code>mediaanalysisd</code> look-ups can do so using a software firewall to block outgoing connections to Apple’s servers by that process through port 443. That may well disable other macOS features.</li>
<li>Trying to harvest VLU neural hashes to detect CSAM would be doomed to failure for many reasons, most of which were raised with Apple at the time of its original proposals, and remain valid today.</li>
<li>Alleging that a user’s actions result in controversial effects requires demonstration of the full chain of causation. Basing claims on the inference that two events might be connected, without understanding the nature of either, is reckless if not malicious.</li>
</ul>
<p><em>If you doubt the accuracy or veracity of anything I have written above, then all the tools that I used are free, available from the links I’ve provided, and I look forward to reading your results.</em></p>
	</div></div>
  </body>
</html>
