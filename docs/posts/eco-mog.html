<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://elijer.github.io/garden/Projects/Eco-Mog">Original</a>
    <h1>Eco MOG</h1>
    
    <div id="readability-page-1" class="page"><article>
<p>My goal is to build a real-time multiplayer game that contains a persistent online ecosystem. The goal of this article is to outline a detailed ‚Äúwhat‚Äù and ‚Äúwhy‚Äù for this project, and chronicle where it takes me.</p>
<blockquote data-callout="info">


</blockquote>
<h2 id="multiplayer-"><strong>Multiplayer</strong> üéÆ<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#multiplayer-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>A series of ‚Äúworlds‚Äù where many players are each given a body to occupy space in the world. Those bodies will interact with the world and each other, but I don‚Äôt have many opinions on the nature of those interactions. The gathering and exchange of information? Building structures?</p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/town.jpeg" width="auto" height="auto" alt=""/></p>
<blockquote>
<p>A drawing of a town inspired by the innovative <a href="https://oskarstalberg.com/Townscaper/">Townscaper<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>, an ambient town-building game.</p>
</blockquote>
<h4 id="open-world-">Open World üåç<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#open-world-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Open World:</strong> each ‚Äúworld‚Äù is a continuous space, although it may be broken up by geographic features, and generative mineral distributions. Flora and fauna make up the living terrain of these places, and each organism has physical properties that allow them to interact with both one another as well as human players.</p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/desert_shmoops.jpeg" width="auto" height="auto" alt=""/></p>
<blockquote>
<p>Sketch of a desert race of Shmoops, with behavior not unlike that of Meerkats or Prairie Dogs</p>
</blockquote>
<h4 id="ecosystem-simulation-">Ecosystem Simulation üå≥<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ecosystem-simulation-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>But this behavior is not static. Through the interaction between organisms and trophic layers, not only do population distributions of organisms throughout the world change over time, but the makeup of each organism does to due to an abstract genetic system.</p>
<blockquote data-callout="info">
<div>
                  
                  <p>Check out an older experiment I made in unity </p>
                  
                </div>
<div>
<p><a href="https://simmer.io/@Kua/grassworldv1">Here‚Äôs an early experiment in this idea<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> - here‚Äôs some vegetation, but check back soon for a build with some herbivores</p>
</div>
</blockquote>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/elements_rts.jpeg" width="auto" height="auto" alt=""/></p>
<blockquote>
<p>A sketch I made while thinking about reducing physics and chemistry into toy-like abstractions</p>
</blockquote>
<h4 id="abstract-laws-of-physics-and-chemistry-">Abstract Laws of Physics and Chemistry üß™<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#abstract-laws-of-physics-and-chemistry-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Here‚Äôs the thing about ecosystems - if they aren‚Äôt based on immutable laws, they will be biased to select for unlimited power [until the world implodes](<a href="https://en.wikipedia.org/wiki/Akira_(1988_film)">https://en.wikipedia.org/wiki/Akira_(1988_film)<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>. they have to be based on immutable rules. One creature would evolve to have ‚Äú1000K strength‚Äù and eat us all. Physics IRL, especially the laws of conservation of energy and mass, requires a cost in exchange for every allowance. For my purposes, the laws themselves matter less than their consistency.</p>
<h4 id="persistence-and-time-Ô∏è">Persistence and Time üï∞Ô∏è<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#persistence-and-time-Ô∏è"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Arguably the most popular lifespan structure of a game is this:</p>
<ul>
<li>Begins when players join</li>
<li>Ends when they leave
But I‚Äôd like to create a world that originates far before any player joins, and continues regardless of whether anyone is around. This is what makes the real world so mysterious and wonderful. Hopefully, this structure allows for games to <em>occur</em> within a world, rather than for the world to <em>be</em> the game. Possibly relevant: <a href="https://www.youtube.com/watch?v=ZCB-0LWAmxw">SIMON SINEK: Finite vs infinite game<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h2 id="environmentalism-and-ecological-sustainability-">Environmentalism and Ecological Sustainability üçÉ<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#environmentalism-and-ecological-sustainability-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>this is pretty loose. I don‚Äôt know if I believe that games can mitigate the effect human beings are having on this planet, and of mass extinction and destruction of natural habitats of once beautifully complex ecosystems. If anything, it is a celebration of them. I think there is a dark beauty in seeing how fragile they are and in allowing the players in this game to destroy and alter these systems, if they choose.</p>
<h2 id="other-thoughts">Other Thoughts<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#other-thoughts"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/pov.png" width="auto" height="auto" alt=""/></p>
<blockquote>
<p>Sketch of the cosmic existentialism of birth into a 1st person view, somewhere.</p>
</blockquote>
<p><strong>POV</strong>: RTS games are generally third person, and first-person are usually, you know. I think that a hybrid of the two would allow for an interesting intersection between individual and society-level gameplay.  <a href="https://simmer.io/@Kua/grassworldv1">experimented a bit with implementing this hybrid here<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
<strong>Time played constrains</strong>: Fundamentally, a world that is ‚Äúalways on‚Äù and has any structures of competition will incentive <em>more play</em>. I don‚Äôt believe in creating this incentive. To get around this, I‚Äôm considering imposing time constraints for players, only allowing the game to be played for a certain amount of time each day</p>
<h2 id="previous-projects-">Previous Projects üêá<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#previous-projects-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Here is a screenshot from an ecosystem simulator I created in the game engine Unity. You can see bunnies with lifespan and reproductive timer bars floating above their heads. They continuously scan their surroundings for grass, and, if their reproductive bar is full, other bunnies. Their visual sensory perception is relatively organic, composed of a scattered slew of ray tracers detecting what objects are in front of them in the hopes it would create interesting and organic behavior.</p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/grass2.jpeg" width="auto" height="auto" alt=""/></p>
<blockquote>
<p>Sorry, I haven‚Äôt deployed this.</p>
</blockquote>
<h2 id="inspiration-">Inspiration üí°<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#inspiration-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li><strong>RTS games</strong> like Age of Empires, Age of Mythology and Black and White</li>
<li><strong>Spore</strong>, an incredibly ambitious game that was as innovative as it was flawed</li>
<li><strong>Conway‚Äôs Game of Life</strong> and <strong>Cellular Automata</strong> as a whole</li>
<li><strong>John van Neumann‚Äôs</strong> question of whether a system can create itself (a matter for another blog post)</li>
</ul>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/spore4.jpeg" width="auto" height="auto" alt=""/></p>
<blockquote>
<p>Single cell organism stage of spore</p>
</blockquote>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/spore5.png" width="auto" height="auto" alt=""/></p>
<h2 id="wild--ideas-">Wild  Ideas üêó<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#wild--ideas-"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>Leveraging Distributed Databases</strong>:
Maintaining an ecosystem on a server is computationally expensive, and could be hard to scale horizontally if more and more users are interacting with the same world and the world is becoming more and more complex. Distributed databases might offer some interesting and creative solutions to this challenge, if the game is every computationally expensive enough for this to be necessary.</p>
<hr/>

<h2 id="may-24-getting-started">May 24: Getting Started<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#may-24-getting-started"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>I started with a basic socket.io implementation on the server and the client.socket.io on both the server and the client. At first I found the structure of their documentation slightly confusing, but figuring out how it was broken down between client and server docs:</p>
<p><strong>Server</strong></p>
<ul>
<li><a href="https://socket.io/docs/v4/server-installation/">Installation<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://socket.io/docs/v4/server-initialization/">Initialization<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>¬†</li>
<li><a href="https://socket.io/docs/v4/server-api/#socket">Complete Server API<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<p><strong>Client</strong></p>
<ul>
<li><a href="https://socket.io/docs/v4/client-socket-instance/">Socket instance<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>¬†</li>
<li><a href="https://socket.io/docs/v4/client-api/#socket">Complete Client API<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<p>The client code could look something like this:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="js" data-theme="github-light github-dark"><code data-language="js" data-theme="github-light github-dark"><span data-line=""><span>import</span><span> { io } </span><span>from</span><span> &#34;socket.io-client&#34;</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>const</span><span>  socket</span><span> =</span><span> io</span><span>(</span><span>&#34;ws://localhost:3000&#34;</span><span>)</span></span>
<span data-line=""><span>socket.</span><span>on</span><span>(</span><span>&#34;connect&#34;</span><span>, () </span><span>=&gt;</span><span> {</span></span>
<span data-line=""><span>  console.</span><span>log</span><span>(</span><span>&#34;Connected&#34;</span><span>)</span></span>
<span data-line=""><span>  console.</span><span>log</span><span>(socket.</span><span>emit</span><span>(</span><span>&#34;player joined&#34;</span><span>, </span><span>determinePlayerId</span><span>()))</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>socket.</span><span>on</span><span>(</span><span>&#34;disconnect&#34;</span><span>, (</span><span>reason</span><span>, </span><span>details</span><span>) </span><span>=&gt;</span><span> {</span></span>
<span data-line=""><span>  console.</span><span>log</span><span>(</span><span>&#34;The server disconnect&#34;</span><span>, reason, details)</span></span>
<span data-line=""><span>});</span></span></code></pre></figure>
<p>With a server like this:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="js" data-theme="github-light github-dark"><code data-language="js" data-theme="github-light github-dark"><span data-line=""><span>// Minimal Server</span></span>
<span data-line=""><span>const</span><span> { </span><span>createServer</span><span> } </span><span>=</span><span> require</span><span>(</span><span>&#39;http&#39;</span><span>);</span></span>
<span data-line=""><span>const</span><span> { </span><span>Server</span><span> } </span><span>=</span><span> require</span><span>(</span><span>&#39;socket.io&#39;</span><span>);</span></span>
<span data-line=""> </span>
<span data-line=""><span>const</span><span> httpServer</span><span> =</span><span> createServer</span><span>();</span></span>
<span data-line=""><span>const</span><span> io</span><span> =</span><span> new</span><span> Server</span><span>(httpServer, {</span></span>
<span data-line=""><span>  cors: {</span></span>
<span data-line=""><span>    origin: </span><span>&#34;http://localhost:5173&#34;</span><span>,</span></span>
<span data-line=""><span>    methods: [</span><span>&#34;GET&#34;</span><span>, </span><span>&#34;POST&#34;</span><span>]</span></span>
<span data-line=""><span>  }</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>io.</span><span>on</span><span>(</span><span>&#34;connection&#34;</span><span>, (</span><span>socket</span><span>) </span><span>=&gt;</span><span> {</span></span>
<span data-line=""><span>  console.</span><span>log</span><span>(</span><span>&#34;Connected&#34;</span><span>)</span></span>
<span data-line=""><span>  socket.</span><span>on</span><span>(</span><span>&#34;player joined&#34;</span><span>, (</span><span>playerId</span><span>) </span><span>=&gt;</span><span> {</span></span>
<span data-line=""><span>	  // do something when connection begins</span></span>
<span data-line=""> </span>
<span data-line=""><span>    socket.</span><span>on</span><span>(</span><span>&#34;disconnecting&#34;</span><span>, </span><span>async</span><span>(</span><span>reason</span><span>) </span><span>=&gt;</span><span> {</span></span>
<span data-line=""><span>	    // do something when connection ends</span></span>
<span data-line=""><span>    })</span></span>
<span data-line=""><span>  })</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>httpServer.</span><span>listen</span><span>(</span><span>3000</span><span>);</span></span></code></pre></figure>
<blockquote>
<p><a href="https://github.com/Elijer/ecomog/tree/814222651737e78b3e8f8a66e52ef38807b5f1bd">If you‚Äôd like to try it out, here is a commit I made for a minimal socket.io server/client ‚Äòhandshake‚Äô to play with<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
</blockquote>
<p>I also tried the <a href="https://github.com/Elijer/ecomog/tree/websocket">websocket library that‚Äôs shipped with all browsers<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>but I found that socket.io had some useful features I didn‚Äôt need to reinvent.</p>
<p>On top of this super basic handshake,</p>
<ul>
<li>I rendered a grid of divs</li>
<li>gave a player a UUID and random location when they first visited the URL</li>
<li>Saved that player‚Äôs UUID so their location persisted across visits
<img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/mog1.png" width="auto" height="auto" alt=""/></li>
</ul>
<p>Once I was content that I had the beginnings of a multiplayer system, I impatiently moved onto the ecosystem. Here are some ‚Äúplants‚Äù!
<img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/mog3-moss.png" width="auto" height="auto" alt=""/></p>
<p>Each of these is sent as a class instance every second.
<img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/mog4-moss.png" width="auto" height="auto" alt=""/></p>
<p>I gave each object some ‚Äúreproductive‚Äù behavior, which actually looked more like movement.
<img src="https://thornberry-garden.s3.us-east-2.amazonaws.com/simple_repro_loop_moss.gif" gif="" loop="true"/></p>
<p>It seemed like each moss should have multiple children, so I messed around with the generation size:</p>
<img src="https://thornberry-garden.s3.us-east-2.amazonaws.com/moss-looping.gif" gif="" loop="true"/>
<hr/>
<h2 id="may-26-optimizations">May 26: Optimizations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#may-26-optimizations"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Then things started crashing. Originally, I passed every object to the client, which was a bit silly. I refactored in a few ways.</p>
<ul>
<li>Only pass the color per square</li>
<li>only re-render divs that need to change</li>
<li>Added an accompanying object with references to each object in their location <em>in addition</em> to the double-nested array/grid structure, which allowed for much cheaper iterations through organisms*</li>
<li>Creating a set of class inheritance to describe organisms, like BaseTile &gt; Organism &gt; Moss</li>
</ul>
<blockquote>
<p>I couldn‚Äôt do away with the double-nested array/grid data structure though, because it was the best way to ask things like ‚Äúwhat is next to this square?‚Äù, as in ‚Äúcan I move here?‚Äù</p>
</blockquote>
<p>Ideas for feature refactors</p>
<ul>
<li>only send the data for the <em>diff</em> of the board, since much of it is empty (at least at the ‚Äúbeginning‚Äù of a ‚Äúgame‚Äù) - Courtesy of the wonderful <a href="https://404wolf.com/">Wolf Mermelstein<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li>Create a way to send a raw buffer of data, minimizing representations of color even further. I could decide to work with just 16 colors, for example, allowing me represent two squares with just a byte.</li>
<li>Use a memory-safe language (bit of a knee-jerk with understanding what memory limitations I may be facing first, if any)</li>
</ul>
<p>During this refactor, I learned something very important about declaring arrays. I wrote this line to create the empty grid like this:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="js" data-theme="github-light github-dark"><code data-language="js" data-theme="github-light github-dark"><span data-line=""><span>initializeGrid</span><span>(){</span></span>
<span data-line=""> </span>
<span data-line=""><span>// this.cols and this.rows is just the number of rows and columns.</span></span>
<span data-line=""><span>return</span><span> new</span><span> Array</span><span>(</span><span>this</span><span>.rows)</span></span>
<span data-line=""><span>	.</span><span>fill</span><span>(</span><span>new</span><span> Array</span><span>(</span><span>this</span><span>.cols)</span></span>
<span data-line=""><span>	.</span><span>fill</span><span>(</span><span>new</span><span> Array</span><span>(</span><span>2</span><span>)</span></span>
<span data-line=""><span>	.</span><span>fill</span><span>(</span><span>0</span><span>)))</span></span>
<span data-line=""><span>}</span></span></code></pre></figure>
<p>What I intended to do was to create an array (rows) of arrays (columns) or arrays (multiple slots per square).</p>
<p>But when I added a player to one of the squares like this:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="js" data-theme="github-light github-dark"><code data-language="js" data-theme="github-light github-dark"><span data-line=""><span>this</span><span>.grid[x][y][</span><span>0</span><span>] </span><span>=</span><span> {</span></span>
<span data-line=""><span>	id: playerId,</span></span>
<span data-line=""><span>	position: [x, y],</span></span>
<span data-line=""><span>	color: </span><span>generateRandomColor</span><span>(),</span></span>
<span data-line=""><span>	online: </span><span>true</span></span>
<span data-line=""><span>}</span></span></code></pre></figure>
<p>This is what I got:
<img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/incorrect_array.png" width="auto" height="auto" alt=""/>
Not really desired behavior.</p>
<p>The problem was that the .fill method was simply filling each index with the same array, at every level of this set of nested loops!</p>
<p>It‚Äôs chunkier, but this was the solution:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="js" data-theme="github-light github-dark"><code data-language="js" data-theme="github-light github-dark"><span data-line=""><span>initializeGrid</span><span>() {</span></span>
<span data-line=""><span>	const</span><span> grid</span><span> =</span><span> [];</span></span>
<span data-line=""><span>	for</span><span> (</span><span>let</span><span> i </span><span>=</span><span> 0</span><span>; i </span><span>&lt;</span><span> this</span><span>.rows; i</span><span>++</span><span>) {</span></span>
<span data-line=""><span>		const</span><span> row</span><span> =</span><span> [];</span></span>
<span data-line=""><span>		for</span><span> (</span><span>let</span><span> j </span><span>=</span><span> 0</span><span>; j </span><span>&lt;</span><span> this</span><span>.cols; j</span><span>++</span><span>) {</span></span>
<span data-line=""><span>			row.</span><span>push</span><span>([</span><span>0</span><span>, </span><span>0</span><span>]); </span><span>// Create a new array for each cell</span></span>
<span data-line=""><span>		}</span></span>
<span data-line=""><span>		grid.</span><span>push</span><span>(row);</span></span>
<span data-line=""> </span>
<span data-line=""><span>	}</span></span>
<span data-line=""> </span>
<span data-line=""><span>	return</span><span> grid;</span></span>
<span data-line=""> </span>
<span data-line=""><span>	}</span></span></code></pre></figure>
<p>Maybe I can get the podcast <a href="https://99percentinvisible.org/">99% invisible<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> to sponsor this project.
<img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/correct_array.png" width="auto" height="auto" alt=""/></p>
<hr/>
<h2 id="may-28-organism-behavior">May 28: Organism Behavior<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#may-28-organism-behavior"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Oof. I was disappointed to find that when I refactored the moss into a class inheritance system, the behavior didn‚Äôt hit the same, so I ended up playing around a lot with it. It also DEFINITELY was still crashing, probably because the cycles of reproduction per generation were so dramatically in sync.</p>
<p> <video controls=""> <source src="https://thornberry-garden.s3.us-east-2.amazonaws.com/Moss1.mp4" type="video/mp4"/> Your browser does not support the video tag. </video> </p>
<p> <video controls=""> <source src="https://thornberry-garden.s3.us-east-2.amazonaws.com/Moss2.mp4" type="video/mp4"/> Your browser does not support the video tag. </video> </p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/Screenshot-2024-05-28-at-5.04.25-PM.png" width="auto" height="auto" alt=""/></p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/Screenshot-2024-05-27-at-10.50.52-PM.png" width="auto" height="auto" alt=""/></p>
<p>Still faced with a lot of latency, I talked with my peers and found that there are many ways I could tackle my latency challenges:</p>
<ul>
<li>Leverage the GPU for better performance</li>
<li>Use WebGL for more efficient rendering than the DOM can provide</li>
<li>Use Web Assembly for more efficient CPU usage than the browser can provide</li>
<li>How a machine language like Rust or Go might really help with performance because garbage collection (cleaning up references to now unused items) might be very important</li>
<li>Big 0 notation and understanding how different iterative structures really effect performance</li>
</ul>
<p>I also discovered which organism properties had the most interesting conway-ish effects.</p>
<ul>
<li>The reproductive window of maturity moss could reproduce within</li>
<li>The ability for moss to reproduce ‚ÄúOVER‚Äù neighboring moss</li>
<li>Number of times a moss reproduced per generation</li>
</ul>
<p>All this said, the most rational thing to do seemed to be to open up the Node profiler for the first time. Hello Node profiler!</p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Projects/attachments/Screenshot-2024-05-28-at-12.30.19-AM.png" width="auto" height="auto" alt=""/></p>
<p>It wasn‚Äôt the biggest revelation, but the draw calls were certainly surpassing the amount of time allotting to the frames they were called in. So the easiest way to kill latency would probably be to just simply slow down the reproductive behavior, or make it slightly more diffuse over time (less synchronized). Luckily, these happen to be things that really make sense for plants anyways. I hope to return to many of these optimization opportunities above, but they also each have the ability to kill the project by making it into an optimization project instead of a game.</p>
<h2 id="may-29--talks">May 29 : Talks<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#may-29--talks"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>I have been recommended this concept/article:
<a href="https://www.david-colson.com/2020/02/09/making-a-simple-ecs.html">How to make a simple entity-component-system in C++<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>And reminded of the brilliant Sebastian Lague, a youtube artist/gamecreater/programmer who creates <a href="https://www.youtube.com/watch?v=DxfEbulyFcY">videos about stuff like volumetric cloud generation.<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>I paired with <a href="https://www.seamusedson.net/">Seamus Edson<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>today and discovered he‚Äôs one of the best possible peers I could have when working on a project like this. I told him about wanting to use Three.JS for this project at some point, and he gave me some nuanced advice. On the one hand, he showed me a game he created with a colleague called <a href="https://rustforms.itch.io/lostlots">Lost Lots<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> which sort of made me feel like, I don‚Äôt even need to do this project because he did such an incredible job on something so similar. He created an incredible abstract chemistry system governing the laws of his plants.</p>
<p>But he also counseled me that, I didn‚Äôt need to go 3D. Much of my concept really doesn‚Äôt require 3D, and would actually be slowed down by the complexity 3D would introduce.</p>
<p><a href="https://www.linkedin.com/in/peter-stefek-083a60126/">Peter Stefek <svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> mentioned <a href="https://distill.pub/2020/growing-ca/">this site in which each cell on the grid has behavior determined by a neural network.<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>which was interesting, but probably not relevant since the thing most like a neural net in my game will really by the generations organisms themselves. However, it opened up a cool conversation. Carsten wondered if a neural net thing could be use for tuning the model itself, sort of similar to how Yannick used combat simulations in his game to determine the difficulty of an enemy. He also pointed out that a point and click movement system is much less demanding than a square-by-square ‚ÄúWASD‚Äù-style input system.</p>
<blockquote>
<p>Note: Peter rewrote an implementation of the Game of Life on ShaderToy that I would really like see.</p>
</blockquote>
<p>Reed framed this type of decision as a rung on a ladder of abstraction. This is a ladder of abstraction because the spectrum we‚Äôre talking about is the spectrum of intent - what is the person intending to to, and you can go one step further on spectrum where you just declare the intent of the actor
He also pointed out I should probably figure out what kind of player interaction I am going for:</p>
<ul>
<li>Human interaction time</li>
<li>How does a player choose what action to take? Can they add nutrients, or take it away? How does it work? Do they need to select a menu item which takes a while?</li>
</ul>
<blockquote>
<p>Carsten also asked - do you play as a ‚Äúhuman‚Äù, or as a plant? I love this question.</p>
</blockquote>
<p>Carsten also asked, can a single square on the map contain multiple things? How does my data model describe space, and stuff in space? I have some reflections on this I wrote down in my journal I ended up writing down much later.</p>
<p>Yannick, meanwhile, is interested in player interaction with the evolution of other organisms; breeding. Maybe even training pets?</p>
<p>At some point somebody showed me this crazy cool game called <a href="https://www.molleindustria.org/lichenia/">lichenia<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>, a really beautiful grid-based game.</p>
<p>To conclude, here‚Äôs a thematic idea - what if there are human beings and you play as animals to destroy their civilization? Misanthropic, but a neat turn table.</p>
<h2 id="may-31-alex-chen">May 31: Alex Chen<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#may-31-alex-chen"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Alex Chen has created a very performant multiplayer top-down shooter game between a bunch of colorful bubbles using a custom implementation of UDP.</p>
<p>Here are some articles he sent me:
<a href="https://mas-bandwidth.com/creating-a-first-person-shooter-that-scales-to-millions-of-players/">Creating a first person shooter with one million players<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
<a href="https://mas-bandwidth.com/choosing-the-right-network-model-for-your-multiplayer-game/">Choosing the right network model for your multiplayer game<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<h2 id="june-18-rust--deployment">June 18: Rust / Deployment!<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#june-18-rust--deployment"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>That past couple weeks have flown by. I spent much of one week <a href="https://sedson.itch.io/form-of-danger">creating this during a gamejam<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> and a lot of the second week working on my <a href="https://blog.mattstuchlik.com/2024/07/Projects/Gauntlet" data-slug="Projects/Gauntlet">Gauntlet</a> , which started during Impossible Day (where Recurser‚Äôs try to do something impossible) and quickly became something I wanted to continue working on throughout the week.</p>
<p>This week, I am working on deployment. <a href="https://saskanupe-b0a033b8892a.herokuapp.com/">I did it actually! Here is the live Demo of what I have so far!<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> This was deployed with Heroku. I made it pretty far with dockerizing and deploying with the community disco server as well, but couldn‚Äôt quite get it just yet.</p>
<p><strong>Rust and WASM</strong>: I tried out Web Assembly and using it to compule Rust to the browser in the hope that at some point I can port much of this game to rust.</p>
<p>One really reassuring part of the Rust community (besides all of it) is that <a href="https://rustwasm.github.io/book/game-of-life/introduction.html">one of the most popular ‚ÄúHello World‚Äú‚Äòs is actually an implementation of Conway‚Äôs game of life!<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<hr/>

<h2 id="june-19-overview">June 19: Overview<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#june-19-overview"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="project-structure">Project Structure<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#project-structure"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Okay, I‚Äôve deployed <em>something</em>, so I feel more comfortable walking through the project and trying to improve it a bit in its current state.</p>
<pre><code>// Directory system
- server &lt;--- Node.js server
- client &lt;--- vite client bundle
- package.json
</code></pre>
<h3 id="deployment-to-heroku">Deployment to Heroku<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#deployment-to-heroku"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Here‚Äôs how to deploy to Heroku since I didn‚Äôt document that the first time around.
This is my top-level <code>package.json</code> file, which references two more package.json‚Äôs that live in  the <code>client</code> and <code>server</code> dirs, respectively.</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="json" data-theme="github-light github-dark"><code data-language="json" data-theme="github-light github-dark"><span data-line=""><span>&#34;scripts&#34;</span><span>: {</span></span>
<span data-line=""><span>	&#34;start&#34;</span><span>: </span><span>&#34;npm run build-client &amp;&amp; npm run server&#34;</span><span>,</span></span>
<span data-line=""><span>	&#34;build-client&#34;</span><span>: </span><span>&#34;cd client &amp;&amp; npm i &amp;&amp; npm run build&#34;</span><span>,</span></span>
<span data-line=""><span>	&#34;server&#34;</span><span>: </span><span>&#34;cd server &amp;&amp; npm i &amp;&amp; node server.js&#34;</span></span>
<span data-line=""><span>},</span></span>
<span data-line=""><span>// Note there are also package.json files in server and client directories</span></span></code></pre></figure>
<p>At this point I should probably be using docker, but this Heroku process works and I want to keep moving.</p>
<p>I actually have omitted the <code>Procfile</code> Heroku sometimes wants because without it, Heroku defaults to a <code>web</code> process running <code>npm run start</code>, which is exactly what I want to do.</p>
<p><a href="https://github.com/Elijer/jungle/commit/75c07f89e653ceebd826823f570107b57d5516af">Here is a snapshot if the repo at this stage.<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p><strong>Here are two guides I used to deploy with Heroku</strong></p>
<ul>
<li><a href="https://devcenter.heroku.com/articles/git">Deploying to Heroku from git<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><a href="https://devcenter.heroku.com/articles/deploying-nodejs">Here is a guide on deploying a Node app to Heroku<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<p><strong>One gotcha I faced:</strong> Setting your node version in you package.json is very important, and making sure it lines up with version you‚Äôre using locally and remotely.</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="zsh" data-theme="github-light github-dark"><code data-language="zsh" data-theme="github-light github-dark"><span data-line=""><span># $create a heroku remote</span></span>
<span data-line=""><span>heroku</span><span> create</span><span> -a</span><span> example-app</span></span>
<span data-line=""> </span>
<span data-line=""><span># Check it was created correctly</span></span>
<span data-line=""><span>git</span><span> remote</span><span> -v</span></span></code></pre></figure>
<p><strong>Note:</strong> This won‚Äôt work for an existing app that already has an origin. To do that, run:</p>
<pre><code>heroku git:remote -a example-app
</code></pre>
<p>And then push to your heroku remote with:</p>
<pre><code>git push heroku main
</code></pre>
<p>And in theory, your site should be live.</p>
<h3 id="threejs-experiments">Three.js Experiments<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#threejs-experiments"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Woah three.js is really fun. I ended up making these sort of sculptures by accident as I was figuring things out.</p>
<p><img src="https://blog.mattstuchlik.com/2024/07/Screenshot-2024-06-20-at-2.01.40-PM.png" width="auto" height="auto" alt=""/><img src="https://blog.mattstuchlik.com/2024/07/Screenshot-2024-06-20-at-2.45.23-PM.png" width="auto" height="auto" alt=""/></p>
<p> <video controls=""> <source muted="" autoplay="false" src="https://thornberry-garden.s3.us-east-2.amazonaws.com/3js_wires.mov" type="video/mp4"/> Your browser does not support the video tag. </video> </p>
<p> <video controls=""> <source muted="" src="https://thornberry-garden.s3.us-east-2.amazonaws.com/3js_dots.mov" type="video/mp4"/> Your browser does not support the video tag. </video> </p>
<p> <video controls=""> <source muted="" autoplay="false" src="https://thornberry-garden.s3.us-east-2.amazonaws.com/3js_slots.mov" type="video/mp4"/> Your browser does not support the video tag. </video> </p>

<p>I‚Äôve been looking into Memory profiling and <a href="https://www.youtube.com/watch?v=L3ugr9BJqIs">this video from 11 years ago<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> was not only helpful in showing how chrome dev tools can help with that but also had a really great primer on how memory is handled by the browser to begin with.</p>

<p>I demo‚Äôd this project a few times which was really exciting:</p>
<p> <video controls=""> <source muted="" autoplay="false" src="https://thornberry-garden.s3.us-east-2.amazonaws.com/demo_graphics.mov" type="video/mp4"/> Your browser does not support the video tag. </video> </p>
<p>Afterwards, I dealt with some lower-hanging usability and performance issues, and got to around this status:</p>
<p>Reasonable performance in the browser with multiple players: ‚úÖ
Performance on mobile: ‚ùå (crashes after about 10 seconds)
Well-managed Memory: ‚ùå (there are memory leaks in the clientside)
Live demo: <a href="https://jungle.rcdis.co/">https://jungle.rcdis.co/<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p>I ALSO got help from the invigorating <a href="https://greg.technology/">Greg Sadetsky<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>on deploying a containerized version of this project through our disco community server in addition to my Heroku deployment just to see how it faired. Serendipitously, Greg‚Äôs keyboard output was configured differently, resulting it what can only be called ‚ÄúThe Zoomies‚Äù. Surprised and excited by this movement behavior, I added sound and some post-processing to heighten the zoomies:</p>
<p> <video controls=""> <source muted="" autoplay="false" src="https://thornberry-garden.s3.us-east-2.amazonaws.com/zoomies.mov" type="video/mp4"/> Your browser does not support the video tag. </video> </p>
<p>This gameplay is too fast-paced for what I‚Äôm going for and isn‚Äôt really doing anything for performance, but it was fun to experiment with. I kidn‚Äôt kill my darlings though, so for now, I just added a ‚Äúfun mode‚Äù button.</p>
<h3 id="some-links">Some Links<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#some-links"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><a href="https://www.youtube.com/watch?v=dc5iJVInpPY">Three.js Optimization - Best Practices and Techniques | Pretty thorough video on best practices for optimization<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
<a href="https://www.youtube.com/watch?v=vTfMjI4rVSI">Intro to React Three Fiber<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>
<a href="https://blog.maximeheckel.com/posts/the-study-of-shaders-with-react-three-fiber/">The Study of Shaders with React Three Fiber<svg viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>

<p>Good things! It was a lot of work but I seriously optimized the project in the following ways:</p>
<ul>
<li>Instead of sending the entire world state <em>every time it changes</em>, only the relevant change is being sent</li>
<li>Instead of tearing down and recreating most rendered objects in the scene, I am binding objects with their representation in state, and physically moving those objects in the scene accordingly.</li>
</ul>
<p>As a result, I have:</p></article></div>
  </body>
</html>
