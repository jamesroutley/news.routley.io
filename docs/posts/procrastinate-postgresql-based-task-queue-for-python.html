<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://procrastinate.readthedocs.io/en/stable/index.html">Original</a>
    <h1>Procrastinate: PostgreSQL-Based Task Queue for Python</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
        <div>
          

          <div role="main">
            
  <div id="procrastinate-postgresql-based-task-queue-for-python">

<p><a href="https://pypi.org/pypi/procrastinate"><img alt="Deployed to PyPI" src="https://img.shields.io/pypi/v/procrastinate?logo=pypi&amp;logoColor=white"/></a>
<a href="https://pypi.org/pypi/procrastinate"><img alt="Deployed to PyPI" src="https://img.shields.io/pypi/pyversions/procrastinate?logo=pypi&amp;logoColor=white"/></a>
<a href="https://github.com/procrastinate-org/procrastinate/"><img alt="GitHub Repository" src="https://img.shields.io/github/stars/procrastinate-org/procrastinate?logo=github"/></a>
<a href="https://github.com/procrastinate-org/procrastinate/actions?workflow=CI"><img alt="Continuous Integration" src="https://img.shields.io/github/workflow/status/procrastinate-org/procrastinate/CI?logo=github"/></a>
<a href="http://procrastinate.readthedocs.io/en/latest/?badge=latest"><img alt="Documentation" src="https://img.shields.io/readthedocs/procrastinate?logo=read-the-docs&amp;logoColor=white"/></a>
<a href="https://github.com/marketplace/actions/coverage-comment"><img alt="Coverage" src="https://img.shields.io/endpoint?logo=codecov&amp;logoColor=white&amp;url=https://raw.githubusercontent.com/wiki/procrastinate-org/procrastinate/coverage-comment-badge.json"/></a>
<a href="https://github.com/procrastinate-org/procrastinate/blob/master/LICENSE"><img alt="MIT License" src="https://img.shields.io/github/license/procrastinate-org/procrastinate?logo=open-source-initiative&amp;logoColor=white"/></a>
<a href="https://github.com/procrastinate-org/procrastinate/blob/master/LICENSE/CODE_OF_CONDUCT.md"><img alt="Contributor Covenant" src="https://img.shields.io/badge/Contributor%20Covenant-v1.4%20adopted-ff69b4.svg"/></a></p><p>Procrastinate is an open-source Python 3.7+ distributed task processing
library, leveraging PostgreSQL to store task definitions, manage locks and
dispatch tasks. It can be used within both sync and async code.</p>
<p>In other words, from your main code, you call specific functions (tasks) in a
special way and instead of being run on the spot, they’re scheduled to
be run elsewhere, now or in the future.</p>
<p>Here’s an example:</p>
<div><div><pre><span></span><span># mycode.py</span>
<span>import</span> <span>procrastinate</span>

<span># Make an app in your code</span>
<span>app</span> <span>=</span> <span>procrastinate</span><span>.</span><span>App</span><span>(</span><span>connector</span><span>=</span><span>procrastinate</span><span>.</span><span>AiopgConnector</span><span>())</span>

<span># Then define tasks</span>
<span>@app</span><span>.</span><span>task</span><span>(</span><span>queue</span><span>=</span><span>&#34;sums&#34;</span><span>)</span>
<span>def</span> <span>sum</span><span>(</span><span>a</span><span>,</span> <span>b</span><span>):</span>
    <span>with</span> <span>open</span><span>(</span><span>&#34;myfile&#34;</span><span>,</span> <span>&#34;w&#34;</span><span>)</span> <span>as</span> <span>f</span><span>:</span>
        <span>f</span><span>.</span><span>write</span><span>(</span><span>str</span><span>(</span><span>a</span> <span>+</span> <span>b</span><span>))</span>

<span>with</span> <span>app</span><span>.</span><span>open</span><span>():</span>
    <span># Launch a job</span>
    <span>sum</span><span>.</span><span>defer</span><span>(</span><span>a</span><span>=</span><span>3</span><span>,</span> <span>b</span><span>=</span><span>5</span><span>)</span>

    <span># Somewhere in your program, run a worker (actually, it&#39;s often a</span>
    <span># different program than the one deferring jobs for execution)</span>
    <span>app</span><span>.</span><span>run_worker</span><span>(</span><span>queues</span><span>=</span><span>[</span><span>&#34;sums&#34;</span><span>])</span>
</pre></div>
</div>
<p>The worker will run the job, which will create a text file
named <code><span>myfile</span></code> with the result of the sum <code><span>3</span> <span>+</span> <span>5</span></code> (that’s <code><span>8</span></code>).</p>
<p>Similarly, from the command line:</p>
<div><div><pre><span></span><span>export</span> <span>PROCRASTINATE_APP</span><span>=</span><span>&#34;mycode.app&#34;</span>

<span># Launch a job</span>
procrastinate defer mycode.sum <span>&#39;{&#34;a&#34;: 3, &#34;b&#34;: 5}&#39;</span>

<span># Run a worker</span>
procrastinate worker -q sums
</pre></div>
</div>
<p>Lastly, you can use Procrastinate asynchronously too:</p>
<div><div><pre><span></span><span>import</span> <span>asyncio</span>

<span>import</span> <span>procrastinate</span>

<span># Make an app in your code</span>
<span>app</span> <span>=</span> <span>procrastinate</span><span>.</span><span>App</span><span>(</span><span>connector</span><span>=</span><span>procrastinate</span><span>.</span><span>AiopgConnector</span><span>())</span>

<span># Define tasks using coroutine functions</span>
<span>@app</span><span>.</span><span>task</span><span>(</span><span>queue</span><span>=</span><span>&#34;sums&#34;</span><span>)</span>
<span>async</span> <span>def</span> <span>sum</span><span>(</span><span>a</span><span>,</span> <span>b</span><span>):</span>
    <span>await</span> <span>asyncio</span><span>.</span><span>sleep</span><span>(</span><span>a</span> <span>+</span> <span>b</span><span>)</span>

<span>async</span> <span>with</span> <span>app</span><span>.</span><span>open_async</span><span>():</span>
    <span># Launch a job</span>
    <span>await</span> <span>sum</span><span>.</span><span>defer_async</span><span>(</span><span>a</span><span>=</span><span>3</span><span>,</span> <span>b</span><span>=</span><span>5</span><span>)</span>

    <span># Somewhere in your program, run a worker (actually, it&#39;s often a</span>
    <span># different program than the one deferring jobs for execution)</span>
    <span>await</span> <span>app</span><span>.</span><span>run_worker_async</span><span>(</span><span>queues</span><span>=</span><span>[</span><span>&#34;sums&#34;</span><span>])</span>
</pre></div>
</div>
<p>There are quite a few interesting features that Procrastinate adds to the mix.
You can head to the Quickstart section for a general tour or
to the How-To sections for specific features. The Discussion
section should hopefully answer your questions. Otherwise,
feel free to open an <a href="https://github.com/procrastinate-org/procrastinate/issues">issue</a>.</p>
<p>The project is still quite early-stage and will probably evolve.</p>
<p><em>Note to my future self: add a quick note here on why this project is named</em>
“<a href="https://en.wikipedia.org/wiki/Procrastination">Procrastinate</a>”.</p>

</div>


          </div>
          
        </div>
      </div>
      
      
    </div></div>
  </body>
</html>
