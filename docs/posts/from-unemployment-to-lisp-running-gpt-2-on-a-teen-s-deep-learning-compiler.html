<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/hikettei/Caten">Original</a>
    <h1>From Unemployment to Lisp: Running GPT-2 on a Teen&#39;s Deep Learning Compiler</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<blockquote>
<p dir="auto"><strong>This repository is still in the early stages of development. Additionally, it includes many experimental approaches. Please consider this as a place to experiment with my ideas. Do not use it in a product under any circumstances.</strong></p>
</blockquote>
<p dir="auto"><a href="https://github.com/hikettei/Caten/actions/workflows/tests_on_push.yml"><img src="https://github.com/hikettei/Caten/actions/workflows/tests_on_push.yml/badge.svg" alt="CI"/></a> <a href="https://github.com/hikettei/Caten/actions/workflows/benchmark.yml"><img src="https://github.com/hikettei/Caten/actions/workflows/benchmark.yml/badge.svg" alt="Benchmarks"/></a> <a href="https://github.com/hikettei/Caten/actions/workflows/pages/pages-build-deployment"><img src="https://github.com/hikettei/Caten/actions/workflows/pages/pages-build-deployment/badge.svg" alt="pages-build-deployment"/></a> <a href="https://discord.gg/tNawU7TN3s" rel="nofollow"><img src="https://camo.githubusercontent.com/b2fda4ac545746e659c6225cc1fe127973f784a782e4f5346bb548de8622a5e7/68747470733a2f2f646362616467652e6c696d65732e70696e6b2f6170692f7365727665722f744e61775537544e33733f7374796c653d666c6174" alt="" data-canonical-src="https://dcbadge.limes.pink/api/server/tNawU7TN3s?style=flat"/></a></p>
<p dir="auto"><code>Caten = Compile+AbstracTENsor</code></p>
<p dir="auto">Caten is an experimental deep learning compiler. Our goal is to implement a compiler that is as simple as tinygrad, and as flexible as TVM.</p>

<p dir="auto">Caten is still under development, but it aims to support a wide range of models in the future—from image processing to text generation, and vision language models! Some models are already up and running.</p>

<div dir="auto" data-snippet-clipboard-copy-content="$ JIT=1 PARALLEL=8 ./roswell/caten.ros llm-example --model &#34;gpt2&#34; --prompt &#34;Hello&#34; --max-length 100"><pre>$ JIT=1 PARALLEL=8 ./roswell/caten.ros llm-example --model <span><span>&#34;</span>gpt2<span>&#34;</span></span> --prompt <span><span>&#34;</span>Hello<span>&#34;</span></span> --max-length 100</pre></div>
<p dir="auto">Give the GPT2 demo a try! You can pass compilation settings through environment variables.</p>
<p dir="auto">For example, setting <code>JIT=1</code> enables JIT compilation, while <code>JIT_DEBUG &gt;= 2</code> allows you to view the schedule and the generated kernels. Setting <code>PARALLEL=8</code> divides the ScheduleGraph and compiles it in parallel.</p>
<p dir="auto">You may still find the token/ms rate slow, but we&#39;re not yet at the stage of implementing an AutoScheduler to accelerate kernel performance (as well as GPU support). Once our IR matures enough to handle a wide range of deep learning models, we plan to focus on speeding things up!</p>

<ol dir="auto">
<li>Install <a href="https://github.com/roswell/roswell">Roswell</a> and suitable IDE. (If unsure, Emacs or <a href="https://github.com/lem-project/lem">Lem</a> is recommended)</li>
<li>Install <a href="https://github.com/Meinersbur/isl">ISL (Integer Set Library)</a> for the fast kernel generation.</li>
<li>Install <a href="https://github.com/fukamachi/qlot">Qlot</a></li>
<li>Check out <a href="https://github.com/hikettei/Caten/blob/main/docs/getting-started.lisp">getting-started.lisp</a></li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="$ git clone git@github.com:hikettei/Caten.git
$ cd Caten
$ qlot install
$ qlot exec ros run
&gt; (ql:quickload :caten)
&gt; (in-package :caten-user)
&gt; (proceed (!randn `(3 3)))"><pre>$ git clone git@github.com:hikettei/Caten.git
$ <span>cd</span> Caten
$ qlot install
$ qlot <span>exec</span> ros run
<span>&gt;</span> (ql:quickload :caten)
<span>&gt;</span> (in-package :caten-user)
<span>&gt;</span> (proceed (<span>!</span>randn <span><span>`</span>(3 3)))</span></pre></div>

<ol dir="auto">
<li>
<p dir="auto">Join our <a href="https://discord.gg/tNawU7TN3s" rel="nofollow">Discord Server</a>.</p>
</li>
<li>
<p dir="auto">Check out our <a href="https://github.com/users/hikettei/projects/2">roadmap</a>.</p>
</li>
<li>
<p dir="auto">Create a PR</p>
</li>
</ol>
<p dir="auto">Caten is a project that started only a few months ago. We are currently in the stage of building a solid foundational library. Here’s what we’re looking for:</p>
<ul dir="auto">
<li>
<p dir="auto">Feature additions with tests (e.g., new activations, unimplemented matrix operations)</p>
</li>
<li>
<p dir="auto">Bug reports and additional tests.</p>
</li>
<li>
<p dir="auto">Refactoring of the core compiler components</p>
</li>
<li>
<p dir="auto">Improving the documentation</p>
</li>
</ul>
<p dir="auto">etc...</p>
<p dir="auto">Before contributing, please note that there is no linter here. Make an effort to adhere to <a href="https://google.github.io/styleguide/lispguide.xml" rel="nofollow">Google Common Lisp Style Guide</a>. Changes that do not follow this should be rejected by the review.</p>


<ul dir="auto">
<li><strong>Transformer</strong>
<ul>
<li> GPT2</li>
<li> Llama3 8B</li>
<li> TinyLLAMA</li>
</ul>
</li>
<li><strong>Classification</strong>
<ul>
<li> MobileNetV2</li>
<li> MobileNetV3</li>
<li> ResNet18/ResNet34/ResNet50</li>
<li> VIT_B_16</li>
</ul>
</li>
<li><strong>Segmentation</strong>
<ul>
<li> CenterNet</li>
</ul>
</li>
<li><strong>Detection</strong>
<ul>
<li> YoLOv3</li>
<li> YoLOv7</li>
</ul>
</li>
</ul>

<ul>
<li> Common Lisp Frontend (caten/apis)</li>
<li> ONNX (caten/onnx)</li>
<li> GGUF (caten/gguf)</li>
</ul>

<ul>
<li> Support Dequantization from GGUF</li>
<li> Support QOPs</li>
</ul>

<ul>
<li> Autodiff</li>
<li> Fast Autodiff</li>
<li> Support Training</li>
<li> Distributed Training</li>
</ul>

<ul>
<li> LISP VM</li>
<li> CLANG JIT</li>
<li> CLANG with Auto Scheduler</li>
<li> METAL</li>
<li> CUDA</li>
<li> Vulkan</li>
<li> Auto Scheduler</li>
</ul>

<p dir="auto">You should install python, numpy, pytorch before running the test-suite by using <code>make install_extra</code>. If not specified, install the latest one.</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ make install_extra # extra dependencies for running tests
$ make test"><pre>$ make install_extra <span><span>#</span> extra dependencies for running tests</span>
$ make <span>test</span></pre></div>
</article></div></div>
  </body>
</html>
