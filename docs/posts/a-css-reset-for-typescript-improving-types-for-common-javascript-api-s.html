<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/total-typescript/ts-reset">Original</a>
    <h1>A &#39;CSS reset&#39; for TypeScript, improving types for common JavaScript API&#39;s</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">TypeScript&#39;s built-in typings are not perfect. <code>ts-reset</code> makes them better.</p>
<p dir="auto"><strong>Without <code>ts-reset</code></strong>:</p>
<ul dir="auto">
<li><g-emoji alias="rotating_light" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f6a8.png">üö®</g-emoji> <code>.json</code> (in <code>fetch</code>) and <code>JSON.parse</code> both return <code>any</code></li>
<li><g-emoji alias="facepalm" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f926.png">ü§¶</g-emoji> <code>.filter(Boolean)</code> doesn&#39;t behave how you expect</li>
<li><g-emoji alias="rage" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f621.png">üò°</g-emoji> <code>array.includes</code> often breaks on readonly arrays</li>
</ul>
<p dir="auto"><code>ts-reset</code> smooths over these hard edges, just like a CSS reset does in the browser.</p>
<p dir="auto"><strong>With <code>ts-reset</code></strong>:</p>
<ul dir="auto">
<li><g-emoji alias="+1" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f44d.png">üëç</g-emoji> <code>.json</code> (in <code>fetch</code>) and <code>JSON.parse</code> both return <code>unknown</code></li>
<li><g-emoji alias="white_check_mark" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png">‚úÖ</g-emoji> <code>.filter(Boolean)</code> behaves EXACTLY how you expect</li>
<li>ü•π <code>array.includes</code> is widened to be more ergonomic</li>
<li><g-emoji alias="rocket" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f680.png">üöÄ</g-emoji> And several more changes!</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-example" aria-hidden="true" href="#example"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example</h2>
<div dir="auto" data-snippet-clipboard-copy-content="// Import in a single file, then across your whole project...
import &#34;@total-typescript/ts-reset&#34;;

// .filter just got smarter!
const filteredArray = [1, 2, undefined].filter(Boolean); // number[]

// Get rid of the any&#39;s in JSON.parse and fetch
const result = JSON.parse(&#34;{}&#34;); // unknown

fetch(&#34;/&#34;)
  .then((res) =&gt; res.json())
  .then((json) =&gt; {
    console.log(json); // unknown
  });"><pre><span>// Import in a single file, then across your whole project...</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset&#34;</span><span>;</span>

<span>// .filter just got smarter!</span>
<span>const</span> <span>filteredArray</span> <span>=</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>undefined</span><span>]</span><span>.</span><span>filter</span><span>(</span><span>Boolean</span><span>)</span><span>;</span> <span>// number[]</span>

<span>// Get rid of the any&#39;s in JSON.parse and fetch</span>
<span>const</span> <span>result</span> <span>=</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span><span>&#34;{}&#34;</span><span>)</span><span>;</span> <span>// unknown</span>

<span>fetch</span><span>(</span><span>&#34;/&#34;</span><span>)</span>
  <span>.</span><span>then</span><span>(</span><span>(</span><span>res</span><span>)</span> <span>=&gt;</span> <span>res</span><span>.</span><span>json</span><span>(</span><span>)</span><span>)</span>
  <span>.</span><span>then</span><span>(</span><span>(</span><span>json</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>json</span><span>)</span><span>;</span> <span>// unknown</span>
  <span>}</span><span>)</span><span>;</span></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-get-started" aria-hidden="true" href="#get-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Get Started</h2>
<ol dir="auto">
<li>
<p dir="auto">Install: <code>npm i -D @total-typescript/ts-reset</code></p>
</li>
<li>
<p dir="auto">Create a <code>reset.d.ts</code> file in your project with these contents:</p>
</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset&#34;</span><span>;</span></pre></div>
<ol start="3" dir="auto">
<li>Enjoy improved typings across your <em>entire</em> project.</li>
</ol>
<h3 tabindex="-1" dir="auto"><a id="user-content-installing-only-certain-rules" aria-hidden="true" href="#installing-only-certain-rules"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing only certain rules</h3>
<p dir="auto">By importing from <code>@total-typescript/ts-reset</code>, you&#39;re bundling <em>all</em> the recommended rules.</p>
<p dir="auto">To only import the rules you want, you can import like so:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// Makes JSON.parse return unknown
import &#34;@total-typescript/ts-reset/json-parse&#34;;

// Makes await fetch().then(res =&gt; res.json()) return unknown
import &#34;@total-typescript/ts-reset/fetch&#34;;"><pre><span>// Makes JSON.parse return unknown</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/json-parse&#34;</span><span>;</span>

<span>// Makes await fetch().then(res =&gt; res.json()) return unknown</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/fetch&#34;</span><span>;</span></pre></div>
<p dir="auto">For these imports to work, you&#39;ll need to ensure that, in your <code>tsconfig.json</code>, <code>module</code> is set to <code>NodeNext</code> or <code>Node16</code>.</p>
<p dir="auto">Below is a full list of all the rules available.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-caveats" aria-hidden="true" href="#caveats"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Caveats</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-use-ts-reset-in-applications-not-libraries" aria-hidden="true" href="#use-ts-reset-in-applications-not-libraries"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use <code>ts-reset</code> in applications, not libraries</h3>
<p dir="auto"><code>ts-reset</code> is designed to be used in application code, not library code. Each rule you include will make changes to the global scope. That means that, simply by importing your library, your user will be unknowingly opting in to <code>ts-reset</code>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-rules" aria-hidden="true" href="#rules"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Rules</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-make-jsonparse-return-unknown" aria-hidden="true" href="#make-jsonparse-return-unknown"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make <code>JSON.parse</code> return <code>unknown</code></h3>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/json-parse&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/json-parse&#34;</span><span>;</span></pre></div>
<p dir="auto"><code>JSON.parse</code> returning <code>any</code> can cause nasty, subtle bugs. Frankly, any <code>any</code>&#39;s can cause bugs because they disable typechecking on the values they describe.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// BEFORE
const result = JSON.parse(&#34;{}&#34;); // any"><pre><span>// BEFORE</span>
<span>const</span> <span>result</span> <span>=</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span><span>&#34;{}&#34;</span><span>)</span><span>;</span> <span>// any</span></pre></div>
<p dir="auto">By changing the result of <code>JSON.parse</code> to <code>unknown</code>, we&#39;re now forced to either validate the <code>unknown</code> to ensure it&#39;s the correct type (perhaps using <a href="https://github.com/colinhacks/zod"><code>zod</code></a>), or cast it with <code>as</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// AFTER
import &#34;@total-typescript/ts-reset/json-parse&#34;;

const result = JSON.parse(&#34;{}&#34;); // unknown"><pre><span>// AFTER</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/json-parse&#34;</span><span>;</span>

<span>const</span> <span>result</span> <span>=</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span><span>&#34;{}&#34;</span><span>)</span><span>;</span> <span>// unknown</span></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-make-json-return-unknown" aria-hidden="true" href="#make-json-return-unknown"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make <code>.json()</code> return <code>unknown</code></h3>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/fetch&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/fetch&#34;</span><span>;</span></pre></div>
<p dir="auto">Just like <code>JSON.parse</code>, <code>.json()</code> returning <code>any</code> introduces unwanted <code>any</code>&#39;s into your application code.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// BEFORE
fetch(&#34;/&#34;)
  .then((res) =&gt; res.json())
  .then((json) =&gt; {
    console.log(json); // any
  });"><pre><span>// BEFORE</span>
<span>fetch</span><span>(</span><span>&#34;/&#34;</span><span>)</span>
  <span>.</span><span>then</span><span>(</span><span>(</span><span>res</span><span>)</span> <span>=&gt;</span> <span>res</span><span>.</span><span>json</span><span>(</span><span>)</span><span>)</span>
  <span>.</span><span>then</span><span>(</span><span>(</span><span>json</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>json</span><span>)</span><span>;</span> <span>// any</span>
  <span>}</span><span>)</span><span>;</span></pre></div>
<p dir="auto">By forcing <code>res.json</code> to return <code>unknown</code>, we&#39;re encouraged to distrust its results, making us more likely to validate the results of <code>fetch</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// AFTER
import &#34;@total-typescript/ts-reset/fetch&#34;;

fetch(&#34;/&#34;)
  .then((res) =&gt; res.json())
  .then((json) =&gt; {
    console.log(json); // unknown
  });"><pre><span>// AFTER</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/fetch&#34;</span><span>;</span>

<span>fetch</span><span>(</span><span>&#34;/&#34;</span><span>)</span>
  <span>.</span><span>then</span><span>(</span><span>(</span><span>res</span><span>)</span> <span>=&gt;</span> <span>res</span><span>.</span><span>json</span><span>(</span><span>)</span><span>)</span>
  <span>.</span><span>then</span><span>(</span><span>(</span><span>json</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>json</span><span>)</span><span>;</span> <span>// unknown</span>
  <span>}</span><span>)</span><span>;</span></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-make-filterboolean-filter-out-falsy-values" aria-hidden="true" href="#make-filterboolean-filter-out-falsy-values"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make <code>.filter(Boolean)</code> filter out falsy values</h3>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/filter-boolean&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/filter-boolean&#34;</span><span>;</span></pre></div>
<p dir="auto">The default behaviour of <code>.filter</code> can feel pretty frustrating. Given the code below:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// BEFORE
const filteredArray = [1, 2, undefined].filter(Boolean); // (number | undefined)[]"><pre><span>// BEFORE</span>
<span>const</span> <span>filteredArray</span> <span>=</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>undefined</span><span>]</span><span>.</span><span>filter</span><span>(</span><span>Boolean</span><span>)</span><span>;</span> <span>// (number | undefined)[]</span></pre></div>
<p dir="auto">It feels natural that TypeScript should understand that you&#39;ve filtered out the <code>undefined</code> from <code>filteredArray</code>. You can make this work, but you need to mark it as a type predicate:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const filteredArray = [1, 2, undefined].filter((item): item is number =&gt; {
  return !!item;
}); // number[]"><pre><span>const</span> <span>filteredArray</span> <span>=</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>undefined</span><span>]</span><span>.</span><span>filter</span><span>(</span><span>(</span><span>item</span><span>)</span>: <span>item</span> is <span>number</span> <span>=&gt;</span> <span>{</span>
  <span>return</span> <span>!</span><span>!</span><span>item</span><span>;</span>
<span>}</span><span>)</span><span>;</span> <span>// number[]</span></pre></div>
<p dir="auto">Using <code>.filter(Boolean)</code> is a really common shorthand for this. So, this rule makes it so <code>.filter(Boolean)</code> acts like a type predicate on the array passed in, removing any falsy values from the array member.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// AFTER
import &#34;@total-typescript/ts-reset/filter-boolean&#34;;

const filteredArray = [1, 2, undefined].filter(Boolean); // number[]"><pre><span>// AFTER</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/filter-boolean&#34;</span><span>;</span>

<span>const</span> <span>filteredArray</span> <span>=</span> <span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>undefined</span><span>]</span><span>.</span><span>filter</span><span>(</span><span>Boolean</span><span>)</span><span>;</span> <span>// number[]</span></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-make-includes-on-as-const-arrays-less-strict" aria-hidden="true" href="#make-includes-on-as-const-arrays-less-strict"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make <code>.includes</code> on <code>as const</code> arrays less strict</h3>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/array-includes&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/array-includes&#34;</span><span>;</span></pre></div>
<p dir="auto">This rule improves on TypeScript&#39;s default <code>.includes</code> behaviour. Without this rule enabled, the argument passed to <code>.includes</code> MUST be a member of the array it&#39;s being tested against.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// BEFORE
const users = [&#34;matt&#34;, &#34;sofia&#34;, &#34;waqas&#34;] as const;

// Argument of type &#39;&#34;bryan&#34;&#39; is not assignable to
// parameter of type &#39;&#34;matt&#34; | &#34;sofia&#34; | &#34;waqas&#34;&#39;.
users.includes(&#34;bryan&#34;);"><pre><span>// BEFORE</span>
<span>const</span> <span>users</span> <span>=</span> <span>[</span><span>&#34;matt&#34;</span><span>,</span> <span>&#34;sofia&#34;</span><span>,</span> <span>&#34;waqas&#34;</span><span>]</span> <span>as</span> <span>const</span><span>;</span>

<span>// Argument of type &#39;&#34;bryan&#34;&#39; is not assignable to</span>
<span>// parameter of type &#39;&#34;matt&#34; | &#34;sofia&#34; | &#34;waqas&#34;&#39;.</span>
<span>users</span><span>.</span><span>includes</span><span>(</span><span>&#34;bryan&#34;</span><span>)</span><span>;</span></pre></div>
<p dir="auto">This can often feel extremely awkward. But with the rule enabled, <code>.includes</code> now takes a widened version of the literals in the <code>const</code> array.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// AFTER
import &#34;@total-typescript/ts-reset/array-includes&#34;;

const users = [&#34;matt&#34;, &#34;sofia&#34;, &#34;waqas&#34;] as const;

// .includes now takes a string as the first parameter
users.includes(&#34;bryan&#34;);"><pre><span>// AFTER</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/array-includes&#34;</span><span>;</span>

<span>const</span> <span>users</span> <span>=</span> <span>[</span><span>&#34;matt&#34;</span><span>,</span> <span>&#34;sofia&#34;</span><span>,</span> <span>&#34;waqas&#34;</span><span>]</span> <span>as</span> <span>const</span><span>;</span>

<span>// .includes now takes a string as the first parameter</span>
<span>users</span><span>.</span><span>includes</span><span>(</span><span>&#34;bryan&#34;</span><span>)</span><span>;</span></pre></div>
<p dir="auto">This means you can test non-members of the array safely.</p>
<p dir="auto">It also makes <code>.includes</code> a type predicate, meaning you can use it to narrow wider types to a set enum:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/array-includes&#34;;

const users = [&#34;matt&#34;, &#34;sofia&#34;, &#34;waqas&#34;] as const;

const isUser = (input: string) =&gt; {
  if (users.includes(input)) {
    // input is narrowed to &#34;matt&#34; | &#34;sofia&#34; | &#34;waqas&#34;
    console.log(input);
  }
};"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/array-includes&#34;</span><span>;</span>

<span>const</span> <span>users</span> <span>=</span> <span>[</span><span>&#34;matt&#34;</span><span>,</span> <span>&#34;sofia&#34;</span><span>,</span> <span>&#34;waqas&#34;</span><span>]</span> <span>as</span> <span>const</span><span>;</span>

<span>const</span> <span>isUser</span> <span>=</span> <span>(</span><span>input</span>: <span>string</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>if</span> <span>(</span><span>users</span><span>.</span><span>includes</span><span>(</span><span>input</span><span>)</span><span>)</span> <span>{</span>
    <span>// input is narrowed to &#34;matt&#34; | &#34;sofia&#34; | &#34;waqas&#34;</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>input</span><span>)</span><span>;</span>
  <span>}</span>
<span>}</span><span>;</span></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-make-sethas-less-strict" aria-hidden="true" href="#make-sethas-less-strict"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make <code>Set.has()</code> less strict</h3>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/set-has&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/set-has&#34;</span><span>;</span></pre></div>
<p dir="auto">Similar to <code>.includes</code>, <code>Set.has()</code> doesn&#39;t let you pass members that don&#39;t exist in the set:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// BEFORE
const userSet = new Set([&#34;matt&#34;, &#34;sofia&#34;, &#34;waqas&#34;] as const);

// Argument of type &#39;&#34;bryan&#34;&#39; is not assignable to
// parameter of type &#39;&#34;matt&#34; | &#34;sofia&#34; | &#34;waqas&#34;&#39;.
userSet.has(&#34;bryan&#34;);"><pre><span>// BEFORE</span>
<span>const</span> <span>userSet</span> <span>=</span> <span>new</span> <span>Set</span><span>(</span><span>[</span><span>&#34;matt&#34;</span><span>,</span> <span>&#34;sofia&#34;</span><span>,</span> <span>&#34;waqas&#34;</span><span>]</span> <span>as</span> <span>const</span><span>)</span><span>;</span>

<span>// Argument of type &#39;&#34;bryan&#34;&#39; is not assignable to</span>
<span>// parameter of type &#39;&#34;matt&#34; | &#34;sofia&#34; | &#34;waqas&#34;&#39;.</span>
<span>userSet</span><span>.</span><span>has</span><span>(</span><span>&#34;bryan&#34;</span><span>)</span><span>;</span></pre></div>
<p dir="auto">With the rule enabled, <code>Set</code> is much smarter:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// AFTER
import &#34;@total-typescript/ts-reset/set-has&#34;;

const userSet = new Set([&#34;matt&#34;, &#34;sofia&#34;, &#34;waqas&#34;] as const);

// .has now takes a string as the argument!
userSet.has(&#34;bryan&#34;);"><pre><span>// AFTER</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/set-has&#34;</span><span>;</span>

<span>const</span> <span>userSet</span> <span>=</span> <span>new</span> <span>Set</span><span>(</span><span>[</span><span>&#34;matt&#34;</span><span>,</span> <span>&#34;sofia&#34;</span><span>,</span> <span>&#34;waqas&#34;</span><span>]</span> <span>as</span> <span>const</span><span>)</span><span>;</span>

<span>// .has now takes a string as the argument!</span>
<span>userSet</span><span>.</span><span>has</span><span>(</span><span>&#34;bryan&#34;</span><span>)</span><span>;</span></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-removing-any-from-arrayisarray" aria-hidden="true" href="#removing-any-from-arrayisarray"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Removing <code>any[]</code> from <code>Array.isArray()</code></h3>
<div dir="auto" data-snippet-clipboard-copy-content="import &#34;@total-typescript/ts-reset/is-array&#34;;"><pre><span>import</span> <span>&#34;@total-typescript/ts-reset/is-array&#34;</span><span>;</span></pre></div>
<p dir="auto">When you&#39;re using <code>Array.isArray</code>, you can introduce subtle <code>any</code>&#39;s into your app&#39;s code.</p>
<div dir="auto" data-snippet-clipboard-copy-content="// BEFORE

const validate = (input: unknown) =&gt; {
  if (Array.isArray(input)) {
    console.log(input); // any[]
  }
};"><pre><span>// BEFORE</span>

<span>const</span> <span>validate</span> <span>=</span> <span>(</span><span>input</span>: <span>unknown</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>if</span> <span>(</span><span>Array</span><span>.</span><span>isArray</span><span>(</span><span>input</span><span>)</span><span>)</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>input</span><span>)</span><span>;</span> <span>// any[]</span>
  <span>}</span>
<span>}</span><span>;</span></pre></div>
<p dir="auto">With <code>is-array</code> enabled, this check will now mark the value as <code>unknown[]</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// AFTER
import &#34;@total-typescript/ts-reset/is-array&#34;;

const validate = (input: unknown) =&gt; {
  if (Array.isArray(input)) {
    console.log(input); // unknown[]
  }
};"><pre><span>// AFTER</span>
<span>import</span> <span>&#34;@total-typescript/ts-reset/is-array&#34;</span><span>;</span>

<span>const</span> <span>validate</span> <span>=</span> <span>(</span><span>input</span>: <span>unknown</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>if</span> <span>(</span><span>Array</span><span>.</span><span>isArray</span><span>(</span><span>input</span><span>)</span><span>)</span> <span>{</span>
    <span>console</span><span>.</span><span>log</span><span>(</span><span>input</span><span>)</span><span>;</span> <span>// unknown[]</span>
  <span>}</span>
<span>}</span><span>;</span></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-rules-we-wont-add" aria-hidden="true" href="#rules-we-wont-add"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Rules we won&#39;t add</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-objectkeysobjectentries" aria-hidden="true" href="#objectkeysobjectentries"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><code>Object.keys</code>/<code>Object.entries</code></h3>
<p dir="auto">A common ask is to provide &#39;better&#39; typings for <code>Object.keys</code>, so that it returns <code>Array&lt;keyof T&gt;</code> instead of <code>Array&lt;string&gt;</code>. Same for <code>Object.entries</code>. <code>ts-reset</code> won&#39;t be including rules to change this.</p>
<p dir="auto">TypeScript is a structural typing system. One of the effects of this is that TypeScript can&#39;t always guarantee that your object types don&#39;t contain excess properties:</p>
<div dir="auto" data-snippet-clipboard-copy-content="type Func = () =&gt; {
  id: string;
};

const func: Func = () =&gt; {
  return {
    id: &#34;123&#34;,
    // No error on an excess property!
    name: &#34;Hello!&#34;,
  };
};"><pre><span>type</span> <span>Func</span> <span>=</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>id</span>: <span>string</span><span>;</span>
<span>}</span><span>;</span>

<span>const</span> <span>func</span>: <span>Func</span> <span>=</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>return</span> <span>{</span>
    <span>id</span>: <span>&#34;123&#34;</span><span>,</span>
    <span>// No error on an excess property!</span>
    <span>name</span>: <span>&#34;Hello!&#34;</span><span>,</span>
  <span>}</span><span>;</span>
<span>}</span><span>;</span></pre></div>
<p dir="auto">So, the only reasonable type for <code>Object.keys</code> to return is <code>Array&lt;string&gt;</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-generics-for-jsonparse-responsejson-etc" aria-hidden="true" href="#generics-for-jsonparse-responsejson-etc"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Generics for <code>JSON.parse</code>, <code>Response.json</code> etc</h3>
<p dir="auto">A common request is for <code>ts-reset</code> to add type arguments to functions like <code>JSON.parse</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const str = JSON.parse&lt;string&gt;(&#39;&#34;hello&#34;&#39;);

console.log(str); // string"><pre><span>const</span> <span>str</span> <span>=</span> <span>JSON</span><span>.</span><span>parse</span><span>&lt;</span><span>string</span><span>&gt;</span><span>(</span><span>&#39;&#34;hello&#34;&#39;</span><span>)</span><span>;</span>

<span>console</span><span>.</span><span>log</span><span>(</span><span>str</span><span>)</span><span>;</span> <span>// string</span></pre></div>
<p dir="auto">This appears to improve the DX by giving you autocomplete on the thing that gets returned from <code>JSON.parse</code>.</p>
<p dir="auto">However, we argue that this is a lie to the compiler and so, unsafe.</p>
<p dir="auto"><code>JSON.parse</code> and <code>fetch</code> represent <em>validation boundaries</em> - places where unknown data can enter your application code.</p>
<p dir="auto">If you <em>really</em> know what data is coming back from a <code>JSON.parse</code>, then an <code>as</code> assertion feels like the right call:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const str = JSON.parse(&#39;&#34;hello&#34;&#39;) as string;

console.log(str); // string"><pre><span>const</span> <span>str</span> <span>=</span> <span>JSON</span><span>.</span><span>parse</span><span>(</span><span>&#39;&#34;hello&#34;&#39;</span><span>)</span> <span>as</span> <span>string</span><span>;</span>

<span>console</span><span>.</span><span>log</span><span>(</span><span>str</span><span>)</span><span>;</span> <span>// string</span></pre></div>
<p dir="auto">This provides the types you intend and also signals to the developer that this is <em>slightly</em> unsafe.</p>
</article>
          </div></div>
  </body>
</html>
