<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://engineering.atspotify.com/2022/03/incident-report-spotify-outage-on-march-8/">Original</a>
    <h1>Incident report: Spotify outage on March 8</h1>
    
    <div id="readability-page-1" class="page"><div role="main" id="main">
    <!-- section -->
    <section>

                        <!-- article -->

                <article id="post-5183">
    <div>
        <!-- post title -->
        

        <div>
            <p><img src="https://engineering.atspotify.com/wp-content/themes/theme-spotify/images/icon.png" alt=""/></p><p><span>March 11, 2022</span>
                
            </p>
        </div>
        <!-- post details -->
        <p><a href="https://engineering.atspotify.com/2022/03/incident-report-spotify-outage-on-march-8/" title="Incident Report: Spotify Outage on March 8">
                        <img src="https://engineering.atspotify.com/wp-content/uploads/sites/2/2022/03/Incident-Report_Header.png" alt="" srcset="https://engineering.atspotify.com/wp-content/uploads/sites/2/2022/03/Incident-Report_Header.png 1200w, https://engineering.atspotify.com/wp-content/uploads/sites/2/2022/03/Incident-Report_Header-250x123.png 250w, https://engineering.atspotify.com/wp-content/uploads/sites/2/2022/03/Incident-Report_Header-700x344.png 700w, https://engineering.atspotify.com/wp-content/uploads/sites/2/2022/03/Incident-Report_Header-768x378.png 768w, https://engineering.atspotify.com/wp-content/uploads/sites/2/2022/03/Incident-Report_Header-120x59.png 120w" sizes="(max-width: 1200px) 100vw, 1200px"/>                    </a></p>

        <!-- /post title -->

        
<p>On March 8, we experienced a global outage triggered by issues in a cloud-hosted service discovery system used at Spotify. We were made aware of issues with login at 18:12 UTC / 13:12 ET and started implementing fixes to critical systems at 18:39 UTC / 13:39 ET. This outage affected our users and we apologize for the inconvenience it may have caused. Our service has now fully recovered.</p>



<h2>What happened?</h2>



<p>The Spotify backend consists of multiple microservices that communicate with each other. For microservices to be able to find each other, we utilize multiple service discovery technologies. Most of our services are using a DNS based service discovery system; however, some of our services use an xDS based traffic control plane and discovery system called <a href="https://cloud.google.com/traffic-director" target="_blank" rel="noreferrer noopener">Traffic Director</a>. </p>



<p>On March 8, <a href="https://status.cloud.google.com/incidents/LuGcJVjNTeC5Sb9pSJ9o" target="_blank" rel="noreferrer noopener">Google Cloud Traffic Director experienced an outage</a>. This in coordination with <a href="https://github.com/grpc/grpc-java/issues/8950" target="_blank" rel="noreferrer noopener">a bug in a client (gRPC) library</a> caused the Spotify outage that affected many of our users: if you were logged out of a Spotify app, you were unable to log back in.</p>



<p>As soon as the problem was discovered, we rolled out configuration changes to revert our affected systems back to use our DNS-based service discovery and saw it recover gradually. See the timeline below for more details.</p>



<h3>Timeline</h3>



<p>18:12 UTC / 13:12 ET  – Reports of users being logged out of the different client apps start to surface.</p>



<p>18:39 UTC / 13:39 ET – Remediations were being put in place to restore the affected systems</p>



<p>20:35 UTC / 15:35 ET – Incident fully mitigated at Spotify</p>



<h2>Where do we go from here?</h2>



<p>In the short term:</p>



<ul><li>We are working with Google Cloud to better understand how issues with Traffic Director resulted in a large outage affecting Spotify’s users.</li><li>We will add additional monitoring and alerting to ensure that we would catch similar service discovery related problems earlier.</li></ul>



<p>We will continue to invest in resiliency by identifying and implementing additional safety nets in terms of monitoring, automatic error detection, and self-recovery.</p>
        </div>
    


</article>
                <!-- /article -->

            
        
    </section>
    <!-- /section -->

    
</div></div>
  </body>
</html>
