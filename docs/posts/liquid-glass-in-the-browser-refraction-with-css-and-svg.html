<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://kube.io/blog/liquid-glass-css-svg/">Original</a>
    <h1>Liquid Glass in the Browser: Refraction with CSS and SVG</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><p><a href="https://unsplash.com/photos/a-black-and-pink-abstract-background-with-curves-wRuhOOaG-Z4" target="_blank" rel="noopener noreferrer">Photo by Martin Martz on Unsplash</a></p></div></div>

<p>Apple <a href="https://www.youtube.com/watch?v=jGztGfRujSE">introduced the Liquid Glass effect during WWDC 2025</a> in June—a stunning UI effect that makes interface elements appear to be made of curved, refractive glass. This article is a hands‑on exploration of how to recreate a similar effect on the web using CSS, SVG displacement maps, and physics-based refraction calculations.</p>
<p>Instead of chasing pixel‑perfect parity, we’ll approximate Liquid Glass, recreating the core refraction and a specular highlight, as a focused proof‑of‑concept you can extend.</p>
<p>We&#39;ll build up the effect from first principles, starting with how light bends when passing through different materials.</p>
<div><div><div><div><p>Chrome‑only demo</p><p>The interactive demo at the end currently works in Chrome only (due to
SVG filters as backdrop‑filter).</p><p>You can still read the article and interact with the inline
simulations in other browsers.</p></div></div></div></div>

<p><strong>Refraction</strong> is what happens when light changes direction as it passes from one material to another (like from air into glass). This bending occurs because light travels at different speeds through different materials.</p>
<p>The relationship between the incoming and outgoing light angles is described by <a href="https://en.wikipedia.org/wiki/Snell%27s_law"><strong>Snell–Descartes law</strong></a>:</p>
<p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n_1 \sin(\theta_1) = n_2 \sin(\theta_2)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>sin</span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>sin</span><span>(</span><span><span>θ</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span>)</span></span></span></span></p>
<div><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mtext>refractive index of first medium</mtext></mrow><annotation encoding="application/x-tex">n_1 = \text{refractive index of first medium}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>refractive index of first medium</span></span></span></span></span></p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>1</mn></msub><mo>=</mo><mtext>angle of incidence</mtext></mrow><annotation encoding="application/x-tex">\theta_1 = \text{angle of incidence}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>θ</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>angle of incidence</span></span></span></span></span></p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mtext>refractive index of second medium</mtext></mrow><annotation encoding="application/x-tex">n_2 = \text{refractive index of second medium}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>refractive index of second medium</span></span></span></span></span></p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mn>2</mn></msub><mo>=</mo><mtext>angle of refraction</mtext></mrow><annotation encoding="application/x-tex">\theta_2 = \text{angle of refraction}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>θ</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>angle of refraction</span></span></span></span></span></p></div>
<div><div><svg viewBox="0 0 400 300"><defs><marker id="ray-arrow-incident" viewBox="0 0 10 10" refX="7" refY="5" markerWidth="4" markerHeight="4" orient="auto" markerUnits="strokeWidth"><path d="M 0 0 L 10 5 L 0 10 z" fill="hsl(180,76%,45%)"></path></marker><marker id="ray-arrow-refracted" viewBox="0 0 10 10" refX="7" refY="5" markerWidth="4" markerHeight="4" orient="auto" markerUnits="strokeWidth"><path d="M 0 0 L 10 5 L 0 10 z" fill="hsl(235.68675471715676,76%,45%)"></path></marker></defs><line x1="0" y1="150" x2="400" y2="150" stroke-width="1.5"></line><line x1="200" y1="0" x2="200" y2="300" opacity="0.6" stroke-width="1" stroke-dasharray="2"></line><path d="M 200 90 A 60 60 0 0 1 200 90" fill="none" stroke-width="1"></path><path d="M 200 90 A 60 60 0 0 0 200 90" display="none" fill="none" stroke-width="1"></path><text opacity="0" x="200" y="75" dominant-baseline="central" text-anchor="middle" font-size="10">θ<tspan baseline-shift="sub" font-size="70%">1</tspan></text><text opacity="0" x="200" y="75" dominant-baseline="central" text-anchor="middle" font-size="10" display="none">θ<tspan baseline-shift="sub" font-size="70%">1</tspan></text><path d="M 200 210 A 60 60 0 0 1 200 210" fill="none" display="block" stroke-width="1"></path><text opacity="0" x="200" y="225" display="block" dominant-baseline="central" text-anchor="middle" font-size="10">θ<tspan baseline-shift="sub" font-size="70%">2</tspan></text><line opacity="0" marker-end="url(#ray-arrow-incident)" x1="338.58192987669304" y1="92.59748514523653" x2="338.58192987669304" y2="92.59748514523653" stroke="hsl(180,76%,45%)" stroke-width="2"></line><line opacity="0" marker-end="url(#ray-arrow-refracted)" x1="200" y1="150" x2="200" y2="150" stroke="hsl(235.68675471715676,76%,45%)" stroke-width="2"></line><line x1="200" y1="150" x2="200" y2="150" stroke-width="1" stroke-dasharray="2"></line></svg><div><div><p>First Medium</p><div><p><span>n<span>1</span></span></p><!-- --><p>= <span>1</span></p></div></div><div><p>Second Medium</p><div><p><span>n<span>2</span></span></p><!-- --><p>=</p><!-- --> <p><span>1.5</span></p></div></div><p>Normal</p></div></div><div><div><div><p><span>0.01</span><span>3</span></p></div><p><span>n<span>2</span></span><span>1.5</span></p></div></div></div>
<p>In the above interactive diagram, you can see that:</p>
<ul>
<li>
<p>When <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_2 = n_1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, the light ray passes straight through without bending.</p>
</li>
<li>
<p>When <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>&gt;</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_2 &gt; n_1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>&gt;</span><span></span></span><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, the ray bends toward the normal (the imaginary line perpendicular to the surface).</p>
</li>
<li>
<p>When <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>&lt;</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">n_2 &lt; n_1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>&lt;</span><span></span></span><span><span></span><span><span>n</span><span><span><span><span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span>, the ray bends away from the normal, and depending on the angle of incidence, it may bend so much that it reflects back into the original medium instead of passing through.</p>
<p>This is called <a href="https://en.wikipedia.org/wiki/Total_internal_reflection">Total Internal Reflection</a></p>
</li>
<li>
<p>When incident ray is orthogonal to the surface, it passes straight through regardless of refractive indices.</p>
</li>
</ul>
<h2 id="limitations-in-this-project"><a href="#limitations-in-this-project" aria-label="Permalink">#</a>Limitations in this project</h2>
<p>To keep things focused we avoid complex branches of behavior by constraining the scenario:</p>
<ul>
<li>
<p>Ambient medium has <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">index = 1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>in</span><span>d</span><span>e</span><span>x</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span> (air).</p>
</li>
<li>
<p>Use materials with <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">index &gt; 1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>in</span><span>d</span><span>e</span><span>x</span><span></span><span>&gt;</span><span></span></span><span><span></span><span>1</span></span></span></span>, and prefer <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.5</mn></mrow><annotation encoding="application/x-tex">1.5</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1.5</span></span></span></span> (glass).</p>
</li>
<li>
<p>Only one refraction event (ignore any later exit / second refraction).</p>
</li>
<li>
<p>Incident rays are always orthogonal to the background plane (no perspective).</p>
</li>
<li>
<p>Objects are 2D shapes parallel to the background (no perspective).</p>
</li>
<li>
<p>No gap between objects and background plane (only one refraction).</p>
</li>
<li>
<p>Circle shapes only in this article:</p>
<p>Extending to other shapes requires preliminary calculations.</p>
<p>Circles let us form rounded rectangles by stretching the middle.</p>
</li>
</ul>
<p>Under these assumptions every ray we manipulate has a well-defined refracted direction via Snell&#39;s Law, and we simplify a lot our calculations.</p>

<p>To create our glass effect, we need to define the shape of our virtual glass surface. Think of this like describing the cross-section of a lens or curved glass panel.</p>
<h2 id="surface-function"><a href="#surface-function" aria-label="Permalink">#</a>Surface Function</h2>
<p>Our glass surface is described by a mathematical function that defines how thick the glass is at any point from its edge to the end of the bezel. This <strong>surface function</strong> takes a value between <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>0</span></span></span></span> (at the outer edge) and <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span></span></span></span> (end of bezel, start of flat surface) and returns the height of the glass at that point.</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="ts" data-theme=""><span data-line=""><span>const</span><span> height</span><span> =</span><span> f</span><span>(</span><span>distanceFromSide</span><span>);</span></span></code></pre></figure>
<p>From the height we can calculate the angle of incidence, which is the angle between the incoming ray and the normal to the surface at that point. The normal is simply the derivative of the height function at that point, rotated by <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>90</mn></mrow><annotation encoding="application/x-tex">-90</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>−</span><span>90</span></span></span></span> degrees:</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="ts" data-theme=""><span data-line=""><span>const</span><span> delta</span><span> =</span><span> 0.001</span><span>; </span><span>// Small value to approximate derivative</span></span>
<span data-line=""><span>const</span><span> y1</span><span> =</span><span> f</span><span>(</span><span>distanceFromSide</span><span> -</span><span> delta</span><span>);</span></span>
<span data-line=""><span>const</span><span> y2</span><span> =</span><span> f</span><span>(</span><span>distanceFromSide</span><span> +</span><span> delta</span><span>);</span></span>
<span data-line=""><span>const</span><span> derivative</span><span> =</span><span> (</span><span>y2</span><span> -</span><span> y1</span><span>) </span><span>/</span><span> (</span><span>2</span><span> *</span><span> delta</span><span>);</span></span>
<span data-line=""><span>const</span><span> normal</span><span> =</span><span> { x: </span><span>-</span><span>derivative</span><span>, y: </span><span>1</span><span> }; </span><span>// Derivative, rotated by -90 degrees</span></span></code></pre></figure>
<h2 id="equations"><a href="#equations" aria-label="Permalink">#</a>Equations</h2>
<p>For this article, we will use four different height functions to demonstrate the effect of the surface shape on the refraction:</p>
<div><svg viewBox="0 0 128 128"><rect x="0.5" y="0.5" width="127" height="127" rx="6"></rect><path d="M 11.00 117.00 L 12.10 101.74 L 13.21 95.48 L 14.31 90.71 L 15.42 86.72 L 16.52 83.24 L 17.63 80.11 L 18.73 77.27 L 19.83 74.64 L 20.94 72.19 L 22.04 69.89 L 23.15 67.73 L 24.25 65.68 L 25.35 63.74 L 26.46 61.88 L 27.56 60.11 L 28.67 58.41 L 29.77 56.77 L 30.88 55.21 L 31.98 53.70 L 33.08 52.24 L 34.19 50.83 L 35.29 49.47 L 36.40 48.16 L 37.50 46.89 L 38.60 45.66 L 39.71 44.46 L 40.81 43.30 L 41.92 42.18 L 43.02 41.09 L 44.13 40.02 L 45.23 38.99 L 46.33 37.99 L 47.44 37.02 L 48.54 36.07 L 49.65 35.15 L 50.75 34.25 L 51.85 33.38 L 52.96 32.53 L 54.06 31.71 L 55.17 30.90 L 56.27 30.12 L 57.38 29.36 L 58.48 28.62 L 59.58 27.90 L 60.69 27.20 L 61.79 26.51 L 62.90 25.85 L 64.00 25.20 L 65.10 24.57 L 66.21 23.96 L 67.31 23.37 L 68.42 22.79 L 69.52 22.23 L 70.63 21.68 L 71.73 21.15 L 72.83 20.64 L 73.94 20.14 L 75.04 19.66 L 76.15 19.19 L 77.25 18.74 L 78.35 18.30 L 79.46 17.87 L 80.56 17.46 L 81.67 17.06 L 82.77 16.68 L 83.88 16.31 L 84.98 15.95 L 86.08 15.61 L 87.19 15.28 L 88.29 14.96 L 89.40 14.66 L 90.50 14.37 L 91.60 14.09 L 92.71 13.82 L 93.81 13.57 L 94.92 13.33 L 96.02 13.10 L 97.13 12.88 L 98.23 12.68 L 99.33 12.48 L 100.44 12.30 L 101.54 12.13 L 102.65 11.98 L 103.75 11.83 L 104.85 11.70 L 105.96 11.58 L 107.06 11.47 L 108.17 11.37 L 109.27 11.28 L 110.38 11.21 L 111.48 11.14 L 112.58 11.09 L 113.69 11.05 L 114.79 11.02 L 115.90 11.01 L 117.00 11.00" stroke-width="2.5" fill="none"></path></svg><div><p>Convex Circle</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msqrt><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">y = \sqrt{(1 - (1 - x)) ^ 2}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span></span><span><span>(</span><span>1</span><span></span><span>−</span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span><span>x</span><span>)</span><span><span>)</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></p><p>Simple circular arc → a spherical dome. Easier than the squircle, but the
transition to the flat interior is harsher, producing sharper refraction
edges—more noticeable when the shape is stretched away from a true circle.</p></div><svg viewBox="0 0 128 128"><rect x="0.5" y="0.5" width="127" height="127" rx="6"></rect><path d="M 11.00 117.00 L 12.10 69.30 L 13.21 60.49 L 14.31 54.71 L 15.42 50.33 L 16.52 46.78 L 17.63 43.79 L 18.73 41.21 L 19.83 38.95 L 20.94 36.94 L 22.04 35.12 L 23.15 33.48 L 24.25 31.98 L 25.35 30.61 L 26.46 29.34 L 27.56 28.17 L 28.67 27.08 L 29.77 26.07 L 30.88 25.13 L 31.98 24.25 L 33.08 23.43 L 34.19 22.66 L 35.29 21.93 L 36.40 21.25 L 37.50 20.62 L 38.60 20.01 L 39.71 19.45 L 40.81 18.92 L 41.92 18.41 L 43.02 17.94 L 44.13 17.49 L 45.23 17.07 L 46.33 16.67 L 47.44 16.30 L 48.54 15.95 L 49.65 15.61 L 50.75 15.30 L 51.85 15.00 L 52.96 14.72 L 54.06 14.46 L 55.17 14.21 L 56.27 13.98 L 57.38 13.76 L 58.48 13.55 L 59.58 13.36 L 60.69 13.18 L 61.79 13.01 L 62.90 12.85 L 64.00 12.70 L 65.10 12.56 L 66.21 12.43 L 67.31 12.30 L 68.42 12.19 L 69.52 12.08 L 70.63 11.98 L 71.73 11.89 L 72.83 11.81 L 73.94 11.73 L 75.04 11.66 L 76.15 11.59 L 77.25 11.53 L 78.35 11.47 L 79.46 11.42 L 80.56 11.37 L 81.67 11.33 L 82.77 11.29 L 83.88 11.25 L 84.98 11.22 L 86.08 11.19 L 87.19 11.17 L 88.29 11.14 L 89.40 11.12 L 90.50 11.10 L 91.60 11.09 L 92.71 11.07 L 93.81 11.06 L 94.92 11.05 L 96.02 11.04 L 97.13 11.03 L 98.23 11.03 L 99.33 11.02 L 100.44 11.02 L 101.54 11.01 L 102.65 11.01 L 103.75 11.01 L 104.85 11.00 L 105.96 11.00 L 107.06 11.00 L 108.17 11.00 L 109.27 11.00 L 110.38 11.00 L 111.48 11.00 L 112.58 11.00 L 113.69 11.00 L 114.79 11.00 L 115.90 11.00 L 117.00 11.00" stroke-width="2.5" fill="none"></path></svg><div><p>Convex Squircle</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mroot><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>4</mn></msup></mrow><mn>4</mn></mroot></mrow><annotation encoding="application/x-tex">y = \sqrt[4]{(1 - (1 - x)) ^ 4}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span></span><span><span><span>4</span></span></span></span></span></span></span></span><span><span><span><span><span></span><span><span>(</span><span>1</span><span></span><span>−</span><span></span><span>(</span><span>1</span><span></span><span>−</span><span></span><span>x</span><span>)</span><span><span>)</span><span><span><span><span><span><span></span><span><span>4</span></span></span></span></span></span></span></span></span></span><span><span></span><span><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></p><p>Uses the <a href="https://en.wikipedia.org/wiki/Squircle">Squircle</a> Apple favors: a
softer flat→curve transition that keeps refraction gradients smooth even
when stretched into rectangles—no harsh interior edges. It also makes the
bezel appear optically thinner than its physical size because the flatter
outer zones bend light less.</p></div><svg viewBox="0 0 128 128"><rect x="0.5" y="0.5" width="127" height="127" rx="6"></rect><path d="M 11.00 11.00 L 12.10 26.26 L 13.21 32.52 L 14.31 37.29 L 15.42 41.28 L 16.52 44.76 L 17.63 47.89 L 18.73 50.73 L 19.83 53.36 L 20.94 55.81 L 22.04 58.11 L 23.15 60.27 L 24.25 62.32 L 25.35 64.26 L 26.46 66.12 L 27.56 67.89 L 28.67 69.59 L 29.77 71.23 L 30.88 72.79 L 31.98 74.30 L 33.08 75.76 L 34.19 77.17 L 35.29 78.53 L 36.40 79.84 L 37.50 81.11 L 38.60 82.34 L 39.71 83.54 L 40.81 84.70 L 41.92 85.82 L 43.02 86.91 L 44.13 87.98 L 45.23 89.01 L 46.33 90.01 L 47.44 90.98 L 48.54 91.93 L 49.65 92.85 L 50.75 93.75 L 51.85 94.62 L 52.96 95.47 L 54.06 96.29 L 55.17 97.10 L 56.27 97.88 L 57.38 98.64 L 58.48 99.38 L 59.58 100.10 L 60.69 100.80 L 61.79 101.49 L 62.90 102.15 L 64.00 102.80 L 65.10 103.43 L 66.21 104.04 L 67.31 104.63 L 68.42 105.21 L 69.52 105.77 L 70.63 106.32 L 71.73 106.85 L 72.83 107.36 L 73.94 107.86 L 75.04 108.34 L 76.15 108.81 L 77.25 109.26 L 78.35 109.70 L 79.46 110.13 L 80.56 110.54 L 81.67 110.94 L 82.77 111.32 L 83.88 111.69 L 84.98 112.05 L 86.08 112.39 L 87.19 112.72 L 88.29 113.04 L 89.40 113.34 L 90.50 113.63 L 91.60 113.91 L 92.71 114.18 L 93.81 114.43 L 94.92 114.67 L 96.02 114.90 L 97.13 115.12 L 98.23 115.32 L 99.33 115.52 L 100.44 115.70 L 101.54 115.87 L 102.65 116.02 L 103.75 116.17 L 104.85 116.30 L 105.96 116.42 L 107.06 116.53 L 108.17 116.63 L 109.27 116.72 L 110.38 116.79 L 111.48 116.86 L 112.58 116.91 L 113.69 116.95 L 114.79 116.98 L 115.90 116.99 L 117.00 117.00" stroke-width="2.5" fill="none"></path></svg><div><p>Concave</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>−</mo><mtext>Convex</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = 1 - \text{Convex}(x)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>−</span><span></span></span><span><span></span><span><span>Convex</span></span><span>(</span><span>x</span><span>)</span></span></span></span></p><p>The concave surface is the complement of the convex function, creating a
bowl-like depression. This surface causes light rays to diverge outward,
displacing them beyond the glass boundaries.</p></div><svg viewBox="0 0 128 128"><rect x="0.5" y="0.5" width="127" height="127" rx="6"></rect><path d="M 11.00 117.00 L 12.10 60.49 L 13.21 50.32 L 14.31 43.79 L 15.42 38.95 L 16.52 35.12 L 17.63 31.99 L 18.73 29.38 L 19.83 27.16 L 20.94 25.28 L 22.04 23.66 L 23.15 22.28 L 24.25 21.12 L 25.35 20.14 L 26.46 19.33 L 27.56 18.68 L 28.67 18.18 L 29.77 17.81 L 30.88 17.59 L 31.98 17.48 L 33.08 17.50 L 34.19 17.63 L 35.29 17.88 L 36.40 18.23 L 37.50 18.68 L 38.60 19.24 L 39.71 19.89 L 40.81 20.63 L 41.92 21.46 L 43.02 22.38 L 44.13 23.38 L 45.23 24.46 L 46.33 25.62 L 47.44 26.85 L 48.54 28.14 L 49.65 29.51 L 50.75 30.93 L 51.85 32.41 L 52.96 33.95 L 54.06 35.54 L 55.17 37.18 L 56.27 38.87 L 57.38 40.59 L 58.48 42.35 L 59.58 44.15 L 60.69 45.97 L 61.79 47.83 L 62.90 49.70 L 64.00 51.60 L 65.10 53.51 L 66.21 55.44 L 67.31 57.37 L 68.42 59.31 L 69.52 61.25 L 70.63 63.19 L 71.73 65.12 L 72.83 67.04 L 73.94 68.95 L 75.04 70.84 L 76.15 72.72 L 77.25 74.57 L 78.35 76.39 L 79.46 78.18 L 80.56 79.94 L 81.67 81.66 L 82.77 83.34 L 83.88 84.97 L 84.98 86.56 L 86.08 88.09 L 87.19 89.58 L 88.29 91.00 L 89.40 92.37 L 90.50 93.68 L 91.60 94.93 L 92.71 96.11 L 93.81 97.23 L 94.92 98.28 L 96.02 99.26 L 97.13 100.17 L 98.23 101.01 L 99.33 101.79 L 100.44 102.49 L 101.54 103.13 L 102.65 103.70 L 103.75 104.20 L 104.85 104.65 L 105.96 105.03 L 107.06 105.36 L 108.17 105.63 L 109.27 105.85 L 110.38 106.03 L 111.48 106.16 L 112.58 106.26 L 113.69 106.33 L 114.79 106.37 L 115.90 106.39 L 117.00 106.40" stroke-width="2.5" fill="none"></path></svg><div><p>Lip</p><p><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mtext>mix</mtext><mo stretchy="false">(</mo><mtext>Convex</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>Concave</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mtext>Smootherstep</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = \text{mix}(\text{Convex}(x), \text{Concave}(x), \text{Smootherstep}(x))</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span><span>mix</span></span><span>(</span><span><span>Convex</span></span><span>(</span><span>x</span><span>)</span><span>,</span><span></span><span><span>Concave</span></span><span>(</span><span>x</span><span>)</span><span>,</span><span></span><span><span>Smootherstep</span></span><span>(</span><span>x</span><span>))</span></span></span></span></p><p>Blends convex and concave via <a href="https://en.wikipedia.org/wiki/Smoothstep">Smootherstep</a>: raised rim, shallow center dip.</p></div></div>
<p>We could make the surface function more complex by adding more parameters, but these four already give a good idea of how the surface shape affects the refraction.</p>
<h2 id="simulation"><a href="#simulation" aria-label="Permalink">#</a>Simulation</h2>
<p>Now let&#39;s see these surface functions in action through interactive ray tracing simulations. The following visualization demonstrates how light rays behave differently as they pass through each surface type, helping us understand the practical implications of our mathematical choices.</p>
<div><svg viewBox="0 0 540 300" xmlns="http://www.w3.org/2000/svg"><defs><marker id="arrow-displacement-vector" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(180,76%,45%)"></path></marker></defs><path d="M 70 260

L 70 180 L 71.9047619047619 158.70411450000205 L 73.80952380952381 150.00377952757404 L 75.71428571428571 143.41071864324084 L 77.61904761904762 137.92243422023898 L 79.52380952380952 133.14905190000442 L 81.42857142857143 128.8898748000048 L 83.33333333333333 125.02525832509787 L 85.23809523809524 121.47698477814396 L 87.14285714285714 118.19054956347449 L 89.04761904761905 115.12614717742323 L 90.95238095238095 112.25364097608099 L 92.85714285714286 109.54955425178312 L 94.76190476190476 106.99516991719315 L 96.66666666666666 104.57527667343493 L 98.57142857142857 102.27731137865459 L 100.47619047619048 100.09075442513131 L 102.38095238095238 98.00669238083472 L 104.28571428571428 96.01749453314818 L 106.19047619047619 94.1165690087962 L 108.0952380952381 92.29817574688505 L 110 90.55728090000842 L 111.9047619047619 88.88944195732267 L 113.80952380952381 87.29071601037745 L 115.71428571428571 85.75758570016777 L 117.61904761904762 84.28689884646772 L 119.52380952380952 82.87581878870887 L 121.42857142857142 81.52178320220521 L 123.33333333333333 80.22246968602823 L 125.23809523809524 78.97576681008672 L 127.14285714285714 77.77974960000961 L 129.04761904761904 76.63265865740848 L 130.95238095238096 75.53288227960314 L 132.85714285714286 74.47894107074634 L 134.76190476190476 73.46947463535571 L 136.66666666666669 72.50323002268601 L 138.57142857142856 71.57905165136984 L 140.47619047619048 70.69587249216325 L 142.38095238095238 69.85270632532603 L 144.28571428571428 69.04864092029943 L 146.1904761904762 68.282832010551 L 148.0952380952381 67.5544979569871 L 150 66.86291501015239 L 151.90476190476193 66.20741309528498 L 153.8095238095238 65.58737205576224 L 155.71428571428572 65.00221830001081 L 157.61904761904762 64.45142180492876 L 159.52380952380952 63.934493435564775 L 161.42857142857142 63.45098254645063 L 163.33333333333331 63.00047483477171 L 165.23809523809524 62.58259041963855 L 167.14285714285714 62.196982125209686 L 169.04761904761904 61.84333394841278 L 170.95238095238096 61.521359694598196 L 172.85714285714283 61.23080176670556 L 174.76190476190476 60.971430095481956 L 176.66666666666666 60.74304120001122 L 178.57142857142856 60.54545736933217 L 180.47619047619048 60.37852595727557 L 182.38095238095238 60.24211878386172 L 184.28571428571428 60.13613163769697 L 186.1904761904762 60.060483874810174 L 188.09523809523807 60.015118110296214 L 190 60

L 350 60

L 350 60 L 351.9047619047619 60.015118110296214 L 353.8095238095238 60.060483874810174 L 355.7142857142857 60.13613163769697 L 357.6190476190476 60.24211878386172 L 359.5238095238095 60.37852595727557 L 361.42857142857144 60.54545736933217 L 363.33333333333337 60.74304120001122 L 365.23809523809524 60.971430095481956 L 367.1428571428571 61.23080176670556 L 369.04761904761904 61.521359694598196 L 370.95238095238096 61.84333394841278 L 372.8571428571429 62.196982125209686 L 374.76190476190476 62.58259041963855 L 376.6666666666667 63.00047483477171 L 378.57142857142856 63.45098254645063 L 380.4761904761905 63.934493435564775 L 382.3809523809524 64.45142180492876 L 384.2857142857143 65.00221830001081 L 386.1904761904762 65.58737205576224 L 388.0952380952381 66.20741309528498 L 390 66.86291501015239 L 391.9047619047619 67.5544979569871 L 393.8095238095238 68.282832010551 L 395.7142857142857 69.04864092029943 L 397.6190476190476 69.85270632532601 L 399.5238095238095 70.69587249216325 L 401.42857142857144 71.57905165136984 L 403.3333333333333 72.50323002268601 L 405.23809523809524 73.46947463535571 L 407.1428571428571 74.47894107074634 L 409.04761904761904 75.53288227960314 L 410.95238095238096 76.63265865740848 L 412.8571428571429 77.77974960000961 L 414.76190476190476 78.9757668100867 L 416.6666666666667 80.22246968602823 L 418.57142857142856 81.52178320220521 L 420.4761904761905 82.87581878870887 L 422.3809523809524 84.28689884646772 L 424.2857142857143 85.75758570016777 L 426.1904761904762 87.29071601037745 L 428.0952380952381 88.88944195732267 L 430 90.55728090000841 L 431.9047619047619 92.29817574688505 L 433.8095238095238 94.1165690087962 L 435.7142857142857 96.01749453314818 L 437.6190476190476 98.00669238083472 L 439.5238095238095 100.09075442513131 L 441.42857142857144 102.27731137865459 L 443.3333333333333 104.57527667343493 L 445.23809523809524 106.99516991719312 L 447.14285714285717 109.54955425178312 L 449.04761904761904 112.25364097608099 L 450.95238095238096 115.12614717742323 L 452.85714285714283 118.19054956347446 L 454.76190476190476 121.47698477814396 L 456.6666666666667 125.02525832509787 L 458.57142857142856 128.8898748000048 L 460.4761904761905 133.1490519000044 L 462.3809523809524 137.92243422023898 L 464.2857142857143 143.41071864324084 L 466.1904761904762 150.00377952757404 L 468.0952380952381 158.70411450000196 L 470 180

L 470 260" stroke-width="1.5"></path><text x="270" y="160" text-anchor="middle" dominant-baseline="middle">Glass</text><line x1="0" y1="260" x2="540" y2="260" stroke-width="1.5"></line><rect width="540" height="40" x="0" y="260" rx="4"></rect><text x="270" y="280" text-anchor="middle" dominant-baseline="middle">Background</text><line x1="-70" y1="0" x2="-70" y2="260" stroke="hsl(180,76%,45%)" stroke-width="3"></line><line x1="-70" y1="260" x2="0" y2="0" stroke="hsl(205.5,76%,45%)" stroke-width="3" display="none"></line><line x1="-70" y1="260" x2="-70" y2="260" stroke="hsl(180,76%,45%)" stroke-width="1" stroke-dasharray="3" stroke-opacity="0.5"></line><line x1="-70" y1="260" x2="0" y2="260" stroke="hsl(180,76%,45%)" stroke-width="0.3" marker-end="url(#arrow-displacement-vector)" display="none"></line></svg><div></div></div>
<p>From the simulation, we can see that concave surfaces push rays outside the glass; convex surfaces keep them inside.</p>
<p>We want to avoid outside displacement because it requires sampling background beyond the object. Apple’s Liquid Glass appears to favor convex profiles (except for the Switch component, covered later).</p>
<p>The background arrow indicates displacement—how far a ray lands compared to where it would have landed without glass. Color encodes magnitude (longer → more purple).</p>
<p>Take a look at symmetry: rays at the same distance from the border share the same displacement magnitude on each side. Compute once, reuse around the bezel/object.</p>

<p>Now that calculated the displacement at a distance from border, let&#39;s calculate the displacement vector field for the entire glass surface.</p>
<p>The vector field describes at every position on the glass surface how much the light ray is displaced from its original position, and in which direction. In a circle, this displacement is always orthogonal to the border.</p>
<h2 id="pre-calculating-the-displacement-magnitude"><a href="#pre-calculating-the-displacement-magnitude" aria-label="Permalink">#</a>Pre-calculating the displacement magnitude</h2>
<p>Because we saw that this displacement magnitude is symmetric around the bezel, we can pre-calculate it for a range of distances from the border, on a single radius.</p>
<p>This allows us to calculate everything in two dimensions once (x and z axis), on one &#34;half-slice&#34; of the object, and we will the rotate these pre-calculated displacements around the z-axis.</p>
<p>The actual number of samples we need to do on a radius is of 127 ray simulations, and is determined by the constraints of the SVG Displacement Map resolution. (See next section.)</p>
<div><svg viewBox="0 0 300 300" transform="translate(0, 0)"><defs><marker id="arrow-displacement-vector-field-0" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(227.378716298591,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-1" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(264.78483139942705,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-2" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(262.6916997528157,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-3" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(256.6028523872958,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-4" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(249.776587560678,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-5" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(241.56962876588273,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-6" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(232.95070652511396,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-7" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(224.89883332209467,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-8" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(215.89036868444225,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-9" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(206.7788407995772,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-10" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(198.43831469635012,88%,54%)"></path></marker><marker id="arrow-displacement-vector-field-11" viewBox="0 0 4 4" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L4,2 L0,4 Z" fill="hsl(189.22591034485822,88%,54%)"></path></marker><g id="radiusOfVectors"><line x1="15" y1="150" x2="18.01923192098864" y2="150" stroke="hsl(227.378716298591,88%,54%)" stroke-width="1.524615661037274" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-0)"></line><line x1="25.833333333333336" y1="150" x2="31.236288275453685" y2="150" stroke="hsl(264.78483139942705,88%,54%)" stroke-width="2.096709186108884" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-1)"></line><line x1="36.66666666666667" y1="150" x2="41.93623576856179" y2="150" stroke="hsl(262.6916997528157,88%,54%)" stroke-width="2.064696584454828" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-2)"></line><line x1="47.5" y1="150" x2="52.381554318798266" y2="150" stroke="hsl(256.6028523872958,88%,54%)" stroke-width="1.971573036511583" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-3)"></line><line x1="58.333333333333336" y1="150" x2="62.77988057984713" y2="150" stroke="hsl(249.776587560678,88%,54%)" stroke-width="1.8671713391633105" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-4)"></line><line x1="69.16666666666667" y1="150" x2="73.09022144096312" y2="150" stroke="hsl(241.56962876588273,88%,54%)" stroke-width="1.741653145831148" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-5)"></line><line x1="80" y1="150" x2="83.37430972954158" y2="150" stroke="hsl(232.95070652511396,88%,54%)" stroke-width="1.6098343350899784" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-6)"></line><line x1="90.83333333333334" y1="150" x2="93.69453349601585" y2="150" stroke="hsl(224.89883332209467,88%,54%)" stroke-width="1.486688039043801" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-7)"></line><line x1="101.66666666666667" y1="150" x2="103.95379800440074" y2="150" stroke="hsl(215.89036868444225,88%,54%)" stroke-width="1.3489115210561755" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-8)"></line><line x1="112.5" y1="150" x2="114.20649475683581" y2="150" stroke="hsl(206.7788407995772,88%,54%)" stroke-width="1.2095587416405926" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-9)"></line><line x1="123.33333333333334" y1="150" x2="124.50832397574781" y2="150" stroke="hsl(198.43831469635012,88%,54%)" stroke-width="1.0819977541794725" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-10)"></line><line x1="134.16666666666669" y1="150" x2="134.75459232589785" y2="150" stroke="hsl(189.22591034485822,88%,54%)" stroke-width="0.9411021582154788" display="block" stroke-linecap="round" marker-end="url(#arrow-displacement-vector-field-11)"></line></g></defs><g style="transform-origin:50% 50%;transform-box:view-box;transform:none"><circle cx="150" cy="150" r="135" fill="none" stroke-width="1"></circle><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:none"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.14279966607226333rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.28559933214452665rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.42839899821678995rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.5711986642890533rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.7139983303613165rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.8567979964335799rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(0.9995976625058433rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.1423973285781066rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.28519699465037rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.427996660722633rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.5707963267948966rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.7135959928671598rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.8563956589394233rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(1.9991953250116865rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.1419949910839495rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.284794657156213rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.4275943232284765rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.57039398930074rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.7131936553730034rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.855993321445266rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(2.99879298751753rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.141592653589793rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.2843923196620564rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.4271919857343196rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.5699916518065833rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.7127913178788465rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.8555909839511098rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(3.998390650023373rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.141190316095636rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.283989982167899rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.426789648240163rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.569589314312426rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.71238898038469rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.855188646456953rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(4.997988312529216rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.14078797860148rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.2835876446737435rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.426387310746007rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.569186976818269rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.711986642890532rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.854786308962796rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(5.99758597503506rad)"></use><use href="#radiusOfVectors" display="block" style="transform-origin:50% 50%;transform-box:view-box;transform:rotate(6.140385641107323rad)"></use></g><g style="transform-origin:50% 50%;transform-box:view-box;transform:rotateX(-90deg) rotateY(-360deg)"><path d="
      M 15 150

      L 15 150 L 17.03125 127.10897504615619 L 19.0625 117.7549058964003 L 21.09375 110.66501289008093 L 23.125 104.76191455200608 L 25.15625 99.6266381314737 L 27.1875 95.04351863747098 L 29.21875 90.88399414340056 L 31.25 87.06402062412948 L 33.28125 83.52503555143862 L 35.3125 80.22427109839698 L 37.34375 77.12934859672585 L 39.375 74.21504519365337 L 41.40625 71.46125185020136 L 43.4375 68.8516260560324 L 45.46875 66.37267029590447 L 47.5 64.0130823904008 L 49.53125 61.76328556979527 L 51.5625 59.6150809385216 L 53.59375 57.561385444515125 L 55.625 55.59603093619421 L 57.65625 53.71360773225793 L 59.6875 51.9093412003467 L 61.71875 50.178993200641884 L 63.75 48.51878252602603 L 65.78125 46.92532004203214 L 67.8125 45.395555334632164 L 69.84375 43.92673246318137 L 71.875 42.516352988001 L 73.90625 41.16214486247213 L 75.9375 39.86203609222659 L 77.96875 38.614132299301545 L 80 37.41669750802298 L 82.03125 36.26813760674847 L 84.0625 35.166986046041615 L 86.09375 34.111891417033206 L 88.125 33.10160661925245 L 90.15625 32.13497937921744 L 92.1875 31.21094392264075 L 94.21875 30.328513636549587 L 96.25 29.486774584695482 L 98.28125 28.684879761682225 L 100.3125 27.922043989301656 L 102.34375 27.197539373441302 L 104.375 26.51069125223836 L 106.40625 25.860874576395133 L 108.4375 25.24751067112929 L 110.46875 24.670064336418406 L 112.5 24.128041248258953 L 114.53125 23.620985628793974 L 116.5625 23.148478157532537 L 118.59375 22.71013409961695 L 120.625 22.305601630298597 L 122.65625 21.93456033754657 L 124.6875 21.59671988710724 L 126.71875 21.291818836417804 L 128.75 21.01962358560121 L 130.78125 20.779927455377504 L 132.8125 20.572549883148838 L 134.84375 20.397335729787187 L 136.875 20.254154690795588 L 138.90625 20.142900806550045 L 140.9375 20.063492067279242 L 142.96875 20.01587010931874

      L 150 20
      L 150 150
      Z" stroke-width="1"></path><line x1="15" y1="0" x2="15" y2="150" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="150" stroke-dashoffset="-150" opacity="1"></line><line x1="25.833333333333336" y1="0" x2="25.833333333333336" y2="98.04515849744553" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="98.04515849744553" stroke-dashoffset="-98.04515849744553" opacity="1"></line><line x1="36.66666666666667" y1="0" x2="36.66666666666667" y2="78.13979620896635" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="78.13979620896635" stroke-dashoffset="-78.13979620896635" opacity="1"></line><line x1="47.5" y1="0" x2="47.5" y2="64.0130823904008" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="64.0130823904008" stroke-dashoffset="-64.0130823904008" opacity="1"></line><line x1="58.333333333333336" y1="0" x2="58.333333333333336" y2="53.103720975009125" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="53.103720975009125" stroke-dashoffset="-53.103720975009125" opacity="1"></line><line x1="69.16666666666667" y1="0" x2="69.16666666666667" y2="44.40972793123622" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="44.40972793123622" stroke-dashoffset="-44.40972793123622" opacity="1"></line><line x1="80" y1="0" x2="80" y2="37.41669750802298" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="37.41669750802298" stroke-dashoffset="-37.41669750802298" opacity="1"></line><line x1="90.83333333333334" y1="0" x2="90.83333333333334" y2="31.822285424779764" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="31.822285424779764" stroke-dashoffset="-31.822285424779764" opacity="1"></line><line x1="101.66666666666667" y1="0" x2="101.66666666666667" y2="27.434824594331758" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="27.434824594331758" stroke-dashoffset="-27.434824594331758" opacity="1"></line><line x1="112.5" y1="0" x2="112.5" y2="24.128041248258953" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="24.128041248258953" stroke-dashoffset="-24.128041248258953" opacity="1"></line><line x1="123.33333333333334" y1="0" x2="123.33333333333334" y2="21.818271366174997" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="21.818271366174997" stroke-dashoffset="-21.818271366174997" opacity="1"></line><line x1="134.16666666666669" y1="0" x2="134.16666666666669" y2="20.452175283068186" stroke="hsl(180,88%,54%)" display="block" stroke-width="1" stroke-dasharray="20.452175283068186" stroke-dashoffset="-20.452175283068186" opacity="1"></line></g><g style="transform-origin:50% 50%;transform-box:view-box;transform:rotateX(-90deg) rotateY(-360deg)"><use href="#radiusOfVectors" style="transform-origin:150px 150px;transform-box:view-box"></use></g></svg><div></div></div>
<h2 id="normalizing-vectors"><a href="#normalizing-vectors" aria-label="Permalink">#</a>Normalizing vectors</h2>
<p>In the above diagram, the arrows are all scaled down for visibility, so they do not overlap. This is normalization, and is also useful from a technical standpoint.</p>
<p>To use these vectors in a displacement map, we need to normalize them. Normalization means scaling the vectors so that their maximum magnitude is <span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>1</span></span></span></span>, which allows us to represent them in a fixed range.</p>
<p>So we calculate the maximum displacement magnitude in our pre-calculated array:</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="ts" data-theme=""><span data-line=""><span>const</span><span> maximumDisplacement</span><span> =</span><span> Math</span><span>.</span><span>max</span><span>(</span><span>...</span><span>displacementMagnitudes</span><span>);</span></span></code></pre></figure>
<p>And we divide each vector&#39;s magnitude by this maximum:</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="ts" data-theme=""><span data-line=""><span>displacementVector_normalized</span><span> =</span><span> {</span></span>
<span data-line=""><span>  angle: </span><span>normalAtBorder</span><span>,</span></span>
<span data-line=""><span>  magnitude: </span><span>magnitude</span><span> /</span><span> maximumDisplacement</span><span>,</span></span>
<span data-line=""><span>};</span></span></code></pre></figure>
<p>We store <code>maximumDisplacement</code> as we will need it to re-scale the displacement map back to the actual magnitudes.</p>

<p>Now we need to translate our mathematical refraction calculations into something the browser can actually render. We&#39;ll use <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feDisplacementMap"><strong>SVG displacement maps</strong></a>.</p>
<p>A displacement map is simply an image where each pixel&#39;s color tells the browser how far it should find the actual pixel value from its current position.</p>
<p>SVG&#39;s <code>&lt;feDisplacementMap /&gt;</code> encodes these pixels in a 32 bit RGBA image, where each channel represents a different axis of displacement.</p>
<p>It&#39;s up to the user to define which channel corresponds to which axis, but it is important to understand the constraint:
Because each channel is 8 bits, the displacement is limited to a range of -128 to 127 pixels in each direction. (256 values possible in total).
128 is the neutral value, meaning no displacement.</p>
<p>SVG filters can only use images as displacement maps, so we need to convert our displacement vector field into an image format.</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="tsx" data-theme=""><span data-line=""><span>&lt;</span><span>svg</span><span> colorInterpolationFilters</span><span>=</span><span>&#34;sRGB&#34;</span><span>&gt;</span></span>
<span data-line=""><span>  &lt;</span><span>filter</span><span> id</span><span>=</span><span>{</span><span>id</span><span>}&gt;</span></span>
<span data-line=""><span>    &lt;</span><span>feImage</span></span>
<span data-line=""><span>      href</span><span>=</span><span>{</span><span>displacementMapDataUrl</span><span>}</span></span>
<span data-line=""><span>      x</span><span>=</span><span>{</span><span>0</span><span>}</span></span>
<span data-line=""><span>      y</span><span>=</span><span>{</span><span>0</span><span>}</span></span>
<span data-line=""><span>      width</span><span>=</span><span>{</span><span>width</span><span>}</span></span>
<span data-line=""><span>      height</span><span>=</span><span>{</span><span>height</span><span>}</span></span>
<span data-line=""><span>      result</span><span>=</span><span>&#34;displacement_map&#34;</span></span>
<span data-line=""><span>    /&gt;</span></span>
<span data-line=""><span>    &lt;</span><span>feDisplacementMap</span></span>
<span data-line=""><span>      in</span><span>=</span><span>&#34;SourceGraphic&#34;</span></span>
<span data-line=""><span>      in2</span><span>=</span><span>&#34;displacement_map&#34;</span></span>
<span data-line=""><span>      scale</span><span>=</span><span>{</span><span>scale</span><span>}</span></span>
<span data-line=""><span>      xChannelSelector</span><span>=</span><span>&#34;R&#34;</span><span> // Red Channel for displacement in X axis</span></span>
<span data-line=""><span>      yChannelSelector</span><span>=</span><span>&#34;G&#34;</span><span> // Green Channel for displacement in Y axis</span></span>
<span data-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  &lt;/</span><span>filter</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>svg</span><span>&gt;</span></span></code></pre></figure>
<p><code>&lt;feDisplacementMap /&gt;</code> uses the red channel for the X axis and the green channel for the Y axis. The blue and alpha channels are ignored.</p>
<h2 id="scale"><a href="#scale" aria-label="Permalink">#</a>Scale</h2>
<p>The Red (X) and Green (Y) channels are 8‑bit values (0–255). Interpreted without any extra scaling, they map linearly to a normalized displacement in [−1, 1], with 128 as the neutral value (no displacement):</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>↦</mo><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>128</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>↦</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>255</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>↦</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
0 &amp;\mapsto -1 \\
128 &amp;\mapsto 0 \\
255 &amp;\mapsto 1
\end{aligned}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>128</span></span></span><span><span></span><span><span>255</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>↦</span><span></span><span>−</span><span>1</span></span></span><span><span></span><span><span></span><span></span><span>↦</span><span></span><span>0</span></span></span><span><span></span><span><span></span><span></span><span>↦</span><span></span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>The <code>scale</code> attribute of <code>&lt;feDisplacementMap /&gt;</code> multiplies this normalized amount:</p>
<p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>↦</mo><mo>−</mo><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>128</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>↦</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mn>255</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>↦</mo><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
0 &amp;\mapsto -scale \\
128 &amp;\mapsto 0 \\
255 &amp;\mapsto scale
\end{aligned}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span>0</span></span></span><span><span></span><span><span>128</span></span></span><span><span></span><span><span>255</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>↦</span><span></span><span>−</span><span>sc</span><span>a</span><span>l</span><span>e</span></span></span><span><span></span><span><span></span><span></span><span>↦</span><span></span><span>0</span></span></span><span><span></span><span><span></span><span></span><span>↦</span><span></span><span>sc</span><span>a</span><span>l</span><span>e</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>Because our vectors are normalized using the maximum possible displacement (in pixels) as the unit, we can reuse that maximum directly as the filter’s <code>scale</code>:</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="tsx" data-theme=""><span data-line=""><span>&lt;</span><span>feDisplacementMap</span></span>
<span data-line=""><span>  in</span><span>=</span><span>&#34;SourceGraphic&#34;</span></span>
<span data-line=""><span>  in2</span><span>=</span><span>&#34;displacement_map&#34;</span></span>
<span data-line=""><span>  scale</span><span>=</span><span>{</span><span>maximumDisplacement</span><span>} </span><span>// max displacement (px) → real pixel shift</span></span>
<span data-line=""><span>  xChannelSelector</span><span>=</span><span>&#34;R&#34;</span></span>
<span data-line=""><span>  yChannelSelector</span><span>=</span><span>&#34;G&#34;</span></span>
<span data-line=""><span>/&gt;</span></span></code></pre></figure>
<p>You can also animate <code>scale</code> to fade the effect in/out—no need to recompute the map (useful for artistic control even if not physically exact).</p>
<h2 id="vector-to-red-green-values"><a href="#vector-to-red-green-values" aria-label="Permalink">#</a>Vector to Red-Green values</h2>
<p>To convert our displacement vector field into a displacement map, we need to convert each vector into a color value. The red channel will represent the X component of the vector, and the green channel will represent the Y component.</p>
<p>We currently have polar coordinates (angle and magnitude) for each vector, so we need to convert them to Cartesian coordinates (X and Y) before mapping them to the red and green channels.</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="tsx" data-theme=""><span data-line=""><span>const</span><span> x</span><span> =</span><span> Math</span><span>.</span><span>cos</span><span>(</span><span>angle</span><span>) </span><span>*</span><span> magnitude</span><span>;</span></span>
<span data-line=""><span>const</span><span> y</span><span> =</span><span> Math</span><span>.</span><span>sin</span><span>(</span><span>angle</span><span>) </span><span>*</span><span> magnitude</span><span>;</span></span></code></pre></figure>
<p>Because we normalised our vectors already, <code>magnitude</code> here is between 0 and 1.</p>
<p>From here, we just remap the values to the range of 0 to 255 for the red and green channels:</p>
<div><svg viewBox="0 0 300 300"><defs><marker id="arrow-vrg" markerWidth="4" markerHeight="4" refX="0" refY="2" orient="auto"><polygon points="0 0, 4 2, 0 4" fill="hsl(280,95%,45%)"></polygon></marker><marker id="dot-vrg" markerWidth="2" markerHeight="2" refX="1" refY="1" orient="auto"><circle cx="1" cy="1" r="1" fill="hsl(280,95%,45%)"></circle></marker></defs><g><circle cx="150" cy="150" r="130" fill="none" stroke-width="1"></circle><line x1="150" y1="150" x2="241.92388155425118" y2="241.92388155425118" stroke-width="5.5" marker-start="url(#dot-vrg)" marker-end="url(#arrow-vrg)" stroke="hsl(280,95%,45%)"></line></g></svg><div><div><div></div><div><p>Red: <span>218</span></p><p>X axis: <span>0.71</span></p><div></div></div><div></div><div><p>Green: <span>218</span></p><p>Y axis: <span>0.71</span></p><div></div></div><div></div><div><p>Result<span> (Blended)</span></p></div></div></div></div>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="tsx" data-theme=""><span data-line=""><span>const</span><span> result</span><span> =</span><span> {</span></span>
<span data-line=""><span>  r: </span><span>128</span><span> +</span><span> x</span><span> *</span><span> 127</span><span>, </span><span>// Red channel is the X component, remapped to 0-255</span></span>
<span data-line=""><span>  g: </span><span>128</span><span> +</span><span> y</span><span> *</span><span> 127</span><span>, </span><span>// Green channel is the Y component, remapped to 0-255</span></span>
<span data-line=""><span>  b: </span><span>128</span><span>, </span><span>// Blue channel is ignored</span></span>
<span data-line=""><span>  a: </span><span>255</span><span>, </span><span>// Alpha channel is fully opaque</span></span>
<span data-line=""><span>};</span></span></code></pre></figure>
<p>After converting every vector in the map to color value, we get an image that can be used as a displacement map in the SVG filter.</p>
<h2 id="playground"><a href="#playground" aria-label="Permalink">#</a>Playground</h2>
<p>This playground applies the SVG displacement filter to a simple scene and lets you tweak surface shape, bezel width, glass thickness, and effect scale. Watch how these inputs change the refraction field, the generated displacement map, and the final rendering.</p>
<div><div><div><h4>Surface</h4><div></div></div><div><h4>Controls</h4><p><label>Bezel Width</label><label>Glass Thickness</label><label>Scale Ratio</label></p></div></div><div><div><h4>Radius Simulation</h4></div><p><h4>Displacement Map</h4><canvas></canvas></p><div><h4>Radius Displacements</h4><p><svg viewBox="0 0 400 300" width="100%"><defs><marker id="axisArrow" viewBox="0 0 10 10" refX="6" refY="5" markerWidth="9" markerHeight="9" orient="auto" markerUnits="strokeWidth"><path d="M 0 0 L 10 5 L 0 10 z" fill="currentColor"></path></marker></defs><line x1="30" y1="150" x2="30" y2="54" stroke="hsl(180,76%,45%)" stroke-width="2" display="none"></line><path d="M 30 54 L 30.6640625 57.467760004536984 L 31.328125 59.252687334682776 L 31.9921875 60.59984009854942 L 32.65625 61.718879686856326 L 33.3203125 62.69257215272182 L 33.984375 63.563599081542364 L 34.6484375 64.35733995993945 L 35.3125 65.09031267306148 L 35.9765625 65.77396533890209 L 36.640625 66.41660971300496 L 37.3046875 67.02450044616165 L 37.96875 67.60248017115316 L 38.6328125 68.15438631459189 L 39.296875 68.68331898484263 L 39.9609375 69.19182378501989 L 40.625 69.68202036290049 L 41.2890625 70.15569514163764 L 41.953125 70.61436970153555 L 42.6171875 71.0593521841396 L 43.28125 71.49177659191744 L 43.9453125 71.91263328764727 L 44.609375 72.32279298282421 L 45.2734375 72.72302583323072 L 45.9375 73.11401680575177 L 46.6015625 73.4963781671121 L 47.265625 73.87065972535646 L 47.9296875 74.23735729788406 L 48.59375 74.59691976666745 L 49.2578125 74.9497549971586 L 49.921875 75.29623483662763 L 50.5859375 75.636699360267 L 51.25 75.9714604985858 L 51.9140625 76.3008051524072 L 52.578125 76.6249978809685 L 53.2421875 76.94428323233826 L 53.90625 77.2588877723605 L 54.5703125 77.56902185815275 L 55.234375 77.87488119464756 L 55.8984375 78.1766482051737 L 56.5625 78.47449324274896 L 57.2265625 78.76857566386134 L 57.890625 79.05904478345754 L 58.5546875 79.34604072647417 L 59.21875 79.62969518955997 L 59.8828125 79.91013212403797 L 60.546875 80.18746834978325 L 61.2109375 80.46181410842583 L 61.875 80.73327356309734 L 62.5390625 81.00194525058471 L 63.203125 81.26792249163334 L 63.8671875 81.53129376374865 L 64.53125 81.79214304078005 L 65.1953125 82.0505501026672 L 65.859375 82.30659081851009 L 66.5234375 82.56033740582741 L 67.1875 82.81185866825959 L 67.8515625 83.06122021384404 L 68.515625 83.30848465589482 L 69.1796875 83.55371179806289 L 69.84375 83.79695880493928 L 70.5078125 84.03828035984874 L 71.171875 84.27772881075555 L 71.8359375 84.51535430529046 L 72.5 84.75120491618073 L 73.1640625 84.98532675753444 L 73.828125 85.21776409313205 L 74.4921875 85.44855943701772 L 75.15625 85.67775364730196 L 75.8203125 85.90538601372677 L 76.484375 86.13149433926208 L 77.1484375 86.35611501661973 L 77.8125 86.57928309936057 L 78.4765625 86.8010323690408 L 79.140625 87.02139539785621 L 79.8046875 87.24040360725648 L 80.46875 87.45808732342519 L 81.1328125 87.67447582882147 L 81.796875 87.88959741123868 L 82.4609375 88.10347940968023 L 83.125 88.31614825743554 L 83.7890625 88.52762952300361 L 84.453125 88.73794794854317 L 85.1171875 88.94712748612707 L 85.78125 89.15519133200351 L 86.4453125 89.36216195921449 L 87.109375 89.56806114796368 L 87.7734375 89.77291001510918 L 88.4375 89.97672904107955 L 89.1015625 90.17953809641101 L 89.765625 90.38135646630062 L 90.4296875 90.58220287403597 L 91.09375 90.78209550337161 L 91.7578125 90.98105201961391 L 92.421875 91.17908958972944 L 93.0859375 91.37622490151023 L 93.75 91.57247418183522 L 94.4140625 91.76785321392785 L 95.078125 91.9623773539519 L 95.7421875 92.15606154654988 L 96.40625 92.34892034017156 L 97.0703125 92.54096790112337 L 97.734375 92.73221802735324 L 98.3984375 92.9226841614799 L 99.0625 93.11237940328292 L 99.7265625 93.30131652162315 L 100.390625 93.48950796571756 L 101.0546875 93.67696587620557 L 101.71875 93.86370209548 L 102.3828125 94.0497281776619 L 103.046875 94.23505539829765 L 103.7109375 94.41969476335197 L 104.375 94.60365701798776 L 105.0390625 94.78695265528262 L 105.703125 94.96959192389465 L 106.3671875 95.15158483607405 L 107.03125 95.33294117507097 L 107.6953125 95.51367050222012 L 108.359375 95.69378216385012 L 109.0234375 95.87328529778777 L 109.6875 96.0521888399077 L 110.3515625 96.23050153012451 L 111.015625 96.40823191813786 L 111.6796875 96.58538836913937 L 112.34375 96.76197906946766 L 113.0078125 96.93801203150524 L 113.671875 97.11349509890309 L 114.3359375 97.28843595145005 L 115 97.4628421096318 L 115.6640625 97.63672093926553 L 116.328125 97.81007965573852 L 116.9921875 97.98292532837513 L 117.65625 98.15526488421614 L 118.3203125 98.3271051121676 L 118.984375 98.49845266668648 L 119.6484375 98.66931407125506 L 120.3125 98.83969572225504 L 120.9765625 99.00960389202046 L 121.640625 99.17904473241055 L 122.3046875 99.34802427763998 L 122.96875 99.51654844772708 L 123.6328125 99.68462305103326 L 124.296875 99.85225378766376 L 124.9609375 100.01944625162753 L 125.625 100.1862059341588 L 126.2890625 100.35253822582695 L 126.953125 100.51844841919151 L 127.6171875 100.6839417114389 L 128.28125 100.84902320641896 L 128.9453125 101.01369791725136 L 129.609375 101.17797076825427 L 130.2734375 101.34184659728442 L 130.9375 101.50533015773405 L 131.6015625 101.66842612074342 L 132.265625 101.83113907663561 L 132.9296875 101.99347353760942 L 133.59375 102.15543393876892 L 134.2578125 102.31702464059187 L 134.921875 102.47824993027598 L 135.5859375 102.63911402327322 L 136.25 102.79962106560649 L 136.9140625 102.959775134651 L 137.578125 103.11958024126267 L 138.2421875 103.27904033098247 L 138.90625 103.43815928561287 L 139.5703125 103.5969409244866 L 140.234375 103.75538900617221 L 140.8984375 103.9135072293569 L 141.5625 104.07129923456426 L 142.2265625 104.22876860515885 L 142.890625 104.38591886862878 L 143.5546875 104.54275349794312 L 144.21875 104.69927591238549 L 144.8828125 104.85548947916521 L 145.546875 105.0113975139387 L 146.2109375 105.1670032824789 L 146.875 105.32231000122621 L 147.5390625 105.47732083852561 L 148.203125 105.63203891585576 L 148.8671875 105.78646730819003 L 149.53125 105.94060904556822 L 150.1953125 106.09446711363111 L 150.859375 106.24804445460096 L 151.5234375 106.40134396820304 L 152.1875 106.55436851256876 L 152.8515625 106.70712090490932 L 153.515625 106.85960392235549 L 154.1796875 107.01182030280589 L 154.84375 107.16377274572591 L 155.5078125 107.31546391288936 L 156.171875 107.46689642879701 L 156.8359375 107.61807288210481 L 157.5 107.76899582542974 L 158.1640625 107.91966777672042 L 158.828125 108.0700912195581 L 159.4921875 108.22026860403429 L 160.15625 108.37020234721581 L 160.8203125 108.51989483360401 L 161.484375 108.66934841626849 L 162.1484375 108.81856541692031 L 162.8125 108.96754812675323 L 163.4765625 109.1162988067895 L 164.140625 109.26481968867432 L 164.8046875 109.41311297512279 L 165.46875 109.56118084033028 L 166.1328125 109.70902543066339 L 166.796875 109.85664886504144 L 167.4609375 110.00405323537686 L 168.125 110.15124060717994 L 168.7890625 110.29821302011086 L 169.453125 110.44497248809546 L 170.1171875 110.5915210000815 L 170.78125 110.73786052040771 L 171.4453125 110.8839929891042 L 172.109375 111.02992032244853 L 172.7734375 111.17564441339508 L 173.4375 111.3211671318179 L 174.1015625 111.4664903250576 L 174.765625 111.611615818167 L 175.4296875 111.75654541451262 L 176.09375 111.9012808957929 L 176.7578125 112.04582402279459 L 177.421875 112.19017653533854 L 178.0859375 112.33434015307347 L 178.75 112.47831657528397 L 179.4140625 112.62210748193655 L 180.078125 112.76571453311789 L 180.7421875 112.90913937010146 L 181.40625 113.05238361530334 L 182.0703125 113.19544887263413 L 182.734375 113.33833672779801 L 183.3984375 113.48104874865038 L 184.0625 113.62358648555619 L 184.7265625 113.7659514711215 L 185.390625 113.9081452215121 L 186.0546875 114.05016923566598 L 186.71875 114.19202499608996 L 187.3828125 114.33371396925347 L 188.046875 114.47523760534338 L 188.7109375 114.61659733898097 L 189.375 114.75779458912555 L 190.0390625 114.89883075971252 L 190.703125 115.03970723935564 L 191.3671875 115.18042540201394 L 192.03125 115.32098660706615 L 192.6953125 115.46139219959859 L 193.359375 115.60164351050025 L 194.0234375 115.74174185665359 L 194.6875 115.88168854139678 L 195.3515625 116.02148485443942 L 196.015625 116.16113207228058 L 196.6796875 116.30063145819372 L 197.34375 116.43998426271487 L 198.0078125 116.57919172363601 L 198.671875 116.71825506596977 L 199.3359375 116.85717550265429 L 200 116.99595423440456 L 200.6640625 117.1345924500066 L 201.328125 117.27309132616645 L 201.9921875 117.41145202833803 L 202.65625 117.549675710213 L 203.3203125 117.68776351424765 L 203.984375 117.82571657192094 L 204.6484375 117.96353600341973 L 205.3125 118.10122291848658 L 205.9765625 118.23877841573474 L 206.640625 118.37620358372735 L 207.3046875 118.51349950033884 L 207.96875 118.65066723328084 L 208.6328125 118.78770784041244 L 209.296875 118.92462236922516 L 209.9609375 119.06141185786205 L 210.625 119.19807733446306 L 211.2890625 119.33461981780334 L 211.953125 119.47104031722425 L 212.6171875 119.60733983282692 L 213.28125 119.74351935550246 L 213.9453125 119.87957986722503 L 214.609375 120.01552234099724 L 215.2734375 120.15134774111922 L 215.9375 120.28705702316917 L 216.6015625 120.42265113424652 L 217.265625 120.55813101304824 L 217.9296875 120.69349758983776 L 218.59375 120.8287517868622 L 219.2578125 120.96389451829218 L 219.921875 121.09892669011434 L 220.5859375 121.23384920065789 L 221.25 121.36866294045574 L 221.9140625 121.50336879218054 L 222.578125 121.63796763127945 L 223.2421875 121.7724603255659 L 223.90625 121.90684773544605 L 224.5703125 122.04113071415983 L 225.234375 122.17531010766008 L 225.8984375 122.30938675513055 L 226.5625 122.44336148826287 L 227.2265625 122.57723513242728 L 227.890625 122.71100850584763 L 228.5546875 122.84468241997985 L 229.21875 122.97825768003037 L 229.8828125 123.1117350842246 L 230.546875 123.24511542459976 L 231.2109375 123.37839948686316 L 231.875 123.5115880501324 L 232.5390625 123.64468188770036 L 233.203125 123.77768176654288 L 233.8671875 123.91058844746954 L 234.53125 124.04340268541183 L 235.1953125 124.17612522965926 L 235.859375 124.30875682321069 L 236.5234375 124.44129820366584 L 237.1875 124.57375010272213 L 237.8515625 124.70611324676663 L 238.515625 124.83838835632486 L 239.1796875 124.97057614667044 L 239.84375 125.10267732741764 L 240.5078125 125.23469260327813 L 241.171875 125.36662267341187 L 241.8359375 125.49846823174937 L 242.5 125.63022996719417 L 243.1640625 125.7619085636397 L 243.828125 125.89350469973422 L 244.4921875 126.02501904949398 L 245.15625 126.15645228188859 L 245.8203125 126.28780506095029 L 246.484375 126.41907804608519 L 247.1484375 126.55027189213274 L 247.8125 126.68138724904077 L 248.4765625 126.81242476219683 L 249.140625 126.94338507263704 L 249.8046875 127.07426881673945 L 250.46875 127.20507662657519 L 251.1328125 127.33580912961301 L 251.796875 127.46646694941035 L 252.4609375 127.59705070493659 L 253.125 127.727561011014 L 253.7890625 127.85799847843768 L 254.453125 127.98836371364108 L 255.1171875 128.11865731935228 L 255.78125 128.2488798939409 L 256.4453125 128.3790320320196 L 257.109375 128.50911432412926 L 257.7734375 128.63912735728633 L 258.4375 128.76907171421504 L 259.1015625 128.8989479741025 L 259.765625 129.0287567125672 L 260.4296875 129.1584985013001 L 261.09375 129.2881739083722 L 261.7578125 129.41778349841456 L 262.421875 129.5473278323385 L 263.0859375 129.67680746765694 L 263.75 129.8062229583455 L 264.4140625 129.93557485510644 L 265.078125 130.06486370490433 L 265.7421875 130.1940900518381 L 266.40625 130.32325443635108 L 267.0703125 130.45235739577797 L 267.734375 130.581399464095 L 268.3984375 130.71038117227528 L 269.0625 130.83930304797912 L 269.7265625 130.96816561591675 L 270.390625 131.0969693976124 L 271.0546875 131.22571491157322 L 271.71875 131.35440267332794 L 272.3828125 131.48303319540165 L 273.046875 131.61160698742813 L 273.7109375 131.7401245561984 L 274.375 131.86858640564515 L 275.0390625 131.99699303662743 L 275.703125 132.1253449475954 L 276.3671875 132.25364263404424 L 277.03125 132.38188658871258 L 277.6953125 132.5100773017166 L 278.359375 132.63821526055224 L 279.0234375 132.76630095003225 L 279.6875 132.89433485236094 L 280.3515625 133.02231744721234 L 281.015625 133.1502492118106 L 281.6796875 133.278130620674 L 282.34375 133.40596214610787 L 283.0078125 133.53374425788576 L 283.671875 133.66147742313564 L 284.3359375 133.78916210697764 L 285 133.9167987719393 L 285.6640625 134.04438787825762 L 286.328125 134.17192988411625 L 286.9921875 134.29942524506617 L 287.65625 134.426874414608 L 288.3203125 134.55427784416312 L 288.984375 134.68163598263652 L 289.6484375 134.80894927700646 L 290.3125 134.93621817223385 L 290.9765625 135.06344311096694 L 291.640625 135.19062453365905 L 292.3046875 135.31776287916847 L 292.96875 135.44485858392056 L 293.6328125 135.57191208258027 L 294.296875 135.69892380762886 L 294.9609375 135.8258941896974 L 295.625 135.9528236575592 L 296.2890625 136.0797126381927 L 296.953125 136.20656155622612 L 297.6171875 136.3333708351054 L 298.28125 136.46014089585333 L 298.9453125 136.5868721581039 L 299.609375 136.71356503941496 L 300.2734375 136.840219955824 L 300.9375 136.9668373215087 L 301.6015625 137.0934175489316 L 302.265625 137.21996104891784 L 302.9296875 137.34646823066518 L 303.59375 137.47293950161708 L 304.2578125 137.5993752676137 L 304.921875 137.72577593290634 L 305.5859375 137.85214190024232 L 306.25 137.97847357088222 L 306.9140625 138.104771344202 L 307.578125 138.23103561840625 L 308.2421875 138.35726678992467 L 308.90625 138.4834652541287 L 309.5703125 138.60963140459125 L 310.234375 138.73576563345836 L 310.8984375 138.8618683315447 L 311.5625 138.98793988836115 L 312.2265625 139.1139806919341 L 312.890625 139.23999112897422 L 313.5546875 139.3659715847677 L 314.21875 139.49192244341688 L 314.8828125 139.61784408773394 L 315.546875 139.7437368989955 L 316.2109375 139.86960125767547 L 316.875 139.99543754250368 L 317.5390625 140.12124613134074 L 318.203125 140.2470274008671 L 318.8671875 140.37278172620233 L 319.53125 140.49850948171402 L 320.1953125 140.6242110404296 L 320.859375 140.74988677421777 L 321.5234375 140.87553705404116 L 322.1875 141.00116224937008 L 322.8515625 141.12676272913708 L 323.515625 141.25233886066172 L 324.1796875 141.37789101060756 L 324.84375 141.50341954453853 L 325.5078125 141.62892482682665 L 326.171875 141.75440722119149 L 326.8359375 141.8798670899077 L 327.5 142.00530479483768 L 328.1640625 142.13072069635933 L 328.828125 142.25611515433053 L 329.4921875 142.38148852765005 L 330.15625 142.50684117402932 L 330.8203125 142.6321734507492 L 331.484375 142.75748571373026 L 332.1484375 142.8827783185722 L 332.8125 143.00805161962518 L 333.4765625 143.13330597067932 L 334.140625 143.25854172459944 L 334.8046875 143.38375923352362 L 335.46875 143.50895884878054 L 336.1328125 143.6341409210894 L 336.796875 143.75930580026687 L 337.4609375 143.8844538354282 L 338.125 144.00958537518846 L 338.7890625 144.13470076723053 L 339.453125 144.25980035857773 L 340.1171875 144.38488449593854 L 340.78125 144.50995352485174 L 341.4453125 144.63500779052572 L 342.109375 144.76004763769046 L 342.7734375 144.885073410238 L 343.4375 145.01008545156913 L 344.1015625 145.13508410444666 L 344.765625 145.26006971120182 L 345.4296875 145.38504261351753 L 346.09375 145.5100031527066 L 346.7578125 145.63495166928342 L 347.421875 145.7598885035964 L 348.0859375 145.88481399532975 L 348.75 146.00972848364177 L 349.4140625 146.1346323075158 L 350.078125 146.25952580526265 L 350.7421875 146.38440931473076 L 351.40625 146.5092831734458 L 352.0703125 146.6341477186802 L 352.734375 146.75900328709795 L 353.3984375 146.8838502151075 L 354.0625 147.00868883871956 L 354.7265625 147.13351949368842 L 355.390625 147.2583425152284 L 356.0546875 147.38315823858036 L 356.71875 147.50796699844565 L 357.3828125 147.63276912919883 L 358.046875 147.75756496517192 L 358.7109375 147.88235484023005 L 359.375 148.0071390881269 L 360.0390625 148.1319180422933 L 360.703125 148.25669203598048 L 361.3671875 148.38146140233226 L 362.03125 148.5062264741744 L 362.6953125 148.63098758415808 L 363.359375 148.75574506483252 L 364.0234375 148.8804992485766 L 364.6875 149.00525046767154 L 365.3515625 149.12999905416163 L 366.015625 149.25474534021083 L 366.6796875 149.37948965768015 L 367.34375 149.50423233841335 L 368.0078125 149.62897371416892 L 368.671875 149.75371411669337 L 369.3359375 149.87845387772404" fill="none" stroke="currentColor" stroke-width="2" stroke-opacity="0.6" stroke-linecap="round"></path><line y1="150" y2="150" x1="30" x2="370" stroke="currentColor" stroke-width="1" opacity="0.25" stroke-dasharray="4 1"></line><line x1="30" x2="30" y1="270" y2="30" stroke="currentColor" opacity="0.25" stroke-width="1" marker-end="url(#axisArrow)"></line><text x="6" y="7" alignment-baseline="middle" text-anchor="end" transform="rotate(-90 30 20)" fill="currentColor" opacity="0.5">Displacement</text><line x1="30" x2="370" y1="270" y2="270" stroke="currentColor" stroke-width="1" opacity="0.28" marker-end="url(#axisArrow)"></line><text x="360" y="285" alignment-baseline="middle" text-anchor="end" fill="currentColor" opacity="0.5">Distance to border</text></svg></p></div><p><h4>Preview</h4><svg viewBox="0 0 400 300" height="100%" color-interpolation-filters="sRGB"><defs><filter id="«Rjuij5»" color-interpolation-filters="sRGB"><feImage x="0" y="0" width="400" height="300" result="displacement_map"></feImage><feDisplacementMap in="SourceGraphic" in2="displacement_map" scale="55.11490080256904" xChannelSelector="R" yChannelSelector="G"></feDisplacementMap></filter><pattern id="grid" x="-15" y="-15" width="30" height="30" patternUnits="userSpaceOnUse"></pattern><linearGradient id="doubleGradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#4FBDBB"></stop> <stop offset="50%" stop-color="#AFBDBB"></stop> <stop offset="100%" stop-color="#DFBDBB"></stop> </linearGradient></defs><g filter="url(#«Rjuij5»)"><rect width="400" height="300" fill="url(#doubleGradient)"></rect><rect width="400" height="300" fill="url(#grid)"></rect></g></svg></p></div></div>

<p>The final piece of our Liquid Glass effect is the <strong>specular highlight</strong>—those bright, shiny edges you see on real glass objects when light hits them at certain angles.</p>
<p>The way Apple implements it seems to be a simple rim light effect, where the highlight appears around the edges of the glass object, and its intensity varies based on the angle of the surface normal relative to a fixed light direction.</p>
<div><div></div><div><p><label>Specular Angle:<!-- --> <span>-60</span>°</label></p><p><span>-180°</span><span>0°</span><span>180°</span></p></div></div>

<p>In the final SVG filter, we combine both the displacement map for refraction and the specular highlight effect.</p>
<p>Both are loaded as separate <code>&lt;feImage /&gt;</code> elements, and then combined using <code>&lt;feBlend /&gt;</code> to overlay the highlight on top of the refracted image.</p>
<p>But this part is actually the most &#34;creative&#34; part of the effect, and it&#39;s just by tweaking the number of filters, and their parameters, that you can get a variety of different looks.</p>
<h2 id="svg-filter-as-backdrop-filter"><a href="#svg-filter-as-backdrop-filter" aria-label="Permalink">#</a>SVG Filter as <code>backdrop-filter</code></h2>
<p>This is the part where cross-browser compatibility ends. Only Chrome currently supports using SVG filters as <code>backdrop-filter</code>, which is essential for applying the Liquid Glass effect to UI components:</p>
<figure data-rehype-pretty-code-figure=""><pre><code data-language="css" data-theme=""><span data-line=""><span>.glass-panel</span><span> {</span></span>
<span data-line=""><span>  backdrop-filter</span><span>: </span><span>url</span><span>(</span><span>#liquidGlassFilterId</span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></figure>
<blockquote>
<p>Note: The backdrop-filter dimensions does not adjust automatically to the element size, so you need to ensure that your filter images fit the size of your elements.</p>
</blockquote>
<p>Now that we have all the pieces in place, we can create components that use this effect.</p>

<p>With our refraction math and displacement maps working, let&#39;s see how this translates to actual UI components you might use in an application.</p>
<div><div><div><div><p>Chrome‑specific demo</p><p>Chrome allows using SVG filters as <code>backdrop-filter</code>, which
isn’t part of the CSS spec.</p><p>Above, we used regular <code>filter</code> so it’s viewable in
Safari/Firefox.</p><p>The next components use <code>backdrop-filter</code>, so they’re
Chrome‑only.</p></div></div></div></div>
<p>The goal won&#39;t be to create real components for production, but just to get a taste of how the effect looks in different UI elements.</p>
<h2 id="magnifying-glass"><a href="#magnifying-glass" aria-label="Permalink">#</a>Magnifying Glass</h2>
<p>This component actually uses two displacement maps: one for the refraction on the sides, and one for the zooming, which has a stronger refraction effect.</p>
<p>It also plays with shadows and scaling to create a more dynamic, interactive effect.</p>
<div><div><div><p><span></span><span>Optics Study</span></p><h3>Liquid Glass<span>—</span>Precision Lens</h3><div><p>Drag the capsule to bend the page. This lens is a compact SVG displacement rig that refracts whatever sits beneath it.</p><p>The field comes from a rounded bezel profile; pixels are pushed along its gradient, then topped with a subtle specular bloom for depth.</p><p>Sweep across strong edges—high contrast makes the bend snap.</p></div></div><p><img src="https://images.unsplash.com/photo-1579380656108-f98e4df8ea62?q=80&amp;w=800&amp;auto=format&amp;fit=crop" alt="Abstract architectural lines" loading="lazy" draggable="false"/></p><div><p><a href="https://unsplash.com/photos/green-frog-on-red-post-SVwOposMxHY" target="_blank" rel="noopener noreferrer">Photo: Stephanie LeBlanc / Unsplash</a></p></div></div><div draggable="false"></div></div><div><div><p>Parameters</p></div><p><label>Specular Opacity</label><span>0.50</span></p><p><label>Specular Saturation</label><span>9</span></p><p><label>Refraction Level</label><span>1.00</span></p></div>
<h2 id="searchbox"><a href="#searchbox" aria-label="Permalink">#</a>Searchbox</h2>
<div><div><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" aria-hidden="true" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M456.69 421.39 362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8 124.95 124.95 0 0 1-124.8-124.8z"></path></svg></div></div><p><label>Use image background</label></p></div><div><div><p>Parameters</p></div><p><label>Specular Opacity</label><span>0.20</span></p><p><label>Specular Saturation</label><span>4</span></p><p><label>Refraction Level</label><span>0.70</span></p><p><label>Blur Level</label><span>1.0</span></p></div>
<h2 id="switch"><a href="#switch" aria-label="Permalink">#</a>Switch</h2>
<p>This uses a lip bezel, which makes the surface convex on the outside and concave in the middle. This makes the center slider zoomed out, while the edges refract the inside.</p>
<div><div></div><p><label>Force active</label></p></div><div><div><p>Parameters</p></div><p><label>Specular Opacity</label><span>0.50</span></p><p><label>Specular Saturation</label><span>6</span></p><p><label>Refraction Level</label><span>1.00</span></p><p><label>Blur Level</label><span>0.2</span></p></div>
<h2 id="slider"><a href="#slider" aria-label="Permalink">#</a>Slider</h2>
<p>Slider allows you to see the current level through the glass, while the sides refract the background. It uses a convex bezel.</p>
<div><div><div><div></div></div></div><p><label>Force active</label></p></div><div><div><p>Parameters</p></div><p><label>Specular Opacity</label><span>0.40</span></p><p><label>Specular Saturation</label><span>7</span></p><p><label>Refraction Level</label><span>1.00</span></p><p><label>Blur Level</label><span>0.0</span></p></div>
<h2 id="music-player"><a href="#music-player" aria-label="Permalink">#</a>Music Player</h2>
<p>This fake music player UI tries to mimic the look of Apple Music’s Liquid Glass panels, using a convex bezel and a subtle specular highlight.</p>
<p>It relies on the iTunes Search API to fetch album art and song details.</p>
<div><div><div><p>No results</p><!--$?--><template id="B:0"></template><div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div></div><!--/$--></div><div><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" aria-hidden="true" height="22" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M456.69 421.39 362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8 124.95 124.95 0 0 1-124.8-124.8z"></path></svg></div></div><div></div><div><div></div></div><div></div></div><div><div><p>Parameters</p></div><p><label>Specular Opacity</label><span>0.40</span></p><p><label>Specular Saturation</label><span>6</span></p><p><label>Refraction Level</label><span>1.00</span></p><p><label>Blur Level</label><span>1.0</span></p><p><label>Progressive Blur Strength</label><span>1.00</span></p><p><label>Glass Background Opacity</label><span>0.60</span></p></div></div>

<p>This prototype distills Apple’s Liquid Glass into real‑time refraction plus a simple highlight. It’s flexible, but still Chrome‑bound—only Chromium exposes SVG filters as <code>backdrop-filter</code>. That said, it’s already viable inside Chromium‑based runtimes like Electron, elsewhere you could fake a softer fallback with layered blur.</p>
<p>Treat this strictly as experimental. Dynamic shape/size changes are currently costly because nearly every tweak (besides animating <code>&lt;filter /&gt;</code> props, like <code>scale</code>) forces a full displacement map rebuild.</p>
<p>The code needs a cleanup pass and perf work before any possible open‑source release.</p>
<p>Thanks for reading my first post—I&#39;d genuinely love any feedback, ideas, critiques, or suggestions. If it sparked a thought or you know someone who&#39;d enjoy this kind of deep‑dive, feel free to pass it along.</p></div></div>
  </body>
</html>
