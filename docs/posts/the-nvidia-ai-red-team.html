<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developer.nvidia.com/blog/nvidia-ai-red-team-an-introduction/">Original</a>
    <h1>The NVIDIA AI Red Team</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>Machine learning has the promise to improve our world, and in many ways it already has. However, research and lived experiences continue to show this technology has risks. Capabilities that used to be restricted to science fiction and academia are increasingly available to the public. The responsible use and development of AI requires categorizing, assessing, and mitigating enumerated risks where practical. This is true from a pure AI standpoint but also from a standard information security perspective.</p>



<p>Until standards are in place and mature testing has taken hold, organizations are using red teams to explore and enumerate the immediate risks presented by AI. This post introduces the NVIDIA AI red team philosophy and the general framing of ML systems.</p>



<h2>Assessment foundations</h2>



<p>Our AI red team is a cross-functional team made up of offensive security professionals and data scientists. We use our combined skills to assess our ML systems to identify and help mitigate any risks from the perspective of information security.</p>



<p>Information security has a lot of useful paradigms, tools, and network access that enable us to accelerate responsible use in all areas. This framework is our foundation and directs assessment efforts toward a standard within the organization. We use it to guide assessments (Figure 1) toward the following goals:</p>



<ul>
<li>The risks that our organization cares about and wants to eliminate are addressed.</li>



<li>Required assessment activities and the various tactics, techniques, and procedures (TTPs) are clearly defined. TTPs can be added without changing existing structures.</li>



<li>The systems and technologies in scope for our assessments are clearly defined. This helps us remain focused on ML systems and not stray into other areas.</li>



<li>All efforts live within a single framework that stakeholders can reference and immediately get a broad overview of what ML security looks like.</li>
</ul>



<p>This helps us set expectations for what an assessment looks like, what systems we could potentially be affecting, and the risks that we address. This framework is not specific to red teaming, but some of these properties are the basis for a functional ML security program, of which red teaming is a small part.</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework.png" alt="Diagram shows threat model assessment including GRC, methodology, ML development phases, the tech stack, and the intra- and Internet networks." width="715" height="478" srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework.png 1430w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-300x201.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-625x418.png 625w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-172x115.png 172w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-768x513.png 768w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-645x431.png 645w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-449x300.png 449w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-135x90.png 135w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-362x242.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-165x110.png 165w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/ai-red-team-assessment-framework-1024x685.png 1024w" sizes="(max-width: 715px) 100vw, 715px"/></a><figcaption><em>Figure 1. AI red team assessment framework</em></figcaption></figure></div>


<p>The specific technologies—and which features go where—is not necessarily important. The important part is that there is a place for everything to go, whether you’re red teaming, vulnerability scanning, or doing any sort of assessment of an ML system.</p>



<p>This framework enables us to address specific issues in specific parts of the ML pipeline, infrastructure, or technologies. It becomes a place to communicate risk about issues to affected systems: up and down the stack and informing policy and technology.</p>



<p>Any given subsection can be isolated, expanded, and described within the context of the whole system. Here are some examples:</p>



<ul>
<li>Evasion is expanded to include specific algorithms or TTPs that would be relevant for an assessment of a particular model type. Red teams can point to exactly the infrastructure components that are affected.</li>



<li>Technical vulnerabilities can affect any level of infrastructure or just a specific application. They can be dealt with in the context of their function and risk-rated accordingly.</li>



<li>Harm-and-abuse scenarios that are foreign to many information security practitioners are not only included but are integrated. In this way, we motivate technical teams to consider harm-and-abuse scenarios as they’re assessing ML systems. Or, they can provide ethics teams access to tools and expertise.</li>



<li>Requirements handed down can be integrated more quickly, both old and new.</li>
</ul>



<p>There are many benefits to a framework like this. Consider how a <a href="https://www.nvidia.com/en-us/support/submit-security-vulnerability/" data-wpel-link="internal" target="_self" rel="noopener noreferrer">disclosure process</a> can benefit from this composed view. The core building blocks are governance, risk, and compliance (GRC) and ML development.</p>



<h3>Governance, risk, and compliance</h3>



<p>As in many organizations, GRC is the top level of information security efforts, ensuring that business security requirements are enumerated, communicated, and implemented. As an AI red team under the banner of information security, here are the high-level risks we’re interested in surfacing:</p>



<ul>
<li><strong>Technical risk:</strong> ML systems or processes are compromised as the result of a technical vulnerability or shortcoming.</li>



<li><strong>Reputational risk:</strong> Model performance or behavior reflects poorly on the organization. In this new paradigm, this could include releasing a model that has a broad societal impact.</li>



<li><strong>Compliance risk:</strong> The ML system is out of compliance, leading to fines or reduced market competitiveness, much like PCI or GDPR.</li>
</ul>



<p>These high-level risk categories are present in all information systems, including ML systems. Think of these categories like individually colored lenses on a light. Using each colored lens provides a different perspective of risks with respect to the underlying system, and sometimes the risks can be additive. For example, a technical vulnerability that leads to a breach can cause reputational damage. Depending on where the breach occurred, compliance could also require breach notification, fines, and so on.</p>



<p>Even if ML didn’t come with its own vulnerabilities, it is still developed, stored, and deployed on an infrastructure that is subject to standards set by GRC efforts. All assets within an organization are subject to being compliant with GRC standards. And if they aren’t, it’s ideally only because management filed and approved an exception.</p>



<h3><a></a>ML development</h3>



<p>The bottom of the stack is the ML development lifecycle, as it is the activity that GRC wants insight into. We generally consider an ML system as any system that involves ML, inclusive of the processes and systems by which models are built. Components of an ML system might include a web server that hosts a model for inference, a data lake holding training data, or a system that uses the model output to make a decision.</p>



<p>Development pipelines span multiple and sometimes incongruent systems. Each phase of the lifecycle is both unique in function and dependent on the prior phase. Because of this, ML systems tend to be tightly integrated, and the compromise of any one part of the pipeline likely affects other upstream or downstream development phases.</p>



<p>There are more detailed MLOps pipelines, but the canonical example is sufficient to successfully group the supporting tools and services with their lifecycle phase (Table 1).</p>



<figure><table><tbody><tr><td><strong>Phase</strong></td><td><strong>Description</strong></td><td><strong>Model state</strong></td></tr><tr><td><strong>Ideation</strong></td><td>Discussions, meetings, and intention toward requirements.</td><td>Pre-development</td></tr><tr><td><strong>Data collection</strong></td><td>Models require data to be trained. Data is usually collected from both public and private sources with a specific model in mind. This is an ongoing process and data continues to be collected from these sources.</td><td>Train</td></tr><tr><td><strong>Data processing</strong></td><td>The collected data is processed in any number of ways before being introduced to an algorithm for both training and inference.</td><td>Train</td></tr><tr><td><strong>Model training</strong></td><td>The processed data is then ingested by an algorithm and a model is trained.</td><td>Train</td></tr><tr><td><strong>Model evaluation</strong></td><td>After a model is trained, it is validated to ensure accuracy, robustness, interpretability, or any number of other metrics.</td><td>Train</td></tr><tr><td><strong>Model deployment</strong></td><td>The trained model is embedded in a system for use in production. Machine learning is deployed in a wide variety of ways: inside autonomous vehicles, on a web API, or in client-side applications.</td><td>Inference</td></tr><tr><td><strong>System monitoring</strong></td><td>After the model has been deployed, the system is monitored. This includes aspects of the system that may not relate to the ML model directly.</td><td>Inference</td></tr><tr><td><strong>End-of-life</strong></td><td>Data shifts, business requirement changes, and innovations require that systems are discontinued properly.</td><td>Post-development</td></tr></tbody></table><figcaption><em>Table 1. MLOps pipeline with supporting red team tools and services</em></figcaption></figure>



<p>This high-level structure enables risks to be put into the context of the whole ML system and provides some natural security boundaries to work with. For example, implementing privilege tiering between phases potentially prevents an incident from spanning an entire pipeline or multiple pipelines. Compromised or not, the purpose of the pipeline is to deploy models for use.</p>



<h2><a></a>Methodology and use cases</h2>



<p>This methodology attempts to cover all primary concerns related to ML systems. In our framework, any given phase can be handed to an appropriately skilled team:</p>



<ul>
<li>Existing offensive security teams are likely equipped to perform reconnaissance and explore technical vulnerabilities.</li>



<li>Responsible AI teams are equipped to address harm-and-abuse scenarios.</li>



<li>ML researchers are equipped to handle model vulnerabilities.</li>
</ul>



<p>Our AI red team prefers to aggregate those skill sets on the same or adjacent teams. The increased learning and effectiveness are undeniable: Traditional red team members are part of <a href="https://arxiv.org/abs/2302.10149" data-wpel-link="exclude">academic papers</a> and data scientists are given <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-29374" data-wpel-link="external" target="_blank" rel="follow external noopener">CVEs</a>.</p>



<figure><table><tbody><tr><td><strong>Assessment phase</strong></td><td><strong>Description</strong> <strong> </strong></td></tr><tr><td><strong>Reconnaissance</strong></td><td>This phase describes classic reconnaissance techniques found in <a href="https://attack.mitre.org/tactics/TA0043/" data-wpel-link="external" target="_blank" rel="follow external noopener">MITRE ATT&amp;CK</a> or <a href="https://atlas.mitre.org/" data-wpel-link="external" target="_blank" rel="follow external noopener">MITRE ATLAS</a>  </td></tr><tr><td><strong>Technical vulnerabilities</strong></td><td>All the traditional vulnerabilities you know and love.  </td></tr><tr><td><strong>Model vulnerabilities</strong></td><td>These vulnerabilities typically come out of research spaces and cover the following: extraction, evasion, inversion, membership inference, and poisoning.  </td></tr><tr><td><strong>Harm and abuse</strong></td><td>Models are often trained and distributed such that they can be abused for malicious or other harmful tasks. Models can also be biased intentionally or unintentionally. Or, they don’t accurately reflect the environments in which they’re deployed.</td></tr></tbody></table><figcaption><em>Table 2. Methodology assessment phases</em></figcaption></figure>



<p>Regardless of which team performs which assessment activity, it all remains within the same framework and feeds into the larger assessment effort.<a></a> Here are some specific use cases:</p>



<ul>
<li>Address new prompt-injection techniques</li>



<li>Examine and define security boundaries</li>



<li>Use privilege tiering</li>



<li>Conduct tabletop exercises</li>
</ul>



<h3>Address new prompt-injection techniques</h3>



<p>In this scenario, outputs from large language models (LLMs) are clumsily put into Python exec or eval statements. Already, you can see how a composed view helps address multiple aspects, as input validation is a layer of defense against prompt injection.</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example.png" alt="Threat model diagram used earlier, but only showing the Methodology columns." width="715" height="182" srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example.png 1430w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-300x76.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-625x159.png 625w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-179x46.png 179w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-768x195.png 768w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-645x164.png 645w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-500x127.png 500w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-160x41.png 160w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-362x92.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-432x110.png 432w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/prompt-injection-vulnerability-example-1024x261.png 1024w" sizes="(max-width: 715px) 100vw, 715px"/></a><figcaption><em>Figure 2. New prompt-injection vulnerability could span both model and technical columns</em></figcaption></figure></div>


<h3>Examine and define security boundaries</h3>



<p>Compartmentalizing each phase with security controls reduces attack surfaces and increases visibility into ML systems. An example control might be that pickles (yes, that torch file has pickles) are blocked outside of development environments, and production models must be converted to something less prone to code execution, like ONNX. This enables R&amp;D to continue using pickles during development but prevents them from being used in sensitive environments.</p>



<p>While not using pickles at all would be ideal, security is often about compromises. Organizations should seek to add mitigating controls where the complete avoidance of issues is not practical.</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases.png" alt="Threat model diagram used earlier but with red lines between the model phases showing security points." width="715" height="236" srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases.png 1430w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-300x99.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-625x206.png 625w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-179x59.png 179w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-768x253.png 768w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-645x212.png 645w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-500x165.png 500w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-160x53.png 160w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-362x119.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-334x110.png 334w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/security-between-development-phases-1024x337.png 1024w" sizes="(max-width: 715px) 100vw, 715px"/></a><figcaption><em>Figure 3. Security between development phases</em></figcaption></figure></div>


<h3>Use privilege tiering</h3>



<p>Inside a development flow, it’s important to understand the tools and their properties at each stage of the lifecycle. For example, MLFlow has no authentication by default. Starting an MLFlow server knowingly or unknowingly opens that host for exploitation through deserialization.</p>



<p>In another example, Jupyter servers are often started with arguments that remove authentication and TensorBoard has no authentication. This isn’t to say that TensorBoard should have authentication. Teams should just be aware of this fact and ensure that the appropriate network security rules are in place. <a></a></p>



<p>Consider the scope of all technologies within the development pipeline. This includes easy things like two-factor authentication on ML services like HuggingFace.</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers.png" alt="Threat-modeling diagram used earlier but with red lines separating the tech stack from the corporate network and the network from the Internet." width="715" height="295" srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers.png 1430w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-300x124.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-625x257.png 625w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-179x74.png 179w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-768x316.png 768w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-645x266.png 645w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-500x206.png 500w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-160x66.png 160w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-362x149.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-267x110.png 267w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/privilege-tiers-infrastructure-layers-1024x422.png 1024w" sizes="(max-width: 715px) 100vw, 715px"/></a><figcaption><em>Figure 4. Privilege tiering between infrastructure layers</em></figcaption></figure></div>


<h3><a></a>Conduct tabletop exercises</h3>



<p>Consider how you might empty the ML development process and only consider your technologies, where they live, and the TTPs that would apply. Work your way up and down the stack. Here are some quick scenarios to think through:</p>



<ul>
<li>A Flask server was deployed with debug privileges enabled and exposed to the Internet. It was hosting a model that provided inference for HIPAA-protected data.</li>



<li>PII was downloaded as part of a dataset and several models have been trained on it. Now, a customer is asking about it.</li>



<li>A public bucket with several ML artifacts, including production models, was left open to the public. It has been improperly accessed and files have been changed.</li>



<li>Someone can consistently bypass content filters despite the models being accurate and up-to-date.</li>



<li>A model isn’t performing as well as it should in certain geographic regions.</li>



<li>Someone is scanning the internal network from an inference server used to host an LLM.</li>



<li>System monitoring services have detected someone sending a well-known dataset against the inference service.</li>
</ul>



<p>These are maybe a little contrived but spend some time putting various technologies in the right buckets and then working your way up through the methodology.</p>



<ul>
<li>Does it sound like a technical vulnerability caused the issue?</li>



<li>Does this affect any ML processes?</li>



<li>Who is responsible for the models? Would they know if changes have been made?</li>
</ul>



<p>These are all questions that must be answered. Some of these scenarios immediately seem like they fit into one section of the methodology. However, on closer inspection, you’ll find most of them span multiple areas.</p>


<div>
<figure><a href="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet.png" data-wpel-link="internal" target="_self" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet.png" alt="Framework diagram with blank spaces for custom use: Tech stack, Corp Network, Internet." width="715" height="521" srcset="https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet.png 1430w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-300x219.png 300w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-625x455.png 625w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-158x115.png 158w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-768x560.png 768w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-645x470.png 645w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-412x300.png 412w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-124x90.png 124w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-362x264.png 362w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-151x110.png 151w, https://developer-blogs.nvidia.com/wp-content/uploads/2023/06/threat-model-worksheet-1024x746.png 1024w" sizes="(max-width: 715px) 100vw, 715px"/></a><figcaption><em>Figure 5. Threat-model worksheet</em></figcaption></figure></div>


<h2><a></a>Conclusion</h2>



<p>This framework already provides you with several familiar paradigms that your organizations can start to strategize around. With a principled methodology, you can create foundations from which to build continuous security improvement, reaching toward standards and maturity from product design to production deployment. We invite you to adopt our methodology and adapt it to your own purposes.</p>



<p>Our methodology does not prescribe behaviors or processes. Instead, it aims to organize them. Your organization may already have mature processes to discover, manage, and mitigate risks associated with traditional applications. We hope that this framework and methodology similarly prepare you to identify and mitigate new risks from the ML components deployed in your organization.</p>



<p>If you have any questions, please comment below or contact <a href="mailto:threatops@nvidia.com">threatops@nvidia.com</a>.</p>
</div></div>
  </body>
</html>
