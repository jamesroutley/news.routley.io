<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://code.ffmpeg.org/FFmpeg/FFmpeg/commit/13ce36fef98a3f4e6d8360c24d6b8434cbb8869b">Original</a>
    <h1>FFmpeg 8.0 adds Whisper support</h1>
    
    <div id="readability-page-1" class="page"><div><tr data-line-type="tag">
			
				
					<td colspan="2">
						
					</td>
				
			
			<td></td>
			<td><span data-type-marker=""></span></td>
			
				<td><code>@ -0,0 +1,463 @@</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="1"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR1"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>/*
</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="2"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR2"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>Copyright</span> <span>(</span><span>c</span><span>)</span> <span>2025</span> <span>Vittorio</span> <span>Palmisano</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="3"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR3"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="4"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR4"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>This</span> <span>file</span> <span>is</span> <span>part</span> <span>of</span> <span>FFmpeg</span><span>.</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="5"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR5"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="6"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR6"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>FFmpeg</span> <span>is</span> <span>free</span> <span>software</span><span>;</span> <span>you</span> <span>can</span> <span>redistribute</span> <span>it</span> <span>and</span><span>/</span><span>or</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="7"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR7"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>modify</span> <span>it</span> <span>under</span> <span>the</span> <span>terms</span> <span>of</span> <span>the</span> <span>GNU</span> <span>Lesser</span> <span>General</span> <span>Public</span> <span>License</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="8"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR8"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>as</span> <span>published</span> <span>by</span> <span>the</span> <span>Free</span> <span>Software</span> <span>Foundation</span><span>;</span> <span>either</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="9"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR9"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>version</span> <span>2.1</span> <span>of</span> <span>the</span> <span>License</span><span>,</span> <span>or</span> <span>(</span><span>at</span> <span>your</span> <span>option</span><span>)</span> <span>any</span> <span>later</span> <span>version</span><span>.</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="10"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR10"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="11"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR11"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>FFmpeg</span> <span>is</span> <span>distributed</span> <span>in</span> <span>the</span> <span>hope</span> <span>that</span> <span>it</span> <span>will</span> <span>be</span> <span>useful</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="12"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR12"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>but</span> <span>WITHOUT</span> <span>ANY</span> <span>WARRANTY</span><span>;</span> <span>without</span> <span>even</span> <span>the</span> <span>implied</span> <span>warranty</span> <span>of</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="13"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR13"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>MERCHANTABILITY</span> <span>or</span> <span>FITNESS</span> <span>FOR</span> <span>A</span> <span>PARTICULAR</span> <span>PURPOSE</span><span>.</span>  <span>See</span> <span>the</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="14"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR14"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>GNU</span> <span>Lesser</span> <span>General</span> <span>Public</span> <span>License</span> <span>for</span> <span>more</span> <span>details</span><span>.</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="15"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR15"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="16"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR16"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>You</span> <span>should</span> <span>have</span> <span>received</span> <span>a</span> <span>copy</span> <span>of</span> <span>the</span> <span>GNU</span> <span>Lesser</span> <span>General</span> <span>Public</span> <span>License</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="17"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR17"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>along</span> <span>with</span> <span>FFmpeg</span><span>;</span> <span>if</span> <span>not</span><span>,</span> <span>write</span> <span>to</span> <span>the</span> <span>Free</span> <span>Software</span> <span>Foundation</span><span>,</span> <span>Inc</span><span>.</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="18"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR18"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*</span> <span>51</span> <span>Franklin</span> <span>Street</span><span>,</span> <span>Fifth</span> <span>Floor</span><span>,</span> <span>Boston</span><span>,</span> <span>MA</span> <span>02110</span><span>-</span><span>1301</span> <span>USA</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="19"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR19"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code> <span>*/</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="20"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR20"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="21"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR21"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&lt;stdio.h&gt;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="22"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR22"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&lt;stdint.h&gt;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="23"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR23"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&lt;stdlib.h&gt;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="24"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR24"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="25"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR25"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&lt;whisper.h&gt;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="26"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR26"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="27"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR27"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/avutil.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="28"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR28"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/opt.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="29"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR29"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/channel_layout.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="30"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR30"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/samplefmt.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="31"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR31"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavfilter/avfilter.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="32"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR32"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavfilter/audio.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="33"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR33"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/mem.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="34"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR34"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/avstring.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="35"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR35"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/internal.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="36"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR36"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavformat/avio.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="37"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR37"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;libavutil/thread.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="38"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR38"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="39"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR39"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>include</span> <span>&#34;formats.h&#34;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="40"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR40"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="41"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR41"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>typedef</span> <span>struct</span> <span>WhisperContext</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="42"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR42"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>const</span> <span>AVClass</span> <span>*</span><span>class</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="43"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR43"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>char</span> <span>*</span><span>model_path</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="44"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR44"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>char</span> <span>*</span><span>language</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="45"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR45"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>bool</span> <span>use_gpu</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="46"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR46"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>gpu_device</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="47"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR47"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>char</span> <span>*</span><span>vad_model_path</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="48"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR48"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>float</span> <span>vad_threshold</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="49"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR49"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int64_t</span> <span>vad_min_speech_duration</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="50"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR50"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int64_t</span> <span>vad_min_silence_duration</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="51"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR51"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="52"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR52"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int64_t</span> <span>queue</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="53"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR53"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>char</span> <span>*</span><span>destination</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="54"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR54"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>char</span> <span>*</span><span>format</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="55"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR55"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="56"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR56"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>struct</span> <span>whisper_context</span> <span>*</span><span>ctx_wsp</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="57"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR57"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>struct</span> <span>whisper_vad_context</span> <span>*</span><span>ctx_vad</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="58"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR58"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>struct</span> <span>whisper_vad_params</span> <span>vad_params</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="59"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR59"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="60"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR60"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>float</span> <span>*</span><span>audio_buffer</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="61"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR61"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>audio_buffer_queue_size</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="62"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR62"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>audio_buffer_fill_size</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="63"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR63"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>audio_buffer_vad_size</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="64"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR64"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int64_t</span> <span>audio_buffer_start_ms</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="65"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR65"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="66"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR66"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>eof</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="67"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR67"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int64_t</span> <span>next_pts</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="68"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR68"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="69"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR69"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVIOContext</span> <span>*</span><span>avio_context</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="70"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR70"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>index</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="71"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR71"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span> <span>WhisperContext</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="72"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR72"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="73"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR73"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>void</span> <span>cb_log</span><span>(</span><span>enum</span> <span>ggml_log_level</span> <span>level</span><span>,</span> <span>const</span> <span>char</span> <span>*</span><span>text</span><span>,</span> <span>void</span> <span>*</span><span>user_data</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="74"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR74"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="75"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR75"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFilterContext</span> <span>*</span><span>ctx</span> <span>=</span> <span>user_data</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="76"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR76"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>av_log_level</span> <span>=</span> <span>AV_LOG_DEBUG</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="77"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR77"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>switch</span> <span>(</span><span>level</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="78"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR78"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>case</span> <span>GGML_LOG_LEVEL_ERROR</span><span>:</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="79"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR79"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log_level</span> <span>=</span> <span>AV_LOG_ERROR</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="80"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR80"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>break</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="81"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR81"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>case</span> <span>GGML_LOG_LEVEL_WARN</span><span>:</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="82"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR82"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log_level</span> <span>=</span> <span>AV_LOG_WARNING</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="83"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR83"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>break</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="84"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR84"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="85"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR85"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>av_log_level</span><span>,</span> <span></span><span>&#34;</span><span>%s</span><span>&#34;</span><span>,</span> <span>text</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="86"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR86"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="87"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR87"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="88"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR88"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>int</span> <span>init</span><span>(</span><span>AVFilterContext</span> <span>*</span><span>ctx</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="89"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR89"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="90"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR90"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>WhisperContext</span> <span>*</span><span>wctx</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>priv</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="91"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR91"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="92"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR92"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>static</span> <span>AVOnce</span> <span>init_static_once</span> <span>=</span> <span>AV_ONCE_INIT</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="93"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR93"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>ff_thread_once</span><span>(</span><span>&amp;</span><span>init_static_once</span><span>,</span> <span>ggml_backend_load_all</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="94"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR94"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="95"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR95"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>whisper_log_set</span><span>(</span><span>cb_log</span><span>,</span> <span>ctx</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="96"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR96"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="97"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR97"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>// Init whisper context
</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="98"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR98"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>wctx</span><span>-</span><span>&gt;</span><span>model_path</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="99"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR99"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_ERROR</span><span>,</span> <span></span><span>&#34;</span><span>No whisper model path specified. Use the &#39;model&#39; option.</span><span>\n</span><span>&#34;</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="100"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR100"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>AVERROR</span><span>(</span><span>EINVAL</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="101"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR101"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="102"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR102"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="103"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR103"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>struct</span> <span>whisper_context_params</span> <span>params</span> <span>=</span> <span>whisper_context_default_params</span><span>(</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="104"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR104"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>use_gpu</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>use_gpu</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="105"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR105"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>gpu_device</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>gpu_device</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="106"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR106"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="107"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR107"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span> <span>=</span> <span>whisper_init_from_file_with_params</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>model_path</span><span>,</span> <span>params</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="108"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR108"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span> <span>=</span><span>=</span> <span>NULL</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="109"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR109"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_ERROR</span><span>,</span> <span></span><span>&#34;</span><span>Failed to initialize whisper context from model: %s</span><span>\n</span><span>&#34;</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>model_path</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="110"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR110"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>AVERROR</span><span>(</span><span>EIO</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="111"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR111"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="112"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR112"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="113"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR113"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>// Init buffer
</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="114"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR114"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_queue_size</span> <span>=</span> <span>av_rescale</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>queue</span><span>,</span> <span>WHISPER_SAMPLE_RATE</span><span>,</span> <span>AV_TIME_BASE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="115"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR115"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span> <span>=</span> <span>av_malloc_array</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_queue_size</span><span>,</span> <span>sizeof</span><span>(</span><span>*</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>)</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="116"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR116"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="117"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR117"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>AVERROR</span><span>(</span><span>ENOMEM</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="118"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR118"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="119"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR119"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>// Init VAD model context
</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="120"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR120"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>vad_model_path</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="121"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR121"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>struct</span> <span>whisper_vad_context_params</span> <span>ctx_params</span> <span>=</span> <span>whisper_vad_default_context_params</span><span>(</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="122"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR122"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>ctx_params</span><span>.</span><span>n_threads</span> <span>=</span> <span>ff_filter_get_nb_threads</span><span>(</span><span>ctx</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="123"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR123"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>// ctx_params.use_gpu = wctx-&gt;use_gpu; TODO (see: whisper_vad_init_context)
</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="124"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR124"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>ctx_params</span><span>.</span><span>gpu_device</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>gpu_device</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="125"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR125"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>ctx_vad</span> <span>=</span> <span>whisper_vad_init_from_file_with_params</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>vad_model_path</span><span>,</span> <span>ctx_params</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="126"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR126"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="127"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR127"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span> <span>=</span> <span>whisper_vad_default_params</span><span>(</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="128"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR128"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>.</span><span>threshold</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>vad_threshold</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="129"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR129"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>.</span><span>min_speech_duration_ms</span> <span>=</span> <span>av_rescale</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>vad_min_speech_duration</span><span>,</span> <span>1000</span><span>,</span> <span>AV_TIME_BASE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="130"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR130"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>.</span><span>min_silence_duration_ms</span> <span>=</span> <span>av_rescale</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>vad_min_silence_duration</span><span>,</span> <span>1000</span><span>,</span> <span>AV_TIME_BASE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="131"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR131"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>.</span><span>max_speech_duration_s</span> <span>=</span> <span>av_rescale</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>queue</span><span>,</span> <span>1</span><span>,</span> <span>AV_TIME_BASE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="132"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR132"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>.</span><span>speech_pad_ms</span> <span>=</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="133"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR133"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>.</span><span>samples_overlap</span> <span>=</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="134"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR134"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="135"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR135"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="136"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR136"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>next_pts</span> <span>=</span> <span>AV_NOPTS_VALUE</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="137"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR137"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="138"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR138"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>destination</span> <span>&amp;</span><span>&amp;</span> <span>strcmp</span><span>(</span><span></span><span>&#34;</span><span>&#34;</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>destination</span><span>)</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="139"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR139"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>const</span> <span>char</span> <span>*</span><span>dst</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>destination</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="140"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR140"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>!</span><span>strcmp</span><span>(</span><span></span><span>&#34;</span><span>-</span><span>&#34;</span><span>,</span> <span>dst</span><span>)</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="141"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR141"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>dst</span> <span>=</span> <span></span><span>&#34;</span><span>pipe:1</span><span>&#34;</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="142"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR142"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>int</span> <span>ret</span> <span>=</span> <span>avio_open</span><span>(</span><span>&amp;</span><span>wctx</span><span>-</span><span>&gt;</span><span>avio_context</span><span>,</span> <span>dst</span><span>,</span> <span>AVIO_FLAG_WRITE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="143"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR143"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="144"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR144"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>ret</span> <span>&lt;</span> <span>0</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="145"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR145"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_ERROR</span><span>,</span> <span></span><span>&#34;</span><span>Could not open %s: %s</span><span>\n</span><span>&#34;</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>destination</span><span>,</span> <span>av_err2str</span><span>(</span><span>ret</span><span>)</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="146"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR146"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>return</span> <span>ret</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="147"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR147"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="148"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR148"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="149"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR149"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>avio_context</span><span>-</span><span>&gt;</span><span>direct</span> <span>=</span> <span>AVIO_FLAG_DIRECT</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="150"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR150"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="151"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR151"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="152"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR152"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_INFO</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="153"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR153"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>           <span></span><span>&#34;</span><span>Whisper filter initialized: model: %s lang: %s queue: %ld ms</span><span>\n</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="154"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR154"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>           <span>wctx</span><span>-</span><span>&gt;</span><span>model_path</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>language</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>queue</span> <span>/</span> <span>1000</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="155"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR155"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="156"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR156"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>return</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="157"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR157"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="158"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR158"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="159"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR159"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>void</span> <span>uninit</span><span>(</span><span>AVFilterContext</span> <span>*</span><span>ctx</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="160"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR160"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="161"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR161"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>WhisperContext</span> <span>*</span><span>wctx</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>priv</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="162"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR162"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="163"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR163"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>&gt;</span> <span>0</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="164"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR164"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_WARNING</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="165"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR165"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>               <span></span><span>&#34;</span><span>Remaining audio buffer %d samples (%d seconds) after stopping</span><span>\n</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="166"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR166"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>               <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>/</span> <span>WHISPER_SAMPLE_RATE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="167"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR167"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="168"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR168"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="169"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR169"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_vad</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="170"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR170"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>whisper_vad_free</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_vad</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="171"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR171"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>ctx_vad</span> <span>=</span> <span>NULL</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="172"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR172"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="173"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR173"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="174"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR174"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="175"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR175"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>whisper_free</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="176"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR176"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span> <span>=</span> <span>NULL</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="177"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR177"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="178"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR178"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="179"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR179"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>av_freep</span><span>(</span><span>&amp;</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="180"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR180"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="181"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR181"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>avio_context</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="182"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR182"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>avio_closep</span><span>(</span><span>&amp;</span><span>wctx</span><span>-</span><span>&gt;</span><span>avio_context</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="183"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR183"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="184"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR184"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="185"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR185"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>void</span> <span>run_transcription</span><span>(</span><span>AVFilterContext</span> <span>*</span><span>ctx</span><span>,</span> <span>AVFrame</span> <span>*</span><span>frame</span><span>,</span> <span>int</span> <span>samples</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="186"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR186"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="187"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR187"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>WhisperContext</span> <span>*</span><span>wctx</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>priv</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="188"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR188"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>samples</span> <span>=</span> <span>FFMAX</span><span>(</span><span>0</span><span>,</span> <span>FFMIN</span><span>(</span><span>samples</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>)</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="189"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR189"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="190"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR190"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span> <span>|</span><span>|</span> <span>samples</span> <span>=</span><span>=</span> <span>0</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="191"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR191"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="192"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR192"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="193"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR193"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>const</span> <span>int64_t</span> <span>timestamp_ms</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_start_ms</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="194"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR194"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>const</span> <span>float</span> <span>duration</span> <span>=</span> <span>(</span><span>float</span><span>)</span> <span>samples</span> <span>/</span> <span>WHISPER_SAMPLE_RATE</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="195"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR195"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="196"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR196"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_INFO</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="197"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR197"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>           <span></span><span>&#34;</span><span>run transcription at %ld ms, %d/%d samples (%.2f seconds)...</span><span>\n</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="198"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR198"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>           <span>timestamp_ms</span><span>,</span> <span>samples</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>,</span> <span>duration</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="199"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR199"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="200"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR200"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>struct</span> <span>whisper_full_params</span> <span>params</span> <span>=</span> <span>whisper_full_default_params</span><span>(</span><span>WHISPER_SAMPLING_GREEDY</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="201"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR201"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>language</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>language</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="202"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR202"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>n_threads</span> <span>=</span> <span>ff_filter_get_nb_threads</span><span>(</span><span>ctx</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="203"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR203"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>print_special</span> <span>=</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="204"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR204"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>print_progress</span> <span>=</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="205"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR205"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>print_realtime</span> <span>=</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="206"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR206"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>params</span><span>.</span><span>print_timestamps</span> <span>=</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="207"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR207"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="208"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR208"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>whisper_full</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>,</span> <span>params</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>,</span> <span>samples</span><span>)</span> <span>!</span><span>=</span> <span>0</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="209"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR209"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_ERROR</span><span>,</span> <span></span><span>&#34;</span><span>Failed to process audio with whisper.cpp</span><span>\n</span><span>&#34;</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="210"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR210"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="211"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR211"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="212"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR212"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="213"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR213"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>const</span> <span>int</span> <span>n_segments</span> <span>=</span> <span>whisper_full_n_segments</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="214"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR214"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>char</span> <span>*</span><span>segments_text</span> <span>=</span> <span>NULL</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="215"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR215"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="216"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR216"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>for</span> <span>(</span><span>int</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>n_segments</span><span>;</span> <span>+</span><span>+</span><span>i</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="217"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR217"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>const</span> <span>char</span> <span>*</span><span>text</span> <span>=</span> <span>whisper_full_get_segment_text</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>,</span> <span>i</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="218"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR218"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>char</span> <span>*</span><span>text_cleaned</span> <span>=</span> <span>av_strireplace</span><span>(</span><span>text</span> <span>+</span> <span>1</span><span>,</span> <span></span><span>&#34;</span><span>[BLANK_AUDIO]</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>&#34;</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="219"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR219"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="220"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR220"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>av_strnlen</span><span>(</span><span>text_cleaned</span><span>,</span> <span>1</span><span>)</span> <span>=</span><span>=</span> <span>0</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="221"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR221"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>av_freep</span><span>(</span><span>&amp;</span><span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="222"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR222"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>continue</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="223"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR223"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="224"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR224"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="225"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR225"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>const</span> <span>bool</span> <span>turn</span> <span>=</span> <span>whisper_full_get_segment_speaker_turn_next</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>,</span> <span>i</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="226"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR226"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>const</span> <span>int64_t</span> <span>t0_ms</span> <span>=</span> <span>whisper_full_get_segment_t0</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>,</span> <span>i</span><span>)</span> <span>*</span> <span>10</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="227"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR227"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>const</span> <span>int64_t</span> <span>t1_ms</span> <span>=</span> <span>whisper_full_get_segment_t1</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_wsp</span><span>,</span> <span>i</span><span>)</span> <span>*</span> <span>10</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="228"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR228"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="229"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR229"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_DEBUG</span><span>,</span> <span></span><span>&#34;</span><span>  [%ld-%ld%s]: </span><span>\&#34;</span><span>%s</span><span>\&#34;</span><span>\n</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="230"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR230"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>               <span>timestamp_ms</span> <span>+</span> <span>t0_ms</span><span>,</span> <span>timestamp_ms</span> <span>+</span> <span>t1_ms</span><span>,</span> <span>turn</span> <span>?</span> <span></span><span>&#34;</span><span> (turn)</span><span>&#34;</span> <span>:</span> <span></span><span>&#34;</span><span>&#34;</span><span>,</span> <span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="231"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR231"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="232"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR232"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>segments_text</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="233"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR233"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>char</span> <span>*</span><span>new_text</span> <span>=</span> <span>av_asprintf</span><span>(</span><span></span><span>&#34;</span><span>%s%s</span><span>&#34;</span><span>,</span> <span>segments_text</span><span>,</span> <span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="234"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR234"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>av_freep</span><span>(</span><span>&amp;</span><span>segments_text</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="235"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR235"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>segments_text</span> <span>=</span> <span>new_text</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="236"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR236"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>}</span> <span>else</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="237"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR237"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>segments_text</span> <span>=</span> <span>av_strdup</span><span>(</span><span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="238"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR238"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="239"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR239"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>avio_context</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="240"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR240"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>const</span> <span>int64_t</span> <span>start_t</span> <span>=</span> <span>timestamp_ms</span> <span>+</span> <span>t0_ms</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="241"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR241"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>const</span> <span>int64_t</span> <span>end_t</span> <span>=</span> <span>timestamp_ms</span> <span>+</span> <span>t1_ms</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="242"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR242"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>char</span> <span>*</span><span>buf</span> <span>=</span> <span>NULL</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="243"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR243"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="244"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR244"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>if</span> <span>(</span><span>!</span><span>av_strcasecmp</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>format</span><span>,</span> <span></span><span>&#34;</span><span>srt</span><span>&#34;</span><span>)</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="245"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR245"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>buf</span> <span>=</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="246"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR246"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                    <span>av_asprintf</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="247"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR247"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                    <span>(</span><span></span><span>&#34;</span><span>%d</span><span>\n</span><span>%02ld:%02ld:%02ld.%03ld --&gt; %02ld:%02ld:%02ld.%03ld</span><span>\n</span><span>%s</span><span>\n</span><span>\n</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="248"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR248"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                     <span>wctx</span><span>-</span><span>&gt;</span><span>index</span><span>,</span> <span>start_t</span> <span>/</span> <span>3600000</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="249"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR249"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                     <span>(</span><span>start_t</span> <span>/</span> <span>60000</span><span>)</span> <span>%</span> <span>60</span><span>,</span> <span>(</span><span>start_t</span> <span>/</span> <span>1000</span><span>)</span> <span>%</span> <span>60</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="250"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR250"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                     <span>start_t</span> <span>%</span> <span>1000</span><span>,</span> <span>end_t</span> <span>/</span> <span>3600000</span><span>,</span> <span>(</span><span>end_t</span> <span>/</span> <span>60000</span><span>)</span> <span>%</span> <span>60</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="251"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR251"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                     <span>(</span><span>end_t</span> <span>/</span> <span>1000</span><span>)</span> <span>%</span> <span>60</span><span>,</span> <span>end_t</span> <span>%</span> <span>1000</span><span>,</span> <span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="252"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR252"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>}</span> <span>else</span> <span>if</span> <span>(</span><span>!</span><span>av_strcasecmp</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>format</span><span>,</span> <span></span><span>&#34;</span><span>json</span><span>&#34;</span><span>)</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="253"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR253"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>buf</span> <span>=</span> <span>av_asprintf</span><span>(</span><span></span><span>&#34;</span><span>{</span><span>\&#34;</span><span>start</span><span>\&#34;</span><span>:%ld,</span><span>\&#34;</span><span>end</span><span>\&#34;</span><span>:%ld,</span><span>\&#34;</span><span>text</span><span>\&#34;</span><span>:</span><span>\&#34;</span><span>%s</span><span>\&#34;</span><span>}</span><span>\n</span><span>&#34;</span><span>,</span> <span>start_t</span><span>,</span> <span>end_t</span><span>,</span> <span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="254"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR254"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>}</span> <span>else</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="255"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR255"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>buf</span> <span>=</span> <span>av_strdup</span><span>(</span><span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="256"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR256"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="257"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR257"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>if</span> <span>(</span><span>buf</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="258"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR258"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>avio_write</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>avio_context</span><span>,</span> <span>buf</span><span>,</span> <span>strlen</span><span>(</span><span>buf</span><span>)</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="259"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR259"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>av_freep</span><span>(</span><span>&amp;</span><span>buf</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="260"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR260"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="261"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR261"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="262"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR262"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="263"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR263"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_freep</span><span>(</span><span>&amp;</span><span>text_cleaned</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="264"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR264"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="265"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR265"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="266"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR266"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>index</span><span>+</span><span>+</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="267"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR267"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="268"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR268"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVDictionary</span> <span>*</span><span>*</span><span>metadata</span> <span>=</span> <span>&amp;</span><span>frame</span><span>-</span><span>&gt;</span><span>metadata</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="269"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR269"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>metadata</span> <span>&amp;</span><span>&amp;</span> <span>segments_text</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="270"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR270"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_dict_set</span><span>(</span><span>metadata</span><span>,</span> <span></span><span>&#34;</span><span>lavfi.whisper.text</span><span>&#34;</span><span>,</span> <span>segments_text</span><span>,</span> <span>0</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="271"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR271"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>char</span> <span>*</span><span>duration_text</span> <span>=</span> <span>av_asprintf</span><span>(</span><span></span><span>&#34;</span><span>%f</span><span>&#34;</span><span>,</span> <span>duration</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="272"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR272"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_dict_set</span><span>(</span><span>metadata</span><span>,</span> <span></span><span>&#34;</span><span>lavfi.whisper.duration</span><span>&#34;</span><span>,</span> <span>duration_text</span><span>,</span> <span>AV_DICT_DONT_STRDUP_VAL</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="273"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR273"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="274"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR274"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>av_freep</span><span>(</span><span>&amp;</span><span>segments_text</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="275"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR275"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="276"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR276"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>&gt;</span> <span>samples</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="277"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR277"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>memcpy</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span> <span>+</span> <span>samples</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="278"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR278"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>               <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>-</span> <span>samples</span><span>)</span> <span>*</span> <span>sizeof</span><span>(</span><span>*</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>)</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="279"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR279"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_start_ms</span> <span>+</span><span>=</span> <span>duration</span> <span>*</span> <span>1000</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="280"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR280"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="281"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR281"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>-</span><span>=</span> <span>samples</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="282"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR282"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_vad_size</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="283"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR283"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="284"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR284"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="285"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR285"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>int</span> <span>filter_frame</span><span>(</span><span>AVFilterLink</span> <span>*</span><span>inlink</span><span>,</span> <span>AVFrame</span> <span>*</span><span>frame</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="286"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR286"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="287"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR287"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFilterContext</span> <span>*</span><span>ctx</span> <span>=</span> <span>inlink</span><span>-</span><span>&gt;</span><span>dst</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="288"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR288"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>WhisperContext</span> <span>*</span><span>wctx</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>priv</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="289"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR289"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFilterLink</span> <span>*</span><span>outlink</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>outputs</span><span>[</span><span>0</span><span>]</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="290"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR290"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="291"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR291"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>const</span> <span>int</span> <span>samples</span> <span>=</span> <span>frame</span><span>-</span><span>&gt;</span><span>nb_samples</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="292"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR292"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>const</span> <span>float</span> <span>*</span><span>input_data</span> <span>=</span> <span>(</span><span>const</span> <span>float</span> <span>*</span><span>)</span> <span>frame</span><span>-</span><span>&gt;</span><span>data</span><span>[</span><span>0</span><span>]</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="293"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR293"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="294"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR294"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>+</span> <span>samples</span> <span>&gt;</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_queue_size</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="295"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR295"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>run_transcription</span><span>(</span><span>ctx</span><span>,</span> <span>frame</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="296"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR296"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="297"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR297"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="298"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR298"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="299"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR299"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_start_ms</span> <span>=</span> <span>av_rescale_q</span><span>(</span><span>frame</span><span>-</span><span>&gt;</span><span>pts</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="300"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR300"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                                   <span>(</span><span>AVRational</span><span>)</span> <span>{</span><span>1000</span><span>,</span> <span>1</span><span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="301"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR301"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                                   <span>(</span><span>AVRational</span><span>)</span> <span>{</span><span>inlink</span><span>-</span><span>&gt;</span><span>time_base</span><span>.</span><span>den</span><span>,</span> <span>inlink</span><span>-</span><span>&gt;</span><span>time_base</span><span>.</span><span>num</span><span>}</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="302"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR302"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>memcpy</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span> <span>+</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>,</span> <span>input_data</span><span>,</span> <span>samples</span> <span>*</span> <span>sizeof</span><span>(</span><span>*</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>)</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="303"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR303"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>+</span><span>=</span> <span>samples</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="304"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR304"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="305"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR305"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_vad</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="306"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR306"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>&amp;</span><span>&amp;</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>-</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_vad_size</span><span>)</span> <span>&gt;</span><span>=</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="307"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR307"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>av_rescale</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>vad_min_speech_duration</span> <span>+</span> <span>wctx</span><span>-</span><span>&gt;</span><span>vad_min_silence_duration</span><span>,</span> <span>WHISPER_SAMPLE_RATE</span><span>,</span> <span>AV_TIME_BASE</span><span>)</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="308"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR308"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>struct</span> <span>whisper_vad_segments</span> <span>*</span><span>segments</span> <span>=</span> <span>whisper_vad_segments_from_samples</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>ctx_vad</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="309"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR309"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                                                                  <span>wctx</span><span>-</span><span>&gt;</span><span>vad_params</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="310"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR310"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                                                                  <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="311"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR311"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                                                                  <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="312"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR312"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_vad_size</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="313"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR313"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="314"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR314"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>!</span><span>segments</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="315"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR315"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_ERROR</span><span>,</span> <span></span><span>&#34;</span><span>failed to detect VAD</span><span>\n</span><span>&#34;</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="316"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR316"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>}</span> <span>else</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="317"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR317"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>int</span> <span>n_segments</span> <span>=</span> <span>whisper_vad_segments_n_segments</span><span>(</span><span>segments</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="318"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR318"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="319"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR319"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>if</span> <span>(</span><span>n_segments</span> <span>&gt;</span> <span>0</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="320"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR320"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>const</span> <span>float</span> <span>start_ms</span> <span>=</span> <span>whisper_vad_segments_get_segment_t0</span><span>(</span><span>segments</span><span>,</span> <span>0</span><span>)</span> <span>*</span> <span>10.0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="321"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR321"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>const</span> <span>float</span> <span>end_ms</span> <span>=</span> <span>whisper_vad_segments_get_segment_t1</span><span>(</span><span>segments</span><span>,</span> <span>n_segments</span> <span>-</span> <span>1</span><span>)</span> <span>*</span> <span>10.0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="322"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR322"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>int</span> <span>end_pos</span> <span>=</span> <span>(</span><span>int</span><span>)</span> <span>(</span><span>end_ms</span> <span>*</span> <span>WHISPER_SAMPLE_RATE</span> <span>/</span> <span>1000</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="323"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR323"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="324"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR324"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>if</span> <span>(</span><span>end_pos</span> <span>&lt;</span><span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>-</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="325"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR325"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                    <span>av_rescale</span><span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>vad_min_silence_duration</span><span>,</span> <span>WHISPER_SAMPLE_RATE</span><span>,</span> <span>AV_TIME_BASE</span><span>)</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="326"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR326"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                    <span>av_log</span><span>(</span><span>ctx</span><span>,</span> <span>AV_LOG_INFO</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="327"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR327"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                            <span></span><span>&#34;</span><span>VAD detected %d segments, start: %.0f ms, end: %.0f ms (buffer: %d ms)</span><span>\n</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="328"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR328"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                            <span>n_segments</span><span>,</span> <span>start_ms</span><span>,</span> <span>end_ms</span><span>,</span> <span>1000</span> <span>*</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>/</span> <span>WHISPER_SAMPLE_RATE</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="329"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR329"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                    <span>run_transcription</span><span>(</span><span>ctx</span><span>,</span> <span>frame</span><span>,</span> <span>end_pos</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="330"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR330"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="331"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR331"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="332"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR332"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="333"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR333"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>whisper_vad_free_segments</span><span>(</span><span>segments</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="334"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR334"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="335"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR335"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span> <span>else</span> <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>&gt;</span><span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_queue_size</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="336"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR336"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>run_transcription</span><span>(</span><span>ctx</span><span>,</span> <span>frame</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="337"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR337"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="338"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR338"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>wctx</span><span>-</span><span>&gt;</span><span>next_pts</span> <span>=</span> <span>frame</span><span>-</span><span>&gt;</span><span>pts</span> <span>+</span> <span>av_rescale_q</span><span>(</span><span>samples</span><span>,</span> <span>(</span><span>AVRational</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="339"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR339"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                               <span>1</span><span>,</span> <span>inlink</span><span>-</span><span>&gt;</span><span>sample_rate</span><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="340"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR340"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                               <span>,</span> <span>inlink</span><span>-</span><span>&gt;</span><span>time_base</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="341"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR341"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>return</span> <span>ff_filter_frame</span><span>(</span><span>outlink</span><span>,</span> <span>frame</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="342"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR342"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="343"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR343"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="344"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR344"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>int</span> <span>push_last_frame</span><span>(</span><span>AVFilterLink</span> <span>*</span><span>outlink</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="345"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR345"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="346"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR346"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFilterContext</span> <span>*</span><span>ctx</span> <span>=</span> <span>outlink</span><span>-</span><span>&gt;</span><span>src</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="347"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR347"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>WhisperContext</span> <span>*</span><span>wctx</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>priv</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="348"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR348"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFrame</span> <span>*</span><span>frame</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="349"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR349"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>n_out</span> <span>=</span> <span>1</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="350"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR350"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="351"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR351"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>ctx</span><span>-</span><span>&gt;</span><span>is_disabled</span> <span>|</span><span>|</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span> <span>=</span><span>=</span> <span>0</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="352"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR352"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="353"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR353"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>frame</span> <span>=</span> <span>ff_get_audio_buffer</span><span>(</span><span>outlink</span><span>,</span> <span>n_out</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="354"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR354"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>frame</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="355"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR355"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>AVERROR</span><span>(</span><span>ENOMEM</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="356"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR356"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="357"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR357"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>av_samples_set_silence</span><span>(</span><span>frame</span><span>-</span><span>&gt;</span><span>extended_data</span><span>,</span> <span>0</span><span>,</span> <span>n_out</span><span>,</span> <span>frame</span><span>-</span><span>&gt;</span><span>ch_layout</span><span>.</span><span>nb_channels</span><span>,</span> <span>frame</span><span>-</span><span>&gt;</span><span>format</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="358"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR358"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="359"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR359"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>frame</span><span>-</span><span>&gt;</span><span>pts</span> <span>=</span> <span>wctx</span><span>-</span><span>&gt;</span><span>next_pts</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="360"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR360"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>next_pts</span> <span>!</span><span>=</span> <span>AV_NOPTS_VALUE</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="361"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR361"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>next_pts</span> <span>+</span><span>=</span> <span>av_rescale_q</span><span>(</span><span>n_out</span><span>,</span> <span>(</span><span>AVRational</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="362"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR362"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                       <span>1</span><span>,</span> <span>outlink</span><span>-</span><span>&gt;</span><span>sample_rate</span><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="363"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR363"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                                       <span>,</span> <span>outlink</span><span>-</span><span>&gt;</span><span>time_base</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="364"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR364"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="365"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR365"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>run_transcription</span><span>(</span><span>ctx</span><span>,</span> <span>frame</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>audio_buffer_fill_size</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="366"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR366"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="367"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR367"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>return</span> <span>ff_filter_frame</span><span>(</span><span>outlink</span><span>,</span> <span>frame</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="368"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR368"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="369"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR369"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="370"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR370"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>int</span> <span>activate</span><span>(</span><span>AVFilterContext</span> <span>*</span><span>ctx</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="371"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR371"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="372"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR372"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFilterLink</span> <span>*</span><span>inlink</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>inputs</span><span>[</span><span>0</span><span>]</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="373"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR373"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVFilterLink</span> <span>*</span><span>outlink</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>outputs</span><span>[</span><span>0</span><span>]</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="374"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR374"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>WhisperContext</span> <span>*</span><span>wctx</span> <span>=</span> <span>ctx</span><span>-</span><span>&gt;</span><span>priv</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="375"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR375"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int64_t</span> <span>pts</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="376"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR376"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>status</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="377"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR377"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="378"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR378"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>FF_FILTER_FORWARD_STATUS_BACK</span><span>(</span><span>outlink</span><span>,</span> <span>inlink</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="379"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR379"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="380"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR380"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>wctx</span><span>-</span><span>&gt;</span><span>eof</span> <span>&amp;</span><span>&amp;</span> <span>ff_inlink_queued_frames</span><span>(</span><span>inlink</span><span>)</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="381"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR381"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>AVFrame</span> <span>*</span><span>frame</span> <span>=</span> <span>NULL</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="382"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR382"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>int</span> <span>ret</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="383"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR383"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="384"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR384"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>ret</span> <span>=</span> <span>ff_inlink_consume_frame</span><span>(</span><span>inlink</span><span>,</span> <span>&amp;</span><span>frame</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="385"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR385"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>ret</span> <span>&lt;</span> <span>0</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="386"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR386"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>return</span> <span>ret</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="387"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR387"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>if</span> <span>(</span><span>ret</span> <span>&gt;</span> <span>0</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="388"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR388"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>            <span>return</span> <span>filter_frame</span><span>(</span><span>inlink</span><span>,</span> <span>frame</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="389"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR389"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="390"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR390"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="391"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR391"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>!</span><span>wctx</span><span>-</span><span>&gt;</span><span>eof</span> <span>&amp;</span><span>&amp;</span> <span>ff_inlink_acknowledge_status</span><span>(</span><span>inlink</span><span>,</span> <span>&amp;</span><span>status</span><span>,</span> <span>&amp;</span><span>pts</span><span>)</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="392"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR392"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>wctx</span><span>-</span><span>&gt;</span><span>eof</span> <span>=</span> <span>status</span> <span>=</span><span>=</span> <span>AVERROR_EOF</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="393"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR393"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="394"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR394"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>wctx</span><span>-</span><span>&gt;</span><span>eof</span><span>)</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="395"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR395"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>push_last_frame</span><span>(</span><span>outlink</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="396"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR396"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="397"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR397"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>ff_outlink_set_status</span><span>(</span><span>outlink</span><span>,</span> <span>AVERROR_EOF</span><span>,</span> <span>wctx</span><span>-</span><span>&gt;</span><span>next_pts</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="398"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR398"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>0</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="399"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR399"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="400"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR400"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="401"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR401"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>FF_FILTER_FORWARD_WANTED</span><span>(</span><span>outlink</span><span>,</span> <span>inlink</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="402"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR402"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="403"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR403"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>return</span> <span>FFERROR_NOT_READY</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="404"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR404"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="405"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR405"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="406"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR406"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>int</span> <span>query_formats</span><span>(</span><span>const</span> <span>AVFilterContext</span> <span>*</span><span>ctx</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="407"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR407"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                         <span>AVFilterFormatsConfig</span> <span>*</span><span>*</span><span>cfg_in</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="408"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR408"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>                         <span>AVFilterFormatsConfig</span> <span>*</span><span>*</span><span>cfg_out</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="409"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR409"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="410"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR410"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>static</span> <span>const</span> <span>enum</span> <span>AVSampleFormat</span> <span>sample_fmts</span><span>[</span><span>]</span> <span>=</span> <span>{</span> <span>AV_SAMPLE_FMT_FLT</span><span>,</span> <span>AV_SAMPLE_FMT_NONE</span> <span>}</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="411"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR411"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>AVChannelLayout</span> <span>chlayouts</span><span>[</span><span>]</span> <span>=</span> <span>{</span> <span>FF_COUNT2LAYOUT</span><span>(</span><span>1</span><span>)</span><span>,</span> <span>{</span> <span>0</span> <span>}</span> <span>}</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="412"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR412"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>sample_rates</span><span>[</span><span>]</span> <span>=</span> <span>{</span> <span>WHISPER_SAMPLE_RATE</span><span>,</span> <span>-</span><span>1</span> <span>}</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="413"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR413"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>int</span> <span>ret</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="414"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR414"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="415"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR415"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>ret</span> <span>=</span> <span>ff_set_common_formats_from_list2</span><span>(</span><span>ctx</span><span>,</span> <span>cfg_in</span><span>,</span> <span>cfg_out</span><span>,</span> <span>sample_fmts</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="416"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR416"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>ret</span> <span>&lt;</span> <span>0</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="417"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR417"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>ret</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="418"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR418"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="419"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR419"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>ret</span> <span>=</span> <span>ff_set_common_channel_layouts_from_list2</span><span>(</span><span>ctx</span><span>,</span> <span>cfg_in</span><span>,</span> <span>cfg_out</span><span>,</span> <span>chlayouts</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="420"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR420"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>if</span> <span>(</span><span>ret</span> <span>&lt;</span> <span>0</span><span>)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="421"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR421"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>        <span>return</span> <span>ret</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="422"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR422"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="423"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR423"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>return</span> <span>ff_set_common_samplerates_from_list2</span><span>(</span><span>ctx</span><span>,</span> <span>cfg_in</span><span>,</span> <span>cfg_out</span><span>,</span> <span>sample_rates</span><span>)</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="424"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR424"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="425"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR425"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="426"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR426"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>define OFFSET(x) offsetof(WhisperContext, x)</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="427"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR427"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>define FLAGS AV_OPT_FLAG_AUDIO_PARAM | AV_OPT_FLAG_FILTERING_PARAM</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="428"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR428"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>#</span><span>define HOURS 3600000000</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="429"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR429"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="430"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR430"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>const</span> <span>AVOption</span> <span>whisper_options</span><span>[</span><span>]</span> <span>=</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="431"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR431"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>model</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Path to the whisper.cpp model file</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>model_path</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_STRING</span><span>,</span><span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span> <span>{</span> <span></span><span>&#34;</span><span>language</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Language for transcription (&#39;auto&#39; for auto-detect)</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>language</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_STRING</span><span>,</span> <span>{</span><span>.</span><span>str</span> <span>=</span> <span></span><span>&#34;</span><span>auto</span><span>&#34;</span><span>}</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="432"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR432"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>queue</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Audio queue size</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>queue</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_DURATION</span><span>,</span> <span>{</span><span>.</span><span>i64</span> <span>=</span> <span>3000000</span><span>}</span><span>,</span> <span>20000</span><span>,</span> <span>HOURS</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="433"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR433"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>use_gpu</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Use GPU for processing</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>use_gpu</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_BOOL</span><span>,</span> <span>{</span><span>.</span><span>i64</span> <span>=</span> <span>1</span><span>}</span><span>,</span> <span>0</span><span>,</span> <span>1</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="434"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR434"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>gpu_device</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>GPU device to use</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>gpu_device</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_INT</span><span>,</span> <span>{</span><span>.</span><span>i64</span> <span>=</span> <span>0</span><span>}</span><span>,</span> <span>0</span><span>,</span> <span>INT_MAX</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="435"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR435"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>destination</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Output destination</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>destination</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_STRING</span><span>,</span> <span>{</span><span>.</span><span>str</span> <span>=</span> <span></span><span>&#34;</span><span>&#34;</span><span>}</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="436"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR436"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>format</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Output format (text|srt|json)</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>format</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_STRING</span><span>,</span> <span>{</span><span>.</span><span>str</span> <span>=</span> <span></span><span>&#34;</span><span>text</span><span>&#34;</span><span>}</span><span>,</span><span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="437"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR437"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>vad_model</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Path to the VAD model file</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>vad_model_path</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_STRING</span><span>,</span><span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="438"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR438"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>vad_threshold</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>VAD threshold</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>vad_threshold</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_FLOAT</span><span>,</span> <span>{</span><span>.</span><span>dbl</span> <span>=</span> <span>0.5</span><span>}</span><span>,</span> <span>0.0</span><span>,</span> <span>1.0</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="439"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR439"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>vad_min_speech_duration</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Minimum speech duration for VAD</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>vad_min_speech_duration</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_DURATION</span><span>,</span> <span>{</span><span>.</span><span>i64</span> <span>=</span> <span>100000</span><span>}</span><span>,</span> <span>20000</span><span>,</span> <span>HOURS</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="440"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR440"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span></span><span>&#34;</span><span>vad_min_silence_duration</span><span>&#34;</span><span>,</span> <span></span><span>&#34;</span><span>Minimum silence duration for VAD</span><span>&#34;</span><span>,</span> <span>OFFSET</span><span>(</span><span>vad_min_silence_duration</span><span>)</span><span>,</span> <span>AV_OPT_TYPE_DURATION</span><span>,</span> <span>{</span><span>.</span><span>i64</span> <span>=</span> <span>500000</span><span>}</span><span>,</span> <span>0</span><span>,</span> <span>HOURS</span><span>,</span> <span>.</span><span>flags</span> <span>=</span> <span>FLAGS</span> <span>}</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="441"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR441"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>{</span> <span>NULL</span> <span>}</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="442"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR442"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="443"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR443"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="444"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR444"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>static</span> <span>const</span> <span>AVClass</span> <span>whisper_class</span> <span>=</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="445"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR445"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>class_name</span> <span>=</span> <span></span><span>&#34;</span><span>whisper</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="446"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR446"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>item_name</span> <span>=</span> <span>av_default_item_name</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="447"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR447"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>option</span> <span>=</span> <span>whisper_options</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="448"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR448"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>version</span> <span>=</span> <span>LIBAVUTIL_VERSION_INT</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="449"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR449"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span><span>;</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="450"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR450"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>
</code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="451"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR451"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>const</span> <span>FFFilter</span> <span>ff_af_whisper</span> <span>=</span> <span>{</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="452"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR452"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>p</span><span>.</span><span>name</span> <span>=</span> <span></span><span>&#34;</span><span>whisper</span><span>&#34;</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="453"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR453"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>p</span><span>.</span><span>description</span> <span>=</span> <span>NULL_IF_CONFIG_SMALL</span><span>(</span><span></span><span>&#34;</span><span>Transcribe audio using whisper.cpp.</span><span>&#34;</span><span>)</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="454"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR454"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>p</span><span>.</span><span>priv_class</span> <span>=</span> <span>&amp;</span><span>whisper_class</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="455"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR455"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>p</span><span>.</span><span>flags</span> <span>=</span> <span>AVFILTER_FLAG_METADATA_ONLY</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="456"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR456"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>init</span> <span>=</span> <span>init</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="457"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR457"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>uninit</span> <span>=</span> <span>uninit</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="458"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR458"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>activate</span> <span>=</span> <span>activate</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="459"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR459"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>.</span><span>priv_size</span> <span>=</span> <span>sizeof</span><span>(</span><span>WhisperContext</span><span>)</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="460"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR460"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>FILTER_INPUTS</span><span>(</span><span>ff_audio_default_filterpad</span><span>)</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="461"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR461"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>FILTER_OUTPUTS</span><span>(</span><span>ff_audio_default_filterpad</span><span>)</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="462"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR462"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code>    <span>FILTER_QUERY_FUNC2</span><span>(</span><span>query_formats</span><span>)</span><span>,</span></code>
</td>
			
		</tr>
		
	
		<tr data-line-type="add">
			
				<td data-line-num=""><span rel=""></span></td>
				<td data-line-num="463"><span rel="diff-42c18e4c94118b4f2e9ac6bdd5abae8b953854ebR463"></span></td>
			
			<td></td>
			<td><span data-type-marker="+"></span></td>
			
				<td><code><span>}</span><span>;</span></code>
</td>
			
		</tr>
		
	


										
									</div></div>
  </body>
</html>
