<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.jupyter.org/gnu-octave-meets-jupyterlite-compute-anywhere-anytime-8b033afbbcdc">Original</a>
    <h1>GNU Octave Meets JupyterLite: Compute Anywhere, Anytime</h1>
    
    <div id="readability-page-1" class="page"><article><div><div><section><div><div><div><div><div><div><div><div><div><div><div><div><div role="tooltip"><div tabindex="-1"><a href="https://medium.com/@isabel.paredes" rel="noopener follow"><div><div><p><img alt="Isabel Paredes" src="https://miro.medium.com/v2/da:true/resize:fill:64:64/1*WI4UZ5Opx-IO1yAT_N1OAA.gif" width="32" height="32" loading="lazy" data-testid="authorPhoto"/></p></div></div></a></div></div></div></div></div></div></div></div></div></div><figure><div role="button" tabindex="0"><p><span>Press enter or click to view image in full size</span></p><div><picture><source srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Ha5vHmLH66mSH3WFg1fxg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcset="https://miro.medium.com/v2/resize:fit:640/1*_Ha5vHmLH66mSH3WFg1fxg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_Ha5vHmLH66mSH3WFg1fxg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_Ha5vHmLH66mSH3WFg1fxg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_Ha5vHmLH66mSH3WFg1fxg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_Ha5vHmLH66mSH3WFg1fxg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_Ha5vHmLH66mSH3WFg1fxg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_Ha5vHmLH66mSH3WFg1fxg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="Octave-lite logo" width="700" height="394" loading="eager"/></picture></div></div></figure><p id="249e">We are thrilled to announce the newest member of our JupyterLite kernel ecosystem: <strong>Xeus-Octave</strong>. Xeus-Octave allows you to run GNU Octave code directly on your browser. GNU Octave is a free and open-source Scientific Programming Language that can be used to run Matlab scripts. In this article, we present the challenges encountered when targeting WebAssembly, the current state of the Xeus-Octave kernel, and the future plans for expanding the GNU Octave ecosystem.</p></div></div></div><div><div><div><p id="ba09">Earlier this year, we introduced the JupyterLite kernel for R, <a href="https://medium.com/jupyter-blog/r-in-the-browser-announcing-our-webassembly-distribution-9450e9539ed5" rel="noopener"><strong>Xeus-R-Lite</strong></a>. Much like R, cross-compiling GNU Octave to WebAssembly required the same custom toolchain to enable the compilation of Fortran code, combining LLVM Flang and Emscripten.</p><p id="fa89">Similar to many other mathematically oriented language packages, GNU Octave requires a BLAS/LAPACK implementation. Fortunately, OpenBLAS and the Netlib implementations of BLAS/LAPACK had already been added to the emscripten-forge WebAssembly distribution. Initially, OpenBLAS was the preferred implementation, but for the successful compilation of Octave, Netlib LAPACK was selected as it presented fewer hurdles during the build process.</p></div></div></div><div><div><div><h2 id="ceaa">Cross-Compilation of GNU Octave</h2><p id="0b34">One of the complications of cross-compiling Octave to WebAssembly, which had not been encountered with the R source code, was the extensive use of Fortran common symbols blocks in the internal libraries of Octave such as odepack.</p><pre><span id="d9d4">C Source: liboctave/external/odepack/slsode.f</span></pre><p id="04ea">Initially, it was not possible to cross-compile these common blocks to WebAssembly because the latest version of LLVM (v20 at the time of testing) did not support common symbol linkage.</p><pre><span id="b201">// Source: llvm/lib/MC/MCWasmStreamer.cpp</span></pre><p id="ee69">As a temporary solution, LLVM was patched with the help of <a href="https://github.com/serge-sans-paille" rel="noopener ugc nofollow" target="_blank">Serge Guelton</a> to simulate common symbols as weak symbols.</p><pre><span id="9410">void MCWasmStreamer::emitCommonSymbol(MCSymbol *S, uint64_t Size,</span></pre><p id="d6c6">A proper solution to enable support of common symbols is currently in progress and will likely be included in the next release of LLVM v22 (see <a href="https://github.com/llvm/llvm-project/pull/151478" rel="noopener ugc nofollow" target="_blank">llvm-project/pull/151478</a>). For curious readers, the patched version of LLVM can be found <a href="https://github.com/IsabelParedes/llvm-project/releases/download/v20.1.7_emscripten-wasm32/llvm_emscripten-wasm32-20.1.7-h2e33cc4_5.tar.bz2" rel="noopener ugc nofollow" target="_blank">here</a> (linux only).</p><p id="cba6">In addition to the patches for LLVM, GNU Octave required a few minor modifications to target WebAssembly; mainly this entailed disabling the GUI functionalities and consolidating the Fortran function signatures and calling conventions. A full list of patches can be found in the <a href="https://github.com/emscripten-forge/recipes/tree/main/recipes/recipes_emscripten/octave/patches" rel="noopener ugc nofollow" target="_blank">recipe directory</a> on emscripten-forge.</p></div></div></div><div><div><div><h2 id="ca33">Future Work</h2><p id="cec2">For our next steps, the team is planning on expanding the Octave ecosystem by adding Octave packages to both conda-forge and emscripten-forge. The packaging work will require defining a process where Octave packages can be installed in predetermined conda environments, perhaps with some minor modifications to the existing pkg utility.</p></div></div></div><div><div><div><h2 id="643a">About the Author</h2><p id="5f77"><strong>Isabel Paredes</strong>, who led the charge on bringing GNU Octave to emscripten-forge, is a senior scientific software developer at QuantStack. Prior to working on this project, she focused on porting the R programming language and the Robot Operating System (ROS) framework to WebAssembly.</p><h2 id="1e21">Acknowledgments</h2><p id="8e97">This project synthesizes work from many open-source contributors.</p><ul><li id="43e6"><a href="https://github.com/emscripten-forge/recipes/" rel="noopener ugc nofollow" target="_blank"><strong>Emscripten-forge</strong></a>, the distribution of conda packages for WebAssembly, was created by Thorsten Beier, who continues to lead the project. Many recipes were contributed by Isabel Paredes, Anutosh Bhat, Martin Renou, Ian Thomas, Wolf Vollprecht, and Johan Mabille.</li><li id="5aa5"><a href="https://jupyterlite.readthedocs.io/en/stable/?badge=latest" rel="noopener ugc nofollow" target="_blank"><strong>JupyterLite</strong></a>, the Jupyter distribution that runs entirely in the web browser, was created by Jeremy Tuloup.</li><li id="7353"><a href="https://github.com/jupyter-xeus/xeus" rel="noopener ugc nofollow" target="_blank"><strong>Xeus</strong></a>, the C++ library implementing the Jupyter kernel protocol, enabling a custom communication layer, and is foundational to kernels like xeus-r, xeus-python, running in JupyterLite, was created by Johan Mabille and is maintained by a broader team including Martin Renou, Sylvain Corlay, and Thorsten Beier, who worked on the first integration with JupyterLite.</li><li id="8f2b"><a href="https://github.com/jupyter-xeus/xeus-octave" rel="noopener ugc nofollow" target="_blank"><strong>Xeus-Octave</strong></a>, the Xeus-based Jupyter kernel for GNU Octave, was created by Giulio Girardi and Antoine Prouvost.</li></ul></div></div></div></div></section></div></div></article></div>
  </body>
</html>
