<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.datadoghq.com/state-of-aws-security/">Original</a>
    <h1>The State of AWS Security</h1>
    
    <div id="readability-page-1" class="page"><article id="state-of-aws-security"><section id="one"><div><div><div><h2>FACT 1</h2><div><figure><img loading="lazy" width="600" height="" alt="state-of-aws-security/fact-1-v2" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max"/></figure></div><p>AWS Identity and Access Management (IAM) users can be used to authenticate humans, either by setting up a password that allows access to the AWS Console or a long-lived access key that allows authentication to the AWS API. Access keys are also frequently used to authenticate workloads.</p><p>Because access keys are static credentials that do not expire, they are widely regarded as highly sensitive and a major cause of AWS security breaches. A <a href="https://res.cloudinary.com/da8kiytlc/image/upload/v1646148528/GitGuardian_StateOfSecretsSprawl2022.pdf">2022 GitGuardian study</a> found that, on average, every 10,000 Git commits leak 84 AWS access keys. Access keys are frequently leaked (e.g., in logs, build outputs, stack traces) and targeted by attacker groups such as <a href="https://attack.mitre.org/groups/G0139/">TeamTNT</a>.</p><p>In particular, we found that:</p><ul><li><strong>40 percent of IAM users have not used their credentials in the past 90 days</strong> (access key or console password), affecting 70 percent of organizations.</li><li><strong>40 percent of organizations have at least one IAM user that has AWS Console access and does not have multi-factor authentication</strong> (MFA) enabled, accounting for a 10 percent of all IAM users. Without the additional protection of MFA, these users are particularly vulnerable to credential stuffing and brute force attacks.</li></ul><p>Furthermore, among IAM users with active access keys:</p><ul><li><strong>25 percent of IAM users have an active access key that’s both older than one year and hasn’t been used in the past 30 days</strong>. This combination of characteristics typically corresponds to IAM users that are unused and should be removed.</li><li><strong>75 percent of IAM users have an active access key that’s older than 90 days</strong>. Rotating IAM access keys is highly challenging, especially at scale.</li></ul><p>This data highlights the difficulty of properly managing IAM credentials when, for instance, an employee leaves the company or an application is decommissioned. Furthermore, it reinforces the importance of not using IAM users to authenticate humans and workloads when other, safer alternatives are available, such as <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html">EC2 instance roles</a> or <a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html">Lambda execution roles</a>.</p></div><div><figure><picture><source media="(max-width: 375px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=375&amp;dpr=1.25"/><source media="(max-width: 425px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=425&amp;dpr=1.25"/><source media="(max-width: 576px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=576&amp;dpr=1.25"/><source media="(min-width: 1200px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x"/><img loading="lazy" width="960" height="" alt="state-of-aws-security/fact-1-v2" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1 1x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1.5&amp;q=65 1.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-1-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960"/></picture></figure></div></div></div><div><div><div><figure><picture><source media="(max-width: 375px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=375&amp;dpr=1.25"/><source media="(max-width: 425px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=425&amp;dpr=1.25"/><source media="(max-width: 576px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=576&amp;dpr=1.25"/><source media="(min-width: 1200px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x"/><img loading="lazy" width="960" height="" alt="state-of-aws-security/fact-2-v2" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1 1x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1.5&amp;q=65 1.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960"/></picture></figure></div><div><h2>FACT 2</h2><div><figure><img loading="lazy" width="600" height="" alt="state-of-aws-security/fact-2-v2" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-2-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max"/></figure></div><p>The root user is automatically provisioned when an AWS account is created. This user has unlimited administrative permissions. In particular, it can download any sensitive data and even completely delete the whole AWS account. To reduce risk, it is a <a href="https://docs.aws.amazon.com/accounts/latest/reference/best-practices-root-user.html">best practice</a> to avoid creating any access keys for the root user in the first place.</p><p>However, we identified that:</p><ul><li>Roughly <strong>10 percent of organizations have an active root user access key</strong>. This represents 3 percent of all AWS accounts. Some of these keys are up to 13 years old.</li><li><strong>25 percent of organizations had used root user credentials</strong> in the 30-day period preceding the making of this research.</li></ul><p>Usage of root user credentials does not always automatically signal a red flag. These credentials are required in <a href="https://docs.aws.amazon.com/accounts/latest/reference/root-user-tasks.html">highly specific situations</a>, such as changing AWS account settings. However, the overhead of maintaining active root user access keys represents a significant risk, as long-lived static credentials often end up being leaked in source code, configuration files, logs, or stack traces and are responsible for many <a href="https://github.com/ramimac/aws-customer-security-incidents">documented AWS customer security breaches</a>. Compromised root user credentials can be particularly problematic because they grant unrestricted access to the entire account.</p></div></div></div><div><div><div><h2>FACT 3</h2><div><figure><img loading="lazy" width="600" height="" alt="state-of-aws-security/fact-3-v2" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max"/></figure></div><p>When using services such as Amazon Simple Queue Service (SQS), Amazon Simple Notification Service (SNS), or Amazon S3, organizations commonly configure cross-account access by using a <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-overview-of-managing-access.html#sqs-managing-access-to-resources">resource-based IAM policy</a> attached to the resource itself.</p><p>We identified that:</p><ul><li><strong>18 percent of organizations</strong> that use SQS have at least one publicly exposed queue, allowing anyone to receive or publish messages to those queues.</li><li><strong>15 percent of organizations</strong> that use SNS have at least one publicly exposed topic, allowing anyone to perform sensitive actions against those topics (e.g., retrieving or publishing notifications).</li><li><strong>36 percent of organizations</strong> that use S3 have at least one publicly exposed bucket, representing 2 percent of all S3 buckets.</li></ul><p>We assess that this can be attributed to the complexity of creating AWS IAM policies that grant only required permissions. Creating secure IAM policies that grant least-privilege, granular permissions can be difficult in complex environments that involve many teams, applications, and ephemeral resources. After encountering one too many &#34;access denied&#34; errors, teams may find it more convenient to create less restrictive IAM policies in order to avoid bottlenecking their workflows.</p><p>This problem is so prevalent that members of the community have developed tools like <a href="https://github.com/Netflix/repokid">Repokid</a> and <a href="https://github.com/salesforce/policy_sentry/">Policy Sentry</a> to address various IAM-related pain points. Although these tools can help, they also highlight the ongoing challenges of crafting IAM policies that grant necessary permissions—and keeping them up to date as those requirements change—without blocking workflows.</p></div><div><figure><picture><source media="(max-width: 375px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=375&amp;dpr=1.25"/><source media="(max-width: 425px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=425&amp;dpr=1.25"/><source media="(max-width: 576px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=576&amp;dpr=1.25"/><source media="(min-width: 1200px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x"/><img loading="lazy" width="960" height="" alt="state-of-aws-security/fact-3-v2" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1 1x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1.5&amp;q=65 1.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-3-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960"/></picture></figure></div></div></div><div><div><div><figure><picture><source media="(max-width: 375px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=375&amp;dpr=1.25"/><source media="(max-width: 425px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=425&amp;dpr=1.25"/><source media="(max-width: 576px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=576&amp;dpr=1.25"/><source media="(min-width: 1200px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x"/><img loading="lazy" width="960" height="" alt="state-of-aws-security/fact-4-v2" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1 1x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1.5&amp;q=65 1.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960"/></picture></figure></div><div><h2>FACT 4</h2><div><figure><img loading="lazy" width="600" height="" alt="state-of-aws-security/fact-4-v2" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-4-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max"/></figure></div><p>Server-side request forgery (SSRF) is an application-level vulnerability that has been consistently and frequently exploited by attackers for years. In AWS, this type of vulnerability allows an attacker to trick an application into calling the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html">EC2 Instance Metadata Service</a> (IMDS) in order to successfully obtain credentials bound to an instance role. An attacker can then use these credentials to authenticate against the AWS API or <a href="https://hackingthe.cloud/aws/post_exploitation/aws_consoler/">access the AWS Console</a>.</p><p>This technique has been used in several high-profile incidents, such as the <a href="https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/">Capital One breach</a>, and was even called out by name by U.S. Senator Ron Wyden <a href="https://www.wyden.senate.gov/imo/media/doc/080519%20Letter%20to%20Amazon%20re%20Capital%20One%20Hack.pdf">in a letter to AWS</a>: &#34;<em>A number of cybersecurity experts have publicly speculated that the Capital One hacker exploited a Server-Side Request Forgery (SSRF) vulnerability, a flaw about which experts have been warning for years. To the best of Amazon&#39;s knowledge, was a SSRF attack used to gain access to Capital One&#39;s customer data?</em>&#34;</p><p>In 2019, AWS released <a href="https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/">version 2</a> of the EC2 IMDS (IMDSv2) to help mitigate this vulnerability. However, we identified that <strong>the vast majority of EC2 instances (93 percent) are not enforcing the usage of IMDSv2</strong>. Overall, 95 percent of organizations that use EC2 have at least one vulnerable instance.</p><p>We believe that this can be attributed to a lack of secure defaults. Unless explicitly configured to enforce version 2, newly created EC2 instances still allow the use of version 1 of the IMDS, leaving them vulnerable to <a href="https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/">SSRF attacks</a>.</p></div></div></div><div><div><div><h2>FACT 5</h2><div><figure><img loading="lazy" width="600" height="" alt="state-of-aws-security/fact-5-v2" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max"/></figure></div><p>Adopting a multi-account strategy in AWS is essential for limiting the blast radius of a compromised application or user account, among other <a href="https://docs.aws.amazon.com/whitepapers/latest/organizing-your-aws-environment/benefits-of-using-multiple-aws-accounts.html">benefits</a>. However, some early stage organizations may opt to use a single AWS account in order to reduce the overhead of creating and managing multiple accounts. Services such as <a href="https://aws.amazon.com/organizations/">AWS Organizations</a> are designed to help address this concern by centralizing account governance and automating the creation of new AWS accounts (e.g., by using infrastructure as code).</p><p>Our data shows that <strong><em>at least</em> 41 percent of organizations</strong> have adopted a multi-account strategy in AWS.</p><p>Six percent of organizations heavily implement a multi-account strategy by using more than 10 AWS accounts. Furthermore, a long tail of 0.6 percent use more than 100 AWS accounts—and some of these organizations have several thousands of AWS accounts.</p><p>These figures should be interpreted as lower bounds, because organizations using Datadog may not monitor all of their AWS accounts, such as those used for testing or development purposes.</p></div><div><figure><picture><source media="(max-width: 375px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=375&amp;dpr=1.25"/><source media="(max-width: 425px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=425&amp;dpr=1.25"/><source media="(max-width: 576px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=576&amp;dpr=1.25"/><source media="(min-width: 1200px)" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x"/><img loading="lazy" width="960" height="" alt="state-of-aws-security/fact-5-v2" srcset="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1 1x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=1.5&amp;q=65 1.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2&amp;q=50 2x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=2.5&amp;q=45 2.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3&amp;q=30 3x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=3.5&amp;q=25 3.5x,
        https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width%2cDPR%2cSave-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960&amp;dpr=4&amp;q=20 4x" src="https://imgix.datadoghq.com/img/state-of-aws-security/fact-5-v2.png?ch=Width,DPR,Save-Data&amp;fm=png&amp;auto=format&amp;fit=max&amp;w=960"/></picture></figure></div></div></div></section><section><div><div><div><p>Findings are based on data collected in September 2022.</p><h2>Population</h2><p>For this report, we analyzed the AWS security posture of a sample of more than 600 organizations that use the Datadog Cloud Security Platform and Datadog&#39;s AWS integration to monitor their environments. While the results presented are biased by the fact that the data comes from our customer base, these organizations are widely diverse in terms of geography, industry, size, and maturity in their cloud journey. Consequently, we believe they provide an accurate representation of organizations using AWS worldwide.</p><h2>Dataset</h2><p>This research was performed against an anonymized dataset that does not contain personally identifiable information or sensitive information, such as resource names or tags.</p><h2>SQS queues and SNS topics</h2><p>We define a publicly accessible SQS queue or SNS topic as a queue or topic that has a resource-based policy that allows the principal “*” to perform an action, and does not have a condition statement that further restricts the context in which the action is authorized.</p><h2>S3 buckets</h2><p>We define a publicly accessible S3 bucket as a bucket that matches at least one of the following criteria:</p><ul><li>Bucket policy has at least one statement that allows an action on the bucket without conditions</li><li>Bucket ACL grants full control to ”authenticated users”</li><li>Bucket ACL grants full control to all users</li></ul><h2>IAM users and multi-factor authentication (MFA)</h2><p>We define an “IAM user with AWS Console access that does not have MFA enabled” as an IAM user that (a) has created an AWS Console password and (b) has not enrolled an MFA device.</p></div></div></div><div><div><div><table><thead><tr><th scope="col"><h5>DESCRIPTION</h5></th><th scope="col"><h5>METRIC VALUE</h5></th><th scope="col"><h5>RATIO COMPUTED OVER</h5></th></tr></thead><tbody><tr><td>Organizations with more than 1 AWS account</td><td>41 %</td><td>All organizations</td></tr><tr><td>Organizations with more than 10 AWS accounts</td><td>5 %</td><td>All organizations</td></tr><tr><td>IAM users with inactive credentials (console password or access key active, and not used in the past 90 days)</td><td>39 %</td><td>All organizations</td></tr><tr><td>Organizations with at least 1 IAM user with inactive credentials</td><td>70 %</td><td>All organizations</td></tr><tr><td>IAM users with an access key older than 1 year that has not been used in the past 30 days</td><td>25 %</td><td>All IAM users</td></tr><tr><td>IAM users with at least 1 active access key older than 90 days</td><td>60 %</td><td>All IAM users</td></tr><tr><td>IAM users with at least 1 active access key older than 90 days</td><td>76 %</td><td>IAM users with at least 1 active access key</td></tr><tr><td>Organizations with at least 1 IAM user with console access and no MFA device enrolled</td><td>40 %</td><td>All organizations</td></tr><tr><td>IAM users with console access and no MFA device enrolled</td><td>11 %</td><td>All IAM users</td></tr><tr><td>Organizations with at least 1 active root user access key</td><td>9 %</td><td>All organizations</td></tr><tr><td>AWS accounts with at least 1 active root user access key</td><td>3 %</td><td>All AWS accounts</td></tr><tr><td>Organizations having used root user credentials in the last 30 days (access key or console password)</td><td>23 %</td><td>All organizations</td></tr><tr><td>EC2 instances not enforcing usage of the IMDSv2</td><td>93 %</td><td>All EC2 instances</td></tr><tr><td>Organizations with at least 1 EC2 instance not enforcing usage of the IMDSv2</td><td>95 %</td><td>Organizations with at least 1 EC2 instance</td></tr><tr><td>Organizations with at least 1 publicly readable S3 bucket</td><td>36 %</td><td>Organizations with at least 1 S3 bucket</td></tr><tr><td>Publicly accessible S3 buckets</td><td>36 %</td><td>Organizations with at least 1 S3 bucket</td></tr><tr><td>Organizations with publicly exposed SNS topics</td><td>15 %</td><td>Organizations with at least 1 SNS topic</td></tr><tr><td>Organizations with publicly exposed SQS queues</td><td>18 %</td><td>Organizations with at least 1 SQS queue</td></tr></tbody></table></div></div></div></section></article></div>
  </body>
</html>
