<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://macwright.com/2025/04/12/tidbyt-second-life.html">Original</a>
    <h1>Tidbyt without the company</h1>
    
    <div id="readability-page-1" class="page"><div><div><p><img src="https://macwright.com/images/2025-04-12-tidbyt-second-life-tidbyt.jpg"/></p></div><p>Remember the Tidbyt? It’s a super low-resolution, internet-connected, wood-paneled display that I <a href="https://macwright.com/2022/03/11/tidbyt-review">wrote a review of it back in 2022</a>. It’s been on my shelf for years now, showing the time, weather, warning me when the UV is going to be high. In 2023 I <a href="https://macwright.com/2023/10/29/tidbyt-rs">used it as an excuse to learn some Rust, to render custom graphics</a>. It’s a toy, a distraction, <a href="https://ethanmarcotte.com/wrote/let-a-website-be-a-worry-stone/">a worry stone</a> for me to work on when I need something open-ended and low-stakes.</p><p>Anyway, the company that made the Tidbyt is no more. They <a href="https://web.archive.org/web/20250326194916/https://tidbyt.com/blogs/tidbyt/tidbyt-is-joining-modal">got acquihired by Modal</a>, a company that makes serverless AI compute hosting. So, they aren’t making devices right now, and the blog post promises that their cloud services will keep working.</p><p>I don’t hold anything against the Tidbyt team: in fact, our <a href="https://www.val.town/">Val Town</a> office was coincidentally right next to theirs in a WeWork, and we met in real life! They’re very nice folks, and were doing so much with a small team. Lots of respect to them. Modal made a smart choice acquiring Tidbyt.</p><p>But realistically, it’s time to make sure my device doesn’t become e-waste.</p><h2 id="the-tidbyt-is-ready-for-this">The Tidbyt is ready for this</h2><p>One of the biggest critiques of the Tidbyt was that it was just an LED matrix and an <a href="https://en.wikipedia.org/wiki/ESP32">ESP chip</a>. You could buy <a href="https://www.sparkfun.com/rgb-led-matrix-panel-32x32.html">an LED matrix</a> on Sparkfun, the ESP, a power supply, some wood for the enclosure, and you’d have your own DIY Tidbyt. Maybe you could do it for half the price!</p><p>But that’s also a strength. The Tidbyt is not some custom <a href="https://en.wikipedia.org/wiki/System_on_a_chip">SoC</a> with an exotic custom software stack and boutique hardware. It is what it looks like: a neat combination of commonplace parts. That makes it kind of future-proof and flexible.</p><p>The first step is to replace the firmware. Tidbyt’s stock firmware routes all of its requests through the Tidbyt company’s servers. I want to eliminate that hop.</p><h2 id="replacing-the-firmware">Replacing the firmware</h2><p>Thankfully, Tidbyt published their <a href="https://github.com/tidbyt/hdk">‘HDK’</a>, which is an open source version of their stock firmware. It’s remarkably simple:</p><ol><li>It connects to Wifi</li><li>It downloads a WebP image from a URL</li><li>It displays that WebP image</li></ol><p>The HDK contains the code to do this stuff. There’s very little code required, but it does drag in a WebP decoder, Wifi library, and a library for running the LED matrix.</p><p>But, setting up the HDK I ran into issues both <a href="https://github.com/tidbyt/hdk/pull/20">small</a> and large: it had issues with HTTPS URLs and Wifi passwords that contain spaces. Plus nobody has been added as a contributor to the HDK repository, so Pull Requests aren’t being accepted and it hasn’t had a change in 7 months.</p><p><strong>But the community came to the rescue</strong> with <a href="https://github.com/tronbyt/firmware-http">tronbyt’s firmware-http</a>, a fork of the HDK that fixes every issue I experienced. Open source works!</p><p>So back in 2022 I included this chart of the Tidbyt network:</p><p><img src="https://macwright.com/images/2022-03-11-tidbyt-review-flow-chart.png" alt="Chart of network flow for Tidbyt"/></p><p>With an updated HDK, this workflow is a lot simpler. Instead of sending images to the Tidbyt servers and those Tidbyt servers delivering them to my device, the device makes requests directly of the server that generates the images.</p><p><img src="https://macwright.com/images/2025-04-12-tidbyt-second-life-new-chart-of-network-flow-for-tidbyt.png" alt="New chart of network flow for Tidbyt"/></p><h3 id="replacing-pixlet">Replacing pixlet</h3><p>The Tidbyt team wrote <a href="https://github.com/tidbyt/pixlet">pixlet</a>, a little framework for generating pixel graphics that the Tidbyt displays. It lets you define a React-like tree of components - some text in a stack, a rectangle, images, and so on - and does all of the layout and rendering.</p><p>The <a href="https://github.com/tronbyt/pixlet">tronbyt community also forked pixlet</a> and are actively developing it, which is fantastic. But this part of the stack I really never liked. That’s why I spent so much time reimplementing it in Rust and JavaScript.</p><p>Partly it’s the language - <a href="https://github.com/tronbyt/pixlet/blob/main/examples/bitcoin/bitcoin.star">pixlet apps</a> are written in <a href="https://github.com/bazelbuild/starlark">starlark</a>, which is kind of an outgrowth of the Bazel build system from Google. Starlark is <em>sort of</em> like Python, but isn’t actually compatible with anything in the Python ecosystem. It’s very niche, limited, and overall just weird.</p><p>I think I understand why Tidbyt would choose Starlark - it’s fast and has <em>hermetic execution</em> - making it safe to run untrusted Starlark programs because they can’t access the filesystem, network, or even the system clock without being given explicit controlled APIs to do those things.</p><p>If you’re building a cloud service that runs a lot of untrusted user code, dictating that code is all Starlark is a really good cheat code - I know firsthand how hard it is to <a href="https://macwright.com/2012/01/10/iframes">run</a> <a href="https://blog.val.town/blog/first-four-val-town-runtimes/">untrusted JavaScript</a>.</p><p>But I’m <em>not</em> building a cloud service full of untrusted code. People who are self-hosting their Tidbyt devices (dozens of us!) don’t benefit from the tradeoffs of the Starlark language. They’d be better off with something normal.</p><h2 id="i-rewrote-pixlet-again">I rewrote pixlet again</h2><p>It’s called <a href="https://github.com/tmcw/indiepixel">indiepixel</a> and it’s a Python reimplementation of pixlet. It supports almost the entire pixlet API, and comes with the added benefit of being Python. You can use Python modules! You can read from the filesystem, parse CSVs, do all of your usual Python stuff. You can embed it in a Python application to render some graphics.</p><p>What does indiepixel do currently?</p><ul><li>Renders text in the glorious retro <a href="https://en.wikipedia.org/wiki/Glyph_Bitmap_Distribution_Format">BDF</a> pixel font format.</li><li>Renders pixelated pie charts, rectangles, and boxes.</li><li>Supports animation for its WebP outputs.</li><li>Provides a nice UI for browsing your selection of screens.</li></ul><p>It’ll probably never be finished, but it works well enough to power my Tidbyt. I’m running indiepixel on a free <a href="https://render.com/">Render server instance</a>, but it should run pretty much the same on any Python-compatible hosting: the only tricky dependency is <a href="https://pypi.org/project/pillow/">Pillow</a>, which it uses for image parsing and rendering.</p><p>My free time for computer-oriented side projects has been limited, due to other commitments and an intention to get offline on the weekends. I’ve been sewing, biking, and running more. So I really want a side project I can enjoy, and indiepixel has fit the bill. It’s really satisfying to implement a new widget and see it rendered in blocky 64x32 pixels. The Pillow image rendering library for Python is mostly wonderful and very powerful.</p><h3 id="why-python">Why Python?</h3><p>Why is indiepixel written in Python? Well - I learned from tidbyt-rs that Rust would be an awkward fit as a scripting language for rendering graphics. The well-known Rust complexities around memory management made simple things difficult for me, which would make them totally unacceptable for others. Besides the attraction of being able to compile a small binary that might be able to run on the Tidbyt itself, Rust didn’t have many other advantages.</p><p>The Pillow module really is such an advantage for Python. JavaScript doesn’t have a real alternative: there’s <a href="https://github.com/lovell/sharp">sharp</a>, a great module for image conversion, but nothing that has such a great canvas interface. <a href="https://github.com/Automattic/node-canvas">node-canvas</a> is fine, but it <a href="https://github.com/Automattic/node-canvas/issues/562">doesn’t support WebP</a> or animation, which are critical features for this project.</p><p>I also wanted a test out the amazing new Python tooling that <a href="https://astral.sh/">Astral</a> is cooking up, like <a href="https://astral.sh/blog/uv-unified-python-packaging">uv</a>. I now have a better grasp of the Python ecosystem than I did a few months ago, and it’s optimistic but mixed. uv is amazing, but Python has a lot of legacy cruft around packaging. People are critical of <a href="https://www.npmjs.com/">NPM</a>, but I think it did benefit from being established after PyPI and learning from its lessons.</p><p><em>Thank you <a href="https://github.com/tmcw/indiepixel/pull/16">Steven Loria</a> for a PR that fixed everything and made it all work and saved me months of tweaking settings.</em></p><h3 id="the-graphic">The graphic</h3><p>I watercolored that Tidbyt a while while ago and have been seriously dragging my feet on finishing this blog post. Sometimes the watercolor-illustration wags the technical-blog-post dog’s tail?</p><p>Anyway, it’s a callback to <a href="https://macwright.com/2016/06/06/that-little-world">that little world</a>, with some small tweaks: this time I thought it’d be nice to have it be <em>both</em> watercolored and interactive. That ‘cybernetic’ feel.</p><p>The secret recipe: a <a href="https://lospec.com/palette-list/resurrect-32">nice palette from lospec</a>, creating a black &amp; white mask of areas in Affinity Photo and vectorizing it with <a href="https://potrace.sourceforge.net/">potrace</a>, and then just some JavaScript that recolors based on hover handling.</p><hr/><p>If you’re using the Tidbyt or some similar pixel-displaying device, try out <a href="https://github.com/tmcw/indiepixel">indiepixel</a>! It’s niche and has required a silly amount of effort to generate a glorified weather clock in my apartment, but it was a fun time <a href="https://macwright.com/2024/01/28/work-hard-and-take-everything-seriously">chasing another interest</a>.</p></div></div>
  </body>
</html>
