<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://idiomdrottning.org/bad-emacs-defaults">Original</a>
    <h1>Bad Emacs defaults</h1>
    
    <div id="readability-page-1" class="page">
    <p>
      <a href="https://idiomdrottning.org">
	<picture>
	  <source srcset="/idiomdrottning_dark_thistle.png" media="(prefers-color-scheme: dark)"/>
	  <img src="https://idiomdrottning.org/idiomdrottning_just_thistle.png" alt="Idiomdrottning’s homepage"/>
	</picture>
      </a>
    </p>

    

<h2 id="littering-backup-files-all-over-the-place">Littering backup files all over the place</h2>

<p>Emacs by default leaves files~ and #files# all over.</p>

<p>This is annoying because those files may get autoloaded.</p>

<p>A solution is</p>

<pre><code>(make-directory &#34;~/.emacs_backups/&#34; t)
(make-directory &#34;~/.emacs_autosave/&#34; t)
(setq auto-save-file-name-transforms &#39;((&#34;.*&#34; &#34;~/.emacs_autosave/&#34; t)))
(setq backup-directory-alist &#39;((&#34;.&#34; . &#34;~/.emacs_backups/&#34;)))
</code></pre>

<p>I was working on a new installation where I didn’t have this in place
yet and I kept trying to update a shell function, re-sourcing it but
it never changed. Turns out it was loading from a backup~ of the same
file.</p>

<p>Thanks to Susam for figuring out a cleaner solution to what I
originally had here.</p>

<p>I also found that <a href="https://git.sr.ht/~technomancy/better-defaults" title="technomancy — better-defaults.el">technomancy has a post similar to this</a> and
this is the only overlap we had at first. People really don’t like
Emacs’ littering.♥</p>

<h2 id="backs-up-by-moving-the-actual-file">Backs up by moving the actual file</h2>

<pre><code>(setq backup-by-copying t)
</code></pre>

<p>The default is <code>nil</code> and that means that every time it makes one of
those backups~, it actually moves your file there, copies the backup
to the original name, and gives you the copy to work on. This isn’t
just a philosophical dilemma (“Am I a butterfly that dreams I am a
backup~?”) but actually breaks hardlinks. I can’t believe this is the default.</p>

<h2 id="sentences-have-two-spaces-between-them">Sentences have two spaces between them</h2>

<pre><code>(setq sentence-end-double-space nil)
</code></pre>

<p>The default is <code>t</code> which might’ve made sense in the typewriter era but
not only messes up filling paragraphs, it also borks the wonderful
family of forward-sentence, kill-sentence, transpose-sentences etc.</p>

<p>If you like the double-spaces between sentences in paragraphs (which I
don’t) but want to be able to use the sentence commands on text,
<a href="https://github.com/duckwork/fill-sentences-correctly.el/blob/main/fill-sentences-correctly.el" title="fill-sentences-correctly.el">a friend of mine has a solution</a>.</p>

<h2 id="indentation-tabs-and-spaces">Indentation, tabs, and spaces</h2>

<p>Emacs famously has its idiosyncratic brace style and indentation style
using a mix of tabs and spaces that no-one else uses.</p>

<p>Which would be fine in a vacuum but you end up fighting it when making
changes in other people’s projects.</p>

<p>We’re on a super AI Lisp genius pile, can’t it figure it out from the
rest of the file or the other files in the directory?</p>

<p>rrthomas and link2xt both wrote in suggesting <a href="https://github.com/jscheid/dtrt-indent/">dtrt-indent</a> which,
you’re gonna have to use a package for this one.</p>

<p>If you’re using straight.el:</p>

<pre><code>(straight-use-package &#39;dtrt-indent)
(require &#39;dtrt-indent)
</code></pre>

<p>If you’re using the default package installer:</p>

<pre><code>(unless (package-installed-p &#39;dtrt-indent) (package-install &#39;dtrt-indent)))
</code></pre>

<p>Then, to turn it on:</p>

<pre><code>(setq dtrt-indent-global-mode t)
</code></pre>

<p>And then, once you’re sure you’ve got it set up the way you want to,
and you wanna hide it from the modeline:</p>

<pre><code>(setcar (alist-get &#39;dtrt-indent-mode minor-mode-alist) &#34;&#34;)
</code></pre>

<p><small>Usually, in Emacs, shadowing an alist by pushing to head works but it didn’t for this, hence the setcar shenanigans.</small></p>

<p>There also <a href="https://github.com/editorconfig/editorconfig-emacs" title="EditorConfig plugin for Emacs">Editor Config</a> which you can install and hide (once you know if it works) similarly.</p>

<h2 id="ctrl-h-doesnt-delete-backwards">Ctrl-H doesn’t delete backwards</h2>

<p>C-h being a convenient, home row way to backspace has been a thing
since the original ASCII table was laid out, and is a staple feature
whenever you see “Emacs shortcuts supported” like bash or zsh. Except
in Emacs itself, where it launches a huge, prompting,
window-splitting help affair.</p>

<p>This was the first Emacs setting I ever changed.</p>

<p>Not sure what’s the best way to do it; I use:</p>

<pre><code>(global-set-key [(control h)] &#39;delete-backward-char)
(keyboard-translate ?\C-h ?\C-?)
</code></pre>

<h2 id="require-final-newline">require-final-newline</h2>

<pre><code>(setq require-final-newline t)
</code></pre>

<p><a href="https://git.sr.ht/~technomancy/better-defaults" title="technomancy — better-defaults.el">Technomancy’s setup</a> reminded me of this one, which I also use. Not always what you want but most of the time, and, should definitively have been the default especially on bash. Things can get weird when your files don’t end in a newline.</p>

<h2 id="frame-inhibit-implied-resize">frame-inhibit-implied-resize</h2>

<p>From <a href="https://tony-zorman.com/posts/2022-10-22-emacs-potpourri.html" title="A Potpourri of Emacs Tweaks – Tony Zorman">Tony Zorman’s Potpourri of Emacs Tweaks</a> there’s a perfect example of an “I can’t believe <code>nil</code> is the default”:</p>

<pre><code>(setq frame-inhibit-implied-resize t)
</code></pre>

<p>Without this, Emacs will try to resize itself to a specific column
size, but like Tony, I’m on a tiling wm, and I change font sizes all
the time, so this is no good.</p>

<p>He also suggests</p>

<pre><code>(setq pixel-scroll-precision-mode t)
</code></pre>

<p>and his description for why does make sense to me, but my older
installation of Emacs doesn’t have that variable yet.</p>

<h2 id="show-trailing-whitespace">show-trailing-whitespace</h2>

<p>This is a mixed bag because it can drive some people crazy so while it
shouldn’t be on for everyone, it should probably be the default:</p>

<pre><code>(setq show-trailing-whitespace t)
</code></pre>

<p>This will highlight whitespace at the end of your lines.</p>

<p>This is good not only for showing whitespace you’ve put there by
mistake, it’s also <a href="https://idiomdrottning.org/show-trailing-whitespace" title="show-trailing-whitespace is my friend">a great way to keep track of unfinished parts your
file</a>.</p>

<p>One reason to turn it back off might be if you’re chatting with people
who leave trailing whitespaces or if you’re working in code repos with
lots of trailing whitespaces. But it’s something that you can toggle
on and off as you please.</p>

<h2 id="bonus-kill-whole-line">Bonus: Kill whole line</h2>

<p>The fact that Emacs just clears the line, not kill it, when there is
no prefix arg is maybe not such a bad default. Starting out, I
actually liked it, compared to vi. But the more time passes the less I
like it. Pretty much all of the time I found myself hitting <code>1k</code>
instead of just <code>k</code>. Thankfully, there is:</p>

<pre><code>(setq kill-whole-line t)
</code></pre>

<p>It kills up to newline if I’m not at column zero, but kills the whole
line (newline and all) if I am at column zero. Pretty happy with that.</p>

  

</div>
  </body>
</html>
