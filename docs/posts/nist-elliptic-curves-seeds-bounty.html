<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://words.filippo.io/dispatches/seeds-bounty/">Original</a>
    <h1>NIST Elliptic Curves Seeds Bounty</h1>
    
    <div id="readability-page-1" class="page"><article>
        <span>
            <time datetime="2023-10-05">05 Oct 2023</time>
        </span>
        
        <section>
            <!--kg-card-begin: markdown--><p>The NIST elliptic curves that power much of modern cryptography were generated in the late ‘90s by hashing seeds provided by the NSA. How were the seeds generated? Rumor has it that they are in turn hashes of English sentences, but the person who picked them, Dr. Jerry Solinas, passed away in early 2023 leaving behind a cryptographic mystery, some conspiracy theories, and an historical password cracking challenge.</p>
<p><strong>Together with some generous matchers, I’m announcing a <s>$8,192</s> $12,288 (12 Ki$) bounty for cracking these five hashes, tripled to $36,864 if the recipient chooses to donate it to a 501(c)(3) charity of their choice.</strong></p>
<pre><code>3045AE6FC8422F64ED579528D38120EAE12196D5
BD71344799D5C7FCDC45B59FA3B9AB8F6A948BC5
C49D360886E704936A6678E1139D26B7819F7E90
A335926AA319A27A1D00896A6773A4827ACDAC73
D09E8800291CB85396CC6717393284AAA0DA64BA
</code></pre>
<p>Thank you to Amir Omidi, Chris Palmer, Colm MacCárthaigh, David Adrian, David Anderson, Jeff Hodges, Matt Green, Matthew McPherrin, Paul Kehrer, Ryan Sleevi, and Soatok for contributing to the bounty, and to Steve Weis for the research that inspired this.</p>
<h2 id="step-back-what-is-this-about">Step back, what is this about?</h2>
<p>The NIST elliptic curves (P-192, P-224, P-256, P-384, and P-521) were published by NIST in FIPS 186-2 in 2000, and generated “verifiably at random” according to ANSI X9.62 by taking an arbitrary seed, hashing it with SHA-1, and using the output to derive some of the parameters.</p>
<p>A <em>lot</em> of cryptography uses NIST curves, and especially P-256 and P-384. They are in the Commercial National Security Algorithm Suite (the successor of Suite B), and are the curves used by the ECDSA X.509 certificates that secure much of the web. They’re a big deal.</p>
<p>Steve Weis has recently published <a href="https://saweis.net/posts/nist-curve-seed-origins.html?ref=words.filippo.io">a well researched article</a> on everything we know about those arbitrary seeds embedded in the FIPS 186 specification. Apparently, they were provided by the NSA, and generated by Jerry Solinas in 1997. He allegedly generated them by hashing, presumably with SHA-1, some English sentences that he later forgot.</p>
<blockquote>
<p>[Jerry] told me that he used a seed that was something like:</p>
</blockquote>
<p>That’s unfortunate, because the NIST curves are—surprisingly—looking better and better: we now have <a href="https://eprint.iacr.org/2015/1060?ref=words.filippo.io">complete addition formulas</a> for them, mitigating their major footgun; we know how to design safer interfaces for them; and we painfully learned to appreciate the value of prime order curves immune to cofactor attacks. However, there is—mostly amongst non-practitioners—some fear that the NSA could have picked the seeds to select some intentionally weak curves.</p>
<p>Do I think those fears are well-founded? No. Koblitz and Menezes make a good argument in <a href="https://eprint.iacr.org/2015/1018.pdf?ref=words.filippo.io"><em>A riddle wrapped in an enigma</em></a> that even with full control over the seed, the NSA would have had to be aware of a class of weak curves so large that it’s not plausible that no one in academia or industry discovered them in 25 years.</p>
<p>Anyway, some <a href="https://en.wikipedia.org/wiki/Fear,_uncertainty,_and_doubt?ref=words.filippo.io">FUD</a> persists around the otherwise pretty good NIST curves that would be good to clear up, even if the English preimage of the hashes <a href="https://twitter.com/lauriewired/status/1700982575291142594?ref=words.filippo.io">is not a complete guarantee of rigidity</a>.</p>
<p>That’s where this bounty comes in. Finding the pre-seeds, the inputs to the hash that generated the seeds, is the bread and butter of password crackers and brainwallet bruteforcers. <strong>This is a call to arms for them to join the search, help fill in a page of cryptographic history, and collect a large bounty or donate an even larger one to charity.</strong></p>
<h2 id="ok-so-what-do-we-know-about-the-hashes">Ok, so what do we know about the hashes?</h2>
<p>To recap Steve Weis’s post, the inputs are probably English phrases which mention Jerry Solinas, possibly someone else, and probably a counter. If you’re actually going for it I recommend reading Steve’s post in full.</p>
<p>The counter has to be there because only one in every 192 to 521 hashes is actually good to make a curve out of, depending the bit size of the curve. (This is because <a href="https://en.wikipedia.org/wiki/Prime_number_theorem?ref=words.filippo.io">one in every ln(N) numbers less than N is prime, for large enough N</a>.) There’s a <a href="https://www.wolframalpha.com/input?i2d=true&amp;i=Power%5B%5C%2840%291+-+Divide%5B1%2C521%5D%5C%2841%29%2Cx%5D+%3D+0.01&amp;ref=words.filippo.io">99% chance the counter is less than 2400 for the largest curve</a>, and less than 1175 for P-256.</p>
<p>The seeds for P-192 and P-256 appeared as examples in the previous ANSI X9.62 standard, while all the others were new in FIPS 186-2, so they might have been generated from differently structured sentences.</p>
<p>Since testing more hashes is nearly free, I recommend also targeting all the examples from ANSI X9.62 that didn’t make the FIPS standard, as well as the seeds for the binary curves in FIPS 186-2, although they are not included in the bounty. Here’s a recap.</p>
<pre><code>3045AE6FC8422F64ED579528D38120EAE12196D5 # NIST P-192, ANSI prime192v1
BD71344799D5C7FCDC45B59FA3B9AB8F6A948BC5 # NIST P-224
C49D360886E704936A6678E1139D26B7819F7E90 # NIST P-256, ANSI prime256v1
A335926AA319A27A1D00896A6773A4827ACDAC73 # NIST P-384
D09E8800291CB85396CC6717393284AAA0DA64BA # NIST P-521
31A92EE2029FD10D901B113E990710F0D21AC6B6 # ANSI prime192v2, not eligible for bounty
C469684435DEB378C4B65CA9591E2A5763059A2E # ANSI prime192v3, not eligible for bounty
E43BB460F0B80CC0C0B075798E948060F8321B7D # ANSI prime239v1, not eligible for bounty
E8B4011604095303CA3B8099982BE09FCB9AE616 # ANSI prime239v2, not eligible for bounty
7D7374168FFE3471B60A857686A19475D3BFA2FF # ANSI prime239v3, not eligible for bounty
85E25BFE5C86226CDB12016F7553F9D0E693A268 # NIST B-163, not eligible for bounty
74D59FF07F6B413D0EA14B344B20A2DB049B50C3 # NIST B-233, not eligible for bounty
77E2B07370EB0F832A6DD5B62DFC88CD06BB84BE # NIST B-283, not eligible for bounty
4099B5A457F9D69F79213D094C4BCD4D4262210B # NIST B-409, not eligible for bounty
2AA058F73A0E33AB486B0F610410C53A7F132310 # NIST B-571, not eligible for bounty
</code></pre>
<p>The format of the string is part of the mystery. It could end with a period or not, end with a newline or not, the counter could be decimal (with or without leading zeroes) or binary (16 or 32 bit), and it could come after the period or separated some other way. The same sentence with different counters could have been used to generate all the seeds, or they could be different sentences, or they could include the curve name or size. Human memory is notoriously fallible, so it could also be that some of the details in the second-hand recollections are wrong.</p>
<p>(<strong>Edited to add</strong>: it could even be that instead of a counter they started with SHA-1(s), and then tried SHA-1(SHA-1(s)), and so on. Or maybe they started with SHA-1(s), and then incremented <em>the hash</em> like <code>IP2BS(BS2IP(h) + 1)</code>, which is what they do to the seed to extend it to the size of a field element in ANSI X9.62, Section A.3.3.1. The latter should be cheap to account for by adding to the list of hashes ~2500 decrements of each of the hashes above. I can produce a list if anyone wants.)</p>
<p>The good news is that SHA-1 is tremendously fast to bruteforce, and <em>YOU</em> are the experts in cracking passphrases you know nothing about.</p>
<h2 id="cool-what%E2%80%99s-the-fine-print">Cool, what’s the fine print?</h2>
<p>The bounty will pay out to the first person(s) to email the pre-seeds for the five prime-order NIST curves to <a href="mailto:seeds@filippo.io">seeds@filippo.io</a>.</p>
<p>Half the bounty ($6,144) will pay out to the first submission of <em>at least one</em> pre-seed, and the other half will pay out to the first submission of <em>all five</em> pre-seeds. They can of course go to the same person, so don’t wait to have them all to submit. Even one would make history.</p>
<p>If successful, you can either choose to receive the cash bounty, or select a U.S. 501(c)(3) charity to receive triple the amount. We reserve the right to veto charity choices dramatically incompatible with our values, but we won’t be jerks about it. If it’s not legally allowed for a U.S. person or Italian national to send money to you, you will have to select the charity option. You’re responsible for any taxes on the cash bounty. I fully trust every matcher, and I am guaranteeing the full amount of the bounty personally, so you don’t have to.</p>
<p>Put “ANTISPAM” in the subject line of any submission to hit my allowlisting rules. The Received header of my mail host will be the unappealable criterion of what submission arrived first.</p>
<p>The bounty expires if the seeds become publicly known, otherwise it’s valid until announced otherwise on this page. If the bounty is being cancelled or lowered, it will be announced six months in advance. (We don’t want anyone to feel cheated of their resources.)</p>
<p>We don’t actually care how you find the seeds. It can be bruteforcing, clever guessing, sleuth work tracking down NSA employees (don’t get arrested), or even recovering that old backup of when you used to work at NIST. If you don’t want us to, we won’t ask questions.</p>
<p>May the hashrate be ever in your favor, and let&#39;s fill out a page of cryptographic history.</p>
<p>For updates, you might want to <a href="https://bsky.app/profile/filippo.abyssdomain.expert?ref=words.filippo.io">follow me on Bluesky</a> or <a href="https://abyssdomain.expert/@filippo?ref=words.filippo.io">Mastodon</a>.</p>


<!--kg-card-end: markdown-->
        </section>
    </article></div>
  </body>
</html>
