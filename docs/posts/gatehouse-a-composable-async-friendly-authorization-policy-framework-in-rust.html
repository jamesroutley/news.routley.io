<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/thepartly/gatehouse">Original</a>
    <h1>Gatehouse â€“ a composable, async-friendly authorization policy framework in Rust</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://github.com/thepartly/gatehouse/actions/workflows/ci.yml"><img src="https://github.com/thepartly/gatehouse/actions/workflows/ci.yml/badge.svg?branch=main" alt="Build status"/></a>
<a href="https://crates.io/crates/gatehouse" rel="nofollow"><img src="https://camo.githubusercontent.com/85df61548729f70846897e920a1326e9b136e4695c9d17e2e47d3747882dcdcf/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f67617465686f757365" alt="Crates.io" data-canonical-src="https://img.shields.io/crates/v/gatehouse"/></a>
<a href="https://docs.rs/gatehouse" rel="nofollow"><img src="https://camo.githubusercontent.com/1c3678002d71d1879bf054577aa85c3cf6acaedf6b94e67356b7ec571d9ced5c/68747470733a2f2f646f63732e72732f67617465686f7573652f62616467652e737667" alt="Documentation" data-canonical-src="https://docs.rs/gatehouse/badge.svg"/></a></p>
<p dir="auto">A flexible authorization library that combines role-based (RBAC), attribute-based (ABAC), and relationship-based (ReBAC) access control policies.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/thepartly/gatehouse/main/.github/logo.svg"><img src="https://raw.githubusercontent.com/thepartly/gatehouse/main/.github/logo.svg" alt="Gatehouse Logo"/></a></p>

<ul dir="auto">
<li><strong>Multi-paradigm Authorization</strong>: Support for RBAC, ABAC, and ReBAC patterns</li>
<li><strong>Policy Composition</strong>: Combine policies with logical operators (<code>AND</code>, <code>OR</code>, <code>NOT</code>)</li>
<li><strong>Detailed Evaluation Tracing</strong>: Complete decision trace for debugging and auditing</li>
<li><strong>Fluent Builder API</strong>: Construct custom policies with a PolicyBuilder.</li>
<li><strong>Type Safety</strong>: Strongly typed resources/actions/contexts</li>
<li><strong>Async Ready</strong>: Built with async/await support</li>
</ul>


<p dir="auto">The foundation of the authorization system:</p>
<div dir="auto" data-snippet-clipboard-copy-content="#[async_trait]
trait Policy&lt;Subject, Resource, Action, Context&gt; {
    async fn evaluate_access(
        &amp;self,
        subject: &amp;Subject,
        action: &amp;Action,
        resource: &amp;Resource,
        context: &amp;Context,
    ) -&gt; PolicyEvalResult;
}"><pre><span>#<span>[</span>async_trait<span>]</span></span>
<span>trait</span> <span>Policy</span><span>&lt;</span><span>Subject</span><span>,</span> <span>Resource</span><span>,</span> <span>Action</span><span>,</span> <span>Context</span><span>&gt;</span> <span>{</span>
    <span>async</span> <span>fn</span> <span>evaluate_access</span><span>(</span>
        <span>&amp;</span><span>self</span><span>,</span>
        <span>subject</span><span>:</span> <span>&amp;</span><span>Subject</span><span>,</span>
        <span>action</span><span>:</span> <span>&amp;</span><span>Action</span><span>,</span>
        <span>resource</span><span>:</span> <span>&amp;</span><span>Resource</span><span>,</span>
        <span>context</span><span>:</span> <span>&amp;</span><span>Context</span><span>,</span>
    <span>)</span> -&gt; <span>PolicyEvalResult</span><span>;</span>
<span>}</span></pre></div>

<p dir="auto">Aggregates multiple policies (e.g. RBAC, ABAC) with <code>OR</code> logic by default: if any policy grants access, permission is granted.</p>
<div dir="auto" data-snippet-clipboard-copy-content="let mut checker = PermissionChecker::new();
checker.add_policy(rbac_policy);
checker.add_policy(owner_policy);

// Check if access is granted
let result = checker.evaluate_access(&amp;user, &amp;action, &amp;resource, &amp;context).await;
if result.is_granted() {
    // Access allowed
} else {
    // Access denied
}"><pre><span>let</span> <span>mut</span> checker = <span>PermissionChecker</span><span>::</span><span>new</span><span>(</span><span>)</span><span>;</span>
checker<span>.</span><span>add_policy</span><span>(</span>rbac_policy<span>)</span><span>;</span>
checker<span>.</span><span>add_policy</span><span>(</span>owner_policy<span>)</span><span>;</span>

<span>// Check if access is granted</span>
<span>let</span> result = checker<span>.</span><span>evaluate_access</span><span>(</span><span>&amp;</span>user<span>,</span> <span>&amp;</span>action<span>,</span> <span>&amp;</span>resource<span>,</span> <span>&amp;</span>context<span>)</span><span>.</span><span>await</span><span>;</span>
<span>if</span> result<span>.</span><span>is_granted</span><span>(</span><span>)</span> <span>{</span>
    <span>// Access allowed</span>
<span>}</span> <span>else</span> <span>{</span>
    <span>// Access denied</span>
<span>}</span></pre></div>

<p dir="auto">The <code>PolicyBuilder</code> provides a fluent API to construct custom policies by chaining predicate functions for
subjects, actions, resources, and context. Once built, the policy can be added to a [<code>PermissionChecker</code>].</p>
<div dir="auto" data-snippet-clipboard-copy-content="let custom_policy = PolicyBuilder::&lt;MySubject, MyResource, MyAction, MyContext&gt;::new(&#34;CustomPolicy&#34;)
    .subjects(|s| /* ... */)
    .actions(|a| /* ... */)
    .resources(|r| /* ... */)
    .context(|c| /* ... */)
    .when(|s, a, r, c| /* ... */)
    .build();"><pre><span>let</span> custom_policy = <span>PolicyBuilder</span><span>::</span><span>&lt;</span><span>MySubject</span><span>,</span> <span>MyResource</span><span>,</span> <span>MyAction</span><span>,</span> <span>MyContext</span><span>&gt;</span><span>::</span><span>new</span><span>(</span><span>&#34;CustomPolicy&#34;</span><span>)</span>
    <span>.</span><span>subjects</span><span>(</span>|s| <span>/* ... */</span><span>)</span>
    <span>.</span><span>actions</span><span>(</span>|a| <span>/* ... */</span><span>)</span>
    <span>.</span><span>resources</span><span>(</span>|r| <span>/* ... */</span><span>)</span>
    <span>.</span><span>context</span><span>(</span>|c| <span>/* ... */</span><span>)</span>
    <span>.</span><span>when</span><span>(</span>|s<span>,</span> a<span>,</span> r<span>,</span> c| <span>/* ... */</span><span>)</span>
    <span>.</span><span>build</span><span>(</span><span>)</span><span>;</span></pre></div>

<ul dir="auto">
<li>RbacPolicy: Role-based access control</li>
<li>AbacPolicy: Attribute-based access control</li>
<li>RebacPolicy: Relationship-based access control</li>
</ul>

<p dir="auto">AndPolicy: Grants access only if all inner policies allow access
OrPolicy: Grants access if any inner policy allows access
NotPolicy: Inverts the decision of an inner policy</p>

<p dir="auto">See the <code>examples</code> directory for complete demonstration of:</p>
<ul dir="auto">
<li>Role-based access control (<code>rbac_policy</code>)</li>
<li>Relationship-based access control (<code>rebac_policy</code>)</li>
<li>Policy combinators (<code>combinator_policy</code>)</li>
</ul>
<p dir="auto">Run with:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cargo run --example rbac_policy"><pre>cargo run --example rbac_policy</pre></div>
</article></div></div>
  </body>
</html>
