<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.nullpt.rs/reversing-botid">Original</a>
    <h1>Reverse Engineering Vercel&#39;s BotID</h1>
    
    <div id="readability-page-1" class="page"><div><p><span>Reverse Engineering Vercel&#39;s BotID</span></p><p><time datetime="2025-06-30T00:00:00.000Z">Mon Jun 30 2025</time><small>authored by<!-- --> <a href="https://todaythings.substack.com/author/veritas">veritas</a></small></p><h2 id="preamble">Preamble</h2>
<p>I’m conflicted every time I write one of these posts.</p>
<p>On one hand, anti-bots are important. They help stop credential stuffing attacks<sup><a href="#user-content-fn-cred-stuffing" id="user-content-fnref-cred-stuffing" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>, block denial-of-service attempts, and keep bad faith scrapers from inflating hosting costs<sup><a href="#user-content-fn-anthropic" id="user-content-fnref-anthropic" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup> (especially in the era of AI). If you’re running a business on the internet these days, it’s hard to survive without <em>some</em> kind of bot protection in place.</p>
<p>On the other hand, I kind of hate them.</p>
<p>Most anti-bots rely on aggressive browser fingerprinting<sup><a href="#user-content-fn-fingerprint-js" id="user-content-fnref-fingerprint-js" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup>, collecting a plethora of device signals<sup><a href="#user-content-fn-bot-test" id="user-content-fnref-bot-test" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup>, and quietly deciding whether you&#39;re “human enough”. They often break for those using Linux, smaller browsers like Ladybird<sup><a href="#user-content-fn-ladybird-turnstile" id="user-content-fnref-ladybird-turnstile" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup>, or even privacy-focused ones like Brave. They push the web toward a monoculture where only certain OS/browser combos are considered legitimate.</p>
<p>So I sit in this weird middle ground. I get why they exist. I get why companies use them. But I also worry about what they&#39;re doing to the open web.</p>
<p>This blog post doesn’t present anything particularly groundbreaking. In fact, much of it revisits topics covered before on this site. My goal here is simply to invite discussion and hear different perspectives on the matter.</p>
<h2 id="introduction">Introduction</h2>
<p>Vercel <a href="https://vercel.com/blog/introducing-botid">recently announced</a> BotID, &#34;an invisible CAPTCHA that protects against sophisticated bots without showing visible challenges or requiring manual intervention&#34;.
It’s available in two modes: <code>Basic</code> and <code>Deep Analysis</code>. The Basic tier is free for all users. Deep Analysis costs $1 per 1,000 requests.
Both modes rely on client-side signals to detect bots, however, Deep Analysis is powered by <a href="https://www.kasada.io/">Kasada</a>&#39;s anti-bot script and is meant to catch more sophisticated bots.</p>
<p>This post primarily focuses on Basic mode, however, Deep Analysis leverages scripts we&#39;ve <a href="#deep-analysis-mode">covered in a previous series</a>.</p>
<p>Setup for both is pretty straightforward.</p>
<h2 id="setting-up-botid">Setting up BotID</h2>
<p>You can start by adding BotID to your existing Next.js project like this:</p>
<p><code>yarn add botid</code></p>
<p>Then, protect a route using the following code:</p>
<pre><code><span>import</span> <span><span>{</span> checkBotId <span>}</span></span> <span>from</span> <span>&#39;botid/server&#39;</span><span>;</span>
<span>import</span> <span><span>{</span> <span>NextRequest</span><span>,</span> <span>NextResponse</span> <span>}</span></span> <span>from</span> <span>&#39;next/server&#39;</span><span>;</span>
 
<span>export</span> <span>async</span> <span>function</span> <span>POST</span><span>(</span><span><span>request</span><span>:</span> <span>NextRequest</span></span><span>)</span> <span>{</span>
  <span>const</span> verification <span>=</span> <span>await</span> <span>checkBotId</span><span>(</span><span>)</span><span>;</span>
 
  <span>if</span> <span>(</span>verification<span>.</span><span>isBot</span><span>)</span> <span>{</span>
    <span>return</span> <span>NextResponse</span><span>.</span><span>json</span><span>(</span><span>{</span> <span>error</span><span>:</span> <span>&#39;Access denied&#39;</span> <span>}</span><span>,</span> <span>{</span> <span>status</span><span>:</span> <span>403</span> <span>}</span><span>)</span><span>;</span>
  <span>}</span>
 
  <span>const</span> data <span>=</span> <span>await</span> <span>processUserRequest</span><span>(</span><span>)</span><span>;</span>
 
  <span>return</span> <span>NextResponse</span><span>.</span><span>json</span><span>(</span><span>{</span> data <span>}</span><span>)</span><span>;</span>
<span>}</span>
</code></pre>
<p>That’s the basics of BotID setup. You can then create a simple form page that calls this API:</p>
<pre><code><span>&#34;use client&#34;</span><span>;</span>
<span>import</span> <span><span>{</span> <span>FormEvent</span><span>,</span> useState <span>}</span></span> <span>from</span> <span>&#39;react&#39;</span>
 
<span>export</span> <span>default</span> <span>function</span> <span><span>Page</span></span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>[</span>bot<span>,</span> setBot<span>]</span> <span>=</span> useState<span>&lt;</span>string <span>|</span> <span>undefined</span><span>&gt;</span><span>(</span><span>undefined</span><span>)</span><span>;</span>

  <span>async</span> <span>function</span> <span>onSubmit</span><span>(</span>event<span>:</span> <span>FormEvent</span><span><span><span>&lt;</span><span>HTMLFormElement</span></span><span>&gt;</span></span><span>) </span><span>{</span>
    event<span>.</span><span>preventDefault</span><span>(</span><span>)</span> 
    
    <span>const</span> formData <span>=</span> <span>new</span> <span>FormData</span><span>(</span>event<span>.</span><span>currentTarget</span><span>)</span>
    <span>const</span> response <span>=</span> <span>await</span> <span>fetch</span><span>(</span><span>&#39;/api/sensitive&#39;</span><span>,</span> <span>{</span>
      <span>method</span><span>:</span> <span>&#39;POST&#39;</span><span>,</span>
      <span>body</span><span>:</span> formData<span>,</span>
    <span>}</span><span>)</span>
 
    <span>const</span> data <span>=</span> <span>await</span> response<span>.</span><span>json</span><span>&lt;</span><span>{</span>
      error<span>?</span><span>:</span> string<span>;</span>
      data<span>?</span><span>:</span> string<span>;</span>
    <span>}</span><span>&gt;</span><span>(</span><span>)</span>

    <span>if</span> <span>(</span>data<span>.</span><span>error</span><span>)</span> <span>{</span>
      <span>setBot</span><span>(</span><span>&#34;BOT&#34;</span><span>)</span><span>;</span>
    <span>}</span> <span>else</span> <span>if</span> <span>(</span>data<span>.</span><span>data</span><span>)</span> <span>{</span>
      <span>setBot</span><span>(</span><span>&#34;HUMAN&#34;</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span><span>
 
  return (
    </span><span><span><span>&lt;</span>div</span><span>&gt;</span></span><span>
    </span><span>{</span>bot <span>===</span> <span>&#34;HUMAN&#34;</span>  <span>&amp;&amp;</span> <span><span><span>&lt;</span>p</span> <span>id</span><span><span>=</span><span>&#34;</span>is-bot<span>&#34;</span></span><span>&gt;</span></span><span>You are a human</span><span><span><span>&lt;/</span>p</span><span>&gt;</span></span><span>}</span><span>
    </span><span>{</span>bot <span>===</span> <span>&#34;BOT&#34;</span> <span>&amp;&amp;</span> <span><span><span>&lt;</span>p</span> <span>id</span><span><span>=</span><span>&#34;</span>is-bot<span>&#34;</span></span><span>&gt;</span></span><span>You are a bot</span><span><span><span>&lt;/</span>p</span><span>&gt;</span></span><span>}</span><span>
    </span><span><span><span>&lt;</span>form</span> <span>onSubmit</span><span><span>=</span><span>{</span>onSubmit<span>}</span></span><span>&gt;</span></span><span>
      </span><span><span><span>&lt;</span>input</span> <span>type</span><span><span>=</span><span>&#34;</span>text<span>&#34;</span></span> <span>name</span><span><span>=</span><span>&#34;</span>whatever<span>&#34;</span></span> <span>/&gt;</span></span><span>
      </span><span><span><span>&lt;</span>button</span> <span>type</span><span><span>=</span><span>&#34;</span>submit<span>&#34;</span></span><span>&gt;</span></span><span>Submit</span><span><span><span>&lt;/</span>button</span><span>&gt;</span></span><span>
    </span><span><span><span>&lt;/</span>form</span><span>&gt;</span></span><span>
    </span><span><span><span>&lt;/</span>div</span><span>&gt;</span></span><span>
  )
}
</span></code></pre>
<h2 id="discovering-the-cjs-script">Discovering the c.js Script</h2>
<p>Visiting this route in our browser, we can see that a new script is fetched: <code>c.js</code>.</p>
<figure><img alt="New script c.js present in the Network inspector" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=3840&amp;q=75 3840w" src="https://todaythings.substack.com/_next/image?url=%2Fposts%2Freversing-botid%2Fnew-script.png&amp;w=3840&amp;q=75"/><figcaption>New script c.js present in the Network inspector</figcaption></figure>
<p>A preview of the script shows reveals obfuscated JavaScript. This is clear from the use of random-looking hex offsets and indirect calls to functions in globals like <code>crypto</code> and <code>JSON</code>, where a separate function is used to resolve the actual method names.</p>
<pre><code><span>async</span> <span>function</span> <span>X</span><span>(</span><span>b<span>,</span> x</span><span>)</span> <span>{</span>
    <span>const</span> <span>S</span> <span>=</span> k<span>;</span>
    <span>// It&#39;s calling stuff from the crypto API but the function names are mangled</span>
    <span>let</span> <span>L</span> <span>=</span> crypto<span>[</span><span>S</span><span>(</span><span>0x271</span><span>,</span> <span>&#39;x2Nz&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x248</span><span>,</span> <span>&#39;s74E&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x1a3</span><span>,</span> <span>&#39;sKIN&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x1cc</span><span>,</span> <span>&#39;rKTC&#39;</span><span>)</span> <span>+</span> <span>&#39;ues&#39;</span><span>]</span><span>(</span><span>new</span> <span>Uint8Array</span><span>(</span><span>0x71</span> <span>*</span> <span>0x1f</span> <span>+</span> <span>-</span><span>0xca4</span> <span>+</span> <span>0x1</span> <span>*</span> <span>-</span><span>0xfb</span><span>)</span><span>)</span>
        <span>,</span> <span>V</span> <span>=</span> crypto<span>[</span><span>S</span><span>(</span><span>0x255</span><span>,</span> <span>&#39;(mPC&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x27b</span><span>,</span> <span>&#39;mz*i&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x230</span><span>,</span> <span>&#39;Qq38&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x215</span><span>,</span> <span>&#39;rTDp&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x20f</span><span>,</span> <span>&#39;[]ns&#39;</span><span>)</span><span>]</span><span>(</span><span>new</span> <span>Uint8Array</span><span>(</span><span>-</span><span>0x2144</span> <span>+</span> <span>0x33</span> <span>*</span> <span>-</span><span>0xad</span> <span>+</span> <span>0x43c7</span> <span>*</span> <span>0x1</span><span>)</span><span>)</span>
        <span>,</span> <span>W</span> <span>=</span> <span>await</span> crypto<span>[</span><span>S</span><span>(</span><span>0x23e</span><span>,</span> <span>&#39;#J9v&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x1c0</span><span>,</span> <span>&#39;KL$e&#39;</span><span>)</span><span>]</span><span>[</span><span>S</span><span>(</span><span>0x223</span><span>,</span> <span>&#39;UnKT&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x1ce</span><span>,</span> <span>&#39;KL$e&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x1a4</span><span>,</span> <span>&#39;s74E&#39;</span><span>)</span><span>]</span><span>(</span><span>H</span><span>[</span><span>S</span><span>(</span><span>0x240</span><span>,</span> <span>&#39;BxPe&#39;</span><span>)</span> <span>+</span> <span>&#39;Yk&#39;</span><span>]</span><span>,</span> <span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>S</span><span>(</span><span>0x263</span><span>,</span> <span>&#39;ZsXG&#39;</span><span>)</span> <span>+</span> <span>&#39;ode&#39;</span><span>]</span><span>(</span>b<span>)</span><span>,</span> <span>H</span><span>[</span><span>S</span><span>(</span><span>0x205</span><span>,</span> <span>&#39;0dQT&#39;</span><span>)</span> <span>+</span> <span>&#39;gg&#39;</span><span>]</span><span>,</span> <span>!</span><span>(</span><span>-</span><span>0x1543</span> <span>*</span> <span>0x1</span> <span>+</span> <span>0xd1</span> <span>*</span> <span>-</span><span>0x1d</span> <span>+</span> <span>-</span><span>0xf</span> <span>*</span> <span>-</span><span>0x2ff</span><span>)</span><span>,</span> <span>[</span><span>H</span><span>[</span><span>S</span><span>(</span><span>0x1b9</span><span>,</span> <span>&#39;BxPe&#39;</span><span>)</span> <span>+</span> <span>&#39;VA&#39;</span><span>]</span><span>,</span> <span>S</span><span>(</span><span>0x20a</span><span>,</span> <span>&#39;S#TT&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x26b</span><span>,</span> <span>&#39;BxPe&#39;</span><span>)</span> <span>+</span> <span>&#39;Key&#39;</span><span>]</span><span>)</span>
        <span>,</span> <span>E</span> <span>=</span> <span>await</span> crypto<span>[</span><span>S</span><span>(</span><span>0x23d</span><span>,</span> <span>&#39;7#V2&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x1f8</span><span>,</span> <span>&#39;uGPe&#39;</span><span>)</span><span>]</span><span>[</span><span>S</span><span>(</span><span>0x222</span><span>,</span> <span>&#39;hyOI&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x22b</span><span>,</span> <span>&#39;v4[O&#39;</span><span>)</span> <span>+</span> <span>&#39;Key&#39;</span><span>]</span><span>(</span><span>{</span>
        <span>&#39;name&#39;</span><span>:</span> <span>H</span><span>[</span><span>S</span><span>(</span><span>0x286</span><span>,</span> <span>&#39;@UgF&#39;</span><span>)</span> <span>+</span> <span>&#39;gg&#39;</span><span>]</span><span>,</span>
        <span>&#39;salt&#39;</span><span>:</span> <span>L</span><span>,</span>
        <span>&#39;iterations&#39;</span><span>:</span> <span>0x186a0</span><span>,</span>
        <span>&#39;hash&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#39;CPO&#39;</span> <span>+</span> <span>&#39;bW&#39;</span><span>]</span>
    <span>}</span><span>,</span> <span>W</span><span>,</span> <span>{</span>
        <span>&#39;name&#39;</span><span>:</span> <span>&#39;AES&#39;</span> <span>+</span> <span>&#39;-GC&#39;</span> <span>+</span> <span>&#39;M&#39;</span><span>,</span>
        <span>&#39;length&#39;</span><span>:</span> <span>0x100</span>
    <span>}</span><span>,</span> <span>!</span><span>(</span><span>0x5a9</span> <span>+</span> <span>0x13a</span> <span>*</span> <span>0x18</span> <span>+</span> <span>0x2318</span> <span>*</span> <span>-</span><span>0x1</span><span>)</span><span>,</span> <span>[</span><span>S</span><span>(</span><span>0x284</span><span>,</span> <span>&#39;uGPe&#39;</span><span>)</span> <span>+</span> <span>&#39;ryp&#39;</span> <span>+</span> <span>&#39;t&#39;</span><span>]</span><span>)</span>
        <span>,</span> <span>R</span> <span>=</span> <span>await</span> crypto<span>[</span><span>S</span><span>(</span><span>0x261</span><span>,</span> <span>&#39;ggq(&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x26f</span><span>,</span> <span>&#39;UnKT&#39;</span><span>)</span><span>]</span><span>[</span><span>&#39;enc&#39;</span> <span>+</span> <span>S</span><span>(</span><span>0x24d</span><span>,</span> <span>&#39;rTDp&#39;</span><span>)</span> <span>+</span> <span>&#39;t&#39;</span><span>]</span><span>(</span><span>{</span>
        <span>&#39;name&#39;</span><span>:</span> <span>S</span><span>(</span><span>0x226</span><span>,</span> <span>&#39;S#TT&#39;</span><span>)</span> <span>+</span> <span>&#39;-GC&#39;</span> <span>+</span> <span>&#39;M&#39;</span><span>,</span>
        <span>&#39;iv&#39;</span><span>:</span> <span>V</span>
    <span>}</span><span>,</span> <span>E</span><span>,</span> <span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>&#39;enc&#39;</span> <span>+</span> <span>S</span><span>(</span><span>0x1c1</span><span>,</span> <span>&#39;@UgF&#39;</span><span>)</span><span>]</span><span>(</span><span>JSON</span><span>[</span><span>S</span><span>(</span><span>0x1fa</span><span>,</span> <span>&#39;ZsXG&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x227</span><span>,</span> <span>&#39;j]8P&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x22a</span><span>,</span> <span>&#39;6nM!&#39;</span><span>)</span><span>]</span><span>(</span>x<span>)</span><span>)</span><span>)</span><span>;</span>
    <span>return</span> <span>btoa</span><span>(</span><span>String</span><span>[</span><span>S</span><span>(</span><span>0x1bc</span><span>,</span> <span>&#39;bQHG&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x262</span><span>,</span> <span>&#39;iIeX&#39;</span><span>)</span> <span>+</span> <span>S</span><span>(</span><span>0x253</span><span>,</span> <span>&#39;KL$e&#39;</span><span>)</span> <span>+</span> <span>&#39;ode&#39;</span><span>]</span><span>(</span><span>...</span><span>L</span><span>,</span> <span>...</span><span>V</span><span>,</span> <span>...</span><span>new</span> <span>Uint8Array</span><span>(</span><span>R</span><span>)</span><span>)</span><span>)</span><span>;</span>
<span>}</span>
</code></pre>
<h2 id="understanding-the-obfuscation">Understanding the Obfuscation</h2>
<p>Using <a href="https://babeljs.io/">Babel</a>, we can traverse all call expressions to the string decoding functions and replace them with the resulting cleartext to return the original function names. This makes static analysis a lot easier.</p>
<p>The script’s string decoding process works in three steps:</p>
<h3 id="1-define-the-encoded-string-constants">1. Define the encoded string constants</h3>
<p>These are stored in a function that returns an array of all the encoded strings used throughout the script.</p>
<pre><code><span>function</span> <span>w</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>D</span> <span>=</span> <span>[</span><span>&#39;veeq&#39;</span><span>,</span> <span>&#39;WOfpW70&#39;</span><span>,</span> <span>&#39;... the rest of the strings ...&#39;</span><span>]</span><span>;</span>
  <span>w</span> <span>=</span> <span>function</span> <span>(</span><span>)</span> <span>{</span>
    <span>return</span> <span>D</span><span>;</span>
  <span>}</span><span>;</span>
  <span>return</span> <span>w</span><span>(</span><span>)</span><span>;</span>
<span>}</span>
</code></pre>
<h3 id="2-shuffle-the-string-constants">2. Shuffle the string constants</h3>
<p>Before we can decode the string constants, the array is shuffled until a specific predicate, determined at build time, returns true. This shuffling happens inside an <dfn title="Immediately Invoked Function Expression"><a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a></dfn> and looks like this:</p>
<pre><code><span>(</span><span>function</span> <span>(</span><span><span>H</span><span>,</span> <span>P</span></span><span>)</span> <span>{</span>
  <span>const</span> <span>I</span> <span>=</span> <span>J</span><span>,</span>
  r <span>=</span> <span>H</span><span>(</span><span>)</span><span>;</span>
  <span>while</span> <span>(</span><span>!</span><span>!</span><span>[</span><span>]</span><span>)</span> <span>{</span>
    <span>try</span> <span>{</span>
        <span>const</span> q <span>=</span> <span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x1c4</span><span>,</span> <span>&#39;ZGpA&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>0x537</span> <span>*</span> <span>0x5</span> <span>+</span> <span>0xbf</span> <span>+</span> <span>-</span><span>0x1ad1</span><span>)</span> <span>+</span> <span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x295</span><span>,</span> <span>&#39;Lj3S&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x981</span> <span>+</span> <span>-</span><span>0x1084</span> <span>+</span> <span>0x1a07</span><span>)</span> <span>+</span> <span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x209</span><span>,</span> <span>&#39;MxSD&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x391</span> <span>*</span> <span>-</span><span>0x7</span> <span>+</span> <span>-</span><span>0x1cd1</span> <span>+</span> <span>-</span><span>0x17</span> <span>*</span> <span>-</span><span>0x2b</span><span>)</span> <span>*</span> <span>(</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x27b</span><span>,</span> <span>&#39;nF93&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x26f0</span> <span>*</span> <span>-</span><span>0x1</span> <span>+</span> <span>-</span><span>0x105e</span> <span>+</span> <span>-</span><span>0x2</span> <span>*</span> <span>0xb47</span><span>)</span><span>)</span> <span>+</span> <span>-</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x1c2</span><span>,</span> <span>&#39;Lj3S&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x36</span> <span>*</span> <span>-</span><span>0xb7</span> <span>+</span> <span>-</span><span>0x1</span> <span>*</span> <span>-</span><span>0xb89</span> <span>+</span> <span>-</span><span>0x190f</span> <span>*</span> <span>0x2</span><span>)</span> <span>*</span> <span>(</span><span>-</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x26d</span><span>,</span> <span>&#39;3bXU&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>0x743</span> <span>*</span> <span>0x3</span> <span>+</span> <span>0x1a07</span> <span>+</span> <span>-</span><span>0x2fca</span><span>)</span><span>)</span> <span>+</span> <span>-</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x1cd</span><span>,</span> <span>&#39;3bXU&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x17aa</span> <span>+</span> <span>-</span><span>0xe90</span> <span>+</span> <span>0x2641</span><span>)</span> <span>*</span> <span>(</span><span>-</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x259</span><span>,</span> <span>&#39;6TSl&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x1ead</span> <span>*</span> <span>-</span><span>0x1</span> <span>+</span> <span>-</span><span>0x123</span> <span>*</span> <span>-</span><span>0x12</span> <span>+</span> <span>-</span><span>0x331b</span><span>)</span><span>)</span> <span>+</span> <span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x1fc</span><span>,</span> <span>&#39;dP9k&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x5</span> <span>*</span> <span>-</span><span>0x63d</span> <span>+</span> <span>-</span><span>0xdea</span> <span>*</span> <span>0x1</span> <span>+</span> <span>0x2</span> <span>*</span> <span>-</span><span>0x89f</span><span>)</span> <span>+</span> <span>-</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x28e</span><span>,</span> <span>&#39;Ynb)&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x15d1</span> <span>+</span> <span>0x1</span> <span>*</span> <span>-</span><span>0x1795</span> <span>+</span> <span>-</span><span>0x2d70</span> <span>*</span> <span>-</span><span>0x1</span><span>)</span> <span>*</span> <span>(</span><span>parseInt</span><span>(</span><span>I</span><span>(</span><span>0x1b6</span><span>,</span> <span>&#39;!CQn&#39;</span><span>)</span><span>)</span> <span>/</span> <span>(</span><span>-</span><span>0x520</span> <span>*</span> <span>-</span><span>0x1</span> <span>+</span> <span>0x8ef</span> <span>*</span> <span>-</span><span>0x2</span> <span>+</span> <span>-</span><span>0x1</span> <span>*</span> <span>-</span><span>0xcc9</span><span>)</span><span>)</span><span>;</span>
      <span>if</span> <span>(</span>q <span>===</span> <span>P</span><span>)</span> <span>{</span>
        <span>break</span><span>;</span>
      <span>}</span>
      <span>else</span> 
        r<span>[</span><span>&#39;push&#39;</span><span>]</span><span>(</span>r<span>[</span><span>&#39;shift&#39;</span><span>]</span><span>(</span><span>)</span><span>)</span><span>;</span>

    <span>}</span> <span>catch</span> <span>(</span>d<span>)</span> <span>{</span>
      r<span>[</span><span>&#39;push&#39;</span><span>]</span><span>(</span>r<span>[</span><span>&#39;shift&#39;</span><span>]</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>}</span>
  <span>}</span>
<span>}</span><span>)</span><span>(</span>w<span>,</span> <span>-</span><span>0x8aa</span> <span>*</span> <span>0x95</span> <span>+</span> <span>-</span><span>0xf2</span> <span>*</span> <span>0x159</span> <span>+</span> <span>-</span><span>0x32</span> <span>*</span> <span>-</span><span>0x2f2b</span><span>)</span><span>;</span>
</code></pre>
<h3 id="3-define-the-decode-function">3. Define the decode function</h3>
<p>This function is called throughout the entire script. It retrieves the cleartext strings from the shuffled array and is often used when accessing or invoke functions on global objects:</p>
<p>e.g.:</p>
<pre><code><span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>&#39;enc&#39;</span> <span>+</span> <span>J</span><span>(</span><span>0x1c1</span><span>,</span> <span>&#39;@UgF&#39;</span><span>)</span><span>]</span> <span>// Likely is a call to TextEncoder().encode</span>
</code></pre>
<p>The function responsible is an obfuscated mess:</p>
<pre><code><span>function</span> <span>J</span><span>(</span><span><span>U</span><span>,</span> <span>O</span></span><span>)</span> <span>{</span>
<span>const</span> g <span>=</span> <span>w</span><span>(</span><span>)</span><span>;</span>
<span>return</span> <span><span>J</span></span> <span>=</span> <span>function</span><span>(</span><span>y<span>,</span> <span>H</span></span><span>)</span> <span>{</span>
    y <span>=</span> y <span>-</span> <span>(</span><span>0x244f</span> <span>+</span> <span>0xd7</span> <span>*</span> <span>-</span><span>0x21</span> <span>+</span> <span>-</span><span>0x6b3</span><span>)</span><span>;</span>
    <span>let</span> <span>P</span> <span>=</span> g<span>[</span>y<span>]</span><span>;</span>
    <span>if</span> <span>(</span><span>J</span><span>[</span><span>&#39;WizbPL&#39;</span><span>]</span> <span>===</span> <span>undefined</span><span>)</span> <span>{</span>
        <span>var</span> <span>r</span> <span>=</span> <span>function</span><span>(</span><span>i</span><span>)</span> <span>{</span>
            <span>const</span> <span>G</span> <span>=</span> <span>&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&#39;</span><span>;</span>
            <span>let</span> <span>C</span> <span>=</span> <span>&#39;&#39;</span>
                <span>,</span> <span>Y</span> <span>=</span> <span>&#39;&#39;</span><span>,</span> <span>X</span> <span>=</span> <span>C</span> <span>+</span> r<span>;</span>
            <span>for</span> <span>(</span><span>let</span> m <span>=</span> <span>0x1</span> <span>*</span> <span>-</span><span>0x161b</span> <span>+</span> <span>-</span><span>0x1223</span> <span>*</span> <span>0x1</span> <span>+</span> <span>0x283e</span> <span>*</span> <span>0x1</span><span>,</span> j<span>,</span> s<span>,</span> b <span>=</span> <span>-</span><span>0x368</span> <span>*</span> <span>-</span><span>0x7</span> <span>+</span> <span>-</span><span>0xcc</span> <span>+</span> <span>-</span><span>0x170c</span><span>;</span> s <span>=</span> i<span>[</span><span>&#39;charAt&#39;</span><span>]</span><span>(</span>b<span>++</span><span>)</span><span>;</span> <span>~</span>s <span>&amp;&amp;</span> <span>(</span>j <span>=</span> m <span>%</span> <span>(</span><span>0x33b</span> <span>*</span> <span>0x2</span> <span>+</span> <span>0x21ae</span> <span>*</span> <span>0x1</span> <span>+</span> <span>-</span><span>0x2820</span><span>)</span> <span>?</span> j <span>*</span> <span>(</span><span>-</span><span>0xb5</span> <span>*</span> <span>-</span><span>0x6</span> <span>+</span> <span>0x19d</span> <span>*</span> <span>0x1</span> <span>+</span> <span>0x23</span> <span>*</span> <span>-</span><span>0x29</span><span>)</span> <span>+</span> s <span>:</span> s<span>,</span>
            m<span>++</span> <span>%</span> <span>(</span><span>-</span><span>0x1de2</span> <span>*</span> <span>0x1</span> <span>+</span> <span>-</span><span>0x229d</span> <span>+</span> <span>-</span><span>0x1581</span> <span>*</span> <span>-</span><span>0x3</span><span>)</span><span>)</span> <span>?</span> <span>C</span> <span>+=</span> <span>X</span><span>[</span><span>&#39;charCodeAt&#39;</span><span>]</span><span>(</span>b <span>+</span> <span>(</span><span>-</span><span>0x1039</span> <span>+</span> <span>-</span><span>0x20b</span> <span>*</span> <span>-</span><span>0x4</span> <span>+</span> <span>0x1</span> <span>*</span> <span>0x817</span><span>)</span><span>)</span> <span>-</span> <span>(</span><span>0x1</span> <span>*</span> <span>0x15bf</span> <span>+</span> <span>-</span><span>0x25f0</span> <span>+</span> <span>-</span><span>0x5</span> <span>*</span> <span>-</span><span>0x33f</span><span>)</span> <span>!==</span> <span>0x2</span> <span>*</span> <span>0x301</span> <span>+</span> <span>0x1e73</span> <span>+</span> <span>0x3d</span> <span>*</span> <span>-</span><span>0x99</span> <span>?</span> <span>String</span><span>[</span><span>&#39;fromCharCode&#39;</span><span>]</span><span>(</span><span>0xc38</span> <span>+</span> <span>-</span><span>0x1</span> <span>*</span> <span>-</span><span>0x1e32</span> <span>+</span> <span>0x17</span> <span>*</span> <span>-</span><span>0x1cd</span> <span>&amp;</span> j <span>&gt;&gt;</span> <span>(</span><span>-</span><span>(</span><span>0x1</span> <span>*</span> <span>-</span><span>0x8d7</span> <span>+</span> <span>0x2b</span> <span>*</span> <span>-</span><span>0x31</span> <span>+</span> <span>0x1114</span> <span>*</span> <span>0x1</span><span>)</span> <span>*</span> m <span>&amp;</span> <span>-</span><span>0x16f6</span> <span>+</span> <span>0x2</span> <span>*</span> <span>-</span><span>0x179</span> <span>+</span> <span>-</span><span>0xcf7</span> <span>*</span> <span>-</span><span>0x2</span><span>)</span><span>)</span> <span>:</span> m <span>:</span> <span>0x9</span> <span>*</span> <span>0xb1</span> <span>+</span> <span>0x712</span> <span>+</span> <span>-</span><span>0xd4b</span><span>)</span> <span>{</span>
                s <span>=</span> <span>G</span><span>[</span><span>&#39;indexOf&#39;</span><span>]</span><span>(</span>s<span>)</span><span>;</span>
            <span>}</span>
            <span>for</span> <span>(</span><span>let</span> x <span>=</span> <span>0xc7</span> <span>*</span> <span>-</span><span>0x1f</span> <span>+</span> <span>0x28</span> <span>+</span> <span>0x17f1</span><span>,</span> c <span>=</span> <span>C</span><span>[</span><span>&#39;length&#39;</span><span>]</span><span>;</span> x <span>&lt;</span> c<span>;</span> x<span>++</span><span>)</span> <span>{</span>
                <span>Y</span> <span>+=</span> <span>&#39;%&#39;</span> <span>+</span> <span>(</span><span>&#39;00&#39;</span> <span>+</span> <span>C</span><span>[</span><span>&#39;charCodeAt&#39;</span><span>]</span><span>(</span>x<span>)</span><span>[</span><span>&#39;toString&#39;</span><span>]</span><span>(</span><span>-</span><span>0x1c20</span> <span>+</span> <span>-</span><span>0x8f3</span> <span>+</span> <span>0x2523</span><span>)</span><span>)</span><span>[</span><span>&#39;slice&#39;</span><span>]</span><span>(</span><span>-</span><span>(</span><span>-</span><span>0x1e8b</span> <span>+</span> <span>0x12d</span> <span>*</span> <span>-</span><span>0xf</span> <span>+</span> <span>0x202</span> <span>*</span> <span>0x18</span><span>)</span><span>)</span><span>;</span>
            <span>}</span>
            <span>return</span> <span>decodeURIComponent</span><span>(</span><span>Y</span><span>)</span><span>;</span>
        <span>}</span><span>;</span>
        <span>const</span> <span><span>F</span></span> <span>=</span> <span>function</span><span>(</span><span><span>G</span><span>,</span> <span>C</span></span><span>)</span> <span>{</span>
            <span>let</span> <span>Y</span> <span>=</span> <span>[</span><span>]</span><span>,</span> <span>X</span> <span>=</span> <span>0x240d</span> <span>+</span> <span>0x10b2</span> <span>+</span> <span>-</span><span>0x34bf</span><span>,</span> m<span>,</span> b <span>=</span> <span>&#39;&#39;</span><span>;</span>
            <span>G</span> <span>=</span> <span>r</span><span>(</span><span>G</span><span>)</span><span>;</span>
            <span>let</span> c<span>;</span>
            <span>for</span> <span>(</span>c <span>=</span> <span>-</span><span>0x884</span> <span>+</span> <span>-</span><span>0xc47</span> <span>*</span> <span>-</span><span>0x1</span> <span>+</span> <span>0x3c3</span> <span>*</span> <span>-</span><span>0x1</span><span>;</span> c <span>&lt;</span> <span>-</span><span>0x224e</span> <span>+</span> <span>-</span><span>0x1f32</span> <span>+</span> <span>0x1</span> <span>*</span> <span>0x4280</span><span>;</span> c<span>++</span><span>)</span> <span>{</span>
                <span>Y</span><span>[</span>c<span>]</span> <span>=</span> c<span>;</span>
            <span>}</span>
            <span>for</span> <span>(</span>c <span>=</span> <span>-</span><span>0x35d</span> <span>+</span> <span>0x1202</span> <span>+</span> <span>-</span><span>0xea5</span> <span>*</span> <span>0x1</span><span>;</span> c <span>&lt;</span> <span>-</span><span>0x2326</span> <span>+</span> <span>0x3f</span> <span>*</span> <span>-</span><span>0x97</span> <span>+</span> <span>0x494f</span><span>;</span> c<span>++</span><span>)</span> <span>{</span>
                <span>X</span> <span>=</span> <span>(</span><span>X</span> <span>+</span> <span>Y</span><span>[</span>c<span>]</span> <span>+</span> <span>C</span><span>[</span><span>&#39;charCodeAt&#39;</span><span>]</span><span>(</span>c <span>%</span> <span>C</span><span>[</span><span>&#39;length&#39;</span><span>]</span><span>)</span><span>)</span> <span>%</span> <span>(</span><span>-</span><span>0xba5</span> <span>+</span> <span>-</span><span>0xf50</span> <span>+</span> <span>-</span><span>0x11</span> <span>*</span> <span>-</span><span>0x1a5</span><span>)</span><span>,</span>
                m <span>=</span> <span>Y</span><span>[</span>c<span>]</span><span>,</span>
<span>// ...</span>
</code></pre>
<p>If you&#39;re familiar with JavaScript obfuscation, or are a regular reader of our blog, you might recognize the style of this obfuscation.
It&#39;s <a href="https://github.com/javascript-obfuscator/javascript-obfuscator">javascript-obfuscator</a>, an extremely popular, open-source JavaScript obfuscator.
If you’ve ever encountered obfuscated JS in the wild, there’s a good chance it was produced by this tool or a modified variant.</p>
<p>Because of its popularity, there are already public tools that can reverse the transformations. The most reliable is a deobfuscator by <a href="https://blog.deobfuscate.io/">ben-sb</a>. You can try it out at <a href="https://obf-io.deobfuscate.io">https://obf-io.deobfuscate.io</a>.</p>
<p>In this article, however, we’ll create our own deobfuscator from scratch to understand how the process works under the hood.</p>
<p>By looking at the obfuscator’s source, we can find the template for the string decode function. We see that the function is just doing a Base64 decode (atob) followed by RC4 (combined with some anti-tamper) to reveal the original string:</p>
<pre><code><span>export</span> <span>function</span> <span><span>StringArrayRC4DecodeTemplate</span></span> <span>(</span>
    <span><span>randomGenerator</span><span>:</span> <span>IRandomGenerator</span></span>
<span>)</span><span>:</span> string <span>{</span>
    <span>const</span> <span>identifierLength</span><span>:</span> number <span>=</span> <span>6</span><span>;</span>
    <span>const</span> <span>initializedIdentifier</span><span>:</span> string <span>=</span> randomGenerator<span>.</span><span>getRandomString</span><span>(</span>identifierLength<span>)</span><span>;</span>
    <span>const</span> <span>rc4Identifier</span><span>:</span> string <span>=</span> randomGenerator<span>.</span><span>getRandomString</span><span>(</span>identifierLength<span>)</span><span>;</span>
    <span>const</span> <span>onceIdentifier</span><span>:</span> string <span>=</span> randomGenerator<span>.</span><span>getRandomString</span><span>(</span>identifierLength<span>)</span><span>;</span>

    <span>return</span> <span><span>`</span><span>
        if ({stringArrayCallsWrapperName}.</span><span><span>${</span>initializedIdentifier<span>}</span></span><span> === undefined) {
            {atobPolyfill}
            {rc4Polyfill}
            {stringArrayCallsWrapperName}.</span><span><span>${</span>rc4Identifier<span>}</span></span><span> = {rc4FunctionName};
            
            {stringArrayCacheName} = arguments;
            
            {stringArrayCallsWrapperName}.</span><span><span>${</span>initializedIdentifier<span>}</span></span><span> = true;
        }
  
        const firstValue = stringArray[0];
        const cacheKey = index + firstValue;
        const cachedValue = {stringArrayCacheName}[cacheKey];

        if (!cachedValue) {
            if ({stringArrayCallsWrapperName}.</span><span><span>${</span>onceIdentifier<span>}</span></span><span> === undefined) {
                {selfDefendingCode}
                
                {stringArrayCallsWrapperName}.</span><span><span>${</span>onceIdentifier<span>}</span></span><span> = true;
            }
            
            value = {stringArrayCallsWrapperName}.</span><span><span>${</span>rc4Identifier<span>}</span></span><span>(value, key);
            {stringArrayCacheName}[cacheKey] = value;
        } else {
            value = cachedValue;
        }
    </span><span>`</span></span><span>;</span>
<span>}</span>
</code></pre>
<h2 id="writing-the-tool">Writing the Tool</h2>
<p>While this information is cool to know, for our case it doesn&#39;t really matter what encoding scheme they&#39;re using since we won&#39;t be reimplementing it. Instead, we&#39;ll use Babel to extract all the functions needed for string decoding and call them whenever we run into a decode call in the source.</p>
<p>Following the steps described above:</p>
<h3 id="1-finding-the-encoded-string-constants">1. Finding the encoded string constants</h3>
<p>Using <code>@babel/traverse</code>, we can look for a function that defines an array made up entirely of string constants. That signature is good enough for our purposes since there&#39;s only one function like that in the script:</p>
<pre><code><span>const</span> ast <span>=</span> parser<span>.</span><span>parse</span><span>(</span>source<span>,</span> <span>{</span>
  <span>sourceType</span><span>:</span> <span>&#39;module&#39;</span><span>,</span>
  <span>plugins</span><span>:</span> <span>[</span><span>&#39;dynamicImport&#39;</span><span>]</span>
<span>}</span><span>)</span><span>;</span>

<span>let</span> stringConstantsFunction <span>=</span> <span>null</span><span>;</span>

traverse<span>.</span><span>default</span><span>(</span>ast<span>,</span> <span>{</span>
  <span>// Visit all function declarations</span>
  <span><span>FunctionDeclaration</span></span><span>(</span><span>path</span><span>)</span> <span>{</span>
    <span>const</span> body <span>=</span> path<span>.</span><span>node</span><span>.</span><span>body</span><span>.</span><span>body</span><span>;</span>
    <span>// Get the first statement of the function declaration</span>
    <span>const</span> <span>[</span>firstStatement<span>]</span> <span>=</span> body<span>;</span>
    <span>if</span> <span>(</span>
      <span>// If we are declaring a variable that is an array with only string literals</span>
      firstStatement<span>?.</span>type <span>===</span> <span>&#39;VariableDeclaration&#39;</span> <span>&amp;&amp;</span>
      firstStatement<span>?.</span>declarations<span>[</span><span>0</span><span>]</span><span>?.</span>init<span>?.</span>type <span>===</span> <span>&#39;ArrayExpression&#39;</span> <span>&amp;&amp;</span>
      firstStatement<span>?.</span>declarations<span>[</span><span>0</span><span>]</span><span>?.</span>init<span>?.</span>elements<span>?.</span><span>every</span><span>(</span><span>el</span> <span>=&gt;</span> el<span>?.</span>type <span>===</span> <span>&#39;StringLiteral&#39;</span><span>)</span>
    <span>)</span> <span>{</span>
      <span>// We found the string constants function</span>
      stringConstantsFunction <span>=</span> path<span>.</span><span>node</span><span>;</span>
    <span>}</span>
  <span>}</span>
<span>}</span><span>)</span><span>;</span>
</code></pre>
<h3 id="2-finding-the-shuffle-function">2. Finding the shuffle function</h3>
<p>For this, we can search for an IIFE that contains a <code>while(!![])</code> loop:</p>
<pre><code>traverse<span>.</span><span>default</span><span>(</span>ast<span>,</span> <span>{</span>
    <span><span>ExpressionStatement</span></span><span>(</span><span>path</span><span>)</span> <span>{</span>
      <span>const</span> expr <span>=</span> path<span>.</span><span>node</span><span>.</span><span>expression</span><span>;</span>
      <span>if</span> <span>(</span>
        expr<span>?.</span>type <span>===</span> <span>&#39;CallExpression&#39;</span> <span>&amp;&amp;</span>
        expr<span>.</span><span>callee</span><span>.</span><span>type</span> <span>===</span> <span>&#39;FunctionExpression&#39;</span>
      <span>)</span> <span>{</span>
        <span>// Look for a while statement with `!!` in the tested expression</span>
        <span>const</span> hasShuffle <span>=</span> expr<span>.</span><span>callee</span><span>.</span><span>body</span><span>.</span><span>body</span><span>.</span><span>some</span><span>(</span><span>n</span> <span>=&gt;</span>
          n<span>.</span><span>type</span> <span>===</span> <span>&#39;WhileStatement&#39;</span> <span>&amp;&amp;</span>
          n<span>.</span><span>test</span><span>.</span><span>type</span> <span>===</span> <span>&#39;UnaryExpression&#39;</span> <span>&amp;&amp;</span>
          n<span>.</span><span>test</span><span>.</span><span>operator</span> <span>===</span> <span>&#39;!&#39;</span> <span>&amp;&amp;</span>
          n<span>.</span><span>test</span><span>.</span><span>argument</span><span>.</span><span>type</span> <span>===</span> <span>&#39;UnaryExpression&#39;</span> <span>&amp;&amp;</span>
          n<span>.</span><span>test</span><span>.</span><span>argument</span><span>.</span><span>operator</span> <span>===</span> <span>&#39;!&#39;</span>
        <span>)</span><span>;</span>
        <span>if</span> <span>(</span>hasShuffle<span>)</span>
            shuffleNode <span>=</span> path<span>.</span><span>node</span><span>;</span>
      <span>}</span>
    <span>}</span>
  <span>}</span><span>)</span><span>;</span>
</code></pre>
<h3 id="3-finding-the-decode-function">3. Finding the decode function</h3>
<p>Now, we just need to look for a function where the first statement includes a call to the string constants function from step 1:</p>
<pre><code>traverse<span>.</span><span>default</span><span>(</span>ast<span>,</span> <span>{</span>
<span><span>FunctionDeclaration</span></span><span>(</span><span>path</span><span>)</span> <span>{</span>
    <span>const</span> body <span>=</span> path<span>.</span><span>node</span><span>.</span><span>body</span><span>.</span><span>body</span><span>;</span>
    <span>const</span> <span>[</span>firstStatement<span>]</span> <span>=</span> body<span>;</span>
    <span>if</span> <span>(</span>
    <span>// Are we calling the string constants function?</span>
    firstStatement<span>?.</span>type <span>===</span> <span>&#39;VariableDeclaration&#39;</span> <span>&amp;&amp;</span>
    firstStatement<span>?.</span>declarations<span>[</span><span>0</span><span>]</span><span>.</span><span>init</span><span>?.</span>type <span>===</span> <span>&#39;CallExpression&#39;</span> <span>&amp;&amp;</span>
    firstStatement<span>?.</span>declarations<span>[</span><span>0</span><span>]</span><span>.</span><span>init</span><span>.</span><span>callee</span><span>.</span><span>name</span> <span>===</span> stringConstantsFunction<span>.</span><span>id</span><span>.</span><span>name</span>
    <span>)</span> <span>{</span>
    <span>// We found the string decode function</span>
    stringDecodeFunction <span>=</span> path<span>.</span><span>node</span><span>;</span>
    <span>}</span>
<span>}</span><span>,</span>
<span>}</span><span>)</span><span>;</span>
</code></pre>
<h3 id="cleaning-the-script">Cleaning the script</h3>
<p>Using the Node <code>vm</code> package, we can move these functions into a self-contained script and run them in their own execution environment.</p>
<p>It’s worth noting that this is <em>not</em> a sandboxed environment so this doesn’t offer any real security or isolation:</p>
<pre><code><span>// Create empty AST as the base for our new script</span>
<span>const</span> deobfAst <span>=</span> parser<span>.</span><span>parse</span><span>(</span><span>&#39;&#39;</span><span>,</span> <span>{</span> <span>sourceType</span><span>:</span> <span>&#39;module&#39;</span> <span>}</span><span>)</span><span>;</span>

<span>// Push the functions we located</span>
deobfAst<span>.</span><span>program</span><span>.</span><span>body</span><span>.</span><span>push</span><span>(</span>stringConstantsFunction<span>,</span> stringDecodeFunction<span>,</span> shuffleNode<span>)</span><span>;</span>
<span>// Export it so we can use it</span>
deobfAst<span>.</span><span>program</span><span>.</span><span>body</span><span>.</span><span>push</span><span>(</span>
  parser<span>.</span><span>parse</span><span>(</span><span><span>`</span><span>module.exports = </span><span><span>${</span>stringDecodeFunction<span>.</span><span>id</span><span>.</span><span>name</span><span>}</span></span><span>;</span><span>`</span></span><span>,</span> <span>{</span> <span>sourceType</span><span>:</span> <span>&#39;module&#39;</span> <span>}</span><span>)</span><span>.</span><span>program</span><span>.</span><span>body</span><span>[</span><span>0</span><span>]</span>
<span>)</span><span>;</span>

<span>const</span> <span>{</span> <span>code</span><span>:</span> deobfCode <span>}</span> <span>=</span> generate<span>.</span><span>default</span><span>(</span>deobfAst<span>,</span> <span>{</span> <span>compact</span><span>:</span> <span>true</span> <span>}</span><span>)</span><span>;</span>
<span>const</span> ctx <span>=</span> <span>{</span> <span>module</span><span>:</span> <span>{</span><span>}</span> <span>}</span><span>;</span>

<span>// Create a VM context to run in</span>
vm<span>.</span><span>createContext</span><span>(</span>ctx<span>)</span><span>;</span>
vm<span>.</span><span>runInContext</span><span>(</span>deobfCode<span>,</span> ctx<span>)</span><span>;</span>

<span>// Reference the exported function so we can call it in our next pass</span>
<span>const</span> decodeString <span>=</span> ctx<span>.</span><span>module</span><span>.</span><span>exports</span><span>;</span>
</code></pre>
<p>We can now go over all the encoded strings and call the deobfuscate function on each one, replacing the original node with its return value:</p>
<pre><code><span>const</span> <span>deobfuscateStrings</span> <span>=</span> <span>(</span><span><span>{</span> <span>types</span><span>:</span> t <span>}</span></span><span>)</span> <span>=&gt;</span> <span>(</span><span>{</span>
  <span>visitor</span><span>:</span> <span>{</span>
    <span><span>CallExpression</span></span><span>(</span><span>path</span><span>)</span> <span>{</span>
      <span>const</span> <span>[</span>first<span>,</span> second<span>]</span> <span>=</span> path<span>.</span><span>node</span><span>.</span><span>arguments</span><span>;</span>
      <span>if</span> <span>(</span>
        <span>// Is the first argument a numeric hex literal (e.g.: 0x123)</span>
        t<span>.</span><span>isNumericLiteral</span><span>(</span>first<span>)</span> <span>&amp;&amp;</span>
        first<span>.</span><span>extra</span><span>?.</span>raw<span>?.</span><span>startsWith</span><span>(</span><span>&#39;0x&#39;</span><span>)</span> <span>&amp;&amp;</span>
        <span>// Is the second argument a string literal?</span>
        t<span>.</span><span>isStringLiteral</span><span>(</span>second<span>)</span>
      <span>)</span> <span>{</span>
        <span>// Call the decode function and replace the node with the return value</span>
        <span>const</span> val <span>=</span> <span>decodeString</span><span>(</span>first<span>.</span><span>value</span><span>,</span> second<span>.</span><span>value</span><span>)</span><span>;</span>
        path<span>.</span><span>replaceWith</span><span>(</span>t<span>.</span><span>stringLiteral</span><span>(</span>val<span>)</span><span>)</span><span>;</span>
      <span>}</span>
    <span>}</span>
  <span>}</span>
<span>}</span><span>)</span><span>;</span>
</code></pre>
<p>This will correctly convert our previously ciphered function call from</p>
<pre><code><span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>&#39;enc&#39;</span> <span>+</span> <span>S</span><span>(</span><span>0x1c1</span><span>,</span> <span>&#39;@UgF&#39;</span><span>)</span><span>]</span>
</code></pre>
<p>to</p>
<pre><code><span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>&#34;enc&#34;</span> <span>+</span> <span>&#34;ode&#34;</span><span>]</span>
</code></pre>
<p>As an added convenience, we can add a constant folding pass to turn expressions like <code>&#34;enc&#34; + &#34;ode&#34;</code> into just <code>encode</code>:</p>
<pre><code><span>const</span> <span>constantFoldPlugin</span> <span>=</span> <span>(</span><span><span>{</span> <span>types</span><span>:</span> t <span>}</span></span><span>)</span> <span>=&gt;</span> <span>(</span><span>{</span>
  <span>visitor</span><span>:</span> <span>{</span>
    <span>BinaryExpression</span><span>:</span> <span>{</span>
      <span>exit</span><span>(</span><span>path</span><span>)</span> <span>{</span>
        <span>if</span> <span>(</span>
          path<span>.</span><span>node</span><span>.</span><span>operator</span> <span>===</span> <span>&#39;+&#39;</span> <span>&amp;&amp;</span>
          t<span>.</span><span>isStringLiteral</span><span>(</span>path<span>.</span><span>node</span><span>.</span><span>left</span><span>)</span> <span>&amp;&amp;</span>
          t<span>.</span><span>isStringLiteral</span><span>(</span>path<span>.</span><span>node</span><span>.</span><span>right</span><span>)</span>
        <span>)</span> <span>{</span>
          path<span>.</span><span>replaceWith</span><span>(</span>t<span>.</span><span>stringLiteral</span><span>(</span>path<span>.</span><span>node</span><span>.</span><span>left</span><span>.</span><span>value</span> <span>+</span> path<span>.</span><span>node</span><span>.</span><span>right</span><span>.</span><span>value</span><span>)</span><span>)</span><span>;</span>
        <span>}</span>
      <span>}</span>
    <span>}</span>
  <span>}</span>
<span>}</span><span>)</span><span>;</span>
</code></pre>
<p>And similarly for binary expressions that only contain numeric literals (e.g. <code>-0x239e + -0xa7 * -0xf + 0x19d6</code> becomes <code>1</code>):</p>
<pre><code><span>const</span> <span>evaluateConstants</span> <span>=</span> <span>(</span><span><span>{</span> <span>types</span><span>:</span> t <span>}</span></span><span>)</span> <span>=&gt;</span> <span>(</span><span>{</span>
  <span>visitor</span><span>:</span> <span>{</span>
    <span><span>Expression</span></span><span>(</span><span>path</span><span>)</span> <span>{</span>
      <span>// Avoid replacing expressions that have already been simplified</span>
      <span>if</span> <span>(</span>path<span>.</span><span>node</span><span>.</span><span>_evaluated</span><span>)</span> <span>return</span><span>;</span>

      <span>const</span> evaluation <span>=</span> path<span>.</span><span>evaluate</span><span>(</span><span>)</span><span>;</span>

      <span>if</span> <span>(</span>evaluation<span>.</span><span>confident</span> <span>&amp;&amp;</span> <span>typeof</span> evaluation<span>.</span><span>value</span> <span>===</span> <span>&#39;number&#39;</span><span>)</span> <span>{</span>
        <span>const</span> literal <span>=</span> t<span>.</span><span>numericLiteral</span><span>(</span>evaluation<span>.</span><span>value</span><span>)</span><span>;</span>
        literal<span>.</span><span>_evaluated</span> <span>=</span> <span>true</span><span>;</span> <span>// prevent re-visiting</span>
        path<span>.</span><span>replaceWith</span><span>(</span>literal<span>)</span><span>;</span>
      <span>}</span>
    <span>}</span>
  <span>}</span>
<span>}</span><span>)</span><span>;</span>
</code></pre>
<p>With these passes, the previously obfuscated <code>X</code> function becomes a lot clearer:</p>
<pre><code><span>async</span> <span>function</span> <span>X</span><span>(</span><span>b<span>,</span> x</span><span>)</span> <span>{</span>
    <span>const</span> <span>S</span> <span>=</span> k<span>;</span>
    <span>let</span> <span>L</span> <span>=</span> crypto<span>[</span><span>&#34;getRandomValues&#34;</span><span>]</span><span>(</span><span>new</span> <span>Uint8Array</span><span>(</span><span>16</span><span>)</span><span>)</span><span>,</span>
    <span>V</span> <span>=</span> crypto<span>[</span><span>&#34;getRandomValues&#34;</span><span>]</span><span>(</span><span>new</span> <span>Uint8Array</span><span>(</span><span>12</span><span>)</span><span>)</span><span>,</span>
    <span>// These variables are set in the beginning of the script</span>
    <span>// but i&#39;ve included them here as comments to make the</span>
    <span>// function&#39;s purpose more obvious</span>

    <span>W</span> <span>=</span> <span>await</span> crypto<span>[</span><span>&#34;subtle&#34;</span><span>]</span><span>[</span><span>&#34;importKey&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;nOdPK&#34;</span><span>]</span><span>,</span> <span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>&#34;encode&#34;</span><span>]</span><span>(</span>b<span>)</span><span>,</span> <span>H</span><span>[</span><span>&#34;QTrOm&#34;</span><span>]</span> <span>/* PBKDF2 */</span><span>,</span> <span>!</span><span>1</span><span>,</span> <span>[</span><span>H</span><span>[</span><span>&#34;vzGnW&#34;</span><span>]</span> <span>/* deriveBits */</span><span>,</span> <span>H</span><span>[</span><span>&#34;EeBaB&#34;</span><span>]</span> <span>/* deriveKey */</span><span>]</span><span>)</span><span>,</span>
    <span>E</span> <span>=</span> <span>await</span> crypto<span>[</span><span>&#34;subtle&#34;</span><span>]</span><span>[</span><span>&#34;deriveKey&#34;</span><span>]</span><span>(</span><span>{</span>
        <span>&#39;name&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;QTrOm&#34;</span><span>]</span> <span>/* PBKDF2 */</span><span>,</span>
        <span>&#39;salt&#39;</span><span>:</span> <span>L</span><span>,</span>
        <span>&#39;iterations&#39;</span><span>:</span> <span>100000</span><span>,</span>
        <span>&#39;hash&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;TtSII&#34;</span><span>]</span> <span>/* SHA-256 */</span>
    <span>}</span><span>,</span> <span>W</span><span>,</span> <span>{</span>
        <span>&#39;name&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;mgAqr&#34;</span><span>]</span> <span>/* AES-GCM */</span><span>,</span>
        <span>&#39;length&#39;</span><span>:</span> <span>256</span>
    <span>}</span><span>,</span> <span>!</span><span>1</span><span>,</span> <span>[</span><span>&#34;encrypt&#34;</span><span>]</span><span>)</span><span>,</span>
    <span>R</span> <span>=</span> <span>await</span> crypto<span>[</span><span>&#34;subtle&#34;</span><span>]</span><span>[</span><span>&#34;encrypt&#34;</span><span>]</span><span>(</span><span>{</span>
        <span>&#39;name&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;mgAqr&#34;</span><span>]</span> <span>/* AES-GCM */</span><span>,</span>
        <span>&#39;iv&#39;</span><span>:</span> <span>V</span>
    <span>}</span><span>,</span> <span>E</span><span>,</span> <span>new</span> <span>TextEncoder</span><span>(</span><span>)</span><span>[</span><span>&#34;encode&#34;</span><span>]</span><span>(</span><span>JSON</span><span>[</span><span>&#34;stringify&#34;</span><span>]</span><span>(</span>x<span>)</span><span>)</span><span>)</span><span>;</span>
    <span>// &#39;XyyaZ&#39;: function(s, b) {</span>
    <span>//     return s(b);</span>
    <span>// },</span>
    <span>return</span> <span>H</span><span>[</span><span>&#34;XyyaZ&#34;</span><span>]</span><span>(</span>btoa<span>,</span> <span>String</span><span>[</span><span>&#34;fromCharCode&#34;</span><span>]</span><span>(</span><span>...</span><span>L</span><span>,</span> <span>...</span><span>V</span><span>,</span> <span>...</span><span>new</span> <span>Uint8Array</span><span>(</span><span>R</span><span>)</span><span>)</span><span>)</span><span>;</span>
<span>}</span>
</code></pre>
<h2 id="understanding-the-x-function">Understanding the X Function</h2>
<p>This function uses the WebCrypto API to derive an AES-256 key via PBKDF2, encrypts the data using AES-GCM, and encodes the salt, IV, and payload into a Base64 string. This is what gets sent to the backend as part of the browser signal verification process.</p>
<h2 id="the-browser-signal-payload">The Browser Signal Payload</h2>
<p>The browser signals themselves are defined in several functions:</p>
<h3 id="detect-leaks-in-window-navigator">Detect Leaks in window &amp; navigator</h3>
<p>Many automation frameworks leak properties into the <code>window</code> object, either for convenience or to enable IPC during development. While useful for debugging, these properties can become an easy giveaway and a reliable way to flag yourself as a bot.</p>
<pre><code><span>// Detect various web driver leaks</span>
<span>function</span> <span>v</span><span>(</span>s <span>/* s = window */</span><span>)</span> <span>{</span>
    <span>const</span> o <span>=</span> k<span>;</span>
    <span>// These two properties are set when controlling</span>
    <span>// a Chromium based browser through the Chrome Devtools Protocol (CDP)</span>
    <span>return</span> <span>!</span><span>!</span>s<span>[</span><span>&#34;domAutomation&#34;</span><span>]</span> <span>||</span> 
    <span>!</span><span>!</span>s<span>[</span><span>&#34;domAutomationController&#34;</span><span>]</span> <span>||</span> 
    <span>// Selenium detection</span>
    <span>!</span><span>!</span>s<span>[</span><span>&#34;_WEBDRIVER_ELEM_CACHE&#34;</span><span>]</span> <span>||</span> 
    <span>// PhantomJS detection (https://phantomjs.org/)</span>
    <span>!</span><span>!</span>s<span>[</span><span>&#34;callPhantom&#34;</span><span>]</span> <span>||</span> 
    <span>!</span><span>!</span>s<span>[</span><span>&#34;_phantom&#34;</span><span>]</span> <span>||</span> 
    <span>// NightmareJS detection (https://github.com/segment-boneyard/nightmare)</span>
    <span>!</span><span>!</span>s<span>[</span><span>&#34;__nightmare&#34;</span><span>]</span> <span>||</span> 
    <span>// chromedriver detection (https://chromium.googlesource.com/chromium/src/+/lkgr/chrome/test/chromedriver/chrome/devtools_client_impl.cc)</span>
    <span>!</span><span>!</span>s<span>[</span><span>&#34;cdc_adoQpoasnfa76pfcZLmcfl_Array&#34;</span><span>]</span> <span>||</span> 
    <span>!</span><span>!</span>s<span>[</span><span>&#34;cdc_adoQpoasnfa76pfcZLmcfl_Promise&#34;</span><span>]</span> <span>||</span> 
    <span>!</span><span>!</span>s<span>[</span><span>&#34;cdc_adoQpoasnfa76pfcZLmcfl_Symbol&#34;</span><span>]</span> <span>||</span> 
    <span>// Puppeteer detection</span>
    <span>Function</span><span>[</span><span>&#34;prototype&#34;</span><span>]</span><span>[</span><span>&#34;toString&#34;</span><span>]</span><span>[</span><span>&#34;toString&#34;</span><span>]</span><span>(</span><span>)</span><span>[</span><span>&#34;includes&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;NeMls&#34;</span><span>]</span> <span>/* __puppeteer_evaluation_script__ */</span><span>)</span> <span>||</span> 
    <span>Function</span><span>[</span><span>&#34;prototype&#34;</span><span>]</span><span>[</span><span>&#34;toString&#34;</span><span>]</span><span>[</span><span>&#34;toString&#34;</span><span>]</span><span>(</span><span>)</span><span>[</span><span>&#34;includes&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;WKkio&#34;</span><span>]</span> <span>/* __playwright_evaluation_script__ */</span><span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>F</span><span>(</span>s <span>/* s = window */</span><span>)</span> <span>{</span>
    <span>const</span> <span>B</span> <span>=</span> k<span>;</span>
    <span>// Selenium check</span>
    <span>return</span> q <span>=</span> <span>&#34;bmB3TrbX&#34;</span><span>,</span> <span>!</span><span>!</span>s<span>[</span><span>&#34;navigator&#34;</span><span>]</span><span>[</span><span>&#34;seleniumWebdriver&#34;</span><span>]</span> <span>||</span>
    <span>// These property is set to true when controlling Chrome using CDP</span>
    <span>!</span><span>!</span>s<span>[</span><span>&#34;navigator&#34;</span><span>]</span><span>[</span><span>&#34;webdriver&#34;</span><span>]</span> <span>||</span> 
    <span>!</span><span>!</span>s<span>[</span><span>&#34;webdriver&#34;</span><span>]</span> <span>||</span> 
    <span>!</span><span>!</span>s<span>[</span><span>&#34;driver&#34;</span><span>]</span> <span>||</span>
    <span>// Another selenium check </span>
    <span>!</span><span>!</span>s<span>[</span><span>&#34;selenium&#34;</span><span>]</span><span>;</span>
<span>}</span>

</code></pre>
<h3 id="detect-headless-in-user-agent">Detect &#34;headless&#34; in User Agent</h3>
<pre><code><span>function</span> <span>i</span><span>(</span>s <span>/* s = window */</span><span>)</span> <span>{</span>
    <span>const</span> <span>M</span> <span>=</span> k<span>;</span>
    <span>// Check if the navigator&#39;s user agent includes &#34;headless&#34;.</span>
    <span>// This is true when Chromium is being controlled with the `--headless` flag passed.</span>
    <span>return</span> s<span>[</span><span>&#34;navigator&#34;</span><span>]</span><span>[</span><span>&#34;userAgent&#34;</span><span>]</span><span>[</span><span>&#34;toLowerCase&#34;</span><span>]</span><span>(</span><span>)</span><span>[</span><span>&#34;includes&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;ZUIun&#34;</span><span>]</span> <span>/* headless */</span><span>)</span><span>;</span>
<span>}</span>
</code></pre>
<h3 id="collect-browsers-gpu-renderer-vendor-information">Collect Browser&#39;s GPU Renderer &amp; Vendor Information</h3>
<p>By creating a <code>canvas</code> and accessing the WebGL context, the script can pull details about the GPU vendor and renderer.
This is helpful for detecting headless environments, where the renderer is often something like “SwiftShader”, Google’s <a href="https://github.com/google/swiftshader">CPU-based fallback for graphics</a><sup><a href="#user-content-fn-swiftshader" id="user-content-fnref-swiftshader" data-footnote-ref="true" aria-describedby="footnote-label">6</a></sup>.</p>
<p>Because this info can be easily spoofed, more advanced anti-bots go a step further. They’ll actually draw something to the canvas, hash the result, and compare that hash to known good or bad values. This allows them to detect subtle differences in how GPUs render images, which can be harder to fake.</p>
<p>Vercel’s Basic Mode doesn’t do any image hashing yet, but it’s a logical next step if they decide to improve their WebGL detection.</p>
<p>If you’re curious about how this works at scale, check out Google’s paper on <a href="https://research.google/pubs/picasso-lightweight-device-class-fingerprinting-for-web-clients/">Picasso: Lightweight Device Class Fingerprinting for Web Clients</a><sup><a href="#user-content-fn-picasso" id="user-content-fnref-picasso" data-footnote-ref="true" aria-describedby="footnote-label">7</a></sup></p>
<pre><code><span>function</span> <span>G</span><span>(</span><span>s</span><span>)</span> <span>{</span>
    <span>const</span> <span>T</span> <span>=</span> k<span>;</span>
    <span>// Create a canvas element </span>
    <span>let</span> b <span>=</span> s<span>[</span><span>&#34;document&#34;</span><span>]</span><span>[</span><span>&#34;createElement&#34;</span><span>]</span><span>(</span><span>&#34;canvas&#34;</span><span>)</span><span>;</span>
    b<span>[</span><span>&#34;getContext&#34;</span><span>]</span><span>(</span><span>&#34;webgl&#34;</span><span>)</span> <span>||</span> b<span>[</span><span>&#34;getContext&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;aSVub&#34;</span><span>]</span> <span>/* experimental-webgl */</span><span>)</span><span>;</span>

    <span>// Get the WebGL context</span>
    <span>let</span> x <span>=</span> b<span>[</span><span>&#34;getContext&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;LauIM&#34;</span><span>]</span> <span>/* webgl */</span><span>)</span> <span>||</span> b<span>[</span><span>&#34;getContext&#34;</span><span>]</span><span>(</span><span>&#34;experimental-webgl&#34;</span><span>)</span><span>,</span>
    c <span>=</span> x<span>?.</span><span>[</span><span>&#34;getExtension&#34;</span><span>]</span><span>?.</span><span>(</span><span>H</span><span>[</span><span>&#34;TCEXm&#34;</span><span>]</span> <span>/* WEBGL_debug_renderer_info */</span><span>)</span><span>;</span>
    
    <span>// Return the vendor and renderer</span>
    <span>// On my desktop machine, this returns</span>
    <span>// Vendor: Google Inc. (NVIDIA)</span>
    <span>// Renderer: ANGLE (NVIDIA, NVIDIA GeForce RTX 4080 (0x00002704) Direct3D11 vs_5_0 ps_5_0, D3D11)</span>
    
    <span>// This is used to check if the browser is utilizing a GPU for rendering</span>
    <span>// Or is relying on software rendering (useful for checking if browser is headless or running in a VM without a GPU)</span>
    <span>return</span> c <span>?</span> <span>(</span>r <span>=</span> <span>H</span><span>[</span><span>&#34;vtKat&#34;</span><span>]</span><span>,</span> <span>{</span>
    <span>&#39;v&#39;</span><span>:</span> x<span>[</span><span>&#34;getParameter&#34;</span><span>]</span><span>(</span>c<span>[</span><span>&#34;UNMASKED_VENDOR_WEBGL&#34;</span><span>]</span><span>)</span><span>,</span>
    <span>&#39;r&#39;</span><span>:</span> x<span>[</span><span>&#34;getParameter&#34;</span><span>]</span><span>(</span>c<span>[</span><span>&#34;UNMASKED_RENDERER_WEBGL&#34;</span><span>]</span><span>)</span>
    <span>}</span><span>)</span> <span>:</span> <span>null</span><span>;</span>
<span>}</span>
</code></pre>
<h3 id="detect-chrome-devtools-protocol-cdp">Detect Chrome Devtools Protocol (CDP)</h3>
<p>The function attempts to detect whether a Chromium-based browser is being instrumented using the <a href="https://chromedevtools.github.io/devtools-protocol/">Chrome DevTools Protocol</a> (CDP). It creates an Error object and overrides its stack property with a custom getter. Under normal circumstances, Chromium doesn’t access the stack property when console functions are called. However, if CDP is enabled, and has issued the <code>Runtime.enable</code> command, Chromium serializes the object to send it over the DevTools protocol. This serialization process accesses the stack property, triggering the custom getter.</p>
<p>If this was confusing, please read Antoine Vastel&#39;s <a href="https://datadome.co/threat-research/how-new-headless-chrome-the-cdp-signal-are-impacting-bot-detection/">How New Headless Chrome &amp; the CDP Signal Are Impacting Bot Detection</a><sup><a href="#user-content-fn-cdp-detection" id="user-content-fnref-cdp-detection" data-footnote-ref="true" aria-describedby="footnote-label">8</a></sup> for a detailed explanation :)</p>
<p>This check also doubles as a way to see if the user has the devtools opened.</p>
<pre><code><span>function</span> <span>C</span><span>(</span><span>)</span> <span>{</span>
    <span>const</span> <span>A</span> <span>=</span> k<span>;</span>
    <span>// If we are running this script locally, don&#39;t run this check</span>
    <span>if</span> <span>(</span><span>location</span><span>[</span><span>&#34;hostname&#34;</span><span>]</span> <span>===</span> <span>H</span><span>[</span><span>&#34;GftGm&#34;</span><span>]</span> <span>/* localhost */</span> <span>||</span> <span>location</span><span>[</span><span>&#34;search&#34;</span><span>]</span><span>[</span><span>&#34;includes&#34;</span><span>]</span><span>(</span><span>H</span><span>[</span><span>&#34;IMeIJ&#34;</span><span>]</span> <span>/* botDebug */</span><span>)</span><span>)</span> <span>return</span> <span>!</span><span>1</span><span>;</span>

    <span>// CDP check</span>
    <span>let</span> s <span>=</span> <span>!</span><span>1</span> <span>// false,</span>
    b <span>=</span> <span>new</span> <span>Error</span><span>(</span><span>&#39;&#39;</span><span>)</span><span>;</span>
    <span>return</span> <span>Object</span><span>[</span><span>&#34;defineProperty&#34;</span><span>]</span><span>(</span>b<span>,</span> <span>H</span><span>[</span><span>&#34;IPbzr&#34;</span><span>]</span><span>,</span> <span>{</span>
    <span>&#39;get&#39;</span><span>(</span><span>)</span> <span>{</span>
        <span>return</span> s <span>=</span> <span>!</span><span>0</span> <span>/* true */</span><span>,</span> <span>&#39;&#39;</span><span>;</span>
    <span>}</span>
    <span>}</span><span>)</span><span>,</span> console<span>[</span><span>&#39;log&#39;</span><span>]</span><span>(</span>b<span>)</span><span>,</span> s<span>;</span>
<span>}</span>
</code></pre>
<h3 id="store-entire-payload-in-an-object">Store Entire Payload in an Object</h3>
<p>The results of all of these detections are then stored in an object returned by <code>function Y</code>:</p>
<pre><code><span>function</span> <span>Y</span><span>(</span><span>)</span> <span>{</span>
    <span>// This function runs and returns the results of</span>
    <span>// all of the browsdr checks</span>
    <span>const</span> a <span>=</span> k<span>;</span>
    <span>let</span> s <span>=</span> <span>window</span><span>;</span>
    <span>return</span> <span>{</span>
    <span>// Any web driver leaks in navigator / window?</span>
    <span>&#39;p&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;YvjhB&#34;</span><span>]</span><span>(</span>v<span>,</span> s<span>)</span><span>,</span>
    <span>/* 
    &#39;nszIW&#39;: function(s, b) {
        return s * b;
    },

    Multiply these two constants.
    */</span>
    <span>&#39;S&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;nszIW&#34;</span><span>]</span><span>(</span><span>0.4856383631795842</span><span>,</span> <span>2</span><span>)</span><span>,</span>
    <span>// WebGL renderer and vendor object</span>
    <span>&#39;w&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;YvjhB&#34;</span><span>]</span><span>(</span><span>G</span><span>,</span> s<span>)</span><span>,</span>
    <span>// More selenium, webdriver, phantom checks in globals</span>
    <span>&#39;s&#39;</span><span>:</span> <span>F</span><span>(</span>s<span>)</span><span>,</span>
    <span>// Does user agent contain &#34;headless&#34;?</span>
    <span>&#39;h&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;YvjhB&#34;</span><span>]</span><span>(</span>i<span>,</span> s<span>)</span><span>,</span>
    <span>// Another CDP / Devtools check by abusing the `Error` object</span>
    <span>&#39;b&#39;</span><span>:</span> <span>H</span><span>[</span><span>&#34;uUxBo&#34;</span><span>]</span><span>(</span><span>C</span><span>)</span>
    <span>}</span><span>;</span>
<span>}</span>
</code></pre>
<p>This payload is then passed to the encryption function described earlier.</p>
<p>Next.js hooks into <code>fetch</code> calls to protected routes and passes the encrypted result as the <code>x-is-human</code> header.</p>
<pre><code><span>window</span><span>.</span><span>fetch</span> <span>=</span> <span>async</span> <span>(</span><span>e<span>,</span> t</span><span>)</span> <span>=&gt;</span> <span>{</span>
   <span>// ...</span>
    <span>let</span> p <span>=</span> <span>await</span> <span>c</span><span>(</span><span>)</span>
      <span>,</span> m <span>=</span> <span>new</span> <span>Headers</span><span>(</span><span>(</span><span>null</span> <span>==</span> t <span>?</span> <span>void</span> <span>0</span> <span>:</span> t<span>.</span><span>headers</span><span>)</span> <span>||</span> <span>(</span>e <span>instanceof</span> <span>Request</span> <span>?</span> e<span>.</span><span>headers</span> <span>:</span> <span>void</span> <span>0</span><span>)</span><span>)</span><span>;</span>
    m<span>.</span><span>set</span><span>(</span><span>&#34;x-is-human&#34;</span><span>,</span> <span>JSON</span><span>.</span><span>stringify</span><span>(</span>p<span>)</span><span>)</span><span>;</span>
    <span>let</span> g <span>=</span> <span>{</span>
        <span>...</span>t<span>,</span>
        <span>headers</span><span>:</span> m
    <span>}</span><span>;</span>
    <span>// ...</span>
    <span>return</span> <span>window</span><span>.</span><span>fetch</span><span>(</span>e<span>,</span> g<span>)</span>
<span>}</span>
</code></pre>
<h2 id="bypassing-the-checks">Bypassing the Checks</h2>
<p>These are all the checks in place at the time of writing. Vercel&#39;s BotID Basic mode is, as the name suggests, pretty basic. These checks can be easily bypassed by spoofing the values before they’re collected:</p>
<pre><code><span>// Call Runtime.disable to prevent CDP check from being flagged</span>
<span>(</span><span>function</span> <span>patchDetection</span><span>(</span><span>)</span> <span>{</span>
    <span>// Patch navigator properties</span>
    <span>Object</span><span>.</span><span>defineProperty</span><span>(</span><span>navigator</span><span>,</span> <span>&#39;webdriver&#39;</span><span>,</span> <span>{</span> <span>get</span><span>:</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>false</span> <span>}</span><span>)</span><span>;</span>

    <span>delete</span> <span>navigator</span><span>.</span><span>seleniumWebdriver</span><span>;</span>
    <span>delete</span> <span>navigator</span><span>.</span><span>driver</span><span>;</span>
    <span>delete</span> <span>navigator</span><span>.</span><span>selenium</span><span>;</span>

    <span>// Patch global window leaks</span>
    <span>delete</span> <span>window</span><span>.</span><span>domAutomation</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>domAutomationController</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>_WEBDRIVER_ELEM_CACHE</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>callPhantom</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>_phantom</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>__nightmare</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>cdc_adoQpoasnfa76pfcZLmcfl_Array</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>cdc_adoQpoasnfa76pfcZLmcfl_Promise</span><span>;</span>
    <span>delete</span> <span>window</span><span>.</span><span>cdc_adoQpoasnfa76pfcZLmcfl_Symbol</span><span>;</span>

    <span>// Override Function.prototype.toString to hide Puppeteer/Playwright markers</span>
    <span>const</span> originalToString <span>=</span> <span>Function</span><span>.</span><span>prototype</span><span>.</span><span>toString</span><span>;</span>
    <span>Function</span><span>.</span><span>prototype</span><span>.</span><span>toString</span> <span>=</span> <span>function</span> <span>(</span><span>)</span> <span>{</span>
        <span>const</span> result <span>=</span> originalToString<span>.</span><span>call</span><span>(</span><span>this</span><span>)</span><span>;</span>
        <span>return</span> result
            <span>.</span><span>replace</span><span>(</span><span><span>/</span><span>__puppeteer_evaluation_script__</span><span>/</span><span>g</span></span><span>,</span> <span>&#39;&#39;</span><span>)</span>
            <span>.</span><span>replace</span><span>(</span><span><span>/</span><span>__playwright_evaluation_script__</span><span>/</span><span>g</span></span><span>,</span> <span>&#39;&#39;</span><span>)</span><span>;</span>
    <span>}</span><span>;</span>

    <span>// Patch navigator.userAgent to hide &#34;Headless&#34;</span>
    <span>const</span> originalUserAgent <span>=</span> <span>navigator</span><span>.</span><span>userAgent</span><span>;</span>
    <span>Object</span><span>.</span><span>defineProperty</span><span>(</span><span>navigator</span><span>,</span> <span>&#39;userAgent&#39;</span><span>,</span> <span>{</span>
        <span>get</span><span>:</span> <span>(</span><span>)</span> <span>=&gt;</span> originalUserAgent<span>.</span><span>replace</span><span>(</span><span><span>/</span><span>HeadlessChrome|headless</span><span>/</span><span>gi</span></span><span>,</span> <span>&#39;Chrome&#39;</span><span>)</span>
    <span>}</span><span>)</span><span>;</span>

    <span>// Patch WebGLRenderingContext.getParameter to spoof renderer &amp; vendor</span>
    <span>const</span> getParameter <span>=</span> <span>WebGLRenderingContext</span><span>.</span><span>prototype</span><span>.</span><span>getParameter</span><span>;</span>
    <span>WebGLRenderingContext</span><span>.</span><span>prototype</span><span>.</span><span>getParameter</span> <span>=</span> <span>function</span> <span>(</span><span>param</span><span>)</span> <span>{</span>
        <span>const</span> ext <span>=</span> <span>this</span><span>.</span><span>getExtension</span><span>(</span><span>&#39;WEBGL_debug_renderer_info&#39;</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>param <span>===</span> ext<span>.</span><span>UNMASKED_VENDOR_WEBGL</span><span>)</span> <span>{</span>
            <span>return</span> <span>&#34;Google Inc. (NVIDIA)&#34;</span><span>;</span>
        <span>}</span>
        <span>if</span> <span>(</span>param <span>===</span> ext<span>.</span><span>UNMASKED_RENDERER_WEBGL</span><span>)</span> <span>{</span>
            <span>return</span> <span>&#34;ANGLE (NVIDIA, NVIDIA GeForce RTX 4080 (0x00002704) Direct3D11 vs_5_0 ps_5_0, D3D11)&#34;</span><span>;</span>
        <span>}</span>
        <span>return</span> getParameter<span>.</span><span>call</span><span>(</span><span>this</span><span>,</span> param<span>)</span><span>;</span>
    <span>}</span><span>;</span>
<span>}</span><span>)</span><span>(</span><span>)</span><span>;</span>
</code></pre>
<h2 id="testing-detection-with-playwright">Testing Detection with Playwright</h2>
<p>I wrote a Playwright script to test two things:</p>
<ol>
<li>Does Basic BotID detect an unpatched Playwright?</li>
<li>If so, can I bypass BotID with my patches?</li>
</ol>
<p>While testing the first part, I noticed something weird.</p>
<pre><code><span>const</span> <span>{</span> chromium <span>}</span> <span>=</span> <span>require</span><span>(</span><span>&#39;playwright&#39;</span><span>)</span><span>;</span>

<span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>const</span> browser <span>=</span> <span>await</span> chromium<span>.</span><span>launch</span><span>(</span><span>{</span> <span>headless</span><span>:</span> <span>true</span> <span>}</span><span>)</span><span>;</span>
  <span>const</span> page <span>=</span> <span>await</span> browser<span>.</span><span>newPage</span><span>(</span><span>)</span><span>;</span>

  <span>// Go to the page</span>
  <span>await</span> page<span>.</span><span>goto</span><span>(</span><span>&#39;https://blog-git-botid-veritasjs-projects.vercel.app/test&#39;</span><span>)</span><span>;</span>

  <span>// Submit the form</span>
  <span>await</span> <span>Promise</span><span>.</span><span>all</span><span>(</span><span>[</span>
    page<span>.</span><span>locator</span><span>(</span><span>&#39;button&#39;</span><span>)</span><span>.</span><span>evaluate</span><span>(</span><span>button</span> <span>=&gt;</span> button<span>.</span><span>click</span><span>(</span><span>)</span><span>)</span>
  <span>]</span><span>)</span><span>;</span>

  <span>const</span> result <span>=</span> <span>await</span> page<span>.</span><span>locator</span><span>(</span><span>&#39;p&#39;</span><span>)</span><span>.</span><span>innerText</span><span>(</span><span>)</span><span>;</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span><span>`</span><span>Is Bot: </span><span><span>${</span>result<span>}</span></span><span>`</span></span><span>)</span><span>;</span>

  <span>const</span> userAgent <span>=</span> <span>await</span> page<span>.</span><span>evaluate</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>navigator</span><span>.</span><span>userAgent</span><span>)</span><span>;</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span><span>`</span><span>User Agent: </span><span><span>${</span>userAgent<span>}</span></span><span>`</span></span><span>)</span><span>;</span>

  <span>const</span> webdriver <span>=</span> <span>await</span> page<span>.</span><span>evaluate</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>navigator</span><span>.</span><span>webdriver</span><span>)</span><span>;</span>
  <span>console</span><span>.</span><span>log</span><span>(</span><span><span>`</span><span>Webdriver: </span><span><span>${</span>webdriver<span>}</span></span><span>`</span></span><span>)</span><span>;</span>

  <span>await</span> browser<span>.</span><span>close</span><span>(</span><span>)</span><span>;</span>
<span>}</span><span>)</span><span>(</span><span>)</span><span>;</span>
</code></pre>
<h3 id="observations-from-playwright-testing">Observations from Playwright Testing</h3>
<p>Output:</p>
<pre><code><span>Is Bot</span><span>:</span> You are a human
<span>User Agent</span><span>:</span> Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML<span>,</span> like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36
<span>Webdriver</span><span>:</span> <span>true</span>
</code></pre>
<p>I found this odd, since our user agent contains <code>Headless</code> and <code>navigator.webdriver</code> is set to <code>true</code>. That should be enough to trip at least two flags, making it obvious to BotID that we’re a bot.</p>
<p>To dig deeper, I wrote some patches to make sure we fail <em>every</em> check:</p>
<pre><code><span>await</span> page<span>.</span><span>addInitScript</span><span>(</span><span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>// We are using a webdriver</span>
    <span>window</span><span>.</span><span>domAutomation</span> <span>=</span> <span>true</span><span>;</span>
    <span>window</span><span>.</span><span>navigator</span><span>.</span><span>webdriver</span> <span>=</span> <span>true</span><span>;</span>

    <span>// Change the user agent to include Headless</span>
    <span>Object</span><span>.</span><span>defineProperty</span><span>(</span><span>navigator</span><span>,</span> <span>&#39;userAgent&#39;</span><span>,</span> <span>{</span>
        <span>get</span><span>:</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>&#39;HeadlessChrome&#39;</span><span>,</span>
    <span>}</span><span>)</span><span>;</span>

    <span>// Spoof WebGL attributes to tell them we are software rendering</span>
    <span>const</span> getParameter <span>=</span> <span>WebGLRenderingContext</span><span>.</span><span>prototype</span><span>.</span><span>getParameter</span><span>;</span>
    <span>WebGLRenderingContext</span><span>.</span><span>prototype</span><span>.</span><span>getParameter</span> <span>=</span> <span>function</span> <span>(</span><span>param</span><span>)</span> <span>{</span>
        <span>const</span> ext <span>=</span> <span>this</span><span>.</span><span>getExtension</span><span>(</span><span>&#39;WEBGL_debug_renderer_info&#39;</span><span>)</span><span>;</span>
        <span>if</span> <span>(</span>ext<span>)</span> <span>{</span>
            <span>if</span> <span>(</span>param <span>===</span> ext<span>.</span><span>UNMASKED_VENDOR_WEBGL</span><span>)</span> <span>{</span>
                <span>return</span> <span>&#34;LOL obviously fake vendor!&#34;</span><span>;</span>
            <span>}</span>
            <span>if</span> <span>(</span>param <span>===</span> ext<span>.</span><span>UNMASKED_RENDERER_WEBGL</span><span>)</span> <span>{</span>
                <span>return</span> <span>&#34;Google SwiftShader&#34;</span><span>;</span>
            <span>}</span>
        <span>}</span>
        <span>return</span> getParameter<span>.</span><span>call</span><span>(</span><span>this</span><span>,</span> param<span>)</span><span>;</span>
    <span>}</span><span>;</span>
<span>}</span><span>)</span><span>;</span>
</code></pre>
<pre><code><span>is-bot</span><span>:</span> You are a human
<span>User Agent</span><span>:</span> HeadlessChrome
<span>Webdriver</span><span>:</span> <span>true</span>
</code></pre>
<p>We were still wrongly identified as a human. My guess is that Vercel is using this launch window to gather signals from a variety of devices before they start enforcing blocks. This likely helps them avoid false positives while they figure out which values to label as “bot-like” versus “human.”</p>
<p>Out of curiosity, I replaced the entire signals payload with an empty object <code>{}</code> in DevTools and only then was I flagged as a bot.</p>
<figure><video width="320" height="240" controls=""><source src="/posts/reversing-botid/should-flag.mp4" type="video/mp4"/><p>Your browser does not support the video tag.</p></video><figcaption>Video showing that basic BotID will currently always return human unless the object is completely empty</figcaption></figure>
<p>At the moment, it seems Basic mode is so basic that it allows everything to pass as human. That’ll likely change as they gather more telemetry to better identify what a bot signal looks like.</p>
<h2 id="deep-analysis-mode">Deep Analysis Mode</h2>
<p>Vercel recommends using their <code>Deep Analysis</code> mode instead of <code>Basic</code>. This mode uses <a href="https://www.kasada.io/">Kasada</a>&#39;s anti-bot to collect even more signals and compare them against their existing trained model to detect bot-like requests.</p>
<p>Enabling this mode requires a <code>Pro</code> ($20/mo) or <code>Enterprise</code> plan, plus an additional cost of <code>$1/1000 req</code>. I upgraded my project from <code>Hobby</code> to <code>Pro</code> to see how Deep Analysis mode works.</p>
<p>With one toggle in the dashboard, Deep Analysis mode was live. I immediately noticed some new but familiar Kasada network requests:</p>
<figure><img alt="Requests for Kasada&#39;s anti-bot scripts" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" sizes="100vw" srcset="/_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=640&amp;q=75 640w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=750&amp;q=75 750w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=828&amp;q=75 828w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=3840&amp;q=75 3840w" src="https://todaythings.substack.com/_next/image?url=%2Fposts%2Freversing-botid%2Fkasada-scripts.webp&amp;w=3840&amp;q=75"/><figcaption>Requests for Kasada&#39;s anti-bot scripts</figcaption></figure>
<h3 id="how-deep-analysis-works">How Deep Analysis Works</h3>
<p>Deep Analysis uses Kasada&#39;s anti-bot script, the same scripts deployed at sites like Nike. It uses a custom virtual machine to obfuscate their signal collection. This means we&#39;d need to disassemble the embedded bytecode to understand what is being sent to their servers for analysis.</p>
<p>This is a much larger undertaking, and was actually done in another nullpt.rs series titled <a href="https://todaythings.substack.com/devirtualizing-nike-vm-1">Devirtualizing Nike.com&#39;s Bot Protection</a> by author <a href="https://todaythings.substack.com/author/umasi">umasi</a> a while back.</p>
<p>Check it out if you&#39;re curious :)</p>
<h2 id="conclusion">Conclusion</h2>
<p>In its current form, Vercel’s BotID (Basic mode) doesn’t seem configured to actually stop bots. It’s likely being used to quietly collect signals for its models before stricter detection kicks in. Deep Analysis, on the other hand, does actively block more advanced bots using Kasada’s fingerprinting scripts and classifiers.</p>
<p>Both modes rely on fingerprinting and client-side data collection, reinforcing the broader trend: anti-bots are increasingly opaque, data-hungry, and can skew toward a narrow definition of what a “normal” user is.</p>
<p>These scripts serve a real purpose, but the way they’re built continues to shape the web in ways that are hard to ignore and even harder to challenge.</p>
<p>Curious to hear your thoughts</p>
<section data-footnotes="true"><h2 id="footnotes">Footnotes</h2>
<ol>
<li id="user-content-fn-cred-stuffing">
<p><a href="https://blog.castle.io/credential-stuffing-attacks-anatomy-detection-and-defense/#what-is-a-credential-stuffing-attack">https://blog.castle.io/credential-stuffing-attacks-anatomy-detection-and-defense/#what-is-a-credential-stuffing-attack</a> <a href="#user-content-fnref-cred-stuffing" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-anthropic">
<p><a href="https://x.com/rauchg/status/1783513104930013490">https://x.com/rauchg/status/1783513104930013490</a> <a href="#user-content-fnref-anthropic" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-fingerprint-js">
<p><a href="https://fingerprintjs.github.io/fingerprintjs/">https://fingerprintjs.github.io/fingerprintjs/</a> <a href="#user-content-fnref-fingerprint-js" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-bot-test">
<p><a href="https://bot.incolumitas.com/">https://bot.incolumitas.com/</a> <a href="#user-content-fnref-bot-test" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-ladybird-turnstile">
<p><a href="https://github.com/LadybirdBrowser/ladybird/issues/226">https://github.com/LadybirdBrowser/ladybird/issues/226</a> <a href="#user-content-fnref-ladybird-turnstile" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-swiftshader">
<p><a href="https://github.com/google/swiftshader">https://github.com/google/swiftshader</a> <a href="#user-content-fnref-swiftshader" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-picasso">
<p><a href="https://research.google/pubs/picasso-lightweight-device-class-fingerprinting-for-web-clients/">https://research.google/pubs/picasso-lightweight-device-class-fingerprinting-for-web-clients/</a> <a href="#user-content-fnref-picasso" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-cdp-detection">
<p><a href="https://datadome.co/threat-research/how-new-headless-chrome-the-cdp-signal-are-impacting-bot-detection/">https://datadome.co/threat-research/how-new-headless-chrome-the-cdp-signal-are-impacting-bot-detection/</a> <a href="#user-content-fnref-cdp-detection" data-footnote-backref="true" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section><div><p><img src="https://avatars.githubusercontent.com/u/25884226" alt="veritas profile picture"/></p><div><p><span>Find <!-- -->veritas<!-- --> on:</span><span>twitter<!-- -->:<!-- --> <a href="https://twitter.com/blastbots">https://twitter.com/blastbots</a></span><span>fedi<!-- -->:<!-- --> <a href="https://infosec.exchange/@voidstar">https://infosec.exchange/@voidstar</a></span><span>bluesky<!-- -->:<!-- --> <a href="https://bsky.app/profile/nullpt.rs">https://bsky.app/profile/nullpt.rs</a></span><span>discord<!-- -->: <!-- -->nullptrs</span></p></div></div></div></div>
  </body>
</html>
