<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://netmeister.org/blog/nsauth-diversity.html">Original</a>
    <h1>Who Controls the Internet? Authoritative NS Records in gTLDs</h1>
    
    <div id="readability-page-1" class="page"><div width="75%">
    <tbody><tr>
      <td>
<h3>A look at diversity of authoritative NS records in gTLDs</h3>
<p><small>November 15th, 2022</small></p>

<p>
<a href="https://xkcd.com/2347/"><img src="https://netmeister.org/blog/images/xkcd2347-dns.png" alt="Modified XKCD 2347 noting the DNS as the main
dependency" width="300"/>
</a>
<small>
This is a blog post version of a talk I gave at the
5th <a href="https://www.icann.org/ids">ICANN DNS
Symposium</a>.
</small>
</p>

<p> Why yes, the internet is resting on a foundation
of <a href="https://netmeister.org/blog/duct-tape-and-wd40.html">duct tape and
WD40</a> - it is known.  And the DNS is the mother of
all corner stones that, if knocked out, would quickly
lead to the fall of western civilization.  (And yes,
it is a hard requirement to use <a href="https://xkcd.com/2347/">this XKCD cartoon</a> to
illustrate this.)  But at least it&#39;s not quite as
fragile as, say, <a href="https://netmeister.org/blog/whois.html">whois</a>, so
yay!  </p>

<p>
But while the DNS <a href="https://root-servers.org">root servers</a> are
known to be distributed, I thought it might be
interesting to take a closer look at the immediate
levels up from the root, and so I went to analyze the
diversity or centralization of the authoritative
nameservers for the generic top-level domains (gTLDs)
and the second-level domains in those gTLDs.
</p>

<p>
To perform this analysis, I started out with the <a href="https://www.iana.org/domains/root/files">root
zone</a>, which (as of November 2022) contains 1485
TLDs.  As I <a href="https://netmeister.org/blog/tlds.html">discussed
previously</a>, just what exactly you find in there is
already utterly fascinating, but for our purposes
here, let&#39;s note that you can then request access to
all of the gTLD zone files via ICANN&#39;s <a href="https://czds.icann.org">Centralized Zone Data
Service</a>, which got me access to 1,165 zones in
total.  In addition, you can obtain the <tt>.gov</tt> zone from <a href="https://github.com/cisagov/dotgov-data">CISA&#39;s
GitHub repository</a>, as well as <tt>.arpa</tt> from most of the root
servers:</p>

<div><pre>$ dig +noall +answer +onesoa @f.root-servers.net arpa. AXFR | more
arpa.                   86400   IN      SOA a.root-servers.net. nstld.verisign-grs.com. 2022111501 1800 900 604800 86400
arpa.                   518400  IN      NS        m.ns.arpa.
arpa.                   518400  IN      NS        c.ns.arpa.
arpa.                   518400  IN      NS        f.ns.arpa.
[...]
</pre></div>

<p>
This leaves us missing the <tt>.edu</tt>,
<tt>.int</tt>, <tt>.mil</tt>
and <tt>.post</tt> TLDs, which are not
generally available. (If you know how to get access,
please <a href="mailto:jschauma@netmeister.org">let me
know</a>.)
</p>

<p>For the country-code specific top-level domains
(ccTLDs), it&#39;s a lot more difficult to gain access:
most operators do not provide public access, although
<a href="https://jpmens.net/2021/05/18/dns-open-zone-data/">some
do</a>: you can <tt>AXFR</tt> some of them or gather
some published data <a href="https://sk-nic.sk/subory/domains.txt">from
others</a>.  Commercial services exist that sell you
zone data, but it seems to me that this data ought to
be public, so I excluded ccTLDs from my analysis for
the time being.</p>

<p>Anyway, so with 1,168 total zone files adding up
to around 7GB of data (of which the <tt>.com</tt> zone accounts for 4.8 GB alone!), I
went ahead and used a variety of shell scripts and
some perl glue to parse out the <tt>NS</tt> records to
then see just what domains <em>those</em> are in,
i.e., who controls them.</p>

<h3><a name="root">The Root</a></h3>

<p>The DNS root zone itself is served by 13 root
authorities, and as such is obviously and trivially
diverse.  The 13 authorities are managed by <a href="https://www.iana.org/domains/root/servers">twelve
root operators</a>: 9 US organizations (including
three US government entities), of which one (Verisign)
operates two roots, one Swedish company (<a href="https://www.netnod.se/">Netnod</a>), one
organization in Japan (<a href="https://www.wide.ad.jp/">WIDE</a>), and one
headquartered in the Netherlands (<a href="https://www.ripe.net/">RIPE NCC</a>).
Obviously, all are in the same domain (i.e., <tt>root-servers.net</tt>):</p>



<p>Now for the root itself, this illustration is of
course a bit silly, but it gives you an idea of what
I&#39;m looking for in this analysis.  And things do get a
bit more interesting once we process all the
<tt>NS</tt> records from the root zone itself, where
we find 7,507 total NS records across 5,612 unique
name servers, which <a href="https://netmeister.org/blog/images/nsauth-root-ns.png">looks</a> reasonably
diverse:
</p>

<div><pre>$ awk &#39;/IN[       ]*NS[   ]/ { print $NF }&#39; root.zone | wc -l
    7507
$ awk &#39;/IN[       ]*NS[   ]/ { print $NF }&#39; root.zone | sort | uniq -c | wc -l
    5625
$ awk &#39;/IN[       ]*NS[   ]/ { print $NF }&#39; root.zone | sort | uniq -c | sort -rn | head -20
 119 ac4.nstld.com.
 119 ac3.nstld.com.
 118 ac2.nstld.com.
 118 ac1.nstld.com.
  47 l.gmoregistry.net.
  47 k.gmoregistry.net.
  47 b.gmoregistry.net.
  47 a.gmoregistry.net.
  46 ns-tld5.charlestonroadregistry.com.
  46 ns-tld4.charlestonroadregistry.com.
  46 ns-tld3.charlestonroadregistry.com.
  46 ns-tld2.charlestonroadregistry.com.
  46 ns-tld1.charlestonroadregistry.com.
  27 anycast9.irondns.net.
  27 anycast24.irondns.net.
  27 anycast23.irondns.net.
  27 anycast10.irondns.net.
  21 j.zdnscloud.com.
  21 i.zdnscloud.com.
  21 g.zdnscloud.com.
$ </pre></div>

<p> But if you look closer, you&#39;ll notice that many of
the nameservers are in the same domain, so if we then
flatten the whole thing, we see a bit more of a
centralization.  For example, 6.3% of the NS
records being under <tt>nstld.com</tt>,
which is operated by Verisign:
</p>

<p>
<img src="https://netmeister.org/blog/images/nsauth-root-domains.png" width="800" alt="Pie
chart showing domains of NS records in the root zone"/>
</p>

<p>But thinking about this distribution a bit more
quickly makes you realize that there isn&#39;t really an
even distribution in the gTLD, since not all domains
have the same footprint.  As you may guess, the <tt>.com</tt> zone has more records than some
of the other zones.  More specifically, <tt>.com</tt> has over 164 million
<tt>NS</tt> records, making up 73% of all the NS
records in <em>all</em> the gTLDs.</p>

<p>
<img src="https://netmeister.org/blog/images/nsauth-ns-by-gtlds.png" width="800" alt="Pie
chart showing the number of NS records in all gTLDs"/>
</p>

<p>The <tt>NS</tt> records for <tt>.com</tt> are in the <tt>gtld-servers.net</tt> domain, but so are
e.g., <tt>.net</tt>&#39;s; similarly, the
<tt>NS</tt> records for <tt>.org</tt> and
<tt>.info</tt> are in the same domain, so
we can flatten this data a little bit more:</p>

<p>
<img src="https://netmeister.org/blog/images/nsauth-ns-by-gtlds-combined.png" width="800" alt="Pie
chart showing the number of NS records in all gTLDs
flattened by domain"/>
</p>

<p>In other words, almost 80% of all  NS records
across <em>all</em> gTLDs are
under the <tt>gtld-servers.net</tt> domain, and thus the
control of Verisign -- the same Verisign that
<em>also</em> operates two roots.</p>

<p>Ok, so this is the representation of the NS records
<em>for</em> the gTLDs within the root zone, but what
about the NS records for all the second-level domains
<em>within</em> the gTLDs?  Parsing all 1,168 zone
files, we end up with 2,699,827 unique name servers
that we can group under 1,063,092 domains:</p>

<p>
<img src="https://netmeister.org/blog/images/nsauth-across-gtlds-by-domain.png" width="800" alt="Pie
chart showing the number of NS records across all gTLDs
flattened by domain"/>
</p>

<p>This shows a notable centralization of the
<tt>NS</tt> records found in all gTLD zones, with <tt>domaincontrol.com</tt> accounting for
roughly 20% alone.</p>

<p>Another thing that seems interesting here is that
some of the cloud companies offering DNS services are
choosing to use a larger number of <tt>NS</tt> records
even across, in the case of AWS, thousands of
second-level domains in several TLDs:</p>

<div><pre>$ grep awsdns- domain-counts.full | head
52221 awsdns-02.org.
49614 awsdns-23.net.
49264 awsdns-49.com.
48276 awsdns-05.co.uk.
46392 awsdns-35.org.
45955 awsdns-53.com.
45593 awsdns-19.net.
44409 awsdns-25.com.
44176 awsdns-22.co.uk.
44140 awsdns-45.org.
$ grep -c awsdns- domain-counts.full 
978
</pre></div>

<p>The data now show that out of the over 534
million <tt>NS</tt> records across a little over 1
million domains:</p>

<ul>
<li>43% of all NS records (roughly 230 million) are served by only 165 name servers found in just 10 domains</li>
<li>52% (~ 278 million) are served by 255 name servers in just 20 domains</li>
<li>75% (~ 401 million) are served by 1,580 name servers in just 100 domains</li>
<li>99% (~ 529 million) are served by 345,000 name servers in 6,000 domains</li>
</ul>

<p>Let&#39;s look at these 20 domains and see who controls
them, and thus over half of all the domains in all the
gTLDs.  They are:</p>

<table>
<tbody><tr>
<td>

<ol>
<li><small><tt>domaincontrol.com</tt> is <s>Wild West Domains</s> GoDaddy ðŸ‡ºðŸ‡¸ (AS44273)</small></li>
<li><small><tt>googledomains.com</tt> is Google ðŸ‡ºðŸ‡¸ (AS15169)</small></li>
<li><small><tt>cloudflare.com</tt> is Cloudflare ðŸ‡ºðŸ‡¸ (AS13335)</small></li>
<li><small><tt>ui-dns.*</tt> is <s>IONOS</s> United Internet AG ðŸ‡©ðŸ‡ª (AS8560)</small></li>
<li><small><tt>registrar-servers.com</tt> is Namecheap ðŸ‡ºðŸ‡¸ (AS397213)</small></li>
<li><small><tt>wixdns.net</tt> is Wix.com Ltd. ðŸ‡®ðŸ‡± (AS15169)</small></li>
<li><small><tt>hichina.com</tt> is Alibaba Cloud Computing ðŸ‡¨ðŸ‡³ (AS37963)</small></li>
<li><small><tt>dns.com</tt> is <s>Comodo</s> Xcitum ðŸ‡ºðŸ‡¸ (AS21859, AS133775 ðŸ‡¨ðŸ‡³)</small></li>
<li><small><tt>awsdns-*</tt> is Amazon Web Services ðŸ‡ºðŸ‡¸ (AS16509)</small></li>
<li><small><tt>nsone.net</tt> is NS1 ðŸ‡ºðŸ‡¸ (AS62597)</small></li>
</ol>
</td>
<td>
<ol start="11">
<li><small><tt>namebrightdns.com</tt> is <s>NameBright</s> Turn Commerce Inc. ðŸ‡ºðŸ‡¸ (AS14618)</small></li>
<li><small><tt>gname-dns.com</tt> is Gname ðŸ‡¸ðŸ‡¬ (AS13335)</small></li>
<li><small><tt>name-services.com</tt> is Enom ðŸ‡ºðŸ‡¸ / ðŸ‡¨ðŸ‡¦ (AS15348)</small></li>
<li><small><tt>dnsowl.com</tt> is NameSilo ðŸ‡ºðŸ‡¸ (AS13335)</small></li>
<li><small><tt>squarespacedns.com</tt> is Squarespace ðŸ‡ºðŸ‡¸ (AS63911)</small></li>
<li><small><tt>worldnic.com</tt> is Network Solutions LLC ðŸ‡ºðŸ‡¸ (AS13335)</small></li>
<li><small><tt>bluehost.com</tt> is Newfold Digital, Inc ðŸ‡ºðŸ‡¸ (AS13335)</small></li>
<li><small><tt>name.com</tt> is <s>Donuts Inc</s> Identity Digital ðŸ‡ºðŸ‡¸ (AS62597)</small></li>
<li><small><tt>myhostadmin.net</tt> ðŸ‡¨ðŸ‡³ (AS38283)</small></li>
<li><small><tt>wordpress.(org|com)</tt> is Automattic Inc. ðŸ‡ºðŸ‡¸ (AS2635)</small></li>
</ol>
</td>
</tr>
</tbody></table>

<p> You may notice that of these 20 organizations, 15
are US entities, 2 Chinese, 1 German, 1 Israeli, and
one from Singapore, giving you an idea what
governments could -- in theory, at least -- exert
control over what percentage of the internet.</p>

<p>Another interesting thing to point out here is that
even though the domains are registered by different
organizations, the name servers in use may actually be
<em>operated</em> from a different entity&#39;s networks.
In particular, it looks like several of the name
servers in these domains are running out of, fronted
by, or otherwise utilizing Cloudflare&#39;s network,
while Wix seems to be using Google Cloud (I&#39;m
guessing) to run their name servers.</p>

<p><tt>name.com</tt> is owned by <a href="https://en.wikipedia.org/wiki/Identity_Digital">Identity
Digital</a>, the rebranding of the merged Donuts and
Afilias (previously discussed <a href="https://netmeister.org/blog/whois.html#registries">here</a>) registries,
which <em>also</em> operates a significant number of
TLD domains.</p>

<p>All in all a sign that perhaps we should take a
look at the Autonomous System (AS) numbers the
various name servers are in, and so, a few thousand
lookups later:</p>

<p> <img src="https://netmeister.org/blog/images/nsauth-gtlds-by-as.png" width="800" alt="Pie chart showing the diversity of AS
numbers for the NS records across all gTLDs"/> </p>

<p>That&#39;s right: around 34% of the majority of
<tt>NS</tt> records are resolving to IP addresses in
Cloudflare&#39;s AS13335, and over half of all are
ultimately served from only four Autonomous Systems:
Cloudflare (<a href="https://bgp.he.net/AS13335#_whois">AS13335</a>),
Alibaba (<a href="https://bgp.he.net/AS37963#_whois">AS37963</a>),
GoDaddy (<a href="https://bgp.he.net/AS44273#_whois">AS44273</a>),
and IONOS (<a href="https://bgp.he.net/AS8560#_whois">AS8560</a>)
(hinting at <a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol">the
other big load-bearing infrastructure pillar</a> that
also remains largely insecure by default.</p>

<p>And while that is interesting by itself, just as
before when we looked at the name servers serving the
gTLD domains themselves and we tried to weigh them
against how many domains they support, perhaps we
should also look at not only the NS diversity in the
raw gTLDs; after all, control of <tt>google.com</tt> or <tt>facebook.com</tt> surely counts more
than, say, <tt>monkeyjungle.com</tt>.</p>

<p>So what do people do when they want to look at
popular domains?  They go for the &#34;Alexa Top 1 Million
Domains&#34; list, of course!  Only... Alexa was bought by
Amazon, and in a sign of &#34;who controls the internet&#34;,
Amazon promptly <a href="https://alexa.com/">shut it
down</a>.  (As of November 8th, 2022, the <a href="http://s3.amazonaws.com/alexa-static/top-1m.cvs.zip">actual
list</a> was still available, but it looks like it has
since been restricted.)  Of course there are other,
similar lists (like e.g., the <a href="https://s3-us-west-1.amazonaws.com/umbrella-static/index.html">Cisco
Umbrella</a> or the <a href="https://majestic.com/reports/majestic-million">Majestic
Million</a>), all of which intersect to some degree
but remain distinct based on the heuristics used by
the data collection mechanisms used.  For this reason,
researchers provide a normalized <a href="https://tranco-list.eu/">Top 1 Million</a> list
(see their <a href="https://tranco-list.eu/assets/tranco-ndss19.pdf">paper</a>
for more details), which I&#39;ve used for this project
here.</p>

<p>Iterating over that full list and looking up the
<tt>NS</tt> records for 1 million domains then yields
a breakdown of 2,636,294 total NS records in 119,291
domains, as well as <a href="https://twitter.com/jschauma/status/1590732890110820355">the
insight</a> that spreadsheets are surprisingly bad at
handling large data sets even of simple text data:</p>

<p> <img src="https://netmeister.org/blog/images/nsauth-top1m.png" width="800" alt="Pie chart showing the diversity of NS
record domains of the top 1 million domains"/></p>

<p>So we see a very similar distribution to our
analysis of all of the NS records in all of the gTLDs
here in the top 1 million domains, too:
More than half of the NS records used by the top one
million domains are found in just 20 of the 120K
domains, served by only 1,740 NS records.</p>

<p>The top ten NS record domains is represented by the
usual suspects (Cloudflare, Amazon, GoDaddy, Akamai,
DigiCert, Google, Microsoft, Alibaba, Network
Solutions, and Namecheap), although not identical to
those we observed for all of the gTLD records.</p>

<p>Also noteworthy is that the distribution across NS
domains shifts somewhat when you look at the top 100
domains (Azure, AWS, Google, Akamai), the top 1,000
domains (AWS, Akamai, NS1, Google), the top 10K
domains (AWS, AKamai, Cloudflare, NS1) and the full
top 1 million (Cloudflare, Amazon, GoDaddy, Akamai),
suggesting that more of the less popular sites use
Cloudflare than do the higher ranked sites.</p>

<p>At the same time, when we do the same breakdown by
AS number as before (with many thanks to our friends
at <a href="https://www.team-cymru.com/ip-asn-mapping">Team
Cymru</a>), we notice an even increased
centralization:</p>

<p> <img src="https://netmeister.org/blog/images/nsauth-top1m-by-as.png" width="800" alt="Pie chart showing the diversity of NS
record domains of the top 1 million domains by AS"/></p>

<p>Out of almost 10,000 IP addresses covering 75% of
the top one million domains&#39; NS records, over 40%
again land in Cloudflare&#39;s AS13335, with most of the
others being mere &#34;also-ran&#34;s.</p>

<p>
Ok, so that&#39;s a whole lot of pie charts, and learning
that there is indeed a fair bit of centralization at
the gTLD level of the DNS will not come as a surprise
to many.  However, crunching those numbers still
provides for some useful insights.  So if we wanted to
answer the question &#34;Who controls the internet?&#34;, then
I think that we may find multiple answers:</p>

<p><b>1. Verisign</b> -- In addition to operating two
of the DNS root authorities, Verisign also controls
the <tt>gtld-servers.net</tt> domain,
which we&#39;ve seen above is home to a whopping 80% of
all gTLD NS records!  Take out Verisign, and the
internet&#39;s going to have a bad day.</p>

<p><b>2. A handful of large companies</b> -- i.e., the
usual suspects.  With 43% of all NS records in all
gTLDs and 44% of those in the Top 1M in a combined 14
domains, any one of those could exert significant
control over large chunks of the internet.  But
amongst those companies, a few stand out:</p>

<p><b>3. GoDaddy</b> -- owner of the aptly named <tt>domaincontrol.com</tt> domain is
responsible for 20% of all NS records in all gTLDs
alone.</p>

<p><b>4. Cloudflare</b> -- responsible for 20% of NS
records in the top one million domains, Cloudflare
also provides the IP space home to a total 40% of
those NS records.</p>

<p>What this centralization means in practice and
whether, for example, the US government could
realistically exert control over the root operators
and companies discussed here, is a different story
altogether.  But no matter how you look at it, the
internet seems less distributed or decentralized than
one might wish, as many businesses and organizations
appear to concentrate in a handful of registries and
cloud service providers.</p>

<p>We don&#39;t have a single point of failure just yet,
but I do see multiple points of calamity with
increasing blast radius...</p>

<p><small>November 15th, 2022</small></p>

<hr/>

<p><small>Links:</small></p>

<ul>
<li><small><a href="https://twitter.com/jschauma/status/1592725563139145728">This blog post as a Twitter thread</a></small></li>
<li><small><a href="https://news.ycombinator.com/item?id=33794489">Discussion on HackerNews</a></small></li>
<li><small><a href="https://docs.google.com/spreadsheets/d/1XJGnCRkfXqnznrg-E_28nAYuj05q3qq7yuYi7r_-1EA/edit#gid=1624786732">Google Sheet containing most of the above pie charts and data</a></small></li>
<li><small><a href="https://blog.apnic.net/2022/11/22/looking-at-centrality-in-the-dns">APNIC Blog analysis on DNS
centralization</a></small></li>
<li><small><a href="https://www.statdns.com/">TLD Zone File Statistics</a></small></li>
<li><small><a href="https://www.icann.org/ids">ICANN DNS Symposium</a></small></li>
<li><small><a href="https://netmeister.org/blog/tlds.html">TLDs -- Putting the &#39;.fun&#39; in the top of the DNS</a></small></li>
<li><small><a href="https://netmeister.org/blog/whois.html">WHOIS: Fragile, unparseable, obsolete... and universally relied upon</a></small></li>
</ul>

      </td>
    </tr>
  </tbody></div></div>
  </body>
</html>
