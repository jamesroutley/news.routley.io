<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/briangu/klongpy">Original</a>
    <h1>KlongPy: High-Performance Array Programming in Python</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/briangu/klongpy/workflows/Unit%20Tests/badge.svg"><img src="https://github.com/briangu/klongpy/workflows/Unit%20Tests/badge.svg" alt="Unit Tests"/></a>
<a href="https://img.shields.io/github/last-commit/briangu/klongpy" rel="nofollow"><img src="https://camo.githubusercontent.com/a34bde922af86fef2037fea76a055bb44d15b8f876b8b8bc8434db3bb27e3523/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6173742d636f6d6d69742f627269616e67752f6b6c6f6e677079" alt="Last Commit" data-canonical-src="https://img.shields.io/github/last-commit/briangu/klongpy"/></a>
<a href="https://libraries.io/github/briangu/klongpy" rel="nofollow"><img src="https://camo.githubusercontent.com/2bd239fc9a4f45f05c9657e439a0c80cb9aad6dfa3b6495069d0cdc123fb4a7d/68747470733a2f2f696d672e736869656c64732e696f2f6c6962726172696573696f2f6769746875622f627269616e67752f6b6c6f6e677079" alt="Dependency Status" data-canonical-src="https://img.shields.io/librariesio/github/briangu/klongpy"/></a>
<a href="https://github.com/briangu/klongpy/issues"><img src="https://camo.githubusercontent.com/8d692a61d2272e87681118ff5ec4bda02d6c0bb3fc09a900d8a2cbfed58c7b48/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732d7261772f627269616e67752f6b6c6f6e677079" alt="Open Issues" data-canonical-src="https://img.shields.io/github/issues-raw/briangu/klongpy"/></a>
<a href="https://img.shields.io/github/repo-size/briangu/klongpy" rel="nofollow"><img src="https://camo.githubusercontent.com/97a89b12f9cb0ba4935b07c757d63d2036c12791673d411c732149880808c012/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f7265706f2d73697a652f627269616e67752f6b6c6f6e677079" alt="Repo Size" data-canonical-src="https://img.shields.io/github/repo-size/briangu/klongpy"/></a>
<a href="https://star-history.com/#briangu/klongpy" rel="nofollow"><img src="https://camo.githubusercontent.com/dedd940b2aaa1c9d1bdda5c57d055d37ef34480372f55dfd86c6142b22136df9/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f627269616e67752f6b6c6f6e6770793f7374796c653d736f6369616c" alt="GitHub star chart" data-canonical-src="https://img.shields.io/github/stars/briangu/klongpy?style=social"/></a></p>
<p dir="auto"><a href="https://github.com/briangu/klongpy/releases"><img src="https://camo.githubusercontent.com/437593497b26900d97347068bcdfa8a26f5ad0c16bc780a123b84db8d5c6e34a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f627269616e67752f6b6c6f6e677079" alt="Release Notes" data-canonical-src="https://img.shields.io/github/release/briangu/klongpy"/></a>
<a href="https://pepy.tech/project/klongpy" rel="nofollow"><img src="https://camo.githubusercontent.com/27de0a80b30fdecfe61136b68437cf3050663b11939be75e3069bcec2dcc670d/68747470733a2f2f7374617469632e706570792e746563682f62616467652f6b6c6f6e6770792f6d6f6e7468" alt="Downloads" data-canonical-src="https://static.pepy.tech/badge/klongpy/month"/></a>
<a href="https://opensource.org/licenses/MIT" rel="nofollow"><img src="https://camo.githubusercontent.com/6cd0120cc4c5ac11d28b2c60f76033b52db98dac641de3b2644bb054b449d60c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d79656c6c6f772e737667" alt="License: MIT" data-canonical-src="https://img.shields.io/badge/License-MIT-yellow.svg"/></a></p>

<p dir="auto">KlongPy is a Python adaptation of the <a href="https://t3x.org/klong" rel="nofollow">Klong</a> <a href="https://en.wikipedia.org/wiki/Array_programming" rel="nofollow">array language</a>, known for its high-performance vectorized operations that leverage the power of NumPy. Embracing a &#34;batteries included&#34; philosophy, KlongPy combines built-in modules with Python&#39;s expansive ecosystem, facilitating rapid application development with Klong&#39;s succinct syntax.</p>

<ul dir="auto">
<li><strong>Vectorized Operations with NumPy:</strong> At its core, KlongPy uses <a href="https://numpy.org/" rel="nofollow">NumPy</a>, an <a href="https://analyzethedatanotthedrivel.org/2018/03/31/NumPy-another-iverson-ghost/" rel="nofollow">Iverson Ghost</a> descendant from APL, for high-efficiency array manipulations.</li>
<li><strong>CPU and GPU Backend Support:</strong> Incorporating <a href="https://github.com/cupy/cupy">CuPy</a>, KlongPy extends its capabilities to operate on both CPU and GPU backends, ensuring versatile and powerful computing options.</li>
<li><strong>Seamless Integration with Python Ecosystem:</strong> The combination of KlongPy&#39;s built-in features with Python&#39;s wide-ranging libraries enables developers to build complex applications effortlessly.</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">KlongPy&#39;s Foundation and Applications</h2><a id="user-content-klongpys-foundation-and-applications" aria-label="Permalink: KlongPy&#39;s Foundation and Applications" href="#klongpys-foundation-and-applications"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><strong>Inspired by Nils M Holm:</strong> KlongPy is grounded in the work of <a href="https://t3x.org" rel="nofollow">Nils M Holm</a>, the original creator of Klong, and is further enriched by his <a href="https://t3x.org/klong/book.html" rel="nofollow">Klong Book</a>.</li>
<li><strong>Ideal for Diverse Fields:</strong> Data scientists, quantitative analysts, researchers, and programming language enthusiasts will find KlongPy especially beneficial for its versatility and performance.</li>
</ul>
<p dir="auto">KlongPy thus stands as a robust tool, blending the simplicity of Klong with the extensive capabilities of Python, suitable for a wide range of computational tasks.</p>

<div dir="auto" data-snippet-clipboard-copy-content="pip3 install &#34;klongpy[full]&#34;"><pre>pip3 install <span><span>&#34;</span>klongpy[full]<span>&#34;</span></span></pre></div>

<p dir="auto">KlongPy is both an Array Language runtime and a set of powerful tools for building high performance data analysis and distributed computing applications.  Some of the features include:</p>
<ul dir="auto">
<li><a href="https://en.wikipedia.org/wiki/Array_programming" rel="nofollow"><strong>Array Programming</strong></a>: Based on <a href="https://t3x.org/klong" rel="nofollow">Klong</a>, a concise, expressive, and easy-to-understand array programming language. Its simple syntax and rich feature set make it an excellent tool for data scientists and engineers.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/performance.md"><strong>Speed</strong></a>: Designed for high-speed vectorized computing, enabling you to process large data sets quickly and efficiently on either CPU or GPU.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/fast_columnar_database.md"><strong>Fast Columnar Database</strong></a>: Includes integration with <a href="http://duckdb.org" rel="nofollow">DuckDb</a>, a super fast in-process columnar store that can operate directly on NumPy arrays with zero-copy.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/ipc_capabilities.md"><strong>Inter-Process Communication (IPC)</strong></a>: Includes built-in support for IPC, enabling easy communication between different processes and systems. Ticker plants and similar pipelines are easy to build.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/table_and_key_value_stores.md"><strong>Table and Key-Value Store</strong></a>: Includes a simple file-backed key value store that can be used to store database tables or raw key/value pairs.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/python_integration.md"><strong>Python Integration</strong></a>: Seamlessly compatible with Python and modules, allowing you to leverage existing Python libraries and frameworks.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/web_server.md"><strong>Web server</strong></a>: Includes a web server, making it easy to build sites backed by KlongPy capabilities.</li>
<li><a href="https://avi.im/briangu/klongpy/blob/main/docs/timer.md"><strong>Timers</strong></a>: Includes periodic timer facility to periodically perform tasks.</li>
</ul>

<p dir="auto">Explore KlongPy with these examples. Each snippet highlights a unique aspect of Klong, demonstrating its versatility in various programming scenarios.</p>
<p dir="auto">Before we get started, you may be wondering: <em>Why is the syntax so terse?</em></p>
<p dir="auto">The answer is that it&#39;s based on the APL style array language programming and there&#39;s a good reason why its compact nature is actually helpful.</p>
<p dir="auto">Array language style lets you describe WHAT you want the computer to do and it lets the computer figure out HOW to do it.  This frees you up from the details while letting the computer figure out how to go as fast as possible.</p>
<p dir="auto">Less code to write and faster execution.</p>
<hr/>
<p dir="auto">Just so the following examples make more sense when you see the REPL outputs, there are a few quick rules about Klong functions.  Functions only take up to 3 parameters and they are ALWAYS called x,y and z.</p>
<p dir="auto">A function with</p>
<ul dir="auto">
<li>no parameters is called a nilad</li>
<li>one parameter is called a monad (x)</li>
<li>two parameters: dyad (x and y)</li>
<li>three parameters: a triad (x, y and z)</li>
</ul>
<p dir="auto">The reason that Klong functions only take up to 3 parameters AND name them for you is both convience and compactness.</p>
<hr/>

<div dir="auto" data-snippet-clipboard-copy-content="$ rlwrap kgpy

Welcome to KlongPy REPL v0.6.0
Author: Brian Guarraci
Web: http://klongpy.org
]h for help; crtl-d or ]q to quit

?&gt;"><pre>$ rlwrap kgpy

Welcome to KlongPy REPL v0.6.0
Author: Brian Guarraci
Web: http://klongpy.org
]h <span>for</span> <span>help</span><span>;</span> crtl-d or ]q to quit

<span>?</span><span>&gt;</span></pre></div>

<p dir="auto">Let&#39;s get started with the basics and build up to some more interesting math.  Expressions are evaluated from right to left: 3*2 and then + 5</p>

<p dir="auto">KlongPy is more about arrays of things, so let&#39;s define sum and count functions over an array:</p>
<div data-snippet-clipboard-copy-content="?&gt; sum::{+/x}  :&#34; sum + over / the array x
:monad
?&gt; sum([1 2 3])
6
?&gt; count::{#x}
:monad
?&gt; count([1 2 3])
3"><pre lang="kgpy"><code>?&gt; sum::{+/x}  :&#34; sum + over / the array x
:monad
?&gt; sum([1 2 3])
6
?&gt; count::{#x}
:monad
?&gt; count([1 2 3])
3
</code></pre></div>
<p dir="auto">Now that we know the sum and number of elements we can compute the average:</p>
<div data-snippet-clipboard-copy-content="?&gt; avg::{sum(x)%count(x)} :&#34; average is the sum divided by the number of elements
:monad
?&gt; avg([1 2 3])
2"><pre lang="kgpy"><code>?&gt; avg::{sum(x)%count(x)} :&#34; average is the sum divided by the number of elements
:monad
?&gt; avg([1 2 3])
2
</code></pre></div>

<p dir="auto">Let&#39;s dig into more interesting operations over array elements.  There&#39;s really big performance differences in how you approach the problem and it&#39;s important to see the difference.</p>
<p dir="auto">For the simple case of squaring numbers in a list, let&#39;s try a couple solutions:</p>
<div data-snippet-clipboard-copy-content="?&gt; {x*x}&#39;[1 2 3 4 5] :&#34; square each element as we iterate over the array
[1 4 9 16 25]"><pre lang="kgpy"><code>?&gt; {x*x}&#39;[1 2 3 4 5] :&#34; square each element as we iterate over the array
[1 4 9 16 25]
</code></pre></div>
<p dir="auto">The vectorized approach will do an element-wise multiplication in bulk:</p>
<div data-snippet-clipboard-copy-content="?&gt; a::[1 2 3 4 5];a*a  :&#34; a*a multiplies the arrays
[1 4 9 16 25]"><pre lang="kgpy"><code>?&gt; a::[1 2 3 4 5];a*a  :&#34; a*a multiplies the arrays
[1 4 9 16 25]
</code></pre></div>
<p dir="auto">The vectorized approach is going to be MUCH faster.  Let&#39;s crank up the size of the array and time it:</p>
<div data-snippet-clipboard-copy-content="$&gt; .l(&#34;time&#34;)
:monad
$&gt; a::!1000;#a
1
$&gt; fast::{{a*a}&#39;!1000}
:nilad
$&gt; slow::{{{x*x}&#39;a}&#39;!1000}
:nilad
$&gt; time(fast)
0.015867948532104492
$&gt; time(slow)
2.8987138271331787"><pre lang="kgpy"><code>$&gt; .l(&#34;time&#34;)
:monad
$&gt; a::!1000;#a
1
$&gt; fast::{{a*a}&#39;!1000}
:nilad
$&gt; slow::{{{x*x}&#39;a}&#39;!1000}
:nilad
$&gt; time(fast)
0.015867948532104492
$&gt; time(slow)
2.8987138271331787
</code></pre></div>
<p dir="auto">Vectors win by 182x!  Why?  Because when you perform a bulk vector operation the CPU can perform the math with much less overhead and do many more operations at a time because it has the entire computation presented to it at once.</p>
<p dir="auto">KlongPy aims to give you tools that let you conveniently exploit this vectorization property - and go FAST!</p>
<p dir="auto">Less code to write AND faster to compute.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">3. Data Analysis with Python Integration</h2><a id="user-content-3-data-analysis-with-python-integration" aria-label="Permalink: 3. Data Analysis with Python Integration" href="#3-data-analysis-with-python-integration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">KlongPy integrates seamlessly with Python so that the strenghts of both can be combined.  It&#39;s easy to use KlongPy from Python and vice versa.</p>
<p dir="auto">For example, let&#39;s say we have some data in Python that we want to operate on in KlongPy.  We can just directly use the interpreter in Python and run functions on data we put into the KlongPy context:</p>
<div dir="auto" data-snippet-clipboard-copy-content="from klongpy import KlongInterpreter
import numpy as np

data = np.array([1, 2, 3, 4, 5])
klong = KlongInterpreter()
# make the data NumPy array available to KlongPy code by passing it into the interpreter
# we are creating a symbol in KlongPy called &#39;data&#39; and assigning the external NumPy array value
klong[&#39;data&#39;] = data
# define the average function in KlongPY
klong(&#39;avg::{(+/x)%#x}&#39;)
# call the average function with the external data and return the result.
r = klong(&#39;avg(data)&#39;)
print(r) # expected value: 3"><pre><span>from</span> <span>klongpy</span> <span>import</span> <span>KlongInterpreter</span>
<span>import</span> <span>numpy</span> <span>as</span> <span>np</span>

<span>data</span> <span>=</span> <span>np</span>.<span>array</span>([<span>1</span>, <span>2</span>, <span>3</span>, <span>4</span>, <span>5</span>])
<span>klong</span> <span>=</span> <span>KlongInterpreter</span>()
<span># make the data NumPy array available to KlongPy code by passing it into the interpreter</span>
<span># we are creating a symbol in KlongPy called &#39;data&#39; and assigning the external NumPy array value</span>
<span>klong</span>[<span>&#39;data&#39;</span>] <span>=</span> <span>data</span>
<span># define the average function in KlongPY</span>
<span>klong</span>(<span>&#39;avg::{(+/x)%#x}&#39;</span>)
<span># call the average function with the external data and return the result.</span>
<span>r</span> <span>=</span> <span>klong</span>(<span>&#39;avg(data)&#39;</span>)
<span>print</span>(<span>r</span>) <span># expected value: 3</span></pre></div>
<p dir="auto">It doesn&#39;t make sense to write code in Klong that already exists in other libraries.  We can directly access them via the python inport functions (.py and .pyf).</p>
<p dir="auto">How about we use the NumPy FFT?</p>
<div data-snippet-clipboard-copy-content="?&gt; .pyf(&#34;numpy&#34;;&#34;fft&#34;);fft::.pya(fft;&#34;fft&#34;)
:monad
?&gt; signal::[0.0 1.0 0.0 -1.0] :&#34; Example simple signal
[0.0 1.0 0.0 -1.0]
?&gt; result::fft(signal)
[0j -2j 0j 2j]"><pre lang="kgpy"><code>?&gt; .pyf(&#34;numpy&#34;;&#34;fft&#34;);fft::.pya(fft;&#34;fft&#34;)
:monad
?&gt; signal::[0.0 1.0 0.0 -1.0] :&#34; Example simple signal
[0.0 1.0 0.0 -1.0]
?&gt; result::fft(signal)
[0j -2j 0j 2j]
</code></pre></div>
<p dir="auto">Now you can use NumPy or other libraries to provide complex functions while KlongPy lets you quickly prepare and process the vectors.</p>
<p dir="auto">There&#39;s a lot more we can do with interop but let&#39;s move on for now!</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">4. Database Functionality</h2><a id="user-content-4-database-functionality" aria-label="Permalink: 4. Database Functionality" href="#4-database-functionality"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">KlongPy leverages a high-performance columnar store called DuckDb that uses zero-copy NumPy array operations behind the scenes.   This database allows fast interop between KlongPy and DuckDb (the arrays are not copied) so that applications can manage arrays in KlongPy and then instantly perform SQL on the data for deeper insights.</p>
<p dir="auto">It&#39;s easy to create a table and a db to query:</p>
<div data-snippet-clipboard-copy-content="?&gt; .py(&#34;klongpy.db&#34;)
?&gt; t::.table([[&#34;name&#34; [&#34;Alice&#34; &#34;Bob&#34;]] [&#34;age&#34; [25 30]]])
name age
Alice 25
Bob 30
?&gt; db::.db(:{},&#34;T&#34;,t)
?&gt; db(&#34;select * from T where age &gt; 27&#34;)
name age
Bob 30"><pre lang="kgpy"><code>?&gt; .py(&#34;klongpy.db&#34;)
?&gt; t::.table([[&#34;name&#34; [&#34;Alice&#34; &#34;Bob&#34;]] [&#34;age&#34; [25 30]]])
name age
Alice 25
Bob 30
?&gt; db::.db(:{},&#34;T&#34;,t)
?&gt; db(&#34;select * from T where age &gt; 27&#34;)
name age
Bob 30
</code></pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">5. IPC, Remote Function Calls and Asynchronous operations</h2><a id="user-content-5-ipc-remote-function-calls-and-asynchronous-operations" aria-label="Permalink: 5. IPC, Remote Function Calls and Asynchronous operations" href="#5-ipc-remote-function-calls-and-asynchronous-operations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Inter Process Communication (IPC) lets you build distributed and interconnected KlongPy programs and services.</p>
<p dir="auto">KlongPy treats IPC connections to servers as functions.  These functions let you call the server and ask for things it has in it&#39;s memory - they can be other functions or values, etc.  For example you can ask for a reference to a remote function and you will get a local function that when you call it runs on teh server with your arguemnts.  This general &#34;remote proxy&#34; approach allows you to write your client code in the same way as if all the code were running locally.</p>
<p dir="auto">To see this in action, let&#39;s setup a simple scenario where the server has an &#34;avg&#34; function and the client wants to call it.</p>
<p dir="auto">Start a server in one terminal:</p>
<div data-snippet-clipboard-copy-content="?&gt; avg::{(+/x)%#x}
:monad
?&gt; .srv(8888)
1"><pre lang="kgpy"><code>?&gt; avg::{(+/x)%#x}
:monad
?&gt; .srv(8888)
1
</code></pre></div>
<p dir="auto">Start the client and make the connection to the server as &#39;f&#39;.  In order to pass parameters to a remote function we form an array of the function symbol followed by the parameters (e.g. :avg,,!100)</p>
<div data-snippet-clipboard-copy-content="?&gt; f::.cli(8888) :&#34; connect to the server
remote[localhost:8888]:fn
?&gt; f(:avg,,!100) : call the remote function &#34;avg&#34; directly with the paramter !100
49.5"><pre lang="kgpy"><code>?&gt; f::.cli(8888) :&#34; connect to the server
remote[localhost:8888]:fn
?&gt; f(:avg,,!100) : call the remote function &#34;avg&#34; directly with the paramter !100
49.5
</code></pre></div>
<p dir="auto">Let&#39;s get fancy and make a local proxy to the remote function:</p>
<div data-snippet-clipboard-copy-content="?&gt; myavg::f(:avg) :&#34; reference the remote function by it&#39;s symbol :avg and assign to a local variable called myavg
remote[localhost:8888]:fn:avg:monad
?&gt; myavg(!100) :&#34; this runs on the server with !100 array passed to it as a parameter
49.5"><pre lang="kgpy"><code>?&gt; myavg::f(:avg) :&#34; reference the remote function by it&#39;s symbol :avg and assign to a local variable called myavg
remote[localhost:8888]:fn:avg:monad
?&gt; myavg(!100) :&#34; this runs on the server with !100 array passed to it as a parameter
49.5
</code></pre></div>
<p dir="auto">Since remote functions may take a while we can wrap them with an async wrapper and have it call our callback when completed:</p>
<div data-snippet-clipboard-copy-content="?&gt; afn::.async(myavg;{.d(&#34;Avg calculated: &#34;);.p(x)})
async::monad
?&gt; afn(!100)
Avg calculated: 49.5
1"><pre lang="kgpy"><code>?&gt; afn::.async(myavg;{.d(&#34;Avg calculated: &#34;);.p(x)})
async::monad
?&gt; afn(!100)
Avg calculated: 49.5
1
</code></pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">6. Web Server Implementation</h2><a id="user-content-6-web-server-implementation" aria-label="Permalink: 6. Web Server Implementation" href="#6-web-server-implementation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">In addition to IPC we can also expose data via a standard web server.  This capability lets you have other ways of serving content that can be either exposing interesting details about some computation or just a simple web server for other reasons.</p>
<p dir="auto">Let&#39;s create a file called web.kg with the following code that adds one index handler:</p>
<div data-snippet-clipboard-copy-content=".py(&#34;klongpy.web&#34;)
data::!10
index::{x; &#34;Hello, Klong World! &#34;,data}
.web(8888;:{},&#34;/&#34;,index;:{})
.p(&#34;ready at http://localhost:8888&#34;)"><pre lang="text"><code>.py(&#34;klongpy.web&#34;)
data::!10
index::{x; &#34;Hello, Klong World! &#34;,data}
.web(8888;:{},&#34;/&#34;,index;:{})
.p(&#34;ready at http://localhost:8888&#34;)
</code></pre></div>
<p dir="auto">We can run this web server as follows:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ kgpy web.kg
ready at http://localhost:8888"><pre>$ kgpy web.kg
ready at http://localhost:8888</pre></div>
<p dir="auto">In another terminal:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ curl http://localhost:8888
[&#39;Hello, Klong World! &#39; 0 1 2 3 4 5 6 7 8 9]"><pre>$ curl http://localhost:8888
[<span><span>&#39;</span>Hello, Klong World! <span>&#39;</span></span> 0 1 2 3 4 5 6 7 8 9]</pre></div>

<p dir="auto">These examples are designed to illustrate the &#34;batteries included&#34; approach, ease of use and diverse applications of KlongPy, making it a versatile choice for various programming needs.</p>
<p dir="auto"><a href="https://github.com/briangu/klongpy/tree/main/examples">Check out the examples folder for more</a>.</p>




<p dir="auto">Choose your CuPy prebuilt binary or from source.  Note, the <a href="https://avi.im/briangu/klongpy/blob/main/docs/ROCM.md">ROCM</a> support for CuPy is experimental and likely will have issues.</p>
<p dir="auto">&#39;cupy&#39; =&gt; build from source
&#39;cuda12x&#39; =&gt; &#34;cupy-cuda12x&#34;
&#39;cuda11x&#39; =&gt; &#34;cupy-cuda11x&#34;
&#39;cuda111&#39; =&gt; &#34;cupy-cuda111&#34;
&#39;cuda110&#39; =&gt; &#34;cupy-cuda110&#34;
&#39;cuda102&#39; =&gt; &#34;cupy-cuda102&#34;
&#39;rocm-5-0&#39; =&gt; &#34;cupy-rocm-5-0&#34;
&#39;rocm-4-3&#39; =&gt; &#34;cupy-rocm-4-3&#34;</p>
<div dir="auto" data-snippet-clipboard-copy-content="pip3 install &#34;klongpy[cupy]&#34;"><pre>pip3 install <span><span>&#34;</span>klongpy[cupy]<span>&#34;</span></span></pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">All application tools (db, web, REPL, etc.)</h3><a id="user-content-all-application-tools-db-web-repl-etc" aria-label="Permalink: All application tools (db, web, REPL, etc.)" href="#all-application-tools-db-web-repl-etc"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="pip3 install &#34;klongpy[full]&#34;"><pre>pip3 install <span><span>&#34;</span>klongpy[full]<span>&#34;</span></span></pre></div>

<p dir="auto">KlongPy is a superset of the Klong array language.  It currently passes all of the integration tests provided by klong as well as additional suites.</p>
<p dir="auto">Since CuPy is <a href="https://docs.cupy.dev/en/stable/user_guide/difference.html" rel="nofollow">not 100% compatible with NumPy</a>, there are currently some gaps in KlongPy between the two backends.  Notably, strings are supported in CuPy arrays so KlongPy GPU support currently is limited to math.</p>
<p dir="auto">Primary ongoing work includes:</p>
<ul dir="auto">
<li>Additional tools to make KlongPy applications more capable.</li>
<li>Additional syntax error help</li>
<li>Actively switch between CuPy and NumPy when incompatibilities are present</li>
</ul>

<p dir="auto">KlongPy is effectively a superset of the Klong language, but has some key differences:</p>
<ul dir="auto">
<li>Infinite precision: The main difference in this implementation of Klong is the lack of infinite precision.  By using NumPy we are restricted to doubles.</li>
<li>Python integration: Most notably, the &#34;.py&#34; command allows direct import of Python modules into the current Klong context.</li>
<li>KlongPy aims to be more &#34;batteries included&#34; approach to modules and contains additional features such as IPC, Web service, Websockets, etc.</li>
</ul>

<ul dir="auto">
<li><a href="https://github.com/briangu/klupyter">Klupyter - KlongPy in Jupyter Notebooks</a></li>
<li><a href="https://github.com/briangu/klongpy-vscode">Visual Studio Code Syntax Highlighting</a></li>
<li><a href="https://github.com/briangu/aoc">Advent Of Code in KlongPy</a></li>
</ul>

<p dir="auto">git clone <a href="https://github.com/briangu/klongpy.git">https://github.com/briangu/klongpy.git</a>
cd klongpy
python3 setup.py develop</p>



<p dir="auto">HUGE thanks to Nils M Holm for his work on Klong and providing the foundations for this interesting project.</p>
</article></div></div>
  </body>
</html>
