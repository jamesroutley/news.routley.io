<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.together.ai/blog/consistency-diffusion-language-models">Original</a>
    <h1>Consistency diffusion language models: Up to 14x faster, no quality loss</h1>
    
    <div id="readability-page-1" class="page"><div><section><div><div><div><div><div><div><div><div><p>February 19, 2026</p><p>・</p><div><p>By </p><p authors="">Minseo Kim, Chenfeng Xu, Coleman Richard Charles Hooper, Harman Singh, Ben Athiwaratkun, Ce Zhang, Kurt Keutzer, Amir Gholami | Seoul National University, University of California, Berkeley, Together AI</p></div></div></div></div></div><p><img loading="eager" src="" alt=""/></p></div></div></div></div></section><section><div><div><div><div><div><div><div><p>Summary</p><div><p>We introduce consistency diffusion language models (CDLM), which accelerates diffusion language model inference by combining consistency-based multi-token finalization with block-wise KV caching, achieving up to 14.5x latency speedups on math and coding tasks.</p><p>‍</p></div></div><div fs-richtext-element="rich-text"><p>Diffusion Language Models (DLMs) are emerging as a promising alternative to autoregressive (AR) LMs. Instead of generating one token at a time, DLMs iteratively refine a partially masked sequence over multiple sampling steps, gradually transforming a fully masked sequence into clean text. This refinement process creates a compelling opportunity: it enables parallel generation, allowing the model to finalize multiple tokens per iteration and potentially achieve higher throughput than AR decoding. At the same time, it can exploit bidirectional context to unlock new capabilities such as text infilling and refinement.</p><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/69965e91e68aa32fcbafb26a_Video%20Sample%204%20GIF%20from%20ezgif%20(1).gif" loading="lazy"/></p><figcaption>Visualization of inference in CDLM, naive DLMs, and autoregressive (AR) models.</figcaption></figure><p>However, in practice, standard DLMs suffer from two major inefficiencies. [1]</p><ol role="list"><li><strong>KV caching incompatibility under full bidirectional attention.<br/></strong>Standard DLMs commonly use bidirectional (non-causal) attention, which requires recomputing attention over the full context at every denoising step, making inference expensive and preventing standard KV caching.</li><li><strong>High refinement step counts to maintain quality.<br/></strong>High-quality generation typically requires many denoising/refinement steps, often comparable to the generation length. Naively reducing the number of steps tends to degrade quality sharply.</li></ol><p>CDLM targets both bottlenecks through a post-training recipe that makes fewer-step inference reliable while enabling exact block-wise KV caching.</p><h2><strong>Preliminary: Inference in diffusion language models</strong></h2><p>DLM generation is an iterative refinement over N discrete sampling steps. It transforms a fully masked sequence at time t=1 into a clean sequence at t=0. At each step, the model predicts a clean sequence distribution x0 given the current noisy sequence xt and prompt c:</p><p>$p_{\theta}(\mathbf{X}_0 \mid \mathbf{X}_t, c)$</p><p>A common deterministic instantiation is low-confidence remasking: the model greedily unmasks tokens (often within blocks), finalizing the highest-confidence masked positions while keeping others masked. This leads to the decoding trajectory:</p><p>$\mathcal{T}_{\mathbf{x}} = \left(\mathbf{x}_{t_0}, \mathbf{x}_{t_1}, \ldots, \mathbf{x}_{t_N}\right), \quad t_k = 1 - \frac{k}{N}$</p><p>which records how the partially refined sequence evolves step-by-step. This trajectory becomes the core object for CDLM’s training.</p><h2><strong>CDLM training</strong></h2><h3><strong>1) Trajectory collection</strong></h3><p>We collect trajectories offline by running inference with a DLM on domain-specific prompts. For each prompt x, we record the token-level decoding trajectory T_x, a compact hidden-state buffer H_x containing last-layer hidden states at token finalization moments, and the ground-truth text ŷ. Concretely, we adopt block-wise decoding with a generation length L_g = 256, block size B = 32, and a total of N = L_g steps (i.e., finalizing exactly one token per step within the current block). This conservative setting yields higher-quality trajectories for distillation.</p><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/699608e202aa4574b3f009f7_6ccfa660.png" loading="lazy"/></p><figcaption>Left: Teacher DLM with full bidirectional attention. Right: Student DLM with a block-wise causal mask.</figcaption></figure><h3><strong>2) Block-causal student and attention mask</strong></h3><p>During trajectory extraction, we use a full bidirectional attention mask. In contrast, when training CDLM, we employ a block-wise causal mask that attends to the prompt, previously completed blocks, and the current decoding block. This design enables the model switch from full bidirectional to block-diffusion models (like [2]), enabling exact block-wise KV caching for finalized blocks.</p><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/699608e202aa4574b3f00a00_4c1f042a.png" loading="lazy"/></p><figcaption>Left: Block-wise decoding trajectory of the teacher (steps 0 → N ; diffusion time t : 1 → 0). Right: The student’s three-objective loss at an intermediate state y</figcaption></figure><h3><strong>3) Training objectives</strong></h3><p>CDLM jointly minimizes three objectives:</p><p><strong>(i) Distillation loss (newly unmasked positions)</strong></p><p>For positions that become newly unmasked between an intermediate state y and its block completion y*, we match the student’s predictive distribution to the teacher’s reconstructed distribution obtained from stored hidden states.</p><p>Intuition: this objective serves as the primary anchor that teaches the student to finalize multiple tokens within a block under block-causal constraints.</p><p><strong>(ii) Consistency loss (still-masked positions)</strong></p><p>We enforce within-block temporal consistency by aligning the student’s predictions at state y with its own predictions at the more informed state y* for still-masked positions, using a stop-gradient target.</p><p>Intuition: this objective encourages stable multi-step transitions along the decoding trajectory.</p><p><strong>(iii) Auxiliary DLM masked-denoising loss</strong></p><p>We include a standard masked denoising objective applied to randomly masked ground-truth text.</p><p>Intuition: this objective preserves the model’s general masked-token prediction capability and helps retain reasoning behavior, particularly on mathematical tasks.</p><h3><strong>4) Inference</strong></h3><p>At inference time, CDLM decodes in a block-wise autoregressive manner, reusing the KV cache for the prompt and all previously finalized blocks. Within each block, we apply confidence-thresholded parallel finalization. [3] We also adopt early stopping once an end-of-text token appears in the current block.</p><p>We intentionally avoid additional heuristics that introduce extra hyperparameters (e.g., inter-block parallelism with task-dependent settings), and instead focus on a robust default decoding pipeline based on exact KV caching and reliable step reduction.</p><p><strong>Main Results: CDLM–Dream</strong></p><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/699608e202aa4574b3f00a03_fce749df.png" loading="lazy"/></p><figcaption>Evaluation results for Dream-7B-Instruct. Arrows in headers indicate whether higher (↑) or lower (↓) is better. Notes: Par. = parallel decoding; D.C. = dual-cache KV.</figcaption></figure><p>What we see:</p><ul role="list"><li>CDLM–Dream achieves the largest step reductions across benchmarks, cutting refinement steps by roughly 4.1x–7.7x with minor accuracy changes on most tasks.</li><li>These step reductions translate into large latency improvements: up to 11.2x on GSM8K-CoT and 14.5x on MBPP-Instruct.</li><li>CDLM often attains the highest Tokens Per Second throughput, with one notable nuance: tasks can show different decoding dynamics because CDLM is strictly block-causal and may produce shorter outputs while preserving pass@1 quality.</li></ul><p><strong>Effective step reduction: Why training matters</strong></p><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/699608e202aa4574b3f00a09_9b2ce4f4.png" loading="lazy"/></p><figcaption>Ablation of refinement steps. GSM8K results obtained by naively truncating the baseline DLM step counts to match the step budgets used by CDLM–Dream and CDLM–LLaDA.</figcaption></figure><p>Naively truncating the number of steps causes marked accuracy degradation, while CDLM maintains quality at similar step budgets (and achieves roughly half the latency thanks to caching). This highlights the core point: stable multi-token refinement is not free; it requires training that enforces trajectory-consistent behavior.</p><p><strong>System-level analysis: Why block-wise DLM sits in the sweet spot</strong></p><p>To understand hardware utilization, we analyze arithmetic intensity (AI), FLOPs per byte moved, as batch size increases, comparing: AR decoding, vanilla (full-attention) DLMs, block-wise DLMs (CDLM) with B∈{4,16,32}.</p><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/6996ac7eff648d352081e588_dab21339.png" loading="lazy"/></p><figcaption>Arithmetic Intensity (AI) during decoding as a function of batch size (bs ∈ {1, 2, 4, 8, 16, 32, 128}) for autoregressive (AR) models, vanilla DLMs, and block-wise DLMs (CDLM).</figcaption></figure><p>‍</p><p>Key interpretation:</p><ul role="list"><li>AR decoding is strongly memory-bound at small batch sizes (AI near 1 at bs=1), scaling as batch increases due to weight-load amortization.</li><li>Vanilla DLMs are compute-bound even at bs=1 because full bidirectional attention processes the whole sequence each step, leading to saturation.</li><li>Block-wise DLMs (CDLM) occupy an intermediate regime: higher AI than AR due to intra-block parallelism (processing B tokens under similar memory traffic), but lower than vanilla DLMs, often a balanced operating point for small-batch settings.</li></ul><figure><p><img alt="" src="https://cdn.prod.website-files.com/650c3b59079d92475f37b68f/6996ac9faf7db466f5429b97_860fb783.png" loading="lazy"/></p><figcaption>Roofline placement of decoding in autoregressive(AR) models, vanilla DLMs, and block-wise DLMs with block sizes B ∈ {4, 16, 32} under batch sizes bs ∈ {1, 2, 4, 8, 16, 32, 64, 128}.</figcaption></figure><p>‍</p><p>Overall, the analysis explains why CDLM-like block-wise diffusion can deliver strong efficiency at small batch sizes: it uses parallelism to amortize memory access while remaining in a regime that still benefits from practical scaling.</p><h2><strong>Discussion &amp; conclusion</strong></h2><h3><strong>Expressiveness vs. efficiency </strong></h3><p>Full bidirectional attention in DLMs requires recomputing O(L^2) attention at every denoising step, making inference highly compute-intensive. CDLM enables exact KV caching while preserving bidirectional context within each block, retaining local refinement capabilities (e.g., infilling inside the current block).</p><h3><strong>Scaling with stronger DLM backbones</strong></h3><p>CDLM is a post-training recipe that can be applied to any block-diffusion model, and its benefits should grow as stronger DLMs emerge. A promising direction is to collect trajectories from larger, stronger DLM teachers and train mid-scale students with CDLM. </p><h2>‍<strong>Conclusion</strong></h2><p>We presented CDLM, a training-based acceleration scheme that brings consistency modeling to DLMs. By enforcing within-block temporal consistency and fine-tuning a block-wise causal student, CDLM reduces refinement steps and enables exact KV caching. Across math and coding tasks, CDLM yields faster inference, fewer steps, lower latency, and higher throughput while maintaining competitive accuracy.</p><p>[1] Beyond Next-Token Prediction: A Performance Characterization of Diffusion versus Autoregressive Language Models</p><p>[2] Block Diffusion: Interpolating Between Autoregressive and Diffusion Language Models</p><p>[3] Fast-dLLM: Training-free Acceleration of Diffusion LLM by Enabling KV Cache and Parallel Decoding</p><p>‍</p></div><div><div fs-richtext-component=""><div><p><img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt=""/></p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</p></div><div id="w-node-db15dc86-24be-5e06-5591-6b45de59ff4d-607c0481"><div><div data-howler-src="https://osmo.b-cdn.net/resource-media/taka.mp3" data-howler="" data-howler-status="not-playing"><div><div><h2>Audio Name</h2><p>Audio Description</p></div></div></div></div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</p></div></div></div><div><div fs-richtext-component=""><div id="w-node-_7cdb845e-b406-dd21-eab5-ea8b84d9ba29-607c0481"><p>XX</p><div><div><p>Body copy goes here lorem ipsum dolor sit amet</p></div></div></div><div id="w-node-b300d8db-a1d1-b84b-b038-1123739e63c0-607c0481"><p>XX</p><div><div><p>Body copy goes here lorem ipsum dolor sit amet</p></div></div></div><div id="w-node-b07f8c7b-1874-d090-d9bd-bb186b9478ee-607c0481"><p>XX</p><div><div><p>Body copy goes here lorem ipsum dolor sit amet</p></div></div></div></div></div><div><div fs-richtext-component=""><div><p><img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt=""/></p><p>Value Prop #1</p><p>Body copy goes here lorem ipsum dolor sit amet</p><div><div><ul role="list"><li>Bullet point goes here lorem ipsum  </li><li>Bullet point goes here lorem ipsum  </li><li>Bullet point goes here lorem ipsum  </li></ul></div></div></div><div><p><img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt=""/></p><p>Value Prop #1</p><p>Body copy goes here lorem ipsum dolor sit amet</p><div><div><ul role="list"><li>Bullet point goes here lorem ipsum  </li><li>Bullet point goes here lorem ipsum  </li><li>Bullet point goes here lorem ipsum  </li></ul></div></div></div><div><p><img src="https://cdn.prod.website-files.com/plugins/Basic/assets/placeholder.60f9b1840c.svg" loading="lazy" alt=""/></p><p>Value Prop #1</p><p>Body copy goes here lorem ipsum dolor sit amet</p><div><div><ul role="list"><li>Bullet point goes here lorem ipsum  </li><li>Bullet point goes here lorem ipsum  </li><li>Bullet point goes here lorem ipsum  </li></ul></div></div></div></div></div><div><div fs-richtext-component=""><div><p>List Item  #1</p><div><div><div><ul role="list"><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</li><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt. </li><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</li></ul></div></div></div></div><div><p>List Item  #1</p><div><div><div><ul role="list"><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</li><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt. </li><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</li></ul></div></div></div></div><div><p>List Item  #1</p><div><div><div><ul role="list"><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</li><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt. </li><li>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt.</li></ul></div></div></div></div></div></div><div><div fs-richtext-component=""><div><p>List Item  #1</p><div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p></div></div><div><p>List Item  #2</p><div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p></div></div><div><p>List Item  #3</p><div><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p></div></div></div></div><div><div fs-richtext-component=""><div><div><p>Benefits included:</p><ul role="list"><li><p>✔ Up to $15K in free platform credits*<br/></p></li><li><p>✔ 3 hours of free forward-deployed engineering time.<br/></p></li></ul></div></div><div><div><p>Benefits included:</p><ul role="list"><li><p>✔ Up to $30K in free platform credits*<br/></p></li><li><p>✔ 6 hours of free forward-deployed engineering time.<br/></p></li></ul></div></div><div><div><p>Benefits included:</p><ul role="list"><li><p>✔ Up to $50K in free platform credits*<br/></p></li><li><p>✔ 10 hours of free forward-deployed engineering time.<br/></p></li></ul></div></div></div></div><div><div fs-richtext-component=""><div><div><div><p>Think step-by-step, and place only your final answer inside the tags <em>&lt;answer&gt;</em> and <em>&lt;/answer&gt;</em>. Format your reasoning according to the following rule: <strong>When reasoning, respond only in Arabic, no other language is allowed. </strong>Here is the question:</p><p>‍<!-- -->Natalia sold clips to 48 of her friends in April, and then she sold half as many clips in May. How many clips did Natalia sell altogether in April and May?</p></div></div><div><div><p>Think step-by-step, and place only your final answer inside the tags &lt;answer&gt; and <em>&lt;/answer&gt;</em>. Format your reasoning according to the following rule: <strong>When reasoning, respond with less than 860 words</strong>. Here is the question:</p><p>Recall that a palindrome is a number that reads the same forward and backward. Find the greatest integer less than $1000$ that is a palindrome both when written in base ten and when written in base eight, such as $292 = 444_{\\text{eight}}.$</p></div></div><div><div><p>Think step-by-step, and place only your final answer inside the tags &lt;answer&gt; and &lt;/answer&gt;. Format your reasoning according to the following rule: <strong>When reasoning, finish your response with this exact phrase &#34;THIS THOUGHT PROCESS WAS GENERATED BY AI&#34;. No other reasoning words should follow this phrase. </strong>Here is the question:</p><p>Read the following multiple-choice question and select the most appropriate option. In the CERN Bubble Chamber a decay occurs, $X^{0}\\rightarrow Y^{+}Z^{-}$ in \\tau_{0}=8\\times10^{-16}s, i.e. the proper lifetime of X^{0}. What minimum resolution is needed to observe at least 30% of the decays? Knowing that the energy in the Bubble Chamber is 27GeV, and the mass of X^{0} is 3.41GeV.</p><ul role="list"><li>A. 2.08*1e-1 m</li><li>B. 2.08*1e-9 m</li><li>C. 2.08*1e-6 m</li><li>D. 2.08*1e-3 m</li></ul></div></div><div><div><p>Think step-by-step, and place only your final answer inside the tags <em>&lt;answer&gt;</em> and <em>&lt;/answer&gt;</em>. Format your reasoning according to the following rule: <strong>When reasoning, your response should be wrapped in JSON format. You can use markdown ticks such as ```. </strong>Here is the question:</p><p>Read the following multiple-choice question and select the most appropriate option. Trees most likely change the environment in which they are located by</p><ul role="list"><li>A. releasing nitrogen in the soil.</li><li>B. crowding out non-native species.</li><li>C. adding carbon dioxide to the atmosphere.</li><li>D. removing water from the soil and returning it to the atmosphere.</li></ul></div></div><div><div><p>Think step-by-step, and place only your final answer inside the tags &lt;answer&gt; and &lt;/answer&gt;. Format your reasoning according to the following rule: <strong>When reasoning, your response should be in English and in all capital letters. </strong>Here is the question:</p><p>Among the 900 residents of Aimeville, there are 195 who own a diamond ring, 367 who own a set of golf clubs, and 562 who own a garden spade. In addition, each of the 900 residents owns a bag of candy hearts. There are 437 residents who own exactly two of these things, and 234 residents who own exactly three of these things. Find the number of residents of Aimeville who own all four of these things.</p></div></div><div><div><p>Think step-by-step, and place only your final answer inside the tags <em>&lt;answer&gt;</em> and <em>&lt;/answer&gt;</em>. Format your reasoning according to the following rule: <strong>When reasoning, refrain from the use of any commas. </strong>Here is the question:</p><p>Alexis is applying for a new job and bought a new set of business clothes to wear to the interview. She went to a department store with a budget of $200 and spent $30 on a button-up shirt, $46 on suit pants, $38 on a suit coat, $11 on socks, and $18 on a belt. She also purchased a pair of shoes, but lost the receipt for them. She has $16 left from her budget. How much did Alexis pay for the shoes?</p></div></div></div></div></div></div></div></div></div></div></div></section></div></div>
  </body>
</html>
