<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://matan-h.com/common-google-xss">Original</a>
    <h1>Common Google XSS</h1>
    
    <div id="readability-page-1" class="page"><div>
      
        <header>
          
          

  <p>
    

    

    
      
      

      <span>
        <i aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


        </header>
      

      <section itemprop="text">
        
        <p>When I was searching for a vulnerability in google DNS from Google Cloud, I came across <a href="https://www.rcesecurity.com/2017/03/ok-google-give-me-all-your-internal-dns-information">this</a> article by <a href="https://twitter.com/MrTuxracer">Julien Ahrens</a>. The article is about an SSRF vulnerability in the Google website <code>https://toolbox.googleapps.com</code>, so I started researching this site.</p>

<h2 id="simple-research--xss">Simple research ⇾ XSS</h2>

<p>The site has many apps, all of them are listed inside the <code>robots.txt</code> file:</p>

<div><div><pre><code><span>#apps-toolbox
</span><span>User-Agent:</span> <span>*</span>
<span>Allow:</span> <span>/apps/main</span>
<span>Allow:</span> <span>/apps/browserinfo</span>
<span>Allow:</span> <span>/apps/checkmx</span>
<span>Allow:</span> <span>/apps/dig</span>
<span>Allow:</span> <span>/apps/har_analyzer</span>
<span>Allow:</span> <span>/apps/loganalyzer</span>
<span>Allow:</span> <span>/apps/loggershark</span>
<span>Allow:</span> <span>/apps/messageheader</span>
<span>Allow:</span> <span>/apps/recovery</span>
<span>Allow:</span> <span>/apps/useragent</span>
<span>Allow:</span> <span>/apps/other_tools</span>
<span>Allow:</span> <span>/apps/encode_decode</span>
<span>Allow:</span> <span>/apps/screen_recorder</span>
<span>Disallow:</span> <span>*</span>
</code></pre></div></div>

<p>Most of the tools are accessible from the /apps/main menu, however, the recovery app (at <code>/apps/recovery</code>) isn’t.</p>

<p>From a simple search in google I see the recovery app has these sub-pages:</p>

<div><div><pre><code>recovery/domain_in_use
recovery/form
recovery/ownership
</code></pre></div></div>

<p>All of which receive many parameters from the query string in URL (parameters in <code>{url}?parm1=1&amp;param2=2...</code>): <code>visit_id</code>, <code>user</code>, <code>domain</code>, <code>email</code> and some more.</p>

<p>In google search I also spotted a result that has <code>Verify that you own example.com</code> title, with this link : <code>https://toolbox.googleapps.com/apps/recovery/ownership?domain=example.com&amp;email=email@example.com&amp;case=45500368&amp;continue=/apps/recovery/...</code></p>

<p>The server apparently just verifies that the email matches the domain, then presents a page with some thank you text and a continue button:</p>

<p><img src="https://matan-h.com/assets/images/google-xss-continue-page.webp" title="screenshot of the google continue page" alt="google-continue-page.png" data-align="center"/></p>
<figcaption>google continue page</figcaption>

<p>And the link in the continue button, was … you guessed it: just taken from the <code>continue</code> URL parameter.</p>

<p>So I tried placing there <code>continue=javascript:alert(document.domain)</code>, and… It works!</p>

<p>The site didn’t use any CSP, or any protection at all. So I also could send and receive data from external sites: (e.g. <code>continue=javascript:fetch(%27https://api.ipify.org?format=json%27).then(response=%3Eresponse.text()).then(data=%3E{alert(data);%20})</code>, which <code>alert</code>s the user public ip). I reported it to Google.</p>

<h2 id="reward">Reward</h2>

<p><img src="https://matan-h.com/assets/images/google-xss-reward.webp" alt="google reward table screenshot"/></p>

<figcaption>google reward table screenshot.</figcaption>

<p>Since this is an XSS, and its on a <code>normal Google application</code>, it falls into the <code>3133$</code> square in google rewards. Therefore, I got more than twice than I got to both <a href="https://matan-h.com/google-has-a-secret-browser-hidden-inside-the-settings">parental</a> <a href="https://matan-h.com/another-secret-browser">control</a> bypasses (googles secret browsers) combined.</p>

<p>I name this article “Common” because it’s really an <code>openredirect-&gt;xss</code> by the book. No thinking is required, just trying to change random parameters on URLs.</p>
<offwhite>
Did you find the Easter egg in this article?
</offwhite>






        
      </section>

      

      


      
  

    </div></div>
  </body>
</html>
