<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/pytorch/torchchat">Original</a>
    <h1>Torchchat: Chat with LLMs Everywhere</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">torchchat is a small codebase showcasing the ability to run large language models (LLMs) seamlessly. With torchchat, you can run LLMs using Python, within your own (C/C++) application (desktop or server) and on iOS and Android.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">What can you do with torchchat?</h2><a id="user-content-what-can-you-do-with-torchchat" aria-label="Permalink: What can you do with torchchat?" href="#what-can-you-do-with-torchchat"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="#running-via-pytorch--python">Run models via PyTorch / Python</a>
<ul dir="auto">
<li><a href="#chat">Chat</a></li>
<li><a href="#generate">Generate</a></li>
<li><a href="#browser">Run chat in the Browser</a></li>
</ul>
</li>
<li><a href="#desktopserver-execution">Run models on desktop/server without python</a>
<ul dir="auto">
<li><a href="#aoti-aot-inductor">Use AOT Inductor for faster execution</a></li>
<li><a href="#running-native-using-our-c-runner">Running in c++ using the runner</a></li>
</ul>
</li>
<li><a href="#mobile-execution">Run models on mobile</a>
<ul dir="auto">
<li><a href="#deploy-and-run-on-ios">Deploy and run on iOS</a></li>
<li><a href="#deploy-and-run-on-android">Deploy and run on Android</a></li>
</ul>
</li>
<li><a href="#eval">Evaluate a model</a></li>
</ul>

<ul dir="auto">
<li>Command line interaction with popular LLMs such as Llama 3, Llama 2, Stories, Mistral and more</li>
<li>PyTorch-native execution with performance</li>
<li>Supports popular hardware and OS
<ul dir="auto">
<li>Linux (x86)</li>
<li>Mac OS (M1/M2/M3)</li>
<li>Android (Devices that support XNNPACK)</li>
<li>iOS 17+ (iPhone 13 Pro+)</li>
</ul>
</li>
<li>Multiple data types including: float32, float16, bfloat16</li>
<li>Multiple quantization schemes</li>
<li>Multiple execution modes including: Python (Eager, Compile) or Native (AOT Inductor (AOTI), ExecuTorch)</li>
</ul>

<p dir="auto">The following steps require that you have <a href="https://www.python.org/downloads/release/python-3100/" rel="nofollow">Python 3.10</a> installed.</p>
<div dir="auto" data-snippet-clipboard-copy-content="# get the code
git clone https://github.com/pytorch/torchchat.git
cd torchchat

# set up a virtual environment
python3 -m venv .venv
source .venv/bin/activate

# install dependencies
./install_requirements.sh"><pre><span><span>#</span> get the code</span>
git clone https://github.com/pytorch/torchchat.git
<span>cd</span> torchchat

<span><span>#</span> set up a virtual environment</span>
python3 -m venv .venv
<span>source</span> .venv/bin/activate

<span><span>#</span> install dependencies</span>
./install_requirements.sh</pre></div>

<p dir="auto">The interfaces of torchchat are leveraged through <strong>Python Commands</strong> and <strong>Native Runners</strong>. While the Python Commands are enumerable in the --help menu, the latter are explored in their respective sections.</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py --help"><pre>python3 torchchat.py --help</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Output
usage: torchchat [-h] {chat,browser,generate,export,eval,download,list,remove,where,server} ...

positional arguments:
  {chat,browser,generate,export,eval,download,list,remove,where,server}
                        The specific command to run
    chat                Chat interactively with a model via the CLI
    generate            Generate responses from a model given a prompt
    browser             Chat interactively with a model in a locally hosted browser
    export              Export a model artifact to AOT Inductor or ExecuTorch
    download            Download model artifacts
    list                List all supported models
    remove              Remove downloaded model artifacts
    where               Return directory containing downloaded model artifacts
    server              [WIP] Starts a locally hosted REST server for model interaction
    eval                Evaluate a model via lm-eval

options:
  -h, --help            show this help message and exit"><pre><span><span>#</span> Output</span>
usage: torchchat [-h] {chat,browser,generate,export,eval,download,list,remove,where,server} ...

positional arguments:
  {chat,browser,generate,export,eval,download,list,remove,where,server}
                        The specific <span>command</span> to run
    chat                Chat interactively with a model via the CLI
    generate            Generate responses from a model given a prompt
    browser             Chat interactively with a model <span>in</span> a locally hosted browser
    <span>export</span>              Export a model artifact to AOT Inductor or ExecuTorch
    download            Download model artifacts
    list                List all supported models
    remove              Remove downloaded model artifacts
    where               Return directory containing downloaded model artifacts
    server              [WIP] Starts a locally hosted REST server <span>for</span> model interaction
    <span>eval</span>                Evaluate a model via lm-eval

options:
  -h, --help            show this <span>help</span> message and <span>exit</span></pre></div>
<p dir="auto"><strong>Python Inference</strong> (chat, generate, browser, server)</p>
<ul dir="auto">
<li>These commands represent different flavors of performing model inference in a Python enviroment.</li>
<li>Models are constructed either from CLI args or from loading exported artifacts.</li>
</ul>
<p dir="auto"><strong>Exporting</strong> (export)</p>
<ul dir="auto">
<li>This command generates model artifacts that are consumed by Python Inference or Native Runners.</li>
<li>More information is provided in the <a href="https://github.com/pytorch/torchchat?tab=readme-ov-file#aoti-aot-inductor">AOT Inductor</a> and <a href="https://github.com/pytorch/torchchat?tab=readme-ov-file#export-for-mobile">ExecuTorch</a> sections.</li>
</ul>
<p dir="auto"><strong>Inventory Management</strong> (download, list, remove, where)</p>
<ul dir="auto">
<li>These commands are used to manage and download models.</li>
<li>More information is provided in the <a href="https://github.com/pytorch/torchchat?tab=readme-ov-file#download-weights">Download Weights</a> section.</li>
</ul>
<p dir="auto"><strong>Evaluation</strong> (eval)</p>
<ul dir="auto">
<li>This command test model fidelity via EleutherAI&#39;s <a href="https://github.com/EleutherAI/lm-evaluation-harness">lm_evaluation_harness</a>.</li>
<li>More information is provided in the <a href="https://github.com/pytorch/torchchat?tab=readme-ov-file#eval">Evaluation</a> section.</li>
</ul>

<p dir="auto">Most models use Hugging Face as the distribution channel, so you will need to create a Hugging Face account.
Create a Hugging Face user access token <a href="https://huggingface.co/docs/hub/en/security-tokens" rel="nofollow">as documented here</a> with the <code>write</code> role.</p>
<p dir="auto">Log into Hugging Face:</p>

<p dir="auto">Once this is done, torchchat will be able to download model artifacts from
Hugging Face.</p>
<div data-snippet-clipboard-copy-content="python3 torchchat.py download llama3.1"><pre><code>python3 torchchat.py download llama3.1
</code></pre></div>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p><p dir="auto">This command may prompt you to request access to Llama 3 via
Hugging Face, if you do not already have access. Simply follow the
prompts and re-run the command when access is granted.*</p>
</div>
<details>
<summary>Additional Model Inventory Management Commands</summary>

<p dir="auto">This subcommands shows the available models</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py list"><pre>python3 torchchat.py list</pre></div>

<p dir="auto">This subcommands shows location of a particular model.</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py list"><pre>python3 torchchat.py list</pre></div>
<p dir="auto">This is useful in scripts when you do not want to hard-code paths</p>

<p dir="auto">This subcommands removes the specified model</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py remove llama3.1"><pre>python3 torchchat.py remove llama3.1</pre></div>
<p dir="auto">More information about these commands can be found by adding the <code>--help</code> option.</p>
</details>
<div dir="auto"><h2 tabindex="-1" dir="auto">Running via PyTorch / Python</h2><a id="user-content-running-via-pytorch--python" aria-label="Permalink: Running via PyTorch / Python" href="#running-via-pytorch--python"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The simplest way to run a model in PyTorch is via <a href="https://pytorch.org/blog/optimizing-production-pytorch-performance-with-graph-transformations/" rel="nofollow">eager execution</a>.
This is the default execution mode for both PyTorch and torchchat. It performs inference
without creating exporting artifacts or using a separate runner.</p>
<p dir="auto">The model used for inference can also be configured and tailored to specific needs
(compilation, quantization, etc.). See the <a href="https://unplannedobsolescence.com/pytorch/torchchat/blob/main/docs/model_customization.md">customization guide</a> for the options supported by torchchat.</p>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</p><p dir="auto">For more information about these commands, please refer to the <code>--help</code> menu.</p>
</div>

<p dir="auto">This mode allows you to chat with an LLM in an interactive fashion.</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py chat llama3.1"><pre>python3 torchchat.py chat llama3.1</pre></div>

<p dir="auto">This mode generates text based on an input prompt.</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py generate llama3.1 --prompt &#34;write me a story about a boy and his bear&#34;"><pre>python3 torchchat.py generate llama3.1 --prompt <span><span>&#34;</span>write me a story about a boy and his bear<span>&#34;</span></span></pre></div>

<p dir="auto">This mode allows you to chat with the model using a UI in your browser
Running the command automatically open a tab in your browser.</p>
<div data-snippet-clipboard-copy-content="streamlit run torchchat.py -- browser llama3.1"><pre><code>streamlit run torchchat.py -- browser llama3.1
</code></pre></div>

<p dir="auto"><strong>Note: This feature is still a work in progress and not all endpoints are working</strong></p>
<details>
<summary>This mode gives a REST API that matches the OpenAI API spec for interacting with a model</summary>
<p dir="auto">To test out the REST API, <strong>you&#39;ll need 2 terminals</strong>: one to host the server, and one to send the request.</p>
<p dir="auto">In one terminal, start the server</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 torchchat.py server llama3.1"><pre>python3 torchchat.py server llama3.1</pre></div>
<p dir="auto">In another terminal, query the server using <code>curl</code>. Depending on the model configuration, this query might take a few minutes to respond.</p>
<p dir="auto">Setting <code>stream</code> to &#34;true&#34; in the request emits a response in chunks. Currently, this response
is plaintext and will not be formatted to the OpenAI API specification. If <code>stream</code> is unset or not &#34;true&#34;, then the client will await the full response from the server.</p>
<p dir="auto"><strong>Example Input + Output</strong></p>
<div data-snippet-clipboard-copy-content="curl http://127.0.0.1:5000/chat \
  -H &#34;Content-Type: application/json&#34; \
  -d &#39;{
    &#34;model&#34;: &#34;llama3.1&#34;,
    &#34;stream&#34;: &#34;true&#34;,
    &#34;messages&#34;: [
      {
        &#34;role&#34;: &#34;system&#34;,
        &#34;content&#34;: &#34;You are a helpful assistant.&#34;
      },
      {
        &#34;role&#34;: &#34;user&#34;,
        &#34;content&#34;: &#34;Hello!&#34;
      }
    ]
  }&#39;"><pre><code>curl http://127.0.0.1:5000/chat \
  -H &#34;Content-Type: application/json&#34; \
  -d &#39;{
    &#34;model&#34;: &#34;llama3.1&#34;,
    &#34;stream&#34;: &#34;true&#34;,
    &#34;messages&#34;: [
      {
        &#34;role&#34;: &#34;system&#34;,
        &#34;content&#34;: &#34;You are a helpful assistant.&#34;
      },
      {
        &#34;role&#34;: &#34;user&#34;,
        &#34;content&#34;: &#34;Hello!&#34;
      }
    ]
  }&#39;
</code></pre></div>
<div data-snippet-clipboard-copy-content="{&#34;response&#34;:&#34; I&#39;m a software developer with a passion for building innovative and user-friendly applications. I have experience in developing web and mobile applications using various technologies such as Java, Python, and JavaScript. I&#39;m always looking for new challenges and opportunities to learn and grow as a developer.\n\nIn my free time, I enjoy reading books on computer science and programming, as well as experimenting with new technologies and techniques. I&#39;m also interested in machine learning and artificial intelligence, and I&#39;m always looking for ways to apply these concepts to real-world problems.\n\nI&#39;m excited to be a part of the developer community and to have the opportunity to share my knowledge and experience with others. I&#39;m always happy to help with any questions or problems you may have, and I&#39;m looking forward to learning from you as well.\n\nThank you for visiting my profile! I hope you find my information helpful and interesting. If you have any questions or would like to discuss any topics, please feel free to reach out to me. I&#34;}"><pre><code>{&#34;response&#34;:&#34; I&#39;m a software developer with a passion for building innovative and user-friendly applications. I have experience in developing web and mobile applications using various technologies such as Java, Python, and JavaScript. I&#39;m always looking for new challenges and opportunities to learn and grow as a developer.\n\nIn my free time, I enjoy reading books on computer science and programming, as well as experimenting with new technologies and techniques. I&#39;m also interested in machine learning and artificial intelligence, and I&#39;m always looking for ways to apply these concepts to real-world problems.\n\nI&#39;m excited to be a part of the developer community and to have the opportunity to share my knowledge and experience with others. I&#39;m always happy to help with any questions or problems you may have, and I&#39;m looking forward to learning from you as well.\n\nThank you for visiting my profile! I hope you find my information helpful and interesting. If you have any questions or would like to discuss any topics, please feel free to reach out to me. I&#34;}
</code></pre></div>
</details>


<p dir="auto"><a href="https://pytorch.org/blog/pytorch2-2/" rel="nofollow">AOTI</a> compiles models before execution for faster inference. The process creates a <a href="https://en.wikipedia.org/wiki/Shared_library" rel="nofollow">DSO</a> model (represented by a file with extension <code>.so</code>)
that is then loaded for inference. This can be done with both Python and C++ enviroments.</p>
<p dir="auto">The following example exports and executes the Llama3.1 8B Instruct
model.  The first command compiles and performs the actual export.</p>
<div data-snippet-clipboard-copy-content="python3 torchchat.py export llama3.1 --output-dso-path exportedModels/llama3.1.so"><pre><code>python3 torchchat.py export llama3.1 --output-dso-path exportedModels/llama3.1.so
</code></pre></div>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p><p dir="auto">If your machine has cuda add this flag for performance
<code>--quantize config/data/cuda.json</code> when exporting.</p>
</div>
<p dir="auto">For more details on quantization and what settings to use for your use
case visit our <a href="https://unplannedobsolescence.com/pytorch/torchchat/blob/main/docs/model_customization.md">customization guide</a>.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Run in a Python Enviroment</h3><a id="user-content-run-in-a-python-enviroment" aria-label="Permalink: Run in a Python Enviroment" href="#run-in-a-python-enviroment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To run in a python enviroment, use the generate subcommand like before, but include the dso file.</p>
<div data-snippet-clipboard-copy-content="python3 torchchat.py generate llama3.1 --dso-path exportedModels/llama3.1.so --prompt &#34;Hello my name is&#34;"><pre><code>python3 torchchat.py generate llama3.1 --dso-path exportedModels/llama3.1.so --prompt &#34;Hello my name is&#34;
</code></pre></div>
<p dir="auto"><strong>Note:</strong> Depending on which accelerator is used to generate the .dso file, the command may need the device specified: <code>--device (cuda | cpu)</code>.</p>

<p dir="auto">To run in a C++ enviroment, we need to build the runner binary.</p>
<div dir="auto" data-snippet-clipboard-copy-content="scripts/build_native.sh aoti"><pre>scripts/build_native.sh aoti</pre></div>
<p dir="auto">Then run the compiled executable, with the exported DSO from earlier.</p>
<div dir="auto" data-snippet-clipboard-copy-content="cmake-out/aoti_run exportedModels/llama3.1.so -z `python3 torchchat.py where llama3.1`/tokenizer.model -l 3 -i &#34;Once upon a time&#34;"><pre>cmake-out/aoti_run exportedModels/llama3.1.so -z <span><span>`</span>python3 torchchat.py where llama3.1<span>`</span></span>/tokenizer.model -l 3 -i <span><span>&#34;</span>Once upon a time<span>&#34;</span></span></pre></div>
<p dir="auto"><strong>Note:</strong> Depending on which accelerator is used to generate the .dso file, the runner may need the device specified: <code>-d (CUDA | CPU)</code>.</p>

<p dir="auto"><a href="https://github.com/pytorch/executorch">ExecuTorch</a> enables you to optimize your model for execution on a
mobile or embedded device.</p>

<p dir="auto">Before running any commands in torchchat that require ExecuTorch, you
must first install ExecuTorch.</p>
<p dir="auto">To install ExecuTorch, run the following commands.  This will download the
ExecuTorch repo to ./et-build/src and install various ExecuTorch libraries to
./et-build/install.</p>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</p><p dir="auto">The following commands should be run from the torchchat root directory.</p>
</div>
<div data-snippet-clipboard-copy-content="export TORCHCHAT_ROOT=${PWD}
./scripts/install_et.sh"><pre><code>export TORCHCHAT_ROOT=${PWD}
./scripts/install_et.sh
</code></pre></div>

<p dir="auto">Similar to AOTI, to deploy onto device, we first export the PTE artifact, then we load the artifact for inference.</p>
<p dir="auto">The following example uses the Llama3.1 8B Instruct model.</p>
<div data-snippet-clipboard-copy-content="# Export
python3 torchchat.py export llama3.1 --quantize config/data/mobile.json --output-pte-path llama3.1.pte"><pre><code># Export
python3 torchchat.py export llama3.1 --quantize config/data/mobile.json --output-pte-path llama3.1.pte
</code></pre></div>
<div dir="auto"><p dir="auto"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</p><p dir="auto">We use <code>--quantize config/data/mobile.json</code> to quantize the
llama3.1 model to reduce model size and improve performance for
on-device use cases.</p>
</div>
<p dir="auto">For more details on quantization and what settings to use for your use
case visit our <a href="https://unplannedobsolescence.com/pytorch/torchchat/blob/main/docs/model_customization.md">customization guide</a>.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Deploy and run on Desktop</h3><a id="user-content-deploy-and-run-on-desktop" aria-label="Permalink: Deploy and run on Desktop" href="#deploy-and-run-on-desktop"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">While ExecuTorch does not focus on desktop inference, it is capable
of doing so. This is handy for testing out PTE
models without sending them to a physical device.</p>
<p dir="auto">Specifically there are 2 ways of doing so: Pure Python and via a Runner</p>
<details>
<summary>Deploying via Python</summary>
<div data-snippet-clipboard-copy-content="# Execute
python3 torchchat.py generate llama3.1 --device cpu --pte-path llama3.1.pte --prompt &#34;Hello my name is&#34;"><pre><code># Execute
python3 torchchat.py generate llama3.1 --device cpu --pte-path llama3.1.pte --prompt &#34;Hello my name is&#34;
</code></pre></div>
</details>
<details>
<summary>Deploying via a Runner</summary>
<p dir="auto">Build the runner</p>
<div dir="auto" data-snippet-clipboard-copy-content="scripts/build_native.sh et"><pre>scripts/build_native.sh et</pre></div>
<p dir="auto">Execute using the runner</p>
<div dir="auto" data-snippet-clipboard-copy-content="cmake-out/et_run llama3.1.pte -z `python3 torchchat.py where llama3.1`/tokenizer.model -l 3 -i &#34;Once upon a time&#34;"><pre>cmake-out/et_run llama3.1.pte -z <span><span>`</span>python3 torchchat.py where llama3.1<span>`</span></span>/tokenizer.model -l 3 -i <span><span>&#34;</span>Once upon a time<span>&#34;</span></span></pre></div>
</details>

<p dir="auto">The following assumes you&#39;ve completed the steps for <a href="#set-up-executorch">Setting up ExecuTorch</a>.</p>
<details>
<summary>Deploying with Xcode</summary>

<ul dir="auto">
<li><a href="https://apps.apple.com/us/app/xcode/id497799835?mt=12/" rel="nofollow">Xcode</a> 15.0 or later</li>
<li><a href="https://cmake.org/download/" rel="nofollow">Cmake</a> 3.19 or later
<ul dir="auto">
<li>Download and open the macOS <code>.dmg</code> installer and move the Cmake app to <code>/Applications</code> folder.</li>
<li>Install Cmake command line tools: <code>sudo /Applications/CMake.app/Contents/bin/cmake-gui --install</code></li>
</ul>
</li>
<li>A development provisioning profile with the <a href="https://developer.apple.com/documentation/bundleresources/entitlements/com_apple_developer_kernel_increased-memory-limit" rel="nofollow"><code>increased-memory-limit</code></a> entitlement.</li>
</ul>

<ol dir="auto">
<li>
<p dir="auto">Open the Xcode project:</p>
<div dir="auto" data-snippet-clipboard-copy-content="open et-build/src/executorch/examples/demo-apps/apple_ios/LLaMA/LLaMA.xcodeproj"><pre>open et-build/src/executorch/examples/demo-apps/apple_ios/LLaMA/LLaMA.xcodeproj</pre></div>
<blockquote>
<p dir="auto">Note: If you&#39;re running into any issues related to package dependencies, close Xcode, clean some of the caches and/or the build products, and open the Xcode project again:</p>
<div dir="auto" data-snippet-clipboard-copy-content="rm -rf \
  ~/Library/org.swift.swiftpm \
  ~/Library/Caches/org.swift.swiftpm \
  ~/Library/Caches/com.apple.dt.Xcode \
  ~/Library/Developer/Xcode/DerivedData"><pre>rm -rf \
  <span>~</span>/Library/org.swift.swiftpm \
  <span>~</span>/Library/Caches/org.swift.swiftpm \
  <span>~</span>/Library/Caches/com.apple.dt.Xcode \
  <span>~</span>/Library/Developer/Xcode/DerivedData</pre></div>
</blockquote>
</li>
<li>
<p dir="auto">Click the Play button to launch the app in the Simulator.</p>
</li>
<li>
<p dir="auto">To run on a device, ensure you have it set up for development and a provisioning profile with the <code>increased-memory-limit</code> entitlement. Update the app&#39;s bundle identifier to match your provisioning profile with the required capability.</p>
</li>
<li>
<p dir="auto">After successfully launching the app, copy the exported ExecuTorch model (<code>.pte</code>) and tokenizer (<code>.model</code>) files to the iLLaMA folder. You can find the model file called <code>llama3.1.pte</code> in the current <code>torchchat</code> directory and the tokenizer file at <code>$(python3 torchchat.py where llama3.1)/tokenizer.model</code> path.</p>
<ul dir="auto">
<li><strong>For the Simulator:</strong> Drag and drop both files onto the Simulator window and save them in the <code>On My iPhone &gt; iLLaMA</code> folder.</li>
<li><strong>For a device:</strong> Open a separate Finder window, navigate to the Files tab, drag and drop both files into the iLLaMA folder, and wait for the copying to finish.</li>
</ul>
</li>
<li>
<p dir="auto">Follow the app&#39;s UI guidelines to select the model and tokenizer files from the local filesystem and issue a prompt.</p>
</li>
</ol>
<p dir="auto"><em>Click the image below to see it in action!</em></p>
<p dir="auto">
<a href="https://pytorch.org/executorch/main/_static/img/llama_ios_app.mp4" rel="nofollow">
  <img src="https://camo.githubusercontent.com/e6975bf38cc4ad360ada871f6d7efc66c2d2f485c33317107c061ea70199d500/68747470733a2f2f7079746f7263682e6f72672f6578656375746f7263682f6d61696e2f5f7374617469632f696d672f6c6c616d615f696f735f6170702e706e67" width="600" alt="iOS app running a LlaMA model" data-canonical-src="https://pytorch.org/executorch/main/_static/img/llama_ios_app.png"/>
</a>
</p>
</details>
<div dir="auto"><h3 tabindex="-1" dir="auto">Deploy and run on Android</h3><a id="user-content-deploy-and-run-on-android" aria-label="Permalink: Deploy and run on Android" href="#deploy-and-run-on-android"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The following assumes you&#39;ve completed the steps for <a href="#set-up-executorch">Setting up ExecuTorch</a>.</p>
<details>
<summary>Approach 1 (Recommended): Android Studio</summary>

<ul dir="auto">
<li>Android Studio</li>
<li><a href="https://developer.android.com/build/jdks" rel="nofollow">Java 17</a></li>
<li><a href="https://developer.android.com/about/versions/14/setup-sdk" rel="nofollow">Android SDK 34</a></li>
<li><a href="https://developer.android.com/tools/adb" rel="nofollow">adb</a></li>
</ul>

<ol dir="auto">
<li>
<p dir="auto">Download the AAR file, which contains the Java library and corresponding JNI library, to build and run the app.</p>
<ul dir="auto">
<li><a href="https://ossci-android.s3.amazonaws.com/executorch/main/executorch-llama-tiktoken-rc3-0719.aar" rel="nofollow">executorch-llama-tiktoken-rc3-0719.aar</a> (SHASUM: c3e5d2a97708f033c2b1839a89f12f737e3bbbef)</li>
</ul>
</li>
<li>
<p dir="auto">Rename the downloaded AAR file to <code>executorch.aar</code> and move the file to <code>android/torchchat/app/libs/</code>. You may need to create directory <code>android/torchchat/app/libs/</code> if it does not exist.</p>
</li>
<li>
<p dir="auto">Push the model and tokenizer file to your device. You can find the model file called <code>llama3.1.pte</code> in the current <code>torchchat</code> directory and the tokenizer file at <code>$(python3 torchchat.py where llama3.1)/tokenizer.model</code> path.</p>
<div data-snippet-clipboard-copy-content="adb shell mkdir -p /data/local/tmp/llama
adb push &lt;model.pte&gt; /data/local/tmp/llama
adb push &lt;tokenizer.model or tokenizer.bin&gt; /data/local/tmp/llama"><pre><code>adb shell mkdir -p /data/local/tmp/llama
adb push &lt;model.pte&gt; /data/local/tmp/llama
adb push &lt;tokenizer.model or tokenizer.bin&gt; /data/local/tmp/llama
</code></pre></div>
</li>
<li>
<p dir="auto">Use Android Studio to open the torchchat app skeleton, located at <code>android/torchchat</code>.</p>
</li>
<li>
<p dir="auto">Click the Play button (^R) to launch it to emulator/device.</p>
<ul dir="auto">
<li>We recommend using a device with at least 12GB RAM and 20GB storage.</li>
<li>If using an emulated device, refer to <a href="https://stackoverflow.com/questions/45517553/cant-change-the-ram-size-in-avd-manager-android-studio" rel="nofollow">this post</a> on how to set the RAM.</li>
</ul>
</li>
<li>
<p dir="auto">Follow the app&#39;s UI guidelines to pick the model and tokenizer files from the local filesystem. Then issue a prompt.</p>
</li>
</ol>
<p dir="auto"><strong>Note:</strong> The AAR file listed in Step 1 has the tiktoken tokenizer, which is used for Llama 3. To tweak or use a custom tokenizer and runtime, modify the ExecuTorch code
and use <a href="https://github.com/pytorch/executorch/blob/main/build/build_android_llm_demo.sh">this script</a> to build the AAR library.</p>
<p dir="auto">
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/8cf1cc62d4896d94efd214dfee81d28fc4065286236c10dd2b4cf4b0ca548581/68747470733a2f2f7079746f7263682e6f72672f6578656375746f7263682f6d61696e2f5f7374617469632f696d672f616e64726f69645f6c6c616d615f6170702e706e67"><img src="https://camo.githubusercontent.com/8cf1cc62d4896d94efd214dfee81d28fc4065286236c10dd2b4cf4b0ca548581/68747470733a2f2f7079746f7263682e6f72672f6578656375746f7263682f6d61696e2f5f7374617469632f696d672f616e64726f69645f6c6c616d615f6170702e706e67" width="600" alt="Android app running a LlaMA model" data-canonical-src="https://pytorch.org/executorch/main/_static/img/android_llama_app.png"/></a>
</p>
</details>
<details>
<summary>Approach 2: E2E Script</summary>
<p dir="auto">Alternatively, you can run <code>scripts/android_example.sh</code> which sets up Java, Android SDK Manager, Android SDK, Android emulator (if no physical device is found), builds the app, and launches it for you. It can be used if you don&#39;t have a GUI.</p>
<div data-snippet-clipboard-copy-content="export TORCHCHAT_ROOT=$(pwd)
export USE_TIKTOKEN=ON # Set this only for tiktoken tokenizer
sh scripts/android_example.sh"><pre><code>export TORCHCHAT_ROOT=$(pwd)
export USE_TIKTOKEN=ON # Set this only for tiktoken tokenizer
sh scripts/android_example.sh
</code></pre></div>
</details>

<p dir="auto"><strong>Note: This feature is still a work in progress and not all features are working</strong></p>
<p dir="auto">Uses the lm_eval library to evaluate model accuracy on a variety of
tasks. Defaults to wikitext and can be manually controlled using the
tasks and limit args. See <a href="https://unplannedobsolescence.com/pytorch/torchchat/blob/main/docs/evaluation.md">Evaluation</a></p>
<p dir="auto"><strong>Examples</strong></p>
<p dir="auto">Eager mode:</p>
<div data-snippet-clipboard-copy-content="python3 torchchat.py eval llama3.1 --dtype fp32 --limit 5"><pre><code>python3 torchchat.py eval llama3.1 --dtype fp32 --limit 5
</code></pre></div>
<p dir="auto">To test the perplexity for a lowered or quantized model, pass it in
the same way you would to generate:</p>
<div data-snippet-clipboard-copy-content="python3 torchchat.py eval llama3.1 --pte-path llama3.1.pte --limit 5"><pre><code>python3 torchchat.py eval llama3.1 --pte-path llama3.1.pte --limit 5
</code></pre></div>

<p dir="auto">The following models are supported by torchchat and have associated
aliases.</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Model</th>
<th>Mobile Friendly</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://huggingface.co/meta-llama/Meta-Llama-3.1-8B-Instruct" rel="nofollow">meta-llama/Meta-Llama-3.1-8B-Instruct</a></td>
<td>✅</td>
<td>Tuned for <code>chat</code> . Alias to <code>llama3.1</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Meta-Llama-3.1-8B" rel="nofollow">meta-llama/Meta-Llama-3.1-8B</a></td>
<td>✅</td>
<td>Best for <code>generate</code>. Alias to <code>llama3.1-base</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct" rel="nofollow">meta-llama/Meta-Llama-3-8B-Instruct</a></td>
<td>✅</td>
<td>Tuned for <code>chat</code> . Alias to <code>llama3</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Meta-Llama-3-8B" rel="nofollow">meta-llama/Meta-Llama-3-8B</a></td>
<td>✅</td>
<td>Best for <code>generate</code>. Alias to <code>llama3-base</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Llama-2-7b-chat-hf" rel="nofollow">meta-llama/Llama-2-7b-chat-hf</a></td>
<td>✅</td>
<td>Tuned for <code>chat</code>. Alias to <code>llama2</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Llama-2-13b-chat-hf" rel="nofollow">meta-llama/Llama-2-13b-chat-hf</a></td>
<td></td>
<td>Tuned for <code>chat</code>. Alias to <code>llama2-13b-chat</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Llama-2-70b-chat-hf" rel="nofollow">meta-llama/Llama-2-70b-chat-hf</a></td>
<td></td>
<td>Tuned for <code>chat</code>. Alias to <code>llama2-70b-chat</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/Llama-2-7b-hf" rel="nofollow">meta-llama/Llama-2-7b-hf</a></td>
<td>✅</td>
<td>Best for <code>generate</code>. Alias to <code>llama2-base</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/CodeLlama-7b-Python-hf" rel="nofollow">meta-llama/CodeLlama-7b-Python-hf</a></td>
<td>✅</td>
<td>Tuned for Python and <code>generate</code>. Alias to <code>codellama</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/meta-llama/CodeLlama-34b-Python-hf" rel="nofollow">meta-llama/CodeLlama-34b-Python-hf</a></td>
<td>✅</td>
<td>Tuned for Python and <code>generate</code>. Alias to <code>codellama-34b</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/mistralai/Mistral-7B-v0.1" rel="nofollow">mistralai/Mistral-7B-v0.1</a></td>
<td>✅</td>
<td>Best for <code>generate</code>. Alias to <code>mistral-7b-v01-base</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.1" rel="nofollow">mistralai/Mistral-7B-Instruct-v0.1</a></td>
<td>✅</td>
<td>Tuned for <code>chat</code>. Alias to <code>mistral-7b-v01-instruct</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2" rel="nofollow">mistralai/Mistral-7B-Instruct-v0.2</a></td>
<td>✅</td>
<td>Tuned for <code>chat</code>. Alias to <code>mistral</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/karpathy/tinyllamas/tree/main" rel="nofollow">tinyllamas/stories15M</a></td>
<td>✅</td>
<td>Toy model for <code>generate</code>. Alias to <code>stories15M</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/karpathy/tinyllamas/tree/main" rel="nofollow">tinyllamas/stories42M</a></td>
<td>✅</td>
<td>Toy model for <code>generate</code>. Alias to <code>stories42M</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/karpathy/tinyllamas/tree/main" rel="nofollow">tinyllamas/stories110M</a></td>
<td>✅</td>
<td>Toy model for <code>generate</code>. Alias to <code>stories110M</code>.</td>
</tr>
<tr>
<td><a href="https://huggingface.co/openlm-research/open_llama_7b" rel="nofollow">openlm-research/open_llama_7b</a></td>
<td>✅</td>
<td>Best for <code>generate</code>. Alias to <code>open-llama</code>.</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">While we describe how to use torchchat using the popular llama3 model,
you can perform the example commands with any of these models.</p>

<p dir="auto">torchchat embodies PyTorch’s design philosophy <a href="https://pytorch.org/docs/stable/community/design.html" rel="nofollow">details</a>, especially &#34;usability over everything else&#34;.</p>

<p dir="auto">torchchat is a native-PyTorch library. While we provide integrations with the surrounding ecosystem (eg: Hugging Face models, etc), all of the core functionality is written in PyTorch.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Simplicity and Extensibility</h3><a id="user-content-simplicity-and-extensibility" aria-label="Permalink: Simplicity and Extensibility" href="#simplicity-and-extensibility"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">torchchat is designed to be easy to understand, use and extend.</p>
<ul dir="auto">
<li>Composition over implementation inheritance - layers of inheritance for code re-use makes the code hard to read and extend</li>
<li>No training frameworks - explicitly outlining the training logic makes it easy to extend for custom use cases</li>
<li>Code duplication is preferred over unnecessary abstractions</li>
<li>Modular building blocks over monolithic components</li>
</ul>

<p dir="auto">torchchat provides well-tested components with a high-bar on correctness.
We provide</p>
<ul dir="auto">
<li>Extensive unit-tests to ensure things operate as they should</li>
</ul>

<p dir="auto">We really value our community and the contributions made by our wonderful users. We&#39;ll use this section to call out some of these contributions! If you&#39;d like to help out as well, please see the <a href="https://unplannedobsolescence.com/pytorch/torchchat/blob/main/CONTRIBUTING.md">CONTRIBUTING</a> guide.</p>

<p dir="auto"><strong>CERTIFICATE_VERIFY_FAILED</strong>
Run <code>pip install --upgrade certifi</code>.</p>
<p dir="auto"><strong>Access to model is restricted and you are not in the authorized list</strong>
Some models require an additional step to access. Follow the
link provided in the error to get access.</p>
<p dir="auto"><strong>Installing ET Fails</strong>
If <code>./scripts/install_et.sh</code> fails with an error like <code>Building wheel for executorch (pyproject.toml) did not run successfully</code> It&#39;s possible that it&#39;s linking to an older version of pytorch installed some other way like via homebrew. You can break the link by uninstalling other versions such as <code>brew uninstall pytorch</code> Note: You may break something that depends on this, so be aware.</p>

<p dir="auto">Please include the exact command you ran and the output of that command.
Also, run this script and include the output saved to <code>system_info.txt</code> so that we can better debug your issue.</p>
<div data-snippet-clipboard-copy-content="(echo &#34;Operating System Information&#34;; uname -a; echo &#34;&#34;; cat /etc/os-release; echo &#34;&#34;; echo &#34;Python Version&#34;; python --version || python3 --version; echo &#34;&#34;; echo &#34;PIP Version&#34;; pip --version || pip3 --version; echo &#34;&#34;; echo &#34;Installed Packages&#34;; pip freeze || pip3 freeze; echo &#34;&#34;; echo &#34;PyTorch Version&#34;; python -c &#34;import torch; print(torch.__version__)&#34; || python3 -c &#34;import torch; print(torch.__version__)&#34;; echo &#34;&#34;; echo &#34;Collection Complete&#34;) &gt; system_info.txt"><pre><code>(echo &#34;Operating System Information&#34;; uname -a; echo &#34;&#34;; cat /etc/os-release; echo &#34;&#34;; echo &#34;Python Version&#34;; python --version || python3 --version; echo &#34;&#34;; echo &#34;PIP Version&#34;; pip --version || pip3 --version; echo &#34;&#34;; echo &#34;Installed Packages&#34;; pip freeze || pip3 freeze; echo &#34;&#34;; echo &#34;PyTorch Version&#34;; python -c &#34;import torch; print(torch.__version__)&#34; || python3 -c &#34;import torch; print(torch.__version__)&#34;; echo &#34;&#34;; echo &#34;Collection Complete&#34;) &gt; system_info.txt
</code></pre></div>

<p dir="auto">The torchchat Repository Content is provided without any guarantees
about performance or compatibility. In particular, torchchat makes
available model architectures written in Python for PyTorch that may
not perform in the same manner or meet the same standards as the
original versions of those models. When using the torchchat Repository
Content, including any model architectures, you are solely responsible
for determining the appropriateness of using or redistributing the
torchchat Repository Content and assume any risks associated with your
use of the torchchat Repository Content or any models, outputs, or
results, both alone and in combination with any other
technologies. Additionally, you may have other legal obligations that
govern your use of other content, such as the terms of service for
third-party models, weights, data, or other technologies, and you are
solely responsible for complying with all such obligations.</p>

<p dir="auto">Thank you to the community for all the
awesome libraries and tools you&#39;ve built around local LLM inference.</p>
<ul dir="auto">
<li>
<p dir="auto">Georgi Gerganov and his <a href="https://github.com/ggerganov/ggml">GGML</a>
project shining a spotlight on community-based enablement and
inspiring so many other projects.</p>
</li>
<li>
<p dir="auto">Andrej Karpathy and his
<a href="https://github.com/karpathy/llama2.c">llama2.c</a> project.  So many
great (and simple!) ideas in llama2.c that we have directly adopted
(both ideas and code) from his repo.  You can never go wrong by
following Andrej&#39;s work.</p>
</li>
<li>
<p dir="auto">Michael Gschwind, Bert Maher, Scott Wolchok, Bin Bao, Chen Yang,
Huamin Li and Mu-Chu Li who built the first version of nanogpt (<code>DSOGPT</code>)
with AOT Inductor proving that AOTI can be used to build efficient
LLMs, and DSOs are a viable distribution format for models.
<a href="https://github.com/karpathy/nanoGPT">nanoGPT</a>.</p>
</li>
<li>
<p dir="auto">Bert Maher and his
<a href="https://github.com/bertmaher/llama2.so">llama2.so</a>, which built on
Andrej&#39;s llama2.c and on DSOGPT to close the loop on Llama models
with AOTInductor.</p>
</li>
<li>
<p dir="auto">Christian Puhrsch, Horace He, Joe Isaacson and many more for their
many contributions in Accelerating GenAI models in the <em>&#34;Anything,
Fast!&#34;</em> pytorch.org blogs, and, in particular, Horace He for <a href="https://github.com/pytorch-labs/gpt-fast">GPT,
Fast!</a>, which we have
directly adopted (both ideas and code) from his repo.</p>
</li>
</ul>

<p dir="auto">torchchat is released under the <a href="https://unplannedobsolescence.com/pytorch/torchchat/blob/main/LICENSE">BSD 3 license</a>. (Additional
code in this distribution is covered by the MIT and Apache Open Source
licenses.) However you may have other legal obligations that govern
your use of content, such as the terms of service for third-party
models.</p>
</article></div></div>
  </body>
</html>
