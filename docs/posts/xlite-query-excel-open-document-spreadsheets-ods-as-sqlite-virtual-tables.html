<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/x2bool/xlite">Original</a>
    <h1>Xlite: Query Excel, Open Document spreadsheets (.ods) as SQLite virtual tables</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">XLite is a SQLite extension written in Rust. The main purpose of this library is to allow working with spreadsheets from SQLite exposing them as <a href="https://sqlite.org/vtab.html" rel="nofollow">virtual tables</a>.</p>
<h3 dir="auto"><a id="user-content-how-to-build" aria-hidden="true" href="#how-to-build"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to build</h3>

<p dir="auto">This step will produce <code>libxlite.so</code> or <code>libxlite.dylib</code> depending on your operation system.</p>
<h3 dir="auto"><a id="user-content-how-to-use" aria-hidden="true" href="#how-to-use"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to use</h3>
<p dir="auto">Assuming you have sqlite3 command line tools installed, <code>libxlite</code> library in your current directory and some spreadsheet file on your disk (this sample uses an .xslx file <a href="https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms" rel="nofollow">exported from Google Sheets</a>) load extension:</p>
<div data-snippet-clipboard-copy-content="sqlite3 # will open SQLite CLI
&gt; .load libxlite"><pre>sqlite3 <span><span>#</span> will open SQLite CLI</span>
<span>&gt;</span> .load libxlite</pre></div>
<p dir="auto">This will load <code>xlite</code> module, now it can be used to create virtual tables.</p>
<p dir="auto">Creating a virtual table:</p>
<div data-snippet-clipboard-copy-content="CREATE VIRTUAL TABLE class_data USING xlite(
    FILENAME &#39;./path/to/example.xlsx&#39;,
    WORKSHEET &#39;Class Data&#39;,
    RANGE &#39;A2:F&#39;
);"><pre>CREATE VIRTUAL TABLE class_data USING xlite(
    FILENAME <span><span>&#39;</span>./path/to/example.xlsx<span>&#39;</span></span>,
    WORKSHEET <span><span>&#39;</span>Class Data<span>&#39;</span></span>,
    RANGE <span><span>&#39;</span>A2:F<span>&#39;</span></span>
);</pre></div>
<p dir="auto">Explanation: this statement will create a virtual table based on the .xlsx file and the worksheet named &#34;Class Data&#34;.</p>
<p dir="auto">Optional <code>RANGE</code> parameter is used here to skip the first row in the table because in the sample spreadsheet it is used as a header. <code>A2:F</code> meaning is <code>use columns from A to F but start from 2nd row</code>.</p>
<p dir="auto">Querying:</p>
<div data-snippet-clipboard-copy-content="SELECT A, B, C, D, E, F from class_data;"><pre><span>SELECT</span> A, B, C, D, E, F <span>from</span> class_data;</pre></div>
<p dir="auto">Columns are named according to their name (index) in the spreadsheet.</p>
<div data-snippet-clipboard-copy-content="SELECT COUNT(*), D FROM class_data GROUP BY D ORDER BY COUNT(*);"><pre><span>SELECT</span> <span>COUNT</span>(<span>*</span>), D <span>FROM</span> class_data <span>GROUP BY</span> D <span>ORDER BY</span> <span>COUNT</span>(<span>*</span>);</pre></div>
<p dir="auto">Theoretically any operation supported by SQLite can be executed on the spreadsheet as long as it is supported by the virtual table mechanism.</p>
<p dir="auto">Dropping:</p>

<p dir="auto">This statement will drop only the virtual table. Physical file won&#39;t be deleted.</p>
<h3 dir="auto"><a id="user-content-limitations" aria-hidden="true" href="#limitations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Limitations</h3>
<p dir="auto"><code>INSERT</code>, <code>UPDATE</code> and <code>DELETE</code> statements are not supported right now.</p>
<h3 dir="auto"><a id="user-content-about" aria-hidden="true" href="#about"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>About</h3>
<p dir="auto">This project is experimental, use at your own risk. The project is developed in my free time as a way to learn Rust and database systems.</p>
</article>
          </div></div>
  </body>
</html>
