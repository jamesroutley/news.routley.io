<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.thinkst.com/2023/01/swipe-right-on-our-new-credit-card-tokens.html">Original</a>
    <h1>Detect breaches with Canary credit cards</h1>
    
    <div id="readability-page-1" class="page"><div>
				
<h4>Detect breaches with Canary credit cards!</h4>



<p><strong>TL;DR;</strong></p>



<p>Today we’re releasing a new Canarytoken type: actual credit cards! </p>



<ol>
<li>Head over to <a href="https://canarytokens.org">canarytokens.org</a>;</li>



<li>We give you a valid credit card (number, expiration, and CVC);</li>



<li>If anyone ever attempts to use that card you’ll be notified.</li>
</ol>



<p>We recommend placing one anywhere you store payment information. If you ever get an alert on it, you know that that data-store has been compromised.</p>



<h3>Background</h3>



<p>Canaries generally aim to look like something an attacker would want to interact with. It’s why our mantra has always been that Canaries should look valuable (instead of just vulnerable). Historically, these have been network services, or a juicy repository of sensitive information that usually would encourage an attacker to advertise their presence as they move through the network attempting to find firm footholds. Canarytokens expand on that to include files or data that reliably trigger alerts when accessed. </p>



<p>Our new credit card tokens fit this bill perfectly. We give you a perfectly valid credit card. You store it somewhere and if it’s ever used, we will let you know.</p>



<p>Mix it in with your store of saved card data or on payment gateways. An attacker who plans to test the cards (as they normally do when obtaining them) or attackers who try to use them will immediately advertise their presence, and your response team can spring into action.</p>



<h3>Using the token</h3>



<p>Using this new token is easy, just head over to <a href="https://canarytokens.org/">Canarytokens.org</a>, and select Credit Card token from the dropdown.</p>



<figure><img decoding="async" src="https://lh3.googleusercontent.com/tqXf5kBPrSfAXQrbSavA6RgHAUSZo6hoIwXOYLHIu1yLY2BCxz3o0pjbfC7fChU0aalP2NGkkgp9HtfGIXtG_2458eOD_2-g-YuA4Qpggot9d4S7s-eONR3HNHglc5nIVS714GnZ00Hy7wrZshcL3jJKPC8fUAo5zd2LuAk_7iYHDN5THEpzha8bp9FKiA" alt="" data-lazy-src="https://lh3.googleusercontent.com/tqXf5kBPrSfAXQrbSavA6RgHAUSZo6hoIwXOYLHIu1yLY2BCxz3o0pjbfC7fChU0aalP2NGkkgp9HtfGIXtG_2458eOD_2-g-YuA4Qpggot9d4S7s-eONR3HNHglc5nIVS714GnZ00Hy7wrZshcL3jJKPC8fUAo5zd2LuAk_7iYHDN5THEpzha8bp9FKiA?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure>



<p>Then enter the email address or webhook URL where you want to be notified when an attempted transaction occurs (we never use this to spam you or sell you things, it’s only to notify you when this card is used):</p>



<figure><img decoding="async" src="https://lh3.googleusercontent.com/NHf-leWD7phU8hj0qPMfYpssxa0CTGbAWuc5eqrTZuqwKwi8LJdUSKYsxzc7bWFwNFkt-2OsGnK2-Y-jR4L5egB-i1Vq1LPTfyAU8CoQoHpwFCanQO1kl7dRggKl0uMGdbAKngw3rjOlU4nCsO4XA44KjJv8P5rtwZCZ3SDA023-HHUxFTzXADaY4jpOzA" alt="" data-lazy-src="https://lh3.googleusercontent.com/NHf-leWD7phU8hj0qPMfYpssxa0CTGbAWuc5eqrTZuqwKwi8LJdUSKYsxzc7bWFwNFkt-2OsGnK2-Y-jR4L5egB-i1Vq1LPTfyAU8CoQoHpwFCanQO1kl7dRggKl0uMGdbAKngw3rjOlU4nCsO4XA44KjJv8P5rtwZCZ3SDA023-HHUxFTzXADaY4jpOzA?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure>



<p>Hit “Create my Canarytoken”, and after a few seconds we will give you a set of unique, valid (real) credit card information, complete with generated name, card number, expiration date, and CVC:</p>



<figure><img decoding="async" src="https://lh5.googleusercontent.com/Chce3QcTD3WJCu30c_NsLRa5jBpVyaMF-H3Oo0tbeklP6-FOkj4k6kq3znUxeI9xUbl3D5YY6Ye0AirnNGJbd-Ip4iz_w4cdLQSKBaRyzNiRDrakPFAamCjUdY9AkBuNIo3KHv1q20v4bHRmTSiwkEBsb05Y3BvX59rVTllJiS7UKAkB9xuyr_EMGMQHsA" alt="" data-lazy-src="https://lh5.googleusercontent.com/Chce3QcTD3WJCu30c_NsLRa5jBpVyaMF-H3Oo0tbeklP6-FOkj4k6kq3znUxeI9xUbl3D5YY6Ye0AirnNGJbd-Ip4iz_w4cdLQSKBaRyzNiRDrakPFAamCjUdY9AkBuNIo3KHv1q20v4bHRmTSiwkEBsb05Y3BvX59rVTllJiS7UKAkB9xuyr_EMGMQHsA?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure>



<p>You can also download this information as a CSV to programmatically import into your storage location. </p>



<p>Some places we recommend putting these include:</p>



<ol>
<li>Databases where you store customer payment information</li>



<li>Email inboxes (PSTs) to get an alert on email compromise</li>



<li>If you’re concerned about an insider, put one or two in a Word document on an internal file share in a file called something like: “travel payment info.docx”</li>
</ol>



<p>Take a deep breath and relax, the hard work is all done!</p>



<p>If someone does try to use the card, the transaction will fail, and you’ll get an alert like this in your email with the merchant name, the amount of the transaction, and the note you put in when you created the account:</p>



<figure><img decoding="async" src="https://lh4.googleusercontent.com/JsJUup4xJnndnUOSW0FVe2Fqa7V2aaGC7fmEcWS9EhBg3E3Mwe21DsGqSJhU9-ScWVAqC7TzUi5T7O7frnISCaIMQN2t7bVXgylebTR9b7v8zSw4ika-YNXgcxKQKvAZqXqKTbtxxgm6Pmd8U0rB4prFKaKM4Y47VO2XpFKGJzz-BAm-Y9m-RTldlZkK7w" alt="" data-lazy-src="https://lh4.googleusercontent.com/JsJUup4xJnndnUOSW0FVe2Fqa7V2aaGC7fmEcWS9EhBg3E3Mwe21DsGqSJhU9-ScWVAqC7TzUi5T7O7frnISCaIMQN2t7bVXgylebTR9b7v8zSw4ika-YNXgcxKQKvAZqXqKTbtxxgm6Pmd8U0rB4prFKaKM4Y47VO2XpFKGJzz-BAm-Y9m-RTldlZkK7w?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure>



<p>This is a high quality alert–someone is actively trying to monetize data that they should only have been able to get from wherever you put this token. Like all other well deployed Canarytokens, it also self identifies. You can drop one in each payment store or database and forget about it (at least until the card expires). When you get the alert, you will know immediately that it’s the credit card from the Lisbon DB that was used, and you know immediately where to start investigating.</p>



<p>The chances of a false positive for this alert is close to nil and historically it’s been clear that the quicker you are able to react to the compromise, the more you are able to contain the splash damage of the event.</p>



<h3>Conspicuous deception</h3>



<p>Canaries and Canarytokens have caught red-teamers, fast-fingered insiders and full-blown attackers all over the world. We expected them to when we started Canary. What we didn’t quite expect, was the deterrence factor once attackers became aware of their presence. Last year, during an external red-team engagement, we placed attackers on a presentation laptop in our conference-room. The attackers, knowing our proclivities, were afraid to move beyond that system, paralyzed (almost into inaction) for days. This matches feedback we’ve received both privately and publicly for years:</p>


<div>
<figure><a href="https://twitter.com/infosec_au/status/949014188579610624?s=20&amp;t=uzizOYeWdmjLf3XZRR6MhA"><img decoding="async" src="https://lh3.googleusercontent.com/9HwufV0b7KFrfHNg4J_xCgL6-Zvw9JDALvB6A0_p-aa0Iuffq5thXk2XcTFxnhWMwvuvGWn_i93TS1Z2ADeIPz5GXLLUhnqmz4QV2DzEzDdwu5MJfILigm-hi_MUzGXeT9csNuimGs47AgcYshDW5cgYX-Edp9hDkrueG-CV2-9IAvhv1QyfPOABVy4erQ" alt="" data-lazy-src="https://lh3.googleusercontent.com/9HwufV0b7KFrfHNg4J_xCgL6-Zvw9JDALvB6A0_p-aa0Iuffq5thXk2XcTFxnhWMwvuvGWn_i93TS1Z2ADeIPz5GXLLUhnqmz4QV2DzEzDdwu5MJfILigm-hi_MUzGXeT9csNuimGs47AgcYshDW5cgYX-Edp9hDkrueG-CV2-9IAvhv1QyfPOABVy4erQ?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></a></figure></div>


<p>We’ve been noodling on this a little bit and we’re calling it <em>conspicuous deception. </em>Letting people know you are running Canaries or Canarytokens in order to alter their behavior.</p>



<p>We think the credit card Canarytoken is a good example of this.</p>



<p>If this token has the impact that we hope, savvy attackers, or the buyers of their stolen dumps, will have to start considering the risk of a test swipe destroying the entire set. As merchants and their payment processors leverage this new visibility, they can respond to a test swipe event much more quickly, and with better understanding of the potential splash damage of a breach. Typically credit card companies and banks identify breaches through analysing multiple reports of fraud looking for commonalities in their transactions (such as physical charge locations, websites where the card was used, or payment processors that were involved). This takes time for sufficient fraud reports to flow in before the breached location can be identified. This token allows for near instantaneous identification of a breach.</p>



<p>For low-tier attackers that continue to breach and steal cards without changing their tactics, this token will reduce their ability to monetize and commit fraud. Savvy attackers may start looking for patterns in the bank identification numbers (BINs) that we issue, and proactively deleting or excluding them from their dumps. For this reason we are in discussions with a number of banks to onboard their BINs to the system too, further mixing in legitimate cards with tokens. </p>



<p>It’s a compelling argument: “Would you like attackers to first remove your bank’s cards from dumps they steal?” </p>



<p>The more BINs we can cover with tokens, the more deterrence the token provides – even to organizations that have not deployed these tokens to their environment. This is a benefit of conspicuous deception, the <em>possibility </em>of the dump being tripwired provides protection even if it isn’t actually seeded with tripwires.</p>



<h3>Conclusions</h3>



<p>Canaries and Canarytokens are powerful tools that are easily deployed. Recently a security researcher, Daniel Hückman discovered his AWS Canarytokens stored in his CircleCI environment being improperly used. </p>


<div>
<figure><img decoding="async" src="https://lh4.googleusercontent.com/vJlbllXWkpbIVjTJNnF_p5WJBP-hG8lm2bGg1Xn7ko-xRmHktUNYcVS-36f9HdBczxJ3UlVzOc2hJl7XQWT0PQK1zJsy2L8fvmPk8o-3S5wUXooEepm4dWVTJHqYNTCuzCjLHEQRukALEqvnAb1RkGeQ0KKvc-mZbT8dn8ecsuJtjWcNIb5DYZAWEoQF9w" alt="" data-lazy-src="https://lh4.googleusercontent.com/vJlbllXWkpbIVjTJNnF_p5WJBP-hG8lm2bGg1Xn7ko-xRmHktUNYcVS-36f9HdBczxJ3UlVzOc2hJl7XQWT0PQK1zJsy2L8fvmPk8o-3S5wUXooEepm4dWVTJHqYNTCuzCjLHEQRukALEqvnAb1RkGeQ0KKvc-mZbT8dn8ecsuJtjWcNIb5DYZAWEoQF9w?is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure></div>


<p>The credit card Canarytoken provides more ways to monitor your environment, as well as the exposure to your data by third parties. Credit card fraud amounts to almost $40B per year worldwide, we hope that with faster response times to a breach to help make a [small] dent in that figure.</p>



<p>We think that our Canarytokens offer great protection and detection capabilities while being easy to deploy, and cost-effective (free!). By giving them away for free, we introduce a risk for attackers who are trying to monetize their access, from AWS credentials that may provide access to the crown jewels to an Excel document called “2022 Taxes”–attackers need to step a little more carefully. </p>



<p>We hope you’re as excited about this new token as we are (and that it never has to alert you).</p>

				</div></div>
  </body>
</html>
