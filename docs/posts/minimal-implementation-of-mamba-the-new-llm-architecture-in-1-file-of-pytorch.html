<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/johnma2006/mamba-minimal">Original</a>
    <h1>Minimal implementation of Mamba, the new LLM architecture, in 1 file of PyTorch</h1>
    
    <div id="readability-page-1" class="page"><div data-view-component="true">        
        
        <div>
  



<div data-modal-dialog-overlay="">
  <modal-dialog role="dialog" id="warn-tag-match-create-branch-dialog" aria-modal="true" aria-labelledby="warn-tag-match-create-branch-dialog-header" data-view-component="true">
      <header>
        
      </header>
    <div>
      
          <p>      A tag already exists with the provided branch name. Many Git commands accept both tag and branch names, so creating this branch may cause unexpected behavior. Are you sure you want to create this branch?
</p>

    </div>
      
</modal-dialog></div>



  

  

  <include-fragment src="/johnma2006/mamba-minimal/overview_actions/master"></include-fragment>


    <p><span>
        
<get-repo>
  <details data-action="
              toggle:get-repo#onDetailsToggle
              keydown:get-repo#onDetailsKeydown">
    <summary data-hydro-click="{&#34;event_type&#34;:&#34;repository.click&#34;,&#34;payload&#34;:{&#34;repository_id&#34;:733879158,&#34;target&#34;:&#34;CLONE_OR_DOWNLOAD_BUTTON&#34;,&#34;originating_url&#34;:&#34;https://github.com/johnma2006/mamba-minimal&#34;,&#34;user_id&#34;:null}}" data-hydro-click-hmac="b4b996cb214076e1cdd9e7d492f4bd3e9cd735f5a6d1ade216d1860230b0e340" aria-description="Open clone and codespaces menu" data-view-component="true">  <span>
    <span>Code</span>
  </span>
    <span>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="m4.427 7.427 3.396 3.396a.25.25 0 0 0 .354 0l3.396-3.396A.25.25 0 0 0 11.396 7H4.604a.25.25 0 0 0-.177.427Z"></path>
</svg>
    </span>
</summary>
    
  </details>
</get-repo>

    </span>

    <span>
      

    </span>
</p></div>




        


<div>
  <div>
    <h2>Latest commit</h2>
    <div data-issue-and-pr-hovercards-enabled="">
      
  <div>
    
<div>
  <p><a data-test-selector="commits-avatar-stack-avatar-link" data-hovercard-type="user" data-hovercard-url="/users/johnma2006/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/johnma2006">
        <img data-test-selector="commits-avatar-stack-avatar-image" src="https://avatars.githubusercontent.com/u/8770777?s=48&amp;v=4" width="24" height="24" alt="@johnma2006"/>
</a>  </p>
</div>

  </div>
  
  
      
    </div>
  </div>
    <h2 id="files">Files</h2>
    


      <p><a data-hotkey="y" href="https://github.com/johnma2006/mamba-minimal/tree/32bc32650f941f6e1e4a33cf67491d6dce5d7c12">Permalink</a></p><div data-view-component="true">
  <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path>
</svg><p>
    Failed to load latest commit information.


  
</p></div>  <div data-hpc="">
    <div role="grid" aria-labelledby="files">
      <div role="row">
        <p>Type</p>
        <p>Name</p>
        <p>Latest commit message</p>
        <p>Commit time</p>
      </div>
          
          
          
    </div>
    
  </div>




</div>

  
      <readme-toc>

      <div id="readme" data-tagsearch-path="README.md" data-tagsearch-lang="Markdown">

        

          <div data-target="readme-toc.content">
            <article itemprop="text"><h2 tabindex="-1" dir="auto"><a id="user-content-mamba-minimal" aria-hidden="true" tabindex="-1" href="#mamba-minimal"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>mamba-minimal</h2>
<p dir="auto">Simple, minimal implementation of Mamba in one file of PyTorch.</p>
<p dir="auto">Featuring:</p>
<ul dir="auto">
<li>Equivalent numerical output as official implementation for both forward and backward pass</li>
<li>Simplified, readable, annotated code</li>
</ul>
<p dir="auto">Does NOT include:</p>
<ul dir="auto">
<li>Speed. The official implementation is heavily optimized, and these optimizations are core contributions of the Mamba paper. I kept most implementations simple for readability.</li>
<li>Proper parameter initialization (though this could be added without sacrificing readability)</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-demo" aria-hidden="true" tabindex="-1" href="#demo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Demo</h2>
<p dir="auto">See <a href="https://github.com/johnma2006/mamba-minimal/blob/master/demo.ipynb">demo.ipynb</a> for examples of prompt completions.</p>
<div dir="auto" data-snippet-clipboard-copy-content="from model import Mamba
from transformers import AutoTokenizer

model = Mamba.from_pretrained(&#39;state-spaces/mamba-370m&#39;)
tokenizer = AutoTokenizer.from_pretrained(&#39;EleutherAI/gpt-neox-20b&#39;)

generate(model, tokenizer, &#39;Mamba is the&#39;)"><pre><span>from</span> <span>model</span> <span>import</span> <span>Mamba</span>
<span>from</span> <span>transformers</span> <span>import</span> <span>AutoTokenizer</span>

<span>model</span> <span>=</span> <span>Mamba</span>.<span>from_pretrained</span>(<span>&#39;state-spaces/mamba-370m&#39;</span>)
<span>tokenizer</span> <span>=</span> <span>AutoTokenizer</span>.<span>from_pretrained</span>(<span>&#39;EleutherAI/gpt-neox-20b&#39;</span>)

<span>generate</span>(<span>model</span>, <span>tokenizer</span>, <span>&#39;Mamba is the&#39;</span>)</pre></div>
<blockquote>
<p dir="auto">Mamba is the world&#39;s longest venomous snake with an estimated length of over 150 m. With such a large size and a venomous bite, Mamba kills by stabbing the victim (which is more painful and less effective than a single stab of the bite)</p>
</blockquote>
<p dir="auto">150 meters... ðŸ«¢ scary!</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-references" aria-hidden="true" tabindex="-1" href="#references"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>References</h2>
<p dir="auto">The Mamba architecture was introduced in <a href="https://arxiv.org/abs/2312.00752" rel="nofollow">Mamba: Linear-Time Sequence Modeling with Selective State Spaces</a> by <a href="https://twitter.com/_albertgu?lang=en" rel="nofollow">Albert Gu</a> and <a href="https://twitter.com/tri_dao?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor" rel="nofollow">Tri Dao</a>.</p>
<p dir="auto">The official implementation is here: <a href="https://github.com/state-spaces/mamba/tree/main">https://github.com/state-spaces/mamba/tree/main</a></p>
</article>
          </div>
      </div>

  </readme-toc>


</div></div>
  </body>
</html>
