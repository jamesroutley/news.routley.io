<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://event-driven.io/en/the_end_is_near_for_crud_data/">Original</a>
    <h1>Moving from relational data to events</h1>
    
    <div id="readability-page-1" class="page"><div><p><span>
      <a href="https://event-driven.io/static/8b59709ef54e36c71a032a94903e9f03/36e56/2023-12-15-cover.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="cover" title="cover" src="https://event-driven.io/static/8b59709ef54e36c71a032a94903e9f03/36e56/2023-12-15-cover.png" srcset="/static/8b59709ef54e36c71a032a94903e9f03/76e7d/2023-12-15-cover.png 200w,
/static/8b59709ef54e36c71a032a94903e9f03/ca202/2023-12-15-cover.png 400w,
/static/8b59709ef54e36c71a032a94903e9f03/36e56/2023-12-15-cover.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p><strong>Knock knock? Who’s there? It’s me, Oskar, the end is near, did you know that?</strong> Ah, you know it but don’t know how to proceed? Let’s talk about the end of the CRUD world. Let’s provide a Hitchhiker’s Guide To Moving Relational Data To Events.</p>
<p><strong>I hope that you know why the end is near. We’ve been trying to optimise the storage size; we’ve made some sins of overriding and losing our precious business data.</strong> Don’t worry; I already talked with Saint Peter, and he will pass us through. Those sins shall be forgiven, as we had no other choice. Yet, now we do. We can optimise for information quality instead of its size.</p>
<p>Saint Peter, send me to his colleague, Santa Claus; you remember him? He’s making a list and checking it twice. Gonna find out who’s naughty or nice. And we’ve been naughty, oh we were! So, Santa showed me something from his list to prove it:</p>
<p><span>
      <a href="https://event-driven.io/static/bf71643d590f7b7062d48499f63153cd/36e56/2023-12-15-1.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="Ordering Process Model" title="Ordering Process Model" src="https://event-driven.io/static/bf71643d590f7b7062d48499f63153cd/36e56/2023-12-15-1.png" srcset="/static/bf71643d590f7b7062d48499f63153cd/76e7d/2023-12-15-1.png 200w,
/static/bf71643d590f7b7062d48499f63153cd/ca202/2023-12-15-1.png 400w,
/static/bf71643d590f7b7062d48499f63153cd/36e56/2023-12-15-1.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>Ordering Process Model, a blast from the past. Don’t you recognise it? Yes, it’s not super-readable. Could I zoom it in? Of course, I could, but would it really help us to understand it? We’d see better what data we keep, but only a little about what’s happening in our system. Finding processes and how they interact and pass information would be, at best, guessing. But no worries, I told you, the end is near, and it will wash away our past mistakes.</p>
<p><strong>In Event Sourcing Church, we’re not doing that anymore. We’re not losing business data; we keep them.</strong> We keep them as events. Events are facts about what has happened, and we store them after each operation. And we’re also making a list like Santa, but we call it Event Stream. It’s a list of everything that has happened with our record. It’s a pity, but you cannot change events, as they’re immutable. But you can add a new one in the end and fix your past mistakes. When making decisions, just like Santa, we’re reading and checking a list of events (not always twice; we’re busy, as we’re working more than one day a year).</p>
<p>If you join our Order, you’ll find your life more peaceful. We have a clear way of behaving.</p>
<p>We start modelling our process by discovering events:</p>
<p><span>
      <a href="https://event-driven.io/static/d10f4e2475c456de507f0d712968eeab/36e56/2023-12-15-2.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="discovering events" title="discovering events" src="https://event-driven.io/static/d10f4e2475c456de507f0d712968eeab/36e56/2023-12-15-2.png" srcset="/static/d10f4e2475c456de507f0d712968eeab/76e7d/2023-12-15-2.png 200w,
/static/d10f4e2475c456de507f0d712968eeab/ca202/2023-12-15-2.png 400w,
/static/d10f4e2475c456de507f0d712968eeab/36e56/2023-12-15-2.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>Then we find commands, so intentions to run some action. Yes, we’re always having good intentions:</p>
<p><span>
      <a href="https://event-driven.io/static/bf2c0aefebc019f7c1a238c53ae6b10a/36e56/2023-12-15-3.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="finding commands" title="finding commands" src="https://event-driven.io/static/bf2c0aefebc019f7c1a238c53ae6b10a/36e56/2023-12-15-3.png" srcset="/static/bf2c0aefebc019f7c1a238c53ae6b10a/76e7d/2023-12-15-3.png 200w,
/static/bf2c0aefebc019f7c1a238c53ae6b10a/ca202/2023-12-15-3.png 400w,
/static/bf2c0aefebc019f7c1a238c53ae6b10a/36e56/2023-12-15-3.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>And we finish our mantra by defining business rules.</p>
<p><span>
      <a href="https://event-driven.io/static/b5336166fe4dbfacdcbcf4886fb89812/36e56/2023-12-15-4.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="defining business rules" title="defining business rules" src="https://event-driven.io/static/b5336166fe4dbfacdcbcf4886fb89812/36e56/2023-12-15-4.png" srcset="/static/b5336166fe4dbfacdcbcf4886fb89812/76e7d/2023-12-15-4.png 200w,
/static/b5336166fe4dbfacdcbcf4886fb89812/ca202/2023-12-15-4.png 400w,
/static/b5336166fe4dbfacdcbcf4886fb89812/36e56/2023-12-15-4.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>Ok, we have a bit more, and we even have a <em>“picture that explains everything”</em> (per <a href="https://www.eventstorming.com/">Alberto Brandolini</a>):</p>
<p><span>
      <a href="https://event-driven.io/static/ff33ce44216f6f88fa985d331b7076c1/36e56/2023-12-15-9.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="picture that explains everything" title="picture that explains everything" src="https://event-driven.io/static/ff33ce44216f6f88fa985d331b7076c1/36e56/2023-12-15-9.png" srcset="/static/ff33ce44216f6f88fa985d331b7076c1/76e7d/2023-12-15-9.png 200w,
/static/ff33ce44216f6f88fa985d331b7076c1/ca202/2023-12-15-9.png 400w,
/static/ff33ce44216f6f88fa985d331b7076c1/36e56/2023-12-15-9.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>Sounds a bit simpler than your past mantras, isn’t it?</p>
<p><strong>But still, events are critical here.</strong> They tell the story and show us critical parts of the process. They’re building a shared understanding of the process between technical and business people.</p>
<p>Yet, time is running out! The storm is here; the end is coming, so let me tell you how you can help yourself get a second life.</p>
<p>If you’re deep into the misery of the DDD, so Database-Driven Design, you should not immediately drop all you had. You should embrace the past, do an examination of conscience and move on! What should you especially examine?</p>
<p><span>
      <a href="https://event-driven.io/static/508a86d4b50037612893263bfe8eed1e/36e56/2023-12-15-5.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="how to" title="how to" src="https://event-driven.io/static/508a86d4b50037612893263bfe8eed1e/36e56/2023-12-15-5.png" srcset="/static/508a86d4b50037612893263bfe8eed1e/76e7d/2023-12-15-5.png 200w,
/static/508a86d4b50037612893263bfe8eed1e/ca202/2023-12-15-5.png 400w,
/static/508a86d4b50037612893263bfe8eed1e/36e56/2023-12-15-5.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<h2 id="1-look-for-status-columns"><a href="#1-look-for-status-columns" aria-label="1 look for status columns permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Look for status columns.</h2>
<p>Find what values they had; quite often, they may reflect the lifetime phases of your data.</p>
<p><span>
      <a href="https://event-driven.io/static/95cca4483a683599531999b07f06e589/36e56/2023-12-15-6.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="status columns" title="status columns" src="https://event-driven.io/static/95cca4483a683599531999b07f06e589/36e56/2023-12-15-6.png" srcset="/static/95cca4483a683599531999b07f06e589/76e7d/2023-12-15-6.png 200w,
/static/95cca4483a683599531999b07f06e589/ca202/2023-12-15-6.png 400w,
/static/95cca4483a683599531999b07f06e589/36e56/2023-12-15-6.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>So, an order may be initiated, shipped, paid, etc. They can be transferable to events like <em>Order Initiated</em>, <em>Order Shipped</em>, <em>Order Paid</em>. Of course, be careful and don’t assume that they’re complete. They may be a flattened interpretation of the business process. Always consult that with someone who knows more: best with business.</p>
<p>Ah, and remember, in Event Sourcing Church, we don’t sware. We’re not naming events as <em>Order Created</em>, <em>Order Updated</em>, <em>Order Deleted</em>. I told you that you should drop your past sins and start fresh! <a href="https://event-driven.io/en/state-obsession/">State Obsession</a> is a big sin in our decalogue, so beware!</p>
<h2 id="2-check-for-dates"><a href="#2-check-for-dates" aria-label="2 check for dates permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Check for dates</h2>
<p><strong>Dates columns can tell you a lot about significant occurrences in your process’s lifetime.</strong> That speaks something if they’re significant enough to keep them as dedicated columns.</p>
<p><span>
      <a href="https://event-driven.io/static/dcc64dea7d145e41eb331c3279bb5082/36e56/2023-12-15-7.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="dates" title="dates" src="https://event-driven.io/static/dcc64dea7d145e41eb331c3279bb5082/36e56/2023-12-15-7.png" srcset="/static/dcc64dea7d145e41eb331c3279bb5082/76e7d/2023-12-15-7.png 200w,
/static/dcc64dea7d145e41eb331c3279bb5082/ca202/2023-12-15-7.png 400w,
/static/dcc64dea7d145e41eb331c3279bb5082/36e56/2023-12-15-7.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>Of course, <em>CreatedDate</em> and <em>ModifiedDate</em> won’t tell you much, but <em>ShipmentDate</em>, <em>DeliveryDate</em>, and <em>OrderPlacementDate</em> will give you better information. They can tell you both about the business lingo, confirm our assumptions we got from statuses or introduce new events.</p>
<p>For instance:</p>
<ul>
<li><em>ShipmentDate</em> would be a next clue for introducing <em>Order Shipped</em> event,</li>
<li><em>OrderPlacementDate</em> can suggest that <em>Order Initiated</em> event may be better named <em>Order Placed</em>, and best trigger discussion with the business if they’re actually the same thing,</li>
<li><em>DeliveryDate</em> may mean we should also introduce a new <em>Order Delivered</em> event.</li>
</ul>
<p>And again, <a href="https://event-driven.io/en/a_few_words_on_communication/">talk to domain experts</a>; they can help you be a better member of Event Sourcing Church by embracing the truth about the business process.</p>
<h2 id="3-analyse-columns-optionality"><a href="#3-analyse-columns-optionality" aria-label="3 analyse columns optionality permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Analyse columns optionality</h2>
<p>If columns are non-nullable, then it means that you have to be always provided. Nullable that they may be either provided later (so in other operations) or that they’re optional.</p>
<p><span>
      <a href="https://event-driven.io/static/b5e5393d1b6370eb3adffd83c7921483/36e56/2023-12-15-8.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="optional columns" title="optional columns" src="https://event-driven.io/static/b5e5393d1b6370eb3adffd83c7921483/36e56/2023-12-15-8.png" srcset="/static/b5e5393d1b6370eb3adffd83c7921483/76e7d/2023-12-15-8.png 200w,
/static/b5e5393d1b6370eb3adffd83c7921483/ca202/2023-12-15-8.png 400w,
/static/b5e5393d1b6370eb3adffd83c7921483/36e56/2023-12-15-8.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>So, in our Ordering Process, if columns are required, then the data we keep them should also be provided in the first <em>Order Initiated</em> event. Remember that a single event type is not always a starting point for the stream; there may be more.</p>
<h2 id="4-search-for-tables-with-the-most-1-to-many-relationships"><a href="#4-search-for-tables-with-the-most-1-to-many-relationships" aria-label="4 search for tables with the most 1 to many relationships permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Search for tables with the most 1 to Many relationships</h2>
<p>At Event Sourcing Church, we believe that setting up boundaries is an essential aspect. To make our processing effective, we group our data around the business process, not the storage normalisation (as our friends from our fellow <a href="https://event-driven.io/en/strategy_on_migrating_relational_data_to_document_based/">Document-Based Approach</a> convent).</p>
<p><span>
      <a href="https://event-driven.io/static/bf71643d590f7b7062d48499f63153cd/36e56/2023-12-15-1.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="Ordering Process Model" title="Ordering Process Model" src="https://event-driven.io/static/bf71643d590f7b7062d48499f63153cd/36e56/2023-12-15-1.png" srcset="/static/bf71643d590f7b7062d48499f63153cd/76e7d/2023-12-15-1.png 200w,
/static/bf71643d590f7b7062d48499f63153cd/ca202/2023-12-15-1.png 400w,
/static/bf71643d590f7b7062d48499f63153cd/36e56/2023-12-15-1.png 800w" sizes="(max-width: 800px) 100vw, 800px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p><strong>To find the stream boundaries, you can start by finding tables that have 1 to Many relationships.</strong> Those that <em>have a lot of ones</em> are candidates for the stream types. We should also logically think if this data can live without each other. For instance, shipment can be a separate process from order, but the order line cannot live without it.</p>
<p>Once we start discussing those boundaries, we may find more events and enrich our understanding of the process.</p>
<h2 id="5-dont-lie-introduce-explicit-events-for-import"><a href="#5-dont-lie-introduce-explicit-events-for-import" aria-label="5 dont lie introduce explicit events for import permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. Don’t lie, introduce explicit events for import</h2>
<p>Once you distinguish all events you’re fine with and want to migrate your relational data, don’t try to cheat; don’t reuse your newly found events during import. Relational data is flattened; if you try to retrofit what happened from the final state, you will likely fail or not be precise at best.</p>
<p><strong>It’s better to be explicit and provide the <em>Order Imported</em> event with all the current states and the code to interpret it.</strong> It gives us clear information on how we got the data about its lifetime, which can be crucial for troubleshooting and diagnostics.</p>
<h2 id="6-experiment-and-validate"><a href="#6-experiment-and-validate" aria-label="6 experiment and validate permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. Experiment and validate</h2>
<p>Don’t be afraid to <a href="https://event-driven.io/en/prototype_underestimated_design_skill/">prototype and see your model in motion</a>. Our church is forgiving!</p>
<p>Try migrations in a safe environment, compare the result with expectations, rinse and repeat. Don’t rush things out. We wouldn’t like to lose old information but improve our future based on it.</p>
<p>I hope this guide will help you resurrect information you have in your data.</p>
<p><strong>The end is near: The end of flattened data and losing business information. Better to start now.</strong></p>
<p>Cheers!</p>
<p>Oskar</p>
<p>p.s. You may also like <a href="https://event-driven.io/en/strategy_on_migrating_relational_data_to_document_based/">General strategy for migrating relational data to document-based</a>.</p>
<p>p.s.2. <strong>Ukraine is still under brutal Russian invasion. A lot of Ukrainian people are hurt, without shelter and need help.</strong> You can help in various ways, for instance, directly helping refugees, spreading awareness, putting pressure on your local government or companies. You can also support Ukraine by donating e.g. to <a href="https://www.icrc.org/pl/donate/ukraine">Red Cross</a>, <a href="https://savelife.in.ua/pl/donate/">Ukraine humanitarian organisation</a> or <a href="https://www.gofundme.com/f/help-to-save-the-lives-of-civilians-in-a-war-zone">donate Ambulances for Ukraine</a>.</p></div></div>
  </body>
</html>
