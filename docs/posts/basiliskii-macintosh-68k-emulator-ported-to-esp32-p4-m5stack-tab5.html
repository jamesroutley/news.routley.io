<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/amcchord/M5Tab-Macintosh">Original</a>
    <h1>BasiliskII Macintosh 68k Emulator Ported to ESP32-P4 / M5Stack Tab5</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A full port of the <strong>BasiliskII</strong> Macintosh 68k emulator to the ESP32-P4 microcontroller, running on the M5Stack Tab5 hardware. This project brings classic Mac OS (System 7.x through Mac OS 8.1) to a portable embedded device with touchscreen input and USB peripheral support.</p>
<hr/>

<p dir="auto">
  <a target="_blank" rel="noopener noreferrer" href="https://github.com/amcchord/M5Tab-Macintosh/blob/master/screenshots/MacOS8.1_Booted.jpeg"><img src="https://github.com/amcchord/M5Tab-Macintosh/raw/master/screenshots/MacOS8.1_Booted.jpeg" width="45%" alt="Mac OS 8.1 Desktop"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://github.com/amcchord/M5Tab-Macintosh/blob/master/screenshots/MacOS8.1_About.jpeg"><img src="https://github.com/amcchord/M5Tab-Macintosh/raw/master/screenshots/MacOS8.1_About.jpeg" width="45%" alt="Mac OS 8.1 About This Macintosh"/></a>
</p>
<p dir="auto">
  <a target="_blank" rel="noopener noreferrer" href="https://github.com/amcchord/M5Tab-Macintosh/blob/master/screenshots/MacOS8.1_Booting.jpeg"><img src="https://github.com/amcchord/M5Tab-Macintosh/raw/master/screenshots/MacOS8.1_Booting.jpeg" width="45%" alt="Mac OS 8.1 Booting"/></a>
  <a target="_blank" rel="noopener noreferrer" href="https://github.com/amcchord/M5Tab-Macintosh/blob/master/screenshots/MacOS753_About.jpeg"><img src="https://github.com/amcchord/M5Tab-Macintosh/raw/master/screenshots/MacOS753_About.jpeg" width="45%" alt="System 7.5.3 About This Macintosh"/></a>
</p>
<p dir="auto">
  <a href="https://github.com/amcchord/M5Tab-Macintosh/blob/master/screenshots.md">
    <img src="https://camo.githubusercontent.com/3d9374732bc820ac88a4676b1f92361bed3f07ba1b73726035899e84ced0b783/68747470733a2f2f696d672e736869656c64732e696f2f62616467652ff09f8eac5f566965775f416e696d6174696f6e732d426f6f745f53657175656e63655f265f466c79696e675f546f6173746572732d626c75653f7374796c653d666f722d7468652d6261646765" alt="View Animations" data-canonical-src="https://img.shields.io/badge/ğŸ¬_View_Animations-Boot_Sequence_&amp;_Flying_Toasters-blue?style=for-the-badge"/>
  </a>
</p>
<hr/>

<p dir="auto">This project runs a <strong>Motorola 68040</strong> emulator that can boot real Macintosh ROMs and run genuine classic Mac OS software. The emulation includes:</p>
<ul dir="auto">
<li><strong>CPU</strong>: Motorola 68040 emulation with FPU (68881)</li>
<li><strong>RAM</strong>: Configurable from 4MB to 16MB (allocated from ESP32-P4&#39;s 32MB PSRAM)</li>
<li><strong>Display</strong>: 640Ã—360 virtual display (2Ã— scaled to 1280Ã—720 physical display)</li>
<li><strong>Storage</strong>: Hard disk and CD-ROM images loaded from SD card</li>
<li><strong>Input</strong>: Capacitive touchscreen (as mouse) + USB keyboard/mouse support</li>
</ul>


<p dir="auto">The Tab5 features a unique <strong>dual-chip architecture</strong> that makes it ideal for this project:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Chip</th>
<th>Role</th>
<th>Key Features</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ESP32-P4</strong></td>
<td>Main Application Processor</td>
<td>400MHz dual-core RISC-V, 32MB PSRAM, MIPI-DSI display</td>
</tr>
<tr>
<td><strong>ESP32-C6</strong></td>
<td>Wireless Co-processor</td>
<td>WiFi 6, Bluetooth LE 5.0 (not used by emulator)</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Component</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Display</strong></td>
<td>5&#34; IPS TFT, 1280Ã—720 (720p), MIPI-DSI interface</td>
</tr>
<tr>
<td><strong>Touch</strong></td>
<td>Capacitive multi-touch (ST7123 controller)</td>
</tr>
<tr>
<td><strong>Memory</strong></td>
<td>32MB PSRAM for emulated Mac RAM + frame buffers</td>
</tr>
<tr>
<td><strong>Storage</strong></td>
<td>microSD card slot for ROM, disk images, and settings</td>
</tr>
<tr>
<td><strong>USB</strong></td>
<td>Type-A host port for keyboard/mouse, Type-C for programming</td>
</tr>
<tr>
<td><strong>Battery</strong></td>
<td>NP-F550 Li-ion (2000mAh) for portable operation</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">See <a href="https://github.com/amcchord/M5Tab-Macintosh/blob/master/boardConfig.md">boardConfig.md</a> for detailed pin mappings and hardware documentation.</p>
<hr/>


<p dir="auto">The emulator leverages the ESP32-P4&#39;s dual-core RISC-V architecture for optimal performance:</p>
<div data-snippet-clipboard-copy-content="â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ESP32-P4 (400MHz)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         CORE 0             â”‚              CORE 1                â”‚
â”‚    (Video &amp; I/O Core)      â”‚       (CPU Emulation Core)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Video rendering task    â”‚  â€¢ 68040 CPU interpreter           â”‚
â”‚  â€¢ 8-bit to RGB565 convert â”‚  â€¢ Memory access emulation         â”‚
â”‚  â€¢ 2Ã—2 pixel scaling       â”‚  â€¢ Interrupt handling              â”‚
â”‚  â€¢ Touch input processing  â”‚  â€¢ ROM patching                    â”‚
â”‚  â€¢ USB HID polling         â”‚  â€¢ Disk I/O                        â”‚
â”‚  â€¢ ~15 FPS refresh rate    â”‚  â€¢ 40,000 instruction quantum      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"><pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ESP32-P4 (400MHz)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         CORE 0             â”‚              CORE 1                â”‚
â”‚    (Video &amp; I/O Core)      â”‚       (CPU Emulation Core)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Video rendering task    â”‚  â€¢ 68040 CPU interpreter           â”‚
â”‚  â€¢ 8-bit to RGB565 convert â”‚  â€¢ Memory access emulation         â”‚
â”‚  â€¢ 2Ã—2 pixel scaling       â”‚  â€¢ Interrupt handling              â”‚
â”‚  â€¢ Touch input processing  â”‚  â€¢ ROM patching                    â”‚
â”‚  â€¢ USB HID polling         â”‚  â€¢ Disk I/O                        â”‚
â”‚  â€¢ ~15 FPS refresh rate    â”‚  â€¢ 40,000 instruction quantum      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<div data-snippet-clipboard-copy-content="â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    32MB PSRAM Allocation                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Mac RAM (4-16MB)          â”‚  Configurable via Boot GUI      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Mac ROM (~1MB)            â”‚  Q650.ROM or compatible         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Mac Frame Buffer (230KB)  â”‚  640Ã—360 @ 8-bit indexed color  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Display Buffer (1.8MB)    â”‚  1280Ã—720 @ RGB565              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Free PSRAM                â”‚  Varies based on RAM selection  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"><pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    32MB PSRAM Allocation                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Mac RAM (4-16MB)          â”‚  Configurable via Boot GUI      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Mac ROM (~1MB)            â”‚  Q650.ROM or compatible         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Mac Frame Buffer (230KB)  â”‚  640Ã—360 @ 8-bit indexed color  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Display Buffer (1.8MB)    â”‚  1280Ã—720 @ RGB565              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Free PSRAM                â”‚  Varies based on RAM selection  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p dir="auto">The video system uses an optimized pipeline for converting the Mac&#39;s 8-bit indexed framebuffer to the display:</p>
<ol dir="auto">
<li><strong>68040 CPU</strong> writes to emulated Mac framebuffer (640Ã—360, 8-bit indexed)</li>
<li><strong>Video Task</strong> (Core 0) reads framebuffer at ~15 FPS</li>
<li><strong>Palette Lookup</strong> converts 8-bit indices to RGB565</li>
<li><strong>2Ã—2 Scaling</strong> doubles pixels horizontally and vertically</li>
<li><strong>DMA Transfer</strong> pushes 1280Ã—720 RGB565 buffer to MIPI-DSI display</li>
</ol>
<hr/>


<p dir="auto">This port includes the following BasiliskII subsystems, adapted for ESP32:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Component</th>
<th>File(s)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>UAE CPU</strong></td>
<td><code>uae_cpu/*.cpp</code></td>
<td>Motorola 68040 interpreter</td>
</tr>
<tr>
<td><strong>ADB</strong></td>
<td><code>adb.cpp</code></td>
<td>Apple Desktop Bus for keyboard/mouse</td>
</tr>
<tr>
<td><strong>Video</strong></td>
<td><code>video_esp32.cpp</code></td>
<td>Display driver with 2Ã— scaling</td>
</tr>
<tr>
<td><strong>Disk</strong></td>
<td><code>disk.cpp</code>, <code>sys_esp32.cpp</code></td>
<td>HDD image support via SD card</td>
</tr>
<tr>
<td><strong>CD-ROM</strong></td>
<td><code>cdrom.cpp</code></td>
<td>ISO image mounting</td>
</tr>
<tr>
<td><strong>XPRAM</strong></td>
<td><code>xpram_esp32.cpp</code></td>
<td>Non-volatile parameter RAM</td>
</tr>
<tr>
<td><strong>Timer</strong></td>
<td><code>timer_esp32.cpp</code></td>
<td>60Hz/1Hz tick generation</td>
</tr>
<tr>
<td><strong>ROM Patches</strong></td>
<td><code>rom_patches.cpp</code></td>
<td>Compatibility patches for ROMs</td>
</tr>
<tr>
<td><strong>Input</strong></td>
<td><code>input_esp32.cpp</code></td>
<td>Touch + USB HID handling</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">The emulator works best with <strong>Macintosh Quadra</strong> series ROMs:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>ROM File</th>
<th>Machine</th>
<th>Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Q650.ROM</code></td>
<td>Quadra 650</td>
<td>âœ… Best compatibility</td>
</tr>
<tr>
<td><code>Q700.ROM</code></td>
<td>Quadra 700</td>
<td>âœ… Good</td>
</tr>
<tr>
<td><code>Q800.ROM</code></td>
<td>Quadra 800</td>
<td>âœ… Good</td>
</tr>
<tr>
<td><code>68030-IIci.ROM</code></td>
<td>Mac IIci</td>
<td><g-emoji alias="warning">âš ï¸</g-emoji> May work</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div dir="auto"><h3 tabindex="-1" dir="auto">Supported Operating Systems</h3><a id="user-content-supported-operating-systems" aria-label="Permalink: Supported Operating Systems" href="#supported-operating-systems"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>OS Version</th>
<th>Status</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>System 7.1</td>
<td>âœ… Works</td>
<td>Lightweight, fast boot</td>
</tr>
<tr>
<td>System 7.5.x</td>
<td>âœ… Works</td>
<td>Good compatibility</td>
</tr>
<tr>
<td>Mac OS 8.0</td>
<td>âœ… Works</td>
<td>Full-featured</td>
</tr>
<tr>
<td>Mac OS 8.1</td>
<td>âœ… Works</td>
<td>Latest supported</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr/>


<ul dir="auto">
<li><strong>Hardware</strong>: M5Stack Tab5</li>
<li><strong>Software</strong>: <a href="https://platformio.org/" rel="nofollow">PlatformIO</a> (CLI or IDE extension)</li>
<li><strong>SD Card</strong>: FAT32 formatted microSD card (8GB+ recommended)</li>
</ul>

<div dir="auto"><h4 tabindex="-1" dir="auto">Quick Start (Recommended)</h4><a id="user-content-quick-start-recommended" aria-label="Permalink: Quick Start (Recommended)" href="#quick-start-recommended"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Download a ready-to-use SD card image with Mac OS pre-installed:</p>
<p dir="auto"><strong><a href="https://mcchord.net/static/sdCard.zip" rel="nofollow">ğŸ“¥ Download sdCard.zip</a></strong></p>
<ol dir="auto">
<li>Format your microSD card as <strong>FAT32</strong></li>
<li>Extract the ZIP contents to the <strong>root</strong> of the SD card</li>
<li>Insert into Tab5 and boot</li>
</ol>

<p dir="auto">Alternatively, create your own setup with these files in the SD card root:</p>
<div data-snippet-clipboard-copy-content="/
â”œâ”€â”€ Q650.ROM              # Macintosh Quadra ROM (required)
â”œâ”€â”€ Macintosh.dsk         # Hard disk image (required)
â”œâ”€â”€ System753.iso         # Mac OS installer CD (optional)
â””â”€â”€ DiskTools1.img        # Boot floppy for installation (optional)"><pre><code>/
â”œâ”€â”€ Q650.ROM              # Macintosh Quadra ROM (required)
â”œâ”€â”€ Macintosh.dsk         # Hard disk image (required)
â”œâ”€â”€ System753.iso         # Mac OS installer CD (optional)
â””â”€â”€ DiskTools1.img        # Boot floppy for installation (optional)
</code></pre></div>
<p dir="auto">To create a blank disk image:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Create a 500MB blank disk image
dd if=/dev/zero of=Macintosh.dsk bs=1M count=500"><pre><span><span>#</span> Create a 500MB blank disk image</span>
dd if=/dev/zero of=Macintosh.dsk bs=1M count=500</pre></div>
<p dir="auto">Then format it during Mac OS installation.</p>

<div dir="auto"><h4 tabindex="-1" dir="auto">Option 1: Pre-built Firmware (Easiest)</h4><a id="user-content-option-1-pre-built-firmware-easiest" aria-label="Permalink: Option 1: Pre-built Firmware (Easiest)" href="#option-1-pre-built-firmware-easiest"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Download the latest release from GitHub:</p>
<p dir="auto"><strong><a href="https://github.com/amcchord/M5Tab-Macintosh/releases/latest">ğŸ“¥ Download Latest Release</a></strong></p>
<p dir="auto">Flash using <code>esptool.py</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Install esptool if you don&#39;t have it
pip install esptool

# Flash all three binary files (connect Tab5 via USB-C)
esptool.py --chip esp32p4 --port /dev/ttyACM0 --baud 921600 \
    write_flash \
    0x0 bootloader.bin \
    0x10000 firmware.bin \
    0x8000 partitions.bin"><pre><span><span>#</span> Install esptool if you don&#39;t have it</span>
pip install esptool

<span><span>#</span> Flash all three binary files (connect Tab5 via USB-C)</span>
esptool.py --chip esp32p4 --port /dev/ttyACM0 --baud 921600 \
    write_flash \
    0x0 bootloader.bin \
    0x10000 firmware.bin \
    0x8000 partitions.bin</pre></div>
<p dir="auto"><strong>Note</strong>: Replace <code>/dev/ttyACM0</code> with your actual port:</p>
<ul dir="auto">
<li><strong>macOS</strong>: <code>/dev/cu.usbmodem*</code> or <code>/dev/tty.usbmodem*</code></li>
<li><strong>Windows</strong>: <code>COM3</code> (or similar)</li>
<li><strong>Linux</strong>: <code>/dev/ttyACM0</code> or <code>/dev/ttyUSB0</code></li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">Option 2: Build from Source</h4><a id="user-content-option-2-build-from-source" aria-label="Permalink: Option 2: Build from Source" href="#option-2-build-from-source"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="# Clone the repository
git clone https://github.com/amcchord/M5Tab-Macintosh.git
cd M5Tab-Macintosh

# Build the firmware
pio run

# Upload to device (connect via USB-C)
pio run --target upload

# Monitor serial output
pio device monitor"><pre><span><span>#</span> Clone the repository</span>
git clone https://github.com/amcchord/M5Tab-Macintosh.git
<span>cd</span> M5Tab-Macintosh

<span><span>#</span> Build the firmware</span>
pio run

<span><span>#</span> Upload to device (connect via USB-C)</span>
pio run --target upload

<span><span>#</span> Monitor serial output</span>
pio device monitor</pre></div>
<hr/>

<p dir="auto">On startup, a <strong>classic Mac-style boot configuration screen</strong> appears:</p>
<div data-snippet-clipboard-copy-content="â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           BasiliskII                    â”‚
â”‚        Starting in 3...                 â”‚
â”‚                                         â”‚
â”‚    Disk: Macintosh.dsk                  â”‚
â”‚    RAM: 8 MB                            â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚       Change Settings           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"><pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           BasiliskII                    â”‚
â”‚        Starting in 3...                 â”‚
â”‚                                         â”‚
â”‚    Disk: Macintosh.dsk                  â”‚
â”‚    RAM: 8 MB                            â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚       Change Settings           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<ul dir="auto">
<li><strong>3-second countdown</strong> to auto-boot with saved settings</li>
<li><strong>Tap to configure</strong> disk images, CD-ROMs, and RAM size</li>
<li><strong>Settings persistence</strong> saved to <code>/basilisk_settings.txt</code> on SD card</li>
<li><strong>Touch-friendly</strong> large buttons designed for the 5&#34; touchscreen</li>
</ul>

<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Setting</th>
<th>Options</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hard Disk</td>
<td>Any <code>.dsk</code> or <code>.img</code> file on SD root</td>
<td>First found</td>
</tr>
<tr>
<td>CD-ROM</td>
<td>Any <code>.iso</code> file on SD root, or None</td>
<td>None</td>
</tr>
<tr>
<td>RAM Size</td>
<td>4 MB, 8 MB, 12 MB, 16 MB</td>
<td>8 MB</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr/>


<p dir="auto">The capacitive touchscreen acts as a single-button mouse:</p>
<ul dir="auto">
<li><strong>Tap</strong> = Click</li>
<li><strong>Drag</strong> = Click and drag</li>
<li>Coordinates are scaled from 1280Ã—720 display to 640Ã—360 Mac screen</li>
</ul>

<p dir="auto">Connect a USB keyboard to the <strong>USB Type-A port</strong>. Supported features:</p>
<ul dir="auto">
<li>Full QWERTY layout with proper Mac key mapping</li>
<li>Modifier keys: Command (âŒ˜), Option (âŒ¥), Control, Shift</li>
<li>Function keys F1-F15</li>
<li>Arrow keys and navigation cluster</li>
<li>Numeric keypad</li>
<li><strong>Caps Lock LED</strong> sync with Mac OS</li>
</ul>

<p dir="auto">Connect a USB mouse for relative movement input:</p>
<ul dir="auto">
<li>Left, right, and middle button support</li>
<li>Relative movement mode (vs. absolute for touch)</li>
</ul>
<hr/>

<div data-snippet-clipboard-copy-content="M5Tab-Macintosh/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.cpp                    # Application entry point
â”‚   â””â”€â”€ basilisk/                   # BasiliskII emulator core
â”‚       â”œâ”€â”€ main_esp32.cpp          # Emulator initialization &amp; main loop
â”‚       â”œâ”€â”€ video_esp32.cpp         # Display driver (2Ã— scaling, RGB565)
â”‚       â”œâ”€â”€ input_esp32.cpp         # Touch + USB HID input handling
â”‚       â”œâ”€â”€ boot_gui.cpp            # Pre-boot configuration GUI
â”‚       â”œâ”€â”€ sys_esp32.cpp           # SD card disk I/O
â”‚       â”œâ”€â”€ timer_esp32.cpp         # 60Hz/1Hz interrupt generation
â”‚       â”œâ”€â”€ xpram_esp32.cpp         # NVRAM persistence to SD
â”‚       â”œâ”€â”€ prefs_esp32.cpp         # Preferences loading
â”‚       â”œâ”€â”€ uae_cpu/                # Motorola 68040 CPU emulator
â”‚       â”‚   â”œâ”€â”€ newcpu.cpp          # Main CPU interpreter loop
â”‚       â”‚   â”œâ”€â”€ memory.cpp          # Memory banking &amp; access
â”‚       â”‚   â””â”€â”€ generated/          # CPU instruction tables
â”‚       â””â”€â”€ include/                # Header files
â”œâ”€â”€ platformio.ini                  # PlatformIO build configuration
â”œâ”€â”€ partitions.csv                  # ESP32 flash partition table
â”œâ”€â”€ boardConfig.md                  # Hardware documentation
â””â”€â”€ scripts/                        # Build helper scripts"><pre><code>M5Tab-Macintosh/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.cpp                    # Application entry point
â”‚   â””â”€â”€ basilisk/                   # BasiliskII emulator core
â”‚       â”œâ”€â”€ main_esp32.cpp          # Emulator initialization &amp; main loop
â”‚       â”œâ”€â”€ video_esp32.cpp         # Display driver (2Ã— scaling, RGB565)
â”‚       â”œâ”€â”€ input_esp32.cpp         # Touch + USB HID input handling
â”‚       â”œâ”€â”€ boot_gui.cpp            # Pre-boot configuration GUI
â”‚       â”œâ”€â”€ sys_esp32.cpp           # SD card disk I/O
â”‚       â”œâ”€â”€ timer_esp32.cpp         # 60Hz/1Hz interrupt generation
â”‚       â”œâ”€â”€ xpram_esp32.cpp         # NVRAM persistence to SD
â”‚       â”œâ”€â”€ prefs_esp32.cpp         # Preferences loading
â”‚       â”œâ”€â”€ uae_cpu/                # Motorola 68040 CPU emulator
â”‚       â”‚   â”œâ”€â”€ newcpu.cpp          # Main CPU interpreter loop
â”‚       â”‚   â”œâ”€â”€ memory.cpp          # Memory banking &amp; access
â”‚       â”‚   â””â”€â”€ generated/          # CPU instruction tables
â”‚       â””â”€â”€ include/                # Header files
â”œâ”€â”€ platformio.ini                  # PlatformIO build configuration
â”œâ”€â”€ partitions.csv                  # ESP32 flash partition table
â”œâ”€â”€ boardConfig.md                  # Hardware documentation
â””â”€â”€ scripts/                        # Build helper scripts
</code></pre></div>
<hr/>


<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Metric</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU Quantum</td>
<td>40,000 instructions per tick</td>
</tr>
<tr>
<td>Video Refresh</td>
<td>~15 FPS</td>
</tr>
<tr>
<td>Boot Time</td>
<td>~15 seconds to Mac OS desktop</td>
</tr>
<tr>
<td>Responsiveness</td>
<td>Usable for productivity apps</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<ol dir="auto">
<li><strong>Dual-core separation</strong>: CPU emulation and video rendering run independently</li>
<li><strong>Large instruction quantum</strong>: Fewer context switches = faster emulation</li>
<li><strong>Direct framebuffer access</strong>: No intermediate copies</li>
<li><strong>Optimized 4-pixel batch processing</strong>: Reduced loop overhead in scaling</li>
<li><strong>Polling-based interrupts</strong>: Safer than async timers for stability</li>
</ol>
<hr/>

<p dir="auto">Key build flags in <code>platformio.ini</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="build_flags =
    -O2                          # Optimize for speed
    -DEMULATED_68K=1             # Use 68k interpreter
    -DREAL_ADDRESSING=0          # Use memory banking
    -DROM_IS_WRITE_PROTECTED=1   # Protect ROM from writes
    -DFPU_IEEE=1                 # IEEE FPU emulation"><pre><span>build_flags</span> =
    -O2                          <span><span>#</span> Optimize for speed</span>
    -<span>DEMULATED_68K</span>=1             <span><span>#</span> Use 68k interpreter</span>
    -<span>DREAL_ADDRESSING</span>=0          <span><span>#</span> Use memory banking</span>
    -<span>DROM_IS_WRITE_PROTECTED</span>=1   <span><span>#</span> Protect ROM from writes</span>
    -<span>DFPU_IEEE</span>=1                 <span><span>#</span> IEEE FPU emulation</span></pre></div>
<hr/>


<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Problem</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#34;SD card initialization failed&#34;</td>
<td>Ensure SD card is FAT32, properly seated</td>
</tr>
<tr>
<td>&#34;Q650.ROM not found&#34;</td>
<td>Place ROM file in SD card root directory</td>
</tr>
<tr>
<td>Black screen after boot</td>
<td>Check serial output for errors; verify ROM compatibility</td>
</tr>
<tr>
<td>Touch not responding</td>
<td>Wait for boot GUI to complete initialization</td>
</tr>
<tr>
<td>USB keyboard not working</td>
<td>Connect to Type-A port (not Type-C)</td>
</tr>
<tr>
<td>Slow/choppy display</td>
<td>Normal; emulator runs at ~15 FPS</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>

<p dir="auto">Connect via USB-C and use:</p>

<p dir="auto">Look for initialization messages:</p>
<div data-snippet-clipboard-copy-content="========================================
  BasiliskII ESP32 - Macintosh Emulator
  Dual-Core Optimized Edition
========================================

[MAIN] Free heap: 473732 bytes
[MAIN] Free PSRAM: 31676812 bytes
[MAIN] Total PSRAM: 33554432 bytes
[MAIN] CPU Frequency: 360 MHz
[MAIN] Running on Core: 1
[PREFS] Loading preferences...
[PREFS] RAM: 16 MB
[PREFS] Disk: /Macintosh8.dsk (read-write)
[PREFS] CD-ROM: None
[PREFS] Preferences loaded
[SYS] SD card should already be initialized by main.cpp
[MAIN] Allocating 16777216 bytes for Mac RAM...
[MAIN] Mac RAM allocated at 0x481ca674 (16777216 bytes)
[MAIN] Loading ROM from: /Q650.ROM
[MAIN] ROM file size: 1048576 bytes"><pre><code>========================================
  BasiliskII ESP32 - Macintosh Emulator
  Dual-Core Optimized Edition
========================================

[MAIN] Free heap: 473732 bytes
[MAIN] Free PSRAM: 31676812 bytes
[MAIN] Total PSRAM: 33554432 bytes
[MAIN] CPU Frequency: 360 MHz
[MAIN] Running on Core: 1
[PREFS] Loading preferences...
[PREFS] RAM: 16 MB
[PREFS] Disk: /Macintosh8.dsk (read-write)
[PREFS] CD-ROM: None
[PREFS] Preferences loaded
[SYS] SD card should already be initialized by main.cpp
[MAIN] Allocating 16777216 bytes for Mac RAM...
[MAIN] Mac RAM allocated at 0x481ca674 (16777216 bytes)
[MAIN] Loading ROM from: /Q650.ROM
[MAIN] ROM file size: 1048576 bytes
</code></pre></div>
<hr/>

<ul dir="auto">
<li><strong>BasiliskII</strong> by Christian Bauer and contributors â€” the original open-source 68k Mac emulator</li>
<li><strong>UAE</strong> (Unix Amiga Emulator) â€” the CPU emulation core</li>
<li><strong><a href="https://shop.m5stack.com/products/m5stack-tab5-iot-development-kit-esp32-p4" rel="nofollow">M5Stack</a></strong> â€” for the excellent Tab5 hardware and M5Unified/M5GFX libraries</li>
<li><strong>EspUsbHost</strong> â€” USB HID support for ESP32</li>
<li><strong>Claude Opus 4.5</strong> (Anthropic) â€” AI pair programmer that made this port possible</li>
</ul>
<hr/>

<p dir="auto">This project is based on BasiliskII, which is licensed under the <strong>GNU General Public License v2</strong>.</p>
<hr/>
<p dir="auto"><em>This project was built with the assistance of <a href="https://anthropic.com" rel="nofollow">Claude Opus 4.5</a>. I am in no way smart enough to have done this on my own.</em> ğŸ¤–ğŸ</p>
<p dir="auto"><em>Run classic Mac OS in your pocket.</em></p>
</article></div></div>
  </body>
</html>
