<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.totaltypescript.com/rewriting-typescript-in-rust">Original</a>
    <h1>Rewriting TypeScript in Rust?</h1>
    
    <div id="readability-page-1" class="page"><div><p>For the last few months, Donny (or <a href="https://github.com/kdy1" target="_blank" rel="noopener noreferrer" title="Link opens in a new window">kdy1</a> on GitHub) has been walking a long, lonely road. The author of <a href="https://swc.rs">swc</a>, a native-speed replacement for <a href="https://babeljs.io/">Babel</a>, has his eyes on another goal: rewriting TypeScript in Rust.</p><p><a href="https://github.com/dudykr/stc"><code>stc</code></a> is his attempt. It&#39;s a drop-in replacement for <code>tsc</code> supporting &#34;all typing and type inference&#34;, including all the complexity of generics, conditional types and template literals.</p><h2 id="an-impossible-challenge">An Impossible Challenge</h2><p>In Donny&#39;s words, &#34;the official TypeScript type checker, <code>tsc</code>, is very slow&#34;. This means in VSCode, the red lines and warnings take a long time to update on large projects.</p><p>The main problem is that <code>tsc</code> is itself &#34;written in TypeScript - which does not support parallel processing&#34;. Rewriting <code>tsc</code> in a native language, like Rust, could speed it up immensely.</p><p>But there&#39;s a problem. Rewriting a library like TypeScript is extremely challenging. First, &#34;absence of [a] specification&#34; for TypeScript&#39;s behaviour. Donny&#39;s had to infer TypeScript&#39;s behaviour mostly test cases alone.</p><p>The pure size of TypeScript is daunting. It&#39;s had ten years to iterate, grow and add features. A glance at TypeScript&#39;s <a href="https://github.com/microsoft/TypeScript/blob/main/src/compiler/checker.ts">2.6MB <code>checker.ts</code> file</a> would be enough to frighten most away.</p><p>TypeScript&#39;s velocity is extraordinary. In Donny&#39;s words, it&#39;s &#34;way too fast&#34;. It&#39;s one of the most active open-source projects in the world. For a single developer to keep up with a huge team seems impossible.</p><p>But Donny is confident. &#34;I think there is no one else on the planet who can and will do it. [...] Many people do not have enough energy to investigate such long-term projects.&#34;</p><h3 id="is-open-source-working">Is Open Source Working?</h3><p>But the real killer is the state of open source. Donny doesn&#39;t know if his work will be rewarded. But he&#39;s seen it happen before. His work on swc landed him a job at Vercel.</p><p>&#34;Vercel wanted to make <a href="https://nextjs.org/">Next.js</a> fast, and swc was a perfect fit for them&#34;. Vercel are now the long-term stewards of swc - which is now an integral part of their bundler, <a href="https://turbo.build/pack">Turbopack</a>.</p><p>Donny sees problems with the sustainability of open source. &#34;I&#39;m sort of a lucky case. Many open-source maintainers are using enormous amounts of their own time without enough reward.&#34;</p><p>For Donny, the only source of sustainability is sponsorship from companies. &#34;Honestly, I&#39;m still not sure if open-source is sustainable without companies like Vercel.&#34;</p><p>But despite the possibility his work might not be rewarded, Donny persists. The project is &#34;too essential for the web development ecosystem&#34;.</p><p>It takes its toll. &#34;Although it&#39;s quite fun, it&#39;s super exhausting. [...] I stopped working on it several times.&#34;</p><p>But community contributions help. Donny is working on <code>stc</code> alone, apart from &#34;some short-time contributors&#34;. Financial backers help morale, too. The best place to contribute is <code>stc</code>&#39;s <a href="https://opencollective.com/stc">Open Collective</a>.</p><h3 id="the-future-of-stc">The Future of <code>stc</code></h3><p>To me, the project seems precarious. It&#39;s an enormous amount to ask from a single developer, even one with extraordinary abilities like Donny. TypeScript&#39;s velocity means the project is a long-term commitment.</p><p>Financial contributions could help keep the project sustainable. But a <a href="https://en.wikipedia.org/wiki/Tragedy_of_the_commons">&#34;Tragedy of the Commons&#34;</a> seems more likely - where the users of the project don&#39;t contribute back to its development.</p><p>Right now, <code>stc</code> is pre-alpha. Donny is working his way towards reducing erroneous errors, and getting feature-complete with TypeScript.</p><p>Personally, I can think of few projects more deserving of your support. You can:</p><ul><li><a href="https://opencollective.com/stc">Contribute to the Open Collective</a></li><li><a href="https://github.com/dudykr">Get involved on GitHub</a></li></ul><h2 id="full-interview">Full Interview</h2><p><strong>Matt</strong>: Let&#39;s start with the basics - what is stc? What problem is it trying to solve?</p><p><strong>Donny</strong>: <code>stc</code> stands for a Speedy TypeScript Type Checker. The goal is to improve DX by reducing build time and iteration time.</p><p>The official TypeScript type checker, <code>tsc</code>, is very slow because it&#39;s written in TypeScript - which does not support parallel processing.</p><p><strong>M</strong>: Why did you decide to start working on <code>stc</code>? Why you? Why now?</p><p><strong>D</strong>: I started it because I wanted to improve <a href="https://swc.rs/">swc</a>. It was actually a subproject of swc at the start.</p><p>I think there is no one else on the planet who can and will do it. I mean, it requires way too much effort. Many people do not have enough energy to investigate such long-term projects. But I have. I have seen my effort rewarding me back thanks to swc.</p><p>I open-sourced it recently because I thought I will be able to be rewarded via sponsorship in the future if there&#39;s enough company using it for everyday development.</p><p>Until recently, I couldn&#39;t think open-sourcing will compensate me back. Thanks to Vercel, I concluded I can.</p><p><strong>M</strong>: Right - were you hired at Vercel because of your work on swc?</p><p><strong>D</strong>: Yes, Vercel wanted to make Next.js fast, and swc was a perfect fit for them. They needed extensibility.</p><p><strong>M</strong>: But without Vercel, your work on swc might not have been rewarded? What do you think this says about the sustainability of open source?</p><p><strong>D</strong>: I could be rewarded by Deno, but I don&#39;t think it&#39;s the point. I think it was possible I couldn&#39;t get rewarded enough. And it means a Tragedy of the Commons for open-source. I&#39;m sort of a lucky case. Many open-source maintainers are using enormous amounts of their own time without enough reward.</p><p>Honestly, I&#39;m still not sure if open-source is sustainable without companies like Vercel.</p><p><strong>M</strong>: So despite that, you&#39;ve put a lot of effort into <code>stc</code> already (thank you). You&#39;re willing to keep pushing even though it might not be rewarded?</p><p><strong>D</strong>: I can&#39;t be 100% sure, but I think so. But I don&#39;t think I would develop <code>stc</code> as open-source if it was the case.</p><p>Rather, I would develop it as BUSL or closed source.</p><p><strong>M</strong>: Let&#39;s talk more about the technical details of the project. What have you found challenging so far? I&#39;d heard that you switched languages a couple of times.</p><p><strong>D</strong>: The most challenging thing is the absence of the specification. I had to infer everything just from test cases.</p><p>The second thing is the velocity of tsc. It&#39;s way too fast, and I was unsure if I could follow it up. So I decided to use semi-automated translation and selected Golang.</p><p>But it was too boring, and more importantly, my programming ability has improved enough to follow tsc only by myself.</p><p><strong>M</strong>: What are your goals with <code>stc</code>? Are you planning to support everything tsc can currently support, or only a subset?</p><p><strong>D</strong>: The former, but not exactly 100%. I don&#39;t like some design decisions of tsc, mainly about diagnostics. Error messages of tsc are too hard to understand, in my opinion.</p><p><strong>M</strong>: Definitely agree about the errors being hard to read. But you&#39;re planning to support advanced features like generics, conditional types, overloads etc?</p><p><strong>D</strong>: Yes, all typing and type inference should match 100%. All three features you mentioned are already implemented</p><p><strong>M</strong>: So in theory, you&#39;d be able to use <code>stc</code> as a drop-in replacement for tsc?</p><p><strong>D</strong>: Yes, exactly.</p><p><strong>M</strong>: How is progress going? What are you using to measure your progress?</p><p><strong>D</strong>: I&#39;m using stats of the conformance test suite from tsc:</p><p>This is the current stat. I&#39;m focusing on reducing <code>extra_error</code>.</p><p><strong>M</strong>: Are you able to estimate when it might be &#39;complete&#39;? I.e. when required_error and extra_error go to 0? Or would you plan to release an alpha earlier than that?</p><p><strong>D</strong>: I&#39;m not sure about the time when it is complete, but I&#39;ll release alpha with a language server when the extra_error goes to 0 I hope I can finish within... about 6 months, but I can&#39;t be sure. I mean alpha by &#39;finish&#39;</p><p><strong>M</strong>: Do you have any help on the project? Or so far, is it just you?</p><p><strong>D</strong>: Currently, it&#39;s only me, although there are some short-time contributors.</p><p><strong>M</strong>: What&#39;s the best way that the community can support you right now?</p><p><strong>D</strong>: As always, contributing developer time is the best. But honestly, I don&#39;t think it&#39;s possible, considering the difficulty of the project. And the second best contribution is a financial contribution, which helps me use almost all my free time for <code>stc</code>.</p><p><strong>M</strong>: Where&#39;s the best spot to give a financial contribution?</p><p><strong>D</strong>: Our <a href="https://opencollective.com/stc">open collective</a> is the best place.</p><p><strong>M</strong>: How does it <em>feel</em> right now to be working on the project? Doing something so difficult in your spare time must be extremely draining.</p><p>Yeah, honestly, it&#39;s quite exhausting. But today, I&#39;m quite motivated thanks to <a href="https://twitter.com/DCbuild3r/status/1596878223433994241">@DCbuild3r, who donated 0.5 ETH</a>. Although it&#39;s quite fun, it&#39;s super exhausting.</p><p><strong>M</strong>: It&#39;s great when the community gets involved. Do you think there&#39;s a danger that exhaustion could prevent the project from being completed?</p><p><strong>D</strong>: Yes, actually I stopped working on it several times.</p><p><strong>M</strong>: So it&#39;s a project which is exhausting, extremely complicated, possibly never-ending and could be without reward. Why do you keep going?</p><p><strong>D</strong>: There are several reasons.</p><ul><li>I trust Vercel</li><li>This is too essential for the web development ecosystem</li><li>I think I may get rewarded sometime in future</li></ul><p>—<span><span><img alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27154%27%20height=%2734%27/%3e"/></span><img alt="Matt&#39;s signature" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic"/></span></p></div></div>
  </body>
</html>
