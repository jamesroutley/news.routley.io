<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/facebookresearch/searchformer">Original</a>
    <h1>Searchformer: Beyond A* – Better planning with transformers via search dynamics</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Official code base for the paper titled <a href="https://arxiv.org/abs/2402.14083" rel="nofollow"><em>Beyond A*: Better Planning with Transformers via Search Dynamics Bootstrapping</em></a>.</p>
<p dir="auto">This repository contians code for accessing the generated datasets and trained models, re-producing the figures of the main paper, and the code used for running the presented experiments.</p>

<p dir="auto">All code is designed around storing and transforming datasets stored in a MongoDB instance.
The <a href="https://github.com/facebookresearch/searchformer/blob/main/notebook"><code>notebook</code></a> folder contains Jupyer notebooks with examples demonstrating how to access token dataset and prompting a trained Searchformer model.
This folder also contains notebooks that read data from MongoDB to generate all figures included in the main paper.</p>
<p dir="auto">The <code>searchformer</code> module contains all code used in the presented experiments.
Please refer to the documentation in the folder <a href="https://github.com/facebookresearch/searchformer/blob/main/doc"><code>doc</code></a> for using this module to train models, evaluate them, and generate training datasets.</p>

<p dir="auto">This code base uses <code>python=3.10</code>.
To run python code and the included Jupyer notebooks, a virtual environment can be created using the included <code>requirements.txt</code> file.
For example, this virtual environment can be created with</p>
<div data-snippet-clipboard-copy-content="$ python3.10 -m venv venv
$ source venv/bin/activate
(venv) $ pip install -r requirements.txt "><pre><code>$ python3.10 -m venv venv
$ source venv/bin/activate
(venv) $ pip install -r requirements.txt 
</code></pre></div>
<p dir="auto">For the code to run correctly, a MongoDB instance needs to be setup.
This code base is designed to work with <a href="https://www.mongodb.com/try/download/community" rel="nofollow">MongoDB Community Edition</a> and connects by default directly to <code>mongodb://localhost:27017/mongo</code> without any user authentication setup.
For example, to explore the included token datasets and checkpoints, a MonogDB instance could be installed locally in a laptop and this code base can be used to access a MongoDB instance running on <code>localhost</code>.
To direct the <code>searchformer</code> module to connect to a different MongoDB instance, the default MongoDB URI can be overwritten by setting the environment variable</p>
<div data-snippet-clipboard-copy-content="export MONGODB_URI=mongodb://localhost:27017/mongo"><pre><code>export MONGODB_URI=mongodb://localhost:27017/mongo
</code></pre></div>
<p dir="auto">before running any python code.
The code segment used for connecting to MongoDB can be found in <code>searchformer.utils</code> in function <code>mongodb_client</code>.</p>
<p dir="auto">To import the released datasets the command line tool <a href="https://www.mongodb.com/docs/database-tools/mongorestore/" rel="nofollow"><code>mongorestore</code></a> is used.
Instructions for downloading and installing MongoDB Database Tools can be found <a href="https://www.mongodb.com/docs/database-tools/" rel="nofollow">here</a>.</p>
<p dir="auto"><strong>As a convention, all commands are run from this repository&#39;s root directory and not from any sub-directory. The root directory is the directory that contains this README file.</strong></p>
<p dir="auto">For example, a correct setup of the python environment can be tested by running the following from the repositories root directory:</p>
<div data-snippet-clipboard-copy-content="$ python -m searchformer.train --help
Usage: python -m searchformer.train [OPTIONS] COMMAND [ARGS]...

Options:
  --help  Show this message and exit.

Commands:
  bulk-drop-run           Drop multiple training runs.
  bulk-export-checkpoint  Bulk export of all checkpoints into current...
  bulk-import-checkpoint  Bulk import checkpoints from directory.
  drop-run                Drop individual training run.
  export-checkpoint       Export a checkpoint stored in MongoDB to a file.
  import-checkpoint       Import a checkpoint into MongoDB from file.
  list-all                List all training runs.
  list-all-checkpoints    List all stored checkpoints.
  single                  Start single DDP training run.
  sweep                   Start single DDP training run with provided..."><pre><code>$ python -m searchformer.train --help
Usage: python -m searchformer.train [OPTIONS] COMMAND [ARGS]...

Options:
  --help  Show this message and exit.

Commands:
  bulk-drop-run           Drop multiple training runs.
  bulk-export-checkpoint  Bulk export of all checkpoints into current...
  bulk-import-checkpoint  Bulk import checkpoints from directory.
  drop-run                Drop individual training run.
  export-checkpoint       Export a checkpoint stored in MongoDB to a file.
  import-checkpoint       Import a checkpoint into MongoDB from file.
  list-all                List all training runs.
  list-all-checkpoints    List all stored checkpoints.
  single                  Start single DDP training run.
  sweep                   Start single DDP training run with provided...
</code></pre></div>

<p dir="auto">We have included Jupyter notebooks in the <a href="https://github.com/facebookresearch/searchformer/blob/main/notebook"><code>notebook</code></a> folder.
These notebooks contain instructions how to download and populate the MongoDB instance with our datasets and how to access the data.
The following notebooks are included:</p>
<ul dir="auto">
<li><code>notebook/ExampleLoadCheckpoint.ipynb</code>: Loading and prompting a search-augmented model with a 10x10 maze navigation task.</li>
<li><code>notebook/ExampleRolloutDatasets.ipynb</code>: Loading rollout datasets with the generated response sequences.</li>
<li><code>notebook/ExampleTokenDatasets.ipynb</code>: Loading token datasets used for training.</li>
<li><code>notebook/Maze.ipynb</code>: Generating all figures contained in the paper regarding any of the maze experiments.</li>
<li><code>notebook/PerfTable.ipynb</code>: Generating the table with the presented performance numbers.</li>
<li><code>notebook/Searchformer.ipynb</code>: Generating figures related to the Searchformer experiments.</li>
<li><code>notebook/SearchformerScatter.ipynb</code>: Generating scatter plot figure related to the Searchformer experiments.</li>
<li><code>notebook/TraceComparison.ipynb</code>: Generating box plots showing token sequence lengths for different datasets.</li>
</ul>
<p dir="auto">The <a href="https://github.com/facebookresearch/searchformer/blob/main/doc"><code>doc</code></a> folder contains documentation about the rest of the code base:</p>
<ul dir="auto">
<li><code>doc/train.md</code>: Outlines how to run the training loop for each model.</li>
<li><code>doc/rollout.md</code>: Outlines how to generate response sequence datasets using the trained checkpoints.</li>
<li><code>doc/trace_generation.md</code>: Outlines how to generate the used training data.</li>
<li><code>doc/sokoban.md</code>: We include a small example to play a Sokoban level from the training data interactively.</li>
<li><code>doc/mongodb.md</code>: Provides an overview of the included datasets with download links.</li>
<li><code>doc/checkpoint_index.csv</code>: Lists all included checkpoints with download links.</li>
</ul>

<p dir="auto">See the <a href="https://github.com/facebookresearch/searchformer/blob/main/LICENSE">LICENSE</a> file for details about the license under which this code is made available.</p>

<p dir="auto">If you find this repository useful in your research, please consider giving a star ⭐ and a citation</p>
<div data-snippet-clipboard-copy-content="@misc{lehnert2024beyondastar,
      title={Beyond A*: Better Planning with Transformers via Search Dynamics Bootstrapping}, 
      author={Lucas Lehnert and Sainbayar Sukhbaatar and DiJia Su and Qinqing Zheng and Paul Mcvay and Michael Rabbat and Yuandong Tian},
      year={2024},
      eprint={2402.14083},
      archivePrefix={arXiv},
      primaryClass={cs.AI}
}"><pre><code>@misc{lehnert2024beyondastar,
      title={Beyond A*: Better Planning with Transformers via Search Dynamics Bootstrapping}, 
      author={Lucas Lehnert and Sainbayar Sukhbaatar and DiJia Su and Qinqing Zheng and Paul Mcvay and Michael Rabbat and Yuandong Tian},
      year={2024},
      eprint={2402.14083},
      archivePrefix={arXiv},
      primaryClass={cs.AI}
}
</code></pre></div>
</article></div></div>
  </body>
</html>
