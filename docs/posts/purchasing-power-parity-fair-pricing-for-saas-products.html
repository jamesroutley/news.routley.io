<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://scastiel.dev/implement-ppp-fair-pricing-for-your-product">Original</a>
    <h1>Purchasing Power Parity: Fair pricing for SaaS products</h1>
    
    <div id="readability-page-1" class="page"><div><p>I released <a href="https://useeffect.dev/?ref=PostPPP">my course about React hooks</a> a couple of weeks ago. As with any SaaS product, I asked myself the usual question: what should be my product&#39;s price?</p>
<p>Economists would say that the right price should be when the offer curve crosses the demand one. But I‚Äôm not an economist, and this model seems to be valid for a given place (country), not when you sell something worldwide.</p>
<p>Using Purchasing Power Parity will help me solve this problem. After I explained what it is, I‚Äôll show you how I implemented it on my course‚Äôs selling page using serverless functions and a little bit of React.</p>
<h2>What is Purchasing Power Parity?</h2>
<p>At the core of the <a href="https://www.investopedia.com/updates/purchasing-power-parity-ppp/">Purchasing Power Parity</a> (PPP) is the following idea: a fair price in Switzerland will have no chance to convince anyone to buy in Somalia. It is an extreme example, but you get the idea.</p>
<p>And it isn‚Äôt new when you think about it: the same Spotify subscription doesn‚Äôt cost the same depending on where you are:</p>
<p><img src="https://scastiel.dev/posts/implement-ppp-fair-pricing-for-your-product/spotify_pricing.png" alt="In Denmark, a Spotify subscription costs $18, but less than $3 in Philippines. Source: Spotify Premium Index (2014)"/></p>
<p>And the reason for this difference is obvious: purchasing power is not the same across the world. Several indices exist to measure this phenomenon, the most famous in popular culture being the <a href="https://en.wikipedia.org/wiki/Big_Mac_Index">Big Mac Index</a>.</p>
<p>Big companies such as Spotify can adjust their pricing in every country they are in, but what about you with your SaaS? You don‚Äôt have headquarters in all countries, yet you sell your product worldwide.</p>
<p>To solve this problem, a tendency emerged these past few months: using PPP to offer your product at a lower price where the purchasing power is lower.</p>
<p>For instance, you can purchase my course at its base price of $50 (when I‚Äôm writing this post) in Switzerland or Denmark, $25 in Romania or Albania, and $5 in Somalia or Liberia.</p>
<p>To me, using PPP for your pricing has two advantages:</p>
<ul>
<li>it is <strong>fair</strong>: I want my course to be available to the most people, especially people who could use it to improve their economic situation by learning new skills;</li>
<li>it is <strong>profitable</strong>: even if low-PPP countries won‚Äôt be the ones bringing you the most significant revenue, it is still better than nothing, i.e., a pricing way too high for these countries.</li>
</ul>
<p><em>Note that I‚Äôm not yet able to confirm the second hypothesis for my case since I just released my course. And even then, confirming it would require an experimental system with a large sample.</em></p>
<p>Let‚Äôs say I convinced you to use PPP for your product‚Äôs pricing; how can you implement it?</p>
<h2>How to add PPP to your site?</h2>
<p>For the rest of this post, I‚Äôll suppose you have a product, and its selling page uses Stripe, React and serverless functions (e.g. with <a href="https://nextjs.org/">Next.js</a> or <a href="https://functions.netlify.com/">Netlify</a> functions).</p>
<p>It‚Äôs quite a big assumption, but it shouldn‚Äôt be too much trouble to use the principles to adapt them to your use case.</p>
<p>I created a small demo website to understand what it can look like when you offer purchasing power parity. <a href="https://github.com/scastiel/parity.coffee">Its source code is available on GitHub</a>, and it presents an implementation for the two first options I will describe here.</p>
<p><img src="https://scastiel.dev/posts/implement-ppp-fair-pricing-for-your-product/parity.coffee-screenshot.png" alt="parity.coffee: a demo site using PPP"/></p>
<p>For the payment with Stripe, I tried to be as close as possible to what they describe in <a href="https://stripe.com/docs/checkout/integration-builder">their documentation about accepting a payment</a>.</p>
<h3>Option #1: adjust the price automatically</h3>
<p>The first solution I tried on my course was to offer a price automatically inferred from the user‚Äôs country, using geolocation of their IP address.</p>
<p>This can be done using <a href="https://www.npmjs.com/package/request-ip"><code>request-ip</code></a> and <a href="https://www.npmjs.com/package/geoip-lite"><code>geoip-lite</code></a> packages with Node.js:</p>
<pre><code><span>async</span> <span>function</span> <span>getCountryForRequest</span>(<span>req</span>) {
  <span>try</span> {
    <span>const</span> clientIp = requestIp.<span>getClientIp</span>(req)
    <span>return</span> geoip.<span>lookup</span>(clientIp).<span>country</span> || <span>null</span>
  } <span>catch</span> (err) {
    <span>console</span>.<span>error</span>(err)
    <span>return</span> <span>null</span>
  }
}</code></pre>
<p>When you have the country, the next step is to get the <em>PPP conversion factor</em> for this country. I used an <a href="https://purchasing-power-parity.com">API</a> created by <a href="https://twitter.com/rwieruch">Robin Wieruch</a>. Still, you can also use any list you find on the Internet with countries associated with their PPP conversion factor (or any other index: Spotify subscription price, Big Mac index‚Ä¶)</p>
<pre><code><span>async</span> <span>function</span> <span>getConversionFactorForCountry</span>(<span>country</span>) {
  <span>try</span> {
    <span>const</span> url = <span>`https://api.purchasing-power-parity.com/?target=<span>${country}</span>`</span>
    <span>const</span> res = <span>await</span> <span>fetch</span>(url)
    <span>const</span> { ppp } = <span>await</span> res.<span>json</span>()
    <span>return</span> ppp.<span>pppConversionFactor</span>
  } <span>catch</span> (err) {
    <span>console</span>.<span>error</span>(err)
    <span>return</span> <span>1</span>
  }
}</code></pre>
<p>Last step: we use the conversion factor to calculate your product&#39;s price dynamically from the user‚Äôs request.</p>
<pre><code><span>import</span> { <span>BASE_PRICE</span> } <span>from</span> <span>&#39;../prices&#39;</span>



<span>async</span> <span>function</span> <span>getPriceFromRequest</span>(<span>req</span>) {
  <span>const</span> country = <span>await</span> <span>getCountryForRequest</span>(req)
  <span>const</span> pppConversionFactor =
    (country &amp;&amp; (<span>await</span> <span>getConversionFactorForCountry</span>(country))) || <span>1</span>
  <span>if</span> (pppConversionFactor &gt;= <span>1</span>) {
    
    
    <span>return</span> { <span>price</span>: <span>BASE_PRICE</span>, <span>discount</span>: <span>0</span>, country }
  }
  <span>const</span> price = <span>Math</span>.<span>round</span>(<span>BASE_PRICE</span> * pppConversionFactor)
  <span>const</span> discount = <span>Math</span>.<span>round</span>(<span>100</span> * (<span>1</span> - price / <span>BASE_PRICE</span>))
  <span>return</span> { price, discount, country }
}</code></pre>
<p>This function has to be called at least in two places:</p>
<ul>
<li>in an endpoint called to display the price on your page, and</li>
<li>in the endpoint used to create the checkout session.</li>
</ul>
<p>To display the price on my course page, I created an endpoint <code>/api/get-price</code>, with this function:</p>
<pre><code><span>async</span> <span>function</span> <span>getPrice</span>(<span>req, res</span>) {
  <span>const</span> { price, discount, country } = <span>await</span> <span>getPriceFromRequest</span>(req)
  res.<span>send</span>({ price, discount, country })
}</code></pre>
<p>Notice that I also return the discount (vs. the base price) and the country; they will be useful, as we‚Äôll see in a minute.</p>
<p>I call this endpoint in my component, using a combination of <code>useState</code> and <code>useEffect</code> hooks:</p>
<pre><code><span>const</span> [priceInfo, setPriceInfo] = <span>useState</span>(<span>null</span>)

<span>useEffect</span>(<span>() =&gt;</span> {
  <span>fetch</span>(<span>&#39;/api/get-price&#39;</span>)
    .<span>then</span>(<span>(<span>res</span>) =&gt;</span> res.<span>json</span>())
    .<span>then</span>(<span>(<span>priceInfo</span>) =&gt;</span> <span>setPriceInfo</span>(price))
    .<span>catch</span>(<span>(<span>err</span>) =&gt;</span> <span>console</span>.<span>error</span>(err))
}, [])</code></pre>
<p>I can then display this price in my page:</p>
<pre><code>&lt;span&gt;
  {priceInfo ? (
    
    <span><span>&lt;<span>span</span>&gt;</span>${(priceInfo / 100).toFixed(2)}<span>&lt;/<span>span</span>&gt;</span></span>
  ) : (
    <span><span>&lt;<span>span</span>&gt;</span>Loading‚Ä¶<span>&lt;/<span>span</span>&gt;</span></span>
  )}
&lt;/span&gt;</code></pre>
<p>I also asked the question (to myself and on Twitter): should I inform the user that they got a discount because of their location? And the answer I got (and it seems very wise) was <a href="https://twitter.com/scastiel/status/1360224976339664897">a big YES</a>.</p>
<p>So we can use the <code>country</code> and the <code>discount</code> returned by the endpoint to display a customized message:</p>
<pre><code>{
  priceInfo.<span>discount</span> &gt; <span>0</span> &amp;&amp; (
    <span><span>&lt;<span>p</span>&gt;</span>
      {countryEmoji} Hey! It looks like you are from {countryName}. We support
      Purchasing Power Parity so we automatically adjusted the price, adding a
      discount of {priceInfo.discount}%.
    <span>&lt;/<span>p</span>&gt;</span></span>
  )
}</code></pre>
<p><a href="https://github.com/scastiel/parity.coffee/blob/main/lib/country.js">Have a look here to know how to get the country name and emoji üòâ</a></p>
<p><img src="https://scastiel.dev/posts/implement-ppp-fair-pricing-for-your-product/message1.png" alt="Displaying a message to inform the user a discount was applied."/></p>
<p>Ok, the price is automatically adjusted on the page, but we still need to adjust it when the user goes to the checkout page on Stripe. To do this, we have to call our <code>getPriceFromRequest</code> function in the <code>create-checkout-session</code> endpoint used to <a href="https://stripe.com/docs/api/checkout/sessions/create">create the Stripe session</a>:</p>
<pre><code><span>export</span> <span>default</span> <span>async</span> <span>function</span> <span>createCheckoutSession</span>(<span>req, res</span>) {
  <span>const</span> { price } = <span>await</span> <span>getPriceFromRequest</span>(req)

  <span>const</span> session = <span>await</span> stripe.<span>checkout</span>.<span>sessions</span>.<span>create</span>({
    <span>payment_method_types</span>: [<span>&#39;card&#39;</span>],
    <span>line_items</span>: [
      {
        <span>price_data</span>: {
          <span>currency</span>: <span>&#39;usd&#39;</span>,
          <span>product_data</span>: { <span>name</span>: <span>&#39;One coffee&#39;</span> },
          <span>unit_amount</span>: price,
        },
        <span>quantity</span>: <span>1</span>,
      },
    ],
    <span>mode</span>: <span>&#39;payment&#39;</span>,
    <span>success_url</span>: <span>`<span>${process.env.DOMAIN}</span>?success=true`</span>,
    <span>cancel_url</span>: <span>`<span>${process.env.DOMAIN}</span>?cancel=true`</span>,
  })
  res.<span>json</span>({ <span>id</span>: session.<span>id</span> })
}</code></pre>
<p>With this solution, the discount is almost transparent for the user (we still display a message to inform them). They could almost believe that the price they see is the same as everyone sees.</p>
<p>When I thought about it, something didn‚Äôt feel perfect with this solution. I felt the discount would be more convincing if the user had to enter a code during the checkout, so I tested the second option.</p>
<h2>Option #2: offer a discount code</h2>
<p>This option‚Äôs implementation is not very different from the first one. First, we‚Äôll need the same functions <code>getCountryForRequest</code> and <code>getConversionFactorForCountry</code>. But, whereas in the previous implementation, we calculated the price using the conversion factor, this time, we‚Äôll infer a discount code from this factor.</p>
<p>The idea is to define that for a factor between 0.9 and 1 there will be a code, another one for factors between 0.8 and 0.9, etc. You can put this association in a database for instance, but for my case it was good enough to hardcode them:</p>
<pre><code><span>function</span> <span>getDiscountForConversionFactor</span>(<span>pppConversionFactor</span>) {
  <span>if</span> (pppConversionFactor &lt;= <span>0.1</span>) <span>return</span> { <span>code</span>: <span>&#39;CSVVSDVV&#39;</span>, <span>discount</span>: <span>90</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.2</span>) <span>return</span> { <span>code</span>: <span>&#39;LLSJDLWF&#39;</span>, <span>discount</span>: <span>80</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.3</span>) <span>return</span> { <span>code</span>: <span>&#39;KRUFLDLF&#39;</span>, <span>discount</span>: <span>70</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.4</span>) <span>return</span> { <span>code</span>: <span>&#39;PJLKHJHI&#39;</span>, <span>discount</span>: <span>60</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.5</span>) <span>return</span> { <span>code</span>: <span>&#39;AGEFDXSL&#39;</span>, <span>discount</span>: <span>50</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.6</span>) <span>return</span> { <span>code</span>: <span>&#39;FDJGFYLX&#39;</span>, <span>discount</span>: <span>40</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.7</span>) <span>return</span> { <span>code</span>: <span>&#39;SYSDJSMF&#39;</span>, <span>discount</span>: <span>30</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>0.8</span>) <span>return</span> { <span>code</span>: <span>&#39;WUEJCCFJ&#39;</span>, <span>discount</span>: <span>20</span> }
  <span>if</span> (pppConversionFactor &lt;= <span>1.0</span>) <span>return</span> { <span>code</span>: <span>&#39;DHFVUFKE&#39;</span>, <span>discount</span>: <span>10</span> }
  <span>return</span> { <span>code</span>: <span>null</span>, <span>discount</span>: <span>null</span> }
}</code></pre>
<p>Note that I offer a discount for countries with a PPP of 1 (but not higher). I think being offered a discount code is always well-perceived by visitors.</p>
<p>Of course, the codes you have here must exist for your Stripe product, and they must remain secret! (These are for <a href="https://parity.coffee">parity.coffee</a> and can be used freely üòâ.)</p>
<p>This time, you don‚Äôt have to fetch the price from an endpoint (it will be the same for everyone), but you have to fetch the user‚Äôs country&#39;s discount code.</p>
<pre><code><span>async</span> <span>function</span> <span>getPrice</span>(<span>req, res</span>) {
  <span>const</span> country = <span>await</span> <span>getCountryForRequest</span>(req)
  <span>const</span> pppConversionFactor =
    (country &amp;&amp; (<span>await</span> <span>getConversionFactorForCountry</span>(country))) || <span>1</span>
  <span>const</span> { discount, code } = <span>await</span> <span>getDiscountForConversionFactor</span>(
    pppConversionFactor
  )
  res.<span>send</span>({ discount, code, country })
}</code></pre>
<p>Same as before, let‚Äôs display a banner to inform the user that they can get a discount:</p>
<pre><code>{
  priceInfo.<span>discount</span> &gt; <span>0</span> &amp;&amp; (
    <span><span>&lt;<span>p</span>&gt;</span>
      {countryEmoji} Hey! It looks like you are from {countryName}. We support
      Purchasing Power Parity so if you need it, use code ‚Äú{priceInfo.code}‚Äù to
      get {priceInfo.discount}% off your purchase at checkout.
    <span>&lt;/<span>p</span>&gt;</span></span>
  )
}</code></pre>
<p><img src="https://scastiel.dev/posts/implement-ppp-fair-pricing-for-your-product/message2.png" alt="Displaying a message to inform the user they can get a discount."/></p>
<p>Regarding the Stripe checkout session creation endpoint, there is no need here to adjust anything, except making sure to allow the client to enter a discount code:</p>
<pre><code><span>export</span> <span>default</span> <span>async</span> <span>function</span> <span>createCheckoutSession</span>(<span>req, res</span>) {
  <span>const</span> session = <span>await</span> stripe.<span>checkout</span>.<span>sessions</span>.<span>create</span>({
    <span>payment_method_types</span>: [<span>&#39;card&#39;</span>],
    <span>line_items</span>: [
      
    ],
    <span>allow_promotion_codes</span>: <span>true</span>, 
    
  })
  res.<span>json</span>({ <span>id</span>: session.<span>id</span> })
}</code></pre>
<p>This option using discount codes is the one I currently use for my course. I can‚Äôt be sure it is better than the first one, neither will I ever be. But it makes more sense to me; plus, from what I‚Äôve seen, it is more used than the first one, so it‚Äôs a good indicator.</p>
<h2>Option #3: use an external service</h2>
<p>The third option is not really another one, as it is the same principle as the second one (using discount codes), the difference being that you use an external service.</p>
<p>I‚Äôve heard of two websites offering this service:</p>
<ul>
<li><a href="https://paritybar.com/">ParityBar</a> is a free website that will add a banner on your site informing the user that they can use a discount code (you configure your codes in their admin panel, and add them to Stripe too);</li>
<li><a href="https://www.exportator.com/">Exportator</a> offers roughly the same service, but as I can understand from their home page, it also offers premium features such as protection against VPNs, Stripe integration, and A/B testing.</li>
</ul>
<p>I haven‚Äôt used any of these solutions since I was interested in developing my custom solution (and as I am trying to convince you here, it is not too complicated). But I assume ParityBar and Exportator target people who don‚Äôt have the desire or skills to code. I can imagine how convenient it can be to integrate a one-line script on a WordPress website to get PPP!</p>
<h2>Which option should I choose?</h2>
<p>I presented three options, and of course, now you expect me to reveal the best one. I‚Äôm afraid there isn‚Äôt! As I said, I chose the second one for my course (using discount codes), but it‚Äôs more by instinct, and each solution has its advantages and drawbacks:</p>
<ul>
<li><strong><em>#1: Adjust the price automatically</em></strong>
<ul>
<li><strong>Advantages</strong>: almost transparent for the user. They don‚Äôt have anything to do to get the discount.</li>
<li><strong>Drawbacks</strong>: I fear that they don‚Äôt perceive that they get a discount. You have to code the price adjustment yourself.</li>
</ul>
</li>
<li><strong><em>#2: Offer a discount code</em></strong>
<ul>
<li><strong>Advantages</strong>: by entering the discount code, the user can choose to use it or not (not everyone does!).</li>
<li><strong>Drawbacks</strong>: you have to maintain your discount codes in Stripe. You still have to code yourself the logic to get the applicable discount code.</li>
</ul>
</li>
<li><strong><em>#3: Use an external service</em></strong>
<ul>
<li><strong>Advantages</strong>: you have nothing to code or maintain, just a script to add to your site. You can get premium features (protection against VPNs, integration with Stripe).</li>
<li><strong>Drawbacks</strong>: you don‚Äôt have control over the implementation. Premium features are not necessarily free.</li>
</ul>
</li>
</ul>
<p>I hope that with this exploration, you now have the elements to make your choice on how to use PPP to get fair pricing for your product.</p>
<p>On a personal note, I don‚Äôt have a lot of experience with serverless, and this small addition to my course selling page was also a fun exercise! I highly recommend you try it as well if you are in the same situation!</p>
<h2>Additional resources</h2>
<p>PPP is not a new concept, but I think it‚Äôs trending now, especially in the online course domain. As far as I know, <a href="https://twitter.com/wesbos">Wes Bos</a> was <a href="https://wesbos.com/tip/purchasing-power-parity">the first one to use it on his courses</a>, and I heard about it for the first time by <a href="https://twitter.com/zenorocha">Zeno Rocha</a> telling <a href="https://draculatheme.com/blog/purchasing-parity-power-plus-4-new-themes">he used it for his Dracula Pro theme</a>.</p>
<p><a href="https://twitter.com/julesmaregiano">Jules Maregiano</a>, creator of the Exportator service I mentioned earlier, published <a href="https://www.exportator.com/blog/7-excellent-javascript-courses-with-purchasing-power-parity-adapted-prices">a list with excellent JavaScript online courses using PPP</a> (I hope one day my course <a href="https://useeffect.dev/?ref=PostPPP">useEffect.dev</a> will be in such lists üòá).</p>
<p>If you want to know more about the theory behind PPP, the dedicated pages on <a href="https://www.investopedia.com/updates/purchasing-power-parity-ppp/">Investopedia</a> and <a href="https://en.wikipedia.org/wiki/Purchasing_power_parity">Wikipedia</a> contain a lot of information. I also appreciated the article <a href="https://www.thoughtco.com/guide-to-purchasing-power-parity-theory-1146305">A Guide to the Purchasing Power Parity Theory</a> on ThoughtCo.</p>
<p><em>Cover photo by <a href="https://unsplash.com/@jkozoski">Juliana Kozoski</a>.</em></p>
</div></div>
  </body>
</html>
