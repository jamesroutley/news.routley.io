<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/antiwork/gumroad">Original</a>
    <h1>Gumroad’s source is available</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
  <themed-picture data-catalyst-inline="true"><picture>
    <source srcset="https://camo.githubusercontent.com/3a5cb2029c58e3895921810e1ed8be6a7ffa782ae61e94b118da9fd25408d60d/68747470733a2f2f7075626c69632d66696c65732e67756d726f61642e636f6d2f6c6f676f2f67756d726f61642d6461726b2e737667" media="(prefers-color-scheme: dark)" data-canonical-src="https://public-files.gumroad.com/logo/gumroad-dark.svg"/>
    <source srcset="https://camo.githubusercontent.com/869e8363f1e1d1b718953613a8eb9d2509e838b645a6b07ef4a4be5860191bbd/68747470733a2f2f7075626c69632d66696c65732e67756d726f61642e636f6d2f6c6f676f2f67756d726f61642e737667" media="(prefers-color-scheme: light)" data-canonical-src="https://public-files.gumroad.com/logo/gumroad.svg"/>
    <img src="https://camo.githubusercontent.com/869e8363f1e1d1b718953613a8eb9d2509e838b645a6b07ef4a4be5860191bbd/68747470733a2f2f7075626c69632d66696c65732e67756d726f61642e636f6d2f6c6f676f2f67756d726f61642e737667" height="100" alt="Gumroad logo" data-canonical-src="https://public-files.gumroad.com/logo/gumroad.svg"/>
  </picture></themed-picture>
</p>
<p dir="auto">
  <strong>Sell your stuff. See what sticks.</strong>
</p>
<p dir="auto">
  <a href="https://github.com/antiwork/gumroad/blob/main/LICENSE.md">License</a> •
  <a href="https://github.com/antiwork/gumroad/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a> •
  <a href="https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md">Contributing</a>
</p>

<ul dir="auto">
<li><a href="#getting-started">Getting Started</a>
<ul dir="auto">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#running-locally">Running Locally</a></li>
</ul>
</li>
<li><a href="#development">Development</a>
<ul dir="auto">
<li><a href="#logging-in">Logging in</a></li>
<li><a href="#resetting-elasticsearch-indices">Resetting Elasticsearch indices</a></li>
<li><a href="#push-notifications">Push Notifications</a></li>
<li><a href="#common-development-tasks">Common Development Tasks</a></li>
<li><a href="#linting">Linting</a></li>
</ul>
</li>
</ul>


<p dir="auto">Before you begin, ensure you have the following installed:</p>

<ul dir="auto">
<li><a href="https://www.ruby-lang.org/en/documentation/installation/" rel="nofollow">https://www.ruby-lang.org/en/documentation/installation/</a></li>
<li>Install the version listed in <a href="https://github.com/antiwork/gumroad/blob/main/.ruby-version">the .ruby-version file</a></li>
</ul>

<ul dir="auto">
<li><a href="https://nodejs.org/en/download" rel="nofollow">https://nodejs.org/en/download</a></li>
</ul>

<p dir="auto">We use <code>docker</code> and <code>docker compose</code> to setup the services for development environment.</p>
<ul dir="auto">
<li>For MacOS: Grab the docker mac installation from the <a href="https://www.docker.com/products/docker-desktop" rel="nofollow">Docker website</a></li>
<li>For Linux:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="sudo wget -qO- https://get.docker.com/ | sh
sudo usermod -aG docker $(whoami)"><pre>sudo wget -qO- https://get.docker.com/ <span>|</span> sh
sudo usermod -aG docker <span><span>$(</span>whoami<span>)</span></span></pre></div>

<p dir="auto">Install a local version of MySQL 8.0.x to match the version running in production.</p>
<p dir="auto">The local version of MySQL is a dependency of the Ruby <code>mysql2</code> gem. You do not need to start an instance of the MySQL service locally. The app will connect to a MySQL instance running in the Docker container.</p>
<ul dir="auto">
<li>For MacOS:</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="brew install mysql@8.0 percona-toolkit
brew link --force mysql@8.0

# to use Homebrew&#39;s `openssl`:
brew install openssl
bundle config --global build.mysql2 --with-opt-dir=&#34;$(brew --prefix openssl)&#34;

# ensure MySQL is not running as a service
brew services stop mysql@8.0"><pre>brew install mysql@8.0 percona-toolkit
brew link --force mysql@8.0

<span><span>#</span> to use Homebrew&#39;s `openssl`:</span>
brew install openssl
bundle config --global build.mysql2 --with-opt-dir=<span><span>&#34;</span><span><span>$(</span>brew --prefix openssl<span>)</span></span><span>&#34;</span></span>

<span><span>#</span> ensure MySQL is not running as a service</span>
brew services stop mysql@8.0</pre></div>
<ul dir="auto">
<li>For Linux:
<ul dir="auto">
<li>MySQL:
<ul dir="auto">
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/linux-installation.html" rel="nofollow">https://dev.mysql.com/doc/refman/8.0/en/linux-installation.html</a></li>
<li><code>apt install libmysqlclient-dev</code></li>
</ul>
</li>
<li>Percona Toolkit: <a href="https://www.percona.com/doc/percona-toolkit/LATEST/installation.html" rel="nofollow">https://www.percona.com/doc/percona-toolkit/LATEST/installation.html</a></li>
</ul>
</li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">Image Processing Libraries</h4><a id="user-content-image-processing-libraries" aria-label="Permalink: Image Processing Libraries" href="#image-processing-libraries"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<p dir="auto">We use <code>imagemagick</code> for preview editing.</p>
<ul dir="auto">
<li>For MacOS: <code>brew install imagemagick</code></li>
<li>For Linux: <code>sudo apt-get install imagemagick</code></li>
</ul>

<p dir="auto">For newer image formats we use <code>libvips</code> for image processing with ActiveStorage.</p>
<ul dir="auto">
<li>For MacOS: <code>brew install libvips</code></li>
<li>For Linux: <code>sudo apt-get install libvips-dev</code></li>
</ul>

<p dir="auto">We use <code>ffprobe</code> that comes with <code>FFmpeg</code> package to fetch metadata from video files.</p>
<ul dir="auto">
<li>For MacOS: <code>brew install ffmpeg</code></li>
<li>For Linux: <code>sudo apt-get install ffmpeg</code></li>
</ul>

<p dir="auto">We use <a href="https://www.pdflabs.com/tools/pdftk-server/" rel="nofollow">pdftk</a> to stamp PDF files with the Gumroad logo and the buyers&#39; emails.</p>
<ul dir="auto">
<li>For MacOS: Download from <a href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/pdftk_server-2.02-mac_osx-10.11-setup.pkg" rel="nofollow">here</a></li>
<li>For Linux: <code>sudo apt-get install pdftk</code></li>
</ul>


<p dir="auto">We use Bundler to install Ruby gems.</p>

<p dir="auto">If you have a license for Sidekiq Pro, configure its credentials:</p>
<div dir="auto" data-snippet-clipboard-copy-content="bundle config gems.contribsys.com &lt;key&gt;"><pre>bundle config gems.contribsys.com <span>&lt;</span>key<span>&gt;</span></pre></div>
<p dir="auto">If you don&#39;t have a license for Sidekiq Pro, set the environment variable <code>GUMROAD_SIDEKIQ_PRO_DISABLED</code> in your shell:</p>
<div dir="auto" data-snippet-clipboard-copy-content="export GUMROAD_SIDEKIQ_PRO_DISABLED=true
echo &#34;export GUMROAD_SIDEKIQ_PRO_DISABLED=true&#34; &gt;&gt; ~/.bashrc"><pre><span>export</span> GUMROAD_SIDEKIQ_PRO_DISABLED=true
<span>echo</span> <span><span>&#34;</span>export GUMROAD_SIDEKIQ_PRO_DISABLED=true<span>&#34;</span></span> <span>&gt;&gt;</span> <span>~</span>/.bashrc</pre></div>
<p dir="auto">Run <code>bundle install</code> to install the necessary dependencies.</p>
<p dir="auto">Also make sure to install <code>dotenv</code> as it is required for some console commands:</p>

<div dir="auto"><h4 tabindex="-1" dir="auto">npm and Node.js dependencies</h4><a id="user-content-npm-and-nodejs-dependencies" aria-label="Permalink: npm and Node.js dependencies" href="#npm-and-nodejs-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Make sure the correct version of <code>npm</code> is enabled:</p>

<p dir="auto">Install dependencies:</p>



<p dir="auto">App can be booted without any custom credentials. But if you would like to use services that require custom credentials (e.g. S3, Stripe, Resend, etc.), you can copy the <code>.env.example</code> file to <code>.env</code> and fill in the values.</p>

<ol dir="auto">
<li>Install mkcert on macOS:</li>
</ol>

<p dir="auto">For other operating systems, see <a href="https://github.com/FiloSottile/mkcert?tab=readme-ov-file#installation">mkcert installation instructions</a>.</p>
<ol start="2" dir="auto">
<li>Generate certificates by running:</li>
</ol>
<div dir="auto" data-snippet-clipboard-copy-content="bin/generate_ssl_certificates"><pre>bin/generate_ssl_certificates</pre></div>


<p dir="auto">If you installed Docker Desktop (on a Mac or Windows machine), you can run the following command to start the Docker services:</p>

<p dir="auto">If you are on Linux, or installed Docker via a package manager on a mac, you may have to manually give docker superuser access to open ports 80 and 443. To do that, use <code>sudo make local</code> instead.</p>
<p dir="auto">This command will not terminate. You run this in one tab and start the application in another tab.
If you want to run Docker services in the background, use <code>LOCAL_DETACHED=true make local</code> instead.</p>


<p dir="auto">For Linux (Debian / Ubuntu) you might need the following:</p>
<ul dir="auto">
<li><code>apt install libxslt-dev libxml2-dev</code></li>
</ul>


<p dir="auto">This starts the rails server, the javascript build system, and a Sidekiq worker.</p>
<p dir="auto">If you know what foreman does and you don&#39;t want to use it you can inspect the contents of the <code>Procfile.dev</code> file and run the required components individually.</p>
<p dir="auto">You can now access the application at <code>https://gumroad.dev</code>.</p>


<p dir="auto">You can log in with the username <code>seller@gumroad.com</code> and the password <code>password</code>. The two-factor authentication code is <code>000000</code>.</p>
<p dir="auto">Read more about logging in as a user with a different team role at <a href="https://github.com/antiwork/gumroad/blob/main/docs/users.md">Users &amp; authentication</a>.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Resetting Elasticsearch indices</h3><a id="user-content-resetting-elasticsearch-indices" aria-label="Permalink: Resetting Elasticsearch indices" href="#resetting-elasticsearch-indices"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">You will need to explicitly reindex Elasticsearch to populate the indices after setup, otherwise you will see <code>index_not_found_exception</code> errors when you visit the dev application. You can reset them using:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Run this in a rails console:
DevTools.delete_all_indices_and_reindex_all"><pre><span># Run this in a rails console:</span>
<span>DevTools</span><span>.</span><span>delete_all_indices_and_reindex_all</span></pre></div>

<p dir="auto">To send push notifications:</p>
<div dir="auto" data-snippet-clipboard-copy-content="INITIALIZE_RPUSH_APPS=true bundle exec rpush start -e development -f"><pre>INITIALIZE_RPUSH_APPS=true bundle <span>exec</span> rpush start -e development -f</pre></div>






<p dir="auto">We use ESLint for JS, and Rubocop for Ruby. Your editor should support displaying and fixing issues reported by these inline, and CI will automatically check and fix (if possible) these.</p>
<p dir="auto">If you&#39;d like, you can run <code>git config --local core.hooksPath .githooks</code> to check for these locally when committing.</p>
</article></div></div>
  </body>
</html>
