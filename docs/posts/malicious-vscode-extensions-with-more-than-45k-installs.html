<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.checkpoint.com/securing-the-cloud/malicious-vscode-extensions-with-more-than-45k-downloads-steal-pii-and-enable-backdoors/">Original</a>
    <h1>Malicious VSCode extensions with more than 45k installs</h1>
    
    <div id="readability-page-1" class="page"><div>
                                                <p><strong>Highlights:</strong></p>
<ol>
<li><strong>CloudGuard Spectral detected malicious extensions on the VSCode marketplace</strong></li>
<li><strong>Users installing these extensions were enabling attackers to steal PII records and to set remote shell to their machines</strong></li>
<li><strong>Once detected, we’ve alerted VSCode on these extensions. Soon after notification, they were removed by the VSCode marketplace team.</strong></li>
</ol>
<p>VSCode (short for Visual Studio Code) is a popular and free source code editor developed by Microsoft. It’s an efficient and customizable coding environment that can support a wide range of programming languages, frameworks, and tools. VSCode has gained much popularity in recent years and has become one of developers’ most popular code editors. One of the main reasons is the <a href="https://marketplace.visualstudio.com/vscode">VSCode Extensions Marketplace</a>, a central hub where developers can discover and install new extensions to enhance their coding experience. The marketplace includes official Microsoft and third-party extensions developed by the community.</p>
<p>As for today, the marketplace includes around 50k extensions. The VSCode extensions are add-ons that can be installed to upgrade the functionality of the editor. They can be used to add new features, support new programming languages, integrate with external tools and services, and more. Malicious extensions can pose a security risk to users by installing malware, stealing user data, or performing other harmful actions.</p>
<p>To prevent the distribution of malicious extensions, <a href="https://code.visualstudio.com/docs/editor/extension-marketplace#_can-i-trust-extensions-from-the-marketplace">Microsoft has implemented several security measures</a> for the VSCode Extensions Marketplace, such as automatic extension scanning tools to detect and remove malicious extensions from the marketplace and user reviews and ratings to identify and report malicious extensions. Until this day, almost no malicious extensions were published to be detected on the VSCode marketplace.</p>
<p>Threat actors keep searching for new ways to infect users, and open-source code components can be a common source for infections—especially the more common ones. As such, we’ve decided to investigate VSCode extensions in search of malicious ones.</p>
<p>As part of our analysis, we found and disclosed a few malicious extensions to the VSCode team with a total count of more than 45K installs. We’ve also found extensions with suspicious code patterns but no clear malicious indicators. Once detected, we disclosed our findings to the VSCode team, and the extensions were removed.</p>
<p>These continued findings highlight the need to verify every open-source component, not just assume it will be ok. We have included details regarding our specific findings below.</p>
<div id="attachment_244288"><p><img aria-describedby="caption-attachment-244288" decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1.png" alt="" width="1380" height="543" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1.png 1380w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1-300x118.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1-1024x403.png 1024w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1-768x302.png 768w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1-400x157.png 400w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs1-1320x519.png 1320w" sizes="(max-width: 1380px) 100vw, 1380px"/></p><p id="caption-attachment-244288">The VSCode extensions marketplace</p></div>

<h2>Malicious Extensions with more than 45,000 Installs</h2>
<p><strong>Prettiest java</strong></p>
<p>The first extension to mention was named ‘prettiest java.’ Based on its short description, it was supposed to be a ‘java helper,’ probably a simple <a href="https://en.wikipedia.org/wiki/Cybersquatting">name-squatting</a>, trying to fool users by mimicking the popular <a href="https://github.com/jhipster/prettier-java">Prettier-Java</a> code formatter project.  Looking into the extension code, we could witness a classic PII stealer code, <a href="https://research.checkpoint.com/2022/cloudguard-spectral-detects-several-malicious-packages-on-pypi-the-official-software-repository-for-python-developers/">quite common on the PyPI distribution</a>, searching for local secrets and sending them to the attacker using a Discord webhook.</p>
<div id="attachment_244289"><p><img aria-describedby="caption-attachment-244289" decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs2.png" alt="" width="517" height="224" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs2.png 517w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs2-300x130.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs2-400x173.png 400w" sizes="(max-width: 517px) 100vw, 517px"/></p><p id="caption-attachment-244289">The extension description from the VSCode marketplace</p></div>
<p><img decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy.png" alt="" width="1685" height="514" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy.png 1685w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy-300x92.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy-1024x312.png 1024w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy-768x234.png 768w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy-1536x469.png 1536w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy-400x122.png 400w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.44.04-copy-1320x403.png 1320w" sizes="(max-width: 1685px) 100vw, 1685px"/></p>
<p><strong>Theme Darcula dark</strong></p>
<p>The next extension to mention was named ‘Theme Darcula dark,’ based on its description, it was supposed to be <em>‘an attempt to improve Dracula colors consistency on VS Code, making it more pleasant to the eyes during coding sessions.’</em> This extension was interesting for two reasons; first, it was quite popular, with more than 45k installs. The second is the malicious code contained within. While the extension was supposed to be a simple theme configuration (no code should be included), it had a simple PII stealer code, which is quite common among NPM malicious packages, sending much metadata regarding the installer settings to a remote machine. Code that shouldn’t exist, especially for allegedly editor theme.</p>
<p><img decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-02-at-12.02.44-copy.jpg" alt="" width="1012" height="386" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-02-at-12.02.44-copy.jpg 1012w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-02-at-12.02.44-copy-300x114.jpg 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-02-at-12.02.44-copy-768x293.jpg 768w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-02-at-12.02.44-copy-400x153.jpg 400w" sizes="(max-width: 1012px) 100vw, 1012px"/></p>
<p><img decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.54.54-copy-1.png" alt="" width="580" height="766" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.54.54-copy-1.png 580w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.54.54-copy-1-227x300.png 227w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-9.54.54-copy-1-400x528.png 400w" sizes="(max-width: 580px) 100vw, 580px"/></p>
<p><strong>Python-vscode</strong></p>
<p>The last malicious extension was named ‘python-vscode.’ While the extension didn’t have a description (and therefore, most users shouldn’t even be aware of or pay attention to), witnessing its relatively high installs count indicates it managed to attract VSCode users to download and install it–effectively infecting those installers. An explanation for that is the extension naming, which can fool users into assuming it is a Python development VSCode enabler. Looking into the extension code, we faced an obfuscated statement being injected into the installer machine. Interestingly, this code was a common C# shell injector code pattern.</p>
<div id="attachment_244293"><p><img aria-describedby="caption-attachment-244293" decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs6.png" alt="" width="602" height="244" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs6.png 602w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs6-300x122.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs6-600x244.png 600w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs6-400x162.png 400w" sizes="(max-width: 602px) 100vw, 602px"/></p><p id="caption-attachment-244293">The extension description from the VSCode marketplace</p></div>
<div id="attachment_244294"><p><img aria-describedby="caption-attachment-244294" decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs7.png" alt="" width="602" height="437" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs7.png 602w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs7-300x218.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs7-600x437.png 600w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs7-400x290.png 400w" sizes="(max-width: 602px) 100vw, 602px"/></p><p id="caption-attachment-244294">Snippet from the extension main .js code, injecting obfuscated C# code</p></div>
<div id="attachment_244297"><p><img aria-describedby="caption-attachment-244297" decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs.png" alt="" width="602" height="440" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/vs.png 602w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs-300x219.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs-600x440.png 600w, https://blog.checkpoint.com/wp-content/uploads/2023/05/vs-400x292.png 400w" sizes="(max-width: 602px) 100vw, 602px"/></p><p id="caption-attachment-244297">Probably the reference malicious code, found on Github</p></div>
<p><strong>Suspicious but not clearly malicious</strong></p>
<p>As part of our analysis, we came across multiple cases where extensions were using suspicious code patterns but, at the same time, weren’t clearly malicious. The more notable cases were those using private registries to install from the required packages (instead of NPM, which can be a way to sneak in malicious packages silently) and those downloading resources from general IP addresses. Both can be theoretically abused to infect installers but currently don’t seem to include clear evidence that this is the case.</p>
<p><img decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.40.54-copy.png" alt="" width="782" height="99" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.40.54-copy.png 782w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.40.54-copy-300x38.png 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.40.54-copy-768x97.png 768w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.40.54-copy-400x51.png 400w" sizes="(max-width: 782px) 100vw, 782px"/></p>
<p><img decoding="async" loading="lazy" src="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.42.45-copy.jpg" alt="" width="664" height="230" srcset="https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.42.45-copy.jpg 664w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.42.45-copy-300x104.jpg 300w, https://blog.checkpoint.com/wp-content/uploads/2023/05/Screen-Shot-2023-05-15-at-10.42.45-copy-400x139.jpg 400w" sizes="(max-width: 664px) 100vw, 664px"/></p>
<p><strong>Disclosure</strong></p>
<p>We disclosed the malicious extensions to VSCode, and soon after, the VSCode marketplace team removed them.</p>
<p><strong>Disclosure – timeline</strong></p>
<p>May 4<sup>th</sup>, 2023 – disclosure submitted to VSCode</p>
<p>May 8<sup>th</sup>, 2023 – VSCode team acknowledged the submission</p>
<p>May 14<sup>th</sup>, 2023 – malicious extensions were removed from the VSCode marketplace</p>
<p><strong>An increasing risk</strong></p>
<p>It’s important to emphasize that the malicious extensions we’ve found are not new; most of them are even more than a year old. This fact highlights again the open-source components risk; no one guarantees that the open sources we use are benign, and it’s our responsibility to verify them.</p>
<p>Supply chain attacks are becoming more frequent. Therefore, it’s essential to ensure we’re kept safe, and to double-check every software ingredient we use, especially those we didn’t create. At Check Point, we aim to generate a secure development process to ensure developers do the right things (security-wise). As part of this effort, <a href="https://spectralops.io/">CloudGuard Spectral</a> constantly scans <a href="https://research.checkpoint.com/2022/check-point-cloudguard-spectral-exposes-new-obfuscation-techniques-for-malicious-packages-on-pypi/">PyPI</a> and <a href="https://blog.checkpoint.com/2023/02/14/check-point-cloudguard-spectral-detects-malicious-crypto-mining-packages-on-npm-the-leading-registry-for-javascript-open-source-packages/">NPM</a> for malicious packages to <a href="https://www.youtube.com/watch?v=cfEeA8cQ2ds">prevent supply chain attack risks</a>—keeping your code clean, applications safe, and malicious actors out.</p>
                                            </div></div>
  </body>
</html>
