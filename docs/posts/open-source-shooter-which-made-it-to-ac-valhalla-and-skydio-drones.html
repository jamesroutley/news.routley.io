<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/TeamHypersomnia/Hypersomnia">Original</a>
    <h1>Show HN: Open-source shooter which made it to AC: Valhalla and Skydio drones</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<div dir="auto">
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/238876321-8ccf0d22-317d-459d-8c19-3b4830968545.png"><img src="https://user-images.githubusercontent.com/3588717/238876321-8ccf0d22-317d-459d-8c19-3b4830968545.png" alt="image"/></a></p>
<p dir="auto"><a href="https://ci.appveyor.com/project/geneotech/Hypersomnia" rel="nofollow"><img src="https://camo.githubusercontent.com/f2e311a68a0d167560a6d38484c754fa5e7f63256260f30578d4be08f273f3b5/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f3561617477787638686365616f7035363f7376673d74727565" alt="Appveyor Build Status" data-canonical-src="https://ci.appveyor.com/api/projects/status/5aatwxv8hceaop56?svg=true"/></a>
<a href="https://github.com/TeamHypersomnia/Hypersomnia/actions"><img src="https://github.com/TeamHypersomnia/Hypersomnia/workflows/Linux%20build/badge.svg" alt="Build Status"/></a>
<a href="https://github.com/TeamHypersomnia/Hypersomnia/actions"><img src="https://github.com/TeamHypersomnia/Hypersomnia/workflows/MacOS%20build/badge.svg" alt="Build MacOS binary"/></a>
<a href="https://www.gnu.org/licenses/agpl-3.0" rel="nofollow"><img src="https://camo.githubusercontent.com/faeb2e1f7989d04a1625340e6880f3484cc58401791e73b5e698913943d24e8c/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4147504c25323076332d626c75652e737667" alt="License: AGPL v3" data-canonical-src="https://img.shields.io/badge/License-AGPL%20v3-blue.svg"/></a>
<a href="https://discord.gg/YC49E4G" rel="nofollow"><img src="https://camo.githubusercontent.com/c2a1421026f888a9d032986d7287fa1dd8d78624a33e6ea781fedb7d8af21f95/68747470733a2f2f646973636f72646170702e636f6d2f6170692f6775696c64732f3238343436343734343431313433303931322f656d6265642e706e67" data-canonical-src="https://discordapp.com/api/guilds/284464744411430912/embed.png"/></a></p>
<p dir="auto">An online shooter with relentless dynamics.</p>
<p dir="auto">Written in modern C++, without a game engine!
Forever free and open-source <g-emoji alias="heart" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/2764.png">❤️</g-emoji></p>

<p dir="auto"><a href="https://hypersomnia.xyz/builds/latest/Hypersomnia-for-Windows.zip" rel="nofollow"> <img src="https://camo.githubusercontent.com/38649e66ea5fcc282fca5948d4f3241207ec527b77795198961d5d2111fbfc2c/68747470733a2f2f6879706572736f6d6e69612e78797a2f696d616765732f77696e646f77735f69636f6e2e737667" height="70" data-canonical-src="https://hypersomnia.xyz/images/windows_icon.svg"/> </a>
<a href="https://hypersomnia.xyz/builds/latest/Hypersomnia-for-Linux.tar.gz" rel="nofollow"> <img src="https://camo.githubusercontent.com/f909d50a8b7bfefc8f993a2d3500cc2e4c41210b3cd071c7e9e5c819d7c2a650/68747470733a2f2f6879706572736f6d6e69612e78797a2f696d616765732f6c696e75785f69636f6e2e737667" height="70" data-canonical-src="https://hypersomnia.xyz/images/linux_icon.svg"/> </a>
<a href="https://hypersomnia.xyz/builds/latest/Hypersomnia-for-MacOS.dmg" rel="nofollow"> <img src="https://camo.githubusercontent.com/1ead37bab21734da191c274031a552ee6bebc0267a86016369dd09b432c59d37/68747470733a2f2f75706c6f61642e77696b696d656469612e6f72672f77696b6970656469612f636f6d6d6f6e732f322f32322f4d61634f535f6c6f676f5f253238323031372532392e737667" height="70" data-canonical-src="https://upload.wikimedia.org/wikipedia/commons/2/22/MacOS_logo_%282017%29.svg"/> </a>
<br/></p>
<p dir="auto">Only 25 MB!</p>
<p dir="auto"><em>Archives are <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/signing_keys.h">digitally signed.</a> You can <a href="https://hypersomnia.xyz/builds/latest/" rel="nofollow">verify signatures.</a></em></p>

<p dir="auto"><a href="https://www.youtube.com/watch?v=CHLPzZqANlM" title="Video Title" rel="nofollow"><img src="https://camo.githubusercontent.com/4d3adca8b88b2177a58f8631ce26aa864215ffc5b437a994345ea912f180432d/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f43484c507a5a71414e6c4d2f302e6a7067" alt="IMAGE ALT TEXT" data-canonical-src="https://img.youtube.com/vi/CHLPzZqANlM/0.jpg"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-latest-developer-journals" aria-hidden="true" href="#latest-developer-journals"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Latest developer journals</h2>
<p dir="auto"><a href="https://www.youtube.com/watch?v=Nlh_dyd_V7w" title="Video Title" rel="nofollow"><img src="https://camo.githubusercontent.com/5082133c3c6d8cc4d0da1a7afb04b51a424158120ff5a473a729379346767c2b/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f4e6c685f6479645f5637772f302e6a7067" alt="IMAGE ALT TEXT" data-canonical-src="https://img.youtube.com/vi/Nlh_dyd_V7w/0.jpg"/></a></p>
<p dir="auto"><a href="https://www.youtube.com/watch?v=URWjNtUArDo" title="Video Title" rel="nofollow"><img src="https://camo.githubusercontent.com/fe1ede66c1606f144dcd2c03516d874cdeaf9c692748168e606dd7453d02c489/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f5552576a4e74554172446f2f302e6a7067" alt="IMAGE ALT TEXT" data-canonical-src="https://img.youtube.com/vi/URWjNtUArDo/0.jpg"/></a></p>
</div>

<ul dir="auto">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#tech-highlights">Tech highlights</a></li>
<li><a href="#background">Background</a></li>
<li><a href="#quick-gameplay-instructions">Quick gameplay instructions</a></li>
<li><a href="#how-to-build">How to build</a>
<ul dir="auto">
<li><a href="#windows-instructions">Windows instructions</a></li>
<li><a href="#linux-instructions">Linux instructions</a>
<ul dir="auto">
<li><a href="#distribution-specific-dependencies">Distribution-specific dependencies</a></li>
<li><a href="#one-shot-launch">One-shot launch</a></li>
<li><a href="#detailed-instructions">Detailed instructions</a></li>
<li><a href="#file-dialogs-integration">File dialogs integration</a></li>
</ul>
</li>
<li><a href="#macos-instructions">MacOS instructions</a></li>
</ul>
</li>
<li><a href="#contributing">Contributing</a></li>
</ul>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245905138-1365f4a0-a517-4257-8148-8d01c3231635.gif"><img src="https://user-images.githubusercontent.com/3588717/245905138-1365f4a0-a517-4257-8148-8d01c3231635.gif" alt="Hypersomnia_discordthread"/></a></p>
<p dir="auto"><em>Hypersomnia</em> is a competitive arena released as free software.</p>
<p dir="auto">It brings together:</p>
<ul dir="auto">
<li>the tactics of <em>Counter-Strike</em>,</li>
<li>the dynamics of <em>Hotline Miami</em>,</li>
<li>the pixel art nostalgia of oldschool RPGs..</li>
<li>..and the potential for limitless community content thanks to an in-game map editor!</li>
</ul>
<p dir="auto">The game is already playable and runs a <strong>server instance 24/7.</strong></p>
<p dir="auto">Although currently intended for quick online matches,
the project began with a single childhood dream:</p>
<p dir="auto"><em>To create an MMO shooter with a persistent universe.</em></p>
<p dir="auto">In the future, the game might introduce elements of RPG with hardcore PvP mechanics.</p>
<p dir="auto">Set in a hypothetical afterlife reality, it shall provide joy through fierce fights, benevolent behaviors, fulfillment of elaborate social roles or sowing panic as a traitor to the altruists.</p>
<p dir="auto">Declare allegiance to one of the three factions whose apple of discord is a disparity between prevailing notions of moral excellence.</p>
<p dir="auto"><strong>Metropolis. Atlantis. Resistance.</strong></p>

<ul dir="auto">
<li>
<p dir="auto"><strong><a href="https://hypersomnia.xyz/weapons" rel="nofollow">24 unique firearms!</a></strong></p>
<ul dir="auto">
<li>And an extra 4 grenade types, 7 melee weapons as well as 6 magic spells!</li>
</ul>
</li>
<li>
<p dir="auto"><strong><a href="https://hypersomnia.xyz/arenas" rel="nofollow">10 community maps</a></strong> and counting!</p>
</li>
<li>
<p dir="auto"><strong>2 game modes</strong>: <em>Bomb defusal</em> and <em>Gun game</em>.</p>
</li>
<li>
<p dir="auto">An <strong>in-game map editor</strong> that lets you host a <strong>work-in-progress map</strong> to <em>instantly</em> play it with your friends, <strong>even behind a router!</strong></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245824984-1744ed72-612a-4af1-afbc-1a9d0c5750b3.png"><img src="https://user-images.githubusercontent.com/3588717/245824984-1744ed72-612a-4af1-afbc-1a9d0c5750b3.png" alt="image"/></a></p>
<ul dir="auto">
<li>
<p dir="auto">Your friends will <strong>automatically download your map</strong> with all its custom resources!</p>
<p dir="auto"><em>(like in CS 1.6)</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/246625203-daeb96d1-0ea5-41c6-89f8-3ef25013570d.png"><img src="https://user-images.githubusercontent.com/3588717/246625203-daeb96d1-0ea5-41c6-89f8-3ef25013570d.png" alt="image"/></a></p>
</li>
</ul>
</li>
</ul>

<ul dir="auto">
<li>
<p dir="auto"><strong><a href="https://github.com/TeamHypersomnia/rectpack2D">rectpack2D,</a> written for packing textures, became famous and was used in <a href="https://www.youtube.com/watch?v=2KnjDL4DnwM&amp;t=2382s" rel="nofollow">Assassin&#39;s Creed: Valhalla.</a></strong></p>
<ul dir="auto">
<li>Used also by <a href="https://pages.skydio.com/rs/784-TUF-591/images/Open%20Source%20Software%20Notice%20v0.2.html" rel="nofollow">a drone manufacturing company</a> and in <a href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C5&amp;q=teamhypersomnia&amp;btnG=" rel="nofollow">2 scientific papers.</a></li>
</ul>
</li>
<li>
<p dir="auto">My Entity-Component-System <strong><a href="https://gamedev.stackexchange.com/questions/58693/grouping-entities-of-the-same-component-set-into-linear-memory/" rel="nofollow">idea from 2013</a></strong> describes techniques similar to <strong><a href="https://patents.google.com/patent/US10599560B2/en" rel="nofollow">Unity Engine patent from 2018.</a></strong></p>
<ul dir="auto">
<li><strong><a href="https://github.com/TeamHypersomnia/Hypersomnia/issues/264" data-hovercard-type="issue" data-hovercard-url="/TeamHypersomnia/Hypersomnia/issues/264/hovercard">See this discussion.</a></strong></li>
</ul>
</li>
<li>
<p dir="auto">Networking is based on <strong>cross-platform simulation determinism</strong>.</p>
<ul dir="auto">
<li>This technique is traditionally used by RTS games with hundreds of continuously moving soldier units.
<ul dir="auto">
<li>It is impractical to continuously update every single one of them through the network.</li>
<li>Instead, only the player inputs are transmitted (&#34;I moved mouse here&#34;, &#34;I pressed this button&#34;) - the clients simulate <em>everything else</em> locally, on their own. Think playing chess with your friend over the phone. You won&#39;t ever say aloud the entire state of the chessboard, only the movements (&#34;Queen to H5&#34;).</li>
</ul>
</li>
<li>But <em>Hypersomnia</em> is not an RTS - since it&#39;s physics-based, it uses <em>floats</em> heavily, not just <em>integers</em>.
<ul dir="auto">
<li>When floating point calculations are involved, simulation determinism becomes <strong>extremely hard.</strong>
<ul dir="auto">
<li>See why in this <a href="https://gafferongames.com/post/floating_point_determinism/" rel="nofollow">excellent article by Glenn Fiedler.</a></li>
</ul>
</li>
<li>To achieve it in <em>Hypersomnia</em>, I had to:
<ul dir="auto">
<li>Use the same compiler - <code>clang</code> - on <strong>all</strong> OSes. It&#39;s very nice of LLVM to be ieee754-compliant by default.</li>
<li>Replace all math functions like <code>std::sin</code>, <code>std::sqrt</code> by these from <a href="https://nicolas.brodu.net/programmation/streflop/index.html" rel="nofollow">STREFLOP.</a></li>
<li>..after which <code>streflop::sqrt</code> became a huge bottleneck - thankfully, I found another efficient <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/3rdparty/streflop/libm/flt-32/e_sqrtf.h">ieee754-compliant implementation.</a></li>
</ul>
</li>
</ul>
</li>
<li>Apart from worrying about floats..
<ul dir="auto">
<li>I had to watch out even when iterating <code>std::unordered_map</code> - often replacing them with deterministically ordered <code>std::map</code>.</li>
<li>I had to use a <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/augs/misc/xorshift.hpp">portable RNG (xorshift)</a>, ditching the entire <code>&lt;random&gt;</code> header (its implementation differs across OSes).</li>
</ul>
</li>
<li>Another magical trick was needed to ensure the <strong>physics itself is fully deterministic:</strong>
<ul dir="auto">
<li>Problem: when a new client connects, it receives the initial physics state - but the packets contain just the body positions, rotations and velocities.</li>
<li>In particular, it doesn&#39;t contain the &#34;hot&#34; physics state such as the already tracked contacts, or the already built/balanced quadtree for fast collision detection.</li>
<li>What if there are already some players on the server, and several bodies overlap the moment a new player joins?</li>
<li>The new client will recreate the entire internal physics state on its own, using just the pos/vel/rotation data, but the contacts might be created in a different order than that of the existing clients! The fresh quadtree might end up completely different too from the one that has already seen many insertions/deletions during a long gaming session - so it might later report collisions in different order.</li>
<li>My solution was one of the greatest stroke of epiphany I ever experienced:
<ul dir="auto">
<li>When a new client connects, <strong>force already connected clients to completely rebuild the physics state from the positions, rotations and velocities as if they have just connected themselves.</strong> <em>drops the mic</em></li>
<li>As long as building the internal physics data from pos/vel/rotation data is deterministic, the in-game clients will have the <em>exact same state</em> as the newly connected client.</li>
<li>I apply the same principle in many other areas of networking. Throughout my codebase, I call this process <em><a href="https://wiki.hypersomnia.xyz/reinference" rel="nofollow">cache reinference.</a></em></li>
</ul>
</li>
</ul>
</li>
<li>All this would be very hard to pull off in a commercial engine, or straight impossible in a closed source one.</li>
<li>Yet in <em>Hypersomnia</em>, you can have thousands of dynamic crates or bullets on the map - as long as there are e.g. two player-controlled characters, the traffic will be around <code>40 kbit/s (= 5 KB/s)</code> under a tickrate of 60 Hz. <strong>Only player-controlled characters</strong> contribute to traffic.
<ul dir="auto">
<li>Even the silliest details like bullet shells are fully synchronized <em>without</em> paying for it with network traffic.</li>
</ul>
</li>
<li>As a bonus, lag is hidden exceptionally well as the game doesn&#39;t just mindlessly &#34;extrapolate&#34; frames visually - rather, it simulates the entire game world forward <em>offscreen</em> to accurately predict the future.</li>
<li>For the very curious - here&#39;s an <a href="https://teamhypersomnia.github.io/newscast/full-blown-networking-with-latency-hiding-for-physics" rel="nofollow">article from my old abandoned blog</a>, showing how I achieved this as early as in 2016.</li>
</ul>
</li>
<li>
<p dir="auto">You can host a working game server <em>from the main menu</em> - the game is able to <strong>forward ports out of the box!</strong></p>
<ul dir="auto">
<li>The algorithm requires a third party server - in this case, the masterserver (server list keeper) facilitates the traversal.</li>
<li>Very simple in principle. Using Google STUN servers, we first detect the NAT type for both the client and the server (conic, symmetric or no NAT), as well as the difference in ports between packets outgoing to two different addresses (&#34;port delta&#34;).</li>
<li>Both parties send packets to the masterserver which in turn relays what was the last external port <code>P</code> of the other party.</li>
<li>Both parties then spam e.g. 10-20 UDP packets at ports <code>P + delta * n</code>.</li>
<li>Even a pair of symmetric NATs will form a connection if they have a deterministic port delta - although after a while. The connection will fail if either the client or the server has a symmetric NAT with randomized port selection. In practice however, most routers are conic which makes punchthrough work instantly.</li>
</ul>
</li>
<li>
<p dir="auto">Cute fish and insect AI <strong><a href="https://www.youtube.com/watch?v=0vlUOO5l0jw" rel="nofollow">with flocking behaviors.</a></strong> Full source: <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/game/stateless_systems/movement_path_system.cpp">movement_path_system.cpp.</a></p>
<ul dir="auto">
<li>These too are synchronized through the network!
<ul dir="auto">
<li>Other players see fish and insects in the same positions, even though they <strong>do not contribute to network traffic.</strong></li>
</ul>
</li>
<li>Fish and insects react to shots and explosions!
<ul dir="auto">
<li>And once they&#39;re scared, they keep closer to members of the same species.</li>
</ul>
</li>
</ul>
</li>
<li>
<p dir="auto">Anyone can host <strong><a href="https://github.com/TeamHypersomnia/Hypersomnia-admin-shell">the entire <em>Hypersomnia</em> server infrastructure.</a></strong></p>
<ul dir="auto">
<li>The Editor, the game server <em>and</em> the masterserver (server list keeper) are <strong>all embedded in the same game executable</strong>, on every OS.</li>
<li>You could run a separate server list for your own community around a completely modded version of <em>Hypersomnia</em>!</li>
</ul>
</li>
<li>
<p dir="auto">Memory pool <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/augs/misc/pool/pool.h">implementation</a> with:</p>
<ul dir="auto">
<li><strong>Contiguous storage</strong>.
<ul dir="auto">
<li>All game objects in existence are kept <strong>linearly in memory</strong> (in a simple <code>std::vector</code>).
<ul dir="auto">
<li>It means blazing-fast iteration of all game objects of the same type, as well as trivial pool serialization.</li>
</ul>
</li>
</ul>
</li>
<li><strong>O(1)</strong> allocation (mostly a glorified <code>push_back</code>).</li>
<li><strong>O(1)</strong> free (via <code>std::swap</code> with the last element and <code>pop_back</code> - a very known idiom).</li>
<li><strong>O(1)</strong> dereference.
<ul dir="auto">
<li>The <em>only</em> caveat being: a dereference involves <strong>four</strong> reads from memory (instead of just <strong>one</strong> with a direct pointer and <strong>two</strong> with a pointer + array index):</li>
<li>It has to first read the <code>indirection_array</code> pointer <strong>(1)</strong>.
<ul dir="auto">
<li>The indirection array contains the current index of the requested object within the vector of all allocated objects.</li>
<li>This index is located at <code>indirection_array[identifier]</code> <strong>(2)</strong>.</li>
</ul>
</li>
<li>Then it reads the actual <code>objects</code> vector pointer <strong>(3)</strong>.</li>
<li>Finally, it reads the object itself at <code>objects[indirection_array[identifier]]</code> <strong>(4)</strong>.</li>
<li>(Note that the <code>objects</code> and <code>indirection_array</code> will usually be cached already so subsequent dereferences will be reduced to two fetches from RAM at most).</li>
<li>This works because <code>indirection_array</code> is kept up-to-date whenever objects are allocated or removed.</li>
</ul>
</li>
<li><strong>Fully resizable</strong>. You don&#39;t have to pass a maximum pool size. It will expand on its own.</li>
<li><strong>Fully deterministic.</strong> Given the same sequence of allocations and frees starting from a given initial pool state, the allocations will produce the same integer identifiers and objects will have exactly the same order in the linear memory.
<ul dir="auto">
<li>When a client connects and the server sends it the initial world state, it includes the entire <strong>internal state</strong> of the game object pools.
<ul dir="auto">
<li>It means the pools themselves are <em>a part of the game simulation</em> - I don&#39;t have to send any &#34;creation&#34; notification events through the network whenever entities are created as the clients <strong>deterministically simulate allocations on their own</strong> resulting in identical object identifiers as well as their orders in memory.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Perfectly undoable allocations and frees.</strong>
<ul dir="auto">
<li>The Editor requires all commands to implement a deterministic undo/redo, especially ones that create or delete a resource.</li>
<li>Suppose you create a custom Material in the editor and it now has an integer identifier <code>I</code>.
<ul dir="auto">
<li>You later set this Material to some walls on the scene. The walls now refer to identifier <code>I</code>.</li>
<li>Now you want to undo all the way back to before you even created the Material.</li>
<li>The Material gets deleted from the pool.</li>
<li>Now you actually want to <em>redo</em> all of these commands back.</li>
<li>You first redo the Material allocation command.</li>
<li>But if the pool uses a non-undoable allocation scheme, the material could now be allocated with the id <code>I+1</code>.</li>
<li>This means that the subsequent commands (that alter the walls material) will set an identifier that is now invalid - <code>I</code>.</li>
<li>To solve this problem, my memory pool implementation provides <code>undo_last_allocate</code> apart from the standard <code>free</code>. It&#39;s used by the commands that have to undo creating a resource (which means deleting it). It will free the object in a way that the next allocation will result in an identical integer id and internal pool state (with allocated objects order) as before freeing the resource. It is an optional feature for the sake of editor commands that is never used during actual gameplay. Analogously, there is an <code>undo_last_free</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p dir="auto">Built-in self-updater: the game will download and apply updates automatically.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245897452-0479fca0-f836-4f6a-b5a5-dc2317bb4b95.png"><img src="https://user-images.githubusercontent.com/3588717/245897452-0479fca0-f836-4f6a-b5a5-dc2317bb4b95.png" alt="image"/></a></p>
<ul dir="auto">
<li>Not only that, <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/application/main/verify_signature.h">it will verify</a> that the update came from the hardcoded <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/src/signing_keys.h">developer public key</a>, with a call to <code>ssh-keygen</code>.
<ul dir="auto">
<li>If the <a href="https://hypersomnia.xyz/builds/latest/" rel="nofollow">build hosting</a> were hacked and a malicious game version uploaded, the existing game clients <strong>will refuse</strong> to apply the updates.</li>
</ul>
</li>
</ul>
</li>
<li>
<p dir="auto">..and I&#39;m signing builds <strong>offline with a <a href="https://github.com/TeamHypersomnia/Hypersomnia-admin-shell/blob/master/developer_sign_file.sh">Trezor hardware wallet</a>.</strong>
This is how <em>every</em> update looks like on my end:</p>
<details open="">
  <summary>
    <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true">
    <path d="M16 3.75v8.5a.75.75 0 0 1-1.136.643L11 10.575v.675A1.75 1.75 0 0 1 9.25 13h-7.5A1.75 1.75 0 0 1 0 11.25v-6.5C0 3.784.784 3 1.75 3h7.5c.966 0 1.75.784 1.75 1.75v.675l3.864-2.318A.75.75 0 0 1 16 3.75Zm-6.5 1a.25.25 0 0 0-.25-.25h-7.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-6.5ZM11 8.825l3.5 2.1v-5.85l-3.5 2.1Z"></path>
</svg>
    <span aria-label="Video description przecietnylinuksiarz.mp4">przecietnylinuksiarz.mp4</span>
    <span></span>
  </summary>

  <video src="https://user-images.githubusercontent.com/3588717/245871612-c4d0764e-382f-45db-bc13-c626723e47e1.mp4" data-canonical-src="https://user-images.githubusercontent.com/3588717/245871612-c4d0764e-382f-45db-bc13-c626723e47e1.mp4" controls="controls" muted="muted">

  </video>
</details>

</li>
<li>
<p dir="auto"><strong>Discord</strong> and <strong>Telegram</strong> notifications when:</p>
<ul dir="auto">
<li>
<p dir="auto">a new game version is deployed,</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245861361-0725d856-0b9d-47c8-a76a-ea3a887318e9.png"><img src="https://user-images.githubusercontent.com/3588717/245861361-0725d856-0b9d-47c8-a76a-ea3a887318e9.png" alt="image"/></a></p>
</li>
<li>
<p dir="auto">players connect,</p>
</li>
<li>
<p dir="auto">a 1v1 &#34;duel of honor&#34; begins (auto-detected whenever there&#39;s only 1 player per faction),</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245825346-ca286048-989a-4289-afd0-bb991c63b8ad.png"><img src="https://user-images.githubusercontent.com/3588717/245825346-ca286048-989a-4289-afd0-bb991c63b8ad.png" alt="image"/></a></p>
</li>
<li>
<p dir="auto">community server is hosted,</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245860934-7c543b0c-7239-4cd9-947b-503001c7f2b6.png"><img src="https://user-images.githubusercontent.com/3588717/245860934-7c543b0c-7239-4cd9-947b-503001c7f2b6.png" alt="image"/></a></p>
</li>
<li>
<p dir="auto">or a match comes to an end. This includes full player stats and the MVP.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245860207-2cc549f4-3dc7-4b6d-aca4-85c60bb6cafc.png"><img src="https://user-images.githubusercontent.com/3588717/245860207-2cc549f4-3dc7-4b6d-aca4-85c60bb6cafc.png" alt="image"/></a></p>
</li>
</ul>
</li>
<li>
<p dir="auto">Beautifully simple JSON format for the game maps. This short json:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
 &#34;settings&#34;: {
  &#34;ambient_light_color&#34;: [53, 25, 102, 255]
 },

 &#34;nodes&#34;: [
  {
   &#34;id&#34;: &#34;floor&#34;,
   &#34;type&#34;: &#34;dev_floor_128&#34;,
   &#34;pos&#34;: [640, 0],
   &#34;size&#34;: [1536, 1536]
  },
  {
   &#34;id&#34;: &#34;light&#34;,
   &#34;type&#34;: &#34;point_light&#34;,
   &#34;color&#34;: [255, 165, 0, 255],
   &#34;pos&#34;: [100, 100],
   &#34;radius&#34;: 700
  },
  {
   &#34;id&#34;: &#34;wall&#34;,
   &#34;type&#34;: &#34;dev_wall_128&#34;,
   &#34;pos&#34;: [-384, 0],
   &#34;size&#34;: [512, 1536]
  },
  {
   &#34;id&#34;: &#34;crate&#34;,
   &#34;type&#34;: &#34;crate&#34;,
   &#34;pos&#34;: [64, 448]
  },
  {
   &#34;id&#34;: &#34;wood1&#34;,
   &#34;type&#34;: &#34;hard_wooden_wall&#34;,
   &#34;pos&#34;: [192, -192]
  },
  {
   &#34;id&#34;: &#34;wood2&#34;,
   &#34;type&#34;: &#34;hard_wooden_wall&#34;,
   &#34;pos&#34;: [561.819, 206.436],
   &#34;size&#34;: [384, 128],
   &#34;rotation&#34;: -15
  },
  {
   &#34;id&#34;: &#34;aquarium&#34;,
   &#34;type&#34;: &#34;aquarium&#34;,
   &#34;pos&#34;: [1408, 0],
   &#34;rotation&#34;: 90
  },
  {
   &#34;id&#34;: &#34;baka1&#34;,
   &#34;type&#34;: &#34;baka47&#34;,
   &#34;pos&#34;: [698, -8]
  },
  {
   &#34;id&#34;: &#34;baka2&#34;,
   &#34;type&#34;: &#34;baka47&#34;,
   &#34;pos&#34;: [454, -264]
  }
 ]
}
"><pre>{
 <span>&#34;settings&#34;</span>: {
  <span>&#34;ambient_light_color&#34;</span>: [<span>53</span>, <span>25</span>, <span>102</span>, <span>255</span>]
 },

 <span>&#34;nodes&#34;</span>: [
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>floor<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>dev_floor_128<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>640</span>, <span>0</span>],
   <span>&#34;size&#34;</span>: [<span>1536</span>, <span>1536</span>]
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>light<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>point_light<span>&#34;</span></span>,
   <span>&#34;color&#34;</span>: [<span>255</span>, <span>165</span>, <span>0</span>, <span>255</span>],
   <span>&#34;pos&#34;</span>: [<span>100</span>, <span>100</span>],
   <span>&#34;radius&#34;</span>: <span>700</span>
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>wall<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>dev_wall_128<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>-384</span>, <span>0</span>],
   <span>&#34;size&#34;</span>: [<span>512</span>, <span>1536</span>]
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>crate<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>crate<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>64</span>, <span>448</span>]
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>wood1<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>hard_wooden_wall<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>192</span>, <span>-192</span>]
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>wood2<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>hard_wooden_wall<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>561.819</span>, <span>206.436</span>],
   <span>&#34;size&#34;</span>: [<span>384</span>, <span>128</span>],
   <span>&#34;rotation&#34;</span>: <span>-15</span>
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>aquarium<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>aquarium<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>1408</span>, <span>0</span>],
   <span>&#34;rotation&#34;</span>: <span>90</span>
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>baka1<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>baka47<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>698</span>, <span>-8</span>]
  },
  {
   <span>&#34;id&#34;</span>: <span><span>&#34;</span>baka2<span>&#34;</span></span>,
   <span>&#34;type&#34;</span>: <span><span>&#34;</span>baka47<span>&#34;</span></span>,
   <span>&#34;pos&#34;</span>: [<span>454</span>, <span>-264</span>]
  }
 ]
}
</pre></div>
<p dir="auto">Instantly produces:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245824453-b108f985-fe79-4a7d-8708-4f1d1da7b93e.png"><img src="https://user-images.githubusercontent.com/3588717/245824453-b108f985-fe79-4a7d-8708-4f1d1da7b93e.png" alt="image"/></a></p>
</li>
<li>
<p dir="auto">And speaking of the Editor..</p>
<ul dir="auto">
<li>
<p dir="auto">It&#39;s created with the excellent <a href="https://github.com/ocornut/imgui">ImGui</a>.</p>
</li>
<li>
<p dir="auto">You&#39;re working <em>directly</em> on the game world. 100% WYSIWYG.</p>
</li>
<li>
<p dir="auto">Supports custom resources. It&#39;s enough to paste folders with PNGs, WAVs, OGGs to the map directory..</p>
<ul dir="auto">
<li>..alt-tab back to the game and it will automatically pick it up!</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245880608-8d5300fa-18cc-4979-9487-88f3b05a517a.png"><img src="https://user-images.githubusercontent.com/3588717/245880608-8d5300fa-18cc-4979-9487-88f3b05a517a.png" alt="image"/></a></p>
</li>
<li>
<p dir="auto">Supports GIFs as well! Just drag&amp;drop them on the scene and they will be animated in-game, right out of the box!</p>
</li>
<li>
<p dir="auto">It&#39;s possible to playtest a <em>work-in-progress map</em> with <strong>a single click</strong>:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245824984-1744ed72-612a-4af1-afbc-1a9d0c5750b3.png"><img src="https://user-images.githubusercontent.com/3588717/245824984-1744ed72-612a-4af1-afbc-1a9d0c5750b3.png" alt="image"/></a></p>
<ul dir="auto">
<li>
<p dir="auto">After which you instantly appear in the game&#39;s server browser:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/3588717/245884520-3d8dbd53-3f84-40fe-9847-1c3ac0df1780.png"><img src="https://user-images.githubusercontent.com/3588717/245884520-3d8dbd53-3f84-40fe-9847-1c3ac0df1780.png" alt="image"/></a></p>
</li>
<li>
<p dir="auto">You will enter the game as the host.</p>
</li>
<li>
<p dir="auto">The connecting clients will automatically download the map in its current version with all its custom resources.</p>
<ul dir="auto">
<li>And they can later <strong>create their own remake</strong> - maps are saved in JSON, after all!</li>
</ul>
</li>
<li>
<p dir="auto">ESC will let you stop the session and go back to the Editor <strong>exactly as you left it</strong>, enabling ultra-efficient iteration cycles.</p>
</li>
<li>
<p dir="auto">This is possible because the server, the game and the editor are <strong>all within the same executable.</strong></p>
</li>
<li>
<p dir="auto">The official Discord will also be notified that you&#39;re playtesting a map, so others can join in on the fun!</p>
</li>
</ul>
</li>
<li>
<p dir="auto">The Editor took well over a year to implement.</p>
</li>
<li>
<p dir="auto">It paid off big time - there is now a neat <a href="https://hypersomnia.xyz/arenas" rel="nofollow">catalogue of community maps</a> - every one of them downloadable.</p>
</li>
</ul>
</li>
</ul>

<p dir="auto"><em>Hypersomnia</em> has been in development <strong>since 2013</strong> (as seen in the commit history).</p>
<p dir="auto">It didn&#39;t take 10 years of uninterrupted coding, though - in the meantime, I worked commercially to cover my costs of living. This <a href="https://www.youtube.com/watch?v=tSP5P0QGWa4" rel="nofollow">cute minigame for PUBG</a> was my last programming gig, and the proceeds allowed me to focus entirely on <em>Hypersomnia</em>.</p>
<p dir="auto">I use a lot of 3rdparty libraries like <code>Box2D</code> (physics) or <code>yojimbo</code> (transport layer) - <a href="https://github.com/TeamHypersomnia/Hypersomnia/tree/master/src/3rdparty">everything not on this list,</a> however, is written pretty much from scratch, in pure C++.</p>
<p dir="auto">Many believe that writing games without an engine is no more than <em>reinventing the wheel</em>, or put more bluntly, a complete waste of time.</p>
<p dir="auto"><strong>I hope this project serves as a great testament to the opposite.</strong></p>
<p dir="auto">If I never embarked on this journey, I would have never made some of the interesting discoveries detailed in <a href="#tech-highlights">Tech highlights section.</a>
Video game internals are just so vast and interdisciplinary that they have limitless potential for creative breakthroughs, and it is a waste to never even entertain the idea that some widely used solutions can be replaced by something absolutely ingenious.</p>
<p dir="auto">It is not a bad thing that game engines exist. If you want to be competitive writing a game without one, then you are forced to come up with a design so unique that it would be hard or impossible to do it in a commercial engine. This alone helps developers arrive to exceptional game ideas.</p>

<p dir="auto">From: <a href="https://hypersomnia.xyz/guide" rel="nofollow">https://hypersomnia.xyz/guide</a></p>
<p dir="auto">You can reconfigure all bindings by going to Settings-&gt;Controls tab.</p>
<ul dir="auto">
<li>WSAD: move around</li>
<li>Shift - sprint, it drains stamina.</li>
<li>Space - dash, it drains quite a lot of stamina.</li>
<li>Left control - move quietly.</li>
<li>B - open the shop. Usually, the shop is off during warmup.</li>
<li>M - change team. You should just pick Auto-assign to preserve balance.</li>
<li>G - drop the most recently wielded item.</li>
<li>H - hide the most recently wielded item. Can fail if you have no space in your inventory!</li>
<li>E - Pick up items/defuse the bomb. If you move when defusing, the timer is reset, so stay still. You can shoot, though. Just remember to keep the trigger in the bomb&#39;s range, they have to touch.</li>
<li>C - pull out the bomb (as a terrorist)</li>
<li>Wheel Down - quickly throw a knife (or another melee weapon you happen to have). Note you can throw a knife during any activity, even when reloading or planting a bomb.</li>
<li>Wheel Up - quickly throw two knives (or other melee weapons you happen to have).</li>
<li>Middle mouse button - quickly throw a Force grenade.</li>
<li>Mouse4 - quickly throw a Flashbang.</li>
<li>Mouse5 - quickly throw a PED grenade (destroys Personal Electricity).</li>
<li>Q - quickly switch to the most recently drawn weapon - or any other at your disposal. Can fail if you have no space in your inventory for the currently held weapon!</li>
<li>0, 1, 2, ..., 9 - choose weapons from the hotbar.</li>
<li>TAB - match statistics, e.g. the players and their scores.</li>
<li>F8 - admininistration panel for your server where you can change maps or restart the match.</li>
<li>Tilde (~) - release the mouse cursor to let you interact with GUI. You probably won&#39;t use it often, but it&#39;s useful if you want to drop a specific item from your inventory - simply press the right mouse button whilst dragging it. Pressing the tilde again puts you back into the game and lets you regain control over the crosshair.</li>
<li>LMB:
<ul dir="auto">
<li>Use the item in your right hand, so:</li>
<li>for the bomb: plant it</li>
<li>for a nade: unpin it</li>
<li>for a firearm: shoot it</li>
<li>for a melee weapon: a wide swing</li>
</ul>
</li>
<li>RMB - Use the item in your left hand, or a secondary function of the item in your right hand (only if your left hand is unoccupied), for example - burst fire for the AO44 revolver. Also: a narrow, powerful swing for a melee weapon. Unpins the nade to throw it under your feet, instead of throwing it far.</li>
</ul>

<p dir="auto">Currently, <em>Hypersomnia</em> is only buildable using <code>clang</code>.
Your operating system must be 64-bit.</p>

<p dir="auto">Irrespectively of the OS, you will need the following software in order to build <em>Hypersomnia</em>:</p>
<ul dir="auto">
<li>The newest <strong>CMake</strong>.</li>
<li><strong>git</strong> to clone the respository and later generate version information.</li>
<li><a href="https://ninja-build.org/" rel="nofollow"><strong>ninja</strong></a> to carry out the build.</li>
<li><a href="https://releases.llvm.org/" rel="nofollow">LLVM</a> toolchain version 13 or newer.
<ul dir="auto">
<li>For Windows, you can use <a href="https://github.com/llvm/llvm-project/releases/download/llvmorg-13.0.1/LLVM-13.0.1-win64.exe">this installer</a>, or a newer one.</li>
<li>For Linux, use your distro-specific package. Make sure to install <code>libc++</code>, <code>libc++abi</code> and <code>lld</code> as well.</li>
<li>For MacOS, the version that comes pre-installed with <strong>Xcode</strong> is good enough.</li>
</ul>
</li>
<li><a href="https://www.openssl.org/" rel="nofollow">OpenSSL</a> needed by the auto-updater to download latest game binaries over HTTPS.
<ul dir="auto">
<li>On Windows, you can get the appropriate installer here: <a href="https://slproweb.com/download/Win64OpenSSL-1_1_1d.exe" rel="nofollow">https://slproweb.com/download/Win64OpenSSL-1_1_1d.exe</a></li>
</ul>
</li>
</ul>
<p dir="auto">Once dependencies are installed, go to the directory where you wish to have your <em>Hypersomnia</em> project downloaded,
open git bash and paste:</p>
<div data-snippet-clipboard-copy-content="git clone --recurse-submodules https://github.com/TeamHypersomnia/Hypersomnia"><pre><code>git clone --recurse-submodules https://github.com/TeamHypersomnia/Hypersomnia
</code></pre></div>
<p dir="auto">The <code>--recurse-submodules</code> is necessary to clone the submodules as well.</p>
<p dir="auto">Wait for the download to complete.
Next steps depend on the platform you are on.</p>
<p dir="auto">On all platforms, you can choose among three building configurations:</p>
<ul dir="auto">
<li><code>Debug</code> - the fastest to build and provides debug information.</li>
<li><code>Release</code> - No debug information. Use only for production builds. Specifies <code>IS_PRODUCTION_BUILD=1</code> C++ preprocessor define that disables assertions in performance-critical areas.</li>
<li><code>RelWithDebInfo</code> - Same as <code>Release</code> but with debug info and with many assertions (&#34;ensures&#34;) compiled-in.
Preferred choice for testing the developed game while full speed is required.</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-windows-instructions" aria-hidden="true" href="#windows-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Windows instructions</h2>
<p dir="auto">Refer to <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/appveyor.yml">appveyor.yml</a> file for up-to-date building procedure. A short overview of the process now follows.</p>
<p dir="auto">Prerequisites:</p>
<ul dir="auto">
<li><strong>Visual Studio 2022 Community</strong> or newer.</li>
</ul>
<p dir="auto">Open up the terminal. Setup the environment:</p>
<div data-snippet-clipboard-copy-content="call &#34;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvarsall.bat&#34; x64"><pre><code>call &#34;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvarsall.bat&#34; x64
</code></pre></div>
<p dir="auto">(If the file cannot be found, it means you are not using Visual Studio 2022 Community. You will have to look for a corresponding <code>vcvarsall.bat</code> location on your own.)</p>
<p dir="auto">Next, run these commands:</p>
<div data-snippet-clipboard-copy-content="cd Hypersomnia
mkdir build
cd build
set CONFIGURATION=Release
cmake -G Ninja -DCMAKE_C_COMPILER=clang-cl -DCMAKE_CXX_COMPILER=clang-cl -DCMAKE_LINKER=lld-link -DARCHITECTURE=&#34;x64&#34; -DCMAKE_BUILD_TYPE=%CONFIGURATION% -DGENERATE_DEBUG_INFORMATION=0 ..
ninja"><pre><code>cd Hypersomnia
mkdir build
cd build
set CONFIGURATION=Release
cmake -G Ninja -DCMAKE_C_COMPILER=clang-cl -DCMAKE_CXX_COMPILER=clang-cl -DCMAKE_LINKER=lld-link -DARCHITECTURE=&#34;x64&#34; -DCMAKE_BUILD_TYPE=%CONFIGURATION% -DGENERATE_DEBUG_INFORMATION=0 ..
ninja
</code></pre></div>
<p dir="auto">Note: your computer <strong>might start lagging heavily</strong> for the duration of the build as <code>ninja</code> will use all available cores for compilation.</p>
<p dir="auto">If you intend to develop the game, it is best to use &#34;Debug&#34; configuration for the fastest builds.</p>
<p dir="auto">If you want to somehow customize your build, e.g. disable certain game features, refer to the beginning of <code>CMakeLists.txt</code> to see which options you can pass to the <code>cmake</code> command.</p>
<p dir="auto">If the game builds successfully, issue this command to launch it:</p>



<p dir="auto">If, for some reason, some step fails, refer to the latest working Appveyor build and the relevant <code>appveyor.yml</code> file.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-linux-instructions" aria-hidden="true" href="#linux-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Linux instructions</h2>
<p dir="auto">Refer to <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/.github/workflows/Linux_build.yml">Linux_build.yml</a> file for up-to-date building procedure - it is constantly in flux. A short overview of the process now follows.</p>
<p dir="auto">Current platforms are actively tested and supported:</p>
<ul dir="auto">
<li>Arch Linux with i3 window manager - the developer&#39;s machine.</li>
<li>Ubuntu, as this is where the dedicated server is deployed.</li>
</ul>
<h4 tabindex="-1" dir="auto"><a id="user-content-distribution-specific-dependencies" aria-hidden="true" href="#distribution-specific-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Distribution-specific dependencies</h4>
<p dir="auto">Arch Linux:</p>
<ul dir="auto">
<li><code>pkg-config</code></li>
<li><code>libx11</code></li>
<li><code>libxcb</code></li>
<li><code>xcb-util-keysyms</code></li>
<li><code>libsodium</code></li>
<li>Might need more - you are on your own here (like very Arch user).</li>
</ul>
<p dir="auto">Ubuntu:</p>
<div data-snippet-clipboard-copy-content="sudo apt-get install cmake ninja-build libxcb-keysyms1 libxcb-keysyms1-dev libxi6 libxi-dev alsa-oss osspd-alsa osspd libasound2 libasound2-dev p7zip p7zip-full libgl1-mesa-dev libxcb-glx0-dev libx11-xcb-dev"><pre><code>sudo apt-get install cmake ninja-build libxcb-keysyms1 libxcb-keysyms1-dev libxi6 libxi-dev alsa-oss osspd-alsa osspd libasound2 libasound2-dev p7zip p7zip-full libgl1-mesa-dev libxcb-glx0-dev libx11-xcb-dev
</code></pre></div>
<h3 tabindex="-1" dir="auto"><a id="user-content-one-shot-launch" aria-hidden="true" href="#one-shot-launch"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>One-shot launch</h3>
<p dir="auto">Once the dependencies are all set, this is the complete script for building and launching the game from scratch, with RelWithDebInfo configuration:</p>
<div data-snippet-clipboard-copy-content="git clone --depth 1 --recurse-submodules https://github.com/TeamHypersomnia/Hypersomnia
cd Hypersomnia
export CXX=clang++; export CC=clang;
cmake/build.sh RelWithDebInfo x64
ninja run -C build/current"><pre><code>git clone --depth 1 --recurse-submodules https://github.com/TeamHypersomnia/Hypersomnia
cd Hypersomnia
export CXX=clang++; export CC=clang;
cmake/build.sh RelWithDebInfo x64
ninja run -C build/current
</code></pre></div>
<h4 tabindex="-1" dir="auto"><a id="user-content-detailed-instructions" aria-hidden="true" href="#detailed-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Detailed instructions</h4>
<p dir="auto">Use your favorite shell to enter the repository&#39;s directory.
Then run:</p>
<div data-snippet-clipboard-copy-content="cmake/build.sh [Debug|Release|RelWithDebInfo] [x86|x64] [&#34;ADDITIONAL CMAKE FLAGS&#34;]"><pre><code>cmake/build.sh [Debug|Release|RelWithDebInfo] [x86|x64] [&#34;ADDITIONAL CMAKE FLAGS&#34;]
</code></pre></div>
<p dir="auto">For example:</p>
<div data-snippet-clipboard-copy-content="export CXX=clang++; export CC=clang;
cmake/build.sh Debug x64"><pre><code>export CXX=clang++; export CC=clang;
cmake/build.sh Debug x64
</code></pre></div>
<p dir="auto">After which, the resultant <code>build.ninja</code> should appear in the build/Debug-x64-clang directory.</p>
<p dir="auto">Example for gcc:</p>
<div data-snippet-clipboard-copy-content="export CXX=g++; export CC=gcc;
cmake/build.sh Debug x64"><pre><code>export CXX=g++; export CC=gcc;
cmake/build.sh Debug x64
</code></pre></div>
<p dir="auto">After which, the resultant <code>build.ninja</code> should appear in the build/Debug-x64-gcc directory.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-invoking-ninja" aria-hidden="true" href="#invoking-ninja"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Invoking ninja</h4>

<p dir="auto">There are several additional ninja targets defined:</p>

<p dir="auto">Launches the game normally.</p>

<p dir="auto">Launches unit tests only and exits cleanly.</p>
<p dir="auto">The above targets set the working directory automatically to <code>${PROJECT_SOURCE_DIR}/hypersomnia</code>.</p>
<p dir="auto">If, for some reason, some step fails, refer to the latest working <code>Linux_build.yml</code> file.</p>
<p dir="auto">If the game fails to launch, it should automatically open a log file with the relevant message using <code>$VISUAL</code> executable.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-file-dialogs-integration" aria-hidden="true" href="#file-dialogs-integration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>File dialogs integration</h3>
<p dir="auto">You might want to follow some additional configuration to make the experience better on Linux.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-opening-and-revealing-files" aria-hidden="true" href="#opening-and-revealing-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Opening and revealing files</h4>
<p dir="auto">The <em>Hypersomnia</em> editor can reveal files in explorer.
The game may also want to open files in other contexts, e.g. for choosing the avatar.
On Windows, this is accomplished through an <code>IFileDialog</code>.</p>
<div data-snippet-clipboard-copy-content="ln -s managers/reveal_file_ranger.zsh reveal_file.local 
ln -s managers/open_file_ranger.zsh open_file.local"><pre><code>ln -s managers/reveal_file_ranger.zsh reveal_file.local 
ln -s managers/open_file_ranger.zsh open_file.local
</code></pre></div>
<p dir="auto">None of the symlinks will be tracked by git.</p>
<p dir="auto">Currently, the following file managers are supported:</p>
<ul dir="auto">
<li><a href="https://github.com/ranger/ranger">ranger</a> through <code>--choosefile</code> and <code>--selectfile</code> options</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-macos-instructions" aria-hidden="true" href="#macos-instructions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>MacOS instructions</h2>
<p dir="auto">Refer to <a href="https://github.com/TeamHypersomnia/Hypersomnia/blob/master/.github/workflows/MacOS_build.yml">MacOS_build.yml</a> file for up-to-date instructions.</p>

<p dir="auto">To understand the repository&#39;s folder structure, make sure to read the <a href="https://wiki.hypersomnia.xyz/folder_structure" rel="nofollow">documentation</a>.</p>
<p dir="auto">Pull requests are welcomed, should they even be typo fixes, missing const guarantees or changes in nomenclature.
If you however plan to add a completely new feature, create a relevant <a href="https://github.com/TeamHypersomnia/Hypersomnia/issues">issue</a> so that everybody knows about it,
because the project is continuously in a very, very active development and may undergo a revolution when it is the least expected.</p>
<p dir="auto">A WIP documentation can be found at <a href="https://wiki.hypersomnia.xyz" rel="nofollow">wiki</a>.</p>
<p dir="auto">Make sure to check out <a href="https://github.com/TeamHypersomnia">TeamHypersomnia</a> for other repositories that are useful when setting up your own custom servers.</p>
<p dir="auto">If you have questions or you fail to build <em>Hypersomnia</em>, create an <a href="https://github.com/TeamHypersomnia/Hypersomnia/issues">issue</a>.
Or if you just can&#39;t wait to utter some brilliant ideas with regard to the game, please do so, too!</p>
</article>
          </div></div>
  </body>
</html>
