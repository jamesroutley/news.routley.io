<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.moontower.ai/jensens-inequality-as-an-intuition-tool/">Original</a>
    <h1>Jensen&#39;s Inequality as an Intuition Tool (2021)</h1>
    
    <div id="readability-page-1" class="page"><section>
            <p>I came across a tool from mathematics called Jensen’s Inequality. I’m going to explain the rule, provide intuitive examples, then end by pointing you to real-world applications.</p><p>A warning to math whizzes — I don’t have formal math training so this post is divorced from pedagogical context. Yes, there will be numerical examples. But the real goal is for readers to recognize when the domain they are reasoning about is subject to the surprising predictions of Jensen’s Inequality. For most of us, the value of this tool is how it nudges our intuition to better predictions, not in the direct application of a formula.</p><p>Here’s where we’re going:</p><ol><li>Why I found Jensen’s Inequality interesting</li><li>The conditions and statement of the inequality</li><li>An example that affects us all</li><li>Spotting Jensen’s in the wild</li></ol><h3 id="why-i-found-jensen%E2%80%99s-inequality-interesting"><strong>Why I Found Jensen’s Inequality Interesting</strong></h3><p><strong>Blindness To Exponents</strong></p><p>Exponential phenomena confuse our brains. It has become tiresome to point out that we do not have natural intuition for growth and decay rates. Even finance folk who are apt to appreciate the idea of compounding  seem to not recognize it when the investing skin is pulled off it.</p><p>Covid is a timely example. A virus’ R0 (“R naught”) indicates how transmissable it is. Remember “Covid is the flu”. Say the flu has an R0 of 2. So for each person that contracts the flu, they infect 2 more people. Now let’s suppose Covid has an R0 of 3. Here’s how the 2 viruses would spread.¹</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/R0.jpg?resize=434%2C391&amp;ssl=1" alt="" loading="lazy" width="434" height="391"/></figure><p>R0 is a more complicated function than I’m stylizing here (it should be obvious that behavior, like masks, change it. And if a virus was super effective at replicating itself, well it would find new hosts harder to come by). My point is that even smart people will not hear the “This Is Not A Linear Phenomena” song unless their station is tuned to it. The failure to recognize non-linear domains is serious, because it leads to wildy wrong predictions. And life is prediction. We implicitly predict that the sun will rise tomorrow.</p><p>Jensen’s Inequality guides our predictions by forcing us to deliberately consider how the average input maps to the average output. When the function that maps the input to the output is non-linear, Jensen’s Inequality tells us in which direction our predictions will be biased. Stated another way: Jensen’s Inequality informs us when an average occurance is a poor predictor of the average result.</p><p>Before we get to any equations, let’s predict the outcome of a simple game.</p><h3 id="dice-payoff"><strong>Dice Payoff</strong></h3><p>Imagine a game, you stake $1, then roll 2 dice. Whatever the roll returns times your stake amount is how much money you make. That’s the <em>payoff function</em>.</p><p>So if you roll a five you receive $5.</p><p><strong>Question 1: On average, how much do you expect to get paid?</strong></p><p>This is a straightforward expected value problem. You get paid the weighted average of all the outcomes or on average $7.</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/2die.jpg?resize=582%2C337&amp;ssl=1" alt="" loading="lazy" width="582" height="337"/></figure><p>The average value that you roll will correspond to the average value of the payoff function. If that sounds obvious, that’s the point. So far, so good.</p><p><strong>Question 2: If you staked $100, what would you predict the average payoff from playing the game?</strong></p><p>A quick way to estimate that would be to ask yourself, “what do we expect to roll on average?” then multiply that by the staked amount. In this case, we roll a 7 on average, and since the staked amount is $100 then on average when we play this game we expect to be paid out $700.</p><p>That prediction is correct. We can brute force the expected value of the payoffs.</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/2dieEV.jpg?resize=570%2C410&amp;ssl=1" alt="" loading="lazy" width="570" height="410"/></figure><p>At this point, things are feeling pretty obvious and redundant, but let me remind you what we did to just answer Question 2. We used a shortcut. We took the expected value of the roll, which was an input, to estimate the expected value of the<em> payoff function</em> or the output. The shortcut worked because the payoff function was linear. We are just scaling the expected input by the staked amount since the function is simply (dice roll x staked amount). This kind of <em>payoff function</em> exists all around us. When you buy a stock, your<em> p/l function</em> is just <em>change in stock price</em> x <em>share quantity. </em>The “staked amount” in our example performs the same scaling role as <em>share quantity</em>.</p><p>You can feel the twist coming.</p><p><strong>Question 3: Same game but we change the payoff function to (staked amount) x (dice roll)². What’s the average payoff?</strong></p><p>First, what does our shortcut predict? Let’s say we bet $1 again. Since the average value we roll is a 7, then we expect the average payoff to be $7² x $1. So we expect the average payoff of this game to be $49.</p><p>As you may have guessed from the unsubtle narrative arc, $49 is the wrong answer. Our shortcut doesn’t work. Brute force method:</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/2dieEVsquared.jpg?resize=527%2C354&amp;ssl=1" alt="" loading="lazy" width="527" height="354"/></figure><p>It turns out the expected value or average result from the squared game is $54.83, a higher value than what we would predict if we took the average value of the input and simply applied the squared function to it.</p><p>It’s intuitive to take the average value of an input, apply a function to it and call that the “expected value of the function”. It turns out that if the function we run the input through is exponential, our estimate will be wrong. So in service of becoming better at making estimates on the fly, we should get better at thinking about what kind of function we are running an input through and if our prediction is likely to be biased higher or lower than the actual expected value of the payoff function.</p><p>With that long intro we can now turn to Jensen’s Inequality and its practical applications.</p><h3 id="a-look-at-jensen%E2%80%99s-inequality"><strong>A Look At Jensen’s Inequality</strong></h3><p>I’ll start with stating the inequality the way I learned it²:</p><p><strong>…if f(x) is convex</strong></p><p>Let’s try saying this in words several ways, assuming f(x) is convex (a term I will address in a bit):</p><ul><li>The expected value of a function is greater than or equal to the function applied to the expected value of the input.<br/></li><li>The average value of a function is greater than or equal to the function applied to the average input.<br/></li><li>Returning to dice…the [weighted] average of all the squares is greater than the square of the average roll.</li></ul><p>In practice this means, you cannot estimate the average value of the function based on the average value of the input IF the function is exponential.</p><h3 id="convex"><strong>Convex</strong></h3><p>Let’s address the term “convex”. You know what it is visually.</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/yx2.jpg?resize=554%2C337&amp;ssl=1" alt="" loading="lazy" width="554" height="337"/></figure><p>Mathematically, a convex function has a second derivative that is greater than 0, meaning as X increases the slope itself increases. The steepness of the chart is increasing.</p><p>If we go back to the dice example and consider the convex payoff function, we can see the average value of the payoff function of $54.76 is greater than the payoff ($49) at the average roll. In other words, the convex function ensured that:</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/payoffyx-1.jpg?resize=568%2C495&amp;ssl=1" alt="" loading="lazy" width="568" height="495"/><figcaption><b><strong>average value of all payoffs &gt; the payoff of the average roll</strong></b></figcaption></figure><h3 id="concave"><strong>Concave</strong></h3><p>For concave functions, like y = sqrt(x), we have a positive slope, but the slope is decreasing as x increases. The second derivative is negative. Let’s look at a concave case for the dice game by making the payoff function = sqrt(roll).</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/payoffyx12.jpg?resize=638%2C395&amp;ssl=1" alt="" loading="lazy" width="638" height="395"/></figure><p>Notice that the average value of the payoff, if you stake $1, is $2.60. But if you tried to predict the expected payoff by using the shortcut of taking the square root of the average roll you’d predict $2.65 which is the sqrt(7).</p><p>Wait a minute. The prediction this time overshot the true expected value of the function?!</p><p>That’s correct. If you multiply one side of an inequality by -1 you flip the sign…a convex function can be flipped to concave by flipping the sign as well. So a concave function flips the sign of Jensen’s Inequality, making the overshoot the expected result.</p><p>Visualizing the concave payoff:</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/sqrtpayoff.jpg?resize=660%2C581&amp;ssl=1" alt="" loading="lazy" width="660" height="581"/></figure><p>Let’s practice with a highly stylized example I made up, but relates to something we all intuitively feel.</p><h3 id="an-intuitive-example-that-affects-us-all-traffic"><strong>An Intuitive Example That Affects Us All: Traffic!</strong></h3><p>We are celebrating a big W, so it’s time to take the kids to Sizzler. We’re going to drive. Sizzler is 10 minutes away + some extra time depending on how many cars are on the road. Let’s keep things very simple and assume the number of cars that can be on the road is 10, 20, 30, 40, or 50 and with equal probability. None of these quantities is enough to slow the flow of traffic to a halt, but the impact of the extra cars is not linear.</p><p>We’ll create a function called “time to destination” denominated in seconds and make it a function of “cars on the road”:</p><p><strong>f(cars on the road) = x² + 600 </strong></p><p>Let’s play “How long will it take to get to Sizzler?”</p><p>Before you discovered this post, you likely would have said 25 minutes. Why? Since we can have 10, 20, 30, 40, or 50 cars all with equal probability, then on average we expect to see 30 cars on the road.</p><p>302 + 600 = 1500 seconds or 25 minutes.</p><p>But because we know about Jensen’s Inequality we:</p><ol><li>recognize the traffic output function is convex</li><li>realize that the expected value of the traffic function will be greater than sticking the average number of cars in the road into the traffic function</li></ol><p>Enlightened, we instead estimate that on average it will take longer than 25 minutes to pounce on that glorious salad bar with the popcorn shrimp.</p><p>How much longer? Brute force tells us 28.3 minutes!</p><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/carstraffic.jpg?resize=460%2C239&amp;ssl=1" alt="" loading="lazy" width="460" height="239"/></figure><h3 id="spotting-jensen%E2%80%99s-inequality-in-the-wild"><strong>Spotting Jensen’s Inequality In The Wild</strong></h3><p>Here’s a few common applications that abide Jensen’s Inequality</p><ul><li>Geometric mean ≤ arithmetic mean</li><li>Call options</li></ul><figure><img src="https://i0.wp.com/moontowermeta.com/wp-content/uploads/2021/09/callprice.jpg?resize=749%2C382&amp;ssl=1" alt="" loading="lazy" width="749" height="382"/></figure><p>A call option is convex payoff function with respect to the stock price. Its first derivative with respect to the price of a stock is <em>delta</em> which is always positive. In other words, as the stock price goes up, all else equal, the call option always goes up (the slope or delta of a way OTM option is 0 so it’s possible for the call to not change in value, but that’s the lower bound). The second derivative with respect to stock price is <em>gamma</em> and it also is always at least worth 0. That means that as a stock price increases the delta or slope itself increases (or hits the zero lower bound). </p><p>Now let’s go back to Jensen’s Inequality:<br/></p><h3 id="efx-%E2%89%A5-fex"><strong>E[f(x)] ≥ f(E[x])</strong></h3><h3 id="%E2%80%A6if-fx-is-convex"><strong>…if f(x) is convex</strong></h3><p>Substituting words:</p><p>In other words,<strong> the average value of a call will be higher than the value of a call in the average scenario.</strong></p><p>It is easier to see with a binary stock (as opposed to a lognormally distributed stock). Suppose a binary stock is $10. That’s its expected value. Suppose now that the expected value is driven by the fact that it’s 90% to be worth 0 and 10% to be worth $100. The 50-strike call is worthless in the average scenario (since $10 is the weighted average of the scenarios…again that’s what a stock price is by definition).</p><p> But the weighted average of its value over both scenarios is $5 (90% x 0 + 10% x (100-50))</p><p><strong>Again, the average value of a call will be higher than the value of a call in the average scenario.</strong></p><p>So next time somebody uses the logic that they don’t buy options because most options expire worthless you can remind them that the typical outcome is not what drives the value of options. Instead, you should care about the average value of the option over all scenarios.</p><p>By the way, nothing I said here is revelatory. It’s not like any serious person thinks OTM options are worthless in the first place and just prices options based on the stock’s expected value. <br/></p><ul><li>Technology</li><li>Investing</li></ul><h3 id="takeways"><strong>Takeways</strong><br/></h3><p>Be careful when trying to make estimates of how a function or process will pay based upon the average input. If the function has exponential dynamics, Jensen’s Inequality tells us that the weighted average value of the function will not coincide with average input you feed it.</p><p>If the function is convex, the average input will underestimate the average output. If the function is concave, it will overestimate the average output.</p><hr/><p><strong>Footnotes</strong></p><ol><li>assuming nobody ever healed</li><li>I learned about Jensen’s Inequality just last week from this YouTube <a href="https://www.youtube.com/watch?v=HfCb1K4Nr8M&amp;ab_channel=Oxeduc&amp;ref=blog.moontower.ai" rel="noreferrer">clip</a>. The author used the same example of dice, but if you browse my writing you’ll find I use the same example all the time. The point of these posts is to ELI5 and dice are the universal demo. </li><li>I borrowed this from <a href="https://onlinelibrary.wiley.com/cms/asset/1c1b6de4-9750-4dab-905b-1062a8745702/ehr12935-fig-0001-m.jpg?ref=blog.moontower.ai" rel="noreferrer">here</a>.</li><li>If we assume no carry costs or dividends</li></ol>
        </section></div>
  </body>
</html>
