<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://simon-frey.com/tabsub/">Original</a>
    <h1>Show HN: Offline JavaScript PubSub between browser tabs</h1>
    
    <div id="readability-page-1" class="page">
    
    <h2>Offline Javascript PubSub between browser tabs</h2>
    <p>TabSub offers you an easy to use Javascript PubSub via local storage. No server is required as all messages are shared via the browser built in local storage.</p>
    <p>Give the example a try to see what you can build with TabSub.</p>
    <p>Is this safe for a lot of concurrent writes? To be honest I have no clue. I tried to break it with 10 concurrent writers and everything worked as expected: No message got lost and the messages where in correct order. No warranty here, use at your own risk ðŸ˜…</p>
    <p>As TabSub uses local store this only works on the same domain, as the browser separates the local storage by domains as security measure.</p>
    <p>TabSub is on <a href="https://github.com/simonfrey/tabsub">Github</a> and licensed <a href="https://github.com/simonfrey/tabsub/blob/master/LICENSE">MIT</a></p>
    <h4>Today (3.4.2025) I learned, that apparently <a href="https://developer.mozilla.org/en-US/docs/Web/API/Broadcast_Channel_API">BroadcastChannel API</a> does the same thing (has a quite similar usage structure as well)</h4>
    <h2>Example</h2>
    <p>Start one of the two songs and than open this site in a second tab. You will see that the playing song time syncs and if you start the other song that the first one stops.</p>
    <p>Look into the source code of this site to see how I used TabSub to built this example.</p>
    <div>
        <h4>Sad Circus</h4>
        <p><audio controls="" id="sadCircus">
            <source src="mp3/sad_circurs.mp3" type="audio/mpeg"/>
            Your browser does not support the audio element.
        </audio>

    </p></div>

    <div>
        <h4>They say</h4>
        <p><audio controls="" id="theySay">
            <source src="mp3/they_say.mp3" type="audio/mpeg"/>
            Your browser does not support the audio element.
        </audio>
    </p></div>
    <h2>Usage</h2>
    <h3>Including the script</h3>
    <pre><span>&lt;</span>script src<span>=</span><span>&#34;</span><span>https://simon-frey.com/tabsub/tabsub.v1.min.js</span><span>&#34;</span> 
    integrity<span>=</span><span>&#34;</span><span>sha384-WhqYceisw/e1nVVrHA5CI/Lt/c3HrNIZLtPE+sWky3NjzRAF6kt9Ivjp8LwoIS/k</span><span>&#34; <span>&gt;</span>
<span>&lt;</span><span>/</span>script<span>&gt;</span></span></pre>
    <!--Created using ToHtml.com on 2019-11-11 23:22:47 UTC -->
    <h3>Initialization</h3>
    <pre><span>&lt;</span>script<span>&gt;</span>
    <span>const</span> ts <span>=</span> <span>new</span> TabSub<span>(</span><span>)</span><span>;</span>
<span>&lt;</span><span>/</span>script<span>&gt;</span></pre>
      <!--Created using ToHtml.com on 2020-05-21 16:58:00 UTC -->
    <h3>Available functions</h3>

    <h4>publish(topic,msg)</h4>
    <p>Publish new message. The message can be of any type. Your callback in subscribe has to handle it correctly. TabSub does not take care about that.</p>
<pre><span>&lt;</span>script<span>&gt;</span>
    ts<span>.</span>publish<span>(</span><span>&#34;</span><span>hello</span><span>&#34;</span><span>,</span><span>&#34;</span><span>world</span><span>&#34;</span><span>)</span><span>;</span>
<span>&lt;</span><span>/</span>script<span>&gt;</span></pre>
      <!--Created using ToHtml.com on 2020-05-21 16:59:22 UTC -->
    <h4>subscribe(topic, callback)</h4>
    <p>Register new listener. Callback is called with the message content if new message arrives</p>
<pre><span>&lt;</span>script<span>&gt;</span>
    ts<span>.</span>subscribe<span>(</span><span>&#34;</span><span>hello</span><span>&#34;</span><span>,</span><span>(</span>msg<span>)</span><span>=</span><span>&gt;</span><span>{</span>
        console<span>.</span><span>log</span><span>(</span><span>&#34;</span><span>Got msg: </span><span>&#34;</span><span>,</span>msg<span>)</span><span>;</span>
    <span>}</span><span>)</span><span>;</span>
<span>&lt;</span><span>/</span>script<span>&gt;</span></pre>
      <!--Created using ToHtml.com on 2020-05-21 17:00:31 UTC -->
    <h4>state(topic)</h4>
    <p>Get the current (static) state of a topic. Returns the current data in the local storage for this topic</p>
<pre><span>&lt;</span>script<span>&gt;</span>
    <span>const</span> state <span>=</span> ts<span>.</span>state<span>(</span><span>&#34;</span><span>hello</span><span>&#34;</span><span>)</span><span>;</span>
    console<span>.</span><span>log</span><span>(</span><span>&#34;</span><span>Current state: </span><span>&#34;</span><span>,</span>msg<span>)</span><span>;</span>
<span>&lt;</span><span>/</span>script<span>&gt;</span></pre>
      <!--Created using ToHtml.com on 2020-05-21 17:01:40 UTC -->
    <h4>Find my other projects on <a href="https://simon-frey.com/">simon-frey.com</a></h4>
    
    






</div>
  </body>
</html>
