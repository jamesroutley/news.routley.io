<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tech.michaelaltfield.net/2024/03/04/lemmy-fediverse-gdpr/">Original</a>
    <h1>Nightmare on Lemmy Street (A Fediverse GDPR Horror Story)</h1>
    
    <div id="readability-page-1" class="page"><div><p>This article will describe <a href="#delete-image">how lemmy instance admins can purge images</a> from pict-rs (click <a href="#delete-image">here</a> if you just want to know how).</p>
<p><a href="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/lemmy-fediverse-gdpr_featuredImage2.jpg"><img decoding="async" fetchpriority="high" src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2.jpg.pagespeed.ic.Oyl0z53iBF.jpg" alt="Nightmare on Lemmy &#34;A Fediverse GDPR Horror Story&#34;" width="1200" height="628" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2.jpg.pagespeed.ic.Oyl0z53iBF.jpg 1200w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2-300x157.jpg.pagespeed.ic.-3KZ9eJBGM.jpg 300w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2-1024x536.jpg.pagespeed.ic.PLtqEiJOs1.jpg 1024w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2-768x402.jpg.pagespeed.ic.SycVMZOEr1.jpg 768w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2-150x79.jpg.pagespeed.ic.AZcDCjIkT-.jpg 150w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-fediverse-gdpr_featuredImage2-400x209.jpg.pagespeed.ic.IZGw_RV8OW.jpg 400w" sizes="(max-width: 1200px) 100vw, 1200px"/></a></p>
<p>This is (also) a horror story about accidentally uploading very sensitive data to Lemmy, and the (surprisingly) difficult task of deleting it.</p>

<p><strong>tl;dr I (accidentally) uploaded a photo of my State-issued ID to Lemmy, and I couldn&#39;t delete it.</strong></p>
<div id="attachment_3332"><p><a href="https://unsplash.com/photos/topless-man-with-tattoo-on-his-chest-sitting-on-bed-96JPe9cQgBM"><img aria-describedby="caption-attachment-3332" decoding="async" src="https://tech.michaelaltfiueld.net/wp-content/uploads/sites/5/shabie3yoh_000-200x300.jpg" alt="Photo of a person on their phone in bed" width="200" height="300" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xshabie3yoh_000-200x300.jpg.pagespeed.ic.h6SYyLkAV8.jpg 200w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xshabie3yoh_000-683x1024.jpg.pagespeed.ic.e0SFmz3KKh.jpg 683w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xshabie3yoh_000-100x150.jpg.pagespeed.ic.MDIrCKWpRh.jpg 100w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xshabie3yoh_000-400x600.jpg.pagespeed.ic.WVWyF9YaXo.jpg 400w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xshabie3yoh_000.jpg.pagespeed.ic.aklTRVM-Ic.jpg 724w" sizes="(max-width: 200px) 100vw, 200px"/></a></p><p id="caption-attachment-3332">Friends don&#39;t let friends compose jerboa comments in bed before coffee (<a href="https://unsplash.com/@theyshane">@theyshane</a>)</p></div>
<p>A few weeks ago I woke up to my 06:00 AM alarm, snoozed my phone, rubbed my eyes, and started reading <a href="https://sh.itjust.works/c/worldnews">/c/worldnews</a> (on <a href="https://join-lemmy.org">Lemmy</a>).</p>
<p>Still half-asleep, I was typing a comment when my thumb accidentally hit the &#34;upload media&#34; button. Up popped a gallery of images. I tried to click the back button, but I missed. I tapped on a photo. The photo that I tapped-on was a KYC selfie image (that I took the previous day for a <a href="#kyc-plp">service that has no business</a> having such PII anyway).</p>
<p>That was all it took -- two consecutive mis-taps while half-asleep in bed, and my dumb-ass just inadvertently <strong>uploaded a KYC selfie onto the public internet</strong>. And thanks to <a href="#state-auth">archaic State authentication systems</a>, anyone with the URL can now steal my identity.</p>

<p>Like adrenaline to the heart, I jumped out of bed. In such an incident, at least two actions should follow:</p>
<p>1. Delete the credential from the Internet and</p>
<p>Thanks to our <a href="#state-auth">moronic State authentication systems</a>, #2 is all but impossible. Sigh.</p>
<p>As for #1, I tried to delete the image -- but I discovered that the ability to delete images from the Lemmy WUI is a <a href="https://github.com/LemmyNet/lemmy/issues/505">pending feature</a>. Wow.</p>
<p>Yes, <strong>Lemmy users cannot delete images that they&#39;ve uploaded</strong>. Well, there is an API call that you can make, but you need to first get the image&#39;s &#34;delete token&#34;.</p>
<p>(Update: after writing this, I found <em>another</em> <a href="https://github.com/LemmyNet/lemmy/issues/4441">Lemmy bug</a> <strong>preventing lemmy users from deleting their own images via the API</strong> using the documented DELETE query.)</p>
<p>But this is time-sensitive. What other options do we have? Well, you can delete your whole account, right? In fact, when you go to the page to delete your account, it &#34;assures&#34; you with the following message</p>

<p>Perfect! That&#39;s what I want. I mean, it&#39;s a bit overkill -- but it will certainly delete the credential from being publicly-accessible ASAP ðŸ™‚</p>
<p>So I delete the account, confirm the user profile and posts are gone, and refresh the image. It&#39;s still there. I clear cache. It&#39;s still there. I launch a new VM with a fresh install of vanilla firefox. Motherfucker, it&#39;s still there!</p>
<p>Yes, <a href="https://github.com/LemmyNet/lemmy/issues/4433">Lemmy has a bug</a> where <strong>upload images are not deleted when the account is deleted</strong>. Good lord.</p>
<p>Well, I guess self-help is out the window. Let&#39;s contact the admin. Oh, but I can&#39;t do that unless I have an account. And I just deleted my account.</p>
<p>I create a new account and message the admin. Of course, PMs sent on Lemmy are not secure. In fact, there&#39;s a message at the top of the PM page that says</p>
<div id="attachment_3383"><p><a href="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/lemmy-pm-insecure1.jpg"><img aria-describedby="caption-attachment-3383" decoding="async" loading="lazy" src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-pm-insecure1.jpg.pagespeed.ic.L2ubyIYwVo.jpg" alt="Screenshot of a Lemmy &#34;/create_private_message&#34; page that says &#34;Warning: Private messages in Lemmy are not secure. Please create an account on Element.io for secure messaging.&#34;" width="800" height="384" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-pm-insecure1.jpg.pagespeed.ic.L2ubyIYwVo.jpg 800w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-pm-insecure1-300x144.jpg.pagespeed.ic.cGgGsAWDy5.jpg 300w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-pm-insecure1-768x369.jpg.pagespeed.ic.P0kmm-4LKa.jpg 768w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-pm-insecure1-150x72.jpg.pagespeed.ic.XuNo0YkAg-.jpg 150w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-pm-insecure1-400x192.jpg.pagespeed.ic.dBufa8Xijt.jpg 400w" sizes="(max-width: 800px) 100vw, 800px"/></a></p><p id="caption-attachment-3383">Lemmy PMs are not meant to be secure</p></div>
<p>Unfortunately, <strong>the message doesn&#39;t provide the matrix handle for the admin</strong> (but I created a <a href="https://github.com/LemmyNet/lemmy-ui/issues/2361">feature request</a> for this). At this point the credential leak is publicly accessible, but only with a known URL. If, however, I send the URL insecurely then I draw more attention to it -- making the situation worse. Fortunately, after a few hours, I&#39;m able to open an encrypted matrix chat with the instance admin.</p>
<p>Their response:</p>
<blockquote><p>
I can look into how to delete images, I havent actually done that before. Its supposed to be possible using some REST API call but not sure, need to look into it. </p>
<p>The admin tools in lemmy arent very good. :/</p>
<p><code>-Lemmy Instance Admin</code>
</p></blockquote>
<p>Actually, I wasn&#39;t surprised by this. I&#39;ve never run a Lemmy server instance, but I was googling while waiting for the admins&#39;s response -- and I couldn&#39;t find any information on how to purge images in Lemmy. In fact, <strong>admins don&#39;t have a <a href="https://github.com/LemmyNet/lemmy-ui/issues/2359">WUI</a></strong> (or <a href="https://join-lemmy.org/api/">lemmy API</a> calls) <strong>to moderate images</strong> <a href="https://github.com/LemmyNet/lemmy-ui/issues/2360">on lemmy</a> (only for posts &amp; comments). In lemmy, images are handled by a third party component <a href="https://git.asonix.dog/asonix/pict-rs/">pict-rs</a>.</p>

<p><a href="https://git.asonix.dog/asonix/pict-rs/">pict-rs</a> is a third-party simple image hosting service that runs along-side Lemmy for instances that allow users to upload media.</p>
<p>At the time of writing, <a href="https://github.com/LemmyNet/lemmy-ui/issues/2360">there is no WUI for admins to find and delete images</a>. You have to manually query the pict-rs database and execute an API call from the command-line. Worse: Lemmy has <a href="https://github.com/LemmyNet/lemmy-docs/issues/293">no documentation</a> telling instance admins how to delete images ðŸ¤¦</p>
<p>For the purposes of this example, let&#39;s assume you&#39;re trying to delete the following image</p>
<pre title="">https://monero.town/pictrs/image/001665df-3b25-415f-8a59-3d836bb68dd1.webp
</pre>
<p>There are two <a href="https://git.asonix.dog/asonix/pict-rs/">API endpoints in pict-rs</a> that can be used to delete an image</p>
<h2>Method One: /image/delete/{delete_token}/{alias}</h2>
<p>This API call is publicly-accessible, but it first requires you to obtain the image&#39;s `<code>delete_token</code>`</p>
<p>The `<code>delete_token</code>` is first returned by Lemmy when POSTing to the `<code>/pictrs/image</code>` endpoint</p>
<pre title="">{
   &#34;msg&#34;:&#34;ok&#34;,
   &#34;files&#34;:[
      {
         &#34;file&#34;:&#34;001665df-3b25-415f-8a59-3d836bb68dd1.webp&#34;,
         &#34;delete_token&#34;:&#34;d88b7f32-a56f-4679-bd93-4f334764d381&#34;
      }
   ]
}
</pre>
<p>Two pieces of information are returned here:</p>
<ol>
<li><strong>file</strong> (aka the &#34;alias&#34;) is the <em>server</em> filename of the uploaded image</li>
<li><strong>delete_token</strong> is the token needed to delete the image</li>
</ol>
<p>Of course, if you didn&#39;t capture this image&#39;s `<code>delete_token</code>` at upload-time, then you must fetch it from the postgres DB.</p>
<p>First, open a shell on your running postgres container. If you installed Lemmy with docker compose, use `<code>docker compose ps</code>` to get the &#34;SERVICE&#34; name of your postgres host, and then enter it with `<code>docker exec</code>`</p>
<pre title="">docker compose ps --format &#34;table {{.Service}}\t{{.Image}}\t{{.Name}}&#34;
docker compose exec &lt;docker_service_name&gt; /bin/bash
</pre>
<p>For example:</p>
<pre title="">user@host:/home/user/lemmy# docker compose ps --format &#34;table {{.Service}}\t{{.Image}}\t{{.Name}}&#34;
SERVICE    IMAGE                            NAME
lemmy      dessalines/lemmy:0.19.3          lemmy-lemmy-1
lemmy-ui   dessalines/lemmy-ui:0.19.3       lemmy-lemmy-ui-1
pictrs     docker.io/asonix/pictrs:0.5.4    lemmy-pictrs-1
postfix    docker.io/mwader/postfix-relay   lemmy-postfix-1
postgres   docker.io/postgres:15-alpine     lemmy-postgres-1
proxy      docker.io/library/nginx          lemmy-proxy-1
user@host:/home/user/lemmy# 

user@host:/home/user/lemmy# docker compose exec postgres /bin/bash
postgres:/# 
</pre>
<p>Connect to the database as the `<code>lemmy</code>` user</p>
<pre title="">psql -U lemmy
</pre>
<p>For example</p>
<pre title="">postgres:/# psql -U lemmy
psql (15.5)
Type &#34;help&#34; for help.

lemmy=# 
</pre>
<p>Query for the image by the &#34;alias&#34; (the filename)</p>
<pre title="">select * from image_upload where pictrs_alias = &#39;&lt;image_filename&gt;&#39;;
</pre>
<p>For example</p>
<pre title="">lemmy=# select * from image_upload where pictrs_alias = &#39;001665df-3b25-415f-8a59-3d836bb68dd1.webp&#39;;
 local_user_id | pictrs_alias | pictrs_delete_token | published 
---------------+--------------+---------------------+-----------
1149 | 001665df-3b25-415f-8a59-3d836bb68dd1.webp | d88b7f32-a56f-4679-bd93-4f334764d381 | 2024-02-07 11:10:17.158741+00
(1 row)

lemmy=# 
</pre>
<p>Now, take the `<code>pictrs_delete_token</code>` from the above output, and use it to delete the image.</p>
<p>The following command should be able to be run on any computer connected to the internet.</p>
<pre title="">curl -i &#34;https://&lt;instance_domain&gt;/pictrs/image/delete/&lt;pictrs_delete_token&gt;/&lt;image_filename&gt;&#34;
</pre>
<p>For example:</p>
<pre title="">user@disp9140:~$ curl -i &#34;https://monero.town/pictrs/image/delete/d88b7f32-a56f-4679-bd93-4f334764d381/001665df-3b25-415f-8a59-3d836bb68dd1.webp&#34;

HTTP/2 204 No Content
server: nginx
date: Fri, 09 Feb 2024 15:37:48 GMT
vary: Origin, Access-Control-Request-Method, Access-Control-Request-Headers
cache-control: private
referrer-policy: same-origin
x-content-type-options: nosniff
x-frame-options: DENY
x-xss-protection: 1; mode=block
X-Firefox-Spdy: h2
user@disp9140:~$ 
</pre>
<p>â“˜ Note: If you get an `<code>incorrect_login</code>` error, then try [a] logging into the instance in your web browser and then [b] pasting the &#34;<code>https://&lt;instance_domain&gt;/pictrs/image/delete/&lt;pictrs_delete_token&gt;/&lt;image_filename&gt;</code>&#34; URL into your web browser.</p>
<p>The image should be deleted.</p>
<h2>Method Two: /internal/purge?alias={alias}</h2>
<p>Alternatively, you could execute the deletion directly inside the pictrs container. This eliminates the need to fetch the `<code>delete_token</code>`.</p>
<p>First, open a shell on your running `<code>pictrs</code>` container. If you installed Lemmy with docker compose, use `<code>docker compose ps</code>` to get the &#34;SERVICE&#34; name of your postgres host, and then enter it with `<code>docker exec</code>`</p>
<pre title="">docker compose ps --format &#34;table {{.Service}}\t{{.Image}}\t{{.Name}}&#34;
docker compose exec &lt;docker_service_name&gt; /bin/sh
</pre>
<p>For example:</p>
<pre title="">user@host:/home/user/lemmy# docker compose ps --format &#34;table {{.Service}}\t{{.Image}}\t{{.Name}}&#34;
SERVICE    IMAGE                            NAME
lemmy      dessalines/lemmy:0.19.3          lemmy-lemmy-1
lemmy-ui   dessalines/lemmy-ui:0.19.3       lemmy-lemmy-ui-1
pictrs     docker.io/asonix/pictrs:0.5.4    lemmy-pictrs-1
postfix    docker.io/mwader/postfix-relay   lemmy-postfix-1
postgres   docker.io/postgres:15-alpine     lemmy-postgres-1
proxy      docker.io/library/nginx          lemmy-proxy-1
user@host:/home/user/lemmy# 

user@host:/home/user/lemmy# docker compose exec pictrs /bin/sh
~ $ 
</pre>
<p>Execute the following command inside the `<code>pictrs</code>` container.</p>
<pre title="">wget --server-response --post-data &#34;&#34; --header &#34;X-Api-Token: ${PICTRS__SERVER__API_KEY}&#34; &#34;http://127.0.0.1:8080/internal/purge?alias=&lt;image_filename&gt;&#34;
</pre>
<p>For example:</p>
<pre title="">~ $ wget --server-response --post-data &#34;&#34; --header &#34;X-Api-Token: ${PICTRS__SERVER__API_KEY}&#34; &#34;http://127.0.0.1:8080/internal/purge?alias=001665df-3b25-415f-8a59-3d836bb68dd1.webp&#34;
Connecting to 127.0.0.1:8080 (127.0.0.1:8080)
HTTP/1.1 200 OK
content-length: 67
connection: close
content-type: application/json
date: Wed, 14 Feb 2024 12:56:24 GMT

saving to &#39;purge?alias=001665df-3b25-415f-8a59-3d836bb68dd1.webp&#39;
purge?alias=001665df 100% |*****************************************************************************************************************************************************************************************************************************| 67 0:00:00 ETA
&#39;purge?alias=001665df-3b25-415f-8a59-3d836bb68dd1.webp&#39; saved

~ $ 
</pre>
<p>â“˜ Note: There&#39;s an error in the pict-rs reference documentation. It says you can POST to `/internal/delete`, but that just returns <code>404 Not Found</code>.</p>
<p>The image should be deleted</p>

<p>When accidents happen, usually there&#39;s multiple things that went wrong.</p>
<h2>1. I fucked up</h2>
<p>Admittedly, I made some mistakes here.</p>
<h3>Don&#39;t use Lemmy in bed</h3>
<p>I should probably not have been using Lemmy when I was half-asleep. Good luck adhering to that policy, self.</p>
<h3>Device Compartmentalization</h3>
<p>I should own a second device for taking pictures of super-sensitive documents like State-issued IDs. I should never copy such sensitive files onto my everyday phone.</p>
<p>Unfortunately, I only own one phone. And it&#39;s a bit unrealistic to expect most people to have more than one phone (though I do hope one day we&#39;ll have a secure way to <a href="https://github.com/QubesOS/qubes-issues/issues/2233">run dozens of distinct Android VMs</a> on our laptops)</p>
<h3>Data Hygiene</h3>
<p>Immediately after I take a photo of sensitive data, I should transfer it into encrypted storage and then securely wipe the storage on which it was taken.</p>
<h2>2. Lemmy fucked up</h2>
<p>But there&#39;s also many bugs in Lemmy that allowed this nightmare to realize.</p>
<ol>
<li><strong>lemmy users</strong> should be able to easily <strong>delete photos</strong> that they&#39;ve uploaded from <strong>the WUI</strong>. I created a <a href="https://github.com/LemmyNet/lemmy-ui/issues/2359">feature request</a> for this.</li>
<li><strong>lemmy users</strong> should <em>at least</em> be able to <strong>delete their photos via the API</strong>. I created a <a href="https://github.com/LemmyNet/lemmy/issues/4441">bug report</a> for this. See also this <a href="https://github.com/LemmyNet/lemmy/issues/4445">related ticket</a>.</li>
<li>To facilitate GDPR &#34;Right to Erasure&#34; requests, <strong>lemmy admins</strong> should also be given an easy-to-use <strong>WUI for finding &amp; purging images</strong> uploaded by their users. I created a <a href="https://github.com/LemmyNet/lemmy-ui/issues/2360">feature request</a> for this.</li>
<li>In the meantime, <strong>lemmy should document</strong> how lemmy admins can <strong>purge photos</strong> via the CLI. I created a <a href="https://github.com/LemmyNet/lemmy-docs/issues/293">feature request</a> for this.</li>
<li>And, to contact lemmy admins, <strong>the <code>private_message_disclaimer</code></strong> shouldn&#39;t just tell lemmy users to use matrix -- it <strong>should tell them the matrix handle of their instance&#39;s admin</strong>. I created a <a href="https://github.com/LemmyNet/lemmy-ui/issues/2361">feature request</a> for this.
</li><li>Also, <strong>deleting a user account should also delete</strong> all of the user&#39;s data (as it says it will), including <strong>the photos</strong> that the user uploaded. I created a <a href="https://github.com/LemmyNet/lemmy/issues/4433">bug report</a> for this.</li>
<li><strong>lemmy users</strong> should be able to easily <strong>delete photos</strong> that they&#39;ve uploaded from <strong>Jerboa App</strong>. I created a <a href="https://github.com/dessalines/jerboa/issues/1361">feature request</a> for this.</li>
<li><strong>jerboa should add a confirmation step</strong> to the UX <strong>before uploading files</strong> to a lemmy instance. I created a <a href="https://github.com/dessalines/jerboa/issues/1363">feature request</a> for this.</li>
<li>finally, <strong>jerboa should add a setting to never upload any files</strong>. I created a <a href="https://github.com/dessalines/jerboa/issues/1362">feature request</a> for this.</li>
</ol>
<h2>3. Android fucked up</h2>
<div id="attachment_3377"><p><a href="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/lemmy-jebora-media-upload-danger1.jpg"><img aria-describedby="caption-attachment-3377" decoding="async" loading="lazy" src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-jebora-media-upload-danger1-146x300.jpg.pagespeed.ic.3cUW7GMO91.jpg" alt="Screenshot of the jerboa app with the &#34;media upload&#34; icon highlighted, a red arrow pointed to it, and the text &#34;DANGER!&#34; under the arrow" width="146" height="300" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-jebora-media-upload-danger1-146x300.jpg.pagespeed.ic.3cUW7GMO91.jpg 146w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-jebora-media-upload-danger1-498x1024.jpg.pagespeed.ic.A1M9ZXo3-v.jpg 498w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-jebora-media-upload-danger1-73x150.jpg.pagespeed.ic.9ulGRekyQm.jpg 73w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-jebora-media-upload-danger1-400x823.jpg.pagespeed.ic.16Rk3UjSqA.jpg 400w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xlemmy-jebora-media-upload-danger1.jpg.pagespeed.ic.PHDH8sGdYO.jpg 618w" sizes="(max-width: 146px) 100vw, 146px"/></a></p><p id="caption-attachment-3377">If you click this button, you&#39;re one mis-tap away from a world of pain</p></div>
<p>AOSP needs more granular permission settings.</p>
<p>In this instance, Android says that the phone has &#34;No permissions requested.&#34; It doesn&#39;t, for example, have <a href="https://developer.android.com/training/data-storage/manage-all-files">access to my system&#39;s storage</a>.</p>
<p>If I could <a href="https://android.stackexchange.com/questions/256092/permissions-how-to-deny-an-app-intent-action-get-content">deny apps from being able to initiate an ACTION_GET_CONTENT Intent</a>, then I could completely prevent apps from spawning a file-picker -- thereby reducing the risk of accidental information leakage.</p>

<h2 id="state-auth">4. The archaic state of State Auth (in 2024)</h2>

<p>The current moronic solution for authentication by State-issued ID is to just give the document to someone else to read. In this design, the card itself (and a picture of the card) serves as the user&#39;s private key. There are glaring flaws with this design:</p>
<ul>
<li>A picture of the ID is a private key</li>
<li>You give your private key to others</li>
<li>Authentication sessions are vulnerable to replay attacks</li>
</ul>
<p>These problems are easily solved by implementing a <a href="https://en.wikipedia.org/wiki/Electronic_identification">State-issued eID system</a> using <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public key cryptography</a>.</p>
<p>Ideally, the eID system would allow users to easily revoke &amp; replace their (sub)keys, and allow them to make (encrypted) software backups of their eID.</p>
<h2 id="kyc-plp">5. KYC must follow PoLP</h2>
<p>Due to the <a href="#state-auth">issues above</a>, we should very rarely be handing out KYC selfies.</p>
<p>Businesses have no reason to collect KYC data, except to avoid money laundering. For the purposes of AML, it&#39;s unreasonable to track transactions lower than $10,000. Now, this number <a href="https://www.aier.org/article/why-arent-anti-money-laundering-regulations-adjusted-for-inflation/">should be increased for inflation</a> -- but there&#39;s a reason you don&#39;t declare currency when you&#39;re moving <a href="https://en.wikipedia.org/wiki/Anti%E2%80%93money_laundering#Preventive">less than $10,000</a> in cash.</p>
<p>Similarly, if I&#39;m <a href="https://buskill.in/#demo">paying an artist $600</a> on Upwork, there&#39;s zero reason for me to risk identity theft by uploading my secret auth PII to your platform, which is hardly regulated to handle such data with the care it deserves.</p>
<p>Asking for KYC data from customers who transact &lt;$10,000 is a clear violation of the <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">Principle of Least Privilege</a>, and we need consumer protection and data protection laws that <strong>prohibit companies from discriminating against customers who protect themselves</strong> by not providing this information to companies that don&#39;t need it.</p>

<div id="attachment_3400"><p><a href="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/gdpr-sum-fines-2024.01.png"><img aria-describedby="caption-attachment-3400" decoding="async" loading="lazy" src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xgdpr-sum-fines-2024.01.png.pagespeed.ic.bKlNO-N7UL.png" alt="Line chart showing an increase of spending on GDPR fines from Jul 2018 to 4.5 billion EUR on Jan 2024" width="997" height="598" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xgdpr-sum-fines-2024.01.png.pagespeed.ic.bKlNO-N7UL.png 997w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xgdpr-sum-fines-2024.01-300x180.png.pagespeed.ic.iehQxK9TME.png 300w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xgdpr-sum-fines-2024.01-768x461.png.pagespeed.ic.XD4ELf6yb6.png 768w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xgdpr-sum-fines-2024.01-150x90.png.pagespeed.ic._9LnOx4-8B.jpg 150w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xgdpr-sum-fines-2024.01-400x240.png.pagespeed.ic.gwZA1xL-pW.png 400w" sizes="(max-width: 997px) 100vw, 997px"/></a></p><p id="caption-attachment-3400">GDPR Violation fines are often <a href="https://www.enforcementtracker.com/">millions of EUR</a> or a percent of revenue -- whichever is higher</p></div>
<p>Exposing basic moderation tools (eg <code>POST /delete-this-thing</code>) to the WUI is neither a bell nor a whistle. It&#39;s a basic component that should be added before shipping.</p>
<p>If admins can&#39;t click to delete an image, but users <em>can</em> click to upload an image, then that feature should not be released.</p>
<p>This isn&#39;t just annoying -- it&#39;s of significant moral, legal, and financial concern.</p>
<p>This is a legal risk to Lemmy instance admins (GDPR violation). This law applies to any website operating anywhere in the world (not just to websites or businesses located in the EU) that has users who are residents of the EU (so it likely affects &gt;90% of public Lemmy instances with &gt;100 active users).</p>
<p>The fines for this violation are commonly <a href="https://www.enforcementtracker.com/">millions of euros</a> or a percent of revenue, whichever is higher. At the time of writing, websites have been fined <a href="https://www.enforcementtracker.com/?insights">98.4 million EUR</a> for violating this class of GDPR violation (Insufficient fulfillment of data subjects rights).</p>
<p>Making the endpoint accessible over an API is not trivial and therefore doesn&#39;t satisfy this requirement. Google received one <a href="https://www.theverge.com/2022/1/7/22871719/france-fines-google-facebook-cookies-tracking-dark-patterns-eprivacy">fine of 150 million EUR in 2022</a> simply for making it more than 1-click to reject cookies. Certainly requiring a user to figure out how to make API calls (including figuring out the darn delete token, which makes even seasoned admins scratch their heads) would not satisfy the GDPR&#39;s &#34;Right to Erasure&#34; requirement.</p>

<div id="attachment_3498"><p><a href="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/bad-lemmy-devs1.jpg"><img aria-describedby="caption-attachment-3498" decoding="async" loading="lazy" src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs1-216x300.jpg.pagespeed.ic.YSL-B45i8L.jpg" alt="A screenshot of multiple comments in this GitHub Issue" width="216" height="300" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs1-216x300.jpg.pagespeed.ic.YSL-B45i8L.jpg 216w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs1-736x1024.jpg.pagespeed.ic.l8zs27cPdK.jpg 736w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs1-108x150.jpg.pagespeed.ic.Yygo-mC7Lx.jpg 108w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs1-400x557.jpg.pagespeed.ic.hn5faUDNUo.jpg 400w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs1.jpg.pagespeed.ic.vcZUjOaR1h.jpg 763w" sizes="(max-width: 216px) 100vw, 216px"/></a></p><p id="caption-attachment-3498">The Lemmy devs <a href="https://github.com/LemmyNet/lemmy/issues/4433">appear to be</a> intentionally throwing their users and instance admins under the bus</p></div>
<p>Since this incident occurred, I&#39;ve opened numerous bug reports and feature requests.</p>
<p>On GitHub, I&#39;ve been trying to stress the importance of these risks to the lemmy developers. Unfortunately, it seems that they were not taking these moral and legal risks seriously (they <a href="https://github.com/LemmyNet/lemmy/issues/4433#issuecomment-1939172930">said</a> <strong>it may take years before they address them</strong>), and <strong>they threatened to ban me</strong> for trying to highlight the severity of this risk, get them to tag GDPR-related bugs, and to prioritize them.</p>
<ul>
<li><a href="https://github.com/LemmyNet/lemmy/issues/4433">lemmy #4433: Deleted Account should delete uploaded media (pictures) too</a></li>
<li><a href="https://github.com/LemmyNet/lemmy/issues/4441">lemmy #4441: Users unable to delete their images (pictrs API)</a></li>
<li><a href="https://github.com/LemmyNet/lemmy/issues/4434">lemmy #4434: Unapproved users cannot delete their accounts/data</a></li>
<li><a href="https://github.com/LemmyNet/lemmy/issues/3973">lemmy #3973: Banned users cannot delete their accounts/data</a></li>
<li><a href="https://github.com/LemmyNet/lemmy/issues/4445">lemmy #4445:  Create an interface for local users to view and remove images</a></li>
<li><a href="https://github.com/LemmyNet/lemmy-ui/issues/2359">lemmy-ui #2359: Allow users to delete images they uploaded</a></li>
<li><a href="https://github.com/LemmyNet/lemmy-ui/issues/2360">lemmy-ui #2360: Allow admins to view &amp; delete uploaded images</a></li>
<li><a href="https://github.com/LemmyNet/lemmy-ui/issues/2361">lemmy-ui #2361: private_message_disclaimer to include user&#39;s matrix handle </a></li>
<li><a href="https://github.com/dessalines/jerboa/issues/1361">jerboa #1361: UI for deleting uploaded files</a></li>
<li><a href="https://github.com/dessalines/jerboa/issues/1362">jerboa #1362: Setting to hide &#34;upload media&#34; button</a></li>
<li><a href="https://github.com/dessalines/jerboa/issues/1363">jerboa #1363: Add &#34;confirm upload&#34; step to UX</a></li>
<li><a href="https://github.com/LemmyNet/lemmy-docs/issues/293">lemmy-docs #293: Document image moderation</a></li>
</ul>
<p>If GDPR-compliance is important to you on the fediverse, then please provide feedback to the Lemmy developers in the GitHub links above.</p>
<div id="attachment_3499"><p><a href="https://github.com/LemmyNet/lemmy/issues/4433#issuecomment-1939275302"><img aria-describedby="caption-attachment-3499" decoding="async" loading="lazy" src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs2.jpg.pagespeed.ic.WH1wDHH_uK.jpg" alt="A &lt;a href=&#34;https://github.com/LemmyNet/lemmy/issues/4433#issuecomment-1939275302&#34;&gt;comment&lt;/a&gt; by Lemmy dev &#34;dessalines&#34; reads &#34;Would you mind if we set some of your priorities also? You&#39;re asking us to do free labor for you, that you&#39;re unwilling to do yourself. Do not put ultimatums and demands on people making FOSS, or I won&#39;t hesitate to block you from these repos.&#34;" width="763" height="227" srcset="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs2.jpg.pagespeed.ic.WH1wDHH_uK.jpg 763w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs2-300x89.jpg.pagespeed.ic.xOBcwpMdUg.jpg 300w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs2-150x45.jpg.pagespeed.ic.Zyd_9mjQ-z.jpg 150w, https://tech.michaelaltfield.net/wp-content/uploads/sites/5/xbad-lemmy-devs2-400x119.jpg.pagespeed.ic.Lbx9Huwshb.jpg 400w" sizes="(max-width: 763px) 100vw, 763px"/></a></p><p id="caption-attachment-3499">Lemmy devs <a href="https://github.com/LemmyNet/lemmy/issues/4433#issuecomment-1939275302">getting hostile</a> when I try to advocate for prioritization of Lemmy&#39;s GDPR bugs</p></div>
<div itemtype="http://schema.org/Person" itemscope="" itemprop="author"><div><p><img src="https://tech.michaelaltfield.net/wp-content/uploads/sites/5/2019/04/100x100xavatar_square_150.jpg.pagespeed.ic.lvLST4AWRQ.jpg" width="100" height="100" alt="headshot of Michael Altfield" itemprop="image"/></p><div><div itemprop="description"><p>Hi, Iâ€™m Michael Altfield. I write articles about opsec, privacy, and devops <a href="https://michaelaltfield.net/biography/">âž¡</a></p>
<p><a href="https://michaelaltfield.net/biography/">About Michael</a></p>
</div></div></div></div></div></div>
  </body>
</html>
