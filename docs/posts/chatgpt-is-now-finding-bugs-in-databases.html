<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://celerdata.com/blog/chatgpt-is-now-finding-bugs-in-databases">Original</a>
    <h1>ChatGPT is now finding bugs in databases</h1>
    
    <div id="readability-page-1" class="page"><div>
    <p><span id="hs_cos_wrapper_post_body" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><div data-page-id="ZyCcdzwKCoshkyxcbeRcOuGYnhb" data-docx-has-block-data="true">
<p>ChatGPT has dominated the public&#39;s attention over the last few months, creating entirely new industries, tools, and changes to how we work almost overnight. Millions of users across the globe have put ChatGPT&#39;s AI power to the test, and while there&#39;s no shortage of limitations with the software, some fairly amazing use cases are starting to show up.</p>
<p>One such use case is ChatGPT&#39;s ability to make database testing more efficient. Recently, contributors to the open source Linux project <a href="https://celerdata.com/blog/starrocks-a-unified-olap-database-for-blazing-fast-analytics" rel="noopener">StarRocks</a> put ChatGPT to the test against several popular automated testing tools to see what advantages, if any, the AI-powered chat platform could offer.</p>

<h2>ChatGPT vs. Popular Database Testing Tools</h2>
<p>The results of the StarRocks community&#39;s test were impressive. ChatGPT was able to hold its own when put up against other existing, and popular, automated testing tools including SQLsmith and SQLancer. The results of the tests were enlightening, and with ChatGPT&#39;s ability to learn and adapt, it seems likely that this is only the beginning of what ChatGPT is capable of for improving database testing.</p>

<h2>ChatGPT vs. SQLsmith</h2>
<p>SQLsmith is an automated database testing tool that generates random SQL queries based on a fixed table schema and executes the queries against the database to test its performance and robustness.</p>
<p>ChatGPT is well-positioned to replace the work of SQLsmith, and can generate random, complex SQL queries based on natural language inputs with ease. While it&#39;s too early to tell if ChatGPT is ready to completely eliminate the need for SQLsmith, it&#39;s certainly worth evaluating for anyone already using the tool.</p>
<p>The following figure offers a great example of how ChatGPT constructs a complex SQL query based on a user&#39;s input:</p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%201.webp" alt="ChatGPT Creating Complex Queries." width="795" height="1068" loading="lazy"/></p>
<p><em>Figure 1: </em><em>ChatGPT</em><em> creating a complex </em><em>query</em><em>.</em></p>

<h3><span>ChatGPT</span><span>: Great for Maintaining SQLsmith</span></h3>
<p>While testing ChatGPT against SQLsmith, another valuable use case presented itself: ChatGPT could be great for maintaining automated database testing tools. Anyone who has used these tools recognizes this is a major pain point. Every time a new function, operator, or data type is added, engineers need to update the source code of their tools like SQLsmith and SQLancer. This is both tedious and time-consuming.</p>
<p>To validate whether ChatGPT could effectively take on this task, StarRocks developers asked ChatGPT to write a query using StarRocks JSON functions. Initially, ChatGPT replied that StarRocks didn&#39;t support JSON functions, but after feeding StarRocks&#39; JSON docs to ChatGPT, ChatGPT was able to learn from the docs and successfully generates an SQL query with StarRocks JSON functions.</p>
<p>The following figures show this learning process in action:</p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%202.webp" alt="ChatGPT Training Needs" width="795" height="621" loading="lazy"/></p>
<p><em>Figure 2: In some cases, </em><em>ChatGPT</em><em> will need to be trained a bit before it&#39;s ready to go.</em></p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%203.webp" alt="Training ChatGPT With StarRocks&#39; JSON functions" width="795" height="428" loading="lazy"/></p>
<p><em>Figure 3: Training </em><em>ChatGPT</em><em> to understand StarRocks&#39; </em><em>JSON</em><em> functions.</em></p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%204.webp" alt="ChatGPT StarRocks JSON Function SQL" width="795" height="758" loading="lazy"/></p>
<p><em>Figure: 4: </em><em>ChatGPT</em><em> generates a SQL </em><em>query</em><em> with StarRocks </em><em>JSON</em><em> functions.</em></p>

<p>It&#39;s clear that ChatGPT may not be ready to go right out of the box, but it demonstrates an amazing ability to quickly learn and adapt when the necessary learning materials are provided.</p>

<h2>ChatGPT vs. SQLancer</h2>
<p>Seeing how well ChatGPT fared versus SQLsmith, it made sense to see how ChatGPT compared to SQLancer by testing against SQLancer&#39;s Ternary Logic Partitioning (TLP) principle.</p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%205.webp" alt="Ternary Logic Partitioning (TLP)" width="795" height="335" loading="lazy"/></p>
<p><em>Figure 5: Ternary Logic Partitioning (TLP).</em></p>

<p>The preceding figure is a schematic of the TLP principle, in which a random SQL query (Q) and a predicate (P) are provided, with three predicates (P, not P, and P is null) being applied to the query. A Union All is then performed on the results of the three queries. The checkmark in the diagram means the result is consistent with the original SQL query and the bug means the opposite.</p>
<p>Initially, this was not something ChatGPT could handle, but after nearly a dozen training sessions, ChatGPT developed the ability to generate an equivalent SQL based on the TLP principle.</p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%206.webp" alt="TLP-Based ChatGPT SQL" width="795" height="1128" loading="lazy"/></p>
<p><em>Figure 6: </em><em>ChatGPT</em><em> develops SQL based on TLP.</em></p>

<p>This, however, doesn&#39;t prove by itself that ChatGPT can act as a replacement to SQLancer. Since a complete SQLancer TLP test involves two additional steps: random table creation and data insertion, ChatGPT needs to hand this as well. Fortunately, this is very simple for ChatGPT. You can see the process below:</p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%207.webp" alt="ChatGPT Instructions" width="795" height="565" loading="lazy"/></p>
<p><em>Figure 7: Providing instructions to </em><em>ChatGPT</em><em>.</em></p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%208.webp" alt="ChatGPT Generates Tables Using StarRocks Syntax" width="795" height="739" loading="lazy"/></p>
<p><em>Figure 8: </em><em>ChatGPT</em><em> generates the table in StarRocks syntax.</em></p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%209.webp" alt="ChatGPT Generates Select SQL" width="795" height="251" loading="lazy"/></p>
<p><em>Figure 9: </em><em>ChatGPT</em><em> generates the select SQL with aggregate and window functions.</em></p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%2010.webp" alt="ChatGPT Generates SQL and UNION ALL Queries" width="795" height="865" loading="lazy"/></p>
<p><em>Figure 10: </em><em>ChatGPT</em><em> generates SQL with three separate UNION ALL queries.</em></p>

<h3>ChatGPT for Query-Aware Table Creation Statements</h3>
<p>By this point, the StarRocks community was able to confirm that ChatGPT could (to a reasonable degree):</p>
<ul>
<li data-list="number">
<p>Automate table creation and data loading.</p>
</li>
<li data-list="number">
<p>Automatically generate test SQL.</p>
</li>
<li data-list="number">
<p>Automatically generate a test oracle (confirm whether the SQL execution results are as expected).</p>
</li>
</ul>

<p>And while these initial results from the ChatGPT vs. SQLancer experiments were exciting, they didn&#39;t completely answer the question as to whether or not ChatGPT can act as a replacement for these testing tools. In order to better answer this question, ChatGPT needs to be able to prove that it can handle four additional requirements. Those are:</p>
<ul>
<li data-list="number">
<p>Automatically generated SQL must be syntactically and semantically correct.</p>
</li>
<li data-list="number">
<p>Automatically generated schema and datasets must be valid.</p>
</li>
<li data-list="number">
<p>Automatically generated SQL code can cover a wide variety of scenarios.</p>
</li>
<li data-list="number">
<p>There is an efficient way to verify that the SQL execution result is correct.</p>
</li>
</ul>

<p>Query-Aware table creation statements are actually a great solution for addressing the requirements and challenges listed above. This made testing ChatGPT&#39;s ability to generate Query-Aware table creation statements a reliable way to evaluate ChatGPT&#39;s effectiveness as a testing tool.</p>
<p>Query-Aware means that table creation and data loading are oriented for SQL queries and guarantee that the test query can get the desired query results as defined in a given test case. It turns out that ChatGPT can handle this with ease.</p>

<p><img src="https://celerdata.com/hubfs/ChatGPT%2011.webp" alt="Testing ChatGPT for Query-Aware Table Creation Statements." width="795" height="1233" loading="lazy"/></p>
<p><em>Figure 11: Testing </em><em>ChatGPT</em><em> for Query-Aware table creation statements.</em></p>

<h2>ChatGPT: A More Efficient Way To Test Databases</h2>
<p>The StarRocks community&#39;s tests show that ChatGPT has great potential for improving automated testing efficiency, but it still has some work to do. ChatGPT still requires additional support to fully understand the basic logic of automated testing, such as the basic rewrite principles of SQLancer&#39;s TLP.</p>
<p>After dozens of hours of training, ChatGPT still does not fully understand the TLP principle, and the predicates in some of its rewritten SQL are wrong. All things considered, however, sufficient training may help ChatGPT fully understand this logic at some point in the near future.</p>
<p>This doesn&#39;t seem like such a high bar for ChatGPT to clear, as ChatGPT&#39;s biggest advantage is its amazing (and scary) ability to learn quickly. Even if it may be a while before ChatGPT is able to write test cases for new features more efficiently than humans, there&#39;s no doubt that ChatGPT will help humans improve the efficiency and accuracy of the work they&#39;re doing today.</p>
</div></span></p>
    

    
  </div></div>
  </body>
</html>
