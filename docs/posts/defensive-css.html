<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ishadeed.com/article/defensive-css/">Original</a>
    <h1>Defensive CSS</h1>
    
    <div id="readability-page-1" class="page"><div>
		
		<p>Oftentimes, we wish that there was a way to avoid a certain CSS issue or behaviors from happening. You know, content is dynamic, and things can change on a web page, thus increasing the possibility of a CSS issue or a weird behavior.</p>

<p>Defensive CSS is a collection of snippets that can help you in writing CSS that is protected. In other words, you will have fewer issues in the future. If you follow my blog, you might read an <a href="https://ishadeed.com/article/the-just-in-case-mindset-css/">article</a> I wrote a while back which is called “The just in case mindset”. This is built upon it, and will be an ongoing list of snippets. If you have any suggestions, please feel free to let me know about it.</p>

<h2 id="table-of-contents">Table of contents</h2>

<ul>
    <li><a href="#flexbox-wrapping">Flexbox wrapping</a></li>
    <li><a href="#spacing">Spacing</a></li>
    <li><a href="#long-content">Long content</a></li>
    <li><a href="#prevent-an-image-from-being-stretched-or-compressed">Prevent an image from being stretched or
            compressed</a></li>
    <li><a href="#lock-scroll-chaining">Lock scroll chaining</a></li>
    <li><a href="#css-variable-fallback">CSS variable fallback</a></li>
    <li><a href="#using-fixed-width-or-height">Using fixed width or height</a>

        <ul>
            <li><a href="#the-fixed-height">The fixed height</a></li>
            <li><a href="#the-fixed-width">The fixed width</a></li>
        </ul>
    </li>
    <li><a href="#forgetting-background-repeat">Forgetting <code>background-repeat</code></a></li>
    <li><a href="#vertical-media-queries">Vertical media queries</a></li>
    <li><a href="#using-justify-content-space-between">Using <code>justify-content: space-between</code></a>
    </li>
    <li><a href="#text-over-images">Text over images</a></li>
    <li><a href="#be-careful-with-fixed-values-in-a-css-grid">Be careful with fixed values in a CSS grid</a>
    </li>
    <li><a href="#show-a-scrollbar-only-when-its-needed">Show a scrollbar only when it&#39;s needed</a></li>
    <li><a href="#scrollbar-gutter">Scrollbar gutter</a></li>
    <li><a href="#minimum-content-size-in-css-flexbox">Minimum content size in CSS flexbox</a></li>
    <li><a href="#minimum-content-size-in-css-grid">Minimum content size in CSS grid</a></li>
    <li><a href="#auto-fit-vs-auto-fill">Auto fit vs auto fill</a></li>
    <li><a href="#image-maximum-width">Image maximum width</a></li>
    <li><a href="#position-sticky-css-grid">position: sticky css grid</a></li>
    <li><a href="#grouping-selectors">Grouping selectors</a></li>
</ul>

<h2 id="flexbox-wrapping">Flexbox wrapping</h2>
<p>CSS flexbox is one of the most useful CSS layout features nowadays. It’s tempting to add <code>display: flex</code> to a wrapper and have the child items ordered next to each other.</p>

<p>The thing is when there is not enough space, those child items won’t wrap into a new line by default. We need to change that behavior with <code>flex-wrap: wrap</code>.</p>

<p>Here is a typical example. We have a group of options that should be displayed next to each other.</p>

<div><div><pre><code><span>.options-list</span> <span>{</span>
    <span>display</span><span>:</span> <span>flex</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>When there is less space, horizontal scrolling will occur. That’s should be expected and isn’t actually a “problem”.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-1-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Notice how the items are still next to each other. To fix that, we need to allow flex wrapping.</p>

<div><div><pre><code><span>.options-list</span> <span>{</span>
    <span>display</span><span>:</span> <span>flex</span><span>;</span>
    <span>flex-wrap</span><span>:</span> <span>wrap</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-1-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>A general rule of thumb when using flexbox is to allow wrapping unless you want a scrolling wrapper. That’s another thing, but try to use <code>flex-wrap</code> to avoid unexpected layout behaviors (horizontal scrolling, in our case).</p>

<h2 id="spacing">Spacing</h2>
<p>We developers need to account for different content lengths. That means, spacing should be added to a component, even though it seems like not needed.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-2-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>In this example, we have a section title and an action button on the right side. Currently, it looks okay. But let’s see what happens when the title is longer.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-2-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Notice how the text is too close to the action button? You might be thinking about multi-line wrapping, but I will come to that in another section. For now, let’s focus on the spacing.</p>

<p>If the title has spacing and text truncation, we won’t see such an issue.</p>

<div><div><pre><code><span>.section__title</span> <span>{</span>
    <span>margin-right</span><span>:</span> <span>1rem</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-2-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h2 id="long-content">Long content</h2>
<p>Accounting for long content is important when building layout. As you might saw in the previous, the section title is truncated when it’s too long. That is optional, but for some UIs it’s important to account for that.</p>

<p>For me, this is a defensive CSS approach. It’s nice to get to fix the “problem” before it actually happens.</p>

<p>Here is a list of people’s names and it looks perfect for now.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-3-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>However, since this is user-generated content, we need to be careful about how to <strong>defense</strong> the layout in case of something too long.</p>

<p>See the following figure:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-3-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>In such layouts, consistency is important. To achieve that, we can simply truncate the name by using <code>text-overflow</code> and its friends.</p>

<div><div><pre><code><span>.username</span> <span>{</span>
    <span>white-space</span><span>:</span> <span>nowrap</span><span>;</span>
    <span>overflow</span><span>:</span> <span>hidden</span><span>;</span>
    <span>text-overflow</span><span>:</span> <span>ellipsis</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-3-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>If you’re interested to sharpen your skills in handling long content in CSS, I <a href="https://ishadeed.com/article/css-short-long-content/">wrote a detailed article</a> on that topic.</p>

<h2 id="prevent-an-image-from-being-stretched-or-compressed">Prevent an image from being stretched or compressed</h2>
<p>When we don’t have control over an image’s aspect ratio on a web page, it’s better to think ahead and provide a solution when a user uploads an image that isn’t aligned with the aspect ratio.</p>

<p>In the following example, we have a card component with a photo. It looks good.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-4-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>When the user uploads an image of a different size, it will be stretched. This isn’t good. Look at how the image is stretched!</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-4-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>The simplest fix for that is to use CSS <code>object-fit</code>.</p>

<div><div><pre><code><span>.card__thumb</span> <span>{</span>
    <span>object-fit</span><span>:</span> <span>cover</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-4-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>On a project level, I prefer to add <code>object-fit</code> to <strong>all images</strong> to avoid unexpected image results.</p>

<div><div><pre><code><span>img</span> <span>{</span>
    <span>object-fit</span><span>:</span> <span>cover</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Learn more about <code>object-fit</code> in <a href="https://www.smashingmagazine.com/2021/10/object-fit-background-size-css/">this article</a> on Smashing Magazine.</p>


<p>Have you ever opened a modal and started scrolling, and then when you reach the end and keep scrolling, the content underneath the modal (the body element) will scroll? This is called <strong>scroll chaining</strong>.</p>

<p>There have been a few hacks to make this work in the past years, but now, we can do that with CSS only, thanks to the <code>‌overscroll-behavior</code> CSS property.</p>

<p>In the following figure, you see the default scroll chaining behavior.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-5-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>To avoid that ahead of time, we can add that to any component that needs to scroll (e.g: chat component, mobile menu.. etc). The nice thing about this property is that it won’t have an effect until there is scrolling.</p>

<div><div><pre><code><span>.modal__content</span> <span>{</span>
    <span>overscroll-behavior-y</span><span>:</span> <span>contain</span><span>;</span>
    <span>overflow-y</span><span>:</span> <span>auto</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-5-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>In case you want to learn more about it, I wrote <a href="https://ishadeed.com/article/prevent-scroll-chaining-overscroll-behavior/">a detailed article</a> on that.</p>

<h2 id="css-variable-fallback">CSS variable fallback</h2>
<p>CSS variables are gaining more and more usage in web design. There is a method that we can apply to use them in a way that doesn’t break the experience, in case the CSS variable value was empty for some reason.</p>

<p>This is particularly useful when feeding the value of a CSS variable via Javascript. Here is an example:</p>

<div><div><pre><code><span>.message__bubble</span> <span>{</span>
    <span>max-width</span><span>:</span> <span>calc</span><span>(</span><span>100%</span> <span>-</span> <span>var</span><span>(</span><span>--actions-width</span><span>));</span>
<span>}</span>
</code></pre></div></div>

<p>The variable <code>--actions-width</code> is being used within the <code>calc()</code> function and its value is coming from Javascript. Let’s suppose that Javascript failed for some reason, what will happen? The <code>max-width</code> will compute to <code>none</code>.</p>

<p>We can avoid that ahead of time and add a fallback value to the <code>var()</code>.</p>

<div><div><pre><code><span>.message__bubble</span> <span>{</span>
    <span>max-width</span><span>:</span> <span>calc</span><span>(</span><span>100%</span> <span>-</span> <span>var</span><span>(</span><span>--actions-width</span><span>,</span> <span>70px</span><span>));</span>
<span>}</span>
</code></pre></div></div>

<p>That way, if the variable isn’t defined, the fallback (<code>70px</code>) will be used. This approach can be used in case there is a possibility that the variable might fail (e.g: coming from Javascript). Otherwise, it’s not needed.</p>

<h2 id="using-fixed-width-or-height">Using fixed width or height</h2>
<p>One of the common things that break a layout is using a fixed width or height with an element that has content in different lengths.</p>

<h3 id="the-fixed-height">The fixed height</h3>
<p>I often see a hero section with a fixed height and content that is larger than that height, which results in a broken layout. Not sure how that looks? Here it is.</p>



<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-6-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>To avoid the content leaking out of the hero, we need to use <code>min-height</code> instead of <code>height</code>.</p>

<div><div><pre><code><span>.hero</span> <span>{</span>
    <span>min-height</span><span>:</span> <span>350px</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-6-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>That way, if the content gets larger, the layout won’t break.</p>

<h3 id="the-fixed-width">The fixed width</h3>
<p>Have you ever seen a button that has its label too close to the left and right edges? This is due to using a fixed width.</p>

<div><div><pre><code><span>.button</span> <span>{</span>
    <span>width</span><span>:</span> <span>100px</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>If the button’s label is longer than <code>100px</code>, it will be close to the edges. If it’s too long, the text will leak out of it. This isn’t good!</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-7-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>To fix that, we can simply replace <code>width</code> with <code>min-width</code>.</p>

<div><div><pre><code><span>.button</span> <span>{</span>
    <span>min-width</span><span>:</span> <span>100px</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<h2 id="forgetting-background-repeat">Forgetting <code>background-repeat</code></h2>
<p>Oftentimes, when using a large image as a background, we tend to forget to account for the case when the design is viewed on a large screen. That background will <strong>repeat</strong> by default.</p>

<p>This mostly won’t be visible on a laptop screen, but it can be seen clearly on larger screens.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-8-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>To avoid that behavior in advance, make sure to reset <code>background-repeat</code>.</p>

<div><div><pre><code><span>.hero</span> <span>{</span>
    <span>background-image</span><span>:</span> <span>url(&#39;..&#39;)</span><span>;</span>
    <span>background-repeat</span><span>:</span> <span>no-repeat</span><span>;</span>
<span>}</span>
</code></pre></div></div>


<p>Sometimes, it’s so tempting to build a component and only test by resizing the browser’s width. Testing against the browser’s height can reveal some interesting problems.</p>

<p>Here is one that I’ve seen multiple times. We have an aside component with main and secondary links. The secondary links should be positioned at the very bottom of the aside section.</p>

<p>Consider the following example. The main and secondary navigation looks okay. In the example that I saw, the developer added <code>position: sticky</code> to the secondary navigation so that it can stick to the bottom.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-9-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>However, if the browser height is smaller, things will break. Notice how the two navigations are overlapped.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-9-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>By using CSS vertical media queries, we can avoid that issue.</p>

<div><div><pre><code><span>@media</span> <span>(</span><span>min-height</span><span>:</span> <span>600px</span><span>)</span> <span>{</span>
    <span>.aside__secondary</span> <span>{</span>
        <span>position</span><span>:</span> <span>sticky</span><span>;</span>
        <span>bottom</span><span>:</span> <span>0</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre></div></div>

<p>That way, the secondary navigation will only be sticked to the bottom <strong>if the viewport height is larger than or equals 600px</strong>. Much better, right?</p>

<p>There are probably better ways to implement that behavior (like using <code>margin-auto</code>) but I’m focusing on the vertical query for this example.</p>

<p>If I want to explain using CSS vertical media query, I need to write a full article about it. The good news is that I already <a href="https://ishadeed.com/article/responsive-design-height/">wrote one</a>, in case you’re interested.</p>

<h2 id="using-justify-content-space-between">Using <code>justify-content: space-between</code></h2>
<p>In a flex container, you might use <code>justify-content</code> to space the child items from each other. With a certain number of child items, the layout will look okay. However, when they increase or decrease, the layout will look odd.</p>

<p>Consider the following example.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-10-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>We have a flex container with four items. The spacing between each item isn’t a <code>gap</code> or <code>margin</code>, it’s there because the container has <code>justify-content: space-between</code>.</p>

<div><div><pre><code><span>.wrapper</span> <span>{</span>
    <span>display</span><span>:</span> <span>flex</span><span>;</span>
    <span>flex-wrap</span><span>:</span> <span>wrap</span><span>;</span>
    <span>justify-content</span><span>:</span> <span>space-between</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>When the number of items is less than four, here is what will happen.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-10-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>This isn’t good. There are different solutions to this:</p>
<ul>
  <li>Margin</li>
  <li>Flexbox gap (Use with caution)</li>
  <li>Padding (Can be applied to the parent of each child element)</li>
  <li>Adding <a href="https://ishadeed.com/article/new-facebook-css/#empty-elements-for-flexbox-grids">empty elements</a> to act as a spacer.</li>
</ul>

<p>For simplicity, I will use <code>gap</code>.</p>

<div><div><pre><code><span>.wrapper</span> <span>{</span>
    <span>display</span><span>:</span> <span>flex</span><span>;</span>
    <span>flex-wrap</span><span>:</span> <span>wrap</span><span>;</span>
    <span>gap</span><span>:</span> <span>1rem</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-10-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h2 id="text-over-images">Text over images</h2>
<p>When using the text over an imaging approach, it’s important to account for the case where the image fails to load. How the text will look like?</p>

<p>Here is an example.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-11-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>The text looks readable, but when the image fails to load, it won’t.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-11-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>We fix that easily by adding a background color to the <code>&lt;img&gt;</code> element. This background will only be visible if the image fails to load. Isn’t that cool?</p>

<div><div><pre><code><span>.card__img</span> <span>{</span>
    <span>background-color</span><span>:</span> <span>grey</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-11-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h2 id="be-careful-with-fixed-values-in-a-css-grid">Be careful with fixed values in a CSS grid</h2>
<p>Say we have a grid that contains an aside and main. The CSS looks like this:</p>

<div><div><pre><code><span>.wrapper</span> <span>{</span>
    <span>display</span><span>:</span> <span>grid</span><span>;</span>
    <span>grid-template-columns</span><span>:</span> <span>250px</span> <span>1</span><span>fr</span><span>;</span>
    <span>gap</span><span>:</span> <span>1rem</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>This will break on small viewport sizes due to the lack of space. To avoid such an issue, always use a media query when using CSS grid like the above.</p>

<div><div><pre><code><span>@media</span> <span>(</span><span>min-width</span><span>:</span> <span>600px</span><span>)</span> <span>{</span>
    <span>.wrapper</span> <span>{</span>
        <span>display</span><span>:</span> <span>grid</span><span>;</span>
        <span>grid-template-columns</span><span>:</span> <span>250px</span> <span>1</span><span>fr</span><span>;</span>
        <span>gap</span><span>:</span> <span>1rem</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre></div></div>


<p>Luckily, we can control to show a scrollbar or not only in the case of having a long content. That being said, it’s highly recommended to use <code>auto</code> as a value for <code>overflow</code>.</p>

<p>Consider the following example.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-12-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Notice how even if the content is short, there is a scrollbar visible. This isn’t good for a UI. As a designer, it’s just confusing to see a scrollbar when it’s not needed.</p>

<div><div><pre><code><span>.element</span> <span>{</span>
    <span>overflow-y</span><span>:</span> <span>auto</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>With <code>overflow-y: auto</code>, the scrollbar will only be visible if the content is long. Otherwise, it won’t be there. Here is an updated figure.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-12-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>


<p>Another thing that is related to scrolling is the <a href="https://ishadeed.com/article/custom-scrollbars-css/#scrollbar-gutter">scrollbar gutter</a>. Taking the previous example, when the content gets longer, adding a scrollbar will cause a layout shift. The reason the layout shift happens is to reserve a space for the scrollbar.</p>

<p>Consider the following figure.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-13-1.jpg" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Notice how the content shifted when it became longer as a result of showing a scrollbar. We can avoid that behavior by using the <code>scrollbar-gutter</code> property.</p>

<div><div><pre><code><span>.element</span> <span>{</span>
    <span>scrollbar-gutter</span><span>:</span> <span>stable</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-13-2.jpg" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h2 id="minimum-content-size-in-css-flexbox">Minimum content size in CSS flexbox</h2>
<p>If a flex item has a text element or an image that is bigger than is longer than the item itself, the browser won’t shrink them. That is the default behavior for flexbox.</p>

<p>Consider the following example.</p>



<p>When the title has a very long word, it won’t wrap into a new line.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-14-1.jpg" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Even if we use <code>overflow-break: break-word</code>, it won’t work.</p>

<div><div><pre><code><span>.card__title</span> <span>{</span>
    <span>overflow-wrap</span><span>:</span> <span>break-word</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>To change that default behavior, we need to set the <code>min-width</code> of the flex item to <code>0</code>. That’s because the <code>min-width</code> default value is <code>auto</code>, the overflow happens.</p>

<div><div><pre><code><span>.card__title</span> <span>{</span>
    <span>overflow-wrap</span><span>:</span> <span>break-word</span><span>;</span>
    <span>min-width</span><span>:</span> <span>0</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>The same thing applies to a column flex wrapper, but we will use <code>min-height: 0</code> instead.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-14-2.jpg" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h2 id="minimum-content-size-in-css-grid">Minimum content size in CSS grid</h2>
<p>Similar to flexbox, CSS grid has a default minimum content size for its child items which is <code>auto</code>. That means, if there is an element that is larger than the grid item, it will overflow.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-15-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>In the example above, we have a carousel within the main section. For context, here is the HTML and CSS.</p>

<div><div><pre><code><span>&lt;div</span> <span>class=</span><span>&#34;wrapper&#34;</span><span>&gt;</span>
    <span>&lt;main&gt;</span>
        <span>&lt;section</span> <span>class=</span><span>&#34;carousel&#34;</span><span>&gt;&lt;/section&gt;</span>
    <span>&lt;/main&gt;</span>
    <span>&lt;aside&gt;&lt;/aside&gt;</span>
<span>&lt;/div&gt;</span>
</code></pre></div></div>

<div><div><pre><code><span>@media</span> <span>(</span><span>min-width</span><span>:</span> <span>1020px</span><span>)</span> <span>{</span>
    <span>.wrapper</span> <span>{</span>
        <span>display</span><span>:</span> <span>grid</span><span>;</span>
        <span>grid-template-columns</span><span>:</span> <span>1</span><span>fr</span> <span>248px</span><span>;</span>
        <span>grid-gap</span><span>:</span> <span>40px</span><span>;</span>
    <span>}</span>
<span>}</span>

<span>.carousel</span> <span>{</span>
    <span>display</span><span>:</span> <span>flex</span><span>;</span>
    <span>overflow-x</span><span>:</span> <span>auto</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Since the carousel is a flex container that doesn’t wrap, its width is larger than the main section, and thus the grid item respected that. As a result, there is horizontal scrolling.</p>

<p>To fix that, we have three different solutions:</p>
<ul>
  <li>Using <code>minmax()</code></li>
  <li>Applying <code>min-width</code> to the grid item</li>
  <li>Adding <code>overflow: hidden</code> to the grid item</li>
</ul>

<p>As a defensive CSS mechanism, I would go for the first one which is using the <code>minmax()</code> function.</p>

<div><div><pre><code><span>@media</span> <span>(</span><span>min-width</span><span>:</span> <span>1020px</span><span>)</span> <span>{</span>
    <span>.wrapper</span> <span>{</span>
        <span>display</span><span>:</span> <span>grid</span><span>;</span>
        <span>grid-template-columns</span><span>:</span> <span>minmax</span><span>(</span><span>0</span><span>,</span> <span>1</span><span>fr</span><span>)</span> <span>248px</span><span>;</span>
        <span>grid-gap</span><span>:</span> <span>40px</span><span>;</span>
    <span>}</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-15-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>I wrote <a href="https://ishadeed.com/article/min-content-size-css-grid/">about that</a> early this year. I also highly recommend checking <a href="https://css-tricks.com/preventing-a-grid-blowout/">“Preventing a Grid Blowout”</a> and <a href="https://css-tricks.com/you-want-minmax10px-1fr-not-1fr">“You want minmax(10px, 1fr) not 1fr”</a> by Chris Coyier.</p>

<h2 id="auto-fit-vs-auto-fill">Auto fit vs auto fill</h2>
<p>When using CSS grid <code>minmax()</code> function, it’s important to decide between using the <code>auto-fit</code> or <code>auto-fill</code> keywords. When used incorrectly, it can lead to unexpected results.</p>

<p>When using <code>minmax()</code> function, the <code>auto-fit</code> keyword will expand the grid items to fill the available space. While <code>auto-fill</code> will keep the available space reserved without altering the grid items width.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-16-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>That being said, using <code>auto-fit</code> might lead to grid items being too wide, especially when they are less than expected. Consider the following example.</p>

<div><div><pre><code><span>.wrapper</span> <span>{</span>
    <span>display</span><span>:</span> <span>grid</span><span>;</span>
    <span>grid-template-columns</span><span>:</span> <span>repeat</span><span>(</span><span>auto-fit</span><span>,</span> <span>minmax</span><span>(</span><span>250px</span><span>,</span> <span>1</span><span>fr</span><span>));</span>
    <span>grid-gap</span><span>:</span> <span>1rem</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>If there is only one grid item and <code>auto-fit</code> is used, the item will expand to fill the container width.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-16-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Most of the time, such behavior isn’t needed, so using <code>auto-fill</code> is better in my opinion.</p>

<div><div><pre><code><span>.wrapper</span> <span>{</span>
    <span>display</span><span>:</span> <span>grid</span><span>;</span>
    <span>grid-template-columns</span><span>:</span> <span>repeat</span><span>(</span><span>auto-fill</span><span>,</span> <span>minmax</span><span>(</span><span>250px</span><span>,</span> <span>1</span><span>fr</span><span>));</span>
    <span>grid-gap</span><span>:</span> <span>1rem</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-16-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h2 id="image-maximum-width">Image maximum width</h2>
<p>As a general rule them, don’t forget to set <code>max-width: 100%</code> to <strong>all</strong> images. This can be added to the CSS reset that you use.</p>

<div><div><pre><code><span>img</span> <span>{</span>
    <span>max-width</span><span>:</span> <span>100%</span><span>;</span>
    <span>object-fit</span><span>:</span> <span>cover</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<h2 id="position-sticky-css-grid">position: sticky css grid</h2>
<p>Have you ever tried using <code>position: sticky</code> with a child of a grid container? The default behavior for grid items is to <strong>stretch</strong>. As a result, the aside element in the example below is equal to the main section height.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-17-1.jpg" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>To make it work as expected, you need to reset <code>align-self</code> property.</p>

<div><div><pre><code><span>aside</span> <span>{</span>
    <span>align-self</span><span>:</span> <span>start</span><span>;</span>
    <span>position</span><span>:</span> <span>sticky</span><span>;</span>
    <span>top</span><span>:</span> <span>1rem</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<figure>
    
        <img src="https://ishadeed.com/assets/defensive-css/defensive-17-2.jpg" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>I wrote about <a href="https://ishadeed.com/article/position-sticky-css-grid/">that topic</a> in detail on my blog, if you’re interested.</p>

<h2 id="grouping-selectors">Grouping selectors</h2>
<p>It’s not recommended to group selectors that are meant to work with different browsers. For example, styling an input’s placeholder needs multiple selectors per the browser. If we group the selectors, the entire rule will be invalid, according to <a href="https://www.w3.org/TR/selectors/#grouping">w3c</a>.</p>

<div><div><pre><code><span>/* Don&#39;t do this, please */</span>
<span>input</span><span>::-webkit-input-placeholder</span><span>,</span>
<span>input</span><span>:-moz-placeholder</span> <span>{</span>
    <span>color</span><span>:</span> <span>#222</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Instead, do this.</p>

<div><div><pre><code><span>input</span><span>::-webkit-input-placeholder</span> <span>{</span>
    <span>color</span><span>:</span> <span>#222</span><span>;</span>
<span>}</span>

<span>input</span><span>:-moz-placeholder</span> <span>{</span>
    <span>color</span><span>:</span> <span>#222</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<h2 id="its-not-the-end">It’s not the end!</h2>
<p>That’s not the end, but I really enjoyed documenting all these techniques. This is an ongoing list of defensive CSS techniques that I personally use depending on the project I’m working on. If you have anything to suggest, please get in touch via Twitter @shadeed9.</p>

<h2 id="interested-in-more-content-like-that">Interested in more content like that?</h2>

<p>I wrote an ebook on everything about Debugging CSS.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/css-mistakes/debugging-css.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>If you’re interested, head over to <a href="https://debuggingcss.com/">debuggingcss.com</a> for a free preview.</p>

	</div></div>
  </body>
</html>
