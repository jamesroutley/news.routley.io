<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/andrewcourtice/ripl">Original</a>
    <h1>Show HN: A JavaScript library for data visualization in both SVG and Canvas</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Ripl (pronounced ripple) is a library that provides a unified API for 2D graphics rendering (canvas &amp; SVG) in the browser with a focus towards high performance and interactive data visualization.</p>
<p dir="auto">Working with the canvas API can be notoriously difficult as it is designed to be very low-level. Alternatively, working with SVG is rather straightforward but not without its flaws. Because these paradigms differ widely in their implementations developers often have to choose one or the other at the outset of a project. Ripl alleviates the issue of choosing between these mediums by exposing a unified API and mimicking the DOM/CSSOM in as many ways possible to make it simple for developers to interact with. Switching between Canvas and SVG is as simple as changing 1 line of code.</p>
<p dir="auto">Ripl also exposes a number of methods such as scales, geometry, interpolation, color, data joining and easing to assist with drawing (inspired by D3).</p>

<ul dir="auto">
<li>Unified API for drawing to different contexts</li>
<li>Grouping and property inheritance</li>
<li>Scene and renderer management</li>
<li>Event bubbling, delegation and stop propagation (mimics the DOM as much as possible. Capture phase only)</li>
<li>Powerful element querying (<code>getElementById</code>, <code>getElementsByType</code>, <code>getElementsByClass</code>) including CSS selector style querying via <code>query</code> and <code>queryAll</code></li>
<li>Element bounds detection with <code>getBoundingBox</code></li>
<li>Automatic interpolation for known property types (ie. can interpolate numbers, points, colors between RGB and Hex etc.)</li>
<li>Point extrapolation for shape morphing (currently only supports regular polygons)</li>
<li>High performance async animation including CSS-like keyframe animation support and custom interpolators</li>
<li>Several built-in shape primitives such as arc, circle, rect, line, polyline, text, ellipse, and polygon</li>
<li>Hoisted scenegraph to optimize render performance when using scenes. See <a href="#performance">performance</a></li>
<li>Completely modular and tree-shakable. Only ship the features that you use.</li>
<li>Strictly typed in TypeScript</li>
<li>Zero runtime dependencies</li>
</ul>
<p dir="auto">Currently unsupported features are: gradients, transforms, clipping.</p>

<p dir="auto">Here are a few proof-of-concept data-visualization examples created using Ripl:</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Multi-Series Trend Chart (Bar/Line)</h3><a id="user-content-multi-series-trend-chart-barline" aria-label="Permalink: Multi-Series Trend Chart (Bar/Line)" href="#multi-series-trend-chart-barline"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://ripl-alpha.vercel.app/docs/charts/trend.html" rel="nofollow">Demo</a></li>
<li><a href="https://github.com/andrewcourtice/ripl/blob/main/packages/charts/src/charts/trend.ts">Source</a>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/11718453/322149505-81017bc2-9f30-4b1d-9746-dae8605bb475.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTI5ODE5OTQsIm5iZiI6MTcxMjk4MTY5NCwicGF0aCI6Ii8xMTcxODQ1My8zMjIxNDk1MDUtODEwMTdiYzItOWYzMC00YjFkLTk3NDYtZGFlODYwNWJiNDc1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDEzVDA0MTQ1NFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFhZGQxMWUwNTBhZmY5OTg0NDI1YjM2MWU0ZDU1ODFlNjkyN2ExZTBkOWEzN2VkY2RjOTA1MTMxM2VhNzVlNWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.JjGzbOZRK2scJJawx1-Yrm1mbSC4Ma4WSgH3nuvQmFk"><img src="https://private-user-images.githubusercontent.com/11718453/322149505-81017bc2-9f30-4b1d-9746-dae8605bb475.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTI5ODE5OTQsIm5iZiI6MTcxMjk4MTY5NCwicGF0aCI6Ii8xMTcxODQ1My8zMjIxNDk1MDUtODEwMTdiYzItOWYzMC00YjFkLTk3NDYtZGFlODYwNWJiNDc1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDEzVDA0MTQ1NFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFhZGQxMWUwNTBhZmY5OTg0NDI1YjM2MWU0ZDU1ODFlNjkyN2ExZTBkOWEzN2VkY2RjOTA1MTMxM2VhNzVlNWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.JjGzbOZRK2scJJawx1-Yrm1mbSC4Ma4WSgH3nuvQmFk" alt="localhost_5173_docs_charts_trend html"/></a></li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Donut Chart with Hover Effects</h3><a id="user-content-donut-chart-with-hover-effects" aria-label="Permalink: Donut Chart with Hover Effects" href="#donut-chart-with-hover-effects"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://ripl-alpha.vercel.app/docs/charts/pie.html" rel="nofollow">Demo</a></li>
<li><a href="https://github.com/andrewcourtice/ripl/blob/main/packages/charts/src/charts/pie.ts">Source</a>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/11718453/322149589-bfaecc5a-d630-4834-aeed-3eda49180fe8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTI5ODE5OTQsIm5iZiI6MTcxMjk4MTY5NCwicGF0aCI6Ii8xMTcxODQ1My8zMjIxNDk1ODktYmZhZWNjNWEtZDYzMC00ODM0LWFlZWQtM2VkYTQ5MTgwZmU4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDEzVDA0MTQ1NFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWIyYjE5YWZmNTE3OTdjZTBhNzlmZmYwYzMwZWIyMmRiZmZmYjVkMGU5MjkwNWFiNzk5YWNlZmVlMDY4NTE1MzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.4dxHnKXwdGdNMzW3Ps0a_VmTQ1CGvS0zersaA1qY1i0"><img src="https://private-user-images.githubusercontent.com/11718453/322149589-bfaecc5a-d630-4834-aeed-3eda49180fe8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTI5ODE5OTQsIm5iZiI6MTcxMjk4MTY5NCwicGF0aCI6Ii8xMTcxODQ1My8zMjIxNDk1ODktYmZhZWNjNWEtZDYzMC00ODM0LWFlZWQtM2VkYTQ5MTgwZmU4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDEzVDA0MTQ1NFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWIyYjE5YWZmNTE3OTdjZTBhNzlmZmYwYzMwZWIyMmRiZmZmYjVkMGU5MjkwNWFiNzk5YWNlZmVlMDY4NTE1MzQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.4dxHnKXwdGdNMzW3Ps0a_VmTQ1CGvS0zersaA1qY1i0" alt="localhost_5173_docs_charts_pie html"/></a></li>
</ul>

<p dir="auto">The following is a tour of Ripl&#39;s features starting from the most basic and progressively building towards more advanced concepts.</p>

<p dir="auto">Here&#39;s a basic example of rendering an element.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext,
    createCircle,
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);
const circle = createCircle({
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    lineWidth: 4,
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

circle.render(context);"><pre><span>import</span> <span>{</span>
    <span>createContext</span><span>,</span>
    <span>createCircle</span><span>,</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>
<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>lineWidth</span>: <span>4</span><span>,</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>circle</span><span>.</span><span>render</span><span>(</span><span>context</span><span>)</span><span>;</span></pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Modify Element Properties</h3><a id="user-content-modify-element-properties" aria-label="Permalink: Modify Element Properties" href="#modify-element-properties"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To modify an element simply change any of it&#39;s properties and re-render it.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext,
    createCircle,
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);
const circle = createCircle({
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    lineWidth: 4,
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

function render() {
    circle.render(context);
}

function update() {
    circle.fillStyle = &#39;#FF0000&#39;;
    circle.cx = context.width / 3;
    circle.cy = context.height / 3;
    render();
}"><pre><span>import</span> <span>{</span>
    <span>createContext</span><span>,</span>
    <span>createCircle</span><span>,</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>
<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>lineWidth</span>: <span>4</span><span>,</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>function</span> <span>render</span><span>(</span><span>)</span> <span>{</span>
    <span>circle</span><span>.</span><span>render</span><span>(</span><span>context</span><span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>update</span><span>(</span><span>)</span> <span>{</span>
    <span>circle</span><span>.</span><span>fillStyle</span> <span>=</span> <span>&#39;#FF0000&#39;</span><span>;</span>
    <span>circle</span><span>.</span><span>cx</span> <span>=</span> <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span><span>;</span>
    <span>circle</span><span>.</span><span>cy</span> <span>=</span> <span>context</span><span>.</span><span>height</span> <span>/</span> <span>3</span><span>;</span>
    <span>render</span><span>(</span><span>)</span><span>;</span>
<span>}</span></pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Render to Different Contexts (eg. SVG)</h3><a id="user-content-render-to-different-contexts-eg-svg" aria-label="Permalink: Render to Different Contexts (eg. SVG)" href="#render-to-different-contexts-eg-svg"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">To render the same element to SVG (or any other context) simply replace the import of the <code>createContext</code> method from <code>@ripl/core</code> to the appropriate package, in this case <code>@ripl/svg</code>. Here&#39;s the same example above rendered to SVG:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext
} from &#39;@ripl/svg&#39;;

import {
    createCircle,
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);
const circle = createCircle({
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    lineWidth: 4,
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

function render() {
    circle.render(context);
}

function update() {
    circle.fillStyle = &#39;#FF0000&#39;;
    circle.cx = context.width / 3;
    circle.cy = context.height / 3;
    render();
}"><pre><span>import</span> <span>{</span>
    <span>createContext</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/svg&#39;</span><span>;</span>

<span>import</span> <span>{</span>
    <span>createCircle</span><span>,</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>
<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>lineWidth</span>: <span>4</span><span>,</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>function</span> <span>render</span><span>(</span><span>)</span> <span>{</span>
    <span>circle</span><span>.</span><span>render</span><span>(</span><span>context</span><span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>update</span><span>(</span><span>)</span> <span>{</span>
    <span>circle</span><span>.</span><span>fillStyle</span> <span>=</span> <span>&#39;#FF0000&#39;</span><span>;</span>
    <span>circle</span><span>.</span><span>cx</span> <span>=</span> <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span><span>;</span>
    <span>circle</span><span>.</span><span>cy</span> <span>=</span> <span>context</span><span>.</span><span>height</span> <span>/</span> <span>3</span><span>;</span>
    <span>render</span><span>(</span><span>)</span><span>;</span>
<span>}</span></pre></div>

<p dir="auto">Ripl can also render multiple elements in groups with inherited properties (like CSS) and events (DOM event bubbling):</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext,
    createCircle,
    createRect,
    createGroup
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);

const circle = createCircle({
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

const rect = createRect({
    x: context.width / 2,
    y: context.height / 2,
    width: context.width / 5,
    height: context.height / 5,
});

const group = createGroup({
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    lineWidth: 4,
    children: [
        circle,
        rect
    ]
});

group.render(context);"><pre><span>import</span> <span>{</span>
    <span>createContext</span><span>,</span>
    <span>createCircle</span><span>,</span>
    <span>createRect</span><span>,</span>
    <span>createGroup</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>

<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>rect</span> <span>=</span> <span>createRect</span><span>(</span><span>{</span>
    <span>x</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>y</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>width</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>5</span><span>,</span>
    <span>height</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>5</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>group</span> <span>=</span> <span>createGroup</span><span>(</span><span>{</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>lineWidth</span>: <span>4</span><span>,</span>
    <span>children</span>: <span>[</span>
        <span>circle</span><span>,</span>
        <span>rect</span>
    <span>]</span>
<span>}</span><span>)</span><span>;</span>

<span>group</span><span>.</span><span>render</span><span>(</span><span>context</span><span>)</span><span>;</span></pre></div>

<p dir="auto">Elements can be queried in groups using common DOM methods such as <code>getElementById</code>, <code>getElementsByType</code>, and <code>getElementsByClass</code>. Elements can also be queried using a subset of the CSS selector syntax with <code>query</code> and <code>queryAll</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext,
    createCircle,
    createRect,
    createGroup
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);

const circle = createCircle({
    class: &#39;shape&#39;,
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

const rect = createRect({
    class: &#39;shape&#39;,
    x: context.width / 2,
    y: context.height / 2,
    width: context.width / 5,
    height: context.height / 5,
});

const childGroup = createGroup({
    id: &#39;child-group&#39;,
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    lineWidth: 4,
    children: [
        circle,
        rect
    ]
});

const parentGroup = createGroup({
    id: &#39;parent-group&#39;,
    children: childGroup
});

parentGroup.render(context);

function query() {
    const qCircle = parentGroup.getElementsByType(&#39;circle&#39;);
    const qRect = parentGroup.getElementsByType(&#39;rect&#39;);
    const qChildren = parentGroup.queryAll(&#39;.shape&#39;);
    const qChild = parentGroup.query(&#39;.child-group &gt; .shape&#39;);
}"><pre><span>import</span> <span>{</span>
    <span>createContext</span><span>,</span>
    <span>createCircle</span><span>,</span>
    <span>createRect</span><span>,</span>
    <span>createGroup</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>

<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>class</span>: <span>&#39;shape&#39;</span><span>,</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>rect</span> <span>=</span> <span>createRect</span><span>(</span><span>{</span>
    <span>class</span>: <span>&#39;shape&#39;</span><span>,</span>
    <span>x</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>y</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>width</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>5</span><span>,</span>
    <span>height</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>5</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>childGroup</span> <span>=</span> <span>createGroup</span><span>(</span><span>{</span>
    <span>id</span>: <span>&#39;child-group&#39;</span><span>,</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>lineWidth</span>: <span>4</span><span>,</span>
    <span>children</span>: <span>[</span>
        <span>circle</span><span>,</span>
        <span>rect</span>
    <span>]</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>parentGroup</span> <span>=</span> <span>createGroup</span><span>(</span><span>{</span>
    <span>id</span>: <span>&#39;parent-group&#39;</span><span>,</span>
    <span>children</span>: <span>childGroup</span>
<span>}</span><span>)</span><span>;</span>

<span>parentGroup</span><span>.</span><span>render</span><span>(</span><span>context</span><span>)</span><span>;</span>

<span>function</span> <span>query</span><span>(</span><span>)</span> <span>{</span>
    <span>const</span> <span>qCircle</span> <span>=</span> <span>parentGroup</span><span>.</span><span>getElementsByType</span><span>(</span><span>&#39;circle&#39;</span><span>)</span><span>;</span>
    <span>const</span> <span>qRect</span> <span>=</span> <span>parentGroup</span><span>.</span><span>getElementsByType</span><span>(</span><span>&#39;rect&#39;</span><span>)</span><span>;</span>
    <span>const</span> <span>qChildren</span> <span>=</span> <span>parentGroup</span><span>.</span><span>queryAll</span><span>(</span><span>&#39;.shape&#39;</span><span>)</span><span>;</span>
    <span>const</span> <span>qChild</span> <span>=</span> <span>parentGroup</span><span>.</span><span>query</span><span>(</span><span>&#39;.child-group &gt; .shape&#39;</span><span>)</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto">The query selector currently only supports a limited subset of features compared to the DOM. Here are some examples of supported queries:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// type
circle

// id
#element-id

// class
.element-class

// element properties (attributes)
circle[radius=&#34;5&#34;]

// descendents
.group-class circle
.group-class &gt; circle
.parent-class .child-class rect
.group-class rect + circle.circle-class
.group-class &gt; rect[x=&#34;50&#34;]"><pre>// type
<span>circle</span>

// id
<span>#</span><span>element-id</span>

// class
.<span>element-class</span>

// element properties (attributes)
<span>circle</span>[<span>radius</span><span>=</span><span>&#34;5&#34;</span>]

// descendents
.<span>group-class</span> <span>circle</span>
.<span>group-class</span> <span>&gt;</span> <span>circle</span>
.<span>parent-class</span> .<span>child-class</span> <span>rect</span>
.<span>group-class</span> <span>rect</span> <span>+</span> <span>circle</span>.<span>circle-class</span>
.<span>group-class</span> <span>&gt;</span> <span>rect</span>[<span>x</span><span>=</span><span>&#34;50&#34;</span>]</pre></div>

<p dir="auto">Ripl also provides complete scene management for rendering large group structures with events.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext,
    createCircle,
    createRect,
    createGroup,
    createScene
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);

const circle = createCircle({
    class: &#39;shape&#39;,
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

const rect = createRect({
    class: &#39;shape&#39;,
    x: context.width / 2,
    y: context.height / 2,
    width: context.width / 5,
    height: context.height / 5,
});

const childGroup = createGroup({
    id: &#39;child-group&#39;,
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    lineWidth: 4,
    children: [
        circle,
        rect
    ]
});

const parentGroup = createGroup({
    id: &#39;parent-group&#39;,
    children: childGroup
});

const scene = createScene({
    children: parentGroup
})

scene.render(context);
circle.on(&#39;click&#39;, event =&gt; console.log(event));"><pre><span>import</span> <span>{</span>
    <span>createContext</span><span>,</span>
    <span>createCircle</span><span>,</span>
    <span>createRect</span><span>,</span>
    <span>createGroup</span><span>,</span>
    <span>createScene</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>

<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>class</span>: <span>&#39;shape&#39;</span><span>,</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>rect</span> <span>=</span> <span>createRect</span><span>(</span><span>{</span>
    <span>class</span>: <span>&#39;shape&#39;</span><span>,</span>
    <span>x</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>y</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>width</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>5</span><span>,</span>
    <span>height</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>5</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>childGroup</span> <span>=</span> <span>createGroup</span><span>(</span><span>{</span>
    <span>id</span>: <span>&#39;child-group&#39;</span><span>,</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>lineWidth</span>: <span>4</span><span>,</span>
    <span>children</span>: <span>[</span>
        <span>circle</span><span>,</span>
        <span>rect</span>
    <span>]</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>parentGroup</span> <span>=</span> <span>createGroup</span><span>(</span><span>{</span>
    <span>id</span>: <span>&#39;parent-group&#39;</span><span>,</span>
    <span>children</span>: <span>childGroup</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>scene</span> <span>=</span> <span>createScene</span><span>(</span><span>{</span>
    <span>children</span>: <span>parentGroup</span>
<span>}</span><span>)</span>

<span>scene</span><span>.</span><span>render</span><span>(</span><span>context</span><span>)</span><span>;</span>
<span>circle</span><span>.</span><span>on</span><span>(</span><span>&#39;click&#39;</span><span>,</span> <span>event</span> <span>=&gt;</span> <span>console</span><span>.</span><span>log</span><span>(</span><span>event</span><span>)</span><span>)</span><span>;</span></pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Basic Animation and Interactivity</h3><a id="user-content-basic-animation-and-interactivity" aria-label="Permalink: Basic Animation and Interactivity" href="#basic-animation-and-interactivity"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Interactivity and animation can be added by using a renderer. The renderer provides an automatic render loop to re-render a scene at the ideal framerate.</p>
<div dir="auto" data-snippet-clipboard-copy-content="import {
    createContext,
    createCircle,
    createRect,
    createGroup,
    createScene,
    easeOutCubic
} from &#39;@ripl/core&#39;;

const context = createContext(&#39;.mount-element&#39;);

const circle = createCircle({
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    cx: context.width / 2,
    cy: context.height / 2,
    radius: context.width / 3
});

const rect = createRect({
    fillStyle: &#39;rgb(30, 105, 120)&#39;,
    x: context.width / 2,
    y: context.height / 2,
    width: context.width / 5,
    height: context.height / 5,
});

const scene = createScene({
    children: [
        circle,
        rect
    ]
});

const renderer = createRenderer(scene, {
    autoStart: true,
    autoStop: true
});

async function animate() {
    // Render one
    await renderer.transition(circle, {
        duration: 1000,
        ease: easeOutCubic,
        state: {
            fillStyle: &#39;#FF0000&#39;,
            cx: context.width / 4,
            cy: context.height / 4,
            radius: context.width / 4
        }
    });

    // Render many with common properties
    // Alternatively you could transition a whole group or scene
    await renderer.transition([circle, rect], {
        duration: 1000,
        ease: easeOutCubic,
        state: {
            fillStyle: &#39;#FF0000&#39;,
        }
    });
}"><pre><span>import</span> <span>{</span>
    <span>createContext</span><span>,</span>
    <span>createCircle</span><span>,</span>
    <span>createRect</span><span>,</span>
    <span>createGroup</span><span>,</span>
    <span>createScene</span><span>,</span>
    <span>easeOutCubic</span>
<span>}</span> <span>from</span> <span>&#39;@ripl/core&#39;</span><span>;</span>

<span>const</span> <span>context</span> <span>=</span> <span>createContext</span><span>(</span><span>&#39;.mount-element&#39;</span><span>)</span><span>;</span>

<span>const</span> <span>circle</span> <span>=</span> <span>createCircle</span><span>(</span><span>{</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>3</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>rect</span> <span>=</span> <span>createRect</span><span>(</span><span>{</span>
    <span>fillStyle</span>: <span>&#39;rgb(30, 105, 120)&#39;</span><span>,</span>
    <span>x</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span><span>,</span>
    <span>y</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>2</span><span>,</span>
    <span>width</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>5</span><span>,</span>
    <span>height</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>5</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>scene</span> <span>=</span> <span>createScene</span><span>(</span><span>{</span>
    <span>children</span>: <span>[</span>
        <span>circle</span><span>,</span>
        <span>rect</span>
    <span>]</span>
<span>}</span><span>)</span><span>;</span>

<span>const</span> <span>renderer</span> <span>=</span> <span>createRenderer</span><span>(</span><span>scene</span><span>,</span> <span>{</span>
    <span>autoStart</span>: <span>true</span><span>,</span>
    <span>autoStop</span>: <span>true</span>
<span>}</span><span>)</span><span>;</span>

<span>async</span> <span>function</span> <span>animate</span><span>(</span><span>)</span> <span>{</span>
    <span>// Render one</span>
    <span>await</span> <span>renderer</span><span>.</span><span>transition</span><span>(</span><span>circle</span><span>,</span> <span>{</span>
        <span>duration</span>: <span>1000</span><span>,</span>
        <span>ease</span>: <span>easeOutCubic</span><span>,</span>
        <span>state</span>: <span>{</span>
            <span>fillStyle</span>: <span>&#39;#FF0000&#39;</span><span>,</span>
            <span>cx</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>4</span><span>,</span>
            <span>cy</span>: <span>context</span><span>.</span><span>height</span> <span>/</span> <span>4</span><span>,</span>
            <span>radius</span>: <span>context</span><span>.</span><span>width</span> <span>/</span> <span>4</span>
        <span>}</span>
    <span>}</span><span>)</span><span>;</span>

    <span>// Render many with common properties</span>
    <span>// Alternatively you could transition a whole group or scene</span>
    <span>await</span> <span>renderer</span><span>.</span><span>transition</span><span>(</span><span>[</span><span>circle</span><span>,</span> <span>rect</span><span>]</span><span>,</span> <span>{</span>
        <span>duration</span>: <span>1000</span><span>,</span>
        <span>ease</span>: <span>easeOutCubic</span><span>,</span>
        <span>state</span>: <span>{</span>
            <span>fillStyle</span>: <span>&#39;#FF0000&#39;</span><span>,</span>
        <span>}</span>
    <span>}</span><span>)</span><span>;</span>
<span>}</span></pre></div>

<p dir="auto">Ripl also supports CSS-like animation keyframes and custom interpolator functions</p>
<div dir="auto" data-snippet-clipboard-copy-content="// ...

async function animate() {
    // Implicit keyframe offsets
    await renderer.transition([circle, rect], {
        duration: 1000,
        ease: easeOutCubic,
        state: {
            fillStyle: [
                &#39;#FF0000&#39;, // implied 0.33 offset
                &#39;#00FF00&#39;, // implied 0.66 offset
                &#39;#0000FF&#39;, // implied end state - offset 1
            ],
        }
    });

    // Explicit keyframe offsets
    await renderer.transition([circle, rect], {
        duration: 1000,
        ease: easeOutCubic,
        state: {
            fillStyle: [
                {
                    value: &#39;#FF0000&#39;,
                    offset: 0.25
                },
                {
                    value: &#39;#0000FF&#39;,
                    offset: 0.8
                }
            ],
        }
    });

    // Custom interpolator
    await renderer.transition(circle, {
        duration: 1000,
        ease: easeOutCubic,
        state: {
            radius: t =&gt; t * context.width / 2 // where 0 &lt;= t &lt;= 1 (depending on the ease function)
        }
    });
}"><pre><span>// ...</span>

<span>async</span> <span>function</span> <span>animate</span><span>(</span><span>)</span> <span>{</span>
    <span>// Implicit keyframe offsets</span>
    <span>await</span> <span>renderer</span><span>.</span><span>transition</span><span>(</span><span>[</span><span>circle</span><span>,</span> <span>rect</span><span>]</span><span>,</span> <span>{</span>
        <span>duration</span>: <span>1000</span><span>,</span>
        <span>ease</span>: <span>easeOutCubic</span><span>,</span>
        <span>state</span>: <span>{</span>
            <span>fillStyle</span>: <span>[</span>
                <span>&#39;#FF0000&#39;</span><span>,</span> <span>// implied 0.33 offset</span>
                <span>&#39;#00FF00&#39;</span><span>,</span> <span>// implied 0.66 offset</span>
                <span>&#39;#0000FF&#39;</span><span>,</span> <span>// implied end state - offset 1</span>
            <span>]</span><span>,</span>
        <span>}</span>
    <span>}</span><span>)</span><span>;</span>

    <span>// Explicit keyframe offsets</span>
    <span>await</span> <span>renderer</span><span>.</span><span>transition</span><span>(</span><span>[</span><span>circle</span><span>,</span> <span>rect</span><span>]</span><span>,</span> <span>{</span>
        <span>duration</span>: <span>1000</span><span>,</span>
        <span>ease</span>: <span>easeOutCubic</span><span>,</span>
        <span>state</span>: <span>{</span>
            <span>fillStyle</span>: <span>[</span>
                <span>{</span>
                    <span>value</span>: <span>&#39;#FF0000&#39;</span><span>,</span>
                    <span>offset</span>: <span>0.25</span>
                <span>}</span><span>,</span>
                <span>{</span>
                    <span>value</span>: <span>&#39;#0000FF&#39;</span><span>,</span>
                    <span>offset</span>: <span>0.8</span>
                <span>}</span>
            <span>]</span><span>,</span>
        <span>}</span>
    <span>}</span><span>)</span><span>;</span>

    <span>// Custom interpolator</span>
    <span>await</span> <span>renderer</span><span>.</span><span>transition</span><span>(</span><span>circle</span><span>,</span> <span>{</span>
        <span>duration</span>: <span>1000</span><span>,</span>
        <span>ease</span>: <span>easeOutCubic</span><span>,</span>
        <span>state</span>: <span>{</span>
            <span>radius</span>: <span>t</span> <span>=&gt;</span> <span>t</span> <span>*</span> <span>context</span><span>.</span><span>width</span> <span>/</span> <span>2</span> <span>// where 0 &lt;= t &lt;= 1 (depending on the ease function)</span>
        <span>}</span>
    <span>}</span><span>)</span><span>;</span>
<span>}</span></pre></div>

<p dir="auto">Ripl is designed to be as performant as possible, however, here are a few tips for getting the best performance out of it:</p>
<ol dir="auto">
<li><strong>Using a scene + renderer to render many elements/groups</strong> - When elements are placed into a scene and rendered using a renderer the elements are &#34;hoisted&#34; into a flat list essentially converting the render time from an O(n^c) operation to O(n). The performance cost is instead shifted to adding/removing elements from groups within the scenegraph.</li>
<li><strong>Using persistent keys when creating paths in custom elements</strong> - When creating a new path/text within a custom element it is highly encouraged to specify a persistent key for the path. The persistent key ensures that custom contexts such as svg can efficiently diff created objects with the DOM in each frame. This effectively reduces the amount of DOM elements that are required to be created/destroyed each frame. See an example of a persistent path key <a href="https://github.com/andrewcourtice/ripl/blob/1a33451da6f1a3b5163b41189c00c0cce116accd/packages/core/src/core/shape.ts#L73">here</a>.</li>
</ol>
</article></div></div>
  </body>
</html>
