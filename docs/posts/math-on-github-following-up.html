<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nschloe.github.io/2022/06/27/math-on-github-follow-up.html">Original</a>
    <h1>Math on GitHub: Following Up</h1>
    
    <div id="readability-page-1" class="page"><div aria-label="Content">
      <div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <p>About six weeks ago, on May 19, 2022, GitHub released
<a href="https://github.blog/2022-05-19-math-support-in-markdown/">Math support on Markdown</a>.
At the time of the release, it received criticism for being ill-designed and
buggy. I, too, wrote
<a href="https://nschloe.github.io/2022/05/20/math-on-github.html">a blog post</a> about
it.</p>

<p>In the weeks following the release, GitHub have tried to address the issues.
Let’s take a look at where math on GitHub stands now.</p>

<p>(<em>Note:</em> Most examples can be found on <a href="https://github.com/nschloe/math-test">my GitHub math test
repo</a>.)</p>

<h2 id="fixed-issues">Fixed issues</h2>

<ul>
  <li>
    <p>Kerning</p>

    <p>At the time of the release, kerning between symbols in LaTeX blocks was
completely off. This was probably a simple math font config bug, and was fixes
swiftly after release.</p>

    <p>Before:</p>
    <p>
  <img src="https://nschloe.github.io/images/kerning-github.png" width="20%"/>
</p>

    <p>After:</p>
    <p>
  <img src="https://nschloe.github.io/images/kerning-github-fixed.png" width="20%"/>
</p>
  </li>
  <li>
    <p>Math in lists, tables, headers works now.</p>

    <p>
  <img src="https://nschloe.github.io/images/math-lists.png" width="30%"/>
</p>
  </li>
</ul>

<h2 id="markdown-vs-math">Markdown vs. math</h2>

<p>One, if not <em>the</em> major issue with GitHub’s math support is its syntax. They’re
using the old familiar <code>$...$</code> for inline and <code>$$...$$</code> for display math. This
is easy for users but unfortunately does not integrate well with Markdown at
all. Whatever Markdown tools run on a text file, they’ll see everything between
<code>$</code>-signs as regular text. This means that certain symbols are sanitized away,
other symbols are forcibly <code>\</code>-escaped etc. Let’s review some of the math that
failed to display correctly right after the release.</p>

<ul>
  <li>
    <p><code>$\{n\in\mathbb{N}:\: n \text{even}\}$</code></p>

    <p>This is still fails to display correctly. The curly brackets are removed, the
<code>\:</code> isn’t displayed a space but as a <code>:</code>. Workaround: Double-escaping LaTeX
commands that don’t start with a letter:</p>

    <p>$\{n\in\mathbb{N}:\: n \text{even}\}$</p>

    <p>You’d have to go back to singly-escaped brackets and spaces though once the
issue is fixed. I’m not sure when or <em>if</em> this will happen. Not sure what to
recommend here.</p>
  </li>
  <li>
    <p><code>$a &lt;b &gt; c$</code></p>

    <p>This still doesn’t get rendered as math as <code>&lt;b &gt;</code> is recognized as an
<a href="https://www.w3schools.com/html/html_formatting.asp">HTML opening bold tag</a>.</p>
  </li>
  <li>
    <p><code>$[a+b](c+d)$</code></p>

    <p>Also still doesn’t get rendered as math. The problem: <code>[...](...)</code> is
accidentally the syntax for Markdown links. It’s recognized as such, and math
is skipped.</p>
  </li>
  <li>
    <p>$<code>U</code>$</p>

    <p>Again, the interior is recognized as Markdown code, and math is not rendered.</p>
  </li>
</ul>

<p>It seems that GitHub haven’t been able to tackle <em>any</em> of the syntactical issues
yet. That’s no surprise: Math was added as an afterthought, and if the Markdown
sanitizer is applied first, you’d have to drill that one open. This is a costly
endeavor and I’m not sure if GitHub want to go down that path. So far, they
don’t.</p>

<h3 id="-vs-dollar-bugs"><code>$</code> vs. dollar bugs</h3>

<p>GitHub might have taken inspiration from
<a href="https://math.stackexchange.com/">StackExchange</a> which also uses <code>$...$</code> as math
syntax delimiters. In contrast to StackExchange, though, GitHub wanted “regular”
dollar signs to continue rendering as such. What <em>is</em> a regular dollar sign
though? That’s where it gets confusing and, consequently, buggy.</p>

<p>GitHub still renders</p>

<div><div><pre><code>An apple costs $1, a mango $2.
</code></pre></div></div>

<p>as dollar signs. This, however,</p>

<div><div><pre><code>An apple costs 1$, a mango 2$.
</code></pre></div></div>

<p>is math. This too:</p>

<div><div><pre><code>An apple costs $1, a mango $ 2.
</code></pre></div></div>

<p>It seems to be that the terminating <code>$</code> is only treated as a LaTeX-toggle if not
immediately followed by an alphanumeric character. If it <em>is</em> followed by an
alphanumeric, the opening <code>$</code> is also treated as a regular dollar. It’s unclear
to me how it works exactly. Experience shows: The clearer the syntax, the fewer
bugs appear. The syntax here is not clear, so you have plenty of bugs:</p>

<ul>
  <li>
    

    <p>renders as</p>
    <p>
  <img src="https://nschloe.github.io/images/x-plus.png" width="10%"/>
</p>
    <p>The rest has somehow disappeared.</p>
  </li>
  <li>
    <p><code>where $T$ is lookback; $\tau$ is horizon.</code></p>

    <p>This line is rendered as</p>

    <p>
  <img src="https://nschloe.github.io/images/lookback-horizon.png" width="30%"/>
</p>

    <p>Whoops! What happened here?</p>
  </li>
  <li>
    <p><code>$x = \text{my $y$}$</code></p>

    <p>
  <img src="https://nschloe.github.io/images/y-dollar.png" width="10%"/>
</p>

    <p>Dollar signs within LaTeX completely throw off the parser.</p>
  </li>
  <li>
    <p><code>$x =\$$</code></p>

    <p>
  <img src="https://nschloe.github.io/images/triple-dollar.png" width="15%"/>
</p>

    <p>Although properly escaped, the parser gets confused with the dollar sign.</p>
  </li>
</ul>

<p>Note that StackExchange doesn’t have those problems: There, <code>$</code> toggles math,
always. If you want a regular dollar sign, you’ll have to escape it, <code>\$</code>.</p>

<h3 id="the-remedy">The remedy</h3>

<p><a href="https://nschloe.github.io/2022/05/20/math-on-github.html">As outlined in the previous blog post</a>,
and as done by GitLab and my browser extension
<a href="https://github.com/nschloe/xhub">xhub</a>, a clean fix for all of the above
problems is to use a different syntax, e.g.,</p>



<p>for inline math and</p>



<p>for display math. This only looks half-TeXy at first, but it’s easy enough to
type <em>and</em> integrates nicely with Markdown. Thanks to the backticks, (which
indicate to Markdown parsers that what follows is “code”) its contents never
messed with. There is no confusion with dollar signs either.</p>

<h3 id="conclusion">Conclusion</h3>

<p>GitHub’s current choice of syntax goes against the Markdown grain. Fixing bugs
is here hard, as highlighted by the fact that none of the initial syntax issues
could be fixed yet. It’ll continue to be an uphill battle for GitHub engineers,
and I’m afraid such math support will never be reliable, let alone complete.
This hinders technical innovation. (For example, I’m working on a
LaTeX-to-Markdown converter that requires robust math support.)</p>

<p>Backtick math is a viable alternative, proven to work in practice. When coming
from the TeX world (like me), typing backticks might feel unfamiliar at first,
but it’s easy to get used to, especially in a Markdown context. Since it
eliminates <em>all</em> the issues described above, it is, in my opinion, the syntax
that GitHub should have adopted. Perhaps it’s not too late to make a switch.</p>



<p><a href="https://news.ycombinator.com/item?id=31891754">Comments welcome on Hacker
News!</a></p>

  </div>
</article>

      </div>
    </div></div>
  </body>
</html>
