<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://elesiuta.github.io/picosnitch/">Original</a>
    <h1>Show HN: Picosnitch – a reliable and lightweight security/privacy tool for Linux</h1>
    
    <div id="readability-page-1" class="page"><div id="content" role="main">
      <p><a href="https://github.com/elesiuta/picosnitch/releases"><img src="https://img.shields.io/github/v/release/elesiuta/picosnitch?color=00a0a0" alt="GitHub release"/></a>
<a href="https://pypi.org/project/picosnitch"><img src="https://img.shields.io/pypi/v/picosnitch?color=00a0a0" alt="PyPI release"/></a>
<a href="https://aur.archlinux.org/packages/picosnitch/"><img src="https://img.shields.io/aur/version/picosnitch?color=00a0a0" alt="AUR release"/></a>
<a href="https://github.com/elesiuta/picosnitch/commits/master"><img src="https://img.shields.io/github/commits-since/elesiuta/picosnitch/latest/master?color=00a0a0" alt="GitHub commits since latest release"/></a>
<a href="https://github.com/elesiuta/picosnitch/graphs/contributors"><img src="https://img.shields.io/github/contributors/elesiuta/picosnitch?color=00a0a0" alt="GitHub contributors"/></a>
<a href="https://github.com/elesiuta/picosnitch/blob/master/picosnitch.py"><img src="https://img.shields.io/github/size/elesiuta/picosnitch/picosnitch.py?color=00a0a0" alt="File size"/></a>
<a href="https://pypistats.org/packages/picosnitch"><img src="https://img.shields.io/pypi/dm/picosnitch?color=00a0a0&amp;label=downloads%20%28pypistats%29" alt="PyPI monthly downloads (without mirrors)"/></a>
<a href="https://pepy.tech/project/picosnitch"><img src="https://img.shields.io/badge/dynamic/json?color=00a0a0&amp;label=downloads%20%28pepy%29&amp;query=total_downloads&amp;url=https%3A%2F%2Fapi.pepy.tech%2Fapi%2Fprojects%2Fpicosnitch" alt="PyPI total downloads"/></a>
<a href="https://github.com/elesiuta/picosnitch/releases"><img src="https://img.shields.io/github/downloads/elesiuta/picosnitch/total?color=00a0a0&amp;label=downloads%20%28github%29" alt="GitHub downloads"/></a></p>


<ul>
  <li>An extremely simple, reliable, and lightweight program for linux to help protect your privacy
    <ul>
      <li>It monitors your system and notifies you whenever it sees a new program that connects to the network</li>
      <li>Or when the sha256 changes for one of those programs (can also check <a href="https://www.virustotal.com">VirusTotal</a>)</li>
      <li>And features a curses based UI for browsing past connections</li>
    </ul>
  </li>
  <li>For advanced users who know what should be running on their system and when they should be making network connections
    <ul>
      <li>Only you can decide which programs to trust, so picosnitch leaves this decision up to you and just focusses on doing one thing well</li>
      <li>A program you can’t trust to make network connections also can’t be trusted not to negate any firewall rules, so blocking or sandboxing these programs is out of scope for picosnitch (also beware of programs running as root that may try to stop/modify picosnitch)</li>
      <li>However, you can still watch picosnitch logs with another program to block connections once detected, picosnitch can be used with any other firewall tool and does not impact performance since it only monitors connections and does not intercept them</li>
    </ul>
  </li>
  <li>Inspired by programs such as GlassWire, Little Snitch, and OpenSnitch</li>
</ul>



<h3 id="ppa-for-ubuntu-and-derivatives"><a href="https://launchpad.net/~elesiuta/+archive/ubuntu/picosnitch">PPA</a> for Ubuntu and derivatives</h3>
<ul>
  <li><code>sudo add-apt-repository ppa:elesiuta/picosnitch</code></li>
  <li><code>sudo apt update</code></li>
  <li><code>sudo apt install picosnitch</code></li>
</ul>

<h3 id="aur-for-arch-and-derivatives"><a href="https://aur.archlinux.org/packages/picosnitch/">AUR</a> for Arch and derivatives</h3>
<ul>
  <li>install <code>picosnitch</code> <a href="https://wiki.archlinux.org/title/Arch_User_Repository#Installing_and_upgrading_packages">manually</a> or using your preferred <a href="https://wiki.archlinux.org/title/AUR_helpers">AUR helper</a></li>
</ul>

<h3 id="pypi-for-any-linux-distribution-with-python--38"><a href="https://pypi.org/project/picosnitch/">PyPI</a> for any Linux distribution with Python &gt;= 3.8</h3>
<ul>
  <li>install the <a href="https://github.com/iovisor/bcc/blob/master/INSTALL.md">BPF Compiler Collection</a> python package for your distribution
    <ul>
      <li>it should be called <code>python-bcc</code> or <code>python-bpfcc</code></li>
    </ul>
  </li>
  <li>install picosnitch using <a href="https://pip.pypa.io/">pip</a>
    <ul>
      <li><code>pip3 install &#34;picosnitch[full]&#34; --upgrade --user</code></li>
    </ul>
  </li>
  <li>create a service file for systemd to run picosnitch (recommended)
    <ul>
      <li><code>picosnitch systemd</code></li>
    </ul>
  </li>
  <li>optional dependencies (should already be installed or install automatically)
    <ul>
      <li>for notifications: <code>dbus-python</code>, <code>python-dbus</code>, or <code>python3-dbus</code> (name depends on your distro)</li>
      <li>for VirusTotal: <code>python-requests</code></li>
    </ul>
  </li>
</ul>


<ul>
  <li>running picosnitch
    <ul>
      <li>enable/disable autostart on reboot with <code>systemctl enable|disable picosnitch</code></li>
      <li>start/stop/restart with <code>systemctl start|stop|restart picosnitch</code></li>
      <li>or if you don’t use systemd <code>picosnitch start|stop|restart</code></li>
    </ul>
  </li>
  <li>user interface for browsing past connections
    <ul>
      <li>start with <code>picosnitch view</code></li>
      <li><code>space/enter</code>: filter on entry <code>backspace</code>: remove filter <code>h/H</code>: cycle through history <code>t/T</code>: cycle time range <code>r</code>: refresh view <code>q</code>: quit</li>
    </ul>
  </li>
  <li>show usage with <code>picosnitch help</code></li>
</ul>


<ul>
  <li>config is stored in <code>~/.config/picosnitch/config.json</code>
    <ul>
      <li>restart picosnitch if it is currently running for any changes to take effect</li>
    </ul>
  </li>
</ul>

<div><div><pre><code><span>{</span>
  <span>&#34;</span><span>DB</span><span> </span><span>retention</span><span> </span><span>(days)&#34;</span><span>:</span> <span>365</span><span>,</span> <span># How many days to keep connection logs in snitch.db</span>
  <span>&#34;</span><span>DB</span><span> </span><span>sql</span><span> </span><span>log&#34;</span><span>:</span> <span>true</span><span>,</span> <span># Write connection logs to snitch.db</span>
  <span>&#34;</span><span>DB</span><span> </span><span>text</span><span> </span><span>log&#34;</span><span>:</span> <span>false</span><span>,</span> <span># Write connection logs to conn.log</span>
  <span>&#34;</span><span>DB</span><span> </span><span>write</span><span> </span><span>limit</span><span> </span><span>(seconds)&#34;</span><span>:</span> <span>1</span><span>,</span> <span># Minimum time between writing connection logs</span>
  <span># increasing it decreases disk writes by grouping connections into larger time windows</span>
  <span># reducing time precision, decreasing database size, and increasing hash latency</span>
  <span>&#34;</span><span>Desktop</span><span> </span><span>notifications&#34;</span><span>:</span> <span>true</span><span>,</span> <span># Try connecting to dbus to show notifications</span>
  <span>&#34;</span><span>Every</span><span> </span><span>exe</span><span> </span><span>(not</span><span> </span><span>just</span><span> </span><span>conns)&#34;</span><span>:</span> <span>false</span><span>,</span> <span># Check every running executable with picosnitch</span>
  <span># these will be treated as &#34;connections&#34; with a port of -1</span>
  <span># this feature is experimental but should work fairly well, errors should be expected as</span>
  <span># picosnitch is unable to open file descriptors for some extremely short-lived processes</span>
  <span>&#34;</span><span>Log</span><span> </span><span>addresses&#34;</span><span>:</span> <span>true</span><span>,</span> <span># Log remote addresses for each connection</span>
  <span>&#34;</span><span>Log</span><span> </span><span>commands&#34;</span><span>:</span> <span>true</span><span>,</span> <span># Log command line args for each executable</span>
  <span>&#34;</span><span>Log</span><span> </span><span>ignore&#34;</span><span>:</span> <span>[],</span> <span># List of hashes (str), domains (str), or ports (int)</span>
  <span># will omit connections that match any of these from the connection log</span>
  <span># domains will match any that start with the provided string, hashes or ports are exact</span>
  <span># the process name, executable, and hash will still be recorded in record.json</span>
  <span>&#34;</span><span>Set</span><span> </span><span>RLIMIT_NOFILE&#34;</span><span>:</span> <span>null</span><span>,</span> <span># Set the maximum number of open file descriptors (int)</span>
  <span># it is used for caching process executables and hashes (typical system default is 1024)</span>
  <span># this is good enough for most people since caching is based on executable device + inode</span>
  <span># fanotify is used to detect if a cached executable is modified to trigger a hash update</span>
  <span>&#34;</span><span>VT</span><span> </span><span>API</span><span> </span><span>key&#34;</span><span>:</span> <span>&#34;</span><span>&#34;</span><span>,</span> <span># API key for VirusTotal, leave blank to disable (str)</span>
  <span>&#34;</span><span>VT</span><span> </span><span>file</span><span> </span><span>upload&#34;</span><span>:</span> <span>false</span><span>,</span> <span># Upload file if hash not found, only hashes are used by default</span>
  <span>&#34;</span><span>VT</span><span> </span><span>request</span><span> </span><span>limit</span><span> </span><span>(seconds)&#34;</span><span>:</span> <span>15</span> <span># Number of seconds between requests (free tier quota)</span>
<span>}</span>
</code></pre></div></div>


<ul>
  <li>a log of seen executables is stored in <code>~/.config/picosnitch/exe.log</code>
    <ul>
      <li>this is a history of your notifications</li>
    </ul>
  </li>
  <li>a record of seen executables is stored in <code>~/.config/picosnitch/record.json</code>
    <ul>
      <li>this is used for determining whether to create a notification</li>
      <li>it contains known process name(s) by executable, executable(s) by process name, and sha256 hash(es) with VirusTotal results by executable</li>
    </ul>
  </li>
  <li>the full connection log is stored in <code>~/.config/picosnitch/snitch.db</code>
    <ul>
      <li>this is used for <code>picosnitch view</code></li>
      <li>note, connection times are based on when the group is processed, so they are accurate to within <code>DB write limit (seconds)</code> at best, and could be delayed if the previous group is slow to hash</li>
      <li>notifications are handled by a separate subprocess, so they are not subject to the same delays as the connection log</li>
    </ul>
  </li>
  <li>if <code>DB text log</code> is enabled, the full connection log is also written to <code>~/.config/picosnitch/conn.log</code>
    <ul>
      <li>this may be useful for watching with another program</li>
      <li>it contains the following fields, separated by commas (commas, newlines, and null characters are removed from values)</li>
      <li><code>executable,name,cmdline,sha256,time,domain,ip,port,uid,count</code></li>
    </ul>
  </li>
  <li>the error log is stored in <code>~/.config/picosnitch/error.log</code>
    <ul>
      <li>errors will also trigger a notification and are usually caused by far too many processes/connections</li>
      <li>for most people in most cases, this should raise suspicion that some other program may be misbehaving</li>
    </ul>
  </li>
</ul>


<ul>
  <li>install dependencies listed under <a href="#installation">installation</a></li>
  <li>install <code>python-setuptools</code></li>
  <li>install picosnitch with <code>python setup.py install --user</code></li>
  <li>see other options with <code>python setup.py [build|install] --help</code></li>
</ul>


      
    </div></div>
  </body>
</html>
