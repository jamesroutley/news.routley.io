<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.copetti.org/writings/consoles/playstation-vita/">Original</a>
    <h1>Playstation Vita Architecture (Part 1)</h1>
    
    <div id="readability-page-1" class="page"><article><h2 id="imagery">Supporting imagery</h2><section><ul><li><a href="#cover-model">Model</a></li><li><a href="#cover-motherboard">Motherboard</a></li></ul><div><h3>Model</h3><div id="cover-model"><ul><li><a href="#cover-model-original">Original</a></li><li><a href="#cover-model-slim">Slim</a></li><li><a href="#cover-model-tv">TV</a></li></ul><figure id="cover-model-original"><a href="https://www.copetti.org/images/consoles/psvita/psvita.2359d8f1dec0379a85c91390f6f19870eae50bb233663be55a85dab75b8ec706.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psvita/_hu279e86fa905866dbeab8b6e32bdcff72_227619_4a3d8c4795dbfdeae653095e584d9b85.webp 500w,
https://www.copetti.org/images/consoles/psvita/_hu279e86fa905866dbeab8b6e32bdcff72_227619_07572ae14f348783653ba0389bd6bc26.webp 800w,
https://www.copetti.org/images/consoles/psvita/_hu279e86fa905866dbeab8b6e32bdcff72_227619_c7015cb43b0e3c0637f2a64759a66ea1.webp 1111w"/><img alt="Image" width="1111" height="643" src="https://www.copetti.org/images/consoles/psvita/psvita.2359d8f1dec0379a85c91390f6f19870eae50bb233663be55a85dab75b8ec706.png"/></picture></a><figcaption>The PlayStation Vita (model PCH-1000).</figcaption></figure><figure id="cover-model-slim"><a href="https://www.copetti.org/images/consoles/psvita/psvita2.ef145b257ce54a14372f29e1e664cad7e23422aeee2aa5cdc408adc6b9e3cc60.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psvita/_huea17b18433814b9ec9d0deef9f944e6d_200016_d6d60722a6a369b9cf5364da104fcc82.webp 500w,
https://www.copetti.org/images/consoles/psvita/_huea17b18433814b9ec9d0deef9f944e6d_200016_803ee9c5ee15d8bc12eaec34fd8630b7.webp 800w,
https://www.copetti.org/images/consoles/psvita/_huea17b18433814b9ec9d0deef9f944e6d_200016_1649626c92d39e0dcfc8c0c2575ba3d8.webp 1111w"/><img alt="Image" width="1111" height="648" src="https://www.copetti.org/images/consoles/psvita/psvita2.ef145b257ce54a14372f29e1e664cad7e23422aeee2aa5cdc408adc6b9e3cc60.png" loading="lazy"/></picture></a><figcaption>The &#39;updated&#39; PS Vita (model PCH-2000, a.k.a. &#39;Slim&#39;).</figcaption></figure><figure id="cover-model-tv"><a href="https://www.copetti.org/images/consoles/psvita/pstv.56fe02a3c4e775ce5ed82886d3a26b32e743a41630484a3712eea93b01b8a13d.png"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psvita/_hud53af2b398085a1a40de10d026849532_217950_1b175e2061f6d93b1de98e22cb22c353.webp 500w,
https://www.copetti.org/images/consoles/psvita/_hud53af2b398085a1a40de10d026849532_217950_a7581f5b4e7a304e21775e78c83583ee.webp 800w,
https://www.copetti.org/images/consoles/psvita/_hud53af2b398085a1a40de10d026849532_217950_c184fbf420d30468841ae54b289a7db7.webp 1111w"/><img alt="Image" width="1111" height="696" src="https://www.copetti.org/images/consoles/psvita/pstv.56fe02a3c4e775ce5ed82886d3a26b32e743a41630484a3712eea93b01b8a13d.png" loading="lazy"/></picture></a><figcaption>The &#39;consolised&#39; PS Vita (model VTE-1000).</figcaption></figure></div><h3>Motherboard</h3><figure id="cover-motherboard"></figure></div></section><hr/><h2 id="a-quick-introduction">A quick introduction</h2><p>The PSVita is a noteworthy intersection between the video-game establishment and the rapidly evolving mobile sector. Times have changed, and it won’t be easy for Sony as it faces fierce competition from cheap gadgets that do more than just make phone calls.</p><p>The new analysis of <a href="https://www.copetti.org/writings/consoles/">this series</a> dives into the contemporary technology behind Sony’s new delivery. Do expect to find recognisable circuitry - perhaps too familiar. Even so, Sony made clear efforts to steer away from any resemblance to the smartphone market.</p><h3 id="models-and-variants">Models and variants</h3><p>As the console sat on store shelves, Sony revisited its product strategy multiple times, leading to three variants of the PSVita being shipped throughout its lifecycle:</p><ul><li>The <strong>original</strong> PSVita (sometimes called the ‘Fat’ model) is the series debut.</li><li>The <strong>Slim</strong> revision retains the same architecture, but exchanges the OLED screen for an LCD to reduce costs. Furthermore, it doesn’t offer a 3G-capable variant anymore. It does, however, feature a bigger eMMC chip… only 52 MB larger! For some strange reason, that was enough to provide an internal 1 GB memory card. In any case, I’ll explain more in the ‘Games’ section.</li><li>The <strong>PlayStation TV</strong> is just a Slim motherboard adapted for the non-portable setting.</li></ul><p>As you can see, the information in this article will easily apply to all three models, although I will dedicate extra paragraphs to talk about the puzzling eMMC changes of the last two variants.</p><h3 id="a-new-publishing-model">A new publishing model</h3><p>Until now, my delivery model involved finishing the whole analysis and then publishing a complete article at once. However, as I continue studying the 8th generation, my articles have considerably grown in complexity. They tend to take almost a year to finish, and the review process has become too cumbersome. Thus, for a change, I’d like to try a new phased approach where I publish by sections instead, starting with the CPU. This will also make the reviewing stage more efficient.</p><p>Having said that, let’s start with the first section.</p><hr/><h2 id="cpu">CPU</h2><p>Sony had been an avid adopter of MIPS technology since the original PlayStation. Even at times when SGI/MIPS was losing market share in the late 90s, Sony shipped a <a href="https://www.copetti.org/writings/consoles/playstation-portable/">successful product</a> carrying MIPS’ <a href="https://www.copetti.org/writings/consoles/playstation-portable/#mips-after-the-turn-of-the-century">revamped line</a>. However, the next decade proved bitter: ARM managed to <a href="https://www.copetti.org/writings/consoles/nintendo-ds/#turning-points">monopolise</a> the mobile market and MIPS’ adoption only diminished. Thus, Sony ultimately put their faith in an ARM CPU instead, and Toshiba (Sony’s close manufacturing <a href="https://www.copetti.org/writings/consoles/playstation-2/#a-special-order-for-sony">partner</a>) would now play the role of <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#tab-1-2-a-new-cpu-venture">ARM licensee</a>.</p><p>The resulting motherboard only houses a handful of integrated circuits, but they package a mix of designs authored by different companies. The main chip is called <strong>Kermit</strong> <sup id="bibref:1"><a href="#bib:cpu-kermit" role="doc-biblioref">[1]</a></sup> (a name borrowed from ‘The Muppets’), it features the largest amount of circuitry, and it’s where the main CPU resides.</p><figure><a href="https://www.copetti.org/images/consoles/psvita/photos/kermit.eacea19e5654107edd286da36949155f606f9545d2ad9d8820542bb5e36b65b7.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psvita/photos/kermit.eacea19e5654107edd286da36949155f606f9545d2ad9d8820542bb5e36b65b7.webp"/><img alt="Image" width="846" height="582" src="https://www.copetti.org/images/consoles/psvita/photos/_hu8cb4d5a93629ee790fbf786b462ec175_52358_e8af1d0c10002cb199314cd254d1e253.png" loading="lazy"/></picture></a><figcaption>The Kermit chip in the original PSVita model. This tiny block houses multiple CPUs, GPUs and ~640 MB of RAM… how far we’ve come!</figcaption></figure><p>Now, while Kermit is considered a <strong>System-On-Chip</strong> (SoC), it exceptionally manages to combine large amounts of memory and processors within the same package. This is thanks to Toshiba’s <strong>Stacked Chip SoC</strong> (SCS) fabrication model <sup id="bibref:2"><a href="#bib:cpu-scs" role="doc-biblioref">[2]</a></sup>. Within it, circuitry is piled on top of others - as opposed to being externally connected side-by-side. The direct consequence is an increase of bandwidth and a reduction of surface footprint, at the cost of a more complex heat dissipation design.</p><p>In any case, SCS fabrication enabled Sony and Toshiba to fit cutting-edge technology while maintaining an energy-efficient profile, just look at all the components Kermit houses:</p><ul><li>The <strong>main CPU</strong>, a quad-core ARM Cortex-A9 MPCore.</li><li>The <strong>main GPU</strong>, a PowerVR SGX543MP4+ by Imagination Technologies.</li><li>Many <strong>accelerators</strong> (some proprietary, others off the shelf), including an ‘AVC Decoder’, <a href="https://www.copetti.org/writings/consoles/playstation/#taking-over-the-cpu">DMA Controllers</a>, a large DSP and security blocks (which includes hidden ROM space).</li><li><strong>Around 640 MB of RAM</strong> (split into multiple types).</li><li>Last but not least, <strong>legacy PlayStation Portable circuitry</strong> (the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#cpu">MIPS CPU</a> and the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#graphics">Graphics Engine</a>).</li></ul><p>…and throughout this article we’ll take a look at each of those!</p><h3 id="the-main-cpu">The main CPU</h3><p>Our new study subject is the <strong>ARM Cortex-A9 MPCore</strong>, a very mature processor from ARM Ltd. </p><p>To make this study captivating and help understand all the technological progress since <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#cpu">my last analysis</a> of the ARM11 CPU, I’d like to begin with an overview of the new ‘Cortex’ line. Then, a quick look at the Cortex-A8 (the predecessor of the A9). Finally, the novelties of the Cortex-A9.</p><h4 id="continued-history">Continued history</h4><figure><figure><a href="https://www.copetti.org/images/consoles/gba/cpu_agb.5718b7d30c573e668823d04f3b2df402e5d74eced59d0aca30219c2171549a56.png"><picture><img alt="Image" width="300" height="232" src="https://www.copetti.org/images/consoles/gba/cpu_agb.5718b7d30c573e668823d04f3b2df402e5d74eced59d0aca30219c2171549a56.png" loading="lazy"/></picture></a><figcaption>The Game Boy Advance housed an ARM7TDMI.</figcaption></figure><figure><a href="https://www.copetti.org/images/consoles/nintendods/cpu_ntr.e00a63784a027cf659e3c8d8f61868a1c9708a3f8b3d4b89e533e991218c0efb.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/nintendods/_hu40410fe630da5453ce9d993455548393_71576_1960096c81b9a73df2547b87f8127cfd.webp 464w"/><img alt="Image" width="464" height="388" src="https://www.copetti.org/images/consoles/nintendods/cpu_ntr.e00a63784a027cf659e3c8d8f61868a1c9708a3f8b3d4b89e533e991218c0efb.jpg" loading="lazy"/></picture></a><figcaption>The Nintendo DS housed an ARM946E-S and ARM7TDMI.</figcaption></figure><figcaption>Past System-on-Chips (SoCs) housing iconic ARM CPUs.</figcaption></figure><p>ARM has come a long way since the days of the <a href="https://www.copetti.org/writings/consoles/game-boy-advance/">Game Boy Advance</a>, to recall its significant milestones:</p><ul><li>The ARM CPU was conceived as a <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#tab-1-1-the-rise-of-acorn-computers">replacement</a> of the <a href="https://www.copetti.org/writings/consoles/nes/#cpu">MOS 6502</a> CPU for Acorn’s computers, later reaching maturity thanks to <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#tab-1-2-a-new-cpu-venture">Apple’s input</a>.</li><li>The <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#the-arm7tdmi">ARM7TDMI</a> paved the way for success in the embedded market. At the same time, competitors across the pond <a href="https://www.copetti.org/writings/consoles/playstation-portable/#the-end-of-the-line">chose to avoid any mobile venture</a>.</li><li>The subsequent <a href="https://www.copetti.org/writings/consoles/nintendo-ds/#arms-new-territories">StrongARM/ARM9</a> line granted the company a spot in the performance sector.</li><li><a href="https://www.copetti.org/writings/consoles/playstation-portable/#the-end-of-the-line">As the competition faded</a>, the new <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#cpu">ARM11 line</a> demonstrated this CPU could now partake on 3D applications.</li></ul><p>The next achievement would become <strong>Cortex</strong>: a new brand carrying a revised instruction set and processor line. This time, ARM would adopt practices traditionally found in the desktop/workstation market, eventually coming heads-to-head with Intel’s x86. Curiously enough, Cortex’s marketing strategy is very similar to Intel’s Pentium, in the sense that the name ‘Cortex’ ultimately becomes an ambiguous term to hide the complicated identifications and variants of all its chips.</p><h5 id="the-cortex-line-up">The Cortex line-up</h5><p>With the announcement of Cortex as a brand, ARM’s product line diversified into three distinguishable sectors: <strong>industrial</strong>, <strong>performance</strong> and <strong>embedded</strong>. Thus, any Cortex CPU would be fitted into a ‘profile’ (Cortex-R, Cortex-A and Cortex-M, respectively), each targeting one of these markets. For this study, we’ll focus on the <strong>Cortex-A</strong> line, which focused on performance or ‘applications’ (in other words, user devices); and made a profound impact on smartphones.</p><figure><a href="https://www.copetti.org/images/consoles/psvita/cortexa8_phones.fce29b750612bf9558672988bda179ca1b946360bd89775cd85d61b65e454ac1.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psvita/cortexa8_phones.fce29b750612bf9558672988bda179ca1b946360bd89775cd85d61b65e454ac1.webp"/><img alt="Image" width="1100" height="452" src="https://www.copetti.org/images/consoles/psvita/_hu544632fc7cf0c5975b0f2f30a9ae9eb1_48164_ad8fc51f938953fa3abeb0fad37f0e61.png" loading="lazy"/></picture></a><figcaption>Some smartphones from the Cortex-A8 generation. From left to right: iPhone 3GS (2009), Nokia N900 (2009), Palm Pre (2009) and Nexus S (2010)</figcaption></figure><p>ARM’s first delivery for ‘applications’ was the <strong>Cortex-A8</strong> CPU. It shipped in 2005, but it wasn’t until four years later that smartphones started adopting it. The <strong>iPhone 3GS</strong>, <strong>Motorola Droid</strong> and <strong>Nokia N900</strong> were its debuting flagship carriers. Be as it may, the CPU can’t work by itself, so these devices relied on Samsung and Texas Instruments to package all the necessary modules into a SoC (combining the CPU with the GPU, modem and other I/O).</p><p>It’s worth mentioning that the Cortex CPU was also a decisive choice for manufacturers finally making the jump from <a href="https://www.copetti.org/writings/consoles/nintendo-ds/#turning-points">Intel’s XScale</a>, such as RIM and its Blackberry line. On the other side, certain smartphones like the Toshiba TG01 and the HTC HD2 only adopted Cortex’s technology partially (they implement the same instruction set, but its microarchitecture was designed by Qualcomm instead).</p><p>Notice that these devices also coincide with a certain time when users considerably changed their attitude towards smartphones: these were initially trusted for trivial tasks such as text messages and e-mail, but now they were starting to provide access to bank accounts, with only a few years behind bringing contactless payments.</p><h5 id="more-news">More news</h5><p>Along the Cortex-A8 came the <strong>ARMv7</strong> instruction set. This is the continuation of the <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#new-dialects">ARMv6 ISA</a> by expanding its multi-processing and SIMD capabilities <sup id="bibref:3"><a href="#bib:cpu-thomas_v7" role="doc-biblioref">[3]</a></sup>.</p><p>ARMv7 is the longest-living 32-bit ISA from ARM, but also the last one. Its wide-spread adoption would still be highly <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#and-a-fragmented-distribution">fragmented</a>, mainly due to the split of Cortex into the aforementioned profiles (spawning different subsets of the ISA), existing adoption of the ARMv6 (i.e. the first Raspberry Pi and Nokia’s Symbian platform only supported ARMv6) and the enlargement of Thumb. To avoid making this topic too dense, I’ve dedicated different sections further down to discuss these.</p><h4 id="the-core">The core</h4><p>So far I’ve talked about the Cortex-A8, that’s the first Cortex CPU. But the PSVita actually bundles the succeeding CPU, the <strong>Cortex-A9</strong> (released two years later, in 2007). It’s curious to see that this console was just a few months apart from the <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/">Nintendo 3DS</a>, a console designed with horizontal innovation in mind.</p><p>Moving on, the full name of the PSVita’s CPU is <strong>ARM Cortex-A9 MPCore</strong>. Overall, this means the CPU is a cluster made of <strong>multiple Cortex-A9 cores</strong>, <strong>four</strong> in this case. It runs at a clock speed of <strong>up to 500 MHz</strong> <sup id="bibref:4"><a href="#bib:cpu-psdev_cpu" role="doc-biblioref">[4]</a></sup>, an underwhelming number considering contemporary adopters of the quad-core A9, such as the Samsung Galaxy S III, reached speeds of 1.4 GHz <sup id="bibref:5"><a href="#bib:cpu-galaxy" role="doc-biblioref">[5]</a></sup>. It’s possible that battery life was the main priority here. Nevertheless, clock speed is not the only decisive measurement, the inner workings of the CPU are as important.</p><p>Speaking of which, the new cores share many characteristics with their predecessor, the Cortex-A8, which includes <sup id="bibref:6"><a href="#bib:cpu-cortexa8_reference" role="doc-biblioref">[6]</a></sup>:</p><ul><li>The next-generation instruction set called <strong>ARMv7-A</strong>, I explain more details further on.</li><li><strong>64 KB of L1 cache</strong> which inherently follows the <a href="https://www.copetti.org/writings/consoles/nintendo-ds/#arms-new-territories">Harvard architecture</a>. Consequently, it’s divided into <strong>32 KB for data</strong> and <strong>32 KB for instructions</strong>.<ul><li>Cache coherency among the cores is automatically handled by the <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#tab-3-3-the-axi-bus">Snoop Control Unit</a>, previously featured in the ARM11MpCore.</li></ul></li><li><strong>2-issue superscalar</strong>: For the first time, ARM has brought <a href="https://www.copetti.org/writings/consoles/xbox-360/#an-alternative-solution">instruction-level parallelism</a>. This means that, as long as there are no <a href="https://www.copetti.org/writings/consoles/playstation/#delay-galore">hazards</a>, the CPU will try to execute two instructions using two separate pipelines. This increases the amount of instructions executed per clock cycle. <a href="https://www.copetti.org/writings/consoles/playstation-2/#tab-1-1-outperforming-success">MIPS</a> and <a href="https://www.copetti.org/writings/consoles/dreamcast/#the-offering">SuperH</a> brought this a decade before, but the two suffered a quick demise, so it’s now ARM’s turn to carry it forward.</li><li><strong>Dynamic branch prediction</strong>: The CPU now predicts the execution path by relying on two dedicated buffers while fetching instructions. The first anticipates whether an upcoming instruction will be a branch, and the next buffer maps the previous flow of the program. Finally, the latter is used to predict whether upcoming branches will be taken or not <sup id="bibref:7"><a href="#bib:cpu-cortexa8_imp" role="doc-biblioref">[7]</a></sup>.<ul><li>It’s worth mentioning that this unit <strong>only predicts branching instructions</strong>, omitting other optimisation techniques such as <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#commanding-the-cpu">conditionals</a> or the <code>IT</code> instruction… Maybe that’s a hint about the future of the ARM ISA.</li></ul></li><li>A <a href="https://www.copetti.org/writings/consoles/nintendo-64/#memory-management">Memory Management Unit</a> (MMU) with a Translation Lookaside Buffer (TLB). This is already typical on most CPUs.<ul><li>By the way, in the case of the Cortex brand, only the ‘Cortex-A’ profile includes this package (the ‘Cortex-R’ bundles an <a href="https://www.copetti.org/writings/consoles/playstation-vita/#focused-memory-management">MPU</a> instead and the ‘Cortex-M’ includes neither).</li></ul></li><li><strong>TrustZone</strong>: A new security subsystem that adds a dimension to the <a href="https://www.copetti.org/writings/consoles/playstation-vita/#focused-memory-management">privilege levels</a> of the MMU. It’s implemented on both the hardware level (by segregating buses between non-secure and secure peripherals) and the software level (by executing a secondary and isolated operating system that handles confidential data). The special OS is called <strong>Trusted Execution Environment</strong>.<ul><li>The OS model of TrustZone reminds me of the <a href="https://www.copetti.org/writings/consoles/playstation-3/#cells-privileged-security">isolated SPU of Cell</a>.</li></ul></li><li><strong>NEON Media Processing Engine</strong> (MPE), a new co-processor that carries out vector and floating-point operations. We’ll dive more into it in the next sections.</li></ul><p>Now, the Cortex-A9 (found in the PSVita) improves the original design by applying significant enhancements <sup id="bibref:8"><a href="#bib:cpu-cortexa9_mpcore" role="doc-biblioref">[8]</a></sup>:</p><ul><li><strong>Multi-core support</strong>. This is most evident by looking at Sony’s choice of a quad-core package.<ul><li>As a side note, this also explains why portable devices like the iPad 2 and iPhone 4s (both carrying an A9) managed to debut a dual-core CPU.</li></ul></li><li><strong>Out-Of-Order execution</strong> through the use of <a href="https://www.copetti.org/writings/consoles/xbox-360/#revisiting-old-paradigms">register renaming</a>. This is a huge step for ARM in further scaling its <a href="https://www.copetti.org/writings/consoles/xbox-360/#an-alternative-solution">Instruction level parallelism</a>, considering other chips like PowerPC were forced to <a href="https://www.copetti.org/writings/consoles/xbox-360/#revisiting-old-paradigms">abandon it</a>.<ul><li>This will also have a profound effect on the evolution of the ARM instruction set. You will see this in a future analysis of the Nintendo Switch.</li></ul></li><li>A <strong>variable-length pipeline</strong>, between <strong>8 and 11 stages</strong> depending on the operation. The total number may also increase if execution continues in the multimedia co-processor (explained in the next section).</li></ul><p>Moreover, Sony customised the package by adding one of ARM’s upgrades called <strong>Primelink Level 2 Cache Controller</strong> along with <strong>2 MB of L2 cache</strong> shared among all cores <sup id="bibref:9"><a href="#bib:cpu-primelink_l2" role="doc-biblioref">[9]</a></sup>. Primelink is a flexible cache subsystem which can be programmed with different types of <a href="https://www.copetti.org/writings/consoles/xbox-360/#shared-cache">cache associations</a>, from direct mapping to 16-way. If you are curious, years later ARM renamed the Primelink brand to ‘CoreLink’ <sup id="bibref:10"><a href="#bib:cpu-corelink_l2" role="doc-biblioref">[10]</a></sup>.</p><h4 id="the-grown-up-isa">The grown-up ISA</h4><p>The ARMv7 instruction set in the Cortex-A9 features a multitude of extensions. The majority of changes will be in the form of <a href="https://www.copetti.org/writings/consoles/dreamcast/#special-work">SIMD capabilities</a> and multiprocessing, you’ll notice this when we take a closer look into the novelties of the ARMv7.</p><div><ul><li id="tab-2-1-a-quick-glance-link"><a href="#tab-2-1-a-quick-glance">A quick glance</a></li><li id="tab-2-2-overshadowing-features-link"><a href="#tab-2-2-overshadowing-features">Overshadowing features</a></li></ul><div><div id="tab-2-1-a-quick-glance"><h5 id="tab-2-1-a-quick-glance">A quick glance</h5><p>ARMv7 is a superset of the ARMv6 ISA. Its additions can be grouped into four areas: VFPv3, NEON, Security Extension and multi-processing. I explain each further down.</p><p>Moreover, the alternative <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#tab-2-3-squeezing-performance">Thumb ISA</a> (previously enhanced with <a href="https://www.copetti.org/writings/consoles/nintendo-ds/#tab-1-2-arm946e-s">Thumb v2</a>) has undergone a major revision called <strong>Thumb-2</strong>. Truth to be told, it already debuted on embedded ARMv6 CPUs (implementing the ARMv6T2 variant), but it has now become a standard on the Cortex-A line.</p><p>On the other side, it’s worth mentioning that <strong>Thumb-2EE</strong>, the successor of the deprecated <a href="https://www.copetti.org/writings/consoles/wii/#the-hidden-co-processor">Jazelle</a>, has been left unused or even excluded from many Cortex-A CPUs. I don’t think the Vita’s SoC even bothers implementing this. If you want an idea of its adoption back in the day, let me tell you that Dalvik (Android’s Java interpreter, to put it simply) didn’t even bother using Jazelle/Thumb-2EE at all. That tells you the general attitude towards ARM’s Java efforts.</p></div><div id="tab-2-2-overshadowing-features"><h5 id="tab-2-2-overshadowing-features">Overshadowing features</h5><p>Back to the interesting bit, Thumb-2 is a significant revamp of Thumb because it <strong>adds 32-bit instructions</strong> <sup id="bibref:11"><a href="#bib:cpu-thomas_thumb" role="doc-biblioref">[11]</a></sup>. Considering Thumb originally only bundled 16-bit opcodes, it now has filled all the missing gaps when compared to the master ISA (ARM). Now, in contrast with ARM, Thumb-2 offers greater density and is only missing the <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#commanding-the-cpu">conditionals</a>. Even so, Thumb-2 manages to bridge this functionality by including an exclusive <code>IT</code> instruction.</p><p>Nevertheless, Thumb’s renovation unfortunately means more fragmentation and confusion, eventually to the point assembler developers can’t decide which instruction set to use. ‘Lucky’ for them, ARM also devised a specification called <strong>Unified Assembler Language</strong> (UAL) that aimed to consolidate all ISAs in a single codebase that can target both ARM and Thumb-2 ISAs. This allows programs written in UAL to be assembled for all variants of Cortex CPUs (some of which implement ARM and Thumb-2 ISA while others only support Thumb-2). Behind the scenes, UAL is just the union of ARM and Thumb-2 opcodes, the assembler then skips opcodes based on the target CPU. For instance, when it comes to writing a branching subroutine, programmers must write the two types of branching opcodes in the same routine (ARM’s conditionals and Thumb-2’s <code>IT</code> instruction) - effectively ‘duplicating’ code. However, the assembler then decides which opcodes to parse based on the target processor.</p><p>In the case of using programming languages (C, Objective-C, C++, etc.), the decision is much simpler, <strong>compilers default to Thumb-2 for assembly generation</strong> <sup id="bibref:12"><a href="#bib:cpu-uni_fund" role="doc-biblioref">[12]</a></sup>, mainly due to its efficient code density and rare performance penalties. Thus, smartphone apps and, by extension, applications for the PSVita, are mainly compiled into Thumb-2 instead of ARM.</p></div></div></div><h5 id="more-accelerators">More accelerators</h5><p>The most notable component of the Cortex-A9, in particular for the PSVita, is the <strong>Media Processing Engine</strong> (MPE). This is ARM’s new coprocessor for 3D applications. It’s been engineered in a very convoluted way, however, as it executes two different but related instruction sets:</p><ul><li>The <strong>Vector Floating-Point v3</strong> (VFPv3): A continuation of <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#tab-3-1-the-original-mpcore">VFPv2</a> for floating-point capabilities. It’s IEEE-754 compliant and now extended to provide instructions like <code>VCVT</code> (to convert between fixed-point and floating-point values) and <code>VMOV</code> (to transfer values between the CPU and the FPU register file). This is helpful since <strong>the VFP only understands 32-bit and 64-bit floating-point values</strong>.<ul><li>The exact variant included in the Cortex-A9 is called ‘VFPv3-D32’, meaning it includes <strong>thirty-two 64-bit registers</strong>.</li><li>Even though this ISA contains the word ‘vector’, ARMv7 deprecated the use of the vector instructions and the Cortex-A9 includes none <sup id="bibref:13"><a href="#bib:cpu-cortexa9_mpe" role="doc-biblioref">[13]</a></sup>. <em>So much for being called a ‘vector FPU’…</em></li></ul></li><li>The <strong>NEONv1</strong>, also known as ‘ARMv7 Advanced SIMD’, is the <em>real</em> vector instruction set, enabling to operate multiple scalars at once. NEON provides <strong>sixteen 128-bit registers</strong>, which can be also split into thirty-two 64-bit or 32-bit ‘virtual’ registers. The integers being operated may be as big as 64 bits, while floating-point types can’t surpass 32 bits.<ul><li>It’s worth reminding that <a href="https://www.copetti.org/writings/consoles/playstation-portable/#coprocessors">Sony’s predecessor vector unit</a> provided the immense amount of 128 registers, albeit 32-bit instead. If we do the math, the Cortex-A9 MPCore manages to match that number. Although, only 16 registers are accessible per core, and forget about the matrix-type addressing that made the VFPU special and efficient. On the bright side, perhaps there’s a new optimisation opportunity by having multiple cores compute SIMD instructions in parallel.</li></ul></li></ul><p>NEON and VFPv3 share the same register file, but they’re still considered separate ISAs. Considering ancestral processors like the SH-4 delivered SIMD operations <a href="https://www.copetti.org/writings/consoles/dreamcast/#special-work">by simply extending its FPU</a>, one can only wonder why ARM ended up producing two distinct ISAs. Well, the explanation is simple: <strong>neither is feature-complete</strong>. Particularly, <strong>VFPv3 doesn’t support fixed-point</strong> while <strong>NEON is not compliant with the IEEE 754 standard</strong> <sup id="bibref:14"><a href="#bib:cpu-johnston" role="doc-biblioref">[14]</a></sup>. So, as an intermediate solution, the circuitry was segregated.</p><figure><a href="https://www.copetti.org/images/consoles/psvita/axim.2a01779d1fb8a57e6be9e8da7700b6d1f53a6daced1f632cfcc592ad7ddda29a.webp"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psvita/axim.2a01779d1fb8a57e6be9e8da7700b6d1f53a6daced1f632cfcc592ad7ddda29a.webp"/><img alt="Image" width="819" height="1000" src="https://www.copetti.org/images/consoles/psvita/_hu60b5a6ff262668fe2c1190207efeefa9_33220_e3f5313e7bddc82982e9b95f94e256f2.png" loading="lazy"/></picture></a><figcaption>The Dell Axim X51v (2005).</figcaption></figure><p>All in all, this means the compiler will need to work harder optimising the code, but it still makes you wonder why ARM’s engineers ended up complicating things to absurd levels. In my opinion, I believe NEON was rushed to rapidly counter <strong>Wireless MMX</strong> (Intel’s proprietary SIMD extension for the XScale, released a year before) as ARM didn’t enjoy seeing Intel bundling exclusive instructions only available on the XScale <sup id="bibref:15"><a href="#bib:cpu-mmx" role="doc-biblioref">[15]</a></sup>. This is also complemented by the fact the official documentation on Cortex’s timings was hurried as well <sup id="bibref:16"><a href="#bib:cpu-timings" role="doc-biblioref">[16]</a></sup>.</p><h3 id="the-master-bus">The master bus</h3><p>Another popular product from ARM, the <a href="https://www.copetti.org/writings/consoles/wii/#the-hidden-co-processor">AMBA protocol</a> designed for interconnecting components, carries forward with the Cortex-A9. Still in its <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#tab-3-3-the-axi-bus">third revision</a>, the AXI subset was selected for interfacing the cores and external components outside the MPCore cluster. Curiously enough, it’s the <a href="https://www.copetti.org/writings/consoles/nintendo-3ds/#tab-3-3-the-axi-bus">same choice</a> found in the ARM11 and its well-known adopter, the Nintendo 3DS.</p><h3 id="envisioning-the-future">Envisioning the future</h3><p>After the Cortex-A9, the line of succession became increasingly confusing. The Cortex-A series was broken down into <strong>four more categories</strong>, ranging from the top performer to the most energy-efficient. In doing so, the model numbering of each CPU became absurdly difficult to follow, but I guess it didn’t matter for the end user because these CPUs weren’t sold off-the-shelf!</p><p>The next big milestone for ARM will debut in 2011, with the arrival of ARMv8. I’ll talk more about this in a future article about the Nintendo Switch.</p><h3 id="media-coprocessors">Media coprocessors</h3><p>Next to the ARM cluster, Sony bundled a couple of accelerators that support gaming-related tasks. Just like the previous <a href="https://www.copetti.org/writings/consoles/playstation-portable/#multimedia-cpu">Media Engine group</a>, they are completely proprietary and act as a black box. Programmers are not meant to fiddle with them directly but through the official SDK.</p><div><ul><li id="tab-3-1-venezia-link"><a href="#tab-3-1-venezia">Venezia</a></li><li id="tab-3-2-avc-decoder-link"><a href="#tab-3-2-avc-decoder">AVC Decoder</a></li></ul><div><div id="tab-3-1-venezia"><h4 id="tab-3-1-venezia">Venezia</h4><figure><a href="https://www.copetti.org/images/consoles/psvita/cpu/venezia.82c55d77c81ac06f3440dbc7b4c6d8a53d3bafdbef9ecec59ec607d79ba68c40.png"><picture><img alt="Image" width="753" height="651" src="https://www.copetti.org/images/consoles/psvita/cpu/venezia.82c55d77c81ac06f3440dbc7b4c6d8a53d3bafdbef9ecec59ec607d79ba68c40.png" loading="lazy"/></picture></a><figcaption>Overview of Venezia.</figcaption></figure><p>To start with, we’ve got <strong>Venezia</strong>. This is a complete and separate CPU package designed by Sony’s close partner, Toshiba, for image and sound processing <sup id="bibref:17"><a href="#bib:cpu-toshiba_press" role="doc-biblioref">[17]</a></sup>. With functionality closer to a Digital Signal Processor (DSP), Venezia was also sold as a <a href="https://www.copetti.org/writings/consoles/game-boy-advance/#tab-1-2-a-new-cpu-venture">synthesisable chip</a> for multimedia appliances (i.e. DVD players) <sup id="bibref:18"><a href="#bib:cpu-mep" role="doc-biblioref">[18]</a></sup>. Consequently, Sony selected it to accelerate multimedia tasks, so you could say it’s the spiritual successor of the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#multimedia-cpu">Media Engine</a>.</p><p>Similarly to the MPCore, Venezia is a cluster, this time made of <strong>eight ‘Media Processing Engine’ (MPE) cores</strong> operating at <strong>266.7 MHz</strong>. Notice that its naming confusingly overlaps with ARM’s vector accelerators, but they are different silicon. That being said, each of Toshiba’s MPEs houses <sup id="bibref:19"><a href="#bib:cpu-venezia" role="doc-biblioref">[19]</a></sup>:</p><ul><li>A proprietary <strong>‘Media-embedded Processor’ (MeP) CPU</strong>. Particularly, a fifth revision called ‘MeP-c5’. This features a 32-bit RISC-based architecture.</li><li><strong>32 KB L1 cache</strong>, split into 16 KB for instructions and 16 KB for data.</li><li><strong>64 KB</strong> of general-purpose memory. This is where the MeP CPU executes its main program.</li><li>A <strong>DMA controller</strong> for transferring between internal and external memory.</li><li>An <strong>‘Image Processing’ co-processor</strong> that executes 64-bit SIMD instructions. It can operate different packs of data, from eight 8-bit integers to two 32-bit ones.</li></ul><p>The cluster also features <strong>256 KB of L2 cache</strong>, but its main selling point is found in its instruction set, which is based on the <strong>Very Long Instruction Word (VLIW) model</strong>. Essentially, a single line can encode multiple instructions at once. In the case of Venezia, three instructions (two for the image coprocessor and one for the CPU) <sup id="bibref:20"><a href="#bib:cpu-berkeley_dsp" role="doc-biblioref">[20]</a></sup>. This requires a very clever compiler capable of packing instructions efficiently, however.</p><p>Interestingly enough, CPU designers once experimented with VLIW implementations back in the 90s when it was thought to be the future of mainstream CPUs. This led to Broadcom’s Firepath, the Transmeta Crusoe and, of course, the Intel Itanium - to name a few. However, the concept didn’t gain traction outside particular uses, as the resulting benchmarks proved disappointing. Thus, interests soon shifted to other parallelism techniques, such as <a href="https://www.copetti.org/writings/consoles/playstation-2/#tab-1-1-outperforming-success">out-of-order execution</a>, which transferred the burden back to the CPU.</p><p>Be as it may, Venezia is only accessible through an abstract API called ‘Codec Engine’ <sup id="bibref:21"><a href="#bib:cpu-venezia" role="doc-biblioref">[21]</a></sup>, which implements different kinds of image and audio encoding/decoding tasks.</p></div><div id="tab-3-2-avc-decoder"><h4 id="tab-3-2-avc-decoder">AVC Decoder</h4><p>Next, we’ve got the <strong>AVC Decoder</strong>. This is a relatively simpler DSP that, as the name indicates, only does one job: decompress video data encoded with ‘Advanced Video Coding’ (AVC) <sup id="bibref:22"><a href="#bib:cpu-onscripter" role="doc-biblioref">[22]</a></sup>.</p><p>The decoder then outputs an uncompressed stream the GPU understands.</p></div></div></div><h3 id="memory-available">Memory available</h3><p>Enough about CPU talk! Let’s now take a look at the memory bundled within the PSVita.</p><p>As it’s customary with portable consoles, there are multiple memory types in this system.</p><h4 id="main-memory">Main memory</h4><p>To start with, at the top of Kermit’s stack, we find a large block that houses <strong>512 MB of LPDDR2 SDRAM</strong> and is used as the main working area. In case you are now wondering “I get the ‘512 MB’ part, but what’s with all those initials?”, you’re not alone.</p><p>There’s a lot of terminology to unpack here, let’s start by breaking down the ‘LPDDR2 SDRAM’ name into two groups, from right to left, and then inspecting what’s inside each:</p><ol><li><strong>SDRAM</strong> means ‘Synchronous Dynamic RAM’.<ul><li>Dynamic RAM (DRAM) is the opposite of ‘Static RAM’ (SRAM). DRAM is cheaper to produce but exhibits more latency. That’s why CPU cache is made of SRAM while external general-purpose memory is made of DRAM.</li><li>Synchronous DRAM (<a href="https://www.copetti.org/writings/consoles/xbox/#memory-layout">SDRAM</a>) means transfers are synchronised on par with the CPU clock, improving its throughput.</li></ul></li><li><strong>LPDDR2</strong> means ‘Low Power Double Data Rate 2’.<ul><li>Double Data Rate (DDR) states that transfers encode twice the information per cycle.</li><li>Low Power (LP) is a novelty here. This is not typical DDR, but a distinct variant called ‘Low Power’. It was initially conceived as a modification of DDR SDRAM, then became its own brand alongside others (as it happened with <a href="https://www.copetti.org/writings/consoles/wiiu/#gddr3-or-ddr3">GDDR</a>). While DDR evolves to increase the bandwidth, new revisions of LP focus on reducing its operating voltage. As you may guess, its main adopters are phones and laptops.</li><li>The ‘2’ at the end signifies it’s the second revision of LPDDR. Its specification was published in 2009 and, among other improvements, it only needs 1.2 Volts to work (compared to 1.35 V for DDR3).</li></ul></li></ol><h4 id="other-memory">Other memory</h4><p>There’s another large block of <strong>128 MB of Cached DRAM (CDRAM)</strong> predominantly connected to the GPU. CDRAM is yet-another type of RAM that combines the traditional (and cheap/slower) DRAM with a bit of SRAM <sup id="bibref:23"><a href="#bib:cpu-mitsu_cdram" role="doc-biblioref">[23]</a></sup>. The latter acts as cache to speed up frequent memory access.</p><p>Last but not least, the SoC also fits <strong>16 KB of SRAM</strong>, but it’s reserved for system functions <sup id="bibref:24"><a href="#bib:cpu-memory" role="doc-biblioref">[24]</a></sup>. You may want to know that it’s the exact amount of SRAM also found in the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#memory-available">PlayStation Portable</a>, you’ll soon see why.</p><h3 id="one-last-cpu">One last CPU</h3><p>Last but not least, there’s an additional CPU inside Kermit: The old <strong><a href="https://www.copetti.org/writings/consoles/playstation-portable/#the-new-portable-cpu">MIPS32 4k</a></strong> (the same one bundled with the <a href="https://www.copetti.org/writings/consoles/playstation-portable/">PlayStation Portable</a>) <sup id="bibref:25"><a href="#bib:cpu-trinity" role="doc-biblioref">[25]</a></sup>. The intention was to provide backwards compatibility with <a href="https://www.copetti.org/writings/consoles/playstation-portable/">PlayStation Portable</a> and <a href="https://www.copetti.org/writings/consoles/playstation/">PlayStation 1</a> games. That’s the one and only (official) use for the MIPS CPU, with no co-processing capability in place.</p><figure><a href="https://www.copetti.org/images/consoles/psp/tachyon.a7c25cb952548e37638dbaf3bf0dc7719c4e7824426d34c915caa5c5115a2677.jpg"><picture><source type="image/webp" srcset="https://www.copetti.org/images/consoles/psp/_huf077cb2897ba78dcb9172cfc220d08f4_68080_ac6e7b5f64a10399c2d13a9361243cfe.webp 500w,
https://www.copetti.org/images/consoles/psp/_huf077cb2897ba78dcb9172cfc220d08f4_68080_3067374a7a3507074b3cac44449032bc.webp 700w"/><img alt="Image" width="700" height="594" src="https://www.copetti.org/images/consoles/psp/tachyon.a7c25cb952548e37638dbaf3bf0dc7719c4e7824426d34c915caa5c5115a2677.jpg" loading="lazy"/></picture></a><figcaption>The predecessor ‘Tachyon’ chip found on the PSP, housing the MIPS CPU and many other components.</figcaption></figure><p>Speaking of backwards compatibility, Kermit doesn’t include the <a href="https://www.copetti.org/writings/consoles/playstation-portable/#multimedia-cpu">Media Engine</a> <sup id="bibref:26"><a href="#bib:cpu-robots" role="doc-biblioref">[26]</a></sup>, although being a black box means that the software doesn’t care about what’s behind the scenes. Thus, the functions of that co-CPU are replicated through Venezia instead.</p><p>For the remaining I/O, MIPS is not physically connected to the rest of the hardware, only the Cortex-A9 is. Thus, the PSP emulation software (running on the MIPS CPU) requests services to the ARM CPU by following a protocol called ‘Remote Procedure Call’ (RPC) <sup id="bibref:27"><a href="#bib:cpu-trinity" role="doc-biblioref">[27]</a></sup> <sup id="bibref:28"><a href="#bib:cpu-davee_kermit" role="doc-biblioref">[28]</a></sup>.</p><p>Finally, 64 MB of CDRAM are also reserved for this service. Those 16 KB of SRAM are also allocated to the PSP emulator <sup id="bibref:29"><a href="#bib:cpu-memory" role="doc-biblioref">[29]</a></sup>, as original PSP games <a href="https://www.copetti.org/writings/consoles/playstation-portable/#memory-available">would expect to find</a>.</p><hr/><h2 id="next-graphics">Next: Graphics</h2><p>That’s it for now! In the next part we’ll take a look at <a href="https://www.copetti.org/writings/consoles/dreamcast/#graphics">VideoLogic</a>’s evolution to become a leading GPU in the mobile market, culminating in their signature PowerVR MBX GPU. <a href="https://www.copetti.org/writings/consoles/#stay-updated">Stay tuned</a> for the next delivery!</p></article></div>
  </body>
</html>
