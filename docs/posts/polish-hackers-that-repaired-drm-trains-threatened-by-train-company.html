<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.404media.co/polish-hackers-repaired-trains-the-manufacturer-artificially-bricked-now-the-train-company-is-threatening-them/">Original</a>
    <h1>Polish Hackers that repaired DRM trains threatened by train company</h1>
    
    <div id="readability-page-1" class="page"><div>
        <article>
          <div>
              
<!--kg-card-begin: html-->

<!--kg-card-end: html-->

<!--kg-card-begin: html-->
  <div>
    <h5>Subscribe</h5>
    <div>
      <p>Join the newsletter to get the latest updates.</p>
      
    </div>
  </div>

<!--kg-card-end: html-->
<p>They did DRM to a train. </p><p>In one of the coolest and more outrageous repair stories in quite some time, three white-hat hackers helped a regional rail company in southwest Poland unbrick a train that had been artificially rendered inoperable by the train’s manufacturer after an independent maintenance company worked on it. The train’s manufacturer is now threatening to sue the hackers who were hired by the independent repair company to fix it.  </p><p>The fallout from the situation is <a href="https://www.rynek-kolejowy.pl/wiadomosci/afera-hakerska--mamy-stanowiska-sps-i-newag--116410.html?ref=404media.co"><u>currently roiling Polish infrastructure circles</u></a> and the repair world, with the manufacturer of those trains denying bricking the trains despite ample evidence to the contrary. The manufacturer is also now demanding that the repaired trains immediately be removed from service because they have been “hacked,” and thus might now be unsafe, a claim they also cannot substantiate. </p><p>The situation is a heavy machinery example of something that happens across most categories of electronics, from phones, laptops, health devices, and wearables to tractors and, apparently, trains. In this case, NEWAG, the manufacturer of the Impuls family of trains, put code in the train’s control systems that prevented them from running if a GPS tracker detected that it spent a certain number of days in an independent repair company’s maintenance center, and also prevented it from running if certain components had been replaced without a manufacturer-approved serial number. </p><p>This anti-repair mechanism is called “parts pairing,” and is a common frustration for farmers who want to repair their John Deere tractors without authorization from the company. It’s also used by Apple to <a href="https://www.404media.co/ifixit-drastically-and-retroactively-reduces-repairability-score-of-iphone-14/"><u>prevent independent repair of iPhones</u></a>.</p><figure><img src="https://www.404media.co/content/images/2023/12/Screen-Shot-2023-12-13-at-6.06.14-AM.png" alt="" loading="lazy" width="1578" height="1178" srcset="https://www.404media.co/content/images/size/w600/2023/12/Screen-Shot-2023-12-13-at-6.06.14-AM.png 600w, https://www.404media.co/content/images/size/w1000/2023/12/Screen-Shot-2023-12-13-at-6.06.14-AM.png 1000w, https://www.404media.co/content/images/2023/12/Screen-Shot-2023-12-13-at-6.06.14-AM.png 1578w" sizes="(min-width: 720px) 720px"/><figcaption><span>An image posed by q3k of how the team did their work.</span></figcaption></figure><p>In this case, a Polish train operator called Lower Silesian Railway, which operates regional train services from Wrocław, purchased 11 Impuls trains. It began to do regular maintenance on the trains using an independent company called Serwis Pojazdów Szynowych (SPS), which notes on its website that “many Polish carriers have trusted us” with train maintenance. Over the course of maintaining four different Impuls trains, SPS found mysterious errors that prevented them from running. SPS became desperate and Googled “Polish hackers” and came across a group called Dragon Sector, a reverse-engineering team made up of white hat hackers. The trains had just undergone “mandatory maintenance” <a href="https://www.rynek-kolejowy.pl/wiadomosci/nie-uruchamia-sie-kolejny-impuls--na-pomorzu-zachodnim-108548.html?ref=404media.co"><u>after having traveled a million kilometers</u></a>.</p><p>“This is quite a peculiar part of the story—when SPS was unable to start the trains and almost gave up on their servicing, someone from the workshop typed &#34;polscy hakerzy&#34; (‘Polish hackers’) into Google,” the team from Dragon Sector, made up of Jakub Stępniewicz, Sergiusz Bazański, and Michał Kowalczyk, told me in an email. “Dragon Sector popped up and soon after we received an email asking for help.”</p><p>The problem was so bad that an infrastructure trade publication in Poland called Rynek Kolejowy <a href="https://www.rynek-kolejowy.pl/wiadomosci/tajemnicza-awaria-impulsow-to-dlatego-bedzie-mniej-pociagow-do-sobotki-108480.html?ref=404media.co"><u>picked up on the mysterious issues</u></a> over the summer, and said that the <a href="https://www.rynek-kolejowy.pl/wiadomosci/tajemnicza-awaria-impulsow-to-dlatego-bedzie-mniej-pociagow-do-sobotki-108480.html?ref=404media.co"><u>lack of working trains</u></a> was beginning to impact service: “Four vehicles after level P3-2 repair cannot be started. At this moment, it is not known what caused the failure. The lack of units is a serious problem for the carrier and passengers, because shorter trains are sent on routes.”</p><p>The hiring of Dragon Sector was a last resort: “In 2021, an independent train workshop won a maintenance tender for some trains made by Newag, but it turned out that they didn&#39;t start after servicing,” Dragon Sector told me. “[SPS] hired us to analyze the issue and we discovered a ‘workshop-detection’ system built into the train software, which bricked the trains after some conditions were met (two of the trains even used a list of precise GPS coordinates of competitors&#39; workshops). We also discovered an undocumented ‘unlock code’ which you could enter from the train driver’s panel which magically fixed the issue.”</p><p>Dragon Sector was able to bypass the measures and fix the trains. The group posted a YouTube video of the train operating properly after they’d worked on it: </p><figure><iframe width="200" height="113" src="https://www.youtube.com/embed/Gv6vjhkLQpM?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" title="To był Impuls"></iframe></figure><p>The news of Dragon Sector’s work was first reported by the Polish outlet <a href="https://zaufanatrzeciastrona.pl/post/o-trzech-takich-co-zhakowali-prawdziwy-pociag-a-nawet-30-pociagow/?ref=404media.co"><u>Zaufana Trzecia Strona</u></a> and was translated into English <a href="https://badcyber.com/dieselgate-but-for-trains-some-heavyweight-hardware-hacking/?ref=404media.co"><u>by the site Bad Cyber</u></a>. Kowalczyk and Stępniewicz gave a talk about the saga last week at Poland’s Oh My H@ck conference in Warsaw. The group plans on doing further talks about the technical measures implemented to prevent the trains from running and how they fixed it. </p><p>“These trains were locking up for arbitrary reasons after being serviced at third-party workshops. The manufacturer argued that this was because of malpractice by these workshops, and that they should be serviced by them instead of third parties,” Bazański, who goes by the handle q3k, <a href="https://social.hackerspace.pl/@q3k/111528162462505087?ref=404media.co" rel="noreferrer">posted on Mastodon</a>. “After a certain update by NEWAG, the cabin controls would also display scary messages about copyright violations if the human machine interface detected a subset of conditions that should&#39;ve engaged the lock but the train was still operational. The trains also had a GSM telemetry unit that was broadcasting lock conditions, and in some cases appeared to be able to lock the train remotely.”</p><figure><img src="https://www.404media.co/content/images/2023/12/Screen-Shot-2023-12-13-at-6.06.23-AM.png" alt="" loading="lazy" width="1104" height="838" srcset="https://www.404media.co/content/images/size/w600/2023/12/Screen-Shot-2023-12-13-at-6.06.23-AM.png 600w, https://www.404media.co/content/images/size/w1000/2023/12/Screen-Shot-2023-12-13-at-6.06.23-AM.png 1000w, https://www.404media.co/content/images/2023/12/Screen-Shot-2023-12-13-at-6.06.23-AM.png 1104w" sizes="(min-width: 720px) 720px"/><figcaption><span>The train had a system that detected if it physically had been to an independent repair shop.</span></figcaption></figure><p>All of this has created quite a stir in Poland (and in repair circles). NEWAG did not respond to a request for comment from 404 Media. But Rynek Kolejowy reported that the company is now very mad, and has threatened to sue the hackers. In a statement to Rynek Kolejowy, NEWAG said “Our software is clean. We have not introduced, we do not introduce and we will not introduce into the software of our trains any solutions that lead to intentional failures. This is slander from our competition, which is conducting an illegal black PR campaign against us.” The company added that it has reported the situation to “the authorized authorities.”</p><p>“Hacking IT systems is a violation of many legal provisions and a threat to railway traffic safety,” NEWAG added. “We do not know who interfered with the train control software, using what methods and what qualifications. We also notified the Office of Rail Transport about this so that it could decide to withdraw from service the sets subjected to the activities of unknown hackers.”</p><p>In response, <a href="https://www.rynek-kolejowy.pl/wiadomosci/hakerzy-odpowiadaja-newagowi-116487.html?ref=404media.co"><u>Dragon Sector released a lengthy statement</u></a> explaining how they did their work and explaining the types of DRM they encountered: “We did not interfere with the code of the controllers in Impulsa - all vehicles still run on the original, unmodified software,” part of the statement reads. SPS, meanwhile, <a href="https://www.rynek-kolejowy.pl/wiadomosci/afera-hakerska--mamy-stanowiska-sps-i-newag--116410.html?ref=404media.co"><u>has said that its position</u></a> “is consistent with the position of Dragon Sector.”</p><p>Kowalczk told 404 Media that “we are answering media and waiting to be summoned as witnesses,” and added that “NEWAG said that they will sue us, but we doubt they will - their defense line is really poor and they would have no chance defending it, they probably just want to sound scary in the media.” </p><p>This strategy—to intimidate independent repair professionals, claim that the device (in this case, a train) is unsafe, and threaten legal action—is an egregious but common playbook in manufacturers’ fight against repair, all over the world. In the United States, an exemption to Section 1201 of the Digital Millennium Copyright Act allows for repair pros to hack land-based motor vehicles, “which would cover trains,” Gay Gordon-Byrne, executive director of right to repair advocacy group Repair.org told 404 Media. </p><p>“All of this is classic OEM bullshit,” Gordon-Byrne said, using an acronym for original equipment manufacturer. “This is the kind of stuff DRM lets you do, and if you don’t stop it, this is where it goes. What the OEM thinks shouldn’t matter anymore, because they’re not the owner of the train anymore. It’s DRM gone wild.”</p><p>But in Europe, the legality of what Dragon Sector did is murkier. Digital rights advocate and copyright expert Cory Doctorow explained <a href="https://pluralistic.net/2023/12/08/playstationed/?ref=404media.co" rel="noreferrer">in his excellent Pluralistic blog</a> that Article 6 of <a href="https://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX%3A32001L0029%3AEN%3AHTML&amp;ref=404media.co" rel="noreferrer">Europe&#39;s 2001 Copyright and Information Society Directive</a> is generally stricter on DRM circumvention than Section 1201 of the DMCA, and does not have a specific repair exemption. Because of this law, Doctorow told 404 Media that &#34;there is now an extra layer of jeopardy for these researchers. They were brave to come forward and talk about it.&#34; Doctorow said that some similar types of research that bypass DRM and technological protection measures (TPMs) in Europe has been done anonymously or behind the scenes for this reason, creating a chilling effect on this type of research. </p><p>During the height of the pandemic, I wrote an article about how a Polish hacker <a href="https://www.vice.com/en/article/3azv9b/why-repair-techs-are-hacking-ventilators-with-diy-dongles-from-poland?ref=404media.co" rel="noreferrer">had developed a dongle</a> that was being used by American repair professionals to bypass DRM on ventilators needed to keep COVID-19 patients alive. That hacker wanted to keep themselves anonymous in part because they feared being prosecuted under EU law. Doctorow said that these sorts of cases—ones involving tractors, trains, other things that people <em>obviously</em> should be able to fix, are ones that can help change laws and regulations. &#34;This is the kind of claim that might actually help unravel these anti-circumvention measures,&#34; he said. &#34;A Polish train operator who wants to fix a Polish train they own is just a no brainer.&#34; </p><p>Earlier this week, a group called the National Association of Manufacturers <a href="https://documents.nam.org/COMM/NAM-3740-Right%20to%20Repair%20Paper%20R4%20V1%20FIN.pdf?ref=404media.co"><u>released a paper</u></a> called “The Economic Downsides of ‘Right-to-Repair’,” which is nominally a piece of research but is just an astroturfed policy paper for big corporations that oppose repair. The paper includes a section called “Altering equipment poses a dramatic increase in violating safety standards and falling out of federal compliance,” which is an extremely common argument that John Deere, medical device manufacturers, Apple, and many other OEMs have made when lobbying against right to repair regulations and laws.</p><p>In other words, the “safety” line of argument that NEWAG is using to try to undermine this repair is a common refrain across every industry of electronics. </p><p>“You name an industry and I’ll give you an example of something like this,” Gordon-Byrne said. “John Deere says farm workers are going to die, your tractor is going to run out of control [if repaired without Deere oversight].” She said that the same diagnostic tools that are used to determine what the problem is with a device are “are then run again at the end of the repair, and the diagnostics tell you whether the thing works or not.” In other words, the train is either fixed, which it appears to be, or it is not.</p><p>SPS, NEWAG, and the Lower Silesian Railway did not respond to 404 Media’s requests for comment.</p><p><strong><em>Update: This article has been updated to include more details about Europe&#39;s copyright laws.</em></strong></p>
<!--kg-card-begin: html-->

<!--kg-card-end: html-->

                    <div>
    <div>
      
      <p>Jason is a cofounder of 404 Media. He was previously the editor-in-chief of Motherboard. He loves the Freedom of Information Act and surfing.</p>
      
    </div>
      <p><img data-src="/content/images/2023/08/404-jason-01-copy.jpeg" alt="Jason Koebler" src="https://www.404media.co/content/images/2023/08/404-jason-01-copy.jpeg"/>  
      </p>
  </div>
          </div>
        </article>
      </div></div>
  </body>
</html>
