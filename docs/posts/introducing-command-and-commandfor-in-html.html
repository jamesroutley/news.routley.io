<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developer.chrome.com/blog/command-and-commandfor">Original</a>
    <h1>Introducing command And commandfor In HTML</h1>
    
    <div id="readability-page-1" class="page"><div>

  
    




<div translate="no">
  
    
    
      <div>
        
          <p><img alt="Keith Cirkel" src="https://web.dev/images/authors/keithcirkel.jpeg" decoding="async" height="64" loading="lazy" width="64"/></p>
      </div>
    
  
</div>

<p>
  Published: March 7, 2025
</p>


<p>Buttons are essential to making dynamic web applications. Buttons open menus,
toggle actions, and submit forms. They provide the foundation of interactivity
on the web. Making buttons simple and accessible can lead to some surprising
challenges. Developers building micro-frontends or component systems can
encounter solutions that become more complex than necessary. While frameworks
help, the web can do more here.</p>

<p>Chrome 135 introduces new capabilities for providing declarative behaviour with
the new <code translate="no" dir="ltr">command</code> and <code translate="no" dir="ltr">commandfor</code> attributes, enhancing and replacing the
<code translate="no" dir="ltr">popovertargetaction</code> and <code translate="no" dir="ltr">popovertarget</code> attributes. These new attributes can
be added to buttons, letting the browser address some core issues around
simplicity and accessibility, and provide built-in common functionality.</p>

<h2 id="traditional_patterns" data-text="Traditional patterns" tabindex="-1">Traditional patterns</h2>

<p>Building button behaviours without a framework can pose some interesting
challenges as production code evolves. While HTML offers <code translate="no" dir="ltr">onclick</code> handlers to
buttons, these are often disallowed outside of demos or tutorials due to Content
Security Policy (CSP) rules. While these events are dispatched on button
elements, buttons are usually placed on a page to control <em>other</em> elements
requiring code to control two elements at once. You also need to ensure this
interaction is accessible to users of assistive technology. This often leads to
code looking a bit like this:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="HTML"><code translate="no" dir="ltr">&lt;div class=&#34;menu-wrapper&#34;&gt;
  &lt;button class=&#34;menu-opener&#34; aria-expanded=&#34;false&#34;&gt;
    Open Menu
  &lt;/button&gt;
  &lt;div popover class=&#34;menu-content&#34;&gt;
    &lt;!-- ... --&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;script type=&#34;module&#34;&gt;
document.addEventListener(&#39;click&#39;, e =&gt; {  
  const button = e.target;
  if (button.matches(&#39;.menu-opener&#39;)) {
    const menu = button
      .closest(&#39;.menu-wrapper&#39;)
      .querySelector(&#39;.menu-content&#39;);
    if (menu) {
      button.setAttribute(&#39;aria-expanded&#39;, &#39;true&#39;);
      menu.showPopover();
      menu.addEventListener(&#39;toggle&#39;, e =&gt; {
        // reset back to aria-expanded=false on close
        if (e.newState == &#39;closed&#39;) {
          button.setAttribute(&#39;aria-expanded&#39;, &#39;false&#39;);
        }
      }, {once: true})
    }
  }
});
&lt;/script&gt;
</code></pre></devsite-code>
<p>This approach can be a little brittle, and frameworks aim to improve ergonomics.
A common pattern with a framework like React might involve mapping the click to
a state change:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="JavaScript"><code translate="no" dir="ltr"><span>function</span><span> </span><span>MyMenu</span><span>({</span><span> </span><span>children</span><span> </span><span>})</span><span> </span><span>{</span>
<span>  </span><span>const</span><span> </span><span>[</span><span>isOpen</span><span>,</span><span> </span><span>setIsOpen</span><span>]</span><span> </span><span>=</span><span> </span><span>useState</span><span>(</span><span>false</span><span>);</span>
<span>  </span><span>const</span><span> </span><span>open</span><span> </span><span>=</span><span> </span><span>useCallback</span><span>(()</span><span> </span><span>=</span>&gt;<span> </span><span>setIsOpen</span><span>(</span><span>true</span><span>),</span><span> </span><span>[]);</span>
<span>  </span><span>const</span><span> </span><span>handleToggle</span><span> </span><span>=</span><span> </span><span>useCallback</span><span>((</span><span>e</span><span>)</span><span> </span><span>=</span>&gt;<span> </span><span>{</span>
<span>      </span><span>// popovers have light dismiss which influences our state</span>
<span>     </span><span>setIsOpen</span><span>(</span><span>e</span><span>.</span><span>newState</span><span> </span><span>===</span><span> </span><span>&#39;open&#39;</span><span>)</span>
<span>  </span><span>},</span><span> </span><span>[]);</span>
<span>  </span><span>const</span><span> </span><span>popoverRef</span><span> </span><span>=</span><span> </span><span>useRef</span><span>(</span><span>null</span><span>);</span>
<span>  </span><span>useEffect</span><span>(()</span><span> </span><span>=</span>&gt;<span> </span><span>{</span>
<span>    </span><span>if</span><span> </span><span>(</span><span>popoverRef</span><span>.</span><span>current</span><span>)</span><span> </span><span>{</span>
<span>      </span><span>if</span><span> </span><span>(</span><span>isOpen</span><span>)</span><span> </span><span>{</span>
<span>        </span><span>popoverRef</span><span>.</span><span>current</span><span>.</span><span>showPopover</span><span>();</span>
<span>      </span><span>}</span><span> </span><span>else</span><span> </span><span>{</span>
<span>        </span><span>popoverRef</span><span>.</span><span>current</span><span>.</span><span>hidePopover</span><span>();</span>
<span>      </span><span>}</span>
<span>    </span><span>}</span>
<span>  </span><span>},</span><span> </span><span>[</span><span>popoverRef</span><span>,</span><span> </span><span>isOpen</span><span>]);</span>
<span>  </span><span>return</span><span> </span><span>(</span>
<span>    </span>&lt;&gt;
<span>      </span>&lt;<span>button</span><span> </span><span>onClick</span><span>=</span><span>{</span><span>open</span><span>}</span><span> </span><span>aria</span><span>-</span><span>expanded</span><span>=</span><span>{</span><span>isOpen</span><span>}</span>&gt;
<span>        </span><span>Open</span><span> </span><span>Menu</span>
<span>      </span>&lt;<span>/</span><span>button</span>&gt;
<span>      </span>&lt;<span>div</span><span> </span><span>popover</span><span> </span><span>onToggle</span><span>=</span><span>{</span><span>handleToggle</span><span>}</span><span> </span><span>ref</span><span>=</span><span>{</span><span>popoverRef</span><span>}</span>&gt;
<span>        </span><span>{</span><span>children</span><span>}</span>
<span>      </span>&lt;<span>/</span><span>div</span>&gt;
<span>    </span>&lt;<span>/</span>&gt;
<span>  </span><span>);</span>
<span>}</span>
</code></pre></devsite-code>
<p>Many other frameworks also aim to provide similar ergonomics, for example this
might be written in AlpineJS as:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="HTML"><code translate="no" dir="ltr">&lt;div x-data=&#34;{open: false}&#34;&gt;
  &lt;button @click=&#34;open = !open; $refs.popover.showPopover()&#34; :aria-expanded=&#34;open&#34;&gt;
    Open Menu
  &lt;/button&gt;
  &lt;div popover x-ref=&#34;popover&#34; @toggle=&#34;open = $event.newState === &#39;open&#39;&#34;&gt;
    &lt;!-- ... --&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre></devsite-code>
<p>While writing this in Svelte might look something like:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="JavaScript"><code translate="no" dir="ltr">&lt;<span>script</span>&gt;
<span>  </span><span>let</span><span> </span><span>popover</span><span>;</span>
<span>  </span><span>let</span><span> </span><span>open</span><span> </span><span>=</span><span> </span><span>false</span><span>;</span>
<span>  </span><span>function</span><span> </span><span>togglePopover</span><span>()</span><span> </span><span>{</span>
<span>    </span><span>open</span><span> </span><span>?</span><span> </span><span>popover</span><span>.</span><span>hidePopover</span><span>()</span><span> </span><span>:</span><span> </span><span>popover</span><span>.</span><span>showPopover</span><span>();</span>
<span>    </span><span>open</span><span> </span><span>=</span><span> </span><span>!</span><span>open</span><span>;</span>
<span>  </span><span>}</span>
&lt;<span>/script</span>&gt;
&lt;<span>button</span><span> </span><span>on</span><span>:</span><span>click</span><span>=</span><span>{</span><span>togglePopover</span><span>}</span><span> </span><span>aria</span><span>-</span><span>expanded</span><span>=</span><span>{</span><span>open</span><span>}</span>&gt;
<span>  </span><span>Open</span><span> </span><span>Menu</span>
&lt;<span>/button</span>&gt;
&lt;<span>div</span><span> </span><span>bind</span><span>:</span><span>this</span><span>=</span><span>{</span><span>popover</span><span>}</span><span> </span><span>popover</span>&gt;
<span>  </span>&lt;<span>!--</span><span> </span><span>...</span><span> </span><span>--</span>&gt;
&lt;<span>/div</span>&gt;
</code></pre></devsite-code>
<p>Some design systems or libraries might go a step further, by providing wrappers
around button elements that encapsulate the state changes. This abstracts state
changes behind a trigger component, trading a little flexibility for improved
ergonomics:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="JavaScript"><code translate="no" dir="ltr"><span>import</span><span> </span><span>{</span><span>MenuTrigger</span><span>,</span><span> </span><span>MenuContent</span><span>}</span><span> </span><span>from</span><span> </span><span>&#39;my-design-system&#39;</span><span>;</span>
<span>function</span><span> </span><span>MyMenu</span><span>({</span><span>children</span><span>})</span><span> </span><span>{</span>
<span>  </span><span>return</span><span> </span><span>(</span>
<span>    </span>&lt;<span>MenuTrigger</span>&gt;
<span>      </span>&lt;<span>button&gt;Open</span><span> </span><span>Menu</span>&lt;<span>/</span><span>button</span>&gt;
<span>    </span>&lt;<span>/</span><span>MenuTrigger</span>&gt;
<span>    </span>&lt;<span>MenuContent</span>&gt;<span>{</span><span>children</span><span>}</span>&lt;<span>/</span><span>MenuContent</span>&gt;
<span>  </span><span>);</span>
<span>}</span>
</code></pre></devsite-code>
<h2 id="the_command_and_commandfor_pattern" data-text="The command and commandfor pattern" tabindex="-1">The command and commandfor pattern</h2>

<p>With the <code translate="no" dir="ltr">command</code> and <code translate="no" dir="ltr">commandfor</code> attributes, buttons can now perform actions
on other elements declaratively, bringing the ergonomics of a framework without
sacrificing flexibility. The <code translate="no" dir="ltr">commandfor</code> button takes an ID—similar to the
<code translate="no" dir="ltr">for</code> attribute—while <code translate="no" dir="ltr">command</code> accepts built-in values, enabling a more
portable and intuitive approach.</p>

<h3 id="example_an_open_menu_button_with_command_and_commandfor" data-text="Example: An open menu button with command and commandfor" tabindex="-1">Example: An open menu button with command and commandfor</h3>

<p>The following HTML sets up declarative relationships between the button and the
menu which lets the browser handle the logic and accessibility for you. There&#39;s
no need to manage <code translate="no" dir="ltr">aria-expanded</code> or add any additional JavaScript.</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="HTML"><code translate="no" dir="ltr">&lt;button commandfor=&#34;my-menu&#34; command=&#34;show-popover&#34;&gt;
Open Menu
&lt;/button&gt;
&lt;div popover id=&#34;my-menu&#34;&gt;
  &lt;!-- ... --&gt;
&lt;/div&gt;
</code></pre></devsite-code>
<h3 id="comparing_command_and_commandfor_with_popovertargetaction_and_popovertarget" data-text="Comparing command and commandfor with popovertargetaction and popovertarget" tabindex="-1">Comparing <code translate="no" dir="ltr">command</code> and <code translate="no" dir="ltr">commandfor</code> with <code translate="no" dir="ltr">popovertargetaction</code> and <code translate="no" dir="ltr">popovertarget</code></h3>

<p>If you&#39;ve used <code translate="no" dir="ltr">popover</code> before, you might be familiar with the <code translate="no" dir="ltr">popovertarget</code>
and <code translate="no" dir="ltr">popovertargetaction</code> attributes. These work similarly to <code translate="no" dir="ltr">commandfor</code> and
<code translate="no" dir="ltr">command</code> respectively—except they&#39;re specific to popovers. The <code translate="no" dir="ltr">command</code> and
<code translate="no" dir="ltr">commandfor</code> attributes completely replace these older attributes. The new
attributes support everything the older attributes did, as well as adding new
capabilities.</p>

<h2 id="built-in_commands" data-text="Built-in commands" tabindex="-1">Built-in commands</h2>

<p>The <code translate="no" dir="ltr">command</code> attribute has a set of built-in behaviours which map to various
APIs for interactive elements:</p>

<ul>
<li><code translate="no" dir="ltr">show-popover</code>: Maps to <code translate="no" dir="ltr">el.showPopover()</code>.</li>
<li><code translate="no" dir="ltr">hide-popover</code>: Maps to <code translate="no" dir="ltr">el.hidePopover()</code>.</li>
<li><code translate="no" dir="ltr">toggle-popover</code>: Maps to <code translate="no" dir="ltr">el.togglePopover()</code>.</li>
<li><code translate="no" dir="ltr">show-modal</code>: Maps to <code translate="no" dir="ltr">dialogEl.showModal()</code>.</li>
<li><code translate="no" dir="ltr">close</code>: Maps to <code translate="no" dir="ltr">dialogEl.close()</code>.</li>
</ul>

<p>These commands map to their JavaScript counterparts, while also streamlining
accessibility (such as providing the <code translate="no" dir="ltr">aria-details</code> and <code translate="no" dir="ltr">aria-expanded</code>
equivalent relations), focus management, and more.</p>

<h3 id="example_a_confirmation_dialog_with_command_and_commandfor" data-text="Example: A confirmation dialog with command and commandfor" tabindex="-1">Example: A confirmation dialog with <code translate="no" dir="ltr">command</code> and <code translate="no" dir="ltr">commandfor</code></h3>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="HTML"><code translate="no" dir="ltr">&lt;button commandfor=&#34;confirm-dialog&#34; command=&#34;show-modal&#34;&gt;
  Delete Record
&lt;/button&gt;
&lt;dialog id=&#34;confirm-dialog&#34;&gt;
  &lt;header&gt;
    &lt;h1&gt;Delete Record?&lt;/h1&gt;
    &lt;button commandfor=&#34;confirm-dialog&#34; command=&#34;close&#34; aria-label=&#34;Close&#34; value=&#34;close&#34;&gt;
      &lt;img role=&#34;none&#34; src=&#34;/close-icon.svg&#34;&gt;
    &lt;/button&gt;
  &lt;/header&gt;
  &lt;p&gt;Are you sure? This action cannot be undone&lt;/p&gt;
  &lt;footer&gt;
    &lt;button commandfor=&#34;confirm-dialog&#34; command=&#34;close&#34; value=&#34;cancel&#34;&gt;
      Cancel
    &lt;/button&gt;
    &lt;button commandfor=&#34;confirm-dialog&#34; command=&#34;close&#34; value=&#34;delete&#34;&gt;
      Delete
    &lt;/button&gt;
  &lt;/footer&gt;
&lt;/dialog&gt;
</code></pre></devsite-code>
<p>Clicking the <strong>Delete Record</strong> button will open the dialog as a modal, while
clicking the <strong>Close</strong>, <strong>Cancel</strong>, or <strong>Delete</strong> buttons will close the dialog while
also dispatching a <code translate="no" dir="ltr">&#34;close&#34;</code> event on the dialog, which has a <code translate="no" dir="ltr">returnValue</code>
property matching the button&#39;s value.
This reduces the need for JavaScript beyond a single event
listener on the dialog to determine what to do next:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="JavaScript"><code translate="no" dir="ltr"><span>dialog</span><span>.</span><span>addEventListener</span><span>(</span><span>&#34;close&#34;</span><span>,</span><span> </span><span>(</span><span>event</span><span>)</span><span> </span><span>=</span>&gt;<span> </span><span>{</span>
<span>  </span><span>if</span><span> </span><span>(</span><span>event</span><span>.</span><span>target</span><span>.</span><span>returnValue</span><span> </span><span>==</span><span> </span><span>&#34;cancel&#34;</span><span>)</span><span> </span><span>{</span>
<span>    </span><span>console</span><span>.</span><span>log</span><span>(</span><span>&#34;cancel was clicked&#34;</span><span>);</span>
<span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>event</span><span>.</span><span>target</span><span>.</span><span>returnValue</span><span> </span><span>==</span><span> </span><span>&#34;close&#34;</span><span>)</span><span> </span><span>{</span>
<span>    </span><span>console</span><span>.</span><span>log</span><span>(</span><span>&#34;close was clicked&#34;</span><span>);</span>
<span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>event</span><span>.</span><span>target</span><span>.</span><span>returnValue</span><span> </span><span>==</span><span> </span><span>&#34;delete&#34;</span><span>)</span><span> </span><span>{</span>
<span>    </span><span>console</span><span>.</span><span>log</span><span>(</span><span>&#34;delete was clicked&#34;</span><span>);</span>
<span>  </span><span>}</span>
<span>});</span>
</code></pre></devsite-code>
<h2 id="custom_commands" data-text="Custom commands" tabindex="-1">Custom commands</h2>

<p>In addition to the built-in commands, you can define custom commands using a
<code translate="no" dir="ltr">--</code> prefix. Custom commands will dispatch a <code translate="no" dir="ltr">&#34;command&#34;</code> event on the target
element (just like the built-in commands), but otherwise will never perform any
additional logic like the built-in values do. This gives flexibility for
building components that can react to buttons in various ways without having to
provide wrapper components, traverse the DOM for the target element, or mapping
button clicks to state changes. This lets you provide an API <em>within</em> HTML for
your components:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="HTML"><code translate="no" dir="ltr">&lt;button commandfor=&#34;the-image&#34; command=&#34;--rotate-landscape&#34;&gt;
 Landscape
&lt;/button&gt;
&lt;button commandfor=&#34;the-image&#34; command=&#34;--rotate-portrait&#34;&gt;
 Portrait
&lt;/button&gt;

&lt;img id=&#34;the-image&#34; src=&#34;photo.jpg&#34;&gt;

&lt;script type=&#34;module&#34;&gt;
  const image = document.getElementById(&#34;the-image&#34;);
  image.addEventListener(&#34;command&#34;, (event) =&gt; {
   if ( event.command == &#34;--rotate-landscape&#34; ) {
    image.style.rotate = &#34;-90deg&#34;
   } else if ( event.command == &#34;--rotate-portrait&#34; ) {
    image.style.rotate = &#34;0deg&#34;
   }
  });
&lt;/script&gt;
</code></pre></devsite-code>
<h2 id="commands_in_the_shadowdom" data-text="Commands in the ShadowDOM" tabindex="-1">Commands in the ShadowDOM</h2>

<p>Given the <code translate="no" dir="ltr">commandfor</code> attribute takes an ID, there are restrictions around
crossing the shadow DOM. In these cases you can use the JavaScript API to set
the <code translate="no" dir="ltr">.commandForElement</code> property which can set any element, across shadow
roots:</p>
<devsite-code><pre translate="no" dir="ltr" is-upgraded="" syntax="HTML"><code translate="no" dir="ltr">&lt;my-element&gt;
  &lt;template shadowrootmode=open&gt;
    &lt;button command=&#34;show-popover&#34;&gt;Show popover&lt;/button&gt;
    &lt;slot&gt;&lt;/slot&gt;
  &lt;/template&gt;
  &lt;div popover&gt;&lt;!-- ... --&gt;&lt;/div&gt;
&lt;/my-element&gt;
&lt;script&gt;
customElements.define(&#34;my-element&#34;, class extends HTMLElement {
  connectedCallback() {
    const popover = this.querySelector(&#39;[popover]&#39;);
    // The commandForElement can set cross-shadow root elements.
    this.shadowRoot.querySelector(&#39;button&#39;).commandForElement = popover;
  }
});
&lt;/script&gt;
</code></pre></devsite-code>
<p>Future proposals may provide a declarative way to share references across shadow
boundaries, such as the
<a href="https://github.com/WICG/webcomponents/blob/gh-pages/proposals/reference-target-explainer.md">Reference Target Proposal</a>.</p>

<h2 id="whats_next" data-text="What&#39;s next?" tabindex="-1">What&#39;s next?</h2>

<p>We&#39;ll be continuing to explore possibilities for new built-in commands, to cover
common functionality that websites use. Proposed ideas are covered in the
<a href="https://open-ui.org/components/future-invokers.explainer/">Open UI Proposal</a>.
Some of the ideas already explored:</p>

<ul>
<li>Opening and closing <code translate="no" dir="ltr">&lt;details&gt;</code> elements.</li>
<li>A <code translate="no" dir="ltr">&#34;show-picker&#34;</code> command for <code translate="no" dir="ltr">&lt;input&gt;</code> and <code translate="no" dir="ltr">&lt;select&gt;</code> elements, mapping to
<code translate="no" dir="ltr">showPicker()</code>.</li>
<li>Playback commands for <code translate="no" dir="ltr">&lt;video&gt;</code> and <code translate="no" dir="ltr">&lt;audio&gt;</code> elements.</li>
<li>Copying text content from elements.</li>
</ul>

<p>We welcome community input—if you have suggestions don&#39;t hesitate to file an
issue on the
<a href="https://github.com/openui/open-ui/issues/new">Open UI Issue Tracker</a>.</p>

<h2 id="learn_more" data-text="Learn more" tabindex="-1">Learn more</h2>

<p>Find more information about <code translate="no" dir="ltr">command</code> and <code translate="no" dir="ltr">commandfor</code> in
<a href="https://html.spec.whatwg.org/multipage/form-elements.html#attr-button-command">the specification</a>
and on
<a href="https://developer.mozilla.org/docs/Web/API/Invoker_Commands_API">MDN</a>.</p>

  

  
</div></div>
  </body>
</html>
