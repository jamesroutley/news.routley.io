<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jasoneckert.github.io/myblog/ultimate-linux-arm64-workstation/">Original</a>
    <h1>ARM64 Linux Workstation</h1>
    
    <div id="readability-page-1" class="page"><div>
    
    <h2 id="it-all-started-this-month-last-year">It all started this month last year</h2>
<p>In March 2022, the alpha release for Asahi was made available and I immediately installed it on a Mac Mini with an 8-core Apple Silicon (ARM64) M1 processor. Asahi is a Linux distribution that can run natively on Apple Silicon-based Macs due to some slick reverse engineering provided by members of the open source community. Moreover, running Asahi is perfectly legal because Apple formally allows booting non-macOS operating systems on their Apple Silicon platform.</p>
<p>And while Asahi didn’t support all of the Mac Mini hardware components at that time, the essential hardware drivers were available, and I was surprised by how fast the system was. After learning I could install all the software I needed, it quickly became my daily driver as I detailed in <a href="https://jasoneckert.github.io/myblog/asahi-linux/" title="my July blog post">my July blog post</a>. By December, drivers were available for all remaining hardware (Bluetooth, audio, GPU), and all of the open source packages I desired were updated to support the 16K page size needed for Apple Silicon.</p>
<p>It was at that point that I thought to myself, “What if I could run Asahi Linux natively on Apple’s fastest Apple Silicon Mac? That’d be the ultimate ARM64 Linux workstation. And I definitely want to run the ultimate ARM64 Linux workstation.”</p>
<h2 id="so-i-took-things-to-the-next-level">So I took things to the next level</h2>
<p>This January, I installed Asahi Linux on Apple’s most powerful ARM64 system: the Mac Studio with a 20-core M1 Ultra processor and 128GB of RAM. It’s paired with a stunning Dell 34&#34; widescreen curved monitor via HDMI.</p>
<p>At the same time, I decided it was time to migrate from the powerful i3 window manager (which must run on the legacy X window system) to the sway compositor that runs on the new Wayland window system. This was much easier than I anticipated - sway performs better and uses a more streamlined configuration compared to i3.</p>
<p>Below is a high-res screenshot of my sway desktop on the Mac Studio (right-click the image and choose to open it in a new browser tab if you want to zoom in on it easily). You can find my custom sway dotfiles configuration <a href="https://github.com/jasoneckert/sway-dotfiles" title="in this GitHub repo">in this GitHub repo</a>.</p>
<p><img src="https://jasoneckert.github.io/myblog/ultimate-linux-arm64-workstation/sway.png#center" alt="Asahi sway desktop" title="Asahi sway desktop"/></p>
<h2 id="is-there-anything-that-doesnt-work">Is there anything that doesn’t work?</h2>
<p>To quote Hamlet, Act 3, Scene 3, Line 87: “No.”</p>
<p>Everything works… and works perfectly. All the hardware (Bluetooth, audio, HDMI, USB, 10G Ethernet, WiFi, and GPU) performs flawlessly with the drivers created by the Asahi team this past year, and there isn’t a single piece of software I want or need that doesn’t run beautifully in Asahi on this system.</p>
<p>Most software packages I’ve installed are from the Arch User Repository (since Asahi is based on Arch), but some of them are installed as Flatpak sandboxes (e.g., Visual Studio Code). For more complicated software systems, I often obtain ready-made container images and run them as containers (e.g., my NextCloud instance). You’ll also note from the <code>htop</code> output in my screenshot that I’m running a K3s cluster for testing the microservices I develop.</p>
<p>Since most of my workloads are containerized, I have no need to run other virtual machines of Linux. However, I do have to support several web apps that run within BSD jails. For this, I installed a dedicated QEMU virtual machine of FreeBSD UNIX that uses 8 cores and 64GB RAM. Below is a picture of the virtual machine console running within a terminal in my sway desktop. You can find my QEMU script <a href="https://github.com/jasoneckert/AsahiVMs" title="in this GitHub repo">in this GitHub repo</a>.</p>
<p><img src="https://jasoneckert.github.io/myblog/ultimate-linux-arm64-workstation/freebsd.png#center" alt="FreeBSD VM" title="FreeBSD VM"/></p>
<h2 id="this-is-by-far-the-fastest-linux-desktop-ive-ever-used">This is by far the fastest Linux desktop I’ve ever used.</h2>
<p>Everything - and I mean everything - is unbelievably fast. Things run instantaneously, and app splash screens don’t seem to exist.</p>
<p>In some cases, it is too fast. When I installed K3s, all of the containers in the kube-system namespace kept entering the dreaded CrashLoopBackOff state (something I’ve never seen before outside a production container). After some investigation, I found out that the Mac Studio was just too fast for the Kubernetes resource timing, and I had to add resource limits to each pod to remedy the situation.</p>
<p>One of the main reasons I like to develop on Linux/ARM64 is because it matches my extracurricular development. The startup I’m currently working with uses a compute heavy microservice-based app that typically runs in an AWS c6g.12xlarge Graviton instance with 48 ARM64 cores. The app is so heavy that we’ve built in our own load simulation and performance monitoring microservices into the app itself (our service mesh also helps with this).</p>
<p>So, I staged the app on my Mac Studio running Asahi and ran the load simulation to see how it fared with our staging environment on AWS. The Mac Studio blew the Graviton instance out of the water. Latency at the same load was roughly 20% lower on average and compute at our peak was exactly 36% faster consistently. I/O was trickier to monitor and interpret, but in my opinion, it wasn’t significantly different overall.</p>
<p>It really is the ultimate ARM64 Linux workstation. And I love using it.</p>

  </div></div>
  </body>
</html>
