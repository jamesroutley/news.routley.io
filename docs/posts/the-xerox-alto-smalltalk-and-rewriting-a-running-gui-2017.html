<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.righto.com/2017/10/the-xerox-alto-smalltalk-and-rewriting.html">Original</a>
    <h1>The Xerox Alto, Smalltalk, and rewriting a running GUI (2017)</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-2145038559598285372" itemprop="description articleBody">


<p>
Be sure to read the comment from Alan Kay at the bottom of the article!
</p>

<p>We succeeded in running the Smalltalk-76 language on our vintage Xerox Alto;
this blog post gives a quick overview of the Smalltalk environment.
One unusual feature of Smalltalk is you can view and modify the system&#39;s code while the system is running. I demonstrate this by modifying the scrollbar code on a running system.</p>
<p>Smalltalk is a highly-influential programming language and environment that introduced the term &#34;object-oriented programming&#34; and was the ancestor of modern object-oriented languages.<span id="fnref:developers"><a href="#fn:developers" rel="footnote">1</a></span>
The Alto&#39;s Smalltalk environment is also notable for its creation of the graphical user interface with the desktop metaphor, icons, scrollbars, overlapping windows, popup menus and so forth. When Steve Jobs famously visited Xerox PARC, the Smalltalk GUI inspired him on how the Lisa and Macintosh should work.<span id="fnref:jobs"><a href="#fn:jobs" rel="footnote">2</a></span></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjiaiieOZ5hcbD6b5hFxFalQq7wzUlt3L2mUFVacMH7-rW38iX1QMyH5Y0pPyX7g6Etjpe6kPTdGqP2rL30OzSZiq3IHrlDA6gXxTJTlugso0Tz0vjhVhFKZ7KezPEvYuup-8PjCraXVv2E/w9999/alto-running-smalltalk.jpg"><img alt="Our Xerox Alto running Smalltalk-76." height="396" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjiaiieOZ5hcbD6b5hFxFalQq7wzUlt3L2mUFVacMH7-rW38iX1QMyH5Y0pPyX7g6Etjpe6kPTdGqP2rL30OzSZiq3IHrlDA6gXxTJTlugso0Tz0vjhVhFKZ7KezPEvYuup-8PjCraXVv2E/w300/alto-running-smalltalk.jpg" title="Our Xerox Alto running Smalltalk-76." width="300"/></a></p><p>Our Xerox Alto running Smalltalk-76.</p>
<p>The Alto was a revolutionary computer designed at Xerox PARC in 1973
to investigate personal computing. It introduced the GUI, high-resolution bitmapped displays, WYSIWYG editors, Ethernet, the optical mouse and laser printers to the world, among other things.
I&#39;ve been restoring an Alto from YCombinator, along with 
Marc Verdiell,
<a href="https://rescue1130.blogspot.com/">Carl Claunch</a>
My full set of Alto posts is <a href="https://www.righto.com/search/label/alto">here</a> and Marc&#39;s extensive videos of the restoration are <a href="https://www.youtube.com/user/mverdiell/videos">here</a>.</p>

<p>Smalltalk introduced the desktop metaphor used in modern computing.<span id="fnref:moad"><a href="#fn:moad" rel="footnote">3</a></span>
It included overlapping windows<span id="fnref:perf"><a href="#fn:perf" rel="footnote">4</a></span>, multiple desktops and pop-up menus.
These windows could be moved and resized with the mouse.
(The biggest missing desktop feature was desktop icons, which Xerox later introduced in the Star computer.)
To understand how revolutionary this was, consider that
the Apple 1 microcomputer came out in 1976,
displaying 24 lines of 40 uppercase characters. 
The mainframe and minicomputer worlds were focused around punched cards, line printers, Teletypes, and dumb CRT terminals.
Alan Kay changed all this with his vision of a computer desktop with windows that could be directly manipulated, windows containing fancy typography or images.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRl2yzWbUSCV9oBXcSczsqhHOAOg2EHludOFMaJK-PJ6LnbjtmjEMQJCaR7tclymMSQ4JaPqLuxXcYtsGYJ7HDgQX-x34QqwnHUzORJ4yKn5t1t4c3jOvphsphEkc_DgBNY8yViZx4xqK1/w9999/smalltalk-desktop.jpg"><img alt="Smalltalk introduced the desktop environment, with overlapping windows for multiple applications." height="664" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRl2yzWbUSCV9oBXcSczsqhHOAOg2EHludOFMaJK-PJ6LnbjtmjEMQJCaR7tclymMSQ4JaPqLuxXcYtsGYJ7HDgQX-x34QqwnHUzORJ4yKn5t1t4c3jOvphsphEkc_DgBNY8yViZx4xqK1/w606/smalltalk-desktop.jpg" title="Smalltalk introduced the desktop environment, with overlapping windows for multiple applications." width="606"/></a></p><p>Smalltalk introduced the desktop environment, with overlapping windows for multiple applications.</p>
<p>The screenshot above shows the Smalltalk-76 desktop. At the bottom, a drawing program displays the Smalltalk elf image.<span id="fnref:elf"><a href="#fn:elf" rel="footnote">5</a></span>
Icons allow selection of drawing mode, line style, brush color (grayscale), and so forth.
The Smalltalk class browser is in the middle.
In the upper right is a file viewer. Finally, in the upper left is a window for entering Smalltalk statements, essentially a shell or <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>.</p>

<p>One of the most interesting things about the Smalltalk environment is that all the Smalltalk code can be examined and modified, even while the system is running.
The class browser below lets you select (using the mouse) a functional area such as &#34;Basic Data Structures&#34; or &#34;Files&#34;. You can then select a class in that area,
functionality within the class, and then a particular method. The browser then displays the code running on the system.
All the Smalltalk code can be examined in this way, making the system&#39;s implementation very transparent.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDOjADktxBgn-v3NiQr3DhMrew1n3u4iJGX5Wn-1Y3HTyjfNQ5Gvwdoh-WXMgP9xpRZrB0HdT8BGhUVmZJnhsLa3ttbFv9GroPHnBAjGce1Y6eZkRibUsVShCtkMsETWzp0nC7Z5dsvxSv/w9999/scrollbar1.jpg"><img alt="Using the Smalltalk class browser, we can view the code to show a ScrollBar." height="279" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDOjADktxBgn-v3NiQr3DhMrew1n3u4iJGX5Wn-1Y3HTyjfNQ5Gvwdoh-WXMgP9xpRZrB0HdT8BGhUVmZJnhsLa3ttbFv9GroPHnBAjGce1Y6eZkRibUsVShCtkMsETWzp0nC7Z5dsvxSv/w600/scrollbar1.jpg" title="Using the Smalltalk class browser, we can view the code to show a ScrollBar." width="600"/></a></p><p>Using the Smalltalk class browser, we can view the code to show a ScrollBar.</p>
<p>In the screenshot above, I use the class browser to access &#34;Panes and Menus&#34;, then &#34;ScrollBar&#34;, then &#34;Image&#34; and finally &#34;show&#34;. This displays the code for the scrollbar&#39;s &#34;show&#34; method, which draws the scrollbar.
This code draws a black rectangle, and then insets a white rectangle, resulting in a black-bordered rectangle for the scrollbar.
(Note the unusual dotted-circle character ☉ that Smalltalk-76 uses to create a <code>Point</code> from two <code>Number</code>s.)</p>
<p>The unusual feature of the class browser is that you can use it to change the system&#39;s code, while the system is running, and everything will pick up the new code.
For example, I can change how scrollbars are drawn.
In the screenshot below, I changed <code>clear: white</code> to <code>clear: black</code>.
Pressing the middle mouse button pops up a menu, and I can select &#34;compile&#34;.
This causes the scrollbar code to be recompiled—while the system is still running.
(Note the modern appearance of the contextual pop-up menu.)</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhzPMVBl4uZvz2nBSUfaH96ddsPOyZBLEo_AcAIY_NhsQrKAXXDIE1JEQxytC0xU4-EZzFongjdP7nDh4-vrZ3eRb74Neshn_uXLn07QyLcH0reZUC1npzBldS3M9t6uvM-p0qBVvQJjD2p/w9999/scrollbar2.jpg"><img alt="After changing the code, I selected &#34;compile&#34; from the pop-up menu." height="179" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhzPMVBl4uZvz2nBSUfaH96ddsPOyZBLEo_AcAIY_NhsQrKAXXDIE1JEQxytC0xU4-EZzFongjdP7nDh4-vrZ3eRb74Neshn_uXLn07QyLcH0reZUC1npzBldS3M9t6uvM-p0qBVvQJjD2p/w600/scrollbar2.jpg" title="After changing the code, I selected &#34;compile&#34; from the pop-up menu." width="600"/></a></p><p>After changing the code, I selected &#34;compile&#34; from the pop-up menu.</p>
<p>The result of this change is that all scrollbars (for existing or new windows) will now have a black background, as you can see below.
The key point is this change was made while the system was running; there is no need to restart anything.
Even existing windows get the new scrollbars. </p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaAiKZjCG2swjZQWzPTA5N-9jkwwV56UlMyq3f54CzGogHXcMDs9d9xU3dDGfW5mmo8obCTm4rXV3f8O0esUirOisf3nQDVPS7PMEGBtB2EIrE4J-ZzCHfBdsxZ7m_qJLneAtTb_hZUQKT/w9999/scrollbar3.jpg"><img alt="Scrollbars now appear with a black background, even for existing windows." height="322" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjaAiKZjCG2swjZQWzPTA5N-9jkwwV56UlMyq3f54CzGogHXcMDs9d9xU3dDGfW5mmo8obCTm4rXV3f8O0esUirOisf3nQDVPS7PMEGBtB2EIrE4J-ZzCHfBdsxZ7m_qJLneAtTb_hZUQKT/w600/scrollbar3.jpg" title="Scrollbars now appear with a black background, even for existing windows." width="600"/></a></p><p>Scrollbars now appear with a black background, even for existing windows.</p>
<p>Although this scrollbar change was rather trivial, major changes can be made to the running Smalltalk system.
One well-known story of changing Smalltalk&#39;s behavior on the fly is from Steve Jobs&#39; visit to Xerox PARC. Steve Jobs didn&#39;t like the way the window scrolled line-by-line, so Smalltalk implementer <a href="https://en.wikipedia.org/wiki/Dan_Ingalls">Dan Ingalls</a> rewrote the scrolling code in a minute and implemented smooth scrolling while the system was running, much to Jobs&#39; surprise.<span id="fnref:scrolling"><a href="#fn:scrolling" rel="footnote">6</a></span></p>

<p>In Smalltalk, even most of the math functions are written in Smalltalk.
For instance, suppose we wonder how square roots are computed.
We can look at the square root function in the class browser by going to &#34;Numbers&#34;, &#34;Float&#34;, &#34;Math functions&#34;, &#34;sqrt&#34;.
This brings up the seven lines of code below for the square root function.
We can see that the code uses five iterations of <a href="https://en.wikipedia.org/wiki/Newton%27s_method#Square_root_of_a_number">Newton&#39;s method</a> to approximate the square root.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhbl8qMpL8AYmoAaNQN5OUfbj3XvMxqSDrDIy0oUAoZDMqeUo3YjSI_Aihs0P9hwLPoGTwa9UdS868OPepsWNF4VYsHAFJKtVTYgKJ8wKk5aU2BhLOpLm-0jYJL6lqdcb5Ao1IC_n-Uj75Q/w9999/sqrt.jpg"><img alt="Looking at the square root code in the Smalltalk-76 class browser." height="91" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhbl8qMpL8AYmoAaNQN5OUfbj3XvMxqSDrDIy0oUAoZDMqeUo3YjSI_Aihs0P9hwLPoGTwa9UdS868OPepsWNF4VYsHAFJKtVTYgKJ8wKk5aU2BhLOpLm-0jYJL6lqdcb5Ao1IC_n-Uj75Q/w508/sqrt.jpg" title="Looking at the square root code in the Smalltalk-76 class browser." width="508"/></a></p><p>Looking at the square root code in the Smalltalk-76 class browser.</p>
<p>If you&#39;re used to Java or C++, this object-oriented code may look strange, especially since Smalltalk uses some strange characters.
The first line of code above defines local variables <code>guess</code> and <code>i</code>.
In the next line, the right arrow ⇒ implements an &#34;if&#34; statement.
If the number receiving the square root message (<code>self</code>) is 0, then 0 is returned (via the up arrow ⇑ return symbol) and if it is negative an exception is raised.
The square brackets define blocks, similar to curly braces in C.
The <code>instfield</code> line is a bit tricky; it pulls the exponent out of the floating point number and divides it by 2, yielding a reasonable starting point for the square root.
Finally, the <code>for</code> loop applies Newton&#39;s method 5 times and returns the result. Note the unusual double colon symbol ⦂; this delays evaluation of the argument, so it can be evaluated multiple times in the loop.<span id="fnref:moreinfo"><a href="#fn:moreinfo" rel="footnote">7</a></span></p>
<p>You might think that executing Smalltalk code for math operations would be very slow, and that is the case.
The good news is that basic operations such as addition are implemented with short cuts, rather than full message passing. But other operations are slow; the team described performance as between &#34;majestic&#34; and &#34;glacial&#34;.
Xerox PARC ended up creating the Dorado, a much faster minicomputer than the Alto, to improve performance.</p>

<p>Although Smalltalk wasn&#39;t the first object-oriented programming language, Smalltalk introduced the term <i>object-oriented programming</i> and was very influential in later object-oriented programming languages.
Most modern object-oriented languages, from Objective-C and Go to Java and Python, show the influence of Smalltalk.
Smalltalk was also responsible for design patterns. The famous &#34;Gang of Four&#34; <a href="http://amzn.to/2xHGTzL">Design Patterns book</a> 
describes design patterns in Smalltalk and C++.<span id="fnref:java"><a href="#fn:java" rel="footnote">8</a></span></p>
<p>Smalltalk systems are still in use.
Smalltalk-76 (and the earlier 71 and 72 versions) were intended for research, but
Xerox released the Smalltalk-80 version; it was licensed by Xerox to HP, Apple, Tektronix and DEC for royalty-free distribution.
Smalltalk-80 in turn led to modern Smalltalk systems such as
<a href="http://pharo.org">Pharo</a>, <a href="http://smalltalk.gnu.org/">GNU Smalltalk</a> and <a href="http://squeak.org/">Squeak</a> (which led to the <a href="https://scratch.mit.edu/">Scratch</a> language for children).</p>
<p>If you want to try Alto Smalltalk out for yourself, you can use the <a href="https://github.com/livingcomputermuseum/ContrAlto">Contralto emulator</a>, built by the Living Computers Museum. I explain how to run it <a href="https://www.righto.com/2016/10/simulating-xerox-alto-with-contralto.html">here</a>.
(Most of the screenshots above are from Contralto rather than the live Alto, for clearer images.)
Be warned, however, that Smalltalk on the Alto (live or emulated) is painfully slow.</p>
<p>Follow me on Twitter: <a href="https://twitter.com/kenshirriff">@kenshirriff</a> to find out about my latest blog posts. I also have an <a href="https://www.righto.com/feeds/posts/default">RSS feed</a>.</p>
<h2>Notes and references</h2>


</div></div>
  </body>
</html>
