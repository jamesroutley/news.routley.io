<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/sysprog21/shecc">Original</a>
    <h1>Shecc: A self-hosting and educational C optimizing compiler</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/18013815/91671374-b2f0db00-eb58-11ea-8d55-858e9fb160c0.png"><img src="https://user-images.githubusercontent.com/18013815/91671374-b2f0db00-eb58-11ea-8d55-858e9fb160c0.png" alt="logo image" width="40%"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-introduction" aria-hidden="true" tabindex="-1" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Introduction</h2>
<p dir="auto"><code>shecc</code> is built from scratch, targeting both 32-bit Arm and RISC-V architectures,
as a self-compiling compiler for a subset of the C language.
Despite its simplistic nature, it is capable of performing basic optimization strategies as a standalone optimizing compiler.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-features" aria-hidden="true" tabindex="-1" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features</h3>
<ul dir="auto">
<li>Generate executable Linux ELF binaries for ARMv7-A and RV32IM.</li>
<li>Provide a minimal C standard library for basic I/O on GNU/Linux.</li>
<li>The cross-compiler is written in ANSI C, making it compatible with most platforms.</li>
<li>Include a self-contained C front-end with an integrated machine code generator; no external assembler or linker needed.</li>
<li>Utilize a two-pass compilation process: the first pass checks syntax and breaks down complex statements into basic operations,
while the second pass translates these operations into Arm/RISC-V machine code.</li>
<li>Develop a register allocation system that is compatible with RISC-style architectures.</li>
<li>Implement an architecture-independent, single static assignment (SSA)-based middle-end for enhanced optimizations.</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-compatibility" aria-hidden="true" tabindex="-1" href="#compatibility"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Compatibility</h2>
<p dir="auto"><code>shecc</code> is capable of compiling C source files written in the following
syntax:</p>
<ul dir="auto">
<li>data types: char, int, struct, and pointer</li>
<li>condition statements: if, while, for, switch, case, break, return, and
general expressions</li>
<li>compound assignments: <code>+=</code>, <code>-=</code>, <code>*=</code></li>
<li>global/local variable initializations for supported data types
<ul dir="auto">
<li>e.g. <code>int i = [expr]</code></li>
</ul>
</li>
<li>limited support for preprocessor directives: <code>#define</code>, <code>#ifdef</code>, <code>#elif</code>, <code>#endif</code>, <code>#undef</code>, and <code>#error</code></li>
<li>non-nested variadic macros with <code>__VA_ARGS__</code> identifier</li>
</ul>
<p dir="auto">The backend targets armv7hf with Linux ABI, verified on Raspberry Pi 3,
and also supports RISC-V 32-bit architecture, verified with QEMU.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-bootstrapping" aria-hidden="true" tabindex="-1" href="#bootstrapping"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Bootstrapping</h2>
<p dir="auto">The steps to validate <code>shecc</code> bootstrapping:</p>
<ol dir="auto">
<li><code>stage0</code>: <code>shecc</code> source code is initially compiled using an ordinary compiler
which generates a native executable. The generated compiler can be used as a
cross-compiler.</li>
<li><code>stage1</code>: The built binary reads its own source code as input and generates an
ARMv7-A/RV32IM  binary.</li>
<li><code>stage2</code>: The generated ARMv7-A/RV32IM binary is invoked (via QEMU or running on
Arm and RISC-V devices) with its own source code as input and generates another
ARMv7-A/RV32IM binary.</li>
<li><code>bootstrap</code>: Build the <code>stage1</code> and <code>stage2</code> compilers, and verify that they are
byte-wise identical. If so, <code>shecc</code> can compile its own source code and produce
new versions of that same program.</li>
</ol>
<h2 tabindex="-1" dir="auto"><a id="user-content-prerequisites" aria-hidden="true" tabindex="-1" href="#prerequisites"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Prerequisites</h2>
<p dir="auto">Code generator in <code>shecc</code> does not rely on external utilities. You only need
ordinary C compilers such as <code>gcc</code> and <code>clang</code>. However, <code>shecc</code> would bootstrap
itself, and Arm/RISC-V ISA emulation is required. Install QEMU for Arm/RISC-V user
emulation on GNU/Linux:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo apt-get install qemu-user"><pre>$ sudo apt-get install qemu-user</pre></div>
<p dir="auto">It is still possible to build <code>shecc</code> on macOS or Microsoft Windows. However,
the second stage bootstrapping would fail due to <code>qemu-arm</code> absence.</p>
<p dir="auto">To execute the snapshot test, install the packages below:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo apt-get install graphviz jq"><pre>$ sudo apt-get install graphviz jq</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-build-and-verify" aria-hidden="true" tabindex="-1" href="#build-and-verify"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Build and Verify</h2>
<p dir="auto">Configure which backend you want, <code>shecc</code> supports ARMv7-A and RV32IM backend:</p>
<div data-snippet-clipboard-copy-content="$ make config ARCH=arm
# Target machine code switch to Arm

$ make config ARCH=riscv
# Target machine code switch to RISC-V"><pre><code>$ make config ARCH=arm
# Target machine code switch to Arm

$ make config ARCH=riscv
# Target machine code switch to RISC-V
</code></pre></div>
<p dir="auto">Run <code>make</code> and you should see this:</p>
<div data-snippet-clipboard-copy-content="  CC+LD	out/inliner
  GEN	out/libc.inc
  CC	out/src/main.o
  LD	out/shecc
  SHECC	out/shecc-stage1.elf
  SHECC	out/shecc-stage2.elf"><pre><code>  CC+LD	out/inliner
  GEN	out/libc.inc
  CC	out/src/main.o
  LD	out/shecc
  SHECC	out/shecc-stage1.elf
  SHECC	out/shecc-stage2.elf
</code></pre></div>
<p dir="auto">File <code>out/shecc</code> is the first stage compiler. Its usage:</p>
<div data-snippet-clipboard-copy-content="shecc [-o output] [--no-libc] [--dump-ir] &lt;infile.c&gt;"><pre><code>shecc [-o output] [--no-libc] [--dump-ir] &lt;infile.c&gt;
</code></pre></div>
<p dir="auto">Compiler options:</p>
<ul dir="auto">
<li><code>-o</code> : output file name (default: out.elf)</li>
<li><code>--no-libc</code> : Exclude embedded C library (default: embedded)</li>
<li><code>--dump-ir</code> : Dump intermediate representation (IR)</li>
</ul>
<p dir="auto">Example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ out/shecc -o fib tests/fib.c
$ chmod +x fib
$ qemu-arm fib"><pre>$ out/shecc -o fib tests/fib.c
$ chmod +x fib
$ qemu-arm fib</pre></div>
<p dir="auto">Verify that the emitted IRs are identical to the snapshots by specifying <code>check-snapshots</code> target when invoking <code>make</code>:</p>

<p dir="auto"><code>shecc</code> comes with unit tests. To run the tests, give <code>check</code> as an argument:</p>

<p dir="auto">Reference output:</p>
<div data-snippet-clipboard-copy-content="...
int main(int argc, int argv) { exit(sizeof(char)); } =&gt; 1
int main(int argc, int argv) { int a; a = 0; switch (3) { case 0: return 2; case 3: a = 10; break; case 1: return 0; } exit(a); } =&gt; 10
int main(int argc, int argv) { int a; a = 0; switch (3) { case 0: return 2; default: a = 10; break; } exit(a); } =&gt; 10
OK"><pre><code>...
int main(int argc, int argv) { exit(sizeof(char)); } =&gt; 1
int main(int argc, int argv) { int a; a = 0; switch (3) { case 0: return 2; case 3: a = 10; break; case 1: return 0; } exit(a); } =&gt; 10
int main(int argc, int argv) { int a; a = 0; switch (3) { case 0: return 2; default: a = 10; break; } exit(a); } =&gt; 10
OK
</code></pre></div>
<p dir="auto">To clean up the generated compiler files, execute the command <code>make clean</code>.
For resetting architecture configurations, use the command <code>make distclean</code>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-intermediate-representation" aria-hidden="true" tabindex="-1" href="#intermediate-representation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Intermediate Representation</h2>
<p dir="auto">Once the option <code>--dump-ir</code> is passed to <code>shecc</code>, the intermediate representation (IR)
will be generated. Take the file <code>tests/fib.c</code> for example. It consists of a recursive
Fibonacci sequence function.</p>
<div dir="auto" data-snippet-clipboard-copy-content="int fib(int n)
{
    if (n == 0)
        return 0;
    else if (n == 1)
        return 1;
    return fib(n - 1) + fib(n - 2);
}"><pre><span>int</span> <span>fib</span>(<span>int</span> <span>n</span>)
{
    <span>if</span> (<span>n</span> <span>==</span> <span>0</span>)
        <span>return</span> <span>0</span>;
    <span>else</span> <span>if</span> (<span>n</span> <span>==</span> <span>1</span>)
        <span>return</span> <span>1</span>;
    <span>return</span> <span>fib</span>(<span>n</span> <span>-</span> <span>1</span>) <span>+</span> <span>fib</span>(<span>n</span> <span>-</span> <span>2</span>);
}</pre></div>
<p dir="auto">Execute the following to generate IR:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ out/shecc --dump-ir -o fib tests/fib.c"><pre>$ out/shecc --dump-ir -o fib tests/fib.c</pre></div>
<p dir="auto">Line-by-line explanation between C source and IR:</p>
<div dir="auto" data-snippet-clipboard-copy-content=" C Source                IR                                         Explanation
------------------+---------------------------------------+----------------------------------------------------------------------------------

int fib(int n)      def int @fib(int %n)                    Indicate a function definition
{                   {
  if (n == 0)         const %.t1001, $0                     Load constant 0 into a temporary variable &#34;.t1001&#34;
                      %.t1002 = eq %n, %.t1001              Test &#34;n&#34; equals &#34;.t1001&#34; or not, and write the result in temporary variable &#34;.t1002&#34;
                      br %.t1002, .label.1177, .label.1178  If &#34;.t1002&#34; equals zero, goto false label &#34;.label.1178&#34;, otherwise,
                                                            goto true label &#34;.label.1177&#34;
                    .label.1177
    return 0;         const %.t1003, $0                     Load constant 0 into a temporary variable &#34;.t1003&#34;
                      ret %.t1003                           Return &#34;.t1003&#34;
                      j .label.1184                         Jump to endif label &#34;.label.1184&#34;
                    .label.1178
  else if (n == 1)    const %.t1004, $1                     Load constant 1 into a temporary variable &#34;.t1004&#34;
                      %.t1005 = eq %n, %.t1004              Test &#34;n&#34; equals &#34;.t1004&#34; or not, and write the result in temporary variable &#34;.t1005&#34;
                      br %.t1005, .label.1183, .label.1184  If &#34;.t1005&#34; equals zero, goto false label &#34;.label.1184&#34;. Otherwise,
                                                            goto true label &#34;.label.1183&#34;
                    .label.1183
    return 1;         const %.t1006, $1                     Load constant 1 into a temporary variable &#34;.t1006&#34;
                      ret %.t1006                           Return &#34;.t1006&#34;
                    .label.1184
  return
    fib(n - 1)        const %.t1007, $1                     Load constant 1 into a temporary variable &#34;.t1007&#34;
                      %.t1008 = sub %n, %.t1007             Subtract &#34;.t1007&#34; from &#34;n&#34;, and store the result in temporary variable &#34;.t1008&#34;
                      push %.t1008                          Prepare parameter for function call
                      call @fib, 1                          Call function &#34;fib&#34; with one parameter
    +                 retval %.t1009                        Store return value in temporary variable &#34;.t1009&#34;
    fib(n - 2);       const %.t1010, $2                     Load constant 2 into a temporary variable &#34;.t1010&#34;
                      %.t1011 = sub %n, %.t1010             Subtract &#34;.t1010&#34; from &#34;n&#34;, and store the result in temporary variable &#34;.t1011&#34;
                      push %.t1011                          Prepare parameter for function call
                      call @fib, 1                          Call function &#34;fib&#34; with one parameter
                      retval %.t1012                        Store return value in temporary variable &#34;.t1012&#34;
                      %.t1013 = add %.t1009, %.t1012        Add &#34;.t1009&#34; and &#34;.t1012&#34;, and store the result in temporary variable &#34;.t1013&#34;
                      ret %.t1013                           Return &#34;.t1013&#34;
}                   }"><pre> <span>C</span> <span>Source</span>                <span>IR</span>                                         <span>Explanation</span>
<span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>+</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>-</span><span>+</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span>

<span>int</span> <span>fib</span>(<span>int</span> <span>n</span>)      <span>def</span> <span>int</span> @<span>fib</span>(<span>int</span> %<span>n</span>)                    <span>Indicate</span> <span>a</span> <span>function</span> <span>definition</span>
{                   {
  <span>if</span> (<span>n</span> <span>==</span> <span>0</span>)         <span>const</span> %.<span>t1001</span>, $<span>0</span>                     <span>Load</span> <span>constant</span> <span>0</span> <span>into</span> <span>a</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1001&#34;</span>
                      %.<span>t1002</span> <span>=</span> <span>eq</span> %<span>n</span>, %.<span>t1001</span>              <span>Test</span> <span>&#34;n&#34;</span> <span>equals</span> <span>&#34;.t1001&#34;</span> <span>or</span> <span>not</span>, <span>and</span> <span>write</span> <span>the</span> <span>result</span> <span>in</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1002&#34;</span>
                      <span>br</span> %.<span>t1002</span>, .<span>label</span>.<span>1177</span>, .<span>label</span>.<span>1178</span>  <span>If</span> <span>&#34;.t1002&#34;</span> <span>equals</span> <span>zero</span>, <span>goto</span> <span>false</span> <span>label</span> <span>&#34;.label.1178&#34;</span>, <span>otherwise</span>,
                                                            <span>goto</span> <span>true</span> <span>label</span> <span>&#34;.label.1177&#34;</span>
                    .<span>label</span>.<span>1177</span>
    <span>return</span> <span>0</span>;         <span>const</span> %.<span>t1003</span>, $<span>0</span>                     <span>Load</span> <span>constant</span> <span>0</span> <span>into</span> <span>a</span> <span>temporary</span> <span>variable</span> &#34;.<span>t1003</span>&#34;
                      <span>ret</span> %.<span>t1003</span>                           <span>Return</span> &#34;.<span>t1003</span>&#34;
                      <span>j</span> .<span>label</span><span>.1184</span>                         <span>Jump</span> <span>to</span> <span>endif</span> <span>label</span> <span>&#34;.label.1184&#34;</span>
                    .<span>label</span>.<span>1178</span>
  <span>else</span> <span>if</span> (<span>n</span> <span>==</span> <span>1</span>)    <span>const</span> %.<span>t1004</span>, $<span>1</span>                     <span>Load</span> <span>constant</span> <span>1</span> <span>into</span> <span>a</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1004&#34;</span>
                      %.<span>t1005</span> <span>=</span> <span>eq</span> %<span>n</span>, %.<span>t1004</span>              <span>Test</span> <span>&#34;n&#34;</span> <span>equals</span> <span>&#34;.t1004&#34;</span> <span>or</span> <span>not</span>, <span>and</span> <span>write</span> <span>the</span> <span>result</span> <span>in</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1005&#34;</span>
                      <span>br</span> %.<span>t1005</span>, .<span>label</span>.<span>1183</span>, .<span>label</span>.<span>1184</span>  <span>If</span> <span>&#34;.t1005&#34;</span> <span>equals</span> <span>zero</span>, <span>goto</span> <span>false</span> <span>label</span> <span>&#34;.label.1184&#34;</span>. <span>Otherwise</span>,
                                                            <span>goto</span> <span>true</span> <span>label</span> <span>&#34;.label.1183&#34;</span>
                    .<span>label</span>.<span>1183</span>
    <span>return</span> <span>1</span>;         <span>const</span> %.<span>t1006</span>, $<span>1</span>                     <span>Load</span> <span>constant</span> <span>1</span> <span>into</span> <span>a</span> <span>temporary</span> <span>variable</span> &#34;.<span>t1006</span>&#34;
                      <span>ret</span> %.<span>t1006</span>                           <span>Return</span> &#34;.<span>t1006</span>&#34;
                    .<span>label</span><span>.1184</span>
  <span>return</span>
    <span>fib</span>(<span>n</span> <span>-</span> <span>1</span>)        <span>const</span> %.<span>t1007</span>, $<span>1</span>                     <span>Load</span> <span>constant</span> <span>1</span> <span>into</span> <span>a</span> <span>temporary</span> <span>variable</span> &#34;.<span>t1007</span>&#34;
                      %.<span>t1008</span> <span>=</span> <span>sub</span> %<span>n</span>, %.<span>t1007</span>             <span>Subtract</span> &#34;.<span>t1007</span><span>&#34; from &#34;</span><span>n</span><span>&#34;, and store the result in temporary variable &#34;</span>.<span>t1008</span>&#34;
                      <span>push</span> %.<span>t1008</span>                          <span>Prepare</span> <span>parameter</span> <span>for</span> <span>function</span> <span>call</span>
                      <span>call</span> @<span>fib</span>, <span>1</span>                          <span>Call</span> <span>function</span> &#34;<span>fib</span><span>&#34; with one parameter</span>
    <span>+</span>                 <span>retval</span> %.<span>t1009</span>                        <span>Store</span> <span>return</span> <span>value</span> <span>in</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1009&#34;</span>
    <span>fib</span>(<span>n</span> <span>-</span> <span>2</span>);       <span>const</span> %.<span>t1010</span>, $<span>2</span>                     <span>Load</span> <span>constant</span> <span>2</span> <span>into</span> <span>a</span> <span>temporary</span> <span>variable</span> &#34;.<span>t1010</span>&#34;
                      %.<span>t1011</span> <span>=</span> <span>sub</span> %<span>n</span>, %.<span>t1010</span>             <span>Subtract</span> &#34;.<span>t1010</span><span>&#34; from &#34;</span><span>n</span><span>&#34;, and store the result in temporary variable &#34;</span>.<span>t1011</span>&#34;
                      <span>push</span> %.<span>t1011</span>                          <span>Prepare</span> <span>parameter</span> <span>for</span> <span>function</span> <span>call</span>
                      <span>call</span> @<span>fib</span>, <span>1</span>                          <span>Call</span> <span>function</span> &#34;<span>fib</span>&#34; with one parameter
                      <span>retval</span> %.<span>t1012</span>                        <span>Store</span> <span>return</span> <span>value</span> <span>in</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1012&#34;</span>
                      %.<span>t1013</span> <span>=</span> <span>add</span> %.<span>t1009</span>, %.<span>t1012</span>        <span>Add</span> <span>&#34;.t1009&#34;</span> <span>and</span> <span>&#34;.t1012&#34;</span>, <span>and</span> <span>store</span> <span>the</span> <span>result</span> <span>in</span> <span>temporary</span> <span>variable</span> <span>&#34;.t1013&#34;</span>
                      <span>ret</span> %.<span>t1013</span>                           <span>Return</span> <span>&#34;.t1013&#34;</span>
}                   }</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-known-issues" aria-hidden="true" tabindex="-1" href="#known-issues"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Known Issues</h2>
<ol dir="auto">
<li>The generated ELF lacks of .bss and .rodata section</li>
<li>The support of varying number of function arguments is incomplete. No <code>&lt;stdarg.h&gt;</code> can be used.
Alternatively, check the implementation <code>printf</code> in source <code>lib/c.c</code> for <code>var_arg</code>.</li>
<li>The C front-end is a bit dirty because there is no effective AST.</li>
</ol>
<h2 tabindex="-1" dir="auto"><a id="user-content-license" aria-hidden="true" tabindex="-1" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>License</h2>
<p dir="auto"><code>shecc</code> is freely redistributable under the BSD 2 clause license.
Use of this source code is governed by a BSD-style license that can be found in the <code>LICENSE</code> file.</p>
</article>
          </div></div>
  </body>
</html>
