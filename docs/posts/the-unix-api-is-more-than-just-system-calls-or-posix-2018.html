<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/UnixAPIMoreThanSyscalls">Original</a>
    <h1>The Unix API is more than just system calls or Posix (2018)</h1>
    
    <div id="readability-page-1" class="page"><div><h2>The practical Unix API is more than system calls (or POSIX)</h2>

	<p><small>March  4, 2018</small></p>
</div><div><p>What is the &#39;Unix API&#39;? Some people would be tempted to say that
this is straightforward; depending on your perspective it&#39;s either
the relatively standard set of core Unix system calls or the system
calls and library functions required by POSIX. This answer is not
wrong at one level, but in practice it is not a useful one.</p>

<p>As people have found out in the past, the real Unix API is the whole
collection of behaviors and environments that Unix programs assume.
It isn&#39;t just POSIX library calls; it&#39;s also the shell and standard
utilities and files that are in known locations and standard
capabilities and various other things. A &#39;Unix&#39; without a useful
<code>$HOME</code> environment variable and <code>/tmp</code> may be specification
compliant (I haven&#39;t checked POSIX) but it&#39;s not useful, in that
many programs that people want generally won&#39;t run on it.</p>

<p>In practice the Unix API is the entire Unix environment. What
constitutes the &#39;Unix&#39; environment instead of the environment
specific to a particular flavour of Unix is <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/UnixStandardProgramsEvolve">an ever-evolving topic</a>. Once upon a time <code>mmap()</code> was not
part of the Unix environment (<a href="https://utcc.utoronto.ca/~cks/space/blog/unix/OldSharedLibraries">cf</a>); today it
absolutely is. I&#39;m pretty certain that once upon a time the <code>-o</code>
flag to <code>egrep</code> was effectively Linux specific (as it relied on
<code>egrep</code> being GNU grep); today it&#39;s much closer to being part of
Unix, as many Unixes either have GNU grep as <code>egrep</code> or have added
support for <code>-o</code>. And so it goes, with the overall Unix API moving
forward through <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/UnixStandardProgramsEvolve">de facto evolution</a>.</p>

<p>Unless you intend for your program to be narrowly and specifically
portable to POSIX or an even more minimal standard, it is not a bug
for it to rely on portions of the broader, de facto Unix API. It&#39;s
not even necessarily a bug to rely on APIs that are only there on
some Unixes (for example Linux and FreeBSD), although it may limit
how widely your program spreads. Even <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/BashAsShAndBashisms">somewhat narrow API choices</a> are not necessarily bugs; you may
have decided to be limited in your portability or to at least require
some common things to be available.</p>

<p>(The Go build process requires Bash on Unix, for example, although
it doesn&#39;t require that <code>/bin/sh</code> is Bash.)</p>

<p>PS: This is a broader sense of the &#39;Unix API&#39; (and a different
usage) than I used when I wrote about <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/UnixAPIAndCRuntime">whether the C runtime and
library was a legitimate part of the Unix API</a>.
The broad Unix API is and always has been layered, and things like
Go are deliberately implementing their own API on top of one of the
lower layers. In a way, <a href="https://utcc.utoronto.ca/~cks/space/blog/unix/UnixAPIAndCRuntime">my earlier entry</a> was
partly about how separate the layers of the broad Unix API have to
be; for example, can you implement a compatible and fully capable
Bourne shell using only public Unix kernel APIs, or at most public
C library APIs?</p>

<p>(Many people would say that a system where you could not do this was
not really &#39;Unix&#39;, even if it complied with POSIX standards.)</p>
</div></div>
  </body>
</html>
