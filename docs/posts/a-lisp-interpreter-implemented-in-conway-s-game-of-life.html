<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/woodrush/lisp-in-life">Original</a>
    <h1>A Lisp Interpreter Implemented in Conway&#39;s Game of Life</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto">Lisp in Life is a Lisp interpreter implemented in Conway&#39;s Game of Life.</p>
<p dir="auto">The entire pattern is viewable on the browser <a href="https://woodrush.github.io/lisp-in-life" rel="nofollow">here</a>.</p>
<h2 dir="auto"><a id="user-content-running-lisp-and-c-on-the-game-of-life" aria-hidden="true" href="#running-lisp-and-c-on-the-game-of-life"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Running Lisp and C on the Game of Life</h2>
<p dir="auto">This repository contains a Conway&#39;s Game of Life pattern that runs a Lisp interpreter.
The Lisp program is provided by editing certain cells within the pattern to represent the ASCII-encoding of the Lisp program.
The interpreter writes its standard output to the bottom end of the RAM module, which can be directly examined in a Game of Life viewer.
The Lisp implementation supports lexical closures and macros, allowing one to write Lisp programs in a Lisp-like taste, as far as the memory limit allows you to.</p>
<p dir="auto">The <a href="https://github.com/woodrush/lisp-in-life/blob/main/src/lisp.c">Lisp interpreter</a> is written in C. Using the build system for this project, you can also compile your own C11-compatible C code and run in on Conway&#39;s Game of Life.</p>
<h2 dir="auto"><a id="user-content-screenshots" aria-hidden="true" href="#screenshots"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Screenshots</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/ss1.png"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/ss1.png" alt="An overview of the entire architecture."/></a></p>
<p dir="auto">An overview of the entire architecture.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/ss2.png"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/ss2.png" alt="An overview of the CPU and its surrounding units."/></a></p>
<p dir="auto">An overview of the CPU and its surrounding modules. On the top are the ROM modules, with the lookup module on the right, and the value modules on the left. On the bottom left is the CPU. On the bottom right is the RAM module.</p>
<p dir="auto">This pattern is the VarLife version of the architecture. VarLife is an 8-state cellular automaton defined in the <a href="https://codegolf.stackexchange.com/questions/11880/build-a-working-game-of-tetris-in-conways-game-of-life/142673#142673" rel="nofollow">Quest For Tetris</a> (QFT) Project, which is used as an intermediate layer to create the final Conway&#39;s Game of Life pattern. The colors of the cells indicate the 8 distinct states of the VarLife rule.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/ss3.png"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/ss3.png" alt="The Conway&#39;s Game of Life version of the architecture, converted from the VarLife pattern."/></a></p>
<p dir="auto">The Conway&#39;s Game of Life version of the architecture, converted from the VarLife pattern.
What appears to be a single cell in this image is actually an <a href="https://www.conwaylife.com/wiki/OTCA_metapixel" rel="nofollow">OTCA metapixel</a> zoomed away to be shown 2048 times smaller.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/ss4.png"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/ss4.png" alt="A close-up view of a part of the ROM module in the Conway&#39;s Game of Life version."/></a></p>
<p dir="auto">A close-up view of a part of the ROM module in the Conway&#39;s Game of Life version.
Each pixel in the previous image is actually this square-shaped structure shown in this image.
These structures are <a href="https://www.conwaylife.com/wiki/OTCA_metapixel" rel="nofollow">OTCA metapixels</a>, which can be seen to be in the On and Off meta-states in this image.
The OTCA metapixel is a special Conway&#39;s Game of Life pattern that can emulate cellular automatons with customized rules.
The original VarLife pattern is simulated this way so that it can run in Conway&#39;s Game of Life.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/lisp_512B_ram_printstdin_QFT.mc.gif"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/lisp_512B_ram_printstdin_QFT.mc.gif" alt="A video of the RAM module of the computer in the VarLife rule in action."/></a></p>
<p dir="auto">A video of the RAM module of the computer in the VarLife rule in action.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/ss6.png"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/ss6.png" alt="The QFT computer showing the results of the computation of (print (* 3 14))."/></a></p>
<p dir="auto">The computer showing the results of the following Lisp program:</p>
<div data-snippet-clipboard-copy-content="(define mult (lambda (m n)
  (* m n)))

(print (mult 3 14))"><pre>(define mult (<span>lambda</span> (m n)
  (* m n)))

(print (mult <span>3</span> <span>14</span>))</pre></div>
<p dir="auto">The result is <code>42</code>, shown in binary ascii format (<code>0b110100</code>, <code>0b110010</code>), read in bottom-to-up order.</p>
<p dir="auto">As shown in this image, the standard output of the Lisp program gets written at the bottom end of the RAM module, and can be directly viewed in a Game of Life viewer.
This repository also contains scripts that run on Golly to decode and view the contents of the output as strings.</p>
<h2 dir="auto"><a id="user-content-how-is-it-done" aria-hidden="true" href="#how-is-it-done"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How is it Done?</h2>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/woodrush/lisp-in-life/blob/main/img/build-flow.png"><img src="https://github.com/woodrush/lisp-in-life/raw/main/img/build-flow.png" alt="The build flow of Lisp in Life."/></a></p>
<p dir="auto">The <a href="https://github.com/woodrush/lisp-in-life/blob/main/src/lisp.c">Lisp interpreter</a>, written in C, is compiled to an assembly language for a CPU architecture implemented in the Game of Life, which is a modification of the computer used in the <a href="https://codegolf.stackexchange.com/questions/11880/build-a-working-game-of-tetris-in-conways-game-of-life/142673#142673" rel="nofollow">Quest For Tetris</a> (QFT) project. The architecture is based on <a href="https://github.com/QuestForTetris/QFT/blob/master/Tetris8.mc">Tetris8.mc</a> in the <a href="https://github.com/QuestForTetris/QFT">original QFT repository</a>.
The compilation is done using an extended version of <a href="https://github.com/shinh/elvm">ELVM</a> (the Esoteric Language Virtual Machine). The Game of  Life backend for ELVM was implemented by myself.</p>
<p dir="auto">Generating a small enough pattern that runs in a reasonable amount of time required a lot of effort.
This required optimizations and improvements in every layer of the project; a brief summary would be:</p>
<ul dir="auto">
<li>The C Compiler layer - adding the <a href="https://en.wikipedia.org/wiki/Goto#Computed_GOTO_and_Assigned_GOTO" rel="nofollow">computed goto</a> feature to the C compiler, preserving variable symbols to be used after compilation, etc.</li>
<li>The C layer (the <a href="https://github.com/woodrush/lisp-in-life/blob/main/src/lisp.c">Lisp interpreter</a>) - using a string hashtable and binary search for Lisp symbol lookup, minimization of stack region usage with union memory structures, careful memory region map design, etc.</li>
<li>The QFTASM layer - writing a <a href="https://github.com/woodrush/lisp-in-life/blob/main/src/qftasmopt.py">compiler optimizer</a> to optimize the length of the assembly code</li>
<li>The VarLife layer (the CPU architecture) - creating a lookup table architecture for faster ROM access, expanding the size and length of the RAM module, adding new opcodes, etc.</li>
<li>The Game of Life layer - <a href="https://en.wikipedia.org/wiki/Hashlife" rel="nofollow">Hashlife</a>-specific optimization</li>
</ul>
<p dir="auto">A more detailed description of the optimizations done in this project is available in the <a href="#implementation-details">Implementation Details</a> section.</p>
<h3 dir="auto"><a id="user-content-conversion-from-varlife-to-conways-game-of-life" aria-hidden="true" href="#conversion-from-varlife-to-conways-game-of-life"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Conversion from VarLife to Conway&#39;s Game of Life</h3>
<p dir="auto">VarLife is an 8-state cellular automaton defined in the <a href="https://codegolf.stackexchange.com/questions/11880/build-a-working-game-of-tetris-in-conways-game-of-life/142673#142673" rel="nofollow">Quest For Tetris</a> (QFT) Project.
It is used as an intermediate layer to generate the final Conway&#39;s Game of Life pattern; the computer is first created in VarLife, and then converted to a Game of Life pattern.</p>
<p dir="auto">When converting VarLife to Conway&#39;s Game of Life, each VarLife cell is mapped to an <a href="https://www.conwaylife.com/wiki/OTCA_metapixel" rel="nofollow">OTCA Metapixel</a> (OTCAMP). The conversion from VarLife to the Game of Life is done in a way so that the behavior of the states of the VarLife pattern matches exactly with the meta-states of the OTCA Metapixels in the converted Game of Life pattern.
Therefore, it is enough to verify the behavior of the VarLife pattern to verify the behavior of the Game of Life pattern.</p>
<p dir="auto">Due to the use of OTCA Metapixels, each VarLife cell becomes extended to a 2048x2048 Game of Life cell, and 1 VarLife generation requires 35328 Game of Life generations. Therefore, the VarLife patterns run significantly faster than the Game of Life (GoL) version.</p>
<p dir="auto">Additional details on VarLife are available in the Miscellaneous section in <a href="https://github.com/woodrush/lisp-in-life/blob/main/details.md">details.md</a>.</p>
<h2 dir="auto"><a id="user-content-pattern-files" aria-hidden="true" href="#pattern-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Pattern Files</h2>
<table>
<thead>
<tr>
<th>Program</th>
<th>VarLife Pattern</th>
<th>Conway&#39;s Game of Life Pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/print.lisp">print.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_print.mc">QFT_print.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_print_metafied.mc">QFT_print_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/lambda.lisp">lambda.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_lambda.mc">QFT_lambda.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_lambda_metafied.mc">QFT_lambda_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/printquote.lisp">printquote.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_printquote.mc">QFT_printquote.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_printquote_metafied.mc">QFT_printquote_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/factorial.lisp">factorial.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_factorial.mc">QFT_factorial.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_factorial_metafied.mc">QFT_factorial_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/z-combinator.lisp">z-combinator.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_z-combinator.mc">QFT_z-combinator.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_z-combinator_metafied.mc">QFT_z-combinator_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote-splice.lisp">backquote-splice.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_backquote-splice.mc">QFT_backquote-splice.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_backquote-splice_metafied.mc">QFT_backquote-splice_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote.lisp">backquote.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_backquote.mc">QFT_backquote.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_backquote_metafied.mc">QFT_backquote_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/object-oriented-like.lisp">object-oriented-like.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_object-oriented-like.mc">QFT_object-oriented-like.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_object-oriented-like_metafied.mc">QFT_object-oriented-like_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes-print.lisp">primes-print.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_primes-print.mc">QFT_primes-print.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_primes-print_metafied.mc">QFT_primes-print_metafied.mc</a></td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes.lisp">primes.lisp</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_primes.mc">QFT_primes.mc</a></td>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_primes_metafied.mc">QFT_primes_metafied.mc</a></td>
</tr>
</tbody>
</table>
<p dir="auto">Pattern files preloaded with various Lisp programs are available here.
Detailed statistics such as the running time and the memory consumption are available in the <a href="#running-times-and-statistics">Running Times and Statistics</a> section.</p>
<p dir="auto">The patterns can be simulated on the Game of Life simulator <a href="https://en.wikipedia.org/wiki/Golly_(program)" rel="nofollow">Golly</a>.</p>
<p dir="auto">The VarLife patterns can be simulated on Golly as well.
To run the VarLife patterns, open Golly and see File -&gt; Preferences -&gt; Control, and Check the &#34;Your Rules&#34; directory.
Open the directory, and copy <a href="https://github.com/woodrush/QFT-devkit/blob/main/Varlife.rule">./QFT-devkit/Varlife.rule</a> to the directory.</p>
<h2 dir="auto"><a id="user-content-descriptions-of-the-lisp-programs" aria-hidden="true" href="#descriptions-of-the-lisp-programs"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Descriptions of the Lisp Programs</h2>
<ul dir="auto">
<li>
<p dir="auto"><strong>object-oriented-like.lisp</strong>:
This example creates a structure similar to classes in Object-Oriented Programming, using closures.</p>
<ul dir="auto">
<li>The class has methods and field variables, where each instance carries distinct and persistent memory locations of their own.
The example instantiates two counters and concurrently modifies the value held by each instance.</li>
<li>New syntaxes for instantiation and method access, <code>(new classname)</code> and <code>(. instance methodname)</code>, are introduced using macros and functions.</li>
</ul>
<p dir="auto">The Lisp interpreter&#39;s variable scope and the macro feature is powerful enough to manage complex memory management,
and even providing a new syntax to support the target paradigm.</p>
</li>
<li>
<p dir="auto"><strong>printquote.lisp</strong>: A simple demonstration of macros.</p>
</li>
<li>
<p dir="auto"><strong>factorial.lisp</strong>: A simple demonstration of recursion with the factorial function.</p>
</li>
<li>
<p dir="auto"><strong>z-combinator.lisp</strong>:
Demonstration of the <a href="https://en.wikipedia.org/wiki/Fixed-point_combinator#Strict_fixed-point_combinator" rel="nofollow">Z Combinator</a> to implement a factorial function
using <a href="https://en.wikipedia.org/wiki/Anonymous_recursion" rel="nofollow">anonymous recursion</a>.</p>
</li>
<li>
<p dir="auto"><strong>backquote-splice.lisp</strong>:
Implements the <a href="http://cl-cookbook.sourceforge.net/macros.html#LtohTOCentry-2" rel="nofollow">backquote macro</a> used commonly in Lisp to construct macros.
It also supports the unquote and unquote-splice operations, each written as <code>~</code> and <code>~@</code>.</p>
</li>
<li>
<p dir="auto"><strong>primes.lisp</strong>: Prints a list of prime numbers up to 20. This example highlights the use of the <code>while</code> syntax.</p>
</li>
</ul>
<p dir="auto">The contents of print.lisp is quite straightforward - it calculates and prints the result of <code>3 * 14</code>.
backquote.lisp and primes-print.lisp are similar to backquote-splice.lisp and primes.lisp, mainly included for performance comparisons.
backquote.lisp doesn&#39;t implement the unquote-splice operation, and demonstrates some more examples.
primes-print.lisp reduces the number of list operations to save memory usage.</p>
<h2 dir="auto"><a id="user-content-details-of-the-lisp-interpreter" aria-hidden="true" href="#details-of-the-lisp-interpreter"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Details of the Lisp Interpreter</h2>
<h3 dir="auto"><a id="user-content-special-forms-and-builtin-functions" aria-hidden="true" href="#special-forms-and-builtin-functions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Special Forms and Builtin Functions</h3>
<ul dir="auto">
<li>define</li>
<li>if</li>
<li>quote</li>
<li>car, cdr</li>
<li>cons</li>
<li>list</li>
<li>atom</li>
<li>print</li>
<li>progn</li>
<li>while</li>
<li>lambda, macro</li>
<li>eval</li>
<li>eq</li>
<li>+, -, *, /, mod, &lt;, &gt;</li>
</ul>
<h3 dir="auto"><a id="user-content-lexical-closures" aria-hidden="true" href="#lexical-closures"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Lexical Closures</h3>
<p dir="auto">This Lisp interpreter supports lexical closures.
The implementation of lexical closures is powerful enough to write an object-oriented-like code as shown in <a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/object-oriented-like.lisp">object-oriented-like.lisp</a>,
where classes are represented as lexical closures over the field variables and the class methods.</p>
<h3 dir="auto"><a id="user-content-macros" aria-hidden="true" href="#macros"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Macros</h3>
<p dir="auto">This Lisp interpreter supports macros. Lisp macros can be thought as a function that receives code and returns code.
Following this design, macros are treated exacly the same as lambdas, except that it takes the arguments as raw S-expressions,
and evaluates the result twice (the first time to build the expression, and the second time to actually evaluate the builded expression).</p>
<h2 dir="auto"><a id="user-content-running-times-and-statistics" aria-hidden="true" href="#running-times-and-statistics"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Running Times and Statistics</h2>
<p dir="auto"><strong>VarLife Patterns</strong></p>
<table>
<thead>
<tr>
<th>Lisp Program and Pattern (VarLife)</th>
<th>#Halting Generations (VarLife)</th>
<th>Running Time (VarLife)</th>
<th>Memory Usage (VarLife)</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/print.lisp">print.lisp</a>                               [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_print.mc">pattern</a>]</td>
<td>105,413,068 (exact)</td>
<td>1.159 mins</td>
<td>5.0 GiB</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/lambda.lisp">lambda.lisp</a>                             [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_lambda.mc">pattern</a>]</td>
<td>700,000,000</td>
<td>2.966 mins</td>
<td>12.5 GiB</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/printquote.lisp">printquote.lisp</a>                     [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_printquote.mc">pattern</a>]</td>
<td>800,000,000</td>
<td>3.424 mins</td>
<td>12.5 GiB</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/factorial.lisp">factorial.lisp</a>                       [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_factorial.mc">pattern</a>]</td>
<td>1,000,000,000</td>
<td>5.200 mins</td>
<td>17.9 GiB</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/z-combinator.lisp">z-combinator.lisp</a>                 [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_z-combinator.mc">pattern</a>]</td>
<td>1,700,000,000</td>
<td>9.823 mins</td>
<td>23.4 GiB</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote-splice.lisp">backquote-splice.lisp</a>         [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_backquote-splice.mc">pattern</a>]</td>
<td>4,100,000,000</td>
<td>20.467 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote.lisp">backquote.lisp</a>                       [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_backquote.mc">pattern</a>]</td>
<td>4,100,000,000</td>
<td>21.663 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/object-oriented-like.lisp">object-oriented-like.lisp</a> [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_object-oriented-like.mc">pattern</a>]</td>
<td>4,673,000,000</td>
<td>22.363 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes-print.lisp">primes-print.lisp</a>                 [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_primes-print.mc">pattern</a>]</td>
<td>8,880,000,000</td>
<td>27.543 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes.lisp">primes.lisp</a>                             [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/QFT_primes.mc">pattern</a>]</td>
<td>9,607,100,000</td>
<td>38.334 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
</tbody>
</table>
<p dir="auto"><strong>Conway&#39;s Game of Life (GoL) Patterns</strong></p>
<table>
<thead>
<tr>
<th>Lisp Program and Pattern (GoL)</th>
<th>#Halting Generations (GoL)</th>
<th>Running Time (GoL)</th>
<th>Memory Usage (GoL)</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/print.lisp">print.lisp</a>                               [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_print_metafied.mc">pattern</a>]</td>
<td>3,724,032,866,304</td>
<td>382.415 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/lambda.lisp">lambda.lisp</a>                             [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_lambda_metafied.mc">pattern</a>]</td>
<td>24,729,600,000,000</td>
<td>1372.985 mins</td>
<td>27.5 GiB (max.)</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/printquote.lisp">printquote.lisp</a>                     [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_printquote_metafied.mc">pattern</a>]</td>
<td>28,262,400,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/factorial.lisp">factorial.lisp</a>                       [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_factorial_metafied.mc">pattern</a>]</td>
<td>35,328,000,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/z-combinator.lisp">z-combinator.lisp</a>                 [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_z-combinator_metafied.mc">pattern</a>]</td>
<td>60,057,600,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote-splice.lisp">backquote-splice.lisp</a>         [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_backquote-splice_metafied.mc">pattern</a>]</td>
<td>144,844,800,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote.lisp">backquote.lisp</a>                       [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_backquote_metafied.mc">pattern</a>]</td>
<td>144,844,800,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/object-oriented-like.lisp">object-oriented-like.lisp</a> [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_object-oriented-like_metafied.mc">pattern</a>]</td>
<td>165,087,744,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes-print.lisp">primes-print.lisp</a>                 [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_primes-print_metafied.mc">pattern</a>]</td>
<td>313,712,640,000,000</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes.lisp">primes.lisp</a>                             [<a href="https://github.com/woodrush/lisp-in-life/blob/main/patterns/metafied/QFT_primes_metafied.mc">pattern</a>]</td>
<td>339,399,628,800,000</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p dir="auto"><strong>Common Statistics</strong></p>
<table>
<thead>
<tr>
<th>Lisp Program</th>
<th>#QFT CPU Cycles</th>
<th>QFT RAM Usage (Words)</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/print.lisp">print.lisp</a></td>
<td>4,425</td>
<td>92</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/lambda.lisp">lambda.lisp</a></td>
<td>13,814</td>
<td>227</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/printquote.lisp">printquote.lisp</a></td>
<td>18,730</td>
<td>271</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/factorial.lisp">factorial.lisp</a></td>
<td>28,623</td>
<td>371</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/z-combinator.lisp">z-combinator.lisp</a></td>
<td>58,883</td>
<td>544</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote-splice.lisp">backquote-splice.lisp</a></td>
<td>142,353</td>
<td>869</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/backquote.lisp">backquote.lisp</a></td>
<td>142,742</td>
<td>876</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/object-oriented-like.lisp">object-oriented-like.lisp</a></td>
<td>161,843</td>
<td>838</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes-print.lisp">primes-print.lisp</a></td>
<td>281,883</td>
<td>527</td>
</tr>
<tr>
<td><a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/primes.lisp">primes.lisp</a></td>
<td>304,964</td>
<td>943</td>
</tr>
</tbody>
</table>
<p dir="auto">The running times for each program are shown above. The <a href="https://en.wikipedia.org/wiki/Hashlife" rel="nofollow">Hashlife</a> algorithm used for the simulation requires a lot of memory in exchange of speedups.
The simulations were run on a 32GB-RAM computer, with Golly&#39;s memory usage limit set to 28000 MB, and the default base step to 2 (configurable from the preferences).
The memory usage was measured by Ubuntu&#39;s activity monitor. &#34;(max.)&#34; shows where the maximum permitted memory was used.
The number of CPU cycles and the QFT memory usage was obtained by running the QFTASM interpreter on the host PC.
The QFT memory usage shows the number of RAM addresses that were written at least once.
The memory usage is measured in words, which is 16 bits in this architecture.</p>
<p dir="auto">All of the VarLife patterns can actually be run on a computer. The shortest running time is about 1 minute for <a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/print.lisp">print.lisp</a>.
A sophisticated program such as <a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/object-oriented-like.lisp">object-oriented-like.lisp</a> can even run in about 22 minutes.</p>
<p dir="auto">On the other hand, the Game of Life patterns take significantly more time than the VarLife patterns, but for short programs it can be run in a moderately reasonable amount of time.
For example, <a href="https://github.com/woodrush/lisp-in-life/blob/main/lisp/print.lisp">print.lisp</a> finishes running in about 6 hours in the Game of Life pattern.
As mentioned in the &#34;Conversion from VarLife to Conway&#39;s Game of Life&#34; section, since the Game of Life pattern emulates the behavior of the VarLife pattern using OTCA Metapixels,
the behavior of the Game of Life patterns can be verified by running the VarLife patterns.</p>
<h2 dir="auto"><a id="user-content-tests" aria-hidden="true" href="#tests"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tests</h2>
<p dir="auto">There are tests to check the behavior of the Lisp interpreter.
There is a test for checking the QFTASM-compiled Lisp interpreter using the QFTASM interpreter, and a test for checking the GCC-compiled Lisp interpreter on the host pc.
To run these tests, use the following commands:</p>
<div data-snippet-clipboard-copy-content="git submodule update --init --recursive # Required for building the source

make test             # Run the tests for the QFTASM-compiled Lisp interpreter, using the QFTASM interpreter
make test_executable  # Run the tests for the executable compiled by GCC"><pre>git submodule update --init --recursive <span><span>#</span> Required for building the source</span>

make <span>test</span>             <span><span>#</span> Run the tests for the QFTASM-compiled Lisp interpreter, using the QFTASM interpreter</span>
make test_executable  <span><span>#</span> Run the tests for the executable compiled by GCC</span></pre></div>
<p dir="auto">Running <code>make test</code> requires <a href="https://github.com/hylang/hy">Hy</a>, a Clojure-like Lisp implemented in Python available via <code>pip install hy</code>.
Some of the tests compare the output results of Hy and the output of the QFTASM Lisp interpreter.</p>
<p dir="auto">The tests were run on Ubuntu and Mac.</p>
<h2 dir="auto"><a id="user-content-building-from-source" aria-hidden="true" href="#building-from-source"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Building from Source</h2>
<p dir="auto">This section explains how to load the Lisp interpreter (written in C) to the Game of Life pattern, and also how to load a custom Lisp program into the pattern to run it on Game of Life.</p>
<p dir="auto">Please see <a href="https://github.com/woodrush/lisp-in-life/blob/main/build.md">build.md</a>.</p>
<h2 dir="auto"><a id="user-content-implementation-details" aria-hidden="true" href="#implementation-details"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Implementation Details</h2>
<p dir="auto">This section describes the implementation details for the various optimizations for the QFT assembly and the resulting Game of Life pattern.</p>
<p dir="auto">Please see <a href="https://github.com/woodrush/lisp-in-life/blob/main/details.md">details.md</a>.</p>
</article>
        </div></div>
  </body>
</html>
