<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setHTML">Original</a>
    <h1>Element: setHTML() method</h1>
    
    <div id="readability-page-1" class="page"><div>
            <section aria-labelledby="syntax">
    <!--lit-part X3RKttXoaxo=--><!--lit-node 0--><h2 id="syntax"><!--lit-node 1--><a href="#syntax">Syntax</a></h2><!--/lit-part-->
    <div><pre><code>setHTML(input)
setHTML(input, options)
</code></pre></div>
  </section><section aria-labelledby="parameters">
    <!--lit-part q+C3FhLECJw=--><!--lit-node 0--><h3 id="parameters"><!--lit-node 1--><a href="#parameters">Parameters</a></h3><!--/lit-part-->
    <dl>
<dt id="input"><a href="#input"><code>input</code></a></dt>
<dd>
<p>A string defining HTML to be sanitized and injected into the element.</p>
</dd>
<dt id="options"><a href="#options"><code>options</code> <span>Optional</span></a></dt>
<dd>
<p>An options object with the following optional parameters:</p>
<dl>
<dt id="sanitizer"><a href="#sanitizer"><code>sanitizer</code></a></dt>
<dd>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer"><code>Sanitizer</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/SanitizerConfig"><code>SanitizerConfig</code></a> object which defines what elements of the input will be allowed or removed, or the string <code>&#34;default&#34;</code> for the default configuration.
Note that generally a <code>&#34;Sanitizer</code> is expected to be more efficient than a <code>SanitizerConfig</code> if the configuration is to reused.
If not specified, the default sanitizer configuration is used.</p>
</dd>
</dl>
</dd>
</dl>
  </section><section aria-labelledby="return_value">
    <!--lit-part ot97hcBGzM0=--><!--lit-node 0--><h3 id="return_value"><!--lit-node 1--><a href="#return_value">Return value</a></h3><!--/lit-part-->
    <p>None (<code>undefined</code>).</p>
  </section><section aria-labelledby="exceptions">
    <!--lit-part M930gBToSqs=--><!--lit-node 0--><h3 id="exceptions"><!--lit-node 1--><a href="#exceptions">Exceptions</a></h3><!--/lit-part-->
    <dl>
<dt id="typeerror"><a href="#typeerror"><code>TypeError</code></a></dt>
<dd>
<p>This is thrown if <code>options.sanitizer</code> is passed a:</p>
<ul>
<li>non-normalized <a href="https://developer.mozilla.org/en-US/docs/Web/API/SanitizerConfig"><code>SanitizerConfig</code></a> (one that includes both &#34;allowed&#34; and &#34;removed&#34; configuration settings).</li>
<li>string that does not have the value <code>&#34;default&#34;</code>.</li>
<li>value that is not a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer"><code>Sanitizer</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/API/SanitizerConfig"><code>SanitizerConfig</code></a>, or string.</li>
</ul>
</dd>
</dl>
  </section><section aria-labelledby="description">
    <!--lit-part Srkl5+9Rtas=--><!--lit-node 0--><h2 id="description"><!--lit-node 1--><a href="#description">Description</a></h2><!--/lit-part-->
    <p>The <strong><code>setHTML()</code></strong> method provides an XSS-safe method to parse and sanitize a string of HTML into a <a href="https://developer.mozilla.org/en-US/docs/Web/API/DocumentFragment"><code>DocumentFragment</code></a>, and then insert it into the DOM as a subtree of the element.</p>
<p><code>setHTML()</code> drops any elements in the HTML input string that are invalid in the context of the current element, such as a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/col"><code>&lt;col&gt;</code></a> element outside of a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/table"><code>&lt;table&gt;</code></a>.
It then removes any HTML entities that aren&#39;t allowed by the sanitizer configuration, and further removes any XSS-unsafe elements or attributes â€” whether or not they are allowed by the sanitizer configuration.</p>
<p>If no sanitizer configuration is specified in the <code>options.sanitizer</code> parameter, <code>setHTML()</code> is used with the default <a href="https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer"><code>Sanitizer</code></a> configuration.
This configuration allows all elements and attributes that are considered XSS-safe, thereby disallowing entities that are considered unsafe.
A custom sanitizer or sanitizer configuration can be specified to choose which elements, attributes, and comments are allowed or removed.
Note that even if unsafe options are allowed by the sanitizer configuration, they will still be removed when using this method (which implicitly calls <a href="https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer/removeUnsafe"><code>Sanitizer.removeUnsafe()</code></a>).</p>
<p><code>setHTML()</code> should be used instead of <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML"><code>Element.innerHTML</code></a> for inserting untrusted strings of HTML into an element.
It should also be used instead of <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setHTMLUnsafe"><code>Element.setHTMLUnsafe()</code></a>, unless there is a specific need to allow unsafe elements and attributes.</p>
<p>Note that since this method always sanitizes input strings of XSS-unsafe entities, it is not secured or validated using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Trusted_Types_API">Trusted Types API</a>.</p>
  </section><section aria-labelledby="examples">
    <!--lit-part cjTOnCoGGWc=--><!--lit-node 0--><h2 id="examples"><!--lit-node 1--><a href="#examples">Examples</a></h2><!--/lit-part-->
    <!--?-->
  </section><section aria-labelledby="basic_usage">
    <!--lit-part e7kExkfCmbE=--><!--lit-node 0--><h3 id="basic_usage"><!--lit-node 1--><a href="#basic_usage">Basic usage</a></h3><!--/lit-part-->
    <p>This example shows some of the ways you can use <code>setHTML()</code> to sanitize and inject a string of HTML.</p>
<div><pre><code>// Define unsanitized string of HTML
const unsanitizedString = &#34;abc &lt;script&gt;alert(1)&lt;&#34; + &#34;/script&gt; def&#34;;
// Get the target Element with id &#34;target&#34;
const target = document.getElementById(&#34;target&#34;);

// setHTML() with default sanitizer
target.setHTML(unsanitizedString);

// Define custom Sanitizer and use in setHTML()
// This allows only elements: div, p, button (script is unsafe and will be removed)
const sanitizer1 = new Sanitizer({
  elements: [&#34;div&#34;, &#34;p&#34;, &#34;button&#34;, &#34;script&#34;],
});
target.setHTML(unsanitizedString, { sanitizer: sanitizer1 });

// Define custom SanitizerConfig within setHTML()
// This removes elements div, p, button, script, and any other unsafe elements/attributes
target.setHTML(unsanitizedString, {
  sanitizer: { removeElements: [&#34;div&#34;, &#34;p&#34;, &#34;button&#34;, &#34;script&#34;] },
});
</code></pre></div>
  </section><section aria-labelledby="sethtml_live_example">
    <!--lit-part 4J3zqwxbTbU=--><!--lit-node 0--><h3 id="sethtml_live_example"><!--lit-node 1--><a href="#sethtml_live_example"><code>setHTML()</code> live example</a></h3><!--/lit-part-->
    <p>This example provides a &#34;live&#34; demonstration of the method when called with different sanitizers.
The code defines buttons that you can click to sanitize and inject a string of HTML using a default and a custom sanitizer, respectively.
The original string and sanitized HTML are logged so you can inspect the results in each case.</p>
<h4 id="html">HTML</h4>
<p>The HTML defines two <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/button"><code>&lt;button&gt;</code></a> elements for applying different sanitizers, another button to reset the example, and a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/div"><code>&lt;div&gt;</code></a> element to inject the string into.</p>
<div><pre><code>&lt;button id=&#34;buttonDefault&#34; type=&#34;button&#34;&gt;Default&lt;/button&gt;
&lt;button id=&#34;buttonAllowScript&#34; type=&#34;button&#34;&gt;allowScript&lt;/button&gt;

&lt;button id=&#34;reload&#34; type=&#34;button&#34;&gt;Reload&lt;/button&gt;
&lt;div id=&#34;target&#34;&gt;Original content of target element&lt;/div&gt;
</code></pre></div>

<div><pre><code>#log {
  height: 220px;
  overflow: scroll;
  padding: 0.5rem;
  border: 1px solid black;
  margin: 5px;
}
</code></pre></div>
<h4 id="javascript">JavaScript</h4>
<div><pre><code>const logElement = document.querySelector(&#34;#log&#34;);
function log(text) {
  logElement.textContent += text;
}
</code></pre></div>
<div><pre><code>if (&#34;Sanitizer&#34; in window) {
</code></pre></div>
<p>First we define the string to sanitize, which will be the same for all cases.
This contains the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> element and the <code>onclick</code> handler, both of which are considered XSS-unsafe.
We also define the handler for the reload button.</p>
<div><pre><code>// Define unsafe string of HTML
const unsanitizedString = `
  &lt;div&gt;
    &lt;p&gt;This is a paragraph. &lt;button onclick=&#34;alert(&#39;You clicked the button!&#39;)&#34;&gt;Click me&lt;/button&gt;&lt;/p&gt;
    &lt;script src=&#34;path/to/a/module.js&#34; type=&#34;module&#34;&gt;&lt;script&gt;
  &lt;/div&gt;
`;

const reload = document.querySelector(&#34;#reload&#34;);
reload.addEventListener(&#34;click&#34;, () =&gt; document.location.reload());
</code></pre></div>
<p>Next we define the click handler for the button that sets the HTML with the default sanitizer.
This should strip out all unsafe entities before inserting the string of HTML.
Note that you can see exactly which elements are removed in the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Sanitizer/Sanitizer#creating_the_default_sanitizer"><code>Sanitizer()</code> constructor examples</a>.</p>
<div><pre><code>const defaultSanitizerButton = document.querySelector(&#34;#buttonDefault&#34;);
defaultSanitizerButton.addEventListener(&#34;click&#34;, () =&gt; {
  // Set the content of the element using the default sanitizer
  target.setHTML(unsanitizedString);

  // Log HTML before sanitization and after being injected
  logElement.textContent =
    &#34;Default sanitizer: remove script element and onclick attribute\n\n&#34;;
  log(`\nunsanitized: ${unsanitizedString}`);
  log(`\nsanitized: ${target.innerHTML}`);
});
</code></pre></div>
<p>The next click handler sets the target HTML using a custom sanitizer that allows only <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/div"><code>&lt;div&gt;</code></a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/p"><code>&lt;p&gt;</code></a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script"><code>&lt;script&gt;</code></a> elements.
Note that because we&#39;re using the <code>setHTML</code> method, <code>&lt;script&gt;</code> will also be removed!</p>
<div><pre><code>const allowScriptButton = document.querySelector(&#34;#buttonAllowScript&#34;);
allowScriptButton.addEventListener(&#34;click&#34;, () =&gt; {
  // Set the content of the element using a custom sanitizer
  const sanitizer1 = new Sanitizer({
    elements: [&#34;div&#34;, &#34;p&#34;, &#34;script&#34;],
  });
  target.setHTML(unsanitizedString, { sanitizer: sanitizer1 });

  // Log HTML before sanitization and after being injected
  logElement.textContent =
    &#34;Sanitizer: {elements: [&#39;div&#39;, &#39;p&#39;, &#39;script&#39;]}\n Script removed even though allowed\n&#34;;
  log(`\nunsanitized: ${unsanitizedString}`);
  log(`\nsanitized: ${target.innerHTML}`);
});
</code></pre></div>
<div><pre><code>} else {
  log(&#34;The HTML Sanitizer API is NOT supported in this browser.&#34;);
  // Provide fallback or alternative behavior
}
</code></pre></div>
<h4 id="results">Results</h4>
<p>Click the &#34;Default&#34; and &#34;allowScript&#34; buttons to see the effects of the default and custom sanitizer, respectively.
Note that in both cases the <code>&lt;script&gt;</code> element and <code>onclick</code> handler are removed, even if explicitly allowed by the sanitizer.</p>

  </section><section aria-labelledby="specifications">
    <!--lit-part s915xX5HiM4=--><!--lit-node 0--><h2 id="specifications"><!--lit-node 1--><a href="#specifications">Specifications</a></h2><!--/lit-part-->
    <!--lit-part lzPdEGUoFG8=--><table>
    <thead>
      <tr>
        <th scope="col"><!--lit-part-->Specification<!--/lit-part--></th>
      </tr>
    </thead>
    <tbody>
      <!--lit-part--><!--lit-part--><!--lit-part a/3Tq0vckuA=--><tr>
              <td><!--lit-part 7GI82/RZJBE=--><!--lit-node 0--><a href="https://wicg.github.io/sanitizer-api/#dom-element-sethtml" rel="noopener" target="_blank"><!--lit-part--><!--lit-part BRUAAAUVAAA=--><!--lit-part-->HTML Sanitizer API<!--/lit-part--><!--?--><!--/lit-part--><!--lit-part--><!--/lit-part--><!--lit-part BIKGC1k/hws=--><!--/lit-part--><!--lit-part--><!--/lit-part--><!--lit-part hrUCAIW1AgA=--><!--lit-part--><!--/lit-part--><!--?--><!--/lit-part--><!--/lit-part--></a><!--/lit-part--></td>
            </tr><!--/lit-part--><!--/lit-part--><!--/lit-part-->
    </tbody>
  </table><!--/lit-part-->
  </section><section aria-labelledby="browser_compatibility">
    <!--lit-part y0+5SMr/T3s=--><!--lit-node 0--><h2 id="browser_compatibility"><!--lit-node 1--><a href="#browser_compatibility">Browser compatibility</a></h2><!--/lit-part-->
    <mdn-compat-table-lazy locale="en-US" query="api.Element.setHTML"><template shadowroot="open" shadowrootmode="open"><!--lit-part y6RVfKR7hws=--><p><!--lit-part-->Loadingâ€¦<!--/lit-part--></p><!--/lit-part--></template></mdn-compat-table-lazy>
  </section><section aria-labelledby="see_also">
    <!--lit-part p88DAUaBJzA=--><!--lit-node 0--><h2 id="see_also"><!--lit-node 1--><a href="#see_also">See also</a></h2><!--/lit-part-->
    <ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/setHTMLUnsafe"><code>Element.setHTMLUnsafe()</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot/setHTML"><code>ShadowRoot.setHTML()</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot/setHTMLUnsafe"><code>ShadowRoot.setHTMLUnsafe()</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/parseHTML_static" title="Document.parseHTML()"><code>Document.parseHTML()</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/parseHTMLUnsafe_static" title="Document.parseHTMLUnsafe()"><code>Document.parseHTMLUnsafe()</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTML_Sanitizer_API">HTML Sanitizer API</a></li>
</ul>
  </section> 
      <section aria-labelledby="feedback">
        
      </section>
    
          </div></div>
  </body>
</html>
