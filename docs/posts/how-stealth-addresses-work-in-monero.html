<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2025/11/24/monero-stealth-addresses/">Original</a>
    <h1>How stealth addresses work in Monero</h1>
    
    <div id="readability-page-1" class="page"><div>
		<p><img decoding="async" src="https://www.johndcook.com/alice_monero.jpg" width="100%"/></p>
<p>Suppose Alice runs a confidential restaurant. Alice doesn’t want there to be any record of who visited her restaurant but does want to get paid for her food. She accepts Monero, and instead of a cash register there are two QR codes on display, one corresponding to her <strong>public view key</strong> <em>A</em> and the other corresponding to her <strong>public spend key</strong> <em>S</em>.</p>
<h2>How Bob buys his burger</h2>
<p>A customer Bob walks into the restaurant and orders a burger and fries. When Bob pays Alice, here’s what’s going on under the hood.</p>
<p>Bob is using software that generates a random integer <em>r</em> and multiplies it by a point <em>G</em> on an elliptic curve, specifically ed25519, obtaining the point</p>
<p><em>R</em> = <em>rG</em></p>
<p>on the curve. The software also multiplies Alice’s view key <em>A</em>, a point on the same elliptic curve, by <em>r</em>, then runs a hash function <em>H</em> on the produce <em>rA</em> that returns an integer <em>k</em>.</p>
<p><em>k</em> = <em>H</em>(<em>rA</em>).</p>
<p>Finally, Bob’s software computes the point</p>
<p><em>P</em> = <em>k</em><em>G</em> + <em>S</em></p>
<p>and sends Alice’s cash register, i.e. her crypto wallet, the pair of points (<em>P</em>, <em>R</em>). The point <em>P</em> is a <strong>stealth address</strong>, an address that will only be used this one time and cannot be linked to Alice or Bob [1]. The point <em>R</em> is additional information that helps Alice receive her money.</p>
<h2>How Alice gets paid</h2>
<p>Alice and Bob share a secret: both know <em>k</em>. How’s that?</p>
<p>Alice’s public view key <em>A</em> is the product of her private view key <em>a</em> and the group generator <em>G</em> [2]. So when Bob computes <em>rA</em>, he’s computing <em>r</em>(<em>aG</em>). Alice’s software can multiply the point <em>R</em> by <em>a</em> to obtain <em>a</em>(<em>rG</em>).</p>
<p><em>rA</em> = <em>r</em>(<em>aG</em>) = <em>a</em>(<em>rG</em>) = <em>aR.</em></p>
<p>Both Alice and Bob can hash this point—which Alice thinks of as <em>aR</em> and Bob thinks of as <em>rA</em>—to obtain <em>k</em>. This is <a href="https://www.johndcook.com/blog/2025/11/17/three-party-diffie-hellman/">ECDH</a>: elliptic curve Diffie-Hellman key exchange.</p>
<p>Next, Alice’s software scans the blockchain for payments to</p>
<p><em>P</em> = <em>k</em><em>G</em> + <em>S.</em></p>
<p>Note that <em>P</em> is on the blockchain, but only Alice and Bob know how to factor <em>P</em> into <em>kG</em> + <em>S</em> because only Alice and Bob know <em>k</em>. And only Alice can spend the money because only she knows the private key <em>s</em> corresponding to the public spend key <em>S</em> where</p>
<p><em>S</em> = <em>sG.</em></p>
<p>She knows</p>
<p><em>P</em> = <em>kG</em> + <em>sG</em> = (<em>k</em> + <em>s</em>)<em>G</em></p>
<p>and so she has the private key (<em>k</em> + <em>s</em>) corresponding to <em>P</em>.</p>
<h2>Related posts</h2>
<ul>
<li><a href="https://www.johndcook.com/blog/2025/09/25/silent-payments/">Bitcoin silent payments</a></li>
<li><a href="https://www.johndcook.com/blog/2025/09/16/monero-seed-words/">Monero seed words</a></li>
<li><a href="https://www.johndcook.com/blog/data-privacy/">Data privacy consulting</a></li>
</ul>
<p>[1] Bob sends money to the address <em>P</em>, so there could be some connection between Bob and <em>P</em> on the Monero blockchain. However, due to another feature of Monero, namely ring signatures, someone analyzing the blockchain could only determine that Bob is one of 16 people who may have sent money to the address <em>P</em>, and there’s no way to know who received the money. That is, there is no way, using only information on the blockchain, who received the money. A private investigator who saw Bob walk into Alice’s restaurant would have additional information outside the blockchain.</p>
<p>[2] The key assumption of elliptic curve cryptography is that it’s computationally infeasible to “divide” on an elliptic curve, i.e. to recover <em>a</em> from knowledge of <em>G</em> and <em>aG</em>. You could recover <em>a</em> by brute force if the group were small, but the elliptic curve ed25519 has on the order of 2<sup>255</sup> points, and <em>a</em> is some integer chosen randomly between 1 and the size of the curve.</p>
			</div></div>
  </body>
</html>
