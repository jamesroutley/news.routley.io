<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://arstechnica.com/information-technology/2022/08/ios-vpns-still-leak-traffic-more-than-2-years-later-researcher-claims/">Original</a>
    <h1>iOS VPNs have leaked traffic for years, researcher claims</h1>
    
    <div id="readability-page-1" class="page"><div>
            <h4>
      VPN security    —
</h4>
            
            <h2 itemprop="description">VPNs on Apple mobile devices reportedly keep connections open and expose data.</h2>
            <section>

  



  
</section>        </div><section>
            <div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2022/08/GettyImages-1291549949-800x533.jpg" alt="iOS VPNs have leaked traffic for years, researcher claims [Updated]"/>
      <figcaption><p>Getty Images</p></figcaption>  </figure>

  




<!-- cache hit 806:single/related:757373fa148d2471f63b851b08b7e21f --><!-- empty -->
<p><strong>(Update, Aug. 18, 2:40 p.m.: </strong>Proton founder and CEO Andy Yen said in a statement: &#34;The fact that this is still an issue is disappointing to say the least. We first notified Apple privately of this issue two years ago. Apple declined to fix the issue, which is why we disclosed the vulnerability to protect the public. Millions of people’s security is in Apple’s hands, they are the only ones who can fix the issue, but given the lack of action for the past two years, we are not very optimistic Apple will do the right thing.&#34;)</p>
<p><strong>Original story: </strong>A security researcher says that Apple&#39;s iOS devices don&#39;t fully route all network traffic through VPNs as a user might expect, a potential security issue the device maker has known about for years.</p>
<p>Michael Horowitz, a longtime computer security blogger and researcher, puts it plainly—if contentiously—in a <a href="https://www.michaelhorowitz.com/VPNs.on.iOS.are.scam.php">continually updated blog post</a>. &#34;VPNs on iOS are broken,&#34; he says.</p>
<p>Any third-party VPN seems to work at first, giving the device a new IP address, DNS servers, and a tunnel for new traffic, Horowitz writes. But sessions and connections established before a VPN is activated do not terminate and, in Horowitz&#39;s findings with advanced router logging, can still send data outside the VPN tunnel while it&#39;s active.</p>
<p>In other words, you might expect a VPN client to kill existing connections before establishing a secure connection so they can be re-established inside the tunnel. But iOS VPNs can&#39;t seem to do this, Horowitz says, a finding that is backed up by a similar report from May 2020.</p>
<p>&#34;Data leaves the iOS device outside of the VPN tunnel,&#34; Horowitz writes. &#34;This is not a classic/legacy DNS leak, it is a data leak. I confirmed this using multiple types of VPN and software from multiple VPN providers. The latest version of iOS that I tested with is 15.6.&#34;</p>
<figure><img alt="Security blogger Michael Horowitz&#39;s logs show a VPN-connected iPad reaching out to both his VPN provider (37.19.214.1) and Apple Push (17.57.144.12). The Apple connection is outside the VPN and could potentially expose his IP address if seen by an ISP or other parties." src="https://cdn.arstechnica.net/wp-content/uploads/2022/08/horowitz_finding.jpeg" width="967" height="137"/><figcaption><p>Security blogger Michael Horowitz&#39;s logs show a VPN-connected iPad reaching out to both his VPN provider (37.19.214.1) and Apple Push (17.57.144.12). The Apple connection is outside the VPN and could potentially expose his IP address if seen by an ISP or other parties.</p></figcaption></figure>
<p>Privacy company Proton previously reported an <a href="https://protonvpn.com/blog/apple-ios-vulnerability-disclosure/">iOS VPN bypass vulnerability</a> that started at least in iOS 13.3.1. Like Horowitz&#39;s post, ProtonVPN&#39;s blog noted that a VPN typically closes all existing connections and reopens them inside a VPN tunnel, but that didn&#39;t happen on iOS. Most existing connections will eventually end up inside the tunnel, but some, like Apple&#39;s push notification service, can last for hours.</p>                                            
                                                        
<p>The primary issue with non-tunneled connections persisting is that they could be unencrypted and that the IP address of the user and what they&#39;re connecting to can be seen by ISPs and other parties. &#34;Those at highest risk because of this security flaw are people in countries where surveillance and civil rights abuses are common,&#34; ProtonVPN wrote at the time. That might not be a pressing concern for typical VPN users, but it&#39;s notable.</p>
<p>ProtonVPN confirmed that the VPN bypass persisted in three subsequent updates to iOS 13. ProtonVPN indicated in its blog post that Apple would add functionality to block existing connections, but this functionality as added did not appear to make a difference in Horowitz&#39;s results.</p>
<p>Horowitz tested ProtonVPN&#39;s app in mid-2022 on an iPad iOS 15.4.1 and found that it still allowed persistent, non-tunneled connections to Apple&#39;s push service. The Kill Switch function added to ProtonVPN, which describes its function as blocking all network traffic if the VPN tunnel is lost, did not prevent leaks, according to Horowitz.</p>
<p>Horowitz tested again on iOS 15.5 with a different VPN provider and iOS app (OVPN, running the WireGuard protocol). His iPad continued to make requests to both Apple services and to Amazon Web Services.</p>
<p>ProtonVPN had suggested a workaround that was &#34;almost as effective&#34; as manually closing all connections when starting a VPN: Connect to a VPN server, turn on airplane mode, then turn it off. &#34;Your other connections should also reconnect inside the VPN tunnel, though we cannot guarantee this 100%,&#34; ProtonVPN wrote. Horowitz suggests that iOS&#39;s Airplane Mode functions are so confusing as to make this a non-answer.</p>
<p>We&#39;ve reached out to both Apple and OpenVPN for comment and will update this article with any responses.</p>
<p>Horowitz&#39;s post doesn&#39;t offer specifics on how iOS might fix the issue. He also doesn&#39;t address VPNs that offer &#34;<a href="https://www.fortinet.com/resources/cyberglossary/vpn-split-tunneling">split tunneling</a>,&#34; focusing instead on the promise of a VPN capturing all network traffic. For his part, Horowitz recommends a <a href="https://www.pcwrt.com/">$130 dedicated VPN router</a> as a truly secure VPN solution.</p>
<p>VPNs, especially commercial offerings, continue to be a complicated piece of Internet security and privacy. <a href="https://arstechnica.com/information-technology/2016/06/aiming-for-anonymity-ars-assesses-the-state-of-vpns-in-2016/">Picking a &#34;best VPN&#34;</a> has long been a challenge. VPNs can be brought down by <a href="https://arstechnica.com/information-technology/2021/04/ransomware-shuts-down-production-at-two-manufacturing-plants/">vulnerabilities</a>, <a href="https://arstechnica.com/gadgets/2021/07/vpn-servers-seized-by-ukrainian-authorities-werent-encrypted/">unencrypted servers</a>, <a href="https://arstechnica.com/tech-policy/2020/03/analytics-firm-harvested-ios-android-user-data-with-vpn-apps-report-finds/">greedy data brokers</a>, or by <a href="https://arstechnica.com/tech-policy/2018/08/facebook-violates-apples-data-gathering-rules-pulls-vpn-from-app-store/">being owned by Facebook</a>.</p>
<p>(<strong>Update 2:58 pm ET</strong>: Updated to address notion of split tunneling and VPN expectations.)</p>

                                                </div>

            
            
        </section></div>
  </body>
</html>
