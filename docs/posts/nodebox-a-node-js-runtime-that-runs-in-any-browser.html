<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://codesandbox.io/blog/announcing-sandpack-2">Original</a>
    <h1>Nodebox: A Node.js runtime that runs in any browser</h1>
    
    <div id="readability-page-1" class="page"><div><div><div><div><p><img width="40" height="40" src="https://avatars0.githubusercontent.com/u/587016?s=460&amp;v=4" alt="Ives van Hoorne"/></p><p><span>Ives van Hoorne</span><span>CodeSandbox Co-Founder</span></p></div>
<p><strong>Today, we are announcing Sandpack 2.0, which introduces Nodebox‚Äîa fast Node.js runtime that allows you to run server-side code in any browser.</strong></p>
<p>One year ago, we <a target="_blank" rel="noreferrer" href="https://codesandbox.io/post/sandpack-announcement">introduced Sandpack</a>, an open-source in-browser bundler that allows you to run live running code examples on your website.</p>
<p>We couldn‚Äôt have made a better decision. We knew how powerful Sandpack is (it&#39;s the bundler that powers CodeSandbox itself!), so making it freely available to everyone just made sense. And we kept thinking: what sorts of cool stuff will people build using this technology?</p>
<p>Lo and behold, cool stuff was built. From the impressive <a target="_blank" rel="noreferrer" href="https://beta.reactjs.org/">React.js beta docs</a> to products like <a target="_blank" rel="noreferrer" href="https://www.sideguide.dev">SideGuide</a>, we marveled at how this technology was pushing the limits of what could be run in a browser.</p>
<p>But the JavaScript world moves fast! New challenges keep appearing, moving beyond runtime execution and demanding more server implementation to solve problems of growing complexity. So, what about... Node support? Not only would this solve an increasing need for server execution, but it would also empower developers by making it more accessible to run Node projects without elaborate setups.</p>
<p>And that is why we‚Äôre all so excited to share the release of Sandpack 2.0 with Nodebox technology, which you can try out in <a href="https://codesandbox.io/p/sandbox/recursing-silence-58ez5h?file=%2Fsrc%2FApp.tsx" target="_blank" rel="noreferrer">this sandbox</a> ü•≥</p>
<h2>Run Node in any browser</h2>
<div><p><img width="40" height="40" src="https://avatars.githubusercontent.com/u/4838076?s=400&amp;u=4a6e83e27f793352a773920255ec23af710dc3aa&amp;v=4" alt="Danilo Woznica"/></p><p><span>Danilo Woznica</span><span>Sandpack maintainer</span></p></div>
<p>If you have heard about or used <a target="_blank" rel="noreferrer" href="https://sandpack.codesandbox.io/">Sandpack</a>, you probably know what it‚Äôs all about: running any JavaScript application directly in the browser. But in version 1, the big caveat to ‚Äúany JavaScript application‚Äù was that it only worked for client runtime execution. And we wanted to change that.</p>
<p>No matter if your app depends on server or client runtime execution, in Sandpack it should work for you. This was the key objective as we worked towards version 2.</p>
<p>To make this a reality, Sandpack 2.0 introduces Nodebox, a new technology that implements its very own abstraction of Node.js in-browser. Nodebox brings a new set of possibilities allowing Sandpack to run almost any JavaScript application you can imagine in any browser.</p>
<p><img alt="framework" srcset="/_next/image?url=%2Fnew%2Fblog%2Fannouncing-sandpack-2%2Fframework.png&amp;w=3840&amp;q=75 1x" src="https://codesandbox.io/_next/image?url=%2Fnew%2Fblog%2Fannouncing-sandpack-2%2Fframework.png&amp;w=3840&amp;q=75" width="3840" height="2160" decoding="async" data-nimg="1" loading="lazy"/></p>
<p>We believe this can be huge‚Äîjust as big, if not bigger than what Sandpack v1 enabled. With Nodebox, you won‚Äôt have to <code>git-clone</code>, download specific Node versions, run scripts on the terminal, etc.‚Äîyou can run a Node project in seconds in the browser without installing anything on your computer. Plus, you get Sandpack‚Äôs customizable UI, low footprint, and a tried-and-true developer experience all in a single package.</p>
<p>But enough talk. Time to really put Sandpack 2.0 to the test with some cool examples. Remember: all of these are editable, so tweak them to your heart‚Äôs desire!</p>
<div><p><strong>Nodebox templates:</strong></p><p><strong>More examples:</strong></p><p><strong>iOS Safari is currently in beta support</strong>, which means that some of the templates might crash this browser tab because of an internal error. Please keep this in mind.</p><div><div><div><div><div aria-autocomplete="list" aria-label="Code Editor for index.js" aria-multiline="true" role="textbox" tabindex="0" translate="no"><pre><span>export</span> <span>default</span> <span>function</span> <span>Home</span><span>(</span><span>{</span> <span>data</span> <span>}</span><span>)</span> <span>{</span>
  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span><span>&gt;</span>
      <span>&lt;</span><span>h1</span><span>&gt;</span>Hello <span>{</span><span>data</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>
  
<span>export</span> <span>function</span> <span>getServerSideProps</span><span>(</span><span>)</span> <span>{</span>
  <span>return</span> <span>{</span>
    <span>props</span><span>:</span> <span>{</span> <span>data</span><span>:</span> <span>&#34;world&#34;</span> <span>}</span><span>,</span>
  <span>}</span>
<span>}</span>

</pre></div></div></div></div></div><div><div><div><div><pre translate="no"><code><span>import</span> <span>{</span> <span>Sandpack</span> <span>}</span> <span>from</span> <span>&#34;@codesandbox/sandpack-react&#34;</span>
  
<span>&lt;</span><span>Sandpack</span> <span>template</span>=<span>&#34;nextjs&#34;</span> <span>/&gt;</span></code></pre></div></div></div></div></div>
<p>üëâ Open the example above in <a href="https://codesandbox.io/p/sandbox/recursing-silence-58ez5h?file=%2Fsrc%2FApp.tsx" target="_blank" rel="noreferrer">this cloud sandbox</a> and start building!</p>
<h2>Making Node at home, everywhere</h2>
<p>Sooooo‚Ä¶ what can it run?</p>
<p>With Sandpack 2.0, you can bring your docs to a whole new level, as Nodebox allows running server-side examples. Go ahead and add Next.js or any Vite-based examples, tutorials for Node scripts‚Ä¶ all of these will run for everyone visiting your Docs, regardless of their browser or device. Take a look at our <a target="_blank" rel="noreferrer" href="https://sandpack.codesandbox.io/docs">brand-new Sandpack Docs</a> for a glimpse of all the exciting things you can achieve with interactive documentation.</p>
<!-- -->
<p>This also means that <strong>disposable server-side instances</strong> are now a reality. Unlike Node emulation technologies, Sandpack 2.0 allows you to run themeable and customizable server projects quickly and easily with almost no footprint‚Äîno need for a server, registration, source control, installation, and running steps.</p>
<blockquote>
<p>At CodeSandbox, we are committed to preventing ideas and even simple moments of curiosity from slipping away. Programming is an incredibly powerful tool to solve real-life problems, we just have to provide accessibility. Sandpack made it possible for any website to make coding part of their content and now, with Nodebox, server code as well. Super excited to see people learn and play with Sandpack 2.0! ‚Äî <a href="https://github.com/christianalfoni">Christian Alfoni</a></p>
</blockquote>
<p>Finally, Sandpack 2.0 opens a whole new world of possibilities for technical content creators, documentation maintainers, developers of new online tools, and other creative usages where a server environment in-browser might be useful.</p>
<p>To cap it all off, when using Sandpack 2.0 you‚Äôre always one click away from a full development environment. Open any example on the <a target="_blank" rel="noreferrer" href="https://codesandbox.io/s/">new CodeSandbox experience</a> to keep building it, going as complex as you need.</p>
<h2>Nodebox under the hood</h2>
<div><p><img width="40" height="40" src="https://avatars.githubusercontent.com/u/2175521?s=64&amp;v=4" alt="Jasper de Moor"/></p><p><span>Jasper de Moor</span><span>Nodebox maintainer</span></p></div>
<p>We started working on Nodebox because of our own internal needs at CodeSandbox and several external requests from other developers wanting an easy way to run Node in any browser.</p>
<p>Nodebox is a high-level abstraction of Node.js. That means it doesn‚Äôt implement some of the small details of Node.js, but we made various tweaks to make it compatible with every browser. So, Nodebox aims for application compatibility, not Node.js feature parity.</p>
<p>Performance was also one of our top priorities while developing Nodebox. We completely rewrote the Sandpack transpiler using Rust, tweaked our caching and made several other optimizations. The result? It‚Äôs really fast! Our Vite templates, for example, have a hot start time of 500ms üéâ.</p>
<p>We‚Äôre shipping Nodebox with out-of-the-box support for Next.js, Vite and Astro, but we‚Äôre growing to support just about any server-side framework you can imagine. However, bear in mind it can‚Äôt run napi or any other low-level C++/Rust package you can use in Node.js‚Äîonly WebAssembly and JavaScript modules. Postgres, MongoDB and MySQL are also currently not supported because of the lack of raw socket support in browsers.</p>
<p>Plus, we&#39;re currently working on some missing APIs, such as <code>async_hooks</code>, <code>vm</code>, <code>worker_threads</code>, automatic process exiting (users now need to manually call <code>process.exit</code> before the process is exited) and synchronous exec/spawn. Nodebox works in iOS Safari, but it‚Äôs still on beta support due to a browser memory leak. Most of these are planned for March.</p>
<div><div><div><p><img blurwidth="8" blurheight="8" alt="Vite 4" srcset="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fvite4.37f0ce78.png&amp;w=96&amp;q=75 1x, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fvite4.37f0ce78.png&amp;w=256&amp;q=75 2x" src="https://codesandbox.io/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fvite4.37f0ce78.png&amp;w=256&amp;q=75" width="95" height="95" decoding="async" data-nimg="1" loading="lazy"/></p><p>Vite 4 support</p><p>Run React, Vue, Astro, Svelte</p></div></div><div><div><p>500ms</p><p>Vite template hot start time</p><p>with auto-install dependencies</p></div></div></div>
<h3>Difference with WebContainers</h3>
<p>We get that Nodebox will invariably be compared to WebContainers. So, below is an overview of how they differ.</p>
<p>WebContainers is a technology that also allows you to run Node.js in the browser. However, it uses modern browser technologies like <code>SharedArrayBuffer</code>, which makes it impossible to run in Safari and requires the user to set additional <code>Cross-Origin-Isolation</code> headers on the server to run any code.</p>
<p>Instead, we implemented Nodebox without modern browser technologies, to make it run in any browser (like iOS and Safari) with minimal setup. The disadvantage of this is that Nodebox will use more memory when you spawn more threads, and we cannot get full Node API compatibility (for example, we cannot use synchronous <code>fork</code>). This is okay for Nodebox because it was built to run small projects and examples, which it does really well. If you want to do full development in the browser, we recommend using our microVM technology instead.</p>
<p>For more detailed information, check our <a target="_blank" rel="noreferrer" href="https://sandpack.codesandbox.io/docs/resources/faq#how-does-the-nodebox-compare-to-webcontainers">FAQ</a>.</p>
<h2>Powerful. Fast. Ready To Use.</h2>
<p>We will never grow tired of developing a more accessible web for everyone.</p>
<p>Building something as powerful and fast as Nodebox is truly a joy, but it wouldn‚Äôt have such a big impact unless we made it for everyone. So, you can use Nodebox as an <a target="_blank" rel="noreferrer" href="https://www.npmjs.com/package/@codesandbox/nodebox">NPM package</a>, which allows you to run Node.js in any browser, any context, and any application.</p>
<p>For example, here‚Äôs how you can run Express.js in Nodebox with just a few lines of code:</p>
<div><div><div><div><pre translate="no"><code><span>import</span> <span>{</span> <span>Nodebox</span> <span>}</span> <span>from</span> <span>&#34;@codesandbox/nodebox&#34;</span><span>;</span>

<span>const</span> <span>previewIframe</span> = <span>document</span>.<span>getElementById</span><span>(</span><span>&#34;preview-iframe&#34;</span><span>)</span><span>;</span>
<span>const</span> <span>nodeboxIframe</span> = <span>document</span>.<span>getElementById</span><span>(</span><span>&#34;nodebox-iframe&#34;</span><span>)</span><span>;</span>

<span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
  
  <span>const</span> <span>nodebox</span> = <span>new</span> <span>Nodebox</span><span>(</span><span>{</span> <span>iframe</span><span>:</span> <span>nodeboxIframe</span> <span>}</span><span>)</span><span>;</span>

  
  <span>await</span> <span>nodebox</span>.<span>connect</span><span>(</span><span>)</span><span>;</span>

  
  <span>await</span> <span>nodebox</span>.<span>fs</span>.<span>init</span><span>(</span><span>{</span>
    <span>&#34;package.json&#34;</span><span>:</span> <span>JSON</span>.<span>stringify</span><span>(</span><span>{</span>
      <span>dependencies</span><span>:</span> <span>{</span>
        <span>express</span><span>:</span> <span>&#34;4.18.2&#34;</span><span>,</span>
      <span>}</span><span>,</span>
    <span>}</span><span>)</span><span>,</span>
    <span>&#34;index.js&#34;</span><span>:</span> <span>`const express = require(&#39;express&#39;)
const app = express()
const port = 3000

app.get(&#39;/&#39;, (req, res) =&gt; {
  res.send(&#39;Hello world&#39;)
})

app.listen(port, () =&gt; {
  console.log(`</span><span>Example </span><span>app </span><span>listening </span><span>on </span><span>port </span><span>$</span><span>{</span><span>port</span><span>}</span><span>`)
})`</span><span>,</span>
  <span>}</span><span>)</span><span>;</span>

  
  <span>const</span> <span>shell</span> = <span>nodebox</span>.<span>shell</span>.<span>create</span><span>(</span><span>)</span><span>;</span>

  
  
  <span>const</span> <span>{</span> <span>id</span> <span>}</span> = <span>await</span> <span>shell</span>.<span>runCommand</span><span>(</span><span>&#34;node&#34;</span><span>,</span> <span>[</span><span>&#34;index.js&#34;</span><span>]</span><span>)</span><span>;</span>

  
  <span>const</span> <span>{</span> <span>url</span> <span>}</span> = <span>await</span> <span>nodebox</span>.<span>preview</span>.<span>getByShellId</span><span>(</span><span>id</span><span>)</span><span>;</span>
  <span>previewIframe</span>.<span>src</span> = <span>url</span><span>;</span>
<span>}</span><span>)</span><span>(</span><span>)</span><span>;</span></code></pre></div></div></div></div>
<p>üëâ Try this example in <a target="_blank" rel="noreferrer" href="https://codesandbox.io/p/sandbox/priceless-bash-nlrrz4">this sandbox</a>.</p>
<h2>What‚Äôs Next?</h2>
<p>There‚Äôs definitely a bright future ahead for Sandpack!</p>
<p>Next up, we‚Äôre working on enabling <a target="_blank" rel="noreferrer" href="https://codesandbox.io/blog/how-we-clone-a-running-vm-in-2-seconds">microVMs</a> in Sandpack, which will allow you to get rid of browser limitations and run complex projects with any programming language.</p>
<p>While unfortunately we are not open-sourcing Nodebox for a variety of reasons, some of which are outside of our control, we believe this technology may be the future of improved DX. So, we will continue to explore whether we can open-source it in the future.</p>
<p>We can‚Äôt wait to see all the amazing things that you will build! If you encounter any bugs or want to request any missing features, open an issue on GitHub.</p>
<p>Our enormous thank you to the people who have made this a reality. Kudos to <a href="https://twitter.com/ace_kyd">Adewale</a>,¬†<a href="https://twitter.com/alexnmoldovan">Alex</a>,¬†<a href="https://github.com/kettanaito">Artem</a>, <a href="https://github.com/bazzjuh">Bas</a>, <a href="https://twitter.com/danilowoz">Danilo</a>,¬†<a href="https://github.com/filipelima18">Filipe</a>, <a href="https://github.com/CompuIves">Ives</a>, <a href="https://twitter.com/JasperDeMoor">Jasper</a>,¬†<a href="https://twitter.com/marcovincit">Marco</a>, <a href="https://github.com/Ekwuno">Obinna</a>,¬†<a href="https://github.com/oskarabc">Oskar</a>, <a href="https://twitter.com/zehf">Zeh</a>, and all our Sandpack contributors on GitHub!</p>
</div></div></div></div>
  </body>
</html>
