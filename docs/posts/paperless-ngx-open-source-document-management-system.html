<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nerdyarticles.com/a-clutter-free-life-with-paperless-ngx/">Original</a>
    <h1>Paperless-ngx – Open source document management system</h1>
    
    <div id="readability-page-1" class="page"><section>
        <h2 id="introduction">Introduction</h2><p>In my previous article, I provided a comprehensive overview of my homelab. If you haven&#39;t had a chance to read it yet but are interested, you can find it at <a href="https://nerdyarticles.com/my-homelab-a-general-overview/">here</a>. In the upcoming articles, I&#39;ll delve into detailed guides on how to create a homelab like mine. However, from time to time, like now, I like to shift the focus and spotlight a service or project I&#39;m particularly fond of.</p><p>In this article, I&#39;ll explore what Paperless-ngx (we&#39;ll call it Paperless for short) is and the benefits it offers. I&#39;ll also share how I&#39;ve structured my Paperless installation. Finally, I&#39;ll provide my code for you to use in setting up your own instance. For now, I&#39;ll assume you already have a functional Docker environment ready to deploy your Paperless instance.</p><p>Introducing <a href="https://docs.paperless-ngx.com/?ref=nerdyarticles.com">Paperless-ngx</a>, your key to simplifying life by going digital! Are you tired of hunting for crucial documents when doing your taxes? With Paperless, that hassle is a thing of the past. This fantastic tool has built-in OCR (Optical Character Recognition) and learns from your categorized documents, making it a breeze to organize your files. Say goodbye to endless diggin through folders – now, all your essential documents are just a few clicks away. Once you&#39;ve given Paperless a try for a while, you&#39;ll find that it consistently gets things right, reducing the need for manual adjustments. Say hello to a more streamlined and efficient way of managing your documents!</p><p>The big benefit of going digital in this space? Flexibility! Unlike traditional paper-based or folder-organized digital systems, your documents can belong to multiple categories at once. Ever wrestled with the dilemma of deciding which folder a document should go into? That&#39;s because it often fits more than one category. The solution? Tags. With a digital solution like Paperless, you can assign as many tags as you need, making categorization a breeze. Say goodbye to the folder confusion!</p><hr/><h2 id="paperless-a-living-proof-of-open-source-greatness">Paperless: A Living Proof of Open Source Greatness</h2><p>In short: Paperless transitioned into Paperless-ng and then into Paperless-ngx</p><p><a href="https://github.com/the-paperless-project/paperless?ref=nerdyarticles.com">Paperless</a> was initiated by Daniel Quinn, with his initial commit to the GitHub project dating back to 6th June 2016. The version 1 release came on 3rd July 2018 (with the first release, 0.3.0, launched on 1st January 2017). The last release under Daniel Quinn&#39;s was on 27th January 2019.</p><p>As the original project began to lose momentum, Jonas Winkler&#39;s fork <a href="https://github.com/jonaswinkler/paperless-ng?ref=nerdyarticles.com">Paperless-ng</a> emerged as the official successor. The first release (0.9) occurred on 18th November 2020, and the final release before the current transition was on 22nd August 2021.</p><p>At the time of writing this, <a href="https://github.com/paperless-ngx/paperless-ngx?ref=nerdyarticles.com">Paperless-ngx</a> is the official version and repository, having its inaugural release on 05th March 2022.</p><p>This journey exemplifies the strength of the open-source community. Even if a project experiences slowdowns or transitions, passionate contributors ensure its legacy lives on and continues to evolve.</p><p>Let&#39;s explore Paperless and my adoption of it. There are various approaches to adopting it, so find what suits you best. What works for me might just be the right fit for you too, or you might discover your own path along the way.</p><figure><img src="https://nerdyarticles.com/content/images/2023/10/Paperless---Documents-Screenshot-blurred.png" alt="" loading="lazy" width="1892" height="958" srcset="https://nerdyarticles.com/content/images/size/w600/2023/10/Paperless---Documents-Screenshot-blurred.png 600w, https://nerdyarticles.com/content/images/size/w1000/2023/10/Paperless---Documents-Screenshot-blurred.png 1000w, https://nerdyarticles.com/content/images/size/w1600/2023/10/Paperless---Documents-Screenshot-blurred.png 1600w, https://nerdyarticles.com/content/images/2023/10/Paperless---Documents-Screenshot-blurred.png 1892w" sizes="(min-width: 1200px) 1200px"/><figcaption>The documents view in Paperless-ngx</figcaption></figure><p>Here are the key feature of Paperless:</p><ol><li><strong>Document Management:</strong> Organize and manage your digital documents efficiently in the web.</li><li><strong>Tagging System:</strong> Easily categorize documents with tags for quick access.</li><li><strong>OCR Integration:</strong> Optical Character Recognition for extracting text from images and scanned documents.</li><li><strong>Automatic Categorization:</strong> Learns from your tags and categories to auto-classify future documents.</li><li><strong>Search Functionality:</strong> Powerful search capabilities to find documents swiftly.</li><li><strong>Multi-User Support:</strong> Collaborate with others by setting up multiple user accounts.</li><li><strong>Data Export:</strong> Export your documents and data for backup or migration purposes. They are also kept in a very neat folder structure and naming convention, enabling you to ditch Paperless without any effort.</li></ol><h2 id="from-paper-to-pixels-which-documents-belong-in-your-digital-vault">From Paper to Pixels: Which Documents Belong in Your Digital Vault?</h2><p>I&#39;m in Germany, so these rules may not apply to you. Always do your own research. I am only sharing what I am doing and not advising you to do the same.</p><p>Generally, I digitize what I&#39;d put in a physical folder, which is not every letter from banks, insurers, etc. </p><p>The next choice is whether to keep the physical copy or go digital only (make sure you have a proven backup solution). In Germany, you must keep physical copies of certificates, notarized docs, property papers, vehicle papers, specific financial docs (contract-related, not just statements), insurance policies, passports, and ID cards. I shred and dispose of any document that don&#39;t require a physical copy. Fortunately, many documents are digital these days, saving me from making that decision and scanning them.</p><hr/><h2 id="tagging-document-types-and-correspondents-my-organizational-secrets">Tagging, Document Types, and Correspondents: My Organizational Secrets</h2><p>To stay organized and efficient, it&#39;s crucial to consider document types, tags, and correspondents.</p><h3 id="correspondents">Correspondents</h3><p>This part is straightforward. Every sender of documents you upload to Paperless becomes a correspondent. You can add new correspondents on the fly when you review new documents. </p><p>I do make exceptions; for instance, invoices from online shops are assigned to &#39;Online Shops&#39; rather than having their own correspondent. Thanks to the full-text search, finding what I need is easy within the hundreds of documents in the system.</p><h3 id="document-types">Document Types</h3><p>I put a lot of thought into document types when setting up Paperless, but rarely ever need them. Although I don&#39;t use them often, they don&#39;t hurt as Paperless is self-learning. </p><p>Here are the types I&#39;ve set up: </p><ul><li>Invoice</li><li>Letter</li><li>Insurance</li><li>Contract</li><li>Other</li></ul><h3 id="tags">Tags</h3><p>Remember what we discussed earlier? Folders, whether they&#39;re physical or digital, limit us to just one category per document. Tags give us the power to assign multiple categories to a single document. So, go ahead, be a tagging superstar and create as many categories as your heart desires (and even assign them all to one document). It&#39;s your very own organizational playground!</p><p>In my experience, simplicity beats complexity. Keep it straightforward, no need for over-detailing. Plus, we&#39;ve got this fantastic search feature to help you find what you need in a snap!</p><p>Now, let&#39;s dive into the magical world of tags.</p><h4 id="whos-affected">Who&#39;s Affected?</h4><p>I find it helpful to use distinct tags for the people the documents affect:</p><ul><li>Wife</li><li>Me</li><li>Family (for example all bills around the house, shared insurances, ...)</li></ul><h4 id="which-categories-are-affected">Which Categories Are Affected?</h4><p>I also like to create specific groupings to easily access all related documents.</p><ul><li>Car (You could also create a tag per car you own.)</li><li>Doctor</li><li>Expenses</li><li>House (Have more real estate? Create a tag per property.)</li><li>ToDo (Will cover this later.)</li></ul><p>For a smooth tax season, I rely on my tax tags, which make finding relevant documents a breeze.</p><ul><li>Tax (A general tag for all tax relevant documents.)</li><li>Tax always (I have documents, which are relevant for every year.)</li><li>Tax 2021</li><li>Tax 2022</li><li>Tax 2023</li><li>...</li></ul><p>Documents like insurance papers, which are relevant for more than one year, usually have three tax tags: the general one and the two for the years they are relevant for.</p><hr/><h2 id="digitalization-made-easy-uploading-to-paperless-ngx">Digitalization Made Easy: Uploading to Paperless-ngx</h2><p>Now that everything is set up for organizing our documents, you might wonder how to get them in there. It&#39;s a straightforward process, with three simple methods (not counting potential mobile apps as a fourth option).</p><p>This is also where the &#39;ToDo&#39; tag comes into play! Make sure, when you create the tag, that you tick the &#39;Inbox tag&#39; box.</p><figure><img src="https://nerdyarticles.com/content/images/2023/10/ToDo-Tag-settings.png" alt="" loading="lazy" width="563" height="567"/><figcaption>Setting of the ToDo tag to always apply to new documents</figcaption></figure><p> Regardless of how the documents are imported into Paperless, the ToDo tag is set. I have created a so-called &#39;view&#39;, which displays all documents with the ToDo tag, and added that view to my homepage. This is essentially my inbox in Paperless, which I go through from time to time to check if everything is set correctly.</p><figure><img src="https://nerdyarticles.com/content/images/2023/10/Paperless---Homescreen-Screenshot.png" alt="" loading="lazy" width="1899" height="952" srcset="https://nerdyarticles.com/content/images/size/w600/2023/10/Paperless---Homescreen-Screenshot.png 600w, https://nerdyarticles.com/content/images/size/w1000/2023/10/Paperless---Homescreen-Screenshot.png 1000w, https://nerdyarticles.com/content/images/size/w1600/2023/10/Paperless---Homescreen-Screenshot.png 1600w, https://nerdyarticles.com/content/images/2023/10/Paperless---Homescreen-Screenshot.png 1899w" sizes="(min-width: 1200px) 1200px"/><figcaption>The Paperless-ngx start screen with documents in my &#39;inbox&#39;.</figcaption></figure><h3 id="uploading">Uploading</h3><p>In your web browser, click the upload button, select your file(s), and click upload. For an even easier method, just drag and drop your file(s) into the Paperless browser window, no matter where you are in Paperless. It&#39;s that simple!</p><h3 id="email-inbox">Email Inbox</h3><p>You can have Paperless periodically scan a specific email inbox and import files from there. It could be your standard inbox, and you watch for a certain topic or folder, or you just set up a new inbox and forward emails with documents you want to import to that inbox. This is what I do, and let&#39;s have a quick look at how to set that up.</p><p>After you have added an email inbox to monitor in the settings, you can specify what the importer will actually watch for and do.</p><figure><img src="https://nerdyarticles.com/content/images/2023/10/Paperless---Mail-rule-1.png" alt="" loading="lazy" width="1136" height="812" srcset="https://nerdyarticles.com/content/images/size/w600/2023/10/Paperless---Mail-rule-1.png 600w, https://nerdyarticles.com/content/images/size/w1000/2023/10/Paperless---Mail-rule-1.png 1000w, https://nerdyarticles.com/content/images/2023/10/Paperless---Mail-rule-1.png 1136w"/><figcaption>Settings for the email importer</figcaption></figure><p>What you can see in the picture above is that my rule &#39;Main Importer&#39; will import from &#39;Paperless Mail Inbox&#39; (the name I gave the configuration of the email inbox to monitor). It watches the folder &#39;INBOX&#39;, processes all PDF documents, uses the file&#39;s name as the document name, sets the &#39;ToDo&#39; tag, and deletes the email. </p><p>Don&#39;t worry about the &#39;Do not assign a correspondent&#39; option; this actually means that the self-learning algorithm will try to set the correct correspondent.</p><h3 id="auto-import-from-a-folder">Auto import from a folder</h3><p>You can also have Paperless watch a specific folder and import all documents from there. This is especially useful if you already have many digital documents you want to import initially or if you have a scanner with the ability to scan to a network share.</p><hr/><h2 id="effortless-editing-perfecting-your-documents">Effortless Editing: Perfecting Your Documents</h2><p>Paired with the OCR process and the self-learning algorithm, editing newly added documents is very easy and fast. Remember, though, that the self-learning algorithm needs to learn from your documents. Any new correspondent will definitely be wrong, as it will try to set a known correspondent. After some time, it will become a matter of just making sure everything is correct.</p><p>The title is something I neraly always redo, to make it very meaningful, in order to identify the document very quickly.</p><p>I have learned that the it also is a tricky part to set the right date. There are a few to choose from (dates from the files meta data, dates in the header, or any other dates mentioned in the document). It gets it right most times, but do pay attention to it.</p><figure><img src="https://nerdyarticles.com/content/images/2023/10/Paperless---Edit-Window-2.png" alt="" loading="lazy" width="522" height="697"/><figcaption>Editing view for Paperless-ngx documents</figcaption></figure><p>In the above screenshot, you can see a freshly imported document, which I can now check if everything is correct. Is it a new correspondent? No need to leave the window; you can create it straight from the input field here, same for the Document Type and Tags.</p><p>The archive serial number can also be very useful (I don&#39;t use it). The serial number will automatically count upwards by one from the last serial number used. You can then write this number on the physical document and just put it in a folder, without any extra organization. Are you now looking for a document, just look up the serial number, identify the folder, ...</p><p>The last step when I am done is removing the &#39;ToDo&#39; tag and &#39;Save &amp; Close&#39; the document.</p><p>You&#39;ve come a long way (or maybe you jumped ahead to grab my Docker config). Now, let&#39;s chat about how I&#39;ve configured my Paperless instance to run in Docker. To make this work, we&#39;ll need three containers: a database (usually PostgreSQL, which I prefer), a Redis broker for scheduled tasks, and, of course, Paperless-ngx itself.</p><h2 id="redis-container">Redis Container</h2><p>Alright, let&#39;s kick things off with the easiest part: the Redis broker.</p><pre><code>paperless-redis:
  container_name: paperless-redis
  image: redis:7.2-alpine #fixedVersion
  restart: unless-stopped
  networks:
    - backend
  security_opt:
    - no-new-privileges:true
  volumes:
    - ./paperless/redis:/data
  environment:
    REDIS_ARGS: &#34;--save 60 10&#34;</code></pre><p>Here are some important points to highlight in my Docker Compose code for the Redis broker:</p><p><strong>Naming Convention:</strong> I use a naming convention for supporting services, where it&#39;s structured as &lt;Name of the supported service&gt;-&lt;Name of the supporting service&gt;. In this case, it&#39;s &#39;paperless-redis,&#39; and this convention applies to both the service and container name.</p><p><strong>Fixed Image Version:</strong> I always specify a fixed image version for supporting services. This helps prevent issues when upgrading the Docker stack. It ensures that the version I&#39;m using is compatible with my main service. This is particularly crucial for databases, where version mismatches can require migration steps.</p><p><strong>Docker Networks:</strong> I organize my Docker containers into two networks:</p><ul><li><strong>Frontend:</strong> This network is for services that run behind my reverse proxy and require outside access (outside means outside of the server running docker).</li><li><strong>Backend:</strong> This network is for services that solely support other services and don&#39;t need outside access.</li></ul><p><strong>Container Privileges:</strong> I specify that the container cannot have additional privileges, which enhances security.</p><p><strong>Bind Mount (Volume Path):</strong> I follow a specific structure for the bind mount (volume path). It starts with a folder named after the main service and then includes a subfolder named after the supporting service. This organization makes it easy to remove a specific configuration if I decide to discard something I&#39;ve experimented with.</p><p><strong>Redis Configuration:</strong> Specific to Redis, I set an environment variable that instructs it to save its state to disk every 60 seconds or after 10 write operations. This ensures data durability.</p><p>If you&#39;re wondering why there&#39;s no port setting, it&#39;s because we&#39;re working within a Docker network. We can access the container ports without explicitly defining them here. The port definition creates a port mapping between the container and the host machine/VM.</p><div data-kg-toggle-state="close"><div><h4>Warning: Ports ignore firewall rules</h4></div><p>It&#39;s worth noting that the default Docker network (bridge network) isn&#39;t affected by rules from an iptables-based firewall. I&#39;ll dive deeper into this in an upcoming article about securing your Docker setup.</p></div><h2 id="postgresql-container">PostgreSQL Container</h2><p>When it comes to databases in my self-hosting setup, I&#39;m a fan of PostgreSQL. It&#39;s my preferred choice. In the case of Paperless-ngx, it defaults to PostgreSQL, but you do have the option to run MariaDB if that&#39;s your preference. I personally also always deploy a DB per service and do not reuse the same DB twice.</p><p>Let&#39;s have a look at the docker compose of the database.</p><pre><code>paperless-postgres:
  container_name: paperless-postgres
  image: postgres:16.0-alpine #fixedVersion
  restart: unless-stopped
  networks:
    - backend
  security_opt:
    - no-new-privileges:true
  volumes:
    - ./paperless/postgres:/var/lib/postgresql/data
  environment:
    POSTGRES_USER: DBUSERNAME
    POSTGRES_DB: DBNAME
    POSTGRES_PASSWORD_FILE: /run/secrets/paperless_db_paperless_passwd
    #POSTGRES_PASSWORD: $PasswordFromEnvFile
  secrets:
    - paperless_db_paperless_passwd</code></pre><p>I prefer to use a docker secret for the password if the image supports it. I&#39;ve also included a commented-out line for providing the password via a .env file if you prefer that method.</p><p>Since I&#39;m using a secret, I need to map it appropriately. I&#39;ll be covering the use of secrets in a future article about securing your Docker environment. Stay tuned for that!</p><h2 id="paperless-ngx-container">Paperless-ngx Container</h2><p>Finally, let&#39;s get to the main reason you&#39;re here: the Docker Compose configuration for my Paperless-ngx container.</p><pre><code>paperless:
  container_name: paperless
  image: ghcr.io/paperless-ngx/paperless-ngx:latest
  restart: unless-stopped
  networks:
    - frontend
    - backend
  ports:
    - 8000:8000
  security_opt:
    - no-new-privileges:true
  depends_on:
    - paperless-redis
    - paperless-postgres
  volumes:
    - ./paperless/paperless:/usr/src/paperless/data # Docker container data
    - ./paperless/paperless:/usr/src/paperless/media # Location of your documents
    - ./paperless/paperless:/usr/src/paperless/export # Target for backups
    - ./paperless/paperless:/usr/src/paperless/consume # Watch folder
  environment:
    USERMAP_UID: $PUID
    USERMAP_GID: $PGID
    PAPERLESS_TIME_ZONE: $TZ
    PAPERLESS_OCR_LANGUAGE: deu+eng
    PAPERLESS_REDIS: redis://paperless-redis:6379
    PAPERLESS_DBHOST: paperless-postgres
    PAPERLESS_DBNAME: DBNAME
    PAPERLESS_DBUSER: DBUSERNAME
    PAPERLESS_DBPASS_FILE: /run/secrets/paperless_db_paperless_passwd
    #PAPERLESS_DBPASS: $PAPERLESS_DBPASS
    PAPERLESS_SECRET_KEY_FILE: /run/secrets/paperless_secret_key
    #PAPERLESS_SECRET_KEY: $PAPERLESS_SECRET_KEY
    PAPERLESS_FILENAME_FORMAT: &#34;{created_year}/{correspondent}/{created} {title}&#34;
    PAPERLESS_URL: &#34;&lt;YOUR PAPERLESS URL&gt;&#34;
    PAPERLESS_ALLOWED_HOSTS: PAPERLESS_URL
    # Set the following two for your first launch
    # and change the admin password afterwards.
    # Once setup, you can safely remove these variables.
    PAPERLESS_ADMIN_USER: &#34;&lt;ADMIN_USER&gt;&#34;
    PAPERLESS_ADMIN_PASSWORD: &#34;&lt;ADMIN_PASSWORD&gt;&#34;</code></pre><p>Let&#39;s take a closer look at some of the specific details in the Docker Compose configuration:</p><p><strong>Networks:</strong> We join both networks because we want Paperless to communicate with the reverse proxy (not setup or covered in this article) and other services on the backend network.</p><p><strong>Ports:</strong> To access Paperless from other devices on your local network, we create a port mapping, which would not be needed when using a reverse proxy.</p><p><strong>Depends On:</strong> This ensures that the specified containers are running before starting Paperless.</p><p><strong>Volumes:</strong> We use volumes for data persistence, including our documents and Paperless configuration. I usually use NFS mounts for media, export, and consume which go straight to my NAS. For simplicity, bind mounts are used here.</p><h3 id="environment-variables">Environment Variables</h3><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#USERMAP_UID">USERMAP_UID</a> &amp; <a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#USERMAP_GID">USERMAP_GID</a>:</strong> It&#39;s a good practice to set these to the IDs of your personal user on the Docker host system. This helps avoid permission issues when editing config files or accessing PDFs on the file system.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_OCR_LANGUAGES">PAPERLESS_OCR_LANGUAGES</a>:</strong> Set this to the languages you expect your documents to be in.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_REDIS">PAPERLESS_REDIS</a>:</strong> Specify the path to your Redis container.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#database">PAPERLESS_DB</a>*:</strong> Configuration details to access your deployed database.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_SECRET_KEY">PAPERLESS_SECRET_KEY</a>:</strong> It&#39;s essential to set this to enhance security. The default token is well-known, so changing it is recommended.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_FILENAME_FORMAT">PAPERLESS_FILENAME_FORMAT</a>:</strong> This determines the folder structure and filename of the PDFs stored in &#39;media&#39;. You can customize it using various variables. I use a folder for the year created, followed by the correspondent, and then the filename as the creation date with the title from Paperless.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_URL">PAPERLESS_URL</a>:</strong> Set it to your domain name or the URL, including the port you&#39;ll use to access Paperless.</p><p><strong><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_ALLOWED_HOSTS">PAPERLESS_ALLOWED_HOSTS</a>:</strong> This setting restricts access to Paperless only from the addresses you specify.</p><p><a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_ADMIN_USER">PAPERLESS_ADMIN_USER</a> &amp; <a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com#PAPERLESS_ADMIN_PASSWORD">PAPERLESS_ADMIN_PASSWORD</a>: Set these two before your first startup, and once you have logged in and changed the password, you can remove the variables. They are only needed to create the initial admin user. Otherwise, you can run the command &#39;createsuperuser,&#39; but I prefer the above variables</p><p>These are the configuration settings I&#39;ve opted for, but there are many more options to explore. I recommend checking out the well-written <a href="https://docs.paperless-ngx.com/configuration/?ref=nerdyarticles.com">Paperless-ngx documentation</a> to tailor the setup to your needs. It&#39;s a valuable resource for fine-tuning your self-hosted document management system.</p><h2 id="data-safety-101-the-power-of-regular-backups">Data Safety 101: The Power of Regular Backups</h2><p>A helpful Redditor reminded me that I hadn&#39;t covered backups. Can you blame me? My backup system is so smooth that I rarely think about it (will be covered in the future). However, let&#39;s dive into the specifics of backing up Paperless.</p><p>Since we&#39;re running everything in Docker and have the export path mounted, we can easily use Paperless&#39;s built-in backup solution. To automate this, we&#39;ll add a specific command to a crontab job (under root user) on our Docker host machine. Personally, I like to create a shell script and launch it from the crontab. This approach allows me to make changes to the command without editing the crontab directly, but you can also insert the command directly into the crontab if you prefer.</p><p>The command I am adding to my &#39;paperless_backup.sh&#39; shell script:</p><pre><code>docker exec -it paperless document_exporter ../export -d -f -p -sm -z</code></pre><p>You can find the documentation of the backup command <a href="https://docs.paperless-ngx.com/administration/?ref=nerdyarticles.com#exporter">here</a>. But in short:</p><p>-d: will delete old backups</p><p>Now, let&#39;s add this to the crontab. We need to include it in the root&#39;s crontab because our normal user doesn&#39;t have the access rights to run Docker commands without &#39;sudo,&#39; and using &#39;sudo&#39; won&#39;t work in a crontab due to the password prompt.</p><pre><code>sudo crontab -e</code></pre><p>I&#39;m scheduling it to run at 4 am because at 3am my hypervisor backes up and my off-site backup starts at 5 am. This way, it includes the backup of Paperless and moves it to my off-site location. The backup itself only takes a couple of minutes for me, so there&#39;s no risk of overlapping with the off-site backup process.</p><p>Instead of adding the &#39;sh &#39; to the crontab, you could also directly add the command from the shell script in here.</p><pre><code>0 4 * * * sh /server/docker/scripts/paperless_backup.sh</code></pre><div data-kg-toggle-state="close"><div><h4>Warning: Supposed to stop Paperless before backup</h4></div><div><p>According to the documentation, we should stop Paperless before running the backup. However, since we&#39;re running it in Docker, we can&#39;t stop the container as we need it for the backup command.</p><p>One of the maintainers wrote, everything <strong>should </strong>run fine as an online backup. There are measures in place to prevent issues when a backup runs while files are being uploaded. <a href="https://github.com/paperless-ngx/paperless-ngx/discussions/3852?ref=nerdyarticles.com">Check the GitHub discussion</a></p></div></div><h2 id="paperless-ngx-in-docker-the-full-stack">Paperless-ngx in Docker: The Full Stack</h2><figure><pre><code>version: &#34;3.9&#34;

networks:
  frontend:
    name: frontend
    driver: bridge
  backend:
    name: backend
    driver: bridge
  default:
    name: default
    driver: bridge

secrets:
  paperless_db_paperless_passwd:
    file: ./secrets/paperless_db_paperless_passwd
  paperless_secret_key:
    file: ./secrets/paperless_secret_key

services:
  paperless:
    container_name: paperless
    image: ghcr.io/paperless-ngx/paperless-ngx:latest
    restart: unless-stopped
    networks:
      - frontend
      - backend
    ports:
      - 8000:8000
    security_opt:
      - no-new-privileges:true
    depends_on:
      - paperless-redis
      - paperless-postgres
    volumes:
      - ./paperless/paperless:/usr/src/paperless/data # Docker container data
      - ./paperless/paperless:/usr/src/paperless/media # Location of your documents
      - ./paperless/paperless:/usr/src/paperless/export # Target for backups
      - ./paperless/paperless:/usr/src/paperless/consume # Watch folder
    environment:
      USERMAP_UID: $PUID
      USERMAP_GID: $PGID
      PAPERLESS_TIME_ZONE: $TZ
      PAPERLESS_OCR_LANGUAGE: deu+eng
      PAPERLESS_ENABLE_UPDATE_CHECK: &#34;true&#34;
      PAPERLESS_REDIS: redis://paperless-redis:6379
      PAPERLESS_DBHOST: paperless-postgres
      PAPERLESS_DBNAME: DBNAME
      PAPERLESS_DBUSER: DBUSERNAME
      PAPERLESS_DBPASS_FILE: /run/secrets/paperless_db_paperless_passwd
      #PAPERLESS_DBPASS: $PAPERLESS_DBPASS
      PAPERLESS_SECRET_KEY_FILE: /run/secrets/paperless_secret_key
      #PAPERLESS_SECRET_KEY: $PAPERLESS_SECRET_KEY
      PAPERLESS_FILENAME_FORMAT: &#34;{created_year}/{correspondent}/{created} {title}&#34;
      PAPERLESS_URL: &#34;&lt;YOUR PAPERLESS URL&gt;&#34;
      PAPERLESS_ALLOWED_HOSTS: PAPERLESS_URL
	  # Set the following two for your first launch
	  # and change the admin password afterwards.
	  # Once setup, you can safely remove these variables.
	  PAPERLESS_ADMIN_USER: &#34;&lt;ADMIN_USER&gt;&#34;
      PAPERLESS_ADMIN_PASSWORD: &#34;&lt;ADMIN_PASSWORD&gt;&#34;
    secrets:
      - paperless_db_paperless_passwd
      - paperless_secret_key
  
  paperless-postgres:
    container_name: paperless-postgres
    image: postgres:16.0-alpine #fixedVersion
    restart: unless-stopped
    networks:
      - backend
    security_opt:
      - no-new-privileges:true
    volumes:
      - ./paperless/postgres:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: DBUSERNAME
      POSTGRES_DB: DBNAME
      POSTGRES_PASSWORD_FILE: /run/secrets/paperless_db_paperless_passwd
      #POSTGRES_PASSWORD: $PasswordFromEnvFile
    secrets:
      - paperless_db_paperless_passwd
  
  paperless-redis:
    container_name: paperless-redis
    image: redis:7.2-alpine #fixedVersion
    restart: unless-stopped
    networks:
      - backend
    security_opt:
      - no-new-privileges:true
    volumes:
      - ./paperless/redis:/data
    environment:
      REDIS_ARGS: &#34;--save 60 10&#34;</code></pre><figcaption>Full Docker Compose Stack for Paperless-ngx</figcaption></figure><p>Whew, that was quite a journey! We delved into Paperless-ngx, discovered the wonders of digital tagging over paper folders, and I spilled the beans on my battle-tested setup that&#39;s served me well for years. Our docker-compose adventure unfolded, providing you with the full recipe to kickstart your own paperless journey (if you have a running docker environment).</p><p>As for alternatives, I&#39;ve been so content with Paperless that I&#39;ve lost track of what&#39;s out there today. I can only vouch for the solution I know and love, but who knows what other gems might be waiting in the wings?</p><p>Farewell for now, fellow self-hosters. Keep the servers humming and the data flowing! Until next time, happy self-hosting.</p><p><em>Henning</em></p>
    </section></div>
  </body>
</html>
