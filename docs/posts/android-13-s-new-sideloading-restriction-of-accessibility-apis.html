<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.esper.io/android-13-sideloading-restriction-harder-malware-abuse-accessibility-apis/">Original</a>
    <h1>Android 13’s new sideloading restriction of Accessibility APIs</h1>
    
    <div id="readability-page-1" class="page"><div>
									
									<p>Android’s Accessibility API is an incredibly powerful tool intended for developers to build apps for users with disabilities. The API lets apps read the contents of the screen and perform inputs on behalf of the user, which are essential functions for screen readers and alternative input systems. Unfortunately, these functions are also incredibly useful for malicious apps that want to steal data from users, which is why Google has been cracking down on which apps are allowed to use the Accessibility API. Google has already limited which apps on Google Play can use the Accessibility API, and <a href="https://www.blog.esper.io/android-13-deep-dive/" target="_blank" rel="noreferrer noopener">in Android 13</a>, they’re taking things one step further by heavily restricting API access for apps that the user has sideloaded from outside of an app store.</p>



<h2 id="androids-accessibility-api-a-history-of-open-misuse">Android’s Accessibility API: A history of open (mis)use</h2>



<p>In order to explain what’s changing, it’s important to understand how Android’s Accessibility APIs are currently being used. Google encourages app developers to <a href="https://developer.android.com/guide/topics/ui/accessibility" target="_blank" rel="noreferrer noopener">build apps with accessibility in mind</a>, which is not the same as saying they need to use Android’s Accessibility APIs. Developers can design their apps to be more accessible to users with disabilities without the need for special APIs, but they can only improve the accessibility of their own apps. To help users with disabilities interact with other apps, developers must create what’s called an accessibility service.</p>



<p>An <a href="https://developer.android.com/reference/android/accessibilityservice/AccessibilityService" target="_blank" rel="noreferrer noopener">accessibility service</a> is a privileged background service that receives information from the system about <a href="https://developer.android.com/reference/android/view/accessibility/AccessibilityEvent" target="_blank" rel="noreferrer noopener">certain events</a>, such as when a button has been clicked or a view has been focused. Apps can react to these events to provide different features, such as audible feedback or an alternative way to send an input. For example, a screen reader like <a href="https://support.google.com/accessibility/android/answer/6007100" target="_blank" rel="noreferrer noopener">TalkBack</a> can read the contents of a dialog on behalf of visually impaired or blind users, while something like <a href="https://support.google.com/accessibility/android/answer/6301490" target="_blank" rel="noreferrer noopener">Switch Access</a> can press “yes” or “no” on behalf of users with mobility limitations.</p>



<p>Because of the powerful nature of this API, Android requires the user to manually enable accessibility services through an interface in Settings &gt; Accessibility. Before enabling the service, users <a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/res/res/values/strings.xml;l=4687?q=%22to%20have%20full%20control%20of%22" target="_blank" rel="noreferrer noopener">are warned</a> that they will be granting the application “full control” of their device, including the ability to “view and control [the] screen” and “view and perform actions” on their behalf.</p>


<div>
<figure><img src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-disclosure.png?fit=598%2C1296&amp;ssl=1" alt="Warning shown before user enables an accessibility service" width="299" height="648" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-disclosure.png?w=598&amp;ssl=1 598w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-disclosure.png?resize=53%2C115&amp;ssl=1 53w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-disclosure.png?resize=231%2C500&amp;ssl=1 231w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-disclosure.png?resize=540%2C1170&amp;ssl=1 540w" data-lazy-sizes="(max-width: 299px) 100vw, 299px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-disclosure.png?fit=598%2C1296&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/><figcaption><em>The warning that users are shown before enabling an accessibility service.</em></figcaption></figure></div>


<p>Apps can optionally provide an explanation for what their accessibility service will be used for, but there’s no guarantee that the service will be used in the manner described by the developer. Malware authors take advantage of this to trick the user into enabling an accessibility service. Several infamous phishing and banking trojan campaigns have taken advantage of Android’s Accessibility API to steal data from users. <a href="https://www.prodaft.com/m/reports/FluBot_4.pdf" target="_blank" rel="noreferrer noopener">FluBot</a>, for example, <a href="https://twitter.com/LukasStefanko/status/1373212991903125506" target="_blank" rel="noreferrer noopener">texted users</a> a link to an app that impersonated FedEx. After installing the app and enabling its accessibility service, FluBot would collect personal information and attack mobile banking apps. Other trojans, like <a href="https://blog.fox-it.com/2022/03/03/sharkbot-a-new-generation-android-banking-trojan-being-distributed-on-google-play-store/" target="_blank" rel="noreferrer noopener">SharkBot</a>, <a href="https://www.threatfabric.com/blogs/xenomorph-a-newly-hatched-banking-trojan.html" target="_blank" rel="noreferrer noopener">Xenomorph</a>, <a href="https://www.bleepingcomputer.com/news/security/bianlian-android-banking-trojan-upgraded-with-screen-recorder/" target="_blank" rel="noreferrer noopener">BianLian</a>, <a href="https://www.threatfabric.com/blogs/sova-new-trojan-with-fowl-intentions.html" target="_blank" rel="noreferrer noopener">S.O.V.A</a>, <a href="https://research.checkpoint.com/2021/pixstealer-a-new-wave-of-android-banking-trojans-abusing-accessibility-services/" target="_blank" rel="noreferrer noopener">PixStealer</a>, <a href="https://www.threatfabric.com/blogs/vultur-v-for-vnc.html" target="_blank" rel="noreferrer noopener">Vultur</a>, and <a href="https://twitter.com/LukasStefanko/status/1498958659174514691" target="_blank" rel="noreferrer noopener">TeaBot</a>, also misuse Android’s Accessibility API.</p>



<p><a href="https://twitter.com/linuxct" target="_blank" rel="noreferrer noopener">Sergio Castell</a>, mobile security analyst at <a href="https://www.riscure.com/" target="_blank" rel="noreferrer noopener"><em>Riscure</em></a>, explains why Android’s Accessibility API is a favorite among malware authors:</p>



<blockquote><p>Why does malware rely on accessibility services?</p><p>There are plenty of different kinds of malware for Android out there. But, if we focus on the ones that are crafted to steal your personal data, such as your banking credentials, crypto wallets, social media logins, etc., we find that most of them require using some sort of accessibility permissions. The reasons why they need those are:</p><p>1. In order to read the device’s screen. Certain pieces of malware abuse accessibility services in order to determine whether certain text is being displayed on the screen, using a technique similar to the one used by screen readers to read text aloud. In this case, the malware may target your banking apps, your crypto wallets, or your social media apps and, if the malware detects they are being displayed on screen, the malware is then able to impersonate the application by either injecting a fake login form through a screen overlay or by switching to some activity present inside the malware’s code. The injected form would resemble the appearance of the application it tries to impersonate, in order to lure the user into believing it’s the real application being shown. Many times the switch between the real and the fake application is almost imperceptible.</p><p>2. In order to prevent the malware from being removed, and in order to impersonate the user (by generating clicks on the screen). The malware also abuses accessibility services in order to produce fake “touches” on the screen and fake button presses, such as the home key. Many pieces of malware do this in order to prevent the user from removing the application that contains the malware, as a defense mechanism. In some cases, this might also be used to install other applications (other malware or unwanted applications) or perform actions without the user’s consent, like disabling Google Play Protect, enabling additional permissions for the malware, and changing the default application for calls, messages, etc. </p><p>Up until now, the only way to mitigate these kinds of infections is through commercial antivirus services, with Google Play Protect, or by enabling Android’s Safe Mode, which disables all applications except the ones that come preinstalled with the device, and which would allow the user to remove the infected application.</p><cite>Sergio Castell, mobile security analyst at Riscure</cite></blockquote>



<p>Google has not been oblivious to these threats. Over the years, they have attempted to crack down on apps misusing the Accessibility API.</p>



<h2 id="cracking-down-on-the-accessibility-api">Cracking down on the Accessibility API</h2>



<p>In late 2017, Google <a href="https://www.xda-developers.com/google-threatening-removal-accessibility-services-play-store/" target="_blank" rel="noreferrer noopener">sent an email to developers</a> informing them that if their app uses an accessibility service for any reason other than assisting users with disabilities, then they must remove this functionality or face their app’s removal from the Play Store. Google quietly <a href="https://www.engadget.com/2017-12-08-google-pauses-crackdown-apps-accessibility-features.html" target="_blank" rel="noreferrer noopener">backed off</a> on this threat following backlash from developers, because the policy change would have forced many developers to strip legitimately useful features from their apps. Instead, the company encouraged developers to use <a href="https://developer.android.com/guide/topics/text/autofill" target="_blank" rel="noreferrer noopener">Android’s purpose-built APIs</a> in lieu of Accessibility, wherever possible.</p>



<p>Google’s strategy changed in 2021, however. In order to reduce the unnecessary and potentially dangerous uses of Accessibility while preserving legitimate uses, Google updated its app store policy with <a href="https://support.google.com/googleplay/android-developer/answer/10964491" target="_blank" rel="noreferrer noopener">a new set of requirements</a> for apps that wish to use the APIs. Developers whose apps target Android 12 or later and use the Accessibility API for non-accessibility reasons must complete an extensive permission declaration form and receive approval from Google Play. They must also prominently disclose within their app why they need to access the Accessibility APIs. Finally, they have to require affirmative action from the user to enable the service (before they even get to Android’s built-in dialog). These requirements can be bypassed by apps declaring that they’re <a href="https://developer.android.com/reference/android/accessibilityservice/AccessibilityServiceInfo#isAccessibilityTool()" target="_blank" rel="noreferrer noopener">an accessibility tool</a>, which is only allowed for apps that are actually designed to assist users with disabilities.</p>



<p>Google also quietly introduced a new feature in Android 12 to warn users about accessibility services they’ve kept enabled. Once in a while, Android <a href="https://forum.xda-developers.com/t/check-access-settings-accessibility-usage-notifications.4368455/" target="_blank" rel="noreferrer noopener">will surface</a> a notification titled “check access settings” that reminds the user about accessibility services they’ve enabled. This notification is <a href="https://cs.android.com/android/_/android/platform/frameworks/base/+/b98a658c27725fc0dd74a7e302a90dfc95f867f8" target="_blank" rel="noreferrer noopener">shown 24 hours</a> after the user enables an accessibility service that <a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/accessibility/java/com/android/server/accessibility/AccessibilitySecurityPolicy.java;l=673?q=%22install%20source%22" target="_blank" rel="noreferrer noopener">hasn’t been</a> declared an accessibility tool and wasn’t installed from a trusted install source. In other words, Android only trusts apps that are legitimate accessibility tools as verified by a trusted app store.</p>


<div>
<figure><img loading="lazy" src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-12-Check-Access-Settings.png?fit=598%2C1296&amp;ssl=1" alt="Check access settings notification in Android 12 for accessibility services" width="299" height="648" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-12-Check-Access-Settings.png?w=598&amp;ssl=1 598w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-12-Check-Access-Settings.png?resize=53%2C115&amp;ssl=1 53w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-12-Check-Access-Settings.png?resize=231%2C500&amp;ssl=1 231w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-12-Check-Access-Settings.png?resize=540%2C1170&amp;ssl=1 540w" data-lazy-sizes="(max-width: 299px) 100vw, 299px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-12-Check-Access-Settings.png?fit=598%2C1296&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/><figcaption><em>Android 12 introduced a system-level warning that tells the user about accessibility services they’ve kept enabled.</em></figcaption></figure></div>


<figure><img loading="lazy" src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Trusted-install-source-for-accessibility-service.png?resize=840%2C41&amp;ssl=1" alt="Google Play is a trusted install source for accessibility services" width="840" height="41" data-recalc-dims="1" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Trusted-install-source-for-accessibility-service.png?w=872&amp;ssl=1 872w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Trusted-install-source-for-accessibility-service.png?resize=300%2C15&amp;ssl=1 300w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Trusted-install-source-for-accessibility-service.png?resize=768%2C38&amp;ssl=1 768w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Trusted-install-source-for-accessibility-service.png?resize=585%2C29&amp;ssl=1 585w" data-lazy-sizes="(max-width: 840px) 100vw, 840px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Trusted-install-source-for-accessibility-service.png?resize=840%2C41&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/><figcaption><em>On GMS devices, the Google Play Store is considered a trusted install source of apps declaring an accessibility service.</em></figcaption></figure><p>However, a warning that’s shown 24 hours after the user has already enabled the accessibility service may not protect users from malicious apps that act quickly. This is partly why Android 13 places further restrictions on the use of the Accessibility API.</p>



<h2 id="android-13s-restricted-access-to-accessibility-services">Android 13’s restricted access to accessibility services</h2>



<p>When the user sideloads an app that has an accessibility service on Android 13, the system may block the user from enabling the accessibility service. If this restriction is applied, the service’s state will be grayed out in settings, and a dialog will appear when tapping the service that says “for your security, this setting is currently unavailable.”</p>



<figure><figure><img loading="lazy" width="598" height="1296" data-id="8302" src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-page.png?fit=598%2C1296&amp;ssl=1" alt="Accessibility service page in Android 13" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-page.png?w=598&amp;ssl=1 598w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-page.png?resize=53%2C115&amp;ssl=1 53w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-page.png?resize=231%2C500&amp;ssl=1 231w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-page.png?resize=540%2C1170&amp;ssl=1 540w" data-lazy-sizes="(max-width: 598px) 100vw, 598px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Accessibility-Service-page.png?fit=598%2C1296&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure><figure><img loading="lazy" width="598" height="1296" data-id="8303" src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Restricted-Settings-dialog.png?fit=598%2C1296&amp;ssl=1" alt="Restricted setting dialog in Android 13" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Restricted-Settings-dialog.png?w=598&amp;ssl=1 598w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Restricted-Settings-dialog.png?resize=53%2C115&amp;ssl=1 53w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Restricted-Settings-dialog.png?resize=231%2C500&amp;ssl=1 231w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Restricted-Settings-dialog.png?resize=540%2C1170&amp;ssl=1 540w" data-lazy-sizes="(max-width: 598px) 100vw, 598px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Android-13-Restricted-Settings-dialog.png?fit=598%2C1296&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure><figcaption>Left: unrestricted access to an app’s accessibility service</figcaption></figure><p>Android 13 applies this restriction to all apps that are installed from a user-acquired APK file, ie. apps that were sideloaded from outside an app store. Google confirmed to <em>Esper</em> that this restriction was designed to not affect apps installed from app stores, both preloaded (like Google Play) or sideloaded (like F-Droid). This is because the company does not want to restrict accessibility API access for all apps that are sideloaded — they just want to restrict access for apps that came from less legitimate sources.</p>



<p>Android determines whether an app came from an app store during the installation process. When an app with an accessibility service is sideloaded by an app that uses the <a href="https://developer.android.com/reference/android/content/pm/PackageInstaller.Session" target="_blank" rel="noreferrer noopener">session-based package installation API</a>, this restriction does not apply and the user can enable the accessibility service. This is because this installation method is usually used by app stores to provide a more seamless experience.</p>



<p>When an app with an accessibility service is sideloaded by an app that uses the <em>non-session</em> package installation API, though, the restriction does apply and the user is blocked from enabling the app’s accessibility services. Many apps that let you download and open arbitrary files use this installation method, as it’s easier to simply hand off installation to the system Package Installer, which <a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/packages/PackageInstaller/AndroidManifest.xml;l=40?q=InstallStart" target="_blank" rel="noreferrer noopener">responds to intents</a> to view and install user-acquired APK files. Apps that are sideloaded via browsers, mail clients, and messaging apps usually use this method, hence they’ll be subjected to Android 13’s restrictions.</p>



<figure><p><span><iframe loading="lazy" width="640" height="360" src="https://www.youtube.com/embed/KvqvcmnE7mU?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en-US&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe></span>
</p></figure><p>Apps can use Android’s new <a href="https://developer.android.com/reference/android/content/pm/PackageInstaller.Session" target="_blank" rel="noreferrer noopener">setPackageSource() API</a> to tell the system that the app came from a user-acquired APK via the parameters PACKAGE_SOURCE_LOCAL_FILE or PACKAGE_SOURCE_DOWNLOADED_FILE. This can be used by apps implementing the session-based package installation API to trigger the same behavior when sideloading arbitrary APK files. For example, the Files by Google app uses the session-based API to install apps even though it isn’t an app store. In order to protect users, Files by Google could use the setPackageSource() API to tell the system Package Installer when apps come from user-acquired APKs, thus subjecting those apps to Android 13’s restrictions.</p>



<p>These restrictions are tied to a new permission in Android 13 called ACCESS_RESTRICTED_SETTINGS. This permission controls whether or not the user can enable an app’s accessibility service. When an app has been sideloaded using the non-session method, ACCESS_RESTRICTED_SETTINGS is first set to “deny”. After viewing the “restricted setting” dialog, ACCESS_RESTRICTED_SETTINGS is set to “ignore.” At this point, the user can go to the app info page for the app in question, tap the three-dot menu, and then tap “allow restricted settings” to unblock access to the accessibility service. The user will then be asked to authenticate themselves, and if they pass, ACCESS_RESTRICTED_SETTINGS will be set to “allow” for the app. The system does not tell the user they can do this, but this could change in future Android 13 builds.</p>



<figure><figure><img loading="lazy" width="598" height="1296" data-id="8316" src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Allow-restricted-settings-on-Android-13.png?fit=598%2C1296&amp;ssl=1" alt="" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Allow-restricted-settings-on-Android-13.png?w=598&amp;ssl=1 598w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Allow-restricted-settings-on-Android-13.png?resize=53%2C115&amp;ssl=1 53w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Allow-restricted-settings-on-Android-13.png?resize=231%2C500&amp;ssl=1 231w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Allow-restricted-settings-on-Android-13.png?resize=540%2C1170&amp;ssl=1 540w" data-lazy-sizes="(max-width: 598px) 100vw, 598px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Allow-restricted-settings-on-Android-13.png?fit=598%2C1296&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure><figure><img loading="lazy" width="598" height="1296" data-id="8317" src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Restricted-settings-allowed-on-Android-13.png?fit=598%2C1296&amp;ssl=1" alt="" data-lazy-srcset="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Restricted-settings-allowed-on-Android-13.png?w=598&amp;ssl=1 598w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Restricted-settings-allowed-on-Android-13.png?resize=53%2C115&amp;ssl=1 53w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Restricted-settings-allowed-on-Android-13.png?resize=231%2C500&amp;ssl=1 231w, https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Restricted-settings-allowed-on-Android-13.png?resize=540%2C1170&amp;ssl=1 540w" data-lazy-sizes="(max-width: 598px) 100vw, 598px" data-lazy-src="https://i0.wp.com/www.blog.esper.io/wp-content/uploads/2022/05/Restricted-settings-allowed-on-Android-13.png?fit=598%2C1296&amp;ssl=1&amp;is-pending-load=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></figure><figcaption>Left: the “allow restricted setting” option in the three-dot menu of the app info page, when ACCESS_RESTRICTED_SETTINGS is set to “ignore”</figcaption></figure><p>In addition, the ACCESS_RESTRICTED_SETTINGS permission only gates access to accessibility services, but it’s plausible that it could be used in the future to gate access to other sensitive APIs like the <a href="https://developer.android.com/reference/android/service/notification/NotificationListenerService" target="_blank" rel="noreferrer noopener">notification listener</a>.</p>



<p>In summary, this change affects two different groups of developers in two different ways. Developers who build apps with accessibility services will have to account for the scenario where the system blocks the services. Developers who build apps that use one of Android’s package installation APIs should use the new setPackageSource() API to tell the system where an app that’s being sideloaded came from. Google may provide guidance about this currently undocumented change at its upcoming I/O developer conference, so be sure to watch the event to learn about all the changes in the new OS release. Of course, we will also be documenting all of these changes in our <a href="https://www.blog.esper.io/android-13-deep-dive/" target="_blank" rel="noreferrer noopener">Android 13 deep dive</a>.</p>



<p><em>Hero image source: <a href="https://www.shutterstock.com/image-photo/september-4-2021-brazil-this-photo-2035714925" target="_blank" rel="noreferrer noopener">rafapress/Shutterstock.com</a></em></p>



<p><em>This article was updated at 1:30 PM PT following publication to note the method to unblock access to restricted settings and to differentiate between the behavior of the ACCESS_RESTRICTED_SETTINGS permission when in “ignore” and “deny” modes.</em></p>

																	</div></div>
  </body>
</html>
