<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.google/threat-analysis-group/spyware-vendors-use-0-days-and-n-days-against-popular-platforms/">Original</a>
    <h1>Spyware vendors use 0-days and n-days against Android, iOS and Chrome</h1>
    
    <div id="readability-page-1" class="page"><article ng-init="drawerToggle = {&#39;open&#39;: true}">

    
    

<section data-analytics-module="{
  &#34;module_name&#34;: &#34;Article Hero&#34;,
  &#34;section_header&#34;: &#34;Spyware vendors use 0-days and n-days against popular platforms&#34;
}">
  
</section>


    

    
      

<div data-analytics-module="{
    &#34;module_name&#34;: &#34;Article Metadata&#34;,
    &#34;section_header&#34;: &#34;undefined&#34;
  }">
  
  <div>
    <div>
      
        
  
    <div>
      
  

<div>
  <p>Clement Lecigne</p>
  
    <p>
      Threat Analysis Group
    </p>
  
  
</div>

    </div>
  


      
    </div>
    
  </div>
</div>

    

    
      

    

    
    <section>
      <div>
        
          
          
          <div data-reading-time="true" data-component="uni-drop-cap|uni-tombstone">
            
            
<!--article text-->

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><p data-block-key="bhk5e">Google’s Threat Analysis Group (TAG) tracks actors involved in information operations (IO), government backed attacks and financially motivated abuse. For years, TAG has been <a href="https://blog.google/threat-analysis-group/italian-spyware-vendor-targets-users-in-italy-and-kazakhstan/">tracking the activities</a> of commercial spyware vendors to protect users. Today, we actively track more than 30 vendors with varying levels of sophistication and public exposure selling exploits or surveillance capabilities to government backed actors. These vendors are enabling the proliferation of dangerous hacking tools, arming governments that would not be able to develop these capabilities in-house. While use of surveillance technologies may be legal under national or international laws, they are often found to be used by governments to target dissidents, journalists, human rights workers and opposition party politicians.</p><p data-block-key="50m50">In this blog, we’re sharing details about two distinct campaigns we’ve recently discovered which used various 0-day exploits against Android, iOS and Chrome and were both limited and highly targeted. The 0-day exploits were used alongside n-day exploits and took advantage of the large time gap between the fix release and when it was fully deployed on end-user devices. Our findings underscore the extent to which commercial surveillance vendors have proliferated capabilities historically only used by governments with the technical expertise to develop and operationalize exploits.</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <p><h3 data-block-key="bhk5e">Campaign #1 - Your missed parcel included 0-days (CVE-2022-42856; CVE-2022-4135)</h3></p>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <p data-block-key="bhk5e">In November 2022, TAG discovered exploit chains with 0-days affecting Android and iOS that were delivered via bit.ly links sent over SMS to users located in Italy, Malaysia and Kazakhstan. When clicked, the links redirected visitors to pages hosting exploits for either Android or iOS then redirected them to legitimate websites such as the page to track shipments for Italian-based shipment and logistics company BRT or a popular Malaysian news website.</p>
      </div>
    </div>
  

  
    







  
      <div>
  

  <p><img alt="Image of a screenshot from one of the malicious websites" src=" https://storage.googleapis.com/gweb-uniblog-publish-prod/images/AwHaueEugCtSxrk.width-100.format-webp.webp " loading="lazy" data-loading="{
                &#34;mobile&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/AwHaueEugCtSxrk.width-500.format-webp.webp&#34;,
                &#34;desktop&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/AwHaueEugCtSxrk.width-1000.format-webp.webp&#34;
              }"/>
        
      
    
    </p>
    
      <figcaption><p data-block-key="0g20w">An example screenshot from one of the malicious websites</p></figcaption>
    
  
    </div>
  



  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><p data-block-key="bhk5e"><b>iOS Exploit Chain</b></p><p data-block-key="631ti">The iOS exploit chain targeted versions prior to 15.1 and contained the following exploits, including one 0-day:</p><ul><li data-block-key="998om"><a href="https://support.apple.com/en-gb/HT213597">CVE-2022-42856</a>, a WebKit remote code execution exploiting a type confusion issue within the JIT compiler (0-day at time of exploitation).</li><li data-block-key="dlkp1">The exploit used a PAC bypass technique which was <a href="https://bugs.webkit.org/show_bug.cgi?id=237867">fixed</a> in March 2022 when Apple removed DYLD_INTERPOSE from WebKit. The exact same technique was used in Cytrox exploits as described by Citizenlab in their <a href="https://citizenlab.ca/2021/12/pegasus-vs-predator-dissidents-doubly-infected-iphone-reveals-cytrox-mercenary-spyware/">blog</a> about Predator. The “make_bogus_transform” function is part of the PAC bypass and is present in both exploits.</li></ul></div>
      </div>
    </div>
  

  
    







  
      <div>
  

  <p><img alt="Extract from CitizenLab report mentioning the “make_bogus_transform” function" src=" https://storage.googleapis.com/gweb-uniblog-publish-prod/images/8voTt9Y9qSfGMGk.width-100.format-webp.webp " loading="lazy" data-loading="{
                &#34;mobile&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/8voTt9Y9qSfGMGk.width-500.format-webp.webp&#34;,
                &#34;desktop&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/8voTt9Y9qSfGMGk.width-1000.format-webp.webp&#34;
              }"/>
        
      
    
    </p>
    
      <figcaption><p data-block-key="n9azr">Extract from CitizenLab report mentioning the “make_bogus_transform” function</p></figcaption>
    
  
    </div>
  



  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><ul><li data-block-key="3py4i"><a href="https://support.apple.com/en-us/HT212872">CVE-2021-30900</a>, a sandbox escape and privilege escalation bug in AGXAccelerator, fixed by Apple in 15.1. The bug was previously described in an <a href="https://github.com/singi/oob_timestamp">exploit</a> for oob_timestamp published on Github in 2020.</li></ul></div>
      </div>
    </div>
  

  
    







  
      <div>
  

  <p><img alt="screenshot of code" src=" https://storage.googleapis.com/gweb-uniblog-publish-prod/images/849UNtSAjA7atQ7.width-100.format-webp.webp " loading="lazy" data-loading="{
                &#34;mobile&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/849UNtSAjA7atQ7.width-500.format-webp.webp&#34;,
                &#34;desktop&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/849UNtSAjA7atQ7.width-1000.format-webp.webp&#34;
              }"/>
        
      
    
    </p>
    
      <figcaption><p data-block-key="0g20w">Description of CVE-2021-30900 on an exploit for oob_timestamp (CVE-2020-3837)</p></figcaption>
    
  
    </div>
  



  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <p data-block-key="bhk5e">The final payload was a simple stager that pings back the GPS location of the device and gives the attacker the ability to install an .IPA file (iOS application archive) onto the affected device.</p>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><p data-block-key="bhk5e"><b>Android Exploit Chain</b></p><p data-block-key="brq8d">The Android exploit chain targeted users on phones with an ARM GPU running Chrome versions prior to 106. It consisted of three exploits, including one 0-day:</p><ul><li data-block-key="8gr0"><a href="https://chromereleases.googleblog.com/2022/10/stable-channel-update-for-desktop_27.html">CVE-2022-3723</a>, a type confusion vulnerability in Chrome, <a href="https://press.avast.com/en-us/avast-threat-report-consumers-plagued-with-refund-fraud-tech-support-scams-and-adware">found</a> by Avast in the wild and <a href="https://chromereleases.googleblog.com/2022/10/stable-channel-update-for-desktop_27.html">fixed</a> in October 2022 in version 107.0.5304.87.</li><li data-block-key="1c9kf"><a href="https://chromereleases.googleblog.com/2022/11/stable-channel-update-for-desktop_24.html">CVE-2022-4135</a>, a Chrome GPU sandbox bypass only affecting Android (0-day at time of exploitation), fixed in November 2022. Sergei Glazunov from Project Zero helped analyze the exploit and <a href="https://googleprojectzero.github.io/0days-in-the-wild//0day-RCAs/2022/CVE-2022-4135.html">wrote</a> a root cause analysis for this bug.</li><li data-block-key="nt6u"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-38181">CVE-2022-38181</a>, a privilege escalation bug <a href="https://developer.arm.com/Arm%20Security%20Center/Mali%20GPU%20Driver%20Vulnerabilities">fixed</a> by ARM in August 2022. It is unclear if attackers had an exploit for this vulnerability before it was reported to ARM.</li></ul><p data-block-key="4uum6">It’s worth noting users were redirected to Chrome using Intent Redirection if they were coming from a Samsung Internet Browser. In the past, we have seen attackers redirect users from Chrome to Samsung Internet Browser, similar to <a href="https://chromereleases.googleblog.com/2022/08/stable-channel-update-for-desktop_16.html">CVE-2022-2856</a>, but in this case the redirection occurred the other way. We were unable to obtain the final payload for this exploit chain.</p><p data-block-key="8sdjj">When ARM released a fix for CVE-2022-38181, patches were not immediately incorporated by vendors, resulting in the bugs exploitation. This was recently highlighted by blog posts from <a href="https://googleprojectzero.blogspot.com/2022/11/mind-the-gap.html">Project Zero</a> and <a href="https://github.blog/2023-01-23-pwning-the-all-google-phone-with-a-non-google-bug/">Github Security Lab</a>.</p><p data-block-key="b40n6">Note, Pixel devices with the 2023-01-05 security update are protected against both exploit chains in this blog. Chrome users updated to at least version 108.0.5359 are also protected.</p><p data-block-key="5fe9s"><b>Related IOCs</b></p><ul><li data-block-key="61vl">https://cdn.cutlink[.]site/p/uu6ekt - landing page</li><li data-block-key="472j6">https://api.cutlink[.]site/api/s/N0NBL8/ - Android exploit chain</li><li data-block-key="747sa">https://api.cutlink[.]site/api/s/3PU970/ - iOS exploit chain</li><li data-block-key="257qu">https://imjustarandomsite.3utilities[.]com - exploit delivery server</li></ul></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <p><h3 data-block-key="bhk5e">Campaign #2 - Complete exploit chain against Samsung Internet Browser (CVE-2022-4262; CVE-2023-0266)</h3></p>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><p data-block-key="bhk5e">In December 2022, TAG discovered a complete exploit chain consisting of multiple 0-days and n-days targeting the latest version of Samsung Internet Browser. The exploits were delivered in one-time links sent via SMS to devices located in the United Arab Emirates (UAE).</p><p data-block-key="bvnku">The link directed users to a landing page identical to the one TAG examined in the <a href="https://blog.google/threat-analysis-group/new-details-on-commercial-spyware-vendor-variston/">Heliconia framework</a> developed by commercial spyware vendor Variston. The exploit chain ultimately delivered a fully featured Android spyware suite written in C++ that includes libraries for decrypting and capturing data from various chat and browser applications. The actor using the exploit chain to target UAE users may be a customer or partner of Variston, or otherwise working closely with the spyware vendor.</p><p data-block-key="1orvt">The exploit chain TAG recovered was delivered to the latest version of Samsung’s Browser, which runs on Chromium 102 and does not include recent mitigations. If they had been in place, the attackers would have needed additional vulnerabilities to bypass the mitigations. The exploit chain consisted of multiple 0-days and n-days:</p><ul><li data-block-key="4fqlp"><a href="https://chromereleases.googleblog.com/2022/12/stable-channel-update-for-desktop.html">CVE-2022-4262</a>, a type confusion vulnerability in Chrome fixed in December 2022 (0-day at time of exploitation) - similar to <a href="https://github.blog/2022-06-29-the-chromium-super-inline-cache-type-confusion/">CVE-2022-1134</a>.</li><li data-block-key="fe2fp"><a href="https://chromereleases.googleblog.com/2022/08/stable-channel-update-for-desktop_30.html">CVE-2022-3038</a>, a sandbox escape in Chrome fixed in August 2022, in version 105 and <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1340253">found</a> by Sergei Glazunov in June 2022.</li><li data-block-key="7ulab"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-22706">CVE-2022-22706</a>, a vulnerability in Mali GPU Kernel Driver <a href="https://developer.arm.com/Arm%20Security%20Center/Mali%20GPU%20Driver%20Vulnerabilities">fixed</a> by ARM in January 2022 and marked as being used in the wild. At the time of delivery, the latest Samsung firmware had not included a fix for this vulnerability. This vulnerability grants the attacker system access.</li><li data-block-key="49j71"><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0266">CVE-2023-0266</a>, a race condition vulnerability in the Linux kernel sound subsystem reachable from the system user and that gives the attacker kernel read and write access (0-day at time of exploitation).</li></ul><p data-block-key="aqqcp">The exploit chain also took advantage of multiple kernel information leak 0-days when exploiting CVE-2022-22706 and CVE-2023-0266. Google reported these vulnerabilities to ARM and Samsung. CVE-2023-26083 was reserved for the information leak in Mali.</p><p data-block-key="eqrpn">Note, Samsung fixed CVE-2022-4262 and CVE-2022-3038 in Samsung’s Browser after version 19.0.6 released at the end of December 2022.</p><p data-block-key="34b4l"><b>Related IOCs</b></p><ul><li data-block-key="d6l42">www.sufficeconfigure[.]com - landing page and exploit delivery</li><li data-block-key="9lg7t">www.anglesyen[.]org - malware C2</li><li data-block-key="7ndre">The following Android system properties might indicate signs of exploitation<ul><li data-block-key="67t7p">sys.brand.note</li><li data-block-key="cuutt">sys.brand.notes</li><li data-block-key="aou5e">sys.brand.doc</li></ul></li><li data-block-key="3fsbc">The following directory on the phone might indicate signs of infection<ul><li data-block-key="ft4o8">/data/local/tmp/dropbox</li></ul></li></ul></div>
      </div>
    </div>
  

  
    
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><p data-block-key="bhk5e">To protect our users, Google has reported these vulnerabilities to the vendors. We would be remiss if we did not acknowledge the quick response and patching of these vulnerabilities by Google’s Chrome, Pixel and Android teams, as well as by Apple. We would also like to acknowledge and thank the Amnesty Security Lab for their help uncovering the second campaign detailed in this blog.</p><p data-block-key="bb97a">These campaigns continue to underscore the importance of patching, as users wouldn’t be impacted by these exploit chains if they were running a fully updated device. Intermediate mitigations like PAC, <a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit#">V8 sandbox</a> and <a href="https://docs.google.com/document/d/1pnnOAIz_DMWDI4oIOFoMAqLnf_MZ2GsrJNb_dbQ3ZBg/edit">MiraclePTR</a> have a real impact on exploit developers, as they would have needed additional bugs to bypass these mitigations.</p></div>
      </div>
    </div>
  

  
    
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;undefined&#34;
         }">
      <div data-component="uni-article-paragraph">
        <p data-block-key="bhk5e">These campaigns are a reminder that the commercial spyware industry continues to thrive. Even smaller surveillance vendors have access to 0-days, and vendors stockpiling and using 0-day vulnerabilities in secret pose a severe risk to the Internet. These campaigns may also indicate that exploits and techniques are being shared between surveillance vendors, enabling the proliferation of dangerous hacking tools. We remain committed to updating the community, and taking steps to protect users, as we uncover these campaigns.</p>
      </div>
    </div>
  


            
            

            
              




            
          </div>
        
      </div>
    </section>
  </article></div>
  </body>
</html>
