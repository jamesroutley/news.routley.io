<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://wiki.gentoo.org/wiki/OpenRC">Original</a>
    <h1>OpenRC is a dependency-based init system for Unix-like systems</h1>
    
    <div id="readability-page-1" class="page"><div id="mw-content-text" lang="en" dir="ltr"><div>
<div id="infobox-stack">
<p><b>Resources</b></p>







<p><b>Article status</b></p>
<p><span><span></span></span><span>This article has some todo items:</span></p>
</div>
<p><b>OpenRC</b> is a dependency-based <a href="https://en.wikipedia.org/wiki/Init" title="wikipedia:Init">init system</a> for Unix-like systems that maintains compatibility with the system-provided <a href="https://www.datadoodad.com/wiki/Init_system" title="Init system">init system</a>, normally located in <span>/sbin/init</span>. OpenRC is Gentoo&#39;s native init system, although <a href="https://www.datadoodad.com/wiki/Comparison_of_init_systems" title="Comparison of init systems">other init systems are available</a>.
</p><p>OpenRC will start necessary system services in the correct order at boot, manage them while the system is in use, and stop them at shutdown. It can manage daemons installed from the Gentoo repository, can optionally supervise the processes it launches, and has an the possibility to start processes in parallel - when possible - to shorten boot time.
</p><p>OpenRC was developed for Gentoo, but is designed to be used in <a href="https://www.datadoodad.com/wiki/OpenRC/Users" title="OpenRC/Users">other Linux distributions and BSD systems</a>. By default, OpenRC is invoked by <a href="https://www.datadoodad.com/wiki/Sysvinit" title="Sysvinit">sysvinit</a>, on Gentoo.
</p><p>Daemons installed from outside the Gentoo repository, e.g. software downloaded as source code and compiled manually, may sometimes need to be adapted to work with OpenRC (which is sometimes trivial).
</p>



<h2><span id="Implementation"><span id="Implementation"></span> Implementation</span></h2>
<p>OpenRC does not require large, fundamental, changes to the traditional Unix-like system. OpenRC integrates with other system software as a component of of a modular and flexible system. It is designed to be fast, lightweight, easily configurable, and adaptable. OpenRC has only a few basic dependencies, on core system components.
</p><p>As a modern init system, OpenRC provides a number of useful features:
</p>
<ul><li><a href="https://www.datadoodad.com/wiki/OpenRC/CGroups" title="OpenRC/CGroups">cgroups</a> support.</li>
<li>Process supervision.</li>
<li>Dependency-based launch, with parallel startup of services.</li>
<li>Automatic resolving, and ordering, of dependencies.</li>
<li>Hardware initiated initscripts.</li>
<li>Setting <var>ulimit</var> and <var>nice</var> values per service through the <var>rc_ulimit</var> variable.</li>
<li>Permits complex init scripts that start multiple components.</li>
<li>Modular architecture, fitting into existing infrastructure.</li>
<li>OpenRC has its own optional <a href="https://www.datadoodad.com/wiki/Init_system" title="Init system">init system</a> called <span>openrc-init</span>, see <a href="https://www.datadoodad.com/wiki/OpenRC/openrc-init" title="OpenRC/openrc-init">OpenRC/openrc-init</a> for details.</li>
<li>OpenRC has its own optional process supervisor, see <a href="https://www.datadoodad.com/wiki/OpenRC/supervise-daemon" title="OpenRC/supervise-daemon">OpenRC/supervise-daemon</a> for details.</li></ul>
<p>See the <a href="https://www.datadoodad.com/wiki/Comparison_of_init_systems" title="Comparison of init systems">comparison of init systems</a> article for more information on init systems.
</p>
<h2><span id="Installation"><span id="Installation"></span> Installation</span></h2>
<p>OpenRC generally does not need installing manually, and is provided as part of an OpenRC <a href="https://www.datadoodad.com/wiki/Profile_(Portage)" title="Profile (Portage)">profile</a> on <a href="https://www.datadoodad.com/wiki/Handbook:AMD64/Installation/Base#Choosing_the_right_profile" title="Handbook:AMD64/Installation/Base">installation</a>. It will be present in the <a href="https://www.datadoodad.com/wiki/Handbook:AMD64/Installation/Stage#OpenRC" title="Handbook:AMD64/Installation/Stage">stage 3 tarball</a>, and will be maintained across system updates.
</p>
<h3><span id="USE_flags"><span id="USE_flags"></span> USE flags</span></h3>
<div>
        <div>
          <h3>
            <span>USE flags for</span>
            <a href="https://packages.gentoo.org/packages/sys-apps/openrc">sys-apps/openrc</a>
            <small><span></span></small>
            <small>OpenRC manages the services, startup and shutdown of a host</small>
          </h3>
        </div>
        <div>
                <table>        <tbody><tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/audit">audit</a></code>
          </td>
          <td>
            Enable support for Linux audit subsystem using sys-process/audit
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/bash">bash</a></code>
          </td>
          <td>
            enable the use of bash in service scripts (experimental)
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/debug">debug</a></code>
          </td>
          <td>
            Enable extra debug codepaths, like asserts and extra output. If you want to get meaningful backtraces see https://wiki.gentoo.org/wiki/Project:Quality_Assurance/Backtraces
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/ncurses">ncurses</a></code>
          </td>
          <td>
            Add ncurses support (console display library)
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/netifrc">netifrc</a></code>
          </td>
          <td>
            enable Gentoo&#39;s network stack (net.* scripts)
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/newnet">newnet</a></code>
          </td>
          <td>
            enable the new network stack (experimental)
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/pam">pam</a></code>
          </td>
          <td>
            Add support for PAM (Pluggable Authentication Modules) - DANGEROUS to arbitrarily flip
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/selinux">selinux</a></code>
          </td>
          <td>
            !!internal use only!! Security Enhanced Linux support, this must be set by the selinux profile or breakage will occur
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/sysv-utils">sysv-utils</a></code>
          </td>
          <td>
            Install sysvinit compatibility scripts for halt, init, poweroff, reboot and shutdown
          </td>
        </tr>        <tr>
          <td>
            <code><a href="https://packages.gentoo.org/useflags/unicode">unicode</a></code>
          </td>
          <td>
            Add support for Unicode
          </td>
        </tr>      </tbody></table>
        </div>
        
      </div>
<p>If the USE flags are modified, the package may be rebuilt to apply changes. For OpenRC <a href="https://www.datadoodad.com/wiki/Profile_(Portage)" title="Profile (Portage)">profiles</a>, <a rel="nofollow" href="https://packages.gentoo.org/packages/sys-apps/openrc">sys-apps/openrc</a> is pulled in as a dependency of <a rel="nofollow" href="https://packages.gentoo.org/packages/virtual/service-manager">virtual/service-manager</a>, thus it should never be added to the <a href="https://www.datadoodad.com/wiki/Selected-packages_set_(Portage)" title="Selected-packages set (Portage)">selected-packages set</a> (<span>/var/lib/portage/world</span> file) - the <a href="https://www.datadoodad.com/wiki/Emerge#Do_not_add_dependencies_to_the_world_file" title="Emerge"><code>--oneshot</code> option</a> avoids adding OpenRC to this set.
</p>
<div><p><code>root <span>#</span></code><span></span><code>emerge --ask --oneshot sys-apps/openrc</code></p></div> 
<h2><span id="Configuration"><span id="Configuration"></span> Configuration</span></h2>
<h3><span id="Files"><span id="Files"></span> Files</span></h3>
<dl><dt><span>/etc/rc.conf</span></dt>
<dd>The global OpenRC configuration file.</dd>
<dd><b>Includes extensive comments documenting OpenRC configuration.</b></dd>
<dt><span>/etc/conf.d</span></dt>
<dd>Contains configuration files for individual initscripts.</dd></dl>
<h3><span id="Logging"><span id="Logging"></span> Logging</span></h3>
<p>OpenRC doesn&#39;t log anything by default. To log OpenRC&#39;s output during boot, uncomment and set the <var>rc_logger</var> option in <span>/etc/rc.conf</span>. The log will be saved at <span>/var/log/rc.log</span> by default.
</p>
<p><span>FILE</span> <strong><code>/etc/rc.conf</code></strong><strong></strong></p><pre><div dir="ltr"><pre><span></span><span>rc_logger</span><span>=</span><span>&#34;YES&#34;</span>
<span>#rc_log_path=&#34;/var/log/rc.log&#34;</span>
</pre></div></pre>
<h3><span id="Network_management"><span id="Network_management"></span> Network management</span></h3>
<p>OpenRC can be used with one of several network managers or even with none.  By default, with Gentoo&#39;s <a href="https://www.datadoodad.com/wiki/Profile_(Portage)" title="Profile (Portage)">OpenRC profiles</a>, <a href="https://www.datadoodad.com/wiki/Netifrc" title="Netifrc">netifrc</a> scripts are utilized to manage network connections.
</p><p>See the <a href="https://www.datadoodad.com/wiki/Network_manager" title="Network manager">Network manager</a> article for a list of options on network management.
</p>
<h3><span id="Dependency_behavior"><span id="Dependency_behavior"></span> Dependency behavior</span></h3>
<p>Changing the default dependencies of init scripts, might be needed to fit more complex setups. See <span>/etc/rc.conf</span> for how to change the default behavior; notice the <i>rc_depend_strict</i> option. In addition, next networking examples show how flexible OpenRC can be.
</p>
<dl><dt><i>Multiple network interfaces (example)</i></dt></dl>
<p>The <a href="https://www.datadoodad.com/wiki/SSH" title="SSH">SSH service</a> must come up with the internal network, for instance <i>eth0</i> and never <i>wlan0</i>.
</p><p>Overrule the &#34;net&#34; dependency from <span>/etc/init.d/sshd</span>, and refine it to depend on &#34;net.eth0&#34;:
</p>
<p><span>FILE</span> <strong><code>/etc/conf.d/sshd</code></strong><strong></strong></p><pre></pre>
<dl><dt><i>Multiple network interfaces in multiple runlevels (example)</i></dt></dl>
<p>The SSH service must start with <i>eth0</i> (not <i>wlan0</i>) in &#34;default&#34; runlevel, but in &#34;office&#34; runlevel it must start with <i>wlan0</i> (not <i>eth0</i>).
</p><p>Keep the default:
</p>
<p><span>FILE</span> <strong><code>/etc/rc.conf</code></strong><strong></strong></p><pre></pre>
<p>Make additional symlinks to <span>sshd</span> with the network interface names:
</p>
<div><p><code>root <span>#</span></code><span></span><code>ln -s sshd /etc/init.d/sshd.eth0
</code></p><p><code>root <span>#</span></code><span></span><code>ln -s sshd /etc/init.d/sshd.wlan0
</code></p></div>
<p>Settings are read from <span>/etc/conf.d/sshd.eth0</span> and <span>/etc/conf.d/sshd.wlan0</span> now:
</p>
<div><p><code>root <span>#</span></code><span></span><code>cp /etc/conf.d/sshd /etc/conf.d/sshd.eth0
</code></p><p><code>root <span>#</span></code><span></span><code>cp /etc/conf.d/sshd /etc/conf.d/sshd.wlan0
</code></p></div>
<p>Add the dependencies:
</p>
<div><p><code>root <span>#</span></code><span></span><code>echo &#39;rc_need=&#34;!net net.eth0&#34;&#39; &gt;&gt; /etc/conf.d/sshd.eth0
</code></p><p><code>root <span>#</span></code><span></span><code>echo &#39;rc_need=&#34;!net net.wlan0&#34;&#39; &gt;&gt; /etc/conf.d/sshd.wlan0
</code></p></div>
<p>In this example <i>net.eth0</i> and <i>net.wlan0</i> read their settings from <span>/etc/conf.d/net</span>, or <span>/etc/conf.d/net.office</span> depending on the active runlevel. Add all runscripts to the different runlevels:
</p>
<div><p><code>root <span>#</span></code><span></span><code>rc-update add sshd.eth0 default
</code></p><p><code>root <span>#</span></code><span></span><code>rc-update add sshd.wlan0 office
</code></p><p><code>root <span>#</span></code><span></span><code>rc-update add net.eth0 default office
</code></p><p><code>root <span>#</span></code><span></span><code>rc-update add net.wlan0 default office
</code></p></div>
<p>To switch between &#34;default&#34; runlevel and &#34;office&#34; runlevel without rebooting the computer, change to &#34;nonetwork&#34; runlevel in between. The network interfaces will be stopped this way, and re-read their runlevel specific configuration. This works best when &#34;nonetwork&#34; is a <i>stacked runlevel</i> in both the &#34;default&#34; and &#34;office&#34; runlevels, and the display manager and other non-network services are added to the &#34;nonetwork&#34; runlevel only.
</p>
<p><b><pre>default runlevel &lt;---&gt; nonetwork runlevel &lt;---&gt; office runlevel</pre></b></p><div><p><code>root <span>#</span></code><span></span><code>rc nonetwork &amp;&amp; rc office
</code></p><p><code>root <span>#</span></code><span></span><code>rc nonetwork &amp;&amp; rc default
</code></p></div>
<h3><span id="Selecting_a_specific_runlevel_at_boot"><span id="Selecting_a_specific_runlevel_at_boot"></span> Selecting a specific runlevel at boot</span></h3>
<p>OpenRC reads the kernel command-line used at boot time, and will start the runlevel specified by the <var>softlevel</var> parameter if provided. If no <var>softlevel</var> parameter is provided, the <i>default</i> runlevel will be used.
</p><p>The following example shows a <a href="https://www.datadoodad.com/wiki/GRUB" title="GRUB">grub</a> configuration allowing to choose to boot into either the <i>default</i> or <i>nonetwork</i> runlevels:
</p>
<p><span>FILE</span> <strong><code>/boot/grub/grub.conf</code></strong><strong>Example grub.conf (GRUB Legacy)</strong></p><pre>title=Regular Start-up
 
kernel (hd0,0)/boot/kernel-3.7.10-gentoo-r1 root=/dev/sda3
 
title=Start without Networking
 
kernel (hd0,0)/boot/kernel-3.7.10-gentoo-r1 root=/dev/sda3 softlevel=nonetwork</pre>
<h2><span id="Usage"><span id="Usage"></span> Usage</span></h2>
<h3><span id="Runlevels"><span id="Runlevels"></span> Runlevels</span></h3>
<p>OpenRC can be controlled and configured using <span>openrc</span>, <span>rc-update</span> and <span>rc-status</span> commands.
</p><p>Delete a service from default runlevel, where <code>&lt;service&gt;</code> is the name of the service to be removed:
</p>
<div><p><code>root <span>#</span></code><span></span><code>rc-update delete &lt;service&gt; default</code></p></div>
<h3><span id="Listing"><span id="Listing"></span> Listing</span></h3>
<p>Listing commands do not need to be ran as root.
</p><p>Use <span>rc-update show -v</span> to display all available init scripts and their current runlevel (if they have been added to one):
</p>

<p>Running <span>rc-update</span> or <span>rc-update show</span> will display only the init scripts that have been added to a runlevel.
</p><p>Alternatively, the <span>rc-status</span> command can be used with the <code>--servicelist</code> (<code>-s</code>) option to view the state of all services:
</p>
<div><p><code>user <span>$</span></code><span></span><code>rc-status --servicelist</code></p></div>
<h4><span id="Named_runlevels"><span id="Named_runlevels"></span> Named runlevels</span></h4>
<p>OpenRC runlevels are directories living in <span>/etc/runlevels</span> to create additional runlevels is enough to issue:
</p>
<div><p><code>root <span>#</span></code><span></span><code>install -d /etc/runlevels/$runlevel</code></p></div>
<h4><span id="Stacked_runlevels"><span id="Stacked_runlevels"></span> Stacked runlevels</span></h4>
<p>Is possible manage variants using <span>rc-update -s</span>.
</p><p>An usage example for using stacked runlevel on laptop to group networking services based on location is at <a href="https://www.datadoodad.com/wiki/OpenRC/Stacked_runlevel" title="OpenRC/Stacked runlevel">OpenRC/Stacked runlevel</a>.
</p>
<h3><span id="Prefix"><span id="Prefix"></span> Prefix</span></h3>
<p><a href="https://www.datadoodad.com/wiki/Project:Prefix" title="Project:Prefix">Gentoo Prefix</a> installs Gentoo within an offset, known as a prefix, allowing users to install Gentoo in another location in the filesystem hierarchy, hence avoiding conflicts. Next to this offset, Gentoo Prefix runs unprivileged, meaning no root user or rights are required to use it.
</p><p>By using an offset (the &#34;prefix&#34; location), it is possible for many &#34;alternative&#34; user groups to benefit from a large part of the packages in the Gentoo Linux Portage tree. Currently users of the following systems successfully run Gentoo Prefix: Mac OS X on PPC and x86, Linux on x86, x86_64 and ia64, Solaris 10 on Sparc, Sparc/64, x86 and x86_64, FreeBSD on x86, AIX on PPC, Interix on x86, Windows on x86 (with the help of Interix), HP-UX on PARISC and ia64. 
</p><p>OpenRC runscript already support prefix-installed daemons, during the Summer of Code 2012 work will be done to implement full secondary/session daemon behavior to complete the overall feature set provided by Prefix.
</p><p><a href="https://www.datadoodad.com/wiki/OpenRC/Prefix" title="OpenRC/Prefix">OpenRC/Prefix</a>, a tutorial for trying it out.
</p>
<h3><span id="Hotplug"><span id="Hotplug"></span> Hotplug</span></h3>
<p>OpenRC can be triggered by external events, such as new hardware from udev. This is what the configuration file says about hotplugged services:
</p>
<p><span>FILE</span> <strong><code>/etc/rc.conf</code></strong><strong>rc_hotplug</strong></p><pre><div dir="ltr"><pre><span></span><span># rc_hotplug controls which services we allow to be hotplugged.</span>
<span># A hotplugged service is one started by a dynamic dev manager when a matching</span>
<span># hardware device is found.</span>
<span># Hotplugged services appear in the &#34;hotplugged&#34; runlevel.</span>
<span># If rc_hotplug is set to any value, we compare the name of this service</span>
<span># to every pattern in the value, from left to right, and we allow the</span>
<span># service to be hotplugged if it matches a pattern, or if it matches no</span>
<span># patterns. Patterns can include shell wildcards.</span>
<span># To disable services from being hotplugged, prefix patterns with &#34;!&#34;.</span>
<span># If rc_hotplug is not set or is empty, all hotplugging is disabled.</span>
<span># Example - rc_hotplug=&#34;net.wlan !net.*&#34;</span>
<span># This allows net.wlan and any service not matching net.* to be hotplugged.</span>
<span># Example - rc_hotplug=&#34;!net.*&#34;</span>
<span># This allows services that do not match &#34;net.*&#34; to be hotplugged.</span>
</pre></div></pre>
<h3><span id="CGroups_support"><span id="CGroups_support"></span> CGroups support</span></h3>
<p>OpenRC starting with version 0.12 has extended cgroups support. See <a href="https://www.datadoodad.com/wiki/OpenRC/CGroups" title="OpenRC/CGroups">OpenRC/CGroups</a> for details.
</p>
<h3><span id="Chroot_support"><span id="Chroot_support"></span> Chroot support</span></h3>
<div><p><code>root <span>#</span></code><span></span><code>mkdir -p /lib64/rc/init.d</code></p><p><code>root <span>#</span></code><span></span><code>ln -s /lib64/rc/init.d /run/openrc
</code></p><p><code>root <span>#</span></code><span></span><code>touch /run/openrc/softlevel
</code></p><p><code>root <span>#</span></code><span></span><code>emerge --oneshot sys-apps/openrc
</code></p></div>
<p><span>FILE</span> <strong><code>/etc/rc.conf</code></strong><strong>OpenRC config file</strong></p><pre><div dir="ltr"><pre><span></span><span>rc_sys</span><span>=</span><span>&#34;prefix&#34;</span>
<span>rc_controller_cgroups</span><span>=</span><span>&#34;NO&#34;</span>
<span>rc_depend_strict</span><span>=</span><span>&#34;NO&#34;</span>
<span>rc_need</span><span>=</span><span>&#34;!net !dev !udev-mount !sysfs !checkfs !fsck !netmount !logger !clock !modules&#34;</span>
</pre></div></pre>
<p>The system may report the following message upon attempting to start a service:
</p>
<pre>* WARNING: &lt;service&gt; is already starting
</pre>
<p>This may be fixed by issuing the following command:
</p>

<h2><span id="System_integration"><span id="System_integration"></span> System integration</span></h2>
<h3><span id="systemd_compatibility"><span id="systemd_compatibility"></span> systemd compatibility</span></h3>
<h4><span id="logind"><span id="logind"></span> logind</span></h4>
<p>Some setups require systemd-logind. <a href="https://www.datadoodad.com/wiki/Elogind" title="Elogind">Elogind</a> can be a suitable replacement as a standalone logind running with OpenRC.
</p>
<h4><span id="tmpfiles.d"><span id="tmpfiles.d"></span> tmpfiles.d</span></h4>
<p>systemd has a special tmpfiles.d file syntax for managing temporary files. <a rel="nofollow" href="https://packages.gentoo.org/packages/sys-apps/systemd-tmpfiles">sys-apps/systemd-tmpfiles</a> is a standalone provider for OpenRC systems. Now deprecated, there is also <a rel="nofollow" href="https://packages.gentoo.org/packages/sys-apps/opentmpfiles">sys-apps/opentmpfiles</a> which provides (for now) a tmpfiles.d interpreter for OpenRC.
</p><p>Both can also be used to manage volatile entries in <span>/sys</span> or <span>/proc</span>.
</p>
<h3><span id="udev,_eudev,_and_mdev"></span><span id="udev.2C_eudev.2C_and_mdev"><span id="udev_eudev_and_mdev"></span> udev, eudev, and mdev</span></h3>
<p><a href="https://www.datadoodad.com/wiki/Udev" title="Udev">udev</a>, <a href="https://www.datadoodad.com/wiki/Eudev" title="Eudev">eudev</a>, and <a href="https://www.datadoodad.com/wiki/Mdev" title="Mdev">mdev</a> are systems available on Gentoo to manage <span>/dev</span>. <a rel="nofollow" href="https://packages.gentoo.org/packages/sys-fs/udev">sys-fs/udev</a> is the default, but OpenRC should be able to work with any, on Gentoo.
</p><p>Older Gentoo installs used udev as the main <a rel="nofollow" href="https://packages.gentoo.org/packages/virtual/udev">virtual/udev</a> provider. Based on <span></span><a rel="nofollow" href="https://bugs.gentoo.org/show_bug.cgi?id=575718">bug #575718</a> this was changed to eudev, but it was changed back to udev in <span></span><a rel="nofollow" href="https://bugs.gentoo.org/show_bug.cgi?id=807193">bug #807193</a>. However, the rc service is still <span>/etc/init.d/udev</span>.
</p><p>See <a href="https://www.datadoodad.com/wiki/Mdev" title="Mdev">mdev</a>, for possible use, e.g. for embedded systems.
</p>
<h3><span id="BusyBox_integration"><span id="BusyBox_integration"></span> BusyBox integration</span></h3>
<p>N.B. This section lacks information on how to actually use BusyBox with OpenRC.
</p><p>Please note that there are currently many BusyBox applets that are incompatible with OpenRC, see <span></span><a rel="nofollow" href="https://bugs.gentoo.org/show_bug.cgi?id=529086">bug #529086</a> for details. <b>Be warned that using OpenRC with BusyBox may require some work to set up.</b> BusyBox is more adapted to embedded use, see previous section about mdev.
</p><p><a href="https://www.datadoodad.com/wiki/Busybox" title="Busybox">BusyBox</a> can be used to replace most of the userspace utilities needed by OpenRC (<span>init</span>, shell, <span>awk</span>, and other POSIX tools), by using a complete BusyBox as the shell for OpenRC <a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/BUSYBOX.md">[1]</a>, all the calls that normally would cause a fork/exec would be spared, improving the overall speed.
</p><p>The SysV-init <span>/etc/inittab</span> file provided by Gentoo is not compatible with the BusyBox <span>init</span>. Here is an example inittab compatible with BusyBox:
</p>
<p><span>FILE</span> <strong><code>/etc/inittab</code></strong><strong>Example inittab compatible with BusyBox init</strong></p><pre>::sysinit:/sbin/openrc sysinit
::wait:/sbin/openrc boot
::wait:/sbin/openrc</pre>
<p>BusyBox provides a number of applets that could be used to replace third party software like acpid or dhcp/dhcpcd.
</p><p>See the OpenRC documentation on <a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/BUSYBOX.md">using BusyBox with OpenRC</a>.
</p>
<h2><span id="Troubleshooting"><span id="Troubleshooting"></span> Troubleshooting</span></h2>
<h3><span id="Respawning_crashed_services"><span id="Respawning_crashed_services"></span> Respawning crashed services</span></h3>
<p>OpenRC can return state of services to runlevel setting state, to provide stateful init scripts and automatic respawning.
</p><p>To respawn crashed services from the default runlevel, run <span>openrc</span>: crashed services will be started and any manually-run services will be stopped. To keep manually-started services running, run <span>openrc --no-stop</span> or <span>openrc -n</span>, for short.
</p><p>By default <span>openrc</span> will attempt to <i>start</i> crashed services, not to <i>restart</i> them. This can be controlled by the rc_crashed_stop (default NO) and rc_crashed_start (default YES) options in <span>/etc/rc.conf</span>.
</p>
<h3><span id="Manually_recovering_crashed_services"><span id="Manually_recovering_crashed_services"></span> Manually recovering crashed services</span></h3>
<p>When a process crashes while starting, an error or warning message will be printed when trying to start, stop, or show the status of a service. For example, when using the &#34;docker&#34; service:
</p>
<div><p><code>root <span>#</span></code><span></span><code>rc-service docker status</code></p><pre> * status: crashed</pre></div>
<div><p><code>root <span>#</span></code><span></span><code>rc-service docker start</code></p><pre> * WARNING: docker has already been started</pre></div>
<div><p><code>root <span>#</span></code><span></span><code>rc-service docker stop</code></p><pre> * Caching service dependencies ...                                                                                                  [ ok ]
 * Stopping docker ...
 * Failed to stop docker                                                                                                             [ !! ]
 * ERROR: docker failed to stop</pre></div>
<p>To remedy this situation, zap the service:
</p>
<div><p><code>root <span>#</span></code><span></span><code>rc-service docker zap
</code></p></div>
<h2><span id="See_also"><span id="See_also"></span> See also</span></h2>
<ul><li><a href="https://www.datadoodad.com/wiki/OpenRC/CGroups" title="OpenRC/CGroups">OpenRC/CGroups</a> — OpenRC includes support for <a href="https://en.wikipedia.org/wiki/cgroup" title="wikipedia:cgroup">cgroups</a>.</li>
<li><a href="https://www.datadoodad.com/wiki/OpenRC/openrc-init" title="OpenRC/openrc-init">OpenRC/openrc-init</a> — Open-RC&#39;s own init system</li>
<li><a href="https://www.datadoodad.com/wiki/OpenRC/Prefix" title="OpenRC/Prefix">OpenRC/Prefix</a> — The following guideline applies to a Gentoo <a href="https://www.datadoodad.com/wiki/Prefix" title="Prefix">Prefix</a> on RHEL-5.6 amd64 and on Debian 6.0 amd64, for other setups it should be similar.</li>
<li><a href="https://www.datadoodad.com/wiki/OpenRC/Stacked_runlevel" title="OpenRC/Stacked runlevel">OpenRC/Stacked runlevel</a> — a tutorial for setting up complicated networking with the help of stacked runlevel.</li>
<li><a href="https://www.datadoodad.com/wiki/OpenRC/supervise-daemon" title="OpenRC/supervise-daemon">OpenRC/supervise-daemon</a> — OpenRC&#39;s daemon supervisor</li>
<li><a href="https://www.datadoodad.com/wiki/OpenRC/Users" title="OpenRC/Users">OpenRC/Users</a> — an (incomplete) list of distributions and operating systems using OpenRC.</li>
<li><a href="https://www.datadoodad.com/wiki//etc/local.d" title="/etc/local.d">/etc/local.d</a> — <b><span>/etc/local.d/</span></b> can contain small programs or light scripts to be run when the local service is started or stopped.</li>
<li><a href="https://www.datadoodad.com/wiki/Handbook:AMD64/Working/Initscripts" title="Handbook:AMD64/Working/Initscripts">Gentoo AMD64 Handbook - Initscript system</a></li>
<li>The main OpenRC configuration file, <span>/etc/rc.conf</span>, contains extensive comments documenting OpenRC configuration.</li></ul>
<h2><span id="External_resources"><span id="External_resources"></span> External resources</span></h2>
<h3><span id="OpenRC_documentation"><span id="OpenRC_documentation"></span> OpenRC documentation</span></h3>
<p>OpenRC has its own useful documentation, maintained by the OpenRC developers themselves. Be aware that Gentoo does not use all of OpenRC&#39;s functionality by default:
</p>
<ul><li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/README.md">README</a></li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/user-guide.md">User Guide</a></li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/init-guide.md">OpenRC init process guide</a> - How to <a href="https://www.datadoodad.com/wiki/OpenRC/openrc-init" title="OpenRC/openrc-init">use OpenRC&#39;s own init system</a> (not used by default in Gentoo).</li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/agetty-guide.md">agetty guide</a> - Setting up the agetty service in OpenRC (By default, ttys are spawned with <a href="https://www.datadoodad.com/wiki/Sysvinit#Gentoo.27s_sysvinit_setup" title="Sysvinit">sysvinit</a> in Gentoo).</li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/runit-guide.md">Using runit with OpenRC</a></li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/s6-guide.md">Using S6 with OpenRC</a></li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/supervise-daemon-guide.md">Using supervise-daemon</a> - <a href="https://www.datadoodad.com/wiki/OpenRC/supervise-daemon" title="OpenRC/supervise-daemon">Optional process supervision</a>.</li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/BUSYBOX.md">Using BusyBox with OpenRC</a></li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/service-script-guide.md">Service script writing guide</a> - For developers or packagers.</li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/NEWS.md">NEWS</a> - Important information about each release.</li>
<li><a rel="nofollow" href="https://github.com/OpenRC/openrc/blob/master/HISTORY.md">HISTORY</a> - History of how OpenRC came to be.</li></ul>
<!-- 
NewPP limit report
Cached time: 20230627033824
Cache expiry: 86400
Dynamic content: false
Complications: []
[SMW] In‐text annotation parser time: 0.002 seconds
CPU time usage: 0.306 seconds
Real time usage: 0.489 seconds
Preprocessor visited node count: 4696/1000000
Post‐expand include size: 100833/2097152 bytes
Template argument size: 26922/2097152 bytes
Highest expansion depth: 26/40
Expensive parser function count: 35/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 7837/5000000 bytes
Lua time usage: 0.090/7 seconds
Lua virtual size: 5.15 MB/50 MB
Lua estimated memory usage: 0 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  380.588      1 -total
 38.67%  147.186     30 Template:Anchor
 19.14%   72.827      7 Template:See_also
 12.68%   48.262     37 Template:Link
  9.41%   35.823      1 Template:InfoBox_stack
  6.27%   23.847     14 Template:RootCmd
  5.32%   20.257     16 Template:GenericCmd
  4.53%   17.224      8 Template:InfoBox
  2.57%    9.795      7 Template:FileBox
  2.07%    7.896      1 Template:InfoBox_todo
-->

<!-- Saved in parser cache with key gentoo?hwiki:pcache:idhash:1238-0!dateformat=default and timestamp 20230627033823 and revision id 1244704
 -->
</div></div></div>
  </body>
</html>
