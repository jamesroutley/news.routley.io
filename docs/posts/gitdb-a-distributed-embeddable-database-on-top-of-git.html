<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/gogitdb/gitdb">Original</a>
    <h1>GitDB, a distributed embeddable database on top of Git</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://goreportcard.com/report/github.com/gogitdb/gitdb" rel="nofollow"><img src="https://camo.githubusercontent.com/8760eb4895806a5a6efef0496a3fd4c75494c9c5703266487e57b51bccf449bf/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f676f67697464622f67697464623f7374796c653d666c61742d737175617265" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/gogitdb/gitdb?style=flat-square"/></a>
<a href="https://codecov.io/gh/gogitdb/gitdb" rel="nofollow"><img src="https://camo.githubusercontent.com/8182674b8b3e93cdaeb7b9a3b990c4404fe77dc7a621c727d92b3480b64ad631/68747470733a2f2f636f6465636f762e696f2f67682f676f67697464622f67697464622f6272616e63682f646576656c6f702f67726170682f62616467652e737667" alt="Coverage" data-canonical-src="https://codecov.io/gh/gogitdb/gitdb/branch/develop/graph/badge.svg"/></a>
<a href="https://travis-ci.com/gogitdb/gitdb" rel="nofollow"><img src="https://camo.githubusercontent.com/a6922ee399bce9580bbd0b2f3e595c0aecb2ff1a5a5becabc0e71e6871a0dfed/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f676f67697464622f67697464622e7376673f7374796c653d666c61742d73717561726526266272616e63683d6d6173746572" alt="Build Status Travis" data-canonical-src="https://img.shields.io/travis/gogitdb/gitdb.svg?style=flat-square&amp;&amp;branch=master"/></a>
<a href="https://godoc.org/github.com/gogitdb/gitdb" rel="nofollow"><img src="https://camo.githubusercontent.com/4ad54fd1f26f813e0b4e76d70ea3c53e084342f38d2af2f3e4d52e8f80cfb570/687474703a2f2f696d672e736869656c64732e696f2f62616467652f676f2d646f63756d656e746174696f6e2d626c75652e7376673f7374796c653d666c61742d737175617265" alt="Godoc" data-canonical-src="http://img.shields.io/badge/go-documentation-blue.svg?style=flat-square"/></a>
<a href="https://github.com/gogitdb/gitdb/releases"><img src="https://camo.githubusercontent.com/70dc064c5b07094c4ebc86a87c3331bcd2c4f72c09049238f94510b4b2b9c35a/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f72656c656173652f676f67697464622f67697464622f616c6c2e7376673f7374796c653d666c61742d737175617265" alt="Releases" data-canonical-src="https://img.shields.io/github/release/gogitdb/gitdb/all.svg?style=flat-square"/></a>
<a href="https://github.com/gogitdb/gitdb/blob/master/LICENSE"><img src="https://camo.githubusercontent.com/f0b46f1848cc78cb35a53344004d4ca24cd0d7e06128c0c638b55e0904fbc267/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f676f67697464622f67697464622e7376673f7374796c653d666c61742d737175617265" alt="LICENSE" data-canonical-src="https://img.shields.io/github/license/gogitdb/gitdb.svg?style=flat-square"/></a></p>
<h2 dir="auto"><a id="user-content-what-is-gitdb" aria-hidden="true" href="#what-is-gitdb"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What is GitDB?</h2>
<blockquote>
<p dir="auto">GitDB is not a binary. Itâ€™s a library!</p>
</blockquote>
<p dir="auto">GitDB is a decentralized document database written in Go that uses <a href="https://git-scm.com/" rel="nofollow">Git</a> under the hood to provide database-like functionalities via strictly defined interfaces.</p>
<p dir="auto">GitDB allows developers to create Models of objects in their application which implement a Model Interface that can access it&#39;s persistence features. This allows GitDB to work with these objects in database operations.</p>
<h2 dir="auto"><a id="user-content-why-gitdb---motivation-behind-project" aria-hidden="true" href="#why-gitdb---motivation-behind-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Why GitDB - motivation behind project?</h2>
<ul dir="auto">
<li>A need for a database that was quick and simple to set up</li>
<li>A need for a database that was decentralized and each participating client in a system can store their data independent of other clients.</li>
</ul>
<h2 dir="auto"><a id="user-content-features" aria-hidden="true" href="#features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Features</h2>
<ul dir="auto">
<li>Decentralized</li>
<li>Document store</li>
<li>Embedded into your go application</li>
<li>Encryption (encrypt on write, decrypt on read)</li>
<li>Record locking.</li>
<li>Simple Indexing System</li>
<li>Transactions</li>
<li>Web UI</li>
</ul>
<h2 dir="auto"><a id="user-content-project-versioning" aria-hidden="true" href="#project-versioning"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Project versioning</h2>
<p dir="auto">GitDB uses <a href="http://semver.org" rel="nofollow">semantic versioning</a>.
API should not change between patch and minor releases.
New minor versions may add additional features to the API.</p>
<h2 dir="auto"><a id="user-content-table-of-contents" aria-hidden="true" href="#table-of-contents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Table of Contents</h2>
<ul dir="auto">
<li><a href="#getting-started">Getting Started</a>
<ul dir="auto">
<li><a href="#installing">Installing</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#opening-a-database">Opening a database</a></li>
<li><a href="#insertingupdating-a-record">Inserting/Updating a record</a></li>
<li><a href="#fetching-a-single-record">Fetching a single record</a></li>
<li><a href="#fetching-all-records-in-a-dataset">Fetching all records in a dataset</a></li>
<li><a href="#deleting-a-record">Deleting a record</a></li>
<li><a href="#search-for-records">Search for records</a></li>
<li><a href="#transactions">Transactions</a></li>
<li><a href="#encryption">Encryption</a></li>
</ul>
</li>
<li><a href="#resources">Resources</a></li>
<li><a href="#caveats--limitations">Caveats &amp; Limitations</a></li>
<li><a href="#reading-the-source">Reading the Source</a></li>
</ul>
  
<h2 dir="auto"><a id="user-content-getting-started" aria-hidden="true" href="#getting-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Getting Started</h2>
<h3 dir="auto"><a id="user-content-installing" aria-hidden="true" href="#installing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing</h3>
<p dir="auto">To start using GitDB, install Go and run <code>go get</code>:</p>
<div data-snippet-clipboard-copy-content="$ go get github.com/gogitdb/gitdb/v2"><pre>$ go get github.com/gogitdb/gitdb/v2</pre></div>
<h3 dir="auto"><a id="user-content-configuration" aria-hidden="true" href="#configuration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Configuration</h3>
<p dir="auto">Below are configuration options provided by GitDB</p>
<table>
  <tbody><tr>
    <td>Name</td>
    <td>Description</td>
    <td>Type</td>
    <td>Required</td>
    <td>Default</td>
  </tr><tr>
  </tr><tr>
    <td>DbPath</td>
    <td>Path on your machine where you want GitDB to create/clone your database</td>
    <td>string</td>
    <td>Y</td>
    <td>N/A</td>
  </tr>
  <tr>
    <td>ConnectionName</td>
    <td>Unique name for gitdb connection. Use this when opening multiple GitDB connections</td>
    <td>string</td>
    <td>N</td>
    <td>&#34;default&#34;</td>
  </tr>
  <tr>
    <td>OnlineRemote</td>
    <td>URL for remote git server you want GitDB to sync with e.g git@github.com:user/db.git or <a href="https://github.com/user/db.git">https://github.com/user/db.git</a>.
    <p dir="auto"><strong>Note: The first time GitDB runs, it will automatically generate ssh keys and will automatically attempt to use this key to sync with the OnlineRemote,
    therefore ensure that the generated keys are added to this git server. The ssh keys can be found at <i>Config.DbPath/.gitdb/ssh</i></strong></p>
    </td>
    <td>string</td>
    <td>N</td>
    <td>&#34;&#34;</td>
  </tr>
  <tr>
    <td>SyncInterval</td>
    <td>This controls how often you want GitDB to sync with the online remote</td>
    <td>time.Duration.</td>
    <td>N</td>
    <td>5s</td>
  </tr>
  <tr>
    <td>EncryptionKey</td>
    <td>16,24 or 32 byte string used to provide AES encryption for Models that implement ShouldEncrypt</td>
    <td>string</td>
    <td>N</td>
    <td>&#34;&#34;</td>
  </tr>
  <tr>
    <td>User</td>
    <td>This specifies the user connected to the Gitdb and will be used to commit all changes to the database</td>
    <td>gitdb.User</td>
    <td>N</td>
    <td>ghost &lt;ghost@gitdb.local&gt;</td>
  </tr>
  <tr>
    <td>EnableUI</td>
    <td>Use this option to enable GitDB web user interface</td>
    <td>bool</td>
    <td>N</td>
    <td>false</td>
  </tr>
  <tr>
    <td>UIPort</td>
    <td>Use this option to change the default port which GitDB uses to serve it&#39;s web user interface</td>
    <td>int</td>
    <td>N</td>
    <td>4120</td>
  </tr>
  <tr>
    <td>Factory</td>
    <td>For backward compatibity with v1. In v1 GitDB needed a factory method to be able construct concrete Model for certain database operations.
    This has now been dropped in v2
    </td>
    <td>func(dataset string) gitdb.Model</td>
    <td>N</td>
    <td>nil</td>
  </tr>
  <tr>
    <td>Mock</td>
    <td>Flag used for testing apps. If true, will return a mock GitDB connection</td>
    <td>bool</td>
    <td>N</td>
    <td>false</td>
  </tr>
</tbody></table>
<p dir="auto">You can configure GitDB either using the constructor or constructing it yourself</p>
<div data-snippet-clipboard-copy-content="cfg := gitdb.NewConfig(path)
//or
cfg := gitdb.Config{
  DbPath: path
}"><pre><span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>path</span>)
<span>//or</span>
<span>cfg</span> <span>:=</span> gitdb.<span>Config</span>{
  <span>DbPath</span>: <span>path</span>
}</pre></div>

<h3 dir="auto"><a id="user-content-importing-gitdb" aria-hidden="true" href="#importing-gitdb"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Importing GitDB</h3>
<p dir="auto">To use GitDB as an embedded document store, import as:</p>
<div data-snippet-clipboard-copy-content="import &#34;github.com/gogitdb/gitdb/v2&#34;

cfg := gitdb.NewConfig(path)
db, err := gitdb.Open(cfg)
if err != nil {
  log.Fatal(err)
}
defer db.Close()"><pre><span>import</span> <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>

<span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>path</span>)
<span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
  <span>log</span>.<span>Fatal</span>(<span>err</span>)
}
<span>defer</span> <span>db</span>.<span>Close</span>()</pre></div>
<h3 dir="auto"><a id="user-content-opening-a-database" aria-hidden="true" href="#opening-a-database"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Opening a database</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main() {
  
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  // Open will create or clone down a git repo 
  // in configured path if it does not exist.
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  ...
}"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>() {
  
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>// Open will create or clone down a git repo </span>
  <span>// in configured path if it does not exist.</span>
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>...</span>
}</pre></div>
<h3 dir="auto"><a id="user-content-models" aria-hidden="true" href="#models"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Models</h3>
<p dir="auto">A Model is a struct that represents a record in GitDB. GitDB only works with models that implement the gidb.Model interface</p>
<p dir="auto">gitdb.TimeStampedModel is a simple struct that allows you to easily add CreatedAt and UpdatedAt to all the Models in your application and will automatically time stamp them before persisting to GitDB. You can write your own base Models to embed common fields across your application Models</p>
<div data-snippet-clipboard-copy-content="type BankAccount struct {
  //TimeStampedModel will add CreatedAt and UpdatedAt fields this Model
  gitdb.TimeStampedModel 
  AccountType         string
  AccountNo           string
  Currency            string
  Name                string
}

func (b *BankAccount) GetSchema() *gitdb.Schema {
  //Dataset Name
  name := &#34;Accounts&#34;
  //Block ID
  block := b.CreatedAt.Format(&#34;200601&#34;)
  //Record ID
  record := b.AccountNo

  //Indexes speed up searching
  indexes := make(map[string]interface{})
  indexes[&#34;AccountType&#34;] = b.AccountType
 
  return gitdb.NewSchema(name, block, record, indexes)
}

func (b *BankAccount) Validate() error            { return nil }
func (b *BankAccount) IsLockable() bool           { return false }
func (b *BankAccount) ShouldEncrypt() bool        { return false }
func (b *BankAccount) GetLockFileNames() []string { return []string{} }

...
  "><pre><span>type</span> <span>BankAccount</span> <span>struct</span> {
  <span>//TimeStampedModel will add CreatedAt and UpdatedAt fields this Model</span>
  gitdb.<span>TimeStampedModel</span> 
  <span>AccountType</span>         <span>string</span>
  <span>AccountNo</span>           <span>string</span>
  <span>Currency</span>            <span>string</span>
  <span>Name</span>                <span>string</span>
}

<span>func</span> (<span>b</span> <span>*</span><span>BankAccount</span>) <span>GetSchema</span>() <span>*</span>gitdb.<span>Schema</span> {
  <span>//Dataset Name</span>
  <span>name</span> <span>:=</span> <span>&#34;Accounts&#34;</span>
  <span>//Block ID</span>
  <span>block</span> <span>:=</span> <span>b</span>.<span>CreatedAt</span>.<span>Format</span>(<span>&#34;200601&#34;</span>)
  <span>//Record ID</span>
  <span>record</span> <span>:=</span> <span>b</span>.<span>AccountNo</span>

  <span>//Indexes speed up searching</span>
  <span>indexes</span> <span>:=</span> <span>make</span>(<span>map</span>[<span>string</span>]<span>interface</span>{})
  <span>indexes</span>[<span>&#34;AccountType&#34;</span>] <span>=</span> <span>b</span>.<span>AccountType</span>
 
  <span>return</span> <span>gitdb</span>.<span>NewSchema</span>(<span>name</span>, <span>block</span>, <span>record</span>, <span>indexes</span>)
}

<span>func</span> (<span>b</span> <span>*</span><span>BankAccount</span>) <span>Validate</span>() <span>error</span>            { <span>return</span> <span>nil</span> }
<span>func</span> (<span>b</span> <span>*</span><span>BankAccount</span>) <span>IsLockable</span>() <span>bool</span>           { <span>return</span> <span>false</span> }
<span>func</span> (<span>b</span> <span>*</span><span>BankAccount</span>) <span>ShouldEncrypt</span>() <span>bool</span>        { <span>return</span> <span>false</span> }
<span>func</span> (<span>b</span> <span>*</span><span>BankAccount</span>) <span>GetLockFileNames</span>() []<span>string</span> { <span>return</span> []<span>string</span>{} }

<span>...</span>
  </pre></div>
<h3 dir="auto"><a id="user-content-insertingupdating-a-record" aria-hidden="true" href="#insertingupdating-a-record"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Inserting/Updating a record</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  //populate model
  account := &amp;BankAccount{}
  account.AccountNo = &#34;0123456789&#34;
  account.AccountType = &#34;Savings&#34;
  account.Currency = &#34;GBP&#34;
  account.Name = &#34;Foo Bar&#34;

  err = db.Insert(account)
  if err != nil {
    log.Println(err)
  }

  //get account id
  log.Println(gitdb.Id(account))

  //update account name
  account.Name = &#34;Bar Foo&#34;
  err = db.Insert(account)
  if err != nil {
    log.Println(err)
  }
}"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>//populate model</span>
  <span>account</span> <span>:=</span> <span>&amp;</span><span>BankAccount</span>{}
  <span>account</span>.<span>AccountNo</span> <span>=</span> <span>&#34;0123456789&#34;</span>
  <span>account</span>.<span>AccountType</span> <span>=</span> <span>&#34;Savings&#34;</span>
  <span>account</span>.<span>Currency</span> <span>=</span> <span>&#34;GBP&#34;</span>
  <span>account</span>.<span>Name</span> <span>=</span> <span>&#34;Foo Bar&#34;</span>

  <span>err</span> <span>=</span> <span>db</span>.<span>Insert</span>(<span>account</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Println</span>(<span>err</span>)
  }

  <span>//get account id</span>
  <span>log</span>.<span>Println</span>(<span>gitdb</span>.<span>Id</span>(<span>account</span>))

  <span>//update account name</span>
  <span>account</span>.<span>Name</span> <span>=</span> <span>&#34;Bar Foo&#34;</span>
  <span>err</span> <span>=</span> <span>db</span>.<span>Insert</span>(<span>account</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Println</span>(<span>err</span>)
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-fetching-a-single-record" aria-hidden="true" href="#fetching-a-single-record"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Fetching a single record</h3>
<div data-snippet-clipboard-copy-content="package main
import (
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  //model to passed to Get to store result 
  var account BankAccount
  if err := db.Get(&#34;Accounts/202003/0123456789&#34;, &amp;account); err != nil {
    log.Println(err)
  }
}"><pre><span>package</span> main
<span>import</span> (
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>//model to passed to Get to store result </span>
  <span>var</span> <span>account</span> <span>BankAccount</span>
  <span>if</span> <span>err</span> <span>:=</span> <span>db</span>.<span>Get</span>(<span>&#34;Accounts/202003/0123456789&#34;</span>, <span>&amp;</span><span>account</span>); <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Println</span>(<span>err</span>)
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-fetching-all-records-in-a-dataset" aria-hidden="true" href="#fetching-all-records-in-a-dataset"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Fetching all records in a dataset</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;fmt&#34;
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  records, err := db.Fetch(&#34;Accounts&#34;)
  if err != nil {
    log.Print(err)
    return
  }

  accounts := []*BankAccount{}
  for _, r := range records {
    b := &amp;BankAccount{}
    r.Hydrate(b)
    accounts = append(accounts, b)
    log.Print(fmt.Sprintf(&#34;%s-%s&#34;, gitdb.ID(b), b.AccountNo))
  }
}
"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;fmt&#34;</span>
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>records</span>, <span>err</span> <span>:=</span> <span>db</span>.<span>Fetch</span>(<span>&#34;Accounts&#34;</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Print</span>(<span>err</span>)
    <span>return</span>
  }

  <span>accounts</span> <span>:=</span> []<span>*</span><span>BankAccount</span>{}
  <span>for</span> <span>_</span>, <span>r</span> <span>:=</span> <span>range</span> <span>records</span> {
    <span>b</span> <span>:=</span> <span>&amp;</span><span>BankAccount</span>{}
    <span>r</span>.<span>Hydrate</span>(<span>b</span>)
    <span>accounts</span> <span>=</span> <span>append</span>(<span>accounts</span>, <span>b</span>)
    <span>log</span>.<span>Print</span>(<span>fmt</span>.<span>Sprintf</span>(<span>&#34;%s-%s&#34;</span>, <span>gitdb</span>.<span>ID</span>(<span>b</span>), <span>b</span>.<span>AccountNo</span>))
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-fetching-all-records-from-specific-block-in-a-dataset" aria-hidden="true" href="#fetching-all-records-from-specific-block-in-a-dataset"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Fetching all records from specific block in a dataset</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;fmt&#34;
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  records, err := db.Fetch(&#34;Accounts&#34;, &#34;b0&#34;, &#34;b1&#34;)
  if err != nil {
    log.Print(err)
    return
  }

  var accounts []*BankAccount
  for _, r := range records {
    b := &amp;BankAccount{}
    r.Hydrate(b)
    accounts = append(accounts, b)
    log.Print(fmt.Sprintf(&#34;%s-%s&#34;, gitdb.ID(b), b.AccountNo))
  }
}
"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;fmt&#34;</span>
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>records</span>, <span>err</span> <span>:=</span> <span>db</span>.<span>Fetch</span>(<span>&#34;Accounts&#34;</span>, <span>&#34;b0&#34;</span>, <span>&#34;b1&#34;</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Print</span>(<span>err</span>)
    <span>return</span>
  }

  <span>var</span> <span>accounts</span> []<span>*</span><span>BankAccount</span>
  <span>for</span> <span>_</span>, <span>r</span> <span>:=</span> <span>range</span> <span>records</span> {
    <span>b</span> <span>:=</span> <span>&amp;</span><span>BankAccount</span>{}
    <span>r</span>.<span>Hydrate</span>(<span>b</span>)
    <span>accounts</span> <span>=</span> <span>append</span>(<span>accounts</span>, <span>b</span>)
    <span>log</span>.<span>Print</span>(<span>fmt</span>.<span>Sprintf</span>(<span>&#34;%s-%s&#34;</span>, <span>gitdb</span>.<span>ID</span>(<span>b</span>), <span>b</span>.<span>AccountNo</span>))
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-deleting-a-record" aria-hidden="true" href="#deleting-a-record"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Deleting a record</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  if err := db.Delete(&#34;Accounts/202003/0123456789&#34;); err != nil {
    log.Print(err)
  }
}"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>if</span> <span>err</span> <span>:=</span> <span>db</span>.<span>Delete</span>(<span>&#34;Accounts/202003/0123456789&#34;</span>); <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Print</span>(<span>err</span>)
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-search-for-records" aria-hidden="true" href="#search-for-records"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Search for records</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;fmt&#34;
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  //Find all records that have savings account type
  searchParam := &amp;db.SearchParam{Index: &#34;AccountType&#34;, Value: &#34;Savings&#34;}
  records, err := dbconn.Search(&#34;Accounts&#34;, []*db.SearchParam{searchParam}, gitdb.SearchEquals)
  if err != nil {
    log.Println(err.Error())
    return
  } 

  accounts := []*BankAccount{}
  for _, r := range records {
    b := &amp;BankAccount{}
    r.Hydrate(b)
    accounts = append(accounts, b)
    log.Print(fmt.Sprintf(&#34;%s-%s&#34;, b.ID, b.CreatedAt))
  }
}"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;fmt&#34;</span>
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>//Find all records that have savings account type</span>
  <span>searchParam</span> <span>:=</span> <span>&amp;</span>db.<span>SearchParam</span>{<span>Index</span>: <span>&#34;AccountType&#34;</span>, <span>Value</span>: <span>&#34;Savings&#34;</span>}
  <span>records</span>, <span>err</span> <span>:=</span> <span>dbconn</span>.<span>Search</span>(<span>&#34;Accounts&#34;</span>, []<span>*</span>db.<span>SearchParam</span>{<span>searchParam</span>}, <span>gitdb</span>.<span>SearchEquals</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Println</span>(<span>err</span>.<span>Error</span>())
    <span>return</span>
  } 

  <span>accounts</span> <span>:=</span> []<span>*</span><span>BankAccount</span>{}
  <span>for</span> <span>_</span>, <span>r</span> <span>:=</span> <span>range</span> <span>records</span> {
    <span>b</span> <span>:=</span> <span>&amp;</span><span>BankAccount</span>{}
    <span>r</span>.<span>Hydrate</span>(<span>b</span>)
    <span>accounts</span> <span>=</span> <span>append</span>(<span>accounts</span>, <span>b</span>)
    <span>log</span>.<span>Print</span>(<span>fmt</span>.<span>Sprintf</span>(<span>&#34;%s-%s&#34;</span>, <span>b</span>.<span>ID</span>, <span>b</span>.<span>CreatedAt</span>))
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-transactions" aria-hidden="true" href="#transactions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Transactions</h3>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main() {
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  func accountUpgradeFuncOne() error { println(&#34;accountUpgradeFuncOne...&#34;); return nil }
  func accountUpgradeFuncTwo() error { println(&#34;accountUpgradeFuncTwo...&#34;); return errors.New(&#34;accountUpgradeFuncTwo failed&#34;) }
  func accountUpgradeFuncThree() error { println(&#34;accountUpgradeFuncThree&#34;); return nil }

  tx := db.StartTransaction(&#34;AccountUpgrade&#34;)
  tx.AddOperation(accountUpgradeFuncOne)
  tx.AddOperation(accountUpgradeFuncTwo)
  tx.AddOperation(accountUpgradeFuncThree)
  terr := tx.Commit()
  if terr != nil {
    log.Print(terr)
  }
}"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>() {
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>func</span> <span>accountUpgradeFuncOne</span>() <span>error</span> { <span>println</span>(<span>&#34;accountUpgradeFuncOne...&#34;</span>); <span>return</span> <span>nil</span> }
  <span>func</span> <span>accountUpgradeFuncTwo</span>() <span>error</span> { <span>println</span>(<span>&#34;accountUpgradeFuncTwo...&#34;</span>); <span>return</span> <span>errors</span>.<span>New</span>(<span>&#34;accountUpgradeFuncTwo failed&#34;</span>) }
  <span>func</span> <span>accountUpgradeFuncThree</span>() <span>error</span> { <span>println</span>(<span>&#34;accountUpgradeFuncThree&#34;</span>); <span>return</span> <span>nil</span> }

  <span>tx</span> <span>:=</span> <span>db</span>.<span>StartTransaction</span>(<span>&#34;AccountUpgrade&#34;</span>)
  <span>tx</span>.<span>AddOperation</span>(<span>accountUpgradeFuncOne</span>)
  <span>tx</span>.<span>AddOperation</span>(<span>accountUpgradeFuncTwo</span>)
  <span>tx</span>.<span>AddOperation</span>(<span>accountUpgradeFuncThree</span>)
  <span>terr</span> <span>:=</span> <span>tx</span>.<span>Commit</span>()
  <span>if</span> <span>terr</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Print</span>(<span>terr</span>)
  }
}</pre></div>
<h3 dir="auto"><a id="user-content-encryption" aria-hidden="true" href="#encryption"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Encryption</h3>
<p dir="auto">GitDB suppports AES encryption and is done on a Model level, which means you can have a database with different Models where some are encrypted and others are not. To encrypt your data, your Model must implement <code>ShouldEncrypt()</code> to return true and you must set <code>gitdb.Config.EncryptionKey</code>. For maximum security set this key to a 32 byte string to select AES-256</p>
<div data-snippet-clipboard-copy-content="package main

import (
  &#34;log&#34;
  &#34;github.com/gogitdb/gitdb/v2&#34;
)

func main(){
  cfg := gitdb.NewConfig(&#34;/tmp/data&#34;)
  cfg.EncryptionKey = &#34;a_32_bytes_string_for_AES-256&#34;
  db, err := gitdb.Open(cfg)
  if err != nil {
    log.Fatal(err)
  }
  defer db.Close()

  //populate model
  account := &amp;BankAccount{}
  account.AccountNo = &#34;0123456789&#34;
  account.AccountType = &#34;Savings&#34;
  account.Currency = &#34;GBP&#34;
  account.Name = &#34;Foo Bar&#34;

  //Insert will encrypt the account
  err = db.Insert(account)
  if err != nil {
    log.Println(err)
  }

  //Get will automatically decrypt account
  var account BankAccount
  err = db.Get(&#34;Accounts/202003/0123456789&#34;, &amp;account)
  if err != nil {
    log.Println(err)
  }
}"><pre><span>package</span> main

<span>import</span> (
  <span>&#34;log&#34;</span>
  <span>&#34;github.com/gogitdb/gitdb/v2&#34;</span>
)

<span>func</span> <span>main</span>(){
  <span>cfg</span> <span>:=</span> <span>gitdb</span>.<span>NewConfig</span>(<span>&#34;/tmp/data&#34;</span>)
  <span>cfg</span>.<span>EncryptionKey</span> <span>=</span> <span>&#34;a_32_bytes_string_for_AES-256&#34;</span>
  <span>db</span>, <span>err</span> <span>:=</span> <span>gitdb</span>.<span>Open</span>(<span>cfg</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Fatal</span>(<span>err</span>)
  }
  <span>defer</span> <span>db</span>.<span>Close</span>()

  <span>//populate model</span>
  <span>account</span> <span>:=</span> <span>&amp;</span><span>BankAccount</span>{}
  <span>account</span>.<span>AccountNo</span> <span>=</span> <span>&#34;0123456789&#34;</span>
  <span>account</span>.<span>AccountType</span> <span>=</span> <span>&#34;Savings&#34;</span>
  <span>account</span>.<span>Currency</span> <span>=</span> <span>&#34;GBP&#34;</span>
  <span>account</span>.<span>Name</span> <span>=</span> <span>&#34;Foo Bar&#34;</span>

  <span>//Insert will encrypt the account</span>
  <span>err</span> <span>=</span> <span>db</span>.<span>Insert</span>(<span>account</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Println</span>(<span>err</span>)
  }

  <span>//Get will automatically decrypt account</span>
  <span>var</span> <span>account</span> <span>BankAccount</span>
  <span>err</span> <span>=</span> <span>db</span>.<span>Get</span>(<span>&#34;Accounts/202003/0123456789&#34;</span>, <span>&amp;</span><span>account</span>)
  <span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
    <span>log</span>.<span>Println</span>(<span>err</span>)
  }
}</pre></div>
<h2 dir="auto"><a id="user-content-resources" aria-hidden="true" href="#resources"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Resources</h2>
<p dir="auto">For more information on getting started with Gitdb, check out the following articles:</p>
<ul dir="auto">
<li><a href="https://docs.google.com/document/d/1OPalq-7J_Vo_uks35up_4a_V0BsRrpwL1J4JG6ZFoEs/edit?usp=sharing" rel="nofollow">Gtidb - an embedded distributed document database for Go</a> by Oke Ugwu</li>
</ul>
<h2 dir="auto"><a id="user-content-caveats--limitations" aria-hidden="true" href="#caveats--limitations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Caveats &amp; Limitations</h2>
<p dir="auto">It&#39;s important to pick the right tool for the job and GitDB is no exception.
Here are a few things to note when evaluating and using GitDB:</p>
<ul dir="auto">
<li>GitDB is good for systems where data producers are indpendent.</li>
<li>GitDB currently depends on the git binary to work</li>
</ul>
<h2 dir="auto"><a id="user-content-reading-the-source" aria-hidden="true" href="#reading-the-source"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Reading the Source</h2>
<p dir="auto">GitDB is a relatively small code base (&lt;5KLOC) for an embedded, distributed,
document database so it can be a good starting point for people
interested in how databases work.</p>
<p dir="auto">The best places to start are the main entry points into GitDB:</p>
<ul dir="auto">
<li><code>Open()</code> - Initializes the reference to the database. It&#39;s responsible for
creating the database if it doesn&#39;t exist and pulling down existing database
if an online remote is specified.</li>
</ul>
<p dir="auto">If you have additional notes that could be helpful for others, please submit
them via pull request.</p>

</article>
          </div></div>
  </body>
</html>
