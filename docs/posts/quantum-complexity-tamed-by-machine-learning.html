<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.quantamagazine.org/quantum-complexity-tamed-by-machine-learning-20220207/">Original</a>
    <h1>Quantum complexity tamed by machine learning</h1>
    
    <div id="readability-page-1" class="page"><div data-reactid="426"><section data-reactid="427"><div data-reactid="428"><div data-reactid="429"><div data-reactid="430"><p>Hohenberg and Kohn’s work proved the existence of a powerful master equation — the universal density functional. The equation would take some instance of an electron soup and calculate its energy, guiding physicists to the most natural arrangement of electrons (the one with the lowest possible energy). The functional would be universal in the sense that it could, in principle, describe any system — from silicon bricks down to water molecules.</p>
<p>The only catch was that no one had any idea what the equation looked like.</p>
<p>Soon Kohn and another physicist, Lu Jeu Sham, <a href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.140.A1133">made a first pass</a> at writing down a practical density functional. An exact functional capturing all subtle aspects of electron behavior should be unspeakably complicated, so they split it in two. The first half was the part they knew how to do. It provided the energy of a group of electrons that could sense each other only on average. Everything else — the excess energy from the byzantine quantum effects and nonlocal interactions — went into the second half: a fudge factor known as the exchange and correlation functional.</p>
<p>They “reduced the thing that we don’t understand about the functional to one small part of it,” Neaton said.</p>
<p>Over the following decades, scientists built on Kohn and Sham’s work with increasingly clever ways of estimating the fudge factor, and density functionals became the de facto way to understand electrons. Researchers use them to predict how likely an atom is to grab or release an electron, the ways in which molecules vibrate (information the Curiosity rover uses to look for signs of life on Mars), the arrangement of atoms in crystal lattices, the speed of sound in a material, and much more. The theory’s endless stream of applications <a href="https://www.nobelprize.org/prizes/chemistry/1998/summary/">won Kohn a Nobel prize in 1998</a>.</p>
<h2>The Functional Ladder</h2>
<p>As researchers ask for more precision from DFT, they’ve had to reckon with the ignorance stuffed into the exchange and correlation term of the functional, sharpening the details of their sketch to bring it more in line with the universal density functional.</p>
<p><a href="https://www.fkf.mpg.de/person/52522/5567042">Aron Cohen</a>, a theoretical chemist at the artificial intelligence company DeepMind, is among those searching for the mythical universal equation. To stay grounded in the abstract landscape of theoretical quantum chemistry, he keeps a blue 3D-printed desk toy on hand. It looks like a plastic fortune cookie, and its curves trace out the exact shape of a functional that is universal, but only for the simplest of systems: It can be used to reveal anything one might wish to know about two electrons shared between any two atoms. Still, it reminds him that a functional that can handle any number of electrons and atoms may exist. “The thing we’re looking for is like this,” he said; it’s just much more complicated. “It’s a real thing.”</p>

<p>A major goal of DFT research is to find more accurate approximations of that universal functional. <a href="https://phys.cst.temple.edu/john-perdew.html">John Perdew</a>, a physicist at Temple University and a leading functional developer, has long spearheaded this work. He describes the path toward the universal functional as like climbing the rungs on a ladder. On each rung, physicists add new ingredients to the functional. The simplest ingredient is just the thickness of the electron stew in each location. On the next rung, the functional also considers how quickly the thickness changes from place to place, giving researchers a broader view and making the functional more precise.</p>
<p>A key part of Perdew’s strategy is to use physical reasoning to identify certain mathematical properties that good approximations must obey, known as “exact constraints.” Higher rungs satisfy more of these constraints, and researchers have to search harder to find equations that obey them all.</p>
<p>Perdew’s group started tackling third-rung functionals, which blend six ingredients, in 1999, and in 2015, he released a <a href="https://arxiv.org/abs/1511.01089">state-of-the-art functional called SCAN</a>. It was his eighth attempt, and the first to obey all 17 known constraints relevant on the third rung. Applicable to both molecules and solids, SCAN has proved one of the most capable approximations of the universal functional yet discovered.</p>
<p>“There are very rich possibilities for third-rung functionals,” Perdew said. “It takes time to figure out what is important and what works.”</p>
<h2><strong>Enter the Machines</strong></h2>
<p>As Perdew refined the art of improving density functionals with physical intuition, a revolution was brewing. Could algorithms ferret out patterns in electron behavior too subtle for humans to write down mathematically?</p>
<p>In 2012, Burke and his collaborators made the first modern attempt to <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.108.253002">apply machine learning</a> to a set of simplified electrons. His one-dimensional prototype motivated him and other groups to see if algorithms could hoist researchers further up the ladder.</p>
<p>One breakthrough came <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.126.036401">in early 2021</a>, when Burke and collaborators set up a neural network for a toy problem that could keep track of density errors as well as energy errors in a way that most previous attempts had ignored. “To get a functional which gives you both density and energy, you need a very flexible architecture,” said <a href="https://wwwen.uni.lu/research/fstm/dphyms/people/alexandre_tkatchenko">Alexandre Tkatchenko</a>, a theoretical chemist at the University of Luxembourg. “It’s not easy to write a functional form with your mind.”</p>
<p>Fernández-Serra at Stony Brook used a similar strategy to design a neural network that would study a range of molecules and energies and search for a third-rung functional obeying most known constraints, essentially using a machine to retrace Perdew’s footsteps.</p>
<p>The resulting exchange and correlation functional beat SCAN in predicting the energies of unfamiliar molecules by roughly 10%, as she and Sebastian Dick <a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.104.L161109">reported in <em>Physical Review B</em></a> in the fall of 2021. But the modest gain suggested that Perdew’s work had already come close to finding the third rung’s ceiling.</p>
<p>“Physical intuition has somehow exhausted almost all that you can reach,” Fernández-Serra said. “Perdew’s functional really is as good as you can get without using machine learning.”</p>
<p>Climbing higher would require more complicated inputs — and algorithms to make sense of them.</p>
<h2>DeepMind Scales the Ladder</h2>
<p>Shortly before the pandemic, researchers at DeepMind, having conquered the board game Go, were searching for new challenges. They were especially interested in scientific machine learning problems, and Cohen pitched them DFT. He had spent years studying exact functionals of simple systems, like the one he keeps on his desk. But they were nowhere near complex enough to describe the real world.</p>
<p>“It felt like a long path to get to something that would be useful for chemistry,” he said.</p>
<p>One weakness at the heart of DFT ate away at Cohen in particular. Current density functionals often smear out electrons too much. The problem is especially glaring for lopsided systems, where electrons should gather mostly on one molecule. DFT tends to spread out the electron soup more evenly across both molecules. A related problem appears in chemical reactions, when DFT gives incorrect energies for particles merging and pulling apart, even for cases as simple as hydrogen atoms. “It’s this workhorse,” Cohen said, “but I know it has these massive failures.”</p>

<p>To design their next-generation functional, Cohen and the DeepMind team opted not to worry so much about satisfying a long list of physical principles. Instead, they’d lean on data, lots of data. They scoured the literature for databases of thousands of molecules with known energies (calculated at great cost using the Schrödinger equation or similar methods). Then they went further, using supercomputers to crunch the energies of hundreds of additional molecules — many of which took days to calculate.</p>
<p>While the team assembled an exhaustive library of example molecules, Cohen and other chemists decided how the functional should be structured.</p>
<p>They landed on a tantalizingly versatile approach. Over years of trial and error, researchers had found a special recipe for estimating part of the exchange and correlation functional. There was a sweet spot in performance when 80% of the energy for one piece of the functional was calculated in one way and 20% in another. Researchers had long suspected that the next step would be to let the 80/20 ratio vary from point to point around a molecule, but no one had fully succeeded in doing this.</p>
<p>There have been “100 papers maybe where people played with this form, but they hadn’t produced something that everybody could use,” said Burke, who <a href="https://pubs.acs.org/doi/10.1021/jp980950v">introduced</a> this type of functional in 1998. “Maybe it’s too hard for a person.”</p>
<p>With its sea of example molecules and the machine learning expertise of the DeepMind team, the group’s neural network was able to train a flexible fourth-rung functional of just that type. It can estimate the energies of a wide array of molecules better than SCAN and other top competitors, largely because it places electrons more accurately and better describes their spins. The functional, dubbed DM21, is the first general-purpose functional capable of handling the breaking and forming of chemical bonds. On December 9, the group <a href="https://www.science.org/doi/10.1126/science.abj6511">described their functional</a> in <em>Science</em>.</p>
<p>“This is the first reasonably general-purpose functional,” said Burke, who was not involved. “If this thing is as good as it looks, thousands of people will start using it within a year.”</p>
<p>However, Burke cautions that fully testing the functional will take time. The field is littered with the wreckage of functionals that initially looked promising but hid fatal flaws, and researchers have only just begun to pick apart DM21.</p>
<p>One weakness is that DM21 trained on molecules from the first three rows of the periodic table, where data is more plentiful. That means the electron behavior it learned may not carry over to metal atoms or solid materials, both of which are crucial for analyzing the <a href="https://www.quantamagazine.org/mega-magnet-reveals-superconductor-secret-20160222/">copper-based family</a> of high-temperature superconductors, for instance. The details of the universal functional representing those systems remain, for now, better approximated by SCAN and other functionals.</p>
<p>“For the foreseeable future, I don’t think there will be one functional that will do it all,” Tkatchenko said.</p>
<h2>Toward a Universal Functional</h2>
<p>The development of new functionals like those of Fernández-Serra and DeepMind suggests that machine learning can be a powerful tool for exploring new regions of the universal density functional, particularly those corresponding to molecules and chemistry.</p>
<p>It’s good for “really adjusting for the part of chemical space you want to address and making this functional as efficient as possible,” said Tkatchenko. “I think machine learning techniques really are here to stay.”</p>

<p>But whether improved chemistry functionals will reveal general features relevant to everything from atoms to materials remains to be seen. Perdew, for example, continues to search for new intuitive qualities that can further refine functionals in the traditional way. “I probably won’t put a lot of time into machine learning efforts,” he said, “because although machines can learn, they can’t yet explain to us what they have learned.”</p>
<p>Cohen hopes that DM21 has glimpsed universal features that could become enduring elements of future approximations, whether they’re generated by human minds or neural networks.</p>
<p>“The functional is infinitely complicated, so making any attack on it is good,” he said. “Ideally we’d like to unify them all.”</p>
</div></div></div></section></div></div>
  </body>
</html>
