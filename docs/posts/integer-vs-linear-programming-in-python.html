<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mlabonne.github.io/blog/linearoptimization/">Original</a>
    <h1>Integer vs. Linear Programming in Python</h1>
    
    <div id="readability-page-1" class="page"><div>

<div>
    <div>
<div><pre><span></span><span>UNITS</span> <span>=</span> <span>[</span>
    <span>&#39;🗡️Swordsmen&#39;</span><span>,</span>
    <span>&#39;🛡️Men-at-arms&#39;</span><span>,</span>
    <span>&#39;🏹Bowmen&#39;</span><span>,</span>
    <span>&#39;❌Crossbowmen&#39;</span><span>,</span>
    <span>&#39;🔫Handcannoneers&#39;</span><span>,</span>
    <span>&#39;🐎Horsemen&#39;</span><span>,</span>
    <span>&#39;♞Knights&#39;</span><span>,</span>
    <span>&#39;🐏Battering rams&#39;</span><span>,</span>
    <span>&#39;🎯Springalds&#39;</span><span>,</span>
    <span>&#39;🪨Mangonels&#39;</span><span>,</span>
<span>]</span>

<span>DATA</span> <span>=</span> <span>[</span>
    <span>[</span><span>60</span><span>,</span> <span>20</span><span>,</span> <span>0</span><span>,</span> <span>6</span><span>,</span> <span>70</span><span>],</span>
    <span>[</span><span>100</span><span>,</span> <span>0</span><span>,</span> <span>20</span><span>,</span> <span>12</span><span>,</span> <span>155</span><span>],</span>
    <span>[</span><span>30</span><span>,</span> <span>50</span><span>,</span> <span>0</span><span>,</span> <span>5</span><span>,</span> <span>70</span><span>],</span>
    <span>[</span><span>80</span><span>,</span> <span>0</span><span>,</span> <span>40</span><span>,</span> <span>12</span><span>,</span> <span>80</span><span>],</span>
    <span>[</span><span>120</span><span>,</span> <span>0</span><span>,</span> <span>120</span><span>,</span> <span>35</span><span>,</span> <span>150</span><span>],</span>
    <span>[</span><span>100</span><span>,</span> <span>20</span><span>,</span> <span>0</span><span>,</span> <span>9</span><span>,</span> <span>125</span><span>],</span>
    <span>[</span><span>140</span><span>,</span> <span>0</span><span>,</span> <span>100</span><span>,</span> <span>24</span><span>,</span> <span>230</span><span>],</span>
    <span>[</span><span>0</span><span>,</span> <span>300</span><span>,</span> <span>0</span><span>,</span> <span>200</span><span>,</span> <span>700</span><span>],</span>
    <span>[</span><span>0</span><span>,</span> <span>250</span><span>,</span> <span>250</span><span>,</span> <span>30</span><span>,</span> <span>200</span><span>],</span>
    <span>[</span><span>0</span><span>,</span> <span>400</span><span>,</span> <span>200</span><span>,</span> <span>12</span><span>*</span><span>3</span><span>,</span> <span>240</span><span>]</span>
<span>]</span>

<span>RESOURCES</span> <span>=</span> <span>[</span><span>183000</span><span>,</span> <span>90512</span><span>,</span> <span>80150</span><span>]</span>


<span>def</span> <span>solve_army</span><span>(</span><span>UNITS</span><span>,</span> <span>DATA</span><span>,</span> <span>RESOURCES</span><span>):</span>
  <span># Create the linear solver using the CBC backend</span>
  <span>solver</span> <span>=</span> <span>pywraplp</span><span>.</span><span>Solver</span><span>(</span><span>&#39;Maximize army power&#39;</span><span>,</span> <span>pywraplp</span><span>.</span><span>Solver</span><span>.</span><span>CBC_MIXED_INTEGER_PROGRAMMING</span><span>)</span>

  <span># 1. Create the variables we want to optimize</span>
  <span>units</span> <span>=</span> <span>[</span><span>solver</span><span>.</span><span>IntVar</span><span>(</span><span>0</span><span>,</span> <span>solver</span><span>.</span><span>infinity</span><span>(),</span> <span>unit</span><span>)</span> <span>for</span> <span>unit</span> <span>in</span> <span>UNITS</span><span>]</span>

  <span># 2. Add constraints for each resource</span>
  <span>for</span> <span>r</span><span>,</span> <span>_</span> <span>in</span> <span>enumerate</span><span>(</span><span>RESOURCES</span><span>):</span>
    <span>solver</span><span>.</span><span>Add</span><span>(</span><span>sum</span><span>(</span><span>DATA</span><span>[</span><span>u</span><span>][</span><span>r</span><span>]</span> <span>*</span> <span>units</span><span>[</span><span>u</span><span>]</span> <span>for</span> <span>u</span><span>,</span> <span>_</span> <span>in</span> <span>enumerate</span><span>(</span><span>units</span><span>))</span> <span>&lt;=</span> <span>RESOURCES</span><span>[</span><span>r</span><span>])</span>

  <span># 3. Maximize the new objective function</span>
  <span>solver</span><span>.</span><span>Maximize</span><span>(</span><span>sum</span><span>((</span><span>10</span><span>*</span><span>DATA</span><span>[</span><span>u</span><span>][</span><span>-</span><span>2</span><span>]</span> <span>+</span> <span>DATA</span><span>[</span><span>u</span><span>][</span><span>-</span><span>1</span><span>])</span> <span>*</span> <span>units</span><span>[</span><span>u</span><span>]</span> <span>for</span> <span>u</span><span>,</span> <span>_</span> <span>in</span> <span>enumerate</span><span>(</span><span>units</span><span>)))</span>

  <span># Solve problem</span>
  <span>status</span> <span>=</span> <span>solver</span><span>.</span><span>Solve</span><span>()</span>

  <span># If an optimal solution has been found, print results</span>
  <span>if</span> <span>status</span> <span>==</span> <span>pywraplp</span><span>.</span><span>Solver</span><span>.</span><span>OPTIMAL</span><span>:</span>
    <span>print</span><span>(</span><span>&#39;================= Solution =================&#39;</span><span>)</span>
    <span>print</span><span>(</span><span>f</span><span>&#39;Solved in </span><span>{</span><span>solver</span><span>.</span><span>wall_time</span><span>()</span><span>:</span><span>.2f</span><span>}</span><span> milliseconds in </span><span>{</span><span>solver</span><span>.</span><span>iterations</span><span>()</span><span>}</span><span> iterations&#39;</span><span>)</span>
    <span>print</span><span>()</span>
    <span>print</span><span>(</span><span>f</span><span>&#39;Optimal value = </span><span>{</span><span>solver</span><span>.</span><span>Objective</span><span>()</span><span>.</span><span>Value</span><span>()</span><span>}</span><span> 💪power&#39;</span><span>)</span>
    <span>print</span><span>(</span><span>&#39;Army:&#39;</span><span>)</span>
    <span>for</span> <span>u</span><span>,</span> <span>_</span> <span>in</span> <span>enumerate</span><span>(</span><span>units</span><span>):</span>
      <span>print</span><span>(</span><span>f</span><span>&#39; - </span><span>{</span><span>units</span><span>[</span><span>u</span><span>]</span><span>.</span><span>name</span><span>()</span><span>}</span><span> = </span><span>{</span><span>units</span><span>[</span><span>u</span><span>]</span><span>.</span><span>solution_value</span><span>()</span><span>}</span><span>&#39;</span><span>)</span>
  <span>else</span><span>:</span>
    <span>print</span><span>(</span><span>&#39;The solver could not find an optimal solution.&#39;</span><span>)</span>

<span>solve_army</span><span>(</span><span>UNITS</span><span>,</span> <span>DATA</span><span>,</span> <span>RESOURCES</span><span>)</span>
</pre></div>

    </div>
</div>
</div></div>
  </body>
</html>
