<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.autodidacts.io/taxonomy-is-hard/">Original</a>
    <h1>Taxonomy Is Hard</h1>
    
    <div id="readability-page-1" class="page"><div id="main-header">
<div>

    <p><a href="https://www.autodidacts.io">
        <img src="https://cdn.autodidacts.io/img/autodidacts/autodidacts-logo-small.png" alt="The Autodidacts Logo"/>
      </a>
    </p>

  <div>
    
    <h3>
      Exploring the universe from the inside out
    </h3>
  </div>

  <!-- <div class="main-header__menu-container"> -->
    
  <!-- </div> -->

</div>

</div><div id="content">

  <article>


      

      <section id="jlb-content">    
        <!--kg-card-begin: markdown--><!--Text started 2022-09-27-->
<p>We all have data that we need to store, and then find. <!--It can be paper files, or it can be digital files; it can be a small quantity or a vast quantity; but no matter what,-->Regardless of type, data tends to build up. Eventually, we need some system for organizing it into sensible categories.</p>
<p>It turns out, this problem is harder than it seems.</p>
<p>In this article, I&#39;m going to be talking about organizing digital files. However, most of the problems (and some of the solutions) also apply to paper files, spreadsheet tables, databases — and even physical objects.</p>
<p>Let&#39;s dig in.</p>
<h3 id="thenavecategorizationsystem">The Naïve Categorization System</h3>
<p>Starting out, most of us come up with a categorization system that makes intuitive sense, following the general guideline <em>a place for everything and everything in its place</em>.</p>
<p>Everyone&#39;s mind works differently. The structure of people’s categorization systems tend to reflect the way their mind works. Some people have hundreds of files piled in visual heaps on the digital (or physical) desktop, and it works for them. But most of us have some kind of nested folder structure, and most people I know organize it by type or project.</p>
<p>Here&#39;s an example:</p>
<pre><code>writing/
    fiction/
        in progress/
        draft/
        submitted/
        published/
    non-fiction/
    poetry/
        song lyrics/
    blog/
        post title/
reading/
photos/
learning/
music/
    recordings/
    practice and learning materials/
    original music/
    traditional songs and covers/
</code></pre>
<p>Obviously this is incomplete, but you get the idea. Organize things by context, in a way that makes sense, without overthinking it.</p>
<p>But you&#39;re probably already overthinking it, and if so, you have likely noticed several serious taxonomic flaws with the above directory structure!</p>
<h3 id="theproblemsexamples">The Problems: Examples</h3>
<p><strong>Exhibit A:</strong> The  <code>song lyrics</code> directory is a subdirectory of <code>writing</code>. But song lyrics also belong in the <code>music</code> directory. <!--(At the time I put it in the writing directory, there were no recordings in the music directory; the music directory may not have even existed.)--></p>
<!--So here we have an example of where naive categorization breaks down.-->
<p><strong>Exhibit B:</strong> <em>Some</em> of the photos in the <code>photos</code> directory are used in the blog that&#39;s in the <code>writing</code> directory.</p>
<p>I can see five ways of addressing Exhibit B:</p>
<ol>
<li>
<p>Move the photos that are used on the blog in the relevant post folder in the <code>blog</code> directory — and lose the convenience of having all photos in one place.</p>
</li>
<li>
<p>Make a <code>blog</code> subdirectory in <code>photos</code> with all the photos that are used on the blog — and then never know exactly which photos go with which post.</p>
</li>
<li>
<p><em>Copy</em> the photos that are used by the blog into the relevant blog subdirectory, leaving the canonical original copy with the original filename in the <code>photos</code> directory — and then have duplicates of those photos on the filesystem.</p>
</li>
<li>
<p>Get rid of the <code>photos</code> directory altogether, and put all photos in the folder of the project they belong to.</p>
</li>
<li>
<p>Give up and bury my head in the sand.</p>
</li>
</ol>
<p>All the options are kind of horrible. But the last one seems promising.</p>
<h3 id="thenavesolutionprojectbasedtaxonomies">The Naïve Solution: Project-Based Taxonomies</h3>
<p>I’ve had friends recommend — and I have started to move to — a <em>project based</em> categorization system. It solves many of the problems. For example, we don&#39;t have the problem of where to put speculative poetry (<code>fiction</code>, or <code>poetry</code>?), or any of the other problems that the above brittle hierarchy exhibits. Instead, we have a folder for each project (song, story, essay, etc.) that <em>everything</em> related to that project goes in: text, photos, reference material, <em>everything</em>.</p>
<p>Most often, the context we are working in is single-project, so this works well. I sit down to work on project <em>X</em>, not to work on “Lists and Spreadsheets” (another directory; not kidding). I have everything I need to work on that project, right at my fingertips.</p>
<p>But we still have two problems: duplication of files that are used in multiple projects, and loss of convenient access to files by <em>type</em>.</p>
<h3 id="theproblemsinabstract">The Problems, in Abstract</h3>
<!--Categorization systems run into four problems as the quantity and complexity of data grows:-->
<ol>
<li>
<p><strong>The re-use problem.</strong> Data is used by multiple projects.</p>
<ul>
<li>Does a book review belong in <code>reading</code>, or <code>writing</code>?</li>
</ul>
</li>
<li>
<p><strong>The interface problem.</strong> Sometimes we want to view data by type, not by project.</p>
<ul>
<li>That <code>photos</code> folder, even though it causes all kinds of problems, is there for a reason: sometimes we want to look at all the photos.</li>
</ul>
</li>
<li>
<p><strong>The mixed-quality problem.</strong> For every project, there is data that is invaluable and crucial, as well as a bunch of cruft created along the way.  Project-based taxonomies tend to mix this all together in a way that is unpleasant.</p>
<ul>
<li>Sometimes we want to exclude low-quality or third-party data from back-ups, due to limited space (or time).</li>
</ul>
</li>
<li>
<p><strong>The project-boundary problem.</strong> The boundaries of a “project” are fuzzy.</p>
<ul>
<li>I have an algebra rules website.  I&#39;m working on an algebra rules poster. I abandoned an algebra rules course. Are these three projects, or one?</li>
</ul>
</li>
</ol>
<h3 id="symlinkstotherescue">Symlinks to the Rescue?</h3>
<p>We can solve two problems at once by using <a href="https://en.wikipedia.org/wiki/Symbolic_link">symbolic links</a>. We can have our avocado toast and eat it too, by having type folders <em>and</em> project folders!</p>
<pre><code>photos
  repellent-author-portrait.jpg

mangy-blogpost
  symlink-to-repellent-author-portrait.jpg
navelgazing-short-story
  another-symlink-to-same-repellent-author-portrait.jpg
</code></pre>
<p>Now, we have projects that contain everything we need, and we have a convenient <em>type-based</em> interface for all photos. Plus, we only store one copy of the file on disk. <!--And, because symlinks, we can easily ignore the photos if we backup the writing folder (though we could have done that before just as easily).--></p>
<p>Have we solved the hard problems of taxonomies yet?</p>
<p>Uh... not quite.</p>
<!--This approach has two problems:-->
<ol>
<li>
<p><strong>Symlinks are brittle</strong>. As soon as you re-organize the <code>photos</code> folder, or rename something further up the tree, <strong>all the symlinks to that original .jpg break.</strong> It sucks. Spreadsheets update references when data is moved; why can&#39;t we have nice things like that on the filesystem?</p>
</li>
<li>
<p><strong>Having a bajillion symlinks to one file is gross.</strong> I don&#39;t know what it is exactly, but there&#39;s something ... <em>messy</em> about this approach. Symlinks aren’t technically duplicate files, but they feel like they are.</p>
</li>
</ol>
<h3 id="tagstotherescue">Tags to the Rescue!</h3>
<!--The fundamental problem with file taxonomies is that -->
<p><strong>Directories are hierarchical, and life is not.</strong> The best solution I’ve come up with is to give up on directory structures and symlinks, and use <em>tags</em> for all organization.</p>
<p>Now, we can tag that author photo with <code>project:storytitle</code>, <code>project:essaytitle</code>, and <code>type:photo</code>. This means:</p>
<ol>
<li>
<p>Zero file duplication (not even symlinks!)</p>
</li>
<li>
<p>Multiple convenient overlapping “interfaces” — just view all files tagged <code>project:storytitle</code>, or <code>type:photo</code> (you could call it <code>project:photos</code>)</p>
</li>
<li>
<p>Freedom from the tyranny of rigid directory structures. Throw all your files in one giant potpourri folder — or keep your existing broken directory structure as is. Tag-based taxonomies enhance your existing organization system, rather than replacing it. (You can use your existing directory structure to automatically apply project and type tags to your files.)</p>
</li>
</ol>
<h2 id="filetaggingintherealworld">File Tagging in the Real World</h2>
<p>We have a promising theoretical solution to <em>The Hard Problem of Taxonomy</em>. <!--(For digital files, at least; tags are hard to implement in meatspace.)--> <!--But marriage is not the honeymoon, and it turns out that--> But the software to implement it is still in diapers.</p>
<!--Alright. We’ve outlined the problems, and found a promising theoretical solution. I’m going to leave it there for this article, before it <!-gets crazy long->becomes too sprawling. -->
<!--**Part II** will look at the real-world options for file tagging. It will go into the gory technical details of the various ways file tags can be stored, operating system specific considerations, third party tagging software, and more. Drop your email below to get it in your inbox as soon as it's published.
**Next up: file tagging in the real world.**  Part II will go into the gory technical details of the various ways file tags can be stored, operating system specific considerations, third party tagging software, the limitations (gasp!) of tab-based file categorization, and more. Enter your email below to get it in your inbox as soon as it is published.<span class="end-mark"></span>


--> 
<h3 id="metadatastorage">Metadata Storage</h3>
<p>There are several places tags for a file can be stored. None of them are a panacea.</p>
<ol>
<li>
<p><strong><a href="https://en.wikipedia.org/wiki/Extended_file_attributes">Extended file attributes</a></strong> (called “alternate data streams” on Windows, and “named forks” on Mac) are a filesystem-level way of storing metadata. They are ‘attached’ to the file in a sense, and travel with it where extended attributes are supported, but they aren&#39;t embedded in the file itself.</p>
<ul>
<li><strong>Pros:</strong> works with all filetypes, all major operating systems support them in some form, they travel with the file when it is moved or renamed.</li>
<li><strong>Cons:</strong> not many tagging tools support them, poor operating system level integration on Linux and Windows, different operating systems’ implementations are largely non-interoperable, can only store ~4kb of metadata on some filesystems, poor portability.</li>
</ul>
</li>
<li>
<p><strong><a href="https://en.wikipedia.org/wiki/Sidecar_file">Sidecar files</a>.</strong> These are typically plaintext or XML files that are <a href="https://en.wikipedia.org/wiki/Hidden_file_and_hidden_directory">hidden</a> by default, most often stored 1:1 alongside the single file the metadata sidecar file refers to.</p>
<ul>
<li><strong>Pros:</strong> portable, simple, no size or characterset limits for metadata contained in them.</li>
<li><strong>Cons</strong>: multiple competing non-interoperable formats for tag sidecar files, creates clutter, hidden files can get left behind, can easily become unlinked if the file referred to is moved or renamed.</li>
</ul>
</li>
<li>
<p><strong>File-specific embedded metadata</strong> such as EXIF data, ID3 tags, Vorbis comments, <a href="https://en.wikipedia.org/wiki/IPTC_Information_Interchange_Model">IPTC</a> keywords, et cetera.</p>
<ul>
<li><strong>Pros:</strong> travels with the file, generally well-supported by operating systems and other software, industry standard for media files.</li>
<li><strong>Cons:</strong> not all filetypes have a place for it, different file formats have different fields.</li>
</ul>
</li>
<li>
<p><strong>Symbolic links.</strong> I&#39;m not sure if it’s ever done, but technically you could have tag directories, and then symlink files into them? It would probably be a putid approach. More often, files are tagged, and the file-tag relations are stored in a database, and symlinks are used as described below.</p>
<ul>
<li><strong>Pros:</strong> simple.</li>
<li><strong>Cons:</strong> very primitive approach, breaks when files are moved.</li>
</ul>
</li>
<li>
<p><strong>In the filename.</strong> This is such a bad idea I don&#39;t even want to talk about it. However, who hasn’t tried it?</p>
<ul>
<li><strong>Pros:</strong> simple, portable, widely supported.</li>
<li><strong>Cons:</strong> breaks your file naming system, makes your filenames horrible, limits tag length, limits characters that can be used in tags, may break spectacularly when moved to an OS with tighter constraints on allowed filenames.</li>
</ul>
</li>
<li>
<p><strong>A database</strong>. Rarely used on its own, though it could be. Generally, a database is used along with a virtual filesystem, with symlinks to the actual tagged files. A database is also generally required for any type of metadata that doesn&#39;t automatically travel with the file (such as sidecar files). A database is <em>also</em> generally needed to <em>index</em> tags stored in embedded metadata, or extended attributes. Storing tags <em>only</em> in a database seems like a bad idea, but pretty much any functional file tagging system is going to need some kind of database (often SQLite).</p>
<ul>
<li><strong>Pros:</strong> you kinda need one.</li>
<li><strong>Cons:</strong> Fragile, not necessarily portable, needs some kind of filesystem watcher that keeps it updated.</li>
</ul>
</li>
</ol>
<h3 id="operatingsystemsupportforfiletagging">Operating System Support for File Tagging</h3>
<p>Here’s the state of things:</p>
<ol>
<li>
<p><strong>MacOS has built in, filesystem-level tagging via extended file attributes</strong>. Tags are also stored in <code>.DS_Store</code> (a sidecar file that&#39;s already used for other things) as a fallback. These tags have first class-support in Finder and Spotlight.</p>
</li>
<li>
<p><strong>Windows supports tagging <em>some</em> types of files using IPTC keywords.</strong> The file manager has support for finding things via tags, but not for managing tags or tagging files in bulk. Windows also has its own version of extended attributes (“alternate data streams”), but nothing much uses them. They’re used to to store the url of files downloaded from the internet, so that Windows can display a warning when the user tries to run them.</p>
</li>
<li>
<p><strong>Linux is still in the stone age when it comes to tagging.</strong> Common Linux filesystems (including ext4 &amp; ZFS) <em>support</em> extended attributes, but I&#39;m not aware of any Linux distro or file manager that includes tagging features based on them (or embedded metadata, for that matter).</p>
</li>
</ol>
<h3 id="thirdpartytaggingsoftwareforlinux">Third-Party Tagging Software for Linux</h3>
<p>Third-party tagging software for Linux includes command-line tools</p>
<!--Why are they all built on symlinks? Because **MacOS is the only major operating system that supports filesystem-level tagging.** Windows supports tags for some filetypes. Welcome to the stone age! -->
<p>I don’t know why none of the options use extended attributes. They could use the <a href="https://man7.org/linux/man-pages/man1/setfattr.1.html"><code>setfattr</code></a> &amp; <a href="https://man7.org/linux/man-pages/man1/getfattr.1.html"><code>getfattr</code></a> commands from the <code>attr</code> package. Likely it has to do with the fact that other apps (including core utilities like <code>cp</code>, without a specific flag) tend to destroy data stored in extended attributes, they aren&#39;t preserved by .zip compression (<code>tar</code> with <code>--xattrs</code> flag preserves them), and <a href="https://en.wikipedia.org/wiki/Comparison_of_file_systems#Metadata">not all filesystems</a> (notably, FAT32) support them in the first place. For more on extended attributes (which seem like the most promising option) see <a href="https://www.lesbonscomptes.com/pages/extattrs.html#_system_configuration">Extended attributes: the good, the not so good, the bad</a>.</p>
<p>It might be possible to keep symlinks from going stale with a file manager plugin that updates them when files are moved or renamed, or an indexer — but <a href="https://lobste.rs/s/u5iyme/tools_for_tag_based_file_management">I’ve asked</a>, and haven’t heard of any existing solution.</p>
<p>The more I look into TMSU, though, the more promising it looks. It doesn’t keep symlinks updated automatically, but it has a repair function that will reattach tags to files that have been moved or modified — as long they have not been both moved <em>and</em> modified! TMSU also offers <a href="https://github.com/oniony/TMSU/wiki/Tricks-and-Tips#delete-a-file">commands</a> for moving/renaming/deleting files while keeping tags fresh, and someone is even working on a <a href="https://github.com/talklittle/tmsu-nautilus-rs">Nautilus extension</a>. Best of all, based on issues <a href="https://github.com/oniony/TMSU/issues/10">#10</a>, <a href="https://github.com/oniony/TMSU/issues/86">#86</a>, and <a href="https://github.com/oniony/TMSU/issues/160">#160</a>, the developer seems open to the idea of supporting extended attributes, and has added them to the v0.8.0 milestone. <!--However, that was some time ago, so we probably shouldn’t hold our breath.--></p>
<small>
<p>Further reading:</p>
<ul>
<li><a href="https://git-annex.branchable.com/tips/metadata_driven_views/">Git Annex metadata-driven views</a></li>
<li><a href="https://www.lesbonscomptes.com/pages/tagfs.html">Extended attributes and tag file systems</a></li>
<li><a href="https://github.com/rrottmann/tag2xattr">tag2xattr — convert tags embedded in filename to Mac extended attributes</a></li>
<li><a href="https://rofi.roger-ferrer.org/eiciel/">Eiciel - Nautilus plugin to graphically edit ACL and extended attributes of files</a></li>
<li><a href="https://www.lesbonscomptes.com/recoll/pages/index-recoll.html">Recoll - fulltext document search app that supports extended attributes</a></li>
<li><a href="https://github.com/Ravn-Tech/HyperTag">HyperTag - newish CLI tagging tool with ML-powered semantic search (no longer actively updated)</a></li>
<li><a href="https://darkfeline.github.io/dantalian/">Dantalian - file tagging with hard links (no longer actively updated)</a></li>
<li><a href="https://github.com/immutag/immutag">Immutag - experimental tag-based, content-addressed distributed file manager (work in progress)</a></li>
<li><a href="https://epilys.github.io/bibliothecula/">Bibliothecula- document organizer with tags and full-text-search (archived)</a></li>
</ul>
</small>
<h3 id="inconclusion">(In)conclusion</h3>
<p>While we wait for better software (or go build it!), we can go ahead and use something like TMSU to tag files — and keep our existing (imperfect, but more reliable) directory structure as a fall-back.<!-- on systems that don't support our new-hotness taxonomy Thanks for reading! --></p>
<p>What are the limitations of tag-based organization? I have only just started moving my data to tag-based systems, so I can&#39;t say how well it works at scale<!-- yet-->. Tags have worked well in the few areas where I have been using them. From my reading, a common complaint is that tags get out of hand, and end up with duplicates and general inconsistency — requiring labour-intensive maintenance.</p>
<p>When I mentioned the problem of inconsistent tags to my brother — who has been using embedded-metadata tags for decades as a professional photographer — he patted me on the back and said, “Young man, you are at the start of a very long journey.” <span></span></p>


<!--kg-card-end: markdown-->
      </section>

      


  </article>
</div></div>
  </body>
</html>
