<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://news.ycombinator.com/item?id=42562750">Original</a>
    <h1>Happy New Year 2025</h1>
    
    <div id="readability-page-1" class="page"><div><li><p>SQLite is the most deployed and most used database. There are over one trillion (1000000000000 or a million million) SQLite databases in active use.</p><p>It is maintained by <a href="https://www.sqlite.org/crew.html">three people</a>. They don‚Äôt allow outside contributions.</p></li><li><p>SQLite is likely used more than all other database engines combined. Billions and billions of copies of SQLite exist in the wild. It‚Äôs everywhere.</p><img src="https://avi.im/blag/images/2024/sqlite-fact-1.png"/></li><li><p>It is also probably one of the top five most deployed software modules.</p><img src="https://avi.im/blag/images/2024/sqlite-fact-2.png"/></li><li><p><a href="https://hwaci.com">Hwaci</a> is the company behind SQLite. They are also into music(?)</p><p><img src="https://avi.im/blag/images/2024/sqlite-fact-3.png"/></p></li><li><p>SQLite originated from a US warship. D. Richard Hipp (DRH) was building software for the USS Oscar Austin, a Navy destroyer. The existing software would just stop working whenever the server went down (this was in the 2000s). For a battleship, this was unacceptable.</p><p>So DRH asked the question: what if the database just worked without any server? In DRH words:</p><blockquote><p>Why do we even need a server? Why can‚Äôt I pull this directly off the disk drive? That way if the computer is healthy enough, it can run our application at all, we don‚Äôt have dependencies that can fail and cause us to fail, and I looked around and there were no SQL database engines that would do that, and one of the guys I was working with says, ‚ÄúRichard, why don‚Äôt you just write one?‚Äù ‚ÄúOkay, I‚Äôll give it a try.‚Äù I didn‚Äôt do that right away, but later on, it was a funding hiatus. This was back in 2000, and if I recall correctly, Newt Gingrich and Bill Clinton were having a fight of some sort, so all government contracts got shut down, so I was out of work for a few months, and I thought, ‚ÄúWell, I‚Äôll just write that database engine now.‚Äù</p></blockquote></li><li><p>Unlike most open source project that uses standard licenses (like MIT or GPL), SQLite does not come with a OSI-approved license.</p><img src="https://avi.im/blag/images/2024/sqlite-fact-4.png"/><p>Instead, SQLite is released into the public domain and it has even fewer restrictions.</p><p>Also note that this can be a <a href="https://opensource.org/blog/public-domain-is-not-open-source">problem</a> in some countries/jurisdictions where public domain is not recognized. Hence, SQLite <a href="https://www.sqlite.org/purchase/license">sells licenses</a>, called ‚ÄòWarranty of Title‚Äô.</p></li><li><p>They don‚Äôt allow outside contributions. You <em>cannot</em> just send a pull request and hope the patch will be accepted.</p><img src="https://avi.im/blag/images/2024/sqlite-fact-5.png"/></li><li><p>Open Source, Not Open Contribution</p><img src="https://avi.im/blag/images/2024/sqlite-fact-6.png"/><p>Contributing to SQLite is invite-only (I don‚Äôt have a source). Only after you are invited and have signed an affidavit dedicating your contribution to the public domain can you submit patches.</p></li><li><p>How do they cook?</p><p>There are over 600 lines of test code for every line of code in SQLite. Tests cover 100% of branches (and 100% <a href="https://en.wikipedia.org/wiki/Modified_condition/decision_coverage">MC/DC</a>) in the library. The test suite is extremely diverse, including fuzz tests, boundary value tests, regression tests, and tests that simulate operating system crashes, power losses, I/O errors, and out-of-memory errors.</p></li><li><p>Interestingly, some SQLite tests are proprietary. The test suite called <a href="https://www.sqlite.org/th3.html">TH3 (Test Harness 3)</a>, which achieves 100% branch coverage of the code, is proprietary and is not open to access.</p><p>I don‚Äôt know any other project which has made code free, but test suites are paid.</p><p>However, they could not sell a single copy of TH3. DRH said in a podcast:</p><blockquote><p>The 100% MCD tests, that‚Äôs called TH3. That‚Äôs proprietary. I had the idea that we would sell those tests to avionics manufacturers and make money that way. We‚Äôve sold exactly zero copies of that so that didn‚Äôt really work out.</p></blockquote><p>In order to get access, one needs to be part of SQLite Consortium, which costs $120K/yearly.</p></li><li><p>It‚Äôs an interesting business model. They generate revenue through licenses, paid support, maintenance services, consortium membership, and commercial extensions.</p></li><li><p>SQLite does not have a Code of Conduct (CoC), rather <a href="https://sqlite.org/codeofethics.html">Code of Ethics</a> derived from ‚Äúinstruments of good works‚Äù from chapter 4 of The Rule of St. Benedict</p><img src="https://avi.im/blag/images/2024/sqlite-coe.png"/></li><li><p>In SQLite: In place of a legal notice, here is a <a href="https://github.com/sqlite/sqlite/blob/624cb96/src/wal.c#L4,#L9">blessing</a>:</p><img src="https://avi.im/blag/images/2024/sqlite-fact-11.jpeg"/><p>All the of the source code files come with a blessing.</p></li><li><p>SQLite is so fast, they compete with <code>fopen</code>. For some use cases, you can use SQLite instead of a filesystem, that can be 35% faster.</p><img src="https://avi.im/blag/images/2024/sqlite-fact-7.png"/></li><li><p>SQLite vs Redis (guess which is faster?)</p><img src="https://avi.im/blag/images/2024/sqlite-fact-8.png"/><p>For <a href="https://x.com/iavins/status/1849422515027763227">some usecases</a>, the SQLite can be faster than Redis due to network stack and (de)serialisation overhead.</p></li><li><p>But, unlike most databases, SQLite has a single writer model. You cannot have more than one concurrent writer.</p><p>This was also changed recently in 2010 by adding WAL mode. Before that, you could have either readers or a writer, but never together.</p></li><li><p>There are other things which are very common in other databases but not in SQLite:</p><ul><li>The default is rollback journal mode, which restricts you to have either multiple readers or a single writer</li><li>Foreign Keys are disabled; they are opt-in</li><li>It is ‚Äúweakly typed‚Äù. SQLite calls it ‚Äútype affinity‚Äù. Meaning you can insert whatever in a column even though you have defined a type. Strong typed columns are opt-in (by <a href="https://www.sqlite.org/stricttables.html"><code>STRICT</code></a> tables).</li><li><a href="https://sqlite.org/omitted.html">Many of the <code>ALTER</code> commands</a> you expect in other databases don‚Äôt work. For example, you cannot add a contraint to an existing column. (They recently added ability to rename a column name)</li></ul><p>There is a whole <a href="https://www.sqlite.org/quirks.html">list of quirks</a> here.</p></li><li><p>I hate that it doesn‚Äôt enforce types. It‚Äôs totally YOLO:</p><div><pre tabindex="0"><code data-lang="sql"><span><span><span>CREATE</span> <span>TABLE</span> <span>user</span>(id INTEGER);
</span></span><span><span><span>INSERT</span> <span>into</span> <span>user</span> <span>VALUES</span> (<span>&#34;YOLO!&#34;</span>); <span>--- This works!
</span></span></span></code></pre></div><p>Not only that, it does not throw any error if you give some random type.</p><p><code>CREATE TABLE t(value TIMMYSTAMP);</code></p><p>There is no <code>TIMMYSTAMP</code> type, but SQLite accepts this happily.</p><p>SQLite has five types: <code>NULL</code>, <code>INTEGER</code>, <code>REAL</code>, <code>TEXT</code>, <code>BLOB</code>. Want to know something cursed? The type affinity works by <a href="https://www.sqlite.org/datatype3.html#determination_of_column_affinity">substring match</a>!</p><div><pre tabindex="0"><code data-lang="sql"><span><span><span>CREATE</span> <span>TABLE</span> t(value SPONGEBLOB) <span>--- This is BLOB type!
</span></span></span></code></pre></div><p>So yeah, this happens too:</p><blockquote><p>Note that a declared type of ‚ÄúFLOATING POINT‚Äù would give INTEGER affinity, not REAL affinity, due to the ‚ÄúINT‚Äù at the end of ‚ÄúPOINT‚Äù.</p></blockquote></li><li><p>This is one my <a href="https://x.com/iavins/status/1865746403072389612">favorite lore</a>. SQLite had to change the default prefix from <code>sqlite_</code> to <code>etilqs_</code> when users started calling developers in the middle of the night</p><img src="https://avi.im/blag/images/2024/sqlite-fact-9.png"/></li><li><p>SQLite takes backward compatibility very seriously</p><blockquote><p>All releases of SQLite version 3 can read and write database files created by the very first SQLite 3 release (version 3.0.0) going back to 2004-06-18. This is ‚Äúbackwards compatibility‚Äù. The developers promise to maintain backwards compatibility of the database file format for all future releases of SQLite 3.</p></blockquote></li><li><p>But they take backward compatibility so seriously that even if they have <a href="https://x.com/iavins/status/1851276312876326980">shipped a bug</a>, they won‚Äôt fix it</p><img src="https://avi.im/blag/images/2024/sqlite-fact-10.png"/></li><li><p>SQLite‚Äôs author D. Richard Hipp (DRH) did not find existing version control systems suitable. So he wrote his own called <a href="https://fossil-scm.org/home/doc/trunk/www/fossil-v-git.wiki">Fossil</a>. Fossil is powered by SQLite, of course.</p><p>This reminds me of how Linus wrote Git.</p><p>DRH also wrote his own parser generator called Lemon.</p></li><li><p>DRH wrote the B-Tree based on the algorithm in the book TAOCP by Donald Knuth, coding it on a plane while traveling (super based)</p></li><li><p>SQLite is pronounced as ‚ÄúEss-Cue-El-ite‚Äù. There is no official guideline though. DRH mentioned in the <a href="https://web.archive.org/web/20201126110450/http://sqlite.1065341.n5.nabble.com/SQLite-Pronunciation-td88186.html#message88194">SQLite forums</a>:</p><blockquote><p>I wrote SQLite, and I think it should be pronounced ‚ÄúS-Q-L-ite‚Äù. Like a mineral. But I‚Äôm cool with y‚Äôall pronouncing it any way you want.</p><p>:-)</p></blockquote></li></div><p>That‚Äôs it for today! If I missed any, let me know. Happy holidays and Happy New Year! üéÑ ‚òÉÔ∏è</p></div>
  </body>
</html>
