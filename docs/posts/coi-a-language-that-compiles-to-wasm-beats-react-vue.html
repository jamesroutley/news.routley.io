<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://news.ycombinator.com/item?id=46696283">Original</a>
    <h1>Show HN: Coi – A language that compiles to WASM, beats React/Vue</h1>
    
    <div id="readability-page-1" class="page"><div><div><p>I usually build web games in C++, but using Emscripten always felt like overkill for what I was doing. I don&#39;t need full POSIX emulation or a massive standard library just to render some stuff to a canvas and handle basic UI.</p><p>The main thing I wanted to solve was the JS/WASM interop bottleneck. Instead of using the standard glue code for every call, I moved everything to a Shared Memory architecture using Command and Event buffers.</p><p>The way it works is that I batch all the instructions in WASM and then just send a single &#34;flush&#34; signal to JS. The JS side then reads everything directly out of Shared Memory in one go. It’s way more efficient, I ran a benchmark rendering 10k rectangles on a canvas and the difference was huge: Emscripten hit around 40 FPS, while my setup hit 100 FPS.</p><p>But writing DOM logic in C++ is painful, so I built Coi. It’s a component-based language that statically analyzes changes at compile-time to enable O(1) reactivity. Unlike traditional frameworks, there is no Virtual DOM overhead; the compiler maps state changes directly to specific handles in the command buffer.</p><p>I recently benchmarked this against React and Vue on a 1,000-row table: Coi came out on top for row creation, row updating and element swapping because it avoids the &#34;diffing&#34; step entirely and minimizes bridge crossings. Its bundle size was also the smallest of the three.</p><p>One of the coolest things about the architecture is how the standard library works. If I want to support a new browser API (like Web Audio or a new Canvas feature), I just add the definition to my WebCC schema file. When I recompile the Coi compiler, the language automatically gains a new standard library function to access that API. There is zero manual wrapping involved.</p><p>I&#39;m really proud of how it&#39;s coming along. It combines the performance of a custom WASM stack with a syntax that actually feels good to write (for me atleast :P). Plus, since the intermediate step is C++, I’m looking into making it work on the server side too, which would allow for sharing components across the whole stack.</p><p>Example (Coi Code):</p><p>component Counter(string label, mut int&amp; value) {</p><pre><code>    def add(int i) : void {
        value += i;
    }

    style {
        .counter {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        button {
            padding: 8px 16px;
            cursor: pointer;
        }
    }

    view {
        &lt;div class=&#34;counter&#34;&gt;
            &lt;span&gt;{label}: {value}&lt;/span&gt;
            &lt;button onclick={add(1)}&gt;+&lt;/button&gt;
            &lt;button onclick={add(-1)}&gt;-&lt;/button&gt;
        &lt;/div&gt;
    }</code></pre><p>
}</p><p>component App {
    mut int score = 0;</p><pre><code>    style {
        .app {
            padding: 24px;
            font-family: system-ui;
        }
        h1 {
            color: #1a73e8;
        }
        .win {
            color: #34a853;
            font-weight: bold;
        }
    }

    view {
        &lt;div class=&#34;app&#34;&gt;
            &lt;h1&gt;Score: {score}&lt;/h1&gt;
            &lt;Counter label=&#34;Player&#34; &amp;value={score} /&gt;
            &lt;if score &gt;= 10&gt;
                &lt;p class=&#34;win&#34;&gt;You win!&lt;/p&gt;
            &lt;/if&gt;
        &lt;/div&gt;
    }</code></pre><p>
}</p><p>app {
    root = App; 
    title = &#34;My Counter App&#34;; 
    description = &#34;A simple counter built with Coi&#34;; 
    lang = &#34;en&#34;; 
}</p><p>Live Demo: <a href="https://io-eric.github.io/coi" rel="nofollow">https://io-eric.github.io/coi</a></p><p>Coi (The Language): <a href="https://github.com/io-eric/coi" rel="nofollow">https://github.com/io-eric/coi</a></p><p>WebCC: <a href="https://github.com/io-eric/webcc" rel="nofollow">https://github.com/io-eric/webcc</a></p><p>I&#39;d love to hear what you think. It&#39;s still far from finished, but as a side project I&#39;m really excited about :)</p></div></div></div>
  </body>
</html>
