<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://bobdahacker.com/blog/rbi-hacked-drive-thrus/">Original</a>
    <h1>We Hacked Burger King: How Auth Bypass Led to Drive-Thru Audio Surveillance</h1>
    
    <div id="readability-page-1" class="page"><article>
            <div>
                <h2>The Setup</h2>
<p>Picture this: Restaurant Brands International (RBI) ‚Äì the corporate overlords behind <strong>Burger King</strong>, <strong>Tim Hortons</strong>, and <strong>Popeyes</strong> ‚Äì control over <strong>30,000 locations worldwide</strong>. That&#39;s a lot of chicken sandwiches, maple syrup, and flame-broiled beef.</p>
<p>What they also control is something called the &#34;assistant&#34; platform ‚Äì the digital brain behind every drive-thru screen, bathroom tablet review, and the slightly-too-cheerful burger king employee asking if you want to make it a combo.</p>
<p>Spoiler alert: Their security was about as solid as a paper Whopper wrapper in the rain.</p>
<p>We stumbled upon vulnerabilities so catastrophic that we could access <strong>every single store</strong> in their global empire. From a Burger King in Times Square to that lonely Tim Hortons where Bugs Bunny shoulda taken a left turn at Albuquerque. Oh, and did we mention we could listen to your actual drive-thru conversations? Yeah, that happened too.</p>
<p>The platforms were spread across three domains, each with the same delicious vulnerabilities:</p>
<ul>
<li><code>https://assistant.bk.com</code></li>
<li><code>https://assistant.popeyes.com</code>  </li>
<li><code>https://assistant.timhortons.com</code></li>
</ul>
<p>Buckle up, this is going to be a wild ride. üçî</p>
<h2>The Vulnerabilities</h2>
<h3>The &#34;Anyone Can Join This Party&#34; Signup API</h3>
<p>Our journey began innocently enough. We tried logging in with fake credentials and discovered they were using AWS Cognito. The good news? The system worked exactly as designed. The bad news? They forgot to disable user signups. Oops.</p>
<p>After a quick email verification dance with AWS&#39;s <code>ConfirmSignup</code> method, we were in. But wait, there&#39;s more!</p>
<p>Using GraphQL introspection (because who doesn&#39;t love a good schema leak), we found an even easier signup endpoint that completely bypassed email verification. It was like finding a secret menu item, except this one came with user privileges.</p>
<pre><code>mutation SignUp {
  signUp(input: { email: &#34;<a href="https://bobdahacker.com/cdn-cgi/l/email-protection" data-cfemail="90f4f5f6f9fef9e4f5fce9bdfeffe4bdf1bdf8f1f3fbf5e2d0f5e8f1fde0fcf5bef3fffd">[email¬†protected]</a>&#34;, password: &#34;password123&#34; })
}
</code></pre>
<p>The cherry on top? <strong>They emailed us the password in plain text.</strong> In 2025. We&#39;re not even mad, just impressed by the commitment to terrible security practices.</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/Passwordemail.png" alt="Password sent in email"/></p>
<hr/>
<h3>&#34;Gotta Catch &#39;Em All&#34; - The Global Store Directory</h3>
<p>Once authenticated, we hit the jackpot: a single GraphQL endpoint that returned <strong>a store in their global empire</strong>. (the store ids were incrementing) Not just the store name, but the good stuff ‚Äì store employees personal information, internal IDs, configuration details.</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/Allthestores.png" alt="All the stores.png"/></p>
<p>But wait, there&#39;s more! We also found a GraphQL query to search users who have access to assistant by name, revealing personal info faster than you can say &#34;would you like fries with that data breach?&#34;</p>
<hr/>
<h3>The &#34;No Authentication, No Problem&#34; Token Generator</h3>
<p>Here&#39;s where things got spicy. We discovered a GraphQL mutation called <code>createToken</code> that was about as secure as leaving your house key under a welcome mat labeled &#34;HOUSE KEY HERE.&#34;</p>
<p>This beautiful piece of mutation accepted a <code>storeId</code> parameter and required <strong>absolutely zero authentication</strong>. None. Nada. Zilch.</p>
<pre><code>mutation CreateToken {
  createToken(input: { storeId: &#34;1&#34; })
}
</code></pre>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/CreateToken2.png" alt="CreateToken"/></p>
<p>This token wasn&#39;t just a key to one store ‚Äì it was the master key to the entire kingdom. With it, we could promote ourselves to admin status across the entire platform:</p>
<pre><code>mutation BecomeTheKing {
  updateUser(input: { id: &#34;definitely-us&#34;, roles: &#34;admin&#34; }) {
    roles  # Spoiler: it&#39;s &#34;admin&#34; now
  }
}
</code></pre>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/WeAreAdmin.png" alt="We Are Admin"/></p>
<h3>The Drive-Thru Equipment Store (A Detour Into Absurdity)</h3>
<p>While exploring, we stumbled upon RBI&#39;s equipment ordering website. The password protection? <strong>Client-side only.</strong> The password? <strong>Hardcoded in da HTML.</strong> </p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/hardCodedPassword.png" alt="Hard Coded Password"/></p>
<p>Here you could order drive-thru essentials like &#34;Single Lane Kits&#34; (tablets included!) or just grab a tablet for those bathroom feedback screens because apparently everything needs to be digital now.</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/singleLaneKit.png" alt="Single Lane Kit"/></p>
<hr/>
<h3>Welcome to the Drive-Thru Control Room</h3>
<p>The tokens unlocked access to the actual tablet interfaces used in stores. The tablet is primarly composed of what seems to be a web app.</p>
<p><strong>Main Screen</strong> (<code>https://assistant.bk.com/screens/main?authToken=yourNewBestFriend</code>)</p>
<ul>
<li>Lists previous conversations (spoiler: you can listen to them)</li>
<li>Shows the &#34;tone&#34; employees should focus on</li>
</ul>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/Screensystem.png" alt="Screen System"/></p>
<p><strong>Diagnostic Screen</strong> (<code>https://assistant.bk.com/screens/diagnostic?authToken=stillYourBestFriend</code>)</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/DiagnosticScreenPasswordProtected.png" alt="Diagnostic Screen Password Protected"/></p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/AdvancedPasswordSecurity.png" alt="Advanced Password Security"/></p>
<p>Once inside, we found APIs to control drive-thru audio levels. Want to blast customers&#39; eardrums or make them whisper their order? We got you covered:</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/EarBlast.png" alt="Ear Gain"/></p>
<p>Any store token could also list any store&#39;s drive-thru config, because apparently access control is just a suggestion.</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/GPIOStrings.png" alt="GPIOStrings.png"/></p>
<p>Notice something? Well it returns a JWT that can be used to call an API to return a signed AWS upload url, for any store&#39;s path, which is bad. Very bad. </p>
<p>First it was kind enough to reveal the missing values:</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/FileUploadApi.png" alt="FileUploadApi.png"/></p>
<p>Then it returned with the signed upload URL for &#34;amongus.mp4&#34;:</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/sus.png" alt="sus.png"/></p>
<hr/>
<h3>The Drive-Thru Surveillance State</h3>
<p>Now for the truly mind-blowing part: <strong>We could access actual voice recordings</strong> of customer orders. Which god knows how long they store those for.</p>
<p>Not just transcripts. Not just metadata. <strong>Raw audio files</strong> of real people ordering food, complete with background conversations, car radios, and sometimes personally identifiable information.</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/DriveTroughHistory2.png" alt="Drive Through History"/></p>
<p><em>Big Brother is watching, and he wants to know if you&#39;d like to supersize that</em></p>
<p>This audio goldmine was being fed into AI systems to analyze:</p>
<ul>
<li>Customer sentiment </li>
<li>Employee friendliness levels</li>
<li>Upsell success rates</li>
<li>Order processing times</li>
<li>How many times employees said &#34;You rule&#34; (because that&#39;s definitely a crucial business metric)</li>
</ul>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/HowFriendly.png" alt="How Friendly"/></p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/MoreStats.png" alt="More Stats"/></p>
<h3>The Bathroom Chronicles</h3>
<p>We found the code for the bathroom rating screen for the tablet was in the assistant panel as well, For example, the bathroom rating screen is located at:</p>
<p><code>https://assistant.bk.com/feedback/storeid/</code></p>
<p>Which we assume the tablet loads in a webapp with its storeId</p>
<p><img src="https://bobdahacker.com/static/images/blogs/rbi/Toiletrating.png" alt="Toiletrating.png"/></p>
<p>The cherry on this porcelain throne? The API that gets called for the feedback sends <strong>zero authentication</strong>. That&#39;s right ‚Äì you could spam bathroom reviews for every Burger King location without even proving you&#39;ve ever been within a mile of their restrooms.</p>
<p>Want to give a 5-star review to a bathroom in Tokyo while sitting in your pajamas in Ohio? The system says &#34;why not!&#34; üöΩ</p>
<hr/>
<h2>The Full Damage Report&#39;</h2>
<p>With our newfound admin powers, we could:</p>
<ul>
<li><strong>Add/remove/manage stores</strong> (Want to open a Burger King on the Moon? Now you can!)  </li>
<li><strong>View/edit employee accounts</strong> (Everyone gets a promotion!)  </li>
<li><strong>Send notifications to any store ids tablet</strong></li>
<li><strong>Access store analytics and sales data</strong> (Numbers, so many numbers)  </li>
<li><strong>Upload files to any store&#39;s systems</strong> (Via convenient JWT-signed AWS URLs)  </li>
<li><strong>AND More</strong></li>
</ul>
<hr/>
<h2>Privacy Violations of Epic Proportions</h2>
<ul>
<li>Access to <strong>thousands, possibly hundreds of thousands of voice recordings</strong> containing PII, if you visited a burger king and went thru the drive thru, your voice is probably in the aws bucket, and analyzed by AI.</li>
<li>GDPR lawyers worldwide suddenly perking up</li>
<li>We now know about your embarrassing order of 47 chicken nuggets at 2 AM</li>
</ul>
<hr/>
<h2>Timeline: The Speed Run</h2>
<table>
<thead>
<tr>
<th>When</th>
<th>What Happened</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Day 1</strong></td>
<td>&#34;Hey, let&#39;s see how this drive-thru system works&#34;</td>
</tr>
<tr>
<td><strong>Day 1, 2 hours later</strong></td>
<td>&#34;Oh no... OH NO... <strong>OH NO</strong>&#34;</td>
</tr>
<tr>
<td><strong>Day 1, 3 hours later</strong></td>
<td>&#34;We can hear people ordering food. This is not good.&#34;</td>
</tr>
<tr>
<td><strong>Day 1, same day</strong></td>
<td>RBI fixes everything faster than you can say &#34;code red&#34;</td>
</tr>
</tbody></table>
<p>Credit where it&#39;s due ‚Äì RBI&#39;s response time was impressive. However they never commented on the vulnerabilities or answered us. (I guess our report was too hot to handle.)</p>
<hr/>
<h2>The Fine Print</h2>
<p><em>No customer data was retained during this research. No drive-thru orders were harmed in the making of this blog post. Responsible disclosure protocols were followed throughout. We still think the Whopper is pretty good, but Wendys is better</em></p>
<p><strong>So Long, and Thanks for All the Fish</strong></p>
<section>
  
  <p><img src="https://bobdahacker.com/static/images/bobdahackerReal.png" alt="Bobdahacker Avatar"/>
    <span>ü§ù</span>
    <img src="https://avatars.githubusercontent.com/u/22559547?v=4" alt="BobTheShoplifter Avatar"/>
  </p>
  
  <h2>Official Hacker Collab</h2>
  
  <p>
    This blog is a proud and official <strong>@BobDaHacker</strong> &amp; <strong>@BobTheShoplifter</strong> collab.
  </p>
  
  <p>Check out the other Bob here:</p>
  
  <a target="_blank" rel="noopener noreferrer" href="https://github.com/BobTheShoplifter" target="_blank">
    
  </a>
    <a target="_blank" rel="noopener noreferrer" href="https://x.com/BobTShoplifter" target="_blank">
    
  </a>
</section>


            </div>
        </article></div>
  </body>
</html>
