<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://hk.jdx.dev/about.html">Original</a>
    <h1>Hk, a new Git hook manager</h1>
    
    <div id="readability-page-1" class="page"><div data-v-e6f2a212=""><div data-v-e6f2a212=""><div><p>hk is built by <a href="https://github.com/jdx" target="_blank" rel="noreferrer">@jdx</a>.</p><div><p>DANGER</p><p>Hey HN, I just published this thing <em>today</em> and have only spent about 3 days on it. It&#39;s about as young as a project gets. What I&#39;ve wrote on this page I got about 20% done with, moved onto something else, and hadn&#39;t come back to it. It certainly is not HN ready.</p><p>Until hk hits 1.0 read this like you would notes left on someone&#39;s desk—because that&#39;s effectively what it is.</p></div><h2 id="why-does-this-exist" tabindex="-1">Why does this exist? <a href="#why-does-this-exist" aria-label="Permalink to &#34;Why does this exist?&#34;">​</a></h2><p>In short: performance and <a href="https://mise.jdx.dev/" target="_blank" rel="noreferrer">mise-en-place</a>. Initially mise users wanted more functionality than mise provides in its basic <code>mise generate git-pre-commit</code> command provided—such as the ability to only run tasks when certain files are changed.</p><p>Rather than bake that into mise, I felt it was unique enough to warrant a new tool. mise users <a href="https://hk.jdx.dev/mise_integration.html">benefit</a> quite a bit from pairing hk with mise, but hk certainly doesn&#39;t require mise at all.</p><p>Once I started looking into this problem more I had quite a bit of ideas on how pre-commit hooks could run faster. These ideas are very experimental right now so I won&#39;t be documenting them until 1.0 but to my knowledge these are things no other git hook manager has.</p><p>hk also has a ton of <a href="https://github.com/jdx/hk/tree/main/pkl/builtins" target="_blank" rel="noreferrer">builtins</a> for common linters and formatters. Expect this list to grow significantly as we approach 1.0. (Also consider contributing to them!)</p><h3 id="comparison-to-lefthook" tabindex="-1">Comparison to lefthook <a href="#comparison-to-lefthook" aria-label="Permalink to &#34;Comparison to lefthook&#34;">​</a></h3><p><a href="https://lefthook.dev" target="_blank" rel="noreferrer">lefthook</a> is a tool for defining git hooks. Unlike pre-commit and hk, it mostly provides a config file for you to write your own hooks in. lefthook is less &#34;batteries included&#34; than hk.</p><ul><li>lefthook is written in go, hk is written in rust. This will make hk faster but the advanced parallelism logic in hk should make hk much faster. Because git hook managers are often limited not by their own logic but the speed of the commands they run, this should make hk signficantly faster in real-world usage.</li><li>Using pkl instead of yaml/toml/etc means that a lot of features in lefthook we simply don&#39;t need to build like <code>extends</code> and <code>templates</code>. We get these for free with pkl.</li><li>lefthook just has &#34;run&#34; commands but hk separates out the concepts of &#34;check&#34; vs &#34;fix&#34; steps which gives control over when steps modify files and when they do not. This enables some of the advanced parallelism functionality in hk and also control to the user.</li></ul><h3 id="comparison-to-pre-commit" tabindex="-1">Comparison to pre-commit <a href="#comparison-to-pre-commit" aria-label="Permalink to &#34;Comparison to pre-commit&#34;">​</a></h3><p><a href="https://pre-commit.com/" target="_blank" rel="noreferrer">pre-commit</a> is a popular framework for git pre-commit hooks. It&#39;s built with a plugin model which allows sharing of common pre-commit logic. As I see it, here are the drawbacks of pre-commit compared to hk:</p><ul><li>I find pre-commit generally quite clunky.</li><li>hk is written in rust, pre-commit is written in python. hk will be much faster.</li><li>I find pre-commit plugins to be painful to work with. The ergonomics of <code>.pre-commit-config.yaml</code> I felt left a lot to be desired. Specifically, I don&#39;t like that I need to look up the rev for each plugin before I&#39;m able to install it.</li><li>hk gets around needing plugins (for now) by putting the entire configuration in pkl. pkl files can be loaded via http without any extra work in hk so we basically get plugins &#34;for free&#34; this way.</li><li>because hk uses pkl, loading the steps is much faster because pkl doesn&#39;t have any runtime logic that needs to be computed.</li><li>I read that pre-commit has some parallel execution capabilities, but the docs don&#39;t explain anything about it. A proper git hook manager should have advanced configuration around parallel execution to be able to group steps that can run in parallel and segment out those that can&#39;t.</li></ul><h2 id="roadmap" tabindex="-1">Roadmap <a href="#roadmap" aria-label="Permalink to &#34;Roadmap&#34;">​</a></h2><p>There isn&#39;t one yet. This project will hit 1.0 when I feel it has good enough parity that almost anyone would be able to switch from lefthook or pre-commit to hk.</p><p>Until then, expect frequent breaking changes and experimentation as I try to identify the proper behavior of hk.</p><h2 id="contributing" tabindex="-1">Contributing <a href="#contributing" aria-label="Permalink to &#34;Contributing&#34;">​</a></h2><p>Contributions are welcome! Please open an issue or submit a PR.</p></div></div></div></div>
  </body>
</html>
