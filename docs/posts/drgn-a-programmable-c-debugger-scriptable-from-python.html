<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/osandov/drgn">Original</a>
    <h1>drgn: A programmable C debugger, scriptable from Python</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<a href="https://pypi.org/project/drgn/" rel="nofollow"><img alt="PyPI" src="https://camo.githubusercontent.com/ae889c2068bf5ba551b21844ac3edcfe8a57d8d0ca35223b6c6e4fe289263e4e/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6472676e" data-canonical-src="https://img.shields.io/pypi/v/drgn"/></a>
<a href="https://github.com/osandov/drgn/actions"><img alt="CI Status" src="https://github.com/osandov/drgn/workflows/CI/badge.svg"/>
</a>
<a href="https://drgn.readthedocs.io/en/latest/?badge=latest" rel="nofollow"><img alt="Documentation Status" src="https://camo.githubusercontent.com/3463dcc3a35f81eaa18fd849f1f0713a23805fc6b9776eecf360da77ce687d96/68747470733a2f2f72656164746865646f63732e6f72672f70726f6a656374732f6472676e2f62616467652f3f76657273696f6e3d6c6174657374" data-canonical-src="https://readthedocs.org/projects/drgn/badge/?version=latest"/></a>
<a href="https://github.com/psf/black"><img src="https://camo.githubusercontent.com/d91ed7ac7abbd5a6102cbe988dd8e9ac21bde0a73d97be7603b891ad08ce3479/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f64652532307374796c652d626c61636b2d3030303030302e737667" data-canonical-src="https://img.shields.io/badge/code%20style-black-000000.svg"/>
</a>
<p dir="auto">drgn (pronounced &#34;dragon&#34;) is a debugger with an emphasis on programmability.
drgn exposes the types and variables in a program for easy, expressive
scripting in Python. For example, you can debug the Linux kernel:</p>
<div dir="auto" data-snippet-clipboard-copy-content="&gt;&gt;&gt; from drgn.helpers.linux import list_for_each_entry
&gt;&gt;&gt; for mod in list_for_each_entry(&#39;struct module&#39;,
...                                prog[&#39;modules&#39;].address_of_(),
...                                &#39;list&#39;):
...    if mod.refcnt.counter &gt; 10:
...        print(mod.name)
...
(char [56])&#34;snd&#34;
(char [56])&#34;evdev&#34;
(char [56])&#34;i915&#34;"><pre>&gt;&gt;&gt; <span>from</span> drgn.helpers.linux <span>import</span> list_for_each_entry
&gt;&gt;&gt; <span>for</span> mod <span>in</span> list_for_each_entry(<span><span>&#39;</span>struct module<span>&#39;</span></span>,
...                                prog[<span><span>&#39;</span>modules<span>&#39;</span></span>].address_of_(),
...                                <span><span>&#39;</span>list<span>&#39;</span></span>):
...    <span>if</span> mod.refcnt.counter <span>&gt;</span> <span>10</span>:
...        <span>print</span>(mod.name)
...
(char [56])&#34;snd&#34;
(char [56])&#34;evdev&#34;
(char [56])&#34;i915&#34;</pre></div>
<p dir="auto">Although other debuggers like <a href="https://www.gnu.org/software/gdb/" rel="nofollow">GDB</a> have
scripting support, drgn aims to make scripting as natural as possible so that
debugging feels like coding. This makes it well-suited for introspecting the
complex, inter-connected state in large programs.</p>
<p dir="auto">Additionally, drgn is designed as a library that can be used to build debugging
and introspection tools; see the official <a href="https://github.com/osandov/drgn/tree/main/tools">tools</a>.</p>
<p dir="auto">drgn was developed at <a href="https://opensource.fb.com/" rel="nofollow">Meta</a> for debugging the
Linux kernel (as an alternative to the <a href="https://crash-utility.github.io/" rel="nofollow">crash</a> utility), but it can also debug userspace
programs written in C. C++ support is in progress.</p>
<p dir="auto">Documentation can be found at <a href="https://drgn.readthedocs.io" rel="nofollow">drgn.readthedocs.io</a>.</p>
<a name="user-content-installation"></a>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>
<a name="user-content-package-manager"></a>
<h3 dir="auto"><a id="user-content-package-manager" aria-hidden="true" href="#package-manager"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Package Manager</h3>
<p dir="auto">drgn can be installed using the package manager on some Linux distributions.</p>
<a href="https://repology.org/project/drgn/versions" rel="nofollow"><img alt="Packaging Status" src="https://camo.githubusercontent.com/c0da51c3d208f323d4722d7bd27e0005dd106a89a0dfa3493967fbc68a54510c/68747470733a2f2f7265706f6c6f67792e6f72672f62616467652f766572746963616c2d616c6c7265706f732f6472676e2e737667" data-canonical-src="https://repology.org/badge/vertical-allrepos/drgn.svg"/>
</a>
<ul dir="auto">
<li><p dir="auto">Fedora &gt;= 32</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo dnf install drgn"><pre>$ <span>sudo dnf install drgn</span></pre></div>
</li>
<li><p dir="auto">RHEL/CentOS &gt;= 8</p>
<p dir="auto"><a href="https://docs.fedoraproject.org/en-US/epel/#_quickstart" rel="nofollow">Enable EPEL</a>. Then:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo dnf install drgn"><pre>$ <span>sudo dnf install drgn</span></pre></div>
</li>
<li><p dir="auto">Arch Linux</p>
<p dir="auto">Install the <a href="https://aur.archlinux.org/packages/drgn/" rel="nofollow">drgn</a> package from
the <a href="https://wiki.archlinux.org/title/Arch_User_Repository" rel="nofollow">AUR</a>.</p>
</li>
<li><p dir="auto">Debian &gt;= 12 (Bookworm)</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo apt install python3-drgn"><pre>$ <span>sudo apt install python3-drgn</span></pre></div>
</li>
<li><p dir="auto">openSUSE</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo zypper install python3-drgn"><pre>$ <span>sudo zypper install python3-drgn</span></pre></div>
</li>
<li><p dir="auto">Ubuntu</p>
<p dir="auto">Enable the <a href="https://launchpad.net/~michel-slm/+archive/ubuntu/kernel-utils" rel="nofollow">michel-slm/kernel-utils PPA</a>.
Then:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo apt install python3-drgn"><pre>$ <span>sudo apt install python3-drgn</span></pre></div>
</li>
</ul>
<a name="user-content-pip"></a>
<h3 dir="auto"><a id="user-content-pip" aria-hidden="true" href="#pip"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>pip</h3>
<p dir="auto">If your Linux distribution doesn&#39;t package the latest release of drgn, you can
install it with <a href="https://pip.pypa.io/" rel="nofollow">pip</a>.</p>
<p dir="auto">First, <a href="https://packaging.python.org/guides/installing-using-linux-tools/#installing-pip-setuptools-wheel-with-linux-package-managers" rel="nofollow">install pip</a>.
Then, run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo pip3 install drgn"><pre>$ <span>sudo pip3 install drgn</span></pre></div>
<p dir="auto">This will install a binary wheel by default. If you get a build error, then pip
wasn&#39;t able to use the binary wheel. Install the dependencies listed <a href="#from-source">below</a> and try again.</p>
<p dir="auto">Note that RHEL/CentOS 6, Debian Stretch, Ubuntu Trusty, and Ubuntu Xenial (and
older) ship Python versions which are too old. Python 3.6 or newer must be
installed.</p>
<a name="user-content-from-source"></a>
<h3 dir="auto"><a id="user-content-from-source" aria-hidden="true" href="#from-source"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>From Source</h3>
<p dir="auto">To get the development version of drgn, you will need to build it from source.
First, install dependencies:</p>
<ul dir="auto">
<li><p dir="auto">Fedora</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo dnf install autoconf automake elfutils-devel gcc git libkdumpfile-devel libtool make pkgconf python3 python3-devel python3-pip python3-setuptools"><pre>$ <span>sudo dnf install autoconf automake elfutils-devel gcc git libkdumpfile-devel libtool make pkgconf python3 python3-devel python3-pip python3-setuptools</span></pre></div>
</li>
<li><p dir="auto">RHEL/CentOS</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo dnf install autoconf automake elfutils-devel gcc git libtool make pkgconf python3 python3-devel python3-pip python3-setuptools"><pre>$ <span>sudo dnf install autoconf automake elfutils-devel gcc git libtool make pkgconf python3 python3-devel python3-pip python3-setuptools</span></pre></div>
<p dir="auto">Optionally, install <code>libkdumpfile-devel</code> from EPEL on RHEL/CentOS &gt;= 8 or
install <a href="https://github.com/ptesarik/libkdumpfile">libkdumpfile</a> from
source if you want support for the makedumpfile format.</p>
<p dir="auto">Replace <code>dnf</code> with <code>yum</code> for RHEL/CentOS &lt; 8.</p>
</li>
<li><p dir="auto">Debian/Ubuntu</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo apt-get install autoconf automake gcc git liblzma-dev libelf-dev libdw-dev libtool make pkgconf python3 python3-dev python3-pip python3-setuptools zlib1g-dev"><pre>$ <span>sudo apt-get install autoconf automake gcc git liblzma-dev libelf-dev libdw-dev libtool make pkgconf python3 python3-dev python3-pip python3-setuptools zlib1g-dev</span></pre></div>
<p dir="auto">Optionally, install libkdumpfile from source if you want support for the
makedumpfile format.</p>
</li>
<li><p dir="auto">Arch Linux</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo pacman -S --needed autoconf automake gcc git libelf libtool make pkgconf python python-pip python-setuptools"><pre>$ <span>sudo pacman -S --needed autoconf automake gcc git libelf libtool make pkgconf python python-pip python-setuptools</span></pre></div>
<p dir="auto">Optionally, install <a href="https://aur.archlinux.org/packages/libkdumpfile/" rel="nofollow">libkdumpfile</a> from the AUR or from
source if you want support for the makedumpfile format.</p>
</li>
<li><p dir="auto">openSUSE</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo zypper install autoconf automake gcc git libdw-devel libelf-devel libkdumpfile-devel libtool make pkgconf python3 python3-devel python3-pip python3-setuptools"><pre>$ <span>sudo zypper install autoconf automake gcc git libdw-devel libelf-devel libkdumpfile-devel libtool make pkgconf python3 python3-devel python3-pip python3-setuptools</span></pre></div>
</li>
</ul>
<p dir="auto">Then, run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ git clone https://github.com/osandov/drgn.git
$ cd drgn
$ python3 setup.py build
$ sudo python3 setup.py install"><pre>$ <span>git clone https://github.com/osandov/drgn.git</span>
$ <span><span>cd</span> drgn</span>
$ <span>python3 setup.py build</span>
$ <span>sudo python3 setup.py install</span></pre></div>
<p dir="auto">See the <a href="https://drgn.readthedocs.io/en/latest/installation.html" rel="nofollow">installation documentation</a> for more options.</p>
<a name="user-content-quick-start"></a>
<h2 dir="auto"><a id="user-content-quick-start" aria-hidden="true" href="#quick-start"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Quick Start</h2>
<p dir="auto">drgn debugs the running kernel by default; run <code>sudo drgn</code>. To debug a
running program, run <code>sudo drgn -p $PID</code>. To debug a core dump (either a
kernel vmcore or a userspace core dump), run <code>drgn -c $PATH</code>. Make sure to
<a href="https://drgn.readthedocs.io/en/latest/getting_debugging_symbols.html" rel="nofollow">install debugging symbols</a> for
whatever you are debugging.</p>
<p dir="auto">Then, you can access variables in the program with <code>prog[&#39;name&#39;]</code> and access
structure members with <code>.</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ sudo drgn
&gt;&gt;&gt; prog[&#39;init_task&#39;].comm
(char [16])&#34;swapper/0&#34;"><pre>$ sudo drgn
&gt;&gt;&gt; prog[<span><span>&#39;</span>init_task<span>&#39;</span></span>].comm
(char [16])&#34;swapper/0&#34;</pre></div>
<p dir="auto">You can use various predefined helpers:</p>
<div dir="auto" data-snippet-clipboard-copy-content="&gt;&gt;&gt; len(list(bpf_prog_for_each(prog)))
11
&gt;&gt;&gt; task = find_task(prog, 115)
&gt;&gt;&gt; cmdline(task)
[b&#39;findmnt&#39;, b&#39;-p&#39;]"><pre>&gt;&gt;&gt; <span>len</span>(<span>list</span>(bpf_prog_for_each(prog)))
11
&gt;&gt;&gt; task <span>=</span> find_task(prog, <span>115</span>)
&gt;&gt;&gt; cmdline(task)
[b&#39;findmnt&#39;, b&#39;-p&#39;]</pre></div>
<p dir="auto">You can get stack traces with <code>prog.stack_trace()</code> and access parameters or
local variables with <code>stack_trace[&#39;name&#39;]</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="&gt;&gt;&gt; trace = prog.stack_trace(task)
&gt;&gt;&gt; trace[5]
#5 at 0xffffffff8a5a32d0 (do_sys_poll+0x400/0x578) in do_poll at ./fs/select.c:961:8 (inlined)
&gt;&gt;&gt; poll_list = trace[5][&#39;list&#39;]
&gt;&gt;&gt; file = fget(task, poll_list.entries[0].fd)
&gt;&gt;&gt; d_path(file.f_path.address_of_())
b&#39;/proc/115/mountinfo&#39;"><pre>&gt;&gt;&gt; trace <span>=</span> prog.stack_trace(task)
&gt;&gt;&gt; trace[<span>5</span>]
#5 at 0xffffffff8a5a32d0 (do_sys_poll+0x400/0x578) in do_poll at ./fs/select.c:961:8 (inlined)
&gt;&gt;&gt; poll_list <span>=</span> trace[<span>5</span>][<span><span>&#39;</span>list<span>&#39;</span></span>]
&gt;&gt;&gt; <span>file</span> <span>=</span> fget(task, poll_list.entries[<span>0</span>].fd)
&gt;&gt;&gt; d_path(<span>file</span>.f_path.address_of_())
b&#39;/proc/115/mountinfo&#39;</pre></div>
<p dir="auto">See the <a href="https://drgn.readthedocs.io/en/latest/user_guide.html" rel="nofollow">user guide</a>
for more details and features.</p>
<a name="user-content-license"></a>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">Copyright (c) Meta Platforms, Inc. and affiliates.</p>
<p dir="auto">drgn is licensed under the <a href="https://www.gnu.org/licenses/old-licenses/lgpl-2.1.en.html" rel="nofollow">LGPLv2.1</a> or later.</p>

</article>
          </div></div>
  </body>
</html>
