<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.kapa.ai/blog/ai-hallucination">Original</a>
    <h1>AI hallucinations: Why LLMs make things up (and how to fix it)</h1>
    
    <div id="readability-page-1" class="page"><div data-framer-name="Content" id="postcontent" data-framer-component-type="RichTextContainer"><p>An AI assistant casually promises a refund policy that never existed, leaving a company liable for an invented commitment. <!--$--><a href="https://arstechnica.com/tech-policy/2024/02/air-canada-must-honor-refund-policy-invented-by-airlines-chatbot/" target="_blank" rel="noopener">This incident with Air Canada’s chatbot</a><!--/$--> is a clear example of &#39;AI hallucination,&#39; where AI can generate confident, yet entirely fictional, answers. These errors—ranging from factual inaccuracies and biases to reasoning failures—are collectively referred to as &#39;hallucinations.&#39; </p><p>In simple terms, Large Language Models (LLMs) work like advanced &#39;autocomplete&#39; tools, generating content by predicting the next word in a sequence based on patterns in their training data. This process is like &#39;filling in the blanks&#39; without understanding the topic. Since LLMs lack true reasoning skills to check their outputs, they rely only on word probability patterns rather than comprehension.</p><p>At <!--$--><a href="https://www.kapa.ai/" target="_blank">kapa.ai</a><!--/$--> we&#39;ve worked with over 100 technical teams like Docker, CircleCI, Reddit and Monday.com to implement LLMs in production, so we wanted to share what we&#39;ve learned about managing hallucinations, which starts with a technical deep-dive into what they are. </p><p><img alt="" data-framer-asset="data:framer/asset-reference,80fBQ1qB2ZiFOWmRw7XXOjyXc.png" data-framer-height="1493" data-framer-width="1250" height="746" src="https://framerusercontent.com/images/80fBQ1qB2ZiFOWmRw7XXOjyXc.png" srcset="https://framerusercontent.com/images/80fBQ1qB2ZiFOWmRw7XXOjyXc.png?scale-down-to=1024 857w,https://framerusercontent.com/images/80fBQ1qB2ZiFOWmRw7XXOjyXc.png 1250w" width="625" data-framer-original-sizes="" sizes="(min-width: 1440px) 100vw, (min-width: 1200px) and (max-width: 1439px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p>(<!--$--><a href="https://medium.com/@cooper.white_86633/ai-hallucinations-the-ethical-burdens-of-using-chatgpt-5e62dd0f75c7" target="_blank" rel="noopener">source</a><!--/$-->)</p><h2>1. Why Are LLM Hallucinations Important?</h2><p>As Artificial Intelligence (AI) models become central to information retrieval and decision-making, trust in these technologies is paramount. AI chatbots have produced several well-known misleading statements, that have led to trust and reputational issues:</p><ul><li data-preset-tag="p"><p>Misinformation:<!--$--><a href="https://www.theverge.com/2023/2/8/23590864/google-ai-chatbot-bard-mistake-error-exoplanet-demo" target="_blank" rel="noopener"> Google’s Bard once inaccurately stated</a><!--/$--> in a promotional video that the James Webb Space Telescope captured the first exoplanet image. While it was actually the European Southern Observatory&#39;s Very Large Telescope.</p></li><li data-preset-tag="p"><p>Ethical concern: <!--$--><a href="https://x.com/kevinroose/status/1626216340955758594?lang=en" target="_blank" rel="noopener"> Microsoft&#39;s AI chatbot generated inappropriate responses</a><!--/$-->, such as professing emotions and attributing motivations to itself, which led to user discomfort and raised ethical questions about AI behavior.</p></li><li data-preset-tag="p"><p>Legal implications: A lawyer using ChatGPT for legal research included<!--$--><a href="https://www.theguardian.com/technology/2023/jun/23/two-us-lawyers-fined-submitting-fake-court-citations-chatgpt#:~:text=A%20US%20judge%20has%20fined,submitted%20in%20a%20court%20filing." target="_blank" rel="noopener"> fabricated citations and quotes,</a><!--/$--> resulting in a fine risking reputational damage and wasting judicial resources. </p></li></ul><p>These examples highlight how AI hallucinations can create reputational and trust issues for organizations.</p><p><img alt=".Microsoft&#39;s AI chatbot generated inappropriate responses" data-framer-asset="data:framer/asset-reference,OaB3HgMJZhPAzDeNUIkQr50A4I.png" data-framer-height="1314" data-framer-width="1416" height="657" src="https://framerusercontent.com/images/OaB3HgMJZhPAzDeNUIkQr50A4I.png" srcset="https://framerusercontent.com/images/OaB3HgMJZhPAzDeNUIkQr50A4I.png?scale-down-to=512 512w,https://framerusercontent.com/images/OaB3HgMJZhPAzDeNUIkQr50A4I.png?scale-down-to=1024 1024w,https://framerusercontent.com/images/OaB3HgMJZhPAzDeNUIkQr50A4I.png 1416w" width="708" data-framer-original-sizes="" sizes="(min-width: 1440px) 100vw, (min-width: 1200px) and (max-width: 1439px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/><img alt="" src="blob:https://framer.com/6d680715-c87b-4ca7-96a4-e5c706283832"/></p><h2>2. Why Do LLMs Hallucinate?</h2><p>LLM hallucinations stem from three core technical challenges: (A) <strong>model architecture limitations</strong>, (B) fundamental constraints of <strong>probabilistic generation</strong>, and (C) <strong>training data gaps.</strong></p><p><img alt="" data-framer-asset="data:framer/asset-reference,yVJHHaT9oH9AiLMGz7qux0BzgE.png" data-framer-height="459" data-framer-width="1374" height="229" src="https://framerusercontent.com/images/yVJHHaT9oH9AiLMGz7qux0BzgE.png" srcset="https://framerusercontent.com/images/yVJHHaT9oH9AiLMGz7qux0BzgE.png?scale-down-to=512 512w,https://framerusercontent.com/images/yVJHHaT9oH9AiLMGz7qux0BzgE.png?scale-down-to=1024 1024w,https://framerusercontent.com/images/yVJHHaT9oH9AiLMGz7qux0BzgE.png 1374w" width="687" data-framer-original-sizes="" sizes="(min-width: 1440px) 100vw, (min-width: 1200px) and (max-width: 1439px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p>View the<!--$--><a href="https://x.com/karpathy/status/1733299213503787018?lang=en" rel="noopener"> full tweet</a><!--/$--> for more detailed insight</p><h3>A. Design and Architectural Constraints:</h3><ul><li data-preset-tag="p"><p><!--$--><a href="https://arxiv.org/pdf/1906.06755" target="_blank" rel="noopener">Theoretical limitations</a><!--/$-->: The transformer-based<!--$--><a href="https://arxiv.org/pdf/1706.03762" target="_blank" rel="noopener"> attention</a><!--/$--> mechanism within an LLM enables the model to focus on parts of an input that are relevant. In transformer models, a fixed attention window restricts the length of input context the model can retain, leading to earlier content being &#39;dropped&#39; when sequences are too long. This constraint often<!--$--><a href="https://www.jeremyjordan.me/attention/" target="_blank" rel="noopener"> causes a breakdown in coherence and increases the likelihood of hallucinated</a><!--/$--> or irrelevant content in longer outputs.</p></li><li data-preset-tag="p"><p>Sequential token generation: LLMs generate responses one token at a time. Each token depends only on a previously generated token, and there is no way to revise earlier output. This design limits real-time error correction, causing initial mistakes to escalate into confidently incorrect completions.</p></li></ul><h3>B. Probabilistic Output Generation:</h3><ul><li data-preset-tag="p"><p><!--$--><a href="https://mitsloanedtech.mit.edu/ai/basics/addressing-ai-hallucinations-and-bias/#Why_is_AI_Flawed" target="_blank" rel="noopener">Limitations of generative models</a><!--/$-->: Generative AI models can produce responses that, while appearing plausible, lack true comprehension of the subject matter. For example, a supermarket’s AI meal planner suggested a chlorine gas recipe(which is toxic) as<!--$--><a href="https://www.theguardian.com/world/2023/aug/10/pak-n-save-savey-meal-bot-ai-app-malfunction-recipes" target="_blank" rel="noopener"> “the perfect nonalcoholic beverage to quench your thirst and refresh your senses”</a><!--/$-->—showing how, even assuming it was trained on valid data, AI can generate unsafe outputs without understanding context.</p></li><li data-preset-tag="p"><p>Unclear input handling: When faced with ambiguous or vague prompts, LLMs attempt to “fill in the blanks,” leading to speculative and sometimes incorrect responses.</p></li></ul><h3>C. Training Data Gaps:</h3><ul><li data-preset-tag="p"><p>Exposure bias: During training, models rely on &#39;ground truth&#39; data provided by human annotators as the basis for predicting the next words. However, during the Inference stage, they must depend on their own previously generated synthetic data. This creates this feedback loop whereby<!--$--><a href="https://aclanthology.org/2022.findings-acl.58.pdf" target="_blank" rel="noopener"> slight mistakes earlier in the process amplify with time and often cause the system to drift away in coherence and accuracy</a><!--/$-->.</p></li><li data-preset-tag="p"><p>Training data coverage gaps: Despite being trained on vast datasets, models often will not cover less frequent or niche information. Models, therefore, when tested on these aspects, inevitably result in a response that contains hallucination. Underrepresented patterns or overfitting on commonly occurring information impact generalization, especially for out-of-scope inputs.</p></li></ul><h2>3. How To Mitigate AI Hallucination?</h2><p>While the<!--$--><a href="https://arxiv.org/pdf/2401.11817" target="_blank" rel="noopener"> hallucination problem in LLMs is inevitable</a><!--/$-->, they can be significantly reduced through a three-layer defense strategy: (A) <strong>input layer</strong> controls that optimize queries and context, (B) <strong>design layer </strong>implementations that enhance model architecture and training, and (C) <strong>output layer</strong> validations that verify and filter responses. </p><p><img alt="" data-framer-asset="data:framer/asset-reference,AxtCCn5AqOTnYnE0W5WLYOdu1k.png" data-framer-height="4623" data-framer-width="8703" height="2311" src="https://framerusercontent.com/images/AxtCCn5AqOTnYnE0W5WLYOdu1k.png" srcset="https://framerusercontent.com/images/AxtCCn5AqOTnYnE0W5WLYOdu1k.png?scale-down-to=512 512w,https://framerusercontent.com/images/AxtCCn5AqOTnYnE0W5WLYOdu1k.png?scale-down-to=1024 1024w,https://framerusercontent.com/images/AxtCCn5AqOTnYnE0W5WLYOdu1k.png?scale-down-to=2048 2048w,https://framerusercontent.com/images/AxtCCn5AqOTnYnE0W5WLYOdu1k.png?scale-down-to=4096 4096w,https://framerusercontent.com/images/AxtCCn5AqOTnYnE0W5WLYOdu1k.png 8703w" width="4351" data-framer-original-sizes="" sizes="(min-width: 1440px) 100vw, (min-width: 1200px) and (max-width: 1439px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p>Each layer serves as a critical checkpoint, working together to improve the reliability and accuracy of AI outputs. Let&#39;s explore a high-level introduction to these techniques within each layer:                                      </p><h3>A. Input Layer Mitigation Strategies</h3><p>Design and deploy layers that process queries before they reach the model. These layers would assess ambiguity, relevance, and complexity, ensuring the queries are refined and optimized for better model performance.</p><ul><li data-preset-tag="p"><p>Query processing: Evaluate if the query contains sufficient context or if it needs clarification. Refine the query to make it more relevant by discarding irrelevant noise, for example. Emphasize the complexity of the query to trigger various model behaviors, such as simplification using simpler models or generating clarification questions when highly uncertain.</p></li><li data-preset-tag="p"><p>Context size optimization: Reduces the size of input so more context could be fit into the input of the model effectively without losing quality:<!--$--><a href="https://arxiv.org/pdf/2304.12102" target="_blank" rel="noopener"> Using self-information filtering to retain key context</a><!--/$-->.</p></li><li data-preset-tag="p"><p><!--$--><a href="https://arxiv.org/html/2405.20234v2#S3" target="_blank" rel="noopener">Context injection</a><!--/$-->: This Technique involves redefining and &#34;injecting&#34; a contextual template or structured prompt before the user&#39;s main query to help the model understand the query better. Thus, structuring the prompts with specific role tags, content separators, and turn markers may help context injection to make the model understand complex prompts better and get the response closer to what the user wants rather than unsupported or speculative outputs.</p></li></ul><p><img alt=". One way to reduce hallucinations might be to “do it the Apple way” and simply ask the model to “Do not hallucinate.”" data-framer-asset="data:framer/asset-reference,32xBMTwI215hp8fhaCnvsdaWvE.jpg" data-framer-height="633" data-framer-width="2048" height="316" src="https://framerusercontent.com/images/32xBMTwI215hp8fhaCnvsdaWvE.jpg" srcset="https://framerusercontent.com/images/32xBMTwI215hp8fhaCnvsdaWvE.jpg?scale-down-to=512 512w,https://framerusercontent.com/images/32xBMTwI215hp8fhaCnvsdaWvE.jpg?scale-down-to=1024 1024w,https://framerusercontent.com/images/32xBMTwI215hp8fhaCnvsdaWvE.jpg 2048w" width="1024" data-framer-original-sizes="" sizes="(min-width: 1440px) 100vw, (min-width: 1200px) and (max-width: 1439px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p>One way to reduce hallucinations might be to “do it the Apple way” and simply<!--$--><a href="https://www.linkedin.com/posts/andrew-vassili_appleintelligence-prettyplease-genai-activity-7257169401165041665-mcRv/" target="_blank" rel="noopener"> ask the model to “Do not hallucinate.”</a><!--/$--></p><h3>B. Design Layer Mitigation Strategies</h3><p>The design layer focuses on enhancing how models process and generate information through architectural improvements and better training approaches. These strategies work at the core of the model to produce more reliable outputs.</p><ul><li data-preset-tag="p"><p>Chain-of-thought prompting:<!--$--><a href="https://openreview.net/pdf?id=_VjQlMeSB_J" target="_blank" rel="noopener"> Chain-of-thought</a><!--/$--> (CoT) prompts the model to “think” in a sequential, logical manner rather than immediately providing a final answer, simulating a reasoning process, and improving output accuracy and coherence. The CoT approach encourages models, especially those with substantial parameter counts<!--$--><a href="https://arxiv.org/pdf/2212.08410" target="_blank" rel="noopener"> often in the range of 100 billion or more</a><!--/$-->, to produce step-by-step answers that mirror human-like thought processes. Smaller models cannot process and utilize the multi-step dependencies that CoT relies on, thus yielding lower accuracy than standard prompting methods. A recent<!--$--><a href="https://x.com/_jasonwei/status/1855417833775309171" target="_blank" rel="noopener"> tweet by an OpenAI researcher</a><!--/$--> highlights how the shift to the o1 model improves CoT by producing a more uniform information density, resembling a model’s &#39;inner monologue&#39; rather than mimicking pre-training data.</p></li><li data-preset-tag="p"><p>Retrieval-Augmented Generation (RAG):<!--$--><a href="https://proceedings.neurips.cc/paper_files/paper/2020/file/6b493230205f780e1bc26945df7481e5-Paper.pdf" target="_blank" rel="noopener"> RAGs</a><!--/$--> are an extension of the LLMs with retrieval mechanisms that draw relevant, timely information from external databases, reducing hallucinations and anchoring outputs in a<strong> </strong>factual context. Researchers describe the three paradigms of RAG:</p><ul><li data-preset-tag="p"><p>The simplest form of RAG is the <strong>Naive RAG</strong>, where top-ranked documents are directly input to the LLM. </p></li><li data-preset-tag="p"><p><strong>Advanced RAG</strong> builds upon this by introducing additional pre- and post-processing steps, including query expansion, subquery generation,<!--$--><a href="https://arxiv.org/pdf/2309.11495" target="_blank" rel="noopener"> Chain-of-Verification</a><!--/$-->, and document reranking, to further refine the relevance of its retrieved chunks. We&#39;ve covered our <!--$--><a href="https://www.kapa.ai/blog/rag-best-practices">recommended advanced RAG techniques in another post</a><!--/$-->.</p></li><li data-preset-tag="p"><p><strong>Modular RAG</strong> transforms the traditional<!--$--><a href="https://arxiv.org/html/2407.21059v1" target="_blank" rel="noopener"> RAG systems into a flexible, reconfigurable framework, like LEGO</a><!--/$-->, with adaptive retrieval and prediction modules that only selectively retrieve new data in the face of uncertainty. Such further configuration makes it easier to support iterative querying over multi-step complex reasoning. Accompanied by features such as a memory pool, RAG can store knowledge regarding conversational context for coherence in dialogue applications. RAG could be further optimized with Customizable Components like Hierarchical indexing and Metadata tagging to improve the precision of retrieval.  Hierarchical structures like knowledge graphs, are able to represent relationships between entities that better align with the intent of the query. Further optimizations of relevance come through techniques such as Small2Big chunking or sentence-level retrieval.</p></li></ul></li></ul><p><img alt="" data-framer-asset="data:framer/asset-reference,8Q9WXdShlIZIVCMgvFnSnDspJXQ.png" data-framer-height="844" data-framer-width="1400" height="422" src="https://framerusercontent.com/images/8Q9WXdShlIZIVCMgvFnSnDspJXQ.png" srcset="https://framerusercontent.com/images/8Q9WXdShlIZIVCMgvFnSnDspJXQ.png?scale-down-to=512 512w,https://framerusercontent.com/images/8Q9WXdShlIZIVCMgvFnSnDspJXQ.png?scale-down-to=1024 1024w,https://framerusercontent.com/images/8Q9WXdShlIZIVCMgvFnSnDspJXQ.png 1400w" width="700" data-framer-original-sizes="" sizes="(min-width: 1440px) 100vw, (min-width: 1200px) and (max-width: 1439px) 100vw, (min-width: 810px) and (max-width: 1199px) 100vw, (max-width: 809px) 100vw"/></p><p>Comparison between the three paradigms of RAG (<!--$--><a href="https://arxiv.org/abs/2312.10997" target="_blank" rel="noopener">Gao et al. 2024</a><!--/$-->)</p><ul><li data-preset-tag="p"><p>Fine-tuning: Ideal for scenarios where there is sufficient task-specific training data and standardized tasks. Tailor models on domain-specific or task-specific data enhancing their accuracy within those specialized domains where the general pretraining data is imprecise. Fine-tuning does not entirely override the originally pre-trained weights but updates them.<!--$--><a href="https://arxiv.org/pdf/2405.05904" target="_blank" rel="noopener"> That allows the model to absorb new information without losing foundational knowledge</a><!--/$-->. This balance helps the model maintain a general context and prevents the loss of essential pre-existing understanding.</p></li></ul><h3>C. Output Layer Mitigation Strategies</h3><p>While input and design layers prevent hallucinations from occurring, the output layer acts as a final defense by filtering and verifying generated content. These verification methods ensure that only accurate and relevant information reaches the end user:</p><ul><li data-preset-tag="p"><p>Rule-based filtering: Using<!--$--><a href="https://www.sapien.io/blog/reducing-hallucinations-in-llms" rel="noopener"> rule-based systems or algorithms to filter out incorrect</a><!--/$--> or irrelevant responses. Rule-based systems check responses in the model’s output against verified databases that have a very low chance of causing hallucinations.</p></li><li data-preset-tag="p"><p>Output re-ranking: Ranking multiple outputs based on relevance and factual consistency, ensuring only the most accurate responses reach the user.</p></li><li data-preset-tag="p"><p>Fact-checking and verification: Using advanced fact-checking frameworks like<!--$--><a href="https://deepmind.google/research/publications/85420/" target="_blank" rel="noopener"> Search-Augmented Factuality Evaluator</a><!--/$--> (SAFE) or<!--$--><a href="https://openai.com/index/webgpt/" target="_blank" rel="noopener"> WebGPT</a><!--/$--> Developed by OpenAI, the process involves dissecting long-form responses into discrete factual statements. Each of these statements is then cross-referenced with up-to-date sources via online searches. This process allows the framework to determine whether each claim is supported by current information found on the web.</p></li><li data-preset-tag="p"><p>Encourage contextual awareness: Encouraging models to<!--$--><a href="https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations#basic-hallucination-minimization-strategies" target="_blank" rel="noopener"> refrain from generating answers when they lack sufficient context</a><!--/$--> or certainty helps avoid speculative or incorrect content.</p></li></ul><h2>4. Future Outlook</h2><p>Current research in furthering AI reliability focuses on innovating around these mitigating techniques or understanding the inner workings of LLMs Better, or potentially lead to new architectures of AI models that enable them to &#34;understand&#34; the data they are being trained on:</p><ul><li data-preset-tag="p"><p>Encoded truth: <!--$--><a href="https://arxiv.org/pdf/2410.02707" target="_blank" rel="noopener">Recent work</a><!--/$--> suggests that LLMs <strong>encode more truthfulness</strong> than previously understood, with certain tokens concentrating this information, which improves error detection. However, this encoding is complex and dataset-specific, hence limiting generalization. Notably, models may be encoding the correct answers internally despite generating errors, highlighting areas for targeted mitigation strategies.</p></li><li data-preset-tag="p"><p>Detection methods: Another<!--$--><a href="https://www.nature.com/articles/s41586-024-07421-0" target="_blank" rel="noopener"> recent study</a><!--/$--> highlights <strong>entropy-based methods for detecting hallucinations</strong> in LLMs, It offers a way to identify hallucinations by assessing uncertainty at a semantic level. This approach generalizes well across diverse tasks and new datasets, allowing users to anticipate when extra caution is needed with LLM outputs.</p></li><li data-preset-tag="p"><p>Self-improvement: <!--$--><a href="https://arxiv.org/html/2407.14507v3" target="_blank" rel="noopener">With self-evaluation and self-update modules</a><!--/$-->, an LLM could improve response consistency at the representation level, especially with methods such as self-consistency and self-refinement. This method promises methods that alleviate hallucinations and improve internal coherence across different reasoning tasks.</p></li></ul><h2>5. Final Thoughts and Conclusion</h2><p>Hallucinations in LLMs result from neural network limitations and probabilistic model architectures. While they cannot be eliminated, understanding the causes of hallucinations provides the foundation for effective mitigation. Techniques such as selective context filtering, retrieval-augmented generation, chain-of-thought prompting, and task-specific modeling<strong>,</strong> significantly reduce hallucination risks, enhancing the reliability and trustworthiness of LLM outputs. As the field continues to evolve, these strategies will likely play a central role in developing AI systems that are both accurate and contextually aware, advancing the practical application of LLMs in diverse domains.</p><p>Whether you choose to build an open-source solution or opt for a managed tool like<!--$--><a href="https://www.kapa.ai/" rel="noopener"> </a><!--/$--><!--$--><a href="https://www.kapa.ai/" target="_blank">kapa.ai</a><!--/$-->, the principles<strong>,</strong> and strategies to mitigate AI hallucination remain consistent. At<!--$--><a href="https://www.kapa.ai/" rel="noopener"> </a><!--/$-->kapa, we address many of these challenges directly, ensuring more reliable and accurate outputs. If you&#39;re interested in seeing how Kapa.ai can transform your knowledge base into an intelligent assistant,<!--$--><a href="https://www.kapa.ai/request-demo" target="_blank"> request a demo here</a><!--/$-->.</p></div></div>
  </body>
</html>
