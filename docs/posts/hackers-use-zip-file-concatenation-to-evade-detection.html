<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bleepingcomputer.com/news/security/hackers-now-use-zip-file-concatenation-to-evade-detection/">Original</a>
    <h1>Hackers use ZIP file concatenation to evade detection</h1>
    
    <div id="readability-page-1" class="page"><div>
	   
<p><img alt="Hacker box" height="897" src="https://www.bleepstatic.com/content/hl-images/2024/05/07/hacker-box.jpg" width="1600"/></p>

<p>Hackers are targeting Windows machines using the ZIP file concatenation technique to deliver malicious payloads in compressed archives without security solutions detecting them.</p>

<p>The technique exploits the different methods ZIP parsers and archive managers handle concatenated ZIP files.</p>

<p>This new trend was spotted by <a href="https://perception-point.io/blog/evasive-concatenated-zip-trojan-targets-windows-users/" target="_blank" rel="nofollow noopener">Perception Point</a>, who discovered a a concatentated ZIP archive hiding a trojan while analyzing a phishing attack that lured users with a fake shipping notice.</p>

<p>The researchers found that the attachment was disguised as a RAR archive and the malware leveraged the AutoIt scripting language to automate malicious tasks.</p>

<div>
<figure><img alt="Phishing email hiding a trojan in a concatenated ZIP file" height="600" src="https://www.bleepstatic.com/images/news/u/1220909/2024/Phishing/24/phish.jpg" width="872"/><figcaption><strong>Phishing email hiding a trojan in a concatenated ZIP file</strong></figcaption></figure></div>

<h2>Hiding malware in “broken” ZIPs</h2>

<p>The first stage of the attack is the preparation, where the threat actors create two or more separate ZIP archives and hide the malicious payload in one of them, leaving the rest with innocuous content.</p>

<p>Next, the separate files are concatenated into one by appending the binary data of one file to the other, merging their contents into one combined ZIP archive.</p>

<p>Although the final result appears as one file, it contains multiple ZIP structures, each with its own central directory and end markers.</p>

<div>
<figure><img alt="Internal structure of ZIP files" height="408" src="https://www.bleepstatic.com/images/news/u/1220909/2024/Phishing/24/structure.jpg" width="757"/><figcaption><strong>Internal structure of ZIP files</strong></figcaption></figure></div>

<h2>Exploiting ZIP app flaws</h2>

<p>The next phase of the attack relies on how ZIP parsers handle concatenated archives. Perception Point tested 7zip, WinRAR, and Windows File Explorer to different results:</p>

<ul><li><strong>7zip </strong>only reads the first ZIP archive (which could be benign) and may generate a warning about additional data, which users may miss</li>
	<li><strong>WinRAR </strong>reads and displays both ZIP structures, revealing all files, including the hidden malicious payload.</li>
	<li><strong>Windows File Explorer</strong> may fail to open the concatenated file or, if renamed with a .RAR extension, might display only the second ZIP archive.</li>
</ul><p>Depending on the app’s behavior, the threat actors may fine-tune their attack, such as hiding the malware in the first or the second ZIP archive of the concatenation.</p>

<p>Trying the malicious archive from the attack on 7Zip, Perception Point researchers saw that only a harmless PDF file was shown. Opening it with Windows Explorer, though, revealed the malicious executable.</p>

<div>
<figure><img alt="7zip (top) and Windows File Explorer (bottom) opening the same file" height="600" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" width="609" data-src="https://www.bleepstatic.com/images/news/u/1220909/2024/Phishing/24/7zip.jpg"/><figcaption><strong>7zip (top) and Windows File Explorer (bottom) opening the same file</strong></figcaption></figure></div>

<p>To defend against concatenated ZIP files, Perception Point suggests that users and organizations use security solutions that support recursive unpacking.</p>

<p>Generally, emails attaching ZIPs or other archive file types should be treated with suspicion, and filters should be implemented in critical environments to block the related file extensions.</p>

	   
           
          
 
	  </div></div>
  </body>
</html>
