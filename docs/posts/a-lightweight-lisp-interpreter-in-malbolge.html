<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/kspalaiologos/malbolge-lisp">Original</a>
    <h1>A lightweight Lisp interpreter in Malbolge</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">Made by Palaiologos, 2020 - 2021. Core (core.mb) to the public domain, the entire program is governed by the GNU GPLv3 license.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/kspalaiologos/malbolge-lisp/raw/master/session.gif"><img src="https://github.com/kspalaiologos/malbolge-lisp/raw/master/session.gif" alt="Session gif" data-animated-image=""/></a></p>
<p dir="auto"><strong><a href="https://github.com/kspalaiologos/malbolge-lisp/raw/master/MalbolgeLisp.pdf">During summer and fall of 2021, I wrote a book about MalbolgeLISP&#39;s design and implementation</a></strong></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-what-is-malbolgelisp" aria-hidden="true" tabindex="-1" href="#what-is-malbolgelisp"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What is MalbolgeLisp?</h2>
<p dir="auto"><strong>MalbolgeLisp</strong> is a LISP interpreter written in Malbolge. It&#39;s as of 2020 and 2021, <a href="https://en.wikipedia.org/wiki/Malbolge#Programming_in_Malbolge" rel="nofollow">the most advanced, usable Malbolge program ever created</a>. It supports everything LISPs generally tend to support (like <code>cond</code>, <code>let</code>, <code>lambda</code>, etc...). The v1.2 release greatly improved the performance and reduced the code size, while adding a few features.</p>
<p dir="auto"><strong>MalbolgeLISP</strong> supports tacit programming, partial application, de Bruijn indices, monad lifting, and more.</p>
<p dir="auto">A few fibonacci functions programmed in MalbolgeLISP (and tested on <code>(fibN 6)</code>):</p>
<div dir="auto" data-snippet-clipboard-copy-content="; Naive attempt at 1m 19s
(defun fib1 (n) (
    if [n &lt; 2]
        n
        [(fib1 [n - 1]) + (fib1 [n - 2])]))

; Direct port of accumulator-keeping solution at 1m 6s:
(defun fib2 (n) ((lambda (a w) (
    if [w = 0]
        (#0 a)
        ((bruijn 0) (tie (#1 a) (lift + a)) [w - 1]))) &#39;(0 1) n))

; A more idiomatic solution than the above at 54s:
(defun fib3 (n) ((lambda (x y w) (
    if [w = 0]
        x
        ((bruijn 0) y [x + y] [w - 1]))) 0 1 n))

; Iterative attempt at 43s
(defun fib4 (n) (#0 (
    iterateN n (lambda (x) (
        tie (#1 x) [(#0 x) + (#1 x)])) &#39;(0 1))))"><pre><span><span>;</span> Naive attempt at 1m 19s</span>
(<span>defun</span> <span>fib1</span> (n) (
    <span>if</span> [n &lt; <span>2</span>]
        n
        [(fib1 [n - <span>1</span>]) + (fib1 [n - <span>2</span>])]))

<span><span>;</span> Direct port of accumulator-keeping solution at 1m 6s:</span>
(<span>defun</span> <span>fib2</span> (n) ((<span>lambda</span> (a w) (
    <span>if</span> [w = <span>0</span>]
        (<span>#0</span> a)
        ((bruijn <span>0</span>) (tie (<span>#1</span> a) (lift + a)) [w - <span>1</span>]))) &#39;(<span>0</span> <span>1</span>) n))

<span><span>;</span> A more idiomatic solution than the above at 54s:</span>
(<span>defun</span> <span>fib3</span> (n) ((<span>lambda</span> (x y w) (
    <span>if</span> [w = <span>0</span>]
        x
        ((bruijn <span>0</span>) y [x + y] [w - <span>1</span>]))) <span>0</span> <span>1</span> n))

<span><span>;</span> Iterative attempt at 43s</span>
(<span>defun</span> <span>fib4</span> (n) (<span>#0</span> (
    iterateN n (<span>lambda</span> (x) (
        tie (<span>#1</span> x) [(<span>#0</span> x) + (<span>#1</span> x)])) &#39;(<span>0</span> <span>1</span>))))</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-what-is-malbolge-why-is-it-difficult" aria-hidden="true" tabindex="-1" href="#what-is-malbolge-why-is-it-difficult"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What is Malbolge? Why is it difficult?</h2>
<p dir="auto"><strong>Malbolge</strong> is a public domain esoteric programming language. It was specifically designed to be almost impossible to use, via a counter-intuitive &#39;crazy operation&#39;, trinary arithmetic, and self-modifying code. It builds on the difficulty of earlier, challenging esoteric languages like Brainfuck, but takes this aspect to the extreme. Despite this design, it is possible to write useful Malbolge programs (as this project proves).</p>
<p dir="auto">What Malbolge instructions do depends on their position in the source code. After being ran, they are encrypted (so to make a loop, one has to decrypt it after each iteration - sounds hard already?). This is how so-called instruction cycles have been discovered - it has been observed that some instructions on certain locations form looping cycles, which is the basis of Malbolge programming.</p>
<p dir="auto">The most complex programs made in Malbolge, to date, include an adder, a &#34;99 bottles of beer&#34; program, and a &#34;Hello, world!&#34; program (originally generated by a Lisp program utilizing a genetic algorithm).</p>
<p dir="auto">MalbolgeLisp uses a special variant of Malbolge called <strong>Malbolge Unshackled</strong>. It&#39;s considerably harder to program for multiple reasons:</p>
<ol dir="auto">
<li>The rotation width is chosen randomly by the interpreter</li>
<li>Malbolge Unshackled lets the width of rotation be variable, which grows with the values in the D register, and since the initial rotation width is unknown, you have to probe it (because otherwise <code>*</code> returns unpredictable results)</li>
<li>Malbolge Unshackled&#39;s print instruction requires unicode codepoints</li>
<li>if the rotation width is unknown then you can&#39;t load values larger than 3^4-1, except values starting with a <code>1</code> trit</li>
<li>to overcome this you need a loop that probes the rotation width which is probably beyond most people&#39;s comprehension</li>
<li>the specification says that the value <code>0t21</code> should be used to print a newline, but this value is <em>theoretically</em> impossible to obtain without having read an end of line or end of file from I/O before.</li>
<li>Malbolge Unshackled is actually usable because it&#39;s (as this project proves) Turing complete. The default Malbolge rotation width (10) constraints the addressable memory enough to make something cool with it.</li>
</ol>
<p dir="auto">A few example Malbolge programs:</p>
<p dir="auto">A &#34;Hello World&#34; program:</p>
<div data-snippet-clipboard-copy-content="(=&lt;`#9]~6ZY327Uv4-QsqpMn&amp;+Ij&#34;&#39;E%e{Ab~w=_:]Kw%o44Uqp0/Q?xNvL:`H%c#DD2^WV&gt;gY;dts76qKJImZkj"><pre><code>(=&lt;`#9]~6ZY327Uv4-QsqpMn&amp;+Ij&#34;&#39;E%e{Ab~w=_:]Kw%o44Uqp0/Q?xNvL:`H%c#DD2^WV&gt;gY;dts76qKJImZkj
</code></pre></div>
<p dir="auto">A cat program that doesn&#39;t terminate on EOF:</p>
<div data-snippet-clipboard-copy-content="(=BA#9&#34;=&lt;;:3y7x54-21q/p-,+*)&#34;!h%B0/.~P&lt;&lt;:(8&amp;66#&#34;!~}|{zyxwvugJk"><pre><code>(=BA#9&#34;=&lt;;:3y7x54-21q/p-,+*)&#34;!h%B0/.~P&lt;&lt;:(8&amp;66#&#34;!~}|{zyxwvugJk
</code></pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-how-to-use" aria-hidden="true" tabindex="-1" href="#how-to-use"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How to use</h2>
<div data-snippet-clipboard-copy-content="$ git clone https://github.com/kspalaiologos/malbolge-lisp
$ cd malbolge-lisp
$ unzip lisp.mb
$ clang -O3 -march=native fast20.c -o fast20
$ cat init_module.mb core.mb &gt; lisp.mb
$ ./fast20 lisp.mb"><pre><code>$ git clone https://github.com/kspalaiologos/malbolge-lisp
$ cd malbolge-lisp
$ unzip lisp.mb
$ clang -O3 -march=native fast20.c -o fast20
$ cat init_module.mb core.mb &gt; lisp.mb
$ ./fast20 lisp.mb
</code></pre></div>
</article>
          </div></div>
  </body>
</html>
