<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://git.sr.ht/~egtann/txtar/">Original</a>
    <h1>Show HN: Chez Scheme txtar port from Go</h1>
    
    <div id="readability-page-1" class="page"><div id="readme">
    <div>
      <div><h2 id="txtar"><a href="#txtar" rel="nofollow noopener">#</a>txtar</h2>
<p>txtar enables you to work with a simple text archive format compatible with
<a href="https://golang.org/x/tools/txtar." rel="nofollow noopener">https://golang.org/x/tools/txtar.</a> It concatenates files together and allows for
a top-level comment.</p>
<pre><code>Math implementation
-- math.h --
#ifndef MATH_H
#define MATH_H

int add(int a, int b);

#endif
-- math.c --
#include &#34;math.h&#34;

int add(int a, int b) {
    return a + b;
}
</code></pre>
<p>This format is easy for humans to read and write by hand and is perfect for
test data.</p>
<h3 id="install"><a href="#install" rel="nofollow noopener">#</a>Install</h3>
<div><pre><span></span><span># Install the library.</span>
$<span> </span>make<span> </span>install

<span># Add the library directory to your CHEZSCHEMELIBDIRS.</span>
$<span> </span><span>export</span><span> </span><span>CHEZSCHEMELIBDIRS</span><span>=</span><span>&#34;</span><span>$HOME</span><span>/.local/lib/chez-scheme:</span><span>$CHEZSCHEMELIBDIRS</span><span>&#34;</span>
</pre></div>
<p>If you want to remove the library from your system, simply run <code>make uninstall</code>.</p>
<h4 id="dependencies"><a href="#dependencies" rel="nofollow noopener">#</a>Dependencies</h4>
<p>This library requires:</p>
<div><pre><span></span><span>;; For using it.</span>
<span>(</span><span>srfi</span><span> </span><span>s13</span><span> </span><span>strings</span><span>)</span>

<span>;; For running the tests only.</span>
<span>(</span><span>srfi</span><span> </span><span>s64</span><span> </span><span>testing</span><span>)</span>
</pre></div>
<p>You can obtain these libraries and many more via Thunderchez:</p>
<div><pre><span></span>$<span> </span>git<span> </span>clone<span> </span>https://github.com/ovenpasta/thunderchez

<span># Add the library directory to your CHEZSCHEMELIBDIRS.</span>
$<span> </span><span>export</span><span> </span><span>CHEZSCHEMELIBDIRS</span><span>=</span>/path/to/thunderchez
</pre></div>
<h3 id="usage"><a href="#usage" rel="nofollow noopener">#</a>Usage</h3>
<p>All the exports of this library are documented with type expectations. I
encourage you to scan the implementation.</p>
<p>A few common example usecases are presented below for convenience:</p>
<h4 id="import"><a href="#import" rel="nofollow noopener">#</a>Import</h4>
<p>To use this library, simply import <code>txtar</code>:</p>

<h4 id="construct-an-archive-from-a-list-of-filenames"><a href="#construct-an-archive-from-a-list-of-filenames" rel="nofollow noopener">#</a>Construct an archive from a list of filenames</h4>
<div><pre><span></span><span>(</span><span>txtar-read-files</span><span> </span><span>&#34;Test files&#34;</span><span> </span><span>&#39;</span><span>(</span><span>&#34;test1.txt&#34;</span><span> </span><span>&#34;test2.txt&#34;</span><span>))</span>
</pre></div>
<h4 id="write-text-to-an-archive-file"><a href="#write-text-to-an-archive-file" rel="nofollow noopener">#</a>Write text to an archive file</h4>
<div><pre><span></span><span>(</span><span>let*</span><span> </span><span>([</span><span>files</span>
<span>         </span><span>(</span><span>list</span>
<span>           </span><span>(</span><span>make-txtar-file</span><span> </span><span>&#34;math.h&#34;</span><span> </span><span>&#34;#ifndef MATH_H</span><span>\n</span><span>#define MATH_H</span><span>\n\n</span><span>int add(int a, int b);</span><span>\n\n</span><span>#endif&#34;</span><span>)</span>
<span>           </span><span>(</span><span>make-txtar-file</span><span> </span><span>&#34;math.c&#34;</span><span> </span><span>&#34;#include </span><span>\&#34;</span><span>math.h</span><span>\&#34;\n\n</span><span>int add(int a, int b) {</span><span>\n</span><span>    return a + b;</span><span>\n</span><span>}&#34;</span><span>))]</span>
<span>       </span><span>[</span><span>archive</span><span> </span><span>(</span><span>make-txtar-archive</span><span> </span><span>&#34;Math implementation&#34;</span><span> </span><span>files</span><span>)]</span>
<span>       </span><span>[</span><span>output-port</span><span> </span><span>(</span><span>open-output-file</span><span> </span><span>&#34;math.txtar&#34;</span><span>)])</span>
<span>  </span><span>(</span><span>txtar-write</span><span> </span><span>archive</span><span> </span><span>output-port</span><span>)</span>
<span>  </span><span>(</span><span>close-output-port</span><span> </span><span>output-port</span><span>))</span>
</pre></div>
<h4 id="retrieve-a-file-from-an-archive"><a href="#retrieve-a-file-from-an-archive" rel="nofollow noopener">#</a>Retrieve a file from an archive</h4>
<div><pre><span></span><span>(</span><span>let</span><span> </span><span>([</span><span>file</span><span> </span><span>(</span><span>txtar-file-ref</span><span> </span><span>archive</span><span> </span><span>&#34;file-in-the-archive.txt&#34;</span><span>)])</span>
<span>  </span><span>(</span><span>if</span><span> </span><span>file</span>
<span>    </span><span>(</span><span>display</span><span> </span><span>&#34;the file existed&#34;</span><span>)</span>
<span>    </span><span>(</span><span>display</span><span> </span><span>&#34;the file did not exist&#34;</span><span>)))</span>
</pre></div>
<h3 id="license"><a href="#license" rel="nofollow noopener">#</a>License</h3>
<p>Copyright (C) 2025 Evan Tann, ParaVoce LLC</p>
<p>This program is free software: you can redistribute it and/or modify it under
the terms of the GNU Affero General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option) any
later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.</p>
<p>You should have received a copy of the GNU Affero General Public License along
with this program. If not, see <a href="https://www.gnu.org/licenses/" rel="nofollow noopener">https://www.gnu.org/licenses/</a>.</p>
</div>
    </div>
  </div></div>
  </body>
</html>
