<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mtirado.com/blog/demystifying-the-analemma/">Original</a>
    <h1>Demystifying the Analemma</h1>
    
    <div id="readability-page-1" class="page"><div id="content">








<p>Here’s complete <a href="https://mtirado.com/resources/analemma-calc">Analemma calculator</a> if you want to see it in action before delving into the specifics.</p>
<p>If you were to take a picture of the Sun every day, at the same time, for an entire year, it would form a figure eight shaped loop. It’s a surprisingly tricky astronomical phenomena to photograph, because you need to take the more than three hundreds pictures at the same location with the same setup to get optimal results. There’s also the challenge of dealing with an unpredictable weather.</p>
<figure>
<img src="https://apod.nasa.gov/apod/image/1906/FINALEDIDAkb1024.jpg" alt="Sunset Analemma, from APOD"/><figcaption>Sunset Analemma, from <a href="https://apod.nasa.gov/apod/ap190621.html">APOD</a></figcaption>
</figure>
<p>Analemmas aren’t unique to planet Earth. Planets have different shapes according to their different inclinations and orbits.</p>
<figure>
<img src="https://apod.nasa.gov/apod/image/0306/marsalemma_mammana_c1.jpg" alt="Martian Analemma, from APOD"/><figcaption>Martian Analemma, from <a href="https://apod.nasa.gov/apod/ap030626.html">APOD</a></figcaption>
</figure>
<p>Thankfully, we don’t need to spend a year to know how Analemmas look and work. Today is the march equinox, the day where the sun passes directly over the equator, so I think it’s the perfect opportunity to talk about analemmas.</p>
<p>Why does it look like that? Why a figure eight? Why is Mars’ analemma so different? These were some of the questions I had that made me wonder about that weird looking shape. I didn’t want a formula or equation for calculating it. I wanted to know why. I wanted to generalize the analemma for every possible orbit.</p>
<p>It seems daunting, I know, but bear with me. You might learn one or two things about celestial mechanics and geometry.</p>
<p>First of all, why does the sun need to be photographed every twenty four hours? Why not every twelve hours? Every hour? Every minute? Well, it’s a simple trick to cancel the Earth’s own rotation. The Earth is rotating, so the sun changes its position in the sky regardless of the Earth’s orbital parameters. In fact, if the Earth were tidally locked to the sun, you would be able to film the analemma over a year.</p>
<p>However, the Earth spins roughly every twenty four hours, so we need to wait for the sun to return to the position it had before taking another picture.</p>
<h2 id="the-mean-sun">The Mean Sun</h2>
<p>Let’s consider the most simple analemma: A single point in the sky. In this hypothetical case the sun would be at the same place in the sky. During local noon, at the equator, the sun would be directly overhead, for example. Throughout a year, at the same time, the sun would remain at the same place. A boring analemma indeed.</p>
<p>This analemma is possible if:</p>
<ul>
<li>The orbit of the planet were perfectly circular</li>
<li>The planet had no axial tilt</li>
</ul>
<p>That means the sun would always be directly above the equator. This is the “mean” or average sun. A perfect sun that moves at a constant rate. Always in the same position every day, always in time. This is perfect for timekeeping, unfortunately, the real sun is not so perfect. Earth’s orbit is elliptical, and the planet itself is tilted.</p>
<p>The analemma is a measure of how much the true sun deviates from the mean sun. That figure eight shape is a sort of “signature” that encodes the planet’s orbital parameters and axial tilt.</p>
<p>Calculating the analemma is useful for knowing the difference between the ideal or mean solar clock and the real, or apparent one.</p>
<p>The analemma has two components:</p>
<ul>
<li>The vertical component, caused by the planet’s axial tilt</li>
<li>The horizontal component, caused by the planet’s orbital eccentricity and axial tilt</li>
</ul>
<h2 id="declination">Declination</h2>
<p>As the Earth revolves around the sun, it keeps a constant tilt of approximately 23.4° degrees with respect to the plane of its orbit. During the summer in the northern hemisphere, for example, the top part of the planet receives the most sunlight, and days tend to be longer, because the sun now reaches a higher point in the sky. Near the poles, you can experience continuous sunlight for more than a day!</p>
<p>The opposite happens half an orbit later. The southern hemisphere starts to receive more sunlight, and winter begins in the north. Days are now shorter, and the sun appear to be lower in the sky.</p>
<p>The more tilted a planet is, the vertical component of the analemma, its declination, increases. Not only that, but also the way it increases changes.</p>
<p>This is an approximation of the solar declination:</p>
<p><span>\[\delta = \epsilon \sin(\theta)\]</span></p>
<ul>
<li><span>\(\delta\)</span>: Apparent solar declination</li>
<li><span>\(\epsilon\)</span>: Axial tilt</li>
<li><span>\(\theta\)</span>: Angular position of the planet along its orbit</li>
</ul>
<p>However, this is only accurate for a small axial tilt. As the axial tilt approaches 90°, it gets less and less accurate. A more correct equation would be:</p>
<p><span>\[\delta = \sin^{-1} (\sin(\epsilon) \sin(\theta))\]</span></p>
<p>Both functions are compared below:</p>
<figure>
<svg id="declination-plot">
</svg>
<figcaption>
Solar declination as a planet revolves around the sun
</figcaption>

</figure>

<p>Notice how at small angles, the declination approximates a sine wave. As we increase the axial tilt, it starts to behave like a triangle wave.</p>
<p>The analemma spans 46.8° on the vertical axis, oscillating as the planet changes its apparent declination. The vertical components reaches a maximum or minimum during the solstices, and it’s exactly zero at the equinoxes. With the mystery of the vertical movement of the sun solved, it’s time to explain the horizontal movement of the sun.</p>
<h2 id="the-equation-of-time">The Equation of Time</h2>
<p>The equation of time is a function that tells us how much our definition of a day (mean solar time), deviates from the true solar time. It is the function that dictates the horizontal movement of the analemma.</p>
<p>It has two components, caused by two variables:</p>
<ul>
<li>Eccentricity (<span>\(e\)</span>): Since the Earth’s movement along its orbit is not constant, sometimes it will me moving faster or slower than the mean solar time. If the Earth had an eccentricity of zero, this component of the equation of time would also be zero.</li>
<li>Obliquity (<span>\(\epsilon\)</span>): The obliquity is the parameter that gives the analemma its figure eight shape. As the solar declination changes, a small horizontal component is added to the equation of time.</li>
</ul>
<p>To explain the effect of eccentricity, we’ll first define an orbit.</p>
<h3 id="defining-an-orbit">Defining an orbit</h3>
<p>This is a very simple formula for plotting an orbit with one of its foci at the origin, with perihelion starting at <span>\(\theta = 0\)</span></p>
<p><span>\[f(\theta) = \begin{cases}x = a \cdot \cos \theta - e \\ y = a \sqrt{1 - e^2} \cdot \sin \theta \end{cases}\]</span></p>
<p>In this case, <span>\(a\)</span> is the semi-major axis and <span>\(e\)</span> the orbital eccentricity.</p>
<figure>
<svg id="orbit-plot">
</svg>
<figcaption>
An elliptical orbit
</figcaption>


</figure>

<h3 id="the-three-anomalies">The Three Anomalies</h3>
<p>Now that we have the shape of the orbit, it’s time to place the planet on it. The questions is where, and when?</p>
<p>Two angles can help us determine the effect of the eccentricity of the equation of time</p>
<ul>
<li>Mean anomaly: It’s an angular quantity that increases linearly with time. This is the “mean solar time” we’re measuring against.</li>
<li>True anomaly: It’s the angle that represents the true position of a planet. If an orbit were perfectly circular, it would be equal to the mean anomaly (Time difference of zero).</li>
</ul>
<p>The true anomaly does not increase linearly with time, due to the eccentricity of the orbit which makes our hypothetical planet move faster near perihelion and slower near aphelion. We use mean solar time because it’s linear and easy to calculate, however it deviates from the apparent solar time. If Earth’s eccentricity were larger it would be a larger difference.</p>
<p>Finally, the eccentric anomaly will allow us to plot the planet’s position using the equation shown above.</p>
<figure>
<svg id="three-anomalies">
</svg>
<figcaption>
The Three Anomalies
</figcaption>

</figure>

<p>The mean anomaly is the easiest to calculate, it completes a full revolution (<span>\(2\pi\)</span> radians) every orbital period.</p>
<p><span>\[M = \frac{2 \pi t}{T}\]</span></p>
<p>The mean anomaly can also be calculated from the eccentric anomaly:</p>
<p><span>\[M = E - e \sin(E)\]</span></p>
<p>Where <span>\(e\)</span> is the orbital eccentricity. Note that if <span>\(e\)</span> were zero, <span>\(E\)</span> would be equal to <span>\(M\)</span>.</p>
<p>To get the true anomaly from the eccentric anomaly:</p>
<p><span>\[\nu = \tan^{-1} \left ( \frac{\sqrt{1 - e^2} \sin(E)}{\cos(E) - e} \right )\]</span></p>
<p>Again, if <span>\(e\)</span> were zero, <span>\(\nu\)</span> would be equal to <span>\(E\)</span>.</p>
<p>The problem lies in solving <span>\(E\)</span> in terms on <span>\(M\)</span>, which can only be done numerically using Newton’s method:</p>
<p><span>\[E_1 = M\]</span></p>
<p><span>\[E_{n + 1} = E_n - \frac{E_n - e \sin(E_n) - M}{1 - e \cos(E_n)}\]</span></p>
<p>It’s necessary to calculate several iterations of <span>\(E\)</span> to get an accurate value.</p>
<p>Once we have the eccentric anomaly, we can calculate the true anomaly of our orbiting body. The eccentric anomaly can be plugged in <a href="#orbit-equation">this equation</a> to obtain the position of the body.</p>
<p>With the position <span>\((x, y)\)</span> calculated, the true anomaly can also be calculated with:</p>
<p><span>\[\nu = \text{atan2}(y, x)\]</span></p>
<h3 id="the-vernal-equinox">The Vernal Equinox</h3>
<p>Imagine the Earth had a very eccentric orbit. Ignoring the effects on the climate and the fact that the seasons would now be primarily determined by the extreme variations in distance, consider what would happen during spring in the northern hemisphere exactly at perihelion. Near perihelion, Earth would move a lot faster, making spring and winter very short, and summer and autumn very long. This means the declination is also affected by the orbital eccentricity. Things complicate when we change the tilt of the Earth so that spring begins at a point other than perihelion or aphelion.</p>
<p>The vernal equinox is used as a reference that marks the beginning of spring in the northern hemisphere.</p>
<p>Now, our updated formula for the declination looks like:</p>
<p><span>\[\delta = \sin^{-1} (\sin(\epsilon) \sin(\nu - V))\]</span></p>
<ul>
<li><span>\(\delta\)</span>: solar declination angle</li>
<li><span>\(\epsilon\)</span>: Axial tilt</li>
<li><span>\(\nu\)</span>: True anomaly</li>
<li><span>\(V\)</span>: Vernal equinox</li>
</ul>
<p>For this equation, a vernal equinox of 0° would mean spring in the northern hemisphere begins exactly at perihelion.</p>
<p>So how would the declination over time look like when we take into account the effects of orbital eccentricity? The graph below shows it.</p>
<figure>
<svg id="vernal-chart">
</svg>
<figcaption>
Declination over time, taking into account the effects of orbital eccentricity
</figcaption>



</figure>
<p>Note that with an orbital eccentricity of zero, changing the vernal equinox only translates the declination function in the horizontal axis. However, once the eccentricity is increased significantly, its effect on the solar declination becomes noticeable.</p>

<p>By tuning these three values (the eccentricity, axial tilt and vernal equinox), you can obtain extremely long summers and short winters, for example.</p>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>These are the following parameters we’ve reviewed so far that affect the shape of the analemma:</p>
<ul>
<li>The planet’s obliquity</li>
<li>The eccentricity of its orbit</li>
<li>The angle between perihelion and the vernal equinox</li>
</ul>
<p>There are several equations that can help us calculate the equation or time and declination at any given point. However, my goal with this calculator is to try to avoid magic numbers. Instead, seeing an orbit and a planet in motion would allow us to see exactly how each of these parameters affects the shape of the analemma.</p>
<p>The analemma as a function of time can be defined as:</p>
<p><span>\[A(t) \begin{cases} x = \text{EoT}(t) \\ y = \text{Dec}(t) \end{cases}\]</span></p>
<p>where <span>\(\text{EoT}\)</span> is the equation of time and <span>\(\text{Dec}\)</span> the solar declination, both in degrees. The equation of time is also usually measured in minutes, that correspond to the actual time difference between the mean and true sun. However, they can be converted to an angular quantity.</p>
<h3 id="declination-1">Declination</h3>
<p><span>\[\text{Dec}(t) = \sin^{-1} (\sin(\epsilon) \sin(\nu(t) - V))\]</span></p>
<p><span>\[M(t) = \frac{2 \pi t}{T}\]</span></p>
<p><span>\[\nu(t) = \tan^{-1} \left ( \frac{\sqrt{1 - e^2} \sin(E(t))}{\cos(E(t)) - e} \right )\]</span></p>
<p>And finally, to get <span>\(E(t)\)</span> we can resort to numerical methods.</p>
<p><span>\[E_1(t) = M(t)\]</span></p>
<p><span>\[E_{n + 1} = E_n(t) - \frac{E_n(t) - e \sin(E_n(t)) - M(t)}{1 - e \cos(E_n(t))}\]</span></p>
<p><span>\[E(t) = E_k(t)\]</span></p>
<p>In this case, <span>\(k\)</span> can be an arbitrary number of iterations (the more the better).</p>
<h3 id="equation-of-time">Equation of Time</h3>
<p>An initial approximation of the equation of time can be:</p>
<p><span>\[\text{EoT}(t) = M(t) - \nu(t)\]</span></p>
<p>However this doesn’t take into account the effect of obliquity. When projecting the true sun on the equatorial plane, there’s an angular difference between the projection and the mean sun.</p>
<p><span>\[\text{EoT}(t) = M(t) - V - \text{atan2}\left (\sin(\nu(t) - V) \cos(\epsilon), \cos(\nu(t) - V) \right )\]</span></p>
<p>Note that if the obliquity <span>\(\epsilon = 0\)</span>:</p>
<p><span>\[\text{EoT}(t) = M(t) - V - \text{atan2}\left (\sin(\nu(t) - V), \cos(\nu(t) - V) \right )\]</span> <span>\[\text{EoT}(t) = M(t) - V - (\nu(t) - V)\]</span></p>
<p><span>\[\text{EoT}(t) = M(t) - \nu(t)\]</span></p>
<p>These formulas may give us a nice analemma, but it’s difficult to visualize them. The equations are only one side of the story. Wouldn’t it be nice to see the equations in a different, more intuitive way?</p>
<h3 id="defining-the-celestial-sphere">Defining the Celestial Sphere</h3>
<p>The celestial sphere is a useful model for understanding and visualizing different astronomical phenomena. The seasons, the plane of the ecliptic, the subsolar point, and even the positions of other stars!</p>
<p>For this SVG model, the XY plane represents the equatorial plane that the mean sun circles over an orbital period. In the center we have the planet itself, happily rotating on its own axis.</p>
<p>Changing the obliquity slider will change the inclination of the ecliptic. The apparent sun is always on this plane, and only intersects the equatorial plane during the equinoxes. It reaches its highest or lowest point during the solstices.</p>
<p>The analemma is traced on both the celestial sphere and on the planet’s surface. On the surface, it represents the location where the sun is directly overhead.</p>
<figure>
<svg id="sphere">
</svg>



<figcaption>
3D representation of the celestial sphere
</figcaption>
</figure>


</div></div>
  </body>
</html>
