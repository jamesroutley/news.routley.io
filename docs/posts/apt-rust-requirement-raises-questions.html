<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lwn.net/SubscriberLink/1046841/5bbf1fc049a18947/">Original</a>
    <h1>Apt Rust requirement raises questions</h1>
    
    <div id="readability-page-1" class="page"><div>
<blockquote>
<div>
<h3>Welcome to LWN.net</h3>
<p>
The following subscription-only content has been made available to you 
by an LWN subscriber.  Thousands of subscribers depend on LWN for the 
best news from the Linux and free software communities.  If you enjoy this 
article, please consider <a href="https://lwn.net/subscribe/">subscribing to LWN</a>.  Thank you
for visiting LWN.net!
</p></div>
</blockquote>

<p>It is rarely newsworthy when a project or package picks up a new
dependency. However, changes in a core tool like Debian&#39;s <a href="https://salsa.debian.org/apt-team/apt#apt">Advanced Package
Tool</a> (APT) can have far-reaching effects. For example, Julian
Andres Klode&#39;s <a href="https://lwn.net/ml/all/20251031213541.GA73786@debian.org/">declaration</a>
that APT would require Rust in May 2026 means that a few of Debian&#39;s
unofficial ports must either acquire a working Rust toolchain or
depend on an old version of APT. This has raised several questions
within the project, particularly about the ability of a single
maintainer to make changes that have widespread impact.</p>

<p>On October 31, Klode sent an announcement to the debian-devel
mailing list that he intended to introduce Rust dependencies and code
into APT as soon as May 2026:</p>

<blockquote>
<p>This extends at first to the Rust compiler and standard library, and
the Sequoia ecosystem.</p>

<p>In particular, our code to parse .deb, .ar, .tar, and the HTTP
signature verification code would strongly benefit from memory safe
languages and a stronger approach to unit testing.</p>

<p>If you maintain a port without a working Rust toolchain,
please ensure it has one within the next 6 months, or
sunset the port.</p>
</blockquote>

<p>Klode added this was necessary so that the project as a whole could
move forward, rely on modern technologies, &#34;<q>and not be held back by
trying to shoehorn modern software on retro computing
devices</q>&#34;. Some Debian developers have welcomed the news. Paul
Tagliamonte <a href="https://lwn.net/ml/all/CAO6P2QQD8MDUTAo_F=kGfDsBF0Xv+Wv020dm-n-WGnb7ODYW-g@mail.gmail.com">acknowledged</a>
that it would impact unofficial Debian ports but called the push
toward Rust &#34;<q>welcome news</q>&#34;.</p>

<p>However, John Paul Adrian Glaubitz <a href="https://lwn.net/ml/all/ad6e60711c8ed3372ed7f324d7b1be23b0722a0d.camel@physik.fu-berlin.de/">complained</a>
that Klode&#39;s wording was unpleasant and that the approach was
confrontational. In <a href="https://lwn.net/ml/all/afb7c58fb0fb995ebde3fb72b4cc4d1943a37923.camel@physik.fu-berlin.de/">another
message</a>, he explained that he was not against adoption of Rust; he
had worked on enabling Rust on many of the Debian architectures and
helped to fix architecture-specific bugs in the Rust toolchain as well
as LLVM upstream. However, the message strongly suggested there was no room
for a change in plan: Klode had ended his message with &#34;<q>thank you for
understanding</q>&#34;, which invited no further discussion. Glaubitz was
one of a few Debian developers who expressed discomfort with Klode&#39;s
communication style in the message.</p>

<p>Klode <a href="https://lwn.net/ml/all/20251031223819.GA97356@debian.org">noted</a>,
briefly, that Rust was already a hard requirement for all Debian
release architectures and ports, except for <a href="https://www.debian.org/ports/alpha/">Alpha (alpha)</a>, <a href="https://www.debian.org/ports/m68k/">Motorola 680x0 (m68k)</a>,
<a href="https://www.debian.org/ports/hppa/">PA-RISC (hppa)</a>, and
<a href="https://wiki.debian.org/SH4">SuperH (sh4)</a>, because of
APT&#39;s use of the <a href="https://sequoia-pgp.org/">Sequoia-PGP</a>
project&#39;s <a href="https://packages.debian.org/trixie/sqv"><tt>sqv</tt></a> tool to
verify <a href="https://openpgp.dev/book/signatures.html">OpenPGP</a>
signatures. APT falls back to using the GNU Privacy Guard
signature-verification tool, <a href="https://packages.debian.org/trixie/gpgv"><tt>gpgv</tt></a>, on
ports that do not have a Rust compiler. By depending directly on Rust,
though, APT itself would not be available on ports without a Rust
compiler. LWN <a href="https://lwn.net/Articles/1045363/">recently
covered</a> the state of Linux architecture support, and the status of
Rust support for each one.</p>

<!-- middle-ad -->

<p>None of the ports listed by Klode are among those <a href="https://www.debian.org/ports/#:~:text=List%20of%20official%20ports,-These">officially
supported</a> by Debian today, or targeted for support in
Debian 14 (&#34;forky&#34;). The sh4 port has never been officially
supported, and none of the other ports have been supported since
Debian 6.0. The actual impact on the ports lacking Rust is also
less dramatic than it sounded at first. Glaubitz <a href="https://lwn.net/ml/all/708d1a6e63d53242cf89f01c2d791e91f1eccab6.camel@physik.fu-berlin.de/">assured</a>
Antoni Boucher that &#34;<q>the ultimatum that Julian set doesn&#39;t really
exist</q>&#34;, but phrasing it that way &#34;<q>gets more attention in the
news</q>&#34;. Boucher is the maintainer of <a href="https://rust-for-linux.com/rustc_codegen_gcc"><tt>rust_codegen_gcc</tt></a>,
a <a href="https://lwn.net/Articles/954787/#codegen_gcc">GCC
ahead-of-time code generator for Rust</a>. Nothing, Glaubitz said,
stops ports from using a non-Rust version of APT until Boucher and
others manage to bootstrap Rust for those ports.</p>

<h4>Security theater?</h4>

<p>David Kalnischkies, who is also a <a href="https://salsa.debian.org/apt-team/apt/-/commits/main?author=David%20Kalnischkies">major
contributor</a> to APT, <a href="https://lwn.net/ml/all/sdi72zvp4koyi7h7wo2bwslds2j466ix4sar7wuaks3szphjmp@xg6itydwhqbp/">suggested</a>
that if the goal is to reduce bugs, it would be better to remove the
code that is used to parse the .deb, .ar, and .tar formats that Klode
mentioned from APT entirely. It is only needed for two tools, <a href="https://manpages.debian.org/trixie/apt-utils/apt-ftparchive.1.en.html"><tt>apt-ftparchive</tt></a>
and <a href="https://manpages.debian.org/trixie/apt-utils/apt-extracttemplates.1.en.html"><tt>apt-extracttemplates</tt></a>,
he said, and the only &#34;<q>serious usage</q>&#34; of
<tt>apt-ftparchive</tt> was by Klode&#39;s employer, Canonical, for its <a href="https://launchpad.net/">Launchpad</a> software-collaboration
platform. If those were taken out of the main APT code base, then it
would not matter whether they were written in Rust, Python, or another
language, since the tools are not directly necessary for any given
port.</p>

<p>Kalnischkies also questioned the claim that Rust was necessary to
achieve the stronger approach to unit testing that Klode mentioned:</p>

<blockquote>
<p>You can certainly do unit tests in C++, we do. The main problem is
that someone has to write those tests. Like docs.</p>

<p>Your new solver e.g. has none (apart from our preexisting integration
tests). You don&#39;t seriously claim that is because of C++ ?
If you don&#39;t like GoogleTest, which is what we currently have,
I could suggest doctest (as I did in previous installments).
Plenty other frameworks exist with similar or different styles.</p>
</blockquote>

<p>Klode has not responded to those comments yet, which is a bit
unfortunate given the fact that introducing hard dependencies on
Rust has an impact beyond his own work on APT. It may well be that he
has good answers to the questions, but it can also give the
impression that Klode is simply embracing a trend toward Rust. He is <a href="https://discourse.ubuntu.com/t/migration-to-rust-coreutils-in-25-10/59708">involved</a>
in the Ubuntu <a href="https://lwn.net/Articles/1014002/">work to migrate from GNU Coreutils to the Rust-based uutils</a>. The reasons given for that work, again, are around
modernization and better security—but security is not automatically 
guaranteed simply by switching to Rust, and there are a number of
other considerations.</p>

<p>For example, Adrian Bunk <a href="https://lwn.net/ml/all/aQkl0qyIyJ5+y5lC@localhost/">pointed
out</a> that there are a number of Debian teams, as well as tooling,
that will be impacted by writing some of APT in Rust. The release
notes for Debian 13 (&#34;trixie&#34;) <a href="https://www.debian.org/releases/trixie/release-notes/issues.html#go-and-rust-based-packages">mention</a>
that Debian&#39;s infrastructure &#34;<q>currently has problems with
rebuilding packages of types that systematically use static
linking</q>&#34;, such as those with code written in Go and Rust. Thus, &#34;<q>these packages will be
covered by limited security support until the infrastructure is
improved to deal with them maintainably</q>&#34;. Limited security support
means that updates to Rust libraries are likely to only be released
when Debian publishes a point release, which happens about every two
months. The security team has <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1106154#10">specifically
stated</a> that <tt>sqv</tt> is fully supported, but there are still
outstanding problems.</p>

<p>Due to the static-linking issue, any time one of <tt>sqv</tt>&#39;s
dependencies, currently more than 40 Rust crates, have to be rebuilt
due to a security issue, <tt>sqv</tt> (at least potentially) also
needs to be rebuilt. There are also difficulties in tracking CVEs for
all of its dependencies, and understanding when a security
vulnerability in a Rust crate may require updating a Rust program that
depends on it.</p>

<p>Fabian Grünbichler, a maintainer of Debian&#39;s Rust toolchain, <a href="https://lwn.net/ml/all/c818f7ef-eff7-40ac-b153-a88412f71d86@app.fastmail.com/">listed</a>
several outstanding problems Debian has with dealing with Rust
packages. One of the largest is the need for a consistent Debian policy for declaring
statically linked libraries. In 2022, Guillem Jover added a control
field for Debian packages called Static-Built-Using (SBU), which would list
the source packages used to build a binary package. This would
indicate when a binary package needs to be rebuilt due to an update in
another source package. For example, <tt>sqv</tt> depends on more than
40 Rust crates that are packaged for Debian. Without declaring the
SBUs, it may not be clear if <tt>sqv</tt> needs to be updated when one
of its dependencies is updated. Debian has been working on a <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1069256">policy
requirement for SBU</a> since April 2024, but it is not yet finished
or adopted.</p>

<p>The discussion sparked by Grünbichler makes clear that most of
Debian&#39;s Rust-related problems are in the process of being
solved. However, there&#39;s no evidence that Klode explored the problems
before declaring that APT would depend on Rust, or even asked &#34;is this
a reasonable time frame to introduce this dependency?&#34;</p>

<h4>Where tradition meets tomorrow</h4>

<p>Debian&#39;s tagline, or at least one of its taglines, is &#34;the
universal operating system&#34;, meaning that the project aims to run on a
wide variety of hardware (old and new) and be usable on the desktop,
server, IoT devices, and more. The &#34;<a href="https://www.debian.org/intro/why_debian">Why Debian</a>&#34; page
lists a number of reasons users and developers should choose the
distribution: <a href="https://www.debian.org/ports">multiple hardware
architectures</a>, <a href="https://wiki.debian.org/LTS">long-term
support</a>, and its <a href="https://www.debian.org/devel/constitution">democratic governance
structure</a> are just a few of the arguments it puts forward in favor
of Debian. It also notes that &#34;<q>Debian cannot be controlled by a
single company</q>&#34;. A single developer employed by a company to work
on Debian tools pushing a change that seems beneficial to that
company, without discussion or debate, that impacts multiple hardware
architectures and that requires other volunteers to do unplanned work
or meet an artificial deadline seems to go against many of the
project&#39;s stated values.</p>

<p>Debian, of course, does have checks and balances that could be
employed if other Debian developers feel it necessary. Someone could,
for example, appeal to Debian&#39;s <a href="https://www.debian.org/devel/tech-ctte">Technical Committee</a>,
or sponsor a general resolution to override a developer if they cannot
be persuaded by discussion alone. That happened recently when the <a href="https://lwn.net/Articles/1041316/">committee required systemd
maintainers to provide the <tt>/var/lock</tt> directory</a> &#34;<q>until
a satisfactory migration of impacted software has occurred and Policy
updated accordingly</q>&#34;.</p>

<p>However, it also seems fair to point out that Debian can move
slowly, even glacially, at times. APT <a href="https://mvogt.wordpress.com/2015/11/30/apt-1-1-released/">added</a>
support for the <a href="https://repolib.readthedocs.io/en/latest/deb822-format.html">DEB822</a>
format for its source information lists in 2015. Despite APT
supporting that format for years, Klode faced resistance in 2021, when
he <a href="https://lwn.net/ml/all/20211103163429.GA3688731@debian.org/">pushed
for Debian to move to the new format</a> ahead of the Debian 12
(&#34;bookworm&#34;) release in 2021, but was unsuccessful. It is now the
default for trixie with the move to <a href="https://lwn.net/Articles/1017315/">APT 3.0</a>, though APT
will continue to support the old format for years to come.</p>

<p>The fact is, regardless of what Klode does with APT, more and more
free software is being written (or rewritten) in Rust. Making it
easier to support that software when it is packaged for Debian is to
everyone&#39;s benefit. Perhaps the project needs some developers who will
be aggressive about pushing the project to move more quickly in
improving its support for Rust. However, what is really needed is more
developers lending a hand to do the work that is needed to support
Rust in Debian and elsewhere, such as <a href="https://rust-gcc.github.io/"><tt>gccrs</tt></a>. It does not
seem in keeping with Debian&#39;s community focus for a single developer
to simply declare dependencies that other volunteers will have to
scramble to support.</p>

</div></div>
  </body>
</html>
