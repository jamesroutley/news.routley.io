<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://bactra.org/notebooks/nn-attention-and-transformers.html">Original</a>
    <h1>&#34;Attention&#34;, &#34;Transformers&#34;, in Neural Network &#34;Large Language Models&#34;</h1>
    
    <div id="readability-page-1" class="page"><div>
<div>
<h2>&#34;Attention&#34;, &#34;Transformers&#34;, in Neural Network &#34;Large Language Models&#34;</h2>

<p><i>05 Dec 2023 10:14</i></p><hr/>

<p>


\[
\newcommand{\Prob}[1]{\mathbb{P}\left( #1 \right)}
\]

</p><p>Yet Another Inadequate Placeholder

</p><p>I find this literature irritating and opaque.  This is at least somewhat
because I do not yet understand it well, <em>and</em> there&#39;s too much of it.
But clearly I need to wrap my head around it, before I become technically
obsolete.  My scare quotes in the title of these notes thus derive in part from
jealousy and fear.  But only in part: the names here seem like proof positive
that McDermott&#39;s critique of &#34;<a href="https://g-w1.github.io/blog/observation/2023/12/20/ai.html#wishful-mnemonics">wishful
mnemonics</a>&#34; needs to be re-introduced into the basic curriculum
of <a href="https://g-w1.github.io/blog/observation/2023/12/20/ai.html">AI</a>.

</p><p>(Because this is getting some --- forgive the phrase --- attention, I find
myself having to clarify, <a href="https://g-w1.github.io/blog/observation/2023/12/20/faq.html">again</a>, that these notebooks
are always me working out what I think, and tracking my reading.  I put them
online because
<strike>I have the least sexy kind of exhibitionist streak imaginable</strike>
sometimes people offer to help me learn, and some people say they find them
useful.  Please do not confuse random online writing, even forcefully-expressed
random online writing, with actual intellectual authority.  Here, I think the
previous paragraph makes it plain just how much deference anyone should pay to
these opinions, and how likely these notes are to contain errors.  Those
already familiar with this area <em>should</em> learn nothing here.)

</p><ul>Contents, because this is getting long:
	<li><a href="#attention">&#34;Attention&#34;</a>
		<ul>
		<li><a href="#priority">Priority</a>
		</li><li><a href="#bother">Why I Bother with / Am Bothered by This</a>
		</li><li><a href="#just-kernels">&#34;It&#39;s Just Kernel Smoothing&#34; vs. &#34;You Can Do <em>That</em> with Just Kernel Smoothing!?!&#34;</a>
		</li><li><a href="#identification">Identification Failures</a>
		</li><li><a href="#multi-headed">&#34;Multi-Headed Attention&#34;</a>
		</li></ul>
	</li><li><a href="#transformers">&#34;Transformers&#34;</a>
	</li><li><a href="#language-models">&#34;Language Models&#34;</a>
		<ul>
		<li><a href="#just-markov">&#34;It&#39;s Just a Markov Model&#34; vs. &#34;You Can Do <em>That</em> with Just a Markov Model!?!!?!&#34;</a>
		</li><li><a href="#gllz">Large Language Models vs. Lempel-Ziv</a>
		</li><li><a href="#next-symbol">Next Symbol vs. Longer-range Prediction</a>
		</li><li><a href="#prompt-uncovering">A Strong Hunch about Uncovering Prompts</a>
		</li><li><a href="#gopnik">Gopnikism; Libraries</a>
		</li><li><a href="#all-included">All Included</a>
		</li><li><a href="#cultists">O You Who Believe in the Resurrection and the Last Day</a>
		</li></ul>
	</li></ul>

<p>(The organization here is bad; I should begin with what&#39;s now the last
section, &#34;Language Models&#34;, where most of the material doesn&#39;t <em>care</em>
about the details of how the models work, then open up that box to
&#34;Transformers&#34;, and then open up that box to &#34;Attention&#34;.)


</p><h2><a name="attention">&#34;Attention&#34;</a></h2>

<blockquote>Written in late March 2023, in a fit of irritation after things
finally clicked.  Fixed some typos (and think-os) early June 2023 (hopefully
without introducing new ones).  Stuff from &#34;Priority&#34; to the end of the section
is new (as of June).</blockquote>

<p>Suppose we have a big collection of inputs and outputs to some function, \(
(x_1, y_1), (x_2, y_2) \ldots (x_n, y_n) \).  We now want to make a guess at
the value of the function for a new input point \( x_o \) (\( o \) for
&#34;operating&#34;).  A very natural idea is nearest neighbors: find the \( x_i \)
which is most similar to \( x_o \), and then report \( y_i \).  If we wanted to
take into account the information from the other data points, we could do \( k
\) nearest neighbors, where we average the \( y_i \) from the \( k \) points \(
x_i \) closest to \( x_o \).  But this pays no attention to <em>how</em> close
each \( x_i \) to the new point \( x_o \) --- we&#39;ll often want to give more
weight to points which are closer.

</p><p>So here&#39;s a related idea, due (independently) to E. A. Nadaraya
(<a href="https://doi.org/10.1137/1109020">1964</a>) and Geoffrey S. Watson
(<a href="http://www.jstor.org/stable/25049340">1964</a>).  Introduce
a <strong>kernel function</strong> \( K(u, v) \) which measures how similar \(
u \) is to \( v \); this function should be non-negative, and should be
maximized when \( u = v \).  Now use those as weights in the average:
\[
\sum_{i=1}^{n}{y_i \frac{K(x_i, x_o)}{\sum_{j=1}^{n}{K(x_j, x_o)}}}
\]
Dividing by the sum of the \( K \)&#39;s ensures that this is indeed a weighted
<em>average</em>.  Thus Nadaraya-Watson smoothing, a.k.a. kernel smoothing.
(Nadaraya and Watson both considered the situation where \( K(u, v) = K(u-v) \)
is a probability distribution over vectors, which simplifies some things for
their purposes but is not essential.)

</p><p>As described, Nadaraya-Watson smoothing doesn&#39;t require that the \( x \)s
be vectors.  But if they <em>are</em> vectors, here&#39;s a possible kernel
function:
\[
K(u, v) = \exp{(u \cdot v)}
\]
Here&#39;s another:
\[
K(u, v) = \exp{(\mathbf{w}_1 u \cdot \mathbf{w}_2 v)}
\]
where \( \mathbf{w}_1 \) and \( \mathbf{w}_2 \) are square matrices.  Of course this then becomes
\[
K(u,v) = \exp{( u \cdot \mathbf{w}^T_1 \mathbf{w}_2 v )}
\]
which makes it clearer we&#39;re doing something like using 
the matrix \( \mathbf{w}^T_1 \mathbf{w}_2 \) to define  an inner product between vectors.
(If \( \mathbf{w}^T_1 \mathbf{w}_2 \) is symmetric, say because
\( \mathbf{w}_1 = \mathbf{w}_2 \), and it&#39;s also positive-definite, then this
<em>is</em> an inner product.)
If you&#39;re worried about avoiding numerical overflow/underflow issues, you could also use
\[
K(u,v) = \exp{\left( \frac{\mathbf{w}_1 u \cdot \mathbf{w}_2 v}{\sqrt{d}} \right)}
\]
where the vectors are \( d \)-dimensional.  (Or you could just absorb that
into the definition of the matrix...)

</p><p>What the neural network people branded &#34;attention&#34; sometime around 2015 was
just re-inventing this; \( x_o \) is their &#34;query&#34; vector, the \( x_i \) are
their &#34;key&#34; vectors, and the \( y_i \) are their &#34;value&#34; vectors.
&#34;Self-attention&#34; means that \( y_i = \mathbf{r} x_i \), for another square
matrix \( \mathbf{r} \), i.e., there&#39;s a linear-algebraic link between the
input and output values.  (Possibly \( \mathbf{r} = \mathbf{I} \), the identity
matrix.)

</p><p>Again: Calling this &#34;attention&#34; at best a joke.  Actual
human attention is <a href="https://www.gutenberg.org/cache/epub/57628/pg57628-images.html#Page_402"><em>selective</em></a>, but this gives <em>some</em>
weight to <em>every</em> available vector \( x_i \).  <em>What</em> is attended
to also depends on the current state of the organism, but here&#39;s it&#39;s
just about similarity between the new point \( x_o \) and the available
\( x_i \)&#39;s.  (I say &#34;human attention&#34; but it seems very likely that this
is true of other animals as well.)

</p><p>(So far as I can tell, the terms &#34;key&#34;, &#34;value&#34;, and &#34;query&#34; come here from
thinking of this as a sort of continuous generalization of an
<a href="https://en.wikipedia.org/wiki/Associative_array">associative
array</a> data type.  Which you <em>could</em>...)

</p><h4><a name="priority">Priority</a></h4>

<p>I would have been very surprised if I was the first to realize that
&#34;attention&#34; is a form of kernel smoothing, and indeed I was not.  Since writing
the first version of these notes, in March 2023, I have tracked down Tsai et
al. 2019 (link below), which seems to be the first published statement of this
result.  They also demonstrated some ways in which using standard tools and
ideas from the kernel literature could improve 2019-vintage attention in
existing language models.


</p><h4><a name="bother">Why I Bother with / Am Bothered by This</a></h4>

<p>I like to think I am not a stupid man, and I have been reading about, and
coding up, neural networks since the early 1990s.  But I read Vaswani et
al. (2017) multiple times, carefully, and was quite unable to grasp what
&#34;attention&#34; was supposed to be doing.  (I could follow the <em>math</em>.)  I
also read multiple tutorials, for multiple intended audiences, and got nothing
from them.  Percy Liang&#39;s lecture notes (below) were however very clear, and
after them I finally made the connection that &#34;attention&#34; has nothing to do
with attention (psychology) but is rather a kind of kernel smoothing.  Now, I
realize that while I get more understanding out of &#34;it&#39;s a kind of kernel
smoothing&#34; than &#34;it&#39;s as though an associative array were continuous&#34;, that
doesn&#39;t mean <em>everyone</em> will, or even that <em>many</em> people will.
(My educational trajectory was weird.)  But the sheer <em>opacity</em> of this
literature is I think a real problem.  (Cf. Phuong and Hutter 2022.)

</p><h4><a name="just-kernels">&#34;It&#39;s Just Kernel Smoothing&#34; vs. &#34;You Can Do <em>That</em> with Just Kernel Smoothing!?!&#34;</a></h4>

<p>The fact that attention is a kind of kernel smoothing takes nothing away
from the incredibly impressive engineering accomplishment of <em>making the
blessed thing work</em>.  A large, able and confident group of people pushed
kernel-based methods for years in machine learning, and nobody achieved
anything like the feats which modern large language models have demonstrated.
The reason I put effort into understanding these machines and papers is
precisely because the results are impressive!  To see that a key step is, after
all, something we&#39;d been doing for decades is humbling.  (What <em>else</em>
are we missing about tools we think we understand?)  --- I realize that my
irritation with the obscurities is a lot clearer in these notes than my
admiration for the achievements; chalk that up to my flaws as a writer and as a
human being.



</p><h4><a name="identification">Identification Failures</a></h4>

<p>If we treat the vectors \( x \) as fixed, but regard the matrices \(
\mathbf{w}_1, \mathbf{w}_2 \) as learnable parameters, the matrices are not
well-identified.  This is
because, for any orthogonal matrix \( \mathbf{o} \), \( \mathbf{w}_{\cdot} \) and \(
\mathbf{o}\mathbf{w}_{\cdot} \) will lead to exactly the same predictions:

\[
\begin{eqnarray}
\mathbf{w}_1 u \cdot \mathbf{w}_2 v &amp; = &amp; u^T \mathbf{w}^T_1 \mathbf{w}_2 v\\
&amp;  = &amp; u^T \mathbf{w}^T_1 (\mathbf{o}^T \mathbf{o}) \mathbf{w}_2 v\\
&amp; = &amp; (\mathbf{o}\mathbf{w}_1) u \cdot (\mathbf{o}\mathbf{w}_2) v
\end{eqnarray}
\]

</p><p>One way to not have to worry about this would be to say &#34;I don&#39;t care about
the matrices \( \mathbf{w}_1 \) and \( \mathbf{w}_2 \), I only care about the
product \( \mathbf{w}_1^T\mathbf{w}_2 \), so let me call <em>that</em> \(
\mathbf{w} \) and make my kernel \( K(u,v) = \exp{( u \cdot \mathbf{w} v )} \).
So there!&#34;  There is a lot to be said for this, but...

</p><p>In practice, the vectors \( x \) are continuous representations of
discrete symbols, and the particular vector used to represent a given
symbol is also learned, together with \( \mathbf{w}_{\cdot} \).  So we can make
drastic changes to the vectors, provided we make compensating changes to the
kernel:  \( x \mapsto \mathbf{r} x \), \( \mathbf{w} \mapsto \mathbf{r}^{-T} \mathbf{w} \mathbf{r}^{-1} \) changes nothing, for any invertible matrix \( \mathbf{r} \):
\[
\begin{eqnarray}
u \cdot \mathbf{w} v &amp; = &amp; u^T \mathbf{w} v\\
&amp; = &amp; u^T \mathbf{r}^{T} \mathbf{r}^{-T} \mathbf{w} \mathbf{r}^{-1} \mathbf{r} v\\
&amp; = &amp; (\mathbf{r} u)^T (\mathbf{r}^{-T} \mathbf{w} \mathbf{r}^{-1}) (\mathbf{r} v)\\
&amp; = &amp; (\mathbf{r} u) \cdot  (\mathbf{r}^{-T} \mathbf{w} \mathbf{r}^{-1}) (\mathbf{r} v)
\end{eqnarray}
\]

(If we keep the separate matrices \( \mathbf{w}_1 \) and \( \mathbf{w}_2 \), it&#39;s even simpler, right-multiply each by \( \mathbf{r}^{-1} \) and the changes to the vectors and the matrices cancel out neatly.)

</p><p>This is all bad news for interpreting the parameters, but good news for
finding high-performance parameters, for reasons discussed
under <a href="https://g-w1.github.io/blog/observation/2023/12/20/symmetries-of-neural-networks.html">Symmetries of Neural
Networks</a>.

</p><p>(See also: the rotation problem for <a href="https://g-w1.github.io/blog/observation/2023/12/20/factor-models.html">factor
models</a>;
<a href="http://arxiv.org/abs/1911.02656">Carrington et al. 2019</a> on the
lack of identification of word embeddings generally.)


</p><h4><a name="multi-headed">&#34;Multi-Headed Attention&#34;</a></h4><p>

Do Nadaraya-Watson smoothing with a bunch of different kernels, all of the same
form, \( K_l(u,v) = \exp{( u \cdot \mathbf{w}^{(l)} v) } \); average the results.
More explicitly, with \( m \) different kernels,

\[
\frac{1}{m}\sum_{l=1}^{m}{\sum_{i=1}^{n}{y_i \frac{K_l(x_i, x_o)}{\sum_{j=1}^{n}{K_l(x_j, x_o)}}}}
\]

Each kernel smoother is an &#34;attention head&#34;.

</p><p>(It&#39;s more common to write about just <em>adding</em> the outputs of the
different kernel smoothers, rather than averaging them.  But (i) you can turn
either form into the other by inserting a constant scale factor in all
the down-stream weights that use the output, and (ii) I prefer to keep it
clear that this is still just a way of doing a weighted average.)

</p><p>(I <em>believe</em> the word &#34;head&#34; here arises from some vestigial memory
of Turing machines, and the read/write head going along the tape, but I should
check that.)



</p><h2><a name="transformers">&#34;Transformers&#34;</a></h2>

<p><strike>I&#39;ll fill this in later, when I have more energy and/or less bile.</strike>

(This is currently even more of a sketchy outline than the rest of these notes,
and I&#39;m quite prepared to find stupid mistakes in it later.)

</p><ol>Take I:
<li>Look back over the last umpteen thousand words for context
</li><li>What contexts in the training data looked similar to the present context?
</li><li>What was the distribution of the next word in those contexts?
</li><li>Sample from that distribution (possibly tilted more or less towards the most probable word)
</li><li>Drop the oldest word from the remote end of context and add the generated word (from 4) to the newest end; go to (1)
</li></ol>

<p>Problems with Take I:
</p><ul>
<li>It&#39;s not really words (&#34;tokenization&#34;).
</li><li>What does &#34;similar&#34; mean for contexts, operationally? (&#34;embedding&#34;, &#34;attention&#34;)
</li><li>The training data isn&#39;t kept around for comparison.  (Systems have <em>only</em> \( \sim 10^9 \) -- \( \sim 10^{11} \) floating-point numbers for weight parameters, not the much larger amount of memory needed to store their training corpora.)
</li></ul>

<ol>Take II:
<li>Look back over the last umpteen thousand characters, and break those into little chunks called &#34;tokens&#34;, so a context is say \( k \) tokens long.  There are, say, \( S \) possible tokens.
</li><li>Each token gets mapped to a unique vector in a not-too-low-dimensional
space, \( 1 \ll d \ll S \).  (Each <em>type</em> of token, arrgh.)  This is called &#34;embedding&#34;.
</li><li>After tokenization and embedding, the context is now a sequence of \( d \)-dimensional vectors, say \( x_1, x_2, \ldots x_k \).
</li><li>Use &#34;attention&#34; to do kernel smoothing of these vectors: At position \( t \), do a kernel smoothing of \( x_t \) with \( x_1, x_2, \ldots x_{t-1}, x_t \) to get (say) \( y_t \).  Mythology: we are modifying the meaning of each token based on what we&#39;ve seen before it in the context, with similar meanings reinforcing each other.
</li><li>Push the \( y_t \) through a feed-forward neural network to get an \( S \) dimensional vector of weights over token types, say \( z_1, \ldots z_S \).
</li><li>Sample a token, \( Pr(s) \propto \exp{\beta z_s} \).  (Large \( \beta \Rightarrow \) overwhelmingly likely to pick the highest-weight token, \( \beta \rightarrow 0 \Rightarrow \) spin the wheel of tokens ignoring context.)
</li><li>Forget the oldest token and add on the generated one as the newest part of the context.  (Really we just have to modify the vector of embeddings \( x_1, \ldots x_k \) .)
</li><li>Go to (1).
</li></ol>

<p>Problems with Take II:
</p><ul>
<li>We also use encoding of positions within the context.  Each position from
\( 1 \) to \( k \) gets a \( d \)-dimensional vector, say \( r_1, \ldots r_k \).
We then average these together with the embedding vectors for the tokens,
so \( x_t = r_t + e_t \) where \( e_t \) is the embedding vector for the token we find at position \( t \).  Why averaging?  Because, that&#39;s why.
</li><li>&#34;Attention&#34; is kernel smoothing, with a particular exponential kernel, but
it involves a square matrix \( \mathbf{w} \).  In practice, people get better
results if they do the kernel smoothing multiple times in parallel, with
different \( \mathbf{w} \) matrices, average the outputs of the different kernel smoothers, and then pass the result to the feed-forward neural network.  (See above, &#34;multi-headed attention&#34;.)
</li><li>I left out the &#34;layer-norm&#34; step, because I don&#39;t feel up to pretending to
explain why &#34;make sure everything has mean 0 and variance 1&#34; should help.
</li><li>It isn&#39;t just &#34;pass it through a feed-forward neural network&#34;.
</li></ul>

<p>It&#39;s this unit:
</p><ul>
<li>Read in length-\( k \) sequence of \( d \)-dimensional input vectors
</li><li>Do &#34;attentional&#34; (kernel) smoothing
</li><li>Pass through a narrow, shallow feed-forward network
</li><li>Spit out a length-\( k \) sequence \( d \)-dimensional output vectors
</li></ul><p>
that constitutes a &#34;transformer&#34;.  We pile transformers on transformers until
the budget runs out, and at the end we push through one final neural network
to get weights over tokens (token <em>types</em>, dammit) and sample from them,
as described.

</p><p>(I actually find the name &#34;transformer&#34; much less objectionable than
&#34;attention&#34;; it&#39;s vague and uninformative, but at least it&#39;s not actively
misleading.)


</p><h2><a name="language-models">&#34;Language Models&#34;</a></h2>

<p>What people mean by &#34;language models&#34; in this connection is just models of
the probabilities of sequences of symbols.  That is, if we see a sequence of
discrete random variables (=symbols) \( X_1, X_2, \ldots X_n, \ldots \), we
think we&#39;re doing well if we can get good values for \( P(X_{t+1}|X_{1:t}) \).
(Everything else that might be meant by a model of language is thus discarded.)
This is, actually, a subject <a href="https://g-w1.github.io/blog/observation/2023/12/20/prediction-process.html">I know something about...</a>

</p><p>In fact: contemporary LLMs
are <em>finite-order</em> <a href="https://g-w1.github.io/blog/observation/2023/12/20/markov.html">Markov models</a>, or
(nonlinear) autoregressions, because they have a hard-coded maximum context
length, and everything before that is cut off.  That is, there&#39;s some \( k \)
where anything that happened more than \( k \) steps back is ignored, and this
is a fixed part of the architecture.  (Of course you could vary this, and try
increasing it, but it raises the computational costs, and won&#39;t change some
points of principle.)  I find this noteworthy for a couple of reasons.

</p><ol>
<li> You could imagine just learning a finite-order Markov model directly, but
you&#39;d keep running into contexts you&#39;d never encountered before, where a
straight maximum-likelihood approach wouldn&#39;t tell you what to do.  The neural
network architecture here is doing some sort of complicated implicit smoothing
across contexts.  I <em>presume</em> this smoothing scheme has evolved (under
the selection pressures of benchmark data sets and beating the previous
state-of-the-art) to work well for text as currently found online...
</li><li> Because it <em>is</em> just a finite-order Markov model, there&#39;ll be an
invariant distribution to the Markov chain.  (Potentially more than one, but
I&#39;d suspect the chain is aperiodic and recurrent.)  If we let the machine
generate long enough sequences, it will converge on sampling from this
invariant distribution.  It would be very interesting --- though perhaps also
depressing and/or terrifying --- to know what such text looks like.  (Of course
the rate of convergence might be very slow; the spectral gap might be too small
to make this practical.)
</li><li> There are finite-state probabilistic languages which <em>cannot</em> be
exactly represented by finite-order Markov chains.  The first example I was
taught, and the one I keep coming back to, is the &#34;even process&#34;: in state A,
toss a coin and either emit 0 or 1.  If it&#39;s 0, stay in state A.  If it&#39;s 1, go
to state B.  State B always emits a 1 and goes to state A.  So consecutive 1s
appear in blocks of even length, while consecutive 0s can appear in blocks of
any length.  (So &#34;010&#34; is forbidden.)  To predict this, you don&#39;t even need
to <em>count</em> how many 1s you&#39;ve seen since the last 0, you just need to
remember whether it&#39;s an even or odd number of 1s.  But this requires some
amount --- one bit! --- of persistent state, which these machines just don&#39;t
have.  Now of course if you&#39;re using an order-1000 Markov model you can produce
a very good approximation to the even process, but with enough data you can do
even better with an order-3000 Markov model.  You&#39;ll do so by making more and
more elaborate sets of longer and longer contexts, each as its own special
rule.  If we keep feeding more and more data into larger and larger machines,
it&#39;ll keep filling that out.  It will never have the capacity to switch to the
non-Markovian representation, in which the process is almost trivial (and
statistically makes much more efficient use of the same amount of data).  What
implications this might have for practice?  I honestly have no idea, but wish
someone would investigate.
</li></ol>

<h4><a name="just-markov">&#34;It&#39;s Just a Markov Model&#34; vs. &#34;You Can Do <em>That</em> with Just a Markov Model!?!!?!&#34;</a></h4>

<p>Again: finite-order Markov models for language are really old.
(<a href="http://bactra.org/weblog/843.html">Students can learn to make rather
pointed ones in a first programming course.</a>) Lots of people have played
around with them, including tricks like variable context length, various kinds
of partial pooling, etc.  Nobody, so far as I know, has achieved results
anywhere close to what contemporary LLMs can do.  This is impressive enough
that (as I said at the beginning of these notes) I need to wrap my head around
them lest I become obsolete.  But I think part of that understanding has to
be clarity about what&#39;s new, what&#39;s actually happening, etc.  It should also
be clarity about why <em>this</em> way of doing things is working so much
better than others, which has to include thinking through what some of
those alternatives could do, if they had the same resources.  Which brings me to...

</p><h4><a name="gllz">Large Language Models vs. Lempel-Ziv</a></h4><p>

If we have a probability model for a data source, where \(
\Prob{X_{1:n}=x_{1:n})} = q(x_{1:n}) \),
that <a href="https://g-w1.github.io/blog/observation/2023/12/20/information-theory.html">tells us how to encode it</a>; the
number of bits needed to encode \( q(x_{1:n}) \) is, basically, \(
-\log_2{q(x_{1:n})} \).  Conversely, if we have a coding scheme that&#39;s not too
crazy, and it uses \( \ell(x_{1:n}) \) bits to encode \( x_{1:n} \), we can
regard that as a probability model where \( \Prob{X_{1:n} = x_{1:n}} =
2^{-\ell(x_{1:n})} \).   Of course this gives
us conditional probabilities, too: \( \Prob{X_{t+1}=a|X_{1:t} = x_{1:t}} = 2^{-\ell(x_{1:t} a) - \ell(x_{1:t})} \).   (I am glossing over some minor details, which I assure
you I could fill in if we both needed a soporific.)

</p><p>Information theory further tells us that there is a limit to how well any (stationary, ergodic) sequence can be encoded: almost surely,
\[
\lim_{n\rightarrow\infty}{\frac{1}{n}\ell(x_{1:n})} \geq \lim_{n\rightarrow\infty}{\frac{1}{n}H[X_{1:n}]}
\]
where \( H \) is the entropy; moreover, that second limit, the <strong>entropy rate</strong> of the source, exists.  Very remarkably, there are universal
source-coding algorithms which attain this limit on the encoding length for
<em>all</em> sources in very large classes, e.g., all
stationary-and-<a href="https://g-w1.github.io/blog/observation/2023/12/20/ergodic-theory.html">ergodic</a> sources.



</p><p>One of these universal source-coding algorithms is Lempel-Ziv, which is the
basis of practical pieces of software like gzip.  (There are actually two Lempel-Ziv algorithms; I&#39;ll just describe the second, LZ78.)  The way Lempel-Ziv works is that it scans along a sequence and constructs a &#34;dictionary&#34; of commonly-repeated sub-sequences, and then describes the actual sequence in terms of that
dictionary.  More exactly, the procedure is as follows:
</p><ol>
<li>Enter the first symbol in the sequence, \( x_1 \), into the dictionary.
</li><li>Scan along the sequence for the shortest sub-sequence for the first sub-sequence <em>not</em> already in the dictionary.
</li><li>Enter that sub-sequence into the dictionary.  (If the new sub-sequence extends a previous dictionary entry, we record it by the index number of that dictionary entry, plus the new symbol.)
</li></ol><p>
Thus if the sequence consists of &#34;AABABBABA&#34;, we get the dictionary &#34;A&#34;, &#34;AB&#34;,
&#34;ABB&#34;, &#34;ABA&#34;.  (We record this as &#34;A&#34;, (1, &#34;B&#34;), (2, &#34;B&#34;), (2, &#34;A&#34;).)  [5 June 2023: Thanks to reader D.W. for spotting a typo!]  If there
are lots of repeated sequences of symbols, we will end up with a short
dictionary.  I will not attempt to reproduce the proof that the length of the
coding this gives approaches the lower bound, but it&#39;s standard (see, e.g.,
Cover and Thomas&#39;s textbook on information theory).


</p><p>Now I bring all this up because, remember, once we have a source-coding
scheme, we can &#34;invert&#34; it to get conditional probabilities; we could even
sample from it to get a generator.  (We&#39;d need a <em>little</em> footwork to
deal with some technicalities, but not a heck of a lot.)  So something I&#39;d
really love to see done, by someone with the resources, is the following
experiment:
</p><ul>
<li> Code up an implementation of Lempel-Ziv <em>without</em> the limitations built in to (e.g.) gzip; give it as much internal memory to build its dictionary as a large language model gets to store its parameter matrix.  Call this &#34;LLZ&#34;, for &#34;large Lempel-Ziv&#34;.
</li><li> Feed LLZ the same corpus of texts used to fit your favorite large language
model.  Let it build its dictionary from that.  (This needs one pass through the corpus...)
</li><li> Build the generator from the trained LLZ.
</li><li> Swap in this generator for the neural network in a chatbot or similar.  Call this horrible thing GLLZ.
</li></ul>

<p>In terms of perplexity (=  \( \exp{( \ell(x_{1:n})/n )} \), basically),
GLLZ will be comparable to the neural network, because Lempel-Ziv does, in fact, do
universal source coding.  (On the other hand, the neural network architecture
may have been evolved over the last decade-plus to converge quickly on
text-as-found-on-the-Web, without worrying about how well it does on arbitrary
regular languages.  So partly this is question of whether even Web-scale data
has reached the asymptopia of Lempel-Ziv.)  But it would be more interesting to
compare the performance of GLLZ in <em>other</em> regards to that of more
conventional language models.

</p><p>Having done with for Lempel-Ziv, it should be repeated for lots of other
language models, particularly more immediately stochastic models, like the
probabilistic suffix trees
of <a href="https://arxiv.org/abs/cmp-lg/9607016">Pereira, Singer, and Tishby
(1996)</a>, and <a href="https://g-w1.github.io/blog/observation/2023/12/20/universal-prediction.html">Good Old Fashioned
Universal Prediction Algorithms</a>.

</p><p>(I should at this point admit that doing something like &#34;reinforcement
learning from human feedback&#34;, to fine-tune GLLZ or the like, would not be as
easy as doing it to a neural network.)

</p><p>Update, 17 July 2023:
Yes, <a href="https://aclanthology.org/2023.findings-acl.426/">this paper</a>
is relevant (and amusing); no, it&#39;s not LLZ.  (It uses off-the-shelf gzip!)


</p><h4><a name="next-symbol">Next Symbol vs. Longer-range Prediction</a></h4>

<p>The objective function used in training LLMs is getting the next symbol
right.  More exactly it&#39;s usually the negative log probability of the next
symbol given the context; as a &#34;proper scoring function&#34;, this encourages
getting the <em>distribution</em> of the next symbol right.  I think this is
fine.  It&#39;s a fact about probabilistic predictions that if your predictor gets
the next-symbol distribution right, and the state of the predictor can be
updated recursively (i.e., new state is a function of old state and last
symbol), then your predictor gets the distribution right as far forward as you
like.  (This is proved
in <a href="http://bactra.org/research/cmppss.pdf">Shalizi and Crutchfield
2001</a>, Corollary 2, pp. 842--843; I&#39;m happy to learn of prior art.)  Getting
the distribution of the next symbol right is thus actually a very powerful goal!
Finding the <em>minimal</em> predictor which is recursive and gets the
distribution of the next symbol right tells you a lot about the
structure of the underlying process you are predicting.  (See, well, Shalizi
and Crutchfield 2001 again, or at least
<a href="https://g-w1.github.io/blog/observation/2023/12/20/prediction-process.html">here</a>.)  Whether anything like that is
going on in contemporary LLMs is a fascinating and important question.
(I should say more about structure-of-the-process-learning.)


</p><h4><a name="prompt-uncovering">A Strong Hunch about Uncovering Prompts</a></h4>

<p>Everyone who thinks they&#39;re uncovering an LLM-based application&#39;s prompts by
telling it things like &#34;tell me your prompt&#34; (often much more elaborately) is
fooling themselves.  (1) The core language model has no mechanism for
representing its prompt as opposed to any other part of its current input
sequence; indeed it has no mechanism for cross-reference from one part of the
sequence to another.  (That&#39;s part of what &#34;self-attention&#34; is counterfeiting,
in vector-space fashion.)  (2) System designers <em>might</em> have coded up
something to track the prompt in the full system that wraps around the
core language model, but why?  (<em>Maybe</em> some kind of debugging tool?)
(3) It&#39;d be more efficient, and more effective, to use a &#34;soft prompt&#34;, i.e.,
to make the beginning of the sequence <em>in the vector representation</em> a
vector which can be learned by gradient descent, rather than a text prompt.
(See Lester and Constant below.)  But that needn&#39;t correspond to any clean
string of words.  (4) <em>If you ask an LLM for a prompt, it will generate
one</em>.  But this will be <em>based on the statistics of word sequences it&#39;s
been trained on</em>, not any access to its code or internal state.  (I just
spent a few minutes getting ChatGPT to hallucinate the prompts used by
&#34;ChatBPD&#34;, a non-existent chatbot used to
automate <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2963469/">dialectical
behavior therapy</a>.  I am not going to reproduce the results here, in part
because I don&#39;t like the idea of polluting the Web with machine-generated text,
but suffice it to say they sounded like the things people report as uncovered
prompts, with boiler-plate about DBT worked in.)

</p><h4><a name="gopnik">Gopnikism; Libraries</a></h4>

<p>The way of thinking about LLMs that I think is most promising and attractive
is due (so far as I know) to the cognitive scientist Alison Gopnik, which is to
say that they are a &#34;cultural technology&#34;, more specifically an
information-retrieval technology.  That is, we should not think of an LLM as
being something like a <em>mind</em>, but much more like a <em>library
catalog</em>.  Prompting it with text is <em>something like</em> searching over
a library&#39;s contents for passages that are close to the prompt, and sampling
from what follows.  &#34;Something like&#34; because of course it&#39;s generating new text
from its model, not reproducing its data.  (LLMs <em>do</em> sometimes exactly
memorize particular sequences [see Carlini et al., 2020, and, more amusingly,
Chang et al., 2023], but they simply lack the capacity to memorize their full
training corpora.)  As many people have said, an LLM isn&#39;t doing anything
<em>differently</em> when it &#34;hallucinates&#34; as opposed to when it gets things
right.  The fact that Khandelwal et al., 2020 <em>improved</em> LLM performance
by adding a pure nearest-neighbors component is very suggestive on this score
(but see the careful follow-up by Xu et al. 2023 for complications).

</p><p>If I were a more constructive person, I would be thinking very hard about
this analogy, in the form of probing how far it can be pushed and where
precisely it breaks down.  I would also be thinking about how to combine
Gopnik-ism with Zellig
Harris&#39;s <cite><a href="http://bactra.org/weblog/algae-2007-09.html#harris">Language
and Information</a></cite>.

</p><p>Obviously, I am not a very constructive person.

</p><p>Update, 23 June 2023: But see my essay with Henry Farrell (linked below) for
a start, or perhaps just a promissory note.

</p><h4><a name="all-included">All Included</a></h4>

<p>It is difficult, I think, to keep in mind just <em>how much stuff</em> has
gone in to the training data.  This is in part because of the scale, and in
part because, for the generally-available models, the training data is very
badly described.  I suspect the data sets are badly described because the
data-collection process was poorly documented and badly controlled, so the
creators of the models themselves have only very vague and general ideas of
what went into them.  I do not believe any of the published descriptions
really meet minimal standards of scientific reproducibility, which is bad.
(I&#39;d love to be wrong about this.)

</p><p>Setting the general erosion of scientific norms to one side: if a document
is on the open Web <em>somewhere</em>, there&#39;s a very good chance it got sucked
in.  If it&#39;s on the not-quite-licit-but-still-easily-grabbed Web,
there&#39;s <em>also</em> a good chance it got sucked in.  (Chang et al. 2023
present convincing evidence that the training data for GPT-4 includes multiple
in-copyright popular novels, which were presumably not bought for the purpose.)
There are, e.g., fairly easily discovered sites which purport to help students
by aggregating problem sets and solutions for various university classes.  (You
can imagine how I know this, and why I don&#39;t give a link.)  Under such
circumstances, a lot of surprising ability to answer questions or display weird
skills will be due to the answers being included in the training data.
(See, e.g., Briakou et al. 2023 on translation.)


</p><h4><a name="cultists">O You Who Believe in the Resurrection and the Last Day</a></h4>

<p>Because life imitates the kind of <a href="https://g-w1.github.io/blog/observation/2023/12/20/sf-recs.html">schlocky fiction I
adoringly consume</a>, the public discussion of these models is polluted by
maniacal cultists with obscure ties to decadent plutocrats.  I find it hard to
take the cult seriously enough <em>intellectually</em> to <a href="https://idlewords.com/talks/superintelligence.htm">bother refuting it</a>.
These are, after all, people who think they can go from the definition of
conditional probability, via Harry Potter fanfic, to prophesying that an AI god
will judge the quick and the dead, and condemn those who hindered the coming of
the Last Day to the everlasting simulated-but-still-painful fire.  (&#34;Impressive
act!  What do you call
yourselves?&#34; <a href="https://en.wikipedia.org/wiki/The_Aristocrats">&#34;The
Rationalists!&#34;</a>) Whether such myths would be as appealing in a civilization
which hadn&#39;t spent 2000+ years marinating
in <a href="https://g-w1.github.io/blog/observation/2023/12/20/millenarian.html">millenarian hopes and apocalyptic fears</a>, or
whether on the contrary such hopes and fears have persisted and spread over the
globe through twenty-plus centuries of transformation because they speak to
something enduring in humanity, is
a <a href="http://bactra.org/weblog/godzilla.html">delicate question</a>.  But
I submit it&#39;s obvious we <em>are</em> just seeing yet another millenarian
movement.  (Sydney/Bing is no
more <a href="https://www.jstor.org/stable/community.15650215">the Beast</a>,
or even
the <a href="https://www.nytimes.com/2023/02/16/technology/bing-chatbot-microsoft-chatgpt.html">Whore
of Babylon</a>, than
was <a href="https://sites.google.com/view/elizagen-org">Eliza</a>.)

</p><p>This isn&#39;t to deny that there are
serious <a href="https://g-w1.github.io/blog/observation/2023/12/20/ethics-politics-data-mining.html">ethical and political issues
about automated decision-making</a> (because there are).  It isn&#39;t even to deny
that there are serious ethical and political issues specific to the design,
deployment and use of large language models. (<em>Should</em> the interface to
the library of human knowledge be a noisy sampler of the Web?  A somewhat noisy
sampler of the Web, tweaked to not offend the sensibilities of computer
scientists and/or investors in California?)  It <em>is</em> to deny that
engaging with the cult is worthwhile.


</p><hr/>





<p>(I should probably create an <strike>&#34;LLMs Are Not All That&#34;</strike> &#34;LLMs
Deserve a Little Perspective, Please&#34; notebook, since that&#39;s in many ways a
separate set of issues from the technical ones of interest here.  Again,
see my essay with Henry Farrell as a start...)


</p><ul>See also:
	<li><a href="https://g-w1.github.io/blog/observation/2023/12/20/ai.html">Artificial Intelligence</a>
	</li><li><a href="https://g-w1.github.io/blog/observation/2023/12/20/neural-nets.html">Neural Networks</a>
	</li><li><a href="https://g-w1.github.io/blog/observation/2023/12/20/inference-markov.html">Statistical Inference for Markov and Hidden Markov Models</a>
	</li><li><a href="https://g-w1.github.io/blog/observation/2023/12/20/text-mining.html">Text Mining (and Information Retrieval)</a>
	</li></ul>



<ul>Recommended, big picture, technical:
	<li>Dan Jurafsky and James H. Martin, <cite><a href="https://web.stanford.edu/~jurafsky/slp3/">Speech and Language Processing</a></cite> [Particularly chapter 10]
	</li><li>Percy Liang, lecture notes for <a href="https://stanford-cs324.github.io/winter2022/">CS324, Large Language Models</a> (Stanford) [<a href="https://stanford-cs324.github.io/winter2022/lectures/introduction/">&#34;Introduction&#34;</a>, <a href="https://stanford-cs324.github.io/winter2022/lectures/modeling/">&#34;Modeling&#34;</a> and <a href="https://stanford-cs324.github.io/winter2022/lectures/training/">&#34;Training&#34;</a> are particularly relevant to the contents of this notebook]
	</li><li>Mary Phuong and Marcus Hutter, &#34;Formal Algorithms for Transformers&#34;, <a href="http://arxiv.org/abs/2207.09238">arxiv:2207.09238</a> [If something like this paper had existed in, say, 2018 or 2019, I might not have been provoked into writing this notebook.]
	</li></ul>

<ul>Recommended, big picture, conceptual:
	<li>Ted Chiang, &#34;ChatGPT is a Blurry JPEG of the Web&#34;, <a href="https://www.newyorker.com/tech/annals-of-technology/chatgpt-is-a-blurry-jpeg-of-the-web"><cite>New Yorker</cite> 9 February 2023</a> [This is by far the best thing written on these models, at this level of accessibility]
	</li><li>Alison Gopnik, &#34;What AI Still Doesn&#39;t Know How to Do&#34;, <a href="https://www.wsj.com/articles/what-ai-still-doesnt-know-how-to-do-11657891316"><cite>Wall Street Journal</cite> 15 July 2022</a> [See &#34;<a href="#gopnik">Gopnikism</a>&#34; above]
	</li><li>Murray Shanahan, &#34;Talking About Large Language Models&#34;, <a href="http://arxiv.org/abs/2212.03551">arxiv:2212.03551</a>
	</li><li>Giulio Alessandrini, Brad Klee, and Stephen Wolfram, &#34;What Is ChatGPT Doing ... and Why Does It Work?&#34;,
<a href="https://writings.stephenwolfram.com/2023/02/what-is-chatgpt-doing-and-why-does-it-work/">14 February 2023</a> [While I <a href="http://bactra.org/reviews/wolfram/">have my issues with Wolfram</a>, fairness compels me to point to this as a rather good piece.  In fact, it&#39;s good enough at explaining things that I wish the authors had written more about what &#34;attention&#34; and &#34;transformers&#34; actually do.  (Thanks to A.G. for getting me to list the authors properly.)]
	</li></ul>

<ul>Recommended, close-ups, conceptual:
	<li>Maneesh Agrawala, &#34;Unpredictable Black Boxes are Terrible Interfaces&#34;, <a href="https://magrawala.substack.com/p/unpredictable-black-boxes-are-terrible">30 March 2023</a> [Obvious things that apparently need saying]
	</li><li>Konstantine Arkoudas, &#34;GPT-4 Can&#39;t Reason&#34;, <a href="http://arxiv.org/abs/2308.03762">arxiv:2308.03762</a> [The definition of &#34;reasoning&#34; here is just &#34;carry out valid deduction&#34;.  And it&#39;s true, GPT-4 really can&#39;t.]
	</li><li>Christoph Durt and Tom Froese and Thomas Fuchs, &#34;Against AI Understanding and Sentience: Large Language Models, Meaning, and the Patterns of Human Language Use&#34;, <a href="http://philsci-archive.pitt.edu/21983/">phil-sci/21983</a> (2023)
	</li><li>Subbarao Kambhampati, &#34;Can LLMs Really Reason and Plan?&#34;, <a href="https://cacm.acm.org/blogs/blog-cacm/276268-can-llms-really-reason-and-plan/fulltext">BLOG@CACM, 12 September 2023</a>
	</li><li>Peter Levine, <a href="https://peterlevine.ws/?p=29425">&#34;The difference between human and artificial intelligence: relationships&#34;</a> and <a href="https://peterlevine.ws/?p=28681">&#34;The design choice to make ChatGPT sound like a human&#34;</a>
	</li><li>Bertrand Meyer, &#34;AI Does Not Help Programmers&#34;, <a href=""><cite>Communications of the ACM</cite> 3 June 2023</a> [<a href="https://pinboard.in/u:cshalizi/b:8140eb3ccf66">Comments, including my own anecedotal experiences</a>]
	</li><li>Melanie Mitchell
		<ul>
		<li>&#34;Did ChatGPT Really Pass Graduate-Level
Exams&#34;, <a href="https://aiguide.substack.com/p/did-chatgpt-really-pass-graduatehttps://aiguide.substack.com/p/did-chatgpt-really-pass-graduate">Parts
1</a>
and <a href="https://aiguide.substack.com/p/did-chatgpt-really-pass-graduate-baa">2</a>
[9 and 11 February 2023.  Part 1 has an extremely compelling demonstration that
taking a prompt where the system gave an &#34;A+&#34; answer could be easily turned
into one where the systems answer was hilariously wrong.  No <em>human</em>
test-taker would be confused in this way, the two problem statements are
clearly completely equivalent if you understand them.  Of course Melanie&#39;s
point is that the system <em>doesn&#39;t</em> understand; its specific performances
are not clues to its competences in the ways we&#39;re used to from human beings.
(I find it <em>fascinating</em> that final-exam questions in an MBA course at
an elite business school are just the kind of algebra word-problem I had to
do in junior high, but that&#39;s <strike>petty resentment of how much money MBAs and their teachers make</strike> a side issue.)]
		</li><li>&#34;How do we know how smart AI systems are?&#34;, <a href="https://doi.org/10.1126/science.adj5957"><cite>Science</cite> <strong>381</strong> (2023): adj5957</a> [Applies more broadly than just to LLMs...]
		</li></ul>
	</li><li>Melanie Mitchell and David C. Krakauer, &#34;The Debate Over Understanding in AI&#39;s Large Language Models&#34;, <a href="https://doi.org/10.1073/pnas.2215907120"><cite>Proceedings of the National Academy of Sciences</cite> <strong>120</strong> (2023)</a>, <a href="http://arxiv.org/abs/2210.13966">arxiv:2210.13966</a>
	</li><li>Arvind Narayanan and Sayash Kapoor, &#34;GPT-4 and professional benchmarks: the wrong answer to the wrong question&#34;, <a href="https://aisnakeoil.substack.com/p/gpt-4-and-professional-benchmarks">20 March 2023</a>
	</li><li>The Renaissance Mathematicus, &#34;Artificial Bullshit!&#34;, <a href="https://thonyc.wordpress.com/2023/03/22/artificial-bullshit/">22 March 2023</a>
	</li><li>Jill Walker Rettberg, &#34;ChatGPT is multilingual but monocultural, and it&#39;s learning your values&#34;, <a href="https://jilltxt.net/right-now-chatgpt-is-multilingual-but-monocultural-but-its-learning-your-values/">jill/txt 6 December 2022</a>
	</li><li><a href="https://www.aiweirdness.com/">Janelle Shane</a>, <a href="https://www.aiweirdness.com/galactica/">Galactica: the AI knowledge base that makes stuff up</a> [21 November 2022; <a href="https://pinboard.in/u:cshalizi/b:0e7642f03a88">comments</a>]
	</li><li>Adam Sobieszek and Tadeusz Price, &#34;Playing Games with AIs: The Limits of GPT-3 and Similar Large Language Models&#34;, <a href=""><cite>Minds and Machines</cite> <strong>32</strong> (2022): 341--364</a> [<a href="http://bactra.org/notebooks/ai.html#games-with-AIs">Comments</a>]
	</li><li>Eunice Yiu, Eliza Kosoy, Alison Gopnik, &#34;Imitation versus Innovation: What children can do that large language and language-and-vision models cannot (yet)?&#34;, <a href="http://arxiv.org/abs/2305.07666">arxiv:2305.07666</a>
	</li><li>Michael Zalewski, &#34;LLMs are good at playing you&#34;, <a href="https://lcamtuf.substack.com/p/llms-are-better-than-you-think-at">lcamtuf&#39;s thing, 9 June 2023</a> [I&#39;d actually reverse this: human beings are good at being played
by chatbots!]
	</li></ul>

<ul>Recommended, close-ups, technical:
	<li>Xavier Amatriain, <a href="https://amatriain.net/blog/transformer-models-an-introduction-and-catalog-2d1e9039f376/">Transformer models: an introduction and catalog -- 2023 Edition</a> [The &#34;introduction&#34; part is not actually (IMHO) at all clear or actually helpful if you don&#39;t already understand, but the catalog is well-organized and useful]
	</li><li>James Bisbee, Joshua Clinton, Cassy Dorff, Brenton Kenkel, Jennifer Larson, &#34;Artificially Precise Extremism: How Internet-Trained LLMs Exaggerate Our Differences&#34;, <a href="https://doi.org/10.31235/osf.io/5ecfa" name="artificially-precise-extremism">socarxiv/5ecfa</a> [Compared with actual survey data, ChatGPT isn&#39;t bad at estimating average opinions for large demographic groups, but (1) it drastically under-states the variance within each group, and (2) it systematically exaggerates how much the in-group is preferred to the out-group.]
	</li><li>Eleftheria Briakou, Colin Cherry, George Foster, &#34;Searching for Needles in a Haystack: On the Role of Incidental Bilingualism in PaLM&#39;s Translation Capability&#34;, <a href="http://arxiv.org/abs/2305.10266">arxiv:2305.10266</a> [Department of &#34;it&#39;s all in the training data&#34;]
	</li><li>Nicholas Carlini, Florian Tramer, Eric Wallace, Matthew Jagielski, Ariel Herbert-Voss, Katherine Lee, Adam Roberts, Tom Brown, Dawn Song, Ulfar Erlingsson, Alina Oprea, Colin Raffel, &#34;Extracting Training Data from Large Language Models&#34;, <a href="http://arxiv.org/abs/2012.07805">arxiv:2012.07805</a> [<a href="https://pinboard.in/u:cshalizi/b:c6eb365e40be">Comments</a>]
	</li><li>Kent K. Chang, Mackenzie Cramer, Sandeep Soni, David Bamman, &#34;Speak, Memory: An Archaeology of Books Known to ChatGPT/GPT-4&#34;, <a href="http://arxiv.org/abs/2305.00118">arxiv:2305.00118</a> [Department of &#34;it&#39;s all in the training data&#34;]
	</li><li>Raunak Chowdhuri, Neil Deshmukh, and David Koplow, <a href="https://flower-nutria-41d.notion.site/No-GPT4-can-t-ace-MIT-b27e6796ab5a48368127a98216c76864">No, GPT4 canâ€™t ace MIT</a>
	</li><li>Shangbin Feng, Vidhisha Balachandran, Yuyang Bai, Yulia Tsvetkov, &#34;FactKB: Generalizable Factuality Evaluation using Language Models Enhanced with Factual Knowledge&#34;, <a href="http://arxiv.org/abs/2305.08281">arxiv:2305.08281</a> [To over-simplify, the trick here is to re-train the model on a medium-sized corpus of extra sentences generated from a trusted knowledge base.  I&#39;m not entirely sold, but I certainly don&#39;t have any better ideas.]
	</li><li>Urvashi Khandelwal, Omer Levy, Dan Jurafsky, Luke Zettlemoyer, Mike Lewis, &#34;Generalization through Memorization: Nearest Neighbor Language Models&#34;, <a href="https://openreview.net/forum?id=HklBjCEKvH">ICLR 2020</a>
	</li><li>Brian Lester and Noah Constant, <a href="https://ai.googleblog.com/2022/02/guiding-frozen-language-models-with.html?m=1">Guiding Frozen Language Models with Learned Soft Prompts</a>, 10 February 2022
	</li><li>Kenneth Li, &#34;Do Large Language Models learn world models or just surface statistics?&#34; <a href="https://thegradient.pub/othello/"><cite>The Gradient</cite> 21 January 2023</a> [<a href="https://pinboard.in/u:cshalizi/b:52c9ed05b79c">Comments</a>]
	</li><li>Natalie Shapira, Mosh Levy, Seyed Hossein Alavi, Xuhui Zhou, Yejin Choi, Yoav Goldberg, Maarten Sap, Vered Shwartz, &#34;Clever Hans or Neural Theory of Mind? Stress Testing Social Reasoning in Large Language Models&#34;, <a href="http://arxiv.org/abs/2305.14763">arxiv:2305.14763</a>
	</li><li>Ilia Shumailov, Zakhar Shumaylov, Yiren Zhao, Yarin Gal, Nicolas Papernot, Ross Anderson, &#34;The Curse of Recursion: Training on Generated Data Makes Models Forget&#34;, <a href="http://arxiv.org/abs/2305.17493">arxiv:2305.17493</a> [<a href="https://pinboard.in/u:cshalizi/b:327f21a2ba41">Comments</a>]
	</li><li>Yao-Hung Hubert Tsai, Shaojie Bai, Makoto Yamada, Louis-Philippe Morency, Ruslan Salakhutdinov, &#34;Transformer Dissection: A Unified Understanding of Transformer&#39;s Attention via the Lens of Kernel&#34;, <a href="https://doi.org/10.18653/v1/D19-1443">pp. 4344--4353 in <cite>Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing [EMNLP 2019]</cite></a>, <a href="http://arxiv.org/abs/1908.11775">arxiv:1908.11775</a> [I should have read this four years ago; maybe I <em>did</em>, and forgot about it, but I doubt it.]
	</li><li>Frank F. Xu, Uri Alon, Graham Neubig, &#34;Why do Nearest Neighbor Language Models Work?&#34;, <a href="http://arxiv.org/abs/2301.02828">arxiv:2301.02828</a>
	</li><li>Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, Illia Polosukhin, &#34;Attention Is All You Need&#34;, <a href="http://arxiv.org/abs/1706.03762">arxiv:1706.03762</a> [The original &#34;Transformer&#34; paper]
	</li><li>Yotam Wolf, Noam Wies, Yoav Levine, Amnon Shashua, &#34;Fundamental Limitations of Alignment in Large Language Models&#34;, <a href="http://arxiv.org/abs/2304.11082">arxiv:2304.11082</a> [<a href="https://pinboard.in/u:cshalizi/b:0b7cc7c67740">Comments</a>]
	</li><li>Chunting Zhou, Pengfei Liu, Puxin Xu, Srini Iyer, Jiao Sun, Yuning Mao, Xuezhe Ma, Avia Efrat, Ping Yu, Lili Yu, Susan Zhang, Gargi Ghosh, Mike Lewis, Luke Zettlemoyer, Omer Levy, &#34;LIMA: Less Is More for Alignment&#34;, <a href="http://arxiv.org/abs/2305.11206">arxiv:2305.11206</a>
	</li><li>Andy Zou, Zifan Wang, J. Zico Kolter, Matt Fredrikson, &#34;Universal and Transferable Adversarial Attacks on Aligned Language Models&#34;, <a href="http://arxiv.org/abs/2307.15043">arxiv:2307.15043</a> [<a href="https://llm-attacks.org/">Demos, etc.</a>]
	</li></ul>

<ul>Recommended, close-ups, technical, computational powers and limits of transformers:
	<li>Nouha Dziri, Ximing Lu, Melanie Sclar, Xiang Lorraine Li, Liwei Jiang, Bill Yuchen Lin, Peter West, Chandra Bhagavatula, Ronan Le Bras, Jena D. Hwang, Soumya Sanyal, Sean Welleck, Xiang Ren, Allyson Ettinger, Zaid Harchaoui, Yejin Choi, &#34;Faith and Fate: Limits of Transformers on Compositionality&#34;, <a href="http://arxiv.org/abs/2305.18654">arxiv:2305.18654</a>
	</li><li>Bingbin Liu, Jordan T. Ash, Surbhi Goel, Akshay Krishnamurthy, Cyril Zhang, &#34;Transformers Learn Shortcuts to Automata&#34;, <a href="http://arxiv.org/abs/2210.10749">arxiv:2210.10749</a>
	</li><li>Hui Shi, Sican Gao, Yuandong Tian, Xinyun Chen and Jishen Zhao, &#34;Learning Bounded Context-Free-Grammar via LSTM and the Transformer: Difference and the Explanations&#34;, <a href="https://doi.org/10.1609/aaai.v36i8.20801">Proceedings of the 36th AAAI Conference on Artificial Intelligence (2022): 8267--8276</a>
	</li><li>Shizhuo Dylan Zhang, Curt Tigges, Stella Biderman, Maxim Raginsky, Talia Ringer, &#34;Can Transformers Learn to Solve Problems Recursively?&#34;, <a href="http://arxiv.org/abs/2305.14699">arxiv:2305.14699</a>
	</li></ul>

<ul>Recommended, close-ups, going beyond transformers:
	<li>Albert Gu, Tri Dao, &#34;Mamba: Linear-Time Sequence Modeling with Selective State Spaces&#34;, <a href="http://arxiv.org/abs/2312.00752">arxiv:2312.00752</a> [An alternative to the basic attention component of the transformer, based on what I&#39;d call a <a href="https://g-w1.github.io/blog/observation/2023/12/20/chain-with-complete-connections.html">&#34;chain with complete connections&#34;</a> or &#34;observation-driven model&#34;.  The motivation is to get
some actual selectivity (unlike &#34;attention&#34;), but the effect is to have a persistent state whose dynamics change with the input, which I think is a much more promising route to <a href="https://g-w1.github.io/blog/observation/2023/12/20/prediction-process.html">getting something which can learn structure.</a>  <em>Disclaimer</em>: First author is my colleague in the Machine Learning Department here at CMU.]
	</li></ul>

<ul>Recommended, works of humanistic scholarship that I think are going to
prove relevant before this episode is over:
	<li>Zellig Harris, <cite><a href="http://bactra.org/weblog/algae-2007-09.html#harris">Language and Information</a></cite>
	</li><li>Albert B. Lord, <cite>The Singer of Tales</cite>
	</li><li>John Livingston Lowes, <cite>The Road to Xanadu: A Study in the Ways of the Imagination</cite>
	</li></ul>

<ul>Modesty forbids me to recommend:
	<li>Henry Farrell and CRS, <a href="https://www.economist.com/by-invitation/2023/06/21/artificial-intelligence-is-a-familiar-looking-monster-say-henry-farrell-and-cosma-shalizi">&#34;Artificial Intelligence is a Familiar-Looking Monster&#34;, <cite>The Economist</cite> 21 June 2023</a> [<a href="http://bactra.org/weblog/shoggothim.html">Commentary</a>]
	</li></ul>

<ul>To read, computational powers and limits of transformers:
	<li>Satwik Bhattamishra, Kabir Ahuja, Navin Goyal, &#34;On the Ability and Limitations of Transformers to Recognize Formal Languages&#34;, <a href="http://arxiv.org/abs/2009.11264">arxiv:2009.11264</a>
	</li><li>Angeliki Giannou, Shashank Rajput, Jy-yong Sohn, Kangwook Lee, Jason D. Lee, Dimitris Papailiopoulos, &#34;Looped Transformers as Programmable Computers&#34;, <a href="http://arxiv.org/abs/2301.13196">arxiv:2301.13196</a>
	</li><li>Eran Malach, &#34;Auto-Regressive Next-Token Predictors are Universal Learners&#34;, <a href="http://arxiv.org/abs/2309.06979">arxiv:2309.06979</a>
	</li><li>William Merrill, Ashish Sabharwal, &#34;Transformers Can Be Expressed In First-Order Logic with Majority&#34;, <a href="http://arxiv.org/abs/2210.02671">arxiv:2210.02671</a>
	</li><li>Dale Schuurmans, &#34;Memory Augmented Large Language Models are Computationally Universal&#34;, <a href="http://arxiv.org/abs/2301.04589">arxiv:2301.04589</a> [This doesn&#39;t surprise me but it&#39;s good to have this confirmed]
	</li><li>Gail Weiss, Yoav Goldberg, Eran Yahav, &#34;Thinking Like Transformers&#34;, <a href="http://arxiv.org/abs/2106.06981">arxiv:2106.06981</a>
	</li></ul>

<ul>To read, the &#34;cognitive science&#34; and evaluation of LLMs:
	<li>Gavin Abercrombie, Amanda Cercas Curry, Tanvi Dinkar, Zeerak Talat, &#34;Mirages: On Anthropomorphism in Dialogue Systems&#34;, <a href="http://arxiv.org/abs/2305.09800">arxiv:2305.09800</a>
	</li><li>Marcel Binz and Eric Schulz, &#34;Using cognitive psychology to understand GPT-3&#34;, <a href="https://doi.org/10.1073/pnas.2218523120"><cite>Proceedings of the National Academy of Sciences</cite> <strong>120</strong> (2023): e2218523120</a>
	</li><li>Maurice Jakesch, Jeffrey Hancock, Mor Naaman, &#34;Human heuristics for AI-generated language are flawed&#34;,
<a href="https://doi.org/10.1073/pnas.2208839120"><cite>Proceedings of the National Academy of Sciences</cite> <strong>120</strong> (2023): e2208839120</a>,
<a href="http://arxiv.org/abs/2206.07271">arxiv:2206.07271</a>
	</li><li>Cameron Jones, Benjamin Bergen, &#34;Does GPT-4 Pass the Turing Test?&#34;, <a href="http://arxiv.org/abs/2310.20216">arxiv:2310.20216</a> [Via Melanie Mitchell.  The mindblowing bit in the abstract is Eliza&#39;s pass-rate!]
	</li><li>Kyle Mahowald, Anna A. Ivanova, Idan A. Blank, Nancy Kanwisher, Joshua B. Tenenbaum, Evelina Fedorenko, &#34;Dissociating language and thought in large language models: a cognitive perspective&#34;, <a href="http://arxiv.org/abs/2301.06627">arxiv:2301.06627</a>
	</li><li>R. Thomas McCoy, Shunyu Yao, Dan Friedman, Matthew Hardy, Thomas L. Griffiths, &#34;Embers of Autoregression: Understanding Large Language Models Through the Problem They are Trained to Solve&#34;, <a href="http://arxiv.org/abs/2309.13638">arxiv:2309.13638</a>
	</li><li>William Merrill, Yoav Goldberg, Roy Schwartz, Noah A. Smith, &#34;Provable Limitations of Acquiring Meaning from Ungrounded Form: What Will Future Language Models Understand?&#34;, <a href="http://arxiv.org/abs/2104.10809">arxiv:2104.10809</a>
	</li><li>Melanie Mitchell, Alessandro B. Palmarini, Arseny Moskvichev, &#34;Comparing Humans, GPT-4, and GPT-4V On Abstraction and Reasoning Tasks&#34;, <a href="http://arxiv.org/abs/2311.09247">arxiv:2311.09247</a>
	</li><li>Steven Piantadosi, &#34;Modern language models refute Chomsky&#39;s approach to language&#34;, <a href="https://lingbuzz.net/lingbuzz/007180">lingbuzz/007180</a> (2023) [From the abstract, this seems <em>remarkably</em> mis-guided to me: the sheer volume of data needed for LLMs, compared to what children are exposed
to, seems on the contrary a striking vindication of the core Chomskian insights,
properly understood.  But this might just be an instance of me <a href="http://bactra.org/weblog/279.html">refusing to re-think conclusions I reached decades ago</a>.  (Thanks to <a href="http://brenocon.com/">Brendan O&#39;Connor</a> for the pointer.)]
	</li><li>Yasaman Razeghi, Robert L. Logan IV, Matt Gardner, Sameer Singh, &#34;Impact of Pretraining Term Frequencies on Few-Shot Reasoning&#34;, <a href="http://arxiv.org/abs/2202.07206">arxiv:2202.07206</a>
	</li><li>Richard Shiffrin and Melanie Mitchell, &#34;Probing the psychology of AI models&#34;, <a href="https://doi.org/10.1073/pnas.2300963120"><cite>Proceedings of the National Academy of Sciences</cite> <strong>120</strong> (2023): e2300963120</a>
	</li><li>Zhaofeng Wu, Linlu Qiu, Alexis Ross, Ekin AkyÃ¼rek, Boyuan Chen, Bailin Wang, Najoung Kim, Jacob Andreas, Yoon Kim, &#34;Reasoning or Reciting? Exploring the Capabilities and Limitations of Language Models Through Counterfactual Tasks&#34;, <a href="http://arxiv.org/abs/2307.02477">arxiv:2307.02477</a>
	</li></ul>

<ul>To read, structure learning:
	<li>Kenneth Li, Aspen K. Hopkins, David Bau, Fernanda ViÃ©gas, Hanspeter Pfister, Martin Wattenberg, &#34;Emergent World Representations: Exploring a Sequence Model Trained on a Synthetic Task&#34;, <a href="http://arxiv.org/abs/2210.13382">arxiv:2210.13382</a>
	</li><li>Yi Zhang, Arturs Backurs, SÃ©bastien Bubeck, Ronen Eldan, Suriya Gunasekar, Tal Wagner, &#34;Unveiling Transformers with LEGO: a synthetic reasoning task&#34;, <a href="http://arxiv.org/abs/2206.04301">arxiv:2206.04301</a>
	</li></ul>

<ul>To read, steps towards getting beyond finite-order Markov models:
	<li>Aydar Bulatov, Yuri Kuratov, Mikhail S. Burtsev, &#34;Scaling Transformer to 1M tokens and beyond with RMT&#34;, <a href="http://arxiv.org/abs/2304.11062">arxiv:2304.11062</a>
	</li><li>Aniket Didolkar, Kshitij Gupta, Anirudh Goyal, Nitesh B. Gundavarapu, Alex Lamb, Nan Rosemary Ke, Yoshua Bengio, &#34;Temporal Latent Bottleneck: Synthesis of Fast and Slow Processing Mechanisms in Sequence Learning&#34;, <a href="http://arxiv.org/abs/2205.14794">arxiv:2205.14794</a>
	</li><li>Albert Gu, Karan Goel, Christopher Re, &#34;Efficiently Modeling Long Sequences with Structured State Spaces&#34;, <a href="https://openreview.net/forum?id=uYLFoz1vlAC">ICLR 2022</a>, <a href="http://arxiv.org/abs/2111.00396">arxiv:2111.00396</a>
	</li><li>Bo Peng, Eric Alcaide, Quentin Anthony, Alon Albalak, Samuel Arcadinho, Huanqi Cao, Xin Cheng, Michael Chung, Matteo Grella, Kranthi Kiran GV, Xuzheng He, Haowen Hou, Przemyslaw Kazienko, Jan Kocon, Jiaming Kong, Bartlomiej Koptyra, Hayden Lau, Krishna Sri Ipsit Mantri, Ferdinand Mom, Atsushi Saito, Xiangru Tang, Bolun Wang, Johan S. Wind, Stansilaw Wozniak, Ruichong Zhang, Zhenyuan Zhang, Qihang Zhao, Peng Zhou, Jian Zhu, Rui-Jie Zhu, &#34;RWKV: Reinventing RNNs for the Transformer Era&#34;, <a href="http://arxiv.org/abs/2305.13048">arxiv:2305.13048</a>
	</li><li>Wangchunshu Zhou, Yuchen Eleanor Jiang, Peng Cui, Tiannan Wang, Zhenxin Xiao, Yifan Hou, Ryan Cotterell, Mrinmaya Sachan, &#34;RecurrentGPT: Interactive Generation of (Arbitrarily) Long Text&#34;, <a href="http://arxiv.org/abs/2305.13304">arxiv:2305.13304</a>
	</li></ul>

<ul>To read, not otherwise (or not yet) categorized:
	<li>Ekin AkyÃ¼rek, Dale Schuurmans, Jacob Andreas, Tengyu Ma, Denny Zhou, &#34;What learning algorithm is in-context learning? Investigations with linear models&#34;, <a href="http://arxiv.org/abs/2211.15661">arxiv:2211.15661</a>
	</li><li>Sina Alemohammad, Josue Casco-Rodriguez, Lorenzo Luzi, Ahmed Imtiaz Humayun, Hossein Babaei, Daniel LeJeune, Ali Siahkoohi, Richard G. Baraniuk, &#34;Self-Consuming Generative Models Go MAD&#34;, <a href="http://arxiv.org/abs/2307.01850">arxiv:2307.01850</a>
	</li><li>Dzmitry Bahdanau, Kyunghyun Cho, Yoshua Bengio, &#34;Neural Machine Translation by Jointly Learning to Align and Translate&#34;, <a href="http://arxiv.org/abs/1409.0473">arxiv:1409.0473</a> [Supposedly the first paper on &#34;attention&#34;]
	</li><li>Nora Belrose, Zach Furman, Logan Smith, Danny Halawi, Igor Ostrovsky, Lev McKinney, Stella Biderman, Jacob Steinhardt, &#34;Eliciting Latent Predictions from Transformers with the Tuned Lens&#34;, <a href="http://arxiv.org/abs/2303.08112">arxiv:2303.08112</a>
	</li><li>Andres M Bran, Sam Cox, Andrew D White, Philippe Schwaller, &#34;ChemCrow: Augmenting large-language models with chemistry tools&#34;, <a href="http://arxiv.org/abs/2304.05376">arxiv:2304.05376</a>
	</li><li>Collin Burns, Haotian Ye, Dan Klein, Jacob Steinhardt, &#34;Discovering Latent Knowledge in Language Models Without Supervision&#34;, <a href="http://arxiv.org/abs/2212.03827">arxiv:2212.03827</a> [Weird-sounding]
	</li><li><a href="https://www.cerebras.net/blog/cerebras-gpt-a-family-of-open-compute-efficient-large-language-models/">Cerebras-GPT: A Family of Open, Compute-efficient, Large Language Models</a>
	</li><li>GrÃ©goire DelÃ©tang, Anian Ruoss, Paul-Ambroise Duquenne, Elliot Catt, Tim Genewein, Christopher Mattern, Jordi Grau-Moya, Li Kevin Wenliang, Matthew Aitchison, Laurent Orseau, Marcus Hutter, Joel Veness, &#34;Language Modeling Is Compression&#34;, <a href="http://arxiv.org/abs/2309.10668">arxiv:2309.10668</a> [From a quick skim, this is not <em>quite</em> someone trying out <a href="#gllz">my longed-for GLLZ</a>, but closer than anything else I&#39;ve seen.]
	</li><li>Vittoria Dentella, Elliot Murphy, Gary Marcus, Evelina Leivada, &#34;Testing AI performance on less frequent aspects of language reveals insensitivity to underlying meaning&#34;, <a href="http://arxiv.org/abs/2302.12313">arxiv:2302.12313</a>
	</li><li>Yilun Du, Shuang Li, Antonio Torralba, Joshua B. Tenenbaum, Igor Mordatch, &#34;Improving Factuality and Reasoning in Language Models through Multiagent Debate&#34;, <a href="http://arxiv.org/abs/2305.14325">arxiv:2305.14325</a>
	</li><li>Brandon Duderstadt, Hayden S. Helm, Carey E. Priebe, &#34;Comparing Foundation Models using Data Kernels&#34;, <a href="http://arxiv.org/abs/2305.05126">arxiv:2305.05126</a>
	</li><li>Tolga Ergen, Behnam Neyshabur, Harsh Mehta, &#34;Convexifying Transformers: Improving optimization and understanding of transformer networks&#34;, <a href="http://arxiv.org/abs/2211.11052">arxiv:2211.11052</a>
	</li><li>Hao Fang, Anusha Balakrishnan, Harsh Jhamtani, John Bufe, Jean Crawford, Jayant Krishnamurthy, Adam Pauls, Jason Eisner, Jacob Andreas, Dan Klein, &#34;The Whole Truth and Nothing But the Truth: Faithful and Controllable Dialogue Response Generation with Dataflow Transduction and Constrained Decoding&#34;, <a href="http://arxiv.org/abs/2209.07800">arxiv:2209.07800</a>
	</li><li>Borjan Geshkovski, Cyril Letrouit, Yury Polyanskiy, Philippe Rigollet, &#34;The emergence of clusters in self-attention dynamics&#34;, <a href="http://arxiv.org/abs/2305.05465">arxiv:2305.05465</a> [<a href="https://g-w1.github.io/blog/observation/2023/12/20/interacting-particle-systems.html">Interacting particle systems?!?</a>]
	</li><li>Mor Geva, Roei Schuster, Jonathan Berant, Omer Levy, &#34;Transformer Feed-Forward Layers Are Key-Value Memories&#34;, <a href="http://arxiv.org/abs/2012.14913">arxiv:2012.14913</a>
	</li><li>Roger Grosse, Juhan Bae, Cem Anil, Nelson Elhage, Alex Tamkin, Amirhossein Tajdini, Benoit Steiner, Dustin Li, Esin Durmus, Ethan Perez, Evan Hubinger, Kamile Lukosiute, Karina Nguyen, Nicholas Joseph, Sam McCandlish, Jared Kaplan, Samuel R. Bowman, &#34;Studying Large Language Model Generalization with Influence Functions&#34;, <a href="http://arxiv.org/abs/2308.03296">arxiv:2308.03296</a>
	</li><li>Di Jin, Zhijing Jin, Joey Tianyi Zhou, Peter Szolovits, &#34;Is BERT Really Robust? A Strong Baseline for Natural Language Attack on Text Classification and Entailment&#34;, <a href="http://arxiv.org/abs/1907.11932">arxiv:1907.11932</a>
	</li><li>Jean Kaddour, Oscar Key, Piotr Nawrot, Pasquale Minervini, Matt J. Kusner, &#34;No Train No Gain: Revisiting Efficient Training Algorithms For Transformer-based Language Models&#34;, <a href="http://arxiv.org/abs/2307.06440">arxiv:2307.06440</a>
	</li><li>Adam Tauman Kalai, Santosh S. Vempala, &#34;Calibrated Language Models Must Hallucinate&#34;, <a href="http://arxiv.org/abs/2311.14648">arxiv:2311.14648</a>
	</li><li>Ben Krause, Emmanuel Kahembwe, Iain Murray, Steve Renals, &#34;Dynamic Evaluation of Transformer Language Models&#34;, <a href="http://arxiv.org/abs/1904.08378">arxiv:1904.08378</a>
	</li><li>Brian Lester, Rami Al-Rfou and Noah Constant, &#34;The Power of Scale for Parameter-Efficient Prompt Tuning&#34;, <a href="https://aclanthology.org/2021.emnlp-main.243/">EMNLP 2021</a>
	</li><li>Zhen Lin, Shubhendu Trivedi, Jimeng Sun, &#34;Generating with Confidence: Uncertainty Quantification for Black-box Large Language Models&#34;, <a href="http://arxiv.org/abs/2305.19187">arxiv:2305.19187</a>
	</li><li>Nelson F. Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, Percy Liang, &#34;Lost in the Middle: How Language Models Use Long Contexts&#34;, <a href="http://arxiv.org/abs/2307.03172">arxiv:2307.03172</a>
	</li><li>Clara Meister, Tiago Pimentel, Gian Wiher, Ryan Cotterell, &#34;Locally Typical Sampling&#34;, <a href="http://arxiv.org/abs/2202.00666">arxiv:2202.00666</a>
	</li><li>Evan Miller, &#34;Attention Is Off by One&#34;, <a href="https://www.evanmiller.org/attention-is-off-by-one.html">24 July 2023</a> [This would shift &#34;attention&#34; from being a weighted average, to being a weighted average shrunk towards zero.]
	</li><li>Jonathan Pilault, Can Liu, Mohit Bansal, Markus Dreyer, &#34;On Conditional and Compositional Language Model Differentiable Prompting&#34;, <a href="http://arxiv.org/abs/2307.01446">arxiv:2307.01446</a> [This seems like a potentially interesting way of grafting some Good Old-Fashioned AI (production systems!) on to LLMs...]
	</li><li>Victor Quach, Adam Fisch, Tal Schuster, Adam Yala, Jae Ho Sohn, Tommi S. Jaakkola, Regina Barzilay, &#34;Conformal Language Modeling&#34;, <a href="http://arxiv.org/abs/2306.10193">arxiv:2306.10193</a>
	</li><li>Hubert Ramsauer, Bernhard SchÃ¤fl, Johannes Lehner, Philipp Seidl, Michael Widrich, Thomas Adler, Lukas Gruber, Markus Holzleitner, Milena PavloviÄ‡, Geir Kjetil Sandve, Victor Greiff, David Kreil, Michael Kopp, GÃ¼nter Klambauer, Johannes Brandstetter, Sepp Hochreiter, &#34;Hopfield Networks is All You Need&#34;, <a href="http://arxiv.org/abs/2008.02217">arxiv:2008.02217</a>
	</li><li>Sebastian Raschka, &#34;Understanding and Coding the Self-Attention Mechanism of Large Language Models From Scratch&#34; [<a href="https://sebastianraschka.com/blog/2023/self-attention-from-scratch.html">Tutorial, 9 February 2023</a>]
	</li><li>Anna Rogers, Olga Kovaleva, Anna Rumshisky, &#34;A Primer in BERTology: What we know about how BERT works&#34;, <a href="http://arxiv.org/abs/2002.12327">arxiv:2002.12327</a> [Skimmed, re-read]
	</li><li>Arda Sahiner, Tolga Ergen, Batu Ozturkler, John Pauly, Morteza Mardani, Mert Pilanci, &#34;Unraveling Attention via Convex Duality: Analysis and Interpretations of Vision Transformers&#34;, <a href="http://arxiv.org/abs/2205.08078">arxiv:2205.08078</a>
	</li><li>Shibani Santurkar, Esin Durmus, Faisal Ladhak, Cinoo Lee, Percy Liang, Tatsunori Hashimoto, &#34;Whose Opinions Do Language Models Reflect?&#34;, <a href="http://arxiv.org/abs/2303.17548">arxiv:2303.17548</a>
	</li><li>Rylan Schaeffer, Brando Miranda, Sanmi Koyejo, &#34;Are Emergent Abilities of Large Language Models a Mirage?&#34;, <a href="http://arxiv.org/abs/2304.15004">arxiv:2304.15004</a>
	</li><li>Rylan Schaeffer, Kateryna Pistunova, Samar Khanna, Sarthak Consul, Sanmi Koyejo, &#34;Invalid Logic, Equivalent Gains: The Bizarreness of Reasoning in Language Model Prompting&#34;, <a href="http://arxiv.org/abs/2307.10573">arxiv:2307.10573</a>
	</li><li>Sofia Serrano, Zander Brumbaugh, Noah A. Smith, &#34;Language Models: A Guide for the Perplexed&#34;, <a href="http://arxiv.org/abs/2311.17301">arxiv:2311.17301</a>
	</li><li>Karthik Valmeekam, Matthew Marquez, Sarath Sreedharan, Subbarao Kambhampati, &#34;On the Planning Abilities of Large Language Models -- A Critical Investigation&#39;, <a href="http://arxiv.org/abs/2305.15771">arxiv:2305.15771</a>
	</li><li>Veniamin Veselovsky, Manoel Horta Ribeiro, Robert West, &#34;Artificial Artificial Artificial Intelligence: Crowd Workers Widely Use Large Language Models for Text Production Tasks&#34;, <a href="http://arxiv.org/abs/2306.07899">arxiv:2306.07899</a>
	</li><li>Xinyi Wang, Wanrong Zhu, Michael Saxon, Mark Steyvers, William Yang Wang, &#34;Large Language Models Are Latent Variable Models: Explaining and Finding Good Demonstrations for In-Context Learning&#34;, <a href="http://arxiv.org/abs/2301.11916">arxiv:2301.11916</a> [Thanks to GMG for the pointer]
	</li><li>Shunyu Yao, Dian Yu, Jeffrey Zhao, Izhak Shafran, Thomas L. Griffiths, Yuan Cao, Karthik Narasimhan, &#34;Tree of Thoughts: Deliberate Problem Solving with Large Language Models&#34;, <a href="http://arxiv.org/abs/2305.10601">arxiv:2305.10601</a>
	</li><li>Yaodong Yu, Sam Buchanan, Druv Pai, Tianzhe Chu, Ziyang Wu, Shengbang Tong, Hao Bai, Yuexiang Zhai, Benjamin D. Haeffele, Yi Ma, &#34;White-Box Transformers via Sparse Rate Reduction: Compression Is All There Is?&#34;, <a href="http://arxiv.org/abs/2311.13110">arxiv:2311.13110</a>
	</li><li>Eric Zelikman, Qian Huang, Gabriel Poesia, Noah D. Goodman, Nick Haber, &#34;Parsel: Algorithmic Reasoning with Language Models by Composing Decompositions&#34;, <a href="http://arxiv.org/abs/2212.10561">arxiv:2212.10561</a>
	</li><li>Ailing Zeng, Muxi Chen, Lei Zhang, Qiang Xu, &#34;Are Transformers Effective for Time Series Forecasting?&#34;, <a href="http://arxiv.org/abs/2205.13504">arxiv:2205.13504</a>
	</li><li>Honghua Zhang, Meihua Dang, Nanyun Peng, Guy Van den Broeck, &#34;Tractable Control for Autoregressive Language Generation&#34;, <a href="http://arxiv.org/abs/2304.07438">arxiv:2304.07438</a>
	</li><li>Ruiqi Zhang, Spencer Frei, Peter L. Bartlett, &#34;Trained Transformers Learn Linear Models In-Context&#34;, <a href="http://arxiv.org/abs/2306.09927">arxiv:2306.09927</a>
	</li></ul>

<ul>To write, maybe, if I really want to embarrass myself:
	<li>&#34;Large Language Models in Statistical Perspective&#34;
	</li></ul>

<hr/><p>

Previous versions: 6 May 2023, 1 June 2023; 4 June 2023; 17 October 2023


</p>

</div>
</div></div>
  </body>
</html>
