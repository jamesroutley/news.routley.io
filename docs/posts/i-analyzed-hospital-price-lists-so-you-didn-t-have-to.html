<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.dolthub.com/blog/2022-07-01-hospitals-compliance/">Original</a>
    <h1>I analyzed hospital price lists so you didn&#39;t have to</h1>
    
    <div id="readability-page-1" class="page"><div data-cy="blog-post-text"><p>I analyzed 1835 hospital price lists so you didn&#39;t have to. But if you&#39;re a data scientist, you can do it too!</p>
<p><em>This article was written in part for python-centric data scientists and programmers, and comes with <a href="https://github.com/alecstein/dolt_datascience/blob/master/hospitals_v3/cleanup/cleaning-hospitals-dataset.ipynb">a follow-along notebook where we clean, analyze, and chart the real-world data that this article is based on.</a></em></p>
<p><em>The notebook uses python, polars, and altair to do the cleanup, analysis, and charting. I used a number of cool tricks and techniques to do the data wrangling and look forward to your feedback!</em></p>

<p>In 1990 a baby was born in Northside Hospital, in Atlanta. That was me. That was I. That was the author of this article.</p>
<p>I haven&#39;t thought about much Northside since then. Not until today, that is, when I discovered that they were the first hospital to get <a href="https://www.cms.gov/hospital-price-transparency/enforcement-actions">slapped with a $900k fine</a> from the Center of Medicare and Medicaid Services. Northside just wasn&#39;t interested in complying with the <a href="https://www.cms.gov/files/document/hospital-price-transparency-frequently-asked-questions.pdf">CMS&#39;s price transparency law</a>, which requires all hospitals to post their prices online in a single, machine-readable file.</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/0d609f8f9953073b28776cb8f51337e1/b54cd/sl-northside-fine.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="northside" title="northside" src="https://www.dolthub.com/blog/static/0d609f8f9953073b28776cb8f51337e1/ad12c/sl-northside-fine.png" srcset="/blog/static/0d609f8f9953073b28776cb8f51337e1/a48b3/sl-northside-fine.png 214w,
/blog/static/0d609f8f9953073b28776cb8f51337e1/47730/sl-northside-fine.png 428w,
/blog/static/0d609f8f9953073b28776cb8f51337e1/ad12c/sl-northside-fine.png 856w,
/blog/static/0d609f8f9953073b28776cb8f51337e1/7a18f/sl-northside-fine.png 1284w,
/blog/static/0d609f8f9953073b28776cb8f51337e1/b54cd/sl-northside-fine.png 1662w" sizes="(max-width: 856px) 100vw, 856px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>As an alternative to posting their price list, Northside offered patients a phone number to call for a tailored price estimate.</p>
<p>Despite this being a flagrant violation of the transparency law, they&#39;ll probably appeal the fine.</p>

<p>Northside might be an egregious violator of the price transparency law, but they did bring me safely into existence, so I can&#39;t hold too much of a grudge.</p>
<p>Nor are they alone. <a href="https://jamanetwork.com/journals/jama/article-abstract/2792987?resultClick=1">Some</a> <a href="https://www.physiciansweekly.com/most-hospitals-not-publicly-posting-price-data">have</a> <a href="https://www.dermatologytimes.com/view/most-hospitals-not-complying-with-price-transparency-rules-study-finds">estimated</a> <a href="https://www.abcactionnews.com/news/local-news/new-report-shows-tampa-bay-hospitals-not-following-medical-bill-transparency-law">that</a> still only half of hospitals are posting their prices, which somewhat agrees with the 33% or so that we collected in one of our data bounties.</p>
<p>As one of the only organizations that publishes this data openly, we naturally want to see what you can find in it. We&#39;ve published a few popular blogs already, which are in equal parts journalism and python tutorial. If you&#39;re interested in that, check them out.</p>
<ul>
<li><a href="https://www.dolthub.com/blog/2022-05-31-hospital-price-gouging/">How hospitals price-gouged insurers</a></li>
<li><a href="https://www.dolthub.com/blog/2022-05-06-the-most-expensive-hospitals/">Finding the most expensive hospital in our database</a></li>
</ul>
<p>But in writing these articles, a problem I repeatedly ran into was that after cleaning, a lot of the data seemed to just vanish. Why?</p>

<p>It turns out that the price lists are incredibly unwieldy to use for a number of reasons that I mention later. I blame in equal parts both the hospitals and the lawmakers.</p>
<ol>
<li>The hospitals that comply often publish the least information they can get away with</li>
<li>The CMS law appears to be written by non-technical people and leaves room for hospitals to do (1)</li>
</ol>
<h2 id="the-stats"><a href="#the-stats" aria-label="the stats permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The stats</h2>
<p><span>
      <a href="https://www.dolthub.com/blog/static/56485807e50b57190c5a2396ea2bafff/38124/sl-hospital-completeness.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="compliance stats" title="compliance stats" src="https://www.dolthub.com/blog/static/56485807e50b57190c5a2396ea2bafff/ad12c/sl-hospital-completeness.png" srcset="/blog/static/56485807e50b57190c5a2396ea2bafff/a48b3/sl-hospital-completeness.png 214w,
/blog/static/56485807e50b57190c5a2396ea2bafff/47730/sl-hospital-completeness.png 428w,
/blog/static/56485807e50b57190c5a2396ea2bafff/ad12c/sl-hospital-completeness.png 856w,
/blog/static/56485807e50b57190c5a2396ea2bafff/38124/sl-hospital-completeness.png 953w" sizes="(max-width: 856px) 100vw, 856px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>The CMS requires hospitals to post a cash price, insurer prices, and a generic (i.e. hospital-agnostic) code for each procedure when applicable. Of the ~33% of hospitals that we found to have published price lists:</p>
<ul>
<li>14% don&#39;t have a single generic code in their entire price list</li>
<li>21% of hospitals don&#39;t have a single price besides the MSRP, making them useless, since no one actually pays that price (not even the uninsured)</li>
<li>31% don&#39;t have a single cash price</li>
</ul>
<h2 id="scoring-the-chargemasters"><a href="#scoring-the-chargemasters" aria-label="scoring the chargemasters permalink"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scoring the chargemasters</h2>
<p>I came up with some criteria for separating the excellent price lists, such as</p>

<p>from ones like</p>

<p>which contain almost no usable information (only &#34;MSRP&#34; prices, low-or-no generic coding, etc.)</p>
<p>I came up with a simple rubric that calculates the total amount of information and junk in each price list, and graded them on a scale of 1-10. I checked for:</p>
<ol>
<li>how many rows had CPT codes</li>
<li>how many rows had prices that were astronomically high or zero (in other words, junk)</li>
<li>whether the price lists were adequately filled out (small penalty for having fewer than 5000 prices)</li>
<li>whether inpatient/outpatient was indicated on the price</li>
<li>how many different payers the hospital specified prices for</li>
</ol>
<p>45% of hospitals -- those that publish their price lists, have scores 6/10 or less, which indicate some kind of important flaw in the data published.</p>
<p><span>
      <a href="https://www.dolthub.com/blog/static/904582df4c6155dcf7b5b4d38503eda4/84cc5/sl-pl-scoring.png" target="_blank" rel="noopener">
    <span></span>
  <img alt="compliance stats" title="compliance stats" src="https://www.dolthub.com/blog/static/904582df4c6155dcf7b5b4d38503eda4/ad12c/sl-pl-scoring.png" srcset="/blog/static/904582df4c6155dcf7b5b4d38503eda4/a48b3/sl-pl-scoring.png 214w,
/blog/static/904582df4c6155dcf7b5b4d38503eda4/47730/sl-pl-scoring.png 428w,
/blog/static/904582df4c6155dcf7b5b4d38503eda4/ad12c/sl-pl-scoring.png 856w,
/blog/static/904582df4c6155dcf7b5b4d38503eda4/84cc5/sl-pl-scoring.png 898w" sizes="(max-width: 856px) 100vw, 856px" loading="lazy" decoding="async"/>
  </a>
    </span></p>
<p>For the exact methodology, <a href="https://github.com/alecstein/dolt_datascience/blob/master/hospitals_v3/cleanup/cleaning-hospitals-dataset.ipynb">check out our notebook</a> where I use some cool tricks in the Polars library to wrangle this 300M-row dataset.</p>

<p>It&#39;s easy to pooh-pooh imperfect laws, and to be fair, this one is better than nothing at all. But the way the current CMS law is set up still makes comparing prices harder than it needs to be. Put yourself in the position of a fictional patient:</p>
<blockquote>
<p>It&#39;s been years of ice hockey, tennis, and stumbling home from Finnegan&#39;s Pub. Now, with your X-ray luridly illuminated by a fluorescent panel, your doctor is circling a shadowy area just beneath your femur with the back of his pen. Bone on bone, he tells you. It&#39;s time for a knee replacement. He&#39;ll write you a referral.</p>
</blockquote>
<p>So what&#39;s it going to cost you? You&#39;ll have to first find the price list on your hospital&#39;s website which, even if it exists, won&#39;t necessarily be easy.</p>
<p>Then you&#39;ll have to Google what code you&#39;re looking for. If it&#39;s a knee replacement, you&#39;ll find that it&#39;s CPT code 27486. Or maybe 27487. You&#39;re not really sure, and neither am I. Perhaps it depends on the surgeon. You have to hope your hospital uses CPT codes and not, say, DRG coding, or something else entirely, otherwise you&#39;ll need to look up those codes too.</p>
<p>From here, you&#39;ll have to hope that the hospital in question posts prices for your insurer. Since only 2/3 have any insurer prices at all, this isn&#39;t a guarantee. And then you&#39;ll have to actually find your insurer in the list, which may not be easy since some hospitals have up to 100 different prices for each plan: are you <code>AETNA OPEN ACCESS MANAGED PLUS NET</code> or <code>AETNA AETNA HEALTHFUND AETNA CHOICE POS II NET</code>? Or perhaps <code>AETNA HSA OPEN ACCESS POS II NET</code>? I have no idea and neither do you probably.</p>
<p>Once you&#39;ve figured that out, you&#39;ve ballparked the price of your knee replacement from one hospital. Then you repeat for the other hospitals in your insurer&#39;s network.</p>
<p>This is the current best-case scenario. Most probably won&#39;t ever get to the chargemaster.</p>

<p>If we&#39;re going to do this at all, we should do it right. It takes minimal effort to make the following changes:</p>
<ol>
<li><strong>Centralize all the files.</strong> The hospitals post their price lists on both their webpages and on the CMS website on a single page. This makes it easy to compare hospitals and see which ones have complied with the law.</li>
<li><strong>Require a standard format.</strong> Pick JSON or CSV in some standard encoding. We don&#39;t need hospitals publishing XML files and Excel spreadsheets.</li>
<li><strong>Do away with MIN/MAX price-reporting requirements.</strong> The CMS requires hospitals to publish a minimum and maximum price for each procedure. This doesn&#39;t add to the value of a machine-readable file, since calculating the min/max per payer is as simple as doing a groupby/aggregation. This, to me, was a tell that the lawmakers who made this were not thinking carefully about the details of the requirements.</li>
<li><strong>Force hospitals to submit price lists conforming to a reasonable, universal schema</strong>. Hospitals are willing to spend $1M just to avoid publishing these things. They have the cash to tidy up their CSVs. A reasonable, non-ambiguous data schema would include: <code>unique procedure ID</code>, <code>hospital billing code</code>, <code>CPT code</code>, <code>DRG code</code>, <code>NDC code</code>, <code>description</code>, <code>inpatient/outpatient</code>, and <code>price</code>.</li>
<li><strong>Force hospitals to a standard template for naming insurers/payers</strong>. It&#39;s impossible to compare hospital prices when each one uses its own cryptic names for insurers and their plans.</li>
</ol>
<p>These are just a few of the changes that would make the machine-readable files more valuable to researchers like me.</p>

<p>While we wait for the CMS fines to increase (again) and for more hospitals to start posting their price lists, we still think that there&#39;s plenty to be discovered in our <a href="https://www.dolthub.com/repositories/dolthub/hospital-price-transparency-v3">database</a>, which is the largest of its kind. Click it, check it out, even fork it (you can do that with Dolt) and let us know what you think.</p>

<p>As usual, a special thanks to those of you who helped us build our $15,000 <a href="https://www.dolthub.com/repositories/dolthub/hospital-price-transparency-v3">hospital price database</a>. Creating distributed databases is our thing and we run contests like this all the time, literally. If you&#39;re interested in joining <a href="https://www.dolthub.com/repositories/dolthub/museum-collections">our latest bounty</a> or just talking to us, you can hop on <a href="https://discord.gg/tTwYVraPDM">Discord</a> to learn more.</p></div></div>
  </body>
</html>
