<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ludic.mataroa.blog/blog/flexible-schemas-are-the-mindkiller/">Original</a>
    <h1>Flexible schemas are the mindkiller</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
            <p>We need to talk about the kind of person that loves &#34;flexible&#34; schemas, and why I am unable to disclose what I will do the next time I see one without going on a watch list.</p>

<p>A few years ago, I worked at a company that had received $1M from FAANG (that&#39;s Facebook et. al. for the one art historian who reads this blog) to produce an AI and data classification tool. For some of you super slick operators out there in your diamond-clad superstructures, where Kubernetes is a real thing, the phrase &#34;web-scale&#34; doesn&#39;t make you assume your interlocutor is a moron, and you spend your days rightfully leering down at the little ants scurrying around from on high, this might seem like a very small amount of money. For this organization, $1M was the <em>largest</em> sum of money they had ever received - it immediately went on everyone&#39;s CV. Of course, only like three people were working on it, but everyone took credit nonetheless.</p>
<p>Without going into details, this was also the only AI product I&#39;ve seen at a company I&#39;ve actually worked at with clear, unambiguous goals that were almost certainly achievable due to the volume of valuable data they had. And to top it off, it had <em>actual positive societal outcomes</em>. I was one of the two data scientists, joining the project at a late stage because it had been &#34;lagging a bit&#34;. The experienced engineers are already upset. I believe it was in <em>The Mythical Man Month</em> that I read a project should &#34;allow no small slippages&#34; - something is either going to be on time or <em>considerably</em> delayed, although evidently we still haven&#39;t learned from a book written in 1975.</p>
<p>However, the other data scientist was a very close friend, and now co-director at our own company, so I knew that things would be in good shape on the AI end of things. They just needed a hand getting some projects across the line, maybe someone to pair program with. The models were basically already working by the time I joined, so all that was left was to check in on the last member of the team.</p>
<p>Fucking Derek.</p>

<p>There were <em>two</em> things that needed to be done. The first was the AI stuff (we used BERT encoding and did some deep learning for those interested, but it could have been a random forest, like almost everything). Donezo.</p>
<p>The <em>second</em> thing was very simple. The organization had many staff dedicated to data labeling using a series of Access databases. Put simply, it&#39;s a database that non-technical staff can use like a spreadsheet for data entry, without all the chaos of untrained people creating your organization&#39;s data models for the rest of eternity. Despite the good things spreadsheets enable, please take a moment to reflect on <em>whether they are actually worth the tradeoff</em> in light of that sentence.</p>
<p>The organization wanted to replace that Access interface with a simple web application so that some functionality could be added, and new data could be pre-labelled by our machine learning work. To do so, they hired Derek, so named because I <a href="https://ludic.mataroa.blog/blog/your-organization-probably-doesnt-want-to-improve-things/">evidently decided that Derek is our default name for someone that hurts me</a>. Sorry, Dereks.</p>
<p>Derek had <em>one simple job</em>. Make a <em>really easy</em> CRUD app.</p>
<p>Create a simple authentication system. Replicate seven CRUD pages. Create a SQL Server instance to store the data instead of Access.</p>
<p>He had been working on it for eight months before I joined, and was scheduled to leave three days after I joined. However, the application was &#34;basically finished&#34; according to management, and Derek had received glowing praise for his extreme efficiency and quiet work ethic. He had also come highly recommended. On the very first day, he is asked to make an adjustment to the application, and he does so in five minutes. He very proudly says this is because the application is &#34;very flexible&#34;. <strong>I could have saved myself so much pain if I had run at this second.</strong></p>
<p>However, since my friend was quite inexperienced at running engineering projects (and I was too, but had some natural aptitude I guess), I decided to make sure the handover was graceful. I asked Derek to share his repository with us.</p>
<p>The rest of this story is one train crashing in slow motion, and it has not actually stopped crashing four years later.</p>

<p>None of the code was version controlled. He had been working for <em>eight months</em> and there was not a single commit in sight. It was all just a gigantic pile of files on his computer, and it was all undocumented and uncommented.</p>
<p>I meander away, stunned. I return five minutes later and ask him to just put the whole dump of files in a repository and write up a quick word document explaining how to run the application.</p>
<p>Derek does as asked. The documentation is admittedly adequate. That is the last positive thing that will be said of Derek. He departs soon thereafter.</p>

<p>It is a month later and... the app doesn&#39;t work. It takes us a while to figure out how to launch it, and when we <em>do</em> launch it, we realize that the core functionality simply doesn&#39;t work. Derek had put together a series of pages that <em>looked</em> like they worked to a manager that only investigated for thirty seconds over his shoulder, but they didn&#39;t function as intended. Some minor features were missing. For example, it had some small flaws such as <em>never saving any user input</em>.</p>
<p>To complicate things further, the whole server was written in C# so bad that I was put off the language for two years until being reassured by competent people that .NET is actually okay, and the frontend was done with Angular so ugly that I <em>still</em> think it must suck. It was, of course, a single-page application for no fucking reason.</p>
<p>Well, okay, let&#39;s see if we can salvage this. My friend and I start unspooling the mess. The records are being pulled from, uh, <em>one table</em>? Wait, what? We have hundreds of columns across those seven pages. The whole database is one table? The whole database is one table. The whole database is <em>one table</em>?</p>
<p>What did he <em>do</em>?</p>
<p>From Bill Karwin&#39;s extremely good book, <em>SQL Antipatterns</em>, which I unfortunately only read a year later:</p>
<blockquote>
<p>If you hear phrases like the following spoken by your project team, it’s a clue that someone is employing the EAV antipattern:  </p>
<p>• “This database is totally extensible without metadata changes. You can define new attributes at runtime.”  </p>
<p>Relational databases don’t support that degree of flexibility. When someone claims to have designed an arbitrarily extensible database, they’re probably using the EAV design.</p>
</blockquote>
<p>He had stored <em>everything</em> as key-value pairs. So instead of:</p>
<table>
<thead>
<tr>
<th>User</th>
<th>Age</th>
<th>Profession</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ludic</td>
<td>29</td>
<td>Tortured Soul</td>
</tr>
</tbody>
</table>
<p>We had:</p>
<table>
<thead>
<tr>
<th>User ID</th>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Name</td>
<td>Ludic</td>
</tr>
<tr>
<td>1</td>
<td>Age</td>
<td>29</td>
</tr>
<tr>
<td>1</td>
<td>Profession</td>
<td>Tortured Soul</td>
</tr>
</tbody>
</table>
<p>Each individual case to be labelled had 350 rows of data now, in one <em>super long</em> table. Remember how I said this was actually a reasonable AI project? Yeah, we had a <em>lot</em> of data, now multiplied by 350 and a fucking nightmare to query.</p>
<p>I opt to proceed by redoing the entire database. It takes <em>a while</em>. Then we rework the Angular app (also <em>very</em> painful) to work with the new (correct) data model. The decision to just do the right thing here instead of limping on forever gave us <em>huge</em> speed benefits later on, and I think it&#39;s one of my proudest professional accomplishments even though it sounds simple. It was boring, painful, and no one other than my friend would ever appreciate it. I <em>knew that</em> going in, and I still did it.</p>
<p>Incidentally, I was allowed to do so only because management had been so negligent in allowing things to get to this state that they also didn&#39;t notice I was getting them out of this state, and thus couldn&#39;t insert their asinine opinions on how good practice is actually too slow. We&#39;ve got to <em>ship</em>.</p>

<p>Oh, you thought this was over? No, no, you see, the flexible schema is simply a portent of things to come. It is the blood moon hanging low in the sky, a malevolent eye bleeding crimson despair across the landscape. It is the sickly glint of a ravenous knife in a dark alleyway. Wielded by the uninitiated, it is a sign that you must flee, flee as fast as your legs can carry you, and I was too foolish to do so.</p>
<p>Each morning, I&#39;m one of the few people that takes the time to get to know the data entry team, and it is becoming increasingly clear that they are treated by management as not-quite-real-people. Useful, to be treated with cordiality, but certainly not to be invited out for morning coffee. The <em>core</em> functionality is brought into a state where I know we can deliver on time, and I cheerfully mention this right before lunch.</p>
<p>&#34;Oh, amazing, can we see it? We&#39;ve been waiting years.&#34;</p>
<p>... <em>Years</em>? We only got the $1M about nine months ago. Development hadn&#39;t started. How long has management been promising this app to these people? I didn&#39;t really have time to look for these signs of dysfunction when I joined because of my visa status <em>and</em> not knowing what to look for those days.</p>
<p><em>Wait</em>. No one <em>had shown the staff the application in ten months</em>?</p>
<p>Yeah, it turns out they just showed Derek the Access database and said &#34;Could you turn this into an app?&#34;. And then they didn&#39;t talk to him for eight months or do anything remotely close to requirements gathering. Just let one guy that didn&#39;t know anything about the company&#39;s operations just start designing the software that would underpin the entirety of their operations. Cool. Cool, cool, cool.</p>
<p>I show the staff the application, and I think they&#39;re more thrilled that someone has actually included them than they are at the application. We make some tweaks because it is immediately apparently that it still has major flaws. This takes a bunch of time too, and I am <em>tired</em>. This is all happening amidst the middle of Covid, so I am periodically being forced to spend weeks locked in my apartment.</p>

<p>It is around 11 AM, about a week later.</p>
<p>I am working on a schema migration. I look at one of the Access databases that Derek had been populating his local SQL Server instance with.</p>
<p>Very abruptly, my blood runs ice-cold, something I had only experienced <em>once</em> before when I endured the rite-of-passage of my first production mistake. I have no idea how this hadn&#39;t occurred to me until this second, seven months after Derek left, but suddenly the right two neurons fire. My blood is running cold <em>now</em> just thinking about it.</p>
<p>He had copied one of the Access databases onto his local machine. An Access database full of <em>extremely sensitive</em> medical data. Like &#34;I have never heard of a leaked dataset that would be this damaging to vulnerable people&#34; levels of sensitive. And I have a copy. Which means <em>Derek put it on GitHub</em>.</p>
<p>There has been a voice playing in my head since that moment. It has become very quiet, and I had almost forgotten about it, but I can hear it now. It sounds like this:</p>
<p>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.</p>
<p>Just take a little bit to soak in the horror for a bit. I&#39;ll wait.</p>
<p>...</p>
<p>...</p>
<p>...</p>
<p>Okay, we&#39;re done panicking together. Let&#39;s move on.</p>
<p>The repository is, thankfully, set to private. Which of course, doesn&#39;t change the fact the fact a fuckton of absolutely radioactive data had just been uploaded to a third-party&#39;s servers outside of the country.</p>
<p>We handle it very judiciously. I can&#39;t even remember how it was raised or what the decision was, but this was out of my hands as a lowly brown person on a very tenuous visa. It would be wrong to say it blew over because management finessed it such that there was nary a whisper of any wrongdoing. I am pretty sure it all worked out fine, truth be told - at this point I suspect all the backups containing the breach have expired, and we hit the actual file with the <a href="https://rtyley.github.io/bfg-repo-cleaner/">BFG</a> and then ran all sorts of things on our hard drives to ensure that the data wouldn&#39;t be recoverable even by specialists. Enterprise infosec isn&#39;t a fake circus moon though, am I right fellow executives?</p>
<p>I also <em>just realized</em> that he might have been working on a personal laptop. That we wouldn&#39;t have scrubbed clean.</p>
<p>I need to take another moment to calm down.</p>

<p>It is a week later. I am deep in horrific depths of some helper function Derek wrote to produce some of SQL Server tables. There is a comprehensive docstring at the top of the file, which is very unlike Derek. Maybe he isn&#39;t so bad.</p>
<blockquote>
<p>COPYRIGHT MEDTECH, 2015.</p>
</blockquote>
<p>That... isn&#39;t where I work.</p>
<p>I stare at the screen for a few minutes, pondering what to do.</p>
<p>I close the file and move on. Just... just... yeah.</p>

<p>The next day, management announces that remote work is cancelled, and we need to be in three days a week because it will aid collaboration. Our addle-brained senior manager, who has no idea what&#39;s happening but also put that $1M on their CV, keeps forgetting whether they&#39;re usually honest with me or not. Each day, they flip a coin and decide whether they&#39;re going to say:</p>
<blockquote>
<p>I am so excited to come back to the office! It&#39;ll be great to see some people around again, great for productivity.</p>
</blockquote>
<p>And:</p>
<blockquote>
<p>I hate this, but the executives are making us do it. God, I would prefer to be spending time with my grandchildren.</p>
</blockquote>
<p>But the air conditioning in the office doesn&#39;t work very well, and I have suddenly remembered that I enjoy not being in a dimly lit room at 27 degrees Celsius (80.6 degrees Fahrenheit for you whacky Americans) for eight hours a day surrounded by lizard people. By sheer luck, my permanent residency is approved after years of struggle. I quit.</p>
<p>The most important person in the organization calls me to yell because they made me promise to stay in order to not get deported a while ago. Sometimes I think about their impotent fury paired with the flaccid repetition of &#34;I just thought you were a man of your word but I can see I was mistaken&#34; and smile.</p>
<p>In retrospect, I would be livid that I did <em>so much</em> to help them. But firstly, I was well-paid. Secondly, the other engineer quits too within two months. One of my current clients, doing lifesaving work that my team agreed to help pro-bono (and I&#39;m so proud of them for it), is in the periphery of that project. They confirmed recently that it still hasn&#39;t launched despite there being only a year of work (<em>extreme</em> upper bound estimate) left to launch at the time I left for two competent engineers.</p>
<p><em>Perish</em>, nerds.</p>

<blockquote>
<p>“Bad programmers worry about the code. Good programmers worry about data structures and their relationships.” - Linus Torvalds</p>
</blockquote>
<p>What about the programmers that do neither?</p>
<p>I do not know what it <em>is</em> about flexible schemas, but there is a certain type of person that probably has all the mental horsepower required to be a <em>phenomenal</em> engineer that simply gets stuck on their &#34;elegance&#34; and then never progresses any further. The fact that Derek had the working memory and patience to whip this grotesque Angular/.NET/schemaless abomination into something that even ran at all indicates he has a level of pain tolerance and raw brainstuff that I cannot even approach. I <em>can&#39;t handle</em> things that badly designed, and it isn&#39;t just aesthetic sense or design intuition. The hardware in my skull isn&#39;t up to spec.</p>
<p>But I just <em>keep meeting that person</em>. The first sign I&#39;m dealing with an Idiot-Pattern clone is <em>always</em> &#34;I&#39;ve found a way to not worry about our data model, ha ha&#34;, and always ends with &#34;I have single-handedly destroyed the infrastructure of this company&#34;. Also, you can never fire them because there <em>is</em> a schema, it lives in their incomprehensible code and in their brains. The worst part is that they&#39;re <em>always so proud</em> of the flexibility, as if they&#39;re the first fucking genius to realize that if you discard things like, I dunno, database types and queryability and any sort of validation, then you can code &#34;without interruption&#34; whatever that means. Then they exhibit this lack of judgement in every other area of their professional lives.</p>
<p>I <em>do not</em> understand how they are both smarter than me in many respects, and then <em>still don&#39;t understand how stupid this all is</em>.</p>

<p>It is years later. I am brought onto a platform that is advertised as state-of-the-art. Every competitor in the state is copying our implementation. On my first day, they tell me that all ETL metadata and logging is stored in DynamoDB because it is more flexible.</p>
<p>This was the first clue that they were idling their computers <a href="https://ludic.mataroa.blog/blog/i-accidentally-saved-half-a-million-dollars/">to the tune of half a million dollars</a>.</p>
<p>Ahem.</p>
<p>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.</p>

<p>PS: You can stop reading here, the post is over. The rest of this is about setting up Liberapay and Patreon to receive support for writing/podcasting/whatever.</p>
<p>The preferred option is <a href="https://en.liberapay.com/Ludic/">Liberapay</a> because it is open-source and aligned with the principles of this community. However <a href="https://www.patreon.com/ludic190/membership">Patreon</a> is also available in case you already have an account and just want to click the buttons fast.</p>
<p>The reasons for this are written in <a href="https://ludic.mataroa.blog/blog/on-authenticity-and-whats-worth-doing/">this post</a>. However, you will probably get my writing forever, for free. The &#34;probably&#34; is not because I&#39;d start charging, but because life might get in the way at times, and there might be breaks in my output. And the currently-being-recorded podcast will also probably be free forever, though this might actually have some paywalled episodes one day if it is time-consuming enough - editing audio doesn&#39;t sound as fun as writing. But of course, even then I&#39;m promising right now, with God as my witness, that I&#39;d hand it out for free to anyone that can&#39;t justify the expense because I have something called <em>ethics</em>/<em>bad business sense</em>.</p>
<p>Currently, you will receive no benefits other than showing appreciation, covering the cost of extending my weekly music classes from 30 minutes to 45 minutes, and eventually paying for hosting a cheap server or two that I&#39;ll use to deploy some stuff to help coordinate our community.</p>
<p>Both systems are configured to show how much I&#39;m getting even though this is demonstrably <em>terrible</em> for your income, because I am evidently hellbent on only accepting money from <em>very insistent</em> people.</p>
<p>I am only going to add this footnote to a post once every six months (this must be done or no new readers will ever know the links are there). And then I won&#39;t have to mar too many posts with this stuff.</p>
<p>Thanks for reading!</p>
        </div></div>
  </body>
</html>
