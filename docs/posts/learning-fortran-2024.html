<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://uncenter.dev/posts/learning-fortran/">Original</a>
    <h1>Learning Fortran (2024)</h1>
    
    <div id="readability-page-1" class="page"><article><div><p><span><time datetime="2024-01-31T00:00:00.000Z">01/31/2024</time> (last edited <time datetime="2024-05-07T00:00:00.000Z">05/07/2024</time>)</span> <span>·</span></p></div><nav aria-label="Table of contents"><ul><li><a href="#a-quick-history">A quick history</a></li><li><a href="#which-version-of-fortran%3F">Which version of Fortran?</a></li><li><a href="#understanding-the-syntax">Understanding the syntax</a></li><li><a href="#how-do-i-actually-run-this%3F">How do I actually run this?</a></li><li><a href="#a-few-improvements">A few improvements</a></li></ul></nav><p>While I probably should be learning a language like C, Go, or whatever new trendy language the <a href="https://twitter.com/ThePrimeagen" rel="noreferrer">ThePrimeagen</a> mentions on Twitter (OCaml?), I&#39;m going to attempt to learn Fortran.</p><h2 id="a-quick-history" tabindex="-1"><a href="#a-quick-history"><span>A quick history</span></a></h2><p>Fortran, which stands for FORmula TRANslator, was created at IBM by <a href="https://en.wikipedia.org/wiki/John_Backus" rel="noreferrer">John Backus</a> in 1957 for scientific applications and has apparently been popular for high-performance computing and benchmarking supercomputers in recent years. Fortran has had several subsequent releases since then; FORTRAN 77, Fortran 90, Fortran 95, Fortran 2003, Fortran 2008, and the latest Fortran 2018.</p><h2 id="which-version-of-fortran%3F" tabindex="-1"><a href="#which-version-of-fortran%3F"><span>Which version of Fortran?</span></a></h2><p>To understand what version of Fortran to learn/use, we first must understand the difference between <em>fixed form</em> and <em>free form</em> Fortran. The <a href="https://fortranwiki.org/fortran/show/Fixed+form+layout" rel="noreferrer">fixed form layout</a> comes from the very beginning of Fortran, inherited from punch cards, and has odd restrictions about the column in which comments and statements are placed. The free form layout, first introduced in Fortran 90, removed special columns and added the ability to write comments wherever, and is what we&#39;ll be learning in this article. The compiler we&#39;ll be using is GNU Fortran, or <code>gfortran</code>. You can install it via Homebrew (macOS) with the <a href="https://formulae.brew.sh/formula/gcc#default" rel="noreferrer"><code>gcc</code></a> formula, or <a href="https://gcc.gnu.org/wiki/GFortranDistros" rel="noreferrer">install it using a package manager for your OS</a>. To tell <code>gfortran</code> that your code uses the free form layout, set the file extension to <code>.f90</code> or newer. The following <a href="https://fortran-lang.discourse.group/t/is-there-a-standard-file-suffix-for-modern-fortran-code/3550/2" rel="noreferrer">comment on the Fortran discussion board</a> explains this well.</p><blockquote><p>The .f90 suffix means that the source code is free format, not that</p></blockquote><h2 id="understanding-the-syntax" tabindex="-1"><a href="#understanding-the-syntax"><span>Understanding the syntax</span></a></h2><p>Coming from TypeScript, and before that, Python, I&#39;m very used to (and comfortable with) modern — you might say &#34;aesthetic&#34; — syntax . Although I wouldn&#39;t say Fortran syntax is quite <em>modern</em>, it seems to avoid the syntactic sugar nightmares that plague beginners in other languages. Take a look at this <code>helloworld.f90</code> example below.</p><div id="99a4ec86"><pre tabindex="0"><code><span><span>program</span><span> helloworld</span></span>

<span><span>  print</span><span> *</span><span>, </span><span>&#39;Hello, world!&#39;</span></span>

<span><span>end program</span><span> helloworld</span></span></code></pre></div><div><p>Older Fortran programs required the use of <a href="https://en.wiktionary.org/wiki/screaming_snake_case" rel="noreferrer">SCREAMING_CASE</a> for all keywords, but in modern Fortran you can and <a href="https://fortran-lang.org/learn/best_practices/style_guide/" rel="noreferrer">it is recommended</a> to use <a href="https://en.wiktionary.org/wiki/snake_case#English" rel="noreferrer">snake_case</a> (you can still use SCREAMING_CASE or any other case you want though).</p></div><p>Just from this small example we can gather that...</p><ul><li>Every Fortran program begins with <code>program &lt;program-name&gt;</code> and ends with <code>end program &lt;program-name&gt;</code>.</li><li>To display text on the terminal we use <code>print *, &#39;&lt;message&gt;&#39;</code>.</li></ul><p>The syntax for printing is a little funky though. What is that asterisk doing there? The asterisk, aside from being used as a mathematical operator, indicates the &#34;default&#34;. So for <code>print</code>, <code>*</code> means &#34;print to the default output channel&#34; (or &#34;print to the default output file unit&#34; to be precise), which is typically going to be STDOUT.</p><div><p>I can&#39;t find exactly where this is documented but you don&#39;t actually need the start and end <code>program &lt;program-name&gt;</code>; you could write a hello world program like this, though as I just mentioned this doesn&#39;t seem to be a common practice and isn&#39;t really very useful in any practical scenario.</p><div id="61dddff9"><pre tabindex="0"><code><span><span>print</span><span> *</span><span>, </span><span>&#39;Hello, world!&#39;</span><span>; end</span></span></code></pre></div></div><p>Here&#39;s another, slightly more complicated example.</p><div id="b6625820"><pre tabindex="0"><code><span><span>program</span><span> calculator</span></span>
<span><span>  implicit</span><span> none</span></span>

<span><span>  real</span><span> ::</span><span> x, y, answer</span></span>
<span><span>  character</span><span>(</span><span>1</span><span>)</span><span> ::</span><span> choice</span></span>

<span><span>  print</span><span> *</span><span>, </span><span>&#39;x:&#39;</span></span>
<span><span>  read</span><span> *</span><span>, x</span></span>
<span><span>  print</span><span> *</span><span>, </span><span>&#39;y:&#39;</span></span>
<span><span>  read</span><span> *</span><span>, y</span></span>

<span><span>  print</span><span> *</span><span>, </span><span>&#39;+, -, *, /:&#39;</span></span>
<span><span>  read</span><span> *</span><span>, choice</span></span>
<span><span>  if</span><span> (</span><span>choice </span><span>==</span><span> &#39;+&#39;</span><span>)</span><span> then</span></span>
<span><span>    answer </span><span>=</span><span> x </span><span>+</span><span> y</span></span>
<span><span>  end if</span></span>
<span><span>  if</span><span> (</span><span>choice </span><span>==</span><span> &#39;-&#39;</span><span>)</span><span> then</span></span>
<span><span>    answer </span><span>=</span><span> x </span><span>-</span><span> y</span></span>
<span><span>  end if</span></span>
<span><span>  if</span><span> (</span><span>choice </span><span>==</span><span> &#39;*&#39;</span><span>)</span><span> then</span></span>
<span><span>    answer </span><span>=</span><span> x </span><span>*</span><span> y</span></span>
<span><span>  end if</span></span>
<span><span>  if</span><span> (</span><span>choice </span><span>==</span><span> &#39;/&#39;</span><span>)</span><span> then</span></span>
<span><span>    answer </span><span>=</span><span> x / y</span></span>
<span><span>  end if</span></span>

<span><span>  print</span><span> *</span><span>, </span><span>&#39;Answer:&#39;</span><span>, answer</span></span>

<span><span>end program</span><span> calculator</span></span></code></pre></div><p>Starting right at the top, we have something new: <code>implicit none</code>. Added in Fortran 90, <code>implicit none</code> disables implicit typing defaults and all variables must be explicitly declared. In Fortran, implicit typing is the practice of assigning default types to variables based on the character a variable name begins with. Variables starting with <code>I</code> through <code>N</code> are <code>INTEGER</code>s, everything else is <code>REAL</code>. It is &#34;a legacy of the past&#34; and usage of an <code>implicit none</code> statement is &#34;strongly advised&#34; (<a href="https://fortranwiki.org/fortran/show/implicit+none" rel="noreferrer">implicit none - Fortran Wiki</a>).</p><p>A common Fortran joke goes along the lines of “GOD is REAL, unless declared INTEGER&#34; because of implicit typing!</p><p>Moving on, we declare our first variables in this program.</p><div id="8fb1f820"><pre tabindex="0"><code><span><span>real</span><span> ::</span><span> x, y, answer</span></span>
<span><span>character</span><span>(</span><span>1</span><span>)</span><span> ::</span><span> choice</span></span></code></pre></div><p>Here we are declaring <code>x</code>, <code>y</code>, and <code>answer</code> with the <code>REAL</code> type, and <code>choice</code> with the <code>CHARACTER</code> type. The <code>REAL</code> type stores floating point numbers, and <code>CHARACTER</code>... stores characters.</p><p>Next, we prompt the user for our <code>x</code> and <code>y</code> values.</p><div id="80835a27"><pre tabindex="0"><code><span><span>print</span><span> *</span><span>, </span><span>&#39;x:&#39;</span></span>
<span><span>read</span><span> *</span><span>, x</span></span>
<span><span>print</span><span> *</span><span>, </span><span>&#39;y:&#39;</span></span>
<span><span>read</span><span> *</span><span>, y</span></span></code></pre></div><p>Notice how we can take input from the user with <code>read</code> and assign it to a value with the <code>read *, &lt;variable&gt;</code> syntax. The asterisk here means <em>read</em> from the default input channel/file unit, which would be STDIN.</p><p>We do the same for prompting the user to select an operation.</p><div id="78a4f9a5"><pre tabindex="0"><code><span><span>print</span><span> *</span><span>, </span><span>&#39;+, -, *, /:&#39;</span></span>
<span><span>read</span><span> *</span><span>, choice</span></span></code></pre></div><p>Finally, we use a series of basic if-statements to calculate our answer and display it in the terminal.</p><div id="16d64b01"><pre tabindex="0"><code><span><span>if</span><span> (</span><span>choice </span><span>==</span><span> &#39;+&#39;</span><span>)</span><span> then</span></span>
<span><span>  answer </span><span>=</span><span> x </span><span>+</span><span> y</span></span>
<span><span>end if</span></span>
<span><span>if</span><span> (</span><span>choice </span><span>==</span><span> &#39;-&#39;</span><span>)</span><span> then</span></span>
<span><span>  answer </span><span>=</span><span> x </span><span>-</span><span> y</span></span>
<span><span>end if</span></span>
<span><span>if</span><span> (</span><span>choice </span><span>==</span><span> &#39;*&#39;</span><span>)</span><span> then</span></span>
<span><span>  answer </span><span>=</span><span> x </span><span>*</span><span> y</span></span>
<span><span>end if</span></span>
<span><span>if</span><span> (</span><span>choice </span><span>==</span><span> &#39;/&#39;</span><span>)</span><span> then</span></span>
<span><span>  answer </span><span>=</span><span> x / y</span></span>
<span><span>end if</span></span>

<span><span>print</span><span> *</span><span>, </span><span>&#39;Answer:&#39;</span><span>, answer</span></span></code></pre></div><p>If we run this, we- wait. Did I even tell you how to compile a Fortran program yet?</p><h2 id="how-do-i-actually-run-this%3F" tabindex="-1"><a href="#how-do-i-actually-run-this%3F"><span>How do I actually run this?</span></a></h2><p>First, compile our calculator program with <code>gfortran -o calculator calculator.f90</code> . Then you can run it with <code>./calculator</code>. If you only instruct <code>gfortran</code> of the input file (<code>gfortran calculator.f90</code>), the default output executable will be named <code>a.out</code>.</p><p>Let&#39;s run our program now.</p><div id="08f86b99"><pre tabindex="0"><code><span><span>$ gfortran -o calculator calculator.f90</span></span>
<span><span>$ ./calculator</span></span>
<span><span> x:</span></span>
<span><span>10</span></span>
<span><span> y:</span></span>
<span><span>2</span></span>
<span><span> +, -, *, /:</span></span>
<span><span>*</span></span>
<span><span> Answer:   20.0000000</span></span></code></pre></div><p>Pretty cool, huh?</p><h2 id="a-few-improvements" tabindex="-1"><a href="#a-few-improvements"><span>A few improvements</span></a></h2><p>Our calculator isn&#39;t perfect yet though. What if the user tries to divide by zero?</p><div id="fcd7a75b"><pre tabindex="0"><code><span><span> x:</span></span>
<span><span>10</span></span>
<span><span> y:</span></span>
<span><span>0</span></span>
<span><span> +, -, *, /:</span></span>
<span><span>/</span></span>
<span><span> Answer:         Infinity</span></span></code></pre></div><p>Probably not the answer you expected. Let&#39;s try to fix that.</p><div id="3d4d8d1e"><pre tabindex="0"><code><span><span>if</span><span> (</span><span>choice </span><span>==</span><span> &#39;/&#39;</span><span>)</span><span> then</span></span>
<span><span>  if</span><span> (</span><span>y </span><span>/=</span><span> 0.0</span><span>)</span><span> then</span></span>
<span><span>    answer </span><span>=</span><span> x / y</span></span>
<span><span>  else</span></span>
<span><span>    print</span><span> *</span><span>, </span><span>&#39;Error: Division by zero is not allowed.&#39;</span></span>
<span><span>	stop</span></span>
<span><span>  end if</span></span>
<span><span>end if</span></span></code></pre></div><p>Here we use the inequality operator, <code>/=</code>, to check if the <code>y</code> value is zero. Now, if the user tries to divide by zero, we&#39;ll print an error message and use the <code>stop</code> statement to end the program.</p><p>Great. We got rid of the zero division mess, but our code isn&#39;t pretty at all. Who wants a bunch of if statements? We can simplify this using the <code>select case</code> statement (also known as the <code>case</code> statement).</p><div id="ed7d0003"><pre tabindex="0"><code><span><span>select case</span><span> (</span><span>choice</span><span>)</span></span>
<span><span>  case</span><span> (</span><span>&#39;+&#39;</span><span>)</span></span>
<span><span>    answer </span><span>=</span><span> x </span><span>+</span><span> y</span></span>
<span><span>  case</span><span> (</span><span>&#39;-&#39;</span><span>)</span></span>
<span><span>    answer </span><span>=</span><span> x </span><span>-</span><span> y</span></span>
<span><span>  case</span><span> (</span><span>&#39;*&#39;</span><span>)</span></span>
<span><span>    answer </span><span>=</span><span> x </span><span>*</span><span> y</span></span>
<span><span>  case</span><span> (</span><span>&#39;/&#39;</span><span>)</span></span>
<span><span>    if</span><span> (</span><span>y </span><span>/=</span><span> 0.0</span><span>)</span><span> then</span></span>
<span><span>      answer </span><span>=</span><span> x / y</span></span>
<span><span>    else</span></span>
<span><span>      print</span><span> *</span><span>, </span><span>&#39;Error: Division by zero is not allowed.&#39;</span></span>
<span><span>      stop</span></span>
<span><span>    end if</span></span>
<span><span>  case</span><span> default</span></span>
<span><span>    print</span><span> *</span><span>, </span><span>&#39;Invalid choice. Please choose +, -, *, or /.&#39;</span></span>
<span><span>    stop</span></span>
<span><span>end select</span></span></code></pre></div><p>This also has the handy benefit of telling the user if they made an invalid choice while selecting the operation.</p><p>That’s just a quick introduction to a few modern Fortran features: declaring variables, printing and reading to and from the terminal, <code>if</code> and <code>select case</code>, and <code>stop</code>. Next time, we’ll talk more about where Fortran is actually used, cooler things <em>you</em> can build with it, and how the Fortran language &amp; community are rapidly modernizing!</p></article></div>
  </body>
</html>
