<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/cjdrake/seqlogic">Original</a>
    <h1>Python Logic Simulation Library</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">SeqiLog (pronounced seh-kwi-log) is a Python library for logic design and verification.</p>

<p dir="auto">SeqiLog provides building blocks to simulate hardware at the register transfer
level (RTL) of abstraction:</p>
<ul dir="auto">
<li>Hierarchical, parameterized <code>Module</code> design element</li>
<li>Four-state <code>bits</code> multidimensional array data type</li>
<li>Discrete event simulation using <code>async</code> / <code>await</code> syntax</li>
</ul>
<p dir="auto">SeqiLog is <em>declarative</em>.
To the extent possible,
the designer should only need to know <em>what</em> components to declare,
not <em>how</em> they interact with the task scheduling algorithm.</p>
<p dir="auto">SeqiLog is <em>strict</em>.
Functions should raise exceptions when arguments have inconsistent types.
Uninitialized or metastable state should always propagate pessimistically.</p>
<p dir="auto">The API is an experiment in how to create a <em>Pythonic</em> meta-HDL.
It is currently a work in progress.
Expect breaking changes from time to time.</p>

<p dir="auto">The following code implements a D flip flop (DFF) with the D input connected
to the inverted Q output.</p>
<div dir="auto" data-snippet-clipboard-copy-content="from vcd import VCDWriter
from seqlogic import Module, Vec, run, sleep


async def drv_clock(y):
    &#34;&#34;&#34;Positive clock w/ no phase shift, period T=2, 50% duty cycle.&#34;&#34;&#34;
    while True:
        y.next = &#34;1b1&#34;
        await sleep(1)
        y.next = &#34;1b0&#34;
        await sleep(1)


async def drv_reset(y):
    &#34;&#34;&#34;Positive reset asserting from T=[1..2]&#34;&#34;&#34;
    y.next = &#34;1b0&#34;
    await sleep(1)
    y.next = &#34;1b1&#34;
    await sleep(1)
    y.next = &#34;1b0&#34;


class Top(Module):
    &#34;&#34;&#34;Data flip flop (DFF) Example&#34;&#34;&#34;

    def build(self):
        clk = self.logic(name=&#34;clk&#34;, dtype=Vec[1])
        rst = self.logic(name=&#34;rst&#34;, dtype=Vec[1])
        q = self.logic(name=&#34;q&#34;, dtype=Vec[1])
        d = self.logic(name=&#34;d&#34;, dtype=Vec[1])

        # d = NOT(q)
        self.expr(d, ~q)

        # DFF w/ async positive (active high) reset, reset to 0
        self.dff_r(q, d, clk, rst, rval=&#34;1b0&#34;)

        # Clock/Reset
        self.drv(drv_clock(clk))
        self.drv(drv_reset(rst))


# Run simulation w/ VCD dump enabled
with (
    open(&#34;dff.vcd&#34;, &#34;w&#34;) as f,
    VCDWriter(f, timescale=&#34;1ns&#34;) as vcdw,
):
    top = Top(name=&#34;top&#34;)
    top.dump_vcd(vcdw, &#34;.*&#34;)
    run(top.elab(), ticks=20)"><pre><span>from</span> <span>vcd</span> <span>import</span> <span>VCDWriter</span>
<span>from</span> <span>seqlogic</span> <span>import</span> <span>Module</span>, <span>Vec</span>, <span>run</span>, <span>sleep</span>


<span>async</span> <span>def</span> <span>drv_clock</span>(<span>y</span>):
    <span>&#34;&#34;&#34;Positive clock w/ no phase shift, period T=2, 50% duty cycle.&#34;&#34;&#34;</span>
    <span>while</span> <span>True</span>:
        <span>y</span>.<span>next</span> <span>=</span> <span>&#34;1b1&#34;</span>
        <span>await</span> <span>sleep</span>(<span>1</span>)
        <span>y</span>.<span>next</span> <span>=</span> <span>&#34;1b0&#34;</span>
        <span>await</span> <span>sleep</span>(<span>1</span>)


<span>async</span> <span>def</span> <span>drv_reset</span>(<span>y</span>):
    <span>&#34;&#34;&#34;Positive reset asserting from T=[1..2]&#34;&#34;&#34;</span>
    <span>y</span>.<span>next</span> <span>=</span> <span>&#34;1b0&#34;</span>
    <span>await</span> <span>sleep</span>(<span>1</span>)
    <span>y</span>.<span>next</span> <span>=</span> <span>&#34;1b1&#34;</span>
    <span>await</span> <span>sleep</span>(<span>1</span>)
    <span>y</span>.<span>next</span> <span>=</span> <span>&#34;1b0&#34;</span>


<span>class</span> <span>Top</span>(<span>Module</span>):
    <span>&#34;&#34;&#34;Data flip flop (DFF) Example&#34;&#34;&#34;</span>

    <span>def</span> <span>build</span>(<span>self</span>):
        <span>clk</span> <span>=</span> <span>self</span>.<span>logic</span>(<span>name</span><span>=</span><span>&#34;clk&#34;</span>, <span>dtype</span><span>=</span><span>Vec</span>[<span>1</span>])
        <span>rst</span> <span>=</span> <span>self</span>.<span>logic</span>(<span>name</span><span>=</span><span>&#34;rst&#34;</span>, <span>dtype</span><span>=</span><span>Vec</span>[<span>1</span>])
        <span>q</span> <span>=</span> <span>self</span>.<span>logic</span>(<span>name</span><span>=</span><span>&#34;q&#34;</span>, <span>dtype</span><span>=</span><span>Vec</span>[<span>1</span>])
        <span>d</span> <span>=</span> <span>self</span>.<span>logic</span>(<span>name</span><span>=</span><span>&#34;d&#34;</span>, <span>dtype</span><span>=</span><span>Vec</span>[<span>1</span>])

        <span># d = NOT(q)</span>
        <span>self</span>.<span>expr</span>(<span>d</span>, <span>~</span><span>q</span>)

        <span># DFF w/ async positive (active high) reset, reset to 0</span>
        <span>self</span>.<span>dff_r</span>(<span>q</span>, <span>d</span>, <span>clk</span>, <span>rst</span>, <span>rval</span><span>=</span><span>&#34;1b0&#34;</span>)

        <span># Clock/Reset</span>
        <span>self</span>.<span>drv</span>(<span>drv_clock</span>(<span>clk</span>))
        <span>self</span>.<span>drv</span>(<span>drv_reset</span>(<span>rst</span>))


<span># Run simulation w/ VCD dump enabled</span>
<span>with</span> (
    <span>open</span>(<span>&#34;dff.vcd&#34;</span>, <span>&#34;w&#34;</span>) <span>as</span> <span>f</span>,
    <span>VCDWriter</span>(<span>f</span>, <span>timescale</span><span>=</span><span>&#34;1ns&#34;</span>) <span>as</span> <span>vcdw</span>,
):
    <span>top</span> <span>=</span> <span>Top</span>(<span>name</span><span>=</span><span>&#34;top&#34;</span>)
    <span>top</span>.<span>dump_vcd</span>(<span>vcdw</span>, <span>&#34;.*&#34;</span>)
    <span>run</span>(<span>top</span>.<span>elab</span>(), <span>ticks</span><span>=</span><span>20</span>)</pre></div>
<p dir="auto">Use <a href="https://gtkwave.sourceforge.net" rel="nofollow">GTKWave</a>
or <a href="https://surfer-project.org" rel="nofollow">Surfer</a> to view the VCD wave dump.
It should look this this:</p>
<div data-snippet-clipboard-copy-content="T (ns)   0  1  2  3  4  5  6  7  8  9 ...
---------+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

clk      /‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\

rst      ___/‾‾\___________________________________________________

q        XXXX________/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\___

d        XXXX‾‾‾‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾

---------+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+"><pre><code>T (ns)   0  1  2  3  4  5  6  7  8  9 ...
---------+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

clk      /‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\__/‾‾\

rst      ___/‾‾\___________________________________________________

q        XXXX________/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\___

d        XXXX‾‾‾‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾‾‾\_____/‾‾‾

---------+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</code></pre></div>
<p dir="auto">See the <code>ipynb</code> and <code>tests</code> directories for more examples.</p>

<p dir="auto">SeqiLog is available on <a href="https://pypi.org" rel="nofollow">PyPI</a>:</p>

<p dir="auto">It supports Python 3.12+.</p>

<p dir="auto">SeqiLog&#39;s repository is on <a href="https://github.com">GitHub</a>:</p>
<div data-snippet-clipboard-copy-content="$ git clone https://github.com/cjdrake/seqlogic.git"><pre><code>$ git clone https://github.com/cjdrake/seqlogic.git
</code></pre></div>
<p dir="auto">Runtime dependencies are listed in <code>requirements.txt</code>.
Development dependencies are listed in <code>requirements-dev.txt</code>.</p>
</article></div></div>
  </body>
</html>
