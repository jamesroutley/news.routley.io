<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://sancarn.github.io/vba-articles/why-do-people-use-vba.html">Original</a>
    <h1>Why do people still use VBA?</h1>
    
    <div id="readability-page-1" class="page"><article>
  <p>
    <time datetime="2023-10-18 00:00:00 +0000">2023-10-18</time>
  </p>
  
  

  <h2 id="introduction">Introduction</h2>

<p>Recently, I watched a video by YouTuber <a href="https://www.youtube.com/@ThePrimeTimeagen">ThePrimeTime</a> which details a dev’s frustrations with business culture. Prime is an ex-entrepreneur who currently works in software development at Netflix. His views in this video have been criticised for being jaded by <a href="https://www.google.com/search?q=FAANG+companies">FAANG</a> business cultures he has worked in. I personally don’t feel this way. Although there is some truth to the <a href="https://ludic.mataroa.blog/blog/your-organization-probably-doesnt-want-to-improve-things/">developer’s (<code>mataroa</code>’s) article</a>, I think it misses the root causes of many issues raised.</p>

<p>
    <iframe width="640" height="390" src="https://www.youtube.com/embed/eJ7oQ6cUwAw" frameborder="0" allowfullscreen=""></iframe>
</p>


<p>I have mixed feelings about the article in question. Some areas I agreed with and others I disagreed with. However I did want to address one particular concern / statement:</p>

<blockquote>
  <p>I work on a platform that cost my organization an eye-watering sum of money to produce, over the span of two years, and the engineers responsible for it elected to use spreadsheets to control the infrastructure, so we now have a spreadsheet with 400 separate worksheets that powers but one part of this whole shambling mess.</p>
</blockquote>

<p>I’m speculating here, but I’d imagine that the business/SMEs (Subject Matter Experts) are using VBA to some capacity to control their 400 worksheet collection. So this begs the question…</p>

<h2 id="why-do-people-use-vba">Why do people use VBA?</h2>

<p>In order to answer this question, we must first look at another question - who actually uses VBA in the first place? In 2021 I ran a poll on <a href="http://reddit.com/r/vba">/r/vba</a> where I asked redditors why they code in VBA.</p>

<p><img src="https://sancarn.github.io/vba-articles/assets/img/reddit-2021-why-do-you-code-in-vba.png" alt="_"/></p>

<p>From these data, we can clearly see that the majority of people who use VBA do so mainly because they have no other choice. Many organisations run their entire business processes with Excel, and when a little bit of automation is required VBA is usually #1 on the list.</p>

<h2 id="the-versatility-of-vba">The versatility of VBA</h2>

<p>In the business I currently work for, in the engineering division, we have access to a variety of technologies (automation platforms):</p>

<ul>
  <li>OnPrem - PowerShell (No access to <code>Install-Module</code>)</li>
  <li>OnPrem - Excel (VBA  / OfficeJS (limited access) / OfficeScripts / PowerQuery)</li>
  <li>OnPrem - PowerBI Desktop</li>
  <li>OnPrem - SAP Analysis for Office</li>
  <li>OnCloud - Power Platform (PowerApps, Power BI, PowerAutomate (non-premium only))</li>
  <li>SandboxedServer - ArcGIS (ArcPy)</li>
  <li>SandboxedServer - MapInfo (MapBasic)</li>
  <li>SandboxedServer - InfoWorks ICM (Ruby)</li>
  <li>SandboxedCloud - ArcGIS Online</li>
</ul>

<p>We also have a number of databases controlled by IT:</p>

<ul>
  <li>D1. OnPrem   - Geospatial database <!-- GISSTdb OnPrem --></li>
  <li>D2. OnCloud  - Geospatial mirror   <!-- GISSTdb OnCloud --></li>
  <li>D3. OnPrem   - SAP database        <!-- SAP ECC --></li>
  <li>D4. OnCloud  - SAP BW4HANA partial mirror</li>
  <li>D5. OnPrem   - Telemetry platform  <!-- eSCADA --></li>
  <li>D6. OnPrem   - Sharepoint</li>
  <li>D7. OnCloud  - Sharepoint Online</li>
  <li>D8. OnCloud  - EDM Telemetry platform</li>
  <li>D9. OnCloud  - Large mirror database <!-- CDP --></li>
  <li>D10. OnPrem  - LotusNotes database   <!-- ORM --></li>
  <li>D11. OnPrem  - IBM BPM database      <!-- STORM --></li>
  <li>D12. OnPrem  - File System</li>
  <li>D13. OnPrem  - Hydraulic Model Information</li>
</ul>

<p><code>D1</code>-<code>D13</code> databases are summarised in the table below listing what types of data are stored in which systems, the importance of the data stored in each database, and whether the database is essentially a replica of OnPrem information:</p>

<table>
  <thead>
    <tr>
      <th>Data Type</th>
      <th>D1</th>
      <th>D2</th>
      <th>D3</th>
      <th>D4</th>
      <th>D5</th>
      <th>D6</th>
      <th>D7</th>
      <th>D8</th>
      <th>D9</th>
      <th>D10</th>
      <th>D11</th>
      <th>D12</th>
      <th>D13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Customer Issues</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Asset Data</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td>X</td>
    </tr>
    <tr>
      <td>Telemetry Data</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Risk Data</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td>X</td>
    </tr>
    <tr>
      <td>Financial Data</td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td> </td>
    </tr>
    <tr>
      <td>Misc Data</td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td>X</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>X</td>
      <td>X</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Note: <code>D6</code> would be C tier if it weren’t for the fact we continue to store a business critical spreadsheet on Sharepoint OnPrem for compatibility reasons. See <a href="#the-control-of-vba">the control of VBA</a> for details.</p>
</blockquote>

<p>And the data’s importance / on cloud replication:</p>

<table>
  <thead>
    <tr>
      <th>Data Type</th>
      <th>D1</th>
      <th>D2</th>
      <th>D3</th>
      <th>D4</th>
      <th>D5</th>
      <th>D6</th>
      <th>D7</th>
      <th>D8</th>
      <th>D9</th>
      <th>D10</th>
      <th>D11</th>
      <th>D12</th>
      <th>D13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Data Importance</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>S/C</td>
      <td>A</td>
      <td>B</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>S</td>
      <td>A</td>
    </tr>
    <tr>
      <td>Replica of</td>
      <td>N/A</td>
      <td>D1</td>
      <td>N/A</td>
      <td>~D3</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>~D4</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>N/A</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Note: Online replicas are de facto replicas in terms of data’s importance, although the reason we need to connect to them is diminished</p>
</blockquote>

<p>Finally, let’s examine how our Automation Platforms link to our Data Platforms. Links shown in the diagram are where the automation platform can access the data from the various data platforms/sources:</p>

<p><img src="https://sancarn.github.io/vba-articles/assets/img/who-uses-vba-data-platform-vs-automation-platform.png" alt="_"/></p>

<blockquote>
  <p>Note: Some of the links from VBA to OnCloud services are based on my attempts alone. There is no doubt in my mind that VBA can interface with SAP BW4HANA and our other cloud services, I just haven’t figured out the authentication requirements and protocols yet</p>
</blockquote>

<p>Here’s where you might start to see an issue. Looks like the only automation platforms which can connect to all the data sources we need is <code>VBA</code> and <code>Powershell</code>. <code>Power BI Desktop</code> has been introduced in our business but doesn’t hit all the platforms which <code>VBA</code> does, and even if it did <code>Power BI</code> cannot be used for process automation where-as <code>VBA</code> can, so what’s the point making the switch? Users who do use <code>Power BI</code> to target these other datasets usually generate CSVs of this other data and store these in cloud sharepoint system, but what generates those CSVs? <code>VBA</code>.</p>

<p>Now, we’d love to use a higher level language in our organisation to handle this business automation. However, <strong>every request</strong> for a high level language to be installed across the team/business e.g. <code>Python</code> / <code>Ruby</code> / <code>Node</code> / <code>Rust</code> etc. has been rejected by CyberSecurity in favour of technologies like <code>PowerAutomate</code>, <code>PowerApps</code> which as you can see above barely touch <strong>any</strong> of the data we need. It is supposedly “Against the technology strategic vision of the company” to allow “end-users” access to high level programming languages. Now even if the data access was there in our business, <code>PowerPlatform</code> would still be insufficient to perform the majority of our processes because the algorithms required are so complex that a <code>PowerAutomate</code> solutions would become infuriating to maintain and incomprehensible to even IT folks (e.g. See <a href="https://www.movable-type.co.uk/scripts/latlong-os-gridref.html#source-code-osgridref">projection algorithms</a>).</p>

<p>Ultimately the stand-out technologies for us are <code>Powershell v3</code> (doesn’t even support class syntax and cannot install modules), and <code>VBA</code>, purely from a versatility standpoint. As a result of this ‘monopoly’ on technology I and others have spent hundreds of hours building <a href="https://github.com/sancarn/awesome-vba">open source VBA libraries</a> which augment <code>VBA</code> promoting it to a reasonable language by modern standards.</p>

<h2 id="the-maintenance-guarantee-of-vba">The maintenance guarantee of VBA</h2>

<p><code>D10</code> and <code>D11</code> above are intimately linked. In 2000s many of our systems were built on top of <a href="https://en.wikipedia.org/wiki/IBM_Lotus_iNotes">IBM Lotus Notes</a> databases. In 2019 Lotus Notes was acquired by HCL, and since then longevity of support has been wavering. Support will officially die in June 2024. As a result, since 2019, technology teams have been trying to migrate many of our systems to new technologies. The business spent an eye watering amount of money developing a system using IBM Business Process manager to supercede one of these Lotus Notes databases. The anticipation was that <code>D11</code> would be backfilled with all the data from <code>D10</code>, once fully built, and <code>D10</code> would be archived.</p>

<p>It’s now 2023:</p>

<ul>
  <li>We are 8 months away from official support dying.</li>
  <li>Technology teams have thrown away their support contact for IBM BPM.</li>
  <li>There is no replacement in sight for both IBM BPM and Lotus Notes databases.</li>
  <li>IBM BPM solution is poorly maintained</li>
  <li>IBM BPM solution has numerous issues and doesn’t function as needed</li>
  <li>Solution has been shoehorned into IBM BPM, despite the platform not being fit for purpose
    <ul>
      <li>i.e. while IBM BPM does come with a REST API, this REST API is borderline useless to Technology teams and SMEs
        <ul>
          <li>Some REST calls use javascript encoded as strings</li>
          <li>Others require html embedded in json embedded in xml</li>
          <li>Database tables aren’t queried by name but by GUID.</li>
          <li>There’s no documentation of which GUID relates to which table/process.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>The data from <code>D10</code> was never actually transferred to <code>D11</code>, meaning the business is now using 2 systems instead of 1.
    <ul>
      <li><code>D11</code> data model doesn’t really support the data in <code>D10</code> either.</li>
    </ul>
  </li>
  <li>Technology teams appear to be ignoring waning support contracts.
    <ul>
      <li>This could be due to lack of resources, finances and/or priority.</li>
    </ul>
  </li>
</ul>

<p>SME’s use these tools on a daily basis, and ultimately it is SME’s who determine changes that need to be made to the system. If SMEs use VBA, they can control and maintain the system as needed. They have a maintenance guarantee, something that should be said for IT systems too, but can’t be.</p>

<h2 id="the-control-of-vba">The control of VBA</h2>

<p>In a recent project we are building a new all encompassing IT system to supercede a business critical spreadsheet. This would ultimately demote <code>D6</code> to C tier importance. The spec for this system was initially simple - Give us a NodeJS server with a MySQL database. Use React for the UI. Give admins/SMEs (subject matter experts) access to the codebase with access to git for code control. IT and SMEs will collaborate to build the system.</p>

<ul>
  <li>Technology teams <strong>demanded</strong> that admins/SMEs will not have access to the code.</li>
  <li>Technology teams <strong>demanded</strong> that FrontEnd be built in Microsoft PowerApps, to comply with “Strategic Vision”.</li>
  <li>Technology teams <strong>demanded</strong> that BackEnd be built in Microsoft Azure Pipelines, to comply with “Strategic Vision”.</li>
</ul>

<p>Unfortunately, as an admin/SME with more development knowledge than many people in technology, these demands do not sit well with me:</p>

<ul>
  <li>Technology teams do not understand work in the teams thus do not understand business logic and calculations
    <ul>
      <li>Thus devs writing business logic is error prone.</li>
    </ul>
  </li>
  <li>Technology teams has frequently abandoned bespoke technology projects, leaving no resource to maintain and improve the system.
    <ul>
      <li>Collaboration with SMEs will ensure that at least 1 team maintains resource to maintain system.</li>
    </ul>
  </li>
  <li>SMEs need to ensure that they have confidence in what is produced.
    <ul>
      <li>How, without observing that the code doesn’t work for all edge cases?
        <ul>
          <li>Unit tests?
            <ul>
              <li>Perhaps, but without seeing the code how can we verify these unit tests exist? And are ran frequently*.</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>SMEs improve and maintain the existing legacy system, and have unparalleled knowledge of how systems interact.
    <ul>
      <li>Less knowledge can be shared in upskilling Technology teams where it is required.</li>
    </ul>
  </li>
  <li>SMEs need to ensure all data is transferred and represented correctly in new system.
    <ul>
      <li>SMEs unable to do this without backend access.</li>
    </ul>
  </li>
</ul>

<p>Ultimately, as long as code stays in VBA it is controlled by the SMEs and the business. Technology teams rarely relinquish control to business teams. SMEs can ensure that software is developed properly in a modular fashion and doesn’t end up as a cluster of barely working technologies loosely linked together.</p>

<h2 id="the-ux-of-vba">The UX of VBA</h2>

<p>This is a smaller one, because you can always make familiar feeling tools in any language, but there is something to be said about the fact that most engineers use spreadsheets in their day job, and how VBA is embedded within these spreadsheets and can improve on UX. Giving someone a foreign tool in a familiar environment, is often much more powerful to that user, than a foreign tool in a foreign environment.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In conclusion, yes, we (and many others in businesses) do choose to use spreadsheets (and VBA) for many tasks within our organisations, there are many reasons for this, including:</p>

<ul>
  <li>Poor alternatives provided by IT due to security concerns.</li>
  <li>Poor connectivity of alternatives to source systems, usually because they are still WIP.</li>
  <li>Faults in IT strategy which don’t account for certain use-cases.</li>
  <li>Unwillingness to collaborate with SMEs due to security and maintenance concerns.</li>
  <li>Lack of training for users/managers/SMEs in alternative systems.</li>
  <li>Users/SMEs wanting some level of control over the business logic in these systems.</li>
  <li>It’s the only viable technology which is available to everyone, as it’s part of Office.</li>
</ul>

<p>This does not mean that we are at all blind to VBA’s weaknesses though:</p>

<ul>
  <li><a href="https://sancarn.github.io/vba-articles/why-is-vba-most-dreaded.html">Why is VBA most dreaded?</a></li>
  <li><a href="https://sancarn.github.io/vba-articles/issues-with-vba.html">What is wrong with VBA?</a></li>
</ul>

<p>There’s no doubt in my mind that there are some elements of truth to <a href="https://ludic.mataroa.blog/blog/your-organization-probably-doesnt-want-to-improve-things/">mataroa’s article</a>. Sometimes management is poor, but more often than not I believe most people in organisations are trying to do the right thing, and are doing whatever they can with the tools that are available to them.</p>


  

<h2> Authors </h2>

<p><a href="https://github.com/Sancarn"><img src="https://github.com/Sancarn.png?size=40"/></a>
  
</p>



  
</article></div>
  </body>
</html>
