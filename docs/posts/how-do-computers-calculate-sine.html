<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://androidcalculator.com/how-do-calculators-compute-sine/">Original</a>
    <h1>How do computers calculate sine?</h1>
    
    <div id="readability-page-1" class="page"><div>
					
<h2>Introduction</h2>









<p>Sine, one of the fundamental trigonometric functions, plays a crucial role in various fields, including mathematics, physics, engineering, and computer science. Its calculation is not trivial, especially when it comes to implementing it in electronic calculators, where efficiency and accuracy are paramount.</p>



<p>In previous entries of the series, we looked into <a href="https://androidcalculator.com/how-do-calculators-solve-equations">how calculators solve equations</a> and <a href="https://androidcalculator.com/how-does-a-calculator-computes-square-roots">how they calculate square roots</a>. In this blog post, we’ll delve into the intricate process of calculating the sine function, starting from simple approximations to more sophisticated methods.</p>



<h2>How sine is calculated</h2>



<p>To begin, let’s inspect the plot of the sine function:</p>



<div><figure><a href="https://androidcalculator.com/wp-content/uploads/2024/03/sin-2.svg"><img src="https://androidcalculator.com/wp-content/uploads/2024/03/sin-2.svg" alt="" width="538" height="195"/></a></figure></div>



<p>It is immediately obvious, that the function is periodic, and has a strong symmetry of the interval between 0 and $\pi/2$:</p>



<div><figure><a href="https://androidcalculator.com/wp-content/uploads/2024/03/sin_period.svg"><img src="https://androidcalculator.com/wp-content/uploads/2024/03/sin_period.svg" alt="" width="538" height="195"/></a></figure></div>



<p>In other words, it is enough to calculate the function on the interval $[0;\pi/2]$. Then, we can just use flipping and negation to get the final value. To calculate $\sin(x)$ within the reduced interval, one option is to use the well-known <a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor series</a> approximation:</p>



<div><figure><a href="https://androidcalculator.com/wp-content/uploads/2024/03/taylor.svg"><img src="https://androidcalculator.com/wp-content/uploads/2024/03/taylor.svg" alt="" width="538" height="195"/></a><figcaption>The sine function and its Taylor series up to the ninth degree</figcaption></figure></div>



<p>While this method is simple, we need to calculate very high exponentials, and the approximation errors can get quite large around $\pi/2$. For example, with a nine-degree approximation, the result at $ \pi/2 $ would be 1.00000354258428. This is an error of 3e-6, which is quite bad, since most calculations are done to 15 digits precision. In other words, that’s a loss of precision around 10 digits!</p>



<h2>How sine is really calculated</h2>



<p>While the method presented in the previous paragraph is quite bad, it does serve as a blueprint for better methods. Essentially, every implementation of sine uses the following three steps:</p>



<ol>
<li>
<strong>Reduction:</strong> Using some algebraic tricks, reduce $x$ to a small number $r$.</li>
<li>
<strong>Approximation:</strong> Calculate the value of $\sin(r)$ using an approximation method, such as the Taylor series.</li>
<li>
<strong>Reconstruction:</strong> Calculate the final value of $\sin(x)$ based on $\sin(r)$.</li>
</ol>



<p>There are many ways to approach this problem. In the following , I present what Intel uses in their processors, based on their <a href="https://www.cl.cam.ac.uk/~jrh13/papers/itj.pdf">paper</a>. They start with the formula</p>



<p>$$\displaylines{\sin(x)=\sin\left(r+N\frac{\pi}{16}\right)=\sin\left(N\frac{\pi}{16}\right)\cos(r)+\cos\left(N\frac{\pi}{16}\right)\sin(r)=\\=\sin\left(\frac{N}{32}2\pi\right)\cos(r)+\cos\left(\frac{N}{32}2\pi\right)\sin(r)}$$</p>



<p>We have to calculate $\sin(r)$ and $\cos(r)$ – this is the approximation step, more on this later. For now, assume we know both $\sin(r)$ and $\cos(r)$. We still have to find the sine and cosine of $\frac{N}{32}2\pi$. Notice, that both $\sin$ and $\cos$ are periodic by $2\pi$, so we only really have to calculate $N$ for $N=0,1,2,\ldots,31$. These are 32 values in total, we can easily precompute them. During the calculation of the final value, we just have to look up them up from a list, which is quite efficient.</p>



<p>Only one piece of the puzzle remains: how to calculate $\sin(r)$? In the paper, Intel does not publish the exact polynomial but they do mention that they use minimax approximation. This approximation finds a polynomial that minimizes the maximum error over an interval:</p>



<h2>Conclusion</h2>



<p>In conclusion, calculating sine in computers involves a combination of reduction, approximation, and reconstruction steps. From simple reduction and Taylor series to more precise methods like minimax approximation, computers employ various techniques to compute sine efficiently while maintaining acceptable levels of accuracy. Understanding these methods sheds light on the underlying mathematics that power computational tools and simulations in numerous fields.</p>
	
                </div></div>
  </body>
</html>
