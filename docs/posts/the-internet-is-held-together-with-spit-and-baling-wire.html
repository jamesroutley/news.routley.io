<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://krebsonsecurity.com/2021/11/the-internet-is-held-together-with-spit-baling-wire/">Original</a>
    
    <div id="readability-page-1" class="page"><div>
												<div id="attachment_57711"><p><img aria-describedby="caption-attachment-57711" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2021/11/blyon-netmap.png" alt="" width="915" height="704" srcset="https://krebsonsecurity.com/wp-content/uploads/2021/11/blyon-netmap.png 915w, https://krebsonsecurity.com/wp-content/uploads/2021/11/blyon-netmap-768x591.png 768w, https://krebsonsecurity.com/wp-content/uploads/2021/11/blyon-netmap-782x602.png 782w" sizes="(max-width: 915px) 100vw, 915px"/></p><p id="caption-attachment-57711">A visualization of the Internet made using network routing data. Image: Barrett Lyon, opte.org.</p></div>
<p>Imagine being able to disconnect or redirect Internet traffic destined for some of the world’s biggest companies — just by spoofing an email. This is the nature of a threat vector recently removed by a Fortune 500 firm that operates one of the largest Internet backbones.</p>
<p>Based in Monroe, La., <strong>Lumen Technologies Inc.</strong> [<a href="https://www.google.com/finance/quote/LUMN:NYSE" target="_blank" rel="noopener">NYSE: LUMN</a>] (formerly <strong>CenturyLink</strong>) is one of more than two dozen entities that operate what’s known as an <a href="http://www.irr.net/docs/list.html" target="_blank" rel="noopener">Internet Routing Registry</a> (IRR). These IRRs maintain routing databases used by network operators to register their assigned network resources — i.e., the Internet addresses that have been allocated to their organization.</p>
<p>The data maintained by the IRRs help keep track of which organizations have the right to access what Internet address space in the global routing system. Collectively, the information voluntarily submitted to the IRRs forms a distributed database of Internet routing instructions that helps connect a vast array of individual networks.</p>
<p>There are about 70,000 distinct networks on the Internet today, ranging from huge broadband providers like <strong>AT&amp;T</strong>, <strong>Comcast</strong> and <strong>Verizon</strong> to many thousands of enterprises that connect to the edge of the Internet for access. Each of these so-called “Autonomous Systems” (ASes) make their own decisions about how and with whom they will connect to the larger Internet.</p>
<p>Regardless of how they get online, each AS uses the same language to specify which Internet IP address ranges they control: It’s called the <strong>Border Gateway Protocol</strong>, or BGP. Using BGP, an AS tells its directly connected neighbor AS(es) the addresses that it can reach. That neighbor in turn passes the information on to its neighbors, and so on, until the information has propagated everywhere [1].</p>
<p>A key function of the BGP data maintained by IRRs is preventing rogue network operators from claiming another network’s addresses and hijacking their traffic. In essence, an organization can use IRRs to declare to the rest of the Internet, “These specific Internet address ranges are ours, should only originate from our network, and you should ignore any other networks trying to lay claim to these address ranges.”</p>
<p>In the early days of the Internet, when organizations wanted to update their records with an IRR, the changes usually involved some amount of human interaction — often someone manually editing the new coordinates into an Internet backbone router. But over the years the various IRRs made it easier to automate this process via email.</p>
<p>For a long time, any changes to an organization’s routing information with an IRR could be processed via email as long as one of the following authentication methods was successfully used:</p>
<blockquote><p><strong>-CRYPT-PW:</strong> A password is added to the text of an email to the IRR containing the record they wish to add, change or delete (the IRR then compares that password to a hash of the password);</p>
<p><strong>-PGPKEY:</strong> The requestor signs the email containing the update with an encryption key the IRR recognizes;</p>
<p><strong>-MAIL-FROM:</strong> The requestor sends the record changes in an email to the IRR, and the authentication is based solely on the “From:” header of the email.</p></blockquote>
<p>Of these, MAIL-FROM has long been considered insecure, for the simple reason that it’s not difficult to spoof the return address of an email. And virtually all IRRs have disallowed its use since at least 2012, said <strong>Adam Korab</strong>, a network engineer and security researcher based in Houston.</p>
<p>All except <a href="https://en.wikipedia.org/wiki/Level_3_Communications" target="_blank" rel="noopener">Level 3 Communications</a>, a major Internet backbone provider acquired by Lumen/CenturyLink.</p>
<p>“LEVEL 3 is the last IRR operator which allows the use of this method, although they have discouraged its use since at least 2012,” Korab told KrebsOnSecurity. “Other IRR operators have fully deprecated MAIL-FROM.”</p>
<p>Importantly, the name and email address of each Autonomous System’s official contact for making updates with the IRRs is public information.</p>
<p>Korab filed a vulnerability report with Lumen demonstrating how a simple spoofed email could be used to disrupt Internet service for banks, telecommunications firms and even government entities.</p>
<p><span>“If such an attack were successful, it would result in customer IP address blocks being filtered and dropped, making them unreachable from some or all of the global Internet,” Korab said</span>, noting that he found more than 2,000 Lumen customers were potentially affected. “This would effectively cut off Internet access for the impacted IP address blocks.”</p>
<p>The recent outage that took <strong>Facebook</strong>, <strong>Instagram</strong> and <strong>WhatsApp</strong> offline for the better part of a day was caused by <a href="https://krebsonsecurity.com/2021/10/what-happened-to-facebook-instagram-whatsapp/" target="_blank" rel="noopener">an erroneous BGP update submitted by Facebook</a>. That update took away the map telling the world’s computers how to find its various online properties.</p>
<p>Now consider the mayhem that would ensue if someone spoofed IRR updates to remove or alter routing entries for multiple e-commerce providers, banks and telecommunications companies at the same time.</p>
<p>“Depending on the scope of an attack, this could impact individual customers, geographic market areas, or potentially the [Lumen] backbone,” Korab continued. “This attack is trivial to exploit, and has a difficult recovery. Our conjecture is that any impacted Lumen or customer IP address blocks would be offline for 24-48 hours. In the worst-case scenario, this could extend much longer.”</p>
<p>Lumen told KrebsOnSecurity that it continued offering MAIL-FROM: authentication because many of its customers still relied on it due to legacy systems. Nevertheless, after receiving Korab’s report the company decided the wisest course of action was to disable MAIL-FROM: authentication altogether.</p>
<p>“We recently received notice of a known insecure configuration with our Route Registry,” reads a statement Lumen shared with KrebsOnSecurity. “We already had mitigating controls in place and to date we have not identified any additional issues. As part of our normal cybersecurity protocol, we carefully considered this notice and took steps to further mitigate any potential risks the vulnerability may have created for our customers or systems.”</p>
<div id="attachment_57733"><p><img aria-describedby="caption-attachment-57733" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2021/11/level3-mailfrom.png" alt="" width="763" height="315" srcset="https://krebsonsecurity.com/wp-content/uploads/2021/11/level3-mailfrom.png 1306w, https://krebsonsecurity.com/wp-content/uploads/2021/11/level3-mailfrom-768x317.png 768w, https://krebsonsecurity.com/wp-content/uploads/2021/11/level3-mailfrom-782x323.png 782w" sizes="(max-width: 763px) 100vw, 763px"/></p><p id="caption-attachment-57733">Level3, now part of Lumen, has long urged customers to avoid using “Mail From” for authentication, but until very recently they still allowed it.</p></div>

<p><strong>KC Claffy </strong>is the founder and director of the <a href="https://www.caida.org" target="_blank" rel="noopener">Center for Applied Internet Data Analysis</a> (CAIDA), and a resident research scientist of the San Diego Supercomputer Center at the University of California, San Diego. Claffy said there is scant public evidence of a threat actor using the weakness now fixed by Lumen to hijack Internet routes.</p>
<p>“People often don’t notice, and a malicious actor certainly works to achieve this,” Claffy said in an email to KrebsOnSecurity. “But also, if a victim does notice, they generally aren’t going to release details that they’ve been hijacked. This is why we need mandatory reporting of such breaches, as <a href="https://en.wikipedia.org/wiki/Dan_Geer" target="_blank" rel="noopener">Dan Geer</a> <a href="http://geer.tinho.net/geer.blackhat.6viii14.txt" target="_blank" rel="noopener">has been saying for years</a>.”</p>
<p>But there are <a href="https://krebsonsecurity.com/2018/07/notorious-hijack-factory-shunned-from-web/" target="_blank" rel="noopener">plenty of</a> <a href="https://krebsonsecurity.com/2011/02/spammers-hijack-internet-space-assigned-to-egyptian-presidents-wife/" target="_blank" rel="noopener">examples</a> of cybercriminals hijacking IP address blocks after a domain name associated with an email address in an IRR record has expired. In those cases, the thieves simply register the expired domain and then send email from it to an IRR specifying any route changes.</p>
<p>While it’s nice that Lumen is no longer the weakest link in the IRR chain, the remaining authentication mechanisms aren’t great. Claffy said after years of debate over approaches to improving routing security, the operator community deployed an alternative known as the <a href="https://en.wikipedia.org/wiki/Resource_Public_Key_Infrastructure" target="_blank" rel="noopener">Resource Public Key Infrastructure</a> (RPKI).</p>
<p>“The RPKI includes cryptographic attestation of records, including expiration dates, with each Regional Internet Registry (RIR) operating as a ‘root’ of trust,” wrote Claffy and two other UC San Diego researchers in a paper that is still undergoing peer review. “Similar to the IRR, operators can use the RPKI to discard routing messages that do not pass origin validation checks.”</p>
<p>However, the additional integrity RPKI brings also comes with a fair amount of added complexity and cost, the researchers found.</p>
<p>“Operational and <a href="https://scholarship.law.upenn.edu/cgi/viewcontent.cgi?article=3037&amp;context=faculty_scholarship" target="_blank" rel="noopener">legal implications of potential malfunctions</a> have limited registration in and use of the RPKI,” the study observed (link added). “In response, some networks have redoubled their efforts to improve the accuracy of IRR registration data. These two technologies are now operating in parallel, along with the option of doing nothing at all to validate routes.”</p>
<p>[1]: I borrowed some descriptive text in the 5th and 6th paragraphs from a CAIDA/UCSD draft paper — <a href="https://www.caida.org/catalog/papers/2021_irr_hygiene_rpki_era/irr_hygiene_rpki_era.pdf" target="_blank" rel="noopener">IRR Hygiene in the RPKI Era</a> (PDF).</p>
<p>Further reading:</p>
<p><a href="https://www.caida.org/catalog/papers/2021_trust_zones_jip/trust_zones_jip.pdf" target="_blank" rel="noopener">Trust Zones: A Path to a More Secure Internet Infrastructure</a> (PDF).</p>
<p><a href="https://people.csail.mit.edu/ctestart/publications/BGPhist.pdf" target="_blank" rel="noopener">Reviewing a historical Internet vulnerability: Why isn’t BGP more secure and what can we do about it?</a> (PDF)</p>
											</div></div>
  </body>
</html>
