<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://security.stackexchange.com/questions/257417/how-did-this-paypal-spoof-email-pass-spf-dkim-and-dmarc">Original</a>
    
    <div id="readability-page-1" class="page"><div itemprop="text">
                
<p>This mail that got through has me stumped.  It appeared to me as being from <code>PayPal &lt;unclaimedproperty@paypal.com&gt;</code> in my Inbox.  I happened to look at the original and it says SPF, DKIM and DMARC all passed.</p>
<p>If I&#39;m reading this right, <code>74.112.67.243</code> connected to <code>mail2550.paypal-notification.com</code> and sent the mail.  They used a <code>Return-Path: &lt;blahblah@bounce.paypal.mkt2944.com&gt;</code>.</p>
<p><code>bounce.paypal.mkt2944.com</code> (currently) has a SPF record of <code>v=spf1 a ip4:208.85.50.137 ip4:74.112.67.243 -all</code>.  So OK, they setup a spam mailer and worked it so SPF passes (the mail server <code>paypal-notification.com</code> is gone, seemingly owned by MarkMonitor now, so somebody else noticed this).</p>
<p>But then the DKIM signature has</p>
<pre><code>DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; s=spop1024; d=paypal.com; h=Date:From:Reply-To:To:Message-ID:Subject:MIME-Version:Content-Type: X-CSA-Complaints:List-Unsubscribe;
</code></pre>
<p>Is this not saying &#34;I&#39;m signing all these headers with the key who&#39;s public portion is in a TXT record at <code>spop1024._domainkey.paypal.com</code>&#34; (which exists)?</p>
<p>This passes, to my surprise</p>
<pre><code>Authentication-Results: mx.google.com;
       dkim=pass
</code></pre>
<p>I&#39;ve looked over and over to see if it&#39;s a close-cousin typo thing, or unicode address, etc.  But it really seems to be signed by that <code>paypal.com</code> key...?</p>
<p>After that, it&#39;s still unclear to me why DMARC then passes -- I thought the <code>From:</code> address had to be &#34;aligned&#34; with the <code>Return-Path:</code>?</p>
<pre><code>Delivered-To: &lt;me@gmail.com&gt;
Received: by 2002:a4a:804a:0:0:0:0:0 with SMTP id y10csp7519296oof;
        Mon, 22 Nov 2021 12:45:16 -0800 (PST)
X-Google-Smtp-Source: ABdhPJyxHoL8oksdcw38NnmHlTdPo1UfJoTCZ/wFDToSgMfRPG6WgHlKDtKbSjMXNh5t44nHazym
X-Received: by 2002:a25:4543:: with SMTP id s64mr27510605yba.304.1637613916462;
        Mon, 22 Nov 2021 12:45:16 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1637613916; cv=none;
        d=google.com; s=arc-20160816;
        b=OvsnJASmnJT63M3MSQlcKCnmxHpmorUbQJk3lIVXRyjM6CXvrRuJ2J1TDvDEOlt3lu
         EzKQHgL++dswppXvJFLxkPxHq8cwPy4JBpvYmk1y1kqcuAE+tB2UJjjm+g2Fv1akRO9N
         iie60J6CAhOYz+6w/1bnJ7K0AIVdy9OKVTt1KECqGLzrB7/HFtPZ5i/BFObcP9tC53Ok
         ULyOlVLCM+iLNvmS9xFfz1YAzR+TDj5/OKUxdT0N96Ut+sVScBF2heLQvceZPv5nw9j0
         VCQjSS/e38koGlh+14We/6o74OHuGkF+pwgaRwfiW3hZtOx0echGxgMUMKB+E+bpV0JB
         PvhQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=list-unsubscribe:mime-version:subject:message-id:to:reply-to:from
         :date:dkim-signature;
        bh=CXo6gpd99q61PdtNQYL0HweNp45DQK9gDadq1QHszOQ=;
        b=AndF29ToqFkXaC88xiijwW2WKaK/3o+FURvx6HVtLghatUDEyVEr4VymEzez9Ijtrf
         Jogh9LH/sqLdrLTBN3oVgNoQlGUrf131M5aK5wrf18hCk54LrIHW1v1BA8Gsl4cO7PZ2
         I+kgLQJY+85mIA1L/NZXKvViNlehHXTjwQCHtnfcdWCuIbrb7OTpDu3SW1kFQ+Wjy6Xt
         Jnm/LXZyT6bexBCXJsISEywM8EwuyD7uz0Rm7O+Pw+AU1pYVt2qArFk2hRHiXeTrB57I
         Yp6n2JM79y420UIVv9o/oPJloQcFdnp45sDxv85tr6DhZpvHlH3v3o3doiy2kC6vaBQU
         aXkQ==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass header.i=@paypal.com header.s=spop1024 header.b=NSAupQiY;
       spf=pass (google.com: domain of v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com designates 74.112.67.243 as permitted sender) smtp.mailfrom=v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com;
       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=paypal.com
Return-Path: &lt;v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com&gt;
Received: from mail2550.paypal-notification.com ([74.112.67.243])
        by mx.google.com with ESMTPS id n184si7359975ybn.210.2021.11.22.12.45.16
        for &lt;me@gmail.com&gt;
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Mon, 22 Nov 2021 12:45:16 -0800 (PST)
Received-SPF: pass (google.com: domain of v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com designates 74.112.67.243 as permitted sender) client-ip=74.112.67.243;
Authentication-Results: mx.google.com;
       dkim=pass header.i=@paypal.com header.s=spop1024 header.b=NSAupQiY;
       spf=pass (google.com: domain of v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com designates 74.112.67.243 as permitted sender) smtp.mailfrom=v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com;
       dmarc=pass (p=REJECT sp=REJECT dis=NONE) header.from=paypal.com
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; s=spop1024; d=paypal.com; h=Date:From:Reply-To:To:Message-ID:Subject:MIME-Version:Content-Type: X-CSA-Complaints:List-Unsubscribe; i=unclaimedproperty@paypal.com; bh=CXo6gpd99q61PdtNQYL0HweNp45DQK9gDadq1QHszOQ=; b=NSAupQiYb884cGVqugiXkhz/FlcoddCqXJLcD+gwE2xFNP+27ZRQFCGOL61uEai1EdgqXLS0FKSV
   1ttmHVRu1H/So/7kxAm93NuGJGDe0K5/t9LK3QQF1bTQv7OHjBOi3FhmFvhSs1roN2q4r+8FxhmR
   HBqxI9Sbw63gjSDL7C8=
Received: by mail2550.paypal-notification.com id hjg0lo2r7aoj for &lt;me@gmail.com&gt;; Mon, 22 Nov 2021 20:37:22 +0000 (envelope-from &lt;v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com&gt;)
Date: Mon, 22 Nov 2021 20:37:22 +0000 (GMT)
From: PayPal &lt;unclaimedproperty@paypal.com&gt;
Reply-To: unclaimedproperty@paypal.com
To: me@gmail.com
Message-ID: &lt;432115452.269147071637613442797.JavaMail.app@rbg41.atlis1&gt;
Subject: Notice of Unclaimed PayPal Funds
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary=&#34;----=_Part_1300052_1672151020.1637613438245&#34;
x-mid: 70903810
X-CSA-Complaints: csa-complaints@eco.de
x-rpcampaign: sp70903810
x-job: 70903810
x-orgId: 35487
List-Unsubscribe: &lt;http://links.paypal.mkt2944.com/luoo/v1/...&gt;, &lt;mailto:v-edjoiac_ibeieokafk_iekbmfgb_iekbmfgb_a@bounce.paypal.mkt2944.com?subject=Unsubscribe&gt;
</code></pre>
<p>Am I missing something obvious?!</p>
<p><em>update</em></p>
<p>It really does seem to pass DKIM.</p>
<pre><code>$ opendkim-testmsg &lt; Notice\ of\ Unclaimed\ PayPal\ Funds.eml
$ echo $?
0
</code></pre>
<p><em>update 2</em></p>
<p>Almost definitely a compromise of/via <a href="https://www.acoustic.com/" rel="noreferrer">Acoustic</a>, which was apparently once called &#34;silverpop&#34;</p>
<blockquote>
<p>We&#39;re 10-year Acoustic Campaign veterans - original beta testers and
daily users of the marketing automation tool for the last decade,
since it was called Silverpop and then IBM Watson Campaign Automation.</p>
</blockquote>
<p>The DKIM key -- <code>spop1024._domainkey.paypal.com</code>, from googling, refers to &#34;silverpop 1024&#34; (here&#39;s Wikimedia getting rid of it <a href="https://phabricator.wikimedia.org/T214525" rel="noreferrer">https://phabricator.wikimedia.org/T214525</a>).  This is a legitimate key, but old.  The classic &#34;it&#39;s an older code, Sir, but it checks out&#34; attack with a forgotten host, maybe?</p>
<p><code>74.112.67.243</code> is owned by &#34;acoustic.co&#34;.  It sent the message and signed it.  Not sure where the <code>mail2550.paypal-notification.com</code> bit comes from, it&#39;s now owned by MarkMonitor.</p>
<p>Also, the <code>List-Unsubscribe: &lt;http://links.paypal.mkt2944.com/luoo/v1/...&gt;</code> link seems legitimate.  <a href="http://links.paypal.mkt2944.com" rel="noreferrer">http://links.paypal.mkt2944.com</a> still has some landing page branded with silverpop.  This suggests to me the service actually &#34;constructed&#34; this mail, rather than say an plain open-relay situation.</p>
<p>As noted below, this does not include any obvious phishing login links.  The idea must be that you log into your account legitimately, and can&#39;t find your &#34;unclaimed funds&#34; and call the phone number at the bottom of the email with your &#34;client id&#34;.</p>
<p>This PayPal account is actually closed, but was registered in California when I lived there (this fact, and that it made it into my inbox, was what got me looking at it closely).  &#34;Send this message to old accounts in California&#34; seems like the type of thing this Acoustic marketing mail stuff does, so maybe that is related.</p>
<p>Dastardly ... I wonder how many hits they got from this ...</p>
    </div></div>
  </body>
</html>
