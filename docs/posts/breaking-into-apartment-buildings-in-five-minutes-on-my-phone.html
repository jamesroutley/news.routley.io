<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/">Original</a>
    <h1>Breaking into apartment buildings in five minutes on my phone</h1>
    
    <div id="readability-page-1" class="page"><div id="quarto-content">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main id="quarto-document-content">





<section id="background">
<h3 data-anchor-id="background">Background</h3>
<p>A few months ago I was on my way to catch the <a href="https://www.instagram.com/seabusmemes/?hl=en">SeaBus</a> when I walked by an apartment building with an interesting looking access control panel. I wrote down the “MESH by Viscount” brand name and made a note to look into it when I had a chance. I ended up just missing my ferry (the 30 minute Sunday headways are brutal), so I decided to see if I could find anything promising on my phone while waiting at Waterfront for the next boat.</p>
</section>
<section id="part-0-recon">
<h3 data-anchor-id="part-0-recon">Part 0: Recon</h3>
<p>Googling the name of the system brings up a sales page advertising “TCP/IP capability to remotely program and maintain the system.” That sounds promising, so let’s try to find a manual. <code>&#34;mesh by viscount&#34; filetype:pdf</code> gets us an <a href="https://files.identiv.com/products/telephone-entry/common/Enterphone_MESH_Installation_Guide.pdf">installation guide</a>. Page 4 explains how to log in to the system’s web UI:</p>
<div>
<figure>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/manual.png"/></p>
</figure>
</div>
<p>Default credentials that “should” be changed, with no requirement or explanation of how to do so. Surely no building managers ever leave the defaults, right? And even if they did, they’d surely have no reason to expose this thing to the Internet, right?</p>
<p>The screenshot from the manual tells us the web UI login page’s title is “FREEDOM Administration Login”, which gives us something to search for.</p>
<div>
<figure>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/google.png"/></p>
</figure>
</div>
<p>Oh no.</p>
</section>
<section id="part-1-pii-galore">
<h3 data-anchor-id="part-1-pii-galore">Part 1: PII galore</h3>
<p>Exposing the panel to the Internet is dumb, but fortunately none of these systems were accessible using the def– just kidding. The <em>very first result</em> happily lets me in with the <code>freedom:viscount</code> login. The first interesting thing here is the Users section:</p>
<div>
<figure>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/users_censored.png"/></p>
</figure>
</div>
<p>This maps residents’ full names to their unit numbers. The building address is also used as the Site title. That’s already not great, but it’s worse in conjunction with the Events section:</p>
<div>
<figure>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/events_censored.png"/></p>
</figure>
</div>
<p>This is a multi-year log of every time a fob associated with a certain suite number accessed an entrance or an elevator. So we can now easily determine that, say, Jon Snow of Unit 999, 123 Bear St Vancouver BC comes home every day at 6pm.</p>
<p>For good measure, there’s also a Users section which exposes every resident’s phone number.</p>
</section>
<section id="part-2-breaking-in">
<h3 data-anchor-id="part-2-breaking-in">Part 2: Breaking in</h3>
<p>The PII leaks are pretty wild, but the most interesting thing we have access to is the Controlled Areas section. In here I can apparently register new access fobs, disable existing ones, and change the floors they’re authorized for. The system for this is somewhat convoluted. Fortunately I don’t need to understand it at all, because I can just unlock any entrance I want through an override function:</p>
<div>
<figure>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/override.png"/></p>
</figure>
</div>
<p>So I can break into this building in about 5 minutes without attracting any attention whatsoever. Neat.</p>
</section>
<section id="part-3-how-widespread-is-this">
<h3 data-anchor-id="part-3-how-widespread-is-this">Part 3: How widespread is this?</h3>
<p>Maybe I just got lucky that the default credentials worked on the first result and this is actually really rare. Let’s get back to a desktop and scan more properly with ZoomEye:</p>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/zoomeye.png"/></p>
<p>That’s not a good sign. ZoomEye kindly offers to let me download a CSV of the results for 700 ZoomPoints. I have no idea what a ZoomPoint is nor how I ended up with 2000 of them, but this seems as good a use as any. With all the hosts in hand, let’s put together a quick Nuclei template:</p>
<pre><code>id: mesh-default-login
info:
  name: MESH By Viscount
  author: Eric Daigle
  severity: high
  description: |
    MESH By Viscount default credentials were discovered.
http:
  - method: POST
  redirects: false
  path:
    - &#34;{{BaseURL}}/mesh/servlet/mesh.webadmin.MESHAdminServlet?requestedAction=login&#34;
  headers:
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
    Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7
    Cache-Control: max-age=0
    Content-Type: application/x-www-form-urlencoded
    Cookie: MESHWebAdminLanguage=en; MESHWebAdminRefreshInterval=0;
    MESHWebAdminPageSize=100;
    Connection: keep-alive
  body: &#34;formLoginName=freedom&amp;formLoginPassword=viscount&amp;formLanguage=en&amp;formLogRefreshInterval=0&amp;formPageSize=100&#34;
  matchers:
    - type: word
      part: body
      words:
        - &#39;Login Failed. Invalid username or password.&#39;
      negative: true</code></pre>
<p>The login behaviour is poorly coded (shocking, I know): it returns 200 whether or not the login was successful. To get around this we use a negative matcher that returns true as long as the “Login Failed” string is not present. The web UI also returns a 301 if the default landing page on successful login has been changed, which we handle as well. Time to send it:</p>
<p><img src="https://www.ericdaigle.ca/posts/breaking-into-dozens-of-apartments-in-five-minutes/nuclei.png"/></p>
<p>In total, Nuclei finds 89 hits, so about 14% of the apartment buildings using this system that have ever exposed it to ZoomEye are vulnerable. But most of those 659 hits were old - of the buildings using this system that have exposed it to ZoomEye in the past year, 43% are vulnerable and have essentially no access control. The large majority (71) of the exposed systems are in Canada, not surprising since 582 out of the 742 ZoomEye hits were Canadian (Nuclei scans fewer targets due to some duplicates).</p>
<p>I’m so glad we have modern IoT technology to keep us safe! It’s crazy to think people used to trust analog locks with physical keys.</p>
</section>
<section id="timeline">
<h3 data-anchor-id="timeline">Timeline</h3>
<ul>
<li>2024-12-20: vulnerability discovered</li>
<li>2024-12-27: Current vendor of MESH identified as Hirsch (subsidiary of Vitaprotech Group) and contacted</li>
<li>2025-01-09: CEO of Identiv, former vendor of MESH, contacted</li>
<li>2025-01-11: Hirsch product security responds requesting details and are asked if they intend to alert clients</li>
<li>2025-01-29: Hirsch replies stating that these vulnerable systems are not following manufacturers’ recommendations to change the default password</li>
<li>2025-01-30: Hirsch asked for an update as to whether clients running vulnerable systems have been alerted (no response as of publication)</li>
<li>2025-02-14: CVE-2025-26793 assigned</li>
<li>2025-02-15: publication</li>
</ul>
</section>
<section id="support">
<h3 data-anchor-id="support">Support</h3>
<p>If you’ve made it this far, consider supporting my work with a small donation on <a href="https://ko-fi.com/edaigle">ko-fi</a>! This site is ad-free, and social-media-free and uses open-source privacy-respecting <a href="https://matomo.org/privacy/">analytics</a>.</p>


</section>

</main> <!-- /main -->

</div></div>
  </body>
</html>
