<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/alonswartz/trackpoint">Original</a>
    <h1>How to integrate a trackpoint in a mechanical keyboard</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">This is a summary of what I needed and learned while integrating a
trackpoint into my <a href="http://www.alonswartz.org/keyboards/blackhawk/" rel="nofollow">custom built hand-wired split mechanical
keyboard</a>. It took quite a lot of research and planning, so I
thought it would be helpful to others to create this guide.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/collage-final.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/collage-final.jpg" alt="final"/></a></p>
<p dir="auto">Before starting this project, the main questions I had were:</p>
<ul dir="auto">
<li>How do I identify the pinout of my trackpoint?</li>
<li>What should I use for the trackpoint stem?</li>
<li>Will I need to ruin my keycaps to make space for the stem?</li>
<li>Can I use the same teensy to power both the keyboard and TP?</li>
<li>Can I use the TP and keyboard mousekeys concurrently?</li>
<li>Should I use busywait, interrupt or usart in TMK?</li>
<li>How do I build the reset circuit?</li>
<li>Will I have enough clearance inside the case?</li>
</ul>
<p dir="auto">There is a lot of useful information scattered around the deskthority
and geekhack forums, and TMK issues, so I&#39;m also including all the
<a href="https://github.com/alonswartz/trackpoint/blob/master/pinouts">pinouts</a> I found during my travels, <a href="https://github.com/alonswartz/trackpoint/blob/master/datasheets">datasheets</a>,
and <a href="#tmk-firmware-changes-and-tweaks">TMK keyboard code tweaks</a>.
(Unfortunately I didn&#39;t take note of where I found the above mentioned
resources, so I can&#39;t give credit where it is due, for that I apologize.
I&#39;ll try retrace my steps, but if you can let me know, I&#39;d be most
welcome).</p>
<p dir="auto">Thanks to hasu for his awesome TMK firmware, and the deskthority and
geekhack communities - if you have posted something to do with a
trackpoint, I&#39;ve read it, and it most likely helped :)</p>
<p dir="auto">Pull requests are welcome, especially new pinouts.</p>
<h2 dir="auto"><a id="user-content-table-of-contents" href="#table-of-contents" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Table of contents</h2>
<ul dir="auto">
<li><a href="#target-audience">Target audience</a></li>
<li><a href="#faq">FAQ</a>
<ul dir="auto">
<li><a href="#q-what-should-i-use-for-the-trackpoint-stem/stick">Q: What should I use for the trackpoint stem/stick?</a></li>
<li><a href="#q-how-do-i-identify-the-trackpoint-pinout">Q: How do I identify the trackpoint pinout?</a></li>
<li><a href="#q-should-i-use-busywait-interrupt-or-usart-in-tmk">Q: Should I use busywait, interrupt or usart in TMK?</a></li>
</ul>
</li>
<li><a href="#what-you-need">What you need</a></li>
<li><a href="#steps">Steps</a>
<ul dir="auto">
<li><a href="#1-solder-leads-to-trackpoint">1. Solder leads to trackpoint</a></li>
<li><a href="#2-create-the-reset-circuit-rc">2. Create the reset circuit (RC)</a></li>
<li><a href="#3-solder-leads-to-reset-circuit-rc">3. Solder leads to reset circuit (RC)</a></li>
<li><a href="#4-testing-on-a-breadboard">4. Testing on a breadboard</a></li>
<li><a href="#5-make-trackpoint-stem-hole-in-case">5. Make trackpoint stem hole in case</a></li>
<li><a href="#6-make-space-for-trackpoint-in-keyboard">6. Make space for trackpoint in keyboard</a></li>
<li><a href="#7-test-trackpoint-clearance-and-stem-length-glue-stem">7. Test trackpoint clearance and stem length, glue stem</a></li>
<li><a href="#8-solder-reset-circuit-rc-to-teensy">8. Solder reset circuit (RC) to teensy</a></li>
<li><a href="#9-finish-up">9. Finish up</a></li>
<li><a href="#10-update-tmk_keyboard-firmware-and-flash">10. Update tmk_keyboard firmware and flash</a></li>
</ul>
</li>
<li><a href="#tmk-firmware-changes-and-tweaks">TMK firmware changes and tweaks</a></li>
</ul>
<h2 dir="auto"><a id="user-content-target-audience" href="#target-audience" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Target audience</h2>
<p dir="auto">It&#39;s hard to cover every use-case, keyboard and firmware so I&#39;m limiting
this for folks who have a hand-wired mechanical keyboard that uses a
teensy (2.0) with TMK_keyboard firmware, and who want to integrate a
trackpoint for just mouse movement (and take advantage of the keyboard
for mouse keys).</p>
<p dir="auto">That said, the information here should still be useful for others.</p>
<h2 dir="auto"><a id="user-content-faq" href="#faq" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>FAQ</h2>
<h3 dir="auto"><a id="user-content-q-what-should-i-use-for-the-trackpoint-stemstick" href="#q-what-should-i-use-for-the-trackpoint-stemstick" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q: What should I use for the trackpoint stem/stick?</h3>
<p dir="auto"><strong>A labret cheek piercing! (yes, I know, weird, but it&#39;s awesome!)</strong></p>
<ul dir="auto">
<li>Relatively cheap.</li>
<li>Super strong (surgical steel, titanium).</li>
<li>Really thin in diameter (16G is perfect for between keycaps).</li>
<li>They come in different lengths (8mm to 26mm).</li>
<li>They have a flat bottom (great for gluing to TP).</li>
<li>They have a screw on top ball, in different sizes.</li>
</ul>
<p dir="auto">I ordered a few sets of different lengths and different diameters (I
wasn&#39;t sure if 16G would be strong enough - it is), as well as different
ball sizes from ebay for relatively cheap.</p>
<p dir="auto">My trackpoint pointer base sits flush under my 3mm switch plate, and
with a cherry MX switch having a height 10.2mm above the switch plate,
and about 1-2mm PBT cherry keycap on top, the 14mm stem with 3mm ball is
kind of perfect.</p>
<p dir="auto">For extra friction on the ball, I used some sandpaper.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/stem.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/stem.jpg" alt="stem"/></a></p>
<h3 dir="auto"><a id="user-content-q-how-do-i-identify-the-trackpoint-pinout" href="#q-how-do-i-identify-the-trackpoint-pinout" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q: How do I identify the trackpoint pinout?</h3>
<p dir="auto"><strong>With some luck, or a multimeter and a steady hand.</strong>
(A scope would be better, but unfortunately I don&#39;t have one).</p>
<p dir="auto">If you&#39;re lucky, someone has already identified the pinout of the
trackpoint you have (see <a href="https://github.com/alonswartz/trackpoint/blob/master/pinouts">pinouts</a>), or at least a similar one.</p>
<p dir="auto">If not, you&#39;ll need to identify the pinout yourself, here are some tips:</p>
<ul dir="auto">
<li>The largest tracer is most likely GND.</li>
<li>The second largest tracer is most likely VCC.</li>
<li>Using a multimeter and the PTPM754 <a href="https://github.com/alonswartz/trackpoint/blob/master/datasheets">datasheet</a>, test for
connectivity:</li>
</ul>
<div data-snippet-clipboard-copy-content="CLK (INT0)    - PTPM754 pin 24
DATA (TXD/1)  - PTPM754 pin 2
RST           - PTPM754 pin 5
GND           - PTPM754 pin 8
VCC           - PTPM754 pin 22"><pre><code>CLK (INT0)    - PTPM754 pin 24
DATA (TXD/1)  - PTPM754 pin 2
RST           - PTPM754 pin 5
GND           - PTPM754 pin 8
VCC           - PTPM754 pin 22
</code></pre></div>
<ul dir="auto">
<li>Alternatively, if you have a scope and know what you&#39;re doing:</li>
</ul>
<div data-snippet-clipboard-copy-content="CLK  - should have a frequency reading
DATA - should have a 5V reading
RST  - should have a 0V reading"><pre><code>CLK  - should have a frequency reading
DATA - should have a 5V reading
RST  - should have a 0V reading
</code></pre></div>
<h3 dir="auto"><a id="user-content-q-should-i-use-busywait-interrupt-or-usart-in-tmk" href="#q-should-i-use-busywait-interrupt-or-usart-in-tmk" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Q: Should I use busywait, interrupt or usart in TMK?</h3>
<p dir="auto">As far as I know, USART is the recommended implementation, as it uses
hardware for PS/2 signal receive.</p>
<p dir="auto">You will need to use D2 (data) and D5 (clock) on the teensy though.</p>
<h2 dir="auto"><a id="user-content-what-you-need" href="#what-you-need" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What you need</h2>
<ul dir="auto">
<li>
<p dir="auto">Keyboard with at least 6mm clearance between switch and base plates,
depending on the trackpoint module height.</p>
</li>
<li>
<p dir="auto">TMK_keyboard firmware source code and development environment.</p>
</li>
<li>
<p dir="auto">Teensy 2.0 (pins D2 and D5 available for USART).</p>
</li>
<li>
<p dir="auto">Trackpoint module (salvaged from old thinkpad or new tp keyboard).</p>
</li>
<li>
<p dir="auto">Veroboard (for reset circuit).</p>
</li>
<li>
<p dir="auto">Reset circuit components (4.7k resistors x2, 100k resistor, 2.2uF capacitor).</p>
</li>
<li>
<p dir="auto">Stem for trackpoint (labret cheek piercing 16G).</p>
</li>
<li>
<p dir="auto">Double sided tape (for testing stem lengths before gluing).</p>
</li>
<li>
<p dir="auto">Glue (stem to trackpoint, I used Loctite super glue-3)</p>
</li>
<li>
<p dir="auto">Cutting knife (x-acto, nt-cutter, japanese knife, etc.).</p>
</li>
<li>
<p dir="auto">Sandpaper (extra friction to stem ball, smooth veroboard cuts).</p>
</li>
<li>
<p dir="auto">Thin wire (I used wire wrap 30 gauge).</p>
</li>
<li>
<p dir="auto">Wire cutter and stripper.</p>
</li>
<li>
<p dir="auto">PCB drill / thin rounded file (to make a 1.2mm hole).</p>
</li>
<li>
<p dir="auto">Insulation tape (prevent shorts, protect trackpoint circuitry).</p>
</li>
<li>
<p dir="auto">Soldering equipment.</p>
</li>
<li>
<p dir="auto">Multi-meter.</p>
</li>
<li>
<p dir="auto">Patience.</p>
</li>
<li>
<p dir="auto">Bonus: extra teensy and breadboard for testing.</p>
</li>
</ul>
<h2 dir="auto"><a id="user-content-steps" href="#steps" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Steps</h2>
<h3 dir="auto"><a id="user-content-1-solder-leads-to-trackpoint" href="#1-solder-leads-to-trackpoint" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>1. Solder leads to trackpoint</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>Thin wire (I used wire wrap 30 guage wire)</li>
<li>Wire cutter and stripper</li>
<li>Soldering equipment</li>
<li>Bonus: helping hand</li>
</ul>
</li>
<li>
<p dir="auto">Cut and strip 5 leads.</p>
</li>
<li>
<p dir="auto">Clean and tin the trackpoint pads to be soldered.</p>
</li>
<li>
<p dir="auto">Use a helping hand to hold the leads on the tinned pads, and heat the
stripped leads so they solder to the pad.</p>
</li>
</ul>
<h3 dir="auto"><a id="user-content-2-create-the-reset-circuit-rc" href="#2-create-the-reset-circuit-rc" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2. Create the reset circuit (RC)</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>4.7k resistors x2</li>
<li>100k resistor</li>
<li>2.2uF capacitor</li>
<li>Veroboard</li>
<li>Cutting knife (x-acto, nt-cutter, japanese knife, etc.)</li>
<li>Sandpaper</li>
<li>Soldering equipment</li>
<li>Insulation tape</li>
</ul>
</li>
<li>
<p dir="auto">Cut a piece of veroboard (6x5 - the 5 is for rails)</p>
<ul dir="auto">
<li>Using the cutting knife, perform 5-10 cuts on both sides.</li>
<li>Using a little pressure, snap the board on the cut.</li>
<li>Use sandpaper to smooth out the cut edges.</li>
</ul>
</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/veroboard.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/veroboard.jpg" alt="veroboard"/></a></p>
<ul dir="auto">
<li>
<p dir="auto">Place the components on the veroboard, and solder</p>
<ul dir="auto">
<li>
<p dir="auto">Resistors</p>
<ul dir="auto">
<li>Resistors don&#39;t have polarity, no need to worry.</li>
<li>Bend component legs, insert into veroboard.</li>
<li>On the back-side, slightly bend legs so components stay in position.</li>
<li>Use insulation tape to hold resistors in position if needed.</li>
<li>Snip legs (leaving about 3-5mm) and solder.</li>
<li>Snip the protruding legs for extra clearance.</li>
</ul>
</li>
<li>
<p dir="auto">Capacitor</p>
<ul dir="auto">
<li>Capacitors have polarity, usually marked with a minus (negative).</li>
<li>Positive leg must go in the VCC rail.</li>
<li>Insert capacitor legs partially, so it can be bent off the
veroboard for clearance inside the keyboard case.</li>
<li>On the back-side, bend legs slightly so it stays in position.</li>
<li>Use insulation tape to hold capacitor in position.</li>
<li>Snip legs and bend negative over to 100k resistor pad, and solder.</li>
<li>Snip the protruding leg for extra clearance.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/collage-reset.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/collage-reset.jpg" alt="collage-reset"/></a></p>
<h3 dir="auto"><a id="user-content-3-solder-leads-to-reset-circuit-rc" href="#3-solder-leads-to-reset-circuit-rc" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>3. Solder leads to reset circuit (RC)</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>Thin wire (I used wire wrap 30 guage wire).</li>
<li>Wire cutter and stripper.</li>
<li>Soldering equipment.</li>
<li>Bonus: helping hand.</li>
</ul>
</li>
<li>
<p dir="auto">Solder trackpoint leads to reset circuit.</p>
</li>
<li>
<p dir="auto">Cut, strip and solder leads to reset circuit that will go to the teensy.</p>
</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/reset-underside.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/reset-underside.jpg" alt="reset-underside"/></a></p>
<h3 dir="auto"><a id="user-content-4-testing-on-a-breadboard" href="#4-testing-on-a-breadboard" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>4. Testing on a breadboard</h3>
<ul dir="auto">
<li>Insert teensy in breadboard.</li>
<li>Insert leads from RC into breadboard connected to teensy pins.</li>
<li>Update firmware to enable PS2 mouse and USART (see below).</li>
<li>Flash firmware to teensy, and test.</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/breadboard.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/breadboard.jpg" alt="breadboard"/></a></p>
<h3 dir="auto"><a id="user-content-5-make-trackpoint-stem-hole-in-case" href="#5-make-trackpoint-stem-hole-in-case" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>5. Make trackpoint stem hole in case</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>PCB drill / thin rounded file (to make a 1.2mm hole).</li>
</ul>
</li>
<li>
<p dir="auto">Decide where you want the trackpoint stem - I prefer using my middle
finger and have a row staggered keyboard, so I positioned it on the
cross section between U/I/K (QWERTY layout).</p>
</li>
<li>
<p dir="auto">Locate position for trackpoint stem, and scratch or mark the space
available.</p>
</li>
<li>
<p dir="auto">Remove the keycaps, make the hole (slowly and carefully), replace
keycaps.</p>
</li>
<li>
<p dir="auto">Test stem diameter in hole. Should be rigid with a slight amount of
slack.</p>
</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/collage-hole.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/collage-hole.jpg" alt="collage-hole"/></a></p>
<h3 dir="auto"><a id="user-content-6-make-space-for-trackpoint-in-keyboard" href="#6-make-space-for-trackpoint-in-keyboard" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>6. Make space for trackpoint in keyboard</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>Insulation tape.</li>
<li>Wire cutter.</li>
</ul>
</li>
<li>
<p dir="auto">Add insulation tape to trackpoint to prevent shorts.</p>
</li>
<li>
<p dir="auto">Rewire diodes / column wires if needed for trackpoint clearance.</p>
</li>
<li>
<p dir="auto">Trim switch legs if needed for trackpoint clearance.</p>
</li>
<li>
<p dir="auto">Relocate D2 and D5 pins if they are already being used.</p>
</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/collage-rewiring.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/collage-rewiring.jpg" alt="collage-rewiring"/></a></p>
<h3 dir="auto"><a id="user-content-7-test-trackpoint-clearance-and-stem-length-glue-stem" href="#7-test-trackpoint-clearance-and-stem-length-glue-stem" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>7. Test trackpoint clearance and stem length, glue stem</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>Stem for trackpoint (labret cheek piercing 16G, different lengths).</li>
<li>Double sided tape.</li>
<li>Glue (loctite super glue-3).</li>
<li>Sandpaper.</li>
</ul>
</li>
<li>
<p dir="auto">Remove red cap.</p>
</li>
<li>
<p dir="auto">Stick a stem to trackpoint pointer base with double side tape.</p>
</li>
<li>
<p dir="auto">Insert trackpoint with stem into hole.</p>
</li>
<li>
<p dir="auto">Close case, flip keyboard, screw on stem ball, test.</p>
</li>
<li>
<p dir="auto">Rinse and repeat for other stems until satisfied with length.</p>
</li>
<li>
<p dir="auto">Remove double sided tape, glue stem.</p>
</li>
<li>
<p dir="auto">Use sandpaper to roughen up the stem ball for added friction.</p>
</li>
</ul>
<h3 dir="auto"><a id="user-content-8-solder-reset-circuit-rc-to-teensy" href="#8-solder-reset-circuit-rc-to-teensy" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>8. Solder reset circuit (RC) to teensy</h3>
<ul dir="auto">
<li>Solder leads to teensy:</li>
</ul>
<div data-snippet-clipboard-copy-content="VCC  -&gt; teensy VCC
GND  -&gt; teensy GND
CLK  -&gt; teensy D5
DATA -&gt; teensy D2"><pre><code>VCC  -&gt; teensy VCC
GND  -&gt; teensy GND
CLK  -&gt; teensy D5
DATA -&gt; teensy D2
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/inside-side-view.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/inside-side-view.jpg" alt="inside-side-view"/></a></p>
<h3 dir="auto"><a id="user-content-9-finish-up" href="#9-finish-up" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>9. Finish up</h3>
<ul dir="auto">
<li>Verify trackpoint is positioned squarely, and close case.</li>
<li>Screw on stem ball.</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/alonswartz/trackpoint/blob/master/images/top-side-view.jpg"><img src="https://github.com/alonswartz/trackpoint/raw/master/images/top-side-view.jpg" alt="top-side-view"/></a></p>
<h3 dir="auto"><a id="user-content-10-update-tmk_keyboard-firmware-and-flash" href="#10-update-tmk_keyboard-firmware-and-flash" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>10. Update tmk_keyboard firmware and flash</h3>
<ul dir="auto">
<li>
<p dir="auto">What you need:</p>
<ul dir="auto">
<li>TMK keyboard firmware and development environment.</li>
</ul>
</li>
<li>
<p dir="auto">Update firmware with PS2 mouse and USART support (see below).</p>
</li>
<li>
<p dir="auto">Plug in keyboard, flash and test.</p>
</li>
</ul>
<h2 dir="auto"><a id="user-content-tmk-firmware-changes-and-tweaks" href="#tmk-firmware-changes-and-tweaks" aria-hidden="true"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>TMK firmware changes and tweaks</h2>
<ul dir="auto">
<li>Configure PS2 mouse and USART support: <a href="https://github.com/alonswartz/tmk_keyboard/commit/f20a6f8fed823e5406f783b51db96c07ee14f079">diff</a></li>
<li>Configure mousekeys: <a href="https://github.com/alonswartz/tmk_keyboard/blob/blackhawk/tmk_core/doc/keycode.txt#L212">keycodes</a>, <a href="https://github.com/alonswartz/tmk_keyboard/blob/1de1336fe06905893340df78ce43e9cafdbf32c9/keyboard/blackhawk/keymap_default.c#L23">keymap</a></li>
<li>Enable concurrent trackpoint movement and mousekeys: <a href="https://github.com/alonswartz/tmk_keyboard/commit/e71670a120b0b0f746b13f593df0c988f03d277c">diff</a></li>
<li>Trackpoint polling interval delay for dropped key strokes: <a href="https://github.com/alonswartz/tmk_keyboard/commit/a5c7dc87bb9f2872483f40482060a645e00e7557">diff1</a>, <a href="https://github.com/alonswartz/tmk_keyboard/commit/1de1336fe06905893340df78ce43e9cafdbf32c9">diff2</a></li>
<li>Todo: auto-enable mouse-layer on tp movement.</li>
</ul>
</article>
          </div></div>
  </body>
</html>
