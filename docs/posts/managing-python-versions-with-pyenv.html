<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://thepythoncorner.com/posts/2022-05-06-managing-python-versions-with-pyenv/">Original</a>
    <h1>Managing Python Versions with Pyenv</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody"><p><img src="https://imgs.xkcd.com/comics/python_environment.png" alt="teaser"/></p><p>Today’s article is about one of the most impressive pieces of software Python-related I have ever seen: <a href="https://github.com/pyenv/pyenv"><code>pyenv</code></a>.
<code>pyenv</code> is the most clever way of installing Python on your system and allows you to install and manage several different versions of
Python specifying a different Python version for every project you have.</p><p>If you’re on a Mac and you are a <a href="https://brew.sh/index_it">homebrew</a> user there’s a specific <a href="https://formulae.brew.sh/formula/pyenv">formulae</a>
for that. If you don’t know homebrew, it’s a package manager for macOS and it’s another great piece of software, go and check it out, don’t
miss it! If you have homebrew installed, you can simply get pyenv by using the following command:</p><p>If you are on Linux, you can simply download it from GitHub but the most convenient way is to use the <a href="https://github.com/pyenv/pyenv-installer">pyenv-installer</a>
that is a simple script that will install it automatically on your distro, whatever it is, in the easiest possible way.</p><p>If you are on Windows… come on man, the 90s are over! ;)
Ok ok, no hard feelings guys, I was just joking! The fact is that this software doesn’t exist on Windows but don’t lose faith, there are at least two possibilities.
The first one is to use <a href="https://github.com/pyenv-win/pyenv-win">pyenv-win</a>, which is a specific fork working on windows by <a href="https://github.com/kirankotari">Kiran Kumar Kotari</a>.
I have to admit that I have never tried it though, so try it by yourself and leave a comment here to let us know how it was.
The second option (the one I actually use when I’m on Windows) is… to use the Linux version on <a href="https://docs.microsoft.com/en-gb/windows/wsl/install">WSL2</a>.
I know, I know… you may think that this is not a real solution, it’s like cheating… but I honestly think that in 2022 if you are a
developer you should consider moving to Unix or Unix like systems, like macOS or Linux, so even when I’m on Windows I heavily rely on the
Windows Subsystem for Linux, which I consider the best thing Microsoft did in the last 40 years…</p><p>However, to write this article since I have already installed and configured <code>pyenv</code> on all my systems, I have created a small Linux Lithium
vm so to be able to start from scratch along with you. If you don’t know Lithium, check <a href="https://www.bunsenlabs.org/index.html">their website</a>, it’s
a very lightweight distro based on Debian and ideally a continuation of the <a href="https://en.wikipedia.org/wiki/CrunchBang_Linux">#!Linux</a>,
which was an incredible distro based on Debian discontinued in 2013…</p><p>However, let’s start the installation!
Start your Linux terminal and execute the pyenv-installer script by executing <code>curl https://pyenv.run | bash</code>.</p><div><pre><code data-lang="bash"><span> 1</span>dave@hell:~$ curl https://pyenv.run | bash
<span> 2</span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
<span> 3</span>                                 Dload  Upload   Total   Spent    Left  Speed
<span> 4</span><span>100</span>   <span>270</span>  <span>100</span>   <span>270</span>    <span>0</span>     <span>0</span>    <span>286</span>      <span>0</span> --:--:-- --:--:-- --:--:--   <span>286</span>
<span> 5</span>Cloning into <span>&#39;/home/dave/.pyenv&#39;</span>...
<span> 6</span>remote: Enumerating objects: 979, <span>done</span>.
<span> 7</span>remote: Counting objects: 100% <span>(</span>979/979<span>)</span>, <span>done</span>.
<span> 8</span>remote: Compressing objects: 100% <span>(</span>451/451<span>)</span>, <span>done</span>.
<span> 9</span>remote: Total <span>979</span> <span>(</span>delta 564<span>)</span>, reused <span>659</span> <span>(</span>delta 401<span>)</span>, pack-reused <span>0</span>
<span>10</span>Receiving objects: 100% <span>(</span>979/979<span>)</span>, 481.70 KiB | 9.83 MiB/s, <span>done</span>.
<span>11</span>Resolving deltas: 100% <span>(</span>564/564<span>)</span>, <span>done</span>.
<span>12</span>Cloning into <span>&#39;/home/dave/.pyenv/plugins/pyenv-doctor&#39;</span>...
<span>13</span>remote: Enumerating objects: 11, <span>done</span>.
<span>14</span>remote: Counting objects: 100% <span>(</span>11/11<span>)</span>, <span>done</span>.
<span>15</span>remote: Compressing objects: 100% <span>(</span>9/9<span>)</span>, <span>done</span>.
<span>16</span>remote: Total <span>11</span> <span>(</span>delta 1<span>)</span>, reused <span>5</span> <span>(</span>delta 0<span>)</span>, pack-reused <span>0</span>
<span>17</span>Unpacking objects: 100% <span>(</span>11/11<span>)</span>, <span>done</span>.
<span>18</span>Cloning into <span>&#39;/home/dave/.pyenv/plugins/pyenv-installer&#39;</span>...
<span>19</span>remote: Enumerating objects: 16, <span>done</span>.
<span>20</span>remote: Counting objects: 100% <span>(</span>16/16<span>)</span>, <span>done</span>.
<span>21</span>remote: Compressing objects: 100% <span>(</span>13/13<span>)</span>, <span>done</span>.
<span>22</span>remote: Total <span>16</span> <span>(</span>delta 1<span>)</span>, reused <span>7</span> <span>(</span>delta 0<span>)</span>, pack-reused <span>0</span>
<span>23</span>Unpacking objects: 100% <span>(</span>16/16<span>)</span>, <span>done</span>.
<span>24</span>Cloning into <span>&#39;/home/dave/.pyenv/plugins/pyenv-update&#39;</span>...
<span>25</span>remote: Enumerating objects: 10, <span>done</span>.
<span>26</span>remote: Counting objects: 100% <span>(</span>10/10<span>)</span>, <span>done</span>.
<span>27</span>remote: Compressing objects: 100% <span>(</span>6/6<span>)</span>, <span>done</span>.
<span>28</span>remote: Total <span>10</span> <span>(</span>delta 1<span>)</span>, reused <span>5</span> <span>(</span>delta 0<span>)</span>, pack-reused <span>0</span>
<span>29</span>Unpacking objects: 100% <span>(</span>10/10<span>)</span>, <span>done</span>.
<span>30</span>Cloning into <span>&#39;/home/dave/.pyenv/plugins/pyenv-virtualenv&#39;</span>...
<span>31</span>remote: Enumerating objects: 61, <span>done</span>.
<span>32</span>remote: Counting objects: 100% <span>(</span>61/61<span>)</span>, <span>done</span>.
<span>33</span>remote: Compressing objects: 100% <span>(</span>54/54<span>)</span>, <span>done</span>.
<span>34</span>remote: Total <span>61</span> <span>(</span>delta 11<span>)</span>, reused <span>28</span> <span>(</span>delta 1<span>)</span>, pack-reused <span>0</span>
<span>35</span>Unpacking objects: 100% <span>(</span>61/61<span>)</span>, <span>done</span>.
<span>36</span>Cloning into <span>&#39;/home/dave/.pyenv/plugins/pyenv-which-ext&#39;</span>...
<span>37</span>remote: Enumerating objects: 10, <span>done</span>.
<span>38</span>remote: Counting objects: 100% <span>(</span>10/10<span>)</span>, <span>done</span>.
<span>39</span>remote: Compressing objects: 100% <span>(</span>6/6<span>)</span>, <span>done</span>.
<span>40</span>remote: Total <span>10</span> <span>(</span>delta 1<span>)</span>, reused <span>6</span> <span>(</span>delta 0<span>)</span>, pack-reused <span>0</span>
<span>41</span>Unpacking objects: 100% <span>(</span>10/10<span>)</span>, <span>done</span>.
<span>42</span>
<span>43</span>WARNING: seems you still have not added <span>&#39;pyenv&#39;</span> to the load path.
<span>44</span>
<span>45</span><span># Load pyenv automatically by appending</span>
<span>46</span><span># the following to </span>
<span>47</span>~/.bash_profile <span>if</span> it exists, otherwise ~/.profile <span>(</span><span>for</span> login shells<span>)</span>
<span>48</span>and ~/.bashrc <span>(</span><span>for</span> interactive shells<span>)</span> :
<span>49</span>
<span>50</span><span>export</span> <span>PYENV_ROOT</span><span>=</span><span>&#34;</span><span>$HOME</span><span>/.pyenv&#34;</span>
<span>51</span><span>command</span> -v pyenv &gt;/dev/null <span>||</span> <span>export</span> <span>PATH</span><span>=</span><span>&#34;</span><span>$PYENV_ROOT</span><span>/bin:</span><span>$PATH</span><span>&#34;</span>
<span>52</span><span>eval</span> <span>&#34;</span><span>$(</span>pyenv init -<span>)</span><span>&#34;</span>
<span>53</span>
<span>54</span><span># Restart your shell for the changes to take effect.</span>
<span>55</span>
<span>56</span><span># Load pyenv-virtualenv automatically by adding</span>
<span>57</span><span># the following to ~/.bashrc:</span>
<span>58</span>
<span>59</span><span>eval</span> <span>&#34;</span><span>$(</span>pyenv virtualenv-init -<span>)</span><span>&#34;</span>
</code></pre></div><p>Ok, that was easy, wasn’t it? Now all you have to do is to add the pyenv root directory <strong>at the beginning</strong> of your <code>PATH</code> environment
variable.</p><p>Now edit your ~/.bashrc and add the following lines:</p><div><pre><code data-lang="bash"><span>1</span><span>export</span> <span>PYENV_ROOT</span><span>=</span><span>&#34;</span><span>$HOME</span><span>/.pyenv&#34;</span>
<span>2</span><span>command</span> -v pyenv &gt;/dev/null <span>||</span> <span>export</span> <span>PATH</span><span>=</span><span>&#34;</span><span>$PYENV_ROOT</span><span>/bin:</span><span>$PATH</span><span>&#34;</span>
<span>3</span><span>eval</span> <span>&#34;</span><span>$(</span>pyenv init -<span>)</span><span>&#34;</span>
</code></pre></div><p>That’s it, now log out and log in again to make your system accept and load these changes.</p><p>If everything worked as expected, you can try to execute <code>pyenv</code> and if you get something, you did it, the installation was ok, read on.</p><p>Now that we have <code>pyenv</code> installed, we can start using it. On my Lithium system, the default python version that comes installed with the
system is the 2.7, which is terrible, isn’t it? So we will download and install the last Python version available that at the moment is the 3.10.4.
With just a command, <code>pyenv</code> will download the source code and build our Python version directly on our system for us!</p><p>Before that, however, some libraries has to be installed and that are needed to build Python.</p><p>So, since I’m on a Lithium Linux (that is a flavor of a Debian distro), I have to use the following command to install all the
reccomended dependencies:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ sudo apt-get install -y build-essential libssl-dev zlib1g-dev libbz2-dev <span>\
</span><span>2</span><span></span>libreadline-dev libsqlite3-dev wget curl llvm libncurses5-dev libncursesw5-dev <span>\
</span><span>3</span><span></span>xz-utils tk-dev libffi-dev liblzma-dev python-openssl git
</code></pre></div><p>If you are on a different distro, you can find the correct command to install all these dependencies <a href="https://github.com/pyenv/pyenv/wiki/Common-build-problems/6dae5cd9c3f0c399e368a3a2e5120fb9debac366">here</a>.</p><p>Ok, now that our dependencies are installed we are ready to install Python 3.10.4 by using <code>pyenv install 3.10.4 -v</code>:</p><div><pre><code data-lang="bash"><span> 1</span>dave@hell:~$ pyenv install 3.10.4 -v
<span> 2</span>...
<span> 3</span>Looking in links: /tmp/tmpzxxvet16
<span> 4</span>Processing /tmp/tmpzxxvet16/setuptools-58.1.0-py3-none-any.whl
<span> 5</span>Processing /tmp/tmpzxxvet16/pip-22.0.4-py3-none-any.whl
<span> 6</span>Installing collected packages: setuptools, pip
<span> 7</span>  WARNING: The scripts pip3 and pip3.10 are installed in <span>&#39;/home/dave/.pyenv/versions/3.10.4/bin&#39;</span> which is not on PATH.
<span> 8</span>  Consider adding this directory to PATH or, <span>if</span> you prefer to suppress this warning, use --no-warn-script-location.
<span> 9</span>Successfully installed pip-22.0.4 setuptools-58.1.0
<span>10</span>/tmp/python-build.20220506212137.7185 ~
<span>11</span>~
<span>12</span>Installed Python-3.10.4 to /home/dave/.pyenv/versions/3.10.4
</code></pre></div><p>The <code>-v</code> is just to have a verbose output because the installation won’t be super fast and if you don’t put this option, you could think
that the system is hanging. On my Lithium vm, installed on a 2018 MacBook Pro, the installation took about 2 minutes.</p><p>Ok, now that we have installed Python 3.10.4, let’s ask to pyenv which version we have available now:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ pyenv versions
<span>2</span>* system <span>(</span><span>set</span> by /home/dave/.pyenv/version<span>)</span>
<span>3</span>  3.10.4
</code></pre></div><p>As you can see, we have the <em>system</em> version (that is the one bundled with my distro) and the 3.10.4 that I’ve just installed.
Since the currently selected version is the <em>system</em> version (that’s what that asterisk near <em>system</em> stands for), if we run the <code>python</code>
command we are welcomed by the system version:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ python
<span>2</span>Python 2.7.16 <span>(</span>default, Oct <span>10</span> 2019, 22:02:15<span>)</span> 
<span>3</span><span>[</span>GCC 8.3.0<span>]</span> on linux2
<span>4</span>Type <span>&#34;help&#34;</span>, <span>&#34;copyright&#34;</span>, <span>&#34;credits&#34;</span> or <span>&#34;license&#34;</span> <span>for</span> more information.
<span>5</span>&gt;&gt;&gt; 
</code></pre></div><p>So, if we want to make sure that for the current user, the default Python installation will be the 3.10.4 one, we can just use the <code>global</code>
keyword like this:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ pyenv global 3.10.4
<span>2</span>dave@hell:~$ 
</code></pre></div><p>Now, if we run the command <code>python</code> again we get the 3.10.4 version:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ python
<span>2</span>Python 3.10.4 <span>(</span>main, May  <span>6</span> 2022, 21:22:43<span>)</span> <span>[</span>GCC 8.3.0<span>]</span> on linux
<span>3</span>Type <span>&#34;help&#34;</span>, <span>&#34;copyright&#34;</span>, <span>&#34;credits&#34;</span> or <span>&#34;license&#34;</span> <span>for</span> more information.
<span>4</span>&gt;&gt;&gt; 
</code></pre></div><p>That’s cool uh?</p><p>Ok, but what if I have a specific project where I would like to use the 3.6.2 version for example?</p><p>Let’s start by installing this version on our system:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ pyenv install 3.6.2
<span>2</span>Downloading Python-3.6.2.tar.xz...
<span>3</span>-&gt; https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tar.xz
<span>4</span>Installing Python-3.6.2...
<span>5</span>Installed Python-3.6.2 to /home/dave/.pyenv/versions/3.6.2
<span>6</span>
<span>7</span>dave@hell:~$ 
</code></pre></div><p>Now, let’s see the version available on our system:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~$ pyenv versions
<span>2</span>  system
<span>3</span>* 3.10.4 <span>(</span><span>set</span> by /home/dave/.pyenv/version<span>)</span>
<span>4</span>  3.6.2
<span>5</span>dave@hell:~$ 
</code></pre></div><p>Cool, now let’s enter in our project directory and let’s set a specific Python version for that specific project by the <code>local</code>
keyword:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~/mysupersecretproject$ pyenv <span>local</span> 3.6.2
<span>2</span>dave@hell:~/mysupersecretproject$ 
</code></pre></div><p>Let’s remain in our project directory and let’s see the Python versions we can use now:</p><div><pre><code data-lang="bash"><span>1</span>dave@hell:~/mysupersecretproject$ pyenv versions
<span>2</span>  system
<span>3</span>  3.10.4
<span>4</span>* 3.6.2 <span>(</span><span>set</span> by /home/dave/mysupersecretproject/.python-version<span>)</span>
<span>5</span>dave@hell:~/mysupersecretproject$ 
</code></pre></div><p>Can you see it? Now the default version is the 3.6.2 and <code>pyenv</code> tells us even why this would be the default version for this directory,
in fact with the <code>local</code> keyword we have created a hidden file named <code>.python-version</code> that specifies the python version that has to be
used for our project! Let’s do some tests:</p><div><pre><code data-lang="bash"><span> 1</span>dave@hell:~/mysupersecretproject$ python
<span> 2</span>Python 3.6.2 <span>(</span>default, May  <span>6</span> 2022, 21:49:46<span>)</span> 
<span> 3</span><span>[</span>GCC 8.3.0<span>]</span> on linux
<span> 4</span>Type <span>&#34;help&#34;</span>, <span>&#34;copyright&#34;</span>, <span>&#34;credits&#34;</span> or <span>&#34;license&#34;</span> <span>for</span> more information.
<span> 5</span>&gt;&gt;&gt; 
<span> 6</span>dave@hell:~/mysupersecretproject$ cat .python-version 
<span> 7</span>3.6.2
<span> 8</span>dave@hell:~/mysupersecretproject$ <span>cd</span> ..
<span> 9</span>dave@hell:~$ pyenv versions
<span>10</span>  system
<span>11</span>* 3.10.4 <span>(</span><span>set</span> by /home/dave/.pyenv/version<span>)</span>
<span>12</span>  3.6.2
<span>13</span>dave@hell:~$ 
</code></pre></div><p>Great, the versioning is working great and the 3.6.2 is used <strong>only</strong> in the directory we chose for it!</p><p>Ok, I know, some of you are thinking “I don’t want to use the standard Python installation, I need Jython, or Anaconda or Miniconda or …”.
Well, the good news is that <code>pyenv</code> lets you choose other Python distributions as well. To know all the versions available try to use
the command <code>pyenv install --list</code> and hold on tight!</p><div><pre><code data-lang="bash"><span> 1</span>dave@hell:~$ pyenv install --list
<span> 2</span>Available versions:
<span> 3</span>  2.1.3
<span> 4</span>  2.2.3
<span> 5</span>  2.3.7
<span> 6</span>  2.4.0
<span> 7</span>  2.4.1
<span> 8</span>...
<span> 9</span>  3.3.4
<span>10</span>  3.3.5
<span>11</span>  3.3.6
<span>12</span>  3.3.7
<span>13</span>  3.4.0
<span>14</span>...
<span>15</span>  3.10.2
<span>16</span>  3.10.3
<span>17</span>  3.10.4
<span>18</span>  3.11.0a7
<span>19</span>  3.11-dev
<span>20</span>  activepython-2.7.14
<span>21</span>  activepython-3.5.4
<span>22</span>  activepython-3.6.0
<span>23</span>  anaconda-1.4.0
<span>24</span>  anaconda-1.5.0
<span>25</span>  anaconda-1.5.1
<span>26</span>...
<span>27</span>  anaconda3-2021.11
<span>28</span>  graalpython-20.1.0
<span>29</span>  graalpython-20.2.0
<span>30</span>  graalpython-20.3.0
<span>31</span>  graalpython-21.0.0
<span>32</span>  graalpython-21.1.0
<span>33</span>...
<span>34</span>  ironpython-2.7.6.3
<span>35</span>  ironpython-2.7.7
<span>36</span>  jython-dev
<span>37</span>  jython-2.5.0
<span>38</span>  jython-2.5-dev
<span>39</span>  jython-2.5.1
<span>40</span>  jython-2.5.2
<span>41</span>...
<span>42</span>  mambaforge
<span>43</span>  mambaforge-4.10.1-4
<span>44</span>  mambaforge-4.10.1-5
<span>45</span>  mambaforge-4.10.3-10
<span>46</span>  micropython-dev
<span>47</span>  micropython-1.9.3
<span>48</span>  micropython-1.9.4
<span>49</span>  micropython-1.10
<span>50</span>  micropython-1.11
<span>51</span>...
<span>52</span>  miniconda3-4.5.11
<span>53</span>  miniconda3-4.5.12
<span>54</span>  miniconda3-4.6.14
<span>55</span>  miniconda3-4.7.10
<span>56</span>  miniconda3-4.7.12
<span>57</span>...
<span>58</span>  stackless-3.4-dev
<span>59</span>  stackless-3.4.2
<span>60</span>  stackless-3.4.7
<span>61</span>  stackless-3.5.4
<span>62</span>  stackless-3.7.5
<span>63</span>dave@hell:~$ 
<span>64</span>
</code></pre></div><p>There are currently more than 560 versions of Python you can choose from.</p><p>Now that you know the basic usage of pyenv you might wondering how it works.
Well, it turns out that as usual, it is easier than you may expect.</p><p>Pyenv works by adding a special directory called <code>shims</code> in front of your PATH environment variable, like this:</p><div><pre><code data-lang="bash"><span>1</span><span>$(</span>pyenv root<span>)</span>/shims:/usr/local/bin:/usr/bin:/bin
</code></pre></div><p>and in this directory, there are all the python commands you are used to, like <code>python</code>, <code>pip</code> etc…
So the command you have inserted is actually hijacked by <code>pyenv</code>, which can pass the command to the Python installation you like.</p><p>When a shim is executed, the Python version to be used is chosen in the following order:</p><ul><li>at first, it checks for a Python version specified in the <code>PYENV_VERSION</code> environment variable</li><li>then it looks if there is a <code>.python-version</code> file in the current directory, created by the <code>pyenv local</code> command</li><li>then it checks in order all the parent directories till the root one, looking for <code>.python-version</code> files to be used</li><li>in the end, it looks for a <code>$(pyenv root)/version</code> file, that is the one that is created when you use the <code>pyenv global</code> command</li></ul><p>All the Python versions installed by <code>pyenv</code> can be found under the directory <code>$(pyenv root)/versions</code> and can be uninstalled by the
<code>pyenv uninstall</code> command.</p><p>In this article, we have seen how easy it is to manage different Python versions either on a per-user or a per-project basis with pyenv.
For more information visit the <a href="https://github.com/pyenv/pyenv#how-it-works">official GitHub page of the project</a> and feel free to submit
pull requests or file bugs on the issue tracker, the project is active and actively supported by hundreds of contributors.</p><p>Happy coding!
D.</p></div></div>
  </body>
</html>
