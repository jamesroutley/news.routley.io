<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://cceckman.com/writing/test-game/">Original</a>
    <h1>The Test Game</h1>
    
    <div id="readability-page-1" class="page"><div>
<details>
  <summary>History</summary>
<p>This post was originally <a href="https://github.com/cceckman/tdd-preso" rel="external" target="_blank">a 5-minute talk</a> at <a target="_blank" href="https://www.recurse.com/scout/click?t=8238c6d9149cbd0865752e535795d509">the Recurse Center</a>.
<a href="https://www.scannedinavian.com/" rel="external" target="_blank">Shae</a> [encouraged] me to dust it off and share here. Enjoy!</p>
</details>
<h2 id="games-everywhere">Games everywhere</h2>
<p>People <a href="https://en.wikipedia.org/wiki/Gamification" rel="external" target="_blank">gamify</a> all sorts of activities.
Gamification can encourage harmful or addictive behaviors, draw money away from more useful purposes, etc.</p>
<p>But gamification is not always for the worse!
In my experience, prompt, positive feedback for doing an otherwise boring task can make it a lot more palatable.
Repeating that feedback helps me build positive habits.</p>
<figure><a href="https://xkcd.com/189"><img src="https://cceckman.com/writing/test-game/exercise.png" alt="A stick figure performs pull-ups on a bar in a doorframe. The figure says, One more point to strength, then I&#39;ll run to work on constitution. Above the figure, a caption reads: Like many geeks, I got a lot more interested in exercise once I made the connection to leveling up."/></a><figcaption>
      <p><a href="https://xkcd.com/189/" rel="external" target="_blank">xkcd #189: Exercise</a></p>
    </figcaption>
</figure>
<h2 id="gamifying-test-development">Gamifying test development</h2>
<p>I find lots of programming fun… at least, the creative and difficult bits of it.
But some bits drag– for me, often that’s writing tests.</p>
<p>I’ve found treating tests as a game can help me get the work done, and well.</p>
<h2 id="test-driven-development">Test-driven development</h2>
<p>Test-driven development– “write the tests, then the code”– is one good way to gamify tests.</p>
<ol>
<li>Add a test: 1 point!</li>
<li>Test compiles: 1 point!</li>
<li>Test goes from failing to passing: 1 point!</li>
</ol>
<p>In both steps (2) and (3), I get to see an indicator go from “bad” to “good” – positive feedback!
And by splitting that into two steps, I get twice the points!</p>
<p>Writing the tests first also helps my creativity with what the tests do.
I ask, “what could possibly go wrong?”, “how could this be misused?” – which I find more interesting than “just” mirroring the code paths.</p>
<h2 id="watch">Watch</h2>
<p>Continuously re-running the compile &amp; test flow is a useful tool for “gamification”.
Re-running <code>make test</code> is boring; getting the results back immediately is more rewarding.</p>
<p>I tend to use <a href="https://github.com/sharkdp/fd" rel="external" target="_blank"><code>fd</code></a> and <a href="https://eradman.com/entrproject" rel="external" target="_blank"><code>entr</code></a> to re-run tests.
For instance,</p>
<div><pre tabindex="0"><code data-lang="shell"><span><span>fd <span>&#39;*.rs&#39;</span> <span>|</span> entr -r cargo <span>test</span>
</span></span></code></pre></div><p>re-runs <code>cargo test</code> whenever the Rust sources change.<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup></p>
<h2 id="coverage-gutters">Coverage gutters</h2>
<p>I also use code coverage to give myself positive feedback.<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup></p>
<p>On each test runs, the runner collects coverage metrics (<a href="https://github.com/taiki-e/cargo-llvm-cov" rel="external" target="_blank">cargo llvm-cov</a> for Rust).
I use an editor extension (<a href="https://github.com/andythigpen/nvim-coverage" rel="external" target="_blank">neovim</a>, <a href="https://github.com/ryanluker/vscode-coverage-gutters" rel="external" target="_blank">VSCode</a>)
that consumes the coverage file and displays the content in the gutter of my editor:
green check for “this is covered”, red X for “this is not covered”.</p>
<figure><a href="https://cceckman.com/writing/test-game/screenshot.png"><img src="https://cceckman.com/writing/test-game/screenshot.png" alt="A screenshot of Rust source code in Neovim. The code shows two branches, one for a Negation expression and one for a Product expression. The left-hand gutter has red X marks along the Negation branch and green check marks along the Product branch."/></a><figcaption>
      <p>Oops, I was supposed to test that!</p>
    </figcaption>
</figure>
<p>Again, writing a new test gives me visual encouragement: an indicator going from “no” to “yes”.
With the tests automatically run, this shows up almost immediately in my editor once I’ve written the test;
prompt, positive feedback!</p>
<p>This is a great way to catch issues with the test suite!
Recently, I had a <a href="https://docs.rs/proptest/latest/proptest/" rel="external" target="_blank">property test</a> that (I thought) covered all expression-to-string round-trips for a type.
But when I turned on coverage, I saw that I had <a href="https://github.com/cceckman/dicer/commit/a067261e82be67d214cc6f057e9a319bd648bb3e" rel="external" target="_blank">missed a whole branch</a>–
the coverage clearly showed “no you didn’t”.<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup></p>
<h2 id="the-games-we-play">The games we play</h2>
<p>These techniques may not work for all environments or languages- I’ve only explored the Rust route.
They also rely on having a quick turnaround of compilation and test execution; I have a harder time with the feedback loop when running a 30-second test!</p>
<p>Still, I’d encourage you to give these techniques a try. If you’ve got your own ways to make testing more fun, I’d love to hear from you!</p>




</div></div>
  </body>
</html>
