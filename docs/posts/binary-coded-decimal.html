<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.veitheller.de/Binary_Coded_Decimal.html">Original</a>
    <h1>Binary Coded Decimal</h1>
    
    <div id="readability-page-1" class="page"><div>
      <p>Today I spent some of my day writing <a href="http://github.com/hellerve/nibbles">a toy library</a> for <a href="https://en.wikipedia.org/wiki/Binary-coded_decimal">Binary Coded Decimals</a>. I’m reading through <a href="https://www.amazon.com/Write-Great-Code-Understanding-Machine/dp/1593270038">Write Great Code</a>, and they were explained in chapter two<sup><a href="#1">1</a></sup>.</p>
<p>Binary coded decimals are an interesting beast in numerical computing—somewhat out of fashion, but still used in a few select industries, apparently.</p>
<p>I can’t say I’ve ever used them myself, although I’m sure that some libraries I depend on in some project or other at least implement them. This of course made me a prime candidate for re-implementing the format.</p>
<p>So I wrote a tiny C library that implements packed Binary-Coded Decimals—that means that every digit takes up half a byte. It is pretty terrible code, and I loved every second of working on it. In fine “Write Great Code” tradition most of the code is an abominable mix of bitmasking and shifting hacks, but it gets the job done. One of the main restrictions of the library is that it currently only supports 8–64 bits precision, though it would be fairly trivial to make it infinte precision. It’s left as an exercise to the reader, let’s say.</p>
<p>Before I leave you, let me give you a loop, slightly more obfuscated than in my library. I owe the people who find out what it does without reading the original source a beer, which I expect will get pretty expensive:</p>
<pre><code>for(i=0;i&lt;20;i+=2)if(*(x+i/2)){if(!(*(x+i/2)&amp;0xf0))i++;break;}</code></pre>
<p>
Fig. 1: A loop, evidently.
</p>

<p><span id="1">1.</span> As an aside, the book seems quite astoundingly good.</p>
      
    </div></div>
  </body>
</html>
