<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://0x46.net/thoughts/2019/02/01/dotfile-madness/">Original</a>
    <h1>Dotfile madness (2019)</h1>
    
    <div id="readability-page-1" class="page"><div> <article>  <p>We are no longer in control of our home directories.</p> <p>My own home directory contains 25 ordinary files and 144 hidden files. The dotfiles contain data that doesn&#39;t belong to me: it belongs to the programmers whose programs decided to hijack the primary location designed as a storage for my personal files. I can&#39;t place those dotfiles anywhere else and they will appear again if I try to delete them. All I can do is sit here knowing that in the darkness, behind the scenes, they are there. Waiting in silence. Some of those programmers decided to additionally place some normal files and directories in the same place. Those are clearly visible every time I execute <code>ls</code> in my home directory. It is beyond me why my home directory ended up up containing a <code>node_modules</code> directory, <code>package-lock.json</code>, a <code>yarn.lock</code> file (I have never even consciously used yarn!), some 2 strange log files origination from some Java software clearly using an H2 database, and a <code>Desktop</code> directory. That last one has been created by Steam, which is quite unfortunate as I simply do not have a desktop or a desktop environment on my machine. I dread the day in which I will hear a loud knock on my door and one of those programmers will barge in informing me that he is going to store a piece of his furniture in the middle of my living room, if I don&#39;t mind.</p> <p>To those of you reading this: I beg you. Avoid creating files or directories of any kind in your user&#39;s <code>$HOME</code> directory in order to store your configuration or data. This practice is bizarre at best and it is time to end it. I am sorry to say that many (if not most) programs are guilty of doing this while there are significantly better places that can be used for storing per-user program data.</p> <p>Even if we will never be able to solve this problem - due to the historical baggage, backward compatibility, software no longer receiving updates or programming villains storing the files wherever they want just to see the world burn - we can at least try to follow some sane practices. While the <a href="https://web.archive.org/web/20171003124306/https://plus.google.com/+RobPikeTheHuman/posts/R58WgWwN9jp">mistake of introducing the mere concept of a &#34;hidden&#34; file</a> can&#39;t be undone anymore, we can at least try to mitigate its results.</p> <p>This particular problem has been noticed and solved a long time ago with the creation of <a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG Base Directory Specification</a>. The specification defines a set of environment variables pointing programs to a directory in which their data or configuration should be stored. It is up to the user to set those variables so if the variables are not available the programs are expected to default to a directory defined by the standard and not the user&#39;s home directory.</p> <h2>User-level variables</h2> <h3><code>$XDG_DATA_HOME</code></h3> <blockquote> <p><code>$XDG_DATA_HOME</code> defines the base directory relative to which user specific data files should be stored. If <code>$XDG_DATA_HOME</code> is either not set or empty, a default equal to <code>$HOME/.local/share</code> should be used. </p> </blockquote> <p>Example usage: storing plugins downloaded by the user, databases created by your program, user&#39;s input history, bookmarks, emails, and so on.</p> <h3><code>$XDG_CONFIG_HOME</code></h3> <blockquote> <p><code>$XDG_CONFIG_HOME</code> defines the base directory relative to which user specific configuration files should be stored. If <code>$XDG_CONFIG_HOME</code> is either not set or empty, a default equal to <code>$HOME/.config</code> should be used. </p> </blockquote> <p>You should use this directory to store user-specific configuration files for your program. You will most likely want to create a default configuration file with sane and sensible default values the first time your program is executed.</p> <h3><code>$XDG_CACHE_HOME</code></h3> <blockquote> <p><code>$XDG_CACHE_HOME</code> defines the base directory relative to which user specific non-essential data files should be stored. If <code>$XDG_CACHE_HOME</code> is either not set or empty, a default equal to $HOME/.cache should be used.</p> </blockquote> <p>Example: caching thumbnails generated by your file manager, songs that the user of a music straming software is often listening to, and so on. Your program should continue to function without any problems if this directory is removed by the user. Ensure that the files that are no longer needed are properly removed. Remember that exceeding the sensible amount of storage space used by your files will most likely upset the user who will quickly track down your program as a culprit.</p> <h3><code>$XDG_RUNTIME_DIR</code></h3> <blockquote> <p><code>$XDG_RUNTIME_DIR</code> defines the base directory relative to which user-specific non-essential runtime files and other file objects (such as sockets, named pipes, ...) should be stored.</p> </blockquote> <p>The specification lists a series of requirements that have to be fulfilled by this directory. As described by the specification you should use this directory to store sockets and similar files used for communication.</p> <h2>System-level variables</h2> <h3><code>$XDG_CONFIG_DIRS</code></h3> <blockquote> <p><code>$XDG_CONFIG_DIRS</code> defines the preference-ordered set of base directories to search for configuration files in addition to the <code>$XDG_CONFIG_HOME</code> base directory. The directories in <code>$XDG_CONFIG_DIRS</code> should be seperated with a colon &#39;:&#39;.</p> <p>If <code>$XDG_CONFIG_DIRS</code> is either not set or empty, a value equal to <code>/etc/xdg</code> should be used. </p> </blockquote> <p>This directory should be used for storing system-wide configuration files that can be overwriten by user-specific configuration files. This directory would most likely be populated during the installation process.</p> <h3><code>$XDG_DATA_DIRS</code></h3> <blockquote> <p><code>$XDG_DATA_DIRS</code> defines the preference-ordered set of base directories to search for data files in addition to the <code>$XDG_DATA_HOME</code> base directory. The directories in <code>$XDG_DATA_DIRS</code> should be seperated with a colon &#39;:&#39;.</p> <p>If <code>$XDG_DATA_DIRS</code> is either not set or empty, a value equal to <code>/usr/local/share/:/usr/share/</code> should be used.</p> </blockquote> <p>Example: storing plugins or themes that can be used by all users of your program. This directory would most likely be populated during the installation process.</p> <h2>How does this work in practice?</h2> <p>Using the standard is very simple. Read the relevant environment variable and use the default paths defined by the standard if it is missing. You should then append a program-specific directory name to it and create the entire directory tree to store your data.</p> <p>As an example if you were to store configuration files you should use <code>$XDG_CONFIG_HOME/your-program</code> as your base configuraion directory instead of just storing your files directly in <code>$XDG_CONFIG_HOME</code>. Remember to never hardcode the directories to the default values defined by the standard. Read the environment variable first to allow the user to move those directories if needed.</p> <p>You can easily migrate your existing programs to use this standard. In order to do so start using the standard when creating new files but keep also checking the old location of the files when reading them. This will allow you to migrate without breaking the program for the users with the configuration or data files that were created by a previous version of your program.</p> <p>Read the standard to find out more and have a look at the directory hierarchy which is almost certain to be already present in your home directory. In reality a cross-platform library allowing you to get a directory for storing your data will be available for your programming language of choice. On Linux and similar systems, this library will surely use the XDG Base Directory Specification.</p> <p> 2019-02-01 </p> </article> </div></div>
  </body>
</html>
