<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.righto.com/2020/11/reverse-engineering-classic-mk4116-16.html">Original</a>
    <h1>Reverse-engineering the classic MK4116 16-kilobit DRAM chip (2020)</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-9178320223286625683" itemprop="description articleBody">


<p>Back in the late 1970s, the most popular memory chip was Mostek&#39;s MK4116, holding a whopping (for the time) 16 kilobits.
<!-- Introduced 1977, most popular: https://books.google.com/books?id=zAsN0XCHbFsC&pg=PA97 1979, 1980, 1982-->
It provided storage for computers such as the Apple II, TRS-80, ZX Spectrum, Commodore PET, IBM PC, 
and Xerox Alto <!-- Xerox Notetaker, Atari 800, TI 99/4a, --> as well as video games such as Defender and Missile Command.
<!-- such as Colecovision, Defender, Joust, Missile Command, Qix, and Robotron. -->
<!-- http://www.bitsavers.org/pdf/xerox/notetaker/schematics/19781013_Notetaker_Memory_Storage.pdf -->
<!-- https://console5.com/store/16kb-x-1-bit-dram-mb8118-12.html -->
<!-- https://www.arcadeshop.com/i/68/4116-ram-set-of-25.htm -->
To see how the chip is implemented I opened one up and reverse-engineered it.
I expected the circuitry to be similar to other chips of the era, using standard NMOS gates, but it was much
more complex than I expected, built from low-power <a href="https://en.wikipedia.org/wiki/Dynamic_logic_(digital_electronics)">dynamic logic</a>.
The MK4116 also used advanced manufacturing processes to fit 16,384 high-density memory cells on the chip.<span id="fnref:references"><a href="#fn:references">1</a></span><span id="fnref:contacts"><a href="#fn:contacts">2</a></span></p>
<p>I created the die photo below from multiple microscope images.
The white lines are the metal wiring on top of the chip, while the silicon underneath appears dark red.
The two large rectangular regions are the 16,384 memory
cells, arranged as a 128×128 matrix split in two.
In between the two memory arrays are the amplifiers and selection circuits.
The control and interface circuitry is at the left and right, connected to the external pins via tiny bond wires.</p>
<p><a href="https://static.righto.com/images/mk4116/metal-rotated.jpg"><img alt="Die photo of the 4116 memory chip. Click for a larger image." height="390" src="https://static.righto.com/images/mk4116/metal-rotated-w700.jpg" title="Die photo of the 4116 memory chip. Click for a larger image." width="700"/></a></p><p>Die photo of the 4116 memory chip. Click for a larger image.</p>
<p>In dynamic RAM, each bit is stored in a capacitor
with the bit&#39;s value, 0 or 1, represented by the voltage on the capacitor.<span id="fnref:charge"><a href="#fn:charge">3</a></span>
The advantage of dynamic RAM is that each memory cell is very small, so a lot of data can be stored on one chip.<span id="fnref:cell"><a href="#fn:cell">4</a></span>
The downside of dynamic RAM is that the charge on a capacitor leaks away after a few milliseconds.
To avoid losing data, dynamic RAM must be constantly refreshed: bits are read from the capacitors, amplified, and then written back
to the capacitors. For the MK4116, all the data must be refreshed every two milliseconds.</p>
<p>The diagram below illustrates four of the 16,384 memory cells.
Each memory cell has a capacitor, along with a transistor that connects the capacitor to the associated bit line.
To read or write data, a row select line is energized, turning on the transistors in that row.
The row&#39;s capacitors are connected to the bit lines, allowing the bits in that row to be accessed.</p>
<p><a href="https://static.righto.com/images/mk4116/patent-diagram.jpg"><img alt="Structure of the memory cells, based on the patent." height="289" src="https://static.righto.com/images/mk4116/patent-diagram-w400.jpg" title="Structure of the memory cells, based on the patent." width="400"/></a></p><p>Structure of the memory cells, based on <a href="https://patents.google.com/patent/US4392210A">the patent</a>.</p>
<p>One of Mostek&#39;s key innovations was to multiplex the address pins.<span id="fnref:multiplex"><a href="#fn:multiplex">6</a></span>
Earlier memory chips used a separate pin for each address bit; as memory sizes increased, so did the number of address pins.
This forced Intel&#39;s <a href="https://drive.google.com/file/d/0B9rh9tVI0J5mMWRkNzg0ZmEtZDdjNC00YzY5LWFlZGMtNzQ5ZmE3NDg3Mzc5/view">4096-bit memory chip</a>, for instance, to use a large, more costly 22-pin package.<span id="fnref:pins"><a href="#fn:pins">5</a></span>
Mostek cut the number of address pins in half by using each address pin twice, first for a &#34;row&#34; address, and then a &#34;column&#34; address.
This approach became the industry standard, allowing memory chips to fit into inexpensive 16-pin packages.</p>
<p>Externally, the chip stores a single bit for 16,384 different addresses. (Typically, eight of these chips were used in parallel to store bytes.)
Internally, however, the chip is implemented as a 128×128 matrix of storage cells.
The row address selects a row of 128 cells<span id="fnref:row"><a href="#fn:row">7</a></span> and then the column address selects one of these 128 cells to read or write.<span id="fnref:efficiency"><a href="#fn:efficiency">8</a></span>
Meanwhile, the entire row of 128 cells is refreshed by amplifying the signals and storing them back in the capacitors.</p>
<p><a href="https://static.righto.com/images/mk4116/die-labeled.jpg"><img alt="The 4116 die with key blocks labeled. Most of the memory cell area has been cut out." height="654" src="https://static.righto.com/images/mk4116/die-labeled-w600.jpg" title="The 4116 die with key blocks labeled. Most of the memory cell area has been cut out." width="600"/></a></p><p>The 4116 die with key blocks labeled. Most of the memory cell area has been cut out.</p>
<p>The die image above is labeled with the main functional blocks.<span id="fnref:block"><a href="#fn:block">9</a></span>
The chip&#39;s 16 pins are labeled around the perimeter,<span id="fnref:power"><a href="#fn:power">10</a></span> including the seven address pins (A0-A6).
The Row Address Strobe pin (RAS) is used to indicate the row address is ready, while the Column Address Strobe pin (CAS)
indicates that the column address is ready.
The two memory arrays are in the center; I&#39;ve cut out most of the cells to keep the diagram compact.
The column select circuitry and sense amplifiers are between the two memory arrays.
At the right, the row decode circuitry selects a row based on the address pins, while the column address circuitry
buffers the address for the column select circuitry.
At the left, the clock circuits generate the chip&#39;s timing pulses, triggered by the RAS, CAS, and WRITE pins.
Finally, the Data Out and Data In pins provide access to the selected data bit.</p>
<h2>Memory cell structure</h2>
<p>The key to the DRAM chip is the memory storage cell, designed to be as compact as possible.
The highly magnified photo below shows some of the storage cells, densely packed together.
It&#39;s a bit hard to visualize what&#39;s going on because the chip is constructed from multiple layers.
The bottom layer is the grayish silicon die.
On top of the silicon are two layers of polysilicon, a special type of deposited silicon used for transistor gates,
capacitors, and wiring.
The top layer of the chip is the metal wiring, which was removed for this photo.
The photo shows three bit lines in the silicon, with bulb-shaped storage cells connected on either side.
Vertical strips of polysilicon (poly 1) over the storage cells implement capacitors: the silicon forms the lower plate, while the polysilicon forms the upper plate.
The second layer of polysilicon (poly 2) is arranged in diagonal regions to implement the selection transistors, where
square notches in the poly 1 layer allow the poly 2 layer to approach the silicon.</p>
<p><a href="https://static.righto.com/images/mk4116/cell-diagram.jpg"><img alt="A closeup of the memory chip under the microscope, showing individual storage cells." height="337" src="https://static.righto.com/images/mk4116/cell-diagram-w500.jpg" title="A closeup of the memory chip under the microscope, showing individual storage cells." width="500"/></a></p><p>A closeup of the memory chip under the microscope, showing individual storage cells.</p>
<p>The cross-section diagram below shows the three-dimensional, layered structure of a memory cell.
At the bottom is the silicon (brown); the bit line (dark brown) is made from doped silicon.
Above the silicon are the two polysilicon layers (red) and the metal layer (purple), separated by insulating silicon dioxide (gray).
At the far left, the poly 1 layer and underlying silicon form a capacitor.
In between the capacitor and the bit line, the poly 2 layer forms the gate of the transistor. At the left, the poly 2 layer
is connected to the metal of the word line, which turns the transistor on, connecting the capacitor to the bit line.</p>
<p><a href="https://static.righto.com/images/mk4116/cell-structure.jpg"><img alt="Cross-section structure of a storage cell. Based on 16K—The new generation dynamic RAM." height="434" src="https://static.righto.com/images/mk4116/cell-structure-w400.jpg" title="Cross-section structure of a storage cell. Based on 16K—The new generation dynamic RAM." width="400"/></a></p>
<p>The diagram below illustrates how bits are addressed in the storage matrix. 
The arrangement is somewhat confusing because columns of cells are offset and interlocked like zippers.
A row select line is connected to the centers of diagonal poly 2 regions, so each region controls two transistors
on neighboring bit lines.
(For instance, in the upper left, the poly region connected to row select 0 forms transistors 0A and 0B.)
The result is that each row select line activates 128 cells, one for each bit line in a staggered arrangement.</p>
<p><a href="https://static.righto.com/images/mk4116/cell-bits.jpg"><img alt="Arrangement of bits in the matrix. The transistors are labeled according to their corresponding row and bit line." height="288" src="https://static.righto.com/images/mk4116/cell-bits-w600.jpg" title="Arrangement of bits in the matrix. The transistors are labeled according to their corresponding row and bit line." width="600"/></a></p><p>Arrangement of bits in the matrix. The transistors are labeled according to their corresponding row and bit line.</p>
<h2>Low-power circuitry</h2>
<p>A key feature of the MK4116 memory chip is that it uses almost no power when it is sitting idle.
Although it consumes 462 milliwatts when active, it uses just 20 milliwatts in standby mode.
Although low-power circuitry is straightforward to build with modern CMOS technology, the 4116 used earlier NMOS transistors.
Most NMOS integrated circuits constructed logic gates with
<a href="https://en.wikipedia.org/wiki/Depletion-load_NMOS_logic">load transistors</a>, a simple technique with the disadvantage of
wasting power.
Instead, the MK4116 memory chip uses dynamic logic, which is considerably more complex but saves power while idle.</p>
<!--
The diagram below shows the construction standard NMOS inverter.
When the input is low, the transistor turns off and the load resistor pulls the output high.
When the input is high, the transistor turns on and the load resistor pulls the output low.
The problem with this inverter is that for a low output, there is constant current flow through the resistor, wasting power.
Thus, Mostek needed to use different, low-power techniques for the circuitry.
(The load resistor is actually constructed from a transistor for technical reasons.)
Despite its power consumption, this circuit is used in handful of places in the 4116 chip, but only where necessary.

![A standard NMOS inverter wastes power through the load resistor.](inverter.jpg "w150")

-->

<p>A typical dynamic logic gate (below) operates in two phases.
In the first phase, a clock signal turns on the upper transistor, precharging the output to +12 volts, the &#34;1&#34; state.
The upper transistor then turns off, but the output remains high due to the capacitance of the wire.
In the second phase, the lower transistors can pull the output low.
In particular, if either input is 1, the corresponding transistor turns on and pulls the output low,
so the circuit implements a NOR gate.
This circuit doesn&#39;t consume any static power, just a small current to charge the wire capacitance when switching.
(The inputs must be carefully timed so they don&#39;t overlap with the precharge clock.)
<!--
Dynamic logic is widely used in the 4116 chip and is also used in modern CPUs as domino logic.
-->
The use of dynamic circuitry makes the 4116 much more complex than it would be otherwise since the gates are controlled
by clock signals, which need to be generated.</p>
<p><a href="https://static.righto.com/images/mk4116/nor.jpg"><img alt="A NOR gate using dynamic logic." height="181" src="https://static.righto.com/images/mk4116/nor-w200.jpg" title="A NOR gate using dynamic logic." width="200"/></a></p><p>A NOR gate using dynamic logic.</p>
<!--
Another low-power technique a "CMOS-style" gate that uses one transistor to pull the output high and a second to pull the
output low.
Now, for a low output the upper transistor is off and there is no static current flow.
(This circuit can also be used as a non-inverting buffer by switching the inputs.)
This circuit has a large drawback: you need to have both non-inverted and inverted signals as inputs.
In some cases, the circuitry can be designed to produce both signals, but in many cases this is a chicken-and-egg problem;
you need something to invert the signal in the first case.

![CMOS-style inverter.](cmos.jpg "w120")
-->

<h2>The row select circuitry</h2>
<p>The purpose of the row-select circuitry is to decode the 7 address bits and energize the corresponding row select line
(out of 128) to read one row of memory.
In the first step, 32 5-input NOR gates decode address bits A0 through A4.
These NOR gates are implemented in the compact circuit shown below.
Each NOR gate takes a different combination of non-inverted and inverted address bits and matches a particular 5-bit address.
These NOR gates use dynamic logic, first pulled high and then discharged to ground, except for the selected address which
remains high.
<!--
(Meanwhile, circuitry at the other side of the array discharges all the row select lines.)
-->
Next, each NOR output is split into four, based on A5 and A6.
The result is that one of 128 row select lines is activated, turning on the transistors for that row in the matrix.</p>
<p>The NOR gates are implemented in several compact blocks; one block of three NOR gates is shown below.
Each NOR gate is a horizontal stripe of doped silicon, with ground above and below it.
Each NOR gate has transistors (pink stripes) connected to ground alternating above and below it.
A transistor will pull the NOR gate low if the connected address line is high.
The precharge transistors at the left pull the NOR gates to +12 volts, while the output control transistors control the
flow of the decoded outputs to the rest of the circuitry.</p>
<p><a href="https://static.righto.com/images/mk4116/row-decoder.jpg"><img alt="Three NOR gates in the row decoder. The vertical yellow strips indicate metal wiring, removed for this photo." height="367" src="https://static.righto.com/images/mk4116/row-decoder-w700.jpg" title="Three NOR gates in the row decoder. The vertical yellow strips indicate metal wiring, removed for this photo." width="700"/></a></p><p>Three NOR gates in the row decoder. The vertical yellow strips indicate metal wiring, removed for this photo.</p>
<p>The small greenish blobs at the end of a transistor gate (pink stripe) are connections (vias) between a transistor gate and an
address line.
The address lines are represented as vertical yellow stripes (since the metal layer was removed).
Note that each transistor gate has an address line at the right and the inverted address line at the left; thus, the
NOR gates all have the same basic layout, but with the contacts changed to match a particular address.
For instance, the upper NOR gate has transistors connected to A0, A2, A1, A3, and A4, so it will be active for address 00000;
any other address will pull it low.</p>
<h2>The sense amplifiers</h2>
<p>The sense amplifiers are one of the most challenging parts of designing a memory chip.
The job of the sense amplifier is to take the tiny voltage from a capacitor and amplify it into
a binary 0 or 1.<span id="fnref:voltage"><a href="#fn:voltage">11</a></span>
The challenge is that even though 12 volts is stored in a capacitor, the signal from the capacitor is very small, is only 100 millivolts or so.
(Because the bit line is much larger than the tiny memory cell capacitor,
the capacitor causes a very small voltage swing.)<span id="fnref:capacitance"><a href="#fn:capacitance">12</a></span>
It is critically important for the sense amplifier to operate accurately, even in the presence of noise or voltage
fluctuations, because any error will corrupt the data.
The sense amplifier circuit must also be compact and low power since there are 128 sense amplifiers.</p>
<p><a href="https://static.righto.com/images/mk4116/die-amps-highlighted.jpg"><img alt="The 128 sense amplifiers are in the middle of the die, between the upper and lower memory arrays." height="270" src="https://static.righto.com/images/mk4116/die-amps-highlighted-w500.jpg" title="The 128 sense amplifiers are in the middle of the die, between the upper and lower memory arrays." width="500"/></a></p><p>The 128 sense amplifiers are in the middle of the die, between the upper and lower memory arrays.</p>
<p>The chip&#39;s 128 sense amplifiers, one for each column, are located between the two memory arrays as shown above.
During a read, 128 values in a row are accessed in parallel and amplified by the sense amplifiers.
These 128 values are then written back to refresh the values in the capacitor.
For a write operation, one of the bits is updated with the new value before they are written back.</p>
<p><a href="https://static.righto.com/images/mk4116/sense-circuit.jpg"><img alt="The sense amplifier as it appears on the die, and corresponding schematic." height="374" src="https://static.righto.com/images/mk4116/sense-circuit-w450.jpg" title="The sense amplifier as it appears on the die, and corresponding schematic." width="450"/></a></p><p>The sense amplifier as it appears on the die, and corresponding schematic.</p>
<p>Each sense amplifier (above) is a very simple circuit. It takes two inputs and compares them, pulling the lower one to 0.<span id="fnref:amplification"><a href="#fn:amplification">13</a></span>
It is built from two <a href="http://www.seas.ucla.edu/brweb/papers/Journals/BR_Magzine1.pdf">cross-coupled transistors</a>, each trying to pull the other one low.
Whichever transistor has the higher voltage to start with will &#34;win&#34;, forcing the other side low.<span id="fnref:sense-example"><a href="#fn:sense-example">14</a></span>
The sense amplifier is sensitive to very small voltage differentials, allowing it to distinguish the small signals from a
storage cell.</p>
<p>Locating the sense amplifiers between the two memory arrays isn&#39;t arbitrary, but the key to their operation:
this is the &#34;divided bit line&#34; architecture introduced in 1972.
The idea is that one input to the sense amp is the voltage from the desired memory cell, while the other input is
a threshold voltage from a &#34;dummy cell&#34; in the opposite memory array.
Dummy cells are constructed and precharged like real memory cells except the capacitor is half-sized, so they provide a voltage midway between a 0 bit and a 1 bit.<span id="fnref2:charge"><a href="#fn:charge">3</a></span>
If the voltage from the real memory cell is lower, the sense amp outputs a 0, and if higher, it outputs a 1.</p>
<p><a href="https://static.righto.com/images/mk4116/dummy-diagram.jpg"><img alt="Dummy cells provide the threshold voltage for deciding if a bit is 0 or 1. The dummy cells are located at the top and bottom of the memory arrays. They are on the same bit lines as real memory cells." height="354" src="https://static.righto.com/images/mk4116/dummy-diagram-w500.jpg" title="Dummy cells provide the threshold voltage for deciding if a bit is 0 or 1. The dummy cells are located at the top and bottom of the memory arrays. They are on the same bit lines as real memory cells." width="500"/></a></p><p>Dummy cells provide the threshold voltage for deciding if a bit is 0 or 1. The dummy cells are located at the top and bottom of the memory arrays. They are on the same bit lines as real memory cells.</p>
<p>The dummy cells are located on the edges of the memory arrays, as shown above.
They consist of capacitors and transistors (similar to real memory cells), but with a separate line to charge them.
The advantage of the dummy cell approach is that manufacturing differences or fluctuations during operation will (hopefully)
affect the real cells and dummy cells equally, so the voltage from the dummy cell will remain at the correct level to
distinguish beween a 0 and a 1.
Address bit A0 controls which half of the array provides real data to the bit lines and which half connects dummy cells
to the bit lines.</p>
<h2>The column select circuitry</h2>
<p>The purpose of the column select circuitry is to select one column out of the 128-bit row; this is the bit that is
read or written.
Each column select circuit is twice as wide as a memory cell, so they only decode one of 64 columns.
The result is that
two bits are selected at a time, and circuitry elsewhere selects one of the two bits.
Like the row select circuitry, the column select circuitry is implemented by numerous NOR gates, each matching
one address.
For column select address bits A0 through A5 select one of 64 lines, selecting two columns at a time.
These two bit lines are connected to data lines transmitting the signals to the I/O circuitry.
(Since the bit lines for the upper and lower halves of the matrix are separate, there are actually four bit
lines selected by the column select circuit.)
As with the row select circuitry, dynamic logic is used, controlled by various timing signals.
Note that each NOR gate is physically split into two parts with the sense amp in the middle.</p>
<p>Footnote <span id="fnref:oral"><a href="#fn:oral">15</a></span></p>
<p><a href="https://static.righto.com/images/mk4116/column-decode-diagram.jpg"><img alt="Five of the column decoders, with one highlighted." height="508" src="https://static.righto.com/images/mk4116/column-decode-diagram-w400.jpg" title="Five of the column decoders, with one highlighted." width="400"/></a></p><p>Five of the column decoders, with one highlighted.</p>
<p>The schematic below shows how the column decoder works with the sense amplifier. The diagram shows two bit lines and the top half of the column decoder and sense circuitry; it is mirrored for the lower array.
At the top, the sense precharge circuit pulls all the bit lines high.
At the bottom, the sense amplifiers amplify and refresh the signals as explained above.
The column decoder matches a particular 6-bit address, so one of the 64 decoders will activate the associated sense select
circuit, connecting the chip&#39;s I/O circuitry to four bit lines (two from the upper memory array as shown here and two from the lower memory array).</p>
<p><a href="https://static.righto.com/images/mk4116/sense-decoder-schematic.jpg"><img alt="Schematic of half the column decoder and sense amplifier." height="818" src="https://static.righto.com/images/mk4116/sense-decoder-schematic-w500.jpg" title="Schematic of half the column decoder and sense amplifier." width="500"/></a></p><p>Schematic of half the column decoder and sense amplifier.</p>
<p>At this point, four bit lines have been selected for use and their signals are passed to the input/output circuitry;
the column select circuitry only decoded 1-of-64, while there are 128 columns, and each half of the array has separate
bit lines.
Column address bit A6 provides the final selection between the two columns.
The selected bit is sent to the data-out pin for a read.
For a write, the value on the data-in pin is sent back through the appropriate wire to overwrite the value in the
sense amplifier.
This circuitry is implemented using dynamic logic and latches, controlled by various timing signals.
Much of the circuitry is duplicated, with one copy for the upper half of the memory array and one copy for the lower
half.
Row address bit A0 distinguishes which half of the matrix is active and which half is providing dummy data).
(Note that row address bit A0 was already used to select a particular row, but the circuitry has &#34;lost track&#34;
of which was the real row and which was the dummy row, so it must make the selection again.)</p>
<h2>Clock generation</h2>
<p>The chip requires many timing signals for the various steps in a memory operations.
The memory chip doesn&#39;t use an external clock, unlike a CPU, but generates its own timing signals internally.
The diagram below illustrates the clock generators, using buffers to create a delay between each
successive clock output.
The first set of timing signals is triggered by the row-access strobe (RAS), indicating that the computer has put the row
address on the address pins.
The next set of timing signals is triggered by the column-access strobe (CAS), indicating the column address is on the
address pins. Other timing signals are triggered by the WRITE pin.</p>
<p><a href="https://static.righto.com/images/mk4116/clock-diagram.jpg"><img alt="Conceptual diagram of the clock generation, from
16K—The new generation dynamic RAM." height="179" src="https://static.righto.com/images/mk4116/clock-diagram-w400.jpg" title="Conceptual diagram of the clock generation, from
16K—The new generation dynamic RAM." width="400"/></a></p>
<p>The real clock circuitry is much more complex than the diagram indicates, consisting of dozens of transistors in multiple chains, feeding back in complex ways to shape the pulses.
(Among other things, using dynamic logic requires each buffer to have both an input that pulls it high and an input that pulls it low, forming almost a circular problem.)
These gates are mostly built from large transistors, as shown below, to provide enough current to drive the circuitry,
and to increase the gate delay sufficiently.
The clock circuitry also uses many capacitors, probably <a href="https://www.righto.com/2020/10/how-bootstrap-load-made-historic-intel.html">bootstrap loads</a> to pull signals up sharper.
I&#39;m not going to describe the clocks in detail since it&#39;s a complicated mess.</p>
<p><a href="https://static.righto.com/images/mk4116/clock-transistors.jpg"><img alt="A small part of the clock circuitry." height="393" src="https://static.righto.com/images/mk4116/clock-transistors-w600.jpg" title="A small part of the clock circuitry." width="600"/></a></p><p>A small part of the clock circuitry.</p>
<h2>Input pins</h2>
<p>The chip uses surprisingly complex circuits for the address pins and the data input pin.
Mostek&#39;s earlier memory chip had problems due to noise margins on the inputs, so the MK4116 uses a complex circuit with
an analog threshold, capacitor drive, and multiple controls and latches.
<!-- 16K - The new generation dynamic RAM, Coker, http://www.bitsavers.org/components/mostek/_dataBooks/1979_Mostek_Memory_Data_Book_and_Designers_Guide_Mar79.pdf p255 --></p>
<p>The diagram below shows the threshold generation circuit, which generates a 1.5-volt reference. It uses many tiny transistors in series to generate the voltage level.
Conceptually, it is similar to a resistor divider between power and ground to produce an output voltage.
However, resistors are both power-hungry and difficult to build in integrated circuits, so transistors are used instead.
Since this circuit is always active, the designers needed to minimize its current; this was achieved by using many
transistors in series.</p>
<p><a href="https://static.righto.com/images/mk4116/voltage-ref-diagram.jpg"><img alt="The voltage reference used for the address pins. (×18 indicates 18 transistors in series, for instance.)" height="278" src="https://static.righto.com/images/mk4116/voltage-ref-diagram-w700.jpg" title="The voltage reference used for the address pins. (×18 indicates 18 transistors in series, for instance.)" width="700"/></a></p><p>The voltage reference used for the address pins. (×18 indicates 18 transistors in series, for instance.)</p>
<p>The voltage on the input pin and the threshold voltage are fed into a differential amplifier/comparator, conceptually similar to the sense amplifiers.
Each side tries to pull the other side low, ending up with a 1 for the &#34;winning&#34; side and 0 for the &#34;losing&#34; side.
Thus, the input is converted into a binary value.
The result from the comparator is stored in a latch.
Multiple timing signals gate the input signal, precharge the circuitry, and control the latch.
<!--
Each side of the comparator has large capacitors connected to help drive the latch.
--></p>
<p><a href="https://static.righto.com/images/mk4116/data-in.jpg"><img alt="The data-in circuitry: the pin, latch circuit, and voltage reference. This circuitry is in the lower-left corner of the die." height="208" src="https://static.righto.com/images/mk4116/data-in-w400.jpg" title="The data-in circuitry: the pin, latch circuit, and voltage reference. This circuitry is in the lower-left corner of the die." width="400"/></a></p><p>The data-in circuitry: the pin, latch circuit, and voltage reference. This circuitry is in the lower-left corner of the die.</p>
<p>The photo above shows the input circuit for the data-in pin. Next to the pin&#39;s bond wire is the threshold circuit and latch; the two capacitors
are the large rectangles of metal.
The voltage reference circuit is next; the data-in voltage reference is similar to the address voltage reference described above.
(I left the metal layer on for this photo; the polysilicon and silicon underneath is obscured
by the oxide layer.)</p>
<h2>Conclusion</h2>
<p>This memory chip was much more complex than I expected.
I studied a <a href="https://www.righto.com/2017/07/inside-intels-first-product-3101-ram.html">simple Intel memory chip</a> earlier so I
assumed this DRAM would be larger but not much more complicated.
Instead, the MK4116 has complex circuitry with over 1000 transistors controlling it,
in addition to the 16,384 transistors for the memory cells and about 1500 transistors for the column selects and sense amps.
A cause of the complexity is that the design needed to optimize multiple axes: density, speed, and power efficiency.<span id="fnref:2116"><a href="#fn:2116">16</a></span></p>
<!--
The clock generation circuitry in particular is complicated with long chains of transistor circuits generating the
internal sequences of pulses that control the operation of the chip.
The second factor that makes the chip complex is its use of low-power dynamic logic.
As a result circuits are both more complicated than most chips and can't be broken down into simple gates.

Even so, reverse-engineering the chip reveals its interesting construction and unusual circuits.
Each bit is stored in a highly-optimized transistor/capacitor circuit, constructed from two layers of polysilicon with a compact
and dense layout.
-->

<p>The table below shows that each generation of DRAM chips required substantial technological changes and new developments.
Memory designers don&#39;t just
sit around waiting for Moore&#39;s Law to increase the memory capacity; they have to constantly develop new techniques because
DRAM storage cells are fundamentally analog.
Fortunately, DRAM designers have continued to solve memory scaling problems;
16-gigabit DRAMs <a href="https://www.businesswire.com/news/home/20200831005214/en/Samsung-Begins-Mass-Production-of-16Gb-LPDDR5-DRAM-at-Worlds-Largest-Semiconductor-Line">recently went into production</a>,
an amazing factor of a million larger than the 16-kilobit MK4116 DRAM chip of 1976.</p>
<p><a href="https://static.righto.com/images/mk4116/dram-cell-evolution.jpg"><img alt="DRAM cell evolution from 4 kilobits to 16 megabits. From Impact of Processing Technology on DRAM Sense Amplifier Design (Gealow, 1990)." height="363" src="https://static.righto.com/images/mk4116/dram-cell-evolution-w400.jpg" title="DRAM cell evolution from 4 kilobits to 16 megabits. From Impact of Processing Technology on DRAM Sense Amplifier Design (Gealow, 1990)." width="400"/></a></p>
<p>I announce my latest blog posts on Twitter, so follow me <a href="https://twitter.com/kenshirriff">@kenshirriff</a> or my <a href="https://www.righto.com/feeds/posts/default">RSS feed</a>. Thanks to <a href="https://twitter.com/mibraden/status/1316808957739098114">Mike Braden</a> for suggesting the MK4332 chip to me.</p>
<h2>Notes and references</h2>


</div></div>
  </body>
</html>
