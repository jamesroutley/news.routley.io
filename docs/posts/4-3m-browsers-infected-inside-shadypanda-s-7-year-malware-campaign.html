<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.koi.ai/blog/4-million-browsers-infected-inside-shadypanda-7-year-malware-campaign">Original</a>
    <h1>4.3M Browsers Infected: Inside ShadyPanda&#39;s 7-Year Malware Campaign</h1>
    
    <div id="readability-page-1" class="page"><div><div><div id="blog-rich-text"><p>Koi researchers have identified a threat actor we&#39;re calling ShadyPanda - responsible for a seven-year browser extension campaign that has infected 4.3 million Chrome and Edge users.</p><p>Our investigation uncovered two active operations:</p><p><strong>A 300,000-user RCE backdoor:</strong> Five extensions, including the &#34;Featured&#34; and &#34;Verified&#34; Clean Master, were weaponized in mid-2024 after years of legitimate operation. These extensions now run hourly remote code execution - downloading and executing arbitrary JavaScript with full browser access. They monitor every website visit, exfiltrate encrypted browsing history, and collect complete browser fingerprints.</p><p><strong>A 4-million-user spyware operation:</strong> Five additional extensions from the same publisher, including WeTab with 3 million installs alone, are actively collecting every URL visited, search query, and mouse click - transmitting data to servers in China.</p><p>Some of ShadyPanda&#39;s extensions were featured and verified by Google, granting instant trust and massive distribution. For seven years, this actor learned how to weaponize browser marketplaces - building trust, accumulating users, and striking through silent updates.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c56_b161140f.png" loading="lazy" alt=""/></p><figcaption>Clean Master - the malware that was featured by Google</figcaption></figure><h2>Phase 1: The Wallpaper Hustle (145 Extensions)</h2><p>ShadyPanda&#39;s first campaign was straightforward but massive, and took place during 2023. 145 extensions total across both marketplaces - 20 on Chrome Web Store under publisher nuggetsno15, and 125 on Microsoft Edge under publisher rocket Zhang. All disguised as wallpaper or productivity apps.</p><p>The attack was simple affiliate fraud. Every time a user clicked on eBay, Amazon, or Booking.com, ShadyPanda&#39;s extensions silently injected affiliate tracking codes. Hidden commissions on every purchase. The extensions also deployed Google Analytics tracking to monetize browsing data - every website visit, search query, and click pattern logged and sold.</p><p>This phase wasn&#39;t sophisticated, but it was successful, ShadyPanda learned three critical lessons:</p><ul role="list"><li>Chrome&#39;s review process focused on initial submission, not ongoing behavior</li><li>Users trust extensions with high install counts and positive reviews</li><li>Patience pays off - some extensions operated for months before detection. The longer you look legitimate, the more damage you can do.</li></ul><h2>Phase 2: Search Hijacking Evolution</h2><p>ShadyPanda got bolder. The next wave, in early 2024, shifted from passive monetization to active browser control.</p><p>The Infinity V+ extension exemplifies this phase. Disguised as a new tab productivity tool, it hijacked core browser functionality:</p><p><strong>Search redirection:</strong> Every web search was redirected through trovi.com - a known browser hijacker. Search queries logged, monetized, and sold. Search results manipulated for profit.</p><p><strong>Cookie exfiltration:</strong> Extensions read cookies from specific domains and send tracking data to nossl.dergoodting.com. Created unique identifiers to monitor browsing activity. All without consent or disclosure.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c5f_57156942.png" loading="lazy" alt=""/></p><figcaption>Cookie exfiltration</figcaption></figure><p><strong>Search query harvesting:</strong> Every keystroke in the search box sent to external servers (<code>s-85283.gotocdn[.]com</code> and<code> s-82923.gotocdn[.]com</code>). Real-time profiling of user interests before you even hit enter. The extension captures partial queries, typos, corrections - building a detailed map of your thought process. All transmitted over unencrypted HTTP connections, making the data easy to intercept and monetize. Not just what you search for, but how you think about searching for it.</p><p>ShadyPanda was learning and getting more aggressive. But they were still getting caught. Extensions were being reported and removed within weeks or months of deployment.</p><p>They needed a better strategy.</p><h2>Phase 3: The Long Game</h2><p>Five extensions. Three uploaded in 2018-2019 - including Clean Master with 200,000+ installs. All operated legitimately for years, gaining Featured and Verified status.</p><p>The strategy: build trust, accumulate users, then weaponize via a single update.</p><p>Before weaponization, ShadyPanda deployed covert installation tracking to optimize distribution. Data-driven malware development.</p><p>Mid 2024: After accumulating 300,000+ installs, ShadyPanda pushed the malicious update. Automatic infection via Chrome and Edge&#39;s trusted auto-update mechanism. All five extensions now run identical malware.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c59_f288a824.png" loading="lazy" alt=""/></p><figcaption>Koidex report on Speedtest Pro-Free</figcaption></figure><h3>Remote Code Execution: The Hourly Weapon</h3><p>Every infected browser runs a remote code execution framework. Every hour, it checks api.extensionplay[.]com for new instructions, downloads arbitrary JavaScript, and executes it with full browser API access.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c5c_6d37b294.png" loading="lazy" alt=""/></p><figcaption>Remote code execution</figcaption></figure><p>This isn&#39;t malware with a fixed function. It&#39;s a backdoor. ShadyPanda decides what it does. Today it&#39;s surveillance, tomorrow it could be ransomware, credential theft, or corporate espionage. The update mechanism runs automatically, hourly, forever.</p><h3>Complete Browser Surveillance</h3><p>The current payload monitors every website visit and exfiltrates encrypted data to ShadyPanda&#39;s servers:</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c65_28322d95.png" loading="lazy" alt=""/></p></figure><p>What gets collected and exfiltrated:</p><ul role="list"><li>Every URL visited with full browsing history</li><li>HTTP referrers showing navigation patterns</li><li>Timestamps for activity profiling</li><li>Persistent UUID4 identifiers (stored in chrome.storage.sync, survives across devices)</li><li>Complete browser fingerprints: user agent, language, platform, screen resolution, timezone</li><li>All data encrypted with AES before sending to api.cleanmasters.store</li></ul><h3>Evasion &amp; Attack Capabilities</h3><p><strong>Anti-analysis:</strong> If a researcher opens developer tools, the malware detects it and switches to benign behavior. The code uses heavy obfuscation with shortened variable names and executes through a 158KB JavaScript interpreter to bypass Content Security Policy.</p><p><strong>Man-in-the-Middle:</strong> Service worker can intercept and modify network traffic, replace legitimate JavaScript files with malicious versions, enabling credential theft, session hijacking, and content injection into any website - even HTTPS connections.</p><p>ShadyPanda can update any of these capabilities hourly. Even though the extensions were recently removed from marketplaces, the infrastructure for full-scale attacks remains deployed on all infected browsers.</p><h2>Phase 4: The Spyware Empire (5 Extensions, 4M+ Users)</h2><p>However, ShadyPanda&#39;s biggest operation wasn&#39;t Clean Master. The same publisher behind Clean Master in Edge - Starlab Technology - launched 5 additional extensions on Microsoft Edge around 2023, accumulating over 4 million combined installs.</p><p>And here&#39;s the problem: ALL 5 extensions are still live in the Microsoft Edge marketplace. Unlike Phase 3&#39;s removed extensions, this 4-million-user surveillance operation is active right now.</p><p>Two of the five are comprehensive spyware. The flagship, WeTab 新标签页 (WeTab New Tab Page), has 3 million installs alone and functions as a sophisticated surveillance platform disguised as a productivity tool.</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c68_2dd22c2d.png" loading="lazy" alt=""/></p></figure><h3>Comprehensive Data Collection</h3><p>WeTab collects and exfiltrates extensive user data to 17 different domains (8 Baidu servers in China, 7 WeTab servers in China, and Google Analytics):</p><figure><p><img src="https://cdn.prod.website-files.com/689ad8c5d13f40cf59df0e0c/6928c38b210340943bdc8c62_7cc2d35b.png" loading="lazy" alt=""/></p></figure><p>What gets collected:</p><ul role="list"><li>Every URL visited - complete browsing history transmitted in real-time</li><li>All search queries - keystroke-level monitoring of what users search for</li><li>Mouse click tracking with pixel-level precision - X/Y coordinates and element identification</li><li>Browser fingerprinting - screen resolution, language, timezone, user agent</li><li>Page interaction data - time on page, scroll behavior, active viewing time</li><li>Storage access - reads localStorage, sessionStorage, and can access all cookies</li></ul><p>Phase 4 dwarfs the Clean Master operation: 4 million infected users versus 300,000. The extensions remain live in Microsoft Edge marketplace - the extension already has dangerous permissions including access to all URLs and cookies, users are downloading them right now. ShadyPanda can push updates at any time, weaponizing 4 million browsers with the same RCE backdoor framework from Phase 3, or something even worse. The infrastructure is in place. The permissions are granted. The update mechanism works automatically.</p><h2>Seven Years of Exploitation</h2><p>ShadyPanda&#39;s success isn&#39;t just about technical sophistication. It&#39;s about systematically exploiting the same vulnerability for seven years: Marketplaces review extensions at submission. They don&#39;t watch what happens after approval.</p><p>What linked all these campaigns together: code signing similarities, overlapping infrastructure, identical obfuscation techniques evolving over time. Same actor. Different masks. Each phase learned from the last - from crude affiliate fraud to patient five-year operations.</p><p>The auto-update mechanism - designed to keep users secure - became the attack vector. Chrome and Edge&#39;s trusted update pipeline silently delivered malware to users. No phishing. No social engineering. Just trusted extensions with quiet version bumps that turned productivity tools into surveillance platforms.</p><p>ShadyPanda controls what happens next: session hijacking, credential harvesting, account takeover, supply chain attacks through compromised developers. For enterprises, infected developer workstations mean compromised repositories and stolen API keys. Browser-based authentication to SaaS platforms, cloud consoles, and internal tools means every login is visible to ShadyPanda. Extensions bypass traditional security controls. ShadyPanda has been inside your network for over a year.</p><p>The systemic problem isn&#39;t just one malicious actor. It&#39;s that the security model incentivizes this behavior:</p><ol role="list"><li>Build something legitimate</li><li>Pass review and gain trust signals (installs, reviews, verified badges)</li><li>Collect large user base</li><li>Weaponize via update</li><li>Profit before detection</li></ol><p>ShadyPanda proved this works. And now every sophisticated threat actor knows the playbook.</p><h2>Final Thoughts</h2><p>One patient threat actor and one lesson: Trust is the vulnerability.</p><p>ShadyPanda proved that marketplaces still review extensions the same way they did seven years ago - static analysis at submission, trust after approval, no ongoing monitoring. Clean Master operated legitimately for five years. Static analysis wouldn&#39;t catch this.</p><p>This writeup was authored by the research team at Koi Security.</p><p>We&#39;ve built Koi for this moment. Behavioral analysis and risk scoring for everything your teams pull from marketplaces. We watch what extensions do after installation, not what they claim to be.</p><p><a href="https://www.koi.ai/get-a-demo">Book a demo</a> to see how behavioral monitoring catches threats that evolve after approval.</p><h2>IOCS</h2><p>C&amp;C Domains:</p><ul role="list"><li>extensionplay[.]com</li><li>yearnnewtab[.]com</li><li>api.cgatgpt[.]net</li></ul><p>Exfiltrations Domains:</p><ul role="list"><li>dergoodting[.]com</li><li>yearnnewtab[.]com</li><li>cleanmasters[.]store</li><li>s-85283.gotocdn[.]com</li><li>s-82923.gotocdn[.]com</li></ul><p>Chrome Extensions:</p><ul role="list"><li>eagiakjmjnblliacokhcalebgnhellfi</li><li>ibiejjpajlfljcgjndbonclhcbdcamai</li><li>ogjneoecnllmjcegcfpaamfpbiaaiekh</li><li>jbnopeoocgbmnochaadfnhiiimfpbpmf</li><li>cdgonefipacceedbkflolomdegncceid</li><li>gipnpcencdgljnaecpekokmpgnhgpela</li><li>bpgaffohfacaamplbbojgbiicfgedmoi</li><li>ineempkjpmbdejmdgienaphomigjjiej</li><li>nnnklgkfdfbdijeeglhjfleaoagiagig</li><li>Mljmfnkjmcdmongjnnnbbnajjdbojoci</li><li>llkncpcdceadgibhbedecmkencokjajg</li><li>nmfbniajnpceakchicdhfofoejhgjefb</li><li>ijcpbhmpbaafndchbjdjchogaogelnjl</li><li>olaahjgjlhoehkpemnfognpgmkbedodk</li><li>gnhgdhlkojnlgljamagoigaabdmfhfeg</li><li>cihbmmokhmieaidfgamioabhhkggnehm</li><li>lehjnmndiohfaphecnjhopgookigekdk</li><li>hlcjkaoneihodfmonjnlnnfpdcopgfjk</li><li>hmhifpbclhgklaaepgbabgcpfgidkoei</li><li>lnlononncfdnhdfmgpkdfoibmfdehfoj</li><li>nagbiboibhbjbclhcigklajjdefaiidc</li><li>ofkopmlicnffaiiabnmnaajaimmenkjn</li><li>ocffbdeldlbilgegmifiakciiicnoaeo</li><li>eaokmbopbenbmgegkmoiogmpejlaikea</li><li>lhiehjmkpbhhkfapacaiheolgejcifgd</li><li>ondhgmkgppbdnogfiglikgpdkmkaiggk</li><li>imdgpklnabbkghcbhmkbjbhcomnfdige</li></ul><p>Edge Add-ons:</p><ul role="list"><li>bpelnogcookhocnaokfpoeinibimbeff</li><li>enkihkfondbngohnmlefmobdgkpmejha</li><li>hajlmbnnniemimmaehcefkamdadpjlfa</li><li>aadnmeanpbokjjahcnikajejglihibpd</li><li>ipnidmjhnoipibbinllilgeohohehabl</li><li>fnnigcfbmghcefaboigkhfimeolhhbcp</li><li>nlcebdoehkdiojeahkofcfnolkleembf</li><li>fhababnomjcnhmobbemagohkldaeicad</li><li>nokknhlkpdfppefncfkdebhgfpfilieo</li><li>ljmcneongnlaecabgneiippeacdoimaa</li><li>onifebiiejdjncjpjnojlebibonmnhog</li><li>dbagndmcddecodlmnlcmhheicgkaglpk</li><li>fmgfcpjmmapcjlknncjgmbolgaecngfo</li><li>kgmlodoegkmpfkbepkfhgeldidodgohd</li><li>hegpgapbnfiibpbkanjemgmdpmmlecbc</li><li>gkanlgbbnncfafkhlchnadcopcgjkfli</li><li>oghgaghnofhhoolfneepjneedejcpiic</li><li>fcidgbgogbfdcgijkcfdjcagmhcelpbc</li><li>nnceocbiolncfljcmajijmeakcdlffnh</li><li>domfmjgbmkckapepjahpedlpdedmckbj</li><li>cbkogccidanmoaicgphipbdofakomlak</li><li>bmlifknbfonkgphkpmkeoahgbhbdhebh</li><li>ghaggkcfafofhcfppignflhlocmcfimd</li><li>hfeialplaojonefabmojhobdmghnjkmf</li><li>boiciofdokedkpmopjnghpkgdakmcpmb</li><li>ibfpbjfnpcgmiggfildbcngccoomddmj</li><li>idjhfmgaddmdojcfmhcjnnbhnhbmhipd</li><li>jhgfinhjcamijjoikplacnfknpchndgb</li><li>cgjgmbppcoolfkbkjhoogdpkboohhgel</li><li>afooldonhjnhddgnfahlepchipjennab</li><li>fkbcbgffcclobgbombinljckbelhnpif</li><li>fpokgjmlcemklhmilomcljolhnbaaajk</li><li>hadkldcldaanpomhhllacdmglkoepaed</li><li>iedkeilnpbkeecjpmkelnglnjpnacnlh</li><li>hjfmkkelabjoojjmjljidocklbibphgl</li><li>dhjmmcjnajkpnbnbpagglbbfpbacoffm</li><li>cgehahdmoijenmnhinajnojmmlnipckl</li><li>fjigdpmfeomndepihcinokhcphdojepm</li><li>chmcepembfffejphepoongapnlchjgil</li><li>googojfbnbhbbnpfpdnffnklipgifngn</li><li>fodcokjckpkfpegbekkiallamhedahjd</li><li>igiakpjhacibmaichhgbagdkjmjbnanl</li><li>omkjakddaeljdfgekdjebbbiboljnalk</li><li>llilhpmmhicmiaoancaafdgganakopfg</li><li>nemkiffjklgaooligallbpmhdmmhepll</li><li>papedehkgfhnagdiempdbhlgcnioofnd</li><li>glfddenhiaacfmhoiebfeljnfkkkmbjb</li><li>pkjfghocapckmendmgdmppjccbplccbg</li><li>gbcjipmcpedgndgdnfofbhgnkmghoamm</li><li>ncapkionddmdmfocnjfcfpnimepibggf</li><li>klggeioacnkkpdcnapgcoicnblliidmf</li><li>klgjbnheihgnmimajhohfcldhfpjnahe</li><li>acogeoajdpgplfhidldckbjkkpgeebod</li><li>ekndlocgcngbpebppapnpalpjfnkoffh</li><li>elckfehnjdbghpoheamjffpdbbogjhie</li><li>dmpceopfiajfdnoiebfankfoabfehdpn</li><li>gpolcigkhldaighngmmmcjldkkiaonbg</li><li>dfakjobhimnibdmkbgpkijoihplhcnil</li><li>hbghbdhfibifdgnbpaogepnkekonkdgc</li><li>fppchnhginnfabgenhihpncnphhafmac</li><li>ghhddclfklljabeodmcejjjlhoaaiban</li><li>bppelgkcnhfkicolffhlkbdghdnjdkhi</li><li>ikgaleggljchgbihlaanjbkekmmgccam</li><li>bdhjinjoglaijpffoamhhnhooeimgoap</li><li>fjioinpkgmlcioajfnncgldldcnabffe</li><li>opncjjhgbllenobgbfjbblhghmdpmpbj</li><li>cbijiaccpnkbdpgbmiiipedpepbhioel</li><li>fbbmnieefocnacnecccgmedmcbhlkcpm</li><li>hmbacpfgehmmoloinfmkgkpjoagiogai</li><li>paghkadkhiladedijgodgghaajppmpcg</li><li>bafbmfpfepdlgnfkgfbobplkkaoakjcl</li><li>kcpkoopmfjhdpgjohcbgkbjpmbjmhgoi</li><li>jelgelidmodjpmohbapbghdgcpncahki</li><li>lfgakdlafdenmaikccbojgcofkkhmolj</li><li>hdfknlljfbdfjdjhfgoonpphpigjjjak</li><li>kpfbijpdidioaomoecdbfaodhajbcjfl</li><li>fckphkcbpgmappcgnfieaacjbknhkhin</li><li>lhfdakoonenpbggbeephofdlflloghhi</li><li>ljjngehkphcdnnapgciajcdbcpgmpknc</li><li>ejfocpkjndmkbloiobcdhkkoeekcpkik</li><li>ccdimkoieijdbgdlkfjjfncmihmlpanj</li><li>agdlpnhabjfcbeiempefhpgikapcapjb</li><li>mddfnhdadbofiifdebeiegecchpkbgdb</li><li>alknmfpopohfpdpafdmobclioihdkhjh</li><li>hlglicejgohbanllnmnjllajhmnhjjel</li><li>iaccapfapbjahnhcmkgjjonlccbhdpjl</li><li>ehmnkbambjnodfbjcebjffilahbfjdml</li><li>ngbfciefgjgijkkmpalnmhikoojilkob</li><li>laholcgeblfbgdhkbiidbpiofdcbpeeo</li><li>njoedigapanaggiabjafnaklppphempm</li><li>fomlombffdkflbliepgpgcnagolnegjn</li><li>jpoofbjomdefajdjcimmaoildecebkjc</li><li>nhdiopbebcklbkpfnhipecgfhdhdbfhb</li><li>gdnhikbabcflemolpeaaknnieodgpiie</li><li>bbdioggpbhhodagchciaeaggdponnhpa</li><li>ikajognfijokhbgjdhgpemljgcjclpmn</li><li>lmnjiioclbjphkggicmldippjojgmldk</li><li>ffgihbmcfcihmpbegcfdkmafaplheknk</li><li>lgnjdldkappogbkljaiedgogobcgemch</li><li>hiodlpcelfelhpinhgngoopbmclcaghd</li><li>mnophppbmlnlfobakddidbcgcjakipin</li><li>jbajdpebknffiaenkdhopebkolgdlfaf</li><li>ejdihbblcbdfobabjfebfjfopenohbjb</li><li>ikkoanocgpdmmiamnkogipbpdpckcahn</li><li>ileojfedpkdbkcchpnghhaebfoimamop</li><li>akialmafcdmkelghnomeneinkcllnoih</li><li>eholblediahnodlgigdkdhkkpmbiafoj</li><li>ipokalojgdmhfpagmhnjokidnpjfnfik</li><li>hdpmmcmblgbkllldbccfdejchjlpochf</li><li>iphacjobmeoknlhenjfiilbkddgaljad</li><li>jiiggekklbbojgfmdenimcdkmidnfofl</li><li>gkhggnaplpjkghjjcmpmnmidjndojpcn</li><li>opakkgodhhongnhbdkgjgdlcbknacpaa</li><li>nkjomoafjgemogbdkhledkoeaflnmgfi</li><li>ebileebbekdcpfjlekjapgmbgpfigled</li><li>oaacndacaoelmkhfilennooagoelpjop</li><li>ljkgnegaajfacghepjiajibgdpfmcfip</li><li>hgolomhkdcpmbgckhebdhdknaemlbbaa</li><li>bboeoilakaofjkdmekpgeigieokkpgfn</li><li>dkkpollfhjoiapcenojlmgempmjekcla</li><li>emiocjgakibimbopobplmfldkldhhiad</li><li>nchdmembkfgkejljapneliogidkchiop</li><li>lljplndkobdgkjilfmfiefpldkhkhbbd</li><li>hofaaigdagglolgiefkbencchnekjejl</li><li>hohobnhiiohgcipklpncfmjkjpmejjni</li><li>jocnjcakendmllafpmjailfnlndaaklf</li><li>bjdclfjlhgcdcpjhmhfggkkfacipilai</li><li>ahebpkbnckhgjmndfjejibjjahjdlhdb</li><li>enaigkcpmpohpbokbfllbkijmllmpafm</li><li>bpngofombcjloljkoafhmpcjclkekfbh</li><li>cacbflgkiidgcekflfgdnjdnaalfmkob</li><li>ibmgdfenfldppaodbahpgcoebmmkdbac</li></ul><p>‍</p></div></div></div></div>
  </body>
</html>
