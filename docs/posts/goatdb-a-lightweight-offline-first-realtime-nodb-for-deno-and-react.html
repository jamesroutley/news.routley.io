<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/goatplatform/goatdb">Original</a>
    <h1>Show HN: GoatDB ‚Äì A lightweight, offline-first, realtime NoDB for Deno and React</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
  <themed-picture data-catalyst-inline="true"><picture>
    <source media="(prefers-color-scheme: dark)" srcset="https://github.com/user-attachments/assets/4975e49c-e73c-435e-8e10-97adc2c0aaeb"/>
    <source media="(prefers-color-scheme: light)" srcset="https://github.com/user-attachments/assets/270caf47-3ed8-49d4-b3b9-74a51bd2d6c0"/>
    <img alt="GoatDB Logo" src="https://github.com/user-attachments/assets/270caf47-3ed8-49d4-b3b9-74a51bd2d6c0"/>
  </picture></themed-picture>
</p>
<hr/>

<p dir="auto">GoatDB is a real-time, version-controlled database for
<strong><a href="https://deno.com/" rel="nofollow">Deno</a></strong>, <strong><a href="https://react.dev/" rel="nofollow">React</a></strong>, and low-friction
deployments. It‚Äôs ideal for <strong>prototyping</strong>, <strong>self-hosting</strong>, <strong>single-tenant</strong>
apps, as well as <strong>ultra light multi-tenant</strong> setups without heavy backends or
complex DBs.</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>No Dedicated Infra</strong>: Run the entire DB client-side, with incremental
queries that remove the need for server-side indexing.</p>
</li>
<li>
<p dir="auto"><strong>Resilience &amp; Offline-First</strong>: If the server goes down, clients keep working
and can restore server state on reboot.</p>
</li>
<li>
<p dir="auto"><strong>Edge-Native</strong>: Most processing happens in the client, keeping servers light
and fast.</p>
</li>
<li>
<p dir="auto"><strong>Real-Time Collaboration</strong>: Built-in sync automatically keeps client and
server state synchronized in real-time.</p>
</li>
</ul>
<p dir="auto">üëâ If you like what we&#39;re building, please star ‚≠êÔ∏è our project. We really
appreciate it! üôè</p>
<ul dir="auto">
<li><a href="https://goatdb.dev/tutorial" rel="nofollow">Tutorial</a></li>
<li><a href="https://goatdb.dev" rel="nofollow">Documentation</a></li>
<li><a href="https://goatdb.dev/faq" rel="nofollow">FAQ</a></li>
</ul>

<p dir="auto">Explore projects built with GoatDB:</p>
<ul dir="auto">
<li>
<p dir="auto"><strong><a href="https://github.com/goatplatform/todo">Todo</a></strong>: A minimalist, modern, todo
list app specifically designed for self hosting.</p>
</li>
<li>
<p dir="auto"><strong><a href="https://github.com/goatplatform/edge-chat">EdgeChat</a></strong>: A demo of a
ChatGPT-like interface that runs completely in the browser, no network
connection needed.</p>
</li>
<li>
<p dir="auto"><strong><a href="https://ovvio.io" rel="nofollow">Ovvio</a></strong>: A productivity suite that has been powered by
GoatDB in production since January 2024.</p>
</li>
</ul>

<ol dir="auto">
<li>
<p dir="auto"><strong>Add GoatDB to your project:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="deno add jsr:@goatdb/goatdb"><pre>deno add jsr:@goatdb/goatdb</pre></div>
</li>
<li>
<p dir="auto"><strong>Initialize the React Skaffold:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="deno run -A jsr:@goatdb/goatdb/init"><pre>deno run -A jsr:@goatdb/goatdb/init</pre></div>
<blockquote>
<p dir="auto"><strong>Note</strong>: This step is only needed for Single Page Applications (SPAs). The
initialization command installs React dependencies and creates a project
skaffold that includes both client-side and server-side code structure. If
you&#39;re not building a SPA or already have your React setup, you can skip
this step.</p>
</blockquote>
</li>
</ol>

<div dir="auto" data-snippet-clipboard-copy-content="import { GoatDB } from &#39;@goatdb/goatdb&#39;;

const db = new GoatDB({ path: &#39;./server-data&#39; peers: [&#39;http://10.0.0.1&#39;] });
const item = db.create(&#39;/todos&#39;, { text: &#39;Hello, GoatDB!&#39;, done: false });

// Update in memory; auto-commits in background
item.set(&#39;done&#39;, true);

console.log(item.get(&#39;text&#39;), item.get(&#39;done&#39;));
// Output: &#34;Hello, GoatDB!&#34; true"><pre><span>import</span> <span>{</span> <span>GoatDB</span> <span>}</span> <span>from</span> <span>&#39;@goatdb/goatdb&#39;</span><span>;</span>

<span>const</span> <span>db</span> <span>=</span> <span>new</span> <span>GoatDB</span><span>(</span><span>{</span> <span>path</span>: <span>&#39;./server-data&#39;</span> <span>peers</span>: <span>[</span><span>&#39;http://10.0.0.1&#39;</span><span>]</span> <span>}</span><span>)</span><span>;</span>
<span>const</span> <span>item</span> <span>=</span> <span>db</span><span>.</span><span>create</span><span>(</span><span>&#39;/todos&#39;</span><span>,</span> <span>{</span> <span>text</span>: <span>&#39;Hello, GoatDB!&#39;</span><span>,</span> <span>done</span>: <span>false</span> <span>}</span><span>)</span><span>;</span>

<span>// Update in memory; auto-commits in background</span>
<span>item</span><span>.</span><span>set</span><span>(</span><span>&#39;done&#39;</span><span>,</span> <span>true</span><span>)</span><span>;</span>

<span>console</span><span>.</span><span>log</span><span>(</span><span>item</span><span>.</span><span>get</span><span>(</span><span>&#39;text&#39;</span><span>)</span><span>,</span> <span>item</span><span>.</span><span>get</span><span>(</span><span>&#39;done&#39;</span><span>)</span><span>)</span><span>;</span>
<span>// Output: &#34;Hello, GoatDB!&#34; true</span></pre></div>
<p dir="auto">GoatDB makes it easy to set up a cluster of servers by specifying replica
locations in the <code>peers</code> field during initialization. Each server will
automatically synchronize with its replicas at the provided URLs, using the same
efficient sync protocol that clients use to stay in sync with servers. This
means you can easily scale out your deployment by adding more replicas without
changing any code or protocols - the servers will seamlessly coordinate using
the built-in sync mechanism.</p>

<p dir="auto">GoatDB&#39;s React hooks provide a complete state management solution with mutable
state that you can edit synchronously. When you make changes (like
<code>task.set(&#39;done&#39;, true)</code>), they&#39;re applied immediately in memory while GoatDB
handles computing diffs, committing to local storage, syncing with the server,
and resolving conflicts automatically in the background. This gives you simple
local state management with automatic cross-client synchronization and server
persistence. Here&#39;s how the hooks work in practice:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import { useDB, useItem, useQuery } from &#39;@goatdb/goatdb/react&#39;;

// Use hooks in your components
function TaskList() {
  const db = useDB();

  // Query tasks sorted by text
  const query = useQuery({
    schema: kSchemaTask,
    source: `/data/${db.currentUser!.key}`,
    sortDescriptor: ({ left, right }) =&gt;
      left.get(&#39;text&#39;).localeCompare(right.get(&#39;text&#39;)),
  });

  return (
    &lt;div&gt;
      {query.results().map(({ path }) =&gt; &lt;TaskItem key={path} path={path} /&gt;)}
    &lt;/div&gt;
  );
}

function TaskItem({ path }) {
  // Subscribe to changes for a specific task
  const task = useItem(path);

  return (
    &lt;div&gt;
      &lt;input
        type=&#39;checkbox&#39;
        checked={task.get(&#39;done&#39;)}
        onChange={(e) =&gt; task.set(&#39;done&#39;, e.target.checked)}
      /&gt;
      &lt;input
        type=&#39;text&#39;
        value={task.get(&#39;text&#39;)}
        onChange={(e) =&gt; task.set(&#39;text&#39;, e.target.value)}
      /&gt;
    &lt;/div&gt;
  );
}"><pre><span>import</span> <span>{</span> <span>useDB</span><span>,</span> <span>useItem</span><span>,</span> <span>useQuery</span> <span>}</span> <span>from</span> <span>&#39;@goatdb/goatdb/react&#39;</span><span>;</span>

<span>// Use hooks in your components</span>
<span>function</span> <span>TaskList</span><span>(</span><span>)</span> <span>{</span>
  <span>const</span> <span>db</span> <span>=</span> <span>useDB</span><span>(</span><span>)</span><span>;</span>

  <span>// Query tasks sorted by text</span>
  <span>const</span> <span>query</span> <span>=</span> <span>useQuery</span><span>(</span><span>{</span>
    <span>schema</span>: <span>kSchemaTask</span><span>,</span>
    <span>source</span>: <span>`/data/<span><span>${</span><span>db</span><span>.</span><span>currentUser</span><span>!</span><span>.</span><span>key</span><span>}</span></span>`</span><span>,</span>
    <span>sortDescriptor</span>: <span>(</span><span>{</span> left<span>,</span> right <span>}</span><span>)</span> <span>=&gt;</span>
      <span>left</span><span>.</span><span>get</span><span>(</span><span>&#39;text&#39;</span><span>)</span><span>.</span><span>localeCompare</span><span>(</span><span>right</span><span>.</span><span>get</span><span>(</span><span>&#39;text&#39;</span><span>)</span><span>)</span><span>,</span>
  <span>}</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span><span>&gt;</span>
      <span>{</span><span>query</span><span>.</span><span>results</span><span>(</span><span>)</span><span>.</span><span>map</span><span>(</span><span>(</span><span>{</span> path <span>}</span><span>)</span> <span>=&gt;</span> <span>&lt;</span><span>TaskItem</span> <span>key</span><span>=</span><span>{</span><span>path</span><span>}</span> <span>path</span><span>=</span><span>{</span><span>path</span><span>}</span> <span>/&gt;</span><span>)</span><span>}</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span>

<span>function</span> <span>TaskItem</span><span>(</span><span>{</span> path <span>}</span><span>)</span> <span>{</span>
  <span>// Subscribe to changes for a specific task</span>
  <span>const</span> <span>task</span> <span>=</span> <span>useItem</span><span>(</span><span>path</span><span>)</span><span>;</span>

  <span>return</span> <span>(</span>
    <span>&lt;</span><span>div</span><span>&gt;</span>
      <span>&lt;</span><span>input</span>
        <span>type</span><span>=</span><span>&#39;checkbox&#39;</span>
        <span>checked</span><span>=</span><span>{</span><span>task</span><span>.</span><span>get</span><span>(</span><span>&#39;done&#39;</span><span>)</span><span>}</span>
        <span>onChange</span><span>=</span><span>{</span><span>(</span><span>e</span><span>)</span> <span>=&gt;</span> <span>task</span><span>.</span><span>set</span><span>(</span><span>&#39;done&#39;</span><span>,</span> <span>e</span><span>.</span><span>target</span><span>.</span><span>checked</span><span>)</span><span>}</span>
      <span>/&gt;</span>
      <span>&lt;</span><span>input</span>
        <span>type</span><span>=</span><span>&#39;text&#39;</span>
        <span>value</span><span>=</span><span>{</span><span>task</span><span>.</span><span>get</span><span>(</span><span>&#39;text&#39;</span><span>)</span><span>}</span>
        <span>onChange</span><span>=</span><span>{</span><span>(</span><span>e</span><span>)</span> <span>=&gt;</span> <span>task</span><span>.</span><span>set</span><span>(</span><span>&#39;text&#39;</span><span>,</span> <span>e</span><span>.</span><span>target</span><span>.</span><span>value</span><span>)</span><span>}</span>
      <span>/&gt;</span>
    <span>&lt;/</span><span>div</span><span>&gt;</span>
  <span>)</span><span>;</span>
<span>}</span></pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Running the Interactive Server</h2><a id="user-content-running-the-interactive-server" aria-label="Permalink: Running the Interactive Server" href="#running-the-interactive-server"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<p dir="auto">Starts an interactive debug server that listens on <a href="http://localhost:8080" rel="nofollow">http://localhost:8080</a>.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Compiling a Server Binary</h2><a id="user-content-compiling-a-server-binary" aria-label="Permalink: Compiling a Server Binary" href="#compiling-a-server-binary"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>

<p dir="auto">Builds a self-contained executable that bundles the server, database and client
code together with no external dependencies or containers needed, making it
cloud agnostic and easy to self-host on any server you wish.</p>
<p dir="auto">That‚Äôs it! GoatDB keeps your app running even if the server fails, with clients
seamlessly backing up and restoring data. No complex indexing required, thanks
to incremental queries.</p>

<p dir="auto">Here are some benchmark results from running on a 2018 MacBook Pro:</p>
<ul dir="auto">
<li>Writing: ~0.25ms / item</li>
<li>Reading: &lt; 0.001ms / item</li>
<li>Querying: ~100ms to filter ~3k items from a set of 100k</li>
<li>Opening a Repository: &lt; 1.5 sec / 100k commits</li>
</ul>
<p dir="auto">Both client and server work against a synchronous in-memory snapshot that gets
synchronized in the background several times per second. This architecture
combines the performance benefits of in-memory databases with the reliability of
persistence and replication, allowing these benchmarks to remain consistent
across client and server.</p>

<p dir="auto">GoatDB employs a robust security model where each node maintains its own
public-private key pair. The private key never leaves the local machine,
ensuring secure commit signing, while the public key enables other nodes to
verify changes. Every commit is digitally signed by its originating node,
creating an immutable chain of custody. When commits are received, nodes verify
both the authenticity and integrity using the public key, automatically
rejecting any unauthorized or tampered changes.</p>
<p dir="auto">The system also includes customizable application-level authorization rules that
enforce business policies, such as restricting users to only edit their own
data. This dual-layer approach combines cryptographic verification with flexible
access controls to create a comprehensive security model that protects data
integrity at both the protocol and application levels. Any mutations that
violate either the cryptographic signatures or authorization policies are
rejected, maintaining consistency and security across the network.</p>

<p dir="auto">GoatDB resolves conflicts by performing a three-way merge whenever it finds more
than one differing value on the leaves of its commit graph. Internally, it
transforms the base version of the data into a temporary CRDT, applies the
changes from each branch, and then captures the final merged output before
discarding the CRDT. This approach provides the advantages of CRDTs‚Äîsimple,
automatic resolution of concurrent edits‚Äîwithout forcing every node to maintain
the entire editing history.</p>
<p dir="auto">To handle indexing conflicts efficiently, GoatDB takes inspiration from Logoot
by assigning continuous identifiers to each element in the data, ensuring
insertions and deletions won‚Äôt interfere with each other. When multiple edits
occur at the same location, GoatDB merges them using a globally agreed-upon
order of commits, resolving differences by either choosing one change, combining
both, or merging them (e.g., ‚Äúcat‚Äù + ‚Äúhat‚Äù ‚Üí ‚Äúchat‚Äù). This ensures predictable
conflict handling at scale, making GoatDB well-suited for hackathon projects and
quick prototypes where ease of collaboration and simplicity are key.</p>

<p dir="auto">To contribute to GoatDB, follow these steps:</p>
<ol dir="auto">
<li>Fork the repository</li>
<li>Create a branch for your changes</li>
<li>Submit a pull request</li>
</ol>
<p dir="auto">We strive to review all pull requests within a few business days.</p>
<p dir="auto">To work on GoatDB&#39;s code alongside a project that uses it, run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="deno run -A jsr:@goatdb/goatdb/link link ./path/to/goatdb"><pre>deno run -A jsr:@goatdb/goatdb/link link ./path/to/goatdb</pre></div>
<p dir="auto">This will link the local GoatDB repo into your project, allowing you to make
changes to the codebase and have them reflected in your project without having
to reinstall GoatDB.</p>
<p dir="auto">To unlink GoatDB, run:</p>
<div dir="auto" data-snippet-clipboard-copy-content="deno run -A jsr:@goatdb/goatdb/link unlink"><pre>deno run -A jsr:@goatdb/goatdb/link unlink</pre></div>

<p dir="auto">GoatDB is licensed under the <a href="https://github.com/goatplatform/goatdb/blob/main/LICENSE">Apache 2.0 License</a>.</p>
</article></div></div>
  </body>
</html>
