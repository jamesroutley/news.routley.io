<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/mrmekon/circadian">Original</a>
    <h1>Circadian â€“ Suspend-on-Idle Daemon for GNU/Linux Power Management</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">

<h3 dir="auto"><a id="user-content-suspend-on-idle-daemon-for-gnulinux-power-management" aria-hidden="true" href="#suspend-on-idle-daemon-for-gnulinux-power-management"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Suspend-On-Idle Daemon for GNU/Linux Power Management</h3>

<p dir="auto">Circadian is a background daemon/service for triggering suspend/sleep/hibernate automatically when a computer is idle.</p>
<p dir="auto">It is primarily for stationary devices with permanent power (i.e. desktops, servers, media centers).</p>
<p dir="auto">Circadian uses a suite of &#39;idle heuristics&#39; to determine when a system is idle.  These include:</p>
<ul dir="auto">
<li>User activity in X11 (keyboard, mouse, full-screen playback)</li>
<li>User activity in terminals (typing in PTY/SSH session)</li>
<li>Open SSH connections</li>
<li>Open SMB/Samba connections</li>
<li>Open NFS connections</li>
<li>Active audio playback</li>
<li>CPU usage below specified threshold</li>
<li>Blacklisted processes</li>
</ul>
<p dir="auto">When all of its heuristics determine that your system has been idle for long enough, Circadian will execute a command.  This is typically a simple power suspend, but it can be configured to any desired action.</p>
<p dir="auto">Circadian can also schedule an automatic daily wakeup.  Simply set a wake time in its configuration file and it will wake up once every day at that time (if not already awake).  This allows an easy way to keep a machine updated and backed up, even if it is seldom used.</p>
<p dir="auto">It can also execute a command when it detects that the system has woken up from sleep, regardless of why it woke up.</p>
<p dir="auto">Circadian exists because modern Linux distros already support suspend-on-idle, but it is apparently a very buggy and unreliable domain.  After you&#39;ve followed your distro&#39;s advice of poking a handful of conf files, tweaking a few XML hierarchies, writing a few scripts, wafting the smoke of burning sage across your keyboard, suspending gem stones from your machine, and whatever else may be recommended... perhaps try Circadian.</p>
<h2 dir="auto"><a id="user-content-example-use-cases" aria-hidden="true" href="#example-use-cases"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Example use cases</h2>
<ul dir="auto">
<li>Gaming rig with noisy fans?  Auto-sleep when idle!</li>
<li>Storage/backup machine?  Auto-wake, backup, and auto-sleep!</li>
<li>Seldom used server, but needs to be available?  Wake-on-LAN, and auto-sleep when no SSH connections!</li>
<li>Wake up to your local music library?  Auto-wake, play music, and auto-sleep!</li>
<li>Media center that you only use in evenings? Sleep all day, auto-wake when you get home!</li>
</ul>
<h2 dir="auto"><a id="user-content-status" aria-hidden="true" href="#status"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Status</h2>
<p dir="auto">&#34;Works for me&#34;.  You try.  You give feedback on GitHub, or to <a href="mailto:trevor@trevorbentley.com">trevor@trevorbentley.com</a>.</p>
<h2 dir="auto"><a id="user-content-installing" aria-hidden="true" href="#installing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing</h2>
<h3 dir="auto"><a id="user-content-debian-x86-64" aria-hidden="true" href="#debian-x86-64"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Debian x86-64</h3>
<ul dir="auto">
<li>Download <a href="https://github.com/mrmekon/circadian/releases/download/0.6.0/circadian_0.6.0-1_amd64.deb">Circadian 0.6.0</a></li>
</ul>
<div data-snippet-clipboard-copy-content="$ sudo dpkg -i circadian_0.6.0-1_amd64.deb"><pre><code>$ sudo dpkg -i circadian_0.6.0-1_amd64.deb
</code></pre></div>
<p dir="auto">Edit /etc/circadian.conf to configure.  The default is to suspend with systemd after 2 hours of idle.</p>
<p dir="auto">When you are happy with the config, continue:</p>
<div data-snippet-clipboard-copy-content="$ sudo systemctl enable circadian
$ sudo systemctl start circadian"><pre><code>$ sudo systemctl enable circadian
$ sudo systemctl start circadian
</code></pre></div>
<h3 dir="auto"><a id="user-content-any-other-system-with-systemd" aria-hidden="true" href="#any-other-system-with-systemd"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Any other system with systemd</h3>
<p dir="auto">Install manually.  It&#39;s easy.</p>
<div data-snippet-clipboard-copy-content="$ git clone https://github.com/mrmekon/circadian.git
$ cd circadian
$ cargo build --release
$ sudo cp target/release/circadian /usr/local/bin/
$ sudo cp resources/circadian.conf.in /etc/circadian.conf
$ sudo cp resources/circadian.service /etc/systemd/system/
$ sudo systemctl enable circadian
$ sudo systemctl start circadian"><pre><code>$ git clone https://github.com/mrmekon/circadian.git
$ cd circadian
$ cargo build --release
$ sudo cp target/release/circadian /usr/local/bin/
$ sudo cp resources/circadian.conf.in /etc/circadian.conf
$ sudo cp resources/circadian.service /etc/systemd/system/
$ sudo systemctl enable circadian
$ sudo systemctl start circadian
</code></pre></div>
<h3 dir="auto"><a id="user-content-non-systemd-systems" aria-hidden="true" href="#non-systemd-systems"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Non-systemd systems</h3>
<p dir="auto">Follow systemd instructions, and port circadian.service to whatever format you want.</p>
<h2 dir="auto"><a id="user-content-dependencies" aria-hidden="true" href="#dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Dependencies</h2>
<ul dir="auto">
<li>Might need to install
<ul dir="auto">
<li>xssstate</li>
<li>xprintidle</li>
<li>netstat</li>
<li>rustc + cargo (if building locally)</li>
</ul>
</li>
<li>Should already have
<ul dir="auto">
<li>grep</li>
<li>awk</li>
<li>w</li>
<li>id</li>
<li>uptime</li>
<li>pgrep</li>
<li>cat</li>
<li>sh</li>
</ul>
</li>
</ul>
<p dir="auto">Auto-wake requires kernel support for the real-time clock (RTC).  You can check for the file <code>/sys/class/rtc/rtc0/wakealarm</code>.  You probably have it.</p>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<ul dir="auto">
<li>Should run as root, ideally from systemd.</li>
<li>Config is in: /etc/circadian.conf (it is documented)</li>
<li><code>pkill -SIGUSR1 circadian</code> will dump info to syslog.  Use that to see if it&#39;s working, or find out why it isn&#39;t sleeping.</li>
</ul>
</article>
          </div></div>
  </body>
</html>
