<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://neilzone.co.uk/2025/01/using-esims-with-devices-that-only-have-a-physical-sim-slot-via-a-9esim-sim-card-with-android-and-linux/">Original</a>
    <h1>Using eSIMs with devices that only have a physical SIM slot via a 9eSIM SIM car</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
<article>
    <p>Do you have a phone, tablet, or laptop (or, well, any device…) which will only take a physical SIM, but with which you’d like to use eSIMs?</p>
<p>Then this is a blogpost for you, as that’s exactly what this is: a physical SIM, onto which one can provision eSIMs, using software to swap between them.</p>
<h2 id="what-i-bought-from-9esim">What I bought from 9eSIM</h2>
<p>I bought the bundle - SIM and smartcard reader - from <a href="https://www.9esim.com/">9eSIM</a>.</p>
<p>The first shipment from China got lost but, after a bit of waiting, they posted another one without complaint. That was shipped by a different delivery company, and it arrived in just over a week.</p>
<p>In the box, I got:</p>
<ul>
<li>
<p>A SIM card, with the usual push-out sections to change it from normal to micro to nano.</p>
<ul>
<li>The SIM was in a blue envelope, not attached to the cardboard saying “9eSIM v2” - at first, I thought “they’ve forgotten to put in the SIM card”.</li>
<li>If you want to use the smartcard reader, <em>do not discard the SIM’s packaging</em>. You will need it to make the smartcard reader work reliably.</li>
</ul>
</li>
<li>
<p>A SIM card adapter.</p>
</li>
<li>
<p>A USB smartcard reader, and a USB-A to USB-C adapter.</p>
</li>
</ul>
<p>Including delivery, it came to about £30.</p>
<h2 id="use-the-sims-packaging-to-make-it-fit-in-the-smartcard-reader">Use the SIM’s packaging to make it fit in the smartcard reader</h2>
<p>I spent a <em>lot</em> of time trying to get the SIM and smartcard reader working.</p>
<p>The solution was a frustratingly simple one: the best way to use the supplied smartcard reader is to use the original packaging for the SIM.</p>
<p>This packaging is the right size to slide into the reader while positioning the SIM’s contacts over the contact points on the reader. I will keep that together with the smartcard reader.</p>
<p>When I realised that - rather than trying to slide the popped-out SIM into the right place and keep it there - it Just Worked.</p>
<h2 id="adding-and-switching-esims">Adding and switching eSIMs</h2>
<p>The SIM card is advertised as have “a memory capacity of 1.6M, [which] can store up to 50 groups of eSIM profile data”.</p>
<p>To make use of it, one needs to download one or more eSIMs to the SIM.</p>
<p>To do this, and to switch between profiles, one needs to use a “Local Profile Agent” (or “LPA”).</p>
<p>I tested the process for this using both Android and Linux, and both worked just fine.</p>
<h2 id="test-esim-profiles-you-can-try-to-for-free">Test eSIM profiles you can try to for free</h2>
<p>While I was getting used to how it worked, I didn’t want to buy an actual eSIM.</p>
<p>Fortunately, there are a couple of options.</p>
<p>First, there are four official <a href="https://source.android.com/docs/core/connect/esim-test-profiles">Android test eSIM profiles</a></p>
<p>While I could start to provision these, I could not download them, with what appears to be a TLS error.</p>
<p>Second, osmocom has a <a href="https://euicc-manual.osmocom.org/docs/rsp/known-test-profile/">very useful page of other test profiles</a>.</p>
<p>I was able to install test eSIM profiles for <a href="https://qr.esim.tf/1$rsp.truphone.com$QR-G-5C-1LS-1W1Z9P7">TruPhone</a> and <a href="https://qr.esim.tf/1$rsp.truphone.com$QRF-SPEEDTEST">TruPhone / Speedtest</a>.</p>
<p>These provisioned correctly onto the SIM. I could not use them to make or receive calls or start a data session - which was fine - but they did show up in Android’s SIM card manager as available eSIMs.</p>
<h2 id="adding-and-switching-esims-via-android">Adding and switching eSIMs via Android</h2>
<p>There is an .apk from the 9eSIM site.</p>
<p>I wasn’t too keen on using this but, well, it worked, and is probably the simplest option.</p>
<p>I tested it first by putting the SIM into my phone, replacing my main physical SIM. This was recognised by the app immediately.</p>
<p>Once I had worked out how to correctly seat the SIM in the reader, I tried that too, using a USB-C hub to connect the smartcard reader to my phone. That worked fine too.</p>
<p>Provisioning eSIMs using the Android application was easy as long as the QR code was on a different screen, since I could just scan the QR code for the eSIM using the camera. I’ve not looked to see if there is a way to use Android to import a QR code on its own screen.</p>
<p>Using the 9eSIM application, one can enable and disable eSIMs, and swap between them. Once enabled, they appeared in Android’s own SIM management settings. I did not need to reboot.</p>
<p>Deleting an eSIM is also easy. One needs to type a security phrase - the name of the eSIM - to trigger deletion, which is a simple means of avoiding accidental deletion.</p>
<h2 id="adding-and-switching-esims-via-linux">Adding and switching eSIMs via Linux</h2>
<p>Since I want to use the SIM with the integrated WWAN modem of a laptop running Linux, I was keen to see if I could get this all to work using Linux and Free software.</p>
<p>So far, I have not found a way of writing profiles to the SIM while it is in the laptop - I need to take it out and put it in the smartcard reader.</p>
<p>And, if I’m going to do that then, from a practical point of view, it is little more effort to hook it up to my phone and swap and provisions eSIMs from there.</p>
<p>Still, I wanted to get it working within Linux and FOSS just because.</p>
<h3 id="the-smartcard-reader-and-linux">The smartcard reader and Linux</h3>
<p>Connecting the smartcard reader and running <code>lsusb</code>:</p>
<pre tabindex="0"><code>Bus 001 Device 011: ID 058f:9540 Alcor Micro Corp. AU9540 Smartcard Reader
</code></pre><p>It looks like this is a quite common smartcard reader, sometimes built into laptops.</p>
<p><code>lsusb -s 1:11 -v</code>:</p>
<pre tabindex="0"><code>Bus 001 Device 011: ID 058f:9540 Alcor Micro Corp. AU9540 Smartcard Reader
Negotiated speed: Full Speed (12Mbps)
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.01
  bDeviceClass            0 [unknown]
  bDeviceSubClass         0 [unknown]
  bDeviceProtocol         0 
  bMaxPacketSize0         8
  idVendor           0x058f Alcor Micro Corp.
  idProduct          0x9540 AU9540 Smartcard Reader
  bcdDevice            1.20
  iManufacturer           1 Generic
  iProduct                2 EMV Smartcard Reader
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength       0x005d
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xa0
      (Bus Powered)
      Remote Wakeup
    MaxPower               50mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           3
      bInterfaceClass        11 Chip/SmartCard
      bInterfaceSubClass      0 [unknown]
      bInterfaceProtocol      0 
      iInterface              0 
      ChipCard Interface Descriptor:
        bLength                54
        bDescriptorType        33
        bcdCCID              1.10
        nMaxSlotIndex           0
        bVoltageSupport         7  5.0V 3.0V 1.8V 
        dwProtocols             3  T=0 T=1
        dwDefaultClock       3700
        dwMaxiumumClock     12000
        bNumClockSupported      3
        dwDataRate           9946 bps
        dwMaxDataRate      688172 bps
        bNumDataRatesSupp.    138
        dwMaxIFSD             254
        dwSyncProtocols  00000007  2-wire 3-wire I2C
        dwMechanical     00000000 
        dwFeatures       000404BE
          Auto configuration based on ATR
          Auto activation on insert
          Auto voltage selection
          Auto clock change
          Auto baud rate change
          Auto PPS made by CCID
          Auto IFSD exchange (T=1)
          Short and extended APDU level exchange
        dwMaxCCIDMsgLen       272
        bClassGetResponse    echo
        bClassEnvelope       echo
        wlcdLayout           none
        bPINSupport             0 
        bMaxCCIDBusySlots       1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0004  1x 4 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x02  EP 2 OUT
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               0
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x83  EP 3 IN
        bmAttributes            2
          Transfer Type            Bulk
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0010  1x 16 bytes
        bInterval               0
Binary Object Store Descriptor:
  bLength                 5
  bDescriptorType        15
  wTotalLength       0x000c
  bNumDeviceCaps          1
  USB 2.0 Extension Device Capability:
    bLength                 7
    bDescriptorType        16
    bDevCapabilityType      2
    bmAttributes   0x00000002
      HIRD Link Power Management (LPM) Supported
Device Status:     0x0000
  (Bus Powered)
</code></pre><p>I spent quite a long time trying to work out why it would not detect the SIM in the smartcard reader (which, as above, was solved by using the supplied packaging material).</p>
<p>I have not reproduced all my troubleshooting here, but it was reasonably obvious from the error messages that, while my laptop recognised and could talk to the smartcard reader, the SIM was not recognised.</p>
<h3 id="lpac"><code>lpac</code></h3>
<p>I started with a command line tool called <a href="https://github.com/estkme-group/lpac"><code>lpac</code></a>.</p>
<p>It has a <a href="https://github.com/estkme-group/lpac/releases/download/v2.2.1/lpac_2.1.0_amd64.deb">.deb release version</a>, which I installed with:</p>
<pre tabindex="0"><code>sudo apt install lpac_2.1.0_amd64.deb -y
</code></pre><p>It installed without error to <code>/usr/bin/lpac</code>.</p>
<p><code>lpac</code>’s output is in json, so run it through <code>jq</code> to prettify it.</p>
<p><code>lpac chip info | jq</code> shows information about the SIM card / eUICC:</p>
<p>(I’ve removed some potentially sensitive/personal bits)</p>
<pre tabindex="0"><code>{
  &#34;type&#34;: &#34;lpa&#34;,
  &#34;payload&#34;: {
    &#34;code&#34;: 0,
    &#34;message&#34;: &#34;success&#34;,
    &#34;data&#34;: {
      &#34;eidValue&#34;: &#34;8904xxxxx&#34;,
      &#34;EuiccConfiguredAddresses&#34;: {
        &#34;defaultDpAddress&#34;: &#34;smdp-plus-0.eu.cd.rsp.kigen.com&#34;,
        &#34;rootDsAddress&#34;: &#34;lpa.ds.gsma.com&#34;
      },
      &#34;EUICCInfo2&#34;: {
        &#34;profileVersion&#34;: &#34;2.3.1&#34;,
        &#34;svn&#34;: &#34;2.3.0&#34;,
        &#34;euiccFirmwareVer&#34;: &#34;36.17.4&#34;,
        &#34;extCardResource&#34;: {
          &#34;installedApplication&#34;: 11,
          &#34;freeNonVolatileMemory&#34;: 1528320,
          &#34;freeVolatileMemory&#34;: 32739
        },
        &#34;uiccCapability&#34;: [
          &#34;usimSupport&#34;,
          &#34;isimSupport&#34;,
          &#34;csimSupport&#34;,
          &#34;akaMilenage&#34;,
          &#34;akaCave&#34;,
          &#34;akaTuak128&#34;,
          &#34;akaTuak256&#34;,
          &#34;gbaAuthenUsim&#34;,
          &#34;gbaAuthenISim&#34;,
          &#34;eapClient&#34;,
          &#34;javacard&#34;,
          &#34;multipleUsimSupport&#34;,
          &#34;multipleIsimSupport&#34;,
          &#34;multipleCsimSupport&#34;
        ],
        &#34;ts102241Version&#34;: &#34;15.1.0&#34;,
        &#34;globalplatformVersion&#34;: &#34;2.3.0&#34;,
        &#34;rspCapability&#34;: [
          &#34;additionalProfile&#34;,
          &#34;testProfileSupport&#34;
        ],
        &#34;euiccCiPKIdListForVerification&#34;: [
          &#34;8137xxxxx&#34;
        ],
        &#34;euiccCiPKIdListForSigning&#34;: [
          &#34;8137xxxxx&#34;
        ],
        &#34;euiccCategory&#34;: null,
        &#34;ppVersion&#34;: &#34;1.0.0&#34;,
        &#34;sasAcreditationNumber&#34;: &#34;KN-DN-UP-0924&#34;,
        &#34;certificationDataObject&#34;: {
          &#34;platformLabel&#34;: null,
          &#34;discoveryBaseURL&#34;: null
        }
      },
      &#34;rulesAuthorisationTable&#34;: [
        {
          &#34;pprIds&#34;: [
            &#34;ppr1&#34;,
            &#34;ppr2&#34;
          ],
          &#34;allowedOperators&#34;: [
            {
              &#34;plmn&#34;: &#34;eeeeee&#34;,
              &#34;gid1&#34;: null,
              &#34;gid2&#34;: null
            }
          ],
          &#34;pprFlags&#34;: []
        }
      ]
    }
  }
}
</code></pre><p>It appears to use a platform run by Kigen for remote SIM provisioning, so it looks like there is a dependency on a third party’s infrastructure to make all this work.</p>
<p>Use <code>lpac profile list | jq</code> to list the downloaded SIMs, and see their ICCID and AID.</p>
<p>To enable / disable downloaded eSIMs, use <code>lpac profile {enable,disable} ICCID/AID | jq</code>.</p>
<p>Using <a href="https://qr.esim.tf/1$rsp.truphone.com$QRF-SPEEDTEST">this test profile</a>, I tried adding/downloading SIMs via <code>lpac</code>.</p>
<p>Specifying the SM-DP+ address (<code>-s</code>) and the matching ID (<code>-m</code>) worked:</p>
<pre tabindex="0"><code>lpac profile download -s rsp.truphone.com -m QRF-SPEEDTEST`
</code></pre><p>Specifying the activation code (<code>-a</code>) in the manner set out in the documentation failed <em>(Edit: quoting issue; see below)</em>:</p>
<pre tabindex="0"><code>lpac profile download -a LPA:1$rsp.truphone.com$QRF-SPEEDTEST | jq
</code></pre><p>It returned:</p>
<pre tabindex="0"><code>{
  &#34;type&#34;: &#34;progress&#34;,
  &#34;payload&#34;: {
    &#34;code&#34;: 0,
    &#34;message&#34;: &#34;es10b_cancel_session&#34;,
    &#34;data&#34;: null
  }
}
{
  &#34;type&#34;: &#34;progress&#34;,
  &#34;payload&#34;: {
    &#34;code&#34;: 0,
    &#34;message&#34;: &#34;es9p_cancel_session&#34;,
    &#34;data&#34;: null
  }
}
{
  &#34;type&#34;: &#34;lpa&#34;,
  &#34;payload&#34;: {
    &#34;code&#34;: -1,
    &#34;message&#34;: &#34;activation_code&#34;,
    &#34;data&#34;: &#34;invalid&#34;
  }
}
</code></pre><p>To check this was not just an issue with the test profiles, I bought a <a href="https://www.lycamobile.co.uk/en/bundles/sim-only-deals/#30-day-plans">30 day, £2.50 LycaMobile eSIM</a> for testing, so that I could try it with an “actual” eSIM, rather than a test eSIM.</p>
<p>Lyca’s email gave me a QR code, but did not specify (explicitly) the SM-DP+ address or matching ID.</p>
<p>The image’s alt-text was just my order number with Lyca.</p>
<p>I used GNOME’s <a href="https://apps.gnome.org/en-GB/Decoder/">“Decoder”</a>, which lets one scan a QR card either from the device’s camera or from a screenshot.</p>
<p>That gave me the full activation code, which looked like this:</p>
<pre tabindex="0"><code>LPA:1$dp-plus-par07-01.oasis-smartsim.com$XHY48-xxxxx-xxxxx-xxxxx$x.x.x.x.x.x.xxxxx.x.x.x.x
</code></pre><p>(I don’t know how much of it is sensitive!)</p>
<p>This too failed using <code>lpac</code>.</p>
<p>I have not dug into <em>why</em> it failed.</p>
<p>I missed the opportunity to test extracting the parameters and pushing them manually into <code>lpac</code> via <code>-s</code> and <code>-m</code> as I had already used EasyLPAC at that point. I suspect that that would have worked.</p>
<p><em>Update</em>: doh, it is just a matter of quoting the string, with single quotes. So:</p>
<pre tabindex="0"><code>lpac profile download -a &#39;LPA:1$rsp.truphone.com$QRF-BETTERROAMING-PMRDGIR2EARDEIT5&#39;
</code></pre><p>How embarrassing.</p>
<p>I tried to update the <code>lpac</code> documentation to make this more obvious, but <a href="https://github.com/estkme-group/lpac/pull/183#issuecomment-2602304507">the maintainer decided that it wasn’t needed</a>. So I guess this blogpost will have to do :)</p>
<p>Thanks to <a href="https://toot.wales/@tswsl">Tom</a> for that :)</p>
<h3 id="linux-gui-easylpac">Linux GUI: EasyLPAC</h3>
<p>There is a GUI for <code>lpac</code>, called <a href="https://github.com/creamlike1024/EasyLPAC">EasyLPAC</a>.</p>
<p>I used <a href="https://github.com/creamlike1024/EasyLPAC/releases/tag/0.7.7.2">the latest Github release</a>, with the version of <code>lpac</code> that I had already installed.</p>
<p>I did not install it; I just ran it, and it worked.</p>
<p>I tested, on a different machine, the version of EasyLPAC which comes with <code>lpac</code> included, but I could not get this to work. I did not pursue this.</p>
<p>I was able to download an eSIM using EasyLPAC in a few different ways:</p>
<ul>
<li>having an LPA:1 activation code on the system clipboard</li>
<li>having a QR code image on the system clipboard</li>
<li>“scanning an image file”, which consisted of opening a QR code saved as an image file on my computer</li>
</ul>
<p>It was really quite straightforward.</p>
<p>I noted that the instructions say:</p>
<blockquote>
<p>Note: Reading LPA activation code and QRCode from clipboard not working in Wayland</p>
</blockquote>
<p>But they did work for me, using Wayland.</p>
<p>Importing the LycaMobile eSIM, using the details extracted from the QR code, worked.</p>
<h2 id="connectivity-worked-fine-via-linux">Connectivity worked fine via Linux</h2>
<p>I put the 9eSIM into my laptop’s SIM slot, and booted it.</p>
<p>In GNOME’s “Mobile Network” settings, it was recognised as a LycaMobile SIM.</p>
<p>I had to set the APN manually.</p>
<p>It took a couple of minutes for the eSIM to activate and, once activated, I was able to browse the Internet.</p>
<p>So there we go: an eSIM on a physical SIM on a laptop running Debian, with very little effort.</p>
<h2 id="other-options">Other options</h2>
<p>I quite like the look of <a href="https://shop.sysmocom.de/sysmoEUICC1-eUICC-for-consumer-eSIM-RSP/sysmoEUICC1">this Sysmocom SIM</a>.</p>
<p>I’d be interested in giving that a try some point.</p>



  


</article>

        </div></div>
  </body>
</html>
