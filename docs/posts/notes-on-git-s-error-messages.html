<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jvns.ca/blog/2024/04/10/notes-on-git-error-messages/">Original</a>
    <h1>Notes on git&#39;s error messages</h1>
    
    <div id="readability-page-1" class="page"><div>
     

<p>While writing about Git, I’ve noticed that a lot of folks struggle with Git’s
error messages. I’ve had many years to get used to these error messages so it
took me a really long time to understand <em>why</em> folks were confused, but having
thought about it much more, I’ve realized that:</p>

<ol>
<li>sometimes I actually <em>am</em> confused by the error messages, I’m just used to
being confused</li>
<li>I have a bunch of strategies for getting more information when the error
message git gives me isn’t very informative</li>
</ol>

<p>So in this post, I’m going to go through a bunch of Git’s error messages,
list a few things that I think are confusing about them for each one, and talk
about what I do when I’m confused by the message.</p>

<h3 id="improving-error-messages-isn-t-easy">improving error messages isn’t easy</h3>

<p>Before we start, I want to say that trying to think about why these error
messages are confusing has given me a lot of respect for how difficult
maintaining Git is. I’ve been thinking about Git for months, and for some of
these messages I really have no idea how to improve them.</p>

<p>Some things that seem hard to me about improving error messages:</p>

<ul>
<li>if you come up with an idea for a new message, it’s hard to tell if it’s actually better!</li>
<li>work like improving error messages often <a href="https://lwn.net/Articles/959768/">isn’t funded</a></li>
<li>the error messages have to be translated (git’s error messages are translated into <a href="https://github.com/git/git/tree/master/po">19 languages</a>!)</li>
</ul>

<p>That said, if you find these messages confusing, hopefully some of these notes
will help clarify them a bit.</p>



<h2 id="git-push-on-a-diverged-branch">
  <a href="#git-push-on-a-diverged-branch">
  error: <code>git push</code> on a diverged branch
  </a>
</h2>

<pre>$ git push
To github.com:jvns/int-exposed
<span>! [rejected]        main -&gt; main (non-fast-forward)</span>
<span>error: failed to push some refs to &#39;github.com:jvns/int-exposed&#39;
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Integrate the remote changes (e.g.
hint: &#39;git pull ...&#39;) before pushing again.
hint: See the &#39;Note about fast-forwards&#39; in &#39;git push --help&#39; for details.</span>

$ git status
On branch main
Your branch and &#39;origin/main&#39; have diverged,
and have 2 and 1 different commits each, respectively.
</pre>

<p>Some things I find confusing about this:</p>

<ol>
<li>You get the exact same error message whether the branch is just <strong>behind</strong>
or the branch has <strong>diverged</strong>. There’s no way to tell which it is from this
message: you need to run <code>git status</code> or <code>git pull</code> to find out.</li>
<li>It says <code>failed to push some refs</code>, but it’s not totally clear <em>which</em> references it
failed to push. I believe everything that failed to push is listed with <code>! [rejected]</code> on the previous line– in this case just the <code>main</code> branch.</li>
</ol>

<p><strong>What I like to do if I’m confused:</strong></p>

<ul>
<li>I’ll run <code>git status</code> to figure out what the state of my current branch is.</li>
<li>I think I almost never try to push more than one branch at a time, so I
usually totally ignore git’s notes about which specific branch failed to push
– I just assume that it’s my current branch</li>
</ul>

<h2 id="git-pull-on-a-diverged-branch">
  <a href="#git-pull-on-a-diverged-branch">
  error: <code>git pull</code> on a diverged branch
  </a>
</h2>

<pre>$ git pull
<span>hint: You have divergent branches and need to specify how to reconcile them.
hint: You can do so by running one of the following commands sometime before
hint: your next pull:
hint:
hint:   git config pull.rebase false  # merge
hint:   git config pull.rebase true   # rebase
hint:   git config pull.ff only       # fast-forward only
hint:
hint: You can replace &#34;git config&#34; with &#34;git config --global&#34; to set a default
hint: preference for all repositories. You can also pass --rebase, --no-rebase,
hint: or --ff-only on the command line to override the configured default per
hint: invocation.</span>
fatal: Need to specify how to reconcile divergent branches.
</pre>

<p>The main thing I think is confusing here is that git is presenting you with a
kind of overwhelming number of options: it’s saying that you can either:</p>

<ol>
<li>configure <code>pull.rebase false</code>, <code>pull.rebase true</code>, or <code>pull.ff only</code> locally</li>
<li>or configure them globally</li>
<li>or run <code>git pull --rebase</code> or <code>git pull --no-rebase</code></li>
</ol>

<p>It’s very hard to imagine how a beginner to git could easily use this hint to
sort through all these options on their own.</p>

<p>If I were explaining this to a friend, I’d say something like “you can use <code>git pull --rebase</code>
or <code>git pull --no-rebase</code> to resolve this with a rebase or merge
<em>right now</em>, and if you want to set a permanent preference, you can do that
with <code>git config pull.rebase false</code> or <code>git config pull.rebase true</code>.</p>

<p><code>git config pull.ff only</code> feels a little redundant to me because that’s git’s
default behaviour anyway (though it wasn’t always).</p>

<p><strong>What I like to do here:</strong></p>

<ul>
<li>run <code>git status</code> to see the state of my current branch</li>
<li>maybe run <code>git log origin/main</code> or <code>git log</code> to see what the diverged commits are</li>
<li>usually run <code>git pull --rebase</code> to resolve it</li>
<li>sometimes I’ll run <code>git push --force</code> or <code>git reset --hard origin/main</code> if I
want to throw away my local work or remote work (for example because I
accidentally commited to the wrong branch, or because I ran <code>git commit
--amend</code> on a personal branch that only I’m using and want to force push)</li>
</ul>

<h2 id="git-checkout-asdf">
  <a href="#git-checkout-asdf">
  error: <code>git checkout asdf</code> (a branch that doesn&#39;t exist)
  </a>
</h2>

<pre>$ git checkout asdf
error: pathspec &#39;asdf&#39; did not match any file(s) known to git
</pre>

<p>This is a little weird because we my intention was to check out a <strong>branch</strong>,
but <code>git checkout</code> is complaining about a <strong>path</strong> that doesn’t exist.</p>

<p>This is happening because <code>git checkout</code>’s first argument can be either a
branch or a path, and git has no way of knowing which one you intended. This
seems tricky to improve, but I might expect something like “No such branch,
commit, or path: asdf”.</p>

<p><strong>What I like to do here:</strong></p>

<ul>
<li>in theory it would be good to use <code>git switch</code> instead, but I keep using <code>git checkout</code> anyway</li>
<li>generally I just remember that I need to decode this as “branch <code>asdf</code> doesn’t exist”</li>
</ul>

<h2 id="git-switch-asdf">
  <a href="#git-switch-asdf">
  error: <code>git switch asdf</code> (a branch that doesn&#39;t exist)
  </a>
</h2>

<pre>$ git switch asdf
fatal: invalid reference: asdf
</pre>

<p><code>git switch</code> only accepts a branch as an argument (unless you pass <code>-d</code>), so why is it saying <code>invalid
reference: asdf</code> instead of <code>invalid branch: asdf</code>?</p>

<p>I think the reason is that internally, <code>git switch</code> is trying to be helpful in its error messages: if you run <code>git switch v0.1</code> to switch to a tag, it’ll say:</p>

<pre><code>$ git switch v0.1
fatal: a branch is expected, got tag &#39;v0.1&#39;`
</code></pre>

<p>So what git is trying to communicate with <code>fatal: invalid reference: asdf</code> is
“<code>asdf</code> isn’t a branch, but it’s not a tag either, or any other reference”. From my various <a href="https://jvns.ca/blog/2024/03/28/git-poll-results/">git polls</a> my impression is that
a lot of git users have literally no idea what a “reference” is in git, so I’m not sure if that’s coming across.</p>

<p><strong>What I like to do here:</strong></p>

<p>90% of the time when a git error message says <code>reference</code> I just mentally
replace it with <code>branch</code> in my head.</p>

<h2 id="detached-head">
  error: <a href="#detached-head"><code>git checkout HEAD^</code></a>
</h2>

<pre>$ git checkout HEAD^
Note: switching to &#39;HEAD^&#39;.

You are in &#39;detached HEAD&#39; state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 182cd3f add &#34;swap byte order&#34; button
</new-branch-name></pre>

<p>
This is a tough one. Definitely a lot of people are confused about this
message, but obviously there&#39;s been a lot of effort to improve it too. I don&#39;t
have anything smart to say about this one.
</p>

<p><strong>What I like to do here:</strong></p>

<ul>
<li>my shell prompt tells me if I’m in detached HEAD state, and generally I can remember not to make new commits while in that state</li>
<li>when I’m done looking at whatever old commits I wanted to look at, I’ll run <code>git checkout main</code> or something to go back to a branch</li>
</ul>

<h2 id="rebase-in-progress">
  <a href="#rebase-in-progress">
  message: <code>git status</code> when a rebase is in progress
  </a>  
</h2>

<p>This isn’t an error message, but I still find it a little confusing on its own:</p>

<pre>$ git status
<span>interactive rebase in progress;</span> onto c694cf8
Last command done (1 command done):
   pick 0a9964d wip
No commands remaining.
You are currently rebasing branch &#39;main&#39; on &#39;c694cf8&#39;.
  (fix conflicts and then run &#34;git rebase --continue&#34;)
  (use &#34;git rebase --skip&#34; to skip this patch)
  (use &#34;git rebase --abort&#34; to check out the original branch)

Unmerged paths:
  (use &#34;git restore --staged <file>...&#34; to unstage)
  (use &#34;git add <file>...&#34; to mark resolution)
  <span>both modified:   index.html</span>

no changes added to commit (use &#34;git add&#34; and/or &#34;git commit -a&#34;)
</file></file></pre>

<p>Two things I think could be clearer here:</p>

<ol>
<li>I think it would be nice if <code>You are currently rebasing branch &#39;main&#39; on &#39;c694cf8&#39;.</code> were on the first line instead of the 5th line – right now the first line doesn’t say which branch you’re rebasing.</li>
<li>In this case, <code>c694cf8</code> is actually <code>origin/main</code>, so I feel like <code>You are currently rebasing branch &#39;main&#39; on &#39;origin/main&#39;</code> might be even clearer.</li>
</ol>

<p><strong>What I like to do here:</strong></p>

<p>My shell prompt includes the branch that I’m currently rebasing, so I rely on that instead of the output of <code>git status</code>.</p>

<h2 id="merge-deleted">
  <a href="#merge-deleted">
  error: <code>git rebase</code> when a file has been deleted
  </a>
</h2>
<pre>$ git rebase main
CONFLICT (modify/delete): index.html deleted in 0ce151e (wip) and modified in HEAD.  Version HEAD of index.html left in tree.
error: could not apply 0ce151e… wip
</pre>

<p>The thing I still find confusing about this is – <code>index.html</code> was modified in
<code>HEAD</code>. But what is <code>HEAD</code>? Is it the commit I was working on when I started
the merge/rebase, or is it the commit from the other branch? (the answer is
“<code>HEAD</code> is your branch if you’re doing a merge, and it’s the “other branch” if
you’re doing a rebase, but I always find that hard to remember)</p>

<p>I think I would personally find it easier to understand if the message listed the branch names if possible, something like this:</p>

<pre><code>CONFLICT (modify/delete): index.html deleted on `main` and modified on `mybranch`
</code></pre>

<h2 id="merge-ours">
  <a href="#merge-ours">
  error: <code>git status</code> during a merge or rebase (who is “them”?)
  </a>
</h2>
<pre>$ git status
On branch master
You have unmerged paths.
  (fix conflicts and run “git commit”)
  (use “git merge –abort” to abort the merge)

<p>Unmerged paths:
  (use “git add/rm <file>…” as appropriate to mark resolution)
    deleted by them: the_file</file></p>

<p>no changes added to commit (use “git add” and/or “git commit -a”)
</p></pre>

<p>I find this one confusing in exactly the same way as the previous message: it
says <code>deleted by them:</code>, but what “them” refers to depends on whether you did a merge or rebase or cherry-pick.</p>

<ul>
<li>for a merge, <code>them</code> is the other branch you merged in</li>
<li>for a rebase, <code>them</code> is the branch that you were on when you ran <code>git rebase</code></li>
<li>for a cherry-pick, I guess it’s the commit you cherry-picked</li>
</ul>

<p><strong>What I like to do if I’m confused:</strong></p>

<ul>
<li>try to remember what I did</li>
<li>run <code>git show main --stat</code> or something to see what I did on the <code>main</code> branch if I can’t remember</li>
</ul>

<h2 id="git clean">
  <a href="#git-clean">
  error: <code>git clean</code>
  </a>
</h2>
<pre>$ git clean
fatal: clean.requireForce defaults to true and neither -i, -n, nor -f given; refusing to clean
</pre>

<p>I just find it a bit confusing that you need to look up what <code>-i</code>, <code>-n</code> and
<code>-f</code> are to be able to understand this error message. I’m personally way too
lazy to do that so even though I’ve probably been using <code>git clean</code> for 10
years I still had no idea what <code>-i</code> stood for (<code>interactive</code>) until I was
writing this down.</p>

<p><strong>What I like to do if I’m confused:</strong></p>

<p>Usually I just chaotically run <code>git clean -f</code> to delete all my untracked files
and hope for the best, though I might actually switch to <code>git clean -i</code>  now
that I know what <code>-i</code> stands for. Seems a lot safer.</p>

<h3 id="that-s-all">that’s all!</h3>

<p>Hopefully some of this is helpful!</p>

</div></div>
  </body>
</html>
