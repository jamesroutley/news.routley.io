<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ramsayleung.github.io/en/post/2025/a_story_about_bypassing_air_canadas_in-flight_network_restrictions/">Original</a>
    <h1>A Story About Bypassing Air Canada&#39;s In-Flight Network Restrictions</h1>
    
    <div id="readability-page-1" class="page"><div><h2 id="prologue"><span>1</span> Prologue</h2><p>A while ago, I took a flight from Canada back to Hong Kong - about 12 hours in total with Air Canada.</p><p>Interestingly, the plane actually had WiFi:</p><figure>
<label for="zoomCheck-a931d"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/acwifi-connect-2.png"/></label></figure><p>However, the WiFi had restrictions. For Aeroplan members who hadn’t paid, it only offered <a href="https://www.aircanada.com/ca/en/aco/home/fly/onboard/in-flight-entertainment-and-connectivity.html#/">Free Texting</a>, meaning you could only use messaging apps like WhatsApp, Snapchat, and WeChat to send text messages, but couldn’t access other websites.</p><p>If you wanted unlimited access to other websites, it would cost CAD $30.75:</p><figure>
<label for="zoomCheck-1118f"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/acwifi.jpg"/></label></figure><p>And if you wanted to watch videos on the plane, that would be CAD $39:</p><figure>
<label for="zoomCheck-47db4"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/acwifi_plan.jpg"/></label></figure><p>I started wondering: for the Free Texting service, could I bypass the messaging app restriction and access other websites freely?</p><p>Essentially, could I enjoy the benefits of the $30.75 paid service without actually paying the fee? After all, with such a long journey ahead, I needed something interesting to pass the 12 hours.</p><p>Since I could use WeChat in flight, I could also call for help from the sky.</p><p>Coincidentally, my roommate happens to be a security and networking expert who was on vacation at home. When I mentioned this idea, he thought it sounded fun and immediately agreed to collaborate. So we started working on it together across the Pacific.</p><h2 id="the-process"><span>2</span> The Process</h2><p>After selecting the only available WiFi network <code>acwifi.com</code> on the plane, just like other login-required WiFi networks, it popped up a webpage from <code>acwifi.com</code> asking me to verify my Aeroplan membership. Once verified, I could access the internet.</p><figure>
<label for="zoomCheck-4b541"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/onboard_success.jpg"/></label></figure><p>There’s a classic software development interview question: what happens after you type a URL into the browser and press enter?</p><p>For example, if you type <code>https://acwifi.com</code> and only focus on the network request part, the general process is: DNS query -&gt; TCP connection -&gt; TLS handshake -&gt; HTTP request and response.</p><figure>
<label for="zoomCheck-9a5c6"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/network_request_sequence_en.png"/></label></figure><p>Let’s consider <code>github.com</code> as our target website we want to access. Now let’s see how we can break through the network restrictions and successfully access <code>github.com</code>.</p><h2 id="approach-1-domain-self-signing"><span>3</span> Approach 1: Domain Self-Signing</h2><p>Since <code>acwifi.com</code> is accessible but <code>github.com</code> is not, could I disguise my server as <code>acwifi.com</code> and route all request traffic through my server to access the target website (<code>github.com</code>)?</p><figure>
<label for="zoomCheck-646db"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/self-sign-certificate-en.png"/></label></figure><p>The idea was roughly: I modify DNS records to bind our proxy server’s IP <code>137.184.231.87</code> to <code>acwifi.com</code>, then use a self-signed certificate to tell the browser that this IP and this domain are bound together, and it should trust it.</p><p>Let me first test this idea:</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span></code></pre></td><td><pre tabindex="0"><code data-lang="shell"><span><span>&gt; ping 137.184.231.87
</span></span><span><span>PING 137.184.231.87 <span>(</span>137.184.231.87<span>)</span>: <span>56</span> data bytes
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>0</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>1</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>2</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>3</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>4</span>
</span></span><span><span>^C
</span></span><span><span>--- 137.184.231.87 ping statistics ---
</span></span><span><span><span>6</span> packets transmitted, <span>0</span> packets received, 100.0% packet loss
</span></span></code></pre></td></tr></tbody></table></div></div><p>Unexpectedly, the IP was completely unreachable via <code>ping</code>, meaning the IP was likely blocked entirely.</p><p>I tried other well-known IPs, like Cloudflare’s CDN IP, and they were also unreachable:</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span></code></pre></td><td><pre tabindex="0"><code data-lang="shell"><span><span>&gt; ping 172.67.133.121
</span></span><span><span>PING 172.67.133.121 <span>(</span>172.67.133.121<span>)</span>: <span>56</span> data bytes
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>0</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>1</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>2</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>3</span>
</span></span><span><span>Request timeout <span>for</span> icmp_seq <span>4</span>
</span></span><span><span>^C
</span></span><span><span>--- 172.67.133.121 ping statistics ---
</span></span><span><span><span>6</span> packets transmitted, <span>0</span> packets received, 100.0% packet loss
</span></span></code></pre></td></tr></tbody></table></div></div><p>It seems this approach won’t work. After all, if the IPs are directly blocked, no amount of disguise will help. This network likely maintains some IP whitelist (such as WhatsApp and WeChat’s egress IPs), and only IPs on the whitelist can be accessed.</p><h2 id="approach-2-dns-port-masquerading"><span>4</span> Approach 2: DNS Port Masquerading</h2><p>When the first approach failed, my roommate suggested a second approach: try using DNS service as a breakthrough:</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span><span>11
</span><span>12
</span><span>13
</span><span>14
</span><span>15
</span><span>16
</span><span>17
</span><span>18
</span><span>19
</span><span>20
</span><span>21
</span></code></pre></td><td><pre tabindex="0"><code data-lang="shell"><span><span>&gt; dig http418.org
</span></span><span><span>
</span></span><span><span><span>;</span> &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; http418.org
</span></span><span><span><span>;;</span> global options: +cmd
</span></span><span><span><span>;;</span> Got answer:
</span></span><span><span><span>;;</span> -&gt;&gt;HEADER<span>&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span>64160</span>
</span></span><span><span><span>;;</span> flags: qr rd ra<span>;</span> QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: <span>1</span>
</span></span><span><span>
</span></span><span><span><span>;;</span> OPT PSEUDOSECTION:
</span></span><span><span><span>;</span> EDNS: version: 0, flags:<span>;</span> udp: <span>4096</span>
</span></span><span><span><span>;;</span> QUESTION SECTION:
</span></span><span><span><span>;</span>http418.org.			IN	A
</span></span><span><span>
</span></span><span><span><span>;;</span> ANSWER SECTION:
</span></span><span><span>http418.org.		300	IN	A	172.67.133.121
</span></span><span><span>http418.org.		300	IN	A	104.21.5.131
</span></span><span><span>
</span></span><span><span><span>;;</span> Query time: <span>3288</span> msec
</span></span><span><span><span>;;</span> SERVER: 172.19.207.1#53<span>(</span>172.19.207.1<span>)</span>
</span></span><span><span><span>;;</span> WHEN: Sat Oct <span>04</span> 14:18:24 PDT <span>2025</span>
</span></span><span><span><span>;;</span> MSG SIZE  rcvd: <span>94</span>
</span></span></code></pre></td></tr></tbody></table></div></div><p>This is good news! It means there are still ways to reach external networks, and DNS is one of them.</p><p>Looking at the record above, it shows our DNS query for <code>http418.org</code> was successful, meaning DNS requests work.</p><h3 id="arbitrary-dns-servers"><span>4.1</span> Arbitrary DNS Servers</h3><p>My roommate then randomly picked another DNS server to see if the network had a whitelist for DNS servers:</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span><span>11
</span><span>12
</span><span>13
</span><span>14
</span><span>15
</span><span>16
</span><span>17
</span><span>18
</span><span>19
</span><span>20
</span><span>21
</span><span>22
</span></code></pre></td><td><pre tabindex="0"><code data-lang="shell"><span><span>&gt; dig @40.115.144.198 http418.org
</span></span><span><span>
</span></span><span><span><span>;</span> &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @40.115.144.198 http418.org
</span></span><span><span><span>;</span> <span>(</span><span>1</span> server found<span>)</span>
</span></span><span><span><span>;;</span> global options: +cmd
</span></span><span><span><span>;;</span> Got answer:
</span></span><span><span><span>;;</span> -&gt;&gt;HEADER<span>&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span>58958</span>
</span></span><span><span><span>;;</span> flags: qr rd ra<span>;</span> QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: <span>1</span>
</span></span><span><span>
</span></span><span><span><span>;;</span> OPT PSEUDOSECTION:
</span></span><span><span><span>;</span> EDNS: version: 0, flags:<span>;</span> udp: <span>1224</span>
</span></span><span><span><span>;;</span> QUESTION SECTION:
</span></span><span><span><span>;</span>http418.org.			IN	A
</span></span><span><span>
</span></span><span><span><span>;;</span> ANSWER SECTION:
</span></span><span><span>http418.org.		275	IN	A	104.21.5.131
</span></span><span><span>http418.org.		275	IN	A	172.67.133.121
</span></span><span><span>
</span></span><span><span><span>;;</span> Query time: <span>1169</span> msec
</span></span><span><span><span>;;</span> SERVER: 40.115.144.198#53<span>(</span>40.115.144.198<span>)</span>
</span></span><span><span><span>;;</span> WHEN: Sat Oct <span>04</span> 14:24:25 PDT <span>2025</span>
</span></span><span><span><span>;;</span> MSG SIZE  rcvd: <span>72</span>
</span></span></code></pre></td></tr></tbody></table></div></div><p>We can actually use arbitrary DNS servers - even better!</p><h3 id="tcp-queries"><span>4.2</span> TCP Queries</h3><p>The fact that arbitrary DNS servers can be queried successfully is excellent news. DNS typically uses UDP protocol, but would TCP-based DNS requests be blocked?</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span><span>11
</span><span>12
</span><span>13
</span><span>14
</span><span>15
</span><span>16
</span><span>17
</span><span>18
</span><span>19
</span><span>20
</span><span>21
</span><span>22
</span></code></pre></td><td><pre tabindex="0"><code data-lang="shell"><span><span>&gt; dig @40.115.144.198 http418.org +tcp
</span></span><span><span>
</span></span><span><span><span>;</span> &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @40.115.144.198 http418.org +tcp
</span></span><span><span><span>;</span> <span>(</span><span>1</span> server found<span>)</span>
</span></span><span><span><span>;;</span> global options: +cmd
</span></span><span><span><span>;;</span> Got answer:
</span></span><span><span><span>;;</span> -&gt;&gt;HEADER<span>&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span>30355</span>
</span></span><span><span><span>;;</span> flags: qr rd ra<span>;</span> QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: <span>1</span>
</span></span><span><span>
</span></span><span><span><span>;;</span> OPT PSEUDOSECTION:
</span></span><span><span><span>;</span> EDNS: version: 0, flags:<span>;</span> udp: <span>1224</span>
</span></span><span><span><span>;;</span> QUESTION SECTION:
</span></span><span><span><span>;</span>http418.org.			IN	A
</span></span><span><span>
</span></span><span><span><span>;;</span> ANSWER SECTION:
</span></span><span><span>http418.org.		36	IN	A	172.67.133.121
</span></span><span><span>http418.org.		36	IN	A	104.21.5.131
</span></span><span><span>
</span></span><span><span><span>;;</span> Query time: <span>4679</span> msec
</span></span><span><span><span>;;</span> SERVER: 40.115.144.198#53<span>(</span>40.115.144.198<span>)</span>
</span></span><span><span><span>;;</span> WHEN: Sat Oct <span>04</span> 14:28:24 PDT <span>2025</span>
</span></span><span><span><span>;;</span> MSG SIZE  rcvd: <span>72</span>
</span></span></code></pre></td></tr></tbody></table></div></div><p>DNS TCP queries also work! This indicates the plane network’s filtering policy is relatively lenient, standing a chance of our subsequent DNS tunneling approach.</p><h3 id="proxy-service-on-port-53"><span>4.3</span> Proxy Service on Port 53</h3><p>It seems the plane network restrictions aren’t completely airtight - we’ve found a “backdoor” in this wall.</p><p>So we had a clever idea: since the plane gateway doesn’t block DNS requests, theoretically we could disguise our proxy server as a DNS server, expose port 53 for DNS service, route all requests through the proxy server disguised as DNS requests, and thus bypass the restrictions.</p><p>My roommate spent about an hour setting up a proxy server exposing port 53 using <a href="https://github.com/XTLS/Xray-core">xray</a> <sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>, and sent me the configuration via WeChat:</p><p>The proxy server configuration my roommate set up with Xray included the following sample configuration:</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span><span>11
</span><span>12
</span><span>13
</span><span>14
</span><span>15
</span><span>16
</span><span>17
</span><span>18
</span><span>19
</span><span>20
</span><span>21
</span><span>22
</span><span>23
</span><span>24
</span><span>25
</span><span>26
</span><span>27
</span><span>28
</span><span>29
</span><span>30
</span><span>31
</span><span>32
</span><span>33
</span><span>34
</span><span>35
</span><span>36
</span><span>37
</span><span>38
</span><span>39
</span><span>40
</span><span>41
</span><span>42
</span><span>43
</span></code></pre></td><td><pre tabindex="0"><code data-lang="json"><span><span><span>{</span>
</span></span><span><span>  <span>&#34;outbounds&#34;</span><span>:</span> <span>[</span>
</span></span><span><span>    <span>{</span>
</span></span><span><span>      <span>&#34;tag&#34;</span><span>:</span> <span>&#34;proxy&#34;</span><span>,</span>
</span></span><span><span>      <span>&#34;protocol&#34;</span><span>:</span> <span>&#34;vless&#34;</span><span>,</span>
</span></span><span><span>      <span>&#34;settings&#34;</span><span>:</span> <span>{</span>
</span></span><span><span>        <span>&#34;vnext&#34;</span><span>:</span> <span>[</span>
</span></span><span><span>          <span>{</span>
</span></span><span><span>            <span>&#34;address&#34;</span><span>:</span> <span>&#34;our-proxy-server-domain&#34;</span><span>,</span>
</span></span><span><span>            <span>&#34;port&#34;</span><span>:</span> <span>53</span><span>,</span>
</span></span><span><span>            <span>&#34;users&#34;</span><span>:</span> <span>[</span>
</span></span><span><span>              <span>{</span>
</span></span><span><span>                <span>&#34;id&#34;</span><span>:</span> <span>&#34;some-uuid&#34;</span><span>,</span>
</span></span><span><span>                <span>&#34;flow&#34;</span><span>:</span> <span>&#34;xtls-rprx-vision&#34;</span><span>,</span>
</span></span><span><span>                <span>&#34;encryption&#34;</span><span>:</span> <span>&#34;none&#34;</span><span>,</span>
</span></span><span><span>                <span>&#34;level&#34;</span><span>:</span> <span>0</span>
</span></span><span><span>              <span>}</span>
</span></span><span><span>            <span>]</span>
</span></span><span><span>          <span>}</span>
</span></span><span><span>        <span>]</span>
</span></span><span><span>      <span>},</span>
</span></span><span><span>      <span>&#34;streamSettings&#34;</span><span>:</span> <span>{</span>
</span></span><span><span>        <span>&#34;network&#34;</span><span>:</span> <span>&#34;tcp&#34;</span><span>,</span>
</span></span><span><span>        <span>&#34;security&#34;</span><span>:</span> <span>&#34;tls&#34;</span><span>,</span>
</span></span><span><span>        <span>&#34;tlsSettings&#34;</span><span>:</span> <span>{</span>
</span></span><span><span>          <span>&#34;allowInsecure&#34;</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>          <span>&#34;allowInsecureCiphers&#34;</span><span>:</span> <span>false</span><span>,</span>
</span></span><span><span>          <span>&#34;alpn&#34;</span><span>:</span> <span>[</span>
</span></span><span><span>            <span>&#34;h2&#34;</span>
</span></span><span><span>          <span>]</span>
</span></span><span><span>        <span>}</span>
</span></span><span><span>      <span>}</span>
</span></span><span><span>    <span>},</span>
</span></span><span><span>    <span>{</span>
</span></span><span><span>      <span>&#34;tag&#34;</span><span>:</span> <span>&#34;direct&#34;</span><span>,</span>
</span></span><span><span>      <span>&#34;protocol&#34;</span><span>:</span> <span>&#34;freedom&#34;</span>
</span></span><span><span>    <span>},</span>
</span></span><span><span>    <span>{</span>
</span></span><span><span>      <span>&#34;tag&#34;</span><span>:</span> <span>&#34;block&#34;</span><span>,</span>
</span></span><span><span>      <span>&#34;protocol&#34;</span><span>:</span> <span>&#34;blackhole&#34;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>  <span>]</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></td></tr></tbody></table></div></div><p>And I already had an xray client on my computer, so no additional software was needed to establish the connection.</p><figure>
<label for="zoomCheck-60758"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/dns-server-proxy-en.png"/></label></figure><p>Everything was ready. The exciting moment arrived - pressing enter to access <code>github.com</code>:</p><div><div><table><tbody><tr><td><pre tabindex="0"><code><span> 1
</span><span> 2
</span><span> 3
</span><span> 4
</span><span> 5
</span><span> 6
</span><span> 7
</span><span> 8
</span><span> 9
</span><span>10
</span><span>11
</span><span>12
</span><span>13
</span><span>14
</span><span>15
</span><span>16
</span><span>17
</span><span>18
</span><span>19
</span><span>20
</span><span>21
</span><span>22
</span><span>23
</span><span>24
</span><span>25
</span><span>26
</span><span>27
</span><span>28
</span><span>29
</span><span>30
</span><span>31
</span><span>32
</span><span>33
</span><span>34
</span><span>35
</span></code></pre></td><td><pre tabindex="0"><code data-lang="shell"><span><span>/Users/ramsayleung <span>[</span>ramsayleung@ramsayleungs-Laptop<span>]</span> <span>[</span>18:28<span>]</span>
</span></span><span><span>&gt; curl -v github.com -x socks5://127.0.0.1:10810
</span></span><span><span>*   Trying 127.0.0.1:10810...
</span></span><span><span>* Connected to 127.0.0.1 <span>(</span>127.0.0.1<span>)</span> port <span>10810</span>
</span></span><span><span>* SOCKS5 connect to 172.19.1.1:80 <span>(</span>locally resolved<span>)</span>
</span></span><span><span>* SOCKS5 request granted.
</span></span><span><span>* Connected to 127.0.0.1 <span>(</span>127.0.0.1<span>)</span> port <span>10810</span>
</span></span><span><span>&gt; GET / HTTP/1.1
</span></span><span><span>&gt; Host: github.com
</span></span><span><span>&gt; User-Agent: curl/8.4.0
</span></span><span><span>&gt; Accept: */*
</span></span><span><span>&gt;
</span></span><span><span>&lt; HTTP/1.1 <span>301</span> Moved Permanently
</span></span><span><span>&lt; Content-Length: <span>0</span>
</span></span><span><span>&lt; Location: https://github.com/
</span></span><span><span>&lt;
</span></span><span><span>* Connection <span>#0 to host 127.0.0.1 left intact</span>
</span></span><span><span>
</span></span><span><span>/Users/ramsayleung <span>[</span>ramsayleung@ramsayleungs-Laptop<span>]</span> <span>[</span>18:28<span>]</span>
</span></span><span><span>&gt; curl -v github.com -x socks5://127.0.0.1:10810
</span></span><span><span>*   Trying 127.0.0.1:10810...
</span></span><span><span>* Connected to 127.0.0.1 <span>(</span>127.0.0.1<span>)</span> port <span>10810</span>
</span></span><span><span>* SOCKS5 connect to 172.19.1.1:80 <span>(</span>locally resolved<span>)</span>
</span></span><span><span>* SOCKS5 request granted.
</span></span><span><span>* Connected to 127.0.0.1 <span>(</span>127.0.0.1<span>)</span> port <span>10810</span>
</span></span><span><span>&gt; GET / HTTP/1.1
</span></span><span><span>&gt; Host: github.com
</span></span><span><span>&gt; User-Agent: curl/8.4.0
</span></span><span><span>&gt; Accept: */*
</span></span><span><span>&gt;
</span></span><span><span>&lt; HTTP/1.1 <span>301</span> Moved Permanently
</span></span><span><span>&lt; Content-Length: <span>0</span>
</span></span><span><span>&lt; Location: https://github.com/
</span></span><span><span>&lt;
</span></span><span><span>* Connection <span>#0 to host 127.0.0.1 left intact</span>
</span></span></code></pre></td></tr></tbody></table></div></div><p>The request actually succeeded! github.com returned a successful result!</p><p>This means we’ve truly broken through the network restrictions and can access any website!</p><p>We hadn’t realized before that xray could be used in this clever way :)</p><p>Here we exploited a simple cognitive bias: not all services using port 53 are DNS query requests.</p><h2 id="ultimate-approach-dns-tunnel"><span>5</span> Ultimate Approach: DNS Tunnel</h2><p>If Approach 2 still didn’t work, we had one final trick up our sleeves.</p><p>Currently, the gateway only checks whether the port is 53 to determine if it’s a DNS request.
But if the gateway were stricter and inspected the content of DNS request packets, it would discover that our requests are “disguised” as DNS queries rather than genuine DNS queries:</p><figure>
<label for="zoomCheck-0b089"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/intercept-dns-request-en.png"/></label></figure><p>Since disguised DNS requests would be blocked, we could embed all requests inside genuine DNS request packets, making them DNS TXT queries. We’d genuinely be querying DNS, just with some extra content inside:</p><figure>
<label for="zoomCheck-78ed8"><img loading="lazy" src="https://ramsayleung.github.io/ox-hugo/dns-tunnel-en.png"/></label></figure><p>However, this ultimate approach requires a DNS Tunnel client to encapsulate all requests. I didn’t have such software on my computer, so this remained a theoretical ultimate solution that couldn’t be practically verified.</p><h2 id="conclusion"><span>6</span> Conclusion</h2><p>With the long journey ahead, my roommate and I spent about 4 hours remotely breaking through the network restrictions, having great fun in the process, proving that our problem-solving approach was indeed feasible.</p><p>The successful implementation of the solution was mainly thanks to my roommate, the networking expert, who provided remote technical and conceptual support.</p><p>The only downside was that although we broke through the network restrictions and could access any website, the plane’s bandwidth was extremely limited, making web browsing quite painful. So I didn’t spend much time browsing the web.</p><p>For the remaining hours, I rewatched the classic 80s time-travel movie: <code>&#34;Back to the Future&#34;</code> , which was absolutely fantastic.</p><p>Last and not least, it’s the disclaimer:</p><p>This technical exploration is intended solely for educational and research purposes. We affirm our strict adherence to all relevant regulations and service terms throughout this project.</p></div></div>
  </body>
</html>
