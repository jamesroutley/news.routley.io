<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://devcenter.heroku.com/articles/heroku-22-stack">Original</a>
    <h1>Heroku 22 Stack</h1>
    
    <div id="readability-page-1" class="page"><div role="main">
        









<div>
  <article>

    <nav aria-label="Breadcrumb"><ul><li><a href="https://devcenter.heroku.com/categories/heroku-architecture">Heroku Architecture</a></li><li><a href="https://devcenter.heroku.com/categories/stacks">Stacks (operating system images)</a></li><li><a aria-current="page" href="https://devcenter.heroku.com/articles/heroku-22-stack">Heroku-22 Stack</a></li></ul></nav>

    

    
    

    


    <p><span>Last updated June 15, 2022</span></p>
    
    

      
      <p>This article describes the Heroku-22 stack, based on Ubuntu 22.04. <a href="https://devcenter.heroku.com/articles/stack">What is a stack?</a></p>

<h2 id="what-s-new">What’s new</h2>

<p>This stack is now based on Ubuntu 22.04, compared to Ubuntu 20.04 used in the <a href="https://devcenter.heroku.com/articles/heroku-20-stack">Heroku-20 stack</a>.</p>

<p>The most important changes compared to Heroku-20 are:</p>

<ul>
<li>The stack no longer includes a <em>system</em> Ruby installation. This will not affect the vast majority of users, since Ruby apps will use the Ruby installation provided by the Ruby buildpack.</li>
<li>The stack no longer includes a <em>system</em> Python 2 installation (accessed on Heroku-20 via the <code>python2</code> command). Python 3 continues to be available via the <code>python</code> and <code>python3</code> commands, as it was for Heroku-20.</li>
</ul>

<h2 id="available-software">Available software</h2>

<p>Every stack on Heroku supports different operating system packages and language runtime versions. This support is typically confined to software that was still actively developed by the respective maintainers at the time the stack was first released.</p>

<h3 id="language-runtimes">Language runtimes</h3>

<p>For the most accurate information on supported language runtime versions, please check the individual language pages:</p>

<table>
<thead>
  <tr>
    <th>Buildpack</th>
        <th>Shorthand</th>
        <th>Runtime versions</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td><a href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-ruby">Ruby</a></td>
    <td><code>heroku/ruby</code></td>
        <td><a href="https://devcenter.heroku.com/articles/ruby-support#ruby-versions">Runtime versions</a></td>
  </tr>
  <tr>
    <td><a href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-nodejs">Node.js</a></td>
    <td><code>heroku/nodejs</code></td>
        <td><a href="https://devcenter.heroku.com/articles/nodejs-support#supported-runtimes">Runtime versions</a></td>
  </tr>
  <tr>
    <td><a href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-python">Python</a></td>
    <td><code>heroku/python</code></td>
    <td><a href="https://devcenter.heroku.com/articles/python-support#supported-runtimes">Runtime versions</a></td>
  </tr>
  <tr>
    <td><a href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-java">Java</a></td>
    <td><code>heroku/java</code></td>
        <td><a href="https://devcenter.heroku.com/articles/java-support#supported-java-versions">Runtime versions</a></td>
  </tr>
  <tr>
    <td><a href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-php">PHP</a></td>
    <td><code>heroku/php</code></td>
    <td><a href="https://devcenter.heroku.com/articles/php-support#supported-versions">Runtime versions</a></td>
  </tr>
  <tr>
    <td><a href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-go">Go</a></td>
    <td><code>heroku/go</code></td>
    <td><a href="https://devcenter.heroku.com/articles/go-support#go-versions">Runtime versions</a></td>
  </tr>
</tbody>
</table>

<h3 id="operating-system-packages">Operating system packages</h3>

<p>For a full list of operating system packages available on Heroku-22, please refer to article <a href="https://devcenter.heroku.com/articles/stack-packages">Ubuntu Packages on Heroku Stacks</a>.</p>

<h2 id="support-period">Support period</h2>

<p>Heroku-22 is based on Ubuntu 22.04. It will be supported through April 2027. Learn more about Heroku’s <a href="https://devcenter.heroku.com/articles/stack-update-policy">stack update policy</a>.</p>

<h2 id="using-heroku-22">Using Heroku-22</h2>

<p><a href="https://devcenter.heroku.com/articles/heroku-20-stack">Heroku-20</a> is currently the <a href="https://devcenter.heroku.com/articles/stack#default-stack">default stack</a> for newly created apps.</p>

<p>To use Heroku-22 instead, it must be specified explicitly when creating an app:</p>
<pre><code>$ heroku create --stack heroku-22
</code></pre>
<p>You may change the stack on an existing app; the next build performed will then use the new stack:</p>
<pre><code>$ heroku stack:set heroku-22
</code></pre>
<p>If you are using <a href="https://devcenter.heroku.com/articles/app-json-schema#stack"><code>app.json</code></a>, you should also specify the stack there to ensure that your Review Apps and Heroku CI runs use the same stack:</p>
<pre><code>{
   &#34;stack&#34;: &#34;heroku-22&#34;
}
</code></pre>
<p>An existing app’s stack cannot be changed using <code>app.json</code>. The stack specified is only applied to newly created apps that are a <a href="https://devcenter.heroku.com/articles/github-integration-review-apps">Review App</a>, a <a href="https://devcenter.heroku.com/articles/heroku-ci">Heroku CI</a> test run app, or an app created using a <a href="https://devcenter.heroku.com/articles/heroku-button">Heroku Button</a>.</p>

<h2 id="upgrading-to-heroku-22">Upgrading to Heroku-22</h2>

<p>Please refer to the <a href="https://devcenter.heroku.com/articles/upgrading-to-the-latest-stack">stack upgrading guide</a> to understand the procedures to follow when upgrading to a new stack.</p>

<p>We recommend that you monitor your application closely after migrating an app to the new stack to ensure it’s performing correctly.</p>

<h3 id="upgrade-notes">Upgrade notes</h3>

<h4 id="system-ruby-is-no-longer-installed">System Ruby is no longer installed</h4>

<p>The stack no longer includes a <em>system</em> Ruby installation. This will not affect the vast majority of users, since by default Ruby apps will use the Ruby installation provided by the Ruby buildpack instead.</p>

<p>If your app is implemented in a language other than Ruby, but relies on Ruby for scripting purposes e.g. during startup or for controlling workers, you may have to <a href="https://devcenter.heroku.com/articles/using-multiple-buildpacks-for-an-app">add</a> the <code>heroku/ruby</code> buildpack to your app.</p>

<p>If your application uses Ruby and you see <code>ruby: command not found</code> errors, check that you haven’t accidentally been using the system-level Ruby installation; you may do so by verifying the Ruby buildpack is present in your application’s list of buildpacks using <code>heroku buildpacks</code>. If the <code>heroku/ruby</code> buildpack (or a GitHub URL equivalent) is missing, see our <a href="https://devcenter.heroku.com/articles/buildpacks">buildpacks</a> documentation for how to add it. You will need to check the buildpack order carefully - the newly added Ruby buildpack may need to go prior to any other buildpacks, depending on exactly where Ruby is being used.</p>

<p>If after adding the Ruby buildpack, you are still seeing <code>ruby: command not found</code> errors from <code>profile.d/</code> scripts at application boot, this is due to the fact that <code>profile.d/</code> scripts are sourced in alphabetical order, and buildpack Ruby is only added to <code>PATH</code> once the <code>profile.d/ruby.sh</code> script runs. Any other <code>profile.d/</code> scripts will need to have a name that sorts alphabetically after <code>ruby.sh</code>. Alternatively, you can move the contents of any affected <code>profile.d/</code> scripts to the <a href="https://devcenter.heroku.com/articles/buildpack-api#profile-d-scripts">.profile</a> file instead, which is guaranteed to always run after all other <code>profile.d/*</code> scripts.</p>

<h4 id="system-python-2-is-no-longer-installed">System Python 2 is no longer installed</h4>

<p>The stack no longer includes a <em>system</em> Python 2 installation (accessed on Heroku-20 via the <code>python2</code> command), since Python 2 has been <a href="https://www.python.org/doc/sunset-python-2/">sunset upstream</a> for some time.</p>

<p>The system Python installation is not the same as the one provided by the Python buildpack (which had <a href="https://devcenter.heroku.com/articles/python-2-7-eol-faq">previously dropped support for Python 2</a>, starting in Heroku-20).</p>

<p>Python 3 continues to be available via the <code>python</code> and <code>python3</code> commands (either via system Python, or the buildpack provided Python installation), as it was for Heroku-20.</p>

<h4 id="openssl-3">OpenSSL 3</h4>

<p>Ubuntu 22.04 ships with OpenSSL 3.0. OpenSSL 1.1 is not available as a runtime library.</p>

<p>If you see OpenSSL/libssl related errors (for example <code>libssl.so.1.1: cannot open shared object file</code>, but there will be many other variations), you will need to update your dependencies and/or third-party buildpacks to a version that is compatible with OpenSSL 3, and ensure that dependencies or binaries you use are compiled against OpenSSL 3.</p>

<p>In addition, OpenSSL 3 drops default support for a number of legacy/insecure cryptographic algorithms. If you see TLS/SSL related failures connecting from your application to external services, it is likely that those servers are running outdated/insecure software or configurations, that will need to be fixed by the maintainers of those services.</p>

<h4 id="the-static-buildpack-is-no-longer-supported">The static buildpack is no longer supported</h4>

<p>The experimental <a href="https://github.com/heroku/heroku-buildpack-static">heroku-buildpack-static</a> buildpack is not supported on Heroku-22. If your application is using that buildpack (check the output of the <code>heroku buildpacks</code> command for either <code>heroku-community/static</code> or <code>heroku-buildpack-static</code>), you will need to switch to the more modern and regularly maintained <a href="https://github.com/heroku/heroku-buildpack-nginx">Nginx buildpack</a> instead (available via <code>heroku-community/nginx</code>).</p>

<p>For more information, see this <a href="https://github.com/heroku/heroku-buildpack-static#warning-heroku-buildpack-static-is-deprecated">migration guide</a>.</p>

<h2 id="heroku-22-docker-image">Heroku-22 Docker image</h2>

<p>Heroku-22 is available as two <a href="https://hub.docker.com/r/heroku/heroku">Docker images</a>:</p>

<ol>
<li>The runtime image (<code>heroku/heroku:22</code>), which is recommended over the build image for most workloads.</li>
<li>The build image (<code>heroku/heroku:22-build</code>), which is larger as it includes development headers and toolchains. It is only recommended for customers that need to compile source code or dependencies.</li>
</ol>

<p>Use the following command in your <code>Dockerfile</code> to use Heroku-22 as your base image:</p>
<pre><code>FROM heroku/heroku:22
</code></pre>
<p>To learn more about deploying Docker images, please refer to the <a href="https://devcenter.heroku.com/articles/container-registry-and-runtime">Heroku Container Registry and Runtime</a> documentation.</p>

    
  </article>
</div>

  

      
    </div></div>
  </body>
</html>
