<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://www.righto.com/2022/08/lumafield-flip-flop.html">Original</a>
    <h1>Reverse-engineering a 1960s hybrid flip flop module with X-ray CT scans</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-1535297747205947738" itemprop="description articleBody">


<p>How can you find out what&#39;s inside a sealed electronics module from the 1960s?
In this blog post, I reverse-engineer a hybrid flip flop module that was used for ground-testing of equipment from the Apollo space program.
These modules are undocumented<span id="fnref:documentation"><a href="#fn:documentation">1</a></span>, so their internal circuitry is a mystery.
Thanks to <a href="https://lumafield.com">Lumafield</a>, I obtained a three-dimensional CT scan of the module that
clearly shows the wiring and components:
transistors, diodes, resistors, and capacitors.
From these images, I could determine the circuitry of this flip flop module.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/structure.jpg"><img alt="A 3-D scan of the module showing the circuitry inside the compact package. This image uses the blue color map. Click this image (or any other) for a larger version." height="387" src="https://static.righto.com/images/apollo-module=lpff/structure-w600.jpg" title="A 3-D scan of the module showing the circuitry inside the compact package. This image uses the blue color map. Click this image (or any other) for a larger version." width="600"/></a></p><p>A 3-D scan of the module showing the circuitry inside the compact package. This image uses the blue color map. Click this image (or any other) for a larger version.</p>
<p>The photo below shows the module, a block of plastic 1.5 inches long with 13 pins.
I could determine most of its functionality by probing it on a breadboardâ€”conveniently, the pin spacing is compatible with standard
solderless breadboards. The module is a flip flop (as the FF label suggests) but some questions remained.
Last month, I reverse-engineered a simpler hybrid module (<a href="https://www.righto.com/2022/06/x-ray-reverse-engineering-hybrid-module.html">post</a>) using 2-D X-rays.
However, this flip flop module was much more complex and I couldn&#39;t reverse-engineer it from standard X-rays.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/module.jpg"><img alt="The Motorola LP FF module. It is a 13-pin block." height="257" src="https://static.righto.com/images/apollo-module=lpff/module-w400.jpg" title="The Motorola LP FF module. It is a 13-pin block." width="400"/></a></p><p>The Motorola LP FF module. It is a 13-pin block.</p>
<p>Fortunately, a company called Lumafield offered to take 3-D X-rays with their
<a href="https://www.lumafield.com/products">Neptune CT scanner</a>.
This 6-foot wide unit has a turntable and an X-Y-Z positioning mechanism inside.
You put an item on the turntable and the unit automatically takes X-rays from hundreds of different angles.
Cloud software then generates a 3-D representation from the X-rays.
This industrial system is aimed at product development, product analysis, quality checking, and so forth.
It handles metal components, soft goods such as shoes, plastic items, and complex assemblies.
I think this is the first time it&#39;s been used for 1960s electronics, though.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/lumafield.jpg"><img alt="The Lumafield CT X-ray machine. Photo courtesy of Lumafield." height="333" src="https://static.righto.com/images/apollo-module=lpff/lumafield-w500.jpg" title="The Lumafield CT X-ray machine. Photo courtesy of Lumafield." width="500"/></a></p><p>The Lumafield CT X-ray machine. Photo courtesy of Lumafield.</p>
<p>A simple web-based interface (below) lets you manipulate the representation by rotating and slicing it with your touchpad or mouse.
In this screenshot, I&#39;m adjusting the clipping box by sliding the red, green, and blue squares.
This yields a cross-section of the module (purple).
You can look at the flip flop module yourself at <a href="https://app.lumafield.com/project/afa60fd5-308d-41da-a0c6-14294af54338">this link</a>;
give it a minute to load.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/screenshot.jpg"><img alt="Screenshot of the Lumafield web interface." height="305" src="https://static.righto.com/images/apollo-module=lpff/screenshot-w600.jpg" title="Screenshot of the Lumafield web interface." width="600"/></a></p><p>Screenshot of the Lumafield web interface.</p>
<h2>Background on the module</h2>
<p>To ensure a successful Moon mission, all the systems of Apollo were thoroughly tested on the ground before flight.
These Motorola modules were used in test equipment for
One box onboard the spacecraft was the Up-Data Link,<span id="fnref:udl"><a href="#fn:udl">2</a></span>
tested by the &#34;Up-Data Link Confidence Test Set&#34; shown below.
Unfortunately the test box had no documentation, so I had to reverse-engineer its functionality.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/box.jpg"><img alt="The up-data test box is a heavy rack-mounted box full of circuitry. The wiring on top is for our reverse-engineering, plugged into the box&#39;s numerous test points." height="375" src="https://static.righto.com/images/apollo-module=lpff/box-w500.jpg" title="The up-data test box is a heavy rack-mounted box full of circuitry. The wiring on top is for our reverse-engineering, plugged into the box&#39;s numerous test points." width="500"/></a></p><p>The up-data test box is a heavy rack-mounted box full of circuitry. The wiring on top is for our reverse-engineering, plugged into the box&#39;s numerous test points.</p>
<p>The test box was constructed from 25 printed-circuit boards,
with the boards connected by a tangled backplane of point-to-point wiring.
Each board held up to 15 tan Motorola modules,
blocks that look a bit like relays but contain electronic circuitry.
The photo below shows one of the boards.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/board.jpg"><img alt="One circuit board from the test box. It has 15 modules including four LP FF modules." height="422" src="https://static.righto.com/images/apollo-module=lpff/board-w500.jpg" title="One circuit board from the test box. It has 15 modules including four LP FF modules." width="500"/></a></p><p>One circuit board from the test box. It has 15 modules including four LP FF modules.</p>
<p>You might wonder why complex electronics would be built from modules instead of integrated circuits.
The invention of the integrated circuit in 1958 led to an electronic revolution, but in the mid-1960s integrated circuits were still expensive and rare.
An alternative was small hybrid modules that functioned as building blocks: logic gates, flip flops, op-amps, and other circuits.
Instead of a silicon chip, these hybrid modules contained discrete transistors, resistors, capacitors, and other components.</p>
<h2>The components inside the module</h2>
<p>The CT scan (below) provides a high-resolution module of the module, its components, and the wiring.
The scan reveals that the module is constructed from two boards, one at the top and one at the bottom, with components mounted vertically, a technique known as cordwood construction.
This technique was used in the 1960s when dense packing of components was required, with the cylindrical components stacked together like wooden logs.
Unexpectedly, the wiring isn&#39;t a printed circuit board (like the previous module that I examined), but spot-welded ribbon wiring.
(Note that the wire contacts the side of each pin or lead.)
The 13 pins pass vertically through the module, with connections at the top and bottom; the scan shows the
shape of each pin in detail.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/module-bw.jpg"><img alt="CT scan of the Motorola LP FF module. In this image, I&#39;ve used the grayscale color scheme." height="360" src="https://static.righto.com/images/apollo-module=lpff/module-bw-w500.jpg" title="CT scan of the Motorola LP FF module. In this image, I&#39;ve used the grayscale color scheme." width="500"/></a></p><p>CT scan of the Motorola LP FF module. In this image, I&#39;ve used the grayscale color scheme.</p>
<p>The module contains two NPN transistors, mounted upside down with wires attached to the pins.
The transistors are in metal cans, which show up clearly in the X-rays. The small square tab sticking out from a transistor indicates the emitter pin.
For the transistor on the right, the tiny silicon die is visible between the pins.
The die is connected to the pins by bond wires, but the bond wires are too small to be visible in the X-ray.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/transistors.jpg"><img alt="Two transistors in the module." height="206" src="https://static.righto.com/images/apollo-module=lpff/transistors-w400.jpg" title="Two transistors in the module." width="400"/></a></p><p>Two transistors in the module.</p>
<p>Some components aren&#39;t as easy to recognize, such as resistors.
A carbon composition resistor is constructed from a resistive carbon cylinder, as shown in the cross section. A metal pin sticks into each end of the cylinder, providing the resistor&#39;s leads.
The carbon doesn&#39;t block X-rays, so it is invisible.
Thus, a resistor looks like two dangling metal pins in the scan.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/comparison-composition.jpg"><img alt="X-ray of a carbon composition resistor and a cross-section of a similar (but not identical) resistor. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." height="375" src="https://static.righto.com/images/apollo-module=lpff/comparison-composition-w300.jpg" title="X-ray of a carbon composition resistor and a cross-section of a similar (but not identical) resistor. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." width="300"/></a></p><p>X-ray of a carbon composition resistor and a cross-section of a similar (but not identical) resistor. Photo from the book <a href="https://nostarch.com/open-circuits">Open Circuits</a>, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors.</p>
<p>A carbon film resistor, in contrast, is constructed from a spiral of carbon film on a ceramic rod.
The carbon and ceramic don&#39;t show up in the scan, but the resistor&#39;s end-caps are visible.
Thus, the two types of resistors appear different in the images.
The module uses both types of resistors; I&#39;m not sure why.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/comparison-spiral.jpg"><img alt="X-ray of a carbon film resistor and a photograph of a similar resistor. The spiral cut in the carbon film controls the resistance. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." height="308" src="https://static.righto.com/images/apollo-module=lpff/comparison-spiral-w300.jpg" title="X-ray of a carbon film resistor and a photograph of a similar resistor. The spiral cut in the carbon film controls the resistance. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." width="300"/></a></p><p>X-ray of a carbon film resistor and a photograph of a similar resistor. The spiral cut in the carbon film controls the resistance. Photo from the book <a href="https://nostarch.com/open-circuits">Open Circuits</a>, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors.</p>
<p>The module contains many diodes and
the internal structure of the diode is visible on the scan.
A diode is constructed from a semiconductor die, with a metal S-shaped spring making contact with one side of the die.
For some reason, the spring is much more visible in Zener diodes; I assume the spring happens to be made from a more radio-opaque metal.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/comparison-diodes.jpg"><img alt="X-ray slice through a diode, a Zener diode, and a cross-section of a diode. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." height="298" src="https://static.righto.com/images/apollo-module=lpff/comparison-diodes-w400.jpg" title="X-ray slice through a diode, a Zener diode, and a cross-section of a diode. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." width="400"/></a></p><p>X-ray slice through a diode, a Zener diode, and a cross-section of a diode. Photo from the book <a href="https://nostarch.com/open-circuits">Open Circuits</a>, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors.</p>
<p>With careful examination, the diode&#39;s die can be seen in the scan as a bright spot at one side of the spring.
This reveals the orientations of the diode, which is important for
creating a schematic.
The two diodes below have opposite orientations: the left one has the die on the top, while the right one has the die on the bottom.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/diodes.jpg"><img alt="Two diodes in the scan. The first diode has the die at the top, while the second has the die at the bottom." height="316" src="https://static.righto.com/images/apollo-module=lpff/diodes-w150.jpg" title="Two diodes in the scan. The first diode has the die at the top, while the second has the die at the bottom." width="150"/></a></p><p>Two diodes in the scan. The first diode has the die at the top, while the second has the die at the bottom.</p>
<p>The module&#39;s final components are capacitors, probably silver-mica capacitors.
As shown in the cross-section, the capacitor consists of layers of foil and mica.
These layers are too thin to show up on X-ray, but the rectangular connections to the leads are visible.
Thus, a capacitor looks like rectangles attached to pins.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/comparison-caps.jpg"><img alt="X-ray of a silver-mica capacitor and a cross-section of a similar capacitor. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." height="206" src="https://static.righto.com/images/apollo-module=lpff/comparison-caps-w600.jpg" title="X-ray of a silver-mica capacitor and a cross-section of a similar capacitor. Photo from the book Open Circuits, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors." width="600"/></a></p><p>X-ray of a silver-mica capacitor and a cross-section of a similar capacitor. Photo from the book <a href="https://nostarch.com/open-circuits">Open Circuits</a>, Copyright Eric Schlaepfer and Windell Oskay; used with permission of the authors.</p>
<p>The cross-section image below shows a horizontal slice through the module.
Since the components are mounted vertically as cordwood, this cuts through the components.
The pins at the top and bottom are bright cyan.
The blue circles are diodes. The more ghostly circles are resistors.
The large hollow circles in the center are the transistors, on top of the capacitors.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/components.jpg"><img alt="A cross-section through the components." height="189" src="https://static.righto.com/images/apollo-module=lpff/components-w500.jpg" title="A cross-section through the components." width="500"/></a></p><p>A cross-section through the components.</p>
<p>It is easy to extract the wiring from the reconstruction.<span id="fnref:wiring"><a href="#fn:wiring">3</a></span>
By defining a bounding box in the user interface, I obtained the top wiring layer as a slice, separated from the other
circuitry.
This view also makes it clear that the wiring is spot-welded to the sides of the pins, and not a printed-circuit board.
At the bottom left, you can see where two wires have been welded together.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/top-wiring.jpg"><img alt="The top wiring layer in the module." height="204" src="https://static.righto.com/images/apollo-module=lpff/top-wiring-w500.jpg" title="The top wiring layer in the module." width="500"/></a></p><p>The top wiring layer in the module.</p>
<p>The wiring on the bottom of the module can be extracted similarly by changing the slice bounds in the user interface.
I used a different color map for this image.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/bottom.jpg"><img alt="The bottom wiring of the board." height="194" src="https://static.righto.com/images/apollo-module=lpff/bottom-w500.jpg" title="The bottom wiring of the board." width="500"/></a></p><p>The bottom wiring of the board.</p>
<p>By studying the CT scan, 
I could reverse-engineer the circuitry.
The hardest part was examining the diodes closely to determine their orientation.
The resulting schematic is shown below (click for a larger version).</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/schematic.jpg"><img alt="Schematic of the flip-flop module." height="289" src="https://static.righto.com/images/apollo-module=lpff/schematic-w700.jpg" title="Schematic of the flip-flop module." width="700"/></a></p><p>Schematic of the flip-flop module.</p>
<p>The core of the flip flop is the two cross-coupled transistors in the center: the output of one transistor is connected (through diodes) to the input (base) of the other.
If one transistor is on, it forces the other transistor off.
Thus, the flip flop has two stable states with one transistor on and one transistor off.
In the remainder of the post, I&#39;ll explain the circuit in more detail.</p>
<h2>How a J-K flip flop works</h2>
<p>A flip flop is a circuit that can be put into two states, outputting a 0 or a 1.
A flip flop has many uses, such as storing a bit, providing a delay, implementing a counter, or dividing a frequency by 2.
A flip flop is controlled by a clock signal, changing state at the moment when the clock signal switches.
(Flip flops often also have asynchronous inputs: Set and Reset inputs that act immediately, regardless of the clock.)</p>
<p>Several different types of flip flops are used for different purposes.
A T (toggle) flip flops simply switches from 0 to 1, or 1 to 0, on each clock pulse, dividing the clock frequency by 2.
A D (data) flip flop takes a data bit as input, storing it when the clock pulses.
The J-K flip flop, however, is a general-purpose flip flop, with its function selected by the J and K control inputs.
Its action is defined by the following table.</p>

<table>
  <tbody><tr><th>J</th><th>K</th><th>Output on clock pulse</th></tr>
  <tr><td>0</td><td>0</td><td>Q (no change)</td></tr>
  <tr><td>0</td><td>1</td><td>0 (clear)</td></tr>
  <tr><td>1</td><td>0</td><td>1 (set)</td></tr>
  <tr><td>1</td><td>1</td><td>Q&#39; (toggle)</td></tr>
</tbody></table>

<h2>Diode-transistor logic NAND gate</h2>
<p>The flip flop is constructed from diode-transistor logic NAND gates.
The NAND gate has two inputs, isolated from each other by diodes.
If both inputs are high, the transistor&#39;s base is pulled high by the first resistor.
This turns on the transistor, pulling the output low.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/nand2.jpg"><img alt="With a 1 for both inputs, the transistor turns on, producing a 0 output." height="278" src="https://static.righto.com/images/apollo-module=lpff/nand2-w300.jpg" title="With a 1 for both inputs, the transistor turns on, producing a 0 output." width="300"/></a></p><p>With a 1 for both inputs, the transistor turns on, producing a 0 output.</p>
<p>Conversely, if one input (or both) is low, the current passes through the diode and the transistor&#39;s base is pulled low.
The transistor turns off and the output resistor pulls the output high.
Thus, the output is low when both inputs are high, and otherwise high, so
the circuit implements a NAND gate.<span id="fnref:zener"><a href="#fn:zener">4</a></span></p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/nand1.jpg"><img alt="With a 0 input, the transistor is turned off, producing a 1 output." height="275" src="https://static.righto.com/images/apollo-module=lpff/nand1-w300.jpg" title="With a 0 input, the transistor is turned off, producing a 1 output." width="300"/></a></p><p>With a 0 input, the transistor is turned off, producing a 1 output.</p>
<p>Since this gate uses diodes and a transistor, it is called diode-transistor logic.
This logic family was popular
in the 1960s, until it was replaced by transistor-transistor logic (TTL).
TTL uses a transistor in place of the input diodes, providing better performance.</p>
<p>Cross-coupling two NAND gates produces a simple latch, the Set-Reset latch.
When one NAND gate is off, it forces the other gate on.
Thus, the circuit has two stable states.
Pulling the set&#39; line low forces the output low, while pulling reset&#39; low forces the output high.
NAND-gate latches are very common circuits, storing one bit.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/nand-latch.jpg"><img alt="Cross-coupling two NAND gates creates a latch." height="188" src="https://static.righto.com/images/apollo-module=lpff/nand-latch-w220.jpg" title="Cross-coupling two NAND gates creates a latch." width="220"/></a></p><p>Cross-coupling two NAND gates creates a latch.</p>
<h2>Understanding the flip flop circuit</h2>
<p>The difference between a flip flop and a latch (by a common definition) is that a latch changes
state as soon as an input changes, but a flip flop only changes state when triggered by a clock
signal.
In this section, I&#39;ll explain how the clock is implemented in the flip flop module, controlled by the J-K functionality.</p>
<p>The underlying idea is that the clock input is connected through capacitors, so a sharp negative edge
on the clock briefly pulls a transistor&#39;s base low, turning off the transistor and switching that
output high. This makes the flip flop edge-sensitive.</p>
<p>The schematic below shows one-half of the flip flop, omitting the earlier cross-coupled latch circuitry (shown as &#34;feedback&#34;).
If the capacitor is charged as shown, then a negative clock pulse (arrow) will pull the capacitor negative,
briefly shutting off the transistor and turning on the output Q.<span id="fnref:symmetry"><a href="#fn:symmetry">5</a></span>
The latch circuitry will then keep the flip flop in the new state.</p>
<p><a href="https://static.righto.com/images/apollo-module=lpff/clock-circuit.jpg"><img alt="When the clock goes low, this can pull the transistor base low, turning the transistor off." height="310" src="https://static.righto.com/images/apollo-module=lpff/clock-circuit-w500.jpg" title="When the clock goes low, this can pull the transistor base low, turning the transistor off." width="500"/></a></p><p>When the clock goes low, this can pull the transistor base low, turning the transistor off.</p>
<p>The conditions for the capacitor to charge are that J must be high and Q must be low.
Otherwise the capacitor will block the clock pulse.<span id="fnref:capacitor"><a href="#fn:capacitor">6</a></span>
In other words, if J is high and Q is low, the output will toggle high on the clock pulse.
In the mirror-image circuit (not shown), if K is high and Q&#39; is low, the complemented output will toggle high on the clock pulse.
This is the desired behavior for a J-K flip flop.<span id="fnref:behavior"><a href="#fn:behavior">7</a></span></p>
<p>The reverse-engineering solves one mystery about the flip flop.
When I probed the module on a breadboard, touching a ground wire to the J pin
immediately set the flip flop. This is very strange behavior because
the J and K inputs are supposed to be controlled by the clock. Moreover, a high (not low) J input should set the output.
(And conversely with K.)
Looking at the reverse-engineered schematic, though, explains that a sharp pulse on the J pin will act like the clock, sending a pulse through the capacitor, turning off the transistor, and causing a high output.
I assume this behavior is not intentional, and J inputs are expected not to transition as sharply as when I touched it with a ground wire.<span id="fnref:transition"><a href="#fn:transition">8</a></span></p>
<h2>Conclusion</h2>
<p>I was impressed by the quality of the CT scan. It not only provided a crystal-clear view of the components and wiring, but
even showed the internal structure of the components.
Being able to see inside a module is like having X-ray vision.
(That sounds redundant since it literally is X-rays, but I don&#39;t know a better way to describe it.)
If you have an application that requires looking inside, I give Lumafield a thumbs-up.</p>
<p>For more background on the Up-data Test Box, I have some Twitter threads:
<a href="https://twitter.com/kenshirriff/status/1432411774985195527">power-up</a>,
<a href="https://twitter.com/kenshirriff/status/1434947848605290497">modules</a>,
<a href="https://twitter.com/kenshirriff/status/1434245713651658752">paper tape reader</a>, and
<a href="https://twitter.com/kenshirriff/status/1511106558930817030">clock circuit</a>.
Also see CuriousMarc&#39;s video on the box:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/VReePQJRRI0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>I announce my latest blog posts on Twitter, so follow me <a href="https://twitter.com/kenshirriff">@kenshirriff</a> for updates. I also have an <a href="http://www.righto.com/feeds/posts/default">RSS feed</a>.
Many thanks to <a href="https://www.lumafield.com/">Lumafield</a> and especially Jon Bruner for performing the CT scan of the module.
Thanks to Marcel for providing the Up-Data Link Test Box, which contains the modules, and thanks to John McMaster for earlier X-rays.
Cross-section photos copyright Windell Oskay and Eric Schlaepfer, from the upcoming book <a href="https://nostarch.com/open-circuits">Open Circuits</a>, which you should check out.</p>
<h2>Notes and references</h2>


</div></div>
  </body>
</html>
