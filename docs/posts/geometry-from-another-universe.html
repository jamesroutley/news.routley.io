<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.falsifian.org/blog/2022/01/17/s3d/">Original</a>
    <h1>Geometry from Another Universe</h1>
    
    <div id="readability-page-1" class="page">
<p>Post by James Cook [<a href="https://www.falsifian.org/">home</a>]</p>

<p>January 17, 2022</p>
<p><i>In which I show you a demo I had a lot of fun making.</i></p>
<p>
  <a href="https://www.falsifian.org/blog/2022/01/17/s3d/s3d.html"><img src="https://www.falsifian.org/blog/2022/01/17/s3d/demo_screenshot.png" width="300" height="300"/></a>
</p>
<p>
  <a href="https://www.falsifian.org/blog/2022/01/17/s3d/s3d.html">If you follow this link,</a> you&#39;ll be taken to an unusual house.
</p>
<p>
  You start on an enclosed lawn, surrounded by four walls with a doorway in one of them.
  If you go in and explore, you might begin to feel trapped.
  You&#39;ll find you can visit five different rooms in the house, or go back outside to the lawn, but there&#39;s no way to go anywhere else.
  It&#39;s not because there are walls stopping you from leaving.
  The house, and the little yard, are the whole universe.
  There&#39;s nothing else.
  If you keep going forward long enough, you end up back where you started.
  (Try to find a clear path in the house where you can do this without running into a wall.)
</p>
<p>
  Some other things to notice:
  </p><ul>
    <li>
      Objects in the distance seem to get smaller and then bigger again as you approach.
      The floor seems to curve upward, but every line you see is perfectly straight.
      If you press the &#34;Go down&#34; button until you&#39;re below the floor, the floor seems to curve downward instead.
    </li>
    <li>
      The lines on the floor appear parallel in some rooms, but in other rooms, you can see that they radiate out of one spot on the floor and then meet at another.
      They are all perfectly straight.
    </li>
    <li>
      If you make three right turns, you&#39;ll end up back in the room you started in.
    </li>
  </ul>

<h2>What&#39;s going on?</h2>
<p>
  This house exists in a geometric world called a <a href="https://en.wikipedia.org/wiki/3-sphere">3-sphere</a>, which is higher-dimensional version of a sphere (aka <i>2-sphere</i>).
  It&#39;s easiest to explain with an analogy.
  Suppose you took a two-dimensional person from a two-dimensional universe and put them on the surface of a sphere.
  </p><ul>
    <li>
      A collection of straight lines radiating out of one point will meet again at the opposite point.
      Lines of longitude behave this way: they meet at both the poles.
      A &#34;straight line&#34; in this universe means a line that splits the sphere exactly in half, like the Earth&#39;s equator, or a line of longitude.
    </li>
    <li>
      Because of that, and because light follows straight lines, an object that&#39;s as far away from you as possible — at the opposite point of the sphere — will fill your whole field of view.
      If you move closer to it, it will become <i>smaller</i>, taking up less and less of your field of view, until it&#39;s halfway around the sphere from you, and then it will get bigger and bigger until you&#39;re right next to it.
    </li>
    <li>
      If you wanted to, you could draw lines to separate the surface of the sphere into six cells, like the faces of a cube.
      Our flatlander would find that even though each room seems square-shaped, they can get back where they started by taking three right turns.
    </li>
  </ul>
  The 3-sphere you&#39;re exploring is a three-dimensional analogue to the 2-sphere we put the flatlander into.
  The rooms are arranged as the faces of a cube.
  The floor, although perfectly flat, has the geometry of a 2-sphere, which allows the lines painted on it to meet at two points, like lines of longitude.

<h2>Some Coordinates</h2>
<p>
  If you&#39;re familiar with the definition of a 3-sphere as 4-D points (x,y,z,w) with magnitude 1, the six rooms of the house are each centred on one of the axes: the yard is at (0,0,-1,0), the next room is at (0,0,0,1), and the next room forward is centred at (0,0,1,0). The floor is the plane y=0, the point (0,1,0,0) sits directly above all of the rooms, and if you check &#34;hide floor&#34; and look straight down, the red box you see is at (0,-1,0,0).
</p>
<h2>What this is not</h2>
<h3>The inside of a ball</h3>
<p>
  It may seem like you&#39;re just walking on the inside of a big balloon with stripes drawn on it.
  That&#39;s close to the truth, but there are a couple of differences:
  </p><ul>
    <li>
      It doesn&#39;t explain how objects sometimes get smaller as you get closer.
    </li>
    <li>
      If you press &#34;Go down&#34; until you&#39;re below the floor, the floor will appear to curve the other way.
      It&#39;s as if the floor splits the universe into two balls.
    </li>
  </ul>

<h3>A torus</h3>
<p>
  A torus is another shape which wraps around: if you keep going far enough, you&#39;ll get back where you started.
</p>
<p>
  The 3-sphere is different from a torus, though.
  Here&#39;s one way to see.
  Go and look for a place in the house where you can walk forward forever without running into a wall.
  If you were to draw a line on the floor while you did that (there&#39;s an idea for a feature...), that line would split the house into two parts.
  Each part would have one room (or the yard) at its centre, and there would be no way to walk from one part to the other without crossing the line you drew.
  If you tried the same thing on the torus, the floor would still be in one piece.
</p>
<h2>Why did you make this?</h2>
<p>
  I&#39;ve been interested in non-Euclidean geometry for a long time.
  I wanted to get some intuition for it, and I think the best way is to put myself inside and explore.
</p>
<h2>WebGL has no problem with non-Euclidean geometry</h2>
<p>
  This is done using WebGL, an API for drawing 3D graphics in a browser.
  You might think it&#39;s only designed to draw ordinary, Euclidean things, but it turns out it&#39;s perfectly suited to rendering this world as well.
  WebGL (and OpenGL) works with four-dimensional coordinates (x,y,z,w).
  Normally, you&#39;ll be advised to just set that w coordinate to 1 all the time.
  If you do that, the x, y and z coordinates will behave like ordinary 3-D geometry.
  I just ignored that rule and used the coordinates to represent points on the 3-sphere instead.
  It all works out.
  (You have to be a bit careful if you want to put textures on things without seeing seams between the triangles, but it can be done. The key is to make sure every flat surface is still a flat surface in 4-D.)
</p>
<h2>Source, including a constructive solid geometry library</h2>
<p>
  <a href="https://sr.ht/~falsifian/s3d/">Here&#39;s a link the the source code</a>.
  It&#39;s written in <a href="https://www.idris-lang.org/">Idris2</a>, an experimental language with a powerful type system, and uses the <a href="https://github.com/stefan-hoeck/idris2-dom">idris2-dom library</a> to interact with your browser.
  I had a lot of fun with it, but spent a lot of time learning to appease the typechecker, and also had to <a href="https://github.com/idris-lang/Idris2/pull/1888">submit</a> <a href="https://github.com/idris-lang/Idris2/pull/2100">some</a> <a href="https://github.com/stefan-hoeck/idris2-dom/pull/24">patches</a> in order to get my demo to run without overflowing the stack.
</p>
<p>
  The code actually includes a constructive solid geometry library, in the <code>src/SolidGeometry</code> directory.
  I used it to build the walls (a big block minus smaller blocks for the doors and windows) and some of the furniture around the house.
  It doesn&#39;t always work, and it&#39;s quite slow, and if you read the code while knowing anything about computational geometry, I can only assume you&#39;ll quickly realize I made it up as I went along.
  But I had fun making it!
  The input is a bunch of planes which split the world into cells, and a rule saying which cells are &#34;inside&#34; or &#34;outside&#34;; and the output is a bunch of triangles separating inside from outside.
</p>
<h2>Stuff I&#39;d like to do if I have time</h2>
<ul>
  <li>
    It turns out it&#39;s posible to embed a torus in the 3-sphere so that the inside and outside of the torus are exactly the same shape.
    It would be fun to explore that.
    (An <a href="https://github.com/falsifian/3d-spherical">earlier version of this project</a> that I made a long time ago has that, but it doesn&#39;t run in a web browser.)
  </li>
  <li>
    I&#39;d like to make a game that takes place in this universe. Ideas welcome!
  </li>
</ul>
<h2>See also</h2>
<ul>
  <li><a href="https://roguetemple.com/z/hyper/">Hyperrogue</a>. A game played on the hyperbolic plane, which is in a sense the opposite of a sphere.</li>
  <li><a href="https://blog.zarfhome.com/2021/06/hyperbolic-text.html">Hyperbolic text</a>. Has lots of links. I think I found it via <a href="https://www.dragonflydigest.com/">the Dragonfly BSD Digest</a>.</li>
  <li>
    <a href="https://www.youtube.com/watch?v=kEB11PQ9Eo8">Non-Euclidean Worlds Engine</a>.
    This one stitches together flat Euclidean geometry instead of making the whole universe curved.
  </li>
</ul>


</div>
  </body>
</html>
