<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ntietz.com/blog/visualizing-distributions-with-pepperoni-pizza/?utm_source=atom&amp;utm_medium=feed">Original</a>
    <h1>Visualizing distributions with pepperoni pizza (and javascript)</h1>
    
    <div id="readability-page-1" class="page"><div><p>There&#39;s a pizza shop near me that serves a normal pizza.
I mean, they distribute the toppings in a normal way.
They&#39;re not uniform at all.
The toppings are random, but not the way I want.</p>
<p>The colloquial understanding of &#34;random&#34; is kind of the Platonic ideal of a pizza: slightly chaotic but things are more or less spread out over the whole piece in a regular way.
If you take a slice you&#39;ll get more of less the same amount of pepperoni as any other slice.
And every bite will have roughly the same amount of pepperoni as every other bite.</p>
<p>I think it would look something like this.</p>


<p>This pizza to me is pretty much the canonical mental pizza.
It looks pretty random, but you know what you&#39;re gonna get.
And it is random!</p>
<p>Here&#39;s how we made it, with the visualiztion part glossed over.
First, we make a helper function, since <code>Math.random()</code> gives us values from 0 to 1, but we want values from -1 to 1.</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>// return a uniform random value in [-1, 1)
</span><span>function </span><span>randUniform</span><span>() {
</span><span>  </span><span>return </span><span>2</span><span>*</span><span>Math</span><span>.</span><span>random</span><span>() </span><span>- </span><span>1</span><span>;
</span><span>}
</span></code></pre>
<p>Then, we make a simple function that gives us the coordinates of where to put a pepperoni piece, from the uniform distribution.</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>uniformPepperoniPosition</span><span>() {
</span><span>  </span><span>var </span><span>[</span><span>centerX</span><span>, </span><span>centerY</span><span>, </span><span>radius</span><span>] </span><span>= </span><span>pepperoniBounds</span><span>();
</span><span>
</span><span>  </span><span>let </span><span>x </span><span>= </span><span>radius</span><span>*</span><span>2</span><span>;
</span><span>  </span><span>let </span><span>y </span><span>= </span><span>radius</span><span>*</span><span>2</span><span>;
</span><span>
</span><span>  </span><span>while </span><span>(</span><span>x</span><span>**</span><span>2 </span><span>+ </span><span>y</span><span>**</span><span>2 </span><span>&gt;= </span><span>radius</span><span>**</span><span>2</span><span>) {
</span><span>    </span><span>x </span><span>= </span><span>randUniform</span><span>() </span><span>* </span><span>radius</span><span>;
</span><span>    </span><span>y </span><span>= </span><span>randUniform</span><span>() </span><span>* </span><span>radius</span><span>;
</span><span>  }
</span><span>
</span><span>  </span><span>return </span><span>[</span><span>x</span><span>+</span><span>centerX</span><span>, </span><span>y</span><span>+</span><span>centerY</span><span>];
</span><span>}
</span></code></pre>
<p>And we cap it off with placing 300 fresh pieces of pepperoni on this pie, before we send it into the oven.
(It&#39;s an outrageous amount of very small pepperoni, chosen in both axes for ease of visualizing the distribution rather than realism.)</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>drawUniformPizza</span><span>() {
</span><span>  </span><span>drawBackground</span><span>();
</span><span>  </span><span>drawPizzaCrust</span><span>();
</span><span>  </span><span>drawCheese</span><span>();
</span><span>
</span><span>  </span><span>var </span><span>[</span><span>_</span><span>, </span><span>_</span><span>, </span><span>radius</span><span>] </span><span>= </span><span>pepperoniBounds</span><span>();
</span><span>
</span><span>  </span><span>for </span><span>(</span><span>let </span><span>p </span><span>= </span><span>0</span><span>; </span><span>p </span><span>&lt; </span><span>300</span><span>; </span><span>p</span><span>++</span><span>) {
</span><span>    </span><span>let </span><span>[</span><span>x</span><span>,</span><span>y</span><span>] </span><span>= </span><span>uniformPepperoniPosition</span><span>();
</span><span>    </span><span>drawPepperoni</span><span>(</span><span>x</span><span>, </span><span>y</span><span>);
</span><span>  }
</span><span>}
</span></code></pre>
<p>But it&#39;s not what my local pizza shop&#39;s pizza&#39;s look like.
That&#39;s because they&#39;re not using the same probability distribution.
This pizza is using a <em>uniform distribution</em>.
That means that for any given pepperoni, every single position on the pizza is equally likely for it to land on.</p>

<p>We are using a uniform distribution here, but there are plenty of other distributions we could use as well.
One of the other most familiar distributions is <em>normal distribution</em>.
This is the distribution that has the normal &#34;bell curve&#34; that we are used to seeing.
And this is probably what people are talking about most of the time when they talk about how many standard deviations something is away from something else.</p>
<p>So what would it look like if we did a normal distribution on a pizza?</p>
<p>The very first thing we need to answer that is a way of getting the values <em>from</em> the normal distribution.
This isn&#39;t included with JavaScript by default, but we can implement it pretty simply using the <a href="https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform">Box-Muller transform</a>.
This might be a scary name, but it&#39;s really easy to use.
Is a way of generating numbers in the normal distribution using number sampled from the uniform distribution.
We can implement it like this:</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>randNormal</span><span>() {
</span><span>  </span><span>let </span><span>theta </span><span>= </span><span>2</span><span>*</span><span>Math</span><span>.</span><span>PI</span><span>*</span><span>Math</span><span>.</span><span>random</span><span>();
</span><span>  </span><span>let </span><span>r </span><span>= </span><span>Math</span><span>.</span><span>sqrt</span><span>(</span><span>-</span><span>2</span><span>*</span><span>Math</span><span>.</span><span>log</span><span>(</span><span>Math</span><span>.</span><span>random</span><span>()));
</span><span>
</span><span>  </span><span>let </span><span>x </span><span>= </span><span>r </span><span>* </span><span>Math</span><span>.</span><span>cos</span><span>(</span><span>theta</span><span>);
</span><span>  </span><span>let </span><span>y </span><span>= </span><span>r </span><span>* </span><span>Math</span><span>.</span><span>sin</span><span>(</span><span>theta</span><span>);
</span><span>
</span><span>  </span><span>return </span><span>[</span><span>x</span><span>,</span><span>y</span><span>];
</span><span>}
</span></code></pre>
<p>Then we can make a pretty simple function again which gives us coordinates for where to place pepperoni in this distribution.
The only little weird thing here is that I scale the radius down by a factor of 3.
Without this, the pizza ends up a little bit indistinguishable from the uniform distribution, but the scaling is arbitrary and you can do whatever you want.</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>normalPepperoniPosition</span><span>() {
</span><span>  </span><span>var </span><span>[</span><span>centerX</span><span>, </span><span>centerY</span><span>, </span><span>radius</span><span>] </span><span>= </span><span>pepperoniBounds</span><span>();
</span><span>
</span><span>  </span><span>let </span><span>x </span><span>= </span><span>radius</span><span>*</span><span>2</span><span>;
</span><span>  </span><span>let </span><span>y </span><span>= </span><span>radius</span><span>*</span><span>2</span><span>;
</span><span>
</span><span>  </span><span>while </span><span>(</span><span>x</span><span>**</span><span>2 </span><span>+ </span><span>y</span><span>**</span><span>2 </span><span>&gt;= </span><span>radius</span><span>**</span><span>2</span><span>) {
</span><span>    [</span><span>x</span><span>,</span><span>y</span><span>] </span><span>= </span><span>randNormal</span><span>();
</span><span>    </span><span>x </span><span>= </span><span>x </span><span>* </span><span>radius</span><span>/</span><span>3</span><span>;
</span><span>    </span><span>y </span><span>= </span><span>y </span><span>* </span><span>radius</span><span>/</span><span>3</span><span>;
</span><span>  }
</span><span>
</span><span>  </span><span>return </span><span>[</span><span>x </span><span>+ </span><span>centerX</span><span>, </span><span>y </span><span>+ </span><span>centerX</span><span>];
</span><span>}
</span></code></pre>
<p>And then once again we cap it off with a 300 piece pepperoni pizza.</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>drawNormalPizza</span><span>() {
</span><span>  </span><span>drawBackground</span><span>();
</span><span>  </span><span>drawPizzaCrust</span><span>();
</span><span>  </span><span>drawCheese</span><span>();
</span><span>
</span><span>  </span><span>for </span><span>(</span><span>let </span><span>p </span><span>= </span><span>0</span><span>; </span><span>p </span><span>&lt; </span><span>300</span><span>; </span><span>p</span><span>++</span><span>) {
</span><span>    </span><span>let </span><span>[</span><span>x</span><span>,</span><span>y</span><span>] </span><span>= </span><span>normalPepperoniPosition</span><span>();
</span><span>    </span><span>drawPepperoni</span><span>(</span><span>x</span><span>, </span><span>y</span><span>);
</span><span>  }
</span><span>}
</span></code></pre>


<p>Ouch.
It&#39;s not my platonic ideal of a pizza, that&#39;s for sure.
It also looks closer to the pizzas my local shop serves, but it&#39;s missing something...</p>
<p>See, this one is centered around, you know, the <em>center</em>.
Theirs are not that.
They&#39;re more chaotic with a few handfuls of toppings.
What if we did the normal distributions, but multiple times, with different centers?</p>
<p>First we have to update our position picking function to accept a center for the cluster.
We&#39;ll do this by passing in the center and generating coordinates around those, while still checking that we&#39;re within the bounds of the circle formed by the crust of the pizza.</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>normal</span><span>(</span><span>cx</span><span>, </span><span>cy</span><span>) {
</span><span>  </span><span>var </span><span>[</span><span>centerX</span><span>, </span><span>centerY</span><span>, </span><span>radius</span><span>] </span><span>= </span><span>pepperoniBounds</span><span>();
</span><span>
</span><span>  </span><span>let </span><span>x </span><span>= </span><span>radius</span><span>*</span><span>2</span><span>;
</span><span>  </span><span>let </span><span>y </span><span>= </span><span>radius</span><span>*</span><span>2</span><span>;
</span><span>
</span><span>  </span><span>while </span><span>((</span><span>x</span><span>-</span><span>centerX</span><span>)</span><span>**</span><span>2 </span><span>+ </span><span>(</span><span>y</span><span>-</span><span>centerY</span><span>)</span><span>**</span><span>2 </span><span>&gt;= </span><span>radius</span><span>**</span><span>2</span><span>) {
</span><span>    [</span><span>x</span><span>,</span><span>y</span><span>] </span><span>= </span><span>randNormal</span><span>();
</span><span>    </span><span>x </span><span>= </span><span>cx </span><span>+ </span><span>x </span><span>* </span><span>radius</span><span>/</span><span>3</span><span>;
</span><span>    </span><span>y </span><span>= </span><span>cy </span><span>+ </span><span>y </span><span>* </span><span>radius</span><span>/</span><span>3</span><span>;
</span><span>  }
</span><span>
</span><span>  </span><span>return </span><span>[</span><span>x</span><span>, </span><span>y</span><span>];
</span><span>}
</span></code></pre>
<p>And then instead of one single loop for all 300 pieces, we can do 3 loops of 100 pieces each, with different (randomly chosen) centers for each.</p>
<pre data-lang="javascript"><code data-lang="javascript"><span>function </span><span>drawClusterPizza</span><span>() {
</span><span>  </span><span>const </span><span>settings </span><span>= </span><span>initializeCanvas</span><span>(</span><span>&#34;drawing-3&#34;</span><span>);
</span><span>
</span><span>  </span><span>drawBackground</span><span>(</span><span>settings</span><span>);
</span><span>  </span><span>drawPizzaCrust</span><span>(</span><span>settings</span><span>);
</span><span>  </span><span>drawCheese</span><span>(</span><span>settings</span><span>);
</span><span>
</span><span>  </span><span>var </span><span>[</span><span>centerX</span><span>, </span><span>centerY</span><span>, </span><span>radius</span><span>] </span><span>= </span><span>pepperoniBounds</span><span>(</span><span>settings</span><span>);
</span><span>
</span><span>  </span><span>for </span><span>(</span><span>let </span><span>c </span><span>= </span><span>0</span><span>; </span><span>c </span><span>&lt; </span><span>3</span><span>; </span><span>c</span><span>++</span><span>) {
</span><span>    </span><span>let </span><span>[</span><span>cx</span><span>, </span><span>cy</span><span>] </span><span>= </span><span>uniform</span><span>(</span><span>settings</span><span>, </span><span>centerX</span><span>, </span><span>centerY</span><span>, </span><span>1</span><span>);
</span><span>    </span><span>console</span><span>.</span><span>log</span><span>(</span><span>cx</span><span>, </span><span>cy</span><span>);
</span><span>
</span><span>    </span><span>for </span><span>(</span><span>let </span><span>p </span><span>= </span><span>0</span><span>; </span><span>p </span><span>&lt; </span><span>100</span><span>; </span><span>p</span><span>++</span><span>) {
</span><span>      </span><span>let </span><span>[</span><span>x</span><span>, </span><span>y</span><span>] </span><span>= </span><span>normal</span><span>(</span><span>settings</span><span>, </span><span>cx</span><span>, </span><span>cy</span><span>, </span><span>4</span><span>);
</span><span>      </span><span>drawPepperoni</span><span>(</span><span>settings</span><span>, </span><span>x</span><span>, </span><span>y</span><span>);
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre>


<p>That looks more like it.
Well, probably.
This one is more chaotic, and sometimes things work out okay, but other times they&#39;re weird.
Just like the real pizzas.
Click that &#34;regenerate&#34; button a few times to see a few examples!</p>

<p>So, this is all great. But, when would we want this?</p>
<p>I mean, first of all, boring.
We don&#39;t need a reason except that it&#39;s fun!
But, there&#39;s one valid use case that a medical professional and I came up with: <em>hot honey</em>.</p>
<p>The ideal pepperoni pizza just might be one that has uniformly distributed pepperoni with <em>normally</em> distributed hot honey or hot sauce.
You&#39;d start with more intense heat, then it would taper off as you go toward the crust, so you maintain the heat without getting overwhelmed by it.</p>
<p>The room to play here is endless!
We can come up with a lot of other fun distributions and map them in similar ways.
Unfortunately, we probably <em>can&#39;t</em> make a Poisson pizza, since that&#39;s a distribution for discrete variables.</p>

<hr/>
</div><p>
  If you&#39;re looking to grow more effective as a software engineer, please consider my <a href="https://d2lang.com/coaching/">coaching services</a>.
  </p></div>
  </body>
</html>
