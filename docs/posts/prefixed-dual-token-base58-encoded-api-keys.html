<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/seamapi/prefixed-api-key">Original</a>
    <h1>Show HN: Prefixed, dual-token, base58 encoded API Keys</h1>
    
    <div id="readability-page-1" class="page"><p dir="auto">Let&#39;s break down each component of the API key...</p><div data-snippet-clipboard-copy-content="import { generateAPIKey } from &#34;prefixed-api-key&#34;

const key = await generateAPIKey()

// Store the key.longTokenHash and key.shortToken in your database and give
// api.token to your customer.

console.log(key)
/*
{
  shortToken: &#39;BRTRKFsL&#39;,
  longToken: &#39;51FwqftsmMDHHbJAMEXXHCgG&#39;,
  longTokenHash: &#39;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#39;,
  token: &#39;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#39;
}
*/"><pre><span>import</span> <span>{</span> <span>generateAPIKey</span> <span>}</span> <span>from</span> <span>&#34;prefixed-api-key&#34;</span>

<span>const</span> <span>key</span> <span>=</span> <span>await</span> <span>generateAPIKey</span><span>(</span><span>)</span>

<span>// Store the key.longTokenHash and key.shortToken in your database and give</span>
<span>// api.token to your customer.</span>

<span>console</span><span>.</span><span>log</span><span>(</span><span>key</span><span>)</span>
<span>/*</span>
<span>{</span>
<span>  shortToken: &#39;BRTRKFsL&#39;,</span>
<span>  longToken: &#39;51FwqftsmMDHHbJAMEXXHCgG&#39;,</span>
<span>  longTokenHash: &#39;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#39;,</span>
<span>  token: &#39;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#39;</span>
<span>}</span>
<span>*/</span></pre></div><div data-snippet-clipboard-copy-content="import {
  hashLongToken,
  extractLongToken,
  extractShortToken,
  checkAPIKey,
  getTokenComponents,
} from &#34;prefixed-api-key&#34;

hashLongToken(&#34;51FwqftsmMDHHbJAMEXXHCgG&#34;)
// &#34;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#34;

extractLongToken(&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;)
// &#34;51FwqftsmMDHHbJAMEXXHCgG&#34;
})

extractShortToken(&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;)
// &#34;BRTRKFsL&#34;

getTokenComponents(&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;)
/*
{
  shortToken: &#39;BRTRKFsL&#39;,
  longToken: &#39;51FwqftsmMDHHbJAMEXXHCgG&#39;,
  longTokenHash: &#39;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#39;,
  token: &#39;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#39;
}
*/

await checkAPIKey(
  &#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;,
  &#34;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#34;
)
// true"><pre><span>import</span> <span>{</span>
  <span>hashLongToken</span><span>,</span>
  <span>extractLongToken</span><span>,</span>
  <span>extractShortToken</span><span>,</span>
  <span>checkAPIKey</span><span>,</span>
  <span>getTokenComponents</span><span>,</span>
<span>}</span> <span>from</span> <span>&#34;prefixed-api-key&#34;</span>

<span>hashLongToken</span><span>(</span><span>&#34;51FwqftsmMDHHbJAMEXXHCgG&#34;</span><span>)</span>
<span>// &#34;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#34;</span>

<span>extractLongToken</span><span>(</span><span>&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;</span><span>)</span>
<span>// &#34;51FwqftsmMDHHbJAMEXXHCgG&#34;</span>
<span>}</span><span>)</span>

<span>extractShortToken</span><span>(</span><span>&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;</span><span>)</span>
<span>// &#34;BRTRKFsL&#34;</span>

<span>getTokenComponents</span><span>(</span><span>&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;</span><span>)</span>
<span>/*</span>
<span>{</span>
<span>  shortToken: &#39;BRTRKFsL&#39;,</span>
<span>  longToken: &#39;51FwqftsmMDHHbJAMEXXHCgG&#39;,</span>
<span>  longTokenHash: &#39;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#39;,</span>
<span>  token: &#39;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#39;</span>
<span>}</span>
<span>*/</span>

<span>await</span> <span>checkAPIKey</span><span>(</span>
  <span>&#34;mycompany_BRTRKFsL_51FwqftsmMDHHbJAMEXXHCgG&#34;</span><span>,</span>
  <span>&#34;d70d981d87b449c107327c2a2afbf00d4b58070d6ba571aac35d7ea3e7c79f37&#34;</span>
<span>)</span>
<span>// true</span></pre></div></div>
  </body>
</html>
