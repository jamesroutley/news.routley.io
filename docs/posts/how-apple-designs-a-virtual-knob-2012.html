<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://jherrm.github.io/knobs/">Original</a>
    <h1>How Apple designs a virtual knob (2012)</h1>
    
    <div id="readability-page-1" class="page"><div id="wrapper">




<p>üí° Author&#39;s note: This unpublished post was originally written in May 2012, and refreshed for publication in November 2022.</p>

<p><b>Just want to see the code? Check out <a href="https://github.com/jherrm/knobs">github.com/jherrm/knobs</a></b></p>

<p>When Apple introduced Garageband for the iPad back in March 2011, I just had to try it out. It wasn‚Äôt just the ability to create music that drew me in, it was the realization that this was a flagship app that uses the strengths of a multitouch interface to create experiences that weren‚Äôt possible with a keyboard and mouse. My favorite example is how you can hit a note on the sound sampler keyboard then drag your fingers left and right to bend the pitch.</p>

<p>Some time after a new type of interface is introduced, a handful of concepts tend to ‚Äúwin‚Äù and become a standard way of interacting with the interface. Keyboard shortcuts and right click contextual menus aren‚Äôt tied to a specific OS, they‚Äôre part of the standard toolset you get by using a keyboard and mouse. The iPhone popularized pinch-to-zoom, swipe, long tap, and many other useful multitouch interactions. With Garageband, Apple explored uncharted waters in user interaction and I‚Äôm going to talk about one simple control that has a few surprises in both use and implementation: <b>the virtual knob.</b></p>

<h2>Apple‚Äôs Three Ways to Turn a Virtual Knob</h2>

<p>After using the knobs in Garageband for a while, I noticed that they didn‚Äôt always react the way I thought they would. Most of the time the little indicator dot on the knob would follow my finger as I spun the knob around in a circle. Other times the knob wouldn‚Äôt follow my finger at all and seemed to go in random directions. I eventually figured out that I had stumbled on three different ways to turn a virtual knob. I was so impressed by this added functionality that I had to try and reproduce it myself, which led to me writing <a href="http://jherrm.github.io/knobs">Knob.js</a>, a javascript implementation of multitouch knobs that attempt to replicate the knobs found in Garageband. Knob.js powers all of the examples used in this post.</p>

<figure>
<img id="gestures" src="https://jherrm.github.io/knobs/asset/gestures_diagram.svg" alt="" title="Apple&#39;s Three Ways to Turn a Virtual Knob"/></figure>



<h3 id="spin">Spin</h3>

<p>The natural interaction with a knob is to spin, so being able to touch the knob and drag it in a circle is key to a successful virtual knob. You can start the spin at any point on the knob, and if your finger is hiding the indicator you can drag away from the knob as you spin, so you can see what‚Äôs going on. Dragging further away from the center of the knob also lets you be more precise in setting the value.</p>



<h3 id="verticalslide">Vertical Slide</h3>

<p>Just as pinch-to-zoom actually wraps zoom, pan and rotate in one gesture<a href="#fn:1" id="fnref:1" title="see footnote">[1]</a>, Apple‚Äôs knobs also do double duty as sliders. By sliding your finger in a vertical line, the knob will lock into vertical slider mode. This makes it super easy to make the knob spin several full revolutions without giving your finger a workout. Just like a real life physical knob, the direction the knob spins is dependent on which side of the knob you turn. If you start sliding down on the right side of the knob, it will spin clockwise, and if you start sliding down on the left side of the knob it turns counter-clockwise. (spin disabled)</p>

<div>
  <div>
  <div><p>
        Try sliding up or down on this knob.</p></div>
</div>
  
</div>


<p>Another bonus of using the vertical slide gesture with multitouch is you can easily change multiple knobs with one gesture on one hand. Using one finger per knob, drag straight up or down as if they were sliders on a audio mixing board.</p>

<h3 id="horizontalslide">Horizontal Slide</h3>

<p>Like the vertical slide, if you start sliding in a horizontal line the knob will lock into horizontal slider mode. Start sliding at the top and moving right causes the knob to spin clockwise, and starting at the bottom and going right will spin the knob counter-clockwise. (spin and vertical slide disabled)</p>

<div>
  <div>
  <div><p>
          Try sliding left or right on this knob.</p></div>
    </div>
  
</div>


<h3 id="alltogethernow">All Together Now</h3>

<p>The demos above restrict the functionality to show each type of interaction one at a time. Try all three interactions together, as well as mouse/trackpad scrolling support on this button:</p>

<div>
  <div>
  <div><p>
        Try spinning, sliding up/down or left/right on this knob</p></div>
</div>
  
</div>

<h2 id="howweretheybuilt">How Were They Built?</h2>

<p>When I set out to replicate the knobs in Garageband, the first thing I did was open up the Garageband.ipa file and extract the assets. What I found was that in order to recreate the classic knobs from various instruments and amps, the developers used several techniques to bring the knobs to life in an efficient and realistic way.</p>

<h3 id="knobswithstaticbackgrounds">Knobs with static backgrounds</h3>

<p>Below we have a knob made with two images: a non-moving knob ‚Äúbackground‚Äù and an indicator. The indicator is simply repositioned to create the turning effect. In Garageband, the <em>generic</em> and <em>clavinet</em> knobs all use this technique.</p>

<div>
  <div>
  <div><p>
        Sprite based knob and indicator</p></div>
    </div>
    
    
    
</div>

<p>Here‚Äôs another knob with a non-moving background, but instead of positioning the indicator to simulate turning, it rotates the indicator instead. Another neat thing about this knob is it, along with the knobs shown at the beginning of this post, are created with CSS rather than images. You can also render a knob with SVG and canvas. The <em>pad</em> and <em>panner</em> knobs in Garageband uses the rotating indicator method, though <em>panner</em> looks like a simple repositioned indicator knob.</p>



<p>A third variation of a knob with a non-moving background is found by combining the other two indicator transformations. An indicator that‚Äôs both positioned and rotated offers a nice way to emulate real knobs. The <em>rhodes</em> electric piano knobs in Garageband show off this style.</p>



<h3 id="knobswithrepeatingbackgrounds">Knobs with repeating backgrounds</h3>

<p>Apple uses repeating backgrounds for knobs that change more than just their indicator as they‚Äôre spun around. To make one of these knobs just create the knob image without the indicator, rotate the image a few degrees and save a new image until the pattern is repeated. Combine all of the generated images side by side into one wide grid. Thanks to <s>Google</s> <a href="http://sketchup.google.com/3dwarehouse/">Trimble 3D Warehouse</a>, I was able to find some 3D knobs and recreate the process using blender and photoshop:</p>

<p>Here‚Äôs one that I made that has a 13 image repeated progression:</p>

<figure>
<img src="https://jherrm.github.io/knobs/knobs/toaster_knob.png" alt=""/></figure>



<p>Of course you can also combine a repeating background with the indicator styles. The <em>hammond</em> knobs on the organs in Garageband are an example of a repeating background and a positioned indicator. The knobs on the generic synthesizers show off a repeated background and an indicator that‚Äôs rotated and positioned.</p>

<div>
  <div>
<figure><img src="https://jherrm.github.io/knobs/knobs/gb/hammond.png" alt=""/>
  <p>
  Garageband Hammond knob source file with a 5 image repeating sequence.<br/>
  </p>
</figure>
</div>

<div>
  <figure><img src="https://jherrm.github.io/knobs/knobs/gb/synth.png" alt=""/>
  <p>
  Garageband Synth knob source file with a 17 image repeating sequence.<br/>
  </p>
</figure>
</div>


  
</div>

<h3 id="fullyrendered3dknobs">Fully Rendered 3D Knobs</h3>

<p>Some knobs just can‚Äôt be reproduced with static images or repeating backgrounds. Instead of embedding an OpenGL 3D model of the knob, Apple chose to use a similar solution to the repeating background knobs. They basically created a 3D model of then knob then took a picture of it as they spun it around 3 degrees at a time. Since a circle has 360 degrees that means they‚Äôre creating 120 different snapshots of the knob! They line them up in order and save it off as a single image that looks like this:</p>

<figure>
<img src="https://jherrm.github.io/knobs/asset/rendered_tiny.png" alt="" title="Birdseye view of all 120 knob sprites"/></figure>

<figure>
<img src="https://jherrm.github.io/knobs/asset/rendered_medium.png" alt="" title="Zoomed in view of knob sprites"/></figure>

<figure>
<img src="https://jherrm.github.io/knobs/asset/rendered_full.png" alt="" title="Actual size view of knob sprites"/></figure>



<p>Out of the 25 knobs in Garageband that are able to be turned in all directions, 18 were created using this method.</p>
<p>Thanks to WebGL we could even do one better and use an actual 3D knob! Unfortunately that will have to wait for another day!</p>

<!-- <figure>
  <img src="knobs/oven_knob.png" alt="" />
</figure>
<figure>
  <img src="knobs/guitar.png" alt="" />
</figure> -->
      




<hr/>

<h2 id="garagebandsecrets">Garageband Secrets</h2>

<p>While going through the assets extracted from the Garageband, I ended up finding some knobs that didn‚Äôt make the cut for inclusion in the final release.
 I‚Äôm happy to breathe some life into these knobs for the first time outside of Apple labs.</p>

<h3 id="testknob">Test Knob</h3>

<p>Before Apple settled on one image for every 3 degrees for 3D knobs, they tested out one image for every 5 degrees - 72 sprites in all. I can only assume they thought the jump from frame to frame was too jarring and was worth the increase in file size.</p>



<h3 id="knobrejects">Knob Rejects</h3>

<p>There were also three knobs that were fully finished but not included. Two were simple color/material changes to existing knobs, but the round arrow knob is new. I especially enjoy the specular highlights that appear on the rounded part of the arrow as you spin it.</p>



<h2 id="conclusion">Conclusion</h2>

<p>Apple‚Äôs attention to detail is what has propelled it to be the most valuable company on earth. Whether it‚Äôs the click of a physical button or the math behind inertial scrolling, Apple employees work really hard to make products that are deceptively simple and just feel right. The virtual knobs found in Garageband are no exception and I hope others enjoyed learning about them as much as I have.</p>



    </div></div>
  </body>
</html>
