<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://loro-dev.notion.site/crdt-richtext-Rust-implementation-of-Peritext-and-Fugue-c49ef2a411c0404196170ac8daf066c0">Original</a>
    <h1>CRDT-richtext: Rust implementation of Peritext and Fugue</h1>
    
    <div id="readability-page-1" class="page">
		<p><a href="https://github.com/loro-dev/crdt-richtext"></a><a href="https://github.com/loro-dev/crdt-richtext">https://github.com/loro-dev/crdt-richtext</a></p>
<p>Presenting a new Rust crate that combines <a href="https://inkandswitch.com/peritext">Peritext</a> and <a href="https://arxiv.org/abs/2305.00583">Fugue</a>&#39;s power with impressive performance, tailored specifically for rich text. This crate&#39;s functionality is set to be incorporated into <strong><a href="https://www.loro.dev/">Loro</a></strong>, a general-purpose CRDT library currently under development.</p>

<p><a href="https://inkandswitch.com/peritext">Peritext: A CRDT for Rich-Text Collaboration</a></p>
<p>Peritext is a novel rich-text CRDT (Conflict-free Replicated Data Type) algorithm. It is capable of merging concurrent edits in rich text format while <a href="https://www.inkandswitch.com/peritext/#preserving-the-authors-intent">preserving users&#39; intent as much as possible</a>. Its primary focus is on merging the formats and annotations of rich text content, such as bold, italic, and comments.</p>
<p>&lt;aside&gt;
ðŸ’¡ The specific definition of user intent in the context of concurrent rich text editing can&#39;t be clearly explained in a few words. it&#39;s best understood through specific examples.</p>
<p>&lt;/aside&gt;</p>
<p>Peritext is designed to solve a couple of significant challenges:</p>
<p>Firstly, it addresses the anticipated problems arising from conflicting style edits. For instance, consider a text example, &#34;The quick fox jumped.&#34; If User A highlights &#34;The quick&#34; in bold and User B highlights &#34;quick fox jumped,&#34; the ideal merge should result in the entire sentence, &#34;The quick fox jumped,&#34; being bold. However, existing algorithms might not meet this expectation, resulting in either &#34;The quick fox&#34; or &#34;The&#34; and &#34;jumped&#34; being bold instead.</p>
<p>| --- | --- |</p>
<p>| Bad case from Yjs | The quick fox jumped |</p>
<p>Additionally, Peritext manages conflicts between style and text edits. In the same example, if User A highlights &#34;The quick&#34; in bold, but User B changes the text to &#34;The fast fox jumped,&#34; the ideal merge should result in &#34;The fast&#34; being bold.</p>
<p>| --- | --- |</p>
<p>Whatâ€™s more, Peritext takes into account different expectations for expanding styles. For example, if you type after a bold text, you would typically want the new text to continue being bold. However, if you&#39;re typing after a hyperlink or a comment, you likely wouldn&#39;t want the new input to become part of the hyperlink or comment.</p>

<p>Fugue is a new CRDT text algorithm, presented in <em><a href="https://arxiv.org/abs/2305.00583">The Art of the Fugue: Minimizing Interleaving in Collaborative Text Editing</a></em> by <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Weidner%2C+M">Matthew Weidner</a> et al., nicely solves <strong>the interleaving problem</strong>.</p>
<h2>The interleaving problem</h2>
<p>The interleaving problem was proposed in the paper <em><a href="https://martin.kleppmann.com/2019/03/25/papoc-interleaving-anomalies.html">Interleaving anomalies in collaborative text editors</a></em> by Martin Kleppmann et al.</p>
<p>An example of interleaving:</p>
<ul>
<li>A type &#34;Hello &#34; from left to right/right to left</li>
<li>B type &#34;Hi &#34; from left to right/right to left</li>
<li>The expected result: &#34;Hello Hi &#34; or &#34;Hi Hello &#34;</li>
</ul>

	

</div>
  </body>
</html>
