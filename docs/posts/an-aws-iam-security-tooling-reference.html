<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ramimac.me/aws-iam-tools-2024">Original</a>
    <h1>An AWS IAM Security Tooling Reference</h1>
    
    <div id="readability-page-1" class="page"><div><div>
  
  <div>       
    
    <p>üï∞Ô∏è Four years ago, I published <a href="https://ramimac.me/aws-iam-tools">An AWS IAM Security Tooling Reference</a>. It‚Äôs time to revisit it and take a look at the current landscape.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup></p>

<p>Identity and Access Management (IAM) is a cornerstone of security. However, AWS IAM is not only crucially important, but also immensely complex.</p>

<p>This complexity and the resultant challenges it can pose for security have not gone unnoticed. In addition to efforts at education, AWS has developed <a href="https://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova/">Zelkova</a>, an automated reasoning tool for AWS permissions. <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html">AWS IAM Access Analyzer</a> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-concepts.html">uses Zelkova to</a> ‚Äúidentify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity.‚Äù <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_access-advisor.html">AWS IAM Access Advisor</a> offers ‚Äúlast used‚Äù information on permissions, to help cull unnecessary access.</p>

<p>Outside of Amazon, numerous individuals and organizations have also released tools to help you reason about the usage of IAM in your AWS environment.</p>

<h3 id="pmapper">PMapper</h3>
<p><em>developed at <a href="https://github.com/nccgroup/PMapper">nccgroup</a>, with <a href="https://github.com/Fennerr/PMapper">a more recently maintained fork available</a></em></p>

<p>Principal Mapper (PMapper) is a script from my former NCC Group coworker Erik Steringer that answers a couple of the most pressing questions about IAM Security:</p>

<ol>
  <li>‚ÄúWho can escalate privileges?‚Äù and</li>
  <li>‚ÄúWhich principals can access other principals?‚Äù</li>
</ol>

<p>Since the <code>1.0</code> launch, PMapper has added support for:</p>
<ol>
  <li>resource policies, permission boundaries, session policies, and service control policies</li>
  <li>New <code>serviceaccess</code> preset query: reporting which services can access which roles</li>
  <li>New <code>wrongadmin</code> preset query: finds admin users/roles that don‚Äôt have the AdministratorAccess (or a similar inline policy) set</li>
</ol>

<p>The fork additionally adds support for <code>externalaccess</code>, a preset query to determine external access for an account.</p>

<p>PMapper accomplishes this by generating and traversing a graph of a given AWS account‚Äôs IAM users and roles. It also comes equipped with both a REPL and support for generating Visualizations.</p>

<h3 id="cloudsplaining">Cloudsplaining</h3>
<p><em><a href="https://opensource.salesforce.com/cloudsplaining/">salesforce/cloudsplaining</a></em></p>

<p><a href="https://twitter.com/kmcquade3">Kinnaird McQuade</a> of Salesforce‚Äôs Cloudsplaining is the most recent release to have made this list. Cloudsplaining identifies violations of least privilege with perhaps the most robust reporting of any tool on this list. While the primary focus is on identifying failures to take advantage of resource constraints, it has findings for:</p>

<ol>
  <li>Privilege Escalation,</li>
  <li>Resource Exposure,</li>
  <li>Infrastructure Modification, and</li>
  <li>Data Exfiltration</li>
</ol>

<h3 id="apeman">Apeman</h3>
<p><em><a href="https://github.com/hotnops/apeman">hotnops/apeman</a></em></p>

<p><a href="https://x.com/hotnops">Daniel Heinsen</a> recently launched this new tool, offering a graph-based tool to model AWS IAM permissions. Check out <a href="https://gist.github.com/hotnops/a1d4ab5fc49d4d4190600827da9078f2">the example query</a> Daniel put together to show how you can use the underlying neo4j database to identify cognito vulnerable roles, as per research by<a href="https://x.com/Frichette_n"> Nick Frichette</a>.</p>

<h3 id="parliament">Parliament</h3>
<p><em><a href="https://github.com/duo-labs/parliament">duo-labs/parliament</a></em></p>

<p>Parliament, from <a href="https://twitter.com/0xdabbad00">Scott Piper</a> (of Summit Route) and Duo Labs, is the OG AWS IAM linting library. It can identify hard to notice issues like the attempt to use a condition that is not documented as supported for the associated action, or the use of completely unknown actions. It also has rules for logical inconsistencies that might allow for privilege escalation, with the provided example ‚Äúan S3 bucket where s3:Delete is not allowed, but s3:PutBucketPolicy is, which could be abused to grant anonymous object deletion.‚Äù</p>

<h3 id="aws-lint-iam-policies">aws-lint-iam-policies</h3>
<p><em><a href="https://github.com/welldone-cloud/aws-lint-iam-policies">welldone-cloud/aws-lint-iam-policies</a></em></p>

<p>This tool from <a href="https://www.linkedin.com/in/michael-kirchner-at/">Michael Kirchner</a> is a more recent AWS IAM linter. It primarily relies on the AWS IAM Access Analyzer policy validation feature, exposing it for use in CI/CD or in the CLI. It also contains a few custom checks, including coverage of trusts to other AWS accounts and wildcard principals.</p>

<h3 id="iamspy">IAMSpy</h3>
<p><em><a href="https://github.com/WithSecureLabs/IAMSpy">WithSecureLabs/IAMSpy</a></em></p>

<p>WithSecure‚Äôs Mohit Gupta has created an opensource variant on Zelkova, using the Z3 prover (an SMT solver) formally prove whether an action by a given IAM entity is possible against a particular resource.</p>

<h3 id="generic-tools-with-iam-findings">Generic Tools with IAM Findings</h3>

<p>There are generally a subset of findings in any cloud security tool that reference IAM.</p>

<ul>
  <li><strong>Pacu</strong> - <a href="https://github.com/RhinoSecurityLabs/pacu">RhinoSecurityLabs/pacu</a>‚Äôs <code>iam__privesc_scan</code> module</li>
  <li><strong>Prowler</strong> - <a href="https://github.com/prowler-cloud/prowler">prowler-cloud/prowler</a>‚Äôs <a href="https://docs.prowler.com/checks/aws/iam-policies/">IAM checks</a></li>
  <li><strong>Steampipe</strong> - <a href="https://hub.powerpipe.io/mods/turbot/aws_compliance/controls/benchmark.all_controls_iam?context=benchmark.all_controls">AWS Compliance benchmark for IAM</a>, and <a href="https://ramimac.me/access-advisor-steampipe">compatibility with Access Advisor</a></li>
</ul>

<h3 id="unmaintained-deprecated-or-not-practically-recommended">Unmaintained, Deprecated, or not practically recommended</h3>

<ul>
  <li><strong>Cloudtracker</strong> - <a href="https://github.com/duo-labs/cloudtracker">duo-labs/cloudtracker</a>: an old tool that found unused permissions</li>
  <li><strong>SkyArk</strong> - <a href="https://github.com/cyberark/SkyArk">cyberark/SkyArk</a>: an unmaintained tool which identifies so-called ‚Äúshadow admins‚Äù within an AWS account</li>
  <li><strong>AWSPX</strong> - <a href="https://github.com/WithSecureLabs/awspx">WithSecureLabs/awspx</a>: an unmaintained graph-based tool for visualizing effective access and resource relationships within AWS</li>
  <li><strong>Aaia</strong> - <a href="https://github.com/rams3sh/Aaia">rams3sh/Aaia</a>: an old tool for visualizing AWS IAM and Organizations in a graph format with help of Neo4j</li>
</ul>



  </div>
</div>
</div></div>
  </body>
</html>
