<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://tuxphones.com/booting-arm-linux-the-standard-way/">Original</a>
    <h1>Booting ARM Linux the standard way</h1>
    
    <div id="readability-page-1" class="page"><div>

            <section>
                <a href="https://tuxphones.com/tag/linux-smartphone/">Linux Smartphone</a>
            </section>

            

            <p>A deeper look in the new Tow-Boot firmware project for ARM devices.</p>



            <div>
                <section>
                    <ul>
                        <li>
                            <a href="https://tuxphones.com/author/martijnbraam/">
                                <img src="https://www.gravatar.com/avatar/589714de59c2ac21dfce521799562cc0?s=250&amp;d=mm&amp;r=x" alt="Martijn Braam"/>
                            </a>
                        </li>
                    </ul>
                    <div>
                        
                        <p><time datetime="2022-03-09">Mar 9, 2022</time>
                            <span><span>â€¢</span> 4 min read</span>
                        </p>
                    </div>
                </section>
            </div>

            <figure>
                <img srcset="/content/images/size/w300/2022/02/tow-boot-main-menu-pinephone-pine64.JPG 300w,
                            /content/images/size/w600/2022/02/tow-boot-main-menu-pinephone-pine64.JPG 600w,
                            /content/images/size/w1000/2022/02/tow-boot-main-menu-pinephone-pine64.JPG 1000w,
                            /content/images/size/w2000/2022/02/tow-boot-main-menu-pinephone-pine64.JPG 2000w" sizes="(min-width: 1400px) 1400px, 92vw" src="https://tuxphones.com/content/images/size/w2000/2022/02/tow-boot-main-menu-pinephone-pine64.JPG" alt="Picture of the PINE64 PinePhone with the Tow-Boot installer running"/>
                    <figcaption>The main menu of the Tow-Boot installer</figcaption>
            </figure>
        </div><section>
            <p>Tow-Boot is a relatively new project for bringing some consistency to the way we boot Linux on ARM. This is both aimed at the Linux single board computers but also the new wave of Linux phones.</p><p>On these devices the most common platform firmware is U-Boot. In some cases the U-Boot provided with the device is a nice and clean mainline U-Boot, in other cases it&#39;s the U-Boot build provided by the manufacturer of the SoC. </p><p>One big difference between x86 computers and the ARM ecosystem is functionality that you&#39;d expect from the bios/uefi in the hardware is actually in most cases part of the operating system that&#39;s installed. This means there&#39;s no consistency at all.</p><p>Getting to a boot menu on a normal computer is already a mess where you have to guess if you have to press Escape F10, F11, F12 or Delete. On ARM this is worse because this might depend on the operating system you have flashed at that moment.</p><p>On a lot of these devices there&#39;s also no nice way to have boot feedback yet except for an RGB status led. If we look at the PinePhone here for example the meaning of the led colors also depends on the operating system. </p><p>If the PinePhone has Manjaro on it pressing the power button will turn on the red LED. Then it will turn yellow if an image with initramfs is booting and purple when an image without initfs is booting. If the phone has postmarketOS instead the red LED will turn on when booting. Then yellow after the kernel and initfs have been sucessfully loaded and then white if the script is done and the kernel is started. If you&#39;re on Mobian instead then only the initial green led will be lit up. </p><p>It&#39;s inconsistencies like this that makes it hard to know what&#39;s happening on the phone when booting, and this is just the led colors. On upstream U-Boot on the PinePhone there&#39;s no boot selection options at all. The display on the PinePhone doesn&#39;t work in U-Boot yet. But at least there&#39;s the volume keys as input and the RGB led as output to make some boot interactions possible. But actually letting end-users use this would be a support nightmare since none of the Linux distributions for the PinePhone would implement this the same way.</p><h2 id="enter-tow-boot">Enter Tow-Boot</h2><p>A nice solution for this problem is not making every distribution figure out an U-Boot build for every device on their own. In an ideal world ARM hardware would act like the x86 hardware. The platform firmware just exists on the board and provides a consistent user interface while booting, no matter what, or <em>if, </em>an operating system is installed. </p><p>Tow-Boot is an U-Boot distribution, just like postmarketOS, Mobian, ArchLinux ARM and Manjaro are Linux distributions. The Tow-Boot project takes upstream U-Boot and makes builds for the supported hardware that provide consistency between the various devices. This means that if you pick up a PinePhone, a PinePhone Pro or a Librem 5, the meaning of the RGB led would be the same.</p><p>Then if distributions use this U-Boot build and if hardware manufacturers have these builds pre-installed if possible. Then there would also be consistency regardless of what Linux distribution is installed at that moment. </p><figure><img src="https://tuxphones.com/content/images/2022/02/tow-boot-menu-pinebook-pro.JPG" alt="" loading="lazy" width="2000" height="750" srcset="https://tuxphones.com/content/images/size/w600/2022/02/tow-boot-menu-pinebook-pro.JPG 600w, https://tuxphones.com/content/images/size/w1000/2022/02/tow-boot-menu-pinebook-pro.JPG 1000w, https://tuxphones.com/content/images/size/w1600/2022/02/tow-boot-menu-pinebook-pro.JPG 1600w, https://tuxphones.com/content/images/size/w2400/2022/02/tow-boot-menu-pinebook-pro.JPG 2400w" sizes="(min-width: 720px) 720px"/><figcaption>Tow-Boot boot menu on the Pinebook Pro</figcaption></figure><h2 id="technical-difficulties">Technical difficulties</h2><p>Sadly things are not as simple as &#34;Just make things consistent&#34;. It&#39;s also far from easy to have the &#34;Just use Tow-Boot instead of brewing your own config&#34; for distributions.</p><p>One of the nice things about Tow-Boot is that it leverages the Nix build system to generate a nice reproducable build of the platform firmware. This should take away some of the doubts of having a prebuild platform firmware instead of every distribution figuring out how to do this from source. Also distributions <em>not</em> doing this from source would mean there&#39;s less chance of inconsistencies slipping in.</p><p>Another thing is that boot selection on phones is not something that comes naturally to U-Boot. Graphical boot menus is also not something that&#39;s very nice in the stock U-Boot configurations. This is why Tow-Boot adds the required patches to have nice graphical boot menus where possible on that hardware, and patches to have volume key input for example on phones.</p><p>Another nice feature is the built-in USB mass storage option in Tow-Boot. People using the PinePhone might be familiar with <a href="https://github.com/dreemurrs-embedded/Jumpdrive">Jumpdrive</a>, this is a tiny Linux image that boots to a splash screen and exposes the internal storage of the phone over USB. Instead of this working by booting an SD card with Jumpdrive to reflash a device it&#39;s now possible to trigger UMS mode in the platform firmware boot menu and have this working without starting Linux at all. This is especially nice on the PinePhone Pro that can&#39;t just boot from SD if a valid bootloader is on the eMMC and Tow-Boot isn&#39;t installed. </p><h2 id="a-better-ecosystem">A better ecosystem</h2><p>One project being able to focus purely on making the boot process as nice as possible means that someone is actually spending some time to make this nice instead of it being the thing you&#39;d have to hack together to make the device boot. This hardware.</p><p>In this case that person is <a href="https://github.com/samueldr">Samuel Dionne-Riel</a>. The project lead for Tow-Boot. Thanks to his work we&#39;re now in a place where we have a chance to have consistent booting and this is one of the reasons why mobile Linux is slowly moving towards being a mature ecosystem. It&#39;s pretty hard to use a Linux phone if you can&#39;t depend on it working. And it&#39;s pretty hard to make a Linux distribution that you can depend on if you can&#39;t depend on the platform firmware.</p>
        </section></div>
  </body>
</html>
