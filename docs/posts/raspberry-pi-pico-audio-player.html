<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://lucstechblog.blogspot.com/2025/02/raspberry-pi-pico-audio-player.html">Original</a>
    <h1>Raspberry Pi Pico audio player</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-5473818848082471537" itemprop="description articleBody">
<p><span><b><span><a href="http://lucstechblog.blogspot.com/p/index-of-my-stories.html">For an index to all my stories click this text.</a></span></b></span></p><p><span>The programming is done in MicroPython with Thonny as the IDE.<!--HTML generated using hilite.me--></span></p><div><pre><span>&#39;&#39;&#39;</span>
<span>Audioplayer Plays 8k WAV files</span>
<span>With Oled screen for choosing audiofiles</span>

<span>Audio files on SD card</span>
<span>Button GP18 next number</span>
<span>Button GP19 previous number</span>
<span>Button GP20 play the song</span>
<span>&#39;&#39;&#39;</span>

<span># Import garbage collect</span>
<span>import</span> <span>gc</span>

<span>import</span> <span>os</span> <span>as</span> <span>os</span>
<span>import</span> <span>time</span>
<span>import</span> <span>machine</span>
<span>from</span> <span>machine</span> <span>import</span> <span>SPI,</span> <span>Pin,</span> <span>Timer</span>
<span>import</span> <span>sdcard</span>
<span>from</span> <span>wavePlayer</span> <span>import</span> <span>wavePlayer</span>

<span>import</span> <span>ssd1306</span>

<span>sda</span><span>=</span><span>machine</span><span>.</span><span>Pin(</span><span>8</span><span>)</span>
<span>scl</span><span>=</span><span>machine</span><span>.</span><span>Pin(</span><span>9</span><span>)</span>

<span>i2c</span><span>=</span><span>machine</span><span>.</span><span>I2C(</span><span>0</span><span>,sda</span><span>=</span><span>sda,</span> <span>scl</span><span>=</span><span>scl,freq</span><span>=</span><span>400000</span><span>)</span>
<span>print</span><span>(i2c</span><span>.</span><span>scan())</span>

<span>oled</span> <span>=</span> <span>ssd1306</span><span>.</span><span>SSD1306_I2C(</span><span>128</span><span>,</span> <span>64</span><span>,</span> <span>i2c)</span>

<span>player</span> <span>=</span> <span>wavePlayer()</span>

<span>spi</span> <span>=</span> <span>SPI(</span><span>1</span><span>,sck</span><span>=</span><span>Pin(</span><span>14</span><span>),</span> <span>mosi</span><span>=</span><span>Pin(</span><span>15</span><span>),</span> <span>miso</span><span>=</span><span>Pin(</span><span>12</span><span>))</span>
<span>cs</span> <span>=</span> <span>Pin(</span><span>13</span><span>)</span>
<span>sd</span> <span>=</span> <span>sdcard</span><span>.</span><span>SDCard(spi,</span> <span>cs)</span>

<span>os</span><span>.</span><span>mount(sd,</span> <span>&#39;/storage&#39;</span><span>)</span>

<span>but01</span><span>=</span><span>machine</span><span>.</span><span>Pin(</span><span>18</span><span>,</span> <span>machine</span><span>.</span><span>Pin</span><span>.</span><span>IN)</span>
<span>but02</span><span>=</span><span>machine</span><span>.</span><span>Pin(</span><span>19</span><span>,</span> <span>machine</span><span>.</span><span>Pin</span><span>.</span><span>IN)</span>
<span>but03</span><span>=</span><span>machine</span><span>.</span><span>Pin(</span><span>20</span><span>,</span> <span>machine</span><span>.</span><span>Pin</span><span>.</span><span>IN)</span>

<span>playnow</span> <span>=</span> <span>-</span><span>1</span>

<span>array</span><span>=</span><span>(os</span><span>.</span><span>listdir(</span><span>&#39;/storage/Music&#39;</span><span>))</span>
<span>numbers</span> <span>=</span> <span>len(array)</span>
<span>print</span> <span>(numbers)</span>

<span>oled</span><span>.</span><span>fill(</span><span>0</span><span>)</span>
<span>oled</span><span>.</span><span>show()</span>
<span>oled</span><span>.</span><span>text(</span><span>&#34;Raspberry Audio&#34;</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)</span>
<span>oled</span><span>.</span><span>text(</span><span>&#34;player&#34;</span><span>,</span><span>40</span><span>,</span><span>10</span><span>)</span>
<span>for</span> <span>i</span> <span>in</span> <span>range(</span><span>0</span><span>,</span> <span>127</span><span>):</span>
    <span>oled</span><span>.</span><span>pixel(</span><span>0</span> <span>+</span> <span>i,</span> <span>20</span><span>,</span> <span>1</span><span>)</span>
<span>oled</span><span>.</span><span>show()</span>

<span>try</span><span>:</span> 
   <span>while</span> <span>True:</span>

      
      <span>if</span> <span>(but01</span><span>.</span><span>value()</span><span>==</span><span>0</span><span>):</span> 
          <span>print</span><span>(</span><span>&#34;button 1 pressed&#34;</span><span>)</span>
          <span>playnow</span> <span>=</span> <span>playnow</span> <span>+</span> <span>1</span>
          <span>if</span> <span>(playnow</span> <span>==</span> <span>numbers):</span>
              <span>playnow</span> <span>=</span> <span>0</span>
          <span>song</span> <span>=</span> <span>&#34;/storage/Music/&#34;</span><span>+</span><span>array[playnow]</span>
          <span>print</span><span>(type(song))</span>
          <span>help</span><span>=</span> <span>array[playnow]</span>
          <span>print</span><span>(</span><span>&#34;Now playing &#34;</span> <span>+</span> <span>help[</span><span>0</span><span>:</span><span>-</span><span>4</span><span>])</span>
          
          <span>oled</span><span>.</span><span>fill(</span><span>0</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;Raspberry Audio&#34;</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;player&#34;</span><span>,</span><span>40</span><span>,</span><span>10</span><span>)</span>
          <span>for</span> <span>i</span> <span>in</span> <span>range(</span><span>0</span><span>,</span> <span>127</span><span>):</span>
              <span>oled</span><span>.</span><span>pixel(</span><span>0</span> <span>+</span> <span>i,</span> <span>20</span><span>,</span> <span>1</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;This song is :&#34;</span><span>,</span><span>0</span><span>,</span><span>25</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;                   &#34;</span><span>,</span><span>0</span><span>,</span><span>35</span><span>)</span>
          <span>oled</span><span>.</span><span>text(help[</span><span>0</span><span>:</span><span>-</span><span>4</span><span>],</span><span>0</span><span>,</span><span>35</span><span>)</span>
          <span>oled</span><span>.</span><span>show()</span>
          <span>print</span><span>(playnow)</span>
          <span>time</span><span>.</span><span>sleep(</span><span>.</span><span>5</span><span>)</span>
          <span># test how much memory is free</span>
          <span>gc</span><span>.</span><span>collect()</span>
          <span>print</span><span>(gc</span><span>.</span><span>mem_free())</span>  
    
      <span>if</span> <span>(but02</span><span>.</span><span>value()</span><span>==</span><span>0</span><span>):</span>
          <span>#player.stop()</span>
          <span>print</span><span>(</span><span>&#34;button 2 pressed&#34;</span><span>)</span>
          
          <span>if</span> <span>(playnow</span> <span>==</span> <span>-</span><span>1</span> <span>or</span> <span>playnow</span> <span>==</span><span>0</span><span>):</span>
              <span>playnow</span> <span>=</span> <span>0</span>
          <span>else</span><span>:</span>
              <span>playnow</span> <span>=</span> <span>playnow</span> <span>-</span><span>1</span>
          <span>song</span> <span>=</span> <span>&#34;/storage/Music/&#34;</span><span>+</span><span>array[playnow]</span>
          <span>print</span><span>(type(song))</span>
          
          <span>help</span><span>=</span> <span>array[playnow]</span>
          <span>print</span><span>(</span><span>&#34;Now playing &#34;</span> <span>+</span> <span>help[</span><span>0</span><span>:</span><span>-</span><span>4</span><span>])</span>
          <span>oled</span><span>.</span><span>fill(</span><span>0</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;Raspberry Audio&#34;</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;player&#34;</span><span>,</span><span>40</span><span>,</span><span>10</span><span>)</span>
          <span>for</span> <span>i</span> <span>in</span> <span>range(</span><span>0</span><span>,</span> <span>127</span><span>):</span>
              <span>oled</span><span>.</span><span>pixel(</span><span>0</span> <span>+</span> <span>i,</span> <span>20</span><span>,</span> <span>1</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;This song is : &#34;</span><span>,</span><span>0</span><span>,</span><span>25</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;                   &#34;</span><span>,</span><span>0</span><span>,</span><span>35</span><span>)</span>
          <span>oled</span><span>.</span><span>text(help[</span><span>0</span><span>:</span><span>-</span><span>4</span><span>],</span><span>0</span><span>,</span><span>35</span><span>)</span>
          <span>oled</span><span>.</span><span>show()</span>
          <span>print</span><span>(playnow)</span>
          <span>time</span><span>.</span><span>sleep(</span><span>.</span><span>5</span><span>)</span>
          
      <span>if</span> <span>(but03</span><span>.</span><span>value()</span> <span>==</span><span>0</span><span>):</span>
          <span>help</span><span>=</span> <span>array[playnow]</span>
          <span>print</span><span>(</span><span>&#34;Now playing &#34;</span> <span>+</span> <span>help[</span><span>0</span><span>:</span><span>-</span><span>4</span><span>])</span>
          <span>oled</span><span>.</span><span>fill(</span><span>0</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;Raspberry Audio&#34;</span><span>,</span><span>0</span><span>,</span><span>0</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;player&#34;</span><span>,</span><span>40</span><span>,</span><span>10</span><span>)</span>
          <span>for</span> <span>i</span> <span>in</span> <span>range(</span><span>0</span><span>,</span> <span>127</span><span>):</span>
             <span>oled</span><span>.</span><span>pixel(</span><span>0</span> <span>+</span> <span>i,</span> <span>20</span><span>,</span> <span>1</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;Now playing:&#34;</span><span>,</span><span>0</span><span>,</span><span>25</span><span>)</span>
          <span>oled</span><span>.</span><span>text(</span><span>&#34;                   &#34;</span><span>,</span><span>0</span><span>,</span><span>35</span><span>)</span>
          <span>oled</span><span>.</span><span>text(help[</span><span>0</span><span>:</span><span>-</span><span>4</span><span>],</span><span>0</span><span>,</span><span>35</span><span>)</span>
          <span>oled</span><span>.</span><span>show()</span>
          <span>player</span><span>.</span><span>play(song)</span>
   
<span>except</span> <span>KeyboardInterrupt</span><span>:</span>
   <span>player</span><span>.</span><span>stop()</span>
</pre></div>
 
  
  
  
  
  
  
  </div></div>
  </body>
</html>
