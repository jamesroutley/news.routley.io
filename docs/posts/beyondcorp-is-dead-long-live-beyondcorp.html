<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mayakaczorowski.com/blogs/beyondcorp-is-dead">Original</a>
    <h1>BeyondCorp is dead, long live BeyondCorp</h1>
    
    <div id="readability-page-1" class="page"><div>
  

<p>
  09 February 2022 -  
  <b>10 mins read time</b>

  </p>

<p>With the US government’s recent <a href="https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf">memo on Zero Trust Cybersecurity Principles</a>, there’s renewed interest (and investment) from organizations in adopting zero trust architectures. <a href="https://research.google/pubs/pub43231/">BeyondCorp</a>, Google’s initial implementation which spawned the pursuit of zero trust in general, is still the guiding star for many organizations. It would seem that the authors of the US government’s memo have, just like the rest of the security industry, read the <a href="https://cloud.google.com/beyondcorp">BeyondCorp whitepapers</a>—and heavily based their strategy on BeyondCorp.</p>

<p><strong>In reality, however, no organization has successfully implemented a fully zero trust architecture, and many proponents of zero trust—including the US government—have missed a key component: devices</strong>. Let’s ignore the memo’s recommendations on DNSSEC and STARTTLS, and focus just on the zero trust architecture.</p>

<h4 id="what-is-zero-trust-architecture">What is zero trust architecture?</h4>

<p>Traditional network architecture relied on a network perimeter to delineate between trusted and untrusted users, such as trusted employees inside a firewall, vs. potentially untrusted parties outside of it. By moving to a zero trust architecture, the location of an individual, specifically, which network they are on, is no longer solely what determines whether the individual is trusted, but other context is used to determine whether they can access a given application. There is no longer such a thing as a privileged, physical, corporate network.</p>

<p>(Most discussion about zero trust these days typically refers to users accessing an enterprise’s internal services, applications, or machines; rather than one service connecting to another service. This is unfortunate, as service to service communication is extremely relevant—even if you validate and allow an individual to access a low risk application, but that application then can make calls to a high risk application, you haven’t effectively protected your high risk applications. If you’re only protecting the front door, but the killer is already <a href="https://xkcd.com/742/">inside the house</a>… well, you’re not going to have a good day.)</p>

<p>We can think of access controls for each application in terms of network segmentation. Each application is in its own segment (micro segmentation), instead of broad concentric circles of increasingly trusted applications. It’s not that a VPN is bad per se, it’s that any entrypoint or gateway that gains access to a broad set of applications, instead of only a specific application, is bad.</p>

<p><a href="https://cloud.google.com/beyondcorp">BeyondCorp, first introduced in a paper in 2014</a>, is Google’s original, specific implementation from which the broader generalized set of principles (and analyst categories) for zero trust architecture emerged.</p>

<p>In BeyondCorp, the idea is that applications are available directly from the public web, not inside a trusted network, and that every request to access an application is a policy decision, based on the user, device, and application. Each of these characteristics can be along a spectrum:</p>

<ul>
  <li><em>User trust</em>: Determined using a user identity (SSO token) and user database (identity provider). A user can be challenged to prove that they are trusted, such as requiring them to sign in or requiring a hardware second factor.</li>
  <li><em>Device trust</em>: Determined using a device inventory, device identity (certificate), and device measurements. A device might be untrusted, like a hotel lobby computer in a foreign country, or might be more trusted, like a fully patched Chromebook, using an MDM, in the company’s device registry, with a device certificate protected by a TPM, also used for secure boot to verify the device’s OS, connecting from the same physical network as the company’s head office.</li>
  <li><em>Application policy</em>: Each application can define a policy with a different fine-grained set of requirements for access, including different minimum requirements for user and device trust. If there is insufficient trust when a user tries to access an application, a challenge can be issued to the user to further authenticate.</li>
</ul>

<p>This is an incredibly complex, sophisticated model for how to manage access to internal applications. BeyondCorp is the gold standard of what we should all aim for when designing zero trust architectures—including what the US government is now mandating.</p>

<p><strong>There’s one problem: a fully zero trust architecture is incredibly difficult and incredibly expensive to deploy, and arguably, no one has ever achieved it.</strong></p>

<h4 id="even-googles-beyondcorp-isnt-a-fully-zero-trust-architecture">Even Google’s BeyondCorp isn’t a fully zero trust architecture</h4>

<p>Google adopted its zero trust architecture of BeyondCorp gradually, targeting both greenfield and brownfield applications, over the span of several years. Today, still, BeyondCorp isn’t 100% rolled out at Google. It never will be. There will always be a gap of enterprise applications or new tools being introduced which require work to integrate.</p>

<p>Like any system, there are exceptions—and those exceptions become more and more expensive (and therefore unworthwhile) to address. Citing <a href="https://research.google/pubs/pub47356/">another of the BeyondCorp papers</a>:</p>

<blockquote>
  <p>Despite all the best efforts to define, roll out, measure, and enforce controls, you may inevitably face the harsh reality that 100% uniform control deployment is a mythical state where unicorns frolic unconcerned about malware and state-sponsored attackers.</p>
</blockquote>

<p>Google has already invested substantial resources, over many many years, in developing BeyondCorp:</p>

<blockquote>
  <p>Fully achieving the goals outlined in this paper (and the more general goals of BeyondCorp) requires significant resources.</p>
</blockquote>

<p>If it’s “significant resources” at Google scale, it must be a massive investment. I would venture to say that if a VP knew the initial cost and time it would actually take, they might not have made that investment. (It’s likely more than the <a href="https://tmf.cio.gov/projects/#zero-trust-networking">$9.9M the Office of Personnel Management has set aside</a>.) For Google, there was a <a href="https://googleblog.blogspot.com/2010/01/new-approach-to-china.html">clear reason to invest</a>; but for a lot of other organizations, there isn’t.</p>

<p><strong>I don’t want to paint the impression that Google’s implementation of BeyondCorp isn’t successful.</strong> It is—it’s a project that has significantly changed how Google operates and improved its security. It has introduced a new model for how to think about network security in the industry—zero trust architecture—and birthed multiple analyst categories, as well as many, many startups. It’s a multi-year initiative in security teams at every major tech company. The US government’s memo cites it in everything but name.</p>

<p>So then, despite its popularity, it shouldn’t come as a surprise that if Google hasn’t fully succeeded, companies other than Google haven’t either.</p>

<h4 id="security-teams-will-laugh-if-you-say-youre-implementing-a-zero-trust-architecture">Security teams will laugh if you say you’re implementing a zero trust architecture</h4>

<p>As with other groundbreaking research coming out of top tech companies, when the BeyondCorp paper was published, startups were created with the goal of reproducing such a zero trust architecture to make it available to anyone. They tried to offer, and I quote, “BeyondCorp… for the Cloud Native organization”, “BeyondCorp outside of Google”, and “BeyondCorp for the rest of us”, amongst others. They bought <a href="https://beyondcorp.com/">beyondcorp.com</a>. They created an <a href="https://cloud.google.com/blog/products/identity-security/google-cloud-announces-new-partners-in-its-beyondcorp-alliance">Alliance</a>. The first BeyondCorp paper (there are many) was released in 2014 - but it’s 2022 now, so shouldn’t you, too, have a zero trust architecture?</p>

<p>What happened? Startups are going to startup, by failing, or getting acquired and absorbed. Today, you can use <a href="https://help.okta.com/asa/en-us/Content/Topics/Adv_Server_Access/docs/setup/ssh.htm?tocpath=Connect%20to%20servers%7CSSH%20setup%7C_____0">an OpenSSH ProxyCommand config to authenticate your SSH sessions using Okta</a>, and you can limit access to an application from a device based on IP address and <a href="https://cloud.google.com/access-context-manager/docs/create-basic-access-level#device-example">whether screen lock is enabled</a>. That’s better, but not saying much, unfortunately.</p>

<p>The reality is if you say you’re “doing zero trust” to a security professional today, they’ll assume you’re naïve, and haven’t realized what you’re actually signing yourself up for. They’ve tried to use the tools already available in the market themselves to get closer to a zero trust architecture, and faced too many challenges. They’ve seen the market get excited, companies be born and die, and yet nothing <em>really</em> changed. If multiple companies registered in Delaware already died trying to make this happen, why would a company headquartered in Virginia be successful? This might be a rare case of security professionals being realistic, not overly pessimistic (as they are often portrayed).</p>

<p>Not to depress you even further, but it’s even worse. The tools that are on the market today aren’t even doing the hard part of zero trust yet.</p>

<h4 id="everyone-seems-to-have-missed-the-bit-about-devices">Everyone seems to have missed the bit about devices</h4>

<p>Recall that Google’s BeyondCorp has three pieces: users, devices, and application policies. But—you may have noticed—the heftiest section of that, by a long shot, is devices. Device trust should be determined using a device inventory, device identity (like a certificate), and device measurements.</p>

<p>So, what does the US government memo say in its barely one and a half pages on devices? That you should inventory your assets, and have government-wide endpoint detection and response. There’s more written on MFA than the whole topic of devices! (Not that MFA isn’t important.)</p>

<p>Why are devices so important? If you recall, if a user has insufficient trust to access a specific application, Google’s BeyondCorp can require the user to perform a challenge, such as re-authenticating or using a hardware second factor. But what’s completely impractical? Asking the user to change the device they are on! (Even my favourite Googler has 5 laptops at home, but only some of them work, even fewer are <em>for</em> work, and most of them are in the other room.) So, when you’re making a decision to authorize a specific access request, you have some data about the user, but ideally, you have <em>as much data about the device as possible</em>, since you can’t get any more. Most of what you can infer about the level of trust for a given connection comes from the device, not the user.</p>

<p>What should you, and the US government, be doing to measure device trust? To poorly summarize: <a href="https://research.google/pubs/pub47356/">have an inventory of your fleet, use an MDM to measure OS version, patch level, and encryption status</a>, yes—the memo got this part. (By the way, have you tried to buy an MDM that covers more than three OSes lately?)</p>

<p>But also, <a href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/43231.pdf">use a device certificate that is specific to each device, protected by the machine’s Trusted Platform Module (TPM)</a>. To do that, you only need enough of an understanding of TPMs to implement secure boot to verify the device’s OS, as well as protected device certificates (sorry, NSA, I don’t think that <a href="https://github.com/nsacyber/HIRS">your implementation</a> in Java, which was susceptible to log4j, will do), and the ability to run an enterprise CA for those certificates, that is available whenever your employees need to access any applications. You already run one of those for your SSH certificates, right?</p>

<h4 id="where-does-that-leave-us">Where does that leave us?</h4>

<p>So, someone at the US government <em>also</em> read the BeyondCorp papers, and <em>also</em> wants a true, working, zero trust architecture. Don’t we all. And I suspect that the government mandating this (by 2024!) won’t make it true—there isn’t a tech company where a top down mandate like this would work today, and I have no reason to believe the US government can do better.</p>

<p><em>These are the right goals.</em> As an industry, we can continue to build pieces of an ideal zero trust solution. A solution that includes:</p>

<ul>
  <li>User authentication, based on single sign-on, and hardware second factors;</li>
  <li>Device authentication, based on a device registry, a hardware-bound device identity, and measured device characteristics like secure boot;</li>
  <li>Application policies, so that each application is micro segmented and enforces its own policies, with no single point of failure;</li>
  <li>No public point of entry to the network;</li>
  <li>End-to-end encryption with world-class cryptography;</li>
  <li>… and meets all the traditional enterprise requirements, like audit logging or SAML integration.</li>
</ul>

<p>I don’t think anyone today is positioned to build every part of that solution. It’s far too much for an organization even like the US government to get right in only 3 years. We’ll still be pulling together components piece meal, where they exist.</p>

<p>The US government memo feels not like a mandate for zero trust, but a mandate to insert “zero trust” in all of our marketing. Here’s hoping we get a few of the missing pieces out of it too.</p>



</div></div>
  </body>
</html>
