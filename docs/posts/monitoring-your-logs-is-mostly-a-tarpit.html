<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/LogMonitoringTarpit">Original</a>
    <h1>Monitoring your logs is mostly a tarpit</h1>
    
    <div id="readability-page-1" class="page"><div><h2>Monitoring your logs is mostly a tarpit</h2>

	<p><small>August  6, 2023</small></p>
</div><div><p>One of the reactions to <a href="https://utcc.utoronto.ca/~cks/space/blog/linux/SystemdRestartHidesProblems">my entry on how systemd&#39;s auto-restarting
of units can hide problems</a>
was a suggestion that we should monitor our logs to detect things
like this. As it happens, one of my potentially unpopular views is
that monitoring your logs is generally a tarpit that isn&#39;t worth
it. Much of the time you&#39;ll spend a great deal of effort to get
very little of worth.</p>

<p>The fundamental problem with general log monitoring is that logs
are functionally unstructured. Anything can appear in them and in
a sufficiently complex environment, anything eventually will. This
unstructured randomness means that sorting general signal from
general noise is a large and often never-ending job, and if you
don&#39;t do it well, you wind up with a lot of noise (which makes it
almost impossible in practice to spot the signal).</p>

<p>One thing you can theoretically sensibly monitor your logs for is
specific, narrow signals of things of interest; for example, you
might monitor Linux kernel logs for <a href="https://utcc.utoronto.ca/~cks/space/blog/linux/MCEUseRasdaemon">machine check error messages</a>. The first problem with monitoring this
way is that there&#39;s no guarantee that the message you&#39;re monitoring
for won&#39;t change. Maybe someday the Linux kernel developers will
decide to put more information in their MCE messages and change the
format. One reason this happens is that almost no one considers log
messages to be an API, and so they feel free to change log messages
at whim.</p>

<p>(But in the mean time, maybe you&#39;ll derive enough value or reassurance
from looking for the current MCE messages in your kernel logs. It&#39;s a
tradeoff, which I&#39;ll get to.)</p>

<p>The second problem with monitoring for specific narrow signals of
interest in your logs is that you have to know what they look like.
It&#39;s easy to say that we&#39;ll monitor for the Prometheus host agent
crashing and systemd restarting it, but it&#39;s much harder to be sure
that we have properly identified the complete collection of log
messages that signal this happening. Remember, log messages are
unstructured, which means it&#39;s hard to get a complete inventory of
what to look for short of things like reading the (current) program
source code to see what it logs.</p>

<p>Finally, all of this potential effort only matters if identifiable
problems appear in your logs on a sufficiently regular basis and
it&#39;s useful to know about them. In other words, problems that happen,
that you care about, and probably that you can do something about.
If a problem was probably a one time occurrence or occurs infrequently,
the payoff from automated log monitoring for it can be potentially
quite low (you can see this as an aspect of <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/AlertsNeverComprehensive">how alerts and
monitoring can never be comprehensive</a>).</p>

<p>But monitoring your logs looks productive and certainly sounds good
and proper. You can write some positive matches to find known
problems, you can write some negative matches to discard noise, you
can &#39;look for anomalies&#39; and then refine your filtering, and so on.
That&#39;s what makes it a tarpit; it&#39;s quite easy to thoroughly mire
yourself in progressively more complex log monitoring.</p>
</div></div>
  </body>
</html>
