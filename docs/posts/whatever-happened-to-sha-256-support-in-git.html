<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lwn.net/SubscriberLink/898522/9cf50ee3f96f90c1/">Original</a>
    <h1>Whatever happened to SHA-256 support in Git?</h1>
    
    <div id="readability-page-1" class="page"><div>
<!-- $Id: slink-trial,v 1.1 2005-11-04 21:27:01 corbet Exp $ -->
<center>
<table>
<tbody><tr><td>
<h3>Welcome to LWN.net</h3>
<p>
The following subscription-only content has been made available to you 
by an LWN subscriber.  Thousands of subscribers depend on LWN for the 
best news from the Linux and free software communities.  If you enjoy this 
article, please consider accepting the trial offer on the right.  Thank you
for visiting LWN.net!
</p></td><td>
<div>
<h3>Free trial subscription</h3>
           <p>
           Try LWN for free for 1 month: no payment
           or credit card required.  <a href="https://lwn.net/Promo/slink-trial2-3/claim">Activate
           your trial subscription now</a> and see why thousands of
           readers subscribe to LWN.net.
           
</p></div>
</td>
</tr>

</tbody></table>
</center>
<p>
The news has been <a href="https://duo.com/decipher/sha-1-fully-and-practically-broken-by-new-collision">proclaimed</a>
loudly and often: the SHA-1 hash algorithm is terminally broken and should
not be used in any situation where security matters.  Among other things,
this news gave some impetus to <a href="https://lwn.net/Articles/811068/">the longstanding
effort</a> to support a more robust hash algorithm in the Git source-code
management system.  As time has passed, though, that work seems to have
slowed to a stop, leaving some users wondering when, if ever, Git will
support a hash algorithm other than SHA-1.
</p><p>
Hash functions are, of course, at the core of how Git works.  Every object
in its data store — every version of every file, among other things — is
hashed, with the resulting value serving as the key under which that object
is stored.  Commits, too, are represented by a hash of the current state of
the tree, the commit message, and the hash(es) of the parent commit(s).
The security of the hash function is a key part of the integrity of a
repository as a whole.  If an attacker could replace a commit with another
having the same hash value, they could perhaps inject malicious code into a
repository without risking detection.  That prospect is worrisome to
anybody who depends on the security of code stored in Git repositories —
everybody, in other words.
</p><p>
The Git project has long since chosen <a href="https://en.wikipedia.org/wiki/SHA-2">SHA-256</a> as the replacement
for SHA-1.  Git was originally written with SHA-1 deeply wired into the
code, but all of that code has since been refactored and can handle
multiple hash types, with SHA-256 being the second supported type.  It is
now possible to create a Git repository using SHA-256 (just use the
<tt>--object-format=sha256</tt> flag) and most local operations will work
just fine.  The foundation for support of alternative hash algorithms in
Git was part of the <a href="https://github.blog/2020-10-19-git-2-29-released/">2.29 release</a>
in 2020 and appears to be solid.
</p><p>
That 2.29 release, though, is the last one that features alternative-hash
work in any significant way; there has been no mention of this work in the
project&#39;s release notes since a fix showed up in <a href="https://github.blog/2021-03-15-highlights-from-git-2-31/">2.31</a>,
released in March 2021.  The 2.29 work marked SHA-256 as experimental and
warned that &#34;<q>that there is no interoperability between SHA-1 and SHA-256
repositories yet</q>&#34;.  There was <a href="https://lwn.net/Articles/823352/">some work
toward interoperability</a> posted in 2020, but those patches do not appear
to have ever been merged into the Git mainline.
</p><p>
In other words, work on supporting the use of a hash algorithm other than
SHA-1 in Git appears to have ground to a halt.  That recently led Stephen
Smith to <a href="https://lwn.net/ml/git/12011256.O9o76ZdvQC@thunderbird/">post a
query</a> about its status to the development list.  <a href="https://lwn.net/ml/git/220621.86sfnyuvt0.gmgdl@evledraar.gmail.com/">This response
from Ævar Arnfjörð Bjarmason</a> is illuminating and, for those looking
forward to full SHA-256 support, potentially discouraging:
</p><blockquote>
	I wouldn&#39;t recommend that anyone use it for anything serious at the
	moment, as far as I can tell the only users (if any) are currently
	(some) people work on git itself.
</blockquote>
<p>
Bjarmason pointed out that there is still no interoperability between SHA-1
and SHA-256 repositories, and that none of the Git hosting providers appear
to be supporting SHA-256.  That support (or the lack thereof) matters; a
repository that cannot be pushed to a Git forge will be essentially useless
to many people.  There is also the risk (which cannot really be made to go
away) that the longer hashes used with SHA-256 may 
break tools developed outside of the Git project.  The overall picture is
one of a feature that is not yet ready for real-world use.
</p><p>
That said, it is worth noting that brian m. carlson, who has done the bulk
of the hash-transition work so far, <a href="https://lwn.net/ml/git/YrI9dvfoc5NYgVDq@tapette.crustytoothpaste.net/">disagrees</a>
with Bjarmason&#39;s assessment.  In his view, the only &#34;<q>defensible</q>&#34;
reason to use SHA-1 at this point is interoperability with the Git forge
providers.  Otherwise, he said, SHA-1 is obsolete, and performance with
SHA-256 can be &#34;<q>substantially faster</q>&#34;.  But he agrees that the
needed interoperability does not exist, and 
nobody has said that it is coming anytime soon.

</p><p>
What has happened here looks, to an extent at least, like a story that has
played out numerous times over the course of free-software history.  A
problem has been identified, and a great deal of core foundational work has
been done to solve it.  That solution appears to be well considered and
solidly implemented.  In a sense, the job is 90% done.  All that is left is
the hard work of making the transition to a new hash easy for users — what
could be thought of as &#34;the other 90%&#34; of the job.
</p><p>
This sort of interface and compatibility development is hard and developers
often do not find it particularly rewarding, so it tends to be neglected
by our community.  The Git project, one might argue, is especially prone to
user-interface challenges, but the problem is wider than that.  There are
certain sorts of tasks that volunteers are often uninclined to pick up, and
that companies may not feel the need to fund.
</p><p>
Given the threat that the SHA-1 hash poses, one might think that there
would be a stronger incentive for somebody to support this work.  But, as
Bjarmason continued, that incentive is not actually all that strong.  The
project adopted the <a href="https://github.com/cr-marcstevens/sha1collisiondetection">SHA-1DC</a>
variant of SHA-1 for the <a href="https://github.blog/2017-05-10-git-2-13-has-been-released/">2.13
release</a> in 2017, which makes the project more robust against the known
SHA-1 collision attacks, so there does not appear to be any sort of
imminent threat of this type of attack against Git.  Even if creating
a collision were feasible for an attacker, Bjarmason pointed out, that is
only the first step in the development of a successful attack.  Finding a
collision of any type is hard; finding one that is still working code, that
has the functionality the attacker is after, and that
looks reasonable to both humans and compilers is quite a bit harder — if it
is possible at all.
</p><p>
So few people are losing sleep over the possibility that a Git repository
could be deliberately corrupted by way of an SHA-1 hash collision anytime
soon.  The 
combination of a lack of urgency and little apparent interest in doing the
work has seemingly brought the SHA-256 transition to a halt.  Perhaps that
is how 
the situation will remain until another SHA-1 weakness turns up and brings
attention back to the situation.  But, as Randall Becker <a href="https://lwn.net/ml/git/011f01d88571$755df480$6019dd80$@nexbridge.com/">pointed
out</a>, there is a cost to this inaction:
</p><blockquote>
	Adding my own 0.02, what some of us are facing is resistance to
	adopting git in our or client organizations because of the presence
	of SHA-1. There are organizations where SHA-1 is blanket banned
	across the board - regardless of its use. [...] Getting around this
	blanket ban is a serious amount of work and I have very recently
	seen customers move to older much less functional (or useful) VCS
	platforms just because of SHA-1.
</blockquote>
<p>
It is a bit of a stretch to imagine that remaining with SHA-1 will threaten
Git&#39;s dominance in the near future.  But it could, perhaps, give a toehold
to a competitor that would lead to trouble in the longer term, especially
if the security of SHA-1 crumbles further.
</p><p>
Given that, one might think that companies that are dependent on Git would
see some value in solving this particular problem.  Many companies use Git,
but some have based their entire business model around it.  The latter
companies have benefited greatly from the community&#39;s investment in Git,
and they have a lot to lose if Git loses its prominence.  It would seem to
make sense for one or more of these companies to make the relatively small
investment needed to push this transition to completion; that would be good
for the community — and for their own future as well.<br clear="all"/></p>
               </div></div>
  </body>
</html>
