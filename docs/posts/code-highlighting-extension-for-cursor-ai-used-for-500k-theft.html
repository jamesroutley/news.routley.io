<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://securelist.com/open-source-package-for-cursor-ai-turned-into-a-crypto-heist/116908/">Original</a>
    <h1>Code highlighting extension for Cursor AI used for $500k theft</h1>
    
    <div id="readability-page-1" class="page"><div>
												<div>
													<p>Attacks that leverage malicious open-source packages are becoming a major and growing threat. This type of attacks currently seems commonplace, with <a href="https://www.kaspersky.com/blog/supply-chain-attacks-in-2024/52965/" target="_blank" rel="noopener">reports of infected packages</a> in repositories like PyPI or npm appearing almost daily. It would seem that increased scrutiny from researchers on these repositories should have long ago minimized the profits for cybercriminals trying to make a fortune from malicious packages. However, our investigation into a recent cyberincident once again confirmed that open-source packages remain an attractive way for attackers to make easy money.</p>
<h2 id="infected-out-of-nowhere">Infected out of nowhere</h2>
<p>In June 2025, a blockchain developer from Russia reached out to us after falling victim to a cyberattack. He’d had around $500,000 in crypto assets stolen from him. Surprisingly, the victim’s operating system had been installed only a few days prior. Nothing but essential and popular apps had been downloaded to the machine. The developer was well aware of the cybersecurity risks associated with crypto transactions, so he was vigilant and carefully reviewed his every step while working online. Additionally, he used free online services for malware detection to protect his system, but no commercial antivirus software.</p>
<p>The circumstances of the infection piqued our interest, and we decided to investigate the origins of the incident. After obtaining a disk image of the infected system, we began our analysis.</p>
<h2 id="syntax-highlighting-with-a-catch">Syntax highlighting with a catch</h2>
<p>As we examined the files on the disk, a file named <code>extension.js</code> caught our attention. We found it at %userprofile%\.cursor\extensions\solidityai.solidity-1.0.9-universal\src\extension.js. Below is a snippet of its content:</p>
<div id="attachment_116913"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116913" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1.png" alt="A request sent by the extension to the server" width="1742" height="280" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1.png 1742w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-300x48.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-1024x165.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-768x123.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-1536x247.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-740x119.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-1600x257.png 1600w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223637/open-source-package1-800x129.png 800w" sizes="auto, (max-width: 1742px) 100vw, 1742px"/></a></p><p id="caption-attachment-116913">A request sent by the extension to the server</p></div>
<p>This screenshot clearly shows the code requesting and executing a PowerShell script from the web server <code>angelic[.]su</code>: a sure sign of malware.</p>
<p>It turned out that <code>extension.js</code> was a component of the Solidity Language extension for the Cursor AI IDE, which is based on Visual Studio Code and designed for AI-assisted development. The extension is available in the Open VSX registry, used by Cursor AI, and was published about two months ago. At the time this research, the extension had been downloaded 54,000 times. The figure was likely inflated. According to the description, the extension offers numerous features to optimize work with Solidity smart contract code, specifically syntax highlighting:</p>
<div id="attachment_116914"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116914" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2.png" alt="The extension&#39;s description in the Open VSX registry" width="1360" height="816" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2.png 1360w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-300x180.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-1024x614.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-768x461.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-583x350.png 583w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-740x444.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-467x280.png 467w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223729/open-source-package2-800x480.png 800w" sizes="auto, (max-width: 1360px) 100vw, 1360px"/></a></p><p id="caption-attachment-116914">The extension’s description in the Open VSX registry</p></div>
<p>We analyzed the code of every version of this extension and confirmed that it was a fake: neither syntax highlighting nor any of the other claimed features were implemented in any version. The extension has nothing to do with smart contracts. All it does is download and execute malicious code from the aforementioned web server. Furthermore, we discovered that the description of the malicious plugin was copied by the attackers from the <a href="https://open-vsx.org/extension/juanblanco/solidity" target="_blank" rel="noopener">page of a legitimate extension</a>, which had 61,000 downloads.</p>
<h2 id="how-the-extension-got-on-the-computer">How the extension got on the computer</h2>
<p>So, we found that the malicious extension had 54,000 downloads, while the legitimate one had 61,000. But how did the attackers manage to lull the developer’s vigilance? Why would he download a malicious extension with fewer downloads than the original?</p>
<p>We found out that while trying to install a Solidity code syntax highlighter, the developer searched the extension registry for <code>solidity</code>. This query returned the following:</p>
<div id="attachment_116915"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116915" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3.png" alt="Search results for &#34;solidity&#34;: the malicious (red) and legitimate (green) extensions" width="902" height="989" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3.png 902w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3-274x300.png 274w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3-768x842.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3-319x350.png 319w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3-740x811.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3-255x280.png 255w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09223825/open-source-package3-800x877.png 800w" sizes="auto, (max-width: 902px) 100vw, 902px"/></a></p><p id="caption-attachment-116915">Search results for “solidity”: the malicious (red) and legitimate (green) extensions</p></div>
<p>In the search results, the malicious extension appeared fourth, while the legitimate one was only in eighth place. Thus, while reviewing the search results, the developer clicked the first extension in the list with a significant number of downloads – which unfortunately proved to be the malicious one.</p>
<h2 id="the-ranking-algorithm-trap">The ranking algorithm trap</h2>
<p>How did the malicious extension appear higher in search results than the legitimate one, especially considering it had fewer downloads? It turns out the Open VSX registry ranks search results by relevance, which <a href="https://github.com/eclipse/openvsx/blob/master/server/src/main/java/org/eclipse/openvsx/search/RelevanceService.java" target="_blank" rel="noopener">considers multiple factors</a>, such as the extension rating, how recently it was published or updated, the total number of downloads, and whether the extension is verified. Consequently, the ranking is determined by a combination of factors: for example, an extension with a low number of downloads can still appear near the top of search results if that metric is offset by its recency. This is exactly what happened with the malicious plugin: the fake extension’s last update date was June 15, 2025, while the legitimate one was last updated on May 30, 2025. Thus, due to the overall mix of factors, the malicious extension’s relevance surpassed that of the original, which allowed the attackers to promote the fake extension in the search results.</p>
<p>The developer, who fell into the ranking algorithm trap, didn’t get the functionality he wanted: the extension didn’t do any syntax highlighting in Solidity. The victim mistook this for a bug, which he decided to investigate later, and continued his work. Meanwhile, the extension quietly installed malware on his computer.</p>
<h2 id="from-powershell-scripts-to-remote-control">From PowerShell scripts to remote control</h2>
<p>As mentioned above, when the malicious plugin was activated, it downloaded a PowerShell script from <code>https://angelic[.]su/files/1.txt</code>.</p>
<div id="attachment_116917"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116917" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1.png" alt="The PowerShell script contents" width="1738" height="462" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1.png 1738w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-300x80.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-1024x272.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-768x204.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-1536x408.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-1317x350.png 1317w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-740x197.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-1053x280.png 1053w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224142/open-source-package4-1-800x213.png 800w" sizes="auto, (max-width: 1738px) 100vw, 1738px"/></a></p><p id="caption-attachment-116917">The PowerShell script contents</p></div>
<p>The script checks if the ScreenConnect remote management software is installed on the computer. If not, it downloads a second malicious PowerShell script from: <code>https://angelic[.]su/files/2.txt</code>. This new script then downloads the ScreenConnect installer to the infected computer from <code>https://lmfao[.]su/Bin/ScreenConnect.ClientSetup.msi?e=Access&amp;y=Guest</code> and runs it. From that point on, the attackers can control the infected computer via the newly installed software, which is configured to communicate with the C2 server <code>relay.lmfao[.]su</code>.</p>
<h2 id="data-theft">Data theft</h2>
<p>Further analysis revealed that the attackers used ScreenConnect to upload three VBScripts to the compromised machine:</p>
<ul>
<li><code>a.vbs</code></li>
<li><code>b.vbs</code></li>
<li><code>m.vbs</code></li>
</ul>
<p>Each of these downloaded a PowerShell script from the text-sharing service <code>paste.ee</code>. The download URL was obfuscated, as shown in the image below:</p>
<div id="attachment_116918"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116918" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5.png" alt="The obfuscated URL for downloading the PowerShell script" width="870" height="189" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5.png 870w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5-300x65.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5-768x167.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5-740x161.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09224354/open-source-package5-800x174.png 800w" sizes="auto, (max-width: 870px) 100vw, 870px"/></a></p><p id="caption-attachment-116918">The obfuscated URL for downloading the PowerShell script</p></div>
<p>The downloaded PowerShell script then retrieved an image from <code>archive[.]org</code>. A loader known as <a href="https://www.sonicwall.com/blog/vmdetector-based-loader-abuses-steganography-to-deliver-infostealers" target="_blank" rel="noopener">VMDetector</a> was then extracted from this image. VMDetector attacks <a href="https://www.ibm.com/think/x-force/dcrat-presence-growing-in-latin-america" target="_blank" rel="noopener">were previously observed</a> in phishing campaigns that targeted entities in Latin America. The loader downloaded and ran the final payload from paste.ee.</p>
<p>Our analysis of the VBScripts determined that the following payloads were downloaded to the infected computer:</p>
<ul>
<li>Quasar open-source backdoor (via <code>a.vbs</code> and <code>b.vbs</code>),</li>
<li>Stealer that collected data from browsers, email clients, and crypto wallets (via <code>m.vbs</code>). Kaspersky products detect this malware as <code>HEUR:Trojan-PSW.MSIL.PureLogs.gen</code>.</li>
</ul>
<p>Both implants communicated with the C2 server <code>144.172.112[.]84</code>, which resolved to <code>relay.lmfao[.]su</code> at the time of our analysis. With these tools, the attackers successfully obtained passphrases for the developer’s wallets and then syphoned off cryptocurrency.</p>
<h2 id="new-malicious-package">New malicious package</h2>
<p>The malicious plugin didn’t last long in the extension store and was taken down on July 2, 2025. By that time, it had already been detected not only by us as we investigated the incident but also by <a href="https://secureannex.com/blog/these-vibes-are-off/" target="_blank" rel="noopener">other researchers</a>. However, the attackers continued their campaign: just one day after the removal, they published another malicious package named “solidity”, this time exactly replicating the name of the original legitimate extension. The functionality of the fake remained unchanged: the plugin downloaded a malicious PowerShell script onto the victim’s device. However, the attackers sought to inflate the number of downloads dramatically. The new extension was supposedly downloaded around two million times. The following results appeared up until recently when users searched for <code>solidity</code> within the Cursor AI development environment (the plugin is currently removed thanks to our efforts).</p>
<div id="attachment_116919"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116919" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6.png" alt="Updated search results for &#34;solidity&#34;" width="892" height="881" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6.png 892w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-300x296.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-768x759.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-354x350.png 354w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-740x731.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-283x280.png 283w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-800x790.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225435/open-source-package6-50x50.png 50w" sizes="auto, (max-width: 892px) 100vw, 892px"/></a></p><p id="caption-attachment-116919">Updated search results for “solidity”</p></div>
<p>The updated search results showed the legitimate and malicious extensions appearing side-by-side in the search rankings, occupying the seventh and eighth positions respectively. The developer names look identical at first glance, but the legitimate package was uploaded by <code>juanblanco</code>, while the malicious one was uploaded by <code>juanbIanco</code>. The font used by Cursor AI makes the lowercase letter <code>l</code> and uppercase <code>I</code> appear identical.</p>
<p>Therefore, the search results displayed two seemingly identical extensions: the legitimate one with 61,000 downloads and the malicious one with two million downloads. Which one would the user choose to install? Making the right choice becomes a real challenge.</p>
<h2 id="similar-cyberattacks">Similar cyberattacks</h2>
<p>It’s worth noting that the Solidity extensions we uncovered are not the only malicious packages published by the attackers behind this operation. We used our <a href="https://www.kaspersky.com/open-source-feed?icid=gl_securelist_acq_ona_smm__onl_b2c_securelist_lnk_sm-team_______da69c993382d038a" target="_blank" rel="noopener">open-source package monitoring tool</a> to find a malicious npm package called “solsafe”. It uses the URL <code>https://staketree[.]net/1.txt</code> to download ScreenConnect. In this campaign, it’s also configured to use <code>relay.lmfao[.]su</code> for communication with the attackers.</p>
<p>We also discovered that April and May 2025 saw three malicious Visual Studio Code extensions <a href="https://securitylabs.datadoghq.com/articles/mut-9332-malicious-solidity-vscode-extensions/" target="_blank" rel="noopener">published</a>: solaibot, among-eth, and blankebesxstnion. The infection method used in these threats is strikingly similar to the one we described above. In fact, we found almost identical functionality in their malicious scripts.</p>
<div id="attachment_116920"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-116920" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7.png" alt="Scripts downloaded by the VS Code extension (left) vs. Solidity Language (right)" width="2048" height="673" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7.png 2048w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-300x99.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-1024x337.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-768x252.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-1536x505.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-1065x350.png 1065w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-740x243.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-852x280.png 852w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2025/07/09225529/open-source-package7-800x263.png 800w" sizes="auto, (max-width: 2048px) 100vw, 2048px"/></a></p><p id="caption-attachment-116920">Scripts downloaded by the VS Code extension (left) vs. Solidity Language (right)</p></div>
<p>In addition, all of the listed extensions perform the same malicious actions during execution, namely:</p>
<ul>
<li>Download PowerShell scripts named <code>1.txt</code> and <code>2.txt</code>.</li>
<li>Use a VBScript with an obfuscated URL to download a payload from <code>paste.ee</code>.</li>
<li>Download an image with a payload from <code>archive.org</code>.</li>
</ul>
<p>This leads us to conclude that these infection schemes are currently being widely used to attack blockchain developers. We believe the attackers won’t stop with the Solidity extensions or the solsafe package that we found.</p>
<h2 id="takeaways">Takeaways</h2>
<p>Malicious packages continue to pose a significant threat to the crypto industry. Many projects today rely on open-source tools downloaded from package repositories. Unfortunately, packages from these repositories are often a source of malware infections. Therefore, we recommend extreme caution when downloading any tools. Always verify that the package you’re downloading isn’t a fake. If a package doesn’t work as advertised after you install it, be suspicious and check the downloaded source code.</p>
<p>In many cases, malware installed via fake open-source packages is well-known, and <a href="https://www.kaspersky.com/premium?icid=gl_securelist_acq_ona_smm__onl_b2c_securelist_lnk_sm-team___kprem____3b7590825188da5e" target="_blank" rel="noopener">modern cybersecurity solutions</a> can effectively block it. Even experienced developers must not neglect security solutions, as these can help prevent an attack in case a malicious package is installed.</p>
<h2 id="indicators-of-compromise">Indicators of compromise</h2>
<p><em>Hashes of malicious JS files</em></p>
<p><em>Network indicators</em></p>
												</div>
											</div></div>
  </body>
</html>
