<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nanochess.org/transputer_board.html">Original</a>
    <h1>Development of a transputer ISA board</h1>
    
    <div id="readability-page-1" class="page"><div>

<p><img src="https://nanochess.org/img/transputer_board_1.jpg" width="30%" alt="The TRAM boards I got from eBay"/></p><p>
    I developed software for transputers in the years 1993-1996. A few months ago, I wrote some articles about my experiences, and most recently I developed a <a href="https://nanochess.org/transputer_emulator.html">transputer emulator in Javascript</a>.
</p>
<p>
    After my transputer emulator in Javascript was working, I got curious about running my software on a PC computer. I have several PC motherboards with ISA connectors, and I decided to build a card compatible with the Inmos B004 (a single board to test transputer processors). Out of curiosity, I decided for compatibility because I wanted to run the Inmos Occam compiler.
    </p>
    <p>
        A quick look in eBay and I got two transputer boards (TRAMs) for $25 each one. Both based on the Inmos T805 transputer running at 30 mhz.
    </p>
<p>
    I got the port numbers for the board from <a href="https://www.geekdot.com/inmos-b004/">Geekdot</a>, and designed a decoder schematic based on TTL circuits.
</p>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_2.jpg" width="80%" alt="My first schematic for the board"/></p></div>
<p>
    The TRAM board contains the transputer and its memory. It is connected to the ISA board with an Inmos C011 chip that serializes and deserializes the communication link. This chip is accessed via the ports 0150H-0153H. My ISA board also provides a 5 mhz oscillator, two flip-flops to reset and analyse the transputer, and a tri-state gate to read the error status.
</p>
<table>
    <tbody><tr><th colspan="2">Ports of an Inmos B004 board</th></tr>
    <tr><th>Offset</th><th>Field</th></tr>
    <tr><td>0150H Read</td><td>Receive data</td></tr>
    <tr><td>0151H Write</td><td>Send data</td></tr>
    <tr><td>0152H Read</td><td>Receive status</td></tr>
    <tr><td>0153H Read</td><td>Send status</td></tr>
    <tr><td>0160H Write</td><td>Latch bit 0 = Direct to Reset</td></tr>
    <tr><td>0161H Write</td><td>Latch bit 0 = Direct to Analyse</td></tr>
    <tr><td>0160H Read</td><td>Bit 0 = Direct from notError</td></tr>
</tbody></table>
<p>
    I required a single ISA board drilled for homebrew development. I was going to buy one board in eBay for $35 dollars shipped, but I considered it was way too expensive. After some searching, I found the PCBWay showcase, where this same board was available for sale. And better, I could get 5 boards of 10x10cm. for $25 dollars shipped.
</p>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_3.jpg" width="80%" alt="The ISA board for homebrewing"/></p></div>
<p>
    I got the board and I started to put sockets for the chips. It took me a while to get the oscillator working. Once it was generating the 5 mhz. clock, I wired everything step-by-step, testing as possible. I was so happy doing this, that I never noticed I built the components on the solder side. My first insertion on a PC motherboard killed two 74LS08 when I feed 12V+ through the chips, until I realized my board was backwards.
</p>
<div><p>
    My board also has a lot of noise produced by the wiring. After adding some decoupling capacitors, I was able to run <a href="https://nanochess.org/pascal.html">my Pascal compiler and ray tracing software from 1993</a>.
</p></div>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_4.jpg" width="80%" alt="The transputer board working with the ray tracer"/></p></div>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_5.jpg" width="40%" alt="The ISA board I&#39;ve built"/>Â <img src="https://nanochess.org/img/transputer_board_6.jpg" width="40%" alt="The ISA board I&#39;ve built (wired side)"/></p></div>
<h2>Going the PCB route</h2>
<p>
    A few weeks later, I decided to learn a little about KiCAD 9, so I installed it on my Macbook Air. Having used OrCAD many years ago, and my own programs that I developed later (I need to write more about it), I recognized most of the tools, and fortunately for this article, KiCAD comes with a predesigned ISA bus component.
</p>
<p>
Once I put the ISA bus component on the sheet, I wondered if there was a 74LS245 in the library, and yes, so I started adding the components. I wired the pins. I also used the component designer to create the Inmos C011 chip, and the TRAM pinout.
</p>
<p>
In less than two hours I had a schematic for my transputer board. It looked good, and from some tutorials in Youtube I heard about a very easy path from schematic to printed circuit board, so I exported the netlist, solved some bugs, and then invoked the PCB program. I discovered that I was missing the footprint for the TRAM.
</p>
<p>
    With the footprint designed, the components appeared almost magically in the workspace. And you only had to click and drag and drop the components to their place! This was heaven! I didn&#39;t found an autorouter, so I went ahead to draw some lines.
</p>
<p>
I had worked five hours already, and I was pretty bored because I had to redraw line after line to make space in the board, or basically every time some line crossed the wrong place and it blocked other lines. I had heard of an autorouter for KiCAD, but it required to install Java (I remember in the 2010s I avoided as possible the slow and weird Oracle&#39;s installer), but I couldn&#39;t find a way to tell KiCAD I had downloaded an autorouter.
</p>
<p>
It happens KiCAD has gone through so many iterations that there are tutorials since KiCAD 6. I was reading the information for the wrong version. In KiCAD 9 you only need to open the complements window from the initial startup window, select Freerouter, and you need also to install a more compact Java version called Eclipse Temurin.
</p>
<p>
The autorouter didn&#39;t worked in the first attempt, because my board outline was open somehow. After some work I was able to make the outline in a single polygon. I made sure the design rules check (DRC) were correct, with some further work going back to the schematic to tag the unused lines, and correct the voltage lines.
</p>
<p>
I clicked the autorouting icon, and Freerouter appeared. I watched a countdown of 5 seconds, and then my board appeared, and ten-seconds later it was routed!!!
</p>
<p>
It was mind-numbing!!! My memories went through the mist of times, when the only software available was Ultiboard and it was priced at $5,000 USD, later Orcad PCB with a slow and terrible autorouter, and now I had my board completed thanks to the effort of countless people.
</p>
<p>
    Also it is pretty amazing to click a menu option and get a 3D view of the board.
</p>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_9.png" width="80%" alt="The 3D view of my first transputer PCB"/></p></div>
<h2>PCBWay</h2>
<p>
KiCAD exported the Gerber and Excellon files. In the old times, there was a Gerber plotter that made a 1:1 version of your board for the negative processing, and the file format (with improvements) is still used in these modern times. It looks like I&#39;m going fast, but it is only because I knew most of this beforehand.
</p>
<p>
What I didn&#39;t expected was that dropping the Gerber files zipped into the PCBWay webpage basically gets you an immediate quote, my card was charged, and ten minutes later the PCB was being manufactured in Shenzhen, China. That&#39;s the power of Internet unleashed.
</p>
<p>
The next day, I was watching again my circuit board, and I discovered that because my impulsiveness, all the power lines were 7 mils wide. Face palm, the transputer needs 1 amper of power to work, luckily, 7 mils is enough for 1 amper. However, you never should make lines so thin, you need tolerance, so I found the design settings, and I changed the voltage lines to be wider for the next revision.
</p>
<p>
One week later, I got my first PCBs, and the first thing I noticed was that some component references were missing. My bad, I never noticed that KiCAD shows two labels on the board, and I believed both were to be printed, but instead one is for your local reference, and the other one is for your silkscreen.
</p>
<p>
Furthermore, my first build step with the 5 mhz oscillator didn&#39;t produced any signal. It took me like three hours to discover that I switched inadvertently the places of the crystal and the capacitor in the schematics. Fortunately, I could swap the components on the board.
</p>
<p>
In the last building step, I discovered the Reset and Analyse pins were inverted. I was mystified as the schematic looked correct. It wasn&#39;t until I made a really big zoom that I saw the bug (KiCAD shines here, as it shows the pin number inside the component pad) I had designed incorrectly my footprint, never noticed I placed first the pad number 10, and then the pad number 9, but these were assigned numbers sequentially. So the pins 9 and 10 of the TRAM were inverted (Reset and Analyse), and the autorouter just followed it. I scratched the lines on the board, and put wires, and the board worked just fine!
</p>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_10.jpg" width="80%" alt="The revisions of my transputer boards"/></p></div>
<h2>More mistakes</h2>
<p>
I wasn&#39;t satisfied with this. Another thing I forgot is that because I was now using a PCB board, the signal noise-ratio was greatly diminished, so I could use the 20 megabits speed of the serializer. However, as I connected the configuration lines directly to ground, it wasn&#39;t easy to separate them.
</p>
<p>
I modified the schematic, and added two jumpers. One for selecting the speed, and another for the port. Because I wanted to put two transputers boards on my PC, just for the sake of doing it and watching some parallel work, although this wouldn&#39;t be compatible with the Inmos software.
</p>
<p>
I revised all carefully, I ran all the DRC tests, and sent it to PCBWay to get the finished product. This time in red color finish.
</p>
<p>
When I received the PCB, I was astonished to watch how the bare PCB stalled the PC motherboard. Turns out that I moved a component on the schematic, and somehow KiCAD decided to add a connection point in a line to make the definitive crossover between the data line D0 and the address line A4. The DRC didn&#39;t recognize the mistake because D0 is tri-state, so it enters into the realm of possibilities having D0 connected to A4.
</p>
<p>
I was so sad because the D0 line is used in several places, but I was pretty lucky to find the autorouter leaved the lines in the clear! I only needed to cut the lines in two places, and add a wire. The board was working!
</p>
<p>
I cut the lines in all the remaining boards in case someday I build more. But I wasn&#39;t satisfied, so I sent again the corrected board to PCBway. This time ordered it in blue color, and with some components adjusted for better look.
</p>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_7.png" width="80%" alt="The final revision of the schematic"/></p></div>
<h2>The blue board</h2>
<p><img src="https://nanochess.org/img/transputer_board_11.jpg" width="30%" alt="My blue transputer board running the Mandelbrot demo from Geekdot, using a 286 motherboard as host."/></p><p>
One week later I had the PCB in my hands, I built it in less than a hour, and started testing it. Everything worked perfectly, even a <a href="https://www.geekdot.com/mandelbrot-benchmark/">Mandelbrot demo</a> I got from Geekdot.
</p>
<p>
It felt good. So I decided, at last, to test the original Inmos Occam compiler. After a cumbersome installation, setting a ton of devices and paths (I just realized how many years have passed since I edited CONFIG.SYS and AUTOEXEC.BAT files), I managed to run the compiler, and it said &#34;Transputer error set&#34;.
</p>
<p>
WTF? The only thing that could have happened is that it requires an unmodified error flag. I used a 74LS368 that inverts the output, because I decided that if you set Reset and Analyse to 1, then probably you also expect a one as error. I desoldered the chip, and I was about to solder the 74LS367, when I decided to disassemble the Inmos ISERVER.EXE file to make sure I was doing the correct thing. 
</p>
<p>
I found easily the code that set the 0150H port as default, and it derived several port numbers. I found the read status port in the first try, and then the code for reading the bit. The program extracted the least-significant bit (this confirms the values in D1-D7 aren&#39;t important), and complemented it. This means it expected the unmodified NotError bit.
</p>
<p>
With this confidence vote, I soldered the only 74367 I had at hand, and the Occam compiler worked! And by the way, the 74367 and the 74LS368 have compatible pinouts.
</p>
<p>
I made the change in the schematic, and the silk-screen in the PCB for the release. 
</p>
<div>
    <p><img src="https://nanochess.org/img/transputer_board_8.png" width="80%" alt="The final revision of the PCB"/></p></div>
<h2>Schematics and PCB board</h2>
<p>
The schematics in PDF and KiCAD format are released at <a href="https://github.com/nanochess/transputer">https://github.com/nanochess/transputer</a>. I preferred to put the PCB board only in Gerber format along the drill files. You only need to compress the files in ZIP format for PCBway.
</p>
<p>
Many people have suggested me to order the PCB with gold plated connector, along a beveled edge. This is at your option.
</p>
<p>
Currently, I have several extra PCB, you can get a board built and tested for $74 USD, shipping included. Good while supplies last. You need to provide your own TRAM board (the one with the transputer), and the Inmos C011 chip. Please write me an <a href="https://nanochess.org/author.html">email</a> if you are interested.
</p>
<p>
    Finally, the <a href="https://github.com/nanochess/transputer/tram">support software</a> is available in the same repository. It contains the <i>comm.com</i> program to run my Pascal compiler or the ray tracer, and the <i>comm2.com</i> program to run my self-contained small operating system booting from a 1.44mb floppy disk. I still need to write another communications program for my full-fledged operating system.
</p>

<h2>Related links</h2>
<ul>
    <li>The repository for all my transputer related work. <a href="https://github.com/nanochess/transputer">https://github.com/nanochess/transputer</a></li>
    <li>My teen years: <a href="https://nanochess.org/pascal.html">My Pascal compiler for transputer</a>.</li>
    <li>My teen years: <a href="https://nanochess.org/bootstrapping_c_os_transputer.html">How I ported Small-C to transputer, and created my own operating system</a>.</li>
    <li>My teen years: <a href="https://nanochess.org/transputer_operating_system.html">How I expanded my operating system to a full-fledged one</a>.</li>
    <li>A <a href="https://nanochess.org/transputer_emulator.html">port of my transputer emulator in Javascript</a>, runnable in your web browser.</li>
</ul>
<p>Last modified: Jul/03/2025</p>
</div></div>
  </body>
</html>
