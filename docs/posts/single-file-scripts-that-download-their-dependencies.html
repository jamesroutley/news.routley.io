<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://dbohdan.com/scripts-with-dependencies">Original</a>
    <h1>Single-file scripts that download their dependencies</h1>
    
    <div id="readability-page-1" class="page"><div>
              <!-- <div id="metadata" class="well well-sm">created 2021-04-25 · updated 2023-01-14</div> -->
            <div>


<p>An ideal distributable script is fully contained in a single file. It runs on any compatible operating system with an appropriate language runtime. It is plain text, and you can copy and paste it. It does not require mucking about with a package manager, or several, to run. It does not conflict with other scripts’ packages or require managing a <a href="https://docs.python.org/3/tutorial/venv.html">project environment</a> to avoid such conflicts.</p>
<p>The classic way to get around all of these issues with scripts is to limit yourself to using the scripting language’s standard library. However, programmers writing scripts don’t want to; they want to use libraries that do not come with the language by default. Some scripting languages, runtimes, and environments resolve this conflict by offering a means to download and cache a script’s dependencies with just declarations in the script itself. This page lists such languages, runtimes, and environments. If you know more, <a href="https://dbohdan.com/contact">drop me a line</a>.</p>
<h2 id="contents">Contents</h2>
<nav id="TOC" role="doc-toc">
<ul>
<li>
<a href="#anything-with-a-nix-package">Anything with a Nix package</a>
</li>
<li>
<a href="#d">D</a>
</li>
<li>
<a href="#groovy">Groovy</a>
</li>
<li>
<a href="#javascript-deno">JavaScript (Deno)</a>
</li>
<li>
<a href="#kotlin-kscript">Kotlin (kscript)</a>
</li>
<li>
<a href="#racket-scripty">Racket (Scripty)</a>
</li>
<li>
<a href="#scala-ammonite">Scala (Ammonite)</a>
</li>
</ul>
</nav>
<h2 id="anything-with-a-nix-package">Anything with a Nix package</h2>
<p>The Nix package manager can <a href="https://nixos.org/manual/nix/stable/command-ref/nix-shell.html#use-as-a--interpreter">act as a <code>#!</code> interpreter</a> and start another program with a list of dependencies available to it.</p>
<div id="cb1"><pre><code><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span>#! /usr/bin/env nix-shell</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span>#! nix-shell -i python3 -p python3</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span>print</span>(<span>&#34;Hello, world!&#34;</span>.rjust(<span>20</span>, <span>&#34;-&#34;</span>))</span></code></pre></div>
<h2 id="d">D</h2>
<p>D’s official package manager DUB supports <a href="https://dub.pm/advanced_usage">single-file packages</a>.</p>
<div id="cb2"><pre><code><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>#! /usr/bin/env dub</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span>/+ dub.sdl:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span>name &#34;foo&#34;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span>+/</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span>import</span> std.range : padLeft;</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span>import</span> std.stdio : writeln;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span>void</span> main() {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>    writeln(padLeft(<span>&#34;Hello, world!&#34;</span>, <span>&#39;-&#39;</span>, <span>20</span>));</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>}</span></code></pre></div>
<h2 id="groovy">Groovy</h2>
<p>Groovy comes with an embedded <a href="http://docs.groovy-lang.org/latest/html/documentation/grape.html">JAR dependency manager</a>.</p>
<pre><code>#! /usr/bin/env groovy
@Grab(group=&#39;org.apache.commons&#39;, module=&#39;commons-lang3&#39;, version=&#39;3.12.0&#39;)
import org.apache.commons.lang3.StringUtils
println StringUtils.leftPad(&#39;Hello, world!&#39;, 20, &#39;-&#39;)</code></pre>
<h2 id="javascript-deno">JavaScript (Deno)</h2>
<p><a href="https://deno.land/">Deno</a> downloads dependencies like a browser. Deno 1.28 and later can also import from NPM packages. Current versions of Deno require you to pass a <code>run</code> argument to <code>deno</code>. One way to accomplish this from a script is with a form of <a href="https://wiki.tcl-lang.org/page/exec+magic">“exec magic”</a>. Here the magic is modified from a <a href="https://github.com/denoland/deno/issues/929#issuecomment-429004626">comment</a> by Rafał Pocztarski.</p>
<div id="cb4"><pre><code><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span>#! /bin/sh</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span>&#34;:&#34;</span> <span>//#; exec /usr/bin/env deno run &#34;$0&#34; &#34;$@&#34;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span>import</span> leftPad <span>from</span> <span>&#34;npm:left-pad&#34;</span><span>;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span>console</span><span>.</span><span>log</span>(<span>leftPad</span>(<span>&#34;Hello, world!&#34;</span><span>,</span> <span>20</span><span>,</span> <span>&#34;-&#34;</span>))<span>;</span></span></code></pre></div>
<p>On Linux systems with <a href="https://coreutils.gnu.narkive.com/e0afmL4P/env-add-s-option-split-string-for-shebang-lines-in-scripts">recent GNU env(1)</a> and on <a href="https://www.freebsd.org/cgi/man.cgi?env">FreeBSD</a> you can replace the magic with <code>env -S</code>.</p>
<div id="cb5"><pre><code><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span>#! /usr/bin/env -S deno run</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span>import</span> leftPad <span>from</span> <span>&#34;npm:left-pad&#34;</span><span>;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span>console</span><span>.</span><span>log</span>(<span>leftPad</span>(<span>&#34;Hello, world!&#34;</span><span>,</span> <span>20</span><span>,</span> <span>&#34;-&#34;</span>))<span>;</span></span></code></pre></div>
<h2 id="kotlin-kscript">Kotlin (kscript)</h2>
<p><a href="https://github.com/holgerbrandl/kscript">kscript</a> is an unofficial scripting tool for Kotlin that understands several comment-based directives, including one for dependencies.</p>
<div id="cb6"><pre><code><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span>#! /usr/bin/env kscript</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span>//DEPS org.apache.commons:commons-lang3:3.12.0</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span>import</span> <span>org.apache.commons.lang3.StringUtils</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>println(StringUtils.leftPad(<span>&#34;Hello, world!&#34;</span>, <span>20</span>, <span>&#34;-&#34;</span>))</span></code></pre></div>
<h2 id="racket-scripty">Racket (Scripty)</h2>
<p><a href="https://docs.racket-lang.org/scripty/">Scripty</a> interactively prompts you to install the missing dependencies for a script in any Racket language.</p>
<pre><code>#! /usr/bin/env racket
#lang scripty
#:dependencies &#39;(&#34;base&#34; &#34;typed-racket-lib&#34; &#34;left-pad&#34;)
------------------------------------------
#lang typed/racket/base
(require left-pad/typed)
(displayln (left-pad &#34;Hello, world!&#34; 20 &#34;-&#34;))</code></pre>
<h2 id="scala-ammonite">Scala (Ammonite)</h2>
<p>The scripting environment in Ammonite lets you <a href="https://ammonite.io/#IvyDependencies">import Ivy dependencies</a>.</p>
<div id="cb8"><pre><code><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>#! /usr/bin/env amm</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span>import</span> $ivy.`org.<span>apache</span>.<span>commons</span>:commons-lang3:<span>3</span>.<span>12.0</span>`,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>  org.<span>apache</span>.<span>commons</span>.<span>lang3</span>.<span>StringUtils</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span>println</span>(StringUtils.<span>leftPad</span>(<span>&#34;Hello, world!&#34;</span>, <span>20</span>, <span>&#34;-&#34;</span>))</span></code></pre></div>




<hr/>

<p>Tags: <a href="https://dbohdan.com/tags#list">list</a>, <a href="https://dbohdan.com/tags#programming">programming</a>.</p>



            </div> <!-- .markdown -->
          </div></div>
  </body>
</html>
