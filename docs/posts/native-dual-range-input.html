<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://muffinman.io/blog/native-dual-range-input/">Original</a>
    <h1>Native dual-range input</h1>
    
    <div id="readability-page-1" class="page"><div id="page"><p><a href="#content">Jump to content</a></p><section id="content" role="main" tabindex="-1"><svg viewBox="0 0 1000 40"><path d="M 0.25 -5 L 0,0 L 500 40 L 1000,0.25 L 1000,-5 z"></path><path d="M-2000 -160 L 500 40 L 3000,-160 L 3000 42 L -2000 42"></path><path d="M-2000 -160 L 500 40 L 3000,-160" fill="none" vector-effect="non-scaling-stroke"></path></svg><div><div><p>I just released <a href="https://github.com/stanko/dual-range-input">@stanko/dual-range-input</a> - a native dual-range input. Here is how it looks with the default styles:</p><p>The &#34;native&#34; part is somewhat open for discussion. I call it native because the library uses two native HTML range inputs. This means that all of the native interactions and accessibility features are preserved.</p><p>Native inputs allow us not to reinvent the wheel. There is about <a href="https://cdn.jsdelivr.net/npm/@stanko/dual-range-input/dist/index.js">fifty lines of JavaScript</a> to synchronize the inputs, along with some CSS to ensure everything looks polished.</p><p>In my book, that is <em>native enough</em>.</p><h2 id="why">Why<a aria-label="Anchor link for: why" title="Anchor link for: why" href="#why"> <span aria-hidden="true">#</span></a></h2><p>When I create <a href="https://muffinman.io/art">my generative drawings</a>, I use a tool I built myself. This tool includes a UI for tweaking parameters, and I often have minimum and maximum sliders for certain parameters. I thought it would be nice to have a dual-range slider for these. However, most existing solutions rely heavily on JavaScript and reimplement dragging and accessibility features.</p><p>So, I set my own set of requirements:</p><ul><li>It should use native HTML range inputs.</li><li>When you click on the track, the closer of the two thumbs should jump to that value.</li></ul><p>Hopefully, after you read these two requirements, my solution will make sense.</p><h2 id="how-it-works">How it works<a aria-label="Anchor link for: how-it-works" title="Anchor link for: how-it-works" href="#how-it-works"> <span aria-hidden="true">#</span></a></h2><p>There are two inputs placed next to each other. When either of the inputs is changed, the library calculates a midpoint between the two selected values. Then the <code>min</code> and <code>max</code> attributes are set to the midpoint, and the width of both inputs is updated to match.</p><p>Here is an unstyled example, which will hopefully illustrate this well:</p><p>Even like this, it works reasonably well. We&#39;ll style it later to make it look nicer.</p><h3 id="resizing-the-inputs">Resizing the inputs<a aria-label="Anchor link for: resizing-the-inputs" title="Anchor link for: resizing-the-inputs" href="#resizing-the-inputs"> <span aria-hidden="true">#</span></a></h3><p>There&#39;s a small trick involved in calculating input widths. This is because the range input&#39;s track is actually shorter than the input&#39;s total width. All browsers leave enough space on the sides so the thumb doesn&#39;t stick out.</p><p>Here is a screenshot from Firefox (other browsers work similarly), where you can see that the track is shorter than the width. I&#39;ve emphasized the space the browser leaves for the thumb.</p><p><img alt="Screenshot showing that the range input&#39;s track is shorter than its total width" src="https://muffinman.io/img/dual-range-input/thumb-width.png"/></p><p>If we take an example where the inputs need to be in a 1:3 ratio, simply setting their widths to 25% and 75% isn&#39;t enough. We also need to account for the thumb width. Instead of calculating the exact ratio, I simplified the math by adding the thumb width to each input&#39;s width:</p><pre data-lang="scss"><code data-lang="scss"><span><span><span>input</span><span><span><span>:</span>first-child</span></span> </span><span>{</span>
</span><span> <span><span>width</span></span><span>:</span><span> <span><span>calc</span><span><span>(</span><span>25<span>%</span></span> <span>+</span> <span><span>var</span><span><span>(</span><span><span>--</span><span>dri-thumb-width</span></span></span><span><span>)</span></span></span></span><span><span>)</span></span></span></span><span>;</span>
</span><span><span>}</span>
</span><span>
</span><span><span><span>input</span><span><span><span>:</span>last-child</span></span> </span><span>{</span>
</span><span> <span><span>width</span></span><span>:</span><span> <span><span>calc</span><span><span>(</span><span>75<span>%</span></span> <span>+</span> <span><span>var</span><span><span>(</span><span><span>--</span><span>dri-thumb-width</span></span></span><span><span>)</span></span></span></span><span><span>)</span></span></span></span><span>;</span>
</span><span><span>}</span>
</span></code></pre><p>If you thought, <em>Wait, this adds up to more than 100%</em>, you&#39;d be 100% right. That&#39;s why I applied a small trick: I added padding to the inputs&#39; wrapper to accommodate the extra width for the thumbs.</p><p><img alt="Screenshot showing padding on the wrapper to accommodate extra width" src="https://muffinman.io/img/dual-range-input/padding.png"/></p><p>This makes the math simpler while keeping the input sizing correct. It took me forever to explain this properly, and I&#39;m still not sure if I succeeded.</p><h3 id="move-the-thumb-closer-to-the-click">Move the thumb closer to the click<a aria-label="Anchor link for: move-the-thumb-closer-to-the-click" title="Anchor link for: move-the-thumb-closer-to-the-click" href="#move-the-thumb-closer-to-the-click"> <span aria-hidden="true">#</span></a></h3><p>Because the inputs are resized to meet at the midpoint, whenever you click between the thumbs, the one closer to the click will move to that value.</p><p> and the midpoint will be easier to see.</p><p>If there&#39;s an odd number of steps between the thumbs, the last-used input is favored. Try it out with debug mode on, and you&#39;ll see what I mean.</p><p>With that, both requirements are satisfied. The only thing left is to style it properly.</p><h2 id="styling">Styling<a aria-label="Anchor link for: styling" title="Anchor link for: styling" href="#styling"> <span aria-hidden="true">#</span></a></h2><p>All browsers allow us to style range inputs using CSS. That made styling of the tracks and thumbs pretty straightforward. I just ensured that the tracks didn&#39;t have a border radius in the middle where they connect.</p><h3 id="theming">Theming<a aria-label="Anchor link for: theming" title="Anchor link for: theming" href="#theming"> <span aria-hidden="true">#</span></a></h3><p>I exposed several variables to make theming easier. Here&#39;s the complete list with their default values:</p><pre data-lang="scss"><code data-lang="scss"><span><span><span><span>.</span></span><span>dual-range-input</span> </span><span>{</span>
</span><span>  <span><span><span>--</span><span>dri-height</span></span></span><span>:</span><span> <span>1<span>.</span>5<span>rem</span></span></span><span>;</span>
</span><span>
</span><span>  <span><span><span>--</span><span>dri-thumb-width</span></span></span><span>:</span><span> <span>1<span>.</span>25<span>rem</span></span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-thumb-height</span></span></span><span>:</span><span> <span>1<span>.</span>25<span>rem</span></span></span><span>;</span>
</span><span>
</span><span>  <span><span><span>--</span><span>dri-thumb-color</span></span></span><span>:</span><span> <span><span>#</span>ddd</span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-thumb-hover-color</span></span></span><span>:</span><span> <span><span>#</span>a8d5ff</span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-thumb-active-color</span></span></span><span>:</span><span> <span><span>#</span>4eaaff</span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-thumb-border-color</span></span></span><span>:</span><span> <span><span>rgba</span><span><span>(</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>0<span>.</span>1</span></span><span><span>)</span></span></span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-thumb-border-radius</span></span></span><span>:</span><span> <span>1<span>rem</span></span></span><span>;</span>
</span><span>
</span><span>  <span><span><span>--</span><span>dri-track-height</span></span></span><span>:</span><span> <span>0</span><span><span>.</span>25<span>rem</span></span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-track-color</span></span></span><span>:</span><span> <span><span>#</span>ccc</span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-track-filled-color</span></span></span><span>:</span><span> <span><span>#</span>0084ff</span></span><span>;</span>
</span><span>  <span><span><span>--</span><span>dri-track-border-radius</span></span></span><span>:</span><span> <span>1<span>rem</span></span></span><span>;</span>
</span><span><span>}</span>
</span></code></pre><p>To create your own theme, simply override these variables.</p><h3 id="gradients">Gradients<a aria-label="Anchor link for: gradients" title="Anchor link for: gradients" href="#gradients"> <span aria-hidden="true">#</span></a></h3><p>One thing I thought was cool is how I used CSS gradients to paint the selected range in both inputs. I set the gradients to use the <code>--dri-gradient-position</code> variable, then updated that variable in the code along with the widths.</p><p>Here&#39;s how the CSS looks for one of the inputs:</p><pre data-lang="scss"><code data-lang="scss"><span><span><span>input</span><span><span><span>:</span>first-child</span></span><span><span>::</span><span>-moz-</span>range-track</span> </span><span>{</span>
</span><span>  <span><span>background-image</span></span><span>:</span><span> <span><span>linear-gradient</span><span><span>(</span>
</span></span></span></span><span><span><span><span>    <span>to</span> <span>right</span><span>,</span>
</span></span></span></span><span><span><span><span>    <span><span>var</span><span><span>(</span><span><span>--</span><span>dri-track-color</span></span></span><span><span>)</span></span></span> <span><span>var</span><span><span>(</span><span><span>--</span><span>dri-gradient-position</span></span></span><span><span>)</span></span></span><span>,</span>
</span></span></span></span><span><span><span><span>    <span><span>var</span><span><span>(</span><span><span>--</span><span>dri-track-filled-color</span></span></span><span><span>)</span></span></span> <span><span>var</span><span><span>(</span><span><span>--</span><span>dri-gradient-position</span></span></span><span><span>)</span></span></span>
</span></span></span></span><span><span><span><span>  </span><span><span>)</span></span></span></span><span>;</span>
</span><span><span>}</span>
</span></code></pre><p>Again,  and the semi-transparent thumbs will make the gradients easier to see.</p><h2 id="conclusion">Conclusion<a aria-label="Anchor link for: conclusion" title="Anchor link for: conclusion" href="#conclusion"> <span aria-hidden="true">#</span></a></h2><p>I had to write this post as <del>a brain dump</del> a way to consolidate my thoughts, so I hope it&#39;s not too convoluted.</p><p>Thank you for following along, and I hope this inspires you to try it out and consider using more native elements before opting for custom libraries.</p></div></div></section></div></div>
  </body>
</html>
