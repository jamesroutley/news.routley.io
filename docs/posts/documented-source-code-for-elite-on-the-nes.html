<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/markmoxon/nes-elite-beebasm">Original</a>
    <h1>Documented source code for Elite on the NES</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://github.com/markmoxon/cassette-elite-beebasm">BBC Micro (cassette)</a> | <a href="https://github.com/markmoxon/disc-elite-beebasm">BBC Micro (disc)</a> | <a href="https://github.com/markmoxon/6502sp-elite-beebasm">6502 Second Processor</a> | <a href="https://github.com/markmoxon/master-elite-beebasm">BBC Master</a> | <a href="https://github.com/markmoxon/electron-elite-beebasm">Acorn Electron</a> | <a href="https://github.com/markmoxon/elite-a-beebasm">Elite-A</a> | <strong>NES</strong></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/94fa2714bfdbcffcfc5c917f6f2751344020c5f2cc4f0582fdbc87117dfce6f1/68747470733a2f2f7777772e626263656c6974652e636f6d2f696d616765732f6769746875622f6e65732d73746174696f6e2e706e67"><img src="https://camo.githubusercontent.com/94fa2714bfdbcffcfc5c917f6f2751344020c5f2cc4f0582fdbc87117dfce6f1/68747470733a2f2f7777772e626263656c6974652e636f6d2f696d616765732f6769746875622f6e65732d73746174696f6e2e706e67" alt="Screenshot of Elite on the NES" data-canonical-src="https://www.bbcelite.com/images/github/nes-station.png"/></a></p>
<p dir="auto">This repository contains source code for Elite on the Nintendo Entertainment System (NES), with every single line documented and (for the most part) explained.</p>
<p dir="auto">It is a companion to the <a href="https://www.bbcelite.com" rel="nofollow">bbcelite.com website</a>.</p>
<p dir="auto">See the <a href="#introduction">introduction</a> for more information, or jump straight into the <a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/1-source-files/main-sources">documented source code</a>.</p>
<h2 tabindex="-1" id="user-content-contents" dir="auto"><a href="#contents">Contents<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<ul dir="auto">
<li>
<p dir="auto"><a href="#introduction">Introduction</a></p>
</li>
<li>
<p dir="auto"><a href="#acknowledgements">Acknowledgements</a></p>
<ul dir="auto">
<li><a href="#user-content-a-note-on-licences-copyright-etc">A note on licences, copyright etc.</a></li>
</ul>
</li>
<li>
<p dir="auto"><a href="#browsing-the-source-in-an-ide">Browsing the source in an IDE</a></p>
</li>
<li>
<p dir="auto"><a href="#folder-structure">Folder structure</a></p>
</li>
<li>
<p dir="auto"><a href="#building-elite-from-the-source">Building Elite from the source</a></p>
<ul dir="auto">
<li><a href="#requirements">Requirements</a></li>
<li><a href="#build-targets">Build targets</a></li>
<li><a href="#windows">Windows</a></li>
<li><a href="#mac-and-linux">Mac and Linux</a></li>
<li><a href="#verifying-the-output">Verifying the output</a></li>
<li><a href="#log-files">Log files</a></li>
</ul>
</li>
<li>
<p dir="auto"><a href="#building-different-variants-of-nes-elite">Building different variants of NES Elite</a></p>
<ul dir="auto">
<li><a href="#building-the-ntsc-variant">Building the NTSC variant</a></li>
<li><a href="#building-the-pal-variant">Building the PAL variant</a></li>
<li><a href="#differences-between-the-variants">Differences between the variants</a></li>
</ul>
</li>
</ul>
<h2 tabindex="-1" id="user-content-introduction" dir="auto"><a href="#introduction">Introduction<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">This repository contains source code for Elite on the NES, with every single line documented and (for the most part) explained.</p>
<p dir="auto">You can build the fully functioning game from this source. <a href="#building-different-variants-of-nes-elite">Two variants</a> are currently supported: the NTSC version from Ian Bell&#39;s personal website, and the Imagineer PAL release.</p>

<ul dir="auto">
<li>
<p dir="auto">If you want to explore the source code, then the <a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/1-source-files/main-sources">annotated source</a> is what you&#39;re looking for. You might also like to read the section on <a href="#browsing-the-source-in-an-ide">Browsing the source in an IDE</a> for some tips.</p>
</li>
<li>
<p dir="auto">If you want to build Elite from the source on a modern computer, to produce a working ROM image that can be loaded into a real NES or an emulator, then you want the section on <a href="#building-elite-from-the-source">Building Elite from the source</a>.</p>
</li>
</ul>
<p dir="auto">My hope is that this repository and the <a href="https://www.bbcelite.com" rel="nofollow">accompanying website</a> will be useful for those who want to learn more about Elite and what makes it tick. It is provided on an educational and non-profit basis, with the aim of helping people appreciate one of the most iconic games of the 8-bit era.</p>
<h2 tabindex="-1" id="user-content-acknowledgements" dir="auto"><a href="#acknowledgements">Acknowledgements<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">NES Elite was written by Ian Bell and David Braben and is copyright © D. Braben and I. Bell 1991/1992.</p>
<p dir="auto">The code on this site has been reconstructed from a disassembly of the version released on <a href="http://www.elitehomepage.org/" rel="nofollow">Ian Bell&#39;s personal website</a>.</p>
<p dir="auto">The commentary is copyright © Mark Moxon. Any misunderstandings or mistakes in the documentation are entirely my fault.</p>
<p dir="auto">Huge thanks are due to the original authors for not only creating such an important piece of my childhood, but also for releasing the source code for us to play with; to Paul Brink for his annotated disassembly; and to Kieran Connell for his <a href="https://github.com/kieranhj/elite-beebasm">BeebAsm version</a>, which I forked as the original basis for this project. You can find more information about this project in the <a href="https://www.bbcelite.com/about_site/about_this_project.html" rel="nofollow">accompanying website&#39;s project page</a>.</p>
<p dir="auto">The following archive from Ian Bell&#39;s personal website forms the basis for this project:</p>
<ul dir="auto">
<li><a href="http://www.elitehomepage.org/archive/a/b7120500.zip" rel="nofollow">NES Elite, NTSC version</a></li>
</ul>
<h3 tabindex="-1" id="user-content-a-note-on-licences-copyright-etc" dir="auto"><a href="#a-note-on-licences-copyright-etc">A note on licences, copyright etc.<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">This repository is <em>not</em> provided with a licence, and there is intentionally no <code>LICENSE</code> file provided.</p>
<p dir="auto">According to <a href="https://docs.github.com/en/free-pro-team@latest/github/creating-cloning-and-archiving-repositories/licensing-a-repository">GitHub&#39;s licensing documentation</a>, this means that &#34;the default copyright laws apply, meaning that you retain all rights to your source code and no one may reproduce, distribute, or create derivative works from your work&#34;.</p>
<p dir="auto">The reason for this is that my commentary is intertwined with the original Elite source code, and the original source code is copyright. The whole site is therefore covered by default copyright law, to ensure that this copyright is respected.</p>
<p dir="auto">Under GitHub&#39;s rules, you have the right to read and fork this repository... but that&#39;s it. No other use is permitted, I&#39;m afraid.</p>
<p dir="auto">My hope is that the educational and non-profit intentions of this repository will enable it to stay hosted and available, but the original copyright holders do have the right to ask for it to be taken down, in which case I will comply without hesitation. I do hope, though, that along with the various other disassemblies and commentaries of this source, it will remain viable.</p>
<h2 tabindex="-1" id="user-content-browsing-the-source-in-an-ide" dir="auto"><a href="#browsing-the-source-in-an-ide">Browsing the source in an IDE<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">If you want to browse the source in an IDE, you might find the following useful.</p>
<ul dir="auto">
<li>
<p dir="auto">The main game&#39;s source code is split across eight different ROM banks, which you can find in the <a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/1-source-files/main-sources">main-sources</a> folder. This is the motherlode and probably contains all the stuff you&#39;re interested in.</p>
</li>
<li>
<p dir="auto">It&#39;s probably worth skimming through the <a href="https://www.bbcelite.com/about_site/terminology_used_in_this_commentary.html" rel="nofollow">notes on terminology and notations</a> on the accompanying website, as this explains a number of terms used in the commentary, without which it might be a bit tricky to follow at times (in particular, you should understand the terminology I use for multi-byte numbers).</p>
</li>
<li>
<p dir="auto">The accompanying website contains <a href="https://www.bbcelite.com/deep_dives/" rel="nofollow">a number of &#34;deep dive&#34; articles</a>, each of which goes into an aspect of the game in detail. Routines that are explained further in these articles are tagged with the label <code>Deep dive:</code> and the relevant article name.</p>
</li>
<li>
<p dir="auto">There are loads of routines and variables in Elite - literally hundreds. You can find them in the source files by searching for the following: <code>Type: Subroutine</code>, <code>Type: Variable</code>, <code>Type: Workspace</code> and <code>Type: Macro</code>.</p>
</li>
<li>
<p dir="auto">If you know the name of a routine, you can find it by searching for <code>Name: &lt;name&gt;</code>, as in <code>Name: SCAN</code> (for the 3D scanner routine) or <code>Name: LL9</code> (for the ship-drawing routine).</p>
</li>
<li>
<p dir="auto">The entry point for the main game code is the <code>BEGIN</code> routine in <a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/1-source-files/main-sources/elite-source-bank-7.asm">bank 7</a>, which you can find by searching for <code>Name: BEGIN</code>. If you want to follow the program flow all the way from the title screen around the main game loop, then you can find a number of <a href="https://www.bbcelite.com/deep_dives/" rel="nofollow">deep dives on program flow</a> on the accompanying website.</p>
</li>
<li>
<p dir="auto">The source code is designed to be read at an 80-column width and with a monospaced font, just like in the good old days.</p>
</li>
</ul>
<p dir="auto">I hope you enjoy exploring the inner workings of NES Elite as much as I have.</p>
<h2 tabindex="-1" id="user-content-folder-structure" dir="auto"><a href="#folder-structure">Folder structure<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">There are five main folders in this repository, which reflect the order of the build process.</p>
<ul dir="auto">
<li>
<p dir="auto"><a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/1-source-files">1-source-files</a> contains all the different source files, such as the main assembler source files, image binaries, fonts and so on.</p>
</li>
<li>
<p dir="auto"><a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/2-build-files">2-build-files</a> contains build-related scripts, such as the crc32 verification scripts.</p>
</li>
<li>
<p dir="auto"><a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/3-assembled-output">3-assembled-output</a> contains the output from the assembly process, when the source files are assembled and the results processed by the build files.</p>
</li>
<li>
<p dir="auto"><a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/4-reference-binaries">4-reference-binaries</a> contains the correct binaries for each variant, so we can verify that our assembled output matches the reference.</p>
</li>
<li>
<p dir="auto"><a href="https://github.com/markmoxon/nes-elite-beebasm/blob/main/5-compiled-game-discs">5-compiled-game-discs</a> contains the final output of the build process: an iNES ROM image that contains the compiled game and which can be run on real hardware or in an emulator.</p>
</li>
</ul>
<h2 tabindex="-1" id="user-content-building-elite-from-the-source" dir="auto"><a href="#building-elite-from-the-source">Building Elite from the source<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<h3 tabindex="-1" id="user-content-requirements" dir="auto"><a href="#requirements">Requirements<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">You will need the following to build Elite from the source:</p>
<ul dir="auto">
<li>
<p dir="auto">BeebAsm, which can be downloaded from the <a href="https://github.com/stardot/beebasm">BeebAsm repository</a>. Mac and Linux users will have to build their own executable with <code>make code</code>, while Windows users can just download the <code>beebasm.exe</code> file.</p>
</li>
<li>
<p dir="auto">Python. Both versions 2.7 and 3.x should work.</p>
</li>
<li>
<p dir="auto">Mac and Linux users may need to install <code>make</code> if it isn&#39;t already present (for Windows users, <code>make.exe</code> is included in this repository).</p>
</li>
</ul>
<p dir="auto">For details of how the build process works, see the <a href="https://www.bbcelite.com/about_site/building_elite.html" rel="nofollow">build documentation on bbcelite.com</a>.</p>
<p dir="auto">Let&#39;s look at how to build Elite from the source.</p>
<h3 tabindex="-1" id="user-content-build-targets" dir="auto"><a href="#build-targets">Build targets<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">There are two main build targets available. They are:</p>
<ul dir="auto">
<li><code>build</code> - A version with a maxed-out commander</li>
<li><code>encrypt</code> - A version that exactly matches the released version of the game</li>
</ul>
<p dir="auto">Unlike the Acornsoft versions of Elite on which it is based, the NES version is not encrypted, so there is no difference in encryption between the two targets. I have used the same target names for consistency, but the only difference is in the commander file.</p>
<p dir="auto">Builds are supported for both Windows and Mac/Linux systems. In all cases the build process is defined in the <code>Makefile</code> provided.</p>
<h3 tabindex="-1" id="user-content-windows" dir="auto"><a href="#windows">Windows<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">For Windows users, there is a batch file called <code>make.bat</code> to which you can pass one of the build targets above. Before this will work, you should edit the batch file and change the values of the <code>BEEBASM</code> and <code>PYTHON</code> variables to point to the locations of your <code>beebasm.exe</code> and <code>python.exe</code> executables. You also need to change directory to the repository folder (i.e. the same folder as <code>make.bat</code>).</p>
<p dir="auto">All being well, doing one of the following:</p>


<p dir="auto">will produce a file called <code>elite-ntsc.NES</code> in the <code>5-compiled-game-discs</code> folder that contains the NTSC release, which you can then load into an emulator, or into a real NES using a flash cart.</p>
<h3 tabindex="-1" id="user-content-mac-and-linux" dir="auto"><a href="#mac-and-linux">Mac and Linux<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The build process uses a standard GNU <code>Makefile</code>, so you just need to install <code>make</code> if your system doesn&#39;t already have it. If BeebAsm or Python are not on your path, then you can either fix this, or you can edit the <code>Makefile</code> and change the <code>BEEBASM</code> and <code>PYTHON</code> variables in the first two lines to point to their locations. You also need to change directory to the repository folder (i.e. the same folder as <code>Makefile</code>).</p>
<p dir="auto">All being well, doing one of the following:</p>


<p dir="auto">will produce a file called <code>elite-ntsc.NES</code> in the <code>5-compiled-game-discs</code> folder that contains the NTSC release, which you can then load into an emulator, or into a real NES using a flash cart.</p>
<h3 tabindex="-1" id="user-content-verifying-the-output" dir="auto"><a href="#verifying-the-output">Verifying the output<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">The build process also supports a verification target that prints out checksums of all the generated files, along with the checksums of the files from the original sources.</p>
<p dir="auto">You can run this verification step on its own, or you can run it once a build has finished. To run it on its own, use the following command on Windows:</p>

<p dir="auto">or on Mac/Linux:</p>

<p dir="auto">To run a build and then verify the results, you can add two targets, like this on Windows:</p>

<p dir="auto">or this on Mac/Linux:</p>

<p dir="auto">The Python script <code>crc32.py</code> in the <code>2-build-files</code> folder does the actual verification, and shows the checksums and file sizes of both sets of files, alongside each other, and with a Match column that flags any discrepancies. If you are building an unencrypted set of files then there will be lots of differences, while the encrypted files should mostly match (see the Differences section below for more on this).</p>
<p dir="auto">The binaries in the <code>4-reference-binaries</code> folder are those extracted from the released version of the game, while those in the <code>3-assembled-output</code> folder are produced by the build process. For example, if you don&#39;t make any changes to the code and build the project with <code>make encrypt verify</code>, then this is the output of the verification process:</p>
<div data-snippet-clipboard-copy-content="Results for variant: pal
[--originals--]  [---output----]
Checksum    Size  Checksum    Size  Match  Filename
-----------------------------------------------------
6a32bd20   16384  6a32bd20   16384   Yes   bank0.bin
1840f774   16384  1840f774   16384   Yes   bank1.bin
e08fa78a   16384  e08fa78a   16384   Yes   bank2.bin
e07c0f21   16384  e07c0f21   16384   Yes   bank3.bin
731cd900   16384  731cd900   16384   Yes   bank4.bin
fee7480c   16384  fee7480c   16384   Yes   bank5.bin
500f28cd   16384  500f28cd   16384   Yes   bank6.bin
8e1162f8   16384  8e1162f8   16384   Yes   bank7.bin
4cf12d39  131088  4cf12d39  131088   Yes   elite.bin
eb5e8763      16  eb5e8763      16   Yes   header.bin"><pre><code>Results for variant: pal
[--originals--]  [---output----]
Checksum    Size  Checksum    Size  Match  Filename
-----------------------------------------------------
6a32bd20   16384  6a32bd20   16384   Yes   bank0.bin
1840f774   16384  1840f774   16384   Yes   bank1.bin
e08fa78a   16384  e08fa78a   16384   Yes   bank2.bin
e07c0f21   16384  e07c0f21   16384   Yes   bank3.bin
731cd900   16384  731cd900   16384   Yes   bank4.bin
fee7480c   16384  fee7480c   16384   Yes   bank5.bin
500f28cd   16384  500f28cd   16384   Yes   bank6.bin
8e1162f8   16384  8e1162f8   16384   Yes   bank7.bin
4cf12d39  131088  4cf12d39  131088   Yes   elite.bin
eb5e8763      16  eb5e8763      16   Yes   header.bin
</code></pre></div>
<p dir="auto">All the compiled binaries match the originals, so we know we are producing the same final game as the release version.</p>
<h3 tabindex="-1" id="user-content-log-files" dir="auto"><a href="#log-files">Log files<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">During compilation, details of every step are output in nine files called <code>compile.txt</code> (for the header) or <code>compile0.txt</code> through <code>compile7.txt</code> (for banks 0 to 7) in the <code>3-assembled-output</code> folder. If you have problems, these might come in handy, and they&#39;re a great reference if you need to know the addresses of labels and variables for debugging (or just snooping around).</p>
<h2 tabindex="-1" id="user-content-building-different-variants-of-nes-elite" dir="auto"><a href="#building-different-variants-of-nes-elite">Building different variants of NES Elite<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h2>
<p dir="auto">This repository contains the source code for two different variants of NES Elite:</p>
<ul dir="auto">
<li>
<p dir="auto">The NTSC version from Ian Bell&#39;s personal website</p>
</li>
<li>
<p dir="auto">The Imagineer PAL release, which is the only official release of NES Elite</p>
</li>
</ul>
<p dir="auto">By default the build process builds the NTSC release, but you can build a specified variant using the <code>variant=</code> build parameter.</p>
<h3 tabindex="-1" id="user-content-building-the-ntsc-variant" dir="auto"><a href="#building-the-ntsc-variant">Building the NTSC variant<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">You can add <code>variant=ntsc</code> to produce the <code>elite-ntsc.NES</code> file that contains the NTSC variant, though that&#39;s the default value so it isn&#39;t necessary. In other words, you can build it like this:</p>
<div data-snippet-clipboard-copy-content="make.bat encrypt verify variant=ntsc"><pre><code>make.bat encrypt verify variant=ntsc
</code></pre></div>
<p dir="auto">or this on a Mac or Linux:</p>
<div data-snippet-clipboard-copy-content="make encrypt verify variant=ntsc"><pre><code>make encrypt verify variant=ntsc
</code></pre></div>
<p dir="auto">This will produce a file called <code>elite-ntsc.NES</code> in the <code>5-compiled-game-discs</code> folder that contains the NTSC variant.</p>
<p dir="auto">The verification checksums for this version are as follows:</p>
<div data-snippet-clipboard-copy-content="Results for variant: ntsc
[--originals--]  [---output----]
Checksum    Size  Checksum    Size  Match  Filename
-----------------------------------------------------
0560a52b   16384  0560a52b   16384   Yes   bank0.bin
c1239b33   16384  c1239b33   16384   Yes   bank1.bin
5e6c3bfb   16384  5e6c3bfb   16384   Yes   bank2.bin
54df916d   16384  54df916d   16384   Yes   bank3.bin
5953c5d4   16384  5953c5d4   16384   Yes   bank4.bin
0dd49e0c   16384  0dd49e0c   16384   Yes   bank5.bin
39255d4f   16384  39255d4f   16384   Yes   bank6.bin
26f0c7de   16384  26f0c7de   16384   Yes   bank7.bin
54386491  131088  54386491  131088   Yes   elite.bin
eb5e8763      16  eb5e8763      16   Yes   header.bin"><pre><code>Results for variant: ntsc
[--originals--]  [---output----]
Checksum    Size  Checksum    Size  Match  Filename
-----------------------------------------------------
0560a52b   16384  0560a52b   16384   Yes   bank0.bin
c1239b33   16384  c1239b33   16384   Yes   bank1.bin
5e6c3bfb   16384  5e6c3bfb   16384   Yes   bank2.bin
54df916d   16384  54df916d   16384   Yes   bank3.bin
5953c5d4   16384  5953c5d4   16384   Yes   bank4.bin
0dd49e0c   16384  0dd49e0c   16384   Yes   bank5.bin
39255d4f   16384  39255d4f   16384   Yes   bank6.bin
26f0c7de   16384  26f0c7de   16384   Yes   bank7.bin
54386491  131088  54386491  131088   Yes   elite.bin
eb5e8763      16  eb5e8763      16   Yes   header.bin
</code></pre></div>
<h3 tabindex="-1" id="user-content-building-the-pal-variant" dir="auto"><a href="#building-the-pal-variant">Building the PAL variant<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">You can build the PAL variant by appending <code>variant=ntsc</code> to the <code>make</code> command, like this on Windows:</p>
<div data-snippet-clipboard-copy-content="make.bat encrypt verify variant=pal"><pre><code>make.bat encrypt verify variant=pal
</code></pre></div>
<p dir="auto">or this on a Mac or Linux:</p>
<div data-snippet-clipboard-copy-content="make encrypt verify variant=pal"><pre><code>make encrypt verify variant=pal
</code></pre></div>
<p dir="auto">This will produce a file called <code>elite-pal.NES</code> in the <code>5-compiled-game-discs</code> folder that contains the PAL variant.</p>
<p dir="auto">The verification checksums for this version are as follows:</p>
<div data-snippet-clipboard-copy-content="Results for variant: pal
[--originals--]  [---output----]
Checksum    Size  Checksum    Size  Match  Filename
-----------------------------------------------------
6a32bd20   16384  6a32bd20   16384   Yes   bank0.bin
1840f774   16384  1840f774   16384   Yes   bank1.bin
e08fa78a   16384  e08fa78a   16384   Yes   bank2.bin
e07c0f21   16384  e07c0f21   16384   Yes   bank3.bin
731cd900   16384  731cd900   16384   Yes   bank4.bin
fee7480c   16384  fee7480c   16384   Yes   bank5.bin
500f28cd   16384  500f28cd   16384   Yes   bank6.bin
8e1162f8   16384  8e1162f8   16384   Yes   bank7.bin
4cf12d39  131088  4cf12d39  131088   Yes   elite.bin
eb5e8763      16  eb5e8763      16   Yes   header.bin"><pre><code>Results for variant: pal
[--originals--]  [---output----]
Checksum    Size  Checksum    Size  Match  Filename
-----------------------------------------------------
6a32bd20   16384  6a32bd20   16384   Yes   bank0.bin
1840f774   16384  1840f774   16384   Yes   bank1.bin
e08fa78a   16384  e08fa78a   16384   Yes   bank2.bin
e07c0f21   16384  e07c0f21   16384   Yes   bank3.bin
731cd900   16384  731cd900   16384   Yes   bank4.bin
fee7480c   16384  fee7480c   16384   Yes   bank5.bin
500f28cd   16384  500f28cd   16384   Yes   bank6.bin
8e1162f8   16384  8e1162f8   16384   Yes   bank7.bin
4cf12d39  131088  4cf12d39  131088   Yes   elite.bin
eb5e8763      16  eb5e8763      16   Yes   header.bin
</code></pre></div>
<h3 tabindex="-1" id="user-content-differences-between-the-variants" dir="auto"><a href="#differences-between-the-variants">Differences between the variants<svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></h3>
<p dir="auto">You can see the differences between the variants by searching the source code for <code>_PAL</code> (for features in the PAL release) or <code>_NTSC</code> (for features in the NTSC release). The main differences in the NTSC release compared to the PAL release are:</p>
<ul dir="auto">
<li>
<p dir="auto">The two versions count a different number of cycles in the NMI handler (7433 in the PAL version, 6797 in the NTSC version).</p>
</li>
<li>
<p dir="auto">The NTSC version is missing the Imagineer and Nintendo headings from the Start screen.</p>
</li>
<li>
<p dir="auto">The PAL version waits for longer before starting auto-play on the combat demo.</p>
</li>
<li>
<p dir="auto">Each version has its own unique checksum algorithm for the save slots.</p>
</li>
<li>
<p dir="auto">The internal version number is different (the PAL version is &#34;&lt;2.8&gt;&#34; while the NTSC version is &#34;5.0&#34;)</p>
</li>
<li>
<p dir="auto">The copyright message hidden in bank 3 is different (the PAL message is &#34;NES ELITE IMAGE 2.8 - 04 MAR 1992&#34; while the NTSC message is &#34;NES ELITE IMAGE 5.2 - 24 APR 1992&#34;</p>
</li>
<li>
<p dir="auto">The first title in the combat demo scroll text is different (the PAL title is &#34;IMAGINEER PRESENTS --- E L I T E --- (C)BRABEN &amp; BELL 1991&#34; while the NTSC title is &#34;NTSC EMULATION --- E L I T E ---  (C)BELL &amp; BRABEN 1991&#34;)</p>
</li>
<li>
<p dir="auto">A number of pixel y-coordinate constants in the PAL version are six pixels bigger than in the NTSC version, to cater for the taller screen height.</p>
</li>
<li>
<p dir="auto">The interrupt vectors in banks 0 to 6 that are used during initialisation are subtly different.</p>
</li>
<li>
<p dir="auto">The code for detecting double-taps of the B button when choosing buttons from the icon bar is a bit simpler in the NTSC version.</p>
</li>
</ul>
<p dir="auto">It&#39;s worth noting that the NTSC variant doesn&#39;t actually work on an NTSC machine. The NMI timings have been changed to work with some (but not all) emulators in NTSC mode, but it isn&#39;t a full NTSC conversion, it&#39;s an NTSC emulation (as per the scroll text).</p>

<hr/>
<p dir="auto">Right on, Commanders!</p>
<p dir="auto"><em>Mark Moxon</em></p>
</article>
          </div></div>
  </body>
</html>
