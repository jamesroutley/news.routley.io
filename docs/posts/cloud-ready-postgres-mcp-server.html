<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/stuzero/pg-mcp">Original</a>
    <h1>Show HN: Cloud-Ready Postgres MCP Server</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">A Model Context Protocol (MCP) server for PostgreSQL databases with enhanced capabilities for AI agents.</p>

<p dir="auto">PG-MCP is a server implementation of the <a href="https://github.com/modelcontextprotocol/mcp">Model Context Protocol</a> for PostgreSQL databases. It provides a comprehensive API for AI agents to discover, connect to, query, and understand PostgreSQL databases through MCP&#39;s resource-oriented architecture.</p>
<p dir="auto">This implementation builds upon and extends the <a href="https://github.com/modelcontextprotocol/servers/tree/main/src/postgres">reference Postgres MCP implementation</a> with several key enhancements:</p>
<ol dir="auto">
<li><strong>Full Server Implementation</strong>: Built as a complete server with SSE transport for production use</li>
<li><strong>Multi-database Support</strong>: Connect to multiple PostgreSQL databases simultaneously</li>
<li><strong>Rich Catalog Information</strong>: Extracts and exposes table/column descriptions from the database catalog</li>
<li><strong>Extension Context</strong>: Provides detailed YAML-based knowledge about PostgreSQL extensions like PostGIS and pgvector</li>
<li><strong>Query Explanation</strong>: Includes a dedicated tool for analyzing query execution plans</li>
<li><strong>Robust Connection Management</strong>: Proper lifecycle for database connections with secure connection ID handling</li>
</ol>


<ul dir="auto">
<li><strong>Connect Tool</strong>: Register PostgreSQL connection strings and get a secure connection ID</li>
<li><strong>Disconnect Tool</strong>: Explicitly close database connections when done</li>
<li><strong>Connection Pooling</strong>: Efficient connection management with pooling</li>
</ul>

<ul dir="auto">
<li><strong>pg_query</strong>: Execute read-only SQL queries using a connection ID</li>
<li><strong>pg_explain</strong>: Analyze query execution plans in JSON format</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Schema Discovery Resources</h3><a id="user-content-schema-discovery-resources" aria-label="Permalink: Schema Discovery Resources" href="#schema-discovery-resources"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>List schemas with descriptions</li>
<li>List tables with descriptions and row counts</li>
<li>Get column details with data types and descriptions</li>
<li>View table constraints and indexes</li>
<li>Explore database extensions</li>
</ul>

<ul dir="auto">
<li>Sample table data (with pagination)</li>
<li>Get approximate row counts</li>
</ul>

<p dir="auto">Built-in contextual information for PostgreSQL extensions like:</p>
<ul dir="auto">
<li><strong>PostGIS</strong>: Spatial data types, functions, and examples</li>
<li><strong>pgvector</strong>: Vector similarity search functions and best practices</li>
</ul>
<p dir="auto">Additional extensions can be easily added via YAML config files.</p>


<ul dir="auto">
<li>Python 3.13+</li>
<li>PostgreSQL database(s)</li>
</ul>

<div dir="auto" data-snippet-clipboard-copy-content="# Clone the repository
git clone https://github.com/stuzero/pg-mcp.git
cd pg-mcp

# Build and run with Docker Compose
docker-compose up -d"><pre><span><span>#</span> Clone the repository</span>
git clone https://github.com/stuzero/pg-mcp.git
<span>cd</span> pg-mcp

<span><span>#</span> Build and run with Docker Compose</span>
docker-compose up -d</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="# Clone the repository
git clone https://github.com/stuzero/pg-mcp.git
cd pg-mcp

# Create and activate a virtual environment
python -m venv .venv
source .venv/bin/activate  # On Windows: .venv\Scripts\activate

# Install using uv
uv sync --frozen

# Run the server
python -m server.app"><pre><span><span>#</span> Clone the repository</span>
git clone https://github.com/stuzero/pg-mcp.git
<span>cd</span> pg-mcp

<span><span>#</span> Create and activate a virtual environment</span>
python -m venv .venv
<span>source</span> .venv/bin/activate  <span><span>#</span> On Windows: .venv\Scripts\activate</span>

<span><span>#</span> Install using uv</span>
uv sync --frozen

<span><span>#</span> Run the server</span>
python -m server.app</pre></div>


<p dir="auto">The repository includes test scripts to verify server functionality:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Basic server functionality test
python test.py &#34;postgresql://username:password@hostname:port/database&#34;

# Claude-powered natural language to SQL conversion
python client/claude_cli.py &#34;Show me the top 5 customers by total sales&#34;"><pre><span><span>#</span> Basic server functionality test</span>
python test.py <span><span>&#34;</span>postgresql://username:password@hostname:port/database<span>&#34;</span></span>

<span><span>#</span> Claude-powered natural language to SQL conversion</span>
python client/claude_cli.py <span><span>&#34;</span>Show me the top 5 customers by total sales<span>&#34;</span></span></pre></div>
<p dir="auto">The <code>claude_cli.py</code> script requires environment variables:</p>
<div data-snippet-clipboard-copy-content="# .env file
DATABASE_URL=postgresql://username:password@hostname:port/database
ANTHROPIC_API_KEY=your-anthropic-api-key
PG_MCP_URL=http://localhost:8000/sse"><pre><code># .env file
DATABASE_URL=postgresql://username:password@hostname:port/database
ANTHROPIC_API_KEY=your-anthropic-api-key
PG_MCP_URL=http://localhost:8000/sse
</code></pre></div>

<p dir="auto">Example prompt for use with agents:</p>
<div data-snippet-clipboard-copy-content="Use the PostgreSQL MCP server to analyze the database. 
Available tools:
- connect: Register a database connection string and get a connection ID
- disconnect: Close a database connection
- pg_query: Execute SQL queries using a connection ID
- pg_explain: Get query execution plans

You can explore schema resources via:
pgmcp://{conn_id}/schemas
pgmcp://{conn_id}/schemas/{schema}/tables
pgmcp://{conn_id}/schemas/{schema}/tables/{table}/columns"><pre><code>Use the PostgreSQL MCP server to analyze the database. 
Available tools:
- connect: Register a database connection string and get a connection ID
- disconnect: Close a database connection
- pg_query: Execute SQL queries using a connection ID
- pg_explain: Get query execution plans

You can explore schema resources via:
pgmcp://{conn_id}/schemas
pgmcp://{conn_id}/schemas/{schema}/tables
pgmcp://{conn_id}/schemas/{schema}/tables/{table}/columns
</code></pre></div>

<p dir="auto">This server is built on:</p>
<ul dir="auto">
<li><strong>MCP</strong>: The Model Context Protocol foundation</li>
<li><strong>FastMCP</strong>: Python library for MCP</li>
<li><strong>asyncpg</strong>: Asynchronous PostgreSQL client</li>
<li><strong>YAML</strong>: For extension context information</li>
</ul>

<ul dir="auto">
<li>The server runs in read-only mode by default (enforced via transaction settings)</li>
<li>Connection details are never exposed in resource URLs, only opaque connection IDs</li>
<li>Database credentials only need to be sent once during the initial connection</li>
</ul>

<p dir="auto">Contributions are welcome! Areas for expansion:</p>
<ul dir="auto">
<li>Additional PostgreSQL extension context files</li>
<li>More schema introspection resources</li>
<li>Query optimization suggestions</li>
</ul>
</article></div></div>
  </body>
</html>
