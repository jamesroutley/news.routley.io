<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://brave.com/privacy-updates/36-adblock-memory-reduction/">Original</a>
    <h1>Brave overhauled its Rust adblock engine with FlatBuffers, cutting memory 75%</h1>
    
    <div id="readability-page-1" class="page"><div>
            
            
  <article>
    

<header>

    
        
        
    </header>

    

    <section>
      
  










<p><em>This is the 36th post in an <a href="https://brave.com/privacy-updates/">ongoing series</a> describing new privacy features in Brave. This post describes work done by Mikhail Atuchin (Sr. Staff Engineer), Pavel Beloborodov (Sr. Software Engineer) and Anton Lazarev (Staff Adblock Engineer). It was written by Shivan Kaul Sahib (VP, Privacy and Security).</em></p>
<p>Brave has overhauled its Rust-based <a href="https://github.com/brave/adblock-rust/" target="_blank" rel="noopener">adblock engine</a> to reduce memory consumption by 75%, bringing better battery life and smoother multitasking to all users. The upgrade represents roughly 45 MB of memory savings for the Brave browser on <em>every platform</em> (Android, iOS and desktop) <em>by default</em>, and scales even higher for users with additional adblocking lists enabled. These performance boosts are live in Brave v1.85, with additional optimizations coming in v1.86.</p>






    








    


    




    
    



<figure>
    <picture>
      <source srcset="/static-assets/images/optimized/privacy-updates/images/36-memory-reduction.webp" type="image/webp"/>
      <img src="https://brave.com/static-assets/images/optimized/privacy-updates/images/36-memory-reduction.jpg" alt="Screenshot comparison of versions 1.79.118 and 1.85.118 of Brave, demonstrating a drop in memory consumption from 162 MB to 104 MB." loading="lazy"/>
    </picture>
    
      <figcaption>
        Screenshot comparison of versions 1.79.118 and 1.85.118 of Brave, demonstrating a drop in memory consumption from 162 MB to 104 MB.
      </figcaption>
    
</figure> 
<p>As announced in <a href="https://x.com/brave/status/1935716280121610485" target="_blank" rel="noopener">June</a> and <a href="https://x.com/brave/status/1984338120297562336" target="_blank" rel="noopener">October</a> last year, we achieved this major memory milestone by iteratively refactoring the <a href="https://github.com/brave/adblock-rust/" target="_blank" rel="noopener">adblock-rust</a> engine to use <a href="https://crates.io/crates/flatbuffers" target="_blank" rel="noopener">FlatBuffers</a>, a compact and efficient storage format. This architectural transition allowed us to move the roughly 100,000 adblock filters shipped by default from standard, heap-allocated Rust data structures (such as Vecs, HashMaps, and structs) into a specialized, zero-copy binary format. </p>
<p>Along the way, we completed several other key performance optimizations (some of these are coming in v1.86):</p>
<ol>
<li><a href="https://github.com/brave/adblock-rust/pull/573/" target="_blank" rel="noopener">Memory management</a>: Used stack-allocated vectors to reduce memory allocations by 19% and improved building time by ~15%.</li>
<li><a href="https://github.com/brave/adblock-rust/pull/554/" target="_blank" rel="noopener">Matching speed</a>: Improved filter matching performance by 13% by tokenizing common regex patterns.</li>
<li><a href="https://github.com/brave/adblock-rust/pull/526" target="_blank" rel="noopener">Sharing resources</a>: Resources are shared between instantiations of adblock engines, saving ~2 MB of memory on desktop.</li>
<li><a href="https://github.com/brave/adblock-rust/pull/517" target="_blank" rel="noopener">Storage efficiency</a>: Optimized internal resource storage memory by 30%.</li>
</ol>
<p>Saving 45+ MB of memory is a significant milestone in the world of browser performance and a massive win for users on mobile and older hardware. While Brave <a href="https://brave.com/blog/brave-android-one-eight-zero-plus-performance/">already improves performance</a> on the Web by blocking invasive ads and trackers, our latest engineering effort ensures that our own built-in protections are as lightweight and invisible as possible. Unlike adblocking in other browsers, Brave’s <a href="https://github.com/brave/adblock-rust/" target="_blank" rel="noopener">adblocking engine</a> is <a href="https://brave.com/blog/improved-ad-blocker-performance/">built into the browser</a> and maintained by our privacy team. Such deep optimizations are impossible for extension-based blockers, which are restricted by browser extension APIs and sandboxing. This native architecture is also why Brave’s own ad and tracker blocking is entirely unaffected by <a href="https://brave.com/blog/brave-shields-manifest-v3/">Manifest V3</a>.</p>
<p>This performance boost is the culmination of several months of in-depth cross-team engineering work between our performance and privacy teams. It marks a significant leap in the browser’s efficiency and ensures that we continue shipping best-in-class privacy to over <a href="https://brave.com/blog/100m-mau/">100 million users</a>.</p>

</section>

    

    
  </article>
    <section>
      
    <h2>Related articles</h2>
    </section>
  

        </div></div>
  </body>
</html>
