<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://brandur.org/atoms/gubk5w2">Original</a>
    <h1>First Contact with SQLite</h1>
    
    <div id="readability-page-1" class="page"><div>
            <div>
                <a href="https://brandur.org/atoms/gubk5w2">
                    
                </a>
                <p>I’ve been playing around with SQLite the last couple of days. I thought I knew a little about SQLite, but I didn’t, and am getting my remedial education through an accelerated gauntlet. Some of what I’ve learned of its quirks has left me reeling.</p>

<p>Top surprises:</p>

<ul>
<li><p><code>ALTER COLUMN</code> is not supported. Official recommendation for changing a column? Make a new table.</p></li>

<li><p><code>DROP CONSTRAINT</code> is not supported. Official recommendation for removing a constraint? Make a new table.</p></li>

<li><p>SQLite doesn’t have data types on columns. Data types (and there are only five) are on values only, so anything can go anywhere.</p></li>

<li><p>If you ask for a column with an unsupported/non-existent type, it happily does the wrong thing without warning or error. I was raising a schema like <code>CREATE TABLE my_table (id bigserial, messages jsonb[])</code>, which seemed to be working, so I mistakenly thought for the first day that SQLite supported serials and arrays. It does not.</p></li>

<li><p>You can use <code>CREATE TABLE my_table (...) STRICT</code> to only allow one of the five supported types: <code>integer</code>, <code>real</code>, <code>text</code>, <code>blob</code>, <code>any</code>.</p></li>

<li><p>There was a lot of recent fanfare about SQLite’s new support for <code>jsonb</code>. Unlike in Postgres, <code>jsonb</code> is not actually a data type, but rather a format that’s input and output to and from built-in <code>jsonb*</code> functions. When persisted, it’s one of the big five: <code>blob</code>.</p></li>

<li><p>Other fairly critical types are also missing. e.g. There’s nothing like <code>timestamptz</code>. If you want a date/time, you store is as a Unix timestamp <code>integer</code> or ISO8601-formatted <code>string</code>, and a number of built-in functions are provided to work with those.</p></li>
</ul>

<p>SQLite has some impressive features around streaming which I’m looking forward to playing with, but the initial DX experience has certainly been a little jarring.</p>

<p>On off days, I sometimes wonder if I’m bought into some narratives too strongly. Like, is Postgres <em>really</em> the world’s best database? Experiences like this certainly cement my conviction. Yes, it is.</p>

            </div></div></div>
  </body>
</html>
