<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.pastly.net/posts/2022-11-09-tor-is-not-just-for-anonymity/">Original</a>
    <h1>Tor is not just for anonymity</h1>
    
    <div id="readability-page-1" class="page"><div>
				


				<h2 id="preamble">Preamble</h2>
<p>Anonymity, privacy, and security. All good things, you&#39;ll agree if you&#39;re
reading this post. But what we can&#39;t all quite agree on is where one stops and
the next begins.</p>
<p>It is my opinion that security is an umbrella term: a more general word that
encompasses both of the others. Everything that makes you more anonymous (or
private) also makes you more secure.</p>
<p>There is a notion that comes up every now and then that Tor doesn&#39;t make you
more secure, but it only makes you anonymous. This is obviously not true under
my definitions of the terms (if it makes you anonymous, it <em>by definition of
the words</em> must also make you more secure). But here I&#39;ll strive to convince
you that even if you disagree with my definitions, there are benefits to Tor
onion services that cannot be construed as anonymity.</p>
<h2 id="the-setup">The setup</h2>
<p>The framing for this is two scenarios. Either you (1) visit a website on the
regular web using TLS (HTTPS), or (2) visit a regular onion service.
Everything in both scenarios is setup in a typical/sane way. Here are the
assumptions:</p>
<ul>
<li>The onion service is a regular 6 hop one. It is not setup to use the
non-anonymous 3 hop design.</li>
<li>The user&#39;s and server&#39;s Tor clients are extremely close to the end point
software such that for the purpose of discussion here, they <em>are</em> the end
point software.</li>
<li>The regular website uses TLS in a typical way. A reputable Certificate
Authority (CA) is used, sane ciphers are used, and TLS 1.2 or 1.3 is used.</li>
<li>DNSSEC is not used. Effectively no one uses it, and if they do, not fully
correctly.</li>
<li>DNS over HTTPS is not used. If it is, then it&#39;s still vulnerable to attacks
on TLS and the DNS server changing or censoring results.</li>
<li>There are no security destroying bugs in TLS libraries or in the relevant
parts of Tor code.</li>
<li>Encryption algorithms are not broken. AES is secure, as is whatever the TLS
client/server negotiate. Crypto is not a weak link.</li>
</ul>
<p>Tor onion services are not limited to being HTTP servers (they could be IRC,
SMTP, or any other TCP-based daemon), but in this post we ignore everything but
HTTP servers.</p>
<h2 id="tor-benefits-that-id-consider-anonymity">Tor benefits that I&#39;d consider anonymity</h2>
<ul>
<li>
<p>5/6ths of the path between the user and the server does not know the user. I
do not just mean the relays, but also the connections between them.</p>
</li>
<li>
<p>Similarly, 5/6ths doesn&#39;t know the destination. Well actually ...</p>
<ul>
<li>
<p>The onion service&#39;s guard can tell based on traffic patterns that it is a
guard for an onion service. Yet while the onion service&#39;s guard knows its
IP address, the guard doesn&#39;t know <em>which</em> onion service it is acting as a
guard for. This means no one knows the destination onion address. Nice! Well
actually ...</p>
</li>
<li>
<p>If the guard <em>already knows</em> the onion address (say it&#39;s a popular
publicly known address), it can perform a timing attack to confirm that it
is the guard for the onion service. And now we&#39;re back to 5/6ths of the path
doesn&#39;t known the destination.</p>
</li>
</ul>
</li>
<li>
<p>100% of the path doesn&#39;t know both.</p>
</li>
</ul>
<h2 id="tor-benefits-that-are-not-anonymity">Tor benefits that are <strong>not</strong> anonymity</h2>
<ul>
<li>
<p>DNS hijacking is impossible. DNS is simply not used.</p>
</li>
<li>
<p>The DNS-like process Tor uses is secure (find onion&#39;s Introduction Points
(IP) in the DHT, connect to an IP and to tell onion what Rendezvous Point
(RP) to use, both parties connect to RP). No one knows what onion was looked up
in the DHT: not even the relay in the DHT that held the answer. DNS is
laughably insecure compared to this. The DNS server knows everything (user,
question, and answer). If any part of the link between user and server is
insecure, that&#39;s a place everything can be determined by anybody watching. The
DNS server can forge or censor responses whenever it wants. Likewise for anyone
on an unprotected part of the link.</p>
</li>
<li>
<p>BGP hijacking is impossible. Every interaction a Tor client has with a relay
or onion service is authenticated such that you are guaranteed to be
interacting with the relay/onion that you intend to be.</p>
</li>
<li>
<p>MITM attacks are impossible. When visiting a regular website, you have to
assume the none of the 100s of CAs that you trust have maliciously or
mistakenly issued a certificate for the domain you&#39;re visiting when they
shouldn&#39;t have. There are zero places a corporate firewall can inject itself to
decrypt the traffic. There are zero places and zero parties between the Tor
clients that a MITM attack can be performed. TLS attempts this and usually
succeeds. Tor guarantees it.</p>
</li>
</ul>
<p>If it looks like you&#39;ve successfully connected to an onion service, you <em>have</em>
and you have done so securely. TLS offers no such guarantee.</p>
<h2 id="moving-on-">Moving on ...</h2>
<blockquote>
<p><em>Matt, you&#39;re just continuing to describe a reimplementation of Transport
Layer Security.</em></p>
</blockquote>
<p>No, I&#39;m not. To restate what I&#39;ve exhaustively said above:</p>
<ol>
<li>
<p>TLS isn&#39;t used in every part of the process of connecting to a regular
website. Tor makes the whole process secure.</p>
</li>
<li>
<p>TLS tries its best to ensure your link is secured, but Tor guarantees it.
With TLS you have to make assumptions you shouldn&#39;t have to make in order to
believe it is working. Or put another way: Tor requires fewer assumptions, so
Tor is more secure.</p>
</li>
</ol>
<p>Accessing Tor onion services is designed to be more secure than accessing
something over TLS.</p>
<p>TLS has patches upon patches trying to make it better: Certificate
Transparency, HSTS, OCSP ... These help! Absolutely these make TLS better and
more secure.</p>
<p>But Tor is <em>more</em> secure. <em>Every</em> onion service is secure and you make fewer
assumptions.</p>
<p>Will the next regular website you visit use HSTS? If you check after you
connect in order to determine the answer, and you find that it isn&#39;t using
HSTS, is that because you&#39;re being attacked or does the site legitimately not
use HSTS?</p>
<p>Does your browser check CT logs, and if it does, what does it do in response to
failing to find the certificate in CT logs?  Do you assume the CT lookup
process is secure? Are the parties you&#39;re communicating with misbehaving? Are
your lookups in CT logs being logged and associated with you?</p>
<p>Tor is not just for anonymity. It provides real, measurable, enumerable
security benefits over TLS.</p>

			</div></div>
  </body>
</html>
