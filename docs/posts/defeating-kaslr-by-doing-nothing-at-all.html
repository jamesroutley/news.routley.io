<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://googleprojectzero.blogspot.com/2025/11/defeating-kaslr-by-doing-nothing-at-all.html">Original</a>
    <h1>Defeating KASLR by doing nothing at all</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-8666722997910127812" itemprop="description articleBody">
<p> <i>Posted by Seth Jenkins, Project Zero</i></p><p><span id="docs-internal-guid-a6ce4139-7fff-b8dc-ab3f-d9f2ba5801dc"><p dir="ltr"><span face="Arial, sans-serif">I&#39;ve recently been researching Pixel kernel exploitation and as part of this research I found myself with an excellent arbitrary write primitive…but without a KASLR leak. As necessity is the mother of all invention, on a hunch, I started researching the Linux kernel linear mapping.</span></p><p dir="ltr"><span face="Arial, sans-serif">The linear mapping is a region in the kernel virtual address space that is a direct 1:1 unstructured representation of physical memory. Working with Jann, I learned how the kernel decided where to place this region in the virtual address space. To make it possible to analyze kernel internals on a rooted phone, Jann wrote a tool to call tracing BPF&#39;s privileged </span><span>BPF_FUNC_probe_read_kernel</span><span face="Arial, sans-serif"> helper, which by design permits arbitrary kernel reads. The code for this is available </span><a href="https://project-zero.issues.chromium.org/issues/434208461"><span face="Arial, sans-serif">here</span></a><span face="Arial, sans-serif">. The linear mapping virtual address for a given physical address is calculated by the following macro:</span><span face="Arial, sans-serif"></span></p><p dir="ltr"><span>#define</span><span> </span><span>phys_to_virt(x)</span><span>    </span><span>((unsigned</span><span> </span><span>long)((x)</span><span> </span><span>-</span><span> </span><span>PHYS_OFFSET)</span><span> </span><span>|</span><span> </span><span>PAGE_OFFSET)</span></p></span></p>
</div></div>
  </body>
</html>
