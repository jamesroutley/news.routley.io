<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/susam/mintotp">Original</a>
    <h1>MinTOTP â€“ Minimal TOTP generator in 20 lines of Python</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">MinTOTP is a minimal TOTP generator written in Python.</p>
<p dir="auto"><a href="https://donnywinston.com/susam/mintotp/blob/main/mintotp.py"><img src="https://camo.githubusercontent.com/f378d9acbdf2e4787e4bd87cd641256606bd18a1ca3a00c64142d6cae4a8b6c7/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f766965772d736f757263652d627269676874677265656e2e737667" alt="View Source" data-canonical-src="https://img.shields.io/badge/view-source-brightgreen.svg"/></a>
<a href="https://pypi.org/project/mintotp/" rel="nofollow"><img src="https://camo.githubusercontent.com/050f4b3e2cc48eba7471f1b1aab2697a77d4ba7fc67be9cfc6d1665b02c34349/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6d696e746f74702e737667" alt="PyPI Package" data-canonical-src="https://img.shields.io/pypi/v/mintotp.svg"/></a>
<a href="https://pypi.org/project/mintotp/" rel="nofollow"><img src="https://camo.githubusercontent.com/f782169e775c5997e30315f3c4c02c2f2c2bc82bff3b3879aff8f366c247dec3/68747470733a2f2f696d672e736869656c64732e696f2f707970692f646d2f6d696e746f7470" alt="PyPI Hits" data-canonical-src="https://img.shields.io/pypi/dm/mintotp"/></a>
<a href="https://donnywinston.com/susam/mintotp/blob/main/LICENSE.md"><img src="https://camo.githubusercontent.com/83d3746e5881c1867665223424263d8e604df233d0a11aae0813e0414d433943/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d626c75652e737667" alt="MIT License" data-canonical-src="https://img.shields.io/badge/license-MIT-blue.svg"/></a></p>
<h2 dir="auto"><a id="user-content-contents" aria-hidden="true" href="#contents"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Contents</h2>
<ul dir="auto">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#source-code">Source Code</a></li>
<li><a href="#install">Install</a>
<ul dir="auto">
<li><a href="#from-pypi">From PyPI</a></li>
<li><a href="#from-github">From GitHub</a></li>
</ul>
</li>
<li><a href="#get-started">Get Started</a>
<ul dir="auto">
<li><a href="#with-base32-key">With Base32 Key</a></li>
<li><a href="#with-qr-code">With QR Code</a></li>
</ul>
</li>
<li><a href="#protect-key-with-gpg">Protect Key with GPG</a>
<ul dir="auto">
<li><a href="#install-gpg">Install GPG</a></li>
<li><a href="#encrypt-base32-key-with-gpg">Encrypt Base32 Key With GPG</a></li>
<li><a href="#encrypt-qr-code-with-gpg">Encrypt QR Code With GPG</a></li>
</ul>
</li>
<li><a href="#usage">Usage</a>
<ul dir="auto">
<li><a href="#multiple-keys">Multiple Keys</a></li>
<li><a href="#command-line-arguments">Command Line Arguments</a></li>
</ul>
</li>
<li><a href="#tradeoff">Tradeoff</a></li>
<li><a href="#alternative-oath-toolkit">Alternative: OATH Toolkit</a></li>
<li><a href="#resources">Resources</a></li>
<li><a href="#license">License</a></li>
<li><a href="#thanks">Thanks</a></li>
</ul>
<h2 dir="auto"><a id="user-content-introduction" aria-hidden="true" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Introduction</h2>
<p dir="auto">TOTP stands for Time-Based One-Time Password. Many websites and services
require two-factor authentication (2FA) or multi-factor authentication
(MFA) where the user is required to present two or more pieces of
evidence:</p>
<ul dir="auto">
<li>Something only the user knows, e.g., password, passphrase, etc.</li>
<li>Something only the user has, e.g., hardware token, mobile phone, etc.</li>
<li>Something only the user is, e.g., biometrics.</li>
</ul>
<p dir="auto">A TOTP value serves as the second factor, i.e., it proves that the user
is in possession of a device (e.g., mobile phone) that contains a TOTP
secret key from which the TOTP value is generated. Usually the service
provider that provides a user&#39;s account also issues a secret key encoded
either as a Base32 string or as a QR code. This secret key is added to
an authenticator app (e.g., Google Authenticator) on a mobile device.
The app can then generate TOTP values based on the current time.
By default, it generates a new TOTP value every 30 seconds.</p>
<p dir="auto">MinTOTP is a Python tool that can be used to generate TOTP values from a
secret key. Additionally, it exposes its functionality as module-level
functions for Python developers. It can be used on any system with
Python 3.4 or later installed on it.</p>
<h2 dir="auto"><a id="user-content-source-code" aria-hidden="true" href="#source-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Source Code</h2>
<p dir="auto">At the heart of the TOTP algorithm lies the HOTP algorithm. HOTP stands
for HMAC-based One-Time Password. HMAC stands for Hash-based Message
Authentication Code. Here are the relevant RFCs to learn more about
these algorithms:</p>
<ul dir="auto">
<li><a href="https://tools.ietf.org/html/rfc2104" rel="nofollow">RFC 2104</a>: HMAC: Keyed-Hashing for Message Authentication</li>
<li><a href="https://tools.ietf.org/html/rfc4226" rel="nofollow">RFC 4226</a>: HOTP: An HMAC-Based One-Time Password Algorithm</li>
<li><a href="https://tools.ietf.org/html/rfc6238" rel="nofollow">RFC 6238</a>: TOTP: Time-Based One-Time Password Algorithm</li>
</ul>
<p dir="auto">The source code in <a href="https://donnywinston.com/susam/mintotp/blob/main/mintotp.py"><code>mintotp.py</code></a> generates TOTP values from a
secret key and current time. It&#39;s just 30 lines of code (actually 20
lines if we ignore the shebang and blank lines). There are no comments
in the code, so a brief description of the code is presented in this
section. Here is the entire code presented once again for convenience:</p>
<div dir="auto" data-snippet-clipboard-copy-content="#!/usr/bin/env python3

import base64
import hmac
import struct
import sys
import time


def hotp(key, counter, digits=6, digest=&#39;sha1&#39;):
    key = base64.b32decode(key.upper() + &#39;=&#39; * ((8 - len(key)) % 8))
    counter = struct.pack(&#39;&gt;Q&#39;, counter)
    mac = hmac.new(key, counter, digest).digest()
    offset = mac[-1] &amp; 0x0f
    binary = struct.unpack(&#39;&gt;L&#39;, mac[offset:offset+4])[0] &amp; 0x7fffffff
    return str(binary)[-digits:].zfill(digits)


def totp(key, time_step=30, digits=6, digest=&#39;sha1&#39;):
    return hotp(key, int(time.time() / time_step), digits, digest)


def main():
    args = [int(x) if x.isdigit() else x for x in sys.argv[1:]]
    for key in sys.stdin:
        print(totp(key.strip(), *args))


if __name__ == &#39;__main__&#39;:
    main()"><pre><span>#!/usr/bin/env python3</span>

<span>import</span> <span>base64</span>
<span>import</span> <span>hmac</span>
<span>import</span> <span>struct</span>
<span>import</span> <span>sys</span>
<span>import</span> <span>time</span>


<span>def</span> <span>hotp</span>(<span>key</span>, <span>counter</span>, <span>digits</span><span>=</span><span>6</span>, <span>digest</span><span>=</span><span>&#39;sha1&#39;</span>):
    <span>key</span> <span>=</span> <span>base64</span>.<span>b32decode</span>(<span>key</span>.<span>upper</span>() <span>+</span> <span>&#39;=&#39;</span> <span>*</span> ((<span>8</span> <span>-</span> <span>len</span>(<span>key</span>)) <span>%</span> <span>8</span>))
    <span>counter</span> <span>=</span> <span>struct</span>.<span>pack</span>(<span>&#39;&gt;Q&#39;</span>, <span>counter</span>)
    <span>mac</span> <span>=</span> <span>hmac</span>.<span>new</span>(<span>key</span>, <span>counter</span>, <span>digest</span>).<span>digest</span>()
    <span>offset</span> <span>=</span> <span>mac</span>[<span>-</span><span>1</span>] <span>&amp;</span> <span>0x0f</span>
    <span>binary</span> <span>=</span> <span>struct</span>.<span>unpack</span>(<span>&#39;&gt;L&#39;</span>, <span>mac</span>[<span>offset</span>:<span>offset</span><span>+</span><span>4</span>])[<span>0</span>] <span>&amp;</span> <span>0x7fffffff</span>
    <span>return</span> <span>str</span>(<span>binary</span>)[<span>-</span><span>digits</span>:].<span>zfill</span>(<span>digits</span>)


<span>def</span> <span>totp</span>(<span>key</span>, <span>time_step</span><span>=</span><span>30</span>, <span>digits</span><span>=</span><span>6</span>, <span>digest</span><span>=</span><span>&#39;sha1&#39;</span>):
    <span>return</span> <span>hotp</span>(<span>key</span>, <span>int</span>(<span>time</span>.<span>time</span>() <span>/</span> <span>time_step</span>), <span>digits</span>, <span>digest</span>)


<span>def</span> <span>main</span>():
    <span>args</span> <span>=</span> [<span>int</span>(<span>x</span>) <span>if</span> <span>x</span>.<span>isdigit</span>() <span>else</span> <span>x</span> <span>for</span> <span>x</span> <span>in</span> <span>sys</span>.<span>argv</span>[<span>1</span>:]]
    <span>for</span> <span>key</span> <span>in</span> <span>sys</span>.<span>stdin</span>:
        <span>print</span>(<span>totp</span>(<span>key</span>.<span>strip</span>(), <span>*</span><span>args</span>))


<span>if</span> <span>__name__</span> <span>==</span> <span>&#39;__main__&#39;</span>:
    <span>main</span>()</pre></div>
<p dir="auto">In the code above, we use the <code>hmac</code> module available in the Python
standard library to implement HOTP. The implementation can be found in
the <code>hotp()</code> function. It is a pretty straightforward implementation of
<a href="https://tools.ietf.org/html/rfc4226#section-5" rel="nofollow">RFC 2104: Section 5: HOTP Algorithm</a>. It takes a
Base32-encoded secret key and a counter as input. It returns a 6-digit
HOTP value as output.</p>
<p dir="auto">The <code>totp()</code> function implements the TOTP algorithm. It is a thin
wrapper around the HOTP algorithm. The TOTP value is obtained by
invoking the HOTP function with the secret key and the number of time
intervals (30 second intervals by default) that have elapsed since Unix
epoch (1970-01-01 00:00:00 UTC).</p>
<h2 dir="auto"><a id="user-content-install" aria-hidden="true" href="#install"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install</h2>
<p dir="auto">MinTOTP requires Python 3.4 or later. If Python 3.4 or later is present
on your system, follow one of the two sections below to get MinTOTP on
your system.</p>
<h3 dir="auto"><a id="user-content-from-pypi" aria-hidden="true" href="#from-pypi"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>From PyPI</h3>
<p dir="auto">If you want to install the MinTOTP package from <a href="https://pypi.org/project/mintotp/" rel="nofollow">PyPI</a> as a Python
module on your system, then follow the steps provided below. Doing so
makes MinTOTP available as the <code>mintotp</code> command that you can run on the
terminal. A module named <code>mintotp</code> also becomes available that you can
<code>import</code> in your own Python code.</p>
<ol dir="auto">
<li>
<p dir="auto">Enter the following command to install MinTOTP on your system:</p>

</li>
<li>
<p dir="auto">Test that MinTOTP works fine as a command:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mintotp &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>mintotp <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
<p dir="auto">A 6-digit TOTP value should appear as the output.</p>
</li>
<li>
<p dir="auto">Test that MinTOTP can be used as a library module:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ python3
&gt;&gt;&gt; import mintotp
&gt;&gt;&gt; mintotp.totp(&#39;ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS&#39;)
&gt;&gt;&gt; mintotp.hotp(&#39;ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS&#39;, 42)"><pre>$ python3
&gt;&gt;&gt; <span>import</span> mintotp
&gt;&gt;&gt; mintotp.totp(<span><span>&#39;</span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS<span>&#39;</span></span>)
&gt;&gt;&gt; mintotp.hotp(<span><span>&#39;</span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS<span>&#39;</span></span>, <span>42</span>)</pre></div>
<p dir="auto">The <code>totp()</code> function call should return a 6-digit TOTP value based
on the current time. The <code>hotp()</code> call should return the following
HOTP value: <code>626854</code>.</p>
</li>
</ol>
<h3 dir="auto"><a id="user-content-from-github" aria-hidden="true" href="#from-github"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>From GitHub</h3>
<p dir="auto">If you do not want to install MinTOTP to your system as a command but
you want to work with the <a href="https://donnywinston.com/susam/mintotp/blob/main/mintotp.py"><code>mintotp.py</code></a> source file directly
clone the GitHub repository of this project.</p>
<ol dir="auto">
<li>
<p dir="auto">Clone GitHub repository of this project and enter its top-level
directory.</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/susam/mintotp.git
cd mintotp"><pre>git clone https://github.com/susam/mintotp.git
<span>cd</span> mintotp</pre></div>
</li>
<li>
<p dir="auto">Test that <a href="https://donnywinston.com/susam/mintotp/blob/main/mintotp.py"><code>mintotp.py</code></a> works fine:</p>
<div dir="auto" data-snippet-clipboard-copy-content="python3 mintotp.py &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>python3 mintotp.py <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
<p dir="auto">A 6-digit TOTP value should appear as the output.</p>
</li>
<li>
<p dir="auto">Test that <a href="https://donnywinston.com/susam/mintotp/blob/main/mintotp.py"><code>mintotp.py</code></a> can be imported as a module:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ python3
&gt;&gt;&gt; import mintotp
&gt;&gt;&gt; mintotp.totp(&#39;ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS&#39;)
&gt;&gt;&gt; mintotp.hotp(&#39;ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS&#39;, 42)"><pre>$ python3
&gt;&gt;&gt; <span>import</span> mintotp
&gt;&gt;&gt; mintotp.totp(<span><span>&#39;</span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS<span>&#39;</span></span>)
&gt;&gt;&gt; mintotp.hotp(<span><span>&#39;</span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS<span>&#39;</span></span>, <span>42</span>)</pre></div>
<p dir="auto">The <code>totp()</code> function call should return a 6-digit TOTP value based
on the current time. The <code>hotp()</code> call should return the following
HOTP value: <code>626854</code>.</p>
</li>
</ol>
<p dir="auto">All examples provided in the sections below assume that MinTOTP has been
installed from PyPI. If you choose to use MinTOTP from GitHub instead,
replace all occurrences of <code>mintotp</code> in the example commands below with
<code>python3 mintotp.py</code>.</p>
<h2 dir="auto"><a id="user-content-get-started" aria-hidden="true" href="#get-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Get Started</h2>
<p dir="auto">This section presents a few examples to quickly get started with
MinTOTP.</p>
<p dir="auto">Note that this section uses a few example secret keys and QR codes. They
are merely examples that come with this project for you to quickly test
the program with. They should not be used for any real account that
requires TOTP-based two-factor authentication. Usually, the issuer of a
real account (such as an account on a website or an organization) would
also issue a secret key or a secret QR code to you which you must use to
generate TOTP values for the purpose of logging into that account.</p>
<h3 dir="auto"><a id="user-content-with-base32-key" aria-hidden="true" href="#with-base32-key"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>With Base32 Key</h3>
<ol dir="auto">
<li>
<p dir="auto">Enter this command:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mintotp &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>mintotp <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
<p dir="auto">The output should be a 6-digit TOTP value.</p>
</li>
<li>
<p dir="auto">Add the following key to a TOTP-based authenticator app:</p>
<div data-snippet-clipboard-copy-content="ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre><code>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS
</code></pre></div>
<p dir="auto">For example, if you have Google Authenticator on your mobile phone,
open it, tap the button with plus sign, select &#34;Enter a provided
key&#34;, enter any account name and &#34;Time-based&#34; and enter the
above key. Set the dropdown menu to &#34;Time-based&#34; and tap the &#34;Add&#34;
button. A 6-digit TOTP value should appear for the new key.</p>
</li>
<li>
<p dir="auto">Run the command in step 1 again and verify that the TOTP value
printed by the Python program matches the TOTP value that appears in
the authenticator app.</p>
</li>
</ol>
<h3 dir="auto"><a id="user-content-with-qr-code" aria-hidden="true" href="#with-qr-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>With QR Code</h3>
<ol dir="auto">
<li>
<p dir="auto">Install <code>zbarimg</code> to scan QR codes:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
brew install zbar

# On Debian, Ubuntu, etc.
apt-get install zbar-tools"><pre><span><span>#</span> On macOS</span>
brew install zbar

<span><span>#</span> On Debian, Ubuntu, etc.</span>
apt-get install zbar-tools</pre></div>
</li>
<li>
<p dir="auto">Download and save the following QR code on your system:</p>
</li>
<li>
<p dir="auto">Enter this command to read the data in the QR code:</p>

<p dir="auto">The output should be:</p>
<div data-snippet-clipboard-copy-content="QR-Code:otpauth://totp/alice:bob?secret=ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre><code>QR-Code:otpauth://totp/alice:bob?secret=ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS
</code></pre></div>
<p dir="auto">Note that the secret key in the URI is same as the secret key we
used in the previous sections.</p>
</li>
<li>
<p dir="auto">Now enter this command to extract the secret key from the QR code
and feed it to MinTOTP.</p>
<div dir="auto" data-snippet-clipboard-copy-content="zbarimg -q secret1.png | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp"><pre>zbarimg -q secret1.png <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp</pre></div>
</li>
<li>
<p dir="auto">Scan the QR code shown above in step 3 with a TOTP-based
authenticator app. For example, if you have Google Authenticator on
your mobile phone, open it, tap the button with plus sign, select
&#34;Scan a barcode&#34;, and scan the QR code shown above in step 3. A
6-digit TOTP value should appear for the new key.</p>
</li>
<li>
<p dir="auto">Run the command in step 4 again and verify that the TOTP value
printed by MinTOTP matches the TOTP value that appears in the
authenticator app.</p>
</li>
</ol>
<h2 dir="auto"><a id="user-content-protect-key-with-gpg" aria-hidden="true" href="#protect-key-with-gpg"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Protect Key with GPG</h2>
<p dir="auto">The previous sections use an example key and QR code to show how this
tool works. If you use this tool to generate TOTP values from a real
secret key for a real account, you must encrypt your secret key to keep
it safe. The next two subsections explain how to protect the key with
GNU Privacy Guard (also known as GnuPG or GPG).</p>
<h3 dir="auto"><a id="user-content-install-gpg" aria-hidden="true" href="#install-gpg"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Install GPG</h3>
<ol dir="auto">
<li>
<p dir="auto">Install GNU Privacy Guard:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
brew install gnupg

# On Debian, Ubuntu, etc.
apt-get update
apt-get install gnupg"><pre><span><span>#</span> On macOS</span>
brew install gnupg

<span><span>#</span> On Debian, Ubuntu, etc.</span>
apt-get update
apt-get install gnupg</pre></div>
</li>
<li>
<p dir="auto">Enter the following command to ensure that GPG is installed.</p>

<p dir="auto">If GPG is installed properly, the command above should print its
version, license details, and cipher details.</p>
</li>
</ol>
<h3 dir="auto"><a id="user-content-encrypt-base32-key-with-gpg" aria-hidden="true" href="#encrypt-base32-key-with-gpg"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Encrypt Base32 Key With GPG</h3>
<p dir="auto">The steps below show the usage of GPG to encrypt our example secret key.
You would have to replace this example secret key with a real secret key
that you want to use to generate TOTP values.</p>
<ol dir="auto">
<li>
<p dir="auto">Encrypt the secret key using GPG. First enter this command:</p>

<p dir="auto">Then enter a <a href="https://www.gnupg.org/faq/gnupg-faq.html#strong_passphrase" rel="nofollow">strong passphrase</a> when it prompts for it. Re-enter
the passphase to confirm it. Then paste the following key as input:</p>
<div data-snippet-clipboard-copy-content="ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre><code>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS
</code></pre></div>
<p dir="auto">Press <kbd>enter</kbd> to end the line. Press <kbd>ctrl</kbd> +
<kbd>d</kbd> to end input. The encrypted secret key would be saved
in a file named <code>secret.gpg</code>.</p>
</li>
<li>
<p dir="auto">Generate TOTP value from the encrypted key:</p>
<div dir="auto" data-snippet-clipboard-copy-content="gpg -q -o - secret.gpg | mintotp"><pre>gpg -q -o - secret.gpg <span>|</span> mintotp</pre></div>
</li>
<li>
<p dir="auto">You can also generate TOTP value and copy it to system clipboard:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
gpg -q -o - secret.gpg | mintotp | tr -d &#39;\n&#39; | pbcopy

# On Linux
gpg -q -o - secret.gpg | mintotp | tr -d &#39;\n&#39; | xclip"><pre><span><span>#</span> On macOS</span>
gpg -q -o - secret.gpg <span>|</span> mintotp <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> pbcopy

<span><span>#</span> On Linux</span>
gpg -q -o - secret.gpg <span>|</span> mintotp <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> xclip</pre></div>
<p dir="auto">Now you can easily paste the TOTP value to any login form that
requires it. On Linux, of course, you need to have <code>xclip</code> installed
to use it. On Debian, Ubuntu, etc. it can be installed with the
<code>apt-get install xclip</code> command. To paste the value copied into the
clipboard by <code>xclip</code>, middle-click on mouse.</p>
</li>
<li>
<p dir="auto">In case you want to see the TOTP value on the terminal while it is
also copied to the system clipboard, use one of these commands:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
gpg -q -o - secret.gpg | mintotp | tee /dev/stderr | tr -d &#39;\n&#39; | pbcopy

# On Linux
gpg -q -o - secret.gpg | mintotp | tee /dev/stderr | tr -d &#39;\n&#39; | xclip"><pre><span><span>#</span> On macOS</span>
gpg -q -o - secret.gpg <span>|</span> mintotp <span>|</span> tee /dev/stderr <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> pbcopy

<span><span>#</span> On Linux</span>
gpg -q -o - secret.gpg <span>|</span> mintotp <span>|</span> tee /dev/stderr <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> xclip</pre></div>
</li>
</ol>
<h3 dir="auto"><a id="user-content-encrypt-qr-code-with-gpg" aria-hidden="true" href="#encrypt-qr-code-with-gpg"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Encrypt QR Code With GPG</h3>
<p dir="auto">The steps below show the usage of GPG to encrypt our example QR code.
You would have to replace the example QR code with a real QR code that
you want to use to generate TOTP values.</p>
<ol dir="auto">
<li>
<p dir="auto">Encrypt the QR code using GPG. First enter this command:</p>

<p dir="auto">Then enter a <a href="https://www.gnupg.org/faq/gnupg-faq.html#strong_passphrase" rel="nofollow">strong passphrase</a> when it prompts for it. Re-enter
the passphase to confirm it. The encrypted QR code would be saved in
a file named <code>secret1.png.gpg</code>.</p>
</li>
<li>
<p dir="auto">Delete the unencrypted QR code file securely:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
rm -P secret1.png

# On Linux
shred -u secret1.png"><pre><span><span>#</span> On macOS</span>
rm -P secret1.png

<span><span>#</span> On Linux</span>
shred -u secret1.png</pre></div>
</li>
<li>
<p dir="auto">Generate TOTP value from the encrypted QR code file:</p>
<div dir="auto" data-snippet-clipboard-copy-content="zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp"><pre>zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp</pre></div>
</li>
<li>
<p dir="auto">You can also generate the TOTP value and copy it to system clipboard:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp | tr -d &#39;\n&#39; | pbcopy

# On Linux
zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp | tr -d &#39;\n&#39; | xclip"><pre><span><span>#</span> On macOS</span>
zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> pbcopy

<span><span>#</span> On Linux</span>
zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> xclip</pre></div>
</li>
<li>
<p dir="auto">In case you want to see the TOTP value on the terminal while it is
also copied to the system clipboard, use one of these commands:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp | tee /dev/stderr | tr -d &#39;\n&#39; | pbcopy

# On Linux
zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp | tee /dev/stderr | tr -d &#39;\n&#39; | xclip"><pre><span><span>#</span> On macOS</span>
zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp <span>|</span> tee /dev/stderr <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> pbcopy

<span><span>#</span> On Linux</span>
zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp <span>|</span> tee /dev/stderr <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> xclip</pre></div>
</li>
</ol>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<h3 dir="auto"><a id="user-content-multiple-keys" aria-hidden="true" href="#multiple-keys"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Multiple Keys</h3>
<p dir="auto">This tool accepts one or more Base32 secret keys as standard input. Each
key must occur in its own line.</p>
<ol dir="auto">
<li>
<p dir="auto">Generate multiple TOTP values, one for each of multiple Base32 keys:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mintotp &lt;&lt;eof
ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS
PW4YAYYZVDE5RK2AOLKUATNZIKAFQLZO
eof"><pre>mintotp <span><span>&lt;&lt;</span><span>eof</span></span>
<span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span>
<span>PW4YAYYZVDE5RK2AOLKUATNZIKAFQLZO</span>
<span><span>eof</span></span></pre></div>
</li>
<li>
<p dir="auto">Generate TOTP values for multiple keys in multiple QR codes:</p>
<div dir="auto" data-snippet-clipboard-copy-content="zbarimg -q *.png | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | mintotp"><pre>zbarimg -q <span>*</span>.png <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> mintotp</pre></div>
</li>
</ol>
<h3 dir="auto"><a id="user-content-command-line-arguments" aria-hidden="true" href="#command-line-arguments"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Command Line Arguments</h3>
<p dir="auto">In order to keep this tool as minimal as possible, it does not come with
any command line options. In fact, it does not even have the <code>--help</code>
option. It does support a few command line arguments though. Since there
is no help output from the tool, this section describes the command line
arguments for this tool.</p>
<p dir="auto">Here is a synopsis of the command line arguments supported by this tool:</p>
<div data-snippet-clipboard-copy-content="mintotp [TIME_STEP [DIGITS [DIGEST]]]"><pre><code>mintotp [TIME_STEP [DIGITS [DIGEST]]]
</code></pre></div>
<p dir="auto">Here is a description of each argument:</p>
<ul dir="auto">
<li>
<p dir="auto"><code>TIME_STEP</code></p>
<p dir="auto">TOTP time-step duration (in seconds) during which a TOTP value is
valid. A new TOTP value is generated after time-step duration
elapses. (Default: <code>30</code>)</p>
</li>
<li>
<p dir="auto"><code>DIGITS</code></p>
<p dir="auto">Number of digits in TOTP value. (Default: <code>6</code>)</p>
</li>
<li>
<p dir="auto"><code>DIGEST</code></p>
<p dir="auto">Cryptographic hash algorithm to use while generating TOTP value.
(Default: <code>sha1</code>)</p>
<p dir="auto">Possible values are <code>sha1</code>, <code>sha224</code>, <code>sha256</code>, <code>sha384</code>, and
<code>sha512</code>.</p>
</li>
</ul>
<p dir="auto">Here are some usage examples of these command line arguments:</p>
<ol dir="auto">
<li>
<p dir="auto">Generate TOTP value with a time-step size of 60 seconds:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mintotp 60 &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>mintotp 60 <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
</li>
<li>
<p dir="auto">Generate 8-digit TOTP value:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mintotp 60 8 &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>mintotp 60 8 <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
</li>
<li>
<p dir="auto">Use SHA-256 hash algorithm to generate TOTP value:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mintotp 60 6 sha256 &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>mintotp 60 6 sha256 <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
</li>
</ol>
<p dir="auto">The behaviour of the tool is undefined if it is used in any way other
than what is described above. For example, although surplus command line
arguments are ignored currently, this behaviour may change in future, so
what should happen in case of surplus arguments is left undefined in
this document.</p>
<h2 dir="auto"><a id="user-content-tradeoff" aria-hidden="true" href="#tradeoff"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Tradeoff</h2>
<p dir="auto">If you use this tool to generate TOTP values on a desktop/laptop device
while logging into a website that requires TOTP-based two-factor (2FA)
or multi-factor authentication (MFA) from the same device, you should be
aware that doing so trades off some security for convenience.</p>
<p dir="auto">2FA or MFA relies on the user presenting at least two pieces of evidence
(factors) to an authentication system: something only the user knows and
something only the user has.</p>
<p dir="auto">If this tool is run to generate TOTP values on the same desktop/laptop
device that you are using to log into a website, then you should
consider that if your desktop/laptop device is compromised, then both
authentication factors can be compromised. The attacker can steal the
first authentication factor that only you should know (e.g., password)
by running a key logger on the compromised device. The attacker can also
steal the second authentication factor that only you should have (e.g.,
TOTP secret key) because it would be read by this tool on the same
compromised device; if this tool can read the TOTP secret key on the
compromised device, so can the attacker.</p>
<p dir="auto">In other words, for higher security, it is good to generate TOTP values
on a separate device. However, if the inconvenience of getting a
separate device prevents you from using 2FA or MFA altogether, then you
might find this tool helpful. It allows to trade off some security for
convenience which is still more secure than not having 2FA or MFA at
all. Whether trading some security for convenience is acceptable to you
or not is something you need to decide for yourself.</p>
<h2 dir="auto"><a id="user-content-alternative-oath-toolkit" aria-hidden="true" href="#alternative-oath-toolkit"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Alternative: OATH Toolkit</h2>
<p dir="auto">There is an <code>oathtool</code> command available in OATH Toolkit that can also
generate TOTP values from TOTP secret keys. This section presents some
examples that show how <code>oathtool</code> can be used to do what MinTOTP does.</p>
<ol dir="auto">
<li>
<p dir="auto">Install OATH Toolkit:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
brew install oath-toolkit

# On Debian, Ubuntu, etc.
apt-get update
apt-get install oathtool"><pre><span><span>#</span> On macOS</span>
brew install oath-toolkit

<span><span>#</span> On Debian, Ubuntu, etc.</span>
apt-get update
apt-get install oathtool</pre></div>
</li>
<li>
<p dir="auto">Generate TOTP from a Base32 key:</p>
<div dir="auto" data-snippet-clipboard-copy-content="oathtool --totp -b - &lt;&lt;&lt; ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS"><pre>oathtool --totp -b - <span>&lt;&lt;&lt;</span> <span>ZYTYYE5FOAGW5ML7LRWUL4WTZLNJAMZS</span></pre></div>
</li>
<li>
<p dir="auto">Generate TOTP from an encrypted Base32 key:</p>
<div dir="auto" data-snippet-clipboard-copy-content="gpg -q -o - secret.gpg | oathtool --totp -b -"><pre>gpg -q -o - secret.gpg <span>|</span> oathtool --totp -b -</pre></div>
<p dir="auto">Section <a href="#encrypt-base32-key-with-gpg">Encrypt Base32 Key With GPG</a>
explains how to create the encrypted key (<code>secret.gpg</code>) with GPG.</p>
</li>
<li>
<p dir="auto">Generate TOTP from a QR code:</p>
<div dir="auto" data-snippet-clipboard-copy-content="zbarimg -q secret1.png | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | oathtool --totp -b -"><pre>zbarimg -q secret1.png <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> oathtool --totp -b -</pre></div>
</li>
<li>
<p dir="auto">Generate TOTP from an encrypted QR code:</p>
<div dir="auto" data-snippet-clipboard-copy-content="zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | oathtool --totp -b -"><pre>zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> oathtool --totp -b -</pre></div>
<p dir="auto">Section <a href="#encrypt-qr-code-with-gpg">Encrypt QR Code With GPG</a> explains
how to create the encrypted QR code (<code>secret1.png.gpg</code>) with GPG.</p>
</li>
<li>
<p dir="auto">Generate TOTP value and copy it to system clipboard:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# On macOS
gpg -q -o - secret.gpg | oathtool --totp -b - | tr -d &#39;\n&#39; | pbcopy
zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | oathtool --totp -b - | tr -d &#39;\n&#39; | pbcopy

# On Linux
gpg -q -o - secret.gpg | oathtool --totp -b - | tr -d &#39;\n&#39; | xclip
zbarimg -q &lt;(gpg -q -o - secret1.png.gpg) | sed &#39;s/.*secret=\([^&amp;]*\).*/\1/&#39; | oathtool --totp -b - | tr -d &#39;\n&#39; | xclip"><pre><span><span>#</span> On macOS</span>
gpg -q -o - secret.gpg <span>|</span> oathtool --totp -b - <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> pbcopy
zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> oathtool --totp -b - <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> pbcopy

<span><span>#</span> On Linux</span>
gpg -q -o - secret.gpg <span>|</span> oathtool --totp -b - <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> xclip
zbarimg -q <span><span>&lt;(</span>gpg -q -o - secret1.png.gpg<span>)</span></span> <span>|</span> sed <span><span>&#39;</span>s/.*secret=\([^&amp;]*\).*/\1/<span>&#39;</span></span> <span>|</span> oathtool --totp -b - <span>|</span> tr -d <span><span>&#39;</span>\n<span>&#39;</span></span> <span>|</span> xclip</pre></div>
</li>
</ol>
<h2 dir="auto"><a id="user-content-resources" aria-hidden="true" href="#resources"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Resources</h2>
<p dir="auto">Here is a list of useful links about this project:</p>
<ul dir="auto">
<li><a href="https://github.com/susam/mintotp#readme">Documentation</a></li>
<li><a href="https://pypi.org/project/mintotp/" rel="nofollow">Latest release</a></li>
<li><a href="https://github.com/susam/mintotp/blob/main/CHANGES.md">Changelog</a></li>
<li><a href="https://github.com/susam/mintotp/issues">Issue tracker</a></li>
<li><a href="https://github.com/susam/mintotp">Source code</a></li>
</ul>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">This is free and open source software. You can use, copy, modify,
merge, publish, distribute, sublicense, and/or sell copies of it,
under the terms of the MIT License. See <a href="https://donnywinston.com/susam/mintotp/blob/main/LICENSE.md">LICENSE.md</a> for details.</p>
<p dir="auto">This software is provided &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND,
express or implied. See <a href="https://donnywinston.com/susam/mintotp/blob/main/LICENSE.md">LICENSE.md</a> for details.</p>
<h2 dir="auto"><a id="user-content-support" aria-hidden="true" href="#support"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Support</h2>
<p dir="auto">To report bugs, suggest improvements, or ask questions, please create a
new issue at <a href="http://github.com/susam/mintotp/issues">http://github.com/susam/mintotp/issues</a>.</p>
<h2 dir="auto"><a id="user-content-thanks" aria-hidden="true" href="#thanks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Thanks</h2>
<p dir="auto">Thanks to <a href="https://github.com/prateeknischal">Prateek Nischal</a> for getting me involved with TOTP. I
referred to his TOTP implementation at
<a href="https://github.com/prateeknischal/qry/blob/master/util/totp.py">prateeknischal/qry/util/totp.py</a> while writing my own.</p>
</article>
          </div></div>
  </body>
</html>
