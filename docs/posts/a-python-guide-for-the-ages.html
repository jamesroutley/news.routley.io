<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gto76.github.io/python-cheatsheet/">Original</a>
    <h1>A Python Guide for the Ages</h1>
    
    <div id="readability-page-1" class="page">
  <header>
    
    
  </header>

   






<div><h2 id="main"><a href="#main" name="main">#</a>Main</h2><pre><code><span>if</span> __name__ == <span>&#39;__main__&#39;</span>:     
    main()
</code></pre></div>

<div><h2 id="list"><a href="#list" name="list">#</a>List</h2><pre><code>&lt;list&gt; = &lt;list&gt;[&lt;slice&gt;]       
</code></pre></div>

<pre><code>&lt;list&gt;.append(&lt;el&gt;)            
&lt;list&gt;.extend(&lt;collection&gt;)    
</code></pre>
<pre><code>&lt;list&gt;.sort()                  
&lt;list&gt;.reverse()               
&lt;list&gt; = sorted(&lt;collection&gt;)  
&lt;iter&gt; = reversed(&lt;list&gt;)      
</code></pre>
<pre><code>sum_of_elements  = sum(&lt;collection&gt;)
elementwise_sum  = [sum(pair) <span>for</span> pair <span>in</span> zip(list_a, list_b)]
sorted_by_second = sorted(&lt;collection&gt;, key=<span>lambda</span> el: el[<span>1</span>])
sorted_by_both   = sorted(&lt;collection&gt;, key=<span>lambda</span> el: (el[<span>1</span>], el[<span>0</span>]))
flatter_list     = list(itertools.chain.from_iterable(&lt;list&gt;))
product_of_elems = functools.reduce(<span>lambda</span> out, el: out * el, &lt;collection&gt;)
list_of_chars    = list(&lt;str&gt;)
</code></pre>
<ul>
<li><strong>For details about sorted(), min() and max() see <a href="#sortable">sortable</a>.</strong></li>
<li><strong>Module <a href="#operator">operator</a> provides functions itemgetter() and mul() that offer the same functionality as <a href="#lambda">lambda</a> expressions above.</strong></li>
</ul>
<pre><code>&lt;list&gt;.insert(&lt;int&gt;, &lt;el&gt;)     
&lt;el&gt;  = &lt;list&gt;.pop([&lt;int&gt;])    
&lt;int&gt; = &lt;list&gt;.count(&lt;el&gt;)     
&lt;int&gt; = &lt;list&gt;.index(&lt;el&gt;)     
&lt;list&gt;.remove(&lt;el&gt;)            
&lt;list&gt;.clear()                 
</code></pre>
<div><h2 id="dictionary"><a href="#dictionary" name="dictionary">#</a>Dictionary</h2><pre><code>&lt;view&gt; = &lt;dict&gt;.keys()                          
&lt;view&gt; = &lt;dict&gt;.values()                        
&lt;view&gt; = &lt;dict&gt;.items()                         
</code></pre></div>

<pre><code>value  = &lt;dict&gt;.get(key, default=<span>None</span>)          
value  = &lt;dict&gt;.setdefault(key, default=<span>None</span>)   
&lt;dict&gt; = collections.defaultdict(&lt;type&gt;)        
&lt;dict&gt; = collections.defaultdict(<span>lambda</span>: <span>1</span>)     
</code></pre>
<pre><code>&lt;dict&gt; = dict(&lt;collection&gt;)                     
&lt;dict&gt; = dict(zip(keys, values))                
&lt;dict&gt; = dict.fromkeys(keys [, value])          
</code></pre>
<pre><code>&lt;dict&gt;.update(&lt;dict&gt;)                           
value = &lt;dict&gt;.pop(key)                         
{k <span>for</span> k, v <span>in</span> &lt;dict&gt;.items() <span>if</span> v == value}    
{k: v <span>for</span> k, v <span>in</span> &lt;dict&gt;.items() <span>if</span> k <span>in</span> keys}  
</code></pre>
<div><h3 id="counter">Counter</h3><pre><code><span>&gt;&gt;&gt; </span><span>from</span> collections <span>import</span> Counter
<span>&gt;&gt;&gt; </span>colors = [<span>&#39;blue&#39;</span>, <span>&#39;blue&#39;</span>, <span>&#39;blue&#39;</span>, <span>&#39;red&#39;</span>, <span>&#39;red&#39;</span>]
<span>&gt;&gt;&gt; </span>counter = Counter(colors)
<span>&gt;&gt;&gt; </span>counter[<span>&#39;yellow&#39;</span>] += <span>1</span>
Counter({<span>&#39;blue&#39;</span>: <span>3</span>, <span>&#39;red&#39;</span>: <span>2</span>, <span>&#39;yellow&#39;</span>: <span>1</span>})
<span>&gt;&gt;&gt; </span>counter.most_common()[<span>0</span>]
(<span>&#39;blue&#39;</span>, <span>3</span>)
</code></pre></div>



<pre><code>&lt;set&gt;.add(&lt;el&gt;)                                 
&lt;set&gt;.update(&lt;collection&gt; [, ...])              
</code></pre>
<pre><code>&lt;set&gt;  = &lt;set&gt;.union(&lt;coll.&gt;)                   
&lt;set&gt;  = &lt;set&gt;.intersection(&lt;coll.&gt;)            
&lt;set&gt;  = &lt;set&gt;.difference(&lt;coll.&gt;)              
&lt;set&gt;  = &lt;set&gt;.symmetric_difference(&lt;coll.&gt;)    
&lt;bool&gt; = &lt;set&gt;.issubset(&lt;coll.&gt;)                
&lt;bool&gt; = &lt;set&gt;.issuperset(&lt;coll.&gt;)              
</code></pre>
<pre><code>&lt;el&gt; = &lt;set&gt;.pop()                              
&lt;set&gt;.remove(&lt;el&gt;)                              
&lt;set&gt;.discard(&lt;el&gt;)                             
</code></pre>
<div><h3 id="frozenset">Frozen Set</h3><ul>
<li><strong>Is immutable and hashable.</strong></li>
<li><strong>That means it can be used as a key in a dictionary or as an element in a set.</strong></li>
</ul><pre><code>&lt;frozenset&gt; = frozenset(&lt;collection&gt;)
</code></pre></div>


<div><h2 id="tuple"><a href="#tuple" name="tuple">#</a>Tuple</h2><p><strong>Tuple is an immutable and hashable list.</strong></p><pre><code>&lt;tuple&gt; = ()
&lt;tuple&gt; = (&lt;el&gt;,)                           
&lt;tuple&gt; = (&lt;el_1&gt;, &lt;el_2&gt; [, ...])          
</code></pre></div>


<div><h3 id="namedtuple">Named Tuple</h3><p><strong>Tuple&#39;s subclass with named elements.</strong></p><pre><code><span>&gt;&gt;&gt; </span><span>from</span> collections <span>import</span> namedtuple
<span>&gt;&gt;&gt; </span>Point = namedtuple(<span>&#39;Point&#39;</span>, <span>&#39;x y&#39;</span>)
<span>&gt;&gt;&gt; </span>p = Point(<span>1</span>, y=<span>2</span>)
Point(x=<span>1</span>, y=<span>2</span>)
<span>&gt;&gt;&gt; </span>p[<span>0</span>]
<span>1</span>
<span>&gt;&gt;&gt; </span>p.x
<span>1</span>
<span>&gt;&gt;&gt; </span>getattr(p, <span>&#39;y&#39;</span>)
<span>2</span>
<span>&gt;&gt;&gt; </span>p._fields  
(<span>&#39;x&#39;</span>, <span>&#39;y&#39;</span>)
</code></pre></div>


<div><h2 id="range"><a href="#range" name="range">#</a>Range</h2><pre><code>&lt;range&gt; = range(to_exclusive)
&lt;range&gt; = range(from_inclusive, to_exclusive)
&lt;range&gt; = range(from_inclusive, to_exclusive, ±step_size)
</code></pre></div>

<pre><code>from_inclusive = &lt;range&gt;.start
to_exclusive   = &lt;range&gt;.stop
</code></pre>
<div><h2 id="enumerate"><a href="#enumerate" name="enumerate">#</a>Enumerate</h2><pre><code><span>for</span> i, el <span>in</span> enumerate(&lt;collection&gt; [, i_start]):
    ...
</code></pre></div>

<div><h2 id="iterator"><a href="#iterator" name="iterator">#</a>Iterator</h2><pre><code>&lt;iter&gt; = iter(&lt;collection&gt;)                 
&lt;iter&gt; = iter(&lt;function&gt;, to_exclusive)     
&lt;el&gt;   = next(&lt;iter&gt; [, default])           
&lt;list&gt; = list(&lt;iter&gt;)                       
</code></pre></div>

<div><h3 id="itertools">Itertools</h3><pre><code><span>from</span> itertools <span>import</span> count, repeat, cycle, chain, islice
</code></pre></div>

<pre><code>&lt;iter&gt; = count(start=<span>0</span>, step=<span>1</span>)             
&lt;iter&gt; = repeat(&lt;el&gt; [, times])             
&lt;iter&gt; = cycle(&lt;collection&gt;)                
</code></pre>
<pre><code>&lt;iter&gt; = chain(&lt;coll_1&gt;, &lt;coll_2&gt; [, ...])  
&lt;iter&gt; = chain.from_iterable(&lt;collection&gt;)  
</code></pre>
<pre><code>&lt;iter&gt; = islice(&lt;coll&gt;, to_exclusive)       
&lt;iter&gt; = islice(&lt;coll&gt;, from_inclusive, …)  
</code></pre>
<div><h2 id="generator"><a href="#generator" name="generator">#</a>Generator</h2><ul>
<li><strong>Any function that contains a yield statement returns a generator.</strong></li>
<li><strong>Generators and iterators are interchangeable.</strong></li>
</ul><pre><code><span><span>def</span> <span>count</span><span>(start, step)</span>:</span>
    <span>while</span> <span>True</span>:
        <span>yield</span> start
        start += step
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>counter = count(<span>10</span>, <span>2</span>)
<span>&gt;&gt;&gt; </span>next(counter), next(counter), next(counter)
(<span>10</span>, <span>12</span>, <span>14</span>)
</code></pre>
<div><h2 id="type"><a href="#type" name="type">#</a>Type</h2><ul>
<li><strong>Everything is an object.</strong></li>
<li><strong>Every object has a type.</strong></li>
<li><strong>Type and class are synonymous.</strong></li>
</ul><pre><code>&lt;type&gt; = type(&lt;el&gt;)                          
&lt;bool&gt; = isinstance(&lt;el&gt;, &lt;type&gt;)            
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>type(<span>&#39;a&#39;</span>), <span>&#39;a&#39;</span>.__class__, str
(&lt;<span><span>class</span> &#39;<span>str</span>&#39;&gt;, &lt;<span>class</span> &#39;<span>str</span>&#39;&gt;, &lt;<span>class</span> &#39;<span>str</span>&#39;&gt;)
</span></code></pre>
<div><h4 id="sometypesdonothavebuiltinnamessotheymustbeimported">Some types do not have built-in names, so they must be imported:</h4><pre><code><span>from</span> types <span>import</span> FunctionType, MethodType, LambdaType, GeneratorType, ModuleType
</code></pre></div>

<div><h3 id="abstractbaseclasses">Abstract Base Classes</h3><p><strong>Each abstract base class specifies a set of virtual subclasses. These classes are then recognized by isinstance() and issubclass() as subclasses of the ABC, although they are really not. ABC can also manually decide whether or not a specific class is its virtual subclass, usually based on which methods the class has implemented. For instance, Iterable ABC looks for method iter() while Collection ABC looks for methods iter(), contains() and len().</strong></p><pre><code><span>&gt;&gt;&gt; </span><span>from</span> collections.abc <span>import</span> Sequence, Collection, Iterable
<span>&gt;&gt;&gt; </span>isinstance([<span>1</span>, <span>2</span>, <span>3</span>], Iterable)
<span>True</span>
</code></pre></div>


<pre><code>┏━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┓
┃                  │  Sequence  │ Collection │  Iterable  ┃
┠──────────────────┼────────────┼────────────┼────────────┨
┃ list, range, str │     ✓      │     ✓      │     ✓      ┃
┃ dict, set        │            │     ✓      │     ✓      ┃
┃ iter             │            │            │     ✓      ┃
┗━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┛
</code></pre>
<pre><code><span>&gt;&gt;&gt; </span><span>from</span> numbers <span>import</span> Integral, Rational, Real, Complex, Number
<span>&gt;&gt;&gt; </span>isinstance(<span>123</span>, Number)
<span>True</span>
</code></pre>
<pre><code>┏━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┓
┃                    │ Integral │ Rational │   Real   │ Complex  │  Number  ┃
┠────────────────────┼──────────┼──────────┼──────────┼──────────┼──────────┨
┃ int                │    ✓     │    ✓     │    ✓     │    ✓     │    ✓     ┃
┃ fractions.Fraction │          │    ✓     │    ✓     │    ✓     │    ✓     ┃
┃ float              │          │          │    ✓     │    ✓     │    ✓     ┃
┃ complex            │          │          │          │    ✓     │    ✓     ┃
┃ decimal.Decimal    │          │          │          │          │    ✓     ┃
┗━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┛
</code></pre>
<div><h2 id="string"><a href="#string" name="string">#</a>String</h2><pre><code>&lt;str&gt;  = &lt;str&gt;.strip()                       
&lt;str&gt;  = &lt;str&gt;.strip(<span>&#39;&lt;chars&gt;&#39;</span>)              
</code></pre></div>

<pre><code>&lt;list&gt; = &lt;str&gt;.split()                       
&lt;list&gt; = &lt;str&gt;.split(sep=<span>None</span>, maxsplit=<span>-1</span>)  
&lt;list&gt; = &lt;str&gt;.splitlines(keepends=<span>False</span>)    
&lt;str&gt;  = &lt;str&gt;.join(&lt;coll_of_strings&gt;)       
</code></pre>
<pre><code>&lt;bool&gt; = &lt;sub_str&gt; <span>in</span> &lt;str&gt;                  
&lt;bool&gt; = &lt;str&gt;.startswith(&lt;sub_str&gt;)         
&lt;bool&gt; = &lt;str&gt;.endswith(&lt;sub_str&gt;)           
&lt;int&gt;  = &lt;str&gt;.find(&lt;sub_str&gt;)               
&lt;int&gt;  = &lt;str&gt;.index(&lt;sub_str&gt;)              
</code></pre>
<pre><code>&lt;str&gt;  = &lt;str&gt;.replace(old, new [, count])   
&lt;str&gt;  = &lt;str&gt;.translate(&lt;table&gt;)            
</code></pre>
<pre><code>&lt;str&gt;  = chr(&lt;int&gt;)                          
&lt;int&gt;  = ord(&lt;str&gt;)                          
</code></pre>
<ul>
<li><strong>Also: <code><span>&#39;lstrip()&#39;</span></code>, <code><span>&#39;rstrip()&#39;</span></code> and <code><span>&#39;rsplit()&#39;</span></code>.</strong></li>
<li><strong>Also: <code><span>&#39;lower()&#39;</span></code>, <code><span>&#39;upper()&#39;</span></code>, <code><span>&#39;capitalize()&#39;</span></code> and <code><span>&#39;title()&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="propertymethods">Property Methods</h3><pre><code>┏━━━━━━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┯━━━━━━━━━━┓
┃               │ [ !#$%…] │ [a-zA-Z] │  [¼½¾]   │  [²³¹]   │  [0-9]   ┃
┠───────────────┼──────────┼──────────┼──────────┼──────────┼──────────┨
┃ isprintable() │    ✓     │    ✓     │    ✓     │    ✓     │    ✓     ┃
┃ isalnum()     │          │    ✓     │    ✓     │    ✓     │    ✓     ┃
┃ isnumeric()   │          │          │    ✓     │    ✓     │    ✓     ┃
┃ isdigit()     │          │          │          │    ✓     │    ✓     ┃
┃ isdecimal()   │          │          │          │          │    ✓     ┃
┗━━━━━━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┷━━━━━━━━━━┛
</code></pre></div>

<ul>
<li><strong>Also: <code><span>&#39;isspace()&#39;</span></code> checks for <code><span>&#39;[ \t\n\r\f\v\x1c-\x1f\x85…]&#39;</span></code>.</strong></li>
</ul>
<div><h2 id="regex"><a href="#regex" name="regex">#</a>Regex</h2><pre><code><span>import</span> re
&lt;str&gt;   = re.sub(&lt;regex&gt;, new, text, count=<span>0</span>)  
&lt;list&gt;  = re.findall(&lt;regex&gt;, text)            
&lt;list&gt;  = re.split(&lt;regex&gt;, text, maxsplit=<span>0</span>)  
&lt;Match&gt; = re.search(&lt;regex&gt;, text)             
&lt;Match&gt; = re.match(&lt;regex&gt;, text)              
&lt;iter&gt;  = re.finditer(&lt;regex&gt;, text)           
</code></pre></div>

<ul>
<li><strong>Search() and match() return None if they can&#39;t find a match.</strong></li>
<li><strong>Argument <code><span>&#39;flags=re.IGNORECASE&#39;</span></code> can be used with all functions.</strong></li>
<li><strong>Argument <code><span>&#39;flags=re.MULTILINE&#39;</span></code> makes <code><span>&#39;^&#39;</span></code> and <code><span>&#39;$&#39;</span></code> match the start/end of each line.</strong></li>
<li><strong>Argument <code><span>&#39;flags=re.DOTALL&#39;</span></code> makes dot also accept the <code><span>&#39;\n&#39;</span></code>.</strong></li>
<li><strong>Use <code><span>r&#39;\1&#39;</span></code> or <code><span>&#39;\\1&#39;</span></code> for backreference.</strong></li>
<li><strong>Add <code><span>&#39;?&#39;</span></code> after an operator to make it non-greedy.</strong></li>
</ul>
<div><h3 id="matchobject">Match Object</h3><pre><code>&lt;str&gt;   = &lt;Match&gt;.group()                      
&lt;str&gt;   = &lt;Match&gt;.group(<span>1</span>)                     
&lt;tuple&gt; = &lt;Match&gt;.groups()                     
&lt;int&gt;   = &lt;Match&gt;.start()                      
&lt;int&gt;   = &lt;Match&gt;.end()                        
</code></pre></div>

<div><h3 id="specialsequences">Special Sequences</h3><ul>
<li><strong>By default, decimal characters, alphanumerics and whitespaces from all alphabets are matched unless <code><span>&#39;flags=re.ASCII&#39;</span></code> argument is used.</strong></li>
<li><strong>As shown below, it restricts special sequence matches to the first 128 characters and prevents <code><span>&#39;\s&#39;</span></code> from accepting <code><span>&#39;[\x1c-\x1f]&#39;</span></code> (the so-called separator characters).</strong></li>
<li><strong>Use a capital letter for negation.</strong></li>
</ul><pre><code><span>&#39;\d&#39;</span> == <span>&#39;[0-9]&#39;</span>                                
<span>&#39;\w&#39;</span> == <span>&#39;[a-zA-Z0-9_]&#39;</span>                         
<span>&#39;\s&#39;</span> == <span>&#39;[ \t\n\r\f\v]&#39;</span>                        
</code></pre></div>


<div><h2 id="format"><a href="#format" name="format">#</a>Format</h2><pre><code>&lt;str&gt; = <span>f&#39;<span>{&lt;el_1&gt;}</span>, <span>{&lt;el_2&gt;}</span>&#39;</span>
&lt;str&gt; = <span>&#39;{}, {}&#39;</span>.format(&lt;el_1&gt;, &lt;el_2&gt;)
</code></pre></div>

<div><h3 id="attributes">Attributes</h3><pre><code><span>&gt;&gt;&gt; </span><span>from</span> collections <span>import</span> namedtuple
<span>&gt;&gt;&gt; </span>Person = namedtuple(<span>&#39;Person&#39;</span>, <span>&#39;name height&#39;</span>)
<span>&gt;&gt;&gt; </span>person = Person(<span>&#39;Jean-Luc&#39;</span>, <span>187</span>)
<span>&gt;&gt;&gt; </span><span>f&#39;<span>{person.height}</span>&#39;</span>
<span>&#39;187&#39;</span>
<span>&gt;&gt;&gt; </span><span>&#39;{p.height}&#39;</span>.format(p=person)
<span>&#39;187&#39;</span>
</code></pre></div>

<div><h3 id="generaloptions">General Options</h3><pre><code>{&lt;el&gt;:&lt;<span>10</span>}                                     
{&lt;el&gt;:^<span>10</span>}                                     
{&lt;el&gt;:&gt;<span>10</span>}                                     
{&lt;el&gt;:.&lt;<span>10</span>}                                    
{&lt;el&gt;:<span>0</span>}                                       
</code></pre></div>

<ul>
<li><strong>Options can be generated dynamically: <code><span>f&#39;<span>{&lt;el&gt;:{&lt;str/int&gt;}</span>[…]}&#39;</span></code>.</strong></li>
<li><strong>Adding <code><span>&#39;!r&#39;</span></code> before the colon converts object to string by calling its <a href="#class">repr()</a> method.</strong></li>
</ul>
<div><h3 id="strings">Strings</h3><pre><code>{<span>&#39;abcde&#39;</span>:<span>10</span>}                                   
{<span>&#39;abcde&#39;</span>:<span>10.3</span>}                                 
{<span>&#39;abcde&#39;</span>:<span>.3</span>}                                   
{<span>&#39;abcde&#39;</span>!r:<span>10</span>}                                 
</code></pre></div>

<div><h3 id="numbers-1">Numbers</h3><pre><code>{<span>123456</span>:<span>10</span>}                                    
{<span>123456</span>:<span>10</span>,}                                   
{<span>123456</span>:<span>10</span>_}                                   
{<span>123456</span>:+<span>10</span>}                                   
{<span>123456</span>:=+<span>10</span>}                                  
{<span>123456</span>: }                                     
{<span>-123456</span>: }                                    
</code></pre></div>

<div><h3 id="floats">Floats</h3><pre><code>{<span>1.23456</span>:<span>10.3</span>}                                 
{<span>1.23456</span>:<span>10.3</span>f}                                
{<span>1.23456</span>:<span>10.3</span>e}                                
{<span>1.23456</span>:<span>10.3</span>%}                                
</code></pre></div>

<div><h4 id="comparisonofpresentationtypes">Comparison of presentation types:</h4><pre><code>┏━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┓
┃              │    {&lt;float&gt;}   │   {&lt;float&gt;:f}  │   {&lt;float&gt;:e}  │   {&lt;float&gt;:%}  ┃
┠──────────────┼────────────────┼────────────────┼────────────────┼────────────────┨
┃  0.000056789 │   &#39;5.6789e-05&#39; │    &#39;0.000057&#39;  │ &#39;5.678900e-05&#39; │    &#39;0.005679%&#39; ┃
┃  0.00056789  │   &#39;0.00056789&#39; │    &#39;0.000568&#39;  │ &#39;5.678900e-04&#39; │    &#39;0.056789%&#39; ┃
┃  0.0056789   │   &#39;0.0056789&#39;  │    &#39;0.005679&#39;  │ &#39;5.678900e-03&#39; │    &#39;0.567890%&#39; ┃
┃  0.056789    │   &#39;0.056789&#39;   │    &#39;0.056789&#39;  │ &#39;5.678900e-02&#39; │    &#39;5.678900%&#39; ┃
┃  0.56789     │   &#39;0.56789&#39;    │    &#39;0.567890&#39;  │ &#39;5.678900e-01&#39; │   &#39;56.789000%&#39; ┃
┃  5.6789      │   &#39;5.6789&#39;     │    &#39;5.678900&#39;  │ &#39;5.678900e+00&#39; │  &#39;567.890000%&#39; ┃
┃ 56.789       │  &#39;56.789&#39;      │   &#39;56.789000&#39;  │ &#39;5.678900e+01&#39; │ &#39;5678.900000%&#39; ┃
┗━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┛
</code></pre></div>

<pre><code>┏━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━┓
┃              │  {&lt;float&gt;:.2}  │  {&lt;float&gt;:.2f} │  {&lt;float&gt;:.2e} │  {&lt;float&gt;:.2%} ┃
┠──────────────┼────────────────┼────────────────┼────────────────┼────────────────┨
┃  0.000056789 │    &#39;5.7e-05&#39;   │      &#39;0.00&#39;    │   &#39;5.68e-05&#39;   │      &#39;0.01%&#39;   ┃
┃  0.00056789  │    &#39;0.00057&#39;   │      &#39;0.00&#39;    │   &#39;5.68e-04&#39;   │      &#39;0.06%&#39;   ┃
┃  0.0056789   │    &#39;0.0057&#39;    │      &#39;0.01&#39;    │   &#39;5.68e-03&#39;   │      &#39;0.57%&#39;   ┃
┃  0.056789    │    &#39;0.057&#39;     │      &#39;0.06&#39;    │   &#39;5.68e-02&#39;   │      &#39;5.68%&#39;   ┃
┃  0.56789     │    &#39;0.57&#39;      │      &#39;0.57&#39;    │   &#39;5.68e-01&#39;   │     &#39;56.79%&#39;   ┃
┃  5.6789      │    &#39;5.7&#39;       │      &#39;5.68&#39;    │   &#39;5.68e+00&#39;   │    &#39;567.89%&#39;   ┃
┃ 56.789       │    &#39;5.7e+01&#39;   │     &#39;56.79&#39;    │   &#39;5.68e+01&#39;   │   &#39;5678.90%&#39;   ┃
┗━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━┛
</code></pre>
<ul>
<li><strong>When both rounding up and rounding down are possible, the one that returns result with even last digit is chosen. That makes <code><span>&#39;{6.5:.0f}&#39;</span></code> a <code><span>&#39;6&#39;</span></code> and <code><span>&#39;{7.5:.0f}&#39;</span></code> an <code><span>&#39;8&#39;</span></code>.</strong></li>
</ul>


<div><h2 id="numbers"><a href="#numbers" name="numbers">#</a>Numbers</h2><div><h3 id="types">Types</h3><pre><code>&lt;int&gt;      = int(&lt;float/str/bool&gt;)       
&lt;float&gt;    = float(&lt;int/str/bool&gt;)       
&lt;complex&gt;  = complex(real=<span>0</span>, imag=<span>0</span>)     
&lt;Fraction&gt; = fractions.Fraction(<span>0</span>, <span>1</span>)    
&lt;Decimal&gt;  = decimal.Decimal(&lt;str/int&gt;)  
</code></pre></div></div>


<ul>
<li><strong><code><span>&#39;int(&lt;str&gt;)&#39;</span></code> and <code><span>&#39;float(&lt;str&gt;)&#39;</span></code> raise ValueError on malformed strings.</strong></li>
<li><strong>Decimal numbers can be represented exactly, unlike floats where <code><span>&#39;1.1 + 2.2 != 3.3&#39;</span></code>.</strong></li>
<li><strong>Precision of decimal operations is set with: <code><span>&#39;decimal.getcontext().prec = &lt;int&gt;&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="basicfunctions">Basic Functions</h3><pre><code>&lt;num&gt; = pow(&lt;num&gt;, &lt;num&gt;)                
&lt;num&gt; = abs(&lt;num&gt;)                       
&lt;num&gt; = round(&lt;num&gt; [, ±ndigits])        
</code></pre></div>

<div><h3 id="math">Math</h3><pre><code><span>from</span> math <span>import</span> e, pi, inf, nan, isinf, isnan
<span>from</span> math <span>import</span> sin, cos, tan, asin, acos, atan, degrees, radians
<span>from</span> math <span>import</span> log, log10, log2
</code></pre></div>

<div><h3 id="statistics">Statistics</h3><pre><code><span>from</span> statistics <span>import</span> mean, median, variance, stdev, pvariance, pstdev
</code></pre></div>

<div><h3 id="random">Random</h3><pre><code><span>from</span> random <span>import</span> random, randint, choice, shuffle, gauss, seed

&lt;float&gt; = random()                       
&lt;int&gt;   = randint(from_inc, to_inc)      
&lt;el&gt;    = choice(&lt;list&gt;)                 
</code></pre></div>

<div><h3 id="binhex">Bin, Hex</h3><pre><code>&lt;int&gt; = ±<span>0</span>b&lt;bin&gt;                         
&lt;int&gt; = int(<span>&#39;±&lt;bin&gt;&#39;</span>, <span>2</span>)                 
&lt;int&gt; = int(<span>&#39;±0b&lt;bin&gt;&#39;</span>, <span>0</span>)               
&lt;str&gt; = bin(&lt;int&gt;)                       
</code></pre></div>

<div><h3 id="bitwiseoperators">Bitwise Operators</h3><pre><code>&lt;int&gt; = &lt;int&gt; &amp; &lt;int&gt;                    
&lt;int&gt; = &lt;int&gt; | &lt;int&gt;                    
&lt;int&gt; = &lt;int&gt; ^ &lt;int&gt;                    
&lt;int&gt; = &lt;int&gt; &lt;&lt; n_bits                  
&lt;int&gt; = ~&lt;int&gt;                           
</code></pre></div>

<div><h2 id="combinatorics"><a href="#combinatorics" name="combinatorics">#</a>Combinatorics</h2><ul>
<li><strong>Every function returns an iterator.</strong></li>
<li><strong>If you want to print the iterator, you need to pass it to the list() function first!</strong></li>
</ul><pre><code><span>from</span> itertools <span>import</span> product, combinations, combinations_with_replacement, permutations
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>product([<span>0</span>, <span>1</span>], repeat=<span>3</span>)
[(<span>0</span>, <span>0</span>, <span>0</span>), (<span>0</span>, <span>0</span>, <span>1</span>), (<span>0</span>, <span>1</span>, <span>0</span>), (<span>0</span>, <span>1</span>, <span>1</span>), ..., (<span>1</span>, <span>1</span>, <span>1</span>)]
</code></pre>
<pre><code><span>&gt;&gt;&gt; </span>product(<span>&#39;abc&#39;</span>, <span>&#39;abc&#39;</span>)                    
[(<span>&#39;a&#39;</span>, <span>&#39;a&#39;</span>), (<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;a&#39;</span>, <span>&#39;c&#39;</span>),         
 (<span>&#39;b&#39;</span>, <span>&#39;a&#39;</span>), (<span>&#39;b&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;b&#39;</span>, <span>&#39;c&#39;</span>),         
 (<span>&#39;c&#39;</span>, <span>&#39;a&#39;</span>), (<span>&#39;c&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;c&#39;</span>, <span>&#39;c&#39;</span>)]         
</code></pre>
<pre><code><span>&gt;&gt;&gt; </span>combinations(<span>&#39;abc&#39;</span>, <span>2</span>)                   
[(<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;a&#39;</span>, <span>&#39;c&#39;</span>),                     
 (<span>&#39;b&#39;</span>, <span>&#39;c&#39;</span>)]                                 
</code></pre>
<pre><code><span>&gt;&gt;&gt; </span>combinations_with_replacement(<span>&#39;abc&#39;</span>, <span>2</span>)  
[(<span>&#39;a&#39;</span>, <span>&#39;a&#39;</span>), (<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;a&#39;</span>, <span>&#39;c&#39;</span>),         
 (<span>&#39;b&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;b&#39;</span>, <span>&#39;c&#39;</span>),                     
 (<span>&#39;c&#39;</span>, <span>&#39;c&#39;</span>)]                                 
</code></pre>
<pre><code><span>&gt;&gt;&gt; </span>permutations(<span>&#39;abc&#39;</span>, <span>2</span>)                   
[(<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>), (<span>&#39;a&#39;</span>, <span>&#39;c&#39;</span>),                     
 (<span>&#39;b&#39;</span>, <span>&#39;a&#39;</span>), (<span>&#39;b&#39;</span>, <span>&#39;c&#39;</span>),                     
 (<span>&#39;c&#39;</span>, <span>&#39;a&#39;</span>), (<span>&#39;c&#39;</span>, <span>&#39;b&#39;</span>)]                     
</code></pre>
<div><h2 id="datetime"><a href="#datetime" name="datetime">#</a>Datetime</h2><ul>
<li><strong>Module &#39;datetime&#39; provides &#39;date&#39; <code><span>&lt;D&gt;</span></code>, &#39;time&#39; <code><span>&lt;T&gt;</span></code>, &#39;datetime&#39; <code><span>&lt;DT&gt;</span></code> and &#39;timedelta&#39; <code><span>&lt;TD&gt;</span></code> classes. All are immutable and hashable.</strong></li>
<li><strong>Time and datetime objects can be &#39;aware&#39; <code><span>&lt;a&gt;</span></code>, meaning they have defined timezone, or &#39;naive&#39; <code><span>&lt;n&gt;</span></code>, meaning they don&#39;t.</strong></li>
<li><strong>If object is naive, it is presumed to be in the system&#39;s timezone.</strong></li>
</ul><pre><code><span>from</span> datetime <span>import</span> date, time, datetime, timedelta
<span>from</span> dateutil.tz <span>import</span> UTC, tzlocal, gettz, datetime_exists, resolve_imaginary
</code></pre></div>


<div><h3 id="constructors">Constructors</h3><pre><code>&lt;D&gt;  = date(year, month, day)
&lt;T&gt;  = time(hour=<span>0</span>, minute=<span>0</span>, second=<span>0</span>, microsecond=<span>0</span>, tzinfo=<span>None</span>, fold=<span>0</span>)
&lt;DT&gt; = datetime(year, month, day, hour=<span>0</span>, minute=<span>0</span>, second=<span>0</span>, ...)
&lt;TD&gt; = timedelta(weeks=<span>0</span>, days=<span>0</span>, hours=<span>0</span>, minutes=<span>0</span>, seconds=<span>0</span>, ...)
</code></pre></div>

<ul>
<li><strong>Use <code><span>&#39;&lt;D/DT&gt;.weekday()&#39;</span></code> to get the day of the week (Mon == 0).</strong></li>
<li><strong><code><span>&#39;fold=1&#39;</span></code> means the second pass in case of time jumping back for one hour.</strong></li>
<li><strong>TD converts and normalizes args to ±days, seconds (&lt; 86 400) and microseconds (&lt; 1M).</strong></li>
</ul>
<div><h3 id="now">Now</h3><pre><code>&lt;D/DTn&gt;  = D/DT.today()                     
&lt;DTn&gt;    = DT.utcnow()                      
&lt;DTa&gt;    = DT.now(&lt;tzinfo&gt;)                 
</code></pre></div>

<ul>
<li><strong>To extract time use <code><span>&#39;&lt;DTn&gt;.time()&#39;</span></code>, <code><span>&#39;&lt;DTa&gt;.time()&#39;</span></code> or <code><span>&#39;&lt;DTa&gt;.timetz()&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="timezone">Timezone</h3><pre><code>&lt;tzinfo&gt; = UTC                              
&lt;tzinfo&gt; = tzlocal()                        
&lt;tzinfo&gt; = gettz(<span>&#39;&lt;Continent&gt;/&lt;City&gt;&#39;</span>)      
&lt;DTa&gt;    = &lt;DT&gt;.astimezone(&lt;tzinfo&gt;)        
&lt;Ta/DTa&gt; = &lt;T/DT&gt;.replace(tzinfo=&lt;tzinfo&gt;)  
</code></pre></div>

<div><h3 id="encode">Encode</h3><pre><code>&lt;D/T/DT&gt; = D/T/DT.fromisoformat(<span>&#39;&lt;iso&gt;&#39;</span>)    
&lt;DT&gt;     = DT.strptime(&lt;str&gt;, <span>&#39;&lt;format&gt;&#39;</span>)   
&lt;D/DTn&gt;  = D/DT.fromordinal(&lt;int&gt;)          
&lt;DTn&gt;    = DT.fromtimestamp(&lt;real&gt;)         
&lt;DTa&gt;    = DT.fromtimestamp(&lt;real&gt;, &lt;tz.&gt;)  
</code></pre></div>

<ul>
<li><strong>ISO strings come in following forms: <code><span>&#39;YYYY-MM-DD&#39;</span></code>, <code><span>&#39;HH:MM:SS.ffffff[±&lt;offset&gt;]&#39;</span></code>, or both separated by an arbitrary character. Offset is formatted as: <code><span>&#39;HH:MM&#39;</span></code>.</strong></li>
<li><strong>Epoch on Unix systems is: <code><span>&#39;1970-01-01 00:00 UTC&#39;</span></code>, <code><span>&#39;1970-01-01 01:00 CET&#39;</span></code>, …</strong></li>
</ul>
<div><h3 id="decode">Decode</h3><pre><code>&lt;str&gt;    = &lt;D/T/DT&gt;.isoformat(sep=<span>&#39;T&#39;</span>)      
&lt;str&gt;    = &lt;D/T/DT&gt;.strftime(<span>&#39;&lt;format&gt;&#39;</span>)    
&lt;int&gt;    = &lt;D/DT&gt;.toordinal()               
&lt;float&gt;  = &lt;DTn&gt;.timestamp()                
&lt;float&gt;  = &lt;DTa&gt;.timestamp()                
</code></pre></div>

<div><h3 id="format-1">Format</h3><pre><code><span>&gt;&gt;&gt; </span>dt = datetime.strptime(<span>&#39;2015-05-14 23:39:00.00 +0200&#39;</span>, <span>&#39;%Y-%m-%d %H:%M:%S.%f %z&#39;</span>)
<span>&gt;&gt;&gt; </span>dt.strftime(<span>&#34;%A, %dth of %B &#39;%y, %I:%M%p %Z&#34;</span>)
<span>&#34;Thursday, 14th of May &#39;15, 11:39PM UTC+02:00&#34;</span>
</code></pre></div>

<ul>
<li><strong><code><span>&#39;%Z&#39;</span></code> only accepts <code><span>&#39;UTC/GMT&#39;</span></code> and local timezone&#39;s code. <code><span>&#39;%z&#39;</span></code> also accepts <code><span>&#39;±HH:MM&#39;</span></code>.</strong></li>
<li><strong>For abbreviated weekday and month use <code><span>&#39;%a&#39;</span></code> and <code><span>&#39;%b&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="arithmetics">Arithmetics</h3><pre><code>&lt;D/DT&gt;   = &lt;D/DT&gt;  ± &lt;TD&gt;                   
&lt;TD&gt;     = &lt;D/DTn&gt; - &lt;D/DTn&gt;                
&lt;TD&gt;     = &lt;DTa&gt;   - &lt;DTa&gt;                  
&lt;TD&gt;     = &lt;TD&gt;    * &lt;real&gt;                 
&lt;float&gt;  = &lt;TD&gt;    / &lt;TD&gt;                   
</code></pre></div>

<div><h2 id="arguments"><a href="#arguments" name="arguments">#</a>Arguments</h2><div><h3 id="insidefunctioncall">Inside Function Call</h3><pre><code>&lt;function&gt;(&lt;positional_args&gt;)                  
&lt;function&gt;(&lt;keyword_args&gt;)                     
&lt;function&gt;(&lt;positional_args&gt;, &lt;keyword_args&gt;)  
</code></pre></div></div>


<div><h3 id="insidefunctiondefinition">Inside Function Definition</h3><pre><code><span><span>def</span> <span>f</span><span>(&lt;nondefault_args&gt;)</span>:</span>                      
<span><span>def</span> <span>f</span><span>(&lt;default_args&gt;)</span>:</span>                         
<span><span>def</span> <span>f</span><span>(&lt;nondefault_args&gt;, &lt;default_args&gt;)</span>:</span>      
</code></pre></div>

<div><h2 id="splatoperator"><a href="#splatoperator" name="splatoperator">#</a>Splat Operator</h2><div><h3 id="insidefunctioncall-1">Inside Function Call</h3><p><strong>Splat expands a collection into positional arguments, while splatty-splat expands a dictionary into keyword arguments.</strong></p><pre><code>args   = (<span>1</span>, <span>2</span>)
kwargs = {<span>&#39;x&#39;</span>: <span>3</span>, <span>&#39;y&#39;</span>: <span>4</span>, <span>&#39;z&#39;</span>: <span>5</span>}
func(*args, **kwargs)
</code></pre></div></div>



<div><h4 id="isthesameas">Is the same as:</h4><pre><code>func(<span>1</span>, <span>2</span>, x=<span>3</span>, y=<span>4</span>, z=<span>5</span>)
</code></pre></div>

<div><h3 id="insidefunctiondefinition-1">Inside Function Definition</h3><p><strong>Splat combines zero or more positional arguments into a tuple, while splatty-splat combines zero or more keyword arguments into a dictionary.</strong></p><pre><code><span><span>def</span> <span>add</span><span>(*a)</span>:</span>
    <span>return</span> sum(a)
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>add(<span>1</span>, <span>2</span>, <span>3</span>)
<span>6</span>
</code></pre>
<div><h4 id="legalargumentcombinations">Legal argument combinations:</h4><pre><code><span><span>def</span> <span>f</span><span>(x, y, z)</span>:</span>                
<span><span>def</span> <span>f</span><span>(*, x, y, z)</span>:</span>             
<span><span>def</span> <span>f</span><span>(x, *, y, z)</span>:</span>             
<span><span>def</span> <span>f</span><span>(x, y, *, z)</span>:</span>             
</code></pre></div>

<pre><code><span><span>def</span> <span>f</span><span>(*args)</span>:</span>                  
<span><span>def</span> <span>f</span><span>(x, *args)</span>:</span>               
<span><span>def</span> <span>f</span><span>(*args, z)</span>:</span>               
<span><span>def</span> <span>f</span><span>(x, *args, z)</span>:</span>            
</code></pre>
<pre><code><span><span>def</span> <span>f</span><span>(**kwargs)</span>:</span>               
<span><span>def</span> <span>f</span><span>(x, **kwargs)</span>:</span>            
<span><span>def</span> <span>f</span><span>(*, x, **kwargs)</span>:</span>         
</code></pre>
<pre><code><span><span>def</span> <span>f</span><span>(*args, **kwargs)</span>:</span>        
<span><span>def</span> <span>f</span><span>(x, *args, **kwargs)</span>:</span>     
<span><span>def</span> <span>f</span><span>(*args, y, **kwargs)</span>:</span>     
<span><span>def</span> <span>f</span><span>(x, *args, z, **kwargs)</span>:</span>  
</code></pre>
<div><h3 id="otheruses">Other Uses</h3><pre><code>&lt;list&gt;  = [*&lt;collection&gt; [, ...]]
&lt;set&gt;   = {*&lt;collection&gt; [, ...]}
&lt;tuple&gt; = (*&lt;collection&gt;, [...])
&lt;dict&gt;  = {**&lt;dict&gt; [, ...]}
</code></pre></div>

<pre><code>head, *body, tail = &lt;collection&gt;
</code></pre>
<div><h2 id="inline"><a href="#inline" name="inline">#</a>Inline</h2><div><h3 id="lambda">Lambda</h3><pre><code>&lt;func&gt; = <span>lambda</span>: &lt;return_value&gt;
&lt;func&gt; = <span>lambda</span> &lt;arg_1&gt;, &lt;arg_2&gt;: &lt;return_value&gt;
</code></pre></div></div>


<div><h3 id="comprehensions">Comprehensions</h3><pre><code>&lt;list&gt; = [i+<span>1</span> <span>for</span> i <span>in</span> range(<span>10</span>)]                         
&lt;set&gt;  = {i <span>for</span> i <span>in</span> range(<span>10</span>) <span>if</span> i &gt; <span>5</span>}                  
&lt;iter&gt; = (i+<span>5</span> <span>for</span> i <span>in</span> range(<span>10</span>))                         
&lt;dict&gt; = {i: i*<span>2</span> <span>for</span> i <span>in</span> range(<span>10</span>)}                      
</code></pre></div>

<pre><code><span>&gt;&gt;&gt; </span>[l+r <span>for</span> l <span>in</span> <span>&#39;abc&#39;</span> <span>for</span> r <span>in</span> <span>&#39;abc&#39;</span>]
[<span>&#39;aa&#39;</span>, <span>&#39;ab&#39;</span>, <span>&#39;ac&#39;</span>, ..., <span>&#39;cc&#39;</span>]
</code></pre>
<div><h3 id="mapfilterreduce">Map, Filter, Reduce</h3><pre><code>&lt;iter&gt; = map(<span>lambda</span> x: x + <span>1</span>, range(<span>10</span>))                  
&lt;iter&gt; = filter(<span>lambda</span> x: x &gt; <span>5</span>, range(<span>10</span>))               
&lt;obj&gt;  = reduce(<span>lambda</span> out, x: out + x, range(<span>10</span>))        
</code></pre></div>

<ul>
<li><strong>Reduce must be imported from the functools module.</strong></li>
</ul>
<div><h3 id="anyall">Any, All</h3><pre><code>&lt;bool&gt; = any(&lt;collection&gt;)                                
&lt;bool&gt; = all(&lt;collection&gt;)                                
</code></pre></div>

<div><h3 id="conditionalexpression">Conditional Expression</h3><pre><code>&lt;obj&gt; = &lt;exp_if_true&gt; <span>if</span> &lt;condition&gt; <span>else</span> &lt;exp_if_false&gt;
</code></pre></div>

<pre><code><span>&gt;&gt;&gt; </span>[a <span>if</span> a <span>else</span> <span>&#39;zero&#39;</span> <span>for</span> a <span>in</span> (<span>0</span>, <span>1</span>, <span>2</span>, <span>3</span>)]
[<span>&#39;zero&#39;</span>, <span>1</span>, <span>2</span>, <span>3</span>]
</code></pre>
<div><h3 id="namedtupleenumdataclass">Named Tuple, Enum, Dataclass</h3><pre><code><span>from</span> collections <span>import</span> namedtuple
Point = namedtuple(<span>&#39;Point&#39;</span>, <span>&#39;x y&#39;</span>)
point = Point(<span>0</span>, <span>0</span>)
</code></pre></div>

<pre><code><span>from</span> enum <span>import</span> Enum
Direction = Enum(<span>&#39;Direction&#39;</span>, <span>&#39;n e s w&#39;</span>)
direction = Direction.n
</code></pre>
<pre><code><span>from</span> dataclasses <span>import</span> make_dataclass
Creature = make_dataclass(<span>&#39;Creature&#39;</span>, [<span>&#39;loc&#39;</span>, <span>&#39;dir&#39;</span>])
creature = Creature(point, direction)
</code></pre>
<div><h2 id="imports"><a href="#imports" name="imports">#</a>Imports</h2><pre><code><span>import</span> &lt;module&gt;            
<span>import</span> &lt;package&gt;           
<span>import</span> &lt;package&gt;.&lt;module&gt;  
</code></pre></div>

<ul>
<li><strong>Package is a collection of modules, but it can also define its own objects.</strong></li>
<li><strong>On a filesystem this corresponds to a directory of Python files with an optional init script.</strong></li>
<li><strong>Running <code><span>&#39;import &lt;package&gt;&#39;</span></code> does not automatically provide access to the package&#39;s modules unless they are explicitly imported in its init script.</strong></li>
</ul>
<div><h2 id="closure"><a href="#closure" name="closure">#</a>Closure</h2><p><strong>We have/get a closure in Python when:</strong></p><ul>
<li><strong>A nested function references a value of its enclosing function and then</strong></li>
<li><strong>the enclosing function returns the nested function.</strong></li>
</ul><pre><code><span><span>def</span> <span>get_multiplier</span><span>(a)</span>:</span>
    <span><span>def</span> <span>out</span><span>(b)</span>:</span>
        <span>return</span> a * b
    <span>return</span> out
</code></pre></div>



<pre><code><span>&gt;&gt;&gt; </span>multiply_by_3 = get_multiplier(<span>3</span>)
<span>&gt;&gt;&gt; </span>multiply_by_3(<span>10</span>)
<span>30</span>
</code></pre>
<ul>
<li><strong>If multiple nested functions within enclosing function reference the same value, that value gets shared.</strong></li>
<li><strong>To dynamically access function&#39;s first free variable use <code><span>&#39;&lt;function&gt;.__closure__[0].cell_contents&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="partial">Partial</h3><pre><code><span>from</span> functools <span>import</span> partial
&lt;function&gt; = partial(&lt;function&gt; [, &lt;arg_1&gt;, &lt;arg_2&gt;, ...])
</code></pre></div>

<pre><code><span>&gt;&gt;&gt; </span><span>import</span> operator <span>as</span> op
<span>&gt;&gt;&gt; </span>multiply_by_3 = partial(op.mul, <span>3</span>)
<span>&gt;&gt;&gt; </span>multiply_by_3(<span>10</span>)
<span>30</span>
</code></pre>
<ul>
<li><strong>Partial is also useful in cases when function needs to be passed as an argument because it enables us to set its arguments beforehand.</strong></li>
<li><strong>A few examples being: <code><span>&#39;defaultdict(&lt;function&gt;)&#39;</span></code>, <code><span>&#39;iter(&lt;function&gt;, to_exclusive)&#39;</span></code> and dataclass&#39;s <code><span>&#39;field(default_factory=&lt;function&gt;)&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="nonlocal">Non-Local</h3><p><strong>If variable is being assigned to anywhere in the scope, it is regarded as a local variable, unless it is declared as a &#39;global&#39; or a &#39;nonlocal&#39;.</strong></p><pre><code><span><span>def</span> <span>get_counter</span><span>()</span>:</span>
    i = <span>0</span>
    <span><span>def</span> <span>out</span><span>()</span>:</span>
        <span>nonlocal</span> i
        i += <span>1</span>
        <span>return</span> i
    <span>return</span> out
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>counter = get_counter()
<span>&gt;&gt;&gt; </span>counter(), counter(), counter()
(<span>1</span>, <span>2</span>, <span>3</span>)
</code></pre>
<div><h2 id="decorator"><a href="#decorator" name="decorator">#</a>Decorator</h2><ul>
<li><strong>A decorator takes a function, adds some functionality and returns it.</strong></li>
<li><strong>It can be any <a href="#callable">callable</a>, but is usually implemented as a function that returns a <a href="#closure">closure</a>.</strong></li>
</ul><pre><code><span>@decorator_name</span>
<span><span>def</span> <span>function_that_gets_passed_to_decorator</span><span>()</span>:</span>
    ...
</code></pre></div>


<div><h3 id="debuggerexample">Debugger Example</h3><p><strong>Decorator that prints function&#39;s name every time it gets called.</strong></p><pre><code><span>from</span> functools <span>import</span> wraps

<span><span>def</span> <span>debug</span><span>(func)</span>:</span>
<span>    @wraps(func)</span>
    <span><span>def</span> <span>out</span><span>(*args, **kwargs)</span>:</span>
        print(func.__name__)
        <span>return</span> func(*args, **kwargs)
    <span>return</span> out

<span>@debug</span>
<span><span>def</span> <span>add</span><span>(x, y)</span>:</span>
    <span>return</span> x + y
</code></pre></div>


<ul>
<li><strong>Wraps is a helper decorator that copies the metadata of the passed function (func) to the function it is wrapping (out).</strong></li>
<li><strong>Without it <code><span>&#39;add.__name__&#39;</span></code> would return <code><span>&#39;out&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="lrucache">LRU Cache</h3><p><strong>Decorator that caches function&#39;s return values. All function&#39;s arguments must be hashable.</strong></p><pre><code><span>from</span> functools <span>import</span> lru_cache

<span>@lru_cache(maxsize=None)</span>
<span><span>def</span> <span>fib</span><span>(n)</span>:</span>
    <span>return</span> n <span>if</span> n &lt; <span>2</span> <span>else</span> fib(n-<span>2</span>) + fib(n-<span>1</span>)
</code></pre></div>


<ul>
<li><strong>CPython interpreter limits recursion depth to 1000 by default. To increase it use <code><span>&#39;sys.setrecursionlimit(&lt;depth&gt;)&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="parametrizeddecorator">Parametrized Decorator</h3><p><strong>A decorator that accepts arguments and returns a normal decorator that accepts a function.</strong></p><pre><code><span>from</span> functools <span>import</span> wraps

<span><span>def</span> <span>debug</span><span>(print_result=False)</span>:</span>
    <span><span>def</span> <span>decorator</span><span>(func)</span>:</span>
<span>        @wraps(func)</span>
        <span><span>def</span> <span>out</span><span>(*args, **kwargs)</span>:</span>
            result = func(*args, **kwargs)
            print(func.__name__, result <span>if</span> print_result <span>else</span> <span>&#39;&#39;</span>)
            <span>return</span> result
        <span>return</span> out
    <span>return</span> decorator

<span>@debug(print_result=True)</span>
<span><span>def</span> <span>add</span><span>(x, y)</span>:</span>
    <span>return</span> x + y
</code></pre></div>


<div><h2 id="class"><a href="#class" name="class">#</a>Class</h2><pre><code><span><span>class</span> &lt;<span>name</span>&gt;:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__repr__</span><span>(self)</span>:</span>
        class_name = self.__class__.__name__
        <span>return</span> <span>f&#39;<span>{class_name}</span>(<span>{self.a!r}</span>)&#39;</span>
    <span><span>def</span> <span>__str__</span><span>(self)</span>:</span>
        <span>return</span> str(self.a)

<span>    @classmethod</span>
    <span><span>def</span> <span>get_class_name</span><span>(cls)</span>:</span>
        <span>return</span> cls.__name__
</code></pre></div>

<ul>
<li><strong>Return value of repr() should be unambiguous and of str() readable.</strong></li>
<li><strong>If only repr() is defined, it will also be used for str().</strong></li>
</ul>
<div><h4 id="strusecases">Str() use cases:</h4><pre><code>print(&lt;el&gt;)
print(<span>f&#39;<span>{&lt;el&gt;}</span>&#39;</span>)
<span>raise</span> Exception(&lt;el&gt;)
csv.writer(&lt;file&gt;).writerow([&lt;el&gt;])
logging.warning(&lt;el&gt;)
</code></pre></div>

<div><h4 id="reprusecases">Repr() use cases:</h4><pre><code>print([&lt;el&gt;])
print(<span>f&#39;<span>{&lt;el&gt;!r}</span>&#39;</span>)
<span>&gt;&gt;&gt; </span>&lt;el&gt;
Z = dataclasses.make_dataclass(<span>&#39;Z&#39;</span>, [<span>&#39;a&#39;</span>]); print(Z(&lt;el&gt;))
</code></pre></div>

<div><h3 id="constructoroverloading">Constructor Overloading</h3><pre><code><span><span>class</span> &lt;<span>name</span>&gt;:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a=<span>None</span>)</span>:</span>
        self.a = a
</code></pre></div>

<div><h3 id="inheritance">Inheritance</h3><pre><code><span><span>class</span> <span>Person</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, name, age)</span>:</span>
        self.name = name
        self.age  = age

<span><span>class</span> <span>Employee</span><span>(Person)</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, name, age, staff_num)</span>:</span>
        super().__init__(name, age)
        self.staff_num = staff_num
</code></pre></div>

<div><h3 id="multipleinheritance">Multiple Inheritance</h3><pre><code><span><span>class</span> <span>A</span>:</span> <span>pass</span>
<span><span>class</span> <span>B</span>:</span> <span>pass</span>
<span><span>class</span> <span>C</span><span>(A, B)</span>:</span> <span>pass</span>
</code></pre></div>

<p><strong>MRO determines the order in which parent classes are traversed when searching for a method:</strong></p>
<pre><code><span>&gt;&gt;&gt; </span>C.mro()
[&lt;<span><span>class</span> &#39;<span>C</span>&#39;&gt;, &lt;<span>class</span> &#39;<span>A</span>&#39;&gt;, &lt;<span>class</span> &#39;<span>B</span>&#39;&gt;, &lt;<span>class</span> &#39;<span>object</span>&#39;&gt;]
</span></code></pre>
<div><h3 id="property">Property</h3><p><strong>Pythonic way of implementing getters and setters.</strong></p><pre><code><span><span>class</span> <span>MyClass</span>:</span>
<span>    @property</span>
    <span><span>def</span> <span>a</span><span>(self)</span>:</span>
        <span>return</span> self._a

<span>    @a.setter</span>
    <span><span>def</span> <span>a</span><span>(self, value)</span>:</span>
        self._a = value
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>obj = MyClass()
<span>&gt;&gt;&gt; </span>obj.a = <span>123</span>
<span>&gt;&gt;&gt; </span>obj.a
<span>123</span>
</code></pre>
<div><h3 id="dataclass">Dataclass</h3><p><strong>Decorator that automatically generates init(), repr() and eq() special methods.</strong></p><pre><code><span>from</span> dataclasses <span>import</span> dataclass, field

<span>@dataclass(order=False, frozen=False)</span>
<span><span>class</span> &lt;<span>class_name</span>&gt;:</span>
    &lt;attr_name_1&gt;: &lt;type&gt;
    &lt;attr_name_2&gt;: &lt;type&gt; = &lt;default_value&gt;
    &lt;attr_name_3&gt;: list/dict/set = field(default_factory=list/dict/set)
</code></pre></div>


<ul>
<li><strong>Objects can be made <a href="#sortable">sortable</a> with <code><span>&#39;order=True&#39;</span></code> and immutable with <code><span>&#39;frozen=True&#39;</span></code>.</strong></li>
<li><strong>For object to be hashable, all attributes must be hashable and frozen must be True.</strong></li>
<li><strong>Function field() is needed because <code><span>&#39;&lt;attr_name&gt;: list = []&#39;</span></code> would make a list that is shared among all instances. Its &#39;default_factory&#39; argument can be any <a href="#callable">callable</a>.</strong></li>
<li><strong>For attributes of arbitrary type use <code><span>&#39;typing.Any&#39;</span></code>.</strong></li>
</ul>
<div><h4 id="inline-1">Inline:</h4><pre><code><span>from</span> dataclasses <span>import</span> make_dataclass
&lt;class&gt; = make_dataclass(<span>&#39;&lt;class_name&gt;&#39;</span>, &lt;coll_of_attribute_names&gt;)
&lt;class&gt; = make_dataclass(<span>&#39;&lt;class_name&gt;&#39;</span>, &lt;coll_of_tuples&gt;)
&lt;tuple&gt; = (<span>&#39;&lt;attr_name&gt;&#39;</span>, &lt;type&gt; [, &lt;default_value&gt;])</code></pre></div>

<div><h3 id="slots">Slots</h3><p><strong>Mechanism that restricts objects to attributes listed in &#39;slots&#39; and significantly reduces their memory footprint.</strong></p><pre><code><span><span>class</span> <span>MyClassWithSlots</span>:</span>
    __slots__ = [<span>&#39;a&#39;</span>]
    <span><span>def</span> <span>__init__</span><span>(self)</span>:</span>
        self.a = <span>1</span>
</code></pre></div>


<div><h3 id="copy">Copy</h3><pre><code><span>from</span> copy <span>import</span> copy, deepcopy

&lt;object&gt; = copy(&lt;object&gt;)
&lt;object&gt; = deepcopy(&lt;object&gt;)
</code></pre></div>

<div><h2 id="ducktypes"><a href="#ducktypes" name="ducktypes">#</a>Duck Types</h2><p><strong>A duck type is an implicit type that prescribes a set of special methods. Any object that has those methods defined is considered a member of that duck type.</strong></p><div><h3 id="comparable">Comparable</h3><ul>
<li><strong>If eq() method is not overridden, it returns <code><span>&#39;id(self) == id(other)&#39;</span></code>, which is the same as <code><span>&#39;self is other&#39;</span></code>.</strong></li>
<li><strong>That means all objects compare not equal by default.</strong></li>
<li><strong>Only the left side object has eq() method called, unless it returns NotImplemented, in which case the right object is consulted.</strong></li>
<li><strong>Ne() automatically works on any object that has eq() defined.</strong></li>
</ul><pre><code><span><span>class</span> <span>MyComparable</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__eq__</span><span>(self, other)</span>:</span>
        <span>if</span> isinstance(other, type(self)):
            <span>return</span> self.a == other.a
        <span>return</span> <span>NotImplemented</span>
</code></pre></div></div>




<div><h3 id="hashable">Hashable</h3><ul>
<li><strong>Hashable object needs both hash() and eq() methods and its hash value should never change.</strong></li>
<li><strong>Hashable objects that compare equal must have the same hash value, meaning default hash() that returns <code><span>&#39;id(self)&#39;</span></code> will not do.</strong></li>
<li><strong>That is why Python automatically makes classes unhashable if you only implement eq().</strong></li>
</ul><pre><code><span><span>class</span> <span>MyHashable</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self._a = a
<span>    @property</span>
    <span><span>def</span> <span>a</span><span>(self)</span>:</span>
        <span>return</span> self._a
    <span><span>def</span> <span>__eq__</span><span>(self, other)</span>:</span>
        <span>if</span> isinstance(other, type(self)):
            <span>return</span> self.a == other.a
        <span>return</span> <span>NotImplemented</span>
    <span><span>def</span> <span>__hash__</span><span>(self)</span>:</span>
        <span>return</span> hash(self.a)
</code></pre></div>


<div><h3 id="sortable">Sortable</h3><ul>
<li><strong>With total_ordering decorator, you only need to provide eq() and one of lt(), gt(), le() or ge() special methods and the rest will be automatically generated.</strong></li>
<li><strong>Functions sorted() and min() only require lt() method, while max() only requires gt(). However, it is best to define them all so that confusion doesn&#39;t arise in other contexts.</strong></li>
<li><strong>When two lists, strings or dataclasses are compared, their values get compared in order until a pair of unequal values is found. The comparison of this two values is then returned. The shorter sequence is considered smaller in case of all values being equal.</strong></li>
</ul><pre><code><span>from</span> functools <span>import</span> total_ordering

<span>@total_ordering</span>
<span><span>class</span> <span>MySortable</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__eq__</span><span>(self, other)</span>:</span>
        <span>if</span> isinstance(other, type(self)):
            <span>return</span> self.a == other.a
        <span>return</span> <span>NotImplemented</span>
    <span><span>def</span> <span>__lt__</span><span>(self, other)</span>:</span>
        <span>if</span> isinstance(other, type(self)):
            <span>return</span> self.a &lt; other.a
        <span>return</span> <span>NotImplemented</span>
</code></pre></div>


<div><h3 id="iterator-1">Iterator</h3><ul>
<li><strong>Any object that has methods next() and iter() is an iterator.</strong></li>
<li><strong>Next() should return next item or raise StopIteration.</strong></li>
<li><strong>Iter() should return &#39;self&#39;.</strong></li>
</ul><pre><code><span><span>class</span> <span>Counter</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self)</span>:</span>
        self.i = <span>0</span>
    <span><span>def</span> <span>__next__</span><span>(self)</span>:</span>
        self.i += <span>1</span>
        <span>return</span> self.i
    <span><span>def</span> <span>__iter__</span><span>(self)</span>:</span>
        <span>return</span> self
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>counter = Counter()
<span>&gt;&gt;&gt; </span>next(counter), next(counter), next(counter)
(<span>1</span>, <span>2</span>, <span>3</span>)
</code></pre>
<div><h4 id="pythonhasmanydifferentiteratorobjects">Python has many different iterator objects:</h4><ul>
<li><strong>Sequence iterators returned by the <a href="#iterator">iter()</a> function, such as list_iterator and set_iterator.</strong></li>
<li><strong>Objects returned by the <a href="#itertools">itertools</a> module, such as count, repeat and cycle.</strong></li>
<li><strong>Generators returned by the <a href="#generator">generator functions</a> and <a href="#comprehensions">generator expressions</a>.</strong></li>
<li><strong>File objects returned by the <a href="#open">open()</a> function, etc.</strong></li>
</ul><div><h3 id="callable">Callable</h3><ul>
<li><strong>All functions and classes have a call() method, hence are callable.</strong></li>
<li><strong>When this cheatsheet uses <code><span>&#39;&lt;function&gt;&#39;</span></code> as an argument, it actually means <code><span>&#39;&lt;callable&gt;&#39;</span></code>.</strong></li>
</ul><pre><code><span><span>class</span> <span>Counter</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self)</span>:</span>
        self.i = <span>0</span>
    <span><span>def</span> <span>__call__</span><span>(self)</span>:</span>
        self.i += <span>1</span>
        <span>return</span> self.i
</code></pre></div></div>




<pre><code><span>&gt;&gt;&gt; </span>counter = Counter()
<span>&gt;&gt;&gt; </span>counter(), counter(), counter()
(<span>1</span>, <span>2</span>, <span>3</span>)
</code></pre>
<div><h3 id="contextmanager">Context Manager</h3><ul>
<li><strong>Enter() should lock the resources and optionally return an object.</strong></li>
<li><strong>Exit() should release the resources.</strong></li>
<li><strong>Any exception that happens inside the with block is passed to the exit() method.</strong></li>
<li><strong>If it wishes to suppress the exception it must return a true value.</strong></li>
</ul><pre><code><span><span>class</span> <span>MyOpen</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, filename)</span>:</span>
        self.filename = filename
    <span><span>def</span> <span>__enter__</span><span>(self)</span>:</span>
        self.file = open(self.filename)
        <span>return</span> self.file
    <span><span>def</span> <span>__exit__</span><span>(self, exc_type, exception, traceback)</span>:</span>
        self.file.close()
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span><span>with</span> open(<span>&#39;test.txt&#39;</span>, <span>&#39;w&#39;</span>) <span>as</span> file:
<span>... </span>    file.write(<span>&#39;Hello World!&#39;</span>)
<span>&gt;&gt;&gt; </span><span>with</span> MyOpen(<span>&#39;test.txt&#39;</span>) <span>as</span> file:
<span>... </span>    print(file.read())
Hello World!
</code></pre>
<div><h2 id="iterableducktypes"><a href="#iterableducktypes" name="iterableducktypes">#</a>Iterable Duck Types</h2><div><h3 id="iterable">Iterable</h3><ul>
<li><strong>Only required method is iter(). It should return an iterator of object&#39;s items.</strong></li>
<li><strong>Contains() automatically works on any object that has iter() defined.</strong></li>
</ul><pre><code><span><span>class</span> <span>MyIterable</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__iter__</span><span>(self)</span>:</span>
        <span>return</span> iter(self.a)
    <span><span>def</span> <span>__contains__</span><span>(self, el)</span>:</span>
        <span>return</span> el <span>in</span> self.a
</code></pre></div></div>



<pre><code><span>&gt;&gt;&gt; </span>obj = MyIterable([<span>1</span>, <span>2</span>, <span>3</span>])
<span>&gt;&gt;&gt; </span>[el <span>for</span> el <span>in</span> obj]
[<span>1</span>, <span>2</span>, <span>3</span>]
<span>&gt;&gt;&gt; </span><span>1</span> <span>in</span> obj
<span>True</span>
</code></pre>
<div><h3 id="collection">Collection</h3><ul>
<li><strong>Only required methods are iter() and len().</strong></li>
<li><strong>This cheatsheet actually means <code><span>&#39;&lt;iterable&gt;&#39;</span></code> when it uses <code><span>&#39;&lt;collection&gt;&#39;</span></code>.</strong></li>
<li><strong>I chose not to use the name &#39;iterable&#39; because it sounds scarier and more vague than &#39;collection&#39;. The only drawback of this decision is that a reader could think a certain function doesn&#39;t accept iterators when it does, since iterators are the only iterable objects that are not collections.</strong></li>
</ul><pre><code><span><span>class</span> <span>MyCollection</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__iter__</span><span>(self)</span>:</span>
        <span>return</span> iter(self.a)
    <span><span>def</span> <span>__contains__</span><span>(self, el)</span>:</span>
        <span>return</span> el <span>in</span> self.a
    <span><span>def</span> <span>__len__</span><span>(self)</span>:</span>
        <span>return</span> len(self.a)
</code></pre></div>


<div><h3 id="sequence">Sequence</h3><ul>
<li><strong>Only required methods are len() and getitem().</strong></li>
<li><strong>Getitem() should return an item at the passed index or raise IndexError.</strong></li>
<li><strong>Iter() and contains() automatically work on any object that has getitem() defined.</strong></li>
<li><strong>Reversed() automatically works on any object that has len() and getitem() defined.</strong></li>
</ul><pre><code><span><span>class</span> <span>MySequence</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__iter__</span><span>(self)</span>:</span>
        <span>return</span> iter(self.a)
    <span><span>def</span> <span>__contains__</span><span>(self, el)</span>:</span>
        <span>return</span> el <span>in</span> self.a
    <span><span>def</span> <span>__len__</span><span>(self)</span>:</span>
        <span>return</span> len(self.a)
    <span><span>def</span> <span>__getitem__</span><span>(self, i)</span>:</span>
        <span>return</span> self.a[i]
    <span><span>def</span> <span>__reversed__</span><span>(self)</span>:</span>
        <span>return</span> reversed(self.a)
</code></pre></div>


<div><h3 id="abcsequence">ABC Sequence</h3><ul>
<li><strong>It&#39;s a richer interface than the basic sequence.</strong></li>
<li><strong>Extending it generates iter(), contains(), reversed(), index() and count().</strong></li>
<li><strong>Unlike <code><span>&#39;abc.Iterable&#39;</span></code> and <code><span>&#39;abc.Collection&#39;</span></code>, it is not a duck type. That is why <code><span>&#39;issubclass(MySequence, abc.Sequence)&#39;</span></code> would return False even if MySequence had all the methods defined.</strong></li>
</ul><pre><code><span>from</span> collections <span>import</span> abc

<span><span>class</span> <span>MyAbcSequence</span><span>(abc.Sequence)</span>:</span>
    <span><span>def</span> <span>__init__</span><span>(self, a)</span>:</span>
        self.a = a
    <span><span>def</span> <span>__len__</span><span>(self)</span>:</span>
        <span>return</span> len(self.a)
    <span><span>def</span> <span>__getitem__</span><span>(self, i)</span>:</span>
        <span>return</span> self.a[i]
</code></pre></div>


<div><h4 id="tableofrequiredandautomaticallyavailablespecialmethods">Table of required and automatically available special methods:</h4><pre><code>┏━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━━━┓
┃            │  Iterable  │ Collection │  Sequence  │ abc.Sequence ┃
┠────────────┼────────────┼────────────┼────────────┼──────────────┨
┃ iter()     │     !      │     !      │     ✓      │      ✓       ┃
┃ contains() │     ✓      │     ✓      │     ✓      │      ✓       ┃
┃ len()      │            │     !      │     !      │      !       ┃
┃ getitem()  │            │            │     !      │      !       ┃
┃ reversed() │            │            │     ✓      │      ✓       ┃
┃ index()    │            │            │            │      ✓       ┃
┃ count()    │            │            │            │      ✓       ┃
┗━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━━━┛
</code></pre></div>

<ul>
<li><strong>Other ABCs that generate missing methods are: MutableSequence, Set, MutableSet, Mapping and MutableMapping.</strong></li>
<li><strong>Names of their required methods are stored in <code><span>&#39;&lt;abc&gt;.__abstractmethods__&#39;</span></code>.</strong></li>
</ul>
<div><h2 id="enum"><a href="#enum" name="enum">#</a>Enum</h2><pre><code><span>from</span> enum <span>import</span> Enum, auto
</code></pre></div>

<pre><code><span><span>class</span> &lt;<span>enum_name</span>&gt;<span>(Enum)</span>:</span>
    &lt;member_name_1&gt; = &lt;value_1&gt;
    &lt;member_name_2&gt; = &lt;value_2_a&gt;, &lt;value_2_b&gt;
    &lt;member_name_3&gt; = auto()
</code></pre>
<ul>
<li><strong>If there are no numeric values before auto(), it returns 1.</strong></li>
<li><strong>Otherwise it returns an increment of the last numeric value.</strong></li>
</ul>
<pre><code>&lt;member&gt; = &lt;enum&gt;.&lt;member_name&gt;                 
&lt;member&gt; = &lt;enum&gt;[<span>&#39;&lt;member_name&gt;&#39;</span>]              
&lt;member&gt; = &lt;enum&gt;(&lt;value&gt;)                      
&lt;str&gt;    = &lt;member&gt;.name                        
&lt;obj&gt;    = &lt;member&gt;.value                       
</code></pre>
<pre><code>list_of_members = list(&lt;enum&gt;)
member_names    = [a.name <span>for</span> a <span>in</span> &lt;enum&gt;]
member_values   = [a.value <span>for</span> a <span>in</span> &lt;enum&gt;]
random_member   = random.choice(list(&lt;enum&gt;))
</code></pre>
<pre><code><span><span>def</span> <span>get_next_member</span><span>(member)</span>:</span>
    members = list(member.__class__)
    index   = (members.index(member) + <span>1</span>) % len(members)
    <span>return</span> members[index]
</code></pre>
<div><h3 id="inline-2">Inline</h3><pre><code>Cutlery = Enum(<span>&#39;Cutlery&#39;</span>, <span>&#39;fork knife spoon&#39;</span>)
Cutlery = Enum(<span>&#39;Cutlery&#39;</span>, [<span>&#39;fork&#39;</span>, <span>&#39;knife&#39;</span>, <span>&#39;spoon&#39;</span>])
Cutlery = Enum(<span>&#39;Cutlery&#39;</span>, {<span>&#39;fork&#39;</span>: <span>1</span>, <span>&#39;knife&#39;</span>: <span>2</span>, <span>&#39;spoon&#39;</span>: <span>3</span>})
</code></pre></div>

<div><h4 id="userdefinedfunctionscannotbevaluessotheymustbewrapped">User-defined functions cannot be values, so they must be wrapped:</h4><pre><code><span>from</span> functools <span>import</span> partial
LogicOp = Enum(<span>&#39;LogicOp&#39;</span>, {<span>&#39;AND&#39;</span>: partial(<span>lambda</span> l, r: l <span>and</span> r),
                           <span>&#39;OR&#39;</span>:  partial(<span>lambda</span> l, r: l <span>or</span> r)})
</code></pre></div>

<ul>
<li><strong>Member names are in all caps because trying to access a member that is named after a reserved keyword raises SyntaxError.</strong></li>
</ul>
<div><h2 id="exceptions"><a href="#exceptions" name="exceptions">#</a>Exceptions</h2><div><h3 id="basicexample">Basic Example</h3><pre><code><span>try</span>:
    &lt;code&gt;
<span>except</span> &lt;exception&gt;:
    &lt;code&gt;
</code></pre></div></div>


<div><h3 id="complexexample">Complex Example</h3><pre><code><span>try</span>:
    &lt;code_1&gt;
<span>except</span> &lt;exception_a&gt;:
    &lt;code_2_a&gt;
<span>except</span> &lt;exception_b&gt;:
    &lt;code_2_b&gt;
<span>else</span>:
    &lt;code_2_c&gt;
<span>finally</span>:
    &lt;code_3&gt;
</code></pre></div>

<ul>
<li><strong>Code inside the <code><span>&#39;else&#39;</span></code> block will only be executed if <code><span>&#39;try&#39;</span></code> block had no exceptions.</strong></li>
<li><strong>Code inside the <code><span>&#39;finally&#39;</span></code> block will always be executed (unless a signal is received).</strong></li>
</ul>
<div><h3 id="catchingexceptions">Catching Exceptions</h3><pre><code><span>except</span> &lt;exception&gt;:
<span>except</span> &lt;exception&gt; <span>as</span> &lt;name&gt;:
<span>except</span> (&lt;exception&gt;, [...]):
<span>except</span> (&lt;exception&gt;, [...]) <span>as</span> &lt;name&gt;:
</code></pre></div>

<ul>
<li><strong>Also catches subclasses of the exception.</strong></li>
<li><strong>Use <code><span>&#39;traceback.print_exc()&#39;</span></code> to print the error message to stderr.</strong></li>
<li><strong>Use <code><span>&#39;print(&lt;name&gt;)&#39;</span></code> to print just the cause of the exception (its arguments).</strong></li>
</ul>
<div><h3 id="raisingexceptions">Raising Exceptions</h3><pre><code><span>raise</span> &lt;exception&gt;
<span>raise</span> &lt;exception&gt;()
<span>raise</span> &lt;exception&gt;(&lt;el&gt; [, ...])
</code></pre></div>

<div><h4 id="reraisingcaughtexception">Re-raising caught exception:</h4><pre><code><span>except</span> &lt;exception&gt; <span>as</span> &lt;name&gt;:
    ...
    <span>raise</span>
</code></pre></div>

<div><h3 id="exceptionobject">Exception Object</h3><pre><code>arguments = &lt;name&gt;.args
exc_type  = &lt;name&gt;.__class__
filename  = &lt;name&gt;.__traceback__.tb_frame.f_code.co_filename
func_name = &lt;name&gt;.__traceback__.tb_frame.f_code.co_name
line      = linecache.getline(filename, &lt;name&gt;.__traceback__.tb_lineno)
error_msg = <span>&#39;&#39;</span>.join(traceback.format_exception(exc_type, &lt;name&gt;, &lt;name&gt;.__traceback__))
</code></pre></div>

<div><h3 id="builtinexceptions">Built-in Exceptions</h3><pre><code>BaseException
 ├── SystemExit                   
 ├── KeyboardInterrupt            
 └── Exception                    
      ├── ArithmeticError         
      │    └── ZeroDivisionError  
      ├── AttributeError          
      ├── EOFError                
      ├── LookupError             
      │    ├── IndexError         
      │    └── KeyError           
      ├── NameError               
      ├── OSError                 
      │    └── FileNotFoundError  
      ├── RuntimeError            
      │    └── RecursionError     
      ├── StopIteration           
      ├── TypeError               
      └── ValueError              
           └── UnicodeError       
</code></pre></div>

<div><h4 id="collectionsandtheirexceptions">Collections and their exceptions:</h4><pre><code>┏━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┓
┃           │    List    │    Set     │    Dict    ┃
┠───────────┼────────────┼────────────┼────────────┨
┃ getitem() │ IndexError │            │  KeyError  ┃
┃ pop()     │ IndexError │  KeyError  │  KeyError  ┃
┃ remove()  │ ValueError │  KeyError  │            ┃
┃ index()   │ ValueError │            │            ┃
┗━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┛
</code></pre></div>

<div><h4 id="usefulbuiltinexceptions">Useful built-in exceptions:</h4><pre><code><span>raise</span> TypeError(<span>&#39;Argument is of wrong type!&#39;</span>)
<span>raise</span> ValueError(<span>&#39;Argument is of right type but inappropriate value!&#39;</span>)
<span>raise</span> RuntimeError(<span>&#39;None of above!&#39;</span>)
</code></pre></div>

<div><h3 id="userdefinedexceptions">User-defined Exceptions</h3><pre><code><span><span>class</span> <span>MyError</span><span>(Exception)</span>:</span>
    <span>pass</span>

<span><span>class</span> <span>MyInputError</span><span>(MyError)</span>:</span>
    <span>pass</span>
</code></pre></div>

<div><h2 id="exit"><a href="#exit" name="exit">#</a>Exit</h2><p><strong>Exits the interpreter by raising SystemExit exception.</strong></p><pre><code><span>import</span> sys
sys.exit()                        
sys.exit(&lt;el&gt;)                    
sys.exit(&lt;int&gt;)                   
</code></pre></div>


<div><h2 id="print"><a href="#print" name="print">#</a>Print</h2><pre><code>print(&lt;el_1&gt;, ..., sep=<span>&#39; &#39;</span>, end=<span>&#39;\n&#39;</span>, file=sys.stdout, flush=<span>False</span>)
</code></pre></div>

<ul>
<li><strong>Use <code><span>&#39;file=sys.stderr&#39;</span></code> for messages about errors.</strong></li>
<li><strong>Use <code><span>&#39;flush=True&#39;</span></code> to forcibly flush the stream.</strong></li>
</ul>
<div><h3 id="prettyprint">Pretty Print</h3><pre><code><span>from</span> pprint <span>import</span> pprint
pprint(&lt;collection&gt;, width=<span>80</span>, depth=<span>None</span>, compact=<span>False</span>, sort_dicts=<span>True</span>)
</code></pre></div>

<ul>
<li><strong>Levels deeper than &#39;depth&#39; get replaced by &#39;…&#39;.</strong></li>
</ul>
<div><h2 id="input"><a href="#input" name="input">#</a>Input</h2><p><strong>Reads a line from user input or pipe if present.</strong></p><pre><code>&lt;str&gt; = input(prompt=<span>None</span>)
</code></pre></div>


<ul>
<li><strong>Trailing newline gets stripped.</strong></li>
<li><strong>Prompt string is printed to the standard output before reading input.</strong></li>
<li><strong>Raises EOFError when user hits EOF (ctrl-d/ctrl-z⏎) or input stream gets exhausted.</strong></li>
</ul>
<div><h2 id="commandlinearguments"><a href="#commandlinearguments" name="commandlinearguments">#</a>Command Line Arguments</h2><pre><code><span>import</span> sys
scripts_path = sys.argv[<span>0</span>]
arguments    = sys.argv[<span>1</span>:]
</code></pre></div>

<div><h3 id="argumentparser">Argument Parser</h3><pre><code><span>from</span> argparse <span>import</span> ArgumentParser, FileType
p = ArgumentParser(description=&lt;str&gt;)
p.add_argument(<span>&#39;-&lt;short_name&gt;&#39;</span>, <span>&#39;--&lt;name&gt;&#39;</span>, action=<span>&#39;store_true&#39;</span>)  
p.add_argument(<span>&#39;-&lt;short_name&gt;&#39;</span>, <span>&#39;--&lt;name&gt;&#39;</span>, type=&lt;type&gt;)          
p.add_argument(<span>&#39;&lt;name&gt;&#39;</span>, type=&lt;type&gt;, nargs=<span>1</span>)                    
p.add_argument(<span>&#39;&lt;name&gt;&#39;</span>, type=&lt;type&gt;, nargs=<span>&#39;+&#39;</span>)                  
p.add_argument(<span>&#39;&lt;name&gt;&#39;</span>, type=&lt;type&gt;, nargs=<span>&#39;*&#39;</span>)                  
args  = p.parse_args()                                            
value = args.&lt;name&gt;
</code></pre></div>

<ul>
<li><strong>Use <code><span>&#39;help=&lt;str&gt;&#39;</span></code> to set argument description.</strong></li>
<li><strong>Use <code><span>&#39;default=&lt;el&gt;&#39;</span></code> to set the default value.</strong></li>
<li><strong>Use <code><span>&#39;type=FileType(&lt;mode&gt;)&#39;</span></code> for files.</strong></li>
</ul>
<div><h2 id="open"><a href="#open" name="open">#</a>Open</h2><p><strong>Opens the file and returns a corresponding file object.</strong></p><pre><code>&lt;file&gt; = open(&lt;path&gt;, mode=<span>&#39;r&#39;</span>, encoding=<span>None</span>, newline=<span>None</span>)
</code></pre></div>


<ul>
<li><strong><code><span>&#39;encoding=None&#39;</span></code> means that the default encoding is used, which is platform dependent. Best practice is to use <code><span>&#39;encoding=&#34;utf-8&#34;&#39;</span></code> whenever possible.</strong></li>
<li><strong><code><span>&#39;newline=None&#39;</span></code> means all different end of line combinations are converted to &#39;\n&#39; on read, while on write all &#39;\n&#39; characters are converted to system&#39;s default line separator.</strong></li>
<li><strong><code><span>&#39;newline=&#34;&#34;&#39;</span></code> means no conversions take place, but input is still broken into chunks by readline() and readlines() on either &#39;\n&#39;, &#39;\r&#39; or &#39;\r\n&#39;.</strong></li>
</ul>
<div><h3 id="modes">Modes</h3><ul>
<li><strong><code><span>&#39;r&#39;</span></code>  - Read (default).</strong></li>
<li><strong><code><span>&#39;w&#39;</span></code>  - Write (truncate).</strong></li>
<li><strong><code><span>&#39;x&#39;</span></code>  - Write or fail if the file already exists.</strong></li>
<li><strong><code><span>&#39;a&#39;</span></code>  - Append.</strong></li>
<li><strong><code><span>&#39;w+&#39;</span></code> - Read and write (truncate).</strong></li>
<li><strong><code><span>&#39;r+&#39;</span></code> - Read and write from the start.</strong></li>
<li><strong><code><span>&#39;a+&#39;</span></code> - Read and write from the end.</strong></li>
<li><strong><code><span>&#39;t&#39;</span></code>  - Text mode (default).</strong></li>
<li><strong><code><span>&#39;b&#39;</span></code>  - Binary mode.</strong></li>
</ul><div><h3 id="exceptions-1">Exceptions</h3><ul>
<li><strong><code><span>&#39;FileNotFoundError&#39;</span></code> can be raised when reading with <code><span>&#39;r&#39;</span></code> or <code><span>&#39;r+&#39;</span></code>.</strong></li>
<li><strong><code><span>&#39;FileExistsError&#39;</span></code> can be raised when writing with <code><span>&#39;x&#39;</span></code>.</strong></li>
<li><strong><code><span>&#39;IsADirectoryError&#39;</span></code> and <code><span>&#39;PermissionError&#39;</span></code> can be raised by any.</strong></li>
<li><strong><code><span>&#39;OSError&#39;</span></code> is the parent class of all listed exceptions.</strong></li>
</ul><div><h3 id="fileobject">File Object</h3><pre><code>&lt;file&gt;.seek(<span>0</span>)                      
&lt;file&gt;.seek(offset)                 
&lt;file&gt;.seek(<span>0</span>, <span>2</span>)                   
&lt;bin_file&gt;.seek(±offset, &lt;anchor&gt;)  
</code></pre></div></div></div>





<pre><code>&lt;str/bytes&gt; = &lt;file&gt;.read(size=<span>-1</span>)  
&lt;str/bytes&gt; = &lt;file&gt;.readline()     
&lt;list&gt;      = &lt;file&gt;.readlines()    
&lt;str/bytes&gt; = next(&lt;file&gt;)          
</code></pre>
<pre><code>&lt;file&gt;.write(&lt;str/bytes&gt;)           
&lt;file&gt;.writelines(&lt;collection&gt;)     
&lt;file&gt;.flush()                      
</code></pre>
<ul>
<li><strong>Methods do not add or strip trailing newlines, even writelines().</strong></li>
</ul>
<div><h3 id="readtextfromfile">Read Text from File</h3><pre><code><span><span>def</span> <span>read_file</span><span>(filename)</span>:</span>
    <span>with</span> open(filename, encoding=<span>&#39;utf-8&#39;</span>) <span>as</span> file:
        <span>return</span> file.readlines()
</code></pre></div>

<div><h3 id="writetexttofile">Write Text to File</h3><pre><code><span><span>def</span> <span>write_to_file</span><span>(filename, text)</span>:</span>
    <span>with</span> open(filename, <span>&#39;w&#39;</span>, encoding=<span>&#39;utf-8&#39;</span>) <span>as</span> file:
        file.write(text)
</code></pre></div>

<div><h2 id="paths"><a href="#paths" name="paths">#</a>Paths</h2><pre><code><span>from</span> os <span>import</span> getcwd, path, listdir
<span>from</span> glob <span>import</span> glob
</code></pre></div>

<pre><code>&lt;str&gt;  = getcwd()                   
&lt;str&gt;  = path.join(&lt;path&gt;, ...)     
&lt;str&gt;  = path.abspath(&lt;path&gt;)       
</code></pre>
<pre><code>&lt;str&gt;  = path.basename(&lt;path&gt;)      
&lt;str&gt;  = path.dirname(&lt;path&gt;)       
&lt;tup.&gt; = path.splitext(&lt;path&gt;)      
</code></pre>
<pre><code>&lt;list&gt; = listdir(path=<span>&#39;.&#39;</span>)          
&lt;list&gt; = glob(<span>&#39;&lt;pattern&gt;&#39;</span>)          
</code></pre>
<pre><code>&lt;bool&gt; = path.exists(&lt;path&gt;)        
&lt;bool&gt; = path.isfile(&lt;path&gt;)        
&lt;bool&gt; = path.isdir(&lt;path&gt;)         
</code></pre>
<div><h3 id="direntry">DirEntry</h3><p><strong>Using scandir() instead of listdir() can significantly increase the performance of code that also needs file type information.</strong></p><pre><code><span>from</span> os <span>import</span> scandir
</code></pre></div>


<pre><code>&lt;iter&gt; = scandir(path=<span>&#39;.&#39;</span>)          
&lt;str&gt;  = &lt;DirEntry&gt;.path            
&lt;str&gt;  = &lt;DirEntry&gt;.name            
&lt;file&gt; = open(&lt;DirEntry&gt;)           
</code></pre>
<div><h3 id="pathobject">Path Object</h3><pre><code><span>from</span> pathlib <span>import</span> Path
</code></pre></div>

<pre><code>&lt;Path&gt; = Path(&lt;path&gt; [, ...])       
&lt;Path&gt; = &lt;path&gt; / &lt;path&gt; [/ ...]    
</code></pre>
<pre><code>&lt;Path&gt; = Path()                     
&lt;Path&gt; = Path.cwd()                 
&lt;Path&gt; = Path.home()                
&lt;Path&gt; = Path(__file__).resolve()   
</code></pre>
<pre><code>&lt;Path&gt; = &lt;Path&gt;.parent              
&lt;str&gt;  = &lt;Path&gt;.name                
&lt;str&gt;  = &lt;Path&gt;.stem                
&lt;str&gt;  = &lt;Path&gt;.suffix              
&lt;tup.&gt; = &lt;Path&gt;.parts               
</code></pre>
<pre><code>&lt;iter&gt; = &lt;Path&gt;.iterdir()           
&lt;iter&gt; = &lt;Path&gt;.glob(<span>&#39;&lt;pattern&gt;&#39;</span>)   
</code></pre>
<pre><code>&lt;str&gt;  = str(&lt;Path&gt;)                
&lt;file&gt; = open(&lt;Path&gt;)               
</code></pre>
<div><h2 id="oscommands"><a href="#oscommands" name="oscommands">#</a>OS Commands</h2><div><h3 id="filesanddirectories">Files and Directories</h3><ul>
<li><strong>Paths can be either strings, Paths or DirEntry objects.</strong></li>
<li><strong>Functions report OS related errors by raising either OSError or one of its <a href="#exceptions-1">subclasses</a>.</strong></li>
</ul><pre><code><span>import</span> os, shutil
</code></pre></div></div>



<pre><code>os.chdir(&lt;path&gt;)                    
os.mkdir(&lt;path&gt;, mode=<span>0o777</span>)        
os.makedirs(&lt;path&gt;, mode=<span>0o777</span>)     
</code></pre>
<pre><code>shutil.copy(from, to)               
shutil.copytree(from, to)           
</code></pre>
<pre><code>os.rename(from, to)                 
os.replace(from, to)                
</code></pre>
<pre><code>os.remove(&lt;path&gt;)                   
os.rmdir(&lt;path&gt;)                    
shutil.rmtree(&lt;path&gt;)               
</code></pre>
<div><h3 id="shellcommands">Shell Commands</h3><pre><code><span>import</span> os
&lt;str&gt; = os.popen(<span>&#39;&lt;shell_command&gt;&#39;</span>).read()
</code></pre></div>

<div><h4 id="sends11tothebasiccalculatorandcapturesitsoutput">Sends &#39;1 + 1&#39; to the basic calculator and captures its output:</h4><pre><code><span>&gt;&gt;&gt; </span><span>from</span> subprocess <span>import</span> run
<span>&gt;&gt;&gt; </span>run(<span>&#39;bc&#39;</span>, input=<span>&#39;1 + 1\n&#39;</span>, capture_output=<span>True</span>, text=<span>True</span>)
CompletedProcess(args=<span>&#39;bc&#39;</span>, returncode=<span>0</span>, stdout=<span>&#39;2\n&#39;</span>, stderr=<span>&#39;&#39;</span>)
</code></pre></div>

<div><h4 id="sendstestintothebasiccalculatorrunninginstandardmodeandsavesitsoutputtotestout">Sends test.in to the basic calculator running in standard mode and saves its output to test.out:</h4><pre><code><span>&gt;&gt;&gt; </span><span>from</span> shlex <span>import</span> split
<span>&gt;&gt;&gt; </span>os.popen(<span>&#39;echo 1 + 1 &gt; test.in&#39;</span>)
<span>&gt;&gt;&gt; </span>run(split(<span>&#39;bc -s&#39;</span>), stdin=open(<span>&#39;test.in&#39;</span>), stdout=open(<span>&#39;test.out&#39;</span>, <span>&#39;w&#39;</span>))
CompletedProcess(args=[<span>&#39;bc&#39;</span>, <span>&#39;-s&#39;</span>], returncode=<span>0</span>)
<span>&gt;&gt;&gt; </span>open(<span>&#39;test.out&#39;</span>).read()
<span>&#39;2\n&#39;</span>
</code></pre></div>

<div><h2 id="json"><a href="#json" name="json">#</a>JSON</h2><p><strong>Text file format for storing collections of strings and numbers.</strong></p><pre><code><span>import</span> json
&lt;str&gt;    = json.dumps(&lt;object&gt;, ensure_ascii=<span>True</span>, indent=<span>None</span>)
&lt;object&gt; = json.loads(&lt;str&gt;)
</code></pre></div>


<div><h3 id="readobjectfromjsonfile">Read Object from JSON File</h3><pre><code><span><span>def</span> <span>read_json_file</span><span>(filename)</span>:</span>
    <span>with</span> open(filename, encoding=<span>&#39;utf-8&#39;</span>) <span>as</span> file:
        <span>return</span> json.load(file)
</code></pre></div>

<div><h3 id="writeobjecttojsonfile">Write Object to JSON File</h3><pre><code><span><span>def</span> <span>write_to_json_file</span><span>(filename, an_object)</span>:</span>
    <span>with</span> open(filename, <span>&#39;w&#39;</span>, encoding=<span>&#39;utf-8&#39;</span>) <span>as</span> file:
        json.dump(an_object, file, ensure_ascii=<span>False</span>, indent=<span>2</span>)
</code></pre></div>

<div><h2 id="pickle"><a href="#pickle" name="pickle">#</a>Pickle</h2><p><strong>Binary file format for storing objects.</strong></p><pre><code><span>import</span> pickle
&lt;bytes&gt;  = pickle.dumps(&lt;object&gt;)
&lt;object&gt; = pickle.loads(&lt;bytes&gt;)
</code></pre></div>


<div><h3 id="readobjectfromfile">Read Object from File</h3><pre><code><span><span>def</span> <span>read_pickle_file</span><span>(filename)</span>:</span>
    <span>with</span> open(filename, <span>&#39;rb&#39;</span>) <span>as</span> file:
        <span>return</span> pickle.load(file)
</code></pre></div>

<div><h3 id="writeobjecttofile">Write Object to File</h3><pre><code><span><span>def</span> <span>write_to_pickle_file</span><span>(filename, an_object)</span>:</span>
    <span>with</span> open(filename, <span>&#39;wb&#39;</span>) <span>as</span> file:
        pickle.dump(an_object, file)
</code></pre></div>

<div><h2 id="csv"><a href="#csv" name="csv">#</a>CSV</h2><p><strong>Text file format for storing spreadsheets.</strong></p><pre><code><span>import</span> csv
</code></pre></div>


<div><h3 id="read">Read</h3><pre><code>&lt;reader&gt; = csv.reader(&lt;file&gt;)       
&lt;list&gt;   = next(&lt;reader&gt;)           
&lt;list&gt;   = list(&lt;reader&gt;)           
</code></pre></div>

<ul>
<li><strong>File must be opened with a <code><span>&#39;newline=&#34;&#34;&#39;</span></code> argument, or newlines embedded inside quoted fields will not be interpreted correctly!</strong></li>
</ul>
<div><h3 id="write">Write</h3><pre><code>&lt;writer&gt; = csv.writer(&lt;file&gt;)       
&lt;writer&gt;.writerow(&lt;collection&gt;)     
&lt;writer&gt;.writerows(&lt;coll_of_coll&gt;)  
</code></pre></div>

<ul>
<li><strong>File must be opened with a <code><span>&#39;newline=&#34;&#34;&#39;</span></code> argument, or &#39;\r&#39; will be added in front of every &#39;\n&#39; on platforms that use &#39;\r\n&#39; line endings!</strong></li>
</ul>
<div><h3 id="parameters">Parameters</h3><ul>
<li><strong><code><span>&#39;dialect&#39;</span></code> - Master parameter that sets the default values.</strong></li>
<li><strong><code><span>&#39;delimiter&#39;</span></code> - A one-character string used to separate fields.</strong></li>
<li><strong><code><span>&#39;quotechar&#39;</span></code> - Character for quoting fields that contain special characters.</strong></li>
<li><strong><code><span>&#39;doublequote&#39;</span></code> - Whether quotechars inside fields get doubled or escaped.</strong></li>
<li><strong><code><span>&#39;skipinitialspace&#39;</span></code> - Whether whitespace after delimiter gets stripped.</strong></li>
<li><strong><code><span>&#39;lineterminator&#39;</span></code> - Specifies how writer terminates rows.</strong></li>
<li><strong><code><span>&#39;quoting&#39;</span></code> - Controls the amount of quoting: 0 - as necessary, 1 - all.</strong></li>
<li><strong><code><span>&#39;escapechar&#39;</span></code> - Character for escaping quotechars if doublequote is False.</strong></li>
</ul><div><h3 id="dialects">Dialects</h3><pre><code>┏━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━┓
┃                  │     excel    │   excel-tab  │     unix     ┃
┠──────────────────┼──────────────┼──────────────┼──────────────┨
┃ delimiter        │       &#39;,&#39;    │      &#39;\t&#39;    │       &#39;,&#39;    ┃
┃ quotechar        │       &#39;&#34;&#39;    │       &#39;&#34;&#39;    │       &#39;&#34;&#39;    ┃
┃ doublequote      │      True    │      True    │      True    ┃
┃ skipinitialspace │     False    │     False    │     False    ┃
┃ lineterminator   │    &#39;\r\n&#39;    │    &#39;\r\n&#39;    │      &#39;\n&#39;    ┃
┃ quoting          │         0    │         0    │         1    ┃
┃ escapechar       │      None    │      None    │      None    ┃
┗━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━┛
</code></pre></div></div>



<div><h3 id="readrowsfromcsvfile">Read Rows from CSV File</h3><pre><code><span><span>def</span> <span>read_csv_file</span><span>(filename)</span>:</span>
    <span>with</span> open(filename, encoding=<span>&#39;utf-8&#39;</span>, newline=<span>&#39;&#39;</span>) <span>as</span> file:
        <span>return</span> list(csv.reader(file))
</code></pre></div>

<div><h3 id="writerowstocsvfile">Write Rows to CSV File</h3><pre><code><span><span>def</span> <span>write_to_csv_file</span><span>(filename, rows)</span>:</span>
    <span>with</span> open(filename, <span>&#39;w&#39;</span>, encoding=<span>&#39;utf-8&#39;</span>, newline=<span>&#39;&#39;</span>) <span>as</span> file:
        writer = csv.writer(file)
        writer.writerows(rows)
</code></pre></div>

<div><h2 id="sqlite"><a href="#sqlite" name="sqlite">#</a>SQLite</h2><p><strong>Server-less database engine that stores each database into a separate file.</strong></p><div><h3 id="connect">Connect</h3><p><strong>Opens a connection to the database file. Creates a new file if path doesn&#39;t exist.</strong></p><pre><code><span>import</span> sqlite3
&lt;conn&gt; = sqlite3.connect(&lt;path&gt;)                
&lt;conn&gt;.close()                                  
</code></pre></div></div>




<div><h3 id="read-1">Read</h3><p><strong>Returned values can be of type str, int, float, bytes or None.</strong></p><pre><code>&lt;cursor&gt; = &lt;conn&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>)            
&lt;tuple&gt;  = &lt;cursor&gt;.fetchone()                  
&lt;list&gt;   = &lt;cursor&gt;.fetchall()                  
</code></pre></div>


<div><h3 id="write-1">Write</h3><pre><code>&lt;conn&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>)                       
&lt;conn&gt;.commit()                                 
&lt;conn&gt;.rollback()                               
</code></pre></div>

<div><h4 id="or">Or:</h4><pre><code><span>with</span> &lt;conn&gt;:                                    
    &lt;conn&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>)                   
</code></pre></div>

<div><h3 id="placeholders">Placeholders</h3><ul>
<li><strong>Passed values can be of type str, int, float, bytes, None, bool, datetime.date or datetime.datetime.</strong></li>
<li><strong>Bools will be stored and returned as ints and dates as <a href="#encode">ISO formatted strings</a>.</strong></li>
</ul><pre><code>&lt;conn&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>, &lt;list/tuple&gt;)         
&lt;conn&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>, &lt;dict/namedtuple&gt;)    
&lt;conn&gt;.executemany(<span>&#39;&lt;query&gt;&#39;</span>, &lt;coll_of_above&gt;)  
</code></pre></div>


<div><h3 id="example">Example</h3><p><strong>In this example values are not actually saved because <code><span>&#39;conn.commit()&#39;</span></code> is omitted!</strong></p><pre><code><span>&gt;&gt;&gt; </span>conn = sqlite3.connect(<span>&#39;test.db&#39;</span>)
<span>&gt;&gt;&gt; </span>conn.execute(<span>&#39;CREATE TABLE person (person_id INTEGER PRIMARY KEY, name, height)&#39;</span>)
<span>&gt;&gt;&gt; </span>conn.execute(<span>&#39;INSERT INTO person VALUES (NULL, ?, ?)&#39;</span>, (<span>&#39;Jean-Luc&#39;</span>, <span>187</span>)).lastrowid
<span>1</span>
<span>&gt;&gt;&gt; </span>conn.execute(<span>&#39;SELECT * FROM person&#39;</span>).fetchall()
[(<span>1</span>, <span>&#39;Jean-Luc&#39;</span>, <span>187</span>)]
</code></pre></div>


<div><h3 id="mysql">MySQL</h3><p><strong>Has a very similar interface, with differences listed below.</strong></p><pre><code>
<span>from</span> mysql <span>import</span> connector
&lt;conn&gt;   = connector.connect(host=&lt;str&gt;, …)     
&lt;cursor&gt; = &lt;conn&gt;.cursor()                      
&lt;cursor&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>)                     
&lt;cursor&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>, &lt;list/tuple&gt;)       
&lt;cursor&gt;.execute(<span>&#39;&lt;query&gt;&#39;</span>, &lt;dict/namedtuple&gt;)  
</code></pre></div>


<div><h2 id="bytes"><a href="#bytes" name="bytes">#</a>Bytes</h2><p><strong>Bytes object is an immutable sequence of single bytes. Mutable version is called bytearray.</strong></p><pre><code>&lt;bytes&gt; = <span>b&#39;&lt;str&gt;&#39;</span>                       
&lt;int&gt;   = &lt;bytes&gt;[&lt;index&gt;]               
&lt;bytes&gt; = &lt;bytes&gt;[&lt;slice&gt;]               
&lt;bytes&gt; = &lt;bytes&gt;.join(&lt;coll_of_bytes&gt;)  
</code></pre></div>


<div><h3 id="encode-1">Encode</h3><pre><code>&lt;bytes&gt; = bytes(&lt;coll_of_ints&gt;)          
&lt;bytes&gt; = bytes(&lt;str&gt;, <span>&#39;utf-8&#39;</span>)          
&lt;bytes&gt; = &lt;int&gt;.to_bytes(n_bytes, …)     
&lt;bytes&gt; = bytes.fromhex(<span>&#39;&lt;hex&gt;&#39;</span>)         
</code></pre></div>

<div><h3 id="decode-1">Decode</h3><pre><code>&lt;list&gt;  = list(&lt;bytes&gt;)                  
&lt;str&gt;   = str(&lt;bytes&gt;, <span>&#39;utf-8&#39;</span>)          
&lt;int&gt;   = int.from_bytes(&lt;bytes&gt;, …)     
<span>&#39;&lt;hex&gt;&#39;</span> = &lt;bytes&gt;.hex()                  
</code></pre></div>

<div><h3 id="readbytesfromfile">Read Bytes from File</h3><pre><code><span><span>def</span> <span>read_bytes</span><span>(filename)</span>:</span>
    <span>with</span> open(filename, <span>&#39;rb&#39;</span>) <span>as</span> file:
        <span>return</span> file.read()
</code></pre></div>

<div><h3 id="writebytestofile">Write Bytes to File</h3><pre><code><span><span>def</span> <span>write_bytes</span><span>(filename, bytes_obj)</span>:</span>
    <span>with</span> open(filename, <span>&#39;wb&#39;</span>) <span>as</span> file:
        file.write(bytes_obj)
</code></pre></div>

<div><h2 id="struct"><a href="#struct" name="struct">#</a>Struct</h2><ul>
<li><strong>Module that performs conversions between a sequence of numbers and a bytes object.</strong></li>
<li><strong>System’s type sizes and byte order are used by default.</strong></li>
</ul><pre><code><span>from</span> struct <span>import</span> pack, unpack, iter_unpack
</code></pre></div>


<pre><code>&lt;bytes&gt;  = pack(<span>&#39;&lt;format&gt;&#39;</span>, &lt;num_1&gt; [, &lt;num_2&gt;, ...])
&lt;tuple&gt;  = unpack(<span>&#39;&lt;format&gt;&#39;</span>, &lt;bytes&gt;)
&lt;tuples&gt; = iter_unpack(<span>&#39;&lt;format&gt;&#39;</span>, &lt;bytes&gt;)
</code></pre>
<div><h3 id="example-1">Example</h3><pre><code><span>&gt;&gt;&gt; </span>pack(<span>&#39;&gt;hhl&#39;</span>, <span>1</span>, <span>2</span>, <span>3</span>)
<span>b&#39;\x00\x01\x00\x02\x00\x00\x00\x03&#39;</span>
<span>&gt;&gt;&gt; </span>unpack(<span>&#39;&gt;hhl&#39;</span>, <span>b&#39;\x00\x01\x00\x02\x00\x00\x00\x03&#39;</span>)
(<span>1</span>, <span>2</span>, <span>3</span>)
</code></pre></div>

<div><h3 id="format-2">Format</h3><div><h4 id="forstandardtypesizesstartformatstringwith">For standard type sizes start format string with:</h4><ul>
<li><strong><code><span>&#39;=&#39;</span></code> - system&#39;s byte order (usually little-endian)</strong></li>
<li><strong><code><span>&#39;&lt;&#39;</span></code> - little-endian</strong></li>
<li><strong><code><span>&#39;&gt;&#39;</span></code> - big-endian (also <code><span>&#39;!&#39;</span></code>)</strong></li>
</ul></div></div><div><h4 id="integertypesuseacapitalletterforunsignedtypeminimumandstandardsizesareinbrackets">Integer types. Use a capital letter for unsigned type. Minimum and standard sizes are in brackets:</h4><ul>
<li><strong><code><span>&#39;x&#39;</span></code> - pad byte</strong></li>
<li><strong><code><span>&#39;b&#39;</span></code> - char (1/1)</strong></li>
<li><strong><code><span>&#39;h&#39;</span></code> - short (2/2)</strong></li>
<li><strong><code><span>&#39;i&#39;</span></code> - int (2/4)</strong></li>
<li><strong><code><span>&#39;l&#39;</span></code> - long (4/4)</strong></li>
<li><strong><code><span>&#39;q&#39;</span></code> - long long (8/8)</strong></li>
</ul></div><div><h4 id="floatingpointtypes">Floating point types:</h4><ul>
<li><strong><code><span>&#39;f&#39;</span></code> - float (4/4)</strong></li>
<li><strong><code><span>&#39;d&#39;</span></code> - double (8/8)</strong></li>
</ul></div>






<div><h2 id="array"><a href="#array" name="array">#</a>Array</h2><p><strong>List that can only hold numbers of a predefined type. Available types and their minimum sizes in bytes are listed above. Sizes and byte order are always determined by the system.</strong></p><pre><code><span>from</span> array <span>import</span> array
&lt;array&gt; = array(<span>&#39;&lt;typecode&gt;&#39;</span>, &lt;collection&gt;)    
&lt;array&gt; = array(<span>&#39;&lt;typecode&gt;&#39;</span>, &lt;bytes&gt;)         
&lt;array&gt; = array(<span>&#39;&lt;typecode&gt;&#39;</span>, &lt;array&gt;)         
&lt;bytes&gt; = bytes(&lt;array&gt;)                       
&lt;file&gt;.write(&lt;array&gt;)                          
</code></pre></div>


<div><h2 id="memoryview"><a href="#memoryview" name="memoryview">#</a>Memory View</h2><ul>
<li><strong>A sequence object that points to the memory of another object.</strong></li>
<li><strong>Each element can reference a single or multiple consecutive bytes, depending on format.</strong></li>
<li><strong>Order and number of elements can be changed with slicing.</strong></li>
<li><strong>Casting only works between char and other types and uses system&#39;s sizes and byte order.</strong></li>
</ul><pre><code>&lt;mview&gt; = memoryview(&lt;bytes/bytearray/array&gt;)  
&lt;real&gt;  = &lt;mview&gt;[&lt;index&gt;]                     
&lt;mview&gt; = &lt;mview&gt;[&lt;slice&gt;]                     
&lt;mview&gt; = &lt;mview&gt;.cast(<span>&#39;&lt;typecode&gt;&#39;</span>)           
&lt;mview&gt;.release()                              
</code></pre></div>


<div><h3 id="decode-2">Decode</h3><pre><code>&lt;bytes&gt; = bytes(&lt;mview&gt;)                       
&lt;bytes&gt; = &lt;bytes&gt;.join(&lt;coll_of_mviews&gt;)       
&lt;array&gt; = array(<span>&#39;&lt;typecode&gt;&#39;</span>, &lt;mview&gt;)         
&lt;file&gt;.write(&lt;mview&gt;)                          
</code></pre></div>

<pre><code>&lt;list&gt;  = list(&lt;mview&gt;)                        
&lt;str&gt;   = str(&lt;mview&gt;, <span>&#39;utf-8&#39;</span>)                
&lt;int&gt;   = int.from_bytes(&lt;mview&gt;, …)           
<span>&#39;&lt;hex&gt;&#39;</span> = &lt;mview&gt;.hex()                        
</code></pre>
<div><h2 id="deque"><a href="#deque" name="deque">#</a>Deque</h2><p><strong>A thread-safe list with efficient appends and pops from either side. Pronounced &#34;deck&#34;.</strong></p><pre><code><span>from</span> collections <span>import</span> deque
&lt;deque&gt; = deque(&lt;collection&gt;, maxlen=<span>None</span>)
</code></pre></div>


<pre><code>&lt;deque&gt;.appendleft(&lt;el&gt;)                       
&lt;deque&gt;.extendleft(&lt;collection&gt;)               
&lt;el&gt; = &lt;deque&gt;.popleft()                       
&lt;deque&gt;.rotate(n=<span>1</span>)                            
</code></pre>
<div><h2 id="threading"><a href="#threading" name="threading">#</a>Threading</h2><ul>
<li><strong>CPython interpreter can only run a single thread at a time.</strong></li>
<li><strong>That is why using multiple threads won&#39;t result in a faster execution, unless at least one of the threads contains an I/O operation.</strong></li>
</ul><pre><code><span>from</span> threading <span>import</span> Thread, RLock, Semaphore, Event, Barrier
<span>from</span> concurrent.futures <span>import</span> ThreadPoolExecutor
</code></pre></div>


<div><h3 id="thread">Thread</h3><pre><code>&lt;Thread&gt; = Thread(target=&lt;function&gt;)           
&lt;Thread&gt;.start()                               
&lt;bool&gt; = &lt;Thread&gt;.is_alive()                   
&lt;Thread&gt;.join()                                
</code></pre></div>

<ul>
<li><strong>Use <code><span>&#39;kwargs=&lt;dict&gt;&#39;</span></code> to pass keyword arguments to the function.</strong></li>
<li><strong>Use <code><span>&#39;daemon=True&#39;</span></code>, or the program will not be able to exit while the thread is alive.</strong></li>
</ul>
<div><h3 id="lock">Lock</h3><pre><code>&lt;lock&gt; = RLock()                               
&lt;lock&gt;.acquire()                               
&lt;lock&gt;.release()                               
</code></pre></div>



<div><h3 id="semaphoreeventbarrier">Semaphore, Event, Barrier</h3><pre><code>&lt;Semaphore&gt; = Semaphore(value=<span>1</span>)               
&lt;Event&gt;     = Event()                          
&lt;Barrier&gt;   = Barrier(n_times)                 
</code></pre></div>

<div><h3 id="threadpoolexecutor">Thread Pool Executor</h3><p><strong>Object that manages thread execution.</strong></p><pre><code>&lt;Exec&gt; = ThreadPoolExecutor(max_workers=<span>None</span>)  
&lt;Exec&gt;.shutdown(wait=<span>True</span>)                     
</code></pre></div>


<pre><code>&lt;iter&gt; = &lt;Exec&gt;.map(&lt;func&gt;, &lt;args_1&gt;, ...)     
&lt;Futr&gt; = &lt;Exec&gt;.submit(&lt;func&gt;, &lt;arg_1&gt;, ...)   
&lt;bool&gt; = &lt;Futr&gt;.done()                         
&lt;obj&gt;  = &lt;Futr&gt;.result()                       
</code></pre>
<div><h3 id="queue">Queue</h3><p><strong>A thread-safe FIFO queue. For LIFO queue use LifoQueue.</strong></p><pre><code><span>from</span> queue <span>import</span> Queue
&lt;Queue&gt; = Queue(maxsize=<span>0</span>)
</code></pre></div>


<pre><code>&lt;Queue&gt;.put(&lt;el&gt;)                              
&lt;Queue&gt;.put_nowait(&lt;el&gt;)                       
&lt;el&gt; = &lt;Queue&gt;.get()                           
&lt;el&gt; = &lt;Queue&gt;.get_nowait()                    
</code></pre>
<div><h2 id="operator"><a href="#operator" name="operator">#</a>Operator</h2><p><strong>Module of functions that provide the functionality of operators.</strong></p><pre><code><span>from</span> operator <span>import</span> add, sub, mul, truediv, floordiv, mod, pow, neg, abs
<span>from</span> operator <span>import</span> eq, ne, lt, le, gt, ge
<span>from</span> operator <span>import</span> and_, or_, xor, inv
<span>from</span> operator <span>import</span> itemgetter, attrgetter, methodcaller
</code></pre></div>


<pre><code><span>import</span> operator <span>as</span> op
elementwise_sum  = map(op.add, list_a, list_b)
sorted_by_second = sorted(&lt;collection&gt;, key=op.itemgetter(<span>1</span>))
sorted_by_both   = sorted(&lt;collection&gt;, key=op.itemgetter(<span>1</span>, <span>0</span>))
product_of_elems = functools.reduce(op.mul, &lt;collection&gt;)
union_of_sets    = functools.reduce(op.or_, &lt;coll_of_sets&gt;)
last_element     = op.methodcaller(<span>&#39;pop&#39;</span>)(&lt;list&gt;)
</code></pre>
<ul>
<li><strong>Functions and_(), or_(), xor() and inv() correspond to operators &#39;&amp;&#39;, &#39;|&#39;, &#39;^&#39; and &#39;~&#39;.</strong></li>
<li><strong>They only work on objects with and(), or(), xor() and invert() special methods.</strong></li>
<li><strong>Also: <code><span>&#39;&lt;int&gt; = &lt;int&gt; &amp;|^ &lt;bool&gt;&#39;</span></code> and <code><span>&#39;&lt;bool&gt; = &lt;bool&gt; &amp;|^ &lt;bool&gt;&#39;</span></code>.</strong></li>
</ul>
<div><h2 id="introspection"><a href="#introspection" name="introspection">#</a>Introspection</h2><p><strong>Inspecting code at runtime.</strong></p><div><h3 id="variables">Variables</h3><pre><code>&lt;list&gt; = dir()                             
&lt;dict&gt; = vars()                            
&lt;dict&gt; = globals()                         
</code></pre></div></div>



<div><h3 id="attributes-1">Attributes</h3><pre><code>&lt;list&gt; = dir(&lt;object&gt;)                     
&lt;dict&gt; = vars(&lt;object&gt;)                    
&lt;bool&gt; = hasattr(&lt;object&gt;, <span>&#39;&lt;attr_name&gt;&#39;</span>)  
value  = getattr(&lt;object&gt;, <span>&#39;&lt;attr_name&gt;&#39;</span>)  
setattr(&lt;object&gt;, <span>&#39;&lt;attr_name&gt;&#39;</span>, value)    
delattr(&lt;object&gt;, <span>&#39;&lt;attr_name&gt;&#39;</span>)           
</code></pre></div>

<div><h3 id="parameters-1">Parameters</h3><pre><code><span>from</span> inspect <span>import</span> signature
&lt;Sig&gt;  = signature(&lt;function&gt;)             
&lt;dict&gt; = &lt;Sig&gt;.parameters                  
&lt;str&gt;  = &lt;Param&gt;.name                      
&lt;memb&gt; = &lt;Param&gt;.kind                      
</code></pre></div>

<div><p><strong>Code that generates code.</strong></p><div><h3 id="type-1">Type</h3><p><strong>Type is the root class. If only passed an object it returns its type (class). Otherwise it creates a new class.</strong></p><pre><code>&lt;class&gt; = type(<span>&#39;&lt;class_name&gt;&#39;</span>, &lt;tuple_of_parents&gt;, &lt;dict_of_class_attributes&gt;)</code></pre></div></div>




<pre><code><span>&gt;&gt;&gt; </span>Z = type(<span>&#39;Z&#39;</span>, (), {<span>&#39;a&#39;</span>: <span>&#39;abcde&#39;</span>, <span>&#39;b&#39;</span>: <span>12345</span>})
<span>&gt;&gt;&gt; </span>z = Z()
</code></pre>
<div><h3 id="metaclass">Meta Class</h3><p><strong>A class that creates classes.</strong></p><pre><code><span><span>def</span> <span>my_meta_class</span><span>(name, parents, attrs)</span>:</span>
    attrs[<span>&#39;a&#39;</span>] = <span>&#39;abcde&#39;</span>
    <span>return</span> type(name, parents, attrs)
</code></pre></div>


<div><h4 id="or-2">Or:</h4><pre><code><span><span>class</span> <span>MyMetaClass</span><span>(type)</span>:</span>
    <span><span>def</span> <span>__new__</span><span>(cls, name, parents, attrs)</span>:</span>
        attrs[<span>&#39;a&#39;</span>] = <span>&#39;abcde&#39;</span>
        <span>return</span> type.__new__(cls, name, parents, attrs)
</code></pre></div>

<ul>
<li><strong>New() is a class method that gets called before init(). If it returns an instance of its class, then that instance gets passed to init() as a &#39;self&#39; argument.</strong></li>
<li><strong>It receives the same arguments as init(), except for the first one that specifies the desired type of the returned instance (MyMetaClass in our case).</strong></li>
<li><strong>Like in our case, new() can also be called directly, usually from a new() method of a child class (</strong><code><span><span>def</span> <span>__new__</span><span>(cls)</span>:</span> <span>return</span> super().__new__(cls)</code><strong>).</strong></li>
<li><strong>The only difference between the examples above is that my_meta_class() returns a class of type type, while MyMetaClass() returns a class of type MyMetaClass.</strong></li>
</ul>
<div><h3 id="metaclassattribute">Metaclass Attribute</h3><p><strong>Right before a class is created it checks if it has the &#39;metaclass&#39; attribute defined. If not, it recursively checks if any of his parents has it defined and eventually comes to type().</strong></p><pre><code><span><span>class</span> <span>MyClass</span><span>(metaclass=MyMetaClass)</span>:</span>
    b = <span>12345</span>
</code></pre></div>


<pre><code><span>&gt;&gt;&gt; </span>MyClass.a, MyClass.b
(<span>&#39;abcde&#39;</span>, <span>12345</span>)
</code></pre>
<div><h3 id="typediagram">Type Diagram</h3><pre><code>type(MyClass)     == MyMetaClass     
type(MyMetaClass) == type            
</code></pre></div>

<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┓
┃   Classes   │ Metaclasses ┃
┠─────────────┼─────────────┨
┃   MyClass ──→ MyMetaClass ┃
┃             │     ↓       ┃
┃    object ─────→ type ←╮  ┃
┃             │     ↑ ╰──╯  ┃
┃     str ──────────╯       ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┛
</code></pre>
<div><h3 id="inheritancediagram">Inheritance Diagram</h3><pre><code>MyClass.__base__     == object       
MyMetaClass.__base__ == type         
</code></pre></div>

<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┓
┃   Classes   │ Metaclasses ┃
┠─────────────┼─────────────┨
┃   MyClass   │ MyMetaClass ┃
┃      ↓      │     ↓       ┃
┃    object ←───── type     ┃
┃      ↑      │             ┃
┃     str     │             ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┛
</code></pre>
<div><h2 id="eval"><a href="#eval" name="eval">#</a>Eval</h2><pre><code><span>&gt;&gt;&gt; </span><span>from</span> ast <span>import</span> literal_eval
<span>&gt;&gt;&gt; </span>literal_eval(<span>&#39;[1, 2, 3]&#39;</span>)
[<span>1</span>, <span>2</span>, <span>3</span>]
<span>&gt;&gt;&gt; </span>literal_eval(<span>&#39;1 + 2&#39;</span>)
ValueError: malformed node or string
</code></pre></div>

<div><h2 id="coroutines"><a href="#coroutines" name="coroutines">#</a>Coroutines</h2><ul>
<li><strong>Coroutines have a lot in common with threads, but unlike threads, they only give up control when they call another coroutine and they don’t use as much memory.</strong></li>
<li><strong>Coroutine definition starts with <code><span>&#39;async&#39;</span></code> and its call with <code><span>&#39;await&#39;</span></code>.</strong></li>
<li><strong><code><span>&#39;asyncio.run(&lt;coroutine&gt;)&#39;</span></code> is the main entry point for asynchronous programs.</strong></li>
<li><strong>Functions wait(), gather() and as_completed() can be used when multiple coroutines need to be started at the same time.</strong></li>
<li><strong>Asyncio module also provides its own <a href="#queue">Queue</a>, <a href="#semaphoreeventbarrier">Event</a>, <a href="#lock">Lock</a> and <a href="#semaphore-event-barrier">Semaphore</a> classes.</strong></li>
</ul><div><h4 id="runsaterminalgamewhereyoucontrolanasteriskthatmustavoidnumbers">Runs a terminal game where you control an asterisk that must avoid numbers:</h4><pre><code><span>import</span> asyncio, collections, curses, enum, random

P = collections.namedtuple(<span>&#39;P&#39;</span>, <span>&#39;x y&#39;</span>)         
D = enum.Enum(<span>&#39;D&#39;</span>, <span>&#39;n e s w&#39;</span>)                  

<span><span>def</span> <span>main</span><span>(screen)</span>:</span>
    curses.curs_set(<span>0</span>)                         
    screen.nodelay(<span>True</span>)                       
    asyncio.run(main_coroutine(screen))        

<span>async</span> <span><span>def</span> <span>main_coroutine</span><span>(screen)</span>:</span>
    state = {<span>&#39;*&#39;</span>: P(<span>0</span>, <span>0</span>), **{id_: P(<span>30</span>, <span>10</span>) <span>for</span> id_ <span>in</span> range(<span>10</span>)}}
    moves = asyncio.Queue()
    coros = (*(random_controller(id_, moves) <span>for</span> id_ <span>in</span> range(<span>10</span>)),
             human_controller(screen, moves),
             model(moves, state, *screen.getmaxyx()),
             view(state, screen))
    <span>await</span> asyncio.wait(coros, return_when=asyncio.FIRST_COMPLETED)

<span>async</span> <span><span>def</span> <span>random_controller</span><span>(id_, moves)</span>:</span>
    <span>while</span> <span>True</span>:
        d = random.choice(list(D))
        moves.put_nowait((id_, d))
        <span>await</span> asyncio.sleep(random.random() / <span>2</span>)

<span>async</span> <span><span>def</span> <span>human_controller</span><span>(screen, moves)</span>:</span>
    <span>while</span> <span>True</span>:
        ch = screen.getch()
        key_mappings = {<span>259</span>: D.n, <span>261</span>: D.e, <span>258</span>: D.s, <span>260</span>: D.w}
        <span>if</span> ch <span>in</span> key_mappings:
            moves.put_nowait((<span>&#39;*&#39;</span>, key_mappings[ch]))
        <span>await</span> asyncio.sleep(<span>0.01</span>)  

<span>async</span> <span><span>def</span> <span>model</span><span>(moves, state, height, width)</span>:</span>
    <span>while</span> state[<span>&#39;*&#39;</span>] <span>not</span> <span>in</span> {p <span>for</span> id_, p <span>in</span> state.items() <span>if</span> id_ != <span>&#39;*&#39;</span>}:
        id_, d = <span>await</span> moves.get()
        p      = state[id_]
        deltas = {D.n: P(<span>0</span>, <span>-1</span>), D.e: P(<span>1</span>, <span>0</span>), D.s: P(<span>0</span>, <span>1</span>), D.w: P(<span>-1</span>, <span>0</span>)}
        new_p  = P(p.x + deltas[d].x, p.y + deltas[d].y)
        <span>if</span> <span>0</span> &lt;= new_p.x &lt; width<span>-1</span> <span>and</span> <span>0</span> &lt;= new_p.y &lt; height:
            state[id_] = new_p

<span>async</span> <span><span>def</span> <span>view</span><span>(state, screen)</span>:</span>
    <span>while</span> <span>True</span>:
        screen.clear()
        <span>for</span> id_, p <span>in</span> state.items():
            screen.addstr(p.y, p.x, str(id_))
        <span>await</span> asyncio.sleep(<span>0.01</span>)  

<span>if</span> __name__ == <span>&#39;__main__&#39;</span>:
    curses.wrapper(main)
</code></pre></div></div>




<div><div><h2 id="progressbar"><a href="#progressbar" name="progressbar">#</a>Progress Bar</h2><pre><code>
<span>&gt;&gt;&gt; </span><span>from</span> tqdm <span>import</span> tqdm
<span>&gt;&gt;&gt; </span><span>from</span> time <span>import</span> sleep
<span>&gt;&gt;&gt; </span><span>for</span> el <span>in</span> tqdm([<span>1</span>, <span>2</span>, <span>3</span>], desc=<span>&#39;Processing&#39;</span>):
<span>... </span>    sleep(<span>1</span>)
Processing: 100%|████████████████████| 3/3 [00:03&lt;00:00,  1.00s/it]
</code></pre></div></div>


<div><h2 id="plot"><a href="#plot" name="plot">#</a>Plot</h2><pre><code>
<span>import</span> matplotlib.pyplot <span>as</span> plt
plt.plot(&lt;x_data&gt;, &lt;y_data&gt; [, label=&lt;str&gt;])   
plt.legend()                                   
plt.savefig(&lt;path&gt;)                            
plt.show()                                     
plt.clf()                                      
</code></pre></div>

<div><h2 id="table"><a href="#table" name="table">#</a>Table</h2><div><h4 id="printsacsvfileasanasciitable">Prints a CSV file as an ASCII table:</h4><pre><code>
<span>import</span> csv, tabulate
<span>with</span> open(<span>&#39;test.csv&#39;</span>, encoding=<span>&#39;utf-8&#39;</span>, newline=<span>&#39;&#39;</span>) <span>as</span> file:
    rows   = csv.reader(file)
    header = [a.title() <span>for</span> a <span>in</span> next(rows)]
    table  = tabulate.tabulate(rows, header)
    print(table)
</code></pre></div></div>


<div><h2 id="curses"><a href="#curses" name="curses">#</a>Curses</h2><div><h4 id="runsabasicfileexplorerintheterminal">Runs a basic file explorer in the terminal:</h4><pre><code><span>from</span> curses <span>import</span> wrapper, ascii, A_REVERSE, KEY_UP, KEY_DOWN, KEY_LEFT, KEY_RIGHT, KEY_ENTER
<span>from</span> os <span>import</span> listdir, path, chdir

<span><span>def</span> <span>main</span><span>(screen)</span>:</span>
    ch, first, selected, paths = <span>0</span>, <span>0</span>, <span>0</span>, listdir()
    <span>while</span> ch != ascii.ESC:
        height, _ = screen.getmaxyx()
        screen.clear()
        <span>for</span> y, filename <span>in</span> enumerate(paths[first : first+height]):
            screen.addstr(y, <span>0</span>, filename, A_REVERSE * (selected == first + y))
        ch = screen.getch()
        selected += (ch == KEY_DOWN) - (ch == KEY_UP)
        selected = max(<span>0</span>, min(len(paths)<span>-1</span>, selected))
        first += (first &lt;= selected - height) - (first &gt; selected)
        <span>if</span> ch <span>in</span> [KEY_LEFT, KEY_RIGHT, KEY_ENTER, <span>10</span>, <span>13</span>]:
            new_dir = <span>&#39;..&#39;</span> <span>if</span> ch == KEY_LEFT <span>else</span> paths[selected]
            <span>if</span> path.isdir(new_dir):
                chdir(new_dir)
                first, selected, paths = <span>0</span>, <span>0</span>, listdir()

<span>if</span> __name__ == <span>&#39;__main__&#39;</span>:
    wrapper(main)
</code></pre></div></div>


<div><h2 id="logging"><a href="#logging" name="logging">#</a>Logging</h2><pre><code>
<span>from</span> loguru <span>import</span> logger
</code></pre></div>

<pre><code>logger.add(<span>&#39;debug_{time}.log&#39;</span>, colorize=<span>True</span>)  
logger.add(<span>&#39;error_{time}.log&#39;</span>, level=<span>&#39;ERROR&#39;</span>)  
logger.&lt;level&gt;(<span>&#39;A logging message.&#39;</span>)
</code></pre>
<ul>
<li><strong>Levels: <code><span>&#39;debug&#39;</span></code>, <code><span>&#39;info&#39;</span></code>, <code><span>&#39;success&#39;</span></code>, <code><span>&#39;warning&#39;</span></code>, <code><span>&#39;error&#39;</span></code>, <code><span>&#39;critical&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="exceptions-2">Exceptions</h3><p><strong>Exception description, stack trace and values of variables are appended automatically.</strong></p><pre><code><span>try</span>:
    ...
<span>except</span> &lt;exception&gt;:
    logger.exception(<span>&#39;An error happened.&#39;</span>)
</code></pre></div>


<div><h3 id="rotation">Rotation</h3><p><strong>Argument that sets a condition when a new log file is created.</strong></p><pre><code>rotation=&lt;int&gt;|&lt;datetime.timedelta&gt;|&lt;datetime.time&gt;|&lt;str&gt;
</code></pre></div>


<ul>
<li><strong><code><span>&#39;&lt;int&gt;&#39;</span></code> - Max file size in bytes.</strong></li>
<li><strong><code><span>&#39;&lt;timedelta&gt;&#39;</span></code> - Max age of a file.</strong></li>
<li><strong><code><span>&#39;&lt;time&gt;&#39;</span></code> - Time of day.</strong></li>
<li><strong><code><span>&#39;&lt;str&gt;&#39;</span></code> - Any of above as a string: <code><span>&#39;100 MB&#39;</span></code>, <code><span>&#39;1 month&#39;</span></code>, <code><span>&#39;monday at 12:00&#39;</span></code>, …</strong></li>
</ul>
<div><h3 id="retention">Retention</h3><p><strong>Sets a condition which old log files get deleted.</strong></p><pre><code>retention=&lt;int&gt;|&lt;datetime.timedelta&gt;|&lt;str&gt;
</code></pre></div>


<ul>
<li><strong><code><span>&#39;&lt;int&gt;&#39;</span></code> - Max number of files.</strong></li>
<li><strong><code><span>&#39;&lt;timedelta&gt;&#39;</span></code> - Max age of a file.</strong></li>
<li><strong><code><span>&#39;&lt;str&gt;&#39;</span></code> - Max age as a string: <code><span>&#39;1 week, 3 days&#39;</span></code>, <code><span>&#39;2 months&#39;</span></code>, …</strong></li>
</ul>
<div><h2 id="scraping"><a href="#scraping" name="scraping">#</a>Scraping</h2><div><h4 id="scrapespythonsurlversionnumberandlogofromitswikipediapage">Scrapes Python&#39;s URL, version number and logo from its Wikipedia page:</h4><pre><code>
<span>import</span> requests, bs4, sys

WIKI_URL = <span>&#39;https://en.wikipedia.org/wiki/Python_(programming_language)&#39;</span>
<span>try</span>:
    html       = requests.get(WIKI_URL).text
    document   = bs4.BeautifulSoup(html, <span>&#39;html.parser&#39;</span>)
    table      = document.find(<span>&#39;table&#39;</span>, class_=<span>&#39;infobox vevent&#39;</span>)
    python_url = table.find(<span>&#39;th&#39;</span>, text=<span>&#39;Website&#39;</span>).next_sibling.a[<span>&#39;href&#39;</span>]
    version    = table.find(<span>&#39;th&#39;</span>, text=<span>&#39;Stable release&#39;</span>).next_sibling.strings.__next__()
    logo_url   = table.find(<span>&#39;img&#39;</span>)[<span>&#39;src&#39;</span>]
    logo       = requests.get(<span>f&#39;https:<span>{logo_url}</span>&#39;</span>).content
    <span>with</span> open(<span>&#39;test.png&#39;</span>, <span>&#39;wb&#39;</span>) <span>as</span> file:
        file.write(logo)
    print(python_url, version)
<span>except</span> requests.exceptions.ConnectionError:
    print(<span>&#34;You&#39;ve got problems with connection.&#34;</span>, file=sys.stderr)
</code></pre></div></div>


<div><h2 id="web"><a href="#web" name="web">#</a>Web</h2><pre><code>
<span>from</span> bottle <span>import</span> run, route, static_file, template, post, request, response
<span>import</span> json
</code></pre></div>

<div><h3 id="run">Run</h3><pre><code>run(host=<span>&#39;localhost&#39;</span>, port=<span>8080</span>)        
run(host=<span>&#39;0.0.0.0&#39;</span>, port=<span>80</span>)            
</code></pre></div>

<div><h3 id="staticrequest">Static Request</h3><pre><code><span>@route(&#39;/img/&lt;filename&gt;&#39;)</span>
<span><span>def</span> <span>send_file</span><span>(filename)</span>:</span>
    <span>return</span> static_file(filename, root=<span>&#39;img_dir/&#39;</span>)
</code></pre></div>

<div><h3 id="dynamicrequest">Dynamic Request</h3><pre><code><span>@route(&#39;/&lt;sport&gt;&#39;)</span>
<span><span>def</span> <span>send_html</span><span>(sport)</span>:</span>
    <span>return</span> template(<span>&#39;&lt;h1&gt;{{title}}&lt;/h1&gt;&#39;</span>, title=sport)
</code></pre></div>

<div><h3 id="restrequest">REST Request</h3><pre><code><span>@post(&#39;/&lt;sport&gt;/odds&#39;)</span>
<span><span>def</span> <span>send_json</span><span>(sport)</span>:</span>
    team = request.forms.get(<span>&#39;team&#39;</span>)
    home_odds, away_odds = <span>2.44</span>, <span>3.29</span>
    response.headers[<span>&#39;Content-Type&#39;</span>] = <span>&#39;application/json&#39;</span>
    response.headers[<span>&#39;Cache-Control&#39;</span>] = <span>&#39;no-cache&#39;</span>
    <span>return</span> json.dumps([team, home_odds, away_odds])
</code></pre></div>

<div><h4 id="test">Test:</h4><pre><code>
<span>&gt;&gt;&gt; </span><span>import</span> threading, requests
<span>&gt;&gt;&gt; </span>threading.Thread(target=run, daemon=<span>True</span>).start()
<span>&gt;&gt;&gt; </span>url = <span>&#39;http://localhost:8080/football/odds&#39;</span>
<span>&gt;&gt;&gt; </span>data = {<span>&#39;team&#39;</span>: <span>&#39;arsenal f.c.&#39;</span>}
<span>&gt;&gt;&gt; </span>response = requests.post(url, data=data)
<span>&gt;&gt;&gt; </span>response.json()
[<span>&#39;arsenal f.c.&#39;</span>, <span>2.44</span>, <span>3.29</span>]
</code></pre></div>

<div><h2 id="profiling"><a href="#profiling" name="profiling">#</a>Profiling</h2><div><h3 id="stopwatch">Stopwatch</h3><pre><code><span>from</span> time <span>import</span> time
start_time = time()                     
...
duration = time() - start_time
</code></pre></div></div>


<div><h4 id="highperformance">High performance:</h4><pre><code><span>from</span> time <span>import</span> perf_counter
start_time = perf_counter()             
...
duration = perf_counter() - start_time
</code></pre></div>

<div><h3 id="timingasnippet">Timing a Snippet</h3><pre><code><span>&gt;&gt;&gt; </span><span>from</span> timeit <span>import</span> timeit
<span>&gt;&gt;&gt; </span>timeit(<span>&#34;&#39;&#39;.join(str(i) for i in range(100))&#34;</span>,
<span>... </span>       number=<span>10000</span>, globals=globals(), setup=<span>&#39;pass&#39;</span>)
<span>0.34986</span>
</code></pre></div>

<div><h3 id="profilingbyline">Profiling by Line</h3><pre><code>
<span>@profile</span>
<span><span>def</span> <span>main</span><span>()</span>:</span>
    a = [*range(<span>10000</span>)]
    b = {*range(<span>10000</span>)}
main()
</code></pre></div>

<pre><code>$ kernprof -lv test.py
Line #   Hits     Time  Per Hit   % Time  Line Contents
=======================================================
     1                                    @profile
     2                                    def main():
     3      1    955.0    955.0     43.7      a = [*range(10000)]
     4      1   1231.0   1231.0     56.3      b = {*range(10000)}
</code></pre>
<pre><code>$ python3 -m memory_profiler test.py
Line #         Mem usage      Increment   Line Contents
=======================================================
     1        37.668 MiB     37.668 MiB   @profile
     2                                    def main():
     3        38.012 MiB      0.344 MiB       a = [*range(10000)]
     4        38.477 MiB      0.465 MiB       b = {*range(10000)}
</code></pre>
<div><h3 id="callgraph">Call Graph</h3><div><h4 id="generatesapngimageofthecallgraphwithhighlightedbottlenecks">Generates a PNG image of the call graph with highlighted bottlenecks:</h4><pre><code>
<span>from</span> pycallgraph2 <span>import</span> output, PyCallGraph
<span>from</span> datetime <span>import</span> datetime
filename = <span>f&#39;profile-<span>{datetime.now():%Y%m%d%H%M%S}</span>.png&#39;</span>
drawer = output.GraphvizOutput(output_file=filename)
<span>with</span> PyCallGraph(drawer):
    &lt;code_to_be_profiled&gt;
</code></pre></div></div>


<div><h2 id="numpy"><a href="#numpy" name="numpy">#</a>NumPy</h2><p><strong>Array manipulation mini-language. It can run up to one hundred times faster than the equivalent Python code. An even faster alternative that runs on a GPU is called CuPy.</strong></p><pre><code>
<span>import</span> numpy <span>as</span> np
</code></pre></div>


<pre><code>&lt;array&gt; = np.array(&lt;list&gt;)
&lt;array&gt; = np.arange(from_inclusive, to_exclusive, ±step_size)
&lt;array&gt; = np.ones(&lt;shape&gt;)
&lt;array&gt; = np.random.randint(from_inclusive, to_exclusive, &lt;shape&gt;)
</code></pre>
<pre><code>&lt;array&gt;.shape = &lt;shape&gt;
&lt;view&gt;  = &lt;array&gt;.reshape(&lt;shape&gt;)
&lt;view&gt;  = np.broadcast_to(&lt;array&gt;, &lt;shape&gt;)
</code></pre>
<pre><code>&lt;array&gt; = &lt;array&gt;.sum(axis)
indexes = &lt;array&gt;.argmin(axis)
</code></pre>
<ul>
<li><strong>Shape is a tuple of dimension sizes.</strong></li>
<li><strong>Axis is an index of the dimension that gets collapsed. Leftmost dimension has index 0.</strong></li>
</ul>
<div><h3 id="indexing">Indexing</h3><pre><code>&lt;el&gt;       = &lt;2d_array&gt;[row_index, column_index]
&lt;1d_view&gt;  = &lt;2d_array&gt;[row_index]
&lt;1d_view&gt;  = &lt;2d_array&gt;[:, column_index]
</code></pre></div>

<pre><code>&lt;1d_array&gt; = &lt;2d_array&gt;[row_indexes, column_indexes]
&lt;2d_array&gt; = &lt;2d_array&gt;[row_indexes]
&lt;2d_array&gt; = &lt;2d_array&gt;[:, column_indexes]
</code></pre>
<pre><code>&lt;2d_bools&gt; = &lt;2d_array&gt; &gt;&lt;== &lt;el&gt;
&lt;1d_array&gt; = &lt;2d_array&gt;[&lt;2d_bools&gt;]
</code></pre>
<div><h3 id="broadcasting">Broadcasting</h3><p><strong>Broadcasting is a set of rules by which NumPy functions operate on arrays of different sizes and/or dimensions.</strong></p><pre><code>left  = [[<span>0.1</span>], [<span>0.6</span>], [<span>0.8</span>]]        
right = [ <span>0.1</span> ,  <span>0.6</span> ,  <span>0.8</span> ]        
</code></pre></div>


<div><h4 id="1ifarrayshapesdifferinlengthleftpadtheshortershapewithones">1. If array shapes differ in length, left-pad the shorter shape with ones:</h4><pre><code>left  = [[<span>0.1</span>], [<span>0.6</span>], [<span>0.8</span>]]        
right = [[<span>0.1</span> ,  <span>0.6</span> ,  <span>0.8</span>]]        
</code></pre></div>

<div><h4 id="2ifanydimensionsdifferinsizeexpandtheonesthathavesize1byduplicatingtheirelements">2. If any dimensions differ in size, expand the ones that have size 1 by duplicating their elements:</h4><pre><code>left  = [[<span>0.1</span>, <span>0.1</span>, <span>0.1</span>], [<span>0.6</span>, <span>0.6</span>, <span>0.6</span>], [<span>0.8</span>, <span>0.8</span>, <span>0.8</span>]]  
right = [[<span>0.1</span>, <span>0.6</span>, <span>0.8</span>], [<span>0.1</span>, <span>0.6</span>, <span>0.8</span>], [<span>0.1</span>, <span>0.6</span>, <span>0.8</span>]]  
</code></pre></div>

<div><h4 id="3ifneithernonmatchingdimensionhassize1raiseanerror">3. If neither non-matching dimension has size 1, raise an error.</h4><div><h3 id="example-2">Example</h3><div><h4 id="foreachpointreturnsindexofitsnearestpoint010608121">For each point returns index of its nearest point (<code>[<span>0.1</span>, <span>0.6</span>, <span>0.8</span>] =&gt; [<span>1</span>, <span>2</span>, <span>1</span>]</code>):</h4><pre><code><span>&gt;&gt;&gt; </span>points = np.array([<span>0.1</span>, <span>0.6</span>, <span>0.8</span>])
 [ <span>0.1</span>,  <span>0.6</span>,  <span>0.8</span>]
<span>&gt;&gt;&gt; </span>wrapped_points = points.reshape(<span>3</span>, <span>1</span>)
[[ <span>0.1</span>],
 [ <span>0.6</span>],
 [ <span>0.8</span>]]
<span>&gt;&gt;&gt; </span>distances = wrapped_points - points
[[ <span>0.</span> , <span>-0.5</span>, <span>-0.7</span>],
 [ <span>0.5</span>,  <span>0.</span> , <span>-0.2</span>],
 [ <span>0.7</span>,  <span>0.2</span>,  <span>0.</span> ]]
<span>&gt;&gt;&gt; </span>distances = np.abs(distances)
[[ <span>0.</span> ,  <span>0.5</span>,  <span>0.7</span>],
 [ <span>0.5</span>,  <span>0.</span> ,  <span>0.2</span>],
 [ <span>0.7</span>,  <span>0.2</span>,  <span>0.</span> ]]
<span>&gt;&gt;&gt; </span>i = np.arange(<span>3</span>)
[<span>0</span>, <span>1</span>, <span>2</span>]
<span>&gt;&gt;&gt; </span>distances[i, i] = np.inf
[[ inf,  <span>0.5</span>,  <span>0.7</span>],
 [ <span>0.5</span>,  inf,  <span>0.2</span>],
 [ <span>0.7</span>,  <span>0.2</span>,  inf]]
<span>&gt;&gt;&gt; </span>distances.argmin(<span>1</span>)
[<span>1</span>, <span>2</span>, <span>1</span>]
</code></pre></div></div></div>



<div><h2 id="image"><a href="#image" name="image">#</a>Image</h2><pre><code>
<span>from</span> PIL <span>import</span> Image
</code></pre></div>

<pre><code>&lt;Image&gt; = Image.new(<span>&#39;&lt;mode&gt;&#39;</span>, (width, height))  
&lt;Image&gt; = Image.open(&lt;path&gt;)                    
&lt;Image&gt; = &lt;Image&gt;.convert(<span>&#39;&lt;mode&gt;&#39;</span>)             
&lt;Image&gt;.save(&lt;path&gt;)                            
&lt;Image&gt;.show()                                  
</code></pre>
<pre><code>&lt;int/tuple&gt; = &lt;Image&gt;.getpixel((x, y))          
&lt;Image&gt;.putpixel((x, y), &lt;int/tuple&gt;)           
&lt;ImagingCore&gt; = &lt;Image&gt;.getdata()               
&lt;Image&gt;.putdata(&lt;list/ImagingCore&gt;)             
&lt;Image&gt;.paste(&lt;Image&gt;, (x, y))                  
</code></pre>
<pre><code>&lt;2d_array&gt; = np.array(&lt;Image_L&gt;)                
&lt;3d_array&gt; = np.array(&lt;Image_RGB&gt;)              
&lt;Image&gt;    = Image.fromarray(&lt;array&gt;)           
</code></pre>
<div><h3 id="modes-1">Modes</h3><ul>
<li><strong><code><span>&#39;1&#39;</span></code> - 1-bit pixels, black and white, stored with one pixel per byte.</strong></li>
<li><strong><code><span>&#39;L&#39;</span></code> - 8-bit pixels, greyscale.</strong></li>
<li><strong><code><span>&#39;RGB&#39;</span></code> - 3x8-bit pixels, true color.</strong></li>
<li><strong><code><span>&#39;RGBA&#39;</span></code> - 4x8-bit pixels, true color with transparency mask.</strong></li>
<li><strong><code><span>&#39;HSV&#39;</span></code> - 3x8-bit pixels, Hue, Saturation, Value color space.</strong></li>
</ul><div><h3 id="examples">Examples</h3><div><h4 id="createsapngimageofarainbowgradient">Creates a PNG image of a rainbow gradient:</h4><pre><code>WIDTH, HEIGHT = <span>100</span>, <span>100</span>
n_pixels = WIDTH * HEIGHT
hues = (<span>255</span> * i/n_pixels <span>for</span> i <span>in</span> range(n_pixels))
img = Image.new(<span>&#39;HSV&#39;</span>, (WIDTH, HEIGHT))
img.putdata([(int(h), <span>255</span>, <span>255</span>) <span>for</span> h <span>in</span> hues])
img.convert(<span>&#39;RGB&#39;</span>).save(<span>&#39;test.png&#39;</span>)
</code></pre></div></div></div>




<div><h4 id="addsnoisetoapngimage">Adds noise to a PNG image:</h4><pre><code><span>from</span> random <span>import</span> randint
add_noise = <span>lambda</span> value: max(<span>0</span>, min(<span>255</span>, value + randint(<span>-20</span>, <span>20</span>)))
img = Image.open(<span>&#39;test.png&#39;</span>).convert(<span>&#39;HSV&#39;</span>)
img.putdata([(add_noise(h), s, v) <span>for</span> h, s, v <span>in</span> img.getdata()])
img.convert(<span>&#39;RGB&#39;</span>).save(<span>&#39;test.png&#39;</span>)
</code></pre></div>

<div><h3 id="imagedraw">Image Draw</h3><pre><code><span>from</span> PIL <span>import</span> ImageDraw
&lt;ImageDraw&gt; = ImageDraw.Draw(&lt;Image&gt;)
</code></pre></div>

<pre><code>&lt;ImageDraw&gt;.point((x, y))
&lt;ImageDraw&gt;.line((x1, y1, x2, y2 [, ...]))
&lt;ImageDraw&gt;.arc((x1, y1, x2, y2), from_deg, to_deg)
&lt;ImageDraw&gt;.rectangle((x1, y1, x2, y2))
&lt;ImageDraw&gt;.polygon((x1, y1, x2, y2 [, ...]))
&lt;ImageDraw&gt;.ellipse((x1, y1, x2, y2))
</code></pre>
<ul>
<li><strong>Use <code><span>&#39;fill=&lt;color&gt;&#39;</span></code> to set the primary color.</strong></li>
<li><strong>Use <code><span>&#39;width=&lt;int&gt;&#39;</span></code> to set the width of lines or contours.</strong></li>
<li><strong>Use <code><span>&#39;outline=&lt;color&gt;&#39;</span></code> to set the color of the contours.</strong></li>
<li><strong>Colors can be specified as an int, tuple, <code><span>&#39;#rrggbb[aa]&#39;</span></code> string or a color name.</strong></li>
</ul>
<div><h2 id="animation"><a href="#animation" name="animation">#</a>Animation</h2><div><h4 id="createsagifofabouncingball">Creates a GIF of a bouncing ball:</h4><pre><code>
<span>from</span> PIL <span>import</span> Image, ImageDraw
<span>import</span> imageio
WIDTH, R = <span>126</span>, <span>10</span>
frames = []
<span>for</span> velocity <span>in</span> range(<span>1</span>, <span>16</span>):
    y = sum(range(velocity))
    frame = Image.new(<span>&#39;L&#39;</span>, (WIDTH, WIDTH))
    draw  = ImageDraw.Draw(frame)
    draw.ellipse((WIDTH/<span>2</span>-R, y, WIDTH/<span>2</span>+R, y+R*<span>2</span>), fill=<span>&#39;white&#39;</span>)
    frames.append(frame)
frames += reversed(frames[<span>1</span>:<span>-1</span>])
imageio.mimsave(<span>&#39;test.gif&#39;</span>, frames, duration=<span>0.03</span>)
</code></pre></div></div>




<pre><code>&lt;Wave_read&gt;  = wave.open(<span>&#39;&lt;path&gt;&#39;</span>, <span>&#39;rb&#39;</span>)        
framerate    = &lt;Wave_read&gt;.getframerate()       
nchannels    = &lt;Wave_read&gt;.getnchannels()       
sampwidth    = &lt;Wave_read&gt;.getsampwidth()       
nframes      = &lt;Wave_read&gt;.getnframes()         
&lt;params&gt;     = &lt;Wave_read&gt;.getparams()          
&lt;bytes&gt;      = &lt;Wave_read&gt;.readframes(nframes)  
</code></pre>
<pre><code>&lt;Wave_write&gt; = wave.open(<span>&#39;&lt;path&gt;&#39;</span>, <span>&#39;wb&#39;</span>)        
&lt;Wave_write&gt;.setframerate(&lt;int&gt;)                
&lt;Wave_write&gt;.setnchannels(&lt;int&gt;)                
&lt;Wave_write&gt;.setsampwidth(&lt;int&gt;)                
&lt;Wave_write&gt;.setparams(&lt;params&gt;)                
&lt;Wave_write&gt;.writeframes(&lt;bytes&gt;)               
</code></pre>
<ul>
<li><strong>Bytes object contains a sequence of frames, each consisting of one or more samples.</strong></li>
<li><strong>In a stereo signal, the first sample of a frame belongs to the left channel.</strong></li>
<li><strong>Each sample consists of one or more bytes that, when converted to an integer, indicate the displacement of a speaker membrane at a given moment.</strong></li>
<li><strong>If sample width is one byte, then the integer should be encoded unsigned.</strong></li>
<li><strong>For all other sizes, the integer should be encoded signed with little-endian byte order.</strong></li>
</ul>
<div><h3 id="samplevalues">Sample Values</h3><pre><code>┏━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━┯━━━━━━━━━━━━━┓
┃ sampwidth │     min     │ zero │     max     ┃
┠───────────┼─────────────┼──────┼─────────────┨
┃     <span>1</span>     │           <span>0</span> │  <span>128</span> │         <span>255</span> ┃
┃     <span>2</span>     │      <span>-32768</span> │    <span>0</span> │       <span>32767</span> ┃
┃     <span>3</span>     │    <span>-8388608</span> │    <span>0</span> │     <span>8388607</span> ┃
┃     <span>4</span>     │ <span>-2147483648</span> │    <span>0</span> │  <span>2147483647</span> ┃
┗━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━┷━━━━━━━━━━━━━┛
</code></pre></div>

<div><h3 id="readfloatsamplesfromwavfile">Read Float Samples from WAV File</h3><pre><code><span><span>def</span> <span>read_wav_file</span><span>(filename)</span>:</span>
    <span><span>def</span> <span>get_int</span><span>(bytes_obj)</span>:</span>
        an_int = int.from_bytes(bytes_obj, <span>&#39;little&#39;</span>, signed=sampwidth!=<span>1</span>)
        <span>return</span> an_int - <span>128</span> * (sampwidth == <span>1</span>)
    <span>with</span> wave.open(filename, <span>&#39;rb&#39;</span>) <span>as</span> file:
        sampwidth = file.getsampwidth()
        frames = file.readframes(<span>-1</span>)
    bytes_samples = (frames[i : i+sampwidth] <span>for</span> i <span>in</span> range(<span>0</span>, len(frames), sampwidth))
    <span>return</span> [get_int(b) / pow(<span>2</span>, sampwidth * <span>8</span> - <span>1</span>) <span>for</span> b <span>in</span> bytes_samples]
</code></pre></div>

<div><h3 id="writefloatsamplestowavfile">Write Float Samples to WAV File</h3><pre><code><span><span>def</span> <span>write_to_wav_file</span><span>(filename, float_samples, nchannels=<span>1</span>, sampwidth=<span>2</span>, framerate=<span>44100</span>)</span>:</span>
    <span><span>def</span> <span>get_bytes</span><span>(a_float)</span>:</span>
        a_float = max(<span>-1</span>, min(<span>1</span> - <span>2e-16</span>, a_float))
        a_float += sampwidth == <span>1</span>
        a_float *= pow(<span>2</span>, sampwidth * <span>8</span> - <span>1</span>)
        <span>return</span> int(a_float).to_bytes(sampwidth, <span>&#39;little&#39;</span>, signed=sampwidth!=<span>1</span>) 
    <span>with</span> wave.open(filename, <span>&#39;wb&#39;</span>) <span>as</span> file:
        file.setnchannels(nchannels)
        file.setsampwidth(sampwidth)
        file.setframerate(framerate)
        file.writeframes(<span>b&#39;&#39;</span>.join(get_bytes(f) <span>for</span> f <span>in</span> float_samples))
</code></pre></div>

<div><h3 id="examples-1">Examples</h3><div><h4 id="savesasinewavetoamonowavfile">Saves a sine wave to a mono WAV file:</h4><pre><code><span>from</span> math <span>import</span> pi, sin
samples_f = (sin(i * <span>2</span> * pi * <span>440</span> / <span>44100</span>) <span>for</span> i <span>in</span> range(<span>100000</span>))
write_to_wav_file(<span>&#39;test.wav&#39;</span>, samples_f)
</code></pre></div></div>


<div><h4 id="addsnoisetoamonowavfile">Adds noise to a mono WAV file:</h4><pre><code><span>from</span> random <span>import</span> random
add_noise = <span>lambda</span> value: value + (random() - <span>0.5</span>) * <span>0.03</span>
samples_f = (add_noise(f) <span>for</span> f <span>in</span> read_wav_file(<span>&#39;test.wav&#39;</span>))
write_to_wav_file(<span>&#39;test.wav&#39;</span>, samples_f)
</code></pre></div>

<div><h4 id="playsawavfile">Plays a WAV file:</h4><pre><code>
<span>from</span> simpleaudio <span>import</span> play_buffer
<span>with</span> wave.open(<span>&#39;test.wav&#39;</span>, <span>&#39;rb&#39;</span>) <span>as</span> file:
    p = file.getparams()
    frames = file.readframes(<span>-1</span>)
    play_buffer(frames, p.nchannels, p.sampwidth, p.framerate)
</code></pre></div>

<div><h3 id="texttospeech">Text to Speech</h3><pre><code>
<span>import</span> pyttsx3
engine = pyttsx3.init()
engine.say(<span>&#39;Sally sells seashells by the seashore.&#39;</span>)
engine.runAndWait()
</code></pre></div>

<div><h2 id="synthesizer"><a href="#synthesizer" name="synthesizer">#</a>Synthesizer</h2><div><h4 id="playspopcornbygershonkingsley">Plays Popcorn by Gershon Kingsley:</h4><pre><code>
<span>import</span> math, struct, simpleaudio
<span>from</span> itertools <span>import</span> repeat, chain
F  = <span>44100</span>
P1 = <span>&#39;71♩,69♪,,71♩,66♪,,62♩,66♪,,59♩,,&#39;</span>
P2 = <span>&#39;71♩,73♪,,74♩,73♪,,74♪,,71♪,,73♩,71♪,,73♪,,69♪,,71♩,69♪,,71♪,,67♪,,71♩,,&#39;</span>
get_pause   = <span>lambda</span> seconds: repeat(<span>0</span>, int(seconds * F))
sin_f       = <span>lambda</span> i, hz: math.sin(i * <span>2</span> * math.pi * hz / F)
get_wave    = <span>lambda</span> hz, seconds: (sin_f(i, hz) <span>for</span> i <span>in</span> range(int(seconds * F)))
get_hz      = <span>lambda</span> key: <span>8.176</span> * <span>2</span> ** (int(key) / <span>12</span>)
parse_note  = <span>lambda</span> note: (get_hz(note[:<span>2</span>]), <span>1</span>/<span>4</span> <span>if</span> <span>&#39;♩&#39;</span> <span>in</span> note <span>else</span> <span>1</span>/<span>8</span>)
get_samples = <span>lambda</span> note: get_wave(*parse_note(note)) <span>if</span> note <span>else</span> get_pause(<span>1</span>/<span>8</span>)
samples_f   = chain.from_iterable(get_samples(n) <span>for</span> n <span>in</span> <span>f&#39;<span>{P1}</span>,<span>{P1}</span>,<span>{P2}</span>&#39;</span>.split(<span>&#39;,&#39;</span>))
samples_b   = <span>b&#39;&#39;</span>.join(struct.pack(<span>&#39;&lt;h&#39;</span>, int(f * <span>30000</span>)) <span>for</span> f <span>in</span> samples_f)
simpleaudio.play_buffer(samples_b, <span>1</span>, <span>2</span>, F)
</code></pre></div></div>


<div><h2 id="pygame"><a href="#pygame" name="pygame">#</a>Pygame</h2><div><h3 id="basicexample-1">Basic Example</h3><pre><code>
<span>import</span> pygame <span>as</span> pg
pg.init()
screen = pg.display.set_mode((<span>500</span>, <span>500</span>))
rect = pg.Rect(<span>240</span>, <span>240</span>, <span>20</span>, <span>20</span>)
<span>while</span> all(event.type != pg.QUIT <span>for</span> event <span>in</span> pg.event.get()):
    deltas = {pg.K_UP: (<span>0</span>, <span>-1</span>), pg.K_RIGHT: (<span>1</span>, <span>0</span>), pg.K_DOWN: (<span>0</span>, <span>1</span>), pg.K_LEFT: (<span>-1</span>, <span>0</span>)}
    <span>for</span> key_code, is_pressed <span>in</span> enumerate(pg.key.get_pressed()):
        rect = rect.move(deltas[key_code]) <span>if</span> key_code <span>in</span> deltas <span>and</span> is_pressed <span>else</span> rect
    screen.fill((<span>0</span>, <span>0</span>, <span>0</span>))
    pg.draw.rect(screen, (<span>255</span>, <span>255</span>, <span>255</span>), rect)
    pg.display.flip()
</code></pre></div></div>


<div><h3 id="rectangle">Rectangle</h3><p><strong>Object for storing rectangular coordinates.</strong></p><pre><code>&lt;Rect&gt; = pg.Rect(x, y, width, height)           
&lt;int&gt;  = &lt;Rect&gt;.x/y/centerx/centery/…           
&lt;tup.&gt; = &lt;Rect&gt;.topleft/center/…                
&lt;Rect&gt; = &lt;Rect&gt;.move((x, y))                    
</code></pre></div>


<pre><code>&lt;bool&gt; = &lt;Rect&gt;.collidepoint((x, y))            
&lt;bool&gt; = &lt;Rect&gt;.colliderect(&lt;Rect&gt;)             
&lt;int&gt;  = &lt;Rect&gt;.collidelist(&lt;list_of_Rect&gt;)     
&lt;list&gt; = &lt;Rect&gt;.collidelistall(&lt;list_of_Rect&gt;)  
</code></pre>
<div><h3 id="surface">Surface</h3><p><strong>Object for representing images.</strong></p><pre><code>&lt;Surf&gt; = pg.display.set_mode((width, height))   
&lt;Surf&gt; = pg.Surface((width, height), flags=<span>0</span>)   
&lt;Surf&gt; = pg.image.load(<span>&#39;&lt;path&gt;&#39;</span>)                
&lt;Surf&gt; = &lt;Surf&gt;.subsurface(&lt;Rect&gt;)              
</code></pre></div>


<pre><code>&lt;Surf&gt;.fill(color)                              
&lt;Surf&gt;.set_at((x, y), color)                    
&lt;Surf&gt;.blit(&lt;Surf&gt;, (x, y))                     
</code></pre>
<pre><code><span>from</span> pygame.transform <span>import</span> scale, ...
&lt;Surf&gt; = scale(&lt;Surf&gt;, (width, height))         
&lt;Surf&gt; = rotate(&lt;Surf&gt;, degrees)                
&lt;Surf&gt; = flip(&lt;Surf&gt;, x_bool, y_bool)           
</code></pre>
<pre><code><span>from</span> pygame.draw <span>import</span> line, ...
line(&lt;Surf&gt;, color, (x1, y1), (x2, y2), width)  
arc(&lt;Surf&gt;, color, &lt;Rect&gt;, from_rad, to_rad)    
rect(&lt;Surf&gt;, color, &lt;Rect&gt;)                     
</code></pre>
<div><h3 id="font">Font</h3><pre><code>&lt;Font&gt; = pg.font.SysFont(<span>&#39;&lt;name&gt;&#39;</span>, size)        
&lt;Font&gt; = pg.font.Font(<span>&#39;&lt;path&gt;&#39;</span>, size)           
&lt;Surf&gt; = &lt;Font&gt;.render(text, antialias, color)  
</code></pre></div>

<div><h3 id="sound">Sound</h3><pre><code>&lt;Sound&gt; = pg.mixer.Sound(<span>&#39;&lt;path&gt;&#39;</span>)              
&lt;Sound&gt;.play()                                  
</code></pre></div>

<div><h3 id="basicmariobrothersexample">Basic Mario Brothers Example</h3><pre><code><span>import</span> collections, dataclasses, enum, io, itertools <span>as</span> it, pygame <span>as</span> pg, urllib.request
<span>from</span> random <span>import</span> randint

P = collections.namedtuple(<span>&#39;P&#39;</span>, <span>&#39;x y&#39;</span>)          
D = enum.Enum(<span>&#39;D&#39;</span>, <span>&#39;n e s w&#39;</span>)                   
SIZE, MAX_SPEED = <span>50</span>, P(<span>5</span>, <span>10</span>)                  

<span><span>def</span> <span>main</span><span>()</span>:</span>
    <span><span>def</span> <span>get_screen</span><span>()</span>:</span>
        pg.init()
        <span>return</span> pg.display.set_mode((SIZE*<span>16</span>, SIZE*<span>16</span>))
    <span><span>def</span> <span>get_images</span><span>()</span>:</span>
        url = <span>&#39;https://gto76.github.io/python-cheatsheet/web/mario_bros.png&#39;</span>
        img = pg.image.load(io.BytesIO(urllib.request.urlopen(url).read()))
        <span>return</span> [img.subsurface(get_rect(x, <span>0</span>)) <span>for</span> x <span>in</span> range(img.get_width() // <span>16</span>)]
    <span><span>def</span> <span>get_mario</span><span>()</span>:</span>
        Mario = dataclasses.make_dataclass(<span>&#39;Mario&#39;</span>, <span>&#39;rect spd facing_left frame_cycle&#39;</span>.split())
        <span>return</span> Mario(get_rect(<span>1</span>, <span>1</span>), P(<span>0</span>, <span>0</span>), <span>False</span>, it.cycle(range(<span>3</span>)))
    <span><span>def</span> <span>get_tiles</span><span>()</span>:</span>
        positions = [p <span>for</span> p <span>in</span> it.product(range(SIZE), repeat=<span>2</span>) <span>if</span> {*p} &amp; {<span>0</span>, SIZE<span>-1</span>}] + \
            [(randint(<span>1</span>, SIZE<span>-2</span>), randint(<span>2</span>, SIZE<span>-2</span>)) <span>for</span> _ <span>in</span> range(SIZE**<span>2</span> // <span>10</span>)]
        <span>return</span> [get_rect(*p) <span>for</span> p <span>in</span> positions]
    <span><span>def</span> <span>get_rect</span><span>(x, y)</span>:</span>
        <span>return</span> pg.Rect(x*<span>16</span>, y*<span>16</span>, <span>16</span>, <span>16</span>)
    run(get_screen(), get_images(), get_mario(), get_tiles())

<span><span>def</span> <span>run</span><span>(screen, images, mario, tiles)</span>:</span>
    clock = pg.time.Clock()
    <span>while</span> all(event.type != pg.QUIT <span>for</span> event <span>in</span> pg.event.get()):
        keys = {pg.K_UP: D.n, pg.K_RIGHT: D.e, pg.K_DOWN: D.s, pg.K_LEFT: D.w}
        pressed = {keys.get(i) <span>for</span> i, on <span>in</span> enumerate(pg.key.get_pressed()) <span>if</span> on}
        update_speed(mario, tiles, pressed)
        update_position(mario, tiles)
        draw(screen, images, mario, tiles, pressed)
        clock.tick(<span>28</span>)

<span><span>def</span> <span>update_speed</span><span>(mario, tiles, pressed)</span>:</span>
    x, y = mario.spd
    x += <span>2</span> * ((D.e <span>in</span> pressed) - (D.w <span>in</span> pressed))
    x -= (x &gt; <span>0</span>) - (x &lt; <span>0</span>)
    y += <span>1</span> <span>if</span> D.s <span>not</span> <span>in</span> get_boundaries(mario.rect, tiles) <span>else</span> (D.n <span>in</span> pressed) * <span>-10</span>
    mario.spd = P(*[max(-limit, min(limit, s)) <span>for</span> limit, s <span>in</span> zip(MAX_SPEED, P(x, y))])

<span><span>def</span> <span>update_position</span><span>(mario, tiles)</span>:</span>
    x, y = mario.rect.topleft
    n_steps = max(abs(s) <span>for</span> s <span>in</span> mario.spd)
    <span>for</span> _ <span>in</span> range(n_steps):
        mario.spd = stop_on_collision(mario.spd, get_boundaries(mario.rect, tiles))
        x, y = x + mario.spd.x/n_steps, y + mario.spd.y/n_steps
        mario.rect.topleft = x, y

<span><span>def</span> <span>get_boundaries</span><span>(rect, tiles)</span>:</span>
    deltas = {D.n: P(<span>0</span>, <span>-1</span>), D.e: P(<span>1</span>, <span>0</span>), D.s: P(<span>0</span>, <span>1</span>), D.w: P(<span>-1</span>, <span>0</span>)}
    <span>return</span> {d <span>for</span> d, delta <span>in</span> deltas.items() <span>if</span> rect.move(delta).collidelist(tiles) != <span>-1</span>}

<span><span>def</span> <span>stop_on_collision</span><span>(spd, bounds)</span>:</span>
    <span>return</span> P(x=<span>0</span> <span>if</span> (D.w <span>in</span> bounds <span>and</span> spd.x &lt; <span>0</span>) <span>or</span> (D.e <span>in</span> bounds <span>and</span> spd.x &gt; <span>0</span>) <span>else</span> spd.x,
             y=<span>0</span> <span>if</span> (D.n <span>in</span> bounds <span>and</span> spd.y &lt; <span>0</span>) <span>or</span> (D.s <span>in</span> bounds <span>and</span> spd.y &gt; <span>0</span>) <span>else</span> spd.y)

<span><span>def</span> <span>draw</span><span>(screen, images, mario, tiles, pressed)</span>:</span>
    <span><span>def</span> <span>get_marios_image_index</span><span>()</span>:</span>
        <span>if</span> D.s <span>not</span> <span>in</span> get_boundaries(mario.rect, tiles):
            <span>return</span> <span>4</span>
        <span>return</span> next(mario.frame_cycle) <span>if</span> {D.w, D.e} &amp; pressed <span>else</span> <span>6</span>
    screen.fill((<span>85</span>, <span>168</span>, <span>255</span>))
    mario.facing_left = (D.w <span>in</span> pressed) <span>if</span> {D.w, D.e} &amp; pressed <span>else</span> mario.facing_left
    screen.blit(images[get_marios_image_index() + mario.facing_left * <span>9</span>], mario.rect)
    <span>for</span> rect <span>in</span> tiles:
        screen.blit(images[<span>18</span> <span>if</span> {*rect.topleft} &amp; {<span>0</span>, (SIZE<span>-1</span>)*<span>16</span>} <span>else</span> <span>19</span>], rect)
    pg.display.flip()

<span>if</span> __name__ == <span>&#39;__main__&#39;</span>:
    main()
</code></pre></div>

<div><h2 id="pandas"><a href="#pandas" name="pandas">#</a>Pandas</h2><pre><code>
<span>import</span> pandas <span>as</span> pd
<span>from</span> pandas <span>import</span> Series, DataFrame
</code></pre></div>

<div><h3 id="series">Series</h3><p><strong>Ordered dictionary with a name.</strong></p><pre><code><span>&gt;&gt;&gt; </span>Series([<span>1</span>, <span>2</span>], index=[<span>&#39;x&#39;</span>, <span>&#39;y&#39;</span>], name=<span>&#39;a&#39;</span>)
x    <span>1</span>
y    <span>2</span>
Name: a, dtype: int64
</code></pre></div>


<pre><code>&lt;Sr&gt; = Series(&lt;list&gt;)                         
&lt;Sr&gt; = Series(&lt;dict&gt;)                         
&lt;Sr&gt; = Series(&lt;dict/Series&gt;, index=&lt;list&gt;)    
</code></pre>
<pre><code>&lt;el&gt; = &lt;Sr&gt;.loc[key]                          
&lt;Sr&gt; = &lt;Sr&gt;.loc[keys]                         
&lt;Sr&gt; = &lt;Sr&gt;.loc[from_key : to_key_inclusive]  
</code></pre>
<pre><code>&lt;el&gt; = &lt;Sr&gt;[key/index]                        
&lt;Sr&gt; = &lt;Sr&gt;[keys/indexes]                     
&lt;Sr&gt; = &lt;Sr&gt;[bools]                            
</code></pre>
<pre><code>&lt;Sr&gt; = &lt;Sr&gt; &gt;&lt;== &lt;el/Sr&gt;                      
&lt;Sr&gt; = &lt;Sr&gt; +-*/ &lt;el/Sr&gt;                      
</code></pre>
<pre><code>&lt;Sr&gt; = &lt;Sr&gt;.append(&lt;Sr&gt;)                      
&lt;Sr&gt; = &lt;Sr&gt;.combine_first(&lt;Sr&gt;)               
&lt;Sr&gt;.update(&lt;Sr&gt;)                             
</code></pre>
<div><h4 id="aggregatetransformmap">Aggregate, Transform, Map:</h4><pre><code>&lt;el&gt; = &lt;Sr&gt;.sum/max/mean/idxmax/all()         
&lt;Sr&gt; = &lt;Sr&gt;.rank/diff/cumsum/ffill/interpl()  
&lt;Sr&gt; = &lt;Sr&gt;.fillna(&lt;el&gt;)                      
</code></pre></div>

<ul>
<li><strong>The way <code><span>&#39;aggregate()&#39;</span></code> and <code><span>&#39;transform()&#39;</span></code> find out whether the passed function accepts an element or the whole Series is by passing it a single value at first and if it raises an error, then they pass it the whole Series.</strong></li>
</ul>
<pre><code><span>&gt;&gt;&gt; </span>sr = Series([<span>1</span>, <span>2</span>], index=[<span>&#39;x&#39;</span>, <span>&#39;y&#39;</span>])
x    <span>1</span>
y    <span>2</span>
</code></pre>
<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━┓
┃             │    <span>&#39;sum&#39;</span>    │   [<span>&#39;sum&#39;</span>]   │ {<span>&#39;s&#39;</span>: <span>&#39;sum&#39;</span>}  ┃
┠─────────────┼─────────────┼─────────────┼───────────────┨
┃ sr.apply(…) │      <span>3</span>      │    sum  <span>3</span>   │     s  <span>3</span>      ┃
┃ sr.agg(…)   │             │             │               ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━┛
</code></pre>
<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━┓
┃             │    <span>&#39;rank&#39;</span>   │   [<span>&#39;rank&#39;</span>]  │ {<span>&#39;r&#39;</span>: <span>&#39;rank&#39;</span>} ┃
┠─────────────┼─────────────┼─────────────┼───────────────┨
┃ sr.apply(…) │             │      rank   │               ┃
┃ sr.agg(…)   │     x  <span>1</span>    │   x     <span>1</span>   │    r  x  <span>1</span>    ┃
┃ sr.trans(…) │     y  <span>2</span>    │   y     <span>2</span>   │       y  <span>2</span>    ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━┛
</code></pre>
<ul>
<li><strong>Last result has a hierarchical index. Use <code><span>&#39;&lt;Sr&gt;[key_1, key_2]&#39;</span></code> to get its values.</strong></li>
</ul>
<div><h3 id="dataframe">DataFrame</h3><p><strong>Table with labeled rows and columns.</strong></p><pre><code><span>&gt;&gt;&gt; </span>DataFrame([[<span>1</span>, <span>2</span>], [<span>3</span>, <span>4</span>]], index=[<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>], columns=[<span>&#39;x&#39;</span>, <span>&#39;y&#39;</span>])
   x  y
a  <span>1</span>  <span>2</span>
b  <span>3</span>  <span>4</span>
</code></pre></div>


<pre><code>&lt;DF&gt;    = DataFrame(&lt;list_of_rows&gt;)           
&lt;DF&gt;    = DataFrame(&lt;dict_of_columns&gt;)        
</code></pre>
<pre><code>&lt;el&gt;    = &lt;DF&gt;.loc[row_key, column_key]       
&lt;Sr/DF&gt; = &lt;DF&gt;.loc[row_key/s]                 
&lt;Sr/DF&gt; = &lt;DF&gt;.loc[:, column_key/s]           
&lt;DF&gt;    = &lt;DF&gt;.loc[row_bools, column_bools]   
</code></pre>
<pre><code>&lt;Sr/DF&gt; = &lt;DF&gt;[column_key/s]                  
&lt;DF&gt;    = &lt;DF&gt;[row_bools]                     
&lt;DF&gt;    = &lt;DF&gt;[&lt;DF_of_bools&gt;]                 
</code></pre>
<pre><code>&lt;DF&gt;    = &lt;DF&gt; &gt;&lt;== &lt;el/Sr/DF&gt;                
&lt;DF&gt;    = &lt;DF&gt; +-*/ &lt;el/Sr/DF&gt;                
</code></pre>
<pre><code>&lt;DF&gt;    = &lt;DF&gt;.set_index(column_key)          
&lt;DF&gt;    = &lt;DF&gt;.reset_index()                  
&lt;DF&gt;    = &lt;DF&gt;.sort_index(ascending=<span>True</span>)     
&lt;DF&gt;    = &lt;DF&gt;.sort_values(column_key/s)      
</code></pre>
<div><h4 id="mergejoinconcat">Merge, Join, Concat:</h4><pre><code><span>&gt;&gt;&gt; </span>l = DataFrame([[<span>1</span>, <span>2</span>], [<span>3</span>, <span>4</span>]], index=[<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>], columns=[<span>&#39;x&#39;</span>, <span>&#39;y&#39;</span>])
   x  y 
a  <span>1</span>  <span>2</span> 
b  <span>3</span>  <span>4</span> 
<span>&gt;&gt;&gt; </span>r = DataFrame([[<span>4</span>, <span>5</span>], [<span>6</span>, <span>7</span>]], index=[<span>&#39;b&#39;</span>, <span>&#39;c&#39;</span>], columns=[<span>&#39;y&#39;</span>, <span>&#39;z&#39;</span>])
   y  z
b  <span>4</span>  <span>5</span>
c  <span>6</span>  <span>7</span>
</code></pre></div>

<pre><code>┏━━━━━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                        │    <span>&#39;outer&#39;</span>    │   <span>&#39;inner&#39;</span>  │   <span>&#39;left&#39;</span>   │       Description        ┃
┠────────────────────────┼───────────────┼────────────┼────────────┼──────────────────────────┨
┃ l.merge(r, on=<span>&#39;y&#39;</span>,     │    x   y   z  │ x   y   z  │ x   y   z  │ Joins/merges on column.  ┃
┃            how=…)      │ <span>0</span>  <span>1</span>   <span>2</span>   .  │ <span>3</span>   <span>4</span>   <span>5</span>  │ <span>1</span>   <span>2</span>   .  │ Also accepts left_on and ┃
┃                        │ <span>1</span>  <span>3</span>   <span>4</span>   <span>5</span>  │            │ <span>3</span>   <span>4</span>   <span>5</span>  │ right_on parameters.     ┃
┃                        │ <span>2</span>  .   <span>6</span>   <span>7</span>  │            │            │ Uses <span>&#39;inner&#39;</span> by default. ┃
┠────────────────────────┼───────────────┼────────────┼────────────┼──────────────────────────┨
┃ l.join(r, lsuffix=<span>&#39;l&#39;</span>, │    x yl yr  z │            │ x yl yr  z │ Joins/merges on row keys.┃
┃           rsuffix=<span>&#39;r&#39;</span>, │ a  <span>1</span>  <span>2</span>  .  . │ x yl yr  z │ <span>1</span>  <span>2</span>  .  . │ Uses <span>&#39;left&#39;</span> by default.  ┃
┃           how=…)       │ b  <span>3</span>  <span>4</span>  <span>4</span>  <span>5</span> │ <span>3</span>  <span>4</span>  <span>4</span>  <span>5</span> │ <span>3</span>  <span>4</span>  <span>4</span>  <span>5</span> │ If r is a series, it is  ┃
┃                        │ c  .  .  <span>6</span>  <span>7</span> │            │            │ treated as a column.     ┃
┠────────────────────────┼───────────────┼────────────┼────────────┼──────────────────────────┨
┃ pd.concat([l, r],      │    x   y   z  │     y      │            │ Adds rows at the bottom. ┃
┃           axis=<span>0</span>,      │ a  <span>1</span>   <span>2</span>   .  │     <span>2</span>      │            │ Uses <span>&#39;outer&#39;</span> by default. ┃
┃           join=…)      │ b  <span>3</span>   <span>4</span>   .  │     <span>4</span>      │            │ A series is treated as a ┃
┃                        │ b  .   <span>4</span>   <span>5</span>  │     <span>4</span>      │            │ column. Use l.append(sr) ┃
┃                        │ c  .   <span>6</span>   <span>7</span>  │     <span>6</span>      │            │ to add a row instead.    ┃
┠────────────────────────┼───────────────┼────────────┼────────────┼──────────────────────────┨
┃ pd.concat([l, r],      │    x  y  y  z │            │            │ Adds columns at the      ┃
┃           axis=<span>1</span>,      │ a  <span>1</span>  <span>2</span>  .  . │ x  y  y  z │            │ right end. Uses <span>&#39;outer&#39;</span>  ┃
┃           join=…)      │ b  <span>3</span>  <span>4</span>  <span>4</span>  <span>5</span> │ <span>3</span>  <span>4</span>  <span>4</span>  <span>5</span> │            │ by default. A series is  ┃
┃                        │ c  .  .  <span>6</span>  <span>7</span> │            │            │ treated as a column.     ┃
┠────────────────────────┼───────────────┼────────────┼────────────┼──────────────────────────┨
┃ l.combine_first(r)     │    x   y   z  │            │            │ Adds missing rows and    ┃
┃                        │ a  <span>1</span>   <span>2</span>   .  │            │            │ columns. Also updates    ┃
┃                        │ b  <span>3</span>   <span>4</span>   <span>5</span>  │            │            │ items that contain NaN.  ┃
┃                        │ c  .   <span>6</span>   <span>7</span>  │            │            │ R must be a DataFrame.   ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━━━━━━━┛
</code></pre>
<div><h4 id="aggregatetransformmap-1">Aggregate, Transform, Map:</h4><pre><code>&lt;Sr&gt; = &lt;DF&gt;.sum/max/mean/idxmax/all()         
&lt;DF&gt; = &lt;DF&gt;.rank/diff/cumsum/ffill/interpl()  
&lt;DF&gt; = &lt;DF&gt;.fillna(&lt;el&gt;)                      
</code></pre></div>

<ul>
<li><strong>All operations operate on columns by default. Use <code><span>&#39;axis=1&#39;</span></code> parameter to process the rows instead.</strong> </li>
</ul>
<pre><code><span>&gt;&gt;&gt; </span>df = DataFrame([[<span>1</span>, <span>2</span>], [<span>3</span>, <span>4</span>]], index=[<span>&#39;a&#39;</span>, <span>&#39;b&#39;</span>], columns=[<span>&#39;x&#39;</span>, <span>&#39;y&#39;</span>])
   x  y
a  <span>1</span>  <span>2</span>
b  <span>3</span>  <span>4</span>
</code></pre>
<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━┓
┃             │    <span>&#39;sum&#39;</span>    │   [<span>&#39;sum&#39;</span>]   │ {<span>&#39;x&#39;</span>: <span>&#39;sum&#39;</span>}  ┃
┠─────────────┼─────────────┼─────────────┼───────────────┨
┃ df.apply(…) │             │       x  y  │               ┃
┃ df.agg(…)   │     x  <span>4</span>    │  sum  <span>4</span>  <span>6</span>  │     x  <span>4</span>      ┃
┃             │     y  <span>6</span>    │             │               ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━┛
</code></pre>
<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━┓
┃             │    <span>&#39;rank&#39;</span>   │   [<span>&#39;rank&#39;</span>]  │ {<span>&#39;x&#39;</span>: <span>&#39;rank&#39;</span>} ┃
┠─────────────┼─────────────┼─────────────┼───────────────┨
┃ df.apply(…) │      x  y   │      x    y │        x      ┃
┃ df.agg(…)   │   a  <span>1</span>  <span>1</span>   │   rank rank │     a  <span>1</span>      ┃
┃ df.trans(…) │   b  <span>2</span>  <span>2</span>   │ a    <span>1</span>    <span>1</span> │     b  <span>2</span>      ┃
┃             │             │ b    <span>2</span>    <span>2</span> │               ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━┛
</code></pre>
<ul>
<li><strong>Use <code><span>&#39;&lt;DF&gt;[col_key_1, col_key_2][row_key]&#39;</span></code> to get the fifth result&#39;s values.</strong></li>
</ul>
<div><h4 id="encodedecode">Encode, Decode:</h4><pre><code>&lt;DF&gt; = pd.read_json/html(<span>&#39;&lt;str/path/url&gt;&#39;</span>)
&lt;DF&gt; = pd.read_csv/pickle/excel(<span>&#39;&lt;path/url&gt;&#39;</span>)
&lt;DF&gt; = pd.read_sql(<span>&#39;&lt;table_name/query&gt;&#39;</span>, &lt;connection&gt;)
&lt;DF&gt; = pd.read_clipboard()
</code></pre></div>

<pre><code>&lt;dict&gt; = &lt;DF&gt;.to_dict([<span>&#39;d/l/s/sp/r/i&#39;</span>])
&lt;str&gt;  = &lt;DF&gt;.to_json/html/csv/markdown/latex([&lt;path&gt;])
&lt;DF&gt;.to_pickle/excel(&lt;path&gt;)
&lt;DF&gt;.to_sql(<span>&#39;&lt;table_name&gt;&#39;</span>, &lt;connection&gt;)
</code></pre>
<div><h3 id="groupby">GroupBy</h3><p><strong>Object that groups together rows of a dataframe based on the value of the passed column.</strong></p><pre><code><span>&gt;&gt;&gt; </span>df = DataFrame([[<span>1</span>, <span>2</span>, <span>3</span>], [<span>4</span>, <span>5</span>, <span>6</span>], [<span>7</span>, <span>8</span>, <span>6</span>]], index=list(<span>&#39;abc&#39;</span>), columns=list(<span>&#39;xyz&#39;</span>))
<span>&gt;&gt;&gt; </span>df.groupby(<span>&#39;z&#39;</span>).get_group(<span>3</span>)
   x  y
a  <span>1</span>  <span>2</span>
<span>&gt;&gt;&gt; </span>df.groupby(<span>&#39;z&#39;</span>).get_group(<span>6</span>)
   x  y
b  <span>4</span>  <span>5</span>
c  <span>7</span>  <span>8</span>
</code></pre></div>


<pre><code>&lt;GB&gt; = &lt;DF&gt;.groupby(column_key/s)             
&lt;DF&gt; = &lt;GB&gt;.get_group(group_key/s)            
</code></pre>
<div><h4 id="aggregatetransformmap-2">Aggregate, Transform, Map:</h4><pre><code>&lt;DF&gt; = &lt;GB&gt;.sum/max/mean/idxmax/all()         
&lt;DF&gt; = &lt;GB&gt;.rank/diff/cumsum/ffill()          
&lt;DF&gt; = &lt;GB&gt;.fillna(&lt;el&gt;)                      
</code></pre></div>

<pre><code><span>&gt;&gt;&gt; </span>gb = df.groupby(<span>&#39;z&#39;</span>)
      x  y  z
<span>3</span>: a  <span>1</span>  <span>2</span>  <span>3</span>
<span>6</span>: b  <span>4</span>  <span>5</span>  <span>6</span>
   c  <span>7</span>  <span>8</span>  <span>6</span>
</code></pre>
<pre><code>┏━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━┓
┃             │    <span>&#39;sum&#39;</span>    │    <span>&#39;rank&#39;</span>   │   [<span>&#39;rank&#39;</span>]  │ {<span>&#39;x&#39;</span>: <span>&#39;rank&#39;</span>} ┃
┠─────────────┼─────────────┼─────────────┼─────────────┼───────────────┨
┃ gb.agg(…)   │      x   y  │      x  y   │      x    y │        x      ┃
┃             │  z          │   a  <span>1</span>  <span>1</span>   │   rank rank │     a  <span>1</span>      ┃
┃             │  <span>3</span>   <span>1</span>   <span>2</span>  │   b  <span>1</span>  <span>1</span>   │ a    <span>1</span>    <span>1</span> │     b  <span>1</span>      ┃
┃             │  <span>6</span>  <span>11</span>  <span>13</span>  │   c  <span>2</span>  <span>2</span>   │ b    <span>1</span>    <span>1</span> │     c  <span>2</span>      ┃
┃             │             │             │ c    <span>2</span>    <span>2</span> │               ┃
┠─────────────┼─────────────┼─────────────┼─────────────┼───────────────┨
┃ gb.trans(…) │      x   y  │      x  y   │             │               ┃
┃             │  a   <span>1</span>   <span>2</span>  │   a  <span>1</span>  <span>1</span>   │             │               ┃
┃             │  b  <span>11</span>  <span>13</span>  │   b  <span>1</span>  <span>1</span>   │             │               ┃
┃             │  c  <span>11</span>  <span>13</span>  │   c  <span>1</span>  <span>1</span>   │             │               ┃
┗━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━┛
</code></pre>
<div><h3 id="rolling">Rolling</h3><p><strong>Object for rolling window calculations.</strong></p><pre><code>&lt;R_Sr/R_DF/R_GB&gt; = &lt;Sr/DF/GB&gt;.rolling(window_size)  
&lt;R_Sr/R_DF&gt;      = &lt;R_DF/R_GB&gt;[column_key/s]        
&lt;Sr/DF/DF&gt;       = &lt;R_Sr/R_DF/R_GB&gt;.sum/max/mean()  
</code></pre></div>


<div><h2 id="plotly"><a href="#plotly" name="plotly">#</a>Plotly</h2><pre><code>
<span>from</span> plotly.express <span>import</span> line
&lt;Figure&gt; = line(&lt;DF&gt;, x=&lt;col_name&gt;, y=&lt;col_name&gt;)        
&lt;Figure&gt;.update_layout(margin=dict(t=<span>0</span>, r=<span>0</span>, b=<span>0</span>, l=<span>0</span>))  
&lt;Figure&gt;.write_html/json/image(<span>&#39;&lt;path&gt;&#39;</span>)                 
</code></pre></div>

<div><h4 id="coviddeathsbycontinent">Covid deaths by continent:</h4><pre><code>covid = pd.read_csv(<span>&#39;https://covid.ourworldindata.org/data/owid-covid-data.csv&#39;</span>, 
                    usecols=[<span>&#39;iso_code&#39;</span>, <span>&#39;date&#39;</span>, <span>&#39;total_deaths&#39;</span>, <span>&#39;population&#39;</span>])
continents = pd.read_csv(<span>&#39;https://gist.githubusercontent.com/stevewithington/20a69c0b6d2ff&#39;</span>
                         <span>&#39;846ea5d35e5fc47f26c/raw/country-and-continent-codes-list-csv.csv&#39;</span>,
                         usecols=[<span>&#39;Three_Letter_Country_Code&#39;</span>, <span>&#39;Continent_Name&#39;</span>])
df = pd.merge(covid, continents, left_on=<span>&#39;iso_code&#39;</span>, right_on=<span>&#39;Three_Letter_Country_Code&#39;</span>)
df = df.groupby([<span>&#39;Continent_Name&#39;</span>, <span>&#39;date&#39;</span>]).sum().reset_index()
df[<span>&#39;Total Deaths per Million&#39;</span>] = df.total_deaths * <span>1e6</span> / df.population
df = df[df.date &gt; <span>&#39;2020-03-14&#39;</span>]
df = df.rename({<span>&#39;date&#39;</span>: <span>&#39;Date&#39;</span>, <span>&#39;Continent_Name&#39;</span>: <span>&#39;Continent&#39;</span>}, axis=<span>&#39;columns&#39;</span>)
line(df, x=<span>&#39;Date&#39;</span>, y=<span>&#39;Total Deaths per Million&#39;</span>, color=<span>&#39;Continent&#39;</span>).show()
</code></pre></div>



<div><h4 id="confirmedcovidcasesdowjonesgoldandbitcoinprice">Confirmed covid cases, Dow Jones, Gold, and Bitcoin price:</h4><pre><code><span>import</span> pandas <span>as</span> pd
<span>import</span> plotly.graph_objects <span>as</span> go

<span><span>def</span> <span>main</span><span>()</span>:</span>
    display_data(wrangle_data(*scrape_data()))

<span><span>def</span> <span>scrape_data</span><span>()</span>:</span>
    <span><span>def</span> <span>scrape_covid</span><span>()</span>:</span>
        url = <span>&#39;https://covid.ourworldindata.org/data/owid-covid-data.csv&#39;</span>
        df = pd.read_csv(url, usecols=[<span>&#39;location&#39;</span>, <span>&#39;date&#39;</span>, <span>&#39;total_cases&#39;</span>])
        <span>return</span> df[df.location == <span>&#39;World&#39;</span>].set_index(<span>&#39;date&#39;</span>).total_cases
    <span><span>def</span> <span>scrape_yahoo</span><span>(slug)</span>:</span>
        url = <span>f&#39;https://query1.finance.yahoo.com/v7/finance/download/<span>{slug}</span>&#39;</span> + \
              <span>&#39;?period1=1579651200&amp;period2=9999999999&amp;interval=1d&amp;events=history&#39;</span>
        df = pd.read_csv(url, usecols=[<span>&#39;Date&#39;</span>, <span>&#39;Close&#39;</span>])
        <span>return</span> df.set_index(<span>&#39;Date&#39;</span>).Close
    out = scrape_covid(), scrape_yahoo(<span>&#39;BTC-USD&#39;</span>), scrape_yahoo(<span>&#39;GC=F&#39;</span>), scrape_yahoo(<span>&#39;^DJI&#39;</span>)
    <span>return</span> map(pd.Series.rename, out, [<span>&#39;Total Cases&#39;</span>, <span>&#39;Bitcoin&#39;</span>, <span>&#39;Gold&#39;</span>, <span>&#39;Dow Jones&#39;</span>])

<span><span>def</span> <span>wrangle_data</span><span>(covid, bitcoin, gold, dow)</span>:</span>
    df = pd.concat([bitcoin, gold, dow], axis=<span>1</span>)  
    df = df.sort_index().interpolate()            
    df = df.loc[<span>&#39;2020-02-23&#39;</span>:]                    
    df = (df / df.iloc[<span>0</span>]) * <span>100</span>                  
    df = df.join(covid)                           
    <span>return</span> df.sort_values(df.index[<span>-1</span>], axis=<span>1</span>)   

<span><span>def</span> <span>display_data</span><span>(df)</span>:</span>
    figure = go.Figure()
    <span>for</span> col_name <span>in</span> reversed(df.columns):
        yaxis = <span>&#39;y1&#39;</span> <span>if</span> col_name == <span>&#39;Total Cases&#39;</span> <span>else</span> <span>&#39;y2&#39;</span>
        trace = go.Scatter(x=df.index, y=df[col_name], name=col_name, yaxis=yaxis)
        figure.add_trace(trace)
    figure.update_layout(
        yaxis1=dict(title=<span>&#39;Total Cases&#39;</span>, rangemode=<span>&#39;tozero&#39;</span>),
        yaxis2=dict(title=<span>&#39;%&#39;</span>, rangemode=<span>&#39;tozero&#39;</span>, overlaying=<span>&#39;y&#39;</span>, side=<span>&#39;right&#39;</span>),
        legend=dict(x=<span>1.1</span>),
        height=<span>450</span>
    ).show()

<span>if</span> __name__ == <span>&#39;__main__&#39;</span>:
    main()
</code></pre></div>



<div><h2 id="pysimplegui"><a href="#pysimplegui" name="pysimplegui">#</a>PySimpleGUI</h2><pre><code>
<span>import</span> PySimpleGUI <span>as</span> sg
layout = [[sg.Text(<span>&#34;What&#39;s your name?&#34;</span>)], [sg.Input()], [sg.Button(<span>&#39;Ok&#39;</span>)]]
window = sg.Window(<span>&#39;Window Title&#39;</span>, layout)
event, values = window.read()
print(<span>f&#39;Hello <span>{values[<span>0</span>]}</span>!&#39;</span> <span>if</span> event == <span>&#39;Ok&#39;</span> <span>else</span> <span>&#39;&#39;</span>)
</code></pre></div>

<div><h2 id="appendix"><a href="#appendix" name="appendix">#</a>Appendix</h2><div><h3 id="cython">Cython</h3><p><strong>Library that compiles Python code into C.</strong></p><pre><code>
<span>import</span> pyximport; pyximport.install()
<span>import</span> &lt;cython_script&gt;
&lt;cython_script&gt;.main()
</code></pre></div></div>



<div><h4 id="definitions">Definitions:</h4><ul>
<li><strong>All <code><span>&#39;cdef&#39;</span></code> definitions are optional, but they contribute to the speed-up.</strong></li>
<li><strong>Script needs to be saved with a <code><span>&#39;pyx&#39;</span></code> extension.</strong></li>
</ul><pre><code>cdef &lt;ctype&gt; &lt;var_name&gt; = &lt;el&gt;
cdef &lt;ctype&gt;[n_elements] &lt;var_name&gt; = [&lt;el_1&gt;, &lt;el_2&gt;, ...]
cdef &lt;ctype/void&gt; &lt;func_name&gt;(&lt;ctype&gt; &lt;arg_name_1&gt;, ...):
</code></pre></div>


<pre><code>cdef <span><span>class</span> &lt;<span>class_name</span>&gt;:</span>
    cdef public &lt;ctype&gt; &lt;attr_name&gt;
    <span><span>def</span> <span>__init__</span><span>(self, &lt;ctype&gt; &lt;arg_name&gt;)</span>:</span>
        self.&lt;attr_name&gt; = &lt;arg_name&gt;
</code></pre>
<pre><code>cdef enum &lt;enum_name&gt;: &lt;member_name_1&gt;, &lt;member_name_2&gt;, ...
</code></pre>
<div><h3 id="pyinstaller">PyInstaller</h3><pre><code>$ pip3 install pyinstaller
$ pyinstaller script.py                        
$ pyinstaller script.py --onefile              
$ pyinstaller script.py --windowed             
$ pyinstaller script.py --add-data &#39;&lt;path&gt;:.&#39;  
</code></pre></div>

<ul>
<li><strong>File paths need to be updated to <code><span>&#39;os.path.join(sys._MEIPASS, &lt;path&gt;)&#39;</span></code>.</strong></li>
</ul>
<div><h3 id="basicscripttemplate">Basic Script Template</h3><pre><code>




<span>from</span> sys <span>import</span> argv, exit
<span>from</span> collections <span>import</span> defaultdict, namedtuple
<span>from</span> dataclasses <span>import</span> make_dataclass
<span>from</span> enum <span>import</span> Enum
<span>import</span> functools <span>as</span> ft, itertools <span>as</span> it, operator <span>as</span> op, re


<span><span>def</span> <span>main</span><span>()</span>:</span>
    <span>pass</span>






<span><span>def</span> <span>read_file</span><span>(filename)</span>:</span>
    <span>with</span> open(filename, encoding=<span>&#39;utf-8&#39;</span>) <span>as</span> file:
        <span>return</span> file.readlines()


<span>if</span> __name__ == <span>&#39;__main__&#39;</span>:
    main()
</code></pre></div>

<div><h2 id="index"><a href="#index" name="index">#</a>Index</h2><ul><li><strong>Only available in the <a href="https://transactions.sendowl.com/products/78175486/4422834F/view">PDF</a>.</strong></li>
<li><strong>Ctrl+F / ⌘F is usually sufficient.</strong></li>
<li><strong>Searching <code><span>&#39;#&lt;title&gt;&#39;</span></code> will limit the search to the titles.</strong></li>
</ul></div>
 

  

  

  
  
  
  
  
  



</div>
  </body>
</html>
