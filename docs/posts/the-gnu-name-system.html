<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lsd.gnunet.org/lsd0001/">Original</a>
    <h1>The GNU Name System</h1>
    
    <div id="readability-page-1" class="page">

<table>
<thead><tr>
<td>Internet-Draft</td>
<td>The GNU Name System</td>
<td>January 2022</td>
</tr></thead>
<tfoot><tr>
<td>Schanzenbach, et al.</td>
<td>Expires 4 August 2022</td>
<td>[Page]</td>
</tr></tfoot>
</table>

<div id="internal-metadata">
<dl id="identifiers">
<dt>Workgroup:</dt>
<dd>Independent Stream</dd>
<dt>Internet-Draft:</dt>
<dd>draft-schanzen-gns-06</dd>
<dt>Published:</dt>
<dd>
<time datetime="2022-01-31">31 January 2022</time>
    </dd>
<dt>Intended Status:</dt>
<dd>Informational</dd>
<dt>Expires:</dt>
<dd><time datetime="2022-08-04">4 August 2022</time></dd>

<dd>
<div>
      <p>M. Schanzenbach</p>
<p>GNUnet e.V.</p>
</div>
<div>
      <p>C. Grothoff</p>
<p>Berner Fachhochschule</p>
</div>
<div>
      <p>B. Fix</p>
<p>GNUnet e.V.</p>
</div>
</dd>
</dl>
</div>

<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
      This document contains the GNU Name System (GNS) technical
      specification.
      GNS is a decentralized and censorship-resistant name
      system that provides a privacy-enhancing alternative to the Domain
      Name System (DNS).<a href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
      This document defines the normative wire format of resource records,
      resolution processes, cryptographic routines and security
      considerations for use by implementers.
      It is published here to inform readers about the function
      of GNS, guide future GNS implementations, and ensure
      interoperability among implementations including with the
      pre-existing GNUnet implementation.<a href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">
      This specification was developed outside the IETF and does not have
      IETF consensus.  It is published here to guide implementation of GNS
      and to ensure interoperability among implementations.<a href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as &#34;work in progress.&#34;<a href="#section-boilerplate.1-3">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 August 2022.<a href="#section-boilerplate.1-4">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust&#39;s Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav><ul>
<li id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1">1</a>.  <a href="#name-introduction">Introduction</a></p>
<ul>
<li id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1">1.1</a>.  <a href="#name-requirements-notation">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2">2</a>.  <a href="#name-terminology">Terminology</a></p>
</li>
          <li id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3">3</a>.  <a href="#name-overview">Overview</a></p>
</li>
          <li id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4">4</a>.  <a href="#name-zones">Zones</a></p>
<ul>
<li id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1">4.1</a>.  <a href="#name-zone-top-level-domain">Zone Top-Level Domain</a></p>
</li>
              <li id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2">4.2</a>.  <a href="#name-zone-revocation">Zone Revocation</a></p>
</li>
            </ul>
</li>
          <li id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5">5</a>.  <a href="#name-resource-records">Resource Records</a></p>
<ul>
<li id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1">5.1</a>.  <a href="#name-zone-delegation-records">Zone Delegation Records</a></p>
<ul>
<li id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1">5.1.1</a>.  <a href="#name-pkey">PKEY</a></p>
</li>
                  <li id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2">5.1.2</a>.  <a href="#name-edkey">EDKEY</a></p>
</li>
                  <li id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3">5.1.3</a>.  <a href="#name-gns2dns">GNS2DNS</a></p>
</li>
                </ul>
</li>
              <li id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2">5.2</a>.  <a href="#name-auxiliary-records">Auxiliary Records</a></p>
<ul>
<li id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1">5.2.1</a>.  <a href="#name-leho">LEHO</a></p>
</li>
                  <li id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2">5.2.2</a>.  <a href="#name-nick">NICK</a></p>
</li>
                  <li id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3">5.2.3</a>.  <a href="#name-box">BOX</a></p>
</li>
                  <li id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4">5.2.4</a>.  <a href="#name-gts">GTS</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6">6</a>.  <a href="#name-record-storage">Record Storage</a></p>
<ul>
<li id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1">6.1</a>.  <a href="#name-the-storage-key">The Storage Key</a></p>
</li>
              <li id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2">6.2</a>.  <a href="#name-the-records-block-rrblock">The Records Block (RRBLOCK)</a></p>
</li>
            </ul>
</li>
          <li id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7">7</a>.  <a href="#name-name-resolution">Name Resolution</a></p>
<ul>
<li id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1">7.1</a>.  <a href="#name-root-zone">Root Zone</a></p>
</li>
              <li id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2">7.2</a>.  <a href="#name-recursion">Recursion</a></p>
</li>
              <li id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3">7.3</a>.  <a href="#name-record-processing">Record Processing</a></p>
<ul>
<li id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1">7.3.1</a>.  <a href="#name-zone-delegation-records-2">Zone Delegation Records</a></p>
</li>
                  <li id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2">7.3.2</a>.  <a href="#name-gns2dns-2">GNS2DNS</a></p>
</li>
                  <li id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3">7.3.3</a>.  <a href="#name-cname">CNAME</a></p>
</li>
                  <li id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4">7.3.4</a>.  <a href="#name-box-2">BOX</a></p>
</li>
                  <li id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a href="#section-7.3.5">7.3.5</a>.  <a href="#name-gts-2">GTS</a></p>
</li>
                  <li id="section-toc.1-1.7.2.3.2.6">
                    <p id="section-toc.1-1.7.2.3.2.6.1"><a href="#section-7.3.6">7.3.6</a>.  <a href="#name-nick-2">NICK</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8">8</a>.  <a href="#name-internationalization-and-ch">Internationalization and Character Encoding</a></p>
</li>
          <li id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9">9</a>.  <a href="#name-security-and-privacy-consid">Security and Privacy Considerations</a></p>
<ul>
<li id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1">9.1</a>.  <a href="#name-cryptography">Cryptography</a></p>
</li>
              <li id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2">9.2</a>.  <a href="#name-abuse-mitigation">Abuse Mitigation</a></p>
</li>
              <li id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3">9.3</a>.  <a href="#name-zone-management">Zone Management</a></p>
</li>
              <li id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4">9.4</a>.  <a href="#name-impact-of-dhts-as-underlyin">Impact of DHTs as Underlying Storage</a></p>
</li>
              <li id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5">9.5</a>.  <a href="#name-revocations">Revocations</a></p>
</li>
              <li id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6">9.6</a>.  <a href="#name-label-guessing">Label Guessing</a></p>
</li>
            </ul>
</li>
          <li id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10">10</a>. <a href="#name-gana-considerations">GANA Considerations</a></p>
</li>
          <li id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11">11</a>. <a href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12">12</a>. <a href="#name-implementation-and-deployme">Implementation and Deployment Status</a></p>
</li>
          <li id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13">13</a>. <a href="#name-test-vectors">Test Vectors</a></p>
</li>
          <li id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14">14</a>. <a href="#name-normative-references">Normative References</a></p>
</li>
          <li id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15">15</a>. <a href="#name-informative-references">Informative References</a></p>
</li>
          <li id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A"></a><a href="#name-authors-addresses">Authors&#39; Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1">1. </a><a href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
       The Domain Name System (DNS) <span>[<a href="#RFC1035">RFC1035</a>]</span> is a unique
       distributed database and a vital service for most Internet applications.
       While DNS is distributed, in practice it
       relies on centralized, trusted registrars to provide globally unique
       names. As the awareness of the central role DNS plays on the Internet
       rises, various institutions are using their power (including legal means)
       to engage in attacks on the DNS, thus threatening the global availability
       and integrity of information on the Internet.<a href="#section-1-1">¶</a></p>
<p id="section-1-2">
       DNS was not designed with security as a goal. This makes it very
       vulnerable, especially to attackers that have the technical capabilities
       of an entire nation state at their disposal.
       While a wider discussion of this issue is out of scope for this document,
       analyses and investigations can be found in recent academic research
       works including <span>[<a href="#SecureNS">SecureNS</a>]</span>.<a href="#section-1-2">¶</a></p>
<p id="section-1-3">
       This specification describes a censorship-resistant, privacy-preserving
       and decentralized name system: The GNU Name System (GNS) <span>[<a href="#GNS">GNS</a>]</span>.
       It is designed to provide a secure, privacy-enhancing alternative to
       DNS, especially when censorship or manipulation is encountered.
       In particular, it directly addresses concerns in DNS with respect to &#34;Query
       Privacy&#34;, the &#34;Single Hierarchy with a Centrally Controlled Root&#34; and
       &#34;Distribution and Management of Root Servers&#34; as raised in
       <span>[<a href="#RFC8324">RFC8324</a>]</span>.
       GNS can bind names to any kind of
       cryptographically secured token, enabling it to double in some respects as
       even as an alternative to some of today&#39;s Public Key Infrastructures, in
       particular X.509 for the Web.<a href="#section-1-3">¶</a></p>
<p id="section-1-4">
       The design of GNS incorporates the capability to integrate and
       coexist with DNS.
       GNS is based on the principle of a petname
       system and builds on ideas from the Simple Distributed Security
       Infrastructure <span>[<a href="#SDSI">SDSI</a>]</span>, addressing a central issue with the decentralized
       mapping of secure identifiers to memorable names: namely the impossibility
       of providing a global, secure and memorable mapping without a trusted
       authority. GNS uses the transitivity in the SDSI design to replace the
       trusted root with secure delegation of authority thus making petnames
       useful to other users while operating under a very strong adversary model.<a href="#section-1-4">¶</a></p>
<p id="section-1-5">
       This is an important distinguishing factor from the Domain Name System
       where root zone governance is centralized at the Internet Corporation
       for Assigned Names and Numbers (ICANN).
       In DNS terminology, GNS roughly follows the idea of a hyperlocal root
       zone deployment, with the difference that it is not
       expected that all deployments use the same local root zone.<a href="#section-1-5">¶</a></p>
<p id="section-1-6">
       This document defines the normative wire format of resource records, resolution processes,
       cryptographic routines and security considerations for use by implementers.<a href="#section-1-6">¶</a></p>
<p id="section-1-7">
       This specification was developed outside the IETF and does not have
       IETF consensus.  It is published here to guide implementation of GNS
       and to ensure interoperability among implementations.<a href="#section-1-7">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1">1.1. </a><a href="#name-requirements-notation">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">
         The key words &#34;MUST&#34;, &#34;MUST NOT&#34;, &#34;REQUIRED&#34;, &#34;SHALL&#34;, &#34;SHALL NOT&#34;,
         &#34;SHOULD&#34;, &#34;SHOULD NOT&#34;, &#34;RECOMMENDED&#34;, &#34;NOT RECOMMENDED&#34;, &#34;MAY&#34;, and
         &#34;OPTIONAL&#34; in this document are to be interpreted as described in
         BCP 14 <span>[<a href="#RFC2119">RFC2119</a>]</span> <span>[<a href="#RFC8174">RFC8174</a>]</span> when, and only
         when, they appear in all capitals, as shown here.<a href="#section-1.1-1">¶</a></p>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2">2. </a><a href="#name-terminology">Terminology</a>
      </h2>
<span></span><dl id="section-2-1">
        <dt id="section-2-1.1">Label</dt>
        <dd id="section-2-1.2">
         A GNS label is a label as defined in <span>[<a href="#RFC8499">RFC8499</a>]</span>.
         Within this document, labels are always assumed to be strings of
         UTF-8 characters <span>[<a href="#RFC8499">RFC8499</a>]</span> with a maximum length of
         63 bytes.  When hashed, labels MUST be canonicalized using
         Normalization Form C (NFC) <span>[<a href="#Unicode-UAX15">Unicode-UAX15</a>]</span>.<a href="#section-2-1.2">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.3">Name</dt>
        <dd id="section-2-1.4">
         A name in GNS is a domain name as defined in  <span>[<a href="#RFC8499">RFC8499</a>]</span>
         as an ordered list of labels.
         The labels in a name are separated using the character &#34;.&#34; (dot).
         Names, like labels, are encoded in UTF-8.<a href="#section-2-1.4">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.5">Top-Level Domain</dt>
        <dd id="section-2-1.6">
  The rightmost label in a GNS name is a GNS Top-Level Domain (TLD).
  Unlike DNS Top-Level Domains (defined in <span>[<a href="#RFC8499">RFC8499</a>]</span>),
  GNS does not expect all users to use the same global root zone. Instead, 
         with the exception of Zone Top-Level Domains (see below),
         GNS TLDs are typically part of the configuration of the local resolver
         (see <a href="#governance">Section 7.1</a>), and may thus not be globally unique.<a href="#section-2-1.6">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.7">Zone</dt>
        <dd id="section-2-1.8">
         A GNS zone contains authoritative information (resource records).
         A zone is uniquely identified by its zone key.  Unlike DNS zones,
  a GNS zone does not need to have a SOA record at its apex.<a href="#section-2-1.8">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.9">Zone Type</dt>
        <dd id="section-2-1.10">
         The type of a GNS zone determines the cipher system and binary encoding
  format of the zone key, blinded zone keys, and signatures.<a href="#section-2-1.10">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.11">Zone Key</dt>
        <dd id="section-2-1.12">
         The zone key uniquely identifies a zone.
         The zone key is usually a public key of an asymmetric key pair.<a href="#section-2-1.12">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.13">Blinded Zone Key</dt>
        <dd id="section-2-1.14">
         A blinded zone key is derived from the zone key and a label.
         The zone key and the blinded zone key are unlinkable without knowing the label.<a href="#section-2-1.14">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.15">Zone Owner</dt>
        <dd id="section-2-1.16">
         The owner of a GNS zone is the holder of the secret (typically a private key)
  that (together with a label and a value to sign) allows the creation of zone
  signatures that can be validated against the respective blinded zone key.<a href="#section-2-1.16">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.17">Zone Top-Level Domain</dt>
        <dd id="section-2-1.18">
         A GNS Zone Top-Level Domain (zTLD) is a GNS label used as the
  rightmost label in a GNS name which encodes a zone type and
         zone key of a zone.
         Due to the statistical uniqueness of zone keys, zTLDs are also globally unique.
  A zTLD label can only be distinguished from ordinary TLD labels
  by attempting to decode the label to a zone type and zone key.<a href="#section-2-1.18">¶</a>
</dd>
        <dd></dd>
<dt id="section-2-1.19">Resource Record</dt>
        <dd id="section-2-1.20">
         A GNS resource record is the information associated with a label in a
         GNS zone.
         A GNS resource record contains information as defined by its
         resource record type.<a href="#section-2-1.20">¶</a>
</dd>
      <dd></dd>
</dl>
</section>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3">3. </a><a href="#name-overview">Overview</a>
      </h2>
<p id="section-3-1">
       In GNS, any user may create and manage one or more cryptographically
       secured zones (<a href="#zones">Section 4</a>).
       Zones are uniquely identified by a zone key.
       Zone contents are signed using blinded private keys and
       encrypted using derived secret keys.
       The zone type determines the respective set of cryptographic operations
       and the wire formats for encrypted data, public keys and signatures.<a href="#section-3-1">¶</a></p>
<p id="section-3-2">
       A zone can be populated with mappings from labels to resource records by
       its owner (<a href="#rrecords">Section 5</a>).
       A label can be mapped to a delegation record which results in the
       corresponding subdomain being delegated to another zone. Circular
       delegations are explicitly allowed, including delegating a subdomain
       to its immediate parent zone.  In
       order to support (legacy) applications as well as to facilitate the use
       of petnames, GNS defines auxiliary record types in addition to
       supporting traditional DNS records.<a href="#section-3-2">¶</a></p>
<p id="section-3-3">
       Zone contents are encrypted and signed
       before being published in a distributed key-value storage
       (<a href="#publish">Section 6</a>).
       In this process, unique zone identification is hidden from the network
       through the use of key blinding.
       Key blinding allows the creation of signatures for zone contents
       using a blinded public/private key pair.
       This blinding is realized using a deterministic key
       derivation from
       the original zone key and corresponding private key using record label values
       as blinding factors.
       Specifically, the zone owner can derive blinded private keys for each record
       set published under a label, and a
       resolver can derive the corresponding blinded public keys.
       It is expected that GNS implementations use distributed or decentralized
       storages such as distributed hash tables (DHT) in order to facilitate
       availability within a network without the need for dedicated infrastructure.
       Specification of such a distributed or decentralized storage is out of
       scope of this document, but possible existing implementations include those
       based on <span>[<a href="#RFC7363">RFC7363</a>]</span>, <span>[<a href="#Kademlia">Kademlia</a>]</span> or
       <span>[<a href="#R5N">R5N</a>]</span>.<a href="#section-3-3">¶</a></p>
<p id="section-3-4">
       Names in GNS are domain names as defined in <span>[<a href="#RFC8499">RFC8499</a>]</span>.
       Starting from a configurable root zone, names are resolved by following zone
       delegations. For each label in a name, the recursive GNS resolver
       fetches the respective record from the storage layer (<a href="#resolution">Section 7</a>).
       Without knowledge of the label values and the zone keys, the
       different derived keys are unlinkable both to the original zone key and to each
       other.
       This prevents zone enumeration (except via impractical online brute
       force attacks) and requires knowledge
       of both the zone key and the label to confirm affiliation of a
       query or the corresponding encrypted record set with a
       specific zone. At the same time, the blinded zone key provides
       resolvers
       with the ability to verify the integrity of the published information
       without disclosing the originating zone.<a href="#section-3-4">¶</a></p>
<p id="section-3-5">
       In the remainder of this document, the &#34;implementer&#34; refers to the developer building
       a GNS implementation including, for example, zone management tools and
       name resolution components.
       An &#34;application&#34; refers to a component which uses a GNS implementation
       to resolve records from the network and (usually) processes its contents.<a href="#section-3-5">¶</a></p>
</section>
</div>
<div id="zones">
<section id="section-4">
      <h2 id="name-zones">
<a href="#section-4">4. </a><a href="#name-zones">Zones</a>
      </h2>
<p id="section-4-1">
       A zone in GNS is uniquely identified by its zone type and zone key.
       It can be represented by a Zone Top-Level Domain (zTLD) string.<a href="#section-4-1">¶</a></p>
<p id="section-4-2">
       Each zone type (ztype) is assigned a unique 32-bit number when it is registered
       in the GNUnet Assigned Numbers Authority <span>[<a href="#GANA">GANA</a>]</span>.
       The ztype determines which cryptosystem is used for the
       asymmetric and symmetric key operations of the zone.
       The ztype number always corresponds to a resource record type
       number identifying a delegation into a zone of this type. To
       ensure that there are no conflicts with DNS record types, ztypes
       are always assigned numeric values above 65535.<a href="#section-4-2">¶</a></p>
<p id="section-4-3">
       For any zone, let d be the private key and zk the public zone key.
       The specific wire format used depends on the ztype.
       The creation of zone keys for the default ztypes are specified in
       <a href="#gnsrecords_delegation">Section 5.1</a>.
       New ztypes may be specified in the future, for example if the
       cryptographic mechanisms used in this document are broken.
       Any ztype MUST define the following set of cryptographic functions:<a href="#section-4-3">¶</a></p>
<span></span><dl id="section-4-4">
        <dt id="section-4-4.1">KeyGen() -&gt; d, zk</dt>
        <dd id="section-4-4.2">
         is a function to generate a fresh private key d and
  the corresponding public zone key zk.<a href="#section-4-4.2">¶</a>
</dd>
        <dd></dd>
<dt id="section-4-4.3">ZKDF-Private(d,label) -&gt; d&#39;</dt>
        <dd id="section-4-4.4">
         is a zone key derivation function which blinds a private key d
         using label, resulting in another private key which
         can be used to create cryptographic signatures.  We note that
         GNS only requires a signature to be created directly with
         d to sign a revocation message for the zone key zk.<a href="#section-4-4.4">¶</a>
</dd>
        <dd></dd>
<dt id="section-4-4.5">ZKDF-Public(zk,label) -&gt; zk&#39;</dt>
        <dd id="section-4-4.6">
         is a zone key derivation function which blinds a zone key zk
         using a label. zk and zk&#39; must be unlinkable. Furthermore,
         blinding zk with different values for the label must result
         in unlinkable zk&#39; values.<a href="#section-4-4.6">¶</a>
</dd>
        <dd></dd>
<dt id="section-4-4.7">S-Encrypt(zk,label,nonce,expiration,message) -&gt; ciphertext</dt>
        <dd id="section-4-4.8">
         is a symmetric encryption function which encrypts the record
         data based on key material derived from the zone key,
         a label, a nonce and an expiration.
         In order to leverage performance-enhancing caching features of certain
         underlying storages, in particular DHTs, a deterministic encryption
         scheme is recommended.<a href="#section-4-4.8">¶</a>
</dd>
        <dd></dd>
<dt id="section-4-4.9">S-Decrypt(zk,label,nonce,expiration,ciphertext) -&gt; message</dt>
        <dd id="section-4-4.10">
         is a symmetric decryption function which decrypts the encrypted record
         data based on key material derived from the zone key,
         a label, a nonce and an expiration.<a href="#section-4-4.10">¶</a>
</dd>
        <dd></dd>
<dt id="section-4-4.11">Sign(d,message) -&gt; signature, Sign(d&#39;,message) -&gt; signature</dt>
        <dd id="section-4-4.12">
         is a function to sign a message (typically encrypted record data) using the (blinded) private
         key d (d&#39;), yielding an unforgable cryptographic signature.<a href="#section-4-4.12">¶</a>
</dd>
        <dd></dd>
<dt id="section-4-4.13">Verify(zk,message,signature) -&gt; boolean, Verify(zk&#39;,message,signature) -&gt; boolean</dt>
        <dd id="section-4-4.14">
         is a function to verify the signature was created by
         the private key d (or derived key d&#39;) corresponding to 
         the zone key zk (or derived zone key zk&#39;)
         where d,zk := Keygen(). If deriviations were used, they
         must have used the same label.
         The function returns a boolean value of &#34;TRUE&#34; if the signature is valid,
         and otherwise &#34;FALSE&#34;.<a href="#section-4-4.14">¶</a>
</dd>
      <dd></dd>
</dl>
<div id="zTLD">
<section id="section-4.1">
        <h3 id="name-zone-top-level-domain">
<a href="#section-4.1">4.1. </a><a href="#name-zone-top-level-domain">Zone Top-Level Domain</a>
        </h3>
<div id="figure_zid">
<figure id="figure-1">
          <div id="section-4.1-1.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |      ZONE KEY         /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-1">Figure 1</a></figcaption></figure>
</div>
<p id="section-4.1-2">The decoded binary representation of the zTLD<a href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">
         The zTLD is the Zone Top-Level Domain.
         It is a string which encodes the zone type and zone key into a domain name.
         The zTLD is used as a globally unique reference to a specific
         namespace in the process of name resolution.
         To encode the zone key, a zone key label zkl is derived from a
         concatenation of the zone type and zone key (see <a href="#figure_zid">Figure 1</a>)
         using the Crockford Base32 encoding <span>[<a href="#CrockfordB32">CrockfordB32</a>]</span>.
         In order to further increase tolerance for failures in character
         recognition, the letter &#34;U&#34; MUST be decoded to the same Base32 value as the
         letter &#34;V&#34;.
         The encoding and decoding symbols for Crockford Base32 including this modification are defined in
         <a href="#CrockfordB32Encode">Figure 2</a>.
         The functions for encoding and decoding based on this table are called
         GNSCrockfordEncode and GNSCrockfordDecode, respectively.<a href="#section-4.1-3">¶</a></p>
<div id="CrockfordB32Encode">
<figure id="figure-2">
          <div id="section-4.1-4.1">
<pre>Symbol      Decode            Encode
Value       Symbol            Symbol
0           0 O o             0
1           1 I i L l         1
2           2                 2
3           3                 3
4           4                 4
5           5                 5
6           6                 6
7           7                 7
8           8                 8
9           9                 9
10          A a               A
11          B b               B
12          C c               C
13          D d               D
14          E e               E
15          F f               F
16          G g               G
17          H h               H
18          J j               J
19          K k               K
20          M m               M
21          N n               N
22          P p               P
23          Q q               Q
24          R r               R
25          S s               S
26          T t               T
27          V v               V U
28          W w               W
29          X x               X
30          Y y               Y
31          Z z               Z
</pre>
</div>
<figcaption><a href="#figure-2">Figure 2</a></figcaption></figure>
</div>
<p id="section-4.1-5">
         The Base32-Crockford Alphabet Including the Additional U Encode Symbol.<a href="#section-4.1-5">¶</a></p>
<p id="section-4.1-6">
         For the string representation of a zTLD we define:<a href="#section-4.1-6">¶</a></p>
<div id="section-4.1-7">
<pre>zkl := GNSCrockfordEncode(ztype|zkey)
ztype|zkey := GNSCrockfordDecode(zkl)
</pre><p><a href="#section-4.1-7">¶</a>
</p></div>
<p id="section-4.1-8">
         If zkl is less than 63 characters, it can directly be
         used as a zTLD.
         If zkl is longer than 63 characters, the
         zTLD is constructed by dividing zkl into smaller labels separated by the
         label separator &#34;.&#34;.
         Here, the most significant bytes of the &#34;ztype|zkey&#34; concatenation must be contained
         in the rightmost label of the resulting string and the least significant
         bytes in the leftmost label of the resulting string. This allows the
         resolver to determine the zone type and zkl length from the rightmost label.
         For example, assuming a zkl of 130 characters, the encoding would be:<a href="#section-4.1-8">¶</a></p>
<div id="section-4.1-9">
<pre>zTLD := zkl[126..129].zkl[63..125].zkl[0..62]
</pre><p><a href="#section-4.1-9">¶</a>
</p></div>
</section>
</div>
<div id="revocation">
<section id="section-4.2">
        <h3 id="name-zone-revocation">
<a href="#section-4.2">4.2. </a><a href="#name-zone-revocation">Zone Revocation</a>
        </h3>
<p id="section-4.2-1">
         Whenever a resolver encounters a new GNS zone, it MUST
         check against the local revocation list whether the respective
         zone key has been revoked.  If the zone key was revoked, the
         resolution MUST fail with an empty result set.<a href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">
         In order to revoke a zone key, a signed revocation object MUST be
         published.
         This object MUST be signed using the private key.
         The revocation object is broadcast to the network.
         The specification of the broadcast mechanism is out of scope of this
         document.
         A possible broadcast mechanism for efficient flooding in a distributed
         network is implemented in <span>[<a href="#GNUnet">GNUnet</a>]</span>.
         Alternatively, revocation objects could also be distributed via a
         distributed ledger or a trusted central server.
         To prevent
         flooding attacks, the revocation message MUST contain a proof of work
         (PoW).
         The revocation message including the PoW MAY be calculated
         ahead of time to support timely revocation.<a href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">
         For all occurrences below, &#34;Argon2id&#34; is the Password-based Key
         Derivation Function as defined in <span>[<a href="#RFC9106">RFC9106</a>]</span>. For the
         PoW calculations the algorithm is instantiated with the
         following parameters:<a href="#section-4.2-3">¶</a></p>
<span></span><dl id="section-4.2-4">
          <dt id="section-4.2-4.1">S</dt>
          <dd id="section-4.2-4.2">The salt. Fixed 16-byte string: &#34;GnsRevocationPow&#34;.<a href="#section-4.2-4.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.3">t</dt>
          <dd id="section-4.2-4.4">Number of iterations: 3<a href="#section-4.2-4.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.5">m</dt>
          <dd id="section-4.2-4.6">Memory size in KiB: 1024<a href="#section-4.2-4.6">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.7">T</dt>
          <dd id="section-4.2-4.8">Output length of hash in bytes: 64<a href="#section-4.2-4.8">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.9">p</dt>
          <dd id="section-4.2-4.10">Parallelization parameter: 1<a href="#section-4.2-4.10">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.11">v</dt>
          <dd id="section-4.2-4.12">Algorithm version: 0x13<a href="#section-4.2-4.12">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.13">y</dt>
          <dd id="section-4.2-4.14">Algorithm type (Argon2id): 2<a href="#section-4.2-4.14">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.15">X</dt>
          <dd id="section-4.2-4.16">Unused<a href="#section-4.2-4.16">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-4.17">K</dt>
          <dd id="section-4.2-4.18">Unused<a href="#section-4.2-4.18">¶</a>
</dd>
        <dd></dd>
</dl>
<p id="section-4.2-5">
         <a href="#figure_revocation">Figure 3</a> illustrates the wire format
         of the message string &#34;P&#34; on which the PoW is calculated.<a href="#section-4.2-5">¶</a></p>
<div id="figure_revocation">
<figure id="figure-3">
          <div id="section-4.2-6.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      POW                      |
+-----------------------------------------------+
|                   TIMESTAMP                   |
+-----------------------------------------------+
|       ZONE TYPE       |    ZONE KEY           |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-3">Figure 3</a></figcaption></figure>
</div>
<p id="section-4.2-7">The Wire Format of the PoW Message String.<a href="#section-4.2-7">¶</a></p>
<span></span><dl id="section-4.2-8">
          <dt id="section-4.2-8.1">POW</dt>
          <dd id="section-4.2-8.2">
           A 64-bit solution to the PoW. In network byte order.<a href="#section-4.2-8.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-8.3">TIMESTAMP</dt>
          <dd id="section-4.2-8.4">
           denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 in network
           byte order.<a href="#section-4.2-8.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-8.5">ZONE TYPE</dt>
          <dd id="section-4.2-8.6">
           is the 32-bit zone type.<a href="#section-4.2-8.6">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-8.7">ZONE KEY</dt>
          <dd id="section-4.2-8.8">
           is the 256-bit public key zk of the zone which is being revoked.
           The wire format of this value is defined by the ZONE TYPE.<a href="#section-4.2-8.8">¶</a>
</dd>
        <dd></dd>
</dl>
<p id="section-4.2-9">
         Traditionally, PoW schemes require to find a POW such that
         at least D leading zeroes are found in the hash result.
         D is then referred to as the difficulty of the PoW.
         In order to reduce the variance in time it takes to calculate the
         PoW, we require that a number Z different PoWs must be
         found that on average have D leading zeroes.<a href="#section-4.2-9">¶</a></p>
<p id="section-4.2-10">
         The resulting proofs may then published and disseminated. The concrete
         dissemination and publication methods are out of scope of this
         document. Given an average difficulty of D, the proofs have an
         expiration time of EPOCH. With each additional bit difficulty, the
         lifetime of the proof is prolonged for another EPOCH.
         Consequently, by calculating a more difficult PoW, the lifetime of the
         proof can be increased on demand by the zone owner.<a href="#section-4.2-10">¶</a></p>
<p id="section-4.2-11">
         The parameters are defined as follows:<a href="#section-4.2-11">¶</a></p>
<span></span><dl id="section-4.2-12">
          <dt id="section-4.2-12.1">Z</dt>
          <dd id="section-4.2-12.2">The number of PoWs required is fixed at 32.<a href="#section-4.2-12.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-12.3">D</dt>
          <dd id="section-4.2-12.4">The difficulty is fixed at 22.<a href="#section-4.2-12.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-12.5">EPOCH</dt>
          <dd id="section-4.2-12.6">A single epoch is fixed at 365 days.<a href="#section-4.2-12.6">¶</a>
</dd>
        <dd></dd>
</dl>
<p id="section-4.2-13">
         The revocation message wire format is illustrated in 
         <a href="#figure_revocationdata">Figure 4</a>.<a href="#section-4.2-13">¶</a></p>
<div id="figure_revocationdata">
<figure id="figure-4">
          <div id="section-4.2-14.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      TTL                      |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_0                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                       ...                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_Z-1                   |
+-----------------------------------------------+
|       ZONE TYPE       |    ZONE KEY           |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-4">Figure 4</a></figcaption></figure>
</div>
<p id="section-4.2-15">The Revocation Message Wire Format.<a href="#section-4.2-15">¶</a></p>
<span></span><dl id="section-4.2-16">
          <dt id="section-4.2-16.1">TIMESTAMP</dt>
          <dd id="section-4.2-16.2">
           denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 in network
           byte order. This is the same value as the timestamp used in the
           individual PoW calculations.<a href="#section-4.2-16.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-16.3">TTL</dt>
          <dd id="section-4.2-16.4">
           denotes the relative 64-bit time to live of the record in
           microseconds also in network byte order. This field is informational
           for a verifier. The verifier may discard revocation if the TTL
           indicates that it is already expired. However, the actual TTL of the
           revocation must be determined by examining the leading zeros in the
           proof of work calculation.<a href="#section-4.2-16.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-16.5">POW_i</dt>
          <dd id="section-4.2-16.6">
           The values calculated as part of the PoW, in network byte order.
           Each POW_i MUST be unique in the set of POW values.
           To facilitate fast verification
           of uniqueness, the POW values must be given in strictly
           monotonically increasing order in the message.<a href="#section-4.2-16.6">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-16.7">ZONE TYPE</dt>
          <dd id="section-4.2-16.8">
           The 32-bit zone type corresponding to the zone key.<a href="#section-4.2-16.8">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-16.9">ZONE KEY</dt>
          <dd id="section-4.2-16.10">
           is the public key zk of the zone which is being revoked and
           the key to be used to verify SIGNATURE.<a href="#section-4.2-16.10">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-16.11">SIGNATURE</dt>
          <dd id="section-4.2-16.12">
           A signature over a timestamp and the zone zk of the zone
           which is revoked and corresponds to the key used in the PoW.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the private key
           (see <a href="#zones">Section 4</a>).<a href="#section-4.2-16.12">¶</a>
</dd>
        <dd></dd>
</dl>
<p id="section-4.2-17">
         The signature over the public key covers a 32-bit pseudo header
         conceptually prefixed to the public key. The pseudo header includes
        the key length and signature purpose. The wire format is illustrated
        in <a href="#figure_revsigwithpseudo">Figure 5</a>.<a href="#section-4.2-17">¶</a></p>
<div id="figure_revsigwithpseudo">
<figure id="figure-5">
          <div id="section-4.2-18.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE (0x30)   |       PURPOSE (0x03)  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |     ZONE KEY          |
+-----+-----+-----+-----+                       |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-5">Figure 5</a></figcaption></figure>
</div>
<p id="section-4.2-19">The Wire Format of the Revocation Data for Signing.<a href="#section-4.2-19">¶</a></p>
<span></span><dl id="section-4.2-20">
          <dt id="section-4.2-20.1">SIZE</dt>
          <dd id="section-4.2-20.2">
           A 32-bit value containing the length of the signed data in bytes
           in network byte order.<a href="#section-4.2-20.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-20.3">PURPOSE</dt>
          <dd id="section-4.2-20.4">
           A 32-bit signature purpose flag. This field MUST be 3 (in network
           byte order).<a href="#section-4.2-20.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-20.5">ZONE TYPE</dt>
          <dd id="section-4.2-20.6">
           The 32-bit zone type corresponding to the zone key.<a href="#section-4.2-20.6">¶</a>
</dd>
          <dd></dd>
<dt id="section-4.2-20.7">ZONE KEY / TIMESTAMP</dt>
          <dd id="section-4.2-20.8">Both values as defined in the revocation data object above.<a href="#section-4.2-20.8">¶</a>
</dd>
        <dd></dd>
</dl>
<p id="section-4.2-21">
         In order to verify a revocation the following steps must be taken,
         in order:<a href="#section-4.2-21">¶</a></p>
<ol start="1" type="1" id="section-4.2-22">
         <li id="section-4.2-22.1">The signature MUST match the public key.<a href="#section-4.2-22.1">¶</a>
</li>
          <li id="section-4.2-22.2">The set of POW values MUST NOT contain duplicates.<a href="#section-4.2-22.2">¶</a>
</li>
          <li id="section-4.2-22.3">The average number of leading zeroes resulting from the provided
           POW values D&#39; MUST be greater than and not equal to D.<a href="#section-4.2-22.3">¶</a>
</li>
          <li id="section-4.2-22.4">The validation period (TTL) of the revocation is calculated as
           (D&#39;-D) * EPOCH * 1.1. The EPOCH is extended by
           10% in order to deal with unsynchronized clocks.
           The TTL added on top of the TIMESTAMP yields the
           expiration date.<a href="#section-4.2-22.4">¶</a>
</li>
          <li id="section-4.2-22.5">The current time MUST be between TIMESTAMP and
           TIMESTAMP+TTL.<a href="#section-4.2-22.5">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="rrecords">
<section id="section-5">
      <h2 id="name-resource-records">
<a href="#section-5">5. </a><a href="#name-resource-records">Resource Records</a>
      </h2>
<p id="section-5-1">
       A GNS implementer MUST provide a mechanism to create and manage resource
       records for local zones. A local zone is established by selecting a
       zone type and creating a zone key pair.
       As records may be added to each created zone, a (local) persistence
       mechanism such as a database for resource records and zones must be provided.
       This local zone database is used by the name resolution logic and serves
       as a basis for publishing zones into the GNS storage (see <a href="#publish">Section 6</a>).<a href="#section-5-1">¶</a></p>
<p id="section-5-2">
       A GNS resource record holds the data of a specific record in a zone.
       The resource record format is defined in
       <a href="#figure_gnsrecord">Figure 6</a>.<a href="#section-5-2">¶</a></p>
<div id="figure_gnsrecord">
<figure id="figure-6">
        <div id="section-5-3.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       DATA SIZE       |          TYPE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|           FLAGS       |        DATA           /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-6">Figure 6</a></figcaption></figure>
</div>
<p id="section-5-4">The Resource Record Wire Format.<a href="#section-5-4">¶</a></p>
<span></span><dl id="section-5-5">
        <dt id="section-5-5.1">EXPIRATION</dt>
        <dd id="section-5-5.2">
         denotes the absolute 64-bit expiration date of the record.
         In microseconds since midnight (0 hour), January 1, 1970 in network
         byte order.<a href="#section-5-5.2">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-5.3">DATA SIZE</dt>
        <dd id="section-5-5.4">
         denotes the 32-bit size of the DATA field in bytes and in network byte
         order.<a href="#section-5-5.4">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-5.5">TYPE</dt>
        <dd id="section-5-5.6">
         is the 32-bit resource record type. This type can be one of the GNS resource
         records as defined in <a href="#rrecords">Section 5</a> or a DNS record
         type as defined in <span>[<a href="#RFC1035">RFC1035</a>]</span> or any of the
         complementary standardized DNS resource record types. This value must be
         stored in network byte order. Note that values
         below 2^16 are reserved for allocation via IANA <span>[<a href="#RFC6895">RFC6895</a>]</span>,
         while values above 2^16 are allocated by the
         GNUnet Assigned Numbers Authority <span>[<a href="#GANA">GANA</a>]</span>.<a href="#section-5-5.6">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-5.7">FLAGS</dt>
        <dd id="section-5-5.8">
         is a 32-bit resource record flags field (see below).<a href="#section-5-5.8">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-5.9">DATA</dt>
        <dd id="section-5-5.10">
         the variable-length resource record data payload. The contents are defined
         by the
         respective type of the resource record.<a href="#section-5-5.10">¶</a>
</dd>
      <dd></dd>
</dl>
<p id="section-5-6">
       Flags indicate metadata surrounding the resource record. A flag
       value of 0 indicates that all flags are unset.
       Applications creating resource records MUST set all bits which are
       not defined as a flag to 0. Additional flags may be defined in
       future protocol versions.
       If an application or implementation encounters a flag which it does not
       recognize, it MUST be ignored.
       <a href="#figure_flag">Figure 7</a>
       illustrates the flag distribution in the 32-bit flag value of a
       resource record:<a href="#section-5-6">¶</a></p>
<div id="figure_flag">
<figure id="figure-7">
        <div id="section-5-7.1">
<pre> 0        1        2        3        4        5...
+--------+--------+--------+--------+--------+----
|RESERVED|PRIVATE |SUPPL   |EXPREL  | SHADOW | ...
+--------+--------+--------+--------+--------+----
</pre>
</div>
<figcaption><a href="#figure-7">Figure 7</a></figcaption></figure>
</div>
<p id="section-5-8">The Resource Record Flag Wire Format.<a href="#section-5-8">¶</a></p>
<span></span><dl id="section-5-9">
        <dt id="section-5-9.1">SHADOW</dt>
        <dd id="section-5-9.2">
         If this flag is set, this record should be ignored by resolvers unless all (other)
         records of the same record type have expired.  Used to allow zone publishers to
         facilitate good performance when records change by allowing them to put future
         values of records into the storage.
         This way, future values can propagate and may be
         cached before the transition becomes active.<a href="#section-5-9.2">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-9.3">EXPREL</dt>
        <dd id="section-5-9.4">
         The expiration time value of the record is a relative time (still in microseconds)
         and not an absolute time. This flag should never be encountered by a resolver
         for records obtained from the storage, but might be present when a resolver looks up
         private records of a zone hosted locally.<a href="#section-5-9.4">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-9.5">
         SUPPL
        </dt>
        <dd id="section-5-9.6">
         This is a supplemental record. It is provided in addition to the
         other records. This flag indicates that this record is not explicitly
         managed alongside the other records under the respective name but
         may be useful for the application. This flag should only be encountered
         by a resolver for records obtained from the storage.<a href="#section-5-9.6">¶</a>
</dd>
        <dd></dd>
<dt id="section-5-9.7">PRIVATE</dt>
        <dd id="section-5-9.8">
         This is a private record of this peer and it should thus not be
         published.  Thus, this flag should never be encountered by
         a resolver for records obtained from the storage.
         Private records should still be considered just like
         regular records when resolving labels in local zones.<a href="#section-5-9.8">¶</a>
</dd>
      <dd></dd>
</dl>
<div id="gnsrecords_delegation">
<section id="section-5.1">
        <h3 id="name-zone-delegation-records">
<a href="#section-5.1">5.1. </a><a href="#name-zone-delegation-records">Zone Delegation Records</a>
        </h3>
<p id="section-5.1-1">
       This section defines the initial set of zone delegation record types.
       Any implementation MUST support all zone types defined here and
       MAY support any number of additional delegation records defined in
       the GNU Name System Record Types registry <a href="#gana">Section 10</a>.
       Zone delegation records MUST NOT be stored and published under the
       empty label.<a href="#section-5.1-1">¶</a></p>
<div id="gnsrecords_pkey">
<section id="section-5.1.1">
          <h4 id="name-pkey">
<a href="#section-5.1.1">5.1.1. </a><a href="#name-pkey">PKEY</a>
          </h4>
<p id="section-5.1.1-1">In GNS, a delegation of a label to a zone of type &#34;PKEY&#34; is
         represented through a PKEY record.  The PKEY number is a zone
         type and thus also implies the cryptosystem for the zone that
         is being delegated to.
         A PKEY resource record contains the public key of the zone to
         delegate to.
         A PKEY record MUST be the only record under a label. No other
         records are allowed. The PKEY DATA entry wire format can be found
         in <a href="#figure_pkeyrecord">Figure 8</a>.<a href="#section-5.1.1-1">¶</a></p>
<div id="figure_pkeyrecord">
<figure id="figure-8">
            <div id="section-5.1.1-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-8">Figure 8</a></figcaption></figure>
</div>
<p id="section-5.1.1-3">The PKEY Wire Format.<a href="#section-5.1.1-3">¶</a></p>
<span></span><dl id="section-5.1.1-4">
            <dt id="section-5.1.1-4.1">PUBLIC KEY</dt>
            <dd id="section-5.1.1-4.2">
           A 256-bit ECDSA zone key.<a href="#section-5.1.1-4.2">¶</a>
</dd>
          <dd></dd>
</dl>
<p id="section-5.1.1-5">
         For PKEY zones the zone key material is derived using the
         curve parameters of the twisted edwards representation
         of Curve25519 <span>[<a href="#RFC7748">RFC7748</a>]</span> (a.k.a. edwards25519)
         with the ECDSA scheme <span>[<a href="#RFC6979">RFC6979</a>]</span>.
         Consequently, we use the following naming convention for our
         cryptographic primitives for PKEY zones:<a href="#section-5.1.1-5">¶</a></p>
<span></span><dl id="section-5.1.1-6">
            <dt id="section-5.1.1-6.1">d</dt>
            <dd id="section-5.1.1-6.2">
           is a 256-bit ECDSA private key.<a href="#section-5.1.1-6.2">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.1-6.3">zk</dt>
            <dd id="section-5.1.1-6.4">
           is the ECDSA public zone key corresponding to d.<a href="#section-5.1.1-6.4">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.1-6.5">p</dt>
            <dd id="section-5.1.1-6.6">
           is the prime of edwards25519 as defined in <span>[<a href="#RFC7748">RFC7748</a>]</span>, i.e.
           2^255 - 19.<a href="#section-5.1.1-6.6">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.1-6.7">G</dt>
            <dd id="section-5.1.1-6.8">
           is the group generator (X(P),Y(P)) of edwards25519 as defined in
           <span>[<a href="#RFC7748">RFC7748</a>]</span>.<a href="#section-5.1.1-6.8">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.1-6.9">L</dt>
            <dd id="section-5.1.1-6.10">
           is the order of the prime-order subgroup of edwards25519 in <span>[<a href="#RFC7748">RFC7748</a>]</span>.<a href="#section-5.1.1-6.10">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.1-6.11">KeyGen()</dt>
            <dd id="section-5.1.1-6.12">The generation of the private
           scalar d and the curve point zk := d*G (where G is the group generator
           of the elliptic curve) as defined in Section 2.2. of 
           <span>[<a href="#RFC6979">RFC6979</a>]</span> represents the KeyGen() function.<a href="#section-5.1.1-6.12">¶</a>
</dd>
          <dd></dd>
</dl>
<p id="section-5.1.1-7">
         The zone type and zone key of a PKEY are 32 + 4 bytes in length. This means that
         a zTLD will always fit into a single label and does
         not need any further conversion.<a href="#section-5.1.1-7">¶</a></p>
<p id="section-5.1.1-8">
         Given a label, the output d&#39; of the ZKDF-Private(d,label) function for zone
         key blinding is calculated as follows for PKEY zones:<a href="#section-5.1.1-8">¶</a></p>
<div id="section-5.1.1-9">
<pre>zk := d * G
PRK_h := HKDF-Extract (&#34;key-derivation&#34;, zk)
h := HKDF-Expand (PRK_h, label | &#34;gns&#34;, 512 / 8)
d&#39; := (h * d) mod L
</pre><p><a href="#section-5.1.1-9">¶</a>
</p></div>
<p id="section-5.1.1-10">
         Equally, given a label, the output zk&#39; of the ZKDF-Public(zk,label) function is
         calculated as follows for PKEY zones:<a href="#section-5.1.1-10">¶</a></p>
<div id="section-5.1.1-11">
<pre>PRK_h := HKDF-Extract (&#34;key-derivation&#34;, zk)
h := HKDF-Expand (PRK_h, label | &#34;gns&#34;, 512 / 8)
zk&#39; := (h mod L) * zk
</pre><p><a href="#section-5.1.1-11">¶</a>
</p></div>
<p id="section-5.1.1-12">
         The PKEY cryptosystem uses a hash-based key derivation function (HKDF) as defined in
         <span>[<a href="#RFC5869">RFC5869</a>]</span>, using SHA-512 <span>[<a href="#RFC6234">RFC6234</a>]</span> for the extraction
         phase and SHA-256 <span>[<a href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
         PRK_h is key material retrieved using an HKDF using the string
         &#34;key-derivation&#34; as salt and the zone key as initial
         keying material.
         h is the 512-bit HKDF expansion result and must be interpreted in
         network byte order. The expansion information input is
         a concatenation of the label and the string &#34;gns&#34;.
         The label is a UTF-8 string under which the resource records are
         published.
         The multiplication of zk with h is a point multiplication,
         while the multiplication of d with h is a scalar multiplication.<a href="#section-5.1.1-12">¶</a></p>
<p id="section-5.1.1-13">
         The Sign() and Verify() functions
         for PKEY zones are implemented using 512-bit ECDSA deterministic
         signatures as specified in <span>[<a href="#RFC6979">RFC6979</a>]</span>.<a href="#section-5.1.1-13">¶</a></p>
<p id="section-5.1.1-14">
         The S-Encrypt() and S-Decrypt() functions use AES in counter mode
         as defined in <span>[<a href="#MODES">MODES</a>]</span> (CTR-AES-256):<a href="#section-5.1.1-14">¶</a></p>
<div id="section-5.1.1-15">
<pre>CIPHERTEXT := CTR-AES256(K, IV, DATA)
DATA := CTR-AES256(K, IV, CIPHERTEXT)
</pre><p><a href="#section-5.1.1-15">¶</a>
</p></div>
<p id="section-5.1.1-16">
         The key K and counter IV are derived from
         the record label and the zone key zk as follows:<a href="#section-5.1.1-16">¶</a></p>
<div id="section-5.1.1-17">
<pre>PRK_k := HKDF-Extract (&#34;gns-aes-ctx-key&#34;, zk)
PRK_n := HKDF-Extract (&#34;gns-aes-ctx-iv&#34;, zk)
K := HKDF-Expand (PRK_k, label, 256 / 8);
NONCE := HKDF-Expand (PRK_n, label, 32 / 8)
</pre><p><a href="#section-5.1.1-17">¶</a>
</p></div>
<p id="section-5.1.1-18">
         HKDF is a hash-based key derivation function as defined in
         <span>[<a href="#RFC5869">RFC5869</a>]</span>. Specifically, SHA-512 <span>[<a href="#RFC6234">RFC6234</a>]</span> is used for the
         extraction phase and SHA-256 <span>[<a href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
         The output keying material is 32 bytes (256 bits) for the symmetric
         key and 4 bytes (32 bits) for the nonce.
         The symmetric key K is a 256-bit AES <span>[<a href="#RFC3826">RFC3826</a>]</span> key.<a href="#section-5.1.1-18">¶</a></p>
<p id="section-5.1.1-19">
         The nonce is combined with a 64-bit initialization vector and a
         32-bit block counter as defined in <span>[<a href="#RFC3686">RFC3686</a>]</span>.
         The block counter begins with the value of 1, and it is incremented
         to generate subsequent portions of the key stream.
         The block counter is a 32-bit integer value in network byte order.
         The initialization vector is the expiration time of the
         resource record block in network byte order.
         The resulting counter (IV) wire format can be found in 
         <a href="#figure_hkdf_ivs_pkey">Figure 9</a>.<a href="#section-5.1.1-19">¶</a></p>
<div id="figure_hkdf_ivs_pkey">
<figure id="figure-9">
            <div id="section-5.1.1-20.1">
<pre>0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
|      BLOCK COUNTER    |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-9">Figure 9</a></figcaption></figure>
</div>
<p id="section-5.1.1-21">The Block Counter Wire Format.<a href="#section-5.1.1-21">¶</a></p>
</section>
</div>
<div id="gnsrecords_edkey">
<section id="section-5.1.2">
          <h4 id="name-edkey">
<a href="#section-5.1.2">5.1.2. </a><a href="#name-edkey">EDKEY</a>
          </h4>
<p id="section-5.1.2-1">
         In GNS, a delegation of a label to a zone of type &#34;EDKEY&#34; is
         represented through a EDKEY record.  The EDKEY number is a zone
         type and thus also implies the cryptosystem for the zone that
         is being delegated to.
         An EDKEY resource record contains the public key of the zone to
         delegate to.
         A EDKEY record MUST be the only record under a label. No other
           records are allowed. The EDKEY DATA entry wire format
         is illustrated in <a href="#figure_edkeyrecord">Figure 10</a>.<a href="#section-5.1.2-1">¶</a></p>
<div id="figure_edkeyrecord">
<figure id="figure-10">
            <div id="section-5.1.2-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-10">Figure 10</a></figcaption></figure>
</div>
<p id="section-5.1.2-3">The EDKEY DATA Wire Format.<a href="#section-5.1.2-3">¶</a></p>
<span></span><dl id="section-5.1.2-4">
            <dt id="section-5.1.2-4.1">PUBLIC KEY</dt>
            <dd id="section-5.1.2-4.2">
           A 256-bit EdDSA zone key.<a href="#section-5.1.2-4.2">¶</a>
</dd>
          <dd></dd>
</dl>
<p id="section-5.1.2-5">
           For EDKEY zones the zone key material is derived using the
           curve parameters of the twisted edwards representation
           of Curve25519 <span>[<a href="#RFC7748">RFC7748</a>]</span> (a.k.a. edwards25519)
           with the Ed25519-SHA-512 scheme <span>[<a href="#ed25519">ed25519</a>]</span>.
           Consequently, we use the following naming convention for our
           cryptographic primitives for EDKEY zones:<a href="#section-5.1.2-5">¶</a></p>
<span></span><dl id="section-5.1.2-6">
            <dt id="section-5.1.2-6.1">d</dt>
            <dd id="section-5.1.2-6.2">
             is a 256-bit EdDSA private key.<a href="#section-5.1.2-6.2">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.2-6.3">a</dt>
            <dd id="section-5.1.2-6.4">
             is is an integer derived from d using the SHA-512 hash function
             as defined in <span>[<a href="#ed25519">ed25519</a>]</span>.<a href="#section-5.1.2-6.4">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.2-6.5">zk</dt>
            <dd id="section-5.1.2-6.6">
             is the EdDSA public key corresponding to d. It is defined 
             as the curve point a*G where G is the
             group generator of the elliptic curve
             as defined in <span>[<a href="#ed25519">ed25519</a>]</span>.<a href="#section-5.1.2-6.6">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.2-6.7">p</dt>
            <dd id="section-5.1.2-6.8">
             is the prime of edwards25519 as defined in <span>[<a href="#RFC7748">RFC7748</a>]</span>, i.e.
             2^255 - 19.<a href="#section-5.1.2-6.8">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.2-6.9">G</dt>
            <dd id="section-5.1.2-6.10">
             is the group generator (X(P),Y(P)) of edwards25519 as defined in
            <span>[<a href="#RFC7748">RFC7748</a>]</span>.<a href="#section-5.1.2-6.10">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.2-6.11">L</dt>
            <dd id="section-5.1.2-6.12">
             is the order of the prime-order subgroup of edwards25519 in <span>[<a href="#RFC7748">RFC7748</a>]</span>.<a href="#section-5.1.2-6.12">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.2-6.13">KeyGen()</dt>
            <dd id="section-5.1.2-6.14">
             The generation of the private key d and the associated public
             key zk := a*G where G is the
             group generator of the elliptic curve and a is an integer
             derived from d using the SHA-512 hash function 
             as defined
             in Section 3.2. of <span>[<a href="#RFC8032">RFC8032</a>]</span> represents the KeyGen()
             function.<a href="#section-5.1.2-6.14">¶</a>
</dd>
          <dd></dd>
</dl>
<p id="section-5.1.2-7">
           The zone type and zone key of an EDKEY are 32 + 4 bytes in length. This means that
           a zTLD will always fit into a single label and does
           not need any further conversion.<a href="#section-5.1.2-7">¶</a></p>
<p id="section-5.1.2-8">
           The &#34;EDKEY&#34; ZKDF instantiation is based on <span>[<a href="#Tor224">Tor224</a>]</span>.
           Given a label, the output of the ZKDF-Private function for zone
           key blinding is calculated as follows for EDKEY zones:<a href="#section-5.1.2-8">¶</a></p>
<div id="section-5.1.2-9">
<pre>zk := a * G
PRK_h := HKDF-Extract (&#34;key-derivation&#34;, zk)
h := HKDF-Expand (PRK_h, label | &#34;gns&#34;, 512 / 8)
h[31] &amp;= 7
a1 := a / 8 /* 8 is the cofactor of Curve25519 */
a2 := (h * a1) mod L
a&#39; = a2 * 8 /* 8 is the cofactor of Curve25519 */
</pre><p><a href="#section-5.1.2-9">¶</a>
</p></div>
<p id="section-5.1.2-10">
           Equally, given a label, the output of the ZKDF-Public function is
           calculated as follows for PKEY zones:<a href="#section-5.1.2-10">¶</a></p>
<div id="section-5.1.2-11">
<pre>PRK_h := HKDF-Extract (&#34;key-derivation&#34;, zk)
h := HKDF-Expand (PRK_h, label | &#34;gns&#34;, 512 / 8)
h[31] &amp;= 7  // Implies h mod L == h
zk&#39; := h * zk
</pre><p><a href="#section-5.1.2-11">¶</a>
</p></div>
<p id="section-5.1.2-12">
           We note that implementers must employ a constant time scalar
           multiplication for the constructions above. Also, implementers
           must ensure that the private key a is an ed25519 private key
           and specifically that &#34;a[0] &amp; 7 == 0&#34; holds.<a href="#section-5.1.2-12">¶</a></p>
<p id="section-5.1.2-13">
           The EDKEY cryptosystem uses a
           hash-based key derivation function (HKDF) as defined in
           <span>[<a href="#RFC5869">RFC5869</a>]</span>, using SHA-512 <span>[<a href="#RFC6234">RFC6234</a>]</span> for the extraction
           phase and HMAC-SHA256 <span>[<a href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
           PRK_h is key material retrieved using an HKDF using the string
           &#34;key-derivation&#34; as salt and the zone key as initial
           keying material.
           The blinding factor h is the 512-bit HKDF expansion result.
           The expansion information input is
           a concatenation of the label and the string &#34;gns&#34;.
           The result of the HKDF must be clamped and interpreted in network
           byte order.
           a is the 256-bit integer corresponding to the 256-bit private 
           key d.
           The label is a UTF-8 string under which the resource records are
           published.
           The multiplication of zk with h is a point multiplication,
           while the division and multiplication of a and a1 with the
           co-factor are integer operations.<a href="#section-5.1.2-13">¶</a></p>
<p id="section-5.1.2-14">
           Signatures for EDKEY zones using the derived private key a&#39;
           are not compliant with <span>[<a href="#ed25519">ed25519</a>]</span>.
           As the corresponding private key to the derived private scalar a&#39;
           is not known, it is not possible to deterministically derive the
           signature part R according to <span>[<a href="#ed25519">ed25519</a>]</span>.
           Instead, signatures MUST be generated as follows for any given
           message M:
           A nonce is calculated from the highest 32 bytes of the
           expansion of the private key d and the blinding factor h.
           The nonce is then hashed with the message M to r.
           This way, we include the full derivation path in the calculation
           of the R value of the signature, ensuring that it is never reused
           for two different derivation paths or messages.<a href="#section-5.1.2-14">¶</a></p>
<div id="section-5.1.2-15">
<pre>dh := SHA-512 (d)
nonce := SHA-256 (dh[32..63] | h)
r := SHA-512 (nonce | M)
R := r * G
S := r + SHA-512(R | zk&#39; | M) * a&#39; mod L
</pre><p><a href="#section-5.1.2-15">¶</a>
</p></div>
<p id="section-5.1.2-16">
           A signature (R,S) is valid if the following holds:<a href="#section-5.1.2-16">¶</a></p>
<div id="section-5.1.2-17">
<pre>S * G == R + SHA-512(R, zk&#39;, M) * zk&#39;
</pre><p><a href="#section-5.1.2-17">¶</a>
</p></div>
<p id="section-5.1.2-18">
           The S-Encrypt() and S-Decrypt() functions use XSalsa20
           as defined in <span>[<a href="#XSalsa20">XSalsa20</a>]</span>
           (XSalsa20-Poly1305):<a href="#section-5.1.2-18">¶</a></p>
<div id="section-5.1.2-19">
<pre>CIPHERTEXT := XSalsa20-Poly1305(K, IV, DATA)
DATA := XSalsa20-Poly1305(K, IV, CIPHERTEXT)
</pre><p><a href="#section-5.1.2-19">¶</a>
</p></div>
<p id="section-5.1.2-20">
           The result of the XSalsa20-Poly1305 encryption function is the encrypted
           ciphertext concatenated with the 128-bit authentication
           tag.
           Accordingly, the length of encrypted data equals the length of the
           data plus the 16 bytes of the authentication tag.<a href="#section-5.1.2-20">¶</a></p>
<p id="section-5.1.2-21">
           The key K and counter IV are derived from
           the record label and the zone key zk as follows:<a href="#section-5.1.2-21">¶</a></p>
<div id="section-5.1.2-22">
<pre>PRK_k := HKDF-Extract (&#34;gns-aes-ctx-key&#34;, zk)
PRK_n := HKDF-Extract (&#34;gns-aes-ctx-iv&#34;, zk)
K := HKDF-Expand (PRK_k, label, 256 / 8);
NONCE := HKDF-Expand (PRK_n, label, 32 / 8)
</pre><p><a href="#section-5.1.2-22">¶</a>
</p></div>
<p id="section-5.1.2-23">
           HKDF is a hash-based key derivation function as defined in
           <span>[<a href="#RFC5869">RFC5869</a>]</span>. Specifically, SHA-512 <span>[<a href="#RFC6234">RFC6234</a>]</span> is used for the
           extraction phase and SHA-256 <span>[<a href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
           The output keying material is 32 bytes (256 bits) for the symmetric
           key and 16 bytes (128 bits) for the NONCE.
           The symmetric key K is a 256-bit XSalsa20
           <span>[<a href="#XSalsa20">XSalsa20</a>]</span> key.
           No additional authenticated data (AAD) is used.<a href="#section-5.1.2-23">¶</a></p>
<p id="section-5.1.2-24">
           The nonce is combined with an 8 byte initialization vector.
           The initialization vector is the expiration time of the
           resource record block in network byte order.
           The resulting counter (IV) wire format is illustrated in 
           <a href="#figure_hkdf_ivs_edkey">Figure 11</a>.<a href="#section-5.1.2-24">¶</a></p>
<div id="figure_hkdf_ivs_edkey">
<figure id="figure-11">
            <div id="section-5.1.2-25.1">
<pre>0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
|                       |
|                       |
|                       |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-11">Figure 11</a></figcaption></figure>
</div>
<p id="section-5.1.2-26">The Counter Block Initialization Vector<a href="#section-5.1.2-26">¶</a></p>
</section>
</div>
<div id="gnsrecords_gns2dns">
<section id="section-5.1.3">
          <h4 id="name-gns2dns">
<a href="#section-5.1.3">5.1.3. </a><a href="#name-gns2dns">GNS2DNS</a>
          </h4>
<p id="section-5.1.3-1">It is possible to delegate a label back into DNS through a GNS2DNS record.
         The resource record contains a DNS name for the resolver to continue with
         in DNS followed by a DNS server. Both names are in the format defined in
         <span>[<a href="#RFC1034">RFC1034</a>]</span> for DNS names.
           A GNS2DNS DATA entry is illustrated in <a href="#figure_gns2dnsrecord">Figure 12</a>.<a href="#section-5.1.3-1">¶</a></p>
<div id="figure_gns2dnsrecord">
<figure id="figure-12">
            <div id="section-5.1.3-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    DNS NAME                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 DNS SERVER NAME               |
/                                               /
/                                               /
|                                               |
+-----------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-12">Figure 12</a></figcaption></figure>
</div>
<p id="section-5.1.3-3"> The GNS2DNS DATA Wire Format<a href="#section-5.1.3-3">¶</a></p>
<span></span><dl id="section-5.1.3-4">
            <dt id="section-5.1.3-4.1">DNS NAME</dt>
            <dd id="section-5.1.3-4.2">
           The name to continue with in DNS. The value is UTF-8 encoded and
           0-terminated.<a href="#section-5.1.3-4.2">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.1.3-4.3">DNS SERVER NAME</dt>
            <dd id="section-5.1.3-4.4">
           The DNS server to use. May be an IPv4 address in dotted-decimal
           form or an IPv6 address in colon-hexadecimal form or a DNS name.
           It may also be a relative GNS name ending with a
           &#34;+&#34; top-level domain.
           The implementation MUST check the string syntactically for a
           an IP address in the respective notation before checking for a
           relative GNS name.
           If all three checks fail, the name MUST be treated as a DNS name.
           The value is UTF-8 encoded and 0-terminated.<a href="#section-5.1.3-4.4">¶</a>
</dd>
          <dd></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="gnsrecords_other">
<section id="section-5.2">
        <h3 id="name-auxiliary-records">
<a href="#section-5.2">5.2. </a><a href="#name-auxiliary-records">Auxiliary Records</a>
        </h3>
<p id="section-5.2-1">
         This section defines the initial set of auxiliary GNS record types. Any
         implementation MUST be able to process the specified record types
         according to <a href="#record_processing">Section 7.3</a>.<a href="#section-5.2-1">¶</a></p>
<div id="gnsrecords_leho">
<section id="section-5.2.1">
          <h4 id="name-leho">
<a href="#section-5.2.1">5.2.1. </a><a href="#name-leho">LEHO</a>
          </h4>
<p id="section-5.2.1-1">
         Applications can use the GNS to lookup IPv4 or IPv6 addresses of
         internet services.
         However, sometimes connecting to such services does not only require
         the knowledge of an address and port, but also requires the canonical
         DNS name of the service to be transmitted over the transport protocol.
         In GNS, legacy host name records provide applications the DNS name that
         is required to establish a connection to such a service.
         The most common use case is HTTP virtual hosting, where a DNS name must
         be supplied in the HTTP &#34;Host&#34;-header.
         Using a GNS name for the &#34;Host&#34;-header may not work as
         it may not be globally unique.

         A LEHO resource record is expected to be found together in a single
         resource record with an IPv4 or IPv6 address.
         A LEHO DATA entry is illustrated in <a href="#figure_lehorecord">Figure 13</a>.<a href="#section-5.2.1-1">¶</a></p>
<div id="figure_lehorecord">
<figure id="figure-13">
            <div id="section-5.2.1-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 LEGACY HOSTNAME               |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-13">Figure 13</a></figcaption></figure>
</div>
<p id="section-5.2.1-3"> The LEHO DATA Wire Format.<a href="#section-5.2.1-3">¶</a></p>
<span></span><dl id="section-5.2.1-4">
            <dt id="section-5.2.1-4.1">LEGACY HOSTNAME</dt>
            <dd id="section-5.2.1-4.2">
           A UTF-8 string (which is not 0-terminated) representing the legacy hostname.<a href="#section-5.2.1-4.2">¶</a>
</dd>
          <dd></dd>
</dl>
<p id="section-5.2.1-5">
         NOTE: If an application uses a LEHO value in an HTTP request header
         (e.g. &#34;Host:&#34; header) it must be converted to a punycode representation
         <span>[<a href="#RFC5891">RFC5891</a>]</span>.<a href="#section-5.2.1-5">¶</a></p>
</section>
</div>
<div id="gnsrecords_nick">
<section id="section-5.2.2">
          <h4 id="name-nick">
<a href="#section-5.2.2">5.2.2. </a><a href="#name-nick">NICK</a>
          </h4>
<p id="section-5.2.2-1">
         Nickname records can be used by zone administrators to publish an
         the label that a zone prefers to have used when it is referred to.
         This is a suggestion to other zones what label to use when creating a
         delegation record (<a href="#gnsrecords_delegation">Section 5.1</a>) containing
         this zone key.
         This record SHOULD only be stored under the empty label &#34;@&#34; but MAY be
         returned with record sets under any label as a supplemental record.
         <a href="#nick_processing">Section 7.3.6</a> details how a resolver must process
         supplemental and non-supplemental NICK records.
         A NICK DATA entry is illustrated in <a href="#figure_nickrecord">Figure 14</a>.<a href="#section-5.2.2-1">¶</a></p>
<div id="figure_nickrecord">
<figure id="figure-14">
            <div id="section-5.2.2-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                  NICKNAME                     |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-14">Figure 14</a></figcaption></figure>
</div>
<p id="section-5.2.2-3">The NICK DATA Wire Format.<a href="#section-5.2.2-3">¶</a></p>
<span></span><dl id="section-5.2.2-4">
            <dt id="section-5.2.2-4.1">NICKNAME</dt>
            <dd id="section-5.2.2-4.2">
           A UTF-8 string (which is not 0-terminated) representing the preferred
           label of the zone. This string MUST NOT include a &#34;.&#34; character.<a href="#section-5.2.2-4.2">¶</a>
</dd>
          <dd></dd>
</dl>
</section>
</div>
<div id="gnsrecords_box">
<section id="section-5.2.3">
          <h4 id="name-box">
<a href="#section-5.2.3">5.2.3. </a><a href="#name-box">BOX</a>
          </h4>
<p id="section-5.2.3-1">
         In GNS, with the notable exception of zTLDs, every &#34;.&#34; in a name
         delegates to another zone, and
         GNS lookups are expected to return all of the required useful
         information in one record set.  This is incompatible with the
         special labels used by DNS for SRV and TLSA records.  Thus, GNS
         defines the BOX record format to box up SRV and TLSA records and
         include them in the record set of the label they are associated
         with.  For example, a
         TLSA record for &#34;_https._tcp.example.org&#34; will be stored in the record set of
         &#34;example.org&#34; as a BOX record with service (SVC) 443 (https) and protocol (PROTO) 6
         (tcp) and record TYPE &#34;TLSA&#34;.
         For reference, see also <span>[<a href="#RFC2782">RFC2782</a>]</span>.
           A BOX DATA entry is illustrated in <a href="#figure_boxrecord">Figure 15</a>.<a href="#section-5.2.3-1">¶</a></p>
<div id="figure_boxrecord">
<figure id="figure-15">
            <div id="section-5.2.3-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|   PROTO   |    SVC    |       TYPE            |
+-----------+-----------------------------------+
|                 RECORD DATA                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-15">Figure 15</a></figcaption></figure>
</div>
<p id="section-5.2.3-3">The BOX DATA Wire Format.<a href="#section-5.2.3-3">¶</a></p>
<span></span><dl id="section-5.2.3-4">
            <dt id="section-5.2.3-4.1">PROTO</dt>
            <dd id="section-5.2.3-4.2">
           the 16-bit protocol number, e.g. 6 for tcp. In network byte order.<a href="#section-5.2.3-4.2">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.2.3-4.3">SVC</dt>
            <dd id="section-5.2.3-4.4">
           the 16-bit service value of the boxed record, i.e. the port number.
           In network byte order.<a href="#section-5.2.3-4.4">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.2.3-4.5">TYPE</dt>
            <dd id="section-5.2.3-4.6">
           is the 32-bit record type of the boxed record. In network byte order.<a href="#section-5.2.3-4.6">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.2.3-4.7">RECORD DATA</dt>
            <dd id="section-5.2.3-4.8">
           is a variable length field containing the &#34;DATA&#34; format of TYPE as
           defined for the respective TYPE in DNS.<a href="#section-5.2.3-4.8">¶</a>
</dd>
          <dd></dd>
</dl>
</section>
</div>
<div id="gnsrecords_vpn">
<section id="section-5.2.4">
          <h4 id="name-gts">
<a href="#section-5.2.4">5.2.4. </a><a href="#name-gts">GTS</a>
          </h4>
<p id="section-5.2.4-1">
         The GNUnet Tunnel Service record is used by
         applications to establish a tunnel between two peers in the
         peer-to-peer network (see <span>[<a href="#GNUnet">GNUnet</a>]</span>).
         The GTS record serves as an example of how resolvers may automatically
         initiate tunnel establishment and provide IP address information in the
         resolution process as specified in <a href="#resolution">Section 7</a>.<a href="#section-5.2.4-1">¶</a></p>
<p id="section-5.2.4-2">
           A GTS DATA entry wire format is illustrated in 
         <a href="#figure_vpnrecord">Figure 16</a>.<a href="#section-5.2.4-2">¶</a></p>
<div id="figure_vpnrecord">
<figure id="figure-16">
            <div id="section-5.2.4-3.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|          HOSTING PEER PUBLIC KEY              |
|                (256 bits)                     |
|                                               |
|                                               |
+-----------+-----------------------------------+
|   PROTO   |    SERVICE  NAME                  |
+-----------+                                   +
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-16">Figure 16</a></figcaption></figure>
</div>
<p id="section-5.2.4-4">The GTS DATA Wire Format.<a href="#section-5.2.4-4">¶</a></p>
<span></span><dl id="section-5.2.4-5">
            <dt id="section-5.2.4-5.1">HOSTING PEER PUBLIC KEY</dt>
            <dd id="section-5.2.4-5.2">
           is a 256-bit EdDSA public key identifying the peer hosting the
           service.<a href="#section-5.2.4-5.2">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.2.4-5.3">PROTO</dt>
            <dd id="section-5.2.4-5.4">
           the 16-bit tunnel protocol number. In network byte order.
           The possible values are defined by the GNUnet Tunnel Service.<a href="#section-5.2.4-5.4">¶</a>
</dd>
            <dd></dd>
<dt id="section-5.2.4-5.5">SERVICE NAME</dt>
            <dd id="section-5.2.4-5.6">
           a shared secret used to identify the service at the hosting peer,
           used to derive the port number required to connect to the service.
           The service name MUST be a 0-terminated UTF-8 string.<a href="#section-5.2.4-5.6">¶</a>
</dd>
          <dd></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="publish">
<section id="section-6">
      <h2 id="name-record-storage">
<a href="#section-6">6. </a><a href="#name-record-storage">Record Storage</a>
      </h2>
<p id="section-6-1">
       Any API which allows storing a value under a key and retrieving
       a value from the key can be used by an implementation for record storage.
       We assume that an implementation realizes two procedures on top of a
       storage:<a href="#section-6-1">¶</a></p>
<div id="section-6-2">
<pre>PUT(key,value)
GET(key) -&gt; value
</pre><p><a href="#section-6-2">¶</a>
</p></div>
<p id="section-6-3">
       There is no explicit delete function as the deletion of a non-expired
       record would require a revocation of the record.
       In GNS, zones can only be revoked as a whole. Records automatically
       expire and it is under the discretion of the storage as to when to delete
       the record. The GNS implementation MUST NOT publish expired resource
       records. Any GNS resolver MUST discard expired records returned from
       the storage.<a href="#section-6-3">¶</a></p>
<p id="section-6-4">
       Resource records are grouped by their respective labels,
       encrypted and published together in a single resource records block
       (RRBLOCK) in the storage under a key q: PUT(q, RRBLOCK).
       The key q is derived from the zone key and the respective
       label of the contained records.
       The required knowledge of both zone key and label in combination
       with the similarly derived symmetric secret keys and blinded zone keys
       ensure query privacy (see <span>[<a href="#RFC8324">RFC8324</a>]</span>, Section 3.5).
       The storage key derivation and records
       block creation is specified in the following sections.
       A client implementation MUST enable the user the manage zones.
       The implementation MUST use the PUT storage procedure in order to update
       the zone contents accordingly.<a href="#section-6-4">¶</a></p>
<div id="blinding">
<section id="section-6.1">
        <h3 id="name-the-storage-key">
<a href="#section-6.1">6.1. </a><a href="#name-the-storage-key">The Storage Key</a>
        </h3>
<p id="section-6.1-1">
         Given a label, the storage key q is derived as follows:<a href="#section-6.1-1">¶</a></p>
<div id="section-6.1-2">
<pre>q := SHA-512 (HDKD-Public(zk, label))
</pre><p><a href="#section-6.1-2">¶</a>
</p></div>
<span></span><dl id="section-6.1-3">
          <dt id="section-6.1-3.1">label</dt>
          <dd id="section-6.1-3.2">is a UTF-8 string under which the resource records are published.<a href="#section-6.1-3.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.1-3.3">zk</dt>
          <dd id="section-6.1-3.4">
           is the zone key.<a href="#section-6.1-3.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.1-3.5">q</dt>
          <dd id="section-6.1-3.6">
           Is the 512-bit storage key under which the resource records block is
           published.
           It is the SHA-512 hash <span>[<a href="#RFC6234">RFC6234</a>]</span> over the derived zone key.<a href="#section-6.1-3.6">¶</a>
</dd>
        <dd></dd>
</dl>
</section>
</div>
<div id="records_block">
<section id="section-6.2">
        <h3 id="name-the-records-block-rrblock">
<a href="#section-6.2">6.2. </a><a href="#name-the-records-block-rrblock">The Records Block (RRBLOCK)</a>
        </h3>
<p id="section-6.2-1">
         GNS records are grouped by their labels and published as a single
         block in the storage. The grouped record sets MAY be paired with any
         number of supplemental records. Supplemental records must have the
         supplemental flag set (See <a href="#rrecords">Section 5</a>).
         The contained resource records are encrypted using a symmetric
         encryption scheme.
         A GNS implementation must publish RRBLOCKs
         in accordance to the properties and recommendations of the underlying
         storage. This may include a periodic refresh publication.
         The GNS RRBLOCK wire format is illustrated in 
         <a href="#figure_record_block">Figure 17</a>.<a href="#section-6.2-1">¶</a></p>
<div id="figure_record_block">
<figure id="figure-17">
          <div id="section-6.2-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |    ZONE KEY           |
+-----+-----+-----+-----+       (BLINDED)       |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE          |       PURPOSE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    BDATA                      /
/                                               /
/                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a href="#figure-17">Figure 17</a></figcaption></figure>
</div>
<p id="section-6.2-3">The RRBLOCK Wire Format.<a href="#section-6.2-3">¶</a></p>
<span></span><dl id="section-6.2-4">
          <dt id="section-6.2-4.1">ZONE TYPE</dt>
          <dd id="section-6.2-4.2">
           is the 32-bit zone type.<a href="#section-6.2-4.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-4.3">ZONE KEY</dt>
          <dd id="section-6.2-4.4">
           is the blinded zone key &#34;ZKDF-Public(zk, label)&#34;
           to be used to verify SIGNATURE.<a href="#section-6.2-4.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-4.5">SIGNATURE</dt>
          <dd id="section-6.2-4.6">
           The signature is computed over the data following
           this field.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the derived private key
           &#34;ZKDF-Private(d, label)&#34; (see <a href="#zones">Section 4</a>).<a href="#section-6.2-4.6">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-4.7">SIZE</dt>
          <dd id="section-6.2-4.8">
           A 32-bit value containing the length of the signed data following the
           PUBLIC KEY field in network byte order. This value always includes the
           length of the fields SIZE (4), PURPOSE (4) and EXPIRATION (8) in
           addition to the length of the BDATA.  While a 32-bit value is used,
           implementations MAY refuse to publish blocks beyond a certain
           size significantly below 4 GB. However, a minimum block size of
           62 kilobytes MUST be supported.<a href="#section-6.2-4.8">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-4.9">PURPOSE</dt>
          <dd id="section-6.2-4.10">
           A 32-bit signature purpose flag. For a RRBLOCK the value of this
           field MUST be 15. The value is encoded in network byte order.
           The value of this field corresponds to an entry in the
           GANA &#34;GNUnet Signature Purpose&#34; registry.<a href="#section-6.2-4.10">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-4.11">EXPIRATION</dt>
          <dd id="section-6.2-4.12">
           Specifies when the RRBLOCK expires and the encrypted block
           SHOULD be removed from the storage and caches as it is likely stale.
           However, applications MAY continue to use non-expired individual
           records until they expire.  The value MUST be set to the
           expiration time of the resource record contained within this block with the
           smallest expiration time.
           If a records block includes shadow records, then the maximum
           expiration time of all shadow records with matching type and the
           expiration times of the non-shadow records is considered.
           This is a 64-bit absolute date in microseconds since midnight
           (0 hour), January 1, 1970 in network byte order.<a href="#section-6.2-4.12">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-4.13">BDATA</dt>
          <dd id="section-6.2-4.14">
           The encrypted RDATA with a total size of SIZE - 16.<a href="#section-6.2-4.14">¶</a>
</dd>
        <dd></dd>
</dl>
<p id="section-6.2-5">
         A symmetric encryption scheme is used to encrypt the resource records
         set RDATA into the BDATA field of a GNS RRBLOCK.
         The wire format of the RDATA is illustrated in 
         <a href="#figure_rdata">Figure 18</a>.<a href="#section-6.2-5">¶</a></p>
<div id="figure_rdata">
<figure id="figure-18">
          <div id="section-6.2-6.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|     RR COUNT          |        EXPIRA-        /
+-----+-----+-----+-----+-----+-----+-----+-----+
/         -TION         |       DATA SIZE       |
+-----+-----+-----+-----+-----+-----+-----+-----+
|         TYPE          |          FLAGS        |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      DATA                     /
/                                               /
/                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       DATA SIZE       |          TYPE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|           FLAGS       |        DATA           /
+-----+-----+-----+-----+                       /
/                       +-----------------------/
/                       |                       /
+-----------------------+                       /
/                     PADDING                   /
/                                               /
</pre>
</div>
<figcaption><a href="#figure-18">Figure 18</a></figcaption></figure>
</div>
<p id="section-6.2-7">The RDATA Wire Format.<a href="#section-6.2-7">¶</a></p>
<span></span><dl id="section-6.2-8">
          <dt id="section-6.2-8.1">RR COUNT</dt>
          <dd id="section-6.2-8.2">
           A 32-bit value containing the number of variable-length resource
           records which are
           following after this field in network byte order.<a href="#section-6.2-8.2">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-8.3">EXPIRATION, DATA SIZE, TYPE, FLAGS and DATA</dt>
          <dd id="section-6.2-8.4">
           These fields were defined
           in the resource record format in <a href="#rrecords">Section 5</a>.
           There MUST be a total of RR COUNT of these resource records
           present.<a href="#section-6.2-8.4">¶</a>
</dd>
          <dd></dd>
<dt id="section-6.2-8.5">PADDING</dt>
          <dd id="section-6.2-8.6">
           When publishing an RDATA block, the implementation MUST ensure that
           the size of the RDATA WITHOUT the RR COUNT field is a power of two
           using the padding field. The field MUST be set to zero and MUST be
           ignored on receipt.
           As a special exception, record sets with (only) a zone delegation
           record type are never padded.
           Note that a record set with a delegation record MUST NOT
           contain other records. If other records are encountered, the whole
           record block MUST be discarded.<a href="#section-6.2-8.6">¶</a>
</dd>
        <dd></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="resolution">
<section id="section-7">
      <h2 id="name-name-resolution">
<a href="#section-7">7. </a><a href="#name-name-resolution">Name Resolution</a>
      </h2>
<p id="section-7-1">
       Names in GNS are resolved by recursively querying the record storage.
       Recursive in this context means that a resolver does not provide
       iterative results for a query.
       
       Instead, it MUST respond to a resolution request with either the
       requested resource record or an error message in case the resolution
       fails.
       In the following, we define how resolution is initiated and each
       iteration in the resolution is processed.<a href="#section-7-1">¶</a></p>
<p id="section-7-2">
       GNS resolution of a name must start in a given starting zone indicated using
       a zone key.
       Details on how the starting zone may be determined are discussed in
       <a href="#governance">Section 7.1</a>.<a href="#section-7-2">¶</a></p>
<p id="section-7-3">
       When GNS name resolution is requested, a desired record type MAY be
       provided by the client.
       The GNS resolver will use the desired record type to guide
       processing, for example by providing conversion of GTS records to A
       or AAAA records.

       However, filtering of record sets according to the required record
       types MUST still be done by the client after the resource record set
       is retrieved.<a href="#section-7-3">¶</a></p>
<div id="governance">
<section id="section-7.1">
        <h3 id="name-root-zone">
<a href="#section-7.1">7.1. </a><a href="#name-root-zone">Root Zone</a>
        </h3>
<p id="section-7.1-1">
         The resolution of a GNS name must start in a given start zone
         indicated to the resolver using any zone key.
         The local resolver may have a local start zone configured/hard-coded
         which points to a local or remote start zone key.
         A resolver client may also determine the start zone from the
         suffix of the name given for resolution or using information
   retrieved out of band.
         The governance model of any zone is at the sole discretion
         of the zone owner.
         However, the choice of start zone(s) is at the sole
         discretion of the local system administrator or user.
         This property addresses the issue of a single hierarchy with a
         centrally controlled root and the related issue of distribution and
         management of root servers in DNS (see <span>[<a href="#RFC8324">RFC8324</a>]</span>, Section 3.10 and 3.12).<a href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">
         In the following, we give examples how a local client resolver SHOULD
         discover the start zone.  The process given is not exhaustive and
         clients MAY supplement it with other mechanisms or ignore it if the
   particular application requires a different process.<a href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">
         GNS clients MUST first try to interpret the top-level domain of
         a GNS name as a zone key representation (i.e. a zTLD).
         If the top-level domain is indicated to be a label representation of
         a zone key with a supported zone type value, the root zone of
         the resolution process is implicitly given by the suffix of the name:<a href="#section-7.1-3">¶</a></p>
<div id="section-7.1-4">
<pre>Example name: www.example.&lt;zTLD&gt;
=&gt; Root zone: zk of type ztype
=&gt; Name to resolve from root zone: www.example
</pre><p><a href="#section-7.1-4">¶</a>
</p></div>
<p id="section-7.1-5">
         In GNS, users MAY own and manage their own zones.
         Each local zone SHOULD be associated with a single GNS label,
   but users MAY choose to use longer names consisting of
   multiple labels.
         If the name of a locally managed zone matches the suffix
         of the name to be resolved, resolution MUST start from the respective local zone:<a href="#section-7.1-5">¶</a></p>
<div id="section-7.1-6">
<pre>Example name: www.example.org
Local zones:
fr = (d0,zk0)
org = (d1,zk1)
com = (d2,zk2)
...
=&gt; Root zone: zk1
=&gt; Name to resolve from root zone: www.example
</pre><p><a href="#section-7.1-6">¶</a>
</p></div>
<p id="section-7.1-7">
         Finally, additional &#34;suffix-to-zone&#34; mappings MAY be configured.
         Suffix to zone key mappings MUST be configurable through a local
         configuration file or database by the user or system administrator.
         The suffix MAY consist of multiple GNS labels concatenated with a
         &#34;.&#34;. If multiple suffixes match the name to resolve, the longest
         matching suffix MUST be used. The suffix length of two results
         MUST NOT be equal. This indicates a misconfiguration and the
         implementation MUST return an error.
         If both a locally managed zone and a configuration entry exist
         for the same suffix, the locally managed zone MUST have priority.<a href="#section-7.1-7">¶</a></p>
<div id="section-7.1-8">
<pre>Example name: www.example.org
Local suffix mappings:
org = zk0
example.org = zk1
example.com = zk2
...
=&gt; Root zone: zk1
=&gt; Name to resolve from root zone: www
</pre><p><a href="#section-7.1-8">¶</a>
</p></div>
</section>
</div>
<div id="recursion">
<section id="section-7.2">
        <h3 id="name-recursion">
<a href="#section-7.2">7.2. </a><a href="#name-recursion">Recursion</a>
        </h3>
<p id="section-7.2-1">
           In each step of the recursive name resolution, there is an
           authoritative zone zk and a name to resolve. The name may be empty.
           Initially, the authoritative zone is the start zone. If the name
           is empty, it is interpreted as the apex label &#34;@&#34;.<a href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">
           From here, the following steps are recursively executed, in order:<a href="#section-7.2-2">¶</a></p>
<ol start="1" type="1" id="section-7.2-3">
           <li id="section-7.2-3.1">Extract the right-most label from the name to look up.<a href="#section-7.2-3.1">¶</a>
</li>
          <li id="section-7.2-3.2">Calculate q using the label and zk as defined in
           <a href="#blinding">Section 6.1</a>.<a href="#section-7.2-3.2">¶</a>
</li>
          <li id="section-7.2-3.3">Perform a storage query GET(q) to retrieve the RRBLOCK.<a href="#section-7.2-3.3">¶</a>
</li>
          <li id="section-7.2-3.4">Verify and process the RRBLOCK and decrypt the BDATA contained
             in it as defined by its zone type (see also <a href="#records_block">Section 6.2</a>).<a href="#section-7.2-3.4">¶</a>
</li>
        </ol>
<p id="section-7.2-4">
           Upon receiving the RRBLOCK from the storage, apart from verifying the
           provided signature, the resolver MUST check that the authoritative
           zone key was used to sign the record:
           The derived zone key zk&#39; MUST match the public key provided in
           the RRBLOCK, otherwise the RRBLOCK MUST be ignored and the storage
           lookup GET(q) MUST continue.<a href="#section-7.2-4">¶</a></p>
</section>
</div>
<div id="record_processing">
<section id="section-7.3">
        <h3 id="name-record-processing">
<a href="#section-7.3">7.3. </a><a href="#name-record-processing">Record Processing</a>
        </h3>
<p id="section-7.3-1">
           Record processing occurs at the end of a single recursion. We assume
           that the RRBLOCK has been cryptographically verified and decrypted.
           At this point, we must first determine if we have received a valid
           record set in the context of the name we are trying to resolve:<a href="#section-7.3-1">¶</a></p>
<ul>
<li id="section-7.3-2.1">
           Case 1:
           If the remainder of the name to resolve is empty and the record set
           does not consist of a delegation, CNAME or DNS2GNS record,
           the record set is the result and the recursion is concluded.<a href="#section-7.3-2.1">¶</a>
</li>
          <li id="section-7.3-2.2">
     Case 2:
     If the name to be resolved is of the format
     &#34;_SERVICE._PROTO&#34; and the record set contains one or more matching BOX
     records, the records in the BOX records are the result and the recursion
     is concluded (<a href="#box_processing">Section 7.3.4</a>).<a href="#section-7.3-2.2">¶</a>
</li>
          <li id="section-7.3-2.3">
           Case 3:
           If the remainder of the name to resolve is not empty and
     does not match the &#34;_SERVICE._PROTO&#34; syntax, then the current record set
           MUST consist of a single delegation record (<a href="#delegation_processing">Section 7.3.1</a>),
           a single CNAME record (<a href="#cname_processing">Section 7.3.3</a>),
           or one or more GNS2DNS records (<a href="#gns2dns_processing">Section 7.3.2</a>),
           which are processed as described in the respective sections below.
           The record set may include any number of supplemental records.
           Otherwise, resolution fails
           and the resolver MUST return an empty record set.

     Finally, after the recursion terminates, the client preferences
     for the record type MUST be considered and possible conversions such as
           defined in <a href="#vpn_processing">Section 7.3.5</a> MUST be performed.<a href="#section-7.3-2.3">¶</a>
</li>
        </ul>
<div id="delegation_processing">
<section id="section-7.3.1">
          <h4 id="name-zone-delegation-records-2">
<a href="#section-7.3.1">7.3.1. </a><a href="#name-zone-delegation-records-2">Zone Delegation Records</a>
          </h4>
<p id="section-7.3.1-1">
             When the resolver encounters a record of a supported
             zone delegation record type (such as PKEY or EDKEY)
             and the remainder of
             the name is not empty, resolution continues
             recursively with the remainder of the name in the
             GNS zone specified in the delegation record.
             Implementations MUST NOT allow multiple different zone type
             delegations under a single label.
             Implementations MAY support any subset of zone types.  If
             an unsupported zone type is encountered, resolution fails and an
             error MUST be returned. The information that the zone type is
             unknown SHOULD be returned in the error description. The
             implementation MAY choose not to return the reason for the failure,
             merely impacting troubleshooting information for the user.
             Implementations MUST NOT process zone delegation for the empty
             apex label &#34;@&#34;. Upon encountering a zone delegation record under
             this label, resolution fails and an error MUST be returned. The
             implementation MAY choose not to return the reason for the failure,
             merely impacting troubleshooting information for the user.<a href="#section-7.3.1-1">¶</a></p>
<p id="section-7.3.1-2">
             If the remainder of the name to resolve is empty and we have
             received a record set containing only a single delegation record, the
             recursion is continued with the record value as authoritative zone
             and the empty apex label &#34;@&#34; as remaining name, except in the case
             where the desired record type is equal to the zone type, in which
             case the delegation record is returned and the resolution is concluded without
             resolving the empty apex label.<a href="#section-7.3.1-2">¶</a></p>
</section>
</div>
<div id="gns2dns_processing">
<section id="section-7.3.2">
          <h4 id="name-gns2dns-2">
<a href="#section-7.3.2">7.3.2. </a><a href="#name-gns2dns-2">GNS2DNS</a>
          </h4>
<p id="section-7.3.2-1">
             When a resolver encounters one or more GNS2DNS records and the remaining name
             is empty and the desired record type is GNS2DNS, the GNS2DNS
             records are returned.<a href="#section-7.3.2-1">¶</a></p>
<p id="section-7.3.2-2">
             Otherwise, it is expected that the resolver first resolves the
             IP addresses of the specified DNS name servers. GNS2DNS records MAY
             contain numeric IPv4 or IPv6 addresses, allowing the resolver to
             skip this step.
             The DNS server names may themselves be names in GNS or DNS.
             If the DNS server name ends in &#34;.+&#34;, the rest of the name is to be
             interpreted relative to the zone of the GNS2DNS record.
             If the DNS server name ends in a label representation of a
             zone key, the DNS server name is to be resolved against
             the GNS zone zk.<a href="#section-7.3.2-2">¶</a></p>
<p id="section-7.3.2-3">
             Multiple GNS2DNS records may be stored under the same label,
             in which case the resolver MUST try all of them.
             The resolver MAY try them in any order or even in parallel.
             If multiple GNS2DNS records are present, the DNS name MUST be
             identical for all of them, if not the resolution fails and an
             empty record set is returned as the record set is invalid.<a href="#section-7.3.2-3">¶</a></p>
<p id="section-7.3.2-4">
             Once the IP addresses of the DNS servers have been determined,
             the DNS name from the GNS2DNS record is appended
             to the remainder of the name to be resolved, and
             resolved by querying the DNS name server(s).  As the DNS servers
             specified are possibly authoritative DNS servers, the GNS resolver MUST
             support recursive DNS resolution and MUST NOT delegate this to the
             authoritative DNS servers.
             The first successful recursive name resolution result
             is returned to the client.
             In addition, the resolver returns the queried DNS name as a
             supplemental LEHO record (<a href="#gnsrecords_leho">Section 5.2.1</a>) with a
             relative expiration time of one hour.<a href="#section-7.3.2-4">¶</a></p>
<p id="section-7.3.2-5">
             Once the transition from GNS into DNS is made through a
             GNS2DNS record, there is no &#34;going back&#34;.
             The (possibly recursive) resolution of the DNS name MUST NOT
             delegate back into GNS and should only follow the DNS specifications.
             For example, names contained in CNAME records MUST NOT be
             interpreted as GNS names.<a href="#section-7.3.2-5">¶</a></p>
<p id="section-7.3.2-6">
       GNS resolvers MUST offer a configuration
       option to disable DNS processing to avoid information leakage
       and provide a consistent security profile for all name resolutions.
       Such resolvers would return an empty record set upon encountering
       a GNS2DNS record during the recursion. However, if GNS2DNS records
       are encountered in the record set for the apex and a GNS2DNS record
       is explicitly requested by the application, such records MUST
       still be returned, even if DNS support is disabled by the
       GNS resolver configuration.<a href="#section-7.3.2-6">¶</a></p>
</section>
</div>
<div id="cname_processing">
<section id="section-7.3.3">
          <h4 id="name-cname">
<a href="#section-7.3.3">7.3.3. </a><a href="#name-cname">CNAME</a>
          </h4>
<p id="section-7.3.3-1">
             If a CNAME record is encountered, the canonical name is
             appended to the remaining name, except if the remaining name
             is empty and the desired record type is CNAME, in which case
             the resolution concludes with the CNAME record.
             If the canonical name ends in &#34;.+&#34;,
             resolution continues in GNS with the new name in the
             current zone.  Otherwise, the resulting name is resolved via the
             default operating system name resolution process.
             This may in turn again trigger a GNS resolution process depending
             on the system configuration.<a href="#section-7.3.3-1">¶</a></p>
<p id="section-7.3.3-2">
             The recursive DNS resolution process may yield a CNAME as well
             which in turn may either point into the DNS or GNS namespace
             (if it ends in a label representation of a zone key).
             In order to prevent infinite loops, the resolver MUST
             implement loop detections or limit the number of recursive
             resolution steps.
             If the last CNAME was a DNS name, the resolver returns the DNS name
             as a supplemental LEHO record (<a href="#gnsrecords_leho">Section 5.2.1</a>)
             with a relative expiration time of one hour.<a href="#section-7.3.3-2">¶</a></p>
</section>
</div>
<div id="box_processing">
<section id="section-7.3.4">
          <h4 id="name-box-2">
<a href="#section-7.3.4">7.3.4. </a><a href="#name-box-2">BOX</a>
          </h4>
<p id="section-7.3.4-1">
             When a BOX record is received, a GNS resolver must unbox it if the
             name to be resolved continues with &#34;_SERVICE._PROTO&#34;.
             Otherwise, the BOX record is to be left untouched. This way, TLSA
             (and SRV) records do not require a separate network request, and
             TLSA records become inseparable from the corresponding address
             records.<a href="#section-7.3.4-1">¶</a></p>
</section>
</div>
<div id="vpn_processing">
<section id="section-7.3.5">
          <h4 id="name-gts-2">
<a href="#section-7.3.5">7.3.5. </a><a href="#name-gts-2">GTS</a>
          </h4>
<p id="section-7.3.5-1">
             At the end of the recursion,
             if the queried record type is either A or AAAA and the retrieved
             record set contains at least one GTS record, the resolver SHOULD
             open a tunnel and return the IPv4 or IPv6 tunnel address,
             respectively.
             If the implementation does not have the capacity to establish
             a GTS tunnel, for example because it is not connected to the GNUnet
             network, the record set MUST be returned as retrieved from the network.<a href="#section-7.3.5-1">¶</a></p>
</section>
</div>
<div id="nick_processing">
<section id="section-7.3.6">
          <h4 id="name-nick-2">
<a href="#section-7.3.6">7.3.6. </a><a href="#name-nick-2">NICK</a>
          </h4>
<p id="section-7.3.6-1">
             NICK records are only relevant to the recursive resolver
             if the record set in question is the final result which is to
             be returned to the client. The encountered NICK records may either
             be supplemental (see <a href="#rrecords">Section 5</a>) or
             non-supplemental.
             If the NICK record is supplemental, the resolver only returns the
             record set if one of the non-supplemental records matches the
             queried record type.
             It is possible that one record set contains both supplemental
             and non-supplemental NICK records.<a href="#section-7.3.6-1">¶</a></p>
<p id="section-7.3.6-2">
             The differentiation between a supplemental and non-supplemental
             NICK record allows the client to match the record to the
             authoritative zone. Consider the following example:<a href="#section-7.3.6-2">¶</a></p>
<div id="section-7.3.6-3">
<pre>Query: alice.example (type=A)
Result:
A: 192.0.2.1
NICK: eve
</pre><p><a href="#section-7.3.6-3">¶</a>
</p></div>
<p id="section-7.3.6-4">
          In this example, the returned NICK record is non-supplemental.
          For the client, this means that the NICK belongs to the zone
          &#34;alice.example&#34; and is published under the empty label along with an A
          record. The NICK record should be interpreted as: The zone defined by
          &#34;alice.example&#34; wants to be referred to as &#34;eve&#34;.
          In contrast, consider the following:<a href="#section-7.3.6-4">¶</a></p>
<div id="section-7.3.6-5">
<pre>Query: alice.example (type=AAAA)
Result:
AAAA: 2001:DB8::1
NICK: john (Supplemental)
</pre><p><a href="#section-7.3.6-5">¶</a>
</p></div>
<p id="section-7.3.6-6">
       In this case, the NICK record is marked as supplemental. This means that
       the NICK record belongs to the zone &#34;example&#34; and is published under the
       label &#34;alice&#34; along with an A record. The NICK record should be
       interpreted as: The zone defined by &#34;example&#34; wants to be referred to as
       &#34;john&#34;. This distinction is likely useful for other records published as
       supplemental.<a href="#section-7.3.6-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="encoding">
<section id="section-8">
      <h2 id="name-internationalization-and-ch">
<a href="#section-8">8. </a><a href="#name-internationalization-and-ch">Internationalization and Character Encoding</a>
      </h2>
<p id="section-8-1">
         All labels in GNS are encoded in UTF-8 <span>[<a href="#RFC3629">RFC3629</a>]</span>.
         This does not include any DNS names found in DNS records, such as CNAME
         records, which are internationalized through the IDNA specifications
         <span>[<a href="#RFC5890">RFC5890</a>]</span>.<a href="#section-8-1">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-9">9. </a><a href="#name-security-and-privacy-consid">Security and Privacy Considerations</a>
      </h2>
<div id="security_crypto">
<section id="section-9.1">
        <h3 id="name-cryptography">
<a href="#section-9.1">9.1. </a><a href="#name-cryptography">Cryptography</a>
        </h3>
<p id="section-9.1-1">
           The security of cryptographic systems depends on both the strength of
           the cryptographic algorithms chosen and the strength of the keys used
           with those algorithms.  The security also depends on the engineering
           of the protocol used by the system to ensure that there are no
           non-cryptographic ways to bypass the security of the overall system.
           This is why developers of applications managing GNS zones SHOULD
           select a default zone type considered secure at the time of
           releasing the software.
           For applications targeting end users that are not expected to
           understand cryptography, the application developer MUST NOT leave
           the zone type selection of new zones to end users.<a href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">
           This document concerns itself with the selection of cryptographic
           algorithms for use in GNS.
           The algorithms identified in this document are not known to be
           broken (in the cryptographic sense) at the current time, and
           cryptographic research so far leads us to believe that they are
           likely to remain secure into the foreseeable future.  However, this
           isn&#39;t necessarily forever, and it is expected that new revisions of
           this document will be issued from time to time to reflect the current
           best practices in this area.<a href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">
           GNS PKEY zone keys use ECDSA over Curve25519.
           This is an unconventional choice,
           as ECDSA is usually used with other curves.  However, traditional
           ECDSA curves are problematic for a range of reasons described in
           the Curve25519 and EdDSA papers.  Using EdDSA directly is also
           not possible, as a hash function is used on the private key which
           destroys the linearity that the GNU Name System depends upon.
           We are not aware of anyone suggesting that using Curve25519 instead
           of another common curve of similar size would lower the security of
           ECDSA.  GNS uses 256-bit curves because that way the encoded (public)
           keys fit into a single DNS label, which is good for usability.<a href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">
           In terms of crypto-agility, whenever the need for an updated cryptographic
           scheme arises to, for example, replace ECDSA over Curve25519 for
           PKEY records it may simply be introduced
           through a new record type. Such a new record type may then replace
           the delegation record type for future records.
           The old record type remains
           and zones can iteratively migrate to the updated zone keys.<a href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">
           In order to ensure ciphertext indistinguishability, care must be
           taken with respect to the initialization vector in the counter
           block. In our design, the IV is always the expiration time of the
           record block.
           For blocks with relative expiration times it is implicitly
           ensured that each time a block is published into the storage, its IV is
           unique as the expiration time is calculated dynamically and increases
           monotonically.
           The implementation MUST ensure that when relative expiration times
           are decreased that the expiration time of the next record block is
           always after the last published block.
           For blocks with absolute expiration times, the implementation
           MUST ensure that the expiration time is increased when the record
           data changes. For example, the expiration time may be increased
           by a single microsecond.
           In case of deletion of all resource records under a label, the
           implementation MUST keep track of the last absolute expiration time
           of the last published resource block.
           When new records are added under this label later, the implementation
           MUST ensure that the expiration times are after the last published
           block.
           Finally, in order to ensure monotonically increasing expiration times
           the implementation MUST keep a local record of the last time obtained
           from the system clock, so as to construct a monotonic clock in case
           the system clock jumps backwards.<a href="#section-9.1-5">¶</a></p>
</section>
</div>
<div id="security_abuse">
<section id="section-9.2">
        <h3 id="name-abuse-mitigation">
<a href="#section-9.2">9.2. </a><a href="#name-abuse-mitigation">Abuse Mitigation</a>
        </h3>
<p id="section-9.2-1">
           GNS names are UTF-8 strings. Consequently, GNS faces similar issues
           with respect to name spoofing as DNS does for internationalized
           domain names.
           In DNS, attackers may register similar sounding or looking
           names (see above) in order to execute phishing attacks.
           GNS zone administrators must take into account this attack vector and
           incorporate rules in order to mitigate it.<a href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">
           Further, DNS can be used to combat illegal content on the internet
           by having the respective domains seized by authorities.
           However, the same mechanisms can also be abused in order to impose
           state censorship, which is one of the motivations behind GNS.
           Hence, such a seizure is, by design, difficult to impossible in GNS.<a href="#section-9.2-2">¶</a></p>
</section>
</div>
<div id="security_keymanagement">
<section id="section-9.3">
        <h3 id="name-zone-management">
<a href="#section-9.3">9.3. </a><a href="#name-zone-management">Zone Management</a>
        </h3>
<p id="section-9.3-1">
           In GNS, zone administrators need to manage and protect their zone
           keys. Once a zone key is lost it cannot be recovered. Once it is
           compromised it cannot be revoked (unless a revocation message was
           pre-calculated and is still available).
           Zone administrators, and for GNS this includes end-users, are
           required to responsibly and diligently protect their cryptographic
           keys.
           GNS supports offline signing of records.
           It does not support separate zone signing and key-signing keys
           (as in <span>[<a href="#RFC6781">RFC6781</a>]</span>) in order to provide usable security.<a href="#section-9.3-1">¶</a></p>
<p id="section-9.3-2">
           Similarly, users are required to manage their local root zone.
           In order to ensure integrity and availability or names, users must
           ensure that their local root zone information is not compromised or
           outdated.
           It can be expected that the processing of zone revocations and an
           initial root zone is provided with a GNS client implementation
           (&#34;drop shipping&#34;).
           Extension and customization of the zone is at the full discretion of
           the user.<a href="#section-9.3-2">¶</a></p>
<p id="section-9.3-3">
           While implementations following this specification will be
           interoperable, if two implementations connect to different storages
           they are mutually unreachable.
           This may lead to a state where a record may exist in the global
           namespace for a particular name, but the implementation is not
           communicating with the storage and is hence unable to resolve it.
           This situation is similar to a split-horizon DNS configuration.
           Which storages are implemented usually depend on the application
           it is built for.
           The storage used will most likely depend on the specific application
           context using GNS resolution.
           For example, one application may be the resolution of hidden services
           within the Tor network.
           Implementations of &#34;aggregated&#34; storages are conceivable, but
           are expected to be the exception.<a href="#section-9.3-3">¶</a></p>
</section>
</div>
<div id="security_dht">
<section id="section-9.4">
        <h3 id="name-impact-of-dhts-as-underlyin">
<a href="#section-9.4">9.4. </a><a href="#name-impact-of-dhts-as-underlyin">Impact of DHTs as Underlying Storage</a>
        </h3>
<p id="section-9.4-1">
           This document does not specify the properties of the underlying
           storage which is required by any GNS implementation.
           For implementers using a DHT as underlying storage, it is important
           to note that the properties of the DHT are directly inherited by the
           GNS implementation. This includes both security as well as
           other non-functional properties such as scalability and performance.
           Implementers should take great care when selecting or implementing
           a DHT for use in a GNS implementation.
           DHTs with strong security and performance guarantees exist
           <span>[<a href="#R5N">R5N</a>]</span>.
           It should also be taken into consideration that GNS implementations
           which build upon different DHT overlays are unlikely to be
           interoperable with each other.<a href="#section-9.4-1">¶</a></p>
</section>
</div>
<div id="security_rev">
<section id="section-9.5">
        <h3 id="name-revocations">
<a href="#section-9.5">9.5. </a><a href="#name-revocations">Revocations</a>
        </h3>
<p id="section-9.5-1">
           Zone administrators are advised to pre-generate zone revocations
           and securely store the revocation information in case the zone
           key is lost, compromised or replaced in the future.
           Pre-calculated revocations may become invalid due to expirations
           or protocol changes such as epoch adjustments.
           Consequently, implementers and users must make precautions in order
           to manage revocations accordingly.<a href="#section-9.5-1">¶</a></p>
<p id="section-9.5-2">
           Revocation payloads do NOT include a &#39;new&#39; key for key replacement.
           Inclusion of such a key would have two major disadvantages:<a href="#section-9.5-2">¶</a></p>
<p id="section-9.5-3">
           If revocation is used after a private key was compromised,
           allowing key replacement would be dangerous: if an
           adversary took over the private key, the adversary could then
           broadcast a revocation with a key replacement. For the replacement,
           the compromised owner would have no chance to issue even a
           revocation. Thus, allowing a revocation message to replace a private
           key makes dealing with key compromise situations worse.<a href="#section-9.5-3">¶</a></p>
<p id="section-9.5-4">
           Sometimes, key revocations are used with the objective of changing
           cryptosystems. Migration to another cryptosystem by replacing keys
           via a revocation message would only be secure as long as both
           cryptosystems are still secure against forgery. Such a planned,
           non-emergency migration to another cryptosystem should be done by
           running zones for both ciphersystems in parallel for a while. The
           migration would conclude by revoking the legacy zone key only once
           it is deemed no longer secure, and hopefully after most users have
           migrated to the replacement.<a href="#section-9.5-4">¶</a></p>
</section>
</div>
<div id="privacy_labels">
<section id="section-9.6">
        <h3 id="name-label-guessing">
<a href="#section-9.6">9.6. </a><a href="#name-label-guessing">Label Guessing</a>
        </h3>
<p id="section-9.6-1">
           Record blocks are published encrypted using keys derived from the
           zone key and record label. Zone administrators should
           carefully consider if the label and zone key may be public or if
           those should be used and considered as a shared secret.
           Unlike zone keys, labels can also be guessed by
           an attacker in the network observing queries and responses. Given
           a known and targeted zone key, the use of well known or easily guessable
           labels effectively result in general disclosure of the records to
           the public.
           If the labels and hence the records should be kept secret except to
           those knowing a secret label and the zone in which to look, the
           label must be chosen accordingly. It is recommended to then use a
           label with sufficient entropy as to prevent guessing attacks.<a href="#section-9.6-1">¶</a></p>
<p id="section-9.6-2">
           It should be noted that this attack on labels only applies if the
           zone key is somehow disclosed to the adversary. GNS itself
           does not disclose it during a lookup or when resource records are
           published as the zone keys are blinded beforehand.<a href="#section-9.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gana">
<section id="section-10">
      <h2 id="name-gana-considerations">
<a href="#section-10">10. </a><a href="#name-gana-considerations">GANA Considerations</a>
      </h2>
<p id="section-10-1">
         GANA <span>[<a href="#GANA">GANA</a>]</span>
         is requested to create an &#34;GNU Name System Record Types&#34; registry.
         The registry shall record for each entry:<a href="#section-10-1">¶</a></p>
<ul>
<li id="section-10-2.1">Name: The name of the record type (case-insensitive ASCII
           string, restricted to alphanumeric characters. For zone delegation
       records, the assigned number represents the ztype value of the zone.<a href="#section-10-2.1">¶</a>
</li>
        <li id="section-10-2.2">Number: 32-bit, above 65535<a href="#section-10-2.2">¶</a>
</li>
        <li id="section-10-2.3">Comment: Optionally, a brief English text describing the purpose of
           the record type (in UTF-8)<a href="#section-10-2.3">¶</a>
</li>
        <li id="section-10-2.4">Contact: Optionally, the contact information of a person to contact for
           further information.<a href="#section-10-2.4">¶</a>
</li>
        <li id="section-10-2.5">References: Optionally, references describing the record type
           (such as an RFC)<a href="#section-10-2.5">¶</a>
</li>
      </ul>
<p id="section-10-3">
         The registration policy for this sub-registry is &#34;First Come First
         Served&#34;. This policy is modeled on that described in <span>[<a href="#RFC8126">RFC8126</a>]</span>,
         but describes the actions taken by GANA.<a href="#section-10-3">¶</a></p>
<p id="section-10-4">
         Adding records is possible after expert review, using a
         first-come-first-served policy for unique name allocation.
         Experts are responsible to ensure that the chosen &#34;Name&#34; is
         appropriate for the record type.
         The registry will assign a unique number for the entry.<a href="#section-10-4">¶</a></p>
<p id="section-10-5">
         The current contact(s) for expert review are reachable at
         gns-registry@gnunet.org.<a href="#section-10-5">¶</a></p>
<p id="section-10-6">
         Any request MUST contain a unique name and a point of contact.
         The contact information MAY be added to the registry given the consent
         of the requester.
         The request MAY optionally also contain relevant references as well
         as a descriptive comment as defined above.<a href="#section-10-6">¶</a></p>
<p id="section-10-7">
         GANA is requested to populate this registry as listed in 
         <a href="#figure_rrtypenums">Figure 19</a>.<a href="#section-10-7">¶</a></p>
<div id="figure_rrtypenums">
<figure id="figure-19">
        <div id="section-10-8.1">
<pre>Number | Name    | Contact | References | Comment
-------+---------+---------+------------+-------------------------
65536  | PKEY    | N/A     | [This.I-D] | GNS zone delegation (PKEY)
65537  | NICK    | N/A     | [This.I-D] | GNS zone nickname
65538  | LEHO    | N/A     | [This.I-D] | GNS legacy hostname
65539  | GTS     | N/A     | [This.I-D] | GTS tunnel metadata
65540  | GNS2DNS | N/A     | [This.I-D] | Delegation to DNS
65556  | EDKEY   | N/A     | [This.I-D] | GNS zone delegation (EDKEY)

</pre>
</div>
<figcaption><a href="#figure-19">Figure 19</a></figcaption></figure>
</div>
<p id="section-10-9">The GANA Resource Record Registry.<a href="#section-10-9">¶</a></p>
<p id="section-10-10">
         GANA is requested to amend the &#34;GNUnet Signature Purpose&#34; registry
           as illustrated in <a href="#figure_purposenums">Figure 20</a>.<a href="#section-10-10">¶</a></p>
<div id="figure_purposenums">
<figure id="figure-20">
        <div id="section-10-11.1">
<pre>Purpose | Name            | References | Comment
--------+-----------------+------------+--------------------------
  3     | GNS_REVOCATION  | [This.I-D] | GNS zone key revocation
 15     | GNS_RECORD_SIGN | [This.I-D] | GNS record set signature
</pre>
</div>
<figcaption><a href="#figure-20">Figure 20</a></figcaption></figure>
</div>
<p id="section-10-12">Requested Changes in the GANA GNUnet Signature Purpose Registry.<a href="#section-10-12">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11">11. </a><a href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-11-1">
         This document makes no requests for IANA action.
         This section may be removed on publication as an RFC.<a href="#section-11-1">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-implementation-and-deployme">
<a href="#section-12">12. </a><a href="#name-implementation-and-deployme">Implementation and Deployment Status</a>
      </h2>
<p id="section-12-1">
         There are two implementations conforming to this specification written
         in C and Go, respectively. The C implementation as part of GNUnet
         <span>[<a href="#GNUnetGNS">GNUnetGNS</a>]</span> represents the original
         and reference implementation. The Go implementation
         <span>[<a href="#GoGNS">GoGNS</a>]</span> demonstrates how two implementations of GNS are
         interoperable given that they are built on top of the same underlying
         DHT storage.<a href="#section-12-1">¶</a></p>
<p id="section-12-2">
         Currently, the GNUnet peer-to-peer network <span>[<a href="#GNUnet">GNUnet</a>]</span>
         is an active deployment of GNS on top of its <span>[<a href="#R5N">R5N</a>]</span>
         DHT. The <span>[<a href="#GoGNS">GoGNS</a>]</span> implementation uses this deployment
         by building on top of the GNUnet DHT services available on any
         GNUnet peer. It shows how GNS implementations and client resolvers
         can attach to this existing deployment and participate in name
         resolution as well as zone publication.<a href="#section-12-2">¶</a></p>
</section>
<section id="section-13">
      <h2 id="name-test-vectors">
<a href="#section-13">13. </a><a href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="section-13-1">
         The following represents a test vector for a record set with a DNS
         record of type &#34;A&#34; as well as a GNS record of type &#34;PKEY&#34;
         under the label &#34;test&#34;.<a href="#section-13-1">¶</a></p>
<div id="section-13-2">
<pre>

Zone private key (d, big-endian):
50d7b652a4efeadf
f37396909785e595
2171a02178c8e7d4
50fa907925fafd98

Zone identifier (ztype|zkey):
00010000677c477d
2d93097c85b195c6
f96d84ff61f5982c
2c4fe02d5a11fedf
b0c2901f

Encoded zone identifier (zkl = zTLD):
000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W

Label: test
RRCOUNT: 2

Record #0
EXPIRATION: 14888744139323793
DATA_SIZE: 4
TYPE: 1
FLAGS: 0
DATA:
01020304

Record #1
EXPIRATION: 26147096139323793
DATA_SIZE: 36
TYPE: 65536
FLAGS: 2
DATA:
000100000e601be4
2eb57fb4697610cf
3a3b18347b65a33f
025b5b174abefb30
807bfecf

RDATA:
000000020034e53b
e193799100000004
0000000100000000
01020304005ce4a5
394ad99100000024
0001000000000002
000100000e601be4
2eb57fb4697610cf
3a3b18347b65a33f
025b5b174abefb30
807bfef00000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000

Encryption NONCE|EXPIRATION|BLOCK COUNTER:
67ebda270034e53b
e193799100000001

Encryption key (K):
551f157acf2bf1d4
a975036999ea7c82
86acb318f1493e63
b500603a9b02e3e4
BDATA:
00e4837eb5d04f92
903de4b5234e8cca
c5736c9793379a59
c33375fc8951aca2
eb7aad067bf9af60
bf26758646a17f5e
5c3b6215f9407954
5b1c4d4f1b2ebb22
c2b4dad44126817b
6f001530d476401d
d67ac0148554e806
353da9e4298079f3
e1b16942c48d90c4
360c61238c40d9d5
2911aea52cc0037a
c7160bb3cf5b2f4a
722fd96b

RRBLOCK:
000100008e16da87
203b5159c5538e9b
765742e968c54af9
afbc0890dc80205a
d14c84e107b0c115
fc0089aa38b9c7ab
9cbe1d77040d282a
51a2ad493f61f349
5f02d8170fe473a5
5ec6bdf9a509ab17
01ffc37ea3bb4cac
4a672520986df96e
67cc1a7300000094
0000000f0034e53b
e193799100e4837e
b5d04f92903de4b5
234e8ccac5736c97
93379a59c33375fc
8951aca2eb7aad06
7bf9af60bf267586
46a17f5e5c3b6215
f94079545b1c4d4f
1b2ebb22c2b4dad4
4126817b6f001530
d476401dd67ac014
8554e806353da9e4
298079f3e1b16942
c48d90c4360c6123
8c40d9d52911aea5
2cc0037ac7160bb3
cf5b2f4a722fd96b

</pre><p><a href="#section-13-2">¶</a>
</p></div>
<p id="section-13-3">
         The following represents a test vector for a record set with a DNS
         record of type &#34;A&#34; as well as a GNS record of type &#34;EDKEY&#34;
         under the label &#34;test&#34;.<a href="#section-13-3">¶</a></p>
<div id="section-13-4">
<pre>

Zone private key (d):
31a47c48b4e2a46e
402c0bd3954711c7
bb51a6f36c463a6f
99450ba0794cf651

Zone identifier (ztype|zkey):
00010014428b3fab
5a4c875d2910d67f
1cc43c2fcad040e8
40e22f7e3dcfa53c
b964123d

Encoded zone identifier (zkl = zTLD):
000G0522HCZTPPJCGXEJJ46PFWEC8F1FSB841T20W8QQWFEFMMYBJS0J7M

Label: test
RRCOUNT: 2

Record #0
EXPIRATION: 14888744139491809
DATA_SIZE: 4
TYPE: 1
FLAGS: 0
DATA:
01020304

Record #1
EXPIRATION: 26147096139491809
DATA_SIZE: 36
TYPE: 65556
FLAGS: 2
DATA:
000100144f8860bd
c9c90388c485eed1
a2bac92ee825e448
e3fe411fc35ed61d
970d9c98

RDATA:
000000020034e53b
e19609e100000004
0000000100000000
01020304005ce4a5
394d69e100000024
0001001400000002
000100144f8860bd
c9c90388c485eed1
a2bac92ee825e448
e3fe411fc35ed61d
970d9c9800000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000

Encryption NONCE|EXPIRATION:
6ce308199d2cad48
fd960ae3bf255899
0034e53be19609e1

Encryption key (K):
57fa0223a3533cdd
6392e1f72c3edab0
f684429ae0eb6134
7e90f617363c768d

BDATA:
3fce073d7b8d092d
f4444a938cf0641d
f8dc1c505bda6c1a
6b7dfd0a31e9b150
2d180299d11f17cb
47a24464bb8c983c
5518e04a406f80eb
1f86b70dc7740669
bbb72d39b1da4570
26fadc370417919e
67cce8452985f504
e6a47f864ed3e7c8
88feda90a43da955
47d336fc70697a42
46e7e5dfc6957ece
20dd4c2041ad206f
3b5098414c3a6667
6dc0778078af272e
76522335

RRBLOCK:
000100142e74734d
1584d0f242d57eae
6462e297ffb8d8c7
35b0ebbc16f9adce
512ff443b0965dad
a47c040b2ecca35f
3ad3e2b126b6f074
872cedf2a96c06a9
4cd3d71c44e625af
a76ce81b7022fbd1
2fcc06c36ce81ea5
66d15065c9e0a9dc
4a0a400a000000a4
0000000f0034e53b
e19609e13fce073d
7b8d092df4444a93
8cf0641df8dc1c50
5bda6c1a6b7dfd0a
31e9b1502d180299
d11f17cb47a24464
bb8c983c5518e04a
406f80eb1f86b70d
c7740669bbb72d39
b1da457026fadc37
0417919e67cce845
2985f504e6a47f86
4ed3e7c888feda90
a43da95547d336fc
70697a4246e7e5df
c6957ece20dd4c20
41ad206f3b509841
4c3a66676dc07780
78af272e76522335

</pre><p><a href="#section-13-4">¶</a>
</p></div>
<p id="section-13-5">
         The following is an example revocation for a zone:<a href="#section-13-5">¶</a></p>
<div id="section-13-6">
<pre>

Zone private key (d, big-endian scalar):
6b1ee07223116bd7
dad0f22677c5dd33
823b204e5e845d19
7e64f1b66879ced0

Zone identifier (ztype|zkey):
00010000432ff523
fc9dd390ba829320
75ff7283df74cd96
204838dd0448b4f9
4a40f932

Encoded zone identifier (zkl = zTLD):
000G00235ZTJ7Z4XTE8BN0MK41TZYWM3VXTCV5H090WDT128PKWMMG7S68

Difficulty (5 base difficulty + 2 epochs): 7

Proof:
0005d657213d208c
0000395d1827c000
7fcb353aff966e2e
7fcb353aff96708a
7fcb353aff967108
7fcb353aff967152
7fcb353aff967164
7fcb353aff96718f
7fcb353aff967213
7fcb353aff9672d4
7fcb353aff9673ae
7fcb353aff9673b5
7fcb353aff967402
7fcb353aff96746e
7fcb353aff96750b
7fcb353aff967546
7fcb353aff96755f
7fcb353aff96762c
7fcb353aff967634
7fcb353aff967695
7fcb353aff9676a5
7fcb353aff9676cb
7fcb353aff9676eb
7fcb353aff9676f4
7fcb353aff96771d
7fcb353aff967755
7fcb353aff96777e
7fcb353aff9677b4
7fcb353aff9678a2
7fcb353aff967914
7fcb353aff967941
7fcb353aff967aa9
7fcb353aff967d04
7fcb353aff967d1b
00010000432ff523
fc9dd390ba829320
75ff7283df74cd96
204838dd0448b4f9
4a40f93200010000
075713bbc84bd10e
e9efe31ab81893c1
c813e0a19761c070
fd52827e3929c9b5
0a6841a44c8b37de
b9f76ffcb798c0d5
b9ae0482cdaa9095
2fb5aa5bc7a1c120

</pre><p><a href="#section-13-6">¶</a>
</p></div>
</section>
<section id="section-14">
      <h2 id="name-normative-references">
<a href="#section-14">14. </a><a href="#name-normative-references">Normative References</a>
      </h2>
<dl>
<dt id="RFC1034">[RFC1034]</dt>
      <dd>
<span>Mockapetris, P.</span>, <span>&#34;Domain names - concepts and facilities&#34;</span>, <span>STD 13</span>, <span>RFC 1034</span>, <span>DOI 10.17487/RFC1034</span>, <time datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC1035">[RFC1035]</dt>
      <dd>
<span>Mockapetris, P.</span>, <span>&#34;Domain names - implementation and specification&#34;</span>, <span>STD 13</span>, <span>RFC 1035</span>, <span>DOI 10.17487/RFC1035</span>, <time datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC2782">[RFC2782]</dt>
      <dd>
<span>Gulbrandsen, A.</span>, <span>Vixie, P.</span>, and <span>L. Esibov</span>, <span>&#34;A DNS RR for specifying the location of services (DNS SRV)&#34;</span>, <span>RFC 2782</span>, <span>DOI 10.17487/RFC2782</span>, <time datetime="2000-02">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span>Bradner, S.</span>, <span>&#34;Key words for use in RFCs to Indicate Requirement Levels&#34;</span>, <span>BCP 14</span>, <span>RFC 2119</span>, <span>DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC3629">[RFC3629]</dt>
      <dd>
<span>Yergeau, F.</span>, <span>&#34;UTF-8, a transformation format of ISO 10646&#34;</span>, <span>STD 63</span>, <span>RFC 3629</span>, <span>DOI 10.17487/RFC3629</span>, <time datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC3686">[RFC3686]</dt>
      <dd>
<span>Housley, R.</span>, <span>&#34;Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)&#34;</span>, <span>RFC 3686</span>, <span>DOI 10.17487/RFC3686</span>, <time datetime="2004-01">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC3826">[RFC3826]</dt>
      <dd>
<span>Blumenthal, U.</span>, <span>Maino, F.</span>, and <span>K. McCloghrie</span>, <span>&#34;The Advanced Encryption Standard (AES) Cipher Algorithm in the SNMP User-based Security Model&#34;</span>, <span>RFC 3826</span>, <span>DOI 10.17487/RFC3826</span>, <time datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3826">https://www.rfc-editor.org/info/rfc3826</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC5869">[RFC5869]</dt>
      <dd>
<span>Krawczyk, H.</span> and <span>P. Eronen</span>, <span>&#34;HMAC-based Extract-and-Expand Key Derivation Function (HKDF)&#34;</span>, <span>RFC 5869</span>, <span>DOI 10.17487/RFC5869</span>, <time datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC5890">[RFC5890]</dt>
      <dd>
<span>Klensin, J.</span>, <span>&#34;Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework&#34;</span>, <span>RFC 5890</span>, <span>DOI 10.17487/RFC5890</span>, <time datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC5891">[RFC5891]</dt>
      <dd>
<span>Klensin, J.</span>, <span>&#34;Internationalized Domain Names in Applications (IDNA): Protocol&#34;</span>, <span>RFC 5891</span>, <span>DOI 10.17487/RFC5891</span>, <time datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5891">https://www.rfc-editor.org/info/rfc5891</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC6234">[RFC6234]</dt>
      <dd>
<span>Eastlake 3rd, D.</span> and <span>T. Hansen</span>, <span>&#34;US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)&#34;</span>, <span>RFC 6234</span>, <span>DOI 10.17487/RFC6234</span>, <time datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC6895">[RFC6895]</dt>
      <dd>
<span>Eastlake 3rd, D.</span>, <span>&#34;Domain Name System (DNS) IANA Considerations&#34;</span>, <span>BCP 42</span>, <span>RFC 6895</span>, <span>DOI 10.17487/RFC6895</span>, <time datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6895">https://www.rfc-editor.org/info/rfc6895</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC6979">[RFC6979]</dt>
      <dd>
<span>Pornin, T.</span>, <span>&#34;Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)&#34;</span>, <span>RFC 6979</span>, <span>DOI 10.17487/RFC6979</span>, <time datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC7748">[RFC7748]</dt>
      <dd>
<span>Langley, A.</span>, <span>Hamburg, M.</span>, and <span>S. Turner</span>, <span>&#34;Elliptic Curves for Security&#34;</span>, <span>RFC 7748</span>, <span>DOI 10.17487/RFC7748</span>, <time datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC8032">[RFC8032]</dt>
      <dd>
<span>Josefsson, S.</span> and <span>I. Liusvaara</span>, <span>&#34;Edwards-Curve Digital Signature Algorithm (EdDSA)&#34;</span>, <span>RFC 8032</span>, <span>DOI 10.17487/RFC8032</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span>Cotton, M.</span>, <span>Leiba, B.</span>, and <span>T. Narten</span>, <span>&#34;Guidelines for Writing an IANA Considerations Section in RFCs&#34;</span>, <span>BCP 26</span>, <span>RFC 8126</span>, <span>DOI 10.17487/RFC8126</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span>Leiba, B.</span>, <span>&#34;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&#34;</span>, <span>BCP 14</span>, <span>RFC 8174</span>, <span>DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC8499">[RFC8499]</dt>
      <dd>
<span>Hoffman, P.</span>, <span>Sullivan, A.</span>, and <span>K. Fujiwara</span>, <span>&#34;DNS Terminology&#34;</span>, <span>BCP 219</span>, <span>RFC 8499</span>, <span>DOI 10.17487/RFC8499</span>, <time datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC9106">[RFC9106]</dt>
      <dd>
<span>Biryukov, A.</span>, <span>Dinu, D.</span>, <span>Khovratovich, D.</span>, and <span>S. Josefsson</span>, <span>&#34;Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications&#34;</span>, <span>RFC 9106</span>, <span>DOI 10.17487/RFC9106</span>, <time datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9106">https://www.rfc-editor.org/info/rfc9106</a>&gt;</span>. </dd>
<dd></dd>
<dt id="GANA">[GANA]</dt>
      <dd>
<span>GNUnet e.V.</span>, <span>&#34;GNUnet Assigned Numbers Authority (GANA)&#34;</span>, <time datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://gana.gnunet.org/">https://gana.gnunet.org/</a>&gt;</span>. </dd>
<dd></dd>
<dt id="MODES">[MODES]</dt>
      <dd>
<span>Dworkin, M.</span>, <span>&#34;Recommendation for Block Cipher Modes of Operation: Methods and Techniques&#34;</span>, <time datetime="2001-12">December 2001</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-38A">https://doi.org/10.6028/NIST.SP.800-38A</a>&gt;</span>. </dd>
<dd></dd><dt id="CrockfordB32">[CrockfordB32]</dt>
      <dd>
<span>Douglas, D.</span>, <span>&#34;Base32&#34;</span>, <time datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.crockford.com/base32.html">https://www.crockford.com/base32.html</a>&gt;</span>. </dd>
<dd></dd>
<dt id="XSalsa20">[XSalsa20]</dt>
      <dd>
<span>Bernstein, D.</span>, <span>&#34;Extending the Salsa20 nonce&#34;</span>, <time datetime="2011">2011</time>, <span>&lt;<a href="https://cr.yp.to/snuffle/xsalsa-20110204.pdf">https://cr.yp.to/snuffle/xsalsa-20110204.pdf</a>&gt;</span>. </dd>
<dd></dd>
<dt id="Unicode-UAX15">[Unicode-UAX15]</dt>
      <dd>
<span>Consortium, T. U.</span>, <span>&#34;Unicode Standard Annex #15: Unicode Normalization Forms, Revision 31&#34;</span>, <time datetime="2009-09">September 2009</time>, <span>&lt;<a href="http://www.unicode.org/reports/tr15/tr15-31.html">http://www.unicode.org/reports/tr15/tr15-31.html</a>&gt;</span>. </dd>
<dd></dd></dl>
</section>
<section id="section-15">
      <h2 id="name-informative-references">
<a href="#section-15">15. </a><a href="#name-informative-references">Informative References</a>
      </h2>
<dl>
<dt id="RFC6781">[RFC6781]</dt>
      <dd>
<span>Kolkman, O.</span>, <span>Mekking, W.</span>, and <span>R. Gieben</span>, <span>&#34;DNSSEC Operational Practices, Version 2&#34;</span>, <span>RFC 6781</span>, <span>DOI 10.17487/RFC6781</span>, <time datetime="2012-12">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6781">https://www.rfc-editor.org/info/rfc6781</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC7363">[RFC7363]</dt>
      <dd>
<span>Maenpaa, J.</span> and <span>G. Camarillo</span>, <span>&#34;Self-Tuning Distributed Hash Table (DHT) for REsource LOcation And Discovery (RELOAD)&#34;</span>, <span>RFC 7363</span>, <span>DOI 10.17487/RFC7363</span>, <time datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7363">https://www.rfc-editor.org/info/rfc7363</a>&gt;</span>. </dd>
<dd></dd>
<dt id="RFC8324">[RFC8324]</dt>
      <dd>
<span>Klensin, J.</span>, <span>&#34;DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?&#34;</span>, <span>RFC 8324</span>, <span>DOI 10.17487/RFC8324</span>, <time datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8324">https://www.rfc-editor.org/info/rfc8324</a>&gt;</span>. </dd>
<dd></dd><dt id="Tor224">[Tor224]</dt>
      <dd>
<span>Goulet, D.</span>, <span>Kadianakis, G.</span>, and <span>N. Mathewson</span>, <span>&#34;Next-Generation Hidden Services in Tor&#34;</span>, <time datetime="2013-11">November 2013</time>, <span>&lt;<a href="https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135">https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135</a>&gt;</span>. </dd>
<dd></dd>
<dt id="SDSI">[SDSI]</dt>
      <dd>
<span>Rivest, R.</span> and <span>B. Lampson</span>, <span>&#34;SDSI - A Simple Distributed Security Infrastructure&#34;</span>, <time datetime="1996-04">April 1996</time>, <span>&lt;<a href="http://people.csail.mit.edu/rivest/Sdsi10.ps">http://people.csail.mit.edu/rivest/Sdsi10.ps</a>&gt;</span>. </dd>
<dd></dd>
<dt id="Kademlia">[Kademlia]</dt>
      <dd>
<span>Maymounkov, P.</span> and <span>D. Mazieres</span>, <span>&#34;Kademlia: A peer-to-peer information system based on the xor metric.&#34;</span>, <time datetime="2002">2002</time>, <span>&lt;<a href="http://css.csail.mit.edu/6.824/2014/papers/kademlia.pdf">http://css.csail.mit.edu/6.824/2014/papers/kademlia.pdf</a>&gt;</span>. </dd>
<dd></dd><dt id="ed25519">[ed25519]</dt>
      <dd>
<span>Bernstein, D.</span>, <span>Duif, N.</span>, <span>Lange, T.</span>, <span>Schwabe, P.</span>, and <span>B. Yang</span>, <span>&#34;High-Speed High-Security Signatures&#34;</span>, <time datetime="2011">2011</time>, <span>&lt;<a href="http://link.springer.com/chapter/10.1007/978-3-642-23951-9_9">http://link.springer.com/chapter/10.1007/978-3-642-23951-9_9</a>&gt;</span>. </dd>
<dd></dd>
<dt id="GNS">[GNS]</dt>
      <dd>
<span>Wachs, M.</span>, <span>Schanzenbach, M.</span>, and <span>C. Grothoff</span>, <span>&#34;A Censorship-Resistant, Privacy-Enhancing and Fully Decentralized Name System&#34;</span>, <time datetime="2014">2014</time>, <span>&lt;<a href="https://sci-hub.st/10.1007/978-3-319-12280-9_9">https://sci-hub.st/10.1007/978-3-319-12280-9_9</a>&gt;</span>. </dd>
<dd></dd>
<dt id="R5N">[R5N]</dt>
      <dd>
<span>Evans, N. S.</span> and <span>C. Grothoff</span>, <span>&#34;R5N: Randomized recursive routing for restricted-route networks&#34;</span>, <time datetime="2011">2011</time>, <span>&lt;<a href="https://sci-hub.st/10.1109/ICNSS.2011.6060022">https://sci-hub.st/10.1109/ICNSS.2011.6060022</a>&gt;</span>. </dd>
<dd></dd>
<dt id="SecureNS">[SecureNS]</dt>
      <dd>
<span>Grothoff, C.</span>, <span>Wachs, M.</span>, <span>Ermert, M.</span>, and <span>J. Appelbaum</span>, <span>&#34;Towards secure name resolution on the Internet&#34;</span>, <time datetime="2018">2018</time>, <span>&lt;<a href="https://sci-hub.st/https://doi.org/10.1016/j.cose.2018.01.018">https://sci-hub.st/https://doi.org/10.1016/j.cose.2018.01.018</a>&gt;</span>. </dd>
<dd></dd>
<dt id="GNUnetGNS">[GNUnetGNS]</dt>
      <dd>
<span>GNUnet e.V.</span>, <span>&#34;The GNUnet GNS Implementation&#34;</span>, <span>&lt;<a href="https://git.gnunet.org/gnunet.git/tree/src/gns">https://git.gnunet.org/gnunet.git/tree/src/gns</a>&gt;</span>. </dd>
<dd></dd>
<dt id="GNUnet">[GNUnet]</dt>
      <dd>
<span>GNUnet e.V.</span>, <span>&#34;The GNUnet Project&#34;</span>, <span>&lt;<a href="https://gnunet.org">https://gnunet.org</a>&gt;</span>. </dd>
<dd></dd>
<dt id="GoGNS">[GoGNS]</dt>
    <dd>
<span>Fix, B.</span>, <span>&#34;The Go GNS Implementation&#34;</span>, <span>&lt;<a href="https://github.com/bfix/gnunet-go/tree/master/src/gnunet/service/gns">https://github.com/bfix/gnunet-go/tree/master/src/gnunet/service/gns</a>&gt;</span>. </dd>
<dd></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses">Authors&#39; Addresses</a>
      </h2>
<address>
        <p><span>Martin Schanzenbach</span></p>
<p><span>GNUnet e.V.</span></p>
<p><span>Boltzmannstrasse 3</span></p>
<p><span>85748</span> <span>Garching</span>
</p>
<p><span>Germany</span></p>
<div>
<p><span>Email:</span>
<a href="mailto:schanzen@gnunet.org">schanzen@gnunet.org</a>
</p></div>
</address>
<address>
        <p><span>Christian Grothoff</span></p>
<p><span>Berner Fachhochschule</span></p>
<p><span>Hoeheweg 80</span></p>
<p>CH-<span>2501</span> <span>Biel/Bienne</span>
</p>
<p><span>Switzerland</span></p>
<div>
<p><span>Email:</span>
<a href="mailto:grothoff@gnunet.org">grothoff@gnunet.org</a>
</p></div>
</address>
<address>
        <p><span>Bernd Fix</span></p>
<p><span>GNUnet e.V.</span></p>
<p><span>Boltzmannstrasse 3</span></p>
<p><span>85748</span> <span>Garching</span>
</p>
<p><span>Germany</span></p>
<div>
<p><span>Email:</span>
<a href="mailto:fix@gnunet.org">fix@gnunet.org</a>
</p></div>
</address>
</section>
</div>



</div>
  </body>
</html>
