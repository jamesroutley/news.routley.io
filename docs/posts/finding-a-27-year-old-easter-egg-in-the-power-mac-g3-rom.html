<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.downtowndougbrown.com/2025/06/finding-a-27-year-old-easter-egg-in-the-power-mac-g3-rom/">Original</a>
    <h1>Finding a 27-year-old easter egg in the Power Mac G3 ROM</h1>
    
    <div id="readability-page-1" class="page"><div>
				
<p>I was recently poking around inside the original Power Macintosh G3’s ROM and accidentally discovered an easter egg that nobody has documented until now.</p>



<p>This story starts with me on a lazy Sunday using <a href="https://hexfiend.com/" target="_blank" rel="noreferrer noopener">Hex Fiend</a> in conjunction with <a href="https://github.com/eharmon/rom_fiend" target="_blank" rel="noreferrer noopener">Eric Harmon’s Mac ROM template (ROM Fiend)</a> to look through the resources stored in the Power Mac G3’s ROM. This ROM was used in the beige desktop, minitower, and all-in-one G3 models from 1997 through 1999.</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-12.png" target="_blank" rel=" noreferrer noopener"><img fetchpriority="high" decoding="async" width="487" height="466" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-12.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-12.png 487w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-12-300x287.png 300w" sizes="(max-width: 487px) 100vw, 487px"/></a></figure>



<p>As I write this post in mid-2025, I’m having a really difficult time accepting the fact that the Power Mac G3 is now over 27 years old. Wow!</p>



<p>While I was browsing through the ROM, two things caught my eye:</p>



<p>First, there was a resource of type <code>HPOE</code> which contained a JPEG image of a bunch of people, presumably people who worked on these Mac models.</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/G3Picture.jpg" target="_blank" rel=" noreferrer noopener"><img decoding="async" width="640" height="480" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/G3Picture.jpg" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/G3Picture.jpg 640w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/G3Picture-300x225.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"/></a></figure>



<p>This wasn’t anything new; <a href="https://www.journaldulapin.com/2014/08/19/easter-egg-les-images-cachees-dans-les-roms/" target="_blank" rel="noreferrer noopener">Pierre Dandumont wrote about it back in 2014</a>. However, in his post, he mentioned that he hadn’t figured out how to display this particular hidden image on the actual machine. Several older Macs have secret keypress combinations to show similar pictures, but the mechanism for displaying this one was a complete mystery.</p>



<p>The second thing I found was a big clue: I kept looking for other interesting information in the ROM, and eventually I stumbled upon <code>nitt</code> resource ID 43, named “Native 4.3”. Thanks to <a href="https://blitter.net/blog/2021/02/09/pippin-kickstart-1-1/" target="_blank" rel="noreferrer noopener">Keith Kaisershot’s earlier Pippin research</a>, I was quickly able to conclude that this was the PowerPC-native SCSI Manager 4.3 code. The SCSI Manager wasn’t what piqued my interest about this resource though. At the very end of the data, I found some interesting Pascal strings:</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-1.png" target="_blank" rel=" noreferrer noopener"><img decoding="async" width="460" height="104" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-1.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-1.png 460w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-1-300x68.png 300w" sizes="(max-width: 460px) 100vw, 460px"/></a></figure>



<p>These strings were definitely intriguing:</p>



<ul>
<li>.Edisk</li>



<li>secret ROM image</li>



<li>The Team</li>
</ul>



<p>The “secret ROM image” text in particular seemed like it could be related to the picture shown above. I decided to dive deeper to see if I could figure out why the SCSI Manager contained these strings, in the hopes that I could solve the mystery. Would this be the clue I needed in order to figure out how to instruct the Power Mac G3 to display this picture?</p>



<p>Some quick Internet searching for the phrase “secret ROM image” revealed that <a href="https://www.mackido.com/EasterEggs/HW-PCIROM.html" target="_blank" rel="noreferrer noopener">it had been used for easter eggs with earlier PowerPC Macs</a>. On those machines, you just had to type the text, select it, and drag it to the desktop. Then, the picture would appear. That approach didn’t work on the G3.</p>



<p>I suspected there was some similar way to access this hidden image, but nobody had documented it, at least not as far as I could find. So I had no choice but to disassemble the code and see where this text was used. What is it with me and all these crazy rabbit holes?</p>



<p>I extracted the entire <code>nitt</code> resource ID 43 to a file and inspected it:</p>



<pre>$ file nitt43</pre>



<p>That wasn’t too surprising, considering that the first twelve bytes were “Joy!peffpwpc”. I fed this entire file into <a href="https://github.com/NationalSecurityAgency/ghidra" target="_blank" rel="noreferrer noopener">Ghidra</a>, which immediately recognized it as a PEF file and had no trouble loading it. Although I’m pretty familiar with reading x86 and ARM assembly, I know essentially nothing about PowerPC assembly code. Thankfully, Ghidra’s decompiler worked very well with this file.</p>



<p>There was one problem, though: it didn’t detect any references to the “secret ROM image” string, other than inside of a huge list of pointers to variables. After scratching my head a little bit, I realized that Ghidra wasn’t doing a great job of finding references to several variables. Luckily, running Auto Analyze a second time after the initial analysis seemed to help it find several more references to things, including all of the strings I was interested in! I didn’t change any options with the analyzer; it just found more stuff on the second run.</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-2.png" target="_blank" rel=" noreferrer noopener"><img loading="lazy" decoding="async" width="765" height="317" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-2.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-2.png 765w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-2-300x124.png 300w" sizes="auto, (max-width: 765px) 100vw, 765px"/></a></figure>



<p>The function that used all of these strings was definitely doing something with the .EDisk driver, which I already knew was the RAM disk driver because of past hackery. It seemed to be using <code>strncmp()</code> to see if a string was equal to “secret ROM image”, and if so, it would create/open/write a file named “The Team”.</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-3.png" target="_blank" rel=" noreferrer noopener"><img loading="lazy" decoding="async" width="704" height="816" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-3.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-3.png 704w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-3-259x300.png 259w" sizes="auto, (max-width: 704px) 100vw, 704px"/></a></figure>



<p>I cleaned up this decompilation quite a bit by giving names to variables and figuring out data types. Fortunately, a lot of the functions like <code>PBGetVInfoSync()</code> had lots of public documentation, so I just had to tell Ghidra about the various Mac Toolbox structs being used.</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-4.png" target="_blank" rel=" noreferrer noopener"><img loading="lazy" decoding="async" width="661" height="831" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-4.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-4.png 661w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-4-239x300.png 239w" sizes="auto, (max-width: 661px) 100vw, 661px"/></a></figure>



<p>Okay, that’s a lot easier to understand!</p>



<p>I couldn’t figure out how to format the 32-bit function arguments such as 0x48504f45 into four-letter codes like <code>HPOE</code>, so that’s what the comments are. Ghidra simply wouldn’t let me display them as ASCII in the decompilation no matter what I did, even though hovering over the constant showed a tooltip with the equivalent text. This is easy to do in IDA, but I couldn’t figure out how to convince Ghidra to do it. I tried Set Equate, but it didn’t change anything. If someone knows how to make it work, I’d love to hear how!</p>



<p>Anyway, the decompiled code shown above makes sense, and here’s a summary of what it does:</p>



<ul>
<li>It looks for a driver called .Edisk. (The driver is really named .EDisk, but I guess Mac OS doesn’t care about case sensitivity for this.)</li>



<li>It finds a disk associated with that driver (the RAM disk).</li>



<li>It looks for a volume associated with that disk.</li>



<li>If the volume is named “secret ROM image”:
<ul>
<li>It loads <code>HPOE</code> resource ID 1, which contains the JPEG image data.</li>



<li>It creates a file of creator <code>ttxt</code> and type <code>JPEG</code> called “The Team”.</li>



<li>It opens the file, writes the JPEG data to it, and closes it.</li>



<li>Then it does something with the driver control entry that I didn’t bother trying to understand further.</li>
</ul>
</li>
</ul>



<p>Okay, interesting! So this code was clearly looking for the RAM disk to be named “secret ROM image”, but I wasn’t sure exactly how to trigger it. This function was only ever called in one other place: another function, which was checking to see if its first argument was equal to the value 0x3DA (decimal 986).</p>



<p>I didn’t have my beige G3 handy for tinkering, so instead, I mentioned what I had discovered in #mac68k on Libera. <a href="https://infosec.exchange/@atax1a/114729277160021527" target="_blank" rel="noreferrer noopener">^alex came to the rescue</a> after playing around in Infinite Mac with the hints I had given. They quickly figured out that the trick was to format the RAM disk, and type the special text into the format dialog:</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-5.png" target="_blank" rel=" noreferrer noopener"><img loading="lazy" decoding="async" width="640" height="480" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-5.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-5.png 640w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-5-300x225.png 300w" sizes="auto, (max-width: 640px) 100vw, 640px"/></a></figure>



<p>I got out my desktop G3, tested it out on real hardware, and sure enough, it worked! If you want to try it for yourself just like ^alex did, you can <a href="https://infinitemac.org/1998/Mac%20OS%208.1?infinite_hd=false&amp;saved_hd=false&amp;machine=Power+Macintosh+G3+%28Beige%29" target="_blank" rel="noreferrer noopener">run Infinite Mac in your browser using this link, which sets up an emulated beige G3 running Mac OS 8.1</a> using DingusPPC. There’s a quirk that causes it to fail to resolve an alias at startup. I intentionally disabled it; just click Stop when the error pops up. Here are instructions:</p>



<ul>
<li>Enable the RAM Disk in the Memory control panel.</li>



<li>Choose Restart from the Special menu.</li>



<li>After the desktop comes back up, select the RAM Disk icon.</li>



<li>Choose Erase Disk from the Special menu.</li>



<li>Type the <em>secret ROM image</em> text exactly as depicted above.</li>



<li>Click Erase.</li>
</ul>



<p>When you open the newly-formatted RAM disk, you should see a file named “The Team”:</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-6.png" target="_blank" rel=" noreferrer noopener"><img loading="lazy" decoding="async" width="640" height="480" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-6.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-6.png 640w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-6-300x225.png 300w" sizes="auto, (max-width: 640px) 100vw, 640px"/></a></figure>



<p>If you double-click the file, SimpleText will open it:</p>



<figure><a href="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-8.png" target="_blank" rel=" noreferrer noopener"><img loading="lazy" decoding="async" width="640" height="480" src="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-8.png" alt="" srcset="https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-8.png 640w, https://www.downtowndougbrown.com/wp-content/uploads/2025/06/image-8-300x225.png 300w" sizes="auto, (max-width: 640px) 100vw, 640px"/></a></figure>



<p>Based on various people’s tests, including my own, it sounds like <a href="https://bsky.app/profile/eaglebtc.bsky.social/post/3lsaz3jqsds2w" target="_blank" rel="noreferrer noopener">this trick works all the way up through Mac OS 9.0.4</a>, but 9.1 may have been the first version where it finally stopped working.</p>



<p>As far as I have been able to determine, this particular secret was undiscovered until now. People definitely knew the image was there in the ROM, but nobody had figured out how to actually activate it. This is probably one of the last easter eggs that existed in the Mac prior to <a href="https://gizmodo.com/the-easter-eggs-are-back-in-os-x-and-this-one-is-insane-5929286" target="_blank" rel="noreferrer noopener">Steve Jobs reportedly banning them in 1997 when he returned to Apple</a>. I wonder if he ever knew about this one?</p>



<p>Special thanks to ^alex for figuring out that the RAM Disk needed to be erased in order to activate the easter egg! I’m not sure I would have thought to try that, and it would have taken a lot more work to trace through the rest of the code to figure it out.</p>



<p>If you are reading this post and you were on “The Team”, I’d love to hear about it! I’m curious if anyone who worked at Apple in the era remembers this little secret.</p>
			  
			</div></div>
  </body>
</html>
