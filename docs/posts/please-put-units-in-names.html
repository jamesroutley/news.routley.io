<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ruudvanasseldonk.com/2022/03/20/please-put-units-in-names">Original</a>
    <h1>Please put units in names</h1>
    
    <div id="readability-page-1" class="page"><article id="content" itemscope=""><header><h2>or use strong types</h2><p>written by </p></header><p><span>There is one</span> code readability trap that is easy to avoid once you are aware of it, yet the trap is pervasive: omitting units. Consider the following three snippets in Python, Java, and Haskell:</p><p>How long do these programs sleep for? The Python program sleeps for five minutes, the Java program sleeps for 0.3 seconds, and the Haskell program sleeps for 0.3 milliseconds.</p><p>How can you tell this from the code? You can’t. You just have to know by heart that <code>time.sleep</code> takes seconds, while <code>threadDelay</code> takes microseconds. If you look it up often enough, eventually that knowledge will stick, but how can we keep the code readable even for people who haven’t encountered <code>time.sleep</code> before?</p><h2 id="option-1-put-the-unit-in-the-name"><a href="#option-1-put-the-unit-in-the-name"></a>Option 1: put the unit in the name</h2><p>Instead of this:</p><div id="cb4"><pre><code><span id="cb4-1"><span>def</span> frobnicate(timeout: <span>int</span>) <span>-&gt;</span> <span>None</span>:</span>
<span id="cb4-2">    ...</span>
<span id="cb4-3"></span>
<span id="cb4-4">frobnicate(<span>300</span>)</span></code></pre></div><p>Do this:</p><div id="cb5"><pre><code><span id="cb5-1"><span>def</span> frobnicate(<span>*</span>, timeout_seconds: <span>int</span>) <span>-&gt;</span> <span>None</span>:</span>
<span id="cb5-2">    <span># The * forces the caller to use named arguments</span></span>
<span id="cb5-3">    <span># for all arguments after the *.</span></span>
<span id="cb5-4">    ...</span>
<span id="cb5-5"></span>
<span id="cb5-6">frobnicate(timeout_seconds<span>=</span><span>300</span>)</span></code></pre></div><p>In the first case, we can’t even tell at the call site that 300 is a timeout, but even if we knew that, it’s a timeout of 300 what? Milliseconds? Seconds? Martian days? In contrast, the second call site is completely self-explanatory.</p><p>Using named arguments is nice for languages that support it, but this is not always a possibility. Even in Python, where <code>time.sleep</code> is defined with a single argument named <code>secs</code>, we can’t call <code>sleep(secs=300)</code> due to implementation reasons. In that case, we can give the value a name instead.</p><p>Instead of this:</p><p>Do this:</p><div id="cb7"><pre><code><span id="cb7-1">sleep_seconds <span>=</span> <span>300</span></span>
<span id="cb7-2">time.sleep(sleep_seconds)</span></code></pre></div><p>Now the code is unambiguous, and readable without having to consult the documentation.</p><h2 id="option-2-use-strong-types"><a href="#option-2-use-strong-types"></a>Option 2: use strong types</h2><p>An alternative to putting the unit in the name, is to use stronger types than integers or floats. For example, we might use a duration type.</p><p>Instead of this:</p><div id="cb8"><pre><code><span id="cb8-1"><span>def</span> frobnicate(timeout: <span>int</span>) <span>-&gt;</span> <span>None</span>:</span>
<span id="cb8-2">    ...</span>
<span id="cb8-3"></span>
<span id="cb8-4">frobnicate(<span>300</span>)</span></code></pre></div><p>Do this:</p><div id="cb9"><pre><code><span id="cb9-1"><span>def</span> frobnicate(timeout: timedelta) <span>-&gt;</span> <span>None</span>:</span>
<span id="cb9-2">    ...</span>
<span id="cb9-3"></span>
<span id="cb9-4">timeout <span>=</span> timedelta(seconds<span>=</span><span>300</span>)</span>
<span id="cb9-5">frobnicate(timeout)</span></code></pre></div><p>For a given floating-point number, you need to be told out of band what the unit is to be able to interpret it. If you are lucky this information is in the variable or argument name, but if you are unlucky it’s only specified in the documentation — or not specified at all. But for a <code>timedelta</code> value, there is no ambiguity about how to interpret it, this is part of the type. This also removes the ambiguity from the code.</p><h2 id="scope"><a href="#scope"></a>Scope</h2><p>The advice to use strong types or to put units in names is not limited to variables and function arguments, it’s applicable to <abbr><abbr>API</abbr></abbr> s, <a href="https://prometheus.io/docs/practices/naming/#metric-names">metric names</a>, serialization formats, configuration files, command-line flags, etc. And although duration values are the most common case, this advice is not limited to those either, it also applies to monetary amounts, lengths, data sizes, etc.</p><p>For example, don’t return this:</p><div id="cb10"><pre><code><span id="cb10-1"><span>{</span></span>
<span id="cb10-2">   <span>&#34;error_code&#34;</span><span>:</span> <span>&#34;E429&#34;</span><span>,</span></span>
<span id="cb10-3">   <span>&#34;error_message&#34;</span><span>:</span> <span>&#34;Rate limit exceeded&#34;</span><span>,</span></span>
<span id="cb10-4">   <span>&#34;retry_after&#34;</span><span>:</span> <span>100</span><span>,</span></span>
<span id="cb10-5"><span>}</span></span></code></pre></div><p>Return this instead:</p><div id="cb11"><pre><code><span id="cb11-1"><span>{</span></span>
<span id="cb11-2">   <span>&#34;error_code&#34;</span><span>:</span> <span>&#34;E429&#34;</span><span>,</span></span>
<span id="cb11-3">   <span>&#34;error_message&#34;</span><span>:</span> <span>&#34;Rate limit exceeded&#34;</span><span>,</span></span>
<span id="cb11-4">   <span>&#34;retry_after_seconds&#34;</span><span>:</span> <span>100</span><span>,</span></span>
<span id="cb11-5"><span>}</span></span></code></pre></div><p>Don’t design your config file like this:</p><pre><code>request_timeout = 10</code></pre><p>Accept one of these instead:</p><pre><code>request_timeout = 10s
request_timeout_seconds = 10</code></pre><p>And don’t design your <abbr>CLI</abbr> accounting app like this:</p><pre><code>show-transactions --minimum-amount 32</code></pre><p>Accept one of these instead:</p><pre><code>show-transactions --minimum-amount-eur 32
show-transactions --minimum-amount &#34;32 EUR&#34;</code></pre></article></div>
  </body>
</html>
