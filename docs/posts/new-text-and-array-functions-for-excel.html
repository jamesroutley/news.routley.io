<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://techcommunity.microsoft.com/t5/excel-blog/announcing-new-text-and-array-functions/ba-p/3186066">Original</a>
    <h1>New Text and Array Functions for Excel</h1>
    
    <div id="readability-page-1" class="page"><div>
		<div itemprop="text" id="bodyDisplay">
	
		<div>
			
				
					
					
						<p><strong>August 17th 2022 Update</strong></p>

<p><span data-contrast="none">I’m thrilled to share with you the availability of 14 new Excel functions designed to help you more easily manipulate text and arrays in your worksheets.</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559739&#34;:160,&#34;335559740&#34;:240}"> </span></p>

<h2 id="toc-hId-366108084">Text Manipulation Functions</h2>
<p><span data-contrast="none">When working with text, a common task to complete is “break apart” text strings using a delimiter. You can already do this with combinations of SEARCH, FIND, LEFT, RIGHT, MID, SUBSTITUTE, and SEQUENCE, but we’ve heard from many of you that these can be challenging to use.</span></p>

<p><span data-contrast="none">To make it easier to extract the text from the start or end of a cell’s contents, we are releasing two functions that simply return everything before or after your selected delimiter. Welcome, TEXTBEFORE and TEXTAFTER!</span></p>

<p><span data-contrast="none">We’ve also made it easy to “split” text into multiple segments using TEXTSPLIT. Each text segment is then automatically spilled into its own cell through the magic of dynamic arrays.<span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></span></p>

<p><span image-alt="Text 1.gif"><img src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356029i8F1E90237F9993B4/image-size/large?v=v2&amp;px=999" role="button" title="Text 1.gif" alt="Text 1.gif" li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356029i8F1E90237F9993B4?v=v2" li-image-display-id="&#39;356029i8F1E90237F9993B4&#39;" li-message-uid="&#39;3186066&#39;" li-messages-message-image="true" li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true" li-use-hover-links="false"/></span></p>

<p>• <a href="https://support.microsoft.com/en-us/office/textbefore-function-d099c28a-dba8-448e-ac6c-f086d0fa1b29" target="_self" rel="noopener noreferrer">TEXTBEFORE </a>- Returns text that’s before delimiting characters</p>
<p>• <a href="https://support.microsoft.com/en-us/office/textafter-function-c8db2546-5b51-416a-9690-c7e6722e90b4" target="_self" rel="noopener noreferrer">TEXTAFTER</a> - Returns text that’s after delimiting characters</p>
<p>• <a href="https://support.microsoft.com/en-us/office/textsplit-function-b1ca414e-4c21-4ca0-b1b7-bdecace8a6e7" target="_self" rel="noopener noreferrer">TEXTSPLIT</a> - Splits text into rows or columns using delimiters</p>
<h2 id="toc-hId--1441346379">Array Manipulation Functions</h2>
<p><span data-contrast="none">Since the release of dynamic arrays in 2019, we’ve seen a large increase in the usage of array formulas. To make it easier to build compelling spreadsheets using dynamic arrays, we are releasing a collection of 11 new array manipulation functions. </span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></p>

<h3 id="toc-hId--750784905"><strong>Combining Arrays</strong></h3>
<p><span data-contrast="none">It can be challenging to combine data, especially when their sources are flexible in size. With VSTACK and HSTACK, you can easily combine dynamic arrays, stacking your data vertically or horizontally. </span></p>

<p><span image-alt="Combining 2.gif"><img src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356030iA12199D1E662C9A4/image-size/large?v=v2&amp;px=999" role="button" title="Combining 2.gif" alt="Combining 2.gif" li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356030iA12199D1E662C9A4?v=v2" li-image-display-id="&#39;356030iA12199D1E662C9A4&#39;" li-message-uid="&#39;3186066&#39;" li-messages-message-image="true" li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true" li-use-hover-links="false"/></span></p>

<ul>
<li><a href="https://support.microsoft.com/en-us/office/vstack-function-a4b86897-be0f-48fc-adca-fcc10d795a9c" target="_self" rel="noopener noreferrer">VSTACK</a> - Stacks arrays vertically</li>
<li><a href="https://support.microsoft.com/en-us/office/hstack-function-98c4ab76-10fe-4b4f-8d5f-af1c125fe8c2" target="_self" rel="noopener noreferrer">HSTACK</a>- Stacks arrays horizontally</li>
</ul>

<h3 id="toc-hId-1736727928"><strong>Shaping Arrays</strong></h3>
<p><span data-contrast="none">It has been challenging to change the “shape” of data in Excel, especially from arrays to lists and vice versa. </span><span data-contrast="auto">If you find yourself with a two-dimensional array that you would like to convert to a simple list, use TOROW and TOCOL to convert a 2D array into a single row or column of data.</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></p>

<p><span data-contrast="auto">Using the WRAPROWS and WRAPCOLS functions, do the opposite: create a 2D array of a specified width or height by “wrapping” data to the next line (just like the text in this document) once your chosen width/height limit is reached. </span></p>

<p><span image-alt="Shaping Short 2.gif"><img src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356032iAE5BCE0E5B439DDF/image-size/large?v=v2&amp;px=999" role="button" title="Shaping Short 2.gif" alt="Shaping Short 2.gif" li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356032iAE5BCE0E5B439DDF?v=v2" li-image-display-id="&#39;356032iAE5BCE0E5B439DDF&#39;" li-message-uid="&#39;3186066&#39;" li-messages-message-image="true" li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true" li-use-hover-links="false"/></span></p>


<ul>
<li><a href="https://support.microsoft.com/en-us/office/torow-function-b90d0964-a7d9-44b7-816b-ffa5c2fe2289" target="_self" rel="noopener noreferrer">TOROW</a> - Returns the array as one row</li>
<li><a href="https://support.microsoft.com/en-us/office/tocol-function-22839d9b-0b55-4fc1-b4e6-2761f8f122ed" target="_self" rel="noopener noreferrer">TOCOL</a> - Returns the array as one column</li>
<li><a href="https://support.microsoft.com/en-us/office/wraprows-function-796825f3-975a-4cee-9c84-1bbddf60ade0" target="_self" rel="noopener noreferrer">WRAPROWS</a> - Wraps a row array into a 2D array</li>
<li><a href="https://support.microsoft.com/en-us/office/wrapcols-function-d038b05a-57b7-4ee0-be94-ded0792511e2" target="_self" rel="noopener noreferrer">WRAPCOLS</a> - Wraps a column array into a 2D array</li>
</ul>

<h3 id="toc-hId--70726535"><strong>Resizing Arrays</strong></h3>
<p><span data-contrast="none">Arrays too large? No problem. Enter the TAKE and DROP functions! They enable you to reduce your arrays by specifying the number of rows to keep or remove from the start or end of your array.</span></p>

<p><span data-contrast="none">Similarly, using CHOOSEROWS or CHOOSECOLS, you can pick specific rows or columns out of an array by their index.</span></p>

<p><span data-contrast="none">EXPAND allows you to grow an array to the size of your choice—you just need to provide the new dimensions and a value to fill the extra space with. </span></p>

<p><span image-alt="Resizing Short 1.gif"><img src="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356033iE26DBE476DCCC5E4/image-size/large?v=v2&amp;px=999" role="button" title="Resizing Short 1.gif" alt="Resizing Short 1.gif" li-image-url="https://techcommunity.microsoft.com/t5/image/serverpage/image-id/356033iE26DBE476DCCC5E4?v=v2" li-image-display-id="&#39;356033iE26DBE476DCCC5E4&#39;" li-message-uid="&#39;3186066&#39;" li-messages-message-image="true" li-bindable="" tabindex="0" li-bypass-lightbox-when-linked="true" li-use-hover-links="false"/></span></p>


<ul>
<li><a href="https://support.microsoft.com/en-us/office/take-function-25382ff1-5da1-4f78-ab43-f33bd2e4e003" target="_self" rel="noopener noreferrer">TAKE</a> - Returns rows or columns from array start or end</li>
<li><a href="https://support.microsoft.com/en-us/office/drop-function-1cb4e151-9e17-4838-abe5-9ba48d8c6a34" target="_self" rel="noopener noreferrer">DROP</a> - Drops rows or columns from array start or end</li>
<li><a href="https://support.microsoft.com/en-us/office/chooserows-function-51ace882-9bab-4a44-9625-7274ef7507a3" target="_self" rel="noopener noreferrer">CHOOSEROWS</a> - Returns the specified rows from an array</li>
<li><a href="https://support.microsoft.com/en-us/office/choosecols-function-bf117976-2722-4466-9b9a-1c01ed9aebff" target="_blank" rel="noopener noreferrer">CHOOSECOLS</a> - Returns the specified columns from an array</li>
<li><a href="https://support.microsoft.com/en-us/office/expand-function-7433fba5-4ad1-41da-a904-d5d95808bc38" target="_self" rel="noopener noreferrer">EXPAND</a> - Expands an array to the specified dimensions</li>
</ul>

<h3 id="toc-hId-609331835"><strong>Scenarios to try</strong></h3>
<ul>
<li data-leveltext="" data-font="Symbol" data-listid="39" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1"><span data-contrast="none">Use “ “ (space) as a delimiter with TEXTBEFORE to extract the first name and TEXTAFTER to extract the last name</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></li>
<li data-leveltext="" data-font="Symbol" data-listid="39" aria-setsize="-1" data-aria-posinset="2" data-aria-level="1"><span data-contrast="none">Use TEXTSPLIT to separate the names into an array with “ “ (space) as a delimiter</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></li>
</ul>

<p><span data-contrast="none">When you want to combine two ranges of data:</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></p>
<ul>
<li data-leveltext="" data-font="Symbol" data-listid="37" aria-setsize="-1" data-aria-posinset="3" data-aria-level="1"><span data-contrast="none">Use VSTACK to combine two ranges of data vertically</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></li>
<li data-leveltext="" data-font="Symbol" data-listid="37" aria-setsize="-1" data-aria-posinset="4" data-aria-level="1"><span data-contrast="none">Use HSTACK to combine two ranges horizontally</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span></li>
</ul>

<h2 id="toc-hId--1208625732">Availability </h2>
<p>These functions are currently available to users running Beta Channel, Version 2203 (Build 15104.20004) or later on Windows and Version 16.60 (Build 22030400) or later on Mac.</p>

<p><strong>Don’t have it yet? It’s probably us, not you.</strong></p>

<p>Features are released over some time to ensure things are working smoothly. We highlight features that you may not have because they’re slowly releasing to larger numbers of Insiders. Sometimes we remove elements to further improve them based on your feedback. Though this is rare, we also reserve the option to pull a feature entirely out of the product, even if you, as an Insider, have had the opportunity to try it.</p>

<h2 id="toc-hId-1278887101">Feedback</h2>
<p><span data-contrast="auto">If you have any feedback or suggestions, you can submit them by clicking  </span><strong><span data-contrast="auto">Help </span></strong><span data-contrast="auto">&gt; </span><strong><span data-contrast="auto">Feedback</span></strong><span data-contrast="auto">.</span><span data-ccp-props="{&#34;134233117&#34;:true,&#34;134233118&#34;:true,&#34;201341983&#34;:0,&#34;335559740&#34;:240}"> </span><span data-contrast="none">You can also submit new ideas or vote for other ideas via </span><a href="https://feedbackportal.microsoft.com/feedback/forum/c23f3b77-f01b-ec11-b6e7-0022481f8472" target="_blank" rel="noopener noreferrer"><span data-contrast="none">Microsoft Feedback</span></a><span data-contrast="none">.</span></p>

<p><span>Want to know more about Excel? See </span><a href="https://support.microsoft.com/en-us/office/what-s-new-in-excel-for-microsoft-365-5fdb9208-ff33-45b6-9e08-1f5cdb3a6c73?ui=en-us&amp;rs=en-us&amp;ad=us#Audience=Windows_Desktop_" target="_blank" rel="noopener noreferrer"><span>What&#39;s new in Excel</span></a><span> and subscribe to our </span><a href="https://aka.ms/xlblog" target="_blank" rel="noopener noreferrer"><span>Excel Blog</span></a><span> to get the latest updates. Stay connected with us and other Excel fans around the world – join our </span><a href="https://aka.ms/ExcelCommunity" target="_blank" rel="noopener noreferrer"><span>Excel Community</span></a><span> and follow us on </span><a href="https://twitter.com/msexcel" target="_blank" rel="noopener nofollow noreferrer"><span>Twitter</span></a><span>.</span></p>

<p>Joe McDaid (<a href="https://twitter.com/jjmcdaid" target="_blank" rel="noopener nofollow noreferrer">@jjmcdaid</a>)</p>

					
				
			
			
			
				
			
			
			
			
			
			
		</div>
		
		
	

	
	
</div>
	</div></div>
  </body>
</html>
