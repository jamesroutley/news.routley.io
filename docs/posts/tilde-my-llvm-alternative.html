<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://yasserarg.com/tb">Original</a>
    <h1>Tilde, My LLVM Alternative</h1>
    
    <div id="readability-page-1" class="page"><div>

<p>
I&#39;m Yasser and I&#39;ve made it my mission to produce an alternative to LLVM, the current
king of compiler backend libraries. I&#39;m calling it Tilde (or TB for tilde backend) and the reasons
are pretty simple, i believe it&#39;s far too slow at compiling and far too big to be fixed from the
inside. It&#39;s been 20 years and cruft has built up, time for a &#34;redo&#34;.
</p>

<p>
As a test case i wrote a C compiler and early tests show the preprocessor to be
around 2x faster than Clang&#39;s along with being able to parse multiple translation units
in the same process without threading issues and out of order declarations (can talk about that
another time). To clarify, my project isn&#39;t some API compatible replacement to LLVM, it&#39;s just
another backend that believes in a similar vision to early LLVM.
</p>

<p>
The world needs better compiler tools, tools which are built as libraries. This
design point allows reuse of the tools in new and novel ways. However, building
the tools as libraries isn&#39;t enough: they must have clean APIs, be as decoupled
from each other as possible, and be easy to modify/extend. This requires clean
layering, decent design, and avoiding tying the libraries to a specific use. Oh
yeah, did I mention that we want the resultant libraries to be as fast as
possible? :)
</p>

<h2>Key features</h2>
<ul>
<li>Sea of nodes IR (opposed to the LLVM or GCC&#39;s SSA CFG)</li>
<li>Simple type system</li>
<li>Fast compile times</li>
<li>Thread-safe modules (can generate and compile two functions at the same time)</li>
<li>Codeview debug info (windows debuggers will handle it just fine)</li>
<li>Capable of both JITing and AOT (there&#39;s also early work on directly outputting linked executables thus bypassing the need for a conventional linker)</li>
</ul>

<h2>In progress</h2>
<p>
Currently I&#39;m working with GingerBill on integrating with <a href="https://github.com/odin-lang/Odin">Odin</a> along
with Shaw Summa on <a href="https://github.com/FastVM/minivm/tree/cuik2">minivm</a>, I&#39;m hoping to self host Cuik this year which will be the most capable example of
TB. Along with this, the optimizer is in progress and going good with most of the expected optimizations:
SSA construction, SCCP, folding, GVN, DCE, and code motion, along with a decent linear scan allocator
which will eventually be replaced with graph coloring for optimized builds.
</p>

<h2>Roadmap</h2>
<p>
The current plan is to have Cuik self-hosting on windows by March 2024, this would mark the first capable compiler under TB. From there the next few months will be spent on self-hosting with the optimizer on, this currently has no timeline but once self hosting is complete i&#39;ll have a clearer picture of that milestone.
</p>

<h2>Compile times?</h2>
<p>
I made a small demo you can try running on different files, just compile <a href="https://gist.github.com/RealNeGate/0c367a16d89d281b5c590072d1a1298a">this</a>. Cuik traces need to be opened with <a href="https://gravitymoth.com/spall/spall.html">spall</a>
</p>
<h3>cuik -g -O1 -c -T</h3>
<p><img src="https://yasserarg.com/spall_tb_o1.png"/></p><h3>clang -g -O0 -c -ftime-trace</h3>
<p><img src="https://yasserarg.com/spall_clang_o0.png"/></p><p>
This is with my optimizer on just in case someone wanted to argue that my codegen being dumb in unoptimized builds (which it isn&#39;t, it&#39;s about the same) was the cause.
Other important caveats are that LLVM doesn&#39;t consider IR generation to be backend here so that&#39;s included in my example and not theirs, it&#39;s only 0.3ms for me so i didn&#39;t
mind giving them the upper hand. It&#39;s not a fair test on purpose to show what my slowest looks like compared to their fastest.
</p>

<h2>Let&#39;s talk</h2>
<p>If you wanna discuss compilers, contribute or just chat about my projects, here&#39;s how you reach me:</p>
<ul>
<li><a id="emaila">Email</a></li>
<li><a href="https://discord.gg/UFuHChZswc">Discord</a></li>
<li><a href="https://github.com/RealNeGate/Cuik">Github repo</a></li>
</ul>
</div></div>
  </body>
</html>
