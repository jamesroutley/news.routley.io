<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://largeworldmodel.github.io/">Original</a>
    <h1>UC Berkley: World Model on Million-Length Video and Language with RingAttention</h1>
    
    <div id="readability-page-1" class="page"><div>
    <div>
      <h2>Abstract</h2>
      <p>
          Current language models fall short in understanding aspects of the world not easily described in words, and struggle with complex, long-form tasks. Video sequences offer valuable temporal information absent in language and static images, making them attractive for joint modeling with language. Such models could develop a understanding of both human textual knowledge and the physical world, enabling broader AI capabilities for assisting humans. However, learning from millions of tokens of video and language sequences poses challenges due to memory constraints, computational complexity, and limited datasets. To address these challenges, we curate a large dataset of diverse videos and books, utilize the RingAttention technique to scalably train on long sequences, and gradually increase context size from 4K to 1M tokens. This paper makes the following contributions: (a) Largest context size neural network: We train one of the largest context size transformers on long video and language sequences, setting new benchmarks in difficult retrieval tasks and long video understanding. (b) Solutions for overcoming vision-language training challenges, including using masked sequence packing for mixing different sequence lengths, loss weighting to balance language and vision, and model-generated QA dataset for long sequence chat. (c) A highly-optimized implementation with RingAttention, masked sequence packing, and other key features for training on millions-length multimodal sequences. (d) Fully open-sourced a family of 7B parameter models capable of processing long text documents (LWM-Text, LWM-Text-Chat) and videos (LWM, LWM-Chat) of over 1M tokens.
          This work paves the way for training on massive datasets of long video and language to develop understanding of both human knowledge and the multimodal world, and broader capabilities.
          </p>
    </div>
  </div><div>
  <div>
    <h2>Question Answering Over 1 Hour Video.</h2>
    <div>
      <div>
      <p><img src="https://largeworldmodel.github.io/materials/long_video_chat_main.png" alt="1M video chat" width="820"/></p><p><b>Figure 1. Long video understanding.</b> LWM can answer questions about over 1 hour YouTube video.</p>
      </div>
    </div>
    </div>
</div><div>
  <div>
    <h2>Fact Retrieval Over 1M Context.</h2>
    <div>
      <div>
        <p><img src="https://largeworldmodel.github.io/materials/needle_comparison_baselines_log_linear_mix_rot.png" alt="1M fact retrieval" width="850"/></p><p><b>Figure 2. Needle retrieval task.</b> LWM achieves high accuracy across 1M context window and outperforms GPT-4V and Gemini Pro.</p>
      </div>
      <!-- <div class="image-container" style="display: flex; justify-content: center; gap: 5px;">
        <div class="image">
          <img src="./materials/single_needle_1M.png" alt="Image 1" width="200" height="100">
        </div>
        <div class="image">
          <img src="./materials/multi_needle.png" alt="Image 2" width="200" height="100">
        </div>
      </div> -->
    </div>
    </div>
</div><div>
  <div>
    <h2>Long Sequence Any-to-Any AR Prediction.</h2>
    <div>
      <div>
      <p><img src="https://largeworldmodel.github.io/materials/model.png" alt="Model" width="700"/></p><p><b>Figure 4. Any-to-Any Long Sequence Prediction.</b> RingAttention enables the use of a very large context window for training across diverse formats such as video-text, text-video, image-text, text-image, pure video, pure image, and pure text. See <a href="https://arxiv.org/abs/2402.08268" target="_blank">the LWM paper</a> for key features, including masked sequence packing and loss weighting, which allow effective video-language training.</p>
      </div>
    </div>
    </div>
</div><div>
  <div>
    <h2>Modeling Diverse Videos and Books With RingAttention.</h2>
    <div>
      <div>
      <p><img src="https://largeworldmodel.github.io/materials/data.png" alt="Data Mixture" width="900"/></p><p><b>Figure 5. Context Extension and Vision-Language Training.</b> Expanding context size from 4K to 1M on books using RingAttention, followed by vision-language training on diverse forms of visual contents of lengths 32K to 1M. The lower panel shows interactive capabilities in understanding and responding to queries about complex multimodal world.</p>
    </div>
    </div>
    </div>
</div><div>
  <div>
    <h2>Image Based Conversation.</h2>
    <div>
      <div>
      <p><img src="https://largeworldmodel.github.io/materials/image_chat.png" alt="1M video chat" width="820"/></p><p><b>Figure 6. Image understanding.</b> LWM can answer questions about images.</p>
      </div>
    </div>
    </div>
</div><div>
  <div>
    <h2>Video Chat Over 1 Hour YouTube Video.</h2>
    <div>
      <div>
        <div>
          <p>
              <iframe src="https://www.youtube.com/embed/NgTV5bxK8Cs" frameborder="0" allowfullscreen=""></iframe>
          </p>
          
          <p><img src="https://largeworldmodel.github.io/materials/long_video_chat_1.png" width="100%"/>
          </p>
        </div>
        </div>
    </div>
    </div>
</div></div>
  </body>
</html>
