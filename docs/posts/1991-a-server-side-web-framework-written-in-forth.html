<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.1-9-9-1.com/">Original</a>
    <h1>1991: A server-side web framework written in Forth</h1>
    
    <div id="readability-page-1" class="page"><div>
            <article>
                <section>
                    
                    <p>
                        The year is 1991. The World Wide Web has just seen public release. <strong>1991</strong> looks to ease your interactions with the new web using cutting edge programming techniques in Forth (well, Gforth).
                    </p>
                </section>
                <section>
                    
                    <p>
                        Getting started in <strong>1991</strong> is easy.
                    </p>
                    <p>
                        All you need to do is include <code>1991.fs</code> into your Forth source file. Next, you can define your public routes using the <code>/1991</code> word. Once your routes are all layed out, start the server using <code>1991:</code>.
                    </p>
<pre>\ app.fs
\ Load 1991.
include 1991.fs

\ Define our route handlers.
: handle-/ ( -- addr u )
    \ Any string returned by the handler
    \ will be output to the browser.
    s&#34; Hello, 1991.&#34; ;

\ Set up our routes.
/1991 / handle-/

\ Start the server on port 8080.
8080 1991:
</pre>
                    <p>You can run the server using <code>gforth app.fs</code>.</p>

                    <h2>Logging In II: Logging In, Deeper</h2>
                    <h3>Route Wildcards (Fuzzy Routing / URL Mapping)</h3>
                    <p>
                        If you want to specify that some part of a route is a wildcard (accepts any value), then you can wrap some named value in <code>&lt;chevrons&gt;</code>. <strong>1991</strong> will accept any URL that matches your wildcard pattern, setting the internal value of whatever you place between the chevrons to whatever is actually requested.
                    </p>
                    <p>
                        In the example below, <code>&lt;uid&gt;</code> specifies that we&#39;re willing to accept any (non-empty) value in its place which we&#39;d like to access using the name <code>uid</code>.
                    </p>
<pre>\ wildcards.fs
\ Load 1991.
include 1991.fs

\ Define our route handler.
: handle-wildcard-route ( -- addr u )
    s&#34; contents of the route request: &#34; get-query-string s+ ;

\ Set up our route.
/1991 /users/&lt;uid&gt; handle-wildcard-route

\ We can set up multiple wildcards too (must be slash-separated).
/1991 /users/&lt;uid&gt;/posts/&lt;pid&gt; handle-wildcard-route

\ Start server on port 8080.
8080 1991:
</pre>
                    <p>
                         All wildcards are treated similar to query string arguments. As such, wildcards can be retrieved using <code>get-query-string</code>.
                    </p>
                    <p>
                        In the example above, visiting <code>http://localhost:8080/users/urlysses</code> will result in the following query string: <code>uid=urlysses</code>.
                    </p><h3>File Serving</h3>
                    <p>
                        Use a <code>public/</code> directory to act as a basic fileserver.
                        Whenever a requested URL doesn&#39;t resolve through the registered routes, <strong>1991</strong> will attempt to find the requested route within your specified public directory.
                    </p>
<pre>\ public.fs
\ Load 1991.
include 1991.fs

\ Specify the location of our public directory.
\ Anything in the public/ directory within the
\ same dir as this source file will resolve.
\ You can change &#34;public&#34; to anything you want
\ as long as it matches your directory name.
sourcedir s&#34; public&#34; s+ set-public-path

\ We can set mimetypes using the `filetype:` word.
\ In the case below, we want .mp4 files to be served
\ with the content-type video/mp4.
s&#34; video/mp4&#34; filetype: mp4

\ Start the server on port 8080.
8080 1991:
</pre>
                    <p>
                        In the above example, If we have a file <code>public/my-video.mp4</code>, then it will be available through <code>http://localhost:8080/my-video.mp4</code>.
                    </p>

                    <h3>Views</h3>
                    <p>
                        <strong>1991</strong> offers basic templating through views.
                    </p>
                    <p>
                        In order to get started, you should specify the <code>views/</code> path. Notice the trailing slash, which differs from how we define <code>public</code>.
                    </p>
                    <p>
                        Once you&#39;ve specified your views/ directory, you can write views/ files to it. This can be any kind of file, honestly. The benefit offered by views/ is the ability to use basic templating. You can write any valid Forth code within opening (<code>&lt;$ </code>) and closing (<code> $&gt;</code>) tags. Additionally, you can use the <code>import</code> word to import other views into your view.
                    </p>
<pre>\ views.fs
\ Load 1991.
include 1991.fs

\ Specify the location of our views directory.
sourcedir s&#34; views/&#34; s+ set-view-path

\ Define some words we&#39;ll use within
\ our view.
: page-title ( -- addr u )
    s&#34; Dynamic page title&#34; ;
: ten-lines ( -- )
    10 0 do
        s&#34; line &#34; i s&gt;d &lt;# #s #&gt; s+
        s&#34; &lt;br&gt;&#34; s+
        $type
    loop ;

\ Use render-view to output the contents
\ of a file in the views/ directory.
: handle-/
    s&#34; v-index.html&#34; render-view ;

/1991 / handle-/

\ Start the server on port 8080.
8080 1991:
</pre>
<pre>\ views/index.html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset=&#34;utf-8&#34;&gt;
        &lt;title&gt;&lt;$ page-title $type $&gt;&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;$ ten-lines $&gt;
        &lt;$ s&#34; imported-view.html&#34; import $&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre>
<pre>\ views/imported-view.html
It&#39;s possible to import view files from within other view files. This is from &lt;code&gt;views/imported-view.html&lt;/code&gt;
</pre>
                </section>
                <section>
                    
                    <h2>Why is <code>1991:</code> post-fix when <code>/1991</code> is pre-fix?</h2>
                    <p>
                        Forth is a (mostly) post-fix notation language. So, for example, you&#39;d write two plus two as <code>2 2 +</code>. This is the language&#39;s natural and immediate notation. Along those lines, <code>1991:</code> is an immediate word——running it results in immediate action. As such, we use Forth&#39;s post-fix notation to set the port and start the server immediately. Alternately, <code>/1991</code> doesn&#39;t exactly have immediate effect per se. All it does is tell <strong>1991</strong> that any request to <code>/path</code> should be handled by <code>path-handler</code>. As such, we opt to write non-immediate code using pre-fix notation.
                    </p>
                    <h2>You&#39;re using Gforth, which came out in 1992. Also, it&#39;s 2017.</h2>
                    <p>Okay. But Fredric Jameson establishes that in postmodernism we have experienced a weakening sense of historisity such that what is, what was, and what will be all exist as presents in time. <a href="https://en.wikipedia.org/wiki/Forth_(programming_language)#History">1970</a>, <a href="https://groups.google.com/forum/#!msg/alt.hypertext/eCTkkOoWTAY/bJGhZyooXzkJ">1991</a>, <a href="https://en.wikipedia.org/wiki/Gforth#History">1992</a>, and <a href="https://www.1-9-9-1.com/">2017</a> all happen simultaneously. Hence developers working on new projects while still coding in decades-old text editors. They write the future in the past and are made present in so doing.</p>
                </section>
            </article>
        </div></div>
  </body>
</html>
