<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rachelbythebay.com/w/2021/11/05/sevenbits/">Original</a>
    <h1>Years since 1900 &#43; seven bits = breakage in 2028</h1>
    
    
<p>
Last November, I put up a
<a href="https://rachelbythebay.com/w/2020/11/26/magic/">list</a>
of a bunch of &#34;magic numbers&#34; including some years in which time/date 
stuff is likely to break.  There&#39;s 2036 for the NTP era rollover, 2038 
for time_t requiring 32 bits in January *and* another GPS week rollover 
in November.
</p>
<p>
It turns out we have another one coming up far sooner, too: 2028!
</p>
<p>
Looking at the current year gives you a hint.  It&#39;s 2021, but another 
way of looking at that is that we&#39;re 121 years past the year 1900.  A 
fair number of things use(d) 1900 as an epoch, base year, or just an 
offset of sorts.  Why?  Well, they were probably invented in simpler 
times when the current year wasn&#39;t quite that far from 1900 at the time, 
and it would fit into fewer bits.  Specifically, it&#39;ll fit into just 
seven bits... until 2028, that is.
</p>
<p>
Why would people do that?  Assume they had limited bits to work with on 
the systems of the day.  You need at least 11 bits to store a value in 
the neighborhood of our current years.  Besides, at the time, 2028 
probably looked like it was so far away that it&#39;d never be a problem, 
because there&#39;s no way this stuff would still be use in by then, right?
</p>
<p>
So, if someone used 1900 as their base year, stored years relative to 
that, and then did it in just seven bits (or eight bits where one of 
them is a sign bit), it&#39;ll overflow in a little over six years.  What 
happens then depends on which method was used, and whether it applies 
certain kinds of sanity checks.
</p>
<p>
Worst case, I guess it could interpret &#34;year 128&#34; as &#34;year -127&#34;, and 
that would cause the system to roll from December 31, 2027 to January 1, 
<b>1773</b>.  Neat!
</p>
<p>
...
</p>
<p>
I originally spotted this thanks to a 
<a href="https://news.ycombinator.com/item?id=28828853">bug report type comment</a>
on an epitaph (!) on HN.  That one is about ISO 9660 (CD/DVD stuff) 
software and how it handles years.
</p>
<p>
Something
<a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=800627">similar</a>
was found in the Linux kernel in 2015 (and appears to have been 
patched).
</p>
<p>
Out of curiosity, I went looking for more info and did find a 
<a href="http://www.3kranger.com/HP3000/mpeix/en-mpe75/Beechglen2028/ch02s03.html">reference to this same problem</a>
that might be useful if you&#39;re trying to keep your HP 3000 alive.  You 
know, the things with the 
<a href="http://www.bitsavers.org/pdf/hp/disc/07935-90902_Operation_and_Installation_Apr83.pdf">300+ lb disk drives?  </a>
(If you know, you know.)
</p>
<p>
Other than those pages, there&#39;s not a whole lot on the topic.
</p>
<p>
Wikipedia does have 2028 in their epic
<a href="https://en.wikipedia.org/wiki/Time_formatting_and_storage_bugs#Year_2028">list</a>
of time formatting and storage bugs, naturally, but it only talks about 
systems from the &#39;70s.  It doesn&#39;t mention ISO 9660 at all - at the 
moment, that is.  Perhaps someone in the know will update it and then 
this comment will be obsolete.
</p>
<p>
If you are responsible for a bit-constrained system that might be 
storing years this way, you owe it to everyone to go look and see 
what&#39;ll happen.  Maybe try setting one forward to 2028-01-01 and see if 
it remains happy or if it decides to go party in the 18th century.
</p>
<p>
...
</p>
<p>
While I have your attention, for the younger set out there: as long as 
we&#39;re talking about bits and years, you aren&#39;t necessarily in the clear.  
You might&#39;ve noticed that 11 bits will hold the whole year, as in 2021, 
with no offsetting needed.  Perhaps you even designed a system that 
shaved things down to their minimum storage sizes based on this.
</p>
<p>
Eleven bits!  Luxury!  Ah, well, guess what happens in 2048?  Yep!
</p>
<p>
...
</p>
<p>
Finally, one random thing for anyone who&#39;s not already aware: try
log2(n) to get a feel for how big a number is in binary.  Neat, right?
</p>

  </body>
</html>
