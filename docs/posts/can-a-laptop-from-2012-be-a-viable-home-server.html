<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ounapuu.ee/posts/2022/05/10/thinkpad-as-a-home-server/">Original</a>
    <h1>Can a laptop from 2012 be a viable home server?</h1>
    
    <div id="readability-page-1" class="page"><div>
      
      <p>I’m a man of many ideas. It’s a shame that most of them are quite stupid.</p>
<p>This is one of them, but at least it makes for a fun experiment.</p>
<h3 id="intro">Intro</h3>
<p>After <a href="https://ounapuu.ee/posts/2022/03/21/ups-i-did-it-again/">adding an UPS to accompany my server,</a>
my setup was as complete as it could reasonably be. The server is low power,
but packs quite a punch with fast storage and plenty of compute power around.
The UPS provides a battery backup for both my server and the router.</p>
<p>There was still one annoyance lingering at the back of my head: this setup took
40 watts of power in idle. That’s a lot for something that runs 24/7. Yes,
<a href="https://www.reddit.com/r/homelab/">/r/homelab</a> regularly showcases more
power hungry setups, but my standards are quite high when it comes to power use.
I want to go as low as reasonably possible.</p>
<p>I recently bought a spare ThinkPad T430 so that I can have a backup machine in case
something happens to <a href="https://ounapuu.ee/posts/2022/01/09/why-i-went-back-to-using-a-thinkpad-from-2012/">my laptop that doesn’t suck</a>.
I’ve also <a href="https://ounapuu.ee/posts/2020/08/22/stupid-project-ideas-1/">had ideas about a server setup involving this laptop.</a></p>
<p>That’s when I decided to try running my services off of the ThinkPad T430.</p>

  <figure>
    <img src="https://ounapuu.ee/media/thinkpad-as-a-home-server/image1.jpg" alt="The setup."/>
    
      <figcaption>The setup.</figcaption>
    
  </figure>



  <figure>
    <img src="https://ounapuu.ee/media/thinkpad-as-a-home-server/image2.jpg" alt="Another angle of the setup."/>
    
      <figcaption>Another angle of the setup.</figcaption>
    
  </figure>


<h3 id="the-setup">The setup</h3>
<p>Here’s a quick rundown of the relevant specifications:</p>
<ul>
<li>CPU: Intel i5-3320M, 2 cores 4 threads @ 3.3GHz max</li>
<li>RAM: 16GB DDR3</li>
<li>OS disk: 256GB Micron mSATA SSD</li>
<li>Main storage: 2x 4TB Samsung 870 QVO SSD</li>
</ul>
<p>One of the main reasons that this setup is viable in the first place is the fact
that the ThinkPad T430 supports up to 3 SSD-s if you replace the optical drive
with a HDD caddy. Your OS can run off of an mSATA SSD and your mirrored storage
can utilize the two 2.5&#34; SATA slots.</p>
<p>You probably don’t want to use a setup like this if you want to store a lot of
big files, such as your legally obtained media collection. If your data can fit
on a pair of SATA SSD-s, then this setup will be just fine.</p>
<h3 id="why-use-a-laptop-as-a-home-server">Why use a laptop as a home server?</h3>
<p>If you don’t have a home server yet and want to start off as cheap as possible
while also being mindful of the power usage, then an used laptop with a competent
CPU is a fantastic starting point. In an age where 6 CPU cores is considered
mid-range, two CPU cores might not sound like much, but for most home server
workloads it’s absolutely fine.</p>
<p>Laptop CPU-s are designed to use as little power as possible. After all, they
need to run off of a small battery most of the time and have to run cool as well
to make do with the limited cooling setup that they have. This makes them ideal
for a machine that runs 24/7.</p>
<p>I measured the power usage of my ThinkPad T430 in this configuration and found
that it used around 15-20 watts when running with a low load. This is comparable
to the <a href="https://ounapuu.ee/posts/2022/01/17/asrock-x300-future-of-desktops/">ASRock DeskMini X300</a>.</p>
<p>What sets laptops apart from the usual desktop-based home server builds is that
they often have a working battery, which can act as a poor man’s UPS. If you
momentarily lose power, then the server will happily keep on working until the
battery runs out, which might take 1-2 hours (or more if your battery is in a
good state). This is comparable to the runtime I saw with the DeskMini server
build and the APC Smart-UPS 750.</p>
<p>Most laptops also come with an Ethernet port, and if the laptop is made some
time after 2005, then it’s likely running at gigabit speeds. Unless you have a
valid use case for 10 gigabits or more, then this will be plenty of network
bandwidth for most home server use cases.</p>
<p>One aspect that’s often overlooked with a laptop-based home server setup is the
inclusion of an integrated keyboard and mouse. If you accidentally mess up your
configuration and your server does not start up properly, then you can just open
the lid and start fixing it on the spot. On any other setup, you’d have to find
a monitor to hook the server up to and find a spare keyboard to use as well,
which can be a hassle.</p>
<h3 id="performance">Performance</h3>
<p>A home server that serves the needs of a couple of users at most and runs some
scheduled tasks from time to time can run perfectly fine off of a dual core
Intel Core series CPU from 2012. You probably don’t want to run intensive
computational workloads off of it, such as transcoding video files on a service
like Jellyfin. However, you can utilize the integrated GPU to off-load specific
workloads to it, and media encode-decode for select video codecs is one of those.
Intel QuickSync is an absolute godsend for situations where you need to transcode
media on a CPU that isn’t that powerful.</p>
<p>My home server runs a lot of services: Docker containers, this blog, data archival
jobs, backup jobs etc. When running them on the T430, the average CPU usage was
around 20%. Not ideal, but still leaves plenty of headroom for services.</p>
<p>The overall usability and performance that this machine offers was completely
acceptable. It’s not as lightning fast as something that runs a modern CPU,
like the AMD Ryzen 5 PRO 4650G in the DeskMini, but it gets the job done.</p>
<h3 id="caveats-thermals">Caveats: thermals</h3>
<p>A home server built around a used laptop brings a lot of benefits. However,
it also has some potential downsides that you should be aware of.</p>
<p>Most laptops have fans, and they can be damn loud. The ThinkPad T430 is
notoriously loud if you have the cooling fan manufactured by Toshiba. In a home
setting this can potentially a deal-breaker, unless you can wedge the laptop
into a corner of the room where it’s not audible.</p>
<p>There exist solutions to the fan control problem. You can install a tool like
thinkfan or just write your preferred fan level to <code>/proc/acpi/ibm/fan</code> to
avoid the cooling fan running too loud <a href="https://wiki.archlinux.org/title/fan_speed_control#ThinkPad_laptops">(instructions here)</a>.</p>
<p>Running the fan at the lowest speed works fine most of the time since your CPU
can throttle itself when it’s running too hot. However, with my setup I had an
odd issue where the machine would power off suddenly when it was doing a lot of
I/O workload, such as scrubbing the ZFS pool on the two 4TB SSD-s. This happened
even when the CPU was not even close to throttling, running around 75 C. I do
not know what the actual reason for the sudden shutdown is, but I suspect that
it may be related to the motherboard overheating or the system treating the hot
SSD-s as hard drives that are over the critical temperature limit of around 60 C.</p>
<p>I was able to work around most of the cooling-related issues by mounting the
laptop vertically and limiting the maximum CPU clock speed to around 2.4 GHz
using the knobs made available with <code>intel_pstate</code>.</p>
<p>The CPU temperatures during normal operation were mostly around 60C, with a high
load reaching max 75C with the tweaks applied and the CPU fan running at the
slowest possible speed.</p>
<h3 id="caveats-maintenance">Caveats: maintenance</h3>
<p>If you have a machine that runs 24/7, maintenance will become an issue. No
matter how often you clean your home, dust will accumulate. On desktop PC-s,
cleaning out your CPU heatsink is just a matter of taking off the PC case side
panel, removing the heatsink fan, cleaning off the dust and putting it all back
together. You probably want to replace the thermal paste from time to time as
well.</p>
<p>On most laptops, cleaning out the CPU heatsink is much trickier. You will likely
have to disassemble most of the machine to even access it, which takes up much
more time compared to a desktop PC, which also means more downtime.</p>
<p>Depending on the model, a simple change, such as upgrading your storage or
replacing a faulty drive, can also be more complicated. I’ve seen laptops where
you actually have to disassemble the whole machine to access the hard drive.
The ThinkPad T430 has an easily accessible setup when it comes to storage, but
the main storage bay does have an annoying pull-tab setup that probably won’t
survive multiple subsequent changes.</p>
<h3 id="conclusion">Conclusion</h3>
<p>Aside from the setbacks that may or may not be due to the specifics of my setup,
I find that a laptop can make for a good home server. If you have more specific
requirements, then a custom-built server is likely the way to go, but if you’re
just starting out, then definitely do consider this option.</p>
<p>After running this setup for a week or two, I decided to go back to my previous
setup based on the ASRock DeskMini. The reliability woes weren’t something I
was too happy with, and I didn’t really have another use case for the DeskMini
either, so it made sense for me.</p>

<p>If you prefer to share your thoughts on this post privately,
<a href="mailto:ihavesomethoughtsonyourblog@ounapuu.ee">just send me an e-mail!</a></p>
<p>Places where you can discuss this post:</p>
<ul>
<li><a href="https://news.ycombinator.com/item?id=31325191">Hacker News</a></li>
<li><a href="https://forum.level1techs.com/t/hddhermans-blog/180788/14?u=hddherman">Level1Techs forum</a></li>
<li><a href="https://www.linkedin.com/posts/%F0%9F%94%A5-herman-%C3%B5unapuu-600516152_can-a-laptop-from-2012-be-a-viable-home-server-activity-6929728654469906432-L3zd">LinkedIn</a></li>
<li><a href="https://www.reddit.com/user/hddherman/comments/umeyyg/can_a_laptop_from_2012_be_a_viable_home_server/">Reddit</a></li>
</ul>

    </div></div>
  </body>
</html>
