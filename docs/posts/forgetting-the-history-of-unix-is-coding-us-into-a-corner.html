<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.theregister.com/2024/02/16/what_is_unix/">Original</a>
    <h1>Forgetting the history of Unix is coding us into a corner</h1>
    
    <div id="readability-page-1" class="page"><div id="body">
<p><span>FOSDEM 2024</span> There are vital lessons to be learned from the history of Unix, but they&#39;re being forgotten. This is leading to truly vast amounts of wasted effort.</p>
<p>This article is the second based on <em>The Reg</em> FOSS desk&#39;s <a target="_blank" href="https://fosdem.org/2024/schedule/event/fosdem-2024-3095-one-way-forward-finding-a-path-to-what-comes-after-unix/" rel="nofollow">talk at FOSDEM 2024</a> (part 1 was <a target="_blank" href="https://www.theregister.com/2024/02/12/drowning_in_code/">Drowning in code</a>). FOSDEM is a conference all about free and open source software, and these days, perhaps regrettably, FOSS is about Unix. Increasingly, <a target="_blank" href="https://www.theregister.com/2023/01/17/unix_is_dead/">Unix today is Linux</a>. The problem is that everyone is forgetting what UNIX really is and knowing your history is essential. As George Santayana said, often misquoted:</p>

<p>It&#39;s often misquoted, which may be why Henry Spencer (who did the original <a target="_blank" href="https://groups.google.com/g/mod.sources/c/OqVZYQNSmDs/m/G_T2jHu5QI8J">FOSS implementation</a> of regex) <a target="_blank" href="https://groups.google.com/g/sci.space.shuttle/c/L8-Upf8gZoY/m/NN6ngTI0K0QJ" rel="nofollow">paraphrased it</a> as:</p>

<p>What Santayana predicted is coming true around the world today, and so is what Spencer predicted. There are other options, but few even look at them. Why is that?</p>
<h3>What is &#39;Unix&#39; anyway?</h3>
<p>First things first, it doesn&#39;t mean anything related to the original AT&amp;T codebase. That definition hasn&#39;t been true since 1993. <a target="_blank" href="https://www.theregister.com/2013/07/25/novell_peaked_with_netware_four/">Novell bought Unix from AT&amp;T</a> 31 years ago, kept the code, and donated the UNIX trademark to the Open Group. Since then, the name &#34;Unix&#34; has meant &#34;passes Open Group testing,&#34; which is broadly what POSIX <em>used</em> to mean. The original codebase is effectively gone. <a target="_blank" href="https://www.theregister.com/2021/03/31/ibm_redhat_xinuos/">SCO Group offshoot Xinuos</a> still sells things based on it, but their main product is based on FreeBSD.</p>
<p>But alongside macOS on both x86-64 and Arm64 and a handful of other OSes, such as HP/UX and IBM AIX, in the <a target="_blank" href="https://www.opengroup.org/openbrand/register/" rel="nofollow">Open Group register of UNIX® certified products</a>, there used to be two different Linux distros, <a target="_blank" href="https://www.opengroup.org/openbrand/register/brand3622.htm" rel="nofollow">Huawei EulerOS</a> and <a target="_blank" href="https://www.opengroup.org/openbrand/register/brand3617.htm" rel="nofollow">Inspur K/UX</a>, both Chinese CentOS Linux derivatives. Like it or not, this means that Linux isn&#39;t &#34;a Unix-like OS&#34; any more. It is a Unix.</p>
<p>It&#39;s a member of a <a target="_blank" href="https://en.wikipedia.org/wiki/History_of_Unix#/media/File:Unix_history-simple.svg" rel="nofollow">big family of Unixes</a>. Even the <a target="_blank" href="https://www.cl.cam.ac.uk/teaching/0708/OSFounds/P04-4.pdf" rel="nofollow">simplified version</a> [PDF] from Cambridge University shows nearly 30 branches. The Wikipedia family tree shows lots of branches and lines: Version 1 to 4, then Version 5 to 6, then Version 7, System III and System V … plus lots and lots of derivatives, mostly proprietary, and all the BSDs. And of course Linux, with zero shared code, but a shared <em>design</em>.</p>

    

<p>But if you take another step back, given that Unix now means compatibility, <em>they are all one branch</em>. It&#39;s not about lines of descent any more, because in a sense, what was once the POSIX definition <em>became</em> Unix. But if your goal is simply to pass compatibility tests, you can do that with a shim, some kind of compatibility layer. That&#39;s why several versions of IBM z/OS are on the Open Group List. That seems strange because they are not Unix-like at all.</p>

        


        

<p>This leads to other questions, such as what constitutes a &#34;Unix-like&#34; OS anyway? Anyone who has a basic idea of how to work with Linux, or macOS from inside the terminal, knows what a Unix looks like. Some identifying characteristics are:</p>
<ul>
<li>One file system, rooted at <code>/</code>.</li>

<li>A shell. (It doesn&#39;t matter which one: <code>bash</code>, <code>tcsh</code>, <code>zsh</code>.)</li>

<li>Commands like <code>ls</code>, <code>cat</code>, <code>echo</code>, <code>mkdir</code>, <code>rmdir</code>, <code>touch</code>.</li>

<li>A case-sensitive file system.</li>

<li>Plain text files, and commands connected with redirection and pipes.</li>
</ul>
<p>Certainly, there can be exceptions to these. For instance, macOS is a Unix™. It passes the tests, and Apple pays for the certification. But it hides most of the real Unix directory tree, its <code>/etc</code> is relatively empty, it doesn&#39;t have an X server – it&#39;s an <a target="_blank" href="https://www.xquartz.org/" rel="nofollow">optional extra</a>. And most of all, it&#39;s not case sensitive.</p>
<p>But all the same, it&#39;s still recognizably a Unix.</p>
<p>So taking that list of general characteristics, and adding a less visible one – that it&#39;s programmed mainly in C or something C-like – and requiring that the OS looks like Unix <em>and nothing else</em>, meaning there&#39;s no other native layer underneath, then the family is bigger.</p>

        

<p>So if it&#39;s just about compatibility and we don&#39;t care about who inherited code from where any more, this raises other questions. How can we categorize them? What is a Unix-like OS anyway?</p>
<h3>Generations and the gaps between</h3>
<p>Looking at the successive projects in the original Unix family within AT&amp;T is very instructive. For its first decade, Unix was a research project, not a commercial product, and in that time it went through about seven generations.</p>
<p>The thing is that even when other projects started branching off from it and going their own way from between Unix V4 and V8, the original research project kept going. Both the Wikipedia and Cambridge family trees show the AT&amp;T line stopping after the Tenth Edition. But actually, there were two more generations.</p>
<p>If we consider that whole extended family to be one unit, one box on the chart, that leaves a few outliers. Linux is one. Minix is another. There are others that aren&#39;t shown, and a whole category of them are very much Unix-like systems: the microkernels.</p>
<p>The original microkernel, <a target="_blank" href="https://www.cs.cmu.edu/afs/cs/project/mach/public/www/mach.html" rel="nofollow">CMU Mach</a>, led to a whole bunch of Unix OSes, including the <a target="_blank" href="https://kb.iu.edu/d/agoq" rel="nofollow">Open Group&#39;s OSF/1</a> and <a target="_blank" href="https://kb.iu.edu/d/agoo" rel="nofollow">DEC Tru64</a>, as well as <a target="_blank" href="https://www.mklinux.org/" rel="nofollow">MkLinux</a> and famously the <a target="_blank" href="https://www.gnu.org/software/hurd/" rel="nofollow">GNU HURD</a>. The only one that isn&#39;t a historical curiosity or a tiny neglected niche is Apple&#39;s macOS family, including iOS, iPadOS and so on.</p>

        

<p>Dr Andy Tanenbaum&#39;s Minix, which was an indirect progenitor of Linux itself, is another, although Minix 1 and 2 were largely monolithic. <a target="_blank" href="https://www.minix3.org/" rel="nofollow">Minix 3</a>, though, is a true microkernel, and a version runs inside most modern Intel CPUs&#39; management processors.</p>
<p>There are others. The research on Mach led to <a target="_blank" href="http://os.inf.tu-dresden.de/L4/" rel="nofollow">L4</a> and <a target="_blank" href="https://www.l4ka.org/" rel="nofollow">others</a>, and work&#39;s <a target="_blank" href="https://sel4.systems/" rel="nofollow">still going on</a>. <a target="_blank" href="https://blackberry.qnx.com/en" rel="nofollow">QNX</a> is a commercial microkernel Unix-like OS, and it&#39;s used in billions of embedded devices … although the only time you might have played with it was <a target="_blank" href="https://www.theregister.com/2015/10/02/bb10_five_reasons_why_it_failed/">Blackberry 10</a>.</p>
<ul>

<li><a href="https://www.theregister.com/2024/02/14/damn_small_linux_returns/">Damn Small Linux returns after a 12-year gap</a></li>

<li><a href="https://www.theregister.com/2024/02/12/drowning_in_code/">Drowning in code: The ever-growing problem of ever-growing codebases</a></li>

<li><a href="https://www.theregister.com/2024/02/12/pistorm_accelerated_amiga_pi/">PiStorm turbocharges vintage Amigas with the Raspberry Pi</a></li>

<li><a href="https://www.theregister.com/2024/02/06/no_kde6_for_noble/">KDE 6 misses boat to make it into Kubuntu 24.04</a></li>
</ul>
<p>Although they have enjoyed more success than you might think, microkernels are hard to get working well. Tiny kernels with lots of user-space processes doing stuff are not so hard – AmigaOS did this successfully in the mid-1980s. The problem is keeping the various processes isolated, yet able to communicate with each other. AmigaOS ran on machines with no memory management hardware – everything was in one address space. It&#39;s easy to communicate with another process when you can read and write its memory.</p>
<p>The idea of a true microkernel is that the kernel runs in ring 0, in supervisor mode. It schedules processes, it allocates memory, and that&#39;s about it. Everything else is implemented in &#34;servers&#34; in user space. Getting them to talk to each other <em>quickly</em> is the hard problem.</p>
<p>For instance, macOS uses Mach, but to provide Unix-compatible APIs so it looks like a Unix, it took a big chunk of the BSD kernel and called it a &#34;Unix server.&#34; Mach still manages the processes, not this Unix server, but even so, the server is still big and complicated. And it still wasn&#39;t that fast, so NeXT moved it inside the Mach kernel, meaning it&#39;s in kernel space too, running in the same memory space as the not-so-micro-any-more Mach kernel.</p>
<p>This leaves us with two families of Unix-like OSes. Monolithic kernels, which includes almost all the old proprietary commercial Unixes, and all the BSDs – and Linux. Plus microkernels, which we can very loosely group into two families. One is commercial, and today mainly means Apple&#39;s OSes and QNX. QNX is proprietary, while Apple&#39;s kernel and userland is open source but hasn&#39;t influenced much else.</p>
<p>And an open source family, including Minix 3, the GNU Hurd, L4, seL4, and many others. Some are used in embedded control systems – such as <a target="_blank" href="https://www.intel.com/content/www/us/en/support/articles/000008927/software/chipset-software.html" rel="nofollow">Intel&#39;s ME</a> – but there is little visible mainstream use.</p>
<p>But that is not the end of the line. It is all that most histories show, but there is a third line of descent. Dennis Ritchie and Ken Thompson&#39;s work didn&#39;t end in 1979 with Unix 7, even if that&#39;s where most commercial Unix originated.</p>
<h3>Turn it up to 11</h3>
<p>The versions of Unix after the Seventh Edition are sometimes collectively called <a target="_blank" href="https://en.wikipedia.org/wiki/Research_Unix" rel="nofollow">Research Unix</a>, and when I have asked about this online, it has resulted more in people telling me that&#39;s <em>wrong</em> than much useful information.</p>
<p>Even so, the lesser-known editions within AT&amp;T&#39;s Unix System Laboratories were the Eighth Edition in 1985, the Ninth Edition in 1986, and in 1989 the Tenth Edition. Some fragmentary <a target="_blank" href="https://www.theregister.com/2017/03/30/old_unix_source_code_opened_for_study/">source code is available</a>, but little information. (Working links or references to what was in these are welcome!)</p>
<p>What came after the Tenth Edition is, for this writer, where it gets interesting. By 1992, Unix was big commercial news, of course. FreeBSD and NetBSD were happening, and Linux was gathering attention.</p>
<p>Meanwhile, Bell Labs did something else.</p>
<p>Think about what constitutes traditional, old-school Unix. It&#39;s about <a target="_blank" href="http://ibgwww.colorado.edu/~lessem/psyc5112/usail/concepts/filesystems/everything-is-a-file.html" rel="nofollow">&#34;everything is a file,&#34;</a> streams of bytes, the familiar shell, and so on. But there are important things on all modern computers that aren&#39;t covered by this.</p>
<p>Graphics, notably, don&#39;t really form part of the classic Unix kernel. macOS and Linux are both Unixes, as is BSD, but they have radically different GUI layers. This is because Unix was a <a target="_blank" href="https://www.britannica.com/technology/minicomputer" rel="nofollow">minicomputer</a> OS. As <a target="_blank" href="https://www.bell-labs.com/usr/dmr/www/hist.html" rel="nofollow">Dennis Ritchie himself described</a>, it was written on a <a target="_blank" href="https://www.soemtron.org/pdp7.html" rel="nofollow">DEC PDP-7</a>, and later ported to the bigger <a target="_blank" href="https://gunkies.org/wiki/PDP-11/20" rel="nofollow">DEC PDP-11</a>.</p>
<p>These were departmental-scale, multiuser computers. A host machine, plus dumb text terminals on serial connections, with no graphics and no networking – even so, high-end kit for the 1970s.</p>
<p>During the period when commercial Unix flowered, in the 1980s there were very expensive <em>workstations</em>: effectively, personal, single-user minicomputers. It took until the late 1980s for equipment like inexpensive 32-bit computers with onboard graphics, reasonably fast expansion buses (and thus, reasonably fast networking as a fairly cheap option) to start to be mainstream. Then Unix acquired networking support, as it still has. But ways for one Unix machine to talk to another wasn&#39;t considered in the original design. Instead, it has files of terminal type definitions. Even today, decades later, networking and graphics need auxiliary, helper tools, such as NFS, SSH, X11, and so on. It works, and it works very well, but these are bolted-on extras that appeared years after the design was set in stone.</p>
<p>This is the point at when Unix Tenth Edition appeared, in 1989, when networking and GUIs were proliferating everywhere.</p>
<p>Today, the Wayland enthusiasts like to talk about how they are modernizing the Linux graphics stack. But Linux is a Unix, and in Unix, <a target="_blank" href="https://hackmd.io/@jkyang/unix-everything-is-a-file" rel="nofollow">everything is meant to be a file</a>. So any Wayland evangelists out there, tell us: where in the file system can I find the files describing a window on the screen under the Wayland protocol? What file holds the coordinates of the window, its place in the Z-order, its colour depth, its contents?</p>
<p>If this stuff is not in the file system, are you sure this is a Unix tool?</p>
<p>Research Unix 10 started to address some of this, but it was too little, too late. The industry had taken much older, simpler versions, commercialized them, and the results were mutating and metastasizing across the world.</p>
<p>So Dennis Ritchie and Ken Thompson did <a target="_blank" href="https://www.theregister.com/2024/01/04/niklaus_wirth_obituary/">what Niklaus Wirth did</a> with Modula-2 and later with Oberon. They ignored what the industry was doing, went back to their original ideas, and kept working on refining them.</p>
<p>The result is the next step in the development of Unix, and in this era of spiralling software complexity and bloat, it&#39;s time to examine it afresh and see if the geniuses who invented Unix didn&#39;t have the right ideas, just as Linux was being created. ®</p>                                
                    </div></div>
  </body>
</html>
