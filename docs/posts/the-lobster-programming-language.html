<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.strlen.com/lobster/">Original</a>
    <h1>The Lobster Programming Language</h1>
    
    <div id="readability-page-1" class="page"><div>
			<div>
				<div>
					<div role="main">
						
	
	
	

<p><img src="https://www.strlen.com/img/lobster/lobster.svg" height="150"/></p>

<p>Lobster is a programming language that tries to combine the advantages of static typing and compile-time memory management with a very lightweight, friendly and terse syntax, by doing most of the heavy lifting for you.</p>

<p>While it is a general purpose language, its current implementation is biased towards games and
other graphical things, with plenty of “batteries included” functionality.</p>

<p>Lobster is Open Source (Apache v2 license) and can be found on <a href="https://github.com/aardappel/lobster">github</a>. Online copy of the full <a href="http://aardappel.github.io/lobster/README_FIRST.html">documentation</a>.</p>

<h2 id="features">Features</h2>

<p>Features have been picked for their suitability in a game programming language, and in particular to make code terse, quick to write and refactor. It is meant to not hold you back to get an idea going quickly.</p>

<ul>
<li>Language

<ul>
<li>Static typing that feels almost as easy to write as dynamic typing thanks to “Flow-Sensitive Type-Inference and Specialization”.</li>
<li>Compile time reference counting / lifetime analysis / borrow checker.</li>
<li>Lightweight Blocks / Anonymous Functions that make any function using them look identical to built-in control structures.</li>
<li>Vector operations (for math and many other builtins).</li>
<li>Unified overloading &amp; dynamic dispatch, in &amp; outside classes, supporting specialization.</li>
<li>Immutable “inline” structs (zero overhead).</li>
<li>GIL-less, race-less distributed memory model multi-threading.</li>
<li>Python-style indentation based syntax with C-style flavoring</li>
</ul></li>
<li>Implementation

<ul>
<li>Choose between running directly using the convenient JIT, or compilation to C++ for extra speed.</li>
<li>Reference Counting with cycle detection at exit, 95% of reference count ops removed at
compile time thanks to lifetime analysis.</li>
<li>Fully graphical debugger (inspect stack traces, modify variables etc).</li>
<li>Dynamic code loading.</li>
<li>Relatively fast (order of magnitude faster than Python, significantly faster than Lua (<a href="https://github.com/stefandd/Tic4">benchmark</a>), not yet a C competitor, but can be eventually) and economical (low overhead memory allocation)</li>
<li>Easy to deploy (engine/JIT exe + compressed bytecode file)</li>
<li>Modularly extendable with your own library of C++ functions</li>
</ul></li>
<li>Engine

<ul>
<li>Portable (mostly courtesy of OpenGL/SDL/Freetype), allowing your games to be run on Windows, Linux, Mac OS X, iOS, Android and WebAssembly (in that order of maturity, currently).</li>
<li>High level interface to OpenGL functionality, very quick to get going with simple 2D geometric primitives</li>
<li>3D primitive construction either directly from triangles, or using high level primitives made into meshes through marching cubes</li>
<li>GLSL shaders (usable accross OpenGL &amp; OpenGL ES 2 without changes)</li>
<li>Accurate text rendering through FreeType</li>
<li>Uniform input system for mouse &amp; touch</li>
<li>Simple sound system supporting .wav and .sfxr synth files.</li>
<li>ImGui support.</li>
<li>Comes with useful libraries written in Lobster for things like A* path finding and game GUIs</li>
</ul></li>
</ul>

<h2 id="examples">Examples</h2>

<p>let’s start with syntax and blocks:</p>
<div><pre><code data-lang="python"><span>def</span> <span>find</span>(xs, fun):
    <span>for</span>(xs) x, i:
        <span>if</span> fun(x):
            <span>return</span> i
    <span>return</span> <span>-</span><span>1</span>

let r <span>=</span> <span>2</span>
let i <span>=</span> find [ <span>1</span>, <span>2</span>, <span>3</span> ]: _ <span>&gt;</span> r</code></pre></div>
<p>We can learn a lot about the language from this tiny example:</p>

<ul>
<li><code>find</code> is a function that takes a vector and a function as argument, and returns the index of the first element for which that function returns true, or -1 if none.</li>
<li>It uses an indentation based syntax, though in this example the <code>for-if-return</code> could also have been written on a single line.</li>
<li>The call to <code>find</code> is in its maximum terse form which is a shorter form of writing the more verbose <code>find([ 1, 2, 3 ], fn(x): x &gt; r)</code>. Blocks / anonymous function arguments are typically written directly after the call they are part of, and generally have the syntax of a (possibly empty) list of arguments (separated by commas), separated from the body by a <code>:</code>. The body may either follow directly, or start a new indentation block on the next line. Additionally, if you don’t feel like declaring arguments, you may use variable names starting with an <code>_</code> inside the body that are automatically declared.</li>
<li><code>for</code> and <code>if</code> look like language features, but they have no special syntactical status compared to <code>find</code>. Any such functions you add will work with the same syntax.</li>
<li>Notice the complete lack of type declarations. The code is fully statically typed, however, type inference is smart enough to assign types to everything, and functions like <code>find</code> get specialized to work on whatever arguments they are called with, in this case a list of ints, and a specific lambda. Specialization not only increases the range of code type inference can handle, it allows the compiler to optimize this particular case as if you had hard-coded the loop (much like C++ templates).</li>
<li>blocks/functions may refer to “free variables”, i.e. variables declared outside of their own scope, like <code>r</code>. This is essential to utilize the full potential of blocks.</li>
<li><code>i</code> will contain <code>2</code> at the end of this (the index of element <code>3</code>). It does not clash with the other <code>i</code> because of lexical scoping. Here <code>=</code> means assignment, and <code>let</code> (or <code>var</code> for mutable) defines a new variable.</li>
<li><code>return</code> returns from <code>find</code>, not from the enclosing function (which would be the block passed to <code>if</code>). In fact, it can be made to return from any named function, which makes it powerful enough to implement exception handling in Lobster code, instead of part of the language.</li>
</ul>

<p>Types, dynamic dispatch, immutables and vector ops:</p>
<div><pre><code data-lang="python"><span>class</span> <span>Animal</span>:
    alive <span>=</span> true

<span>class</span> <span>Cat</span> : Animal
    <span>def</span> <span>hello</span>(): <span>print</span> <span>&#34;meow&#34;</span>

<span>class</span> <span>Dog</span> : Animal
    barked <span>=</span> <span>0</span>

<span>def</span> <span>hello</span>(d::Dog):
    <span>print</span> <span>&#34;bark!&#34;</span>
    barked<span>++</span>

let d <span>=</span> Dog {}
d<span>.</span>hello()

let a:Animal <span>=</span> d
a<span>.</span>hello()</code></pre></div>
<p>What we learn here:</p>

<ul>
<li>we can declare custom datatypes, that can optionally inherit from existing datatypes.</li>
<li>we can declare them with either <code>struct</code> or <code>class</code>, where the former means the object is immutable and passed in-line by value. This enforces more functional style programming for objects which can be seen as unit things (like points and vectors). These structs can be used with the rich set of built-in vector operations.</li>
<li>We can declare multiple version of a function, either in-line in the class, or anywhere else (both declarations of <code>hello</code> above are equivalent). These functions can be used as overloads (statically dispatched, like <code>d.hello()</code>) or dynamic dispatch (like <code>a.hello()</code>). Unlike other languages, this distinction depends on context, and because in Lobster all types and functions are known (closed world compilation), this can use static dispatch more often.</li>
<li>we can specify types for arguments with <code>:</code>. Besides their use in overloads, they can be used in regular    functions to make compile time type errors simpler. You can even specify the type with <code>::</code>, which allows you direct access to all members of the type, so you can write <code>x</code> instead of <code>p.x</code> etc.</li>
<li>(not shown here): classes, structs and functions can have generic arguments, even in addition to dynamic dispatch.</li>
</ul>

<p>Enough of dry programming language stuff, how do we draw?</p>
<div><pre><code data-lang="python"><span>import</span> <span>vec</span>
<span>import</span> <span>color</span>
<span>import</span> <span>gl</span>

let directions <span>=</span> [ xy_0, xy_x, xy_y ]

<span>def</span> <span>sierpinski</span>(depth) <span>-&gt;</span> void:
    <span>if</span> depth:
        gl_scale <span>0.5</span>:
            <span>for</span>(directions) d:
                gl_translate d:
                    sierpinski(depth <span>-</span> <span>1</span>)
    <span>else</span>:
        gl_polygon(directions)

fatal(gl_window(<span>&#34;sierpinski&#34;</span>, <span>512</span>, <span>512</span>))

<span>while</span> gl_frame():
    <span>if</span> gl_button(<span>&#34;escape&#34;</span>) <span>==</span> <span>1</span>: <span>return</span>
    gl_clear(color_black)
    gl_scale(<span>float</span>(gl_window_size()))
    sierpinski(<span>7</span>)</code></pre></div>
<p>which produces:</p>

<p><img src="https://www.strlen.com/img/lobster/sierpinski.png"/></p>

<p>What do we see:</p>

<ul>
<li>if we skip to <code>gl_window</code>, this creates the window and sets up OpenGL basics. This can theoretically fail which will return us an error string, but here for the example we’re lazy.</li>
<li>rendering in Lobster centers around frames like in most game engines, so we redraw everything every time (this example has no animation or interaction, so that looks a bit silly). <code>gl_frame</code> takes care not only of frame swapping, but updating input etc as well</li>
<li><code>gl_scale</code> allows us to scale all rendering by specifying the unit size (compared to the previous scale, which by default is pixel size). Using the current window size thus gets us a canvas with a resolution of 1.0 x 1.0 which is convenient for the algorithm we’re about to run</li>
<li>The import pulls in definitions for 2d/3d/4d vectors and some useful constants (e.g. <code>xyz_0</code> is a vector of all zeroes).</li>
<li>The recursive function then keeps subdividing and scaling in 3 directions until it gets to the bottom of the recursion where it draws the triangles</li>
</ul>

<p>To see more about the builtin functionality of Lobster (graphics or otherwise), check out the <a href="http://aardappel.github.io/lobster/builtin_functions_reference.html">builtin functions reference</a>
(this particular file may be out of date, it can be regenerated by the running <code>lobster -r</code>). You can also check out draft version of the full Lobster <a href="http://aardappel.github.io/lobster/README_FIRST.html">documentation</a>,
in particular the
<a href="http://aardappel.github.io/lobster/language_reference.html">Language Reference</a>.</p>

<p>Most recent version of everything is on <a href="https://github.com/aardappel/lobster">GitHub</a>.</p>

<p>Come chat on <a href="https://discord.gg/szJPYdX">Discord</a> or <a href="https://gitter.im/lobster_programming_language/community">Gitter</a>.</p>

<p>Like it on the <a href="https://www.facebook.com/lobsterprogramminglanguage">Facebook page</a>.</p>



						
					</div>
				</div>
			</div>
			
			

</div></div>
  </body>
</html>
