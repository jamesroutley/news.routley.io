<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://pjg1.site/rc04">Original</a>
    <h1>RC04: Shell Scripting Adventures</h1>
    
    <div id="readability-page-1" class="page"><div>

<p>2023-09-30</p>

<blockquote>
  <p><img src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2012%2015%22%3E%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%2212%22%20height%3D%2210%22%20fill%3D%22%23000%22%3E%3C%2Frect%3E%3Crect%20x%3D%221%22%20y%3D%221%22%20width%3D%2210%22%20height%3D%228%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%222%22%20y%3D%222%22%20width%3D%228%22%20height%3D%226%22%20fill%3D%22%23000%22%3E%3C%2Frect%3E%3Crect%20x%3D%222%22%20y%3D%223%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%233dc06c%22%3E%3C%2Frect%3E%3Crect%20x%3D%224%22%20y%3D%223%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%233dc06c%22%3E%3C%2Frect%3E%3Crect%20x%3D%226%22%20y%3D%223%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%233dc06c%22%3E%3C%2Frect%3E%3Crect%20x%3D%223%22%20y%3D%225%22%20width%3D%222%22%20height%3D%221%22%20fill%3D%22%233dc06c%22%3E%3C%2Frect%3E%3Crect%20x%3D%226%22%20y%3D%225%22%20width%3D%222%22%20height%3D%221%22%20fill%3D%22%233dc06c%22%3E%3C%2Frect%3E%3Crect%20x%3D%224%22%20y%3D%229%22%20width%3D%224%22%20height%3D%223%22%20fill%3D%22%23000%22%3E%3C%2Frect%3E%3Crect%20x%3D%221%22%20y%3D%2211%22%20width%3D%2210%22%20height%3D%224%22%20fill%3D%22%23000%22%3E%3C%2Frect%3E%3Crect%20x%3D%220%22%20y%3D%2212%22%20width%3D%2212%22%20height%3D%223%22%20fill%3D%22%23000%22%3E%3C%2Frect%3E%3Crect%20x%3D%222%22%20y%3D%2213%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%223%22%20y%3D%2212%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%224%22%20y%3D%2213%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%225%22%20y%3D%2212%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%226%22%20y%3D%2213%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%227%22%20y%3D%2212%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%228%22%20y%3D%2213%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3Crect%20x%3D%229%22%20y%3D%2212%22%20width%3D%221%22%20height%3D%221%22%20fill%3D%22%23fff%22%3E%3C%2Frect%3E%3C%2Fsvg%3E"/> I&#39;m attending the Fall 1 batch at <a href="https://www.recurse.com/scout/click?t=2ac66128b9116e0722d941ebf7e14b5a">Recurse Center</a>! Posts in this series cover things I&#39;m working on or find interesting during my time here.</p>
</blockquote>

<p>One of the things that helped me rediscover the joy of programming was making tiny shell scripts/functions for a specific purpose.</p>

<p>As I started using the command line more often, these functions helped execute commands that I would otherwise have to type repeatedly. And that set off a chain reaction - the more functions I made, the more ideas I&#39;d get.</p>

<p>The first one I made was <a href="https://github.com/pjg11/scripts/tree/main/tzc"><code>tzc</code></a>, to convert time from another timezone to my local time. It was inspired by two things:</p>
<ul>
  <li>The RC application process, where all the interview timings were displayed in EST, and I needed a way to convert timings quickly, and</li>
  <li><a href="https://lazybear.io/posts/cli-of-the-week-19/">CLI of the week #19</a>, a post that introduced me to the idea of tiny shell functions.</li>
</ul>

<p>Things I like about making tiny functions:</p>
<ul>
  <li><a href="https://blubsblog.bearblog.dev/i-am-the-only-user/">I am the only user</a>, so I make them in a way that makes sense to me (bonus points if it makes sense to others too).</li>
  <li>It takes less time to go from idea to execution.</li>
  <li>It&#39;s a great learning opportunity, as I end up learning something new about shell scripting concepts or the thing I&#39;m making the script for.</li>
</ul>

<p>I made a couple of functions while at RC - particularly over the last two weeks - which I&#39;ll share in this post.</p>
<h2 id="note">
  
  
    <code>note</code> <a href="#note">#</a>
  
  
</h2>
    

<p>I came across <a href="https://github.com/cdkini/quicknote"><code>quicknote</code></a> recently, and really liked the way it was structured. It made it easier to capture notes and search them, so I made its <code>zsh</code> equivalent:</p>

<pre><code><span>#!/bin/zsh</span>
note<span>()</span> <span>(</span>
	<span>dir</span><span>=</span><span>$HOME</span>/notes
	<span>cd</span> <span>$dir</span>
		
	<span>case</span> <span>$1</span> <span>in</span>
		<span>&#34;open&#34;</span><span>)</span>    <span>shift</span> <span>;</span> micro <span>$@</span> <span>;;</span>
		<span>&#34;ls&#34;</span><span>)</span>      fd <span>.</span> <span>$dir</span> <span>--type</span> file | <span>cut</span> <span>-d</span><span>&#39;/&#39;</span> <span>-f5-</span> <span>;;</span>
		<span>&#34;grep&#34;</span><span>)</span>    rg <span>$2</span> <span>;;</span>
		<span>&#34;rm&#34;</span><span>)</span>      <span>shift</span> <span>;</span> <span>rm</span> <span>$@</span> <span>;;</span>
		<span>*</span><span>)</span>         _usage <span>;</span> <span>return</span> <span>;;</span>
	<span>esac</span>
<span>)</span>
</code></pre>

<p>A neat trick I learnt while making this is writing the function block in regular braces <code>()</code> - which runs commands in a subshell as opposed to curly braces <code>{}</code> - to prevent changing the directory of my current shell session.</p>

<p>The full code with error handling and usage information can be found <a href="https://github.com/pjg11/scripts/blob/main/note">here</a>.</p>
<h2 id="blog">
  
  
    <code>blog</code> <a href="#blog">#</a>
  
  
</h2>
    

<p>This function is my take on a basic CLI content management system.</p>

<pre><code><span>$</span><span> </span>blog <span>-h</span>
<span>blog - commands to manage your Jekyll blog
		
Usage:
  blog command [args]

Options:
  -h|--help                  Show this message and exit
		
Commands:
  new filename               Create a new post
  update commitmsg           Build and deploy changes to existing content
  publish filename           Publish post now
  publish filename time      Schedule post for a later time
  preview                    View recent post/draft locally
  preview all                View entire website locally
</span></code></pre>

<p>These commands have existed as a bunch of separate shell scripts and aliases. Some of them have featured on this blog - a <a href="https://pjg1.site/jekyll-blog-setup#publish-your-website%23testing-the-script">publish script</a> and a post on <a href="https://pjg1.site/schedule-jekyll">scheduling</a>.</p>

<p>The upgraded function code can be found <a href="https://github.com/pjg11/scripts/blob/main/blog">here</a>.</p>
<h2 id="rlist">
  
  
    <code>rlist</code> <a href="#rlist">#</a>
  
  
</h2>
    

<p>I use Safari&#39;s Reading List to save links, and I wanted a way to manage them from the command line, particularly to view all links and delete a link once I&#39;m done reading.</p>

<pre><code><span>$</span><span> </span>rlist <span>-h</span>
<span>rlist - Manage Safari&#39;s Reading List from the command line

Usage:
  rlist [options] command

Options:
  -h|--help    Show this message and exit

Commands:
  init         Extracts links and saves to $HOME/notes/rlist.tsv
  search       Search all links and open chosen link in browser
  delete       Delete chosen link from list
</span></code></pre>

<p>The Reading List is stored in <code>~/Library/Safari/Bookmarks.plist</code>, and the function uses a utility called <a href="https://www.marcosantadev.com/manage-plist-files-plistbuddy/"><code>PlistBuddy</code></a> to interact with the file.</p>

<p>Here&#39;s a demo of the search command, that works like a fuzzy finder, along with the option to open the link in a browser.</p>

<img src="https://pjg1.site/public/demo.gif" alt=""/>
<p>This is possibly the coolest script I&#39;ve made yet, as it took a while to understand how <code>PlistBuddy</code> works, and using <a href="https://github.com/charmbracelet/gum"><code>gum</code></a> for the fancy formatting added to the coolness. ðŸ˜Ž</p>
<h2 id="mkfunc">
  
  
    <code>mkfunc</code> <a href="#mkfunc">#</a>
  
  
</h2>
    

<p>Lastly, a meta function whose naming is inspired by <code>mkdir</code>. It creates a file with starter code for a shell function when called.</p>

<pre><code><span>#!/bin/zsh</span>

mkfunc<span>()</span> <span>{</span>

	<span>if</span> <span>[[</span> <span>(</span> <span>$# </span><span>-eq</span> 0 <span>)</span> <span>||</span> <span>(</span> <span>&#34;</span><span>$*</span><span>&#34;</span> <span>=</span>~ <span>&#34;-h&#34;</span> <span>)</span> <span>||</span> <span>(</span><span>&#34;</span><span>$*</span><span>&#34;</span> <span>=</span>~ <span>&#34;--help&#34;</span><span>)</span> <span>]]</span> <span>;</span> <span>then
			</span><span>echo</span> <span>&#34;Usage: mkfunc name&#34;</span>
			<span>return
	fi

	</span><span>tee</span> <span>$HOME</span>/.oh-my-zsh/functions/<span>$1</span> <span>&lt;&lt;</span> <span>&#39;</span><span>EOF</span><span>&#39;
#!/bin/zsh
	
func() {
	
	_usage() {
		# Add help text here
	}

	if [[ ( </span><span>$# </span><span>-eq 0 ) || ( &#34;</span><span>$*</span><span>&#34; =~ &#34;-h&#34; ) || ( &#34;</span><span>$*</span><span>&#34; =~ &#34;--help&#34;) ]] ; then
		_usage
		return
	fi

	# Remove this block if function contains no subcommands
	case </span><span>$1</span><span> in
		# Add other cases here
		*) echo &#34;invalid option - </span><span>$1</span><span>&#34; ; _usage ;;	
	esac
}
</span><span>EOF	
</span>	<span>chmod </span>u+x <span>$1</span>
	<span>$EDITOR</span> <span>$1</span>
<span>}</span>
</code></pre>

<p>This function contains simpler help text, as there are no additional commands. The heredoc delimiter <code>EOF</code> is wrapped with single quotes to prevent execution of the variables within the heredoc (<code>$*</code>, <code>$@</code>,<code>$1</code>).</p><hr/>

<p>Thanks for tuning in to another episode of &#34;things I didn&#39;t plan to work on&#34;! It&#39;s interesting how I get more post ideas from side quests rather than the main ones ðŸ˜…</p>

<p>You can find all the above scripts (and more, whenever I make them) at <a href="https://github.com/pjg11/scripts">pjg11/scripts</a>.</p>

</div></div>
  </body>
</html>
