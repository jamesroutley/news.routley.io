<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.infoq.com/news/2023/03/java-20-so-far/">Original</a>
    <h1>JDK 20 and JDK 21: What we know so far</h1>
    
    <div id="readability-page-1" class="page"><div>
								<p><a href="https://openjdk.java.net/projects/jdk/20/">JDK 20</a>, the third non-LTS release since <a href="https://www.infoq.com/news/2021/09/java17-released/">JDK 17</a>, has reached its initial release candidate phase as <a href="https://mail.openjdk.org/pipermail/jdk-dev/2023-February/007364.html">declared</a> by <a href="https://www.linkedin.com/in/markreinhold">Mark Reinhold</a>, chief architect, Java Platform Group at Oracle. The main-line source repository, forked to the JDK <a href="https://github.com/openjdk/jdk19">stabilization repository</a> in mid-December 2022 (Rampdown Phase One), defines the feature set for JDK 20. Critical bugs, such as regressions or serious functionality issues, may be addressed, but must be approved via the <a href="https://openjdk.java.net/jeps/3#Fix-Request-Process">Fix-Request</a> process. As per the <a href="https://openjdk.org/projects/jdk/19/#Schedule">release schedule</a>, JDK 20 will be formally released on March 21, 2023. It is worth noting that JEP 438 was added to the feature set in early March 2023.</p>

<p>The final set of seven (7) new features, in the form of <a href="https://openjdk.java.net/jeps/0">JEPs</a>, can be separated into two (2) categories: <strong>Core Java Library</strong> and <strong>Java Specification</strong>.</p>

<p>Five (5) of these new features are categorized under the <strong>Core Java Library</strong>:</p>

<ul>
	<li>JEP 429: <a href="https://openjdk.java.net/jeps/429">Scoped Values (Incubator)</a></li>
	<li>JEP 434: <a href="https://openjdk.java.net/jeps/434">Foreign Function &amp; Memory API (Second Preview)</a></li>
	<li>JEP 436: <a href="https://openjdk.java.net/jeps/436">Virtual Threads (Second Preview)</a></li>
	<li>JEP 437: <a href="https://openjdk.java.net/jeps/437">Structured Concurrency (Second Incubator)</a></li>
	<li>JEP 438: <a href="https://openjdk.org/jeps/438">Vector API (Fifth Incubator)</a></li>
</ul>

<p>Two (2) of these new features are categorized under the <strong>Java Specification</strong>:</p>

<ul>
	<li>JEP 432: <a href="https://openjdk.java.net/jeps/432">Record Patterns (Second Preview)</a></li>
	<li>JEP 433: <a href="https://openjdk.java.net/jeps/433">Pattern Matching for switch (Fourth Preview)</a></li>
</ul>

<p>We examine these new features and include where they fall under the auspices of the four major Java projects - <a href="https://openjdk.java.net/projects/amber/">Amber</a>, <a href="https://wiki.openjdk.java.net/display/loom">Loom</a>, <a href="https://openjdk.java.net/projects/panama/">Panama</a> and <a href="https://openjdk.java.net/projects/valhalla/">Valhalla</a> - designed to incubate a series of components for eventual inclusion in the JDK through a curated merge.</p>

<h4>Project Amber</h4>

<p>JEP 432, <a href="https://openjdk.org/jeps/432">Record Patterns (Second Preview)</a>, incorporates enhancements in response to feedback from the previous round of <a href="https://openjdk.java.net/jeps/12">preview</a>, JEP 405, <a href="https://openjdk.org/jeps/405">Record Patterns (Preview)</a>. This proposes to enhance the language with <em>record patterns</em> to deconstruct record values. Record patterns may be used in conjunction with <em>type patterns</em> to &#34;enable a powerful, declarative, and composable form of data navigation and processing.&#34; Type patterns were recently extended for use in <strong><code>switch</code></strong> case labels via: JEP 406, <a href="https://openjdk.java.net/jeps/406">Pattern Matching for switch (Preview)</a>, delivered in JDK 17; and JEP 420, <a href="https://openjdk.java.net/jeps/420">Pattern Matching for switch (Second Preview)</a>, delivered in JDK 18. Changes from JEP 405 include: added support for inference of type arguments of generic record patterns; added support for record patterns to appear in the header of an enhanced for statement; and remove support for named record patterns.</p>

<p>Similarly, JEP 433, <a href="https://openjdk.org/jeps/433">Pattern Matching for switch (Fourth Preview)</a>, incorporates enhancements in response to feedback from the previous three rounds of preview: JEP 427, <a href="https://openjdk.org/jeps/427">Pattern Matching for switch (Third Preview)</a>, delivered in JDK 19; JEP 420, <a href="https://openjdk.java.net/jeps/420">Pattern Matching for switch (Second Preview)</a>, delivered in JDK 18; and JEP 406, <a href="https://openjdk.java.net/jeps/406">Pattern Matching for switch (Preview)</a>, delivered in JDK 17. Changes from JEP 427 include: a simplified grammar for <strong><code>switch</code></strong> labels; and inference of type arguments for generic type patterns and record patterns is now supported in <strong><code>switch</code></strong> expressions and statements along with the other constructs that support patterns.</p>

<h4>Project Loom</h4>

<p>JEP 429, <a href="https://openjdk.org/jeps/429">Scoped Values (Incubator)</a>, an <a href="https://openjdk.java.net/jeps/11">incubating</a> JEP formerly known as <em>Extent-Local Variables (Incubator)</em>, proposes to enable sharing of immutable data within and across threads. This is preferred to thread-local variables, especially when using large numbers of virtual threads.</p>

<p>JEP 436, <a href="https://openjdk.org/jeps/436">Virtual Threads (Second Preview)</a>, proposes a second preview from JEP 425, <a href="https://openjdk.org/jeps/425">Virtual Threads (Preview)</a>, delivered in JDK 19, to allow time for additional feedback and experience for this feature to progress. This feature provides virtual threads, lightweight threads that dramatically reduce the effort of writing, maintaining, and observing high-throughput concurrent applications, to the Java platform. It is important to note that no changes are within this preview except for a small number of APIs from JEP 425 that were made permanent in JDK 19 and, therefore, not proposed in this second preview. More details on JEP 425 may be found in this InfoQ <a href="https://www.infoq.com/news/2022/05/virtual-threads-for-jdk19/">news story</a> and this JEP Café <a href="https://inside.java/2022/06/08/jepcafe11/">screen cast</a> by <a href="https://www.linkedin.com/in/jos%C3%A9-paumard-2458ba5/">José Paumard</a>, Java developer advocate, Java Platform Group at Oracle.</p>

<p>JEP 437, <a href="https://openjdk.org/jeps/437">Structured Concurrency (Second Incubator)</a>, proposes to reincubate this feature from JEP 428, <a href="https://openjdk.org/jeps/428">Structured Concurrency (Incubator)</a>, delivered in JDK 19, to allow time for additional feedback and experience. The intent of this feature is to simplify multithreaded programming by introducing a library to treat multiple tasks running in different threads as a single unit of work. This can streamline error handling and cancellation, improve reliability, and enhance observability. The only change is an updated <strong><code><a href="https://download.java.net/java/early_access/jdk20/docs/api/jdk.incubator.concurrent/jdk/incubator/concurrent/StructuredTaskScope.html">StructuredTaskScope</a></code></strong> class to support the inheritance of scoped values by threads created in a task scope. This streamlines the sharing of immutable data across threads. More details on JEP 428 may be found in this InfoQ <a href="https://www.infoq.com/news/2022/06/java-structured-concurrency/">news story</a>.</p>

<h4>Project Panama</h4>

<p>JEP 434, <a href="https://openjdk.org/jeps/434">Foreign Function &amp; Memory API (Second Preview)</a>, incorporate refinements based on feedback and to provide a second preview from JEP 424, <a href="https://openjdk.org/jeps/424">Foreign Function &amp; Memory API (Preview)</a>, delivered in JDK 19, and the related incubating JEP 419, <a href="https://openjdk.org/jeps/419">Foreign Function &amp; Memory API (Second Incubator)</a>, delivered in JDK 18; and JEP 412, <a href="https://openjdk.org/jeps/412">Foreign Function &amp; Memory API (Incubator)</a>, delivered in JDK 17. This feature provides an API for Java applications to interoperate with code and data outside of the Java runtime by efficiently invoking foreign functions and by safely accessing foreign memory that is not managed by the JVM. Updates from JEP 424 include: the <strong><code><a href="https://docs.oracle.com/en/java/javase/14/docs/api/jdk.incubator.foreign/jdk/incubator/foreign/MemorySegment.html">MemorySegment</a></code></strong> and <strong><code><a href="https://docs.oracle.com/en/java/javase/14/docs/api/jdk.incubator.foreign/jdk/incubator/foreign/MemoryAddress.html">MemoryAddress</a></code></strong> interfaces are now unified, i.e., memory addresses are modeled by zero-length memory segments; and the sealed <strong><code><a href="https://docs.oracle.com/en/java/javase/14/docs/api/jdk.incubator.foreign/jdk/incubator/foreign/MemoryLayout.html">MemoryLayout</a></code></strong> interface has been enhanced to facilitate usage with JEP 427, <a href="https://openjdk.org/jeps/427">Pattern Matching for switch (Third Preview)</a>, delivered in JDK 19.</p>

<p>JEP 438, <a href="https://openjdk.java.net/jeps/438">Vector API (Fifth Incubator)</a>, incorporates enhancements in response to feedback from the previous four rounds of incubation: JEP 426, <a href="https://openjdk.org/jeps/426">Vector API (Fourth Incubator)</a>, delivered in JDK 19; JEP 417, <a href="https://openjdk.java.net/jeps/417">Vector API (Third Incubator)</a>, delivered in JDK 18; JEP 414, <a href="https://openjdk.java.net/jeps/414">Vector API (Second Incubator)</a>, delivered in JDK 17; and JEP 338, <a href="https://openjdk.java.net/jeps/338">Vector API (Incubator)</a>, delivered as an <a href="https://openjdk.java.net/jeps/11">incubator module</a> in JDK 16. This feature proposes to enhance the Vector API to load and store vectors to and from a <strong><code><a href="https://docs.oracle.com/en/java/javase/14/docs/api/jdk.incubator.foreign/jdk/incubator/foreign/MemorySegment.html">MemorySegment</a></code></strong> as defined by JEP 424, <a href="https://openjdk.java.net/jeps/424">Foreign Function &amp; Memory API (Preview)</a>.</p>

<h4>JDK 21</h4>

<p>Scheduled for a GA and next LTS release in September 2023, two (2) JEPs are currently <strong>Proposed to Target</strong> for <a href="https://jdk.java.net/20/">JDK 21</a>.</p>

<p>JEP 430, <a href="https://openjdk.org/jeps/430">String Templates (Preview)</a>, a feature JEP type, proposes to enhance the Java programming language with string templates, which are similar to string literals but which contain embedded expressions that are incorporated into the string template at run time. This feature has been classified as <strong>Proposed to Target</strong> for JDK 21, but has not yet been formally announced with a review date.</p>

<p>JEP 431, <a href="https://openjdk.org/jeps/431">Sequenced Collections</a>, proposes to introduce &#34;a new family of interfaces that represent the concept of a collection whose elements are arranged in a well-defined sequence or ordering, as a structural property of the collection.&#34; This is motivated by the lack of a well-defined ordering and uniform set of operations within the Collections Framework. This feature has been classified as <strong>Proposed to Target</strong> for JDK 21, but has not yet been formally announced with a review date.</p>

<p>We can surmise which additional JEPs have the potential to be included in JDK 21 based on a number of JEP drafts and candidates.</p>

<p><strong>JEP Draft 8303358</strong>, <a href="https://openjdk.org/jeps/8303358">Scoped Values (Preview)</a>, submitted by <a href="https://www.linkedin.com/in/andrew-haley-3546112/">Andrew Haley</a> and <a href="https://www.infoq.com/profile/Andrew-Dinn/">Andrew Dinn</a>, both distinguished engineers at Red Hat, evolves JEP 429, <a href="https://openjdk.org/jeps/429">Scoped Values (Incubator)</a>, delivered in the upcoming release of JDK 20. Formerly known as <em>Extent-Local Variables (Incubator)</em> and under the auspices of <a href="https://wiki.openjdk.java.net/display/loom/Main">Project Loom</a>, this feature proposes to enable sharing of immutable data within and across threads. This is preferred to thread-local variables, especially when using large numbers of virtual threads. And while this draft has not yet reached <strong>Candidate</strong> status, the description explicitly states that this JEP will be added in JDK 21.</p>

<p><strong>JEP Draft 8277163</strong>, <a href="https://openjdk.java.net/jeps/8277163">Value Objects (Preview)</a>, a feature JEP under the auspices of Project Valhalla, proposes the creation of value objects - identity-free value classes that specify the behavior of their instances. This draft is related to JEP 401, <a href="https://openjdk.java.net/jeps/401">Primitive Classes (Preview)</a>, which is still in <strong>Candidate</strong> status.</p>

<p>JEP 435, <a href="https://openjdk.org/jeps/435">Asynchronous Stack Trace VM API</a>, a feature JEP type, proposes to define an efficient API for obtaining asynchronous call traces for profiling from a signal handler with information on Java and native frames.</p>

<p>JEP 401, <a href="https://openjdk.org/jeps/401">Primitive Classes (Preview)</a>, under the auspices of Project Valhalla, introduces developer-declared primitive classes - special kinds of value classes - as defined in the aforementioned Value Objects (Preview) JEP Draft - that define new primitive types.</p>

<p><strong>JEP Draft 8301034</strong>, <a href="https://openjdk.org/jeps/8301034">Key Encapsulation Mechanism API</a>, a feature JEP type, proposes to: satisfy implementations of standard <a href="https://cseweb.ucsd.edu/~btackmann/papers/CoMaTa13b.pdf">Key Encapsulation Mechanism</a> (KEM) algorithms; satisfy use cases of KEM by higher level security protocols; and allow service providers to plug-in Java or native implementations of KEM algorithms. This draft was recently updated to include a major change that eliminates the <strong><code>DerivedKeyParameterSpec</code></strong> class in favor of placing fields in the argument list of the <strong><code>encapsulate(int from, int to, String algorithm)</code></strong> method.</p>

<p><strong>JEP Draft 8283227</strong>, <a href="https://openjdk.org/jeps/8283227">JDK Source Structure</a>, an informational JEP type, describes the overall layout and structure of the JDK source code and related files in the JDK repository. This JEP proposes to help developers adapt to the source code structure as described in JEP 201, <a href="https://openjdk.java.net/jeps/201">Modular Source Code</a>, delivered in JDK 9.</p>

<p><strong>JEP Draft 8280389</strong>, <a href="https://openjdk.org/jeps/8280389">ClassFile API</a>, proposes to provide an API for parsing, generating, and transforming Java class files. This JEP will initially serve as an internal replacement for <a href="https://asm.ow2.io/">ASM</a>, the Java bytecode manipulation and analysis framework, in the JDK with plans to have it opened as a public API. <a href="https://www.linkedin.com/in/briangoetz">Brian Goetz</a>, Java language architect at Oracle, characterized ASM as &#34;an old codebase with plenty of legacy baggage&#34; and provided background information on how this draft will evolve and ultimately replace ASM.</p>

<p><strong>JEP Draft 8278252</strong>, <a href="https://openjdk.org/jeps/8278252">JDK Packaging and Installation Guidelines</a>, an informational JEP, proposed to provide guidelines for creating JDK installers on macOS, Linux and Windows to reduce the risks of collisions among JDK installations by different JDK providers. The intent is to promote a better experience when installing update releases of the JDK by formalizing installation directory names, package names, and other elements of installers that may lead to conflicts.</p>

<p>We anticipate that Oracle will start targeting additional JEPs for JDK 21 very soon.</p>

								









  
    

							</div></div>
  </body>
</html>
