<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/lancedb/lance">Original</a>
    <h1>Show HN: Lance – Alternative to Parquet for ML data</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><div dir="auto">
<p dir="auto">
<a target="_blank" rel="noopener noreferrer nofollow" href="https://user-images.githubusercontent.com/917119/199353423-d3e202f7-0269-411d-8ff2-e747e419e492.png"><img width="257" alt="Lance Logo" src="https://user-images.githubusercontent.com/917119/199353423-d3e202f7-0269-411d-8ff2-e747e419e492.png"/></a>
</p><p dir="auto"><strong>Modern columnar data format for ML. Convert from parquet in 2-lines of code for 100x faster random access, a vector index, data versioning, and more.<br/></strong>
<strong>Compatible with pandas, duckdb, polars, pyarrow, with more integrations on the way.</strong></p>
<p dir="auto"><a href="https://lancedb.github.io/lance/" rel="nofollow">Documentation</a> •
<a href="https://blog.lancedb.com/" rel="nofollow">Blog</a> •
<a href="https://discord.gg/zMM32dvNtd" rel="nofollow">Discord</a> •
<a href="https://twitter.com/lancedb" rel="nofollow">Twitter</a></p>
<p dir="auto"><a href="https://github.com/lancedb/lance/actions/workflows/rust.yml"><img src="https://github.com/lancedb/lance/actions/workflows/rust.yml/badge.svg" alt="CI Badge"/></a>
<a href="https://lancedb.github.io/lance/" rel="nofollow"><img src="https://camo.githubusercontent.com/35586e6cd51cd0091bbbfbc333c414c869b36ed95834b914bce8e15259832cc3/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d70617373696e672d627269676874677265656e" alt="Docs Badge" data-canonical-src="https://img.shields.io/badge/docs-passing-brightgreen"/></a>
<a href="https://crates.io/crates/lance" rel="nofollow"><img src="https://camo.githubusercontent.com/b1624715cbbb30f5438144d67f43e446b2dc401dd3910ab0497c370bd760ac08/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f6c616e63652e737667" alt="crates.io badge" data-canonical-src="https://img.shields.io/crates/v/lance.svg"/></a>
<a href="https://pypi.org/project/pylance/" rel="nofollow"><img src="https://camo.githubusercontent.com/11df64e7c2f9b6b4986a47a27a02959e24c724b414288ae1a7883e904afd9c5c/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f70796c616e6365" alt="Python versions badge" data-canonical-src="https://img.shields.io/pypi/pyversions/pylance"/></a></p>

</div>
<hr/>
<p dir="auto">Lance is a modern columnar data format that is optimized for ML workflows and datasets. Lance is perfect for:</p>
<ol dir="auto">
<li>Building search engines and features stores.</li>
<li>Large-scale ML training requiring high performance IO and shuffles.</li>
<li>Storing, querying, and inspecting deeply nested data for robotics or large blobs like images, point-clouds, and more.</li>
</ol>
<p dir="auto">The key features of Lance include:</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>High-performance random access:</strong> 100x faster than Parquet without sacrificing scan performance.</p>
</li>
<li>
<p dir="auto"><strong>Vector search:</strong> find nearest neighbors in milliseconds and combine OLAP-queries with vector search.</p>
</li>
<li>
<p dir="auto"><strong>Zero-copy, automatic versioning:</strong> manage versions of your data without needing extra infrastructure.</p>
</li>
<li>
<p dir="auto"><strong>Ecosystem integrations:</strong> Apache-Arrow, Pandas, Polars, DuckDB and more on the way.</p>
</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-quick-start" aria-hidden="true" href="#quick-start"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Quick Start</h2>
<p dir="auto"><strong>Installation</strong></p>

<p dir="auto"><strong>Converting to Lance</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="import lance

import pandas as pd
import pyarrow as pa
import pyarrow.dataset

df = pd.DataFrame({&#34;a&#34;: [5], &#34;b&#34;: [10]})
uri = &#34;/tmp/test.parquet&#34;
tbl = pa.Table.from_pandas(df)
pa.dataset.write_dataset(tbl, uri, format=&#39;parquet&#39;)

parquet = pa.dataset.dataset(uri, format=&#39;parquet&#39;)
lance.write_dataset(parquet, &#34;/tmp/test.lance&#34;)"><pre><span>import</span> <span>lance</span>

<span>import</span> <span>pandas</span> <span>as</span> <span>pd</span>
<span>import</span> <span>pyarrow</span> <span>as</span> <span>pa</span>
<span>import</span> <span>pyarrow</span>.<span>dataset</span>

<span>df</span> <span>=</span> <span>pd</span>.<span>DataFrame</span>({<span>&#34;a&#34;</span>: [<span>5</span>], <span>&#34;b&#34;</span>: [<span>10</span>]})
<span>uri</span> <span>=</span> <span>&#34;/tmp/test.parquet&#34;</span>
<span>tbl</span> <span>=</span> <span>pa</span>.<span>Table</span>.<span>from_pandas</span>(<span>df</span>)
<span>pa</span>.<span>dataset</span>.<span>write_dataset</span>(<span>tbl</span>, <span>uri</span>, <span>format</span><span>=</span><span>&#39;parquet&#39;</span>)

<span>parquet</span> <span>=</span> <span>pa</span>.<span>dataset</span>.<span>dataset</span>(<span>uri</span>, <span>format</span><span>=</span><span>&#39;parquet&#39;</span>)
<span>lance</span>.<span>write_dataset</span>(<span>parquet</span>, <span>&#34;/tmp/test.lance&#34;</span>)</pre></div>
<p dir="auto"><strong>Reading Lance data</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="dataset = lance.dataset(&#34;/tmp/test.lance&#34;)
assert isinstance(dataset, pa.dataset.Dataset)"><pre><span>dataset</span> <span>=</span> <span>lance</span>.<span>dataset</span>(<span>&#34;/tmp/test.lance&#34;</span>)
<span>assert</span> <span>isinstance</span>(<span>dataset</span>, <span>pa</span>.<span>dataset</span>.<span>Dataset</span>)</pre></div>
<p dir="auto"><strong>Pandas</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="df = dataset.to_table().to_pandas()
df"><pre><span>df</span> <span>=</span> <span>dataset</span>.<span>to_table</span>().<span>to_pandas</span>()
<span>df</span></pre></div>
<p dir="auto"><strong>DuckDB</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="import duckdb

# If this segfaults, make sure you have duckdb v0.7+ installed
duckdb.query(&#34;SELECT * FROM dataset LIMIT 10&#34;).to_df()"><pre><span>import</span> <span>duckdb</span>

<span># If this segfaults, make sure you have duckdb v0.7+ installed</span>
<span>duckdb</span>.<span>query</span>(<span>&#34;SELECT * FROM dataset LIMIT 10&#34;</span>).<span>to_df</span>()</pre></div>
<p dir="auto"><strong>Vector search</strong></p>
<p dir="auto">Download the sift1m subset</p>
<div dir="auto" data-snippet-clipboard-copy-content="wget ftp://ftp.irisa.fr/local/texmex/corpus/sift.tar.gz
tar -xzf sift.tar.gz"><pre>wget ftp://ftp.irisa.fr/local/texmex/corpus/sift.tar.gz
tar -xzf sift.tar.gz</pre></div>
<p dir="auto">Convert it to Lance</p>
<div dir="auto" data-snippet-clipboard-copy-content="import lance
from lance.vector import vec_to_table
import numpy as np
import struct

nvecs = 1000000
ndims = 128
with open(&#34;sift/sift_base.fvecs&#34;, mode=&#34;rb&#34;) as fobj:
    buf = fobj.read()
    data = np.array(struct.unpack(&#34;&lt;128000000f&#34;, buf[4 : 4 + 4 * nvecs * ndims])).reshape((nvecs, ndims))
    dd = dict(zip(range(nvecs), data))

table = vec_to_table(dd)
uri = &#34;vec_data.lance&#34;
sift1m = lance.write_dataset(table, uri, max_rows_per_group=8192, max_rows_per_file=1024*1024)"><pre><span>import</span> <span>lance</span>
<span>from</span> <span>lance</span>.<span>vector</span> <span>import</span> <span>vec_to_table</span>
<span>import</span> <span>numpy</span> <span>as</span> <span>np</span>
<span>import</span> <span>struct</span>

<span>nvecs</span> <span>=</span> <span>1000000</span>
<span>ndims</span> <span>=</span> <span>128</span>
<span>with</span> <span>open</span>(<span>&#34;sift/sift_base.fvecs&#34;</span>, <span>mode</span><span>=</span><span>&#34;rb&#34;</span>) <span>as</span> <span>fobj</span>:
    <span>buf</span> <span>=</span> <span>fobj</span>.<span>read</span>()
    <span>data</span> <span>=</span> <span>np</span>.<span>array</span>(<span>struct</span>.<span>unpack</span>(<span>&#34;&lt;128000000f&#34;</span>, <span>buf</span>[<span>4</span> : <span>4</span> <span>+</span> <span>4</span> <span>*</span> <span>nvecs</span> <span>*</span> <span>ndims</span>])).<span>reshape</span>((<span>nvecs</span>, <span>ndims</span>))
    <span>dd</span> <span>=</span> <span>dict</span>(<span>zip</span>(<span>range</span>(<span>nvecs</span>), <span>data</span>))

<span>table</span> <span>=</span> <span>vec_to_table</span>(<span>dd</span>)
<span>uri</span> <span>=</span> <span>&#34;vec_data.lance&#34;</span>
<span>sift1m</span> <span>=</span> <span>lance</span>.<span>write_dataset</span>(<span>table</span>, <span>uri</span>, <span>max_rows_per_group</span><span>=</span><span>8192</span>, <span>max_rows_per_file</span><span>=</span><span>1024</span><span>*</span><span>1024</span>)</pre></div>
<p dir="auto">Build the index</p>
<div dir="auto" data-snippet-clipboard-copy-content="sift1m.create_index(&#34;vector&#34;,
                    index_type=&#34;IVF_PQ&#34;, 
                    num_partitions=256,  # IVF
                    num_sub_vectors=16)  # PQ"><pre><span>sift1m</span>.<span>create_index</span>(<span>&#34;vector&#34;</span>,
                    <span>index_type</span><span>=</span><span>&#34;IVF_PQ&#34;</span>, 
                    <span>num_partitions</span><span>=</span><span>256</span>,  <span># IVF</span>
                    <span>num_sub_vectors</span><span>=</span><span>16</span>)  <span># PQ</span></pre></div>
<p dir="auto">Search the dataset</p>
<div dir="auto" data-snippet-clipboard-copy-content="# Get top 10 similar vectors
import duckdb

dataset = lance.dataset(uri)

# Sample 100 query vectors. If this segfaults, make sure you have duckdb v0.7+ installed
sample = duckdb.query(&#34;SELECT vector FROM dataset USING SAMPLE 100&#34;).to_df()
query_vectors = np.array([np.array(x) for x in sample.vector])

# Get nearest neighbors for all of them
rs = [dataset.to_table(nearest={&#34;column&#34;: &#34;vector&#34;, &#34;k&#34;: 10, &#34;q&#34;: q})      
      for q in query_vectors]"><pre><span># Get top 10 similar vectors</span>
<span>import</span> <span>duckdb</span>

<span>dataset</span> <span>=</span> <span>lance</span>.<span>dataset</span>(<span>uri</span>)

<span># Sample 100 query vectors. If this segfaults, make sure you have duckdb v0.7+ installed</span>
<span>sample</span> <span>=</span> <span>duckdb</span>.<span>query</span>(<span>&#34;SELECT vector FROM dataset USING SAMPLE 100&#34;</span>).<span>to_df</span>()
<span>query_vectors</span> <span>=</span> <span>np</span>.<span>array</span>([<span>np</span>.<span>array</span>(<span>x</span>) <span>for</span> <span>x</span> <span>in</span> <span>sample</span>.<span>vector</span>])

<span># Get nearest neighbors for all of them</span>
<span>rs</span> <span>=</span> [<span>dataset</span>.<span>to_table</span>(<span>nearest</span><span>=</span>{<span>&#34;column&#34;</span>: <span>&#34;vector&#34;</span>, <span>&#34;k&#34;</span>: <span>10</span>, <span>&#34;q&#34;</span>: <span>q</span>})      
      <span>for</span> <span>q</span> <span>in</span> <span>query_vectors</span>]</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-directory-structure" aria-hidden="true" href="#directory-structure"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Directory structure</h2>
<table>
<thead>
<tr>
<th>Directory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/lancedb/lance/blob/main/rust">rust</a></td>
<td>Core Rust implementation</td>
</tr>
<tr>
<td><a href="https://github.com/lancedb/lance/blob/main/python">python</a></td>
<td>Python bindings (pyo3)</td>
</tr>
<tr>
<td><a href="https://github.com/lancedb/lance/blob/main/docs">docs</a></td>
<td>Documentation source</td>
</tr>
</tbody>
</table>
<h2 tabindex="-1" dir="auto"><a id="user-content-what-makes-lance-different" aria-hidden="true" href="#what-makes-lance-different"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What makes Lance different</h2>
<p dir="auto">Here we will highlight a few aspects of Lance’s design. For more details, see the full <a href="https://lancedb.github.io/lance/format.html" rel="nofollow">Lance design document</a>.</p>
<p dir="auto"><strong>Vector index</strong>: Vector index for similarity search over embedding space</p>
<p dir="auto"><strong>Encodings</strong>: to achieve both fast columnar scan and sub-linear point queries, Lance uses custom encodings and layouts.</p>
<p dir="auto"><strong>Nested fields</strong>: Lance stores each subfield as a separate column to support efficient filters like “find images where detected objects include cats”.</p>
<p dir="auto"><strong>Versioning</strong>: a Manifest can be used to record snapshots. Currently we support creating new versions automatically via appends, overwrites, and index creation</p>
<p dir="auto"><strong>Fast updates</strong> (ROADMAP): Updates will be supported via write-ahead logs.</p>
<p dir="auto"><strong>Rich secondary indices</strong> (ROADMAP):</p>
<ul dir="auto">
<li>Inverted index for fuzzy search over many label / annotation fields</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-benchmarks" aria-hidden="true" href="#benchmarks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Benchmarks</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-vector-search" aria-hidden="true" href="#vector-search"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Vector search</h3>
<p dir="auto">We used the sift dataset to benchmark our results with 1M vectors of 128D</p>
<ol dir="auto">
<li>For 100 randomly sampled query vectors, we get &lt;1ms average response time (on a 2023 m2 macbook air)</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/lancedb/lance/blob/main/docs/avg_latency.png"><img src="https://github.com/lancedb/lance/raw/main/docs/avg_latency.png" alt="avg_latency.png"/></a></p>
<ol start="2" dir="auto">
<li>ANN is always a trade-off between recall and performance</li>
</ol>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/lancedb/lance/blob/main/docs/recall_vs_latency.png"><img src="https://github.com/lancedb/lance/raw/main/docs/recall_vs_latency.png" alt="avg_latency.png"/></a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-vs-parquet" aria-hidden="true" href="#vs-parquet"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Vs parquet</h3>
<p dir="auto">We create a Lance dataset using the Oxford Pet dataset to do some preliminary performance testing of Lance as compared to Parquet and raw image/xmls. For analytics queries, Lance is 50-100x better than reading the raw metadata. For batched random access, Lance is 100x better than both parquet and raw files.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/lancedb/lance/blob/main/docs/lance_perf.png"><img src="https://github.com/lancedb/lance/raw/main/docs/lance_perf.png" alt=""/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-why-are-you-building-yet-another-data-format" aria-hidden="true" href="#why-are-you-building-yet-another-data-format"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Why are you building yet another data format?!</h2>
<p dir="auto">Machine Learning development cycle involves the steps:</p>
<section data-identity="87ca0215-2248-4e23-b87a-81fe9767ec8d" data-host="https://viewscreen.githubusercontent.com" data-src="https://viewscreen.githubusercontent.com/markdown/mermaid?docs_host=https%3A%2F%2Fdocs.github.com" data-type="mermaid" aria-label="mermaid rendered output container">
  <div data-json="{&#34;data&#34;:&#34;graph LR\n    A[Collection] --&amp;gt; B[Exploration];\n    B --&amp;gt; C[Analytics];\n    C --&amp;gt; D[Feature Engineer];\n    D --&amp;gt; E[Training];\n    E --&amp;gt; F[Evaluation];\n    F --&amp;gt; C;\n    E --&amp;gt; G[Deployment];\n    G --&amp;gt; H[Monitoring];\n    H --&amp;gt; A;\n&#34;}" data-plain="graph LR
    A[Collection] --&gt; B[Exploration];
    B --&gt; C[Analytics];
    C --&gt; D[Feature Engineer];
    D --&gt; E[Training];
    E --&gt; F[Evaluation];
    F --&gt; C;
    E --&gt; G[Deployment];
    G --&gt; H[Monitoring];
    H --&gt; A;
" dir="auto">
    <div dir="auto">
      <pre lang="mermaid" aria-label="Raw mermaid code">graph LR
    A[Collection] --&gt; B[Exploration];
    B --&gt; C[Analytics];
    C --&gt; D[Feature Engineer];
    D --&gt; E[Training];
    E --&gt; F[Evaluation];
    F --&gt; C;
    E --&gt; G[Deployment];
    G --&gt; H[Monitoring];
    H --&gt; A;
</pre>
    </div>
  </div>
  <span role="presentation">
    <svg style="box-sizing: content-box; color: var(--color-icon-primary);" width="16" height="16" viewBox="0 0 16 16" fill="none" data-view-component="true">
  <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-opacity="0.25" stroke-width="2" vector-effect="non-scaling-stroke"></circle>
  <path d="M15 8a7.002 7.002 0 00-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke"></path>
</svg>
  </span>
</section>

<p dir="auto">People use different data representations to varying stages for the performance or limited by the tooling available.
The academia mainly uses XML / JSON for annotations and zipped images/sensors data for deep learning, which
is difficult to integrated into data infrastructure and slow to train over cloud storage.
While the industry uses data lake (Parquet-based techniques, i.e., Delta Lake, Iceberg) or data warehouse (AWS Redshift
or Google BigQuery) to collect and analyze data, they have to convert the data into training-friendly formats, such
as <a href="https://github.com/eto-ai/rikai">Rikai</a>/<a href="https://github.com/uber/petastorm">Petastorm</a>
or <a href="https://www.tensorflow.org/tutorials/load_data/tfrecord" rel="nofollow">Tfrecord</a>.
Multiple single-purpose data transforms, as well as syncing copies between cloud storage to local training
instances have become a common practice among ML practices.</p>
<p dir="auto">While each of the existing data formats excel at its original designed workload, we need a new data format
to tailored for multistage ML development cycle to reduce the fraction in tools and data silos.</p>
<p dir="auto">A comparison of different data formats in each stage of ML development cycle.</p>
<table>
<thead>
<tr>
<th></th>
<th>Lance</th>
<th>Parquet &amp; ORC</th>
<th>JSON &amp; XML</th>
<th>Tfrecord</th>
<th>Database</th>
<th>Warehouse</th>
</tr>
</thead>
<tbody>
<tr>
<td>Analytics</td>
<td>Fast</td>
<td>Fast</td>
<td>Slow</td>
<td>Slow</td>
<td>Decent</td>
<td>Fast</td>
</tr>
<tr>
<td>Feature Engineering</td>
<td>Fast</td>
<td>Fast</td>
<td>Decent</td>
<td>Slow</td>
<td>Decent</td>
<td>Good</td>
</tr>
<tr>
<td>Training</td>
<td>Fast</td>
<td>Decent</td>
<td>Slow</td>
<td>Fast</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr>
<td>Exploration</td>
<td>Fast</td>
<td>Slow</td>
<td>Fast</td>
<td>Slow</td>
<td>Fast</td>
<td>Decent</td>
</tr>
<tr>
<td>Infra Support</td>
<td>Rich</td>
<td>Rich</td>
<td>Decent</td>
<td>Limited</td>
<td>Rich</td>
<td>Rich</td>
</tr>
</tbody>
</table>
<h2 tabindex="-1" dir="auto"><a id="user-content-community-highlights" aria-hidden="true" href="#community-highlights"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Community Highlights</h2>
<p dir="auto">Lance is currently used in production by:</p>
<ul dir="auto">
<li><a href="https://github.com/lancedb/lancedb">LanceDB</a>, a serverless, low-latency vector database for ML applications</li>
<li>Self-driving car company for large-scale storage, retrieval and processing of multi-modal data.</li>
<li>E-commerce company for billion-scale+ vector personalized search.</li>
<li>and more.</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-presentations-and-talks" aria-hidden="true" href="#presentations-and-talks"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Presentations and Talks</h2>
<ul dir="auto">
<li><a href="https://docs.google.com/presentation/d/1a4nAiQAkPDBtOfXFpPg7lbeDAxcNDVKgoUkw3cUs2rE/edit#slide=id.p" rel="nofollow">Lance: A New Columnar Data Format</a>, <a href="https://www.scipy2022.scipy.org/posters" rel="nofollow">Scipy 2022, Austin, TX</a>. July, 2022.</li>
</ul>
</article>
          </div></div>
  </body>
</html>
