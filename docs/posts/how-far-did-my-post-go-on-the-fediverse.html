<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://shkspr.mobi/blog/2023/09/how-far-did-my-post-go-on-the-fediverse/">Original</a>
    <h1>How far did my post go on the Fediverse?</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="https://schema.org/articleBody"><p>I wrote a moderately popular post on Mastodon. Lots of people shared it. Is it possible to find out how many different ActivityPub servers it went to?</p><p>Yes!</p><p>As we all know, <a href="https://m.fa.gl/@joshbal4/111048499514776098">the Fediverse is one big chain mail</a>.  I don&#39;t mean that in a derogatory way.</p><p>When I write a post, it appears on my server (called an &#34;instance&#34; in Mastodon-speak).</p><p>Everyone on my instance can see my post.</p><p>My instance looks at all my followers - some of whom are on completely different instances - and sends my post to their instances.</p><p>As an example:</p><ul><li>I am on <code>mastodon.social</code></li><li>John is on <code>eggman_social.com</code></li><li>Paul is on <code>penny_lane.co.uk</code></li><li>Both John and Paul follow me. So my post gets syndicated to their servers.</li></ul><p>With me so far?</p><p>What happens when someone shares (reposts) my status?</p><ul><li>John is on <code>eggman_social.com</code></li><li>Ringo is on <code>liverpool.drums</code></li><li>Ringo follows John</li><li>John reposts my status.</li><li><code>eggman_social.com</code> syndicates my post to <code>liverpool.drums</code></li></ul><p>And so my post goes around the Fediverse!  But can I see where it has gone?  Well... sort of! Let&#39;s look at how.</p><h2 id="a-note-on-privacy"><a href="#a-note-on-privacy">A note on privacy</a></h2><p>People on Mastodon and the Fediverse tend to be privacy conscious. So there are limits - both in the API and the culture - as to what is acceptable.</p><p>Some people don&#39;t share their &#34;social graph&#34;. That is, it is impossible to see who follows them or who they follow.</p><p>Users can choose to opt-in or -out of publicly sharing their social graph. They remain in control of their privacy.</p><p>In the example above, if Ringo were to reshare John&#39;s reshare of my status - John doesn&#39;t know about it. Only the original poster (me) gets notified. If John doesn&#39;t share his social graph, it <em>might</em> be possible to work out where Ringo saw the status - but that&#39;s rather unlikely.</p><p>Mastodon has an API rate limit which only allows 80 results per request and 1 request per second. That makes it long and tedious to crawl thousands of results.</p><p>Similarly, some instances do not share their social data or expose anything of significance. Some servers may no longer exist, or might have changed names. It&#39;s impossible to get a comprehensive view of the entire Fediverse network.</p><p>And that&#39;s OK! People should be able to set limits on what others can do with their data.  The code you&#39;re about to see doesn&#39;t attempt to breach anyone&#39;s privacy. All it does is show me which servers picked up my post. This is information which is already shown to me - but this makes it slightly easier to see.</p><h2 id="the-result"><a href="#the-result">The Result</a></h2><p>I looked at <a href="https://mastodon.social/@Edent/111040801202691232">this post of mine</a> which was reposted over 100 times.</p><p>It eventually found its way to… <strong>2,547</strong> instances!</p><p>Ranging from <code>0ab.uk</code> to <code>թութ.հայ</code> via <code>godforsaken.website</code> and many more!</p><p>And that&#39;s one of the things which makes me hopeful this rebellion will succeed. There are a thousand points of light out there - each a shining beacon to doing things differently. And, the more the social media giants tighten their grip, the more these systems will slip through their fingers.</p><h2 id="the-code"><a href="#the-code">The Code</a></h2><p>This is not very efficient code - nor well written. It was designed to scratch an itch.  It uses <a href="https://mastodonpy.readthedocs.io">Mastodon.py</a> to interact with the API.</p><p>It gets the instance names of all my followers. Then the instance names of everyone who reposted one of <em>my</em> posts.</p><p>But it cannot get the instance names of <em>everyone</em> who follows the users who reposted me - because:</p><p>But I can get the instance name of the followers of accounts on my instance who reposted me. Clear?</p><p>I can also get a list of everyone who favourited my post. If they aren&#39;t on my instance, or one of my reposter&#39;s follower&#39;s instances, they&#39;re probably from a reposter who isn&#39;t on my instance.</p><p>My head hurts.</p><p>Got it? Here we go!</p><pre><code>import config
from mastodon import Mastodon
from rich.pretty import pprint

#  Set up access
mastodon = Mastodon( api_base_url=config.instance, access_token=config.access_token, ratelimit_method=&#39;pace&#39; )

#  Status to check for
status_id = 111040801202691232
print(&#34;Looking up status: &#34; + str(status_id))

#  Get my data
me = mastodon.me()
my_id = me[&#34;id&#34;]
print(&#34;You have User ID: &#34; + str(my_id))

#  Empty sets
instances_all        = set()
instances_followers  = set()
instances_reposters  = set()
instances_reposters_followers  = set()
instances_favourites = set()

#  My Followers
followers = mastodon.account_followers( my_id )
print( &#34;Getting all followers&#34; )
followers_all = mastodon.fetch_remaining( followers )
print(&#34;Total followers = &#34; + str( len(followers_all) ) )

#  Get the server names of all my followers
for follower in followers_all:
    if ( &#34;@&#34; in follower[&#34;acct&#34;]) :
        f = follower[&#34;acct&#34;].split(&#34;@&#34;)[1]
        instances_all.add( f )
        if ( f not in instances_followers):
            print( &#34;Follower: &#34; + f )
            instances_followers.add( f )
    else :
        instances_all.add( &#34;mastodon.social&#34; )
        instances_followers.add( &#34;mastodon.social&#34; )
total_followers  = len(instances_followers)
print( &#34;Total Unique Followers Instances = &#34; + str(total_followers)  )

#  Reposters
#  Find the accounts which reposted my status
reposters     = mastodon.status_reblogged_by( status_id )
reposters_all = mastodon.fetch_remaining(reposters)

#  Get all the instance names of my reposters
for reposter in reposters_all:
    if ( &#34;@&#34; in reposter[&#34;acct&#34;]) :
        r = reposter[&#34;acct&#34;].split(&#34;@&#34;)[1]
        instances_all.add( r )
        if ( r not in instances_followers ) :
            print( &#34;Reposter: &#34; + r )
            instances_reposters.add( r )
total_reposters  = len(instances_reposters)
print( &#34;Total Unique Reposters Instances = &#34; + str(total_reposters)  )

# Followers of reposters     
# This can take a *long* time!   
for reposter in reposters_all:   
    if ( &#34;@&#34; not in reposter[&#34;acct&#34;]) :  
        reposter_id = reposter[&#34;id&#34;]
        print( &#34;Getting followers of reposter &#34; + reposter[&#34;acct&#34;] + &#34; with ID &#34; + str(reposter_id) )
        reposter_followers = mastodon.account_followers( reposter_id )   
        reposter_followers_all = mastodon.fetch_remaining( reposter_followers )  
        for reposter_follower in reposter_followers_all:    
            if ( &#34;@&#34; in reposter_follower[&#34;acct&#34;]) : 
                f = reposter_follower[&#34;acct&#34;].split(&#34;@&#34;)[1]
                instances_all.add( f )
                if (f not in instances_reposters_followers) :
                    print( &#34;   Adding &#34; + f + &#34; from &#34; + reposter[&#34;acct&#34;] )
                    instances_reposters_followers.add( f )   
total_instances_reposters_followers  = len(instances_reposters_followers)
print( &#34;Total Unique Reposters&#39; Followers Instances = &#34; + str(total_instances_reposters_followers)  )

#  Favourites
#  Find the accounts which favourited my status
favourites     = mastodon.status_favourited_by( status_id )
favourites_all = mastodon.fetch_remaining(favourites)

#  Get all the instance names of my favourites
for favourite in favourites_all:
    if ( &#34;@&#34; in favourite[&#34;acct&#34;]) :
        f = favourite[&#34;acct&#34;].split(&#34;@&#34;)[1]
        instances_all.add( f )
        if ( f not in instances_favourites ) :
            print( &#34;Favourite: &#34; + f )
            instances_favourites.add( r )
total_favourites = len(instances_favourites)

print( &#34;Total Unique Favourites Instances  = &#34; + str(total_favourites) )
print( &#34;Total Unique Reposters Instances = &#34; + str(total_reposters)  )
print( &#34;Total Unique Followers Instances = &#34; + str(total_followers)  )
print( &#34;Total Unique Reposters&#39; Followers Instances = &#34; + str( len(instances_reposters_followers) ) )
print( &#34;Total Unique Instances = &#34; + str( len(instances_all) ) )
</code></pre></div></div>
  </body>
</html>
