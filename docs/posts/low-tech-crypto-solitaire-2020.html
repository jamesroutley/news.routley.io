<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://alicegg.tech//2020/01/03/solitaire.html">Original</a>
    <h1>Low Tech Crypto: Solitaire (2020)</h1>
    
    <div id="readability-page-1" class="page"><article itemscope="" itemtype="http://schema.org/BlogPosting">
	<div itemprop="articleBody">
		<p>In a previous post, I talked about the <a href="https://alicegg.tech/2019/09/13/one-time-pad">One-Time Pad</a>, as an example of cryptography that’s achievable without a computer.
It’s a very simple, yet perfectly secure cryptographic algorithm, that comes with a lot of practical limitations, the biggest one being that it requires a truly random key as long as the text you want to encrypt (the plaintext).
The good news is that cryptographers have been hard at work creating algorithms that are more usable while still providing privacy.</p>

<p>Solitaire, an algorithm made by Bruce Schneier in 1999 is definitely the most famous of the low-tech cryptography algorithm since it was featured in Neal Stephenson’s book Cryptonomicon under the name “Pontifex”.
As its name suggests, it uses a deck of cards to encrypt and decrypt messages.</p>

<figure>
	<img src="https://alicegg.tech/assets/2020-01-03-solitaire/deck.jpg" alt="A regular card deck" width="70%"/>
	<figcaption>
		Illustraton by <a href="https://unsplash.com/@adityachinchure?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Aditya Chinchure</a>
	</figcaption>
</figure>



<p>Solitaire is a stream cipher, which means it works just like the one-time pad, except instead of using a truly random key for the whole length of the plaintext, they generate a pseudo-random keystream from a smaller key.
In this case, our base key is a shuffled deck of 54 cards, with two differentiable jokers (we will call them A and B).</p>

<p>Let’s say we have the thoroughly shuffled deck of cards below and want to encrypt the message <code>HAPPY NEW YEAR</code>:</p>

<table>
	<tbody><tr>
		<td>49</td>
		<td>50</td>
		<td>51</td>
		<td>3</td>
		<td>4</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
		<td>1</td>
	</tr>
	<tr>
		<td>10</td>
		<td>11</td>
		<td>12</td>
		<td>52</td>
		<td>15</td>
		<td>16</td>
		<td>17</td>
		<td>18</td>
		<td>19</td>
	</tr>
	<tr>
		<td>20</td>
		<td>21</td>
		<td>2</td>
		<td>9</td>
		<td>26</td>
		<td>27</td>
		<td>28</td>
		<td>29</td>
		<td>30</td>
	</tr>
	<tr>
		<td>31</td>
		<td>32</td>
		<td>33</td>
		<td>34</td>
		<td>35</td>
		<td>36</td>
		<td>37</td>
		<td>38</td>
		<td>39</td>
	</tr>
	<tr>
		<td>40</td>
		<td>41</td>
		<td>42</td>
		<td>43</td>
		<td>44</td>
		<td>45</td>
		<td>23</td>
		<td><SPAN color="red">A</SPAN></td>
		<td>14</td>
	</tr>
	<tr>
		<td>22</td>
		<td>8</td>
		<td>24</td>
		<td>25</td>
		<td><SPAN color="green">B</SPAN></td>
		<td>46</td>
		<td>47</td>
		<td>48</td>
		<td>13</td>
	</tr>
</tbody></table>

<p><strong>Step 0</strong>: First we need to format the message into blocks of 5 characters (pad it with X if necessary) to avoid leaking pieces of informations. This gives us: <code>HAPPY NEWYE ARXXX</code>.
We will then use a number representation of this plaintext.</p>
<table>
	<tbody><tr>
		<td>H</td>
		<td>A</td>
		<td>P</td>
		<td>P</td>
		<td>Y</td>
		<td>N</td>
		<td>E</td>
		<td>W</td>
		<td>Y</td>
		<td>E</td>
		<td>A</td>
		<td>R</td>
		<td>X</td>
		<td>X</td>
		<td>X</td>
	</tr>
	<tr>
		<td>8</td>
		<td>1</td>
		<td>16</td>
		<td>16</td>
		<td>25</td>
		<td>14</td>
		<td>5</td>
		<td>23</td>
		<td>25</td>
		<td>5</td>
		<td>1</td>
		<td>18</td>
		<td>24</td>
		<td>24</td>
		<td>24</td>
	</tr>
</tbody></table>

<p><strong>Step 1</strong>: We can then start generating the keystream, by taking the joker A and swapping it with the card beneath it. If it’s the last card put it after the first card.</p>
<table>
	<tbody><tr>
		<td>49</td>
		<td>50</td>
		<td>51</td>
		<td>3</td>
		<td>4</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
		<td>1</td>
	</tr>
	<tr>
		<td>10</td>
		<td>11</td>
		<td>12</td>
		<td>52</td>
		<td>15</td>
		<td>16</td>
		<td>17</td>
		<td>18</td>
		<td>19</td>
	</tr>
	<tr>
		<td>20</td>
		<td>21</td>
		<td>2</td>
		<td>9</td>
		<td>26</td>
		<td>27</td>
		<td>28</td>
		<td>29</td>
		<td>30</td>
	</tr>
	<tr>
		<td>31</td>
		<td>32</td>
		<td>33</td>
		<td>34</td>
		<td>35</td>
		<td>36</td>
		<td>37</td>
		<td>38</td>
		<td>39</td>
	</tr>
	<tr>
		<td>40</td>
		<td>41</td>
		<td>42</td>
		<td>43</td>
		<td>44</td>
		<td>45</td>
		<td>23</td>
		<td>14</td>
		<td><SPAN color="red">A</SPAN></td>
	</tr>
	<tr>
		<td>22</td>
		<td>8</td>
		<td>24</td>
		<td>25</td>
		<td><SPAN color="green">B</SPAN></td>
		<td>46</td>
		<td>47</td>
		<td>48</td>
		<td>13</td>
	</tr>
</tbody></table>

<p><strong>Step 2</strong>: You then find joker B and move it the same way two cards down.</p>

<table>
	<tbody><tr>
		<td>49</td>
		<td>50</td>
		<td>51</td>
		<td>3</td>
		<td>4</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
		<td>1</td>
	</tr>
	<tr>
		<td>10</td>
		<td>11</td>
		<td>12</td>
		<td>52</td>
		<td>15</td>
		<td>16</td>
		<td>17</td>
		<td>18</td>
		<td>19</td>
	</tr>
	<tr>
		<td>20</td>
		<td>21</td>
		<td>2</td>
		<td>9</td>
		<td>26</td>
		<td>27</td>
		<td>28</td>
		<td>29</td>
		<td>30</td>
	</tr>
	<tr>
		<td>31</td>
		<td>32</td>
		<td>33</td>
		<td>34</td>
		<td>35</td>
		<td>36</td>
		<td>37</td>
		<td>38</td>
		<td>39</td>
	</tr>
	<tr>
		<td>40</td>
		<td>41</td>
		<td>42</td>
		<td>43</td>
		<td>44</td>
		<td>45</td>
		<td>23</td>
		<td>14</td>
		<td><SPAN color="red">A</SPAN></td>
	</tr>
	<tr>
		<td>22</td>
		<td>8</td>
		<td>24</td>
		<td>25</td>
		<td>46</td>
		<td>47</td>
		<td><SPAN color="green">B</SPAN></td>
		<td>48</td>
		<td>13</td>
	</tr>
</tbody></table>

<p><strong>Step 3</strong>: Swap the cards above the first joker, with the cards below the second joker.</p>
<table>
	<tbody><tr>
		<td>48</td>
		<td>13</td>
		<td><SPAN color="red">A</SPAN></td>
		<td>22</td>
		<td>8</td>
		<td>24</td>
		<td>25</td>
		<td>46</td>
		<td>47</td>
	</tr>
	<tr>
		<td><SPAN color="green">B</SPAN></td>
		<td>49</td>
		<td>50</td>
		<td>51</td>
		<td>3</td>
		<td>4</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
	</tr>
	<tr>
		<td>1</td>
		<td>10</td>
		<td>11</td>
		<td>12</td>
		<td>52</td>
		<td>15</td>
		<td>16</td>
		<td>17</td>
		<td>18</td>
	</tr>
	<tr>
		<td>19</td>
		<td>20</td>
		<td>21</td>
		<td>2</td>
		<td>9</td>
		<td>26</td>
		<td>27</td>
		<td>28</td>
		<td>29</td>
	</tr>
	<tr>
		<td>30</td>
		<td>31</td>
		<td>32</td>
		<td>33</td>
		<td>34</td>
		<td>35</td>
		<td>36</td>
		<td>37</td>
		<td>38</td>
	</tr>
	<tr>
		<td>39</td>
		<td>40</td>
		<td>41</td>
		<td>42</td>
		<td>43</td>
		<td>44</td>
		<td>45</td>
		<td>23</td>
		<td>14</td>
	</tr>
</tbody></table>

<p><strong>Step 4</strong>: Take the value of the bottom card as a number. The simplest way to do that is to use the position of the card in the <a href="https://poker.fandom.com/wiki/Bridge_suits">bridge suit</a> (clubs &lt; diamonds &lt; hearts &lt; spades).
For example 10 of heart is 36 and a 2 of club is just 2. Jokers are both 53.</p>

<p>Use this value as the index where to cut the deck for the next step. Now swap both parts of the cut, without moving the bottom card:</p>
<table>
	<tbody><tr>
		<td>4</td>
		<td>5</td>
		<td>6</td>
		<td>7</td>
		<td>1</td>
		<td>10</td>
		<td>11</td>
		<td>12</td>
		<td>52</td>
	</tr>
	<tr>
		<td>15</td>
		<td>16</td>
		<td>17</td>
		<td>18</td>
		<td>19</td>
		<td>20</td>
		<td>21</td>
		<td>2</td>
		<td>9</td>
	</tr>
	<tr>
		<td>26</td>
		<td>27</td>
		<td>28</td>
		<td>29</td>
		<td>30</td>
		<td>31</td>
		<td>32</td>
		<td>33</td>
		<td>34</td>
	</tr>
	<tr>
		<td>35</td>
		<td>36</td>
		<td>37</td>
		<td>38</td>
		<td>39</td>
		<td>40</td>
		<td>41</td>
		<td>42</td>
		<td>43</td>
	</tr>
	<tr>
		<td>44</td>
		<td>45</td>
		<td>23</td>
		<td>48</td>
		<td>13</td>
		<td><SPAN color="red">A</SPAN></td>
		<td>22</td>
		<td>8</td>
		<td>24</td>
	</tr>
	<tr>
		<td>25</td>
		<td>46</td>
		<td>47</td>
		<td><SPAN color="green">B</SPAN></td>
		<td>49</td>
		<td>50</td>
		<td>51</td>
		<td>3</td>
		<td>14</td>
	</tr>
</tbody></table>

<p><strong>Step 5</strong>: To find the output value, use the value of the top card as the index of the output card.
If the output card is not a joker, write down its value. Start back with the deck in its current state at step 1 until you have as many numbers in your keystream as letters in your plaintext.</p>

<p>In our example, we find the following keystream:</p>

<table>
	<tbody><tr>
		<td>1</td>
		<td>34</td>
		<td>29</td>
		<td>35</td>
		<td>39</td>
		<td>46</td>
		<td>11</td>
		<td>12</td>
		<td>29</td>
		<td>50</td>
		<td>24</td>
		<td>26</td>
		<td>45</td>
		<td>6</td>
		<td>6</td>
	</tr>
</tbody></table>

<p><strong>Step 7</strong>: Add your keystream to your plaintext (as numbers) modulo 26 to obtain the ciphertext:</p>
<table>
	<tbody><tr>
		<td>8</td>
		<td>1</td>
		<td>16</td>
		<td>16</td>
		<td>25</td>
		<td>14</td>
		<td>5</td>
		<td>23</td>
		<td>25</td>
		<td>5</td>
		<td>1</td>
		<td>18</td>
		<td>24</td>
		<td>24</td>
		<td>24</td>
	</tr>
	<tr>
		<td>1</td>
		<td>34</td>
		<td>29</td>
		<td>35</td>
		<td>39</td>
		<td>46</td>
		<td>11</td>
		<td>12</td>
		<td>29</td>
		<td>50</td>
		<td>24</td>
		<td>26</td>
		<td>45</td>
		<td>6</td>
		<td>6</td>
	</tr>
	<tr>
		<td>I</td>
		<td>I</td>
		<td>S</td>
		<td>Y</td>
		<td>L</td>
		<td>H</td>
		<td>P</td>
		<td>I</td>
		<td>B</td>
		<td>C</td>
		<td>Y</td>
		<td>R</td>
		<td>Q</td>
		<td>D</td>
		<td>A</td>
	</tr>
</tbody></table>

<p>You can now safely send <code>IISYL HPIBC YRQDA</code> to anyone who has a deck shuffled in the same order as yours.
To decrypt it, you will need to generate the same keystream and subtract it to the ciphertext you just produced.</p>

<figure>
	<img src="https://alicegg.tech/assets/2020-01-03-solitaire/pen.jpg" alt="A regular card deck" width="100%"/>
	<figcaption>
		Illustraton by <a href="https://unsplash.com/@aaronburden?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Aaron Burden</a>
	</figcaption>
</figure>



<p>Solitaire is a great low-tech cipher since it’s both practically secure and uses items that are both easy to find and unsuspicious.
However, there are a few limitations to keep in mind while using this cipher:</p>

<ol>
  <li>You should <strong>never use the same key twice</strong>, as it would allow an attacker to gather information about your messages without even knowing the key.</li>
  <li>You should only encrypt small messages with it.
<a href="https://arxiv.org/abs/1909.06300">A recent analysis of Solitaire</a> found that it leaks information at a rate of 0.0005 bits per character, while this is reasonably safe for encoding you 140 character long tweet, it isn’t safe to use for your copy of War and Peace.</li>
  <li>You still need to be careful about any extra information you could give to an attacker, especially notes you take of the keystream, or decks that you used / intent to use, as those can be used to crack your messages.</li>
</ol>

<p>If you want a more complete overview of Solitaire, I recommend the lecture of the original <a href="https://www.schneier.com/academic/solitaire/">Bruce Schneier’s article on it</a>.
If code talks to you more than English, I made a small Python implementation of Solitaire that can be useful for testing purposes, <a href="https://github.com/zer0tonin/solitaire">you can find it on GitHub</a>.</p>

	</div>
</article></div>
  </body>
</html>
