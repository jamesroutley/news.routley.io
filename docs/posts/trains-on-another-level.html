<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://factorio.com/blog/post/fff-378">Original</a>
    <h1>Trains on another level</h1>
    
    <div id="readability-page-1" class="page"><div>
        <p>
  Hello!</p>

<p>
  As explained last week, we can now define any kind of rail shape, and we had some very specific shapes in mind all along...
</p>

<hr/>
<h3>Over or under?</h3>

<p>
  We want multi-level crossings for trains, but how? Bridges or tunnels?
</p>

<p>
  At first it would seem like going underground is the safer bet - we already have experience with belts and pipes doing that. Simple - we draw the entrance and the exit, the middle is magically connected, and that&#39;s it?
</p>

<ul>
    <li>The second layer of rails should also be able to use curves and rail signals, otherwise it would be quite limited.
    </li><li>Sometimes you already want to interact with items inside of underground belts, with trains this would be a lot worse as they can run out of fuel, stop at signals etc.
    </li><li>Building curves, signals or interacting with trains inside of a tunnel probably means we need to be able to walk inside.
    </li><li>If we can walk in a tunnel, biters and robots should be able to as well.
    </li><li>If tunnels can have curves, how could you tell which tunnel entrance connects to which exit when looking from the outside?
    </li><li>Tunnels &#34;over&#34; water don&#39;t quite feel right.
    </li><li>Drawing tunnels would be surprisingly difficult as we would need to do some expensive masking that Factorio isn&#39;t currently capable of.
    </li><li>And more...
  </li></ul>


<p>
  The idea of an elevated rail seems to have much more potential, although drawing in an upper layer certainly won&#39;t be easy either.
  </p>

<p>
  Such an idea would consist of:
  </p><ul>
    <li><strong>Rail ramp</strong> - The transition between the lower and upper layer.
    </li><li><strong>Elevated rail</strong> - Tracks buildable above most things.
    </li><li><strong>Rail support</strong> - Elevated rails would need supports at some intervals.
  </li></ul>


<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-elevated-rail-idea.png"/>
  </p>

<hr/>
<h3>Elevated rails</h3>

<p>
  I know you&#39;ve already scrolled down to see the ramps instead of reading this but it just felt weird not to put a
  paragraph here.
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-ramp.png"/>
</p>

<p>
  When we thought about the visual design with Albert and Earendel, we wanted the ramp to be heavy and industrial, but
  at the same time not quite perfectly stable and rigid. After multiple iterations we have arrived to this combination
  of a solid concrete base combined with an upper metal structure.
</p>


<p>
  The concrete base helps clearly show where the ramp touches the ground, while in contrast the metal part has a lot of holes so you could see entities placed behind the ramp most of the time. The metal is painted red, as mostly the only other red entities in Factorio are related to trains, it helps the elevated rails belong to the train family, and stand out in the factory - as they should with their height.
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-ramp-collision-boxes.png"/>
</p>

<p>
  The rail ramp is the new longest entity in the game at 16 tiles long and 4 tiles wide, so you will need to consider where and when to place it. It can only rotate in 4 directions.
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-support.png"/>
</p>

<p>
  The rail support follows the style of the ramp, but with the difference that it can be rotated in 8 directions.
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-rail-support-collision-boxes.png"/>
</p>

<p>
  It has a roughly 4x4 collision box, with the rotated ones all having the same shape.
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-elevated-rails.png"/>
</p>

<p>
  The elevated rails can be built between ramps, held by rail supports along the way.
</p>
<p>
  The elevated rail can be constructed above anything except tall entities (rocket silo, roboport, big electric pole, etc.).
</p>
<p>
  They have exactly the same rail shapes as the new ground rails do, and signals can be attached to the elevated rails.
</p>
<p>
  There are fences which help visually distinguish the elevated rails from ground rails, you can also see how they disappear on track crossings.
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-junction-simple.png"/>
  </p>

<p>
    <video autoplay="" muted="" loop="" playsinline="">
        <source src="https://cdn.factorio.com/assets/blog-sync/fff-378-junction-refinery.mp4" type="video/mp4"/>
      Mp4 playback not supported on your device.
    </video>
  </p>
  <p>
    With the ramp being long and since we have &#34;only&#34; two layers, building a fully multilevel junction can get rather large, but the throughput potential is massive.
    </p>


<p>
    <video autoplay="" muted="" loop="" playsinline="">
        <source src="https://cdn.factorio.com/assets/blog-sync/fff-378-junction-furnaces.mp4" type="video/mp4"/>
      Mp4 playback not supported on your device.
    </video>
  </p>
  <p>
    Specifically in arrays of train stops, having the exit and entrance on different levels is a game changer.
  </p>


<p><img src="https://cdn.factorio.com/assets/blog-sync/fff-378-ramps-on-water.png"/>
    <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-ramps-on-landfill.png"/>
  </p>
  <p>
    There is a very special patch that draws under terrain which is visible only in places where the ramps or supports touch water.
  </p>


<p>
    <video autoplay="" muted="" loop="" playsinline="">
        <source src="https://cdn.factorio.com/assets/blog-sync/fff-378-junction-island.mp4" type="video/mp4"/>
      Mp4 playback not supported on your device.
    </video>
  </p>
  <p>
    In case you decide to route your rails through a lake because why not, islands can become opportunities for multi-level crossings.
  </p>



<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-rail-planner-ramp.png"/>
</p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-rail-planner-snapping.png"/>
  </p>

<p>
  <img src="https://cdn.factorio.com/assets/blog-sync/fff-378-rail-planner-obstacles.png"/>
  </p>

<p>
    <video autoplay="" muted="" loop="" playsinline="">
        <source src="https://cdn.factorio.com/assets/blog-sync/fff-378-junction-hell.mp4" type="video/mp4"/>
      Mp4 playback not supported on your device.
    </video>
  </p>
  <p>
    ...as a result, this can happen a lot quicker than you&#39;d think.
  </p>


<hr/>

<h3>Conclusion</h3>
<p>
  Allowing trains to cross paths on different levels has been one of the most requested features for a very long time. We had always felt it makes perfect sense, but trains in Factorio would rarely ever get into serious enough throughput issues to justify adding elevated rails.
</p>
<p>
  The expansion changed this landscape quite a bit though. If we expect players to generally build larger factories than in the base game, train throughput could become an issue, and since you are expected to travel away from the home planet, having a train system that doesn&#39;t deadlock would be more important than ever before.
</p>
<p>
  It&#39;s not hard to guess that implementing this would require a lot of time, and working on the expansion behind closed doors allowed us some breathing room where we could make bigger experiments.
</p>
<p>
  Between boskid with the mechanics and posila with the drawing code, just the programming took a few months. On the graphics side, we could reuse a lot of initial Blender setup from the rework of ground rails, but that didn&#39;t get us very far. The ramps were simply large objects, while the rail supports are a hive of optical hacks as they need to fill their collision boxes. Both the ramps and supports were reworked multiple times to finally get the result that would look and function well.
</p>
<p>
  Especially because of the elevated rail fences, the required sprite count grew very rapidly. This made me use all the tricks in our Blender book and even add completely new Blender Python tools that mostly help with organizing and rendering large amounts of outputs. I got the final iteration to about 90% completion but then it just became too much.
</p>
<p>
  Jerzy already had experience with rail graphics, so I had asked him to help me by finishing the last details and texturing, and then he handled all of the signals and remnants again. It&#39;s hard to overstate how much bravery and mental fortitude was required to &#34;just&#34; jump into the Blend file of the elevated rails, and I&#39;d like to thank him for that, again.
  </p>
<p>
  Between Earendel on concept art, me on most of the 3D process, Jerzy on finishing and together with Albert on re-evaluating multiple major iterarions, the graphics took about 9 months to make. Perhaps we could have taken some simplified route trying to make tunnels work, but we believe the elevated rails offer better gameplay beyond comparison.</p>
<p>
  All of the elevated rails will be <strong>only available with the expansion executable</strong>. Their technology can be researched using Production science packs without the need to go to space or any planets. Elevated rails be will one of the standalone official mods next to Quality and Space Age, so you can play a vanilla-like game with just the elevated rails for example, or other mods can just depend on Elevated rails.
</p>

<hr/>
<p>
  As always, we are looking forward to all the feedback you are about to elevate.
</p>




        

        
    </div></div>
  </body>
</html>
