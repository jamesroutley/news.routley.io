<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://wololo.net/2024/02/01/is-an-18-year-old-vulnerability-the-key-to-the-next-ps5-ps4-jailbreak/">Original</a>
    <h1>FreeBSD 4 Bug may be present in Playstation 4/5</h1>
    
    <div id="readability-page-1" class="page"><div>	
						<div>

<!--nok--><p><img decoding="async" fetchpriority="high" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?resize=768%2C1024&amp;ssl=1" alt="" width="768" height="1024" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?resize=768%2C1024&amp;ssl=1 768w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?resize=225%2C300&amp;ssl=1 225w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?w=1024&amp;ssl=1 1024w" sizes="(max-width: 768px) 100vw, 768px" data-recalc-dims="1"/></p>
<p>What initially looked like a troll might turn out to be an actual PS4/PS5 vulnerability. While people shouldn’t get their hopes up just right now as this might fizzle, it’s more interesting than it initially looked on the surface.</p><!-- ezoic_video_placeholder-under_first_paragraph-854x480-999998-clearholder --><!-- ezoic_video_placeholder-under_first_paragraph-854x480-999998-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-under_first_paragraph-640x360-999998-clearholder --><!-- ezoic_video_placeholder-under_first_paragraph-640x360-999998-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-under_first_paragraph-426x240-999998-clearholder --><!-- ezoic_video_placeholder-under_first_paragraph-426x240-999998-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-under_first_paragraph-384x216-999998-clearholder --><!-- ezoic_video_placeholder-under_first_paragraph-384x216-999998-nonexxxclearxxxblock -->
<p>Discussions about an 18 year old CVE have been making the rounds of PS4/PS5 hacking discords, forums, and Twitter over the past few days. Some people have been claiming that a Network bug disclosed in 2006 could  be leveraged to Jailbreak recent PS4 and PS5 firmwares, and that this might even be the vulnerability (or one of the vulnerabilities in a chain) used by <a href="https://wololo.net/tag">TheFloW</a> in <a href="https://wololo.net/2023/09/23/spoiler-alert-dont-update-theflow-sets-the-ps4-ps5-scene-on-fire-once-again/">one of his most recent PlayStation bug bounties</a>.</p>
<p>Early tests seem to <strong>indicate that a crash is indeed present in PS4 up to 11.00 included, and PS5 8.20 included</strong>. (Which would put the patch for this issue at <a href="https://wololo.net/2023/12/06/ps5-firmware-8-40-and-ps4-11-02-are-out-and-theres-something-interesting-in-there-dont-update/">firmwares PS5 8.40 and PS4 11.02</a>)</p>
<p>I’ll be the first to admit I initially dismissed the original message as a troll, but <strong>it seems the claim has legs</strong>: a PoC (proof of concept) file has been circulating, and multiple people confirm it crashes their PS4 and PS5, up to the firmwares mentioned above. Now, <strong>a crash in itself is certainly not a vulnerability (let alone an exploitable one)</strong>, but this means the claim is now leaving the “troll” territory and becomes worth looking into. And there’s more…</p>
<h2>CVE From 2006 and PS4/PS5 crash PoC</h2>
<p>Before people become overly excited, I’d like to say that <strong>this should still be considered as a rumor, or, at the very least, something that could fizzle, until more skilled devs actually dig into the issue</strong>. However, here’s what happened so far:</p><!-- ezoic_video_placeholder-under_second_paragraph-854x480-999997-clearholder --><!-- ezoic_video_placeholder-under_second_paragraph-854x480-999997-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-under_second_paragraph-640x360-999997-clearholder --><!-- ezoic_video_placeholder-under_second_paragraph-640x360-999997-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-under_second_paragraph-426x240-999997-clearholder --><!-- ezoic_video_placeholder-under_second_paragraph-426x240-999997-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-under_second_paragraph-384x216-999997-clearholder --><!-- ezoic_video_placeholder-under_second_paragraph-384x216-999997-nonexxxclearxxxblock -->
<ul>
<li>An old CVE From 2006 (<a href="https://www.cvedetails.com/cve/CVE-2006-4304/">CVE-2006-4304</a>) was <a href="https://wololo.net/2024/01/26/ps5-update-8-60-is-here-and-guess-what-dont-update/comment-page-1/#comment-6543161">initially reported</a> by some anonymous user to be a “PS4/PS5 KEX” a few days ago. Multiple people, including myself, initially dismissed the claim: “There’s no way a 18-year old FreeBSD 4 bug is present on the PS4 or the PS5, which are based on FreeBSD 9 or above”.</li>
</ul>
<p><img decoding="async" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/initial_claims.png?resize=603%2C339&amp;ssl=1" alt="" width="603" height="339" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/initial_claims.png?w=603&amp;ssl=1 603w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/initial_claims.png?resize=300%2C169&amp;ssl=1 300w" sizes="(max-width: 603px) 100vw, 603px" data-recalc-dims="1"/></p>
<ul>
<li>However, several folks have tested the <a href="https://gist.github.com/RobbedColek/8b0bc9655adc6ad9564ad71453188e37">poc that’s been circulating</a> (Please note that @Colek who provided this PoC on their github is not the person who initially made the claims) and have confirmed that it crashes their PS4/PS5 consoles, up to some specific firmwares (apparently up to PS4 11.00 and PS5 8.20 included).</li>
</ul>
<p><img decoding="async" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/packet_ps4_ps5_crash.jpg?resize=1024%2C768&amp;ssl=1" alt="" width="1024" height="768" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/packet_ps4_ps5_crash-scaled.jpg?resize=1024%2C768&amp;ssl=1 1024w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/packet_ps4_ps5_crash-scaled.jpg?resize=300%2C225&amp;ssl=1 300w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/packet_ps4_ps5_crash-scaled.jpg?resize=768%2C576&amp;ssl=1 768w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/packet_ps4_ps5_crash-scaled.jpg?resize=1536%2C1152&amp;ssl=1 1536w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/packet_ps4_ps5_crash-scaled.jpg?resize=2048%2C1536&amp;ssl=1 2048w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"/></p>

<div id="attachment_48289"><p><img aria-describedby="caption-attachment-48289" decoding="async" loading="lazy" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?resize=768%2C1024&amp;ssl=1" alt="" width="768" height="1024" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?resize=768%2C1024&amp;ssl=1 768w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?resize=225%2C300&amp;ssl=1 225w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/ps5_crash_test.jpg?w=1024&amp;ssl=1 1024w" sizes="(max-width: 768px) 100vw, 768px" data-recalc-dims="1"/></p><p id="caption-attachment-48289">Screenshots courtesy of hhk2003</p><!-- ezoic_video_placeholder-mid_content-640x360-999996-clearholder --><!-- ezoic_video_placeholder-mid_content-640x360-999996-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-mid_content-426x240-999996-clearholder --><!-- ezoic_video_placeholder-mid_content-426x240-999996-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-mid_content-384x216-999996-clearholder --><!-- ezoic_video_placeholder-mid_content-384x216-999996-nonexxxclearxxxblock --></div>
<p><strong>What the CVE is about</strong>:</p>
<blockquote><p><em>Buffer overflow in the sppp driver in FreeBSD 4.11 through 6.1, NetBSD 2.0 through 4.0 beta before 20060823, and OpenBSD 3.8 and 3.9 before 20060902 allows remote attackers to cause a denial of service (panic), obtain sensitive information, and possibly execute arbitrary code via crafted Link Control Protocol (LCP) packets with an option length that exceeds the overall length, which triggers the overflow in (1) pppoe and (2) ippp.</em></p></blockquote>
<p>This appears to be a bug in the Network stack of FreeBSD/NetBSD. Setting aside for a minute how crazy it would be that an 18 year old vulnerability is still present in modern consoles, at the very least this is an area of the code that we know TheFloW has been investigating a lot in the past (the only known PS5 Kernel exploit was from TheFloW and is related to the Network stack as well).</p>
<p><strong>The poc:</strong></p>
<pre>from scapy.all import PPPoED, Ether, sniff, sendp, srp1, hexdump

source = b&#34;\xXX\xXX\xXX\xXX\xXX\xXX&#34; # MAC address of your adapter on PC
destination = b&#34;\xXX\xXX\xXX\xXX\xXX\xXX&#34; # MAC address of LAN on your PS4
interface = &#34;Realtek PCIe 2.5GbE Family Controller #2&#34; # get via &#34;ipconfig /all&#34; or eth0 or similiar on Linux

packet = sniff(iface=interface, filter=&#34;pppoed&#34;, count=1)
tag_value = packet[PPPoED][0].tag_list[1].tag_value
payload = destination + source + b&#34;\x88\x63\x11\x07\x00\x00\x00\x0c\x01\x03\x00\x08&#34; + tag_value
sendp(payload, iface=interface)

packet = sniff(iface=interface, filter=&#34;pppoed&#34;, count=1)
payload = destination + source + b&#34;\x88\x63\x11\x65\x00\x01\x00\x0c\x01\x03\x00\x08&#34; + tag_value
sendp(payload, iface=interface)

packet = sniff(iface=interface, filter=&#34;pppoes&#34;, count=1)
payload = destination + source + b&#34;\x88\x64\x11\x00\x00\x01\x00\x09\xc0\x21\x01\x01\x00\x07\xab\xff&#34;
packet = srp1(Ether(payload), iface=interface)
print(hexdump(packet))

payload = destination + source + b&#34;\x88\x64\x11\x00\x00\x01\x00\x09\xc0\x21\x01\x01\x00\x07\xab\xff&#34; + b&#34;\xff&#34; * 256 # this number might be different, just a guess
for i in range(20):
sendp(payload, iface=interface)</pre><!-- ezoic_video_placeholder-long_content-854x480-999995-clearholder --><!-- ezoic_video_placeholder-long_content-854x480-999995-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-long_content-640x360-999995-clearholder --><!-- ezoic_video_placeholder-long_content-640x360-999995-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-long_content-426x240-999995-clearholder --><!-- ezoic_video_placeholder-long_content-426x240-999995-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-long_content-384x216-999995-clearholder --><!-- ezoic_video_placeholder-long_content-384x216-999995-nonexxxclearxxxblock -->
<h2>Verdict: Is there a new vulnerability on the PS4/PS5?</h2>
<p>A few thoughts come to mind:</p>
<ul>
<li>In my opinion, if a bug from a CVE has been fixed on some system, it should generally not crash that system after the patch. I understand that in some rare scenarios, a crash is the only way out, but in my experience, most bug fixes intend to handle an error case gracefully. <strong>A crash is not an exploit</strong>, but it is very interesting to see that this code actually crashes the PS4 and PS5
<ul>
<li>A likely explanation, rather than an old bug surfacing, is a new one (or similar one) that happens to be triggered by taking a similar path in the code base.</li>
<li>It is also possible that some bits and pieces of the PS4/PS5 Network stack are not based on FreeBSD, but some other PS4/PS5 specific code that might still have the issue due to not be part of FreeBSD patches.</li>
</ul>
</li>
<li><strong>It is particularly interesting to me that some more recent firmwares do not crash</strong>. This <strong>implies that Sony have fixed some issue, or modified some code in that area, in recent firmwares</strong> (which was actually <a href="https://wololo.net/2023/12/06/ps5-firmware-8-40-and-ps4-11-02-are-out-and-theres-something-interesting-in-there-dont-update/">strongly hinted at</a> when PS4 11.02 and PS5 8.40 were released). This is additional confirmation that this crash could be related to a recent vulnerability that was surfaced to Sony’s engineers (e.g. one of TheFloW’s bugs is not out of the question)</li>
<li>Some people have confirmed that the buggy code does, or did, exist, at some point, in the PS4’s codebase. SlidyBat over at the PS5 R&amp;D discord in particular says that there is indeed some function in the PS4 that seems to use the old buggy code:</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_tests.png?resize=1012%2C491&amp;ssl=1" alt="" width="1012" height="491" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_tests.png?w=1012&amp;ssl=1 1012w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_tests.png?resize=300%2C146&amp;ssl=1 300w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_tests.png?resize=768%2C373&amp;ssl=1 768w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"/></p>
<p><img decoding="async" loading="lazy" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_code_change.png?resize=1024%2C295&amp;ssl=1" alt="" width="1024" height="295" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_code_change.png?resize=1024%2C295&amp;ssl=1 1024w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_code_change.png?resize=300%2C86&amp;ssl=1 300w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_code_change.png?resize=768%2C221&amp;ssl=1 768w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_code_change.png?w=1300&amp;ssl=1 1300w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"/></p>
<p><img decoding="async" loading="lazy" src="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_ps4_code.png?resize=1024%2C575&amp;ssl=1" alt="" width="1024" height="575" srcset="https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_ps4_code.png?resize=1024%2C575&amp;ssl=1 1024w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_ps4_code.png?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_ps4_code.png?resize=768%2C431&amp;ssl=1 768w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_ps4_code.png?resize=1536%2C863&amp;ssl=1 1536w, https://i0.wp.com/wololo.net/wagic/wp-content/uploads/2024/02/slidybat_ps4_code.png?w=1670&amp;ssl=1 1670w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"/></p>
<h2>Download and test the PoC</h2><!-- ezoic_video_placeholder-longer_content-854x480-999994-clearholder --><!-- ezoic_video_placeholder-longer_content-854x480-999994-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-longer_content-640x360-999994-clearholder --><!-- ezoic_video_placeholder-longer_content-640x360-999994-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-longer_content-426x240-999994-clearholder --><!-- ezoic_video_placeholder-longer_content-426x240-999994-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-longer_content-384x216-999994-clearholder --><!-- ezoic_video_placeholder-longer_content-384x216-999994-nonexxxclearxxxblock -->
<p>It is of course <strong>too early to tell if this could lead to anything on the PS4 and PS5</strong>, but for sure this looks <strong>way more interesting than I initially thought </strong>it did, a few days ago. We’re at the very early stages of this, and although this won’t be useful to anyone without the right skills to dig further, it probably doesn’t hurt for people to try and run the PoC on their PS4 and PS5.</p>
<p>Feel free to give it a try and report in the comments whether this crashed your console (and which firmware you’re on).</p>
<p>Please understand that in its current stage, this will only crash your console, and it’s not particularly obvious to set up: you’ll need some basic scripting skills. If you can’t follow the instructions on how to edit the script and run it, I’d strongly suggest you don’t sweat it.</p>
<ol>
<li>Get the Poc here: <a href="https://gist.github.com/RobbedColek/8b0bc9655adc6ad9564ad71453188e37">https://gist.github.com/RobbedColek/8b0bc9655adc6ad9564ad71453188e37</a>
<ul>
<li>Requires Python 3 and Scapy.</li>
</ul>
</li>
<li>Connect your PS4/PS5 directly to PC via LAN cable.</li>
<li>Set up your PS4/PS5 for manual ethernet connection via PPPoE – insert any username/password.</li>
<li>Update the “source”, “destination”, and “interface” details in the script, according to your home PC and target console. &lt;– <strong>If you don’t know how to do that and can’t figure it out, stop right there, this thing isn’t for you and you will not be helpful</strong></li>
<li>Use “Test Internet Connection” on console.</li>
<li>Launch script.</li>
</ol><!-- ezoic_video_placeholder-longest_content-854x480-999993-clearholder --><!-- ezoic_video_placeholder-longest_content-854x480-999993-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-longest_content-640x360-999993-clearholder --><!-- ezoic_video_placeholder-longest_content-640x360-999993-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-longest_content-426x240-999993-clearholder --><!-- ezoic_video_placeholder-longest_content-426x240-999993-nonexxxclearxxxblock --><!-- ezoic_video_placeholder-longest_content-384x216-999993-clearholder --><!-- ezoic_video_placeholder-longest_content-384x216-999993-nonexxxclearxxxblock -->
<p dir="auto">If it worked, it will crash your console.</p>
<h2 dir="auto">Reference</h2>
<ul>
<li>Original claim: https://wololo.net/2024/01/26/ps5-update-8-60-is-here-and-guess-what-dont-update/comment-page-1/#comment-6543161</li>
<li>PoC for PS4/PS5: https://gist.github.com/RobbedColek/8b0bc9655adc6ad9564ad71453188e37</li>
<li>CVE: https://www.cvedetails.com/cve/CVE-2006-4304/</li>
<li>OpenBSD patch to fix the 2006 vulnerability: https://ftp.openbsd.org/pub/OpenBSD/patches/3.8/common/014_sppp.patch</li>
</ul>
<p><em>As always I’ve tried to be accurate and precise in this article. If you notice something is missing or wrong, please let me know in the comments. Thanks</em></p>



													</div>
						

										
					</div></div>
  </body>
</html>
