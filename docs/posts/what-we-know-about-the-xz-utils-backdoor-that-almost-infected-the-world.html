<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/">Original</a>
    <h1>What we know about the xz Utils backdoor that almost infected the world</h1>
    
    <div id="readability-page-1" class="page"><div>
        <header>
            <h4>
      NIGHTMARE SUPPLY CHAIN ATTACK SCENARIO    —
</h4>
            
            <h2 itemprop="description">Malicious updates made to a ubiquitous tool were a few weeks away from going mainstream.</h2>
            <section>

  


  
</section>        </header>
        <section>
            <div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2024/04/malware-800x450.jpg" alt="What we know about the xz Utils backdoor that almost infected the world"/>
      <figcaption><p>Getty Images</p></figcaption>  </figure>

  




<!-- cache hit 205:single/related:b2a8acd50dd36b60ff62d51a1b220d0e --><!-- empty -->
<p>On Friday, a lone Microsoft developer rocked the world when he revealed a <a href="https://arstechnica.com/security/2024/03/backdoor-found-in-widely-used-linux-utility-breaks-encrypted-ssh-connections/">backdoor</a> had been intentionally planted in xz Utils, an open source data compression utility available on almost all installations of Linux and other Unix-like operating systems. The person or people behind this project likely spent years on it. They were likely very close to seeing the backdoor update merged into Debian and Red Hat, the two biggest distributions of Linux, when an eagle-eyed software developer spotted something fishy.</p>
<p>&#34;This might be the best executed supply chain attack we&#39;ve seen described in the open, and it&#39;s a nightmare scenario: malicious, competent, authorized upstream in a widely used library,&#34; software and cryptography engineer Filippo Valsorda <a href="https://bsky.app/profile/filippo.abyssdomain.expert/post/3kouaom62oi2b">said</a> of the effort, which came frightfully close to succeeding.
</p><p>Researchers have spent the weekend gathering clues. Here&#39;s what we know so far.</p>
<p><b>What is xz Utils?</b></p>
<p>xz Utils is nearly ubiquitous in Linux. It provides lossless data compression on virtually all Unix-like operating systems, including Linux. xz Utils provides critical functions for compressing and decompressing data during all kinds of operations. xz Utils also supports the legacy .lzma format, making this component even more crucial.</p>
<p><b>What happened?</b></p>
<p>Andres Freund, a developer and engineer working on Microsoft’s PostgreSQL offerings, was recently troubleshooting performance problems a Debian system was experiencing with SSH, the most widely used protocol for remotely logging in to devices over the Internet. Specifically, SSH logins were consuming too many CPU cycles and were generating errors with <a href="https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/link">valgrind</a>, a utility for monitoring computer memory.</p>
<p>Through a combination of sheer luck and Freund’s careful eye, he eventually discovered the problems were the result of updates that had been made to xz Utils. On Friday, Freund took to the Open Source Security List to disclose the updates were the result of someone intentionally planting a backdoor in the compression software.</p>                                            
                                                        
<p><b>What does the backdoor do?</b></p>
<p>Malicious code added to xz Utils versions 5.6.0 and 5.6.1 modified the way the software functions when performing operations related to lzma compression or decompression. When these functions involved SSH, they allowed for malicious code to be executed with root privileges. This code allowed someone in possession of a predetermined encryption key to log in to the backdoored system over SSH. From then on, that person would have the same level of control as any authorized administrator.</p>
<p><b>How did this backdoor come to be?</b></p>
<p>It would appear that this backdoor was years in the making. In 2021, someone with the username JiaT75 made their <a href="https://github.com/libarchive/libarchive/pull/1609">first known commit</a> to an open source project. In retrospect, the <a href="https://github.com/libarchive/libarchive/pull/1609">change</a> to the libarchive project is suspicious, because it replaced the safe_fprint funcion with a variant that has long been recognized as less secure. No one noticed at the time.</p>
<p>The following year, JiaT75 submitted a patch over the xz Utils mailing list, and, almost immediately, a never-before-seen participant named Jigar Kumar joined the discussion and argued that Lasse Collin, the longtime maintainer of xz Utils, hadn’t been updating the software often or fast enough. Kumar, with the support of Dennis Ens and several other people who had never had a presence on the list, pressured Collin to bring on an additional developer to maintain the project.</p>
<p>In January 2023, JiaT75 made their <a href="https://github.com/tukaani-project/xz/pull/7">first commit</a> to xz Utils. In the months following, JiaT75, who used the name Jia Tan, became increasingly involved in xz Utils affairs. For instance, Tan replaced Collins&#39; contact information with their own on oss-fuzz, a project that scans open source software for vulnerabilities that can be exploited. Tan also requested that oss-fuzz disable the ifunc function during testing, a change that prevented it from detecting the malicious changes Tan would soon make to xz Utils.</p>
<p>In February of this year, Tan issued commits for versions 5.6.0 and 5.6.1 of xz Utils. The updates implemented the backdoor. In the following weeks, Tan or others appealed to developers of Ubuntu, Red Hat, and Debian to merge the updates into their OSes. Eventually, one of the two updates made its way into the following releases, <a href="https://www.tenable.com/blog/frequently-asked-questions-cve-2024-3094-supply-chain-backdoor-in-xz-utils">according to</a> security firm Tenable:</p>

<p>There’s more about Tan and the timeline <a href="https://boehs.org/node/everything-i-know-about-the-xz-backdoor">here</a>.</p>

                                                </div>

            
            
                            <nav>Page: <span>1 <a href="https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/2/">2</a> <a href="https://arstechnica.com/security/2024/04/what-we-know-about-the-xz-utils-backdoor-that-almost-infected-the-world/2/"><span>Next <span>→</span></span></a></span></nav>
            
        </section>
    </div></div>
  </body>
</html>
