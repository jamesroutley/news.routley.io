<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://securelist.com/xz-backdoor-story-part-1/112354/">Original</a>
    <h1>XZ backdoor story – Initial analysis</h1>
    
    <div id="readability-page-1" class="page"><div>
												<div>
													<p>On March 29, 2024, a single <a href="https://www.openwall.com/lists/oss-security/2024/03/29/4" target="_blank" rel="noopener">message</a> on the Openwall OSS-security mailing list marked an important discovery for the information security, open source and Linux communities: the discovery of a malicious backdoor in <strong>XZ</strong>. <strong>XZ </strong>is a compression utility integrated into many popular distributions of Linux.</p>
<p>The particular danger of the backdoored library lies in its use by the OpenSSH server process <strong>sshd</strong>. On several systemd-based distributions, including Ubuntu, Debian and RedHat/Fedora Linux, OpenSSH is patched to use systemd features, and as a result has a dependency on this library (note that Arch Linux and Gentoo are unaffected). The ultimate goal of the attackers was most likely to introduce a remote code execution capability to <strong>sshd</strong> that no one else could use.</p>
<p>Unlike other supply chain attacks we have seen in Node.js, <a href="https://securelist.com/two-more-malicious-python-packages-in-the-pypi/107218/" target="_blank" rel="noopener">PyPI</a>, <a href="https://social.librem.one/@eighthave/112194828562355097" target="_blank" rel="noopener">FDroid</a>, and the Linux <a href="https://lore.kernel.org/lkml/20210421130105.1226686-1-gregkh@linuxfoundation.org/" target="_blank" rel="noopener">Kernel</a> that mostly consisted of atomic malicious patches, fake packages and typosquatted package names, this incident was a multi-stage operation that almost succeeded in compromising SSH servers on a global scale.</p>
<p>The backdoor in the liblzma library was introduced at two levels. The source code of the build infrastructure that generated the final packages was slightly modified (by introducing an additional file <strong>build-to-host.m4</strong>) to extract the next stage script that was hidden in a test case file (<strong>bad-3-corrupt_lzma2.xz</strong>). These scripts in turn extracted a malicious binary component from another test case file (<strong>good-large_compressed.lzma</strong>) that was linked with the legitimate library during the compilation process to be shipped to Linux repositories. Major vendors in turn shipped the malicious component in beta and experimental builds. The compromise of XZ Utils is assigned <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-3094" target="_blank" rel="noopener">CVE-2024–3094</a> with the maximum severity score of 10.</p>
<h2 id="the-timeline-of-events">The timeline of events</h2>
<p>2024.01.19 XZ website moved to GitHub pages by a new maintainer (<a href="https://github.com/JiaT75" target="_blank" rel="noopener">jiaT75</a>)</p>
<h2 id="backdoored-source-distributions">Backdoored source distributions</h2>
<p><strong>xz-5.6.0</strong></p>

<p><strong>xz-5.6.1</strong></p>

<h2 id="initial-infection-analysis">Initial infection analysis</h2>
<p>The XZ git repository contains a set of test files that are used when testing the compressor/decompressor code to verify that it’s working properly. The account named Jia Tan or “<a href="https://github.com/JiaT75" target="_blank" rel="noopener">jiaT75</a>“, <a href="https://github.com/tukaani-project/xz/commit/cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0" target="_blank" rel="noopener">committed</a> two test files that initially appeared harmless, but served as the bootstrap to implant backdoor.</p>
<p>The associated files were:</p>
<ul>
<li><strong>bad-3-corrupt_lzma2.xz</strong> (<a href="https://opentip.kaspersky.com/86fc2c94f8fa3938e3261d0b9eb4836be289f8ae/?utm_source=SL&amp;utm_medium=SL&amp;utm_campaign=SL" target="_blank" rel="noopener">86fc2c94f8fa3938e3261d0b9eb4836be289f8ae</a>)</li>
<li><strong>good-large_compressed.lzma</strong> (<a href="https://opentip.kaspersky.com/540c665dfcd4e5cfba5b72b4787fec4f/?utm_source=SL&amp;utm_medium=SL&amp;utm_campaign=SL" target="_blank" rel="noopener">50941ad9fd99db6fca5debc3c89b3e899a9527d7</a>)</li>
</ul>
<p>These files were intended to contain shell scripts and the backdoor binary object itself. However, they were hidden within the malformed data, and the attacker knew how to properly extract them when needed.</p>
<h3>Stage 1 – The modified <strong>build-to-host</strong> script</h3>
<p>When the XZ release is ready, the official Github repository distributes the project’s source files. Initially, these releases on the repository, aside from containing the malicious test files, were harmless because they don’t get the chance to execute. However, the attacker appears to have only added the malicious code that bootstrap the infection when the releases were sourced from <strong>https://xz[.]tukaani.org</strong>, which was under the control of Jia Tan.</p>
<p>This URL is used by most distributions, and, when downloaded, it comes with a file named <strong>build-to-host.m4</strong> that contains malicious code.</p>
<p><strong>build-to-host.m4 </strong>(<a href="https://opentip.kaspersky.com/b4dd2661a7c69e85f19216a6dbbb1664/?utm_source=SL&amp;utm_medium=SL&amp;utm_campaign=SL" target="_blank" rel="noopener">c86c8f8a69c07fbec8dd650c6604bf0c9876261f</a>) is executed during the build process and executes a line of code that fixes and decompresses the first file added to the tests folder:</p>
<div id="attachment_112357"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112357" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09-1024x167.png" alt="Deobfuscated line of code in build-to-host.m4" width="1024" height="167" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09-1024x167.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09-300x49.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09-768x125.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09-740x121.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09-800x130.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145102/XZ_backdoor_analysis_09.png 1246w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112357">Deobfuscated line of code in build-to-host.m4</p></div>
<p>This line of code replaces the “broken” data from <strong>bad-3-corrupt_lzma2.xz</strong> using the <strong>tr</strong> command, and pipes the output to the <strong>xz -d</strong> command, which decompresses the data. The decompressed data contains a shell script that will be executed later using <strong>/bin/bash</strong>, triggered by this <strong>.m4</strong> file.</p>
<h3 id="stage-2-the-injected-shell-script">Stage 2 – The injected shell script</h3>
<p>The malicious script injected by the malicious <strong>.m4</strong> file verifies that it’s running on a Linux machine and also that it’s running inside the intended build process.</p>
<div id="attachment_112358"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112358" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-1024x229.png" alt="Injected script contents" width="1024" height="229" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-1024x229.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-300x67.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-768x171.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-1536x343.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-1568x350.png 1568w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-740x165.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-1255x280.png 1255w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10-800x179.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145150/XZ_backdoor_analysis_10.png 2048w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112358">Injected script contents</p></div>
<p>To execute the next stage, it uses <strong>good-large_compressed.lzma</strong>, which is indeed compressed correctly with XZ, but contains junk data inside the decompressed data.</p>
<p>The junk data removal procedure is as follows: the <strong>eval</strong> function executes the head pipeline, with each <strong>head</strong> command either ignoring the next 1024 bytes or extracting the next 2048 or 724 bytes.</p>
<p>In total, these commands extracted <strong>33,492 </strong>bytes (<strong>2048*16 + 724 </strong>bytes). The <strong>tail</strong> command then retains the final <strong>31,265 </strong>bytes of the file and ignores the rest.</p>
<p>Then, the <strong>tr</strong> command applies a basic substitution to the output to deobfuscate it. The second XZ command decompresses the transformed bytes as a raw <strong>lzma </strong>stream, after which the result is piped into shell.</p>

<p>The last stage shell script performs many checks to ensure that it is running in the expected environment, such as whether the project is configured to use <a href="https://sourceware.org/glibc/wiki/GNU_IFUNC" target="_blank" rel="noopener">IFUNC</a> (which will be discussed in the next sections).</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13.png"><img loading="lazy" decoding="async" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13-1024x83.png" alt="" width="1024" height="83" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13-1024x83.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13-300x24.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13-768x62.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13-740x60.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13-800x65.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145253/XZ_backdoor_analysis_13.png 1110w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p>
<p>Many of the other checks performed by this stage include determining whether GCC is used for compilation or if the project contains specific files that will be used by the script later on.</p>
<p>In this stage, it extracts the backdoor binary code itself, an <a href="https://www.gnu.org/software/guile/manual/html_node/Object-File-Format.html" target="_blank" rel="noopener">object file</a> that is currently hidden in the same <strong>good-large_compressed.lzma</strong> file, but at a different offset.</p>
<p>The following code handles this:</p>
<div id="attachment_112360"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112360" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12-1024x160.png" alt="Partial command used by the last script stage" width="1024" height="160" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12-1024x160.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12-300x47.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12-768x120.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12-740x115.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12-800x125.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145335/XZ_backdoor_analysis_12.png 1392w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112360">Partial command used by the last script stage</p></div>
<p>The extraction process operates through a sequence of commands, with the result of each command serving as the input for the next one. The formatted one-liner code is shown below:</p>
<div id="attachment_112361"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112361" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-1024x742.png" alt="Formatted backdoor extraction one-liner" width="1024" height="742" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-1024x742.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-300x217.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-768x556.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-483x350.png 483w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-740x536.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-387x280.png 387w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04-800x580.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145406/XZ_backdoor_analysis_04.png 1397w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112361">Formatted backdoor extraction one-liner</p></div>
<p>Initially, the file <strong>good-large_compressed.lzma</strong> is extracted using the <strong>XZ</strong> tool itself. The subsequent steps involve calling a chain of <strong>head</strong> calls with the “<strong>eval $i”</strong> function (same as the stage 3 extraction).</p>
<p>Then a custom RC4-like algorithm is used to decrypt the binary data, which contains another compressed file. This compressed file is also extracted using the XZ utility. The script then removes some bytes from the beginning of the decompressed data using predefined values and saves the result to disk as <strong>liblzma_la-crc64-fast.o</strong>, which is the backdoor file used in the linking process.</p>
<p>Finally, the script modifies the function <strong>is_arch_extension_supported</strong> from the <strong>crc_x86_clmul.h</strong> file in <strong>liblzma</strong>, to replace the call to the <strong>__get_cpuid</strong> function with <strong>_get_cpuid</strong>, removing one underscore character.</p>
<p>This modification allows it to be linked into the library (we’ll discuss this in more detail in the next section). The whole build infection chain can be summarized in the following scheme:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14.png"><img loading="lazy" decoding="async" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-1024x531.png" alt="" width="1024" height="531" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-1024x531.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-300x156.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-768x398.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-1536x796.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-675x350.png 675w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-740x384.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-540x280.png 540w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14-800x415.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145446/XZ_backdoor_analysis_14.png 1645w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p>
<h2 id="binary-backdoor-analysis">Binary backdoor analysis</h2>
<h3 id="a-stealth-loading-scenario">A stealth loading scenario</h3>
<p>In the original XZ code, there are two special functions used to calculate the CRC of the given data: <strong>lzma_crc32 </strong>and <strong>lzma_crc64</strong>. Both of these functions are stored in the ELF symbol table with type <a href="https://sourceware.org/glibc/wiki/GNU_IFUNC" target="_blank" rel="noopener">IFUNC</a>, a feature provided by the GNU C Library (GLIBC). IFUNC allows developers to dynamically select the correct function to use. This selection takes place when the dynamic linker loads the shared library.</p>
<p>The reason XZ uses this is that it allows for determining whether an optimized version of the <strong>lzma_crcX </strong>function should be used or not. The optimized version requires special features from modern processors (CLMUL, SSSE3, SSE4.1). These special features need to be verified by issuing the <strong>cpuid </strong>instruction, which is called using the <a href="https://github.com/gcc-mirror/gcc/blob/6f9ba3ea55477cf1bd3d37e40ad116150c06a75e/gcc/config/i386/cpuid.h#L324" target="_blank" rel="noopener"><strong>__get_cpuid</strong></a> wrapper/intrinsic provided by GLIBC, and it’s at this point the backdoor takes advantage to load itself.</p>
<p>The backdoor is stored as an object file, and its primary goal is to be linked to the main executable during compilation. The object file contains the <strong>_get_cpuid</strong> symbol, as the injected shell scripts remove one underscore symbol from the original source code, which means that when the code calls <strong>_get_cpuid</strong>, it actually calls the backdoor’s version of it.</p>
<div id="attachment_112363"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112363" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-1024x392.png" alt="Backdoor code entry point" width="1024" height="392" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-1024x392.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-300x115.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-768x294.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-915x350.png 915w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-740x283.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-732x280.png 732w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07-800x306.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145548/XZ_backdoor_analysis_07.png 1302w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112363">Backdoor code entry point</p></div>
<h3 id="backdoor-code-analysis">Backdoor code analysis</h3>
<p>The initial backdoor code is invoked twice, as both <strong>lzma_crc32</strong> and <strong>lzma_crc64</strong> use the same modified function (<strong>_get_cpuid</strong>). To ensure control over this, a simple counter is created to verify that the code has already been executed. The actual malicious activity starts when the <strong>lzma_crc64</strong> IFUNC invokes <strong>_get_cpuid</strong>, sees the counter value 1 indicating that that the function has already been accessed, and initiates one final step to redirect to the true entry point of this malware.</p>
<div id="attachment_112364"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112364" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-854x1024.png" alt="Backdoor initialization" width="854" height="1024" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-854x1024.png 854w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-250x300.png 250w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-768x921.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-168x200.png 168w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-292x350.png 292w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-740x887.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-233x280.png 233w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01-751x900.png 751w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145625/XZ_backdoor_analysis_01.png 964w" sizes="(max-width: 854px) 100vw, 854px"/></a></p><p id="caption-attachment-112364">Backdoor initialization</p></div>
<p>To initialize the malicious code, the backdoor first initializes a couple of structures that hold core information about the current running process. Primarily, it locates the Global Offset Table (<a href="https://en.wikipedia.org/wiki/Global_Offset_Table">GOT</a>) address using hardcoded offsets, and uses this information to find the <strong>cpuid</strong> pointer inside it.</p>
<div id="attachment_112365"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112365" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-1024x381.png" alt="GOT modification code" width="1024" height="381" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-1024x381.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-300x112.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-768x286.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-1536x572.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-940x350.png 940w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-740x276.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-752x280.png 752w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03-800x298.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11145711/XZ_backdoor_analysis_03.png 1678w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112365">GOT modification code</p></div>
<p>The GOT contains the offsets of symbols, including the <strong>cpuid</strong> wrapper. The backdoor then swaps the pointers to the main malware function, and calls it as if it were calling <strong>cpuid</strong>.</p>
<h3 id="core-behavior">Core behavior</h3>
<p>The main goal of the backdoor is to successfully hook specific functions that will allow it to monitor every connection to the infected machine. The targeted functions include:</p>
<table>
<tbody>
<tr>
<td><strong>Targeted function</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td><strong>RSA_public_decrypt</strong></td>
<td>Used by <strong>libcrypto</strong> to decrypt a ciphertext signed by a private key</td>
</tr>
<tr>
<td><strong>EVP_PKEY_set1_RSA</strong></td>
<td>Used by <strong>libcrypto</strong> to set the RSA key of a given context</td>
</tr>
<tr>
<td><strong>RSA_get0_key</strong></td>
<td>Used by <strong>libcrypto</strong> to retrieve an RSA key</td>
</tr>
</tbody>
</table>
<p>However, hooking all these functions is not a simple and straightforward task for the backdoor. It involves accessing many internal structures and manipulating process-specific structures until it achieves its goal, and it also needs to be as stealthy as possible, which means that the malicious code contains multiple checks to avoid being analyzed.</p>
<h3 id="execution-environment-check">Execution environment check</h3>
<p>It first parses <strong>ld-linux</strong> (dynamic linker), which is primarily responsible for dynamically resolving symbol addresses in memory. It also extracts various information about the environment and verifies that the current process the backdoor is running in matches its execution criteria, which are:</p>
<ul>
<li>The current process is <strong>/usr/bin/sshd</strong></li>
<li>Check if the kill switch is present</li>
</ul>
<p>It extracts the name of the current process from <strong>argv[0]</strong> and also parses all the process environment variables to see if any of them are present in its internal string table. If a match is found, or the process is not <strong>sshd</strong>, the malware halts its execution.</p>
<div id="attachment_112366"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112366" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-1024x864.png" alt="Process environment check" width="1024" height="864" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-1024x864.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-300x253.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-768x648.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-415x350.png 415w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-740x624.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-332x280.png 332w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15-800x675.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150105/XZ_backdoor_analysis_15.png 1299w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112366">Process environment check</p></div>
<p>The only variable inside its own table is <strong>yolAbejyiejuvnup=Evjtgvsh5okmkAvj</strong>, which in this context serves as a <strong>kill switch</strong>.</p>
<h3 id="the-trie-structure">The trie structure</h3>
<p>One of the distinctive features of the backdoor is the use of a single <a href="https://en.wikipedia.org/wiki/Trie" target="_blank" rel="noopener">trie</a> structure for string operations. Instead of directly comparing strings or using string hashes to match a particular constant (for example, the name of a library function), the code performs a trie lookup, and checks if the result is equal to a certain constant number. For example, the magic value for the ELF header results in the trie returning <strong>0x300</strong>, and the name of the <strong>system</strong> function is matched with a return value of <strong>0x9F8</strong>. Trie is not just used for comparisons: certain functions that use pointers to strings (for example, <strong>ssh-2.0</strong>) search for these strings in the host binary using the trie, so there will be no suspicious data in the backdoor’s body.</p>
<p>The implementation of the trie uses 16-byte bitmasks, each half corresponding to the byte input ranges <strong>0x00-0x3F</strong> and <strong>0x40-0x7F</strong>, and 2-byte trie leaf nodes, 3 bits of which are flags (direction, termination) and the rest is reserved for the value (or the location of the next node).</p>
<div id="attachment_112367"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150150/XZ_backdoor_analysis_16.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112367" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150150/XZ_backdoor_analysis_16.png" alt="Part of the trie lookup function that performs the bitmap match" width="648" height="275" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150150/XZ_backdoor_analysis_16.png 648w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150150/XZ_backdoor_analysis_16-300x127.png 300w" sizes="(max-width: 648px) 100vw, 648px"/></a></p><p id="caption-attachment-112367">Part of the trie lookup function that performs the bitmap match</p></div>
<h3 id="symbol-resolver">Symbol resolver</h3>
<p>There are at least three symbol resolver-related routines used by the backdoor to locate the ELF Symbol structure, which holds information such as the symbol name and its offset. All symbol resolver functions receive a key to be searched in the trie.</p>
<div id="attachment_112368"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112368" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05-1024x195.png" alt="Symbol resolver example" width="1024" height="195" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05-1024x195.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05-300x57.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05-768x146.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05-740x141.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05-800x153.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150247/XZ_backdoor_analysis_05.png 1028w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112368">Symbol resolver example</p></div>
<p>One of the backdoor resolver functions iterates through all symbols and verifies which one has the desired key. If it is found, it returns the <strong>Elf64_Sym</strong> structure, which will later be used to populate an internal structure of the backdoor that holds all the necessary function pointers. This process is similar to that commonly seen in Windows threats with API hashing routines.</p>
<p>The backdoor searches many functions from the libcrypto (OpenSSL) library, as these will be used in later encryption routines. It also keeps track of how many functions it was able to find and resolve; this determines whether it is executing properly or should stop.</p>
<p>Another interesting symbol resolver abuses the <strong>lzma_alloc</strong> function, which is part of the liblzma library itself. This function serves as a helper for developers to allocate memory efficiently using the default allocator (malloc) or a custom one. In the case of the XZ backdoor, this function is abused to make use of a fake allocator. In reality, it functions as another symbol resolver. The parameter intended for “allocation size” is, in fact, the symbol key inside the trie. This trick is meant to complicate backdoor analysis.</p>
<div id="attachment_112369"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112369" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06.png" alt="Symbol resolver using a fake allocator structure" width="997" height="98" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06.png 997w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06-300x29.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06-768x75.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06-990x98.png 990w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06-740x73.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150335/XZ_backdoor_analysis_06-800x79.png 800w" sizes="(max-width: 997px) 100vw, 997px"/></a></p><p id="caption-attachment-112369">Symbol resolver using a fake allocator structure</p></div>
<p>The backdoor dynamically resolves its symbols while executing; it doesn’t necessarily do so all at once or only when it needs to use them. The resolved symbols/functions range from legitimate OpenSSL functions to functions such as <strong>system</strong>, which is used to execute commands on the machine.</p>
<h3 id="the-symbind-hook">The Symbind hook</h3>
<p>As mentioned earlier, the primary objective of the backdoor initialization is to successfully hook functions. To do so, the backdoor makes use of <a href="https://www.man7.org/linux/man-pages/man7/rtld-audit.7.html" target="_blank" rel="noopener"><strong>rtdl-audit</strong></a>, a feature of the dynamic linker that enables the creation of custom shared libraries to be notified when certain events occur within the linker, such as symbol resolution. In a typical scenario, a developer would create a shared library following the <a href="https://www.man7.org/linux/man-pages/man7/rtld-audit.7.html" target="_blank" rel="noopener"><strong>rtdl-audit</strong> manual</a>. However, the XZ backdoor opts to perform a runtime patch on the already registered (default) interfaces loaded in memory, thereby hijacking the symbol-resolving routine.</p>
<div id="attachment_112370"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112370" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11-1024x194.png" alt="dl-audit runtime patch" width="1024" height="194" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11-1024x194.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11-300x57.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11-768x146.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11-740x141.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11-800x152.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150425/XZ_backdoor_analysis_11.png 1385w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112370">dl-audit runtime patch</p></div>
<p>The maliciously crafted structure <a href="https://elixir.bootlin.com/glibc/latest/source/sysdeps/generic/ldsodefs.h#L237" target="_blank" rel="noopener"><strong>audit_iface</strong></a>, stored in the <strong>dl_audit</strong> global variable within the dynamic linker’s memory area, contains the <strong>symbind64</strong> callback address, which is invoked by the dynamic linker. It sends all the symbol information to the backdoor control, which is then used to obtain a malicious address for the target functions, thus achieving hooking.</p>
<div id="attachment_112371"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112371" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-1024x308.png" alt="Hooking placement inside the Symbind modified callback" width="1024" height="308" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-1024x308.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-300x90.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-768x231.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-740x222.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-932x280.png 932w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08-800x240.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150507/XZ_backdoor_analysis_08.png 1085w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112371">Hooking placement inside the Symbind modified callback</p></div>
<p>The addresses for <strong>dl_audit</strong> and <strong>dl_naudit</strong>, which holds the number of audit interfaces available, are obtained by disassembling both the <strong>dl_main</strong> and <strong>dl_audit_symbind_alt</strong> functions. The backdoor contains an internal minimalistic <strong>disassembler </strong>used for instruction decoding. It makes extensive use of it, especially when hunting for specific values like the <strong>*audit</strong> addresses.</p>
<div id="attachment_112372"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-112372" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-1024x492.png" alt="dl_naudit hunting code" width="1024" height="492" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-1024x492.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-300x144.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-768x369.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-728x350.png 728w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-740x356.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-582x280.png 582w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02-800x385.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/11150611/XZ_backdoor_analysis_02.png 1504w" sizes="(max-width: 1024px) 100vw, 1024px"/></a></p><p id="caption-attachment-112372">dl_naudit hunting code</p></div>
<p>The <strong>dl_naudit</strong> address is found by one of the <strong>mov </strong>instructions within the <strong>dl_main</strong> function code that accesses it. With that information, the backdoor hunts for access to a memory address and saves it.</p>
<p>It also verifies if the memory address acquired is the same address as the one accessed by the <strong>dl_audit_symbind_alt</strong> function on a given offset. This allows it to safely assume that it has indeed found the correct address. After it finds the <strong>dl_naudit </strong>address, it can easily calculate where <strong>dl_audit </strong>is, since the two are stored next to each other in memory.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this article, we covered the entire process of backdooring <strong>liblzma (XZ)</strong>, and delved into a detailed analysis of the binary backdoor code, up to achieving its principal goal: hooking.</p>
<p>It’s evident that this backdoor is highly complex and employs sophisticated methods to evade detection. These include the multi-stage implantation in the <strong>XZ</strong> repository, as well as the complex code contained within the binary itself.</p>
<p>There is still much more to explore about the backdoor’s internals, which is why we have decided to present this as <strong>Part I</strong> of the <strong>XZ</strong> backdoor series.</p>
<p>Kaspersky products detect malicious objects related to the attack as <strong>HEUR:Trojan.Script.XZ</strong> and <strong>Trojan.Shell.XZ</strong>. In addition, Kaspersky Endpoint Security for Linux detects malicious code in SSHD process memory as <strong>MEM:Trojan.Linux.XZ</strong> (as part of the Critical Areas Scan task).</p>
<h2 id="indicators-of-compromise">Indicators of compromise</h2>
<h3 id="yara-rules">Yara rules</h3>

		<div id="crayon-661a42bb84e30813611298" data-settings=" touchscreen minimize scroll-mouseover">
		
			
			
			
			<div>
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>rule</span><span> </span><span>liblzma_get_cpuid_function</span><span> </span><span>{</span></p><p><span>   </span><span>meta</span><span>:</span></p><p><span>	</span><span>description</span><span> </span>=<span> </span><span>&#34;Rule to find the malicious get_cpuid function CVE-2024-3094&#34;</span></p><p><span>            </span><span>author</span><span> </span>=<span> </span><span>&#34;Kaspersky Lab&#34;</span></p><p><span>   </span><span>strings</span><span>:</span></p><p><span>        </span><span>$</span><span>a</span><span> </span>=<span> </span><span>{</span><span> </span><span>F3</span><span> </span><span>0F</span><span> </span><span>1E</span><span> </span><span>FA</span><span> </span><span>55</span><span> </span><span>48</span><span> </span><span>89</span><span> </span><span>F5</span><span> </span><span>4C</span><span> </span><span>89</span><span> </span><span>CE</span><span> </span><span>53</span><span> </span><span>89</span><span> </span><span>FB</span><span> </span><span>81</span><span> </span><span>E7</span><span> </span><span>00</span><span> </span><span>00</span><span> </span><span>00</span><span> </span><span>80</span><span> </span><span>48</span><span> </span><span>83</span><span> </span><span>EC</span><span> </span><span>28</span><span> </span><span>48</span><span> </span><span>89</span><span> </span><span>54</span><span> </span><span>24</span><span> </span><span>18</span><span> </span><span>48</span><span> </span><span>89</span><span> </span><span>4C</span><span> </span><span>24</span><span> </span><span>10</span><span> </span><span>4C</span><span> </span><span>89</span><span> </span><span>44</span><span> </span><span>24</span><span> </span><span>08</span><span> </span><span>E8</span><span> </span><span>?</span><span>?</span><span> </span><span>?</span><span>?</span><span> </span><span>?</span><span>?</span><span> </span><span>?</span><span>?</span><span> </span><span>85</span><span> </span><span>C0</span><span> </span><span>74</span><span> </span><span>27</span><span> </span><span>39</span><span> </span><span>D8</span><span> </span><span>72</span><span> </span><span>23</span><span> </span><span>4C</span><span> </span><span>8B</span><span> </span><span>44</span><span> </span><span>24</span><span> </span><span>08</span><span> </span><span>48</span><span> </span><span>8B</span><span> </span><span>4C</span><span> </span><span>24</span><span> </span><span>10</span><span> </span><span>45</span><span> </span><span>31</span><span> </span><span>C9</span><span> </span><span>48</span><span> </span><span>89</span><span> </span><span>EE</span><span> </span><span>48</span><span> </span><span>8B</span><span> </span><span>54</span><span> </span><span>24</span><span> </span><span>18</span><span> </span><span>89</span><span> </span><span>DF </span><span>E8</span><span> </span><span>?</span><span>?</span><span> </span><span>?</span><span>?</span><span> </span><span>?</span><span>?</span><span> </span><span>?</span><span>?</span><span> </span><span>B8</span><span> </span><span>01</span><span> </span><span>00</span><span> </span><span>00</span><span> </span><span>00</span><span> </span><span>EB</span><span> </span><span>02</span><span> </span><span>31</span><span> </span><span>C0</span><span> </span><span>48</span><span> </span><span>83</span><span> </span><span>C4</span><span> </span><span>28</span><span> </span><span>5B</span><span> </span><span>5D</span><span> </span><span>C3</span><span> </span><span>}</span><span>  </span></p><p><span>    </span><span>condition</span><span>:</span></p><p><span>        </span><span>$</span><span>a</span></p><p><span>}</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<h3 id="known-backdoored-libraries">Known backdoored libraries</h3>
<p><strong>Debian Sid liblzma.so.5.6.0</strong></p>
<p><strong>Debian Sid liblzma.so.5.6.1</strong></p>
<p><strong>Related files</strong></p>
<p><strong>Analyzed artefacts</strong></p>
												</div>
											</div></div>
  </body>
</html>
