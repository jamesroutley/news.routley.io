<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/joeyates/imap-backup">Original</a>
    <h1>Imap-backup: Backup Gmail or other IMAP accounts to disk</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text"><p dir="auto"><a href="https://circleci.com/gh/joeyates/imap-backup" title="Build status by CirceCI" rel="nofollow"><img src="https://camo.githubusercontent.com/b2e409dc984fd14e8a2894a29e2a6c479b3c2849cf160de6674d5dd086184256/68747470733a2f2f636972636c6563692e636f6d2f67682f6a6f6579617465732f696d61702d6261636b75702e7376673f7374796c653d737667" alt="Build Status" data-canonical-src="https://circleci.com/gh/joeyates/imap-backup.svg?style=svg"/></a>
<a href="https://codeclimate.com/github/joeyates/imap-backup" rel="nofollow"><img src="https://camo.githubusercontent.com/14c40468a51f5c1ce7e74c713f8c6af357640efdd4985e74202e90ab39ff6360/68747470733a2f2f636f6465636c696d6174652e636f6d2f6769746875622f6a6f6579617465732f696d61702d6261636b75702f6261646765732f6770612e737667" alt="Source Analysis" data-canonical-src="https://codeclimate.com/github/joeyates/imap-backup/badges/gpa.svg"/></a>
<a href="https://codeclimate.com/github/joeyates/imap-backup/coverage" rel="nofollow"><img src="https://camo.githubusercontent.com/b9a911849e442428e90111a02243d4eef3187a4426c77906469f4f253a8d89ab/68747470733a2f2f636f6465636c696d6174652e636f6d2f6769746875622f6a6f6579617465732f696d61702d6261636b75702f6261646765732f636f7665726167652e737667" alt="Test Coverage" data-canonical-src="https://codeclimate.com/github/joeyates/imap-backup/badges/coverage.svg"/></a></p>

<p dir="auto"><em>Backup GMail (or other IMAP) accounts to disk</em></p>
<ul dir="auto">
<li><a href="https://github.com/joeyates/imap-backup" title="Source code at GitHub">Source Code</a></li>
<li><a href="http://rubydoc.info/gems/imap-backup/frames" title="RDoc API Documentation at Rubydoc.info" rel="nofollow">API documentation</a></li>
<li><a href="http://rubygems.org/gems/imap-backup" title="Ruby gem at rubygems.org" rel="nofollow">Rubygem</a></li>
<li><a href="https://circleci.com/gh/joeyates/imap-backup" title="Build status by CirceCI" rel="nofollow">Continuous Integration</a></li>
</ul>

<div data-snippet-clipboard-copy-content="$ gem install &#39;imap-backup&#39;"><pre>$ gem install <span><span>&#39;</span>imap-backup<span>&#39;</span></span></pre></div>

<p dir="auto">For a full list, run</p>

<p dir="auto">For more information about a command, run</p>
<div data-snippet-clipboard-copy-content="$ imap-backup help COMMAND"><pre>$ imap-backup <span>help</span> COMMAND</pre></div>

<p dir="auto">In order to do backups, you need to add accounts via a menu-driven command
line program:</p>
<p dir="auto">Run:</p>

<h2 dir="auto"><a id="user-content-gmail" aria-hidden="true" href="#gmail"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>GMail</h2>
<p dir="auto">To use imap-backup with GMail, you will need to enable &#39;App passwords&#39; on your account.</p>
<h2 dir="auto"><a id="user-content-folders" aria-hidden="true" href="#folders"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Folders</h2>
<p dir="auto">By default, all folders are backed-up. You can override this by choosing
specific folders.</p>
<h2 dir="auto"><a id="user-content-configuration-file" aria-hidden="true" href="#configuration-file"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Configuration file</h2>
<p dir="auto"><code>setup</code> creates the file <code>~/.imap-backup/config.json</code></p>
<p dir="auto">E.g.:</p>
<div data-snippet-clipboard-copy-content="{
  &#34;accounts&#34;: [
    {
      &#34;username&#34;: &#34;my.user@gmail.com&#34;,
      &#34;password&#34;: &#34;secret&#34;,
      &#34;local_path&#34;: &#34;/path/to/backup/root&#34;,
      &#34;folders&#34;:
        [
          {&#34;name&#34;: &#34;[Gmail]/All Mail&#34;},
          {&#34;name&#34;: &#34;my_folder&#34;}
        ]
    }
  ]
}"><pre>{
  <span>&#34;accounts&#34;</span>: [
    {
      <span>&#34;username&#34;</span>: <span><span>&#34;</span>my.user@gmail.com<span>&#34;</span></span>,
      <span>&#34;password&#34;</span>: <span><span>&#34;</span>secret<span>&#34;</span></span>,
      <span>&#34;local_path&#34;</span>: <span><span>&#34;</span>/path/to/backup/root<span>&#34;</span></span>,
      <span>&#34;folders&#34;</span>:
        [
          {<span>&#34;name&#34;</span>: <span><span>&#34;</span>[Gmail]/All Mail<span>&#34;</span></span>},
          {<span>&#34;name&#34;</span>: <span><span>&#34;</span>my_folder<span>&#34;</span></span>}
        ]
    }
  ]
}</pre></div>
<p dir="auto">It connects to GMail by default, but you can also specify a server:</p>
<div data-snippet-clipboard-copy-content="{
  &#34;accounts&#34;: [
    {
      &#34;username&#34;: &#34;my.user@gmail.com&#34;,
      &#34;password&#34;: &#34;secret&#34;,
      &#34;server&#34;: &#34;my.imap.example.com&#34;,
      &#34;local_path&#34;: &#34;/path/to/backup/root&#34;,
      &#34;folders&#34;:
        [
          {&#34;name&#34;: &#34;[Gmail]/All Mail&#34;},
          {&#34;name&#34;: &#34;my_folder&#34;}
        ]
    }
  ]
}"><pre>{
  <span>&#34;accounts&#34;</span>: [
    {
      <span>&#34;username&#34;</span>: <span><span>&#34;</span>my.user@gmail.com<span>&#34;</span></span>,
      <span>&#34;password&#34;</span>: <span><span>&#34;</span>secret<span>&#34;</span></span>,
      <span>&#34;server&#34;</span>: <span><span>&#34;</span>my.imap.example.com<span>&#34;</span></span>,
      <span>&#34;local_path&#34;</span>: <span><span>&#34;</span>/path/to/backup/root<span>&#34;</span></span>,
      <span>&#34;folders&#34;</span>:
        [
          {<span>&#34;name&#34;</span>: <span><span>&#34;</span>[Gmail]/All Mail<span>&#34;</span></span>},
          {<span>&#34;name&#34;</span>: <span><span>&#34;</span>my_folder<span>&#34;</span></span>}
        ]
    }
  ]
}</pre></div>
<h2 dir="auto"><a id="user-content-connection-options" aria-hidden="true" href="#connection-options"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Connection options</h2>
<p dir="auto">You can override the parameters passed to <code>Net::IMAP</code> with <code>connection_options</code>.</p>
<p dir="auto">Specifically, if you are using a self-signed certificate and get SSL errors, e.g.
<code>certificate verify failed</code>, you can choose to not verify the TLS connection:</p>
<div data-snippet-clipboard-copy-content="{
  &#34;accounts&#34;: [
    {
      &#34;username&#34;: &#34;my.user@gmail.com&#34;,
      &#34;password&#34;: &#34;secret&#34;,
      &#34;server&#34;: &#34;my.imap.example.com&#34;,
      &#34;local_path&#34;: &#34;/path/to/backup/root&#34;,
      &#34;folders&#34;: [
        {&#34;name&#34;: &#34;[Gmail]/All Mail&#34;},
        {&#34;name&#34;: &#34;my_folder&#34;}
      ],
      &#34;connection_options&#34;: {
        &#34;ssl&#34;: {&#34;verify_mode&#34;: 0},
        &#34;port&#34;: 993
      }
    }
  ]
}"><pre>{
  <span>&#34;accounts&#34;</span>: [
    {
      <span>&#34;username&#34;</span>: <span><span>&#34;</span>my.user@gmail.com<span>&#34;</span></span>,
      <span>&#34;password&#34;</span>: <span><span>&#34;</span>secret<span>&#34;</span></span>,
      <span>&#34;server&#34;</span>: <span><span>&#34;</span>my.imap.example.com<span>&#34;</span></span>,
      <span>&#34;local_path&#34;</span>: <span><span>&#34;</span>/path/to/backup/root<span>&#34;</span></span>,
      <span>&#34;folders&#34;</span>: [
        {<span>&#34;name&#34;</span>: <span><span>&#34;</span>[Gmail]/All Mail<span>&#34;</span></span>},
        {<span>&#34;name&#34;</span>: <span><span>&#34;</span>my_folder<span>&#34;</span></span>}
      ],
      <span>&#34;connection_options&#34;</span>: {
        <span>&#34;ssl&#34;</span>: {<span>&#34;verify_mode&#34;</span>: <span>0</span>},
        <span>&#34;port&#34;</span>: <span>993</span>
      }
    }
  ]
}</pre></div>

<p dir="auto">Note that email usernames and passwords are held in plain text
in the configuration file.</p>
<p dir="auto">The directory ~/.imap-backup, the configuration file and all backup
directories have their access permissions set to only allow access
by your user. This is not done on Windows - see below.</p>
<h2 dir="auto"><a id="user-content-windows" aria-hidden="true" href="#windows"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Windows</h2>
<p dir="auto">Due to the complexity of managing permissions on Windows,
directory and file access permissions are not set explicity.</p>
<p dir="auto">A pull request that implements permissions management on Windows
would be welcome!</p>

<p dir="auto">Manually, from the command line:</p>

<p dir="auto">Alternatively, add it to your crontab.</p>

<p dir="auto">Each folder is saved to an mbox file.
Alongside each mbox is a file with extension &#39;.imap&#39;, which lists the source IMAP
UIDs to allow a full restore.</p>

<p dir="auto">There a various commands for viewing local backup status.</p>
<p dir="auto">To view the list, use</p>


<p dir="auto">If you have problems:</p>
<ol dir="auto">
<li>ensure that you have the latest release,</li>
<li>turn on debugging output:</li>
</ol>
<div data-snippet-clipboard-copy-content="{
  &#34;accounts&#34;:
  [
    ...
  ],
  &#34;debug&#34;: true
}"><pre>{
  <span>&#34;accounts&#34;</span>:
  [
    <span>...</span>
  ],
  <span>&#34;debug&#34;</span>: <span>true</span>
}</pre></div>

<p dir="auto">All missing messages are pushed to the IMAP server.
Existing messages are left unchanged.</p>
<p dir="auto">This functionality requires that the IMAP server supports the UIDPLUS
extension to IMAP4.</p>

<p dir="auto">List IMAP folders:</p>

<p dir="auto">Get statistics of emails to download per folder:</p>


<ul dir="auto">
<li>Secure - use a local file protected by permissions</li>
<li>Restartable - calculate start point based on already downloaded messages</li>
<li>Standalone - do not rely on an email client or MTA</li>
</ul>

<ul dir="auto">
<li><a href="https://github.com/joeyates/imap-backup/blob/main/docs/development.md">Development</a></li>
<li><a href="https://github.com/joeyates/imap-backup/blob/main/docs/restore.md">Restore</a></li>
</ul>
</article>
        </div></div>
  </body>
</html>
