<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ittavern.com/cron-jobs-on-linux-comprehensive-guide/">Original</a>
    <h1>Cron Jobs on Linux – Comprehensive Guide with Examples</h1>
    
    <div id="readability-page-1" class="page"><div>
<p>In this article, I’ll use <strong>Ubuntu 22.04</strong> (Debian-derivative) and <strong>rockyOS 9.2</strong> (RHEL-derivative) as references. If it is not mentioned, commands are the same for both systems.</p>

<p>Cron jobs are scheduled and automated tasks that run commands or scripts on Linux. Common <strong>use cases</strong> are backups, updates, health checks, and so on. Those tasks can be run as <code>sudo</code> or user context.</p>
<p>Cron is the daemon that runs in the background. The running service is called <code>cron</code> and <code>crond</code> on Ubuntu and rockyOS, respectively.</p>
<h4 id="make-sure-the-daemon-is-running-a-hrefdaemon-iddaemona">Make sure the daemon is running <a href="#daemon" id="daemon">#</a></h4>
<p>Make sure that the service is running:</p>
<p><strong>Ubuntu / Debian</strong></p>
<p><code>sudo systemctl status cron</code>
or
<code>ps aux | grep cron</code></p>
<p><strong>rockyOS / RHEL</strong></p>
<p><code>sudo systemctl status crond</code>
or
<code>ps aux | grep crond</code></p>
<h4 id="show-cron-jobs-a-hrefshow-cron-jobs-idshow-cron-jobsa">Show cron jobs <a href="#show-cron-jobs" id="show-cron-jobs">#</a></h4>
<p>Before we start, there are several places where you can look for cron jobs.</p>
<ol>
<li>via the <code>crontab</code> command, as described in the following section
Cron tables are saved in <code>/var/spool/cron/crontabs/*</code> in Ubuntu and <code>/var/spool/cron</code> in rockyOS.</li>
<li>in the system-wide <code>/etc/crontab</code> or <code>/etc/cron.d/*</code> configuration files</li>
<li>as script or executable in one of the following directories:
<code>/etc/cron.hourly/</code>
<code>/etc/cron.daily/</code>
<code>/etc/cron.weekly/</code>
<code>/etc/cron.monthly/</code></li>
</ol>
<dl>
<dt>List existing cron jobs of <code>crontab</code>:</dt>
<dd><code>crontab -l</code> <em># cron jobs of current user</em></dd>
<dd><code>sudo crontab -l</code> <em># cron jobs of <code>root</code></em></dd>
<dd><code>sudo crontab -u USERNAME -l</code> <em># cron jobs of specific user</em></dd>
</dl>
<hr/>
<p>Check <strong>all cron jobs of all users</strong> on a machine:</p>
<p>So, there are multiple ways to do so. I’ll show you my preferred way that should cover all cron jobs.</p>
<p><strong>Ubuntu / Debian</strong></p>
<pre><code>root@test-ubu-01:~# grep &#34;^[^#;]&#34; /var/spool/cron/crontabs/* /etc/crontab /etc/cron.d/*
</code></pre>
<pre><code>/etc/crontab:SHELL=/bin/sh
/etc/crontab:17 *       * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
/etc/crontab:25 6       * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
/etc/crontab:47 6       * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
/etc/crontab:52 6       1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
/etc/cron.d/e2scrub_all:30 3 * * 0 root test -e /run/systemd/system || SERVICE_MODE=1 /usr/lib/x86_64-linux-gnu/e2fsprogs/e2scrub_all_cron
/etc/cron.d/e2scrub_all:10 3 * * * root test -e /run/systemd/system || SERVICE_MODE=1 /sbin/e2scrub_all -A -r
</code></pre>
<pre><code>root@test-ubu-01:~# ls /etc/cron.*
</code></pre>
<pre><code>/etc/cron.d:
e2scrub_all

/etc/cron.daily:
apport  apt-compat  dpkg  logrotate  man-db

/etc/cron.hourly:

/etc/cron.monthly:

/etc/cron.weekly:
man-db
</code></pre>
<hr/>
<p><strong>rockyOS / RHEL</strong></p>
<pre><code>[root@test-rocky-01 ~]# grep &#34;^[^#;]&#34; /var/spool/cron/* /etc/crontab /etc/cron.d/*
</code></pre>
<pre><code>/var/spool/cron/remotesuser:* * * * * echo &#34;hello world as a random ass user
/var/spool/cron/root:* * * * * echo &#34;hello world&#34;
/etc/crontab:SHELL=/bin/bash
/etc/crontab:PATH=/sbin:/bin:/usr/sbin:/usr/bin
/etc/crontab:MAILTO=root
/etc/crontab:* * * * * remotesuser whoami &gt;&gt; /home/remotesuser/logy.logs
/etc/cron.d/0hourly:SHELL=/bin/bash
/etc/cron.d/0hourly:PATH=/sbin:/bin:/usr/sbin:/usr/bin
/etc/cron.d/0hourly:MAILTO=root
/etc/cron.d/0hourly:01 * * * * root run-parts /etc/cron.hourly
/etc/cron.d/cronywhat:SHELL=/bin/bash
/etc/cron.d/cronywhat:PATH=/sbin:/bin:/usr/sbin:/usr/bin
/etc/cron.d/cronywhat:MAILTO=root
/etc/cron.d/cronywhat:* * * * * root whoami &gt;&gt; /home/remotesuser/logy.logs
[root@test-rocky-01 ~]# 
</code></pre>
<pre><code>[root@test-rocky-01 etc]# ls /etc/cron.*
</code></pre>
<pre><code>/etc/cron.deny

/etc/cron.d:
0hourly

/etc/cron.daily:

/etc/cron.hourly:
0anacron

/etc/cron.monthly:

/etc/cron.weekly:
</code></pre>
<h4 id="add-and-edit-cron-jobs-a-hrefedit-cron-jobs-idedit-cron-jobsa">Add and edit cron jobs <a href="#edit-cron-jobs" id="edit-cron-jobs">#</a></h4>
<p><strong>Side note:</strong> <code>crontab</code> will ask you what editor you want to use to edit the file.</p>
<dl>
<dt>Edit cron jobs with <code>crontab</code> user-specific:</dt>
<dd><code>crontab -e</code> <em># edit cron jobs of current user</em></dd>
<dd><code>sudo crontab -e</code> <em># edit cron jobs of <code>root</code></em></dd>
<dd><code>sudo crontab -u USERNAME -e</code> <em># edit cron jobs of specific user</em></dd>
</dl>
<p>The default syntax is <code>* * * * * command</code>. A detailed description and examples follow in the following section.</p>
<hr/>
<p>A second method would be to add the cron job to the system-wide <code>/etc/cronjob</code> file or create a new file in the <code>/etc/cron.d/</code> directory. The latter is recommended as the <code>/etc/cronjob</code> is at risk of getting overwritten by an update.</p>
<p>The default syntax is slightly different as it adds the user name on the sixth position <code>* * * * * user command</code>.</p>
<hr/>
<p><strong>Another way to run scripts</strong> is to use the <code>/etc/cron.*</code> directories. Save a script in one of the following directories to run it directly as root and system-wide and the schedule you want:</p>
<pre><code>/etc/cron.hourly/
/etc/cron.daily/
/etc/cron.weekly/
/etc/cron.monthly/
</code></pre>
<p><strong>Side note:</strong> <code>/etc/cron.yearly/</code> / <code>/etc/cron.annually/</code> are not there per default but can be added. I have not looked into it.</p>
<hr/>
<p><strong>Important:</strong> Make sure that the script is executable: <code>sudo chmod +x script.sh</code></p>
<h4 id="remove-cron-job-a-hrefremove-cron-jobs-idremove-cron-jobsa">Remove cron job <a href="#remove-cron-jobs" id="remove-cron-jobs">#</a></h4>
<p>You can either delete single cron jobs with <code>crontab -e</code> or all cron jobs with the following commands:</p>
<dl>
<dt>Removing ALL cron jobs with <code>crontab -r</code>:</dt>
<dd><code>crontab -r</code> <em># removes all cron jobs of current user WITHOUT a prompt</em></dd>
<dd><code>crontab -r -i</code> <em># <code>-i</code> adds a yes/no prompt before removing all cron jobs</em></dd>
<dd><code>sudo crontab -r</code> <em># removes all cron jobs of <code>root</code></em></dd>
<dd><code>sudo crontab -u USERNAME -r</code> <em># removes all cron jobs of specific user</em></dd>
</dl>
<p><strong>Example:</strong></p>
<pre><code>[root@test-rocky-01 ~]# crontab -u remotesuser -r -i
crontab: really delete remotesuser&#39;s crontab? 
</code></pre>

<p><strong>Side note:</strong> I am going to use the <code>crontab</code> command syntax for further references.</p>
<p>There are <strong>four things</strong> you can add to the table:</p>
<dl>
<dt>Active cron job for a command or script:</dt>
<dd><code>0 */12 * * * /path/to/backup.sh</code> <em># runs a backup script every 12 hours</em></dd>
<dd><code>0 */12 * * * rsync -avh /source/ /destination/</code> <em># runs a backup command every 12 hours</em></dd>
<dt>A declaration of an environment variable for the following cron jobs:</dt>
<dd><code>result=&#34;HELLO WORLD&#34;</code></dd>
<dt>A comment taht starts the line with a hash <code>#</code>, that is ignored by <code>cron</code>:</dt>
<dd><code># just a comment</code></dd>
<dt>Or an empty line, which is also ignored:</dt>
<dd><code> </code></dd>
</dl>
<p><strong>Side note</strong>: it is recommended to use absolute paths for all scripts or executables.</p>
<hr/>
<p>Explanation from the manual:</p>
<pre><code>Example of job definition:                                                                                     
.---------------- minute (0 - 59)                                                                              
|  .------------- hour (0 - 23)                                                                                
|  |  .---------- day of month (1 - 31)                                                                        
|  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...                                                        
|  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat                           
|  |  |  |  |                                                                                                  
*  *  *  *  * command to be executed              
</code></pre>
<dl>
<dt>Examples:</dt>
<dd><code>* * * * * command</code> - every minute, which is the lowest possible interval</dd>
<dd><code>0 * * * * command</code> - every full hour</dd>
<dd><code>20 4 * * * command</code> - every day at 4:20 am</dd>
<dd><code>0 4 1 * * command</code> - at 4 am on the first day of the month</dd>
<dd><code>0 4 1 1 * command</code> - at 4 am on the first day of January</dd>
<dd><code>0 4 * * 1 command</code> - at 4 am every Monday</dd>
</dl>
<p>There are some operators to specify the timing even more.</p>
<p>Noted, the following options <strong>can be combined</strong>! I’ll add an example at the end.</p>
<p>The asterisk (<code>*</code>) means every possible value.</p>
<dl>
<dt>Lists:</dt>
<dd>Lists of values can be created with a comma (<code>,</code>)</dd>
<dd><code>0 4,16 * * * command</code> - every day at 4 am and 4 pm</dd>
<dd><code>0 4 * * 1,5 command</code> - at 4 am every Monday <strong>and Friday</strong></dd>
<dt>Ranges:</dt>
<dd>Ranges of values can be created with a hyphen (<code>-</code>)</dd>
<dd><code>0 9-17 * * * command</code> - every hour from 9 am to 5 pm</dd>
<dd><code>0 4 * * 1-5 command</code> - at 4 am every <strong>weekday from Monday to Friday</strong></dd>
<dt>Steps:</dt>
<dd>Ranges of values can be created with a slash (<code>/</code>)</dd>
<dd><code>*/30 * * * * command</code> - <strong>every 30 minutes</strong> <em>(00:00,00:30,01:00,[…])</em></dd>
<dd><code>0 */12 * * * command</code> - <strong>every 12 hours</strong> <em>(00:00 and 12:00)</em></dd>
</dl>
<p>As mentioned before, you can combine these options like in the following example:</p>
<p><code>0 9-17/2 * jan-mar 1,5</code> - every two hours between 9 am and 5 pm, on Monday and Friday from January to March. It’s not the best example, but you get the idea.</p>
<p>The following options are <strong>limited</strong> to only some fields and might be <strong>not compatible</strong> with every other option. Additionally, they might not be available in all crin implementations.</p>
<dl>
<dt>The (L)ast x of:</dt>
<dd>does only work for ‘Day of month’ and ‘Day of week’</dd>
<dd><code>0 4 L * * command</code> - at 4 am on <strong>the last day of the month</strong></dd>
<dd><code>0 4 * * 5L command</code> - at 4 am on <strong>the last Friday of the month</strong></dd>
<dt>The nearest (w)eekday within the month:</dt>
<dd>does only work for ‘Day of month’</dd>
<dd><code>0 4 15W * * command</code> - at 4 am on <strong>nearest weekday (Mon-Fri) to the 15th of the month</strong></dd>
<dd><em>must be a single day and not a list or range</em></dd>
<dt>The <code>n</code>th day of the month with a hash (<code>#</code>):</dt>
<dd>does only work for ‘Day of week’</dd>
<dd><code>0 4 * * 5#2</code> - at 4 am on <strong>the second Friday of every month</strong></dd>
</dl>
<p><strong>Side note:</strong> Certain values (besides <code>*</code>) in the ‘Day of month’ and ‘Day of week’ fields can cause an <code>OR</code> condition, which creates multiple timings.</p>
<hr/>
<h4 id="nonstandard-special-strings-a-hrefspecial-strings-idspecial-stringsa">Nonstandard Special Strings <a href="#special-strings" id="special-strings">#</a></h4>
<p>Most implementations support special strings, but some behave a little bit differently. They replace the usual expressions <code>* * * * *</code>.</p>
<dl>
<dt>Special strings</dt>
<dd><code>@hourly</code> - every full hour - same as <code>0 * * * *</code></dd>
<dd><code>@daily</code> or <code>@midnight</code> - daily at midnight - same as <code>0 0 * * *</code></dd>
<dd><code>@weekly</code> - weekly at midnight on Sunday - same as <code>0 0 * * 0</code></dd>
<dd><code>@monthly</code> - monthly at midnight on the first day of the month - same as <code>0 0 1 * *</code></dd>
<dd><code>@yearly</code> or <code>@annually</code> - yearly at midnight on the 1st of January - same as <code>0 0 1 1 *</code></dd>
<dd><code>@reboot</code> - when the cron daemon is started. Depending on the implementation, some daemons would run the command again after a service restart, and some prevent it. Additionally, it can be beneficial to delay the command for a bit to make sure everything is up and running.</dd>
<dd>Example: <code>@reboot sleep 300 &amp;&amp; command</code></dd>
</dl>
<h4 id="environment-variables-a-hrefenv-variables-idenv-variablesa">Environment Variables <a href="#env-variables" id="env-variables">#</a></h4>
<p>Cron** does not source any startup files**. We then have to add any environment variable to the crontab to use it.</p>
<p>It was mentioned before, but just declare the environment variable in a new line like this:</p>
<p><code>result=&#34;HELLO WORLD&#34;</code> <em># this environment variable will be available for all commands or scripts of this cron file</em></p>
<p>If you want to add an environment variable <strong>for just one cron job</strong>, you could add it like this:</p>
<p><code>20 4 * * * TZ=&#34;Europe/Berlin&#34; command</code></p>
<h4 id="timezones-a-hreftimezones-idtimezonesa">Timezones <a href="#timezones" id="timezones">#</a></h4>
<p>By default cron uses the system timezone which can be found in the file <code>/etc/timezone</code>.</p>
<pre><code>cat /etc/timezone
Etc/UTC
</code></pre>
<p>Systems often have <strong>multiple users</strong> that might work in <strong>different timezones</strong>. You can add <code>CRON_TZ=TIME/ZOME</code> to the cron file of specific users to specify the timezone.</p>
<p><code>CRON_TZ=Europe/Berlin</code></p>
<p><strong>Side note:</strong> I’ve read that it works for Ubuntu and rockyOS, but I only tested it successfully on rockOS.</p>
<p>Available options can be found in the <code>/usr/share/zoneinfo</code> directory:</p>
<pre><code>ls /usr/share/zoneinfo
Africa      EST5EDT    Iceland    PRC        Zulu               
America     Egypt      Indian     PST8PDT    iso3166.tab        
Antarctica  Eire       Iran       Pacific    leap-seconds.list  
Arctic      Etc        Israel     Poland     leapseconds        
Asia        Europe     Jamaica    Portugal   local time          
Atlantic    Factory    Japan      ROC        posix              
Australia   GB         Kwajalein  ROK        posixrules         
Brazil      GB-Eire    Libya      Singapore  right              
CET         GMT        MET        Turkey     tzdata.zi          
CST6CDT     GMT+0      MST        UCT        zone.tab
Canada      GMT-0      MST7MDT    US         zone1970.tab
Chile       GMT0       Mexico     UTC       
Cuba        Greenwich  NZ         Universal                  
EET         HST        NZ-CHAT    W-SU                                                                      
EST         Hongkong   Navajo     WET                  
</code></pre>
<h4 id="cron-job-permissions-a-hrefpermissions-idpermissionsa">Cron Job Permissions <a href="#permissions" id="permissions">#</a></h4>
<p>There are two configuration files to allow or deny users the use of cron jobs.</p>
<p><code>/etc/cron.deny</code> # it exists by default, but is empty. Any user that is listed in this file can not use cron jobs.</p>
<p><code>/etc/cron.allow</code> # if this file exists, users must be listed in this file to be able to use cron jobs. Just for clarification:** an empty <code>cron.allow</code> file means that no user can use cron jobs.**</p>
<p><strong>If both files are missing</strong>, all users on the system <strong>can</strong> use cron jobs.</p>
<p><strong>If a user is mentioned in both</strong>, the affected user <strong>can not</strong> use cron jobs.</p>
<p><strong>In case you want to deny all users</strong> the use of cron jobs, you can either add <code>ALL</code> to the <code>/etc/cron.deny</code> file or create an empty <code>/etc/cron.allow</code> file.</p>

<p>The cron daemon writes logs into the following files by default:</p>
<p><strong>Ubuntu / Debian</strong></p>
<p><code>/var/log/syslog</code> or <code>/var/log/auth.log</code></p>
<p>You can filter the logs with <code>grep</code>:</p>
<p><code>sudo grep -i cron /var/log/syslog /var/log/auth.log</code></p>
<p><strong>rockyOS / RHEL</strong></p>
<p><code>/var/log/cron</code></p>
<p>The logs are not that detailed, and only the basics are logged.</p>
<hr/>
<p>That said, the output / stdout of the command or script is not logged and must be added to the command or script itself.</p>
<p>Example:</p>
<p><code>0 4 * * 5L command -v &gt;&gt; /var/logs/command.log</code></p>
<p><strong>Side note:</strong> when the cron daemon is not able to run a job - for example when the server is down - all missed cron jobs won’t be repeated and must be run manually if they are important.</p>
<hr/>


<hr/>





</div></div>
  </body>
</html>
