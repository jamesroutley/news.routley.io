<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mrbruh.com/dismantling_malware_operation/">Original</a>
    <h1>Dismantling a Crappy Malware Operation</h1>
    
    <div id="readability-page-1" class="page"><div>
  
<h3 id="the-discovery">The Discovery</h3>
<p>I had been made aware of a malware spreading site called <a href="https://mrbruh.com/dismantling_malware_operation/obspremium.com">obspremium.com</a>. This site is claiming to offer a so-called “premium” version of the popular open source recording and streaming program Open Broadcaster Software at <a href="https://mrbruh.com/dismantling_malware_operation/obsproject.com">obsproject.com</a>. “OBS Premium” hosts a direct rip of it’s legitimate counterparts landing page with a few sentences changed.</p>
<p><strong>The real OBS</strong></p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/real_obs.avif" alt="Real OBS Site"/></p>
<p><strong>The malware site</strong></p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/fake_obs.avif" alt="Fake OBS Site"/></p>
<p>Aside from the text, the other difference between these sites is one offers installers for a very useful recording tool, and the other offers crappy malware. OBS Premium has replaced every download link with a link to a suspicious looking rar file hosted on Dropbox.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/fake_download.avif" alt="Fake OBS Download"/></p>
<p>Unfortunately (fortunately) for macOS and Linux users, all the links give you the same rar file which extracts to a Windows only executable.</p>
<h3 id="the-inspection">The Inspection</h3>
<p>Naturally I decided to download this rar file and crack open the contained exe to see how it worked. It ended up being some python script packaged with PyInstaller so this was rather trivial.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/pyinstxtractor.avif" alt=""/></p>
<p>Then after running the main file through pycdc I had a readable python script.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/webhook.avif" alt=""/></p>
<p>The first thing that catches your eye in that image is probably the Discord webhook, we’ll get to that in a second.</p>
<p>I first wanted to see if there were any other referenced to this code on the internet, So I had a look around and found some interesting strings.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/interesting_strings.avif" alt=""/></p>
<p>This exentually led me to a project called “empyrean”</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/empyrean.avif" alt=""/></p>
<p>Wait a second… I don’t think this is OBS!</p>
<h3 id="the-shutdown">The Shutdown</h3>
<p>Empyrean claims to steal the following information from its victims:</p>
<pre><code>- Discord token info

  - Nitro
  - Badges
  - Billing
  - Email
  - Phone
  - HQ Guilds
  - HQ Friends
  - Gift codes

- Browser data

  - Cookies
  - Passwords
  - History
  - Bookmarks
  - Autofill
  - Chrome, Edge, Brave, Opera GX, and many more...

- Discord injection

  - Send token, password, and email on login or when password is changed

- System info

  - User
  - System
  - Disk
  - Network
  - WiFi
  - Screenshot

- Anti-debug

  - Check if being run in a virustotal sandbox

- Startup persistence

  - Place stub in appdata
  - Add to startup registry
</code></pre><p>All the information this script steals is send via Discord webhook to whoever has deployed it.</p>
<p><strong>Image from empyrean’s GitHub</strong></p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/em2.avif" alt=""/></p>
<p>Obviously I’m not just going to just sit by and let unknowing victims be compromised, and thanks to whichever genius decided a webhook was the best way to retrieve data from victims, this was a simple task. A simple HTTP DELETE request can be used to nuke the webhook preventing further infections via that URL. I of course promptly deleted the webhook and did <strong>not</strong> spam it with nonsense until they were forced to delete it themselves as that would have been too funny for this very serious investigation.</p>
<h3 id="the-reconnaissance">The Reconnaissance</h3>
<p>With this bot shutdown it was back to more digging.</p>
<p>I was ready to start gathering as much information about this operation as possible in order to send the relevant information to the companies providing hosting services to this group, such as DNS provider, web host, Discord since that’s where the stolen information is sent, and any other services I might find. In under minute I found out that they were hosting the site via github.io when attempting to load any sub-directory.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/site_subdir.avif" alt=""/></p>
<p>Now to search GitHub for matching repositories, lets see if anything comes up…</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_search.avif" alt=""/></p>
<p>Well, that was easy. Almost too easy.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_githubio.avif" alt=""/></p>
<p>To confirm if this is indeed the malvertising site we can check the CNAME file and check if it points to the external dns name.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_cname.avif" alt=""/></p>
<p>I so was gobsmacked by the fact that this repo was public that I thought it was a requirement to have the malvertising site visible to the web.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/github_docs.avif" alt=""/></p>
<p>But no, they’re just dumb.</p>
<h3 id="the-culprits">The Culprits</h3>
<p><strong>Yes they have their real names attached to this repo</strong></p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_contributors.avif" alt=""/></p>
<p>The first user has their Facebook linked</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_facebook.avif" alt=""/></p>
<p>… And the second has their school and location linked.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_school.avif" alt=""/></p>
<p>A new challenger approaches!</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/northdev831.avif" alt=""/></p>
<p>Checking their repository list we can find an additional <strong>six</strong> malvertising sites.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/more_malvertising_sites.avif" alt=""/></p>
<p>All of which seem to be hosting the same family of python stealer albeit using different webhooks for each.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/obspremium_stealer_family.avif" alt=""/></p>
<h3 id="the-cleanup">The Cleanup</h3>
<p>I sent an email to discord alerting them to the issue a week ago, no response yet. (Update: It took 10 days but they finally responded)</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/discord_email.avif" alt=""/></p>
<p>As for their domain provider they all use <a href="https://mrbruh.com/dismantling_malware_operation/matbao.net">matbao.net</a> which provides a online abuse report form. No response or takedowns after two weeks though.</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/matbao_report_form.avif" alt=""/></p>
<p>GitHub is the best of all these platforms and allows me to report them directly from their profiles, action was taken by GitHub within 24 hours!</p>
<p><img src="https://mrbruh.com/dismantling_malware_operation/github_report.avif" alt=""/></p>

</div></div>
  </body>
</html>
