<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.3blue1brown.com/lessons/prime-spirals">Original</a>
    <h1>Why do prime numbers make these spirals? (2019)</h1>
    
    <div id="readability-page-1" class="page"><section data-dark="false" data-width="narrow"><div><div><h2 id="why-do-prime-numbers-make-these-spirals">Why Do Prime Numbers Make These Spirals?</h2><p>I&#39;ve had people ask me before why it is that mathematicians care so much about prime numbers. The role they play in math is similar to the role atoms play in chemistry. They&#39;re the fundamental building blocks of the integers, at least when multiplication is involved, and quite often solving some problem can be reduced to first solving it for primes. But honestly, a big part of why mathematicians care so much about primes is that they&#39;re hard to understand. Math is riddled with unsolved problems about primes, so for personality types who are drawn to difficult puzzles, prime numbers have a certain allure that&#39;s almost independent of the practical importance they have in math and related fields, like cryptography.</p><p>Part of the beauty of mathematics is how two seemingly unrelated concepts can be interconnected through an arbitrary choice. I first saw this pattern in a <a href="https://math.stackexchange.com/questions/885879/meaning-of-rays-in-polar-plot-of-prime-numbers/885894">question</a> on the Math Stack Exchange. It was asked by a user under the name <a href="https://math.stackexchange.com/users/167656/dwymark">dwymark</a>, and answered by <a href="https://math.stackexchange.com/users/16078/greg-martin">Greg Martin</a>, and it relates to the distribution of prime numbers, as well as rational approximations for <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span>.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/ppp_writing.png" alt="" loading="lazy"/></p></figure><p>This user had been playing around with plotting data in polar coordinates. As a quick reminder, this means labeling points in 2D space, not with the usual <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xy</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span><span>y</span></span></span></span></span>-coordinates, but instead with a distance from the origin, commonly called <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>r</span></span></span></span></span> for radius, together with the angle that line makes with the horizontal, commonly called theta, <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>θ</span></span></span></span></span>.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/polar_coords.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/polar_coords.mp4#t=0.001"/></video></div></figure><p>The angle is typically given in <em>radians</em>; that means an angle of <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span> is halfway around, and <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span> gives a full circle. Notice, polar coordinates are not unique, in the sense that adding <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span> to the angle doesn&#39;t change the location.</p><div><p>Which other point in polar coordinates does this point <em>not</em> equal? <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mfrac><mrow><mn>7</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3, \frac{7\pi}{2})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>3</span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>7</span><span>π</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span></span></p><p><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mfrac><mrow><mn>3</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3, \frac{3\pi}{2})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>3</span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>3</span><span>π</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mn>3</mn><mo separator="true">,</mo><mfrac><mrow><mn>5</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-3, \frac{5\pi}{2})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>−</span><span>3</span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>5</span><span>π</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mo>−</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3, -\frac{\pi}{2})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>3</span><span>,</span><span></span><span>−</span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>π</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mfrac><mrow><mn>5</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3, \frac{5\pi}{2})</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>3</span><span>,</span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>5</span><span>π</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>)</span></span></span></span></span></p></span><span><i></i></span></label></p></div><p>The pattern we&#39;ll look at centers around plotting points where both these coordinates are a given prime number. </p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,\theta)=(p,p)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>r</span><span>,</span><span></span><span>θ</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>(</span><span>p</span><span>,</span><span></span><span>p</span><span>)</span></span></span></span></span></p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/plotting_primes.png" alt="" loading="lazy"/></p></figure><p>There&#39;s no practical reason to do this. It&#39;s just fun! We&#39;re frolicking in the playground of data visualization. Let&#39;s get a feel for this with all whole numbers, rather than just primes. The point <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1, 1)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>1</span><span>,</span><span></span><span>1</span><span>)</span></span></span></span></span> sits a distance 1 away from the origin, with an angle of 1 radian. <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2, 2)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>2</span><span>,</span><span></span><span>2</span><span>)</span></span></span></span></span> has twice the angle, and twice the distance. Similarly, to get to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3, 3)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>3</span><span>,</span><span></span><span>3</span><span>)</span></span></span></span></span>, you rotate one more radian, with a total angle now slightly less than <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span>, and you step one unit farther from the origin.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/integer_plot.png" alt="" loading="lazy"/></p></figure><p>Make sure it&#39;s clear what&#39;s being plotted, because everything that follows depends on understanding it. Each step forward is like the tip of a clock hand which rotates 1 radian, a little less than <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac16</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>6</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> of a turn, and grows longer by 1 unit. As you continue, these points spiral outward, forming what&#39;s known in the business as an &#34;Archimedean spiral&#34;.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/archimedean_spiral.png" alt="" loading="lazy"/></p></figure><p>If you knock out everything except the prime numbers, it initially looks quite random. After all, primes are famous for their chaotic and difficult-to-predict behavior. But when you zoom out, you see these very clear galactic seeming spirals. What&#39;s weird is that some of the arms seem to be missing.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/galactic_zoomout.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/galactic_zoomout.mp4#t=0.001"/></video></div></figure><p>Zooming out even farther, those spirals give way to a different pattern: these many different outward rays. Those rays seem to come mostly in clumps of 4, but with an occasional gap here and there, like a comb missing some teeth</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/galactic_comb.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/galactic_comb.mp4#t=0.001"/></video></div></figure><p>The question, naturally, is what on <em>Earth</em> is going on here? Where do these spirals come from, and why do we instead get straight lines at a larger scale? You could be more quantitative and count that there are 20 spirals, and up at the larger scale if you patiently went through each ray you&#39;d count a total of 280. But of course, this just raises further questions on where these numbers come from, and why they&#39;d arise from primes.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/ray_count.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/ray_count.mp4#t=0.001"/></video></div></figure><p>These patterns are certainly beautiful, but they don&#39;t have a hidden, divine message about primes. I should say upfront, the fact the math exchange question jumped right into primes makes the puzzle a bit misleading. If you look at all the whole numbers, not just the primes, you see very similar spirals. </p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/integer_rays.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/integer_rays.mp4#t=0.001"/></video></div></figure><p>They&#39;re much cleaner, and there are now 44 of them, but it means the question of where the spirals come from is, perhaps disappointingly, completely separate from what happens when we limit our view to primes.</p><p>Before you get too disappointed, the question of why we see spirals at all is still a great puzzle. And even if primes don&#39;t cause the spirals, asking what goes on when you filter for primes <em>does</em> lead you to one of the most important theorems on the distribution of prime numbers, known as Dirichlet&#39;s theorem. </p><h2 id="ingredients-for-a-spiral-pi">Ingredients for a Spiral PI</h2><p>To start, did you notice that at a much smaller scale there were 6 little spirals? This offers a good starting point to explain what&#39;s happening in the two larger patterns. Notice how all the multiples of 6 form one of the arms of this spiral. Then the next one is every number one above a multiple of 6, and the one after that includes all numbers two above a multiple of 6, and so on. Why is that?</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_spirals.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_spirals.mp4#t=0.001"/></video></div></figure><p>Remember, each step forward in the sequence involves a turn of one radian, so when you count up by 6, you&#39;ve turned a total of 6 radians, which is a little less than <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span>, a full turn. So every time you count up 6, you&#39;ve almost made a full turn, it&#39;s just a little less. Another six steps, a slightly smaller angle, six more, smaller still, and so on, with this angle changing gently enough to give the illusion of a single curving line.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_steps.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_steps.mp4#t=0.001"/></video></div></figure><p>If you limit the view to prime numbers, all but two of these spiral arms go away. Think about it… a prime number can&#39;t be a multiple of 6. It also can&#39;t be 2 above a multiple of 6, unless it&#39;s 2, nor can it be 4 above a multiple of 6, since all those are even numbers. It also can&#39;t be 3 above a multiple of 6 (unless it&#39;s the number 3 itself) since all those numbers are divisible by 3.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_prime_spiral.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_prime_spiral.mp4#t=0.001"/></video></div></figure><p>While we&#39;re in this simpler context, let me introduce some terminology that mathematicians use. Each of these sequences where you&#39;re counting up by 6 is called a &#34;residue class, mod 6&#34;. The word &#34;residue&#34; in this context is a fancy way of saying &#34;remainder&#34;, and mod means something like &#34;from division by&#34;. The label &#34;residue class mod 6&#34; means &#34;a set of remainders from division by 6.&#34;</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/residue_class_mod_6.png" alt="" loading="lazy"/></p></figure><p>For example, 6 goes into 20 three times, with a remainder of 2, so 20 has a &#34;residue of 2 mod 6&#34;. </p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/6_mod_20.png" alt="" loading="lazy"/></p></figure><p>Together with all other numbers leaving a remainder of 2 when the thing you divide by is 6, you have a full &#34;residue class&#34;. I know that sounds like the world&#39;s most pretentious way of saying &#34;everything 2 above a multiple of 6&#34;, and it is! But this is the standard jargon, and it is handy to have some words for the idea.</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>2nd Residue class mod 6</mtext><mspace linebreak="newline"></mspace><mn>6</mn><mi>k</mi><mo>+</mo><mn>2</mn><mo>:</mo><mo stretchy="false">{</mo><mn>2</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>14</mn><mo separator="true">,</mo><mn>20</mn><mo separator="true">,</mo><mn>26</mn><mo separator="true">,</mo><mn>32</mn><mo separator="true">,</mo><mn>38</mn><mo separator="true">,</mo><mo>…</mo><mtext> </mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\text{2nd Residue class mod 6} \\ 6k+2: \{2,8,14,20,26,32,38,\dots \}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>2nd Residue class mod 6</span></span></span><span></span><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>2</span><span></span><span>:</span><span></span></span><span><span></span><span>{</span><span>2</span><span>,</span><span></span><span>8</span><span>,</span><span></span><span>14</span><span>,</span><span></span><span>20</span><span>,</span><span></span><span>26</span><span>,</span><span></span><span>32</span><span>,</span><span></span><span>38</span><span>,</span><span></span><span>…</span><span></span><span>}</span></span></span></span></span></p><p>So in the lingo, each of these spiral arms corresponds to a residue class mod 6, and the reason we see them is that 6 is close to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span>; turning 6 radians is almost a full turn. And the reason we only see two of them when filtering for primes is that all prime numbers are either 1 or 5 above a multiple of 6 (with the exceptions of 2 and 3). The other four residue classes hold numbers which are either even or divisible by 3.</p><div><p>Which residue class mod 6 does the number 381 belong to?</p><p><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">6k+0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>0</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">6k+1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">6k+2</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>2</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">6k+3</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>3</span></span></span></span></span></p></span><span><i></i></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">6k+4</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>4</span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6</mn><mi>k</mi><mo>+</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">6k+5</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>6</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>5</span></span></span></span></span></p></span><span></span></label></p></div><p>With that as a warmup, let&#39;s think about the larger scale patterns. In the same way that 6 steps were close to a full turn, taking 44 steps is <em>very</em> close to a whole number of turns. </p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/44_spiral.png" alt="" loading="lazy"/></p></figure><p>Since there are <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span> radians per rotation, taking 44 steps gives a total of <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>44</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{44}{2\pi}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span><span>π</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>44</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> rotations, which comes out to be just barely above 7 full turns. You could also write this by saying <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>44</mn><mn>7</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{44}{7}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>7</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>44</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> is a close approximation for <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span>, which some of you may better recognize as the famous <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>22</mn><mn>7</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{22}{7}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>7</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>22</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> approximation for <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span>.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/44_7_approx.png" alt="" loading="lazy"/></p></figure><p>So if you count by multiples of 44 in the diagram, each point has almost the same angle as the last, just a <em>little</em> bit bigger, so as you continue on with more and more we get this gentle spiral as that angle increases very slowly. All of the numbers 1 above a multiple of 44 make a similar spiral, but rotated one radian counterclockwise. Same for everything 2 above a multiple of 44, and so on.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/44_residue_arm.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/44_residue_arm.mp4#t=0.001"/></video></div></figure><p>To phrase it with the fancier language, each of these spiral arms is a residue class mod 44. And maybe now you can tell me what happens when we limit the view to prime numbers.</p><p>Prime numbers cannot be a multiple of 44, so that arm won&#39;t be visible. Similarly, you won&#39;t see primes 2 above a multiple of 44, or 4 above, and so on, since all those residue classes have nothing but even numbers.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/prime_spiral_numbered_circle.png" alt="" loading="lazy"/></p><figcaption><p>Of the residual classes mod 44, only 20 arms are visible when filtering for primes.</p></figcaption></figure><p>Likewise, any multiple of 11 can&#39;t be prime, except for 11 itself, so the spiral of numbers 11 above a multiple of 44 won&#39;t be visible, and neither will the spiral of number 33 above a multiple of 44. Each spiral we&#39;re left with is a residue class that doesn&#39;t share any factors with 44. Within each of these spiral arms that we can&#39;t reject out of hand, the primes seem to be somewhat randomly distributed, a fact I&#39;d like you to tuck away for later.</p><p>This is another good chance for a side note on jargon mathematicians use. What we care about here are all the numbers between 0 and 43 that don&#39;t share any prime factors with 44, right? The ones which aren&#39;t even, and aren&#39;t divisible by 11. Two numbers that don&#39;t share any factors like this are called &#34;relatively prime&#34;, or &#34;coprime&#34;.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/coprime_definition.png" alt="" loading="lazy"/></p></figure><p>You can count that there are 20 numbers between 1 and 44 coprime to 44, a fact that a number theorist would compactly write as:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mn>44</mn><mo stretchy="false">)</mo><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">\phi(44)=20</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>ϕ</span><span>(</span><span>44</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>20</span></span></span></span></span></p><p>The greek letter phi, <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>ϕ</span></span></span></span></span>, here refers to &#34;Euler&#39;s totient function&#34; (yet another needlessly fancy word). It is defined to be the number of integers from 1 up to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span> which are coprime to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span>. More obscurely, these numbers are sometimes called the &#34;totatives&#34; of <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span>.</p><p>In short, what the user on math exchange was seeing are two unrelated pieces of number theory illustrated in one drawing: The first is that <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>44</mn><mn>7</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{44}{7}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>7</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>44</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> is a close rational approximation to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span>, which results in residue classes mod 44 being cleanly separated out. The second is that many of these residue classes contain either 0 or 1 primes, so won&#39;t show up, while primes <em>do</em> show up plentifully enough in the remaining 20 residue classes to make these spiral arms visible.</p><p>Perhaps now you can predict what&#39;s going on at a larger scale. Just as 6 radians is vaguely close to a full turn, and 44 radians is quite close to 7 full turns, it so happens that 710 radians is <em>extremely</em> close to a whole number of turns.</p><p>Specifically, 710 radians is <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>710</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{710}{2\pi}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span><span>π</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>710</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> rotations, which works out to be 113 point <em>zero zero zero zero zero</em> nine. This is the same thing as saying that <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>710</mn><mn>113</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{710}{113}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>113</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>710</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> is a very close rational approximation to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span>, which may be recognizable as the <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>355</mn><mn>113</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{355}{113}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>113</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>355</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> approximation of <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span>.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/710_113_approx.png" alt="" loading="lazy"/></p></figure><p>If you want to understand where rational approximations like this come from, and what it means for something like this one to be &#34;unusually good&#34;, take a look at this great <a href="https://www.youtube.com/watch?v=CaasbfdJdJg">mathologer video</a>.</p><p>What this means is that if you move forward by steps of 710, the angle of each new point is almost exactly the same as the last, only microscopically bigger. Even very far out, such a sequence appears to be on a straight line. And of course, the other residue classes mod 710 also form nearly-straight lines.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/710_spiral.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/710_spiral.mp4#t=0.001"/></video></div><figcaption><p>710 radians is so close to a whole number of revolutions that the 710k residue class appears to be almost exactly on the x-axis.</p></figcaption></figure><p>With all 710 of them, and only so many pixels on the screen, it can be a bit hard to make them out. So in this case, it&#39;s actually easier to see once we limit the view to primes, where you don&#39;t see many of these residue classes.</p><div><p>Which quadrant would the <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>710</mn><mi>k</mi><mo>+</mo><mn>60</mn></mrow><annotation encoding="application/x-tex">710k+60</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>710</span><span>k</span><span></span><span>+</span><span></span></span><span><span></span><span>60</span></span></span></span></span> class show up in if it were on the above graph?</p><p><label data-highlight="false"><span></span><span><p>1st (top right)</p></span><span></span></label><label data-highlight="false"><span></span><span><p>2nd (top left)</p></span><span></span></label><label data-highlight="false"><span></span><span><p>3rd (bottom left)</p></span><span><i></i></span></label><label data-highlight="false"><span></span><span><p>4th (bottom right)</p></span><span></span></label></p></div><p>In reality, with a little further zooming, you can see that there is actually a gentle spiral to these, but the fact that it takes so long to become prominent is a wonderful illustration, maybe the best illustration I&#39;ve seen, for just how good an approximation <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>710</mn><mn>113</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{710}{113}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>113</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>710</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> is for <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding="application/x-tex">2\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>2</span><span>π</span></span></span></span></span>. <sup></sup></p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/710_galaxy.png" alt="" loading="lazy"/></p></figure><p>To understand what happens when we filter for primes, it&#39;s entirely analogous to what we did before. The factors of 710 are 71, 5 and 2. So if the remainder is divisible by any of those, then so is your number.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/710_factors.png" alt="" loading="lazy"/></p></figure><p>When you pull up all of the residue classes with odd numbers, it looks like every other ray in our crowded picture. Of those which remain, these are the ones divisible by five, which are nice and evenly spaced at every fifth line. Notice, the fact that primes never show up in these is what explains the pattern of these lines coming in clumps of four. And of those remaining, these four residue classes are divisible by 71, so the primes won&#39;t show up there. This explains why some of the clumps of four seem to be missing a tooth.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/filtering_quad.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/filtering_quad.mp4#t=0.001"/></video></div><figcaption><p>The top left plots all of the residue classes. Each successive plot continues to filter for the prime factors of 710.</p></figcaption></figure><p>So if you were wondering where the number 280 came from earlier, it comes from counting how many numbers from 1 to 710 don&#39;t share any factors with 710; these are the ones that we can&#39;t rule out for including primes based on some obvious divisibility consideration. </p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/280_calculation.png" alt="" loading="lazy"/></p></figure><p>This of course doesn&#39;t guarantee that any particular one <em>will</em> have prime numbers, but when you look at the picture, it actually seems like the primes are pretty evenly distributed among all these remaining classes, wouldn&#39;t you agree?</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/710_rainbow.png" alt="" loading="lazy"/></p><figcaption><p>Every color in the rainbow can be seen, showing that every remaining residue class has about the same density of primes.</p></figcaption></figure><h2 id="dirichlets-theorem">Dirichlet&#39;s Theorem</h2><p>That last point actually relates to a fairly deep fact, known in number theory as &#34;<a href="https://en.wikipedia.org/wiki/Dirichlet%27s_theorem_on_arithmetic_progressions">Dirichlet&#39;s theorem</a>&#34;. To take a simpler example than residue classes mod 710, think of those mod 10. Because we write numbers in base 10, this is the same thing as grouping numbers together by what their last digit is. So numbers ending with a digit 0 form one residue class, numbers ending with a digit 1 form another, and so on.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/residue_class_mod_10.png" alt="" loading="lazy"/></p></figure><p>Other than 2, prime numbers can&#39;t have an even number as their last digit, since that means they&#39;re even. Similarly any prime bigger than 5 can&#39;t end in a 5. There&#39;s nothing surprising there, primes bigger than 5 must end in a 1, 3, 7 or 9. </p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/primes_mod_10.png" alt="" loading="lazy"/></p></figure><p>How are the primes distributed between the residue classes 0 mod 2 and 1 mod 2?</p><p><span tabindex="0">All of the primes except 2 would be in the 1 mod 2 class, because it contains all the odd numbers. The 0 mod 2 class has all the even integers, and the only even prime is 2.</span></p><p>A much more nuanced question is how the primes are distributed among the remaining four groups. Let&#39;s make a quick histogram, counting through each prime, and showing what proportion of primes we&#39;ve seen so far have a given last digit. What do you predict will happen as we go through more and more primes? </p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/histogram_mod_10.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/histogram_mod_10.mp4#t=0.001"/></video></div><figcaption><p>The 2nd and 5th residue class&#39;s proportion go to zero as more primes are added to the histogram.</p></figcaption></figure><p>As we add more primes to the histogram, it seems like a pretty even spread between these four classes, about 25% for each. Maybe that&#39;s what you&#39;d expect. After all, why would primes show any preference for one last digit over another? But it&#39;s highly nonobvious how you would prove such a thing. Or for that matter, how do you rigorously phrase what it is you want to prove?</p><p>A mathematician might go about it like this: If you look at all the prime numbers less than <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span></span> for some large <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span></span>, and consider what fraction of them are, say, one above a multiple of 10, that fraction should approach <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac14</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>4</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> as <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span></span> approaches infinity. </p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="normal">#</mi><mtext> of primes </mtext><mi>p</mi><mtext> where </mtext><mi>p</mi><mo>≤</mo><mi>x</mi><mstyle mathcolor="red"><mtext> and </mtext><mi>p</mi><mo>≡</mo><mn>1</mn><mtext> mod </mtext><mn>10</mn></mstyle></mrow><mstyle mathcolor="black"><mi mathvariant="normal">#</mi><mtext> of primes </mtext><mi>p</mi><mtext> where </mtext><mi>p</mi><mo>≤</mo><mi>x</mi></mstyle></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\lim_{x\to\infty} \left( \frac{\#\text{ of primes }p\text{ where }p\leq x \color{red}\text{ and }p\equiv 1 \text{ mod } 10} {\color{black}\#\text{ of primes }p\text{ where }p\leq x} \right) = \frac14</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span></span><span><span><span>x</span><span>→</span><span>∞</span></span></span></span><span><span></span><span><span>lim</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span>#</span><span><span> of primes </span></span><span>p</span><span><span> where </span></span><span>p</span><span></span><span>≤</span><span></span><span>x</span></span></span><span><span></span><span></span></span><span><span></span><span><span>#</span><span><span> of primes </span></span><span>p</span><span><span> where </span></span><span>p</span><span></span><span>≤</span><span></span><span>x</span><span><span> and </span></span><span>p</span><span></span><span>≡</span><span></span><span>1</span><span><span> mod </span></span><span>10</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>4</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>Likewise for all the other allowable residue classes 3 and 7 and 9. And of course, there&#39;s nothing special about 10, a similar fact should hold for other numbers.</p><p>Consider our old friends the residue classes mod 44. For example, let&#39;s make a similar histogram, showing what proportion of the primes show up in each one. Again, as time goes on, we see an even spread between the 20 allowable residue classes, meaning each spiral arm from our diagram has about the same number of primes as the others. Again, perhaps this is what you&#39;d expect, but it&#39;s <em>shockingly</em> hard to prove.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/histogram_mod_44.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/histogram_mod_44.mp4#t=0.001"/></video></div><figcaption><p>All of the even classes and 11 + 33 quickly go to zero, just like the missing arms of the spiral.</p></figcaption></figure><p>How many primes will be in the 71st histogram bin for the larger spiral pattern (r mod 710)?</p><p><span tabindex="0">Just one! 71 is one of the prime factors of 710, so after 71 is put in the bin, no other primes will follow.</span></p><p>The histograms give a pretty good illustration of what we mean by an even distribution, but it might be enlightening to see how it would be phrased in a math text, fancy jargon and all. It&#39;s essentially what we just saw for 10, only more general. Again, look at all the primes up to some bound <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span></span>, but instead of asking what proportion of them have a residue of, say, 1 mod 10, you ask what proportion have a <em>residue</em> of <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>r</span></span></span></span></span> mod <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span>, where <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span> is any number, and <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>r</span></span></span></span></span> is anything <em>coprime</em> to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span>. </p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mtext> is any number</mtext><mspace linebreak="newline"></mspace><mi>r</mi><mtext> is coprime to </mtext><mi>N</mi><mspace linebreak="newline"></mspace><munder><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mrow><mo fence="true">(</mo><mfrac><mrow><mi mathvariant="normal">#</mi><mtext> of primes </mtext><mi>p</mi><mtext> where </mtext><mi>p</mi><mo>≤</mo><mi>x</mi><mstyle mathcolor="red"><mtext> and </mtext><mi>p</mi><mo>≡</mo><mi>r</mi><mtext> mod </mtext><mi>N</mi></mstyle></mrow><mstyle mathcolor="black"><mi mathvariant="normal">#</mi><mtext> of primes </mtext><mi>p</mi><mtext> where </mtext><mi>p</mi><mo>≤</mo><mi>x</mi></mstyle></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">N\text{ is any number}\\ r\text{ is coprime to }N\\ \lim_{x\to\infty} \left( \frac {\#\text{ of primes }p\text{ where }p\le x \color{red}\text{ and }p\equiv r \text{ mod } N} {\color{black}\#\text{ of primes }p\text{ where }p\le x} \right) = \frac1{\phi(N)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span><span><span> is any number</span></span></span><span></span><span><span></span><span>r</span><span><span> is coprime to </span></span><span>N</span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>x</span><span>→</span><span>∞</span></span></span></span><span><span></span><span><span>lim</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span>#</span><span><span> of primes </span></span><span>p</span><span><span> where </span></span><span>p</span><span></span><span>≤</span><span></span><span>x</span></span></span><span><span></span><span></span></span><span><span></span><span><span>#</span><span><span> of primes </span></span><span>p</span><span><span> where </span></span><span>p</span><span></span><span>≤</span><span></span><span>x</span><span><span> and </span></span><span>p</span><span></span><span>≡</span><span></span><span>r</span><span><span> mod </span></span><span>N</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>ϕ</span><span>(</span><span>N</span><span>)</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>Remember, to be &#34;coprime&#34; means they don&#39;t share factors bigger than 1. Instead of approaching <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac14</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>4</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span>, that proportion approaches <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac1{\phi(N)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>ϕ</span><span>(</span><span>N</span><span>)</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span>, where <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>ϕ</span></span></span></span></span> is that special function I mentioned earlier that gives the number of residues coprime to <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span>. For example:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mrow><mo fence="true">{</mo><mn>1</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mn>7</mn><mo separator="true">,</mo><mn>9</mn><mo fence="true">}</mo></mrow><mi mathvariant="normal">∣</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\phi(10) = |\left\{1,3,7,9\right\}| = 4</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>ϕ</span><span>(</span><span>10</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>∣</span><span></span><span><span>{</span><span>1</span><span>,</span><span></span><span>3</span><span>,</span><span></span><span>7</span><span>,</span><span></span><span>9</span><span>}</span></span><span></span><span>∣</span><span></span><span>=</span><span></span></span><span><span></span><span>4</span></span></span></span></span></p><p>In case this is too clear for the reader, you might even see it buried in more notation, where this denominator and numerator are written with a special prime counting function, which, rather confusingly, has the name <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mi>π</mi></mstyle></mrow><annotation encoding="application/x-tex">\color{blue}\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span>; totally unrelated to the number <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>π</span></span></span></span></span>.</p><div data-flip="false" data-placement="auto" data-text="true" data-sectionwidth="narrow"><div><p><img src="https://reserialised.routley.io/images/pi-creatures/angry.svg" alt="angry pi creature"/></p><svg xmlns="http://www.w3.org/2000/svg" viewBox="-50 -50 100 100"><path fill="#fff" stroke="#000" d="M-35 38a64 45 0 1 0-13-8l-11 24z"></path></svg><p>We&#39;re running out of symbols!</p></div></div><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mrow><mo fence="true">(</mo><mfrac><mstyle mathcolor="blue"><mi>π</mi><mstyle mathcolor="black"><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mi>N</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mstyle></mstyle><mstyle mathcolor="blue"><mi>π</mi><mstyle mathcolor="black"><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mstyle></mstyle></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\lim_{x\to\infty}\left(\frac{\color{blue}\pi\color{black}(x;N,r)}{\color{blue}\pi\color{black}(x)}\right)=\frac1{\phi(N)}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span></span><span><span><span>x</span><span>→</span><span>∞</span></span></span></span><span><span></span><span><span>lim</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span>π</span><span>(</span><span>x</span><span>)</span></span></span><span><span></span><span></span></span><span><span></span><span><span>π</span><span>(</span><span>x</span><span>;</span><span></span><span>N</span><span>,</span><span></span><span>r</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span>ϕ</span><span>(</span><span>N</span><span>)</span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><div><p>What does this equation equal? <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>x</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></msub><mrow><mo fence="true">(</mo><mfrac><mstyle mathcolor="blue"><mi>π</mi><mstyle mathcolor="black"><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">;</mo><mn>6</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mstyle></mstyle><mstyle mathcolor="blue"><mi>π</mi><mstyle mathcolor="black"><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mstyle></mstyle></mfrac><mo fence="true">)</mo></mrow><mo>=</mo><mtext> </mtext><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">\lim_{x\to\infty}\left(\frac{\color{blue}\pi\color{black}(x;6,1)}{\color{blue}\pi\color{black}(x)}\right)=\ ? </annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span>lim</span><span><span><span><span><span><span></span><span><span><span>x</span><span>→</span><span>∞</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span><span><span>(</span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>π</span><span>(</span><span>x</span><span>)</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>π</span><span>(</span><span>x</span><span>;</span><span>6</span><span>,</span><span>1</span><span>)</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span><span>)</span></span></span><span></span><span>=</span><span> </span></span><span><span></span><span>?</span></span></span></span></span></p><p><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac12</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>2</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p></span><span><i></i></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>3</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac13</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>3</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac14</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>4</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>5</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac15</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>5</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p></span><span></span></label><label data-highlight="false"><span></span><span><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mn>6</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac16</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>6</span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p></span><span></span></label></p></div><p>It turns out to be rather difficult to prove that the primes are evenly distributed among residue classes like this. In 1837, Dirichlet published a result which is very close to this, but he used a slightly different definition of density. Instead of simply counting the primes up to a certain threshold, it involves looking at all primes and adding up the values <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><msup><mi>p</mi><mi>s</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{p^s}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span>p</span><span><span><span><span><span><span></span><span><span>s</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span>1</span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span> for some real number <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s &gt; 0</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>s</span><span></span><span>&gt;</span><span></span></span><span><span></span><span>0</span></span></span></span></span>. Specifically, in his notion, here&#39;s how the density of primes which are <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>r</span></span></span></span></span> mod <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span> would look:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munder><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>s</mi><mo>→</mo><msup><mn>1</mn><mo lspace="0em" rspace="0em">+</mo></msup></mrow></munder><mfrac><mstyle scriptlevel="0" displaystyle="true"><munder><mo>∑</mo><mrow><mi>p</mi><mo>≡</mo><mi>r</mi><mtext> mod </mtext><mi>n</mi></mrow></munder><mfrac><mn>1</mn><msup><mi>p</mi><mi>s</mi></msup></mfrac></mstyle><mstyle scriptlevel="0" displaystyle="true"><munder><mo>∑</mo><mi>p</mi></munder><mfrac><mn>1</mn><msup><mi>p</mi><mi>s</mi></msup></mfrac></mstyle></mfrac></mrow><annotation encoding="application/x-tex">\lim _{s \rightarrow 1^{+}} \frac{\displaystyle \sum_{p \equiv r \text{ mod } n} \frac{1}{p^{s}}}{\displaystyle \sum_{p} \frac{1}{p^{s}}}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span></span><span><span><span>s</span><span>→</span><span><span>1</span><span><span><span><span><span><span></span><span><span><span>+</span></span></span></span></span></span></span></span></span></span></span></span><span><span></span><span><span>lim</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span><span><span><span><span></span><span><span><span>p</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>s</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span><span><span><span><span><span></span><span><span><span>p</span><span>≡</span><span>r</span><span><span> mod </span></span><span>n</span></span></span></span><span><span></span><span><span>∑</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span><span><span></span><span><span><span><span><span><span></span><span><span><span>p</span><span><span><span><span><span><span></span><span><span><span>s</span></span></span></span></span></span></span></span></span></span></span><span><span></span><span></span></span><span><span></span><span><span>1</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span></span></span></span></span></p><p>This looks more complicated, but based on the approach Dirichlet used this turns out to be easier to wrangle with mathematically. The real significance of his result, though, was that it was the first time anyone could show that there are infinitely many primes in any residue class (assuming <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>r</span></span></span></span></span> and <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>N</span></span></span></span></span> are coprime).</p><p>For example, imagine you were asked to prove that infinitely many primes end in the digit 1, and the way you do it is by showing that a <em>quarter</em> of all primes end in a 1. Together with the fact that there are infinitely many primes, which we’ve known since Euclid, this gives a much stronger statement, and a much more interesting one.</p><p>So how did Dirichlet prove it? Well… it’s <em>way</em> more involved than what would be reasonable to show here, but one interesting fact worth mentioning is that it relies heavily on complex analysis, which is the study of doing calculus with functions whose inputs and outputs are complex numbers. That may seem surprising, given that prime numbers seem unrelated to the continuous world of calculus, much less when complex numbers end up in the mix. But since the early 19th century, that’s absolutely par for the course when it comes to understanding how primes are distributed.</p><p>This isn’t just antiquated technology. Understanding the distribution of primes in residue classes like this continues to be relevant in modern research, too.<sup></sup> Some of the recent breakthroughs on small gaps between primes, edging towards that ever-elusive twin prime conjecture, have their basis in understanding how primes split up among these kinds of residue classes.</p><figure id="" data-show="image"><div><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/quad_histogram.png" alt="" loading="lazy"/></p><video muted="" controls="" preload="metadata"><source src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/quad_histogram.mp4#t=0.001"/></video></div></figure><h2 id="from-arbitrary-to-important">From Arbitrary to Important</h2><p>To close things off, I want to emphasize something. In some sense, the original bit of data visualization whimsy that led to these patterns... it doesn’t matter. No one cares. There’s nothing natural about plotting <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p, p)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>p</span><span>,</span><span></span><span>p</span><span>)</span></span></span></span></span> in polar coordinates, and most of the initial mystery in these spirals resulted from artifacts that come from dealing with an integer number of radians.</p><p>But on the other hand, this kind of play is <em>clearly</em> worth it if the end result is a line of questions leading you to something like Dirichlet’s theorem, which <em>is</em> important, especially if it inspires you to learn enough to understand the tactics of the proof. </p><p>It’s not a coincidence that a fairly random question like this one can lead you to an important and deep fact from math. What it <em>means</em> for a piece of math to be important is that it connects to many other topics. So even arbitrary explorations of numbers, as long as they aren’t too arbitrary, have a good chance of stumbling into something meaningful.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/many_connections.png" alt="" loading="lazy"/></p></figure><p>Sure, you’ll get a much more concentrated dosage of important facts by going through a textbook or a course, with far fewer uninteresting dead ends. But there’s something special about rediscovering these topics on your own. If you effectively reinvent Euler’s Totient function before ever seeing it defined, or start wondering about rational approximations before learning about continued fractions, or if you seriously explore how primes are divvied up between residue classes before you’ve even heard the name Dirichlet, then when you <em>do</em> learn those topics, you’ll see them as familiar friends, not as arbitrary definitions.</p><figure id="" data-show="image"><p><img src="https://3b1b-posts.us-east-1.linodeobjects.com//content/lessons/2019/prime-spirals/3b1b_spiral.png" alt="" loading="lazy"/></p></figure><h3 id="a-challenging-exploration">A Challenging Exploration</h3><p>As a demonstration for what it is like to explore an arbitrary path of mathematics, let&#39;s extend this problem into 3 dimensions. Spherical coordinates is a method of plotting a point in 3D space using the distance to the origin, the angle from the <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>X</span></span></span></span></span> axis, and the angle from the <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>Z</span></span></span></span></span> axis. We can condense this formula into:</p><p><span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>z</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}x\\y\\z\end{bmatrix} =\begin{bmatrix}p\cos(p)\sin(p)\\p\sin^2(p)\\p\cos(p)\end{bmatrix}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span><span><span><span><span><span><span><span></span><span><span>⎣</span></span></span><span><span></span><span><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span><span></span><span><span>⎡</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span><span><span><span><span></span><span><span>x</span></span></span><span><span></span><span><span>y</span></span></span><span><span></span><span><span>z</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>⎦</span></span></span><span><span></span><span><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span><span></span><span><span>⎤</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span></span><span>=</span><span></span></span><span><span></span><span><span><span><span><span><span><span><span></span><span><span>⎣</span></span></span><span><span></span><span><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span><span></span><span><span>⎡</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span><span><span><span><span><span><span><span></span><span><span>p</span><span></span><span>cos</span><span>(</span><span>p</span><span>)</span><span></span><span>sin</span><span>(</span><span>p</span><span>)</span></span></span><span><span></span><span><span>p</span><span></span><span><span>sin</span><span><span><span><span><span><span></span><span><span>2</span></span></span></span></span></span></span></span><span>(</span><span>p</span><span>)</span></span></span><span><span></span><span><span>p</span><span></span><span>cos</span><span>(</span><span>p</span><span>)</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span><span><span><span><span><span><span></span><span><span>⎦</span></span></span><span><span></span><span><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span><span></span><span><span>⎤</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span></span></span></span></span></p><p>If we take the first few thousand prime numbers and plot them as <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>p</mi><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(p, p, p)</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>(</span><span>p</span><span>,</span><span></span><span>p</span><span>,</span><span></span><span>p</span><span>)</span></span></span></span></span> in spherical coordinates, what pattern emerges? </p><p>The spiral galaxy we saw on the 2D plane is still visible, but now it looks like some type of infinity spiral where the arms of the galaxy are weaving in and out of each other. The <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11</mn><mtext>th</mtext></mrow><annotation encoding="application/x-tex">11\text{th}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>11</span><span><span>th</span></span></span></span></span></span> and <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>33</mn><mtext>rd</mtext></mrow><annotation encoding="application/x-tex">33\text{rd}</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>33</span><span><span>rd</span></span></span></span></span></span> classes are still missing on either side of the center. The above image is actually an interactive applet, go ahead and click and drag on it to move it around.</p><p>The 2D plot gave us question like &#34;why are there spirals?&#34; and &#34;why are some arms missing for primes?&#34; The 3D plot gives us another question &#34;why do the spirals go into an infinity pattern?&#34; And just like the first two questions, this one is also unrelated to either of the previous questions. Take a moment to try and explain why this shape appears in spherical coordinates. I recommend to explore this new prompt with the math community in the comments below, what important topics arise from looking at this arbitrary choice? As you continue your journey into mathematics, keep in mind that sometimes a puzzle should be broken down into simpler components which are easier to deal with individually.</p><h2 id="relation-to-ulam-spirals">Relation to Ulam Spirals</h2><p>There’s a great Numberphile video some of you may have seen entitled <a href="https://www.youtube.com/watch?v=iFuR97YcSLM">prime spirals</a>, in which James Grimes describes a similar, but distinct, pattern with primes. If you haven’t seen it, I’d recommend taking a look. The idea is to write out all numbers in a grid, starting from the center, and spiraling out while circling all the primes. The pattern you get is called an “Ulam Spiral,” named after Stanislaw Ulam who first noticed this while doodling during a boring meeting.</p><p>What you find in the zoomed out pattern is a bias towards certain stripes. In our example, the spirals and rays corresponded to certain linear functions, things like <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>44</mn><mi>x</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">44x + 1</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>44</span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>1</span></span></span></span></span>, or <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>710</mn><mi>x</mi><mo>+</mo><mn>13</mn></mrow><annotation encoding="application/x-tex">710x + 13</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>710</span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>13</span></span></span></span></span>, where you plug in some integer for <span><span><span><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span aria-hidden="true"><span><span></span><span>x</span></span></span></span></span>. The Ulam Spiral pattern highlighted in the Numberphile video is showing something one step more complicated, which is how certain quadratic functions seem to have more primes than others.
There’s an analog to Dirichlet’s theorem, known as the Chebotarev density theorem, laying out exactly how dense you expect primes to be in certain polynomial patterns like these. Again, the details are a bit too technical for the scope here. The point, though, is that not only do primes have plenty of patterns within them, but mathematicians also understand many of those patterns quite well, despite the reputation primes have of being impenetrably complicated.</p></div></div></section><section data-dark="false" data-width="narrow"></section><section data-dark="false" data-width="normal"><div><p>Special thanks to those below for supporting the original video behind this post, and to<!-- --> <a href="https://reserialised.routley.io/thanks">current patrons</a> <!-- -->for funding ongoing projects. If you find these lessons valuable,<!-- --> <a href="https://www.patreon.com/3blue1brown">consider joining</a>.</p><p><span>Juan Benet</span><span>Kurt Dicus</span><span>Vassili Philippov</span><span>Burt Humburg</span><span>Matt Russell</span><span>Scott Gray</span><span>soekul</span><span>Tihan Seale</span><span>D. Sivakumar</span><span>Ali Yahya</span><span>Arthur Zey</span><span>dave nicponski</span><span>Joseph Kelly</span><span>Kaustuv DeBiswas</span><span>kkm</span><span>Lambda AI Hardware</span><span>Lukas Biewald</span><span>Mark Heising</span><span>Nicholas Cahill</span><span>Peter Mcinerney</span><span>Quantopian</span><span>Scott Walter, Ph.D.</span><span>Tauba Auerbach</span><span>Yana Chernobilsky</span><span>Yu Jun</span><span>Jordan Scales</span><span>Lukas -krtek.net- Novy</span><span>Andrew Weir</span><span>Britt Selvitelle</span><span>Britton Finley</span><span>David Gow</span><span>J</span><span>Jonathan Wilson</span><span>Joseph John Cox</span><span>Magnus Dahlström</span><span>Mattéo Delabre</span><span>Randy C. Will</span><span>Ryan Atallah</span><span>Luc Ritchie</span><span>1stViewMaths</span><span>Aidan Shenkman</span><span>Alex Mijalis</span><span>Alexis Olson</span><span>Andreas Benjamin Brössel</span><span>Andrew Busey</span><span>Andrew R. Whalley</span><span>Ankalagon</span><span>Anthony Turvey</span><span>Antoine Bruguier</span><span>Antonio Juarez</span><span>Arjun Chakroborty</span><span>Art Ianuzzi</span><span>Austin Goodman</span><span>Avi Finkel</span><span>Awoo</span><span>Azeem Ansar</span><span>AZsorcerer</span><span>Barry Fam</span><span>Bernd Sing</span><span>Boris Veselinovich</span><span>Bradley Pirtle</span><span>Brian Staroselsky</span><span>Calvin Lin</span><span>Charles Southerland</span><span>Charlie N</span><span>Chris Connett</span><span>Christian Kaiser</span><span>Clark Gaebel</span><span>Danger Dai</span><span>Daniel Herrera C</span><span>Daniel Pang</span><span>Dave B</span><span>Dave Kester</span><span>David B. Hill</span><span>David Clark</span><span>Delton Ding</span><span>Dominik Wagner</span><span>eaglle</span><span>emptymachine</span><span>Eric Younge</span><span>Ero Carrera</span><span>Eryq Ouithaqueue</span><span>Federico Lebron</span><span>Fernando Via Canel</span><span>Frank R. Brown, Jr.</span><span>Giovanni Filippi</span><span>Hal Hildebrand</span><span>Hause Lin</span><span>Henry Bresnahan</span><span>Hitoshi Yamauchi</span><span>Ivan Sorokin</span><span>j eduardo perez</span><span>Jacob Baxter</span><span>Jacob Harmon</span><span>Jacob Hartmann</span><span>Jacob Magnuson</span><span>Jameel Syed</span><span>James Stevenson</span><span>Jason Hise</span><span>Jeff Linse</span><span>Jeff Straathof</span><span>John C. Vesey</span><span>John Griffith</span><span>John Haley</span><span>Johnny Hwang</span><span>John V Wertheim</span><span>Jonathan Eppele</span><span>Josh Kinnear</span><span>Joshua Claeys</span><span>Kai-Siang Ang</span><span>Kanan Gill</span><span>Kartik Cating-Subramanian</span><span>L0j1k</span><span>Lee Redden</span><span>Linh Tran</span><span>Ludwig Schubert</span><span>Magister Mugit</span><span>Mark B Bahu</span><span>Mark Mann</span><span>Martin Price</span><span>Mathias Jansson</span><span>Matt Langford</span><span>Matt Roveto</span><span>Matthew Bouchard</span><span>Matthew Cocke</span><span>Michael Faust</span><span>Michael Hardel</span><span>Michele Donadoni</span><span>Mirik Gogri</span><span>Mustafa Mahdi</span><span>Márton Vaitkus</span><span>Nero Li</span><span>Nikita Lesnikov</span><span>Omar Zrien</span><span>Owen Campbell-Moore</span><span>Patrick Lucas</span><span>Pedro Igor Salomão Budib</span><span>Peter Ehrnstrom</span><span>RedAgent14</span><span>rehmi post</span><span>Rex Godby</span><span>Richard Barthel</span><span>Ripta Pasay</span><span>Rish Kundalia</span><span>Roman Sergeychik</span><span>Roobie</span><span>Ryan Williams</span><span>Sebastian Garcia</span><span>Solara570</span><span>Steven Siddals</span><span>Stevie Metke</span><span>Suthen Thomas</span><span>Tal Einav</span><span>Ted Suzman</span><span>The Responsible One</span><span>Thomas Tarler</span><span>Tianyu Ge</span><span>Tom Fleming</span><span>Tyler VanValkenburg</span><span>Valeriy Skobelev</span><span>Veritasium</span><span>Vinicius Reis</span><span>Xuanji Li</span><span>Yavor Ivanov</span><span>YinYangBalance.Asia</span><span>Andrew Hampson</span><span>Christopher Lorton</span><span>Edward Swartz</span><span>Apurva Varma</span><span>Azman Ahmed</span><span>Ettore Randazzo</span><span>Psylence</span><span>Sean Barrett</span><span>Raphael Nitsche</span><span>Alan Stein</span><span>Alex Dodge</span><span>Alex Frieder</span><span>Alvaro Carbonero</span><span>Alvin Khaled</span><span>Andreas Nautsch</span><span>Andrew Foster</span><span>Andrew Mohn</span><span>Andy Petsch</span><span>Arkajyoti Misra</span><span>Ben Granger</span><span>blockulator</span><span>Bpendragon</span><span>Brian Sletten</span><span>Bryce D. Wilkins</span><span>Carlos Iriarte</span><span>Chandra Sripada</span><span>Chris Sachs</span><span>Christian Cooper</span><span>Christian Mercat</span><span>ConvenienceShout</span><span>Dan Davison</span><span>David H. Friedman</span><span>David House</span><span>David J Wu</span><span>Derek G Miller</span><span>Dheeraj Narasimha</span><span>Dhilung Kirat</span><span>Elliot Winkler</span><span>Eric Koslow</span><span>Eugene Foss</span><span>EurghSireAwe</span><span>Evan Miyazono</span><span>Evan Thayer</span><span>Filip Milosavljevic</span><span>Florian Ragwitz</span><span>Gokcen Eraslan</span><span>Gordon Gould</span><span>Gregory Hopper</span><span>Günther Köckerandl</span><span>Henry Reich</span><span>Hervé Guillon</span><span>Jacob Wallingford</span><span>Jaewon Jung</span><span>Jake Brownson</span><span>James D. Woolery, M.D.</span><span>James Golab</span><span>Jan Pfeifer</span><span>Jay Ebhomenye</span><span>Jayne Gabriele</span><span>Jean Peissik</span><span>Jed Yeiser</span><span>Jeremy Cole</span><span>Jimmy Campbell</span><span>Joo Donghyun</span><span>John</span><span>John Jernigan</span><span>Jon Adams</span><span>Jonathan Trousdale</span><span>Jonathan Whitmore</span><span>Jonathan Wright</span><span>Jono Forbes</span><span>Kasia Hayden</span><span>Keith Smith</span><span>Kenneth Larsen</span><span>Kevin Norris</span><span>Krishanu Sankar</span><span>Lael S Costa</span><span>Lee Burnette</span><span>Longti</span><span>Mahrlo Amposta</span><span>Manne Moquist</span><span>Manuel Garcia</span><span>Matt Parlmer</span><span>Max Anderson</span><span>Mayank M. Mehrotra</span><span>Mert Öz</span><span>Michael Kohler</span><span>Michael W White</span><span>Mike Dour</span><span>Mike Dussault</span><span>Mikko</span><span>Nate Pinsky</span><span>Nenad Vitorovic</span><span>Nican</span><span>Nick Lucas</span><span>Nikolay</span><span>Ocaubrid</span><span>otavio good</span><span>Patch Kessler</span><span>Patron Saint of Noodles</span><span>Paul Pluzhnikov</span><span>Paul Wolfgang</span><span>Peter Bryan</span><span>PeterCxy</span><span>Philipp Paraguya</span><span>Randy True</span><span>Robert Davis</span><span>Robert van der Tuuk</span><span>Roy Larson</span><span>Roy Velich</span><span>Ryan Mahuron</span><span>Sandy Wilbourn</span><span>Sebastian Braunert</span><span>Sergey Ovchinnikov</span><span>Sergey Ten</span><span>Siddhesh Vichare</span><span>sidwill</span><span>Sophie Karlin</span><span>Steve Cohen</span><span>Sundar Subbarayan</span><span>Syafiq Kamarul Azman</span><span>TD</span><span>Thomas Peter Berntsen</span><span>Tim Kazik</span><span>Tim Robinson</span><span>Tino Adams</span><span>Tobias Christiansen</span><span>Trevor Settles</span><span>Tyler Herrmann</span><span>Valentin Mayer-Eichberger</span><span>Victor Castillo</span><span>Victor Kostyuk</span><span>Victor Lee</span><span>Vitalii Kalinkin</span><span>Xierumeng</span><span>Yair kass</span><span>Zachary Elliott</span><span>zhenyu xu</span><span>噗噗兔</span><span>김승현</span><span></span></p></div></section></div>
  </body>
</html>
