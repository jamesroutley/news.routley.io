<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.theregister.com/2024/08/08/copilot_black_hat_vulns/">Original</a>
    <h1>If you give Copilot the reins, don&#39;t be surprised when it spills your secrets</h1>
    
    <div id="readability-page-1" class="page"><div id="body">
<p><span>Black Hat</span> One hopes widely used enterprise software is secure. Get ready for those hopes to be dashed again, as Zenity CTO Michael Bargury today revealed his Microsoft Copilot exploits at Black Hat.</p>
<p>&#34;It&#39;s actually very difficult to create a [Copilot Studio] bot that is safe,&#34; Bargury told <em>The Register</em> in an interview ahead of his conference talks, &#34;because all of the defaults are insecure.&#34; </p>
<p>Bargury is speaking twice about security failings with Microsoft Copilot at Black Hat in Las Vegas this week. His <a href="https://www.blackhat.com/us-24/briefings/schedule/#-ways-to-break-your-copilot-39770" rel="nofollow">first talk</a> focused on the aforementioned Copilot Studio, Microsoft&#39;s no-code tool for building custom enterprise Copilot bots. The <a href="https://www.blackhat.com/us-24/briefings/schedule/#living-off-microsoft-copilot-40074" rel="nofollow">second</a> covered all the nasty things an attacker can do with Copilot itself if they manage to break into the systems of an organization that uses the tech, as well as how to use Copilot to gain that initial access. </p>

    

<p>Zenity, for what it&#39;s worth, offers among other things security controls for Copilot and similar enterprise-level assistants. Bear that in mind. It warns of the risks of using Microsoft&#39;s AI services <a target="_blank" rel="nofollow" href="https://www.zenity.io/remote-copilot-execution/">here</a>.</p>
<h3>Your Copilot bots are quite chatty</h3>
<p>If you don&#39;t have much exposure to <a href="https://www.theregister.com/2023/11/15/microsoft_ignite_copilot/">Copilot Studio</a>, it&#39;s a tool for non-technical people to create simple conversational bots, using Microsoft&#39;s Copilot AI, that can answer people&#39;s questions using internal business documents and data. This is made possible by what&#39;s called retrieval-augmented generation, or <a target="_blank" href="https://www.theregister.com/2024/06/15/ai_rag_guide/">RAG</a>.</p>
<p>It&#39;s Microsoft&#39;s way &#34;to extend [Copilot&#39;s] tentacles into other business areas, such as CRM and ERP,&#34; as we wrote <a target="_blank" href="https://www.theregister.com/2023/11/15/microsoft_ignite_copilot/">here</a>. Companies can create customer and/or employee-facing bots that provide a natural-language interface to internal information.</p>

        


        

<p>Unfortunately for all the Copilot Studio customers out there, we&#39;re told the default settings in the platform are entirely insufficient. Combine those with what Zenity marketing chief Andrew Silberman told us is nearly 3,000 Copilot Studio bots in the average large enterprise (we&#39;re talking Fortune 500-level companies), along with research indicating that 63 percent of those are discoverable online, and you have a potential recipe for a data exfiltration.</p>
<p>Specifically, if these bots are accessible to the public, and we&#39;re told a good number of them are, they can be potentially tricked into handing over, or simply hand over by design, information to people that should not have been volunteered during conversations, it&#39;s claimed.</p>

        

<p>As Copilot bots frequently have access to internal company data and sensitive documents, it&#39;s a matter of figuring out how to fool or prompt them into disclosing that data, we&#39;re told. Bargury said he was able to do that by configuring ChatGPT to fuzz Copilot bots with automated, malformed prompts.</p>
<p>&#34;We scanned the internet and found tens of thousands of these bots,&#34; Bargury said. He blamed the high online availability of these agents on default Copilot Studio settings that published them to the web without any need to authenticate to access them - an oversight Microsoft has since fixed after the Zenity team brought it to their attention. </p>
<p>Unfortunately, new default settings that keep Copilot Studio bots off the public internet by default currently only apply to new installations, Bargury said, so users of the suite who installed it before now should check their deployments to be sure.</p>

        

<p>Bargury and his team have <a target="_blank" rel="nofollow" href="https://labs.zenity.io/p/hsc24">released a new tool</a> to detect and exploit Copilot bot vulnerabilities. Dubbed CopilotHunter, it&#39;s now available as a <a href="https://www.theregister.com/2023/08/10/microsoft_365_guest_accounts_power/">module in PowerPwn</a>, a tool Zenity released at Black Hat last year for <a href="https://www.theregister.com/2023/08/10/microsoft_365_guest_accounts_power/">testing abuses</a> of Microsoft 365 guest accounts. </p>
<h3>Copilot, please breach my target for me</h3>
<p>While Bargury told <em>The Reg</em> he may have overextended himself by planning two Black Hat talks this year, his second shows no less effort - or devastating effect - than the first. </p>
<p>Copilot, Bargury <a target="_blank" rel="nofollow" href="https://www.youtube.com/playlist?app=desktop&amp;list=PLM_RIPYi59BN6BeHyJQ_9fJ4WVsaKPMfv">demonstrated</a> this week, is quite susceptible to indirect prompt injection attacks, which he argues rise to the severity of remote code execution (RCE) when performed against an enterprise target with access to sensitive data. </p>
<p>&#34;An RCE is simply, from a remote location, being able to execute code that does something on your machine,&#34; Bargury said. &#34;Indirect prompt injection that makes an AI do something on your behalf is the exact same thing with the same impact.&#34; </p>
<ul>

<li><a href="https://www.theregister.com/2024/05/21/microsoft_extends_reach_of_copilot/">If you find Microsoft&#39;s Copilot offerings overwhelming, it&#39;s no wonder: There are 130-plus of them now</a></li>

<li><a href="https://www.theregister.com/2024/04/01/us_house_copilot_ban/">US House of Reps tells staff: No Microsoft Copilot for you!</a></li>

<li><a href="https://www.theregister.com/2024/05/07/microsoft_copilot_windows_insiders/">Windows Insiders to fly solo while Copilot rollout frozen</a></li>

<li><a href="https://www.theregister.com/2024/03/18/microsoft_copilot_moneymaker/">Microsoft promises Copilot will be a &#39;moneymaker&#39; in the long term</a></li>
</ul>
<p>With access to a compromised environment, Bargury said he can jailbreak Copilot, make it visit phishing sites to force it to feed malicious information to users, control references, display arbitrary information while secretly exfiltrating encrypted data, conduct operations without user approval and the like. </p>
<p>To top it all off, Copilot can also be tricked into granting initial access to a network, and conduct other malicious activities, with nothing but an email, direct message, calendar invite or other common phishing tactic, but this one even works without the user needing to interact with it or click a link because of how Copilot scans messages. </p>
<p>&#34;Microsoft Copilot is built on the <a href="https://www.theregister.com/2023/09/07/outlook_rest_api_deprecation/">enterprise graph</a>,&#34; Bargury explained. Once a message, email or invite is sent it hits the graph, Copilot scans it, &#34;and that&#39;s a path for me to start with prompt injection.&#34; </p>
<p>In one example, Bargury demonstrated how he was able to change banking information to intercept a bank transfer between a company and client &#34;just by sending an email to the person.&#34; </p>
<h3>An AI bot feature</h3>
<p>Bargury explained to us that he sees these discoveries as indicative of the industry still being in the very early days of artificial intelligence in the enterprise, and having to face the fact that AI is changing our relationship with data. </p>
<p>&#34;There&#39;s a fundamental issue here,&#34; he said. &#34;When you give AI access to data, that data is now an attack surface for prompt injection.&#34; </p>
<blockquote>

<p>When you give AI access to data, that data is now an attack surface for prompt injection</p>
</blockquote>
<p>If that&#39;s true, Copilot bots are by their very nature insecure since many are publicly accessible, they&#39;re tied closely to enterprise data, and are ready to spill secrets with a bit of hidden HTML or a ChatGPT-powered fuzzing bot. </p>
<p>&#34;It&#39;s kind of funny in a way - if you have a bot that&#39;s useful, then it&#39;s vulnerable. If it&#39;s not vulnerable, it&#39;s not useful,&#34; Bargury said. </p>
<p>The Zenity CTO noted that Microsoft has been incredibly responsive to his reports, and said several of the faults he found have been addressed, albeit within limits.</p>
<p>&#34;[AI] apps are basically changing in production because AI chooses to do what it wants, so you can&#39;t expect to have a platform that&#39;s just secure and that&#39;s it,&#34; Bargury said. &#34;That&#39;s not going to happen because these platforms have to be flexible, otherwise they&#39;re not useful.&#34; </p>
<blockquote>

<p>If you have a bot that&#39;s useful, it&#39;s vulnerable. If it&#39;s not vulnerable, it&#39;s not useful</p>
</blockquote>
<p>Bargury believes that securing AI software like Copilot requires real-time monitoring of memory, monitoring conversations and tracking potential prompt-injection RCEs, but even that can be difficult in closed-off enterprise environments. </p>
<p>The bottom line is that businesses are the guinea pigs testing an experimental drug called &#34;artificial intelligence,&#34; and we&#39;re not at a point where we know how to make it safe yet.</p>
<p>Bargury and team have released another testing kit called &#34;LOLCopilot&#34; for organizations that want to test their setups for vulnerability to his exploits. </p>
<p>&#34;Copilot has great skills. It can search, it can enable your employees to find data they have access to but didn&#39;t know they did … those things are important,&#34; Bargury told us. &#34;But that&#39;s not as important as preventing remote code execution.&#34;</p>
<p>We&#39;re seeking a response from Microsoft direct about Zenity&#39;s findings, and will let you know if we hear back from the Windows giant. ®</p>
<h3>Updated to add</h3>
<p>Spokespeople for Microsoft have been in touch to tell us the Azure giant believes it can keep its Copilot users protected by itself, thank you, though it appreciated Zenity&#39;s reports:</p>
                                
                    </div></div>
  </body>
</html>
