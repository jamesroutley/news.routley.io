<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.jim-nielsen.com/2023/html-web-components-an-example/">Original</a>
    <h1>HTML Web Components: An Example</h1>
    
    <div id="readability-page-1" class="page"><div>
          
          <p>In <a href="https://blog.jim-nielsen.com/2023/html-web-components/">my article on HTML web components</a>, I said:</p>
<blockquote>
<p>But the unique power of web components (in the browser) is that they can render before JavaScript. React components cannot do this — full stop.</p>
</blockquote>
<p>There’s a lot in there I wanted to explain more in-depth, but I just never go to it.</p>
<p>Then a reader kindly emailed me and asked:</p>
<blockquote>
<p>what do you mean? As far as I know, web components need a JS API to be defined. How can they run before JS?</p>
</blockquote>
<p>That is a great question. Allow me to explain my thinking.</p>
<p>There are different ways to use web components.</p>
<p>One way of using them requires JavaScript in order for them to “run” and display anything in the browser.</p>
<p>An alternate way of using them allows you to display information/content in the browser before any JavaScript executes, and then you use web component structured JavaScript<sup id="fnref:1"><a href="#fn:1">[1]</a></sup> to enhance what’s already on display.</p>
<p>In an attempt to explain this more, let’s use an simplified example.</p>
<p>Imagine we want to build a component for displaying a user’s avatar. It will be an image and, when hovered, it will display a tooltip that shows their full name.</p>
<p><img src="https://cdn.jim-nielsen.com/blog/2023/user-avatar-end-result.png" width="220" height="220" alt="Screenshot of a profile photo with a mouse cursor hovering over it and dispaying a name."/>

</p><p>If you were building this in React, you could imagine a typical implementation looking something like this:</p>
<pre><code><span>import</span> <span>Tooltip</span> <span>from</span> <span>&#34;3rd-party-tooltip-on-npm&#34;</span>;

<span>function</span> <span>UserAvatar</span>(<span>{ src, name }</span>) {
  <span>const</span> [showTooltip, setShowTooltip] = <span>useState</span>(<span>false</span>);
  <span>return</span> (
    <span><span>&lt;<span>div</span>&gt;</span>
      <span>&lt;<span>img</span>
        <span>src</span>=<span>{src}</span>
        <span>alt</span>=<span>{</span>`<span>Profile</span> <span>photo</span> <span>of</span> ${<span>name</span>}`}
        <span>width</span>=<span>&#34;32&#34;</span>
        <span>height</span>=<span>&#34;32&#34;</span>
      /&gt;</span>
      {showTooltip &amp;&amp; <span>&lt;<span>Tooltip</span>&gt;</span>{name}<span>&lt;/<span>Tooltip</span>&gt;</span>}
    <span>&lt;/<span>div</span>&gt;</span></span>
  )
}


</code></pre>
<p>This is nice enough. But the point is: it requires JavaScript (React, <code>3rd-party-tooltip-on-npm</code>, your JS code) before <em>anything</em> will render in the browser. It’s an all-or-nothing approach. If any JavaScript fails to download, parse, and run, the end user will see absolutely nothing. This is what it will look like:</p>
<p><img src="https://cdn.jim-nielsen.com/blog/2023/user-avatar-blank.png" width="220" height="220" alt="Screenshot of a mouse cursor on a blank white screen."/>

</p><p>Now, since this is a “component” and the web has components, couldn’t you port it to a web component and remove the dependency on React? Yes, you could. (Note: this code is not meant to be production ready, but illustrative.)</p>
<pre><code><span>&lt;<span>user-avatar</span>
  <span>src</span>=<span>&#34;https://www.jim-nielsen.com/.well-known/avatar&#34;</span>
  <span>name</span>=<span>&#34;Jim Nielsen&#34;</span>
&gt;</span><span>&lt;/<span>user-avatar</span>&gt;</span>

<span>&lt;<span>script</span>&gt;</span><span><span>
  class UserAvatar extends HTMLElement {
    connectedCallback() {
      const src = this.getAttribute(&#34;src&#34;);
      const name = this.getAttribute(&#34;name&#34;);
      this.innerHTML = `
        <span>&lt;<span>div</span>&gt;</span>
          <span>&lt;<span>img</span>
            <span>src</span>=<span>&#34;${src}&#34;</span>
            <span>alt</span>=<span>&#34;Profile photo of ${name}&#34;</span>
            <span>width</span>=<span>&#34;32&#34;</span>
            <span>height</span>=<span>&#34;32&#34;</span>
          /&gt;</span>
          
        <span>&lt;/<span>div</span>&gt;</span>
      `;
    }
  }
  customElements.define(&#39;user-avatar&#39;, UserAvatar);
</span></span><span>&lt;/<span>script</span>&gt;</span>
</code></pre>
<p>You can see we have a web component that does something very similar to the React component but it doesn’t require React.</p>
<p>It does, however, still require JavaScript. If the user’s browser fails to download, parse, and run any JavaScript, nothing will display on screen. This is what they’ll see:</p>
<p><img src="https://cdn.jim-nielsen.com/blog/2023/user-avatar-blank.png" width="220" height="220" alt="Screenshot of a mouse cursor on a blank white screen."/>

</p><p>This kind of approach to building web components, per the original question, has a dependence on JavaScript. This web component cannot display anything on screen without JavaScript. It is what I meant in <a href="https://blog.jim-nielsen.com/2023/html-web-components/">my original article</a> when I said “JavaScript web components”.</p>
<p>But there’s another approach to building web components.</p>
<p>This approach is what Jeremy called <a href="https://adactio.com/journal/20618">“HTML web components”</a>. It does not require JavaScript in order to provide basic functionality. But it does require the author of the component to step back and ask, “What am I trying to build here and how can I do it in a way that progressively enhances the end user’s experience?”</p>
<p>What we want to show to is a profile picture of the user. That shouldn’t require JavaScript, it’s just an <code>&lt;img&gt;</code>.</p>
<p>Is there a way for us to provide the basic functionality of <code>&lt;user-avatar&gt;</code> so that, before JavaScript loads (if it loads at all), the user still sees something?</p>
<p>With an approach that considers the idea of HTML web components, you can! Starting with the HTML, you could write something like this:</p>
<pre><code><span>&lt;<span>img</span>
  <span>src</span>=<span>&#34;https://www.jim-nielsen.com/.well-known/avatar&#34;</span>
  <span>alt</span>=<span>&#34;Profile photo of Jim Nielsen&#34;</span>
  <span>width</span>=<span>&#34;32&#34;</span>
  <span>height</span>=<span>&#34;32&#34;</span>
  <span>title</span>=<span>&#34;Jim Nielsen&#34;</span>
/&gt;</span>
</code></pre>
<p>Given this HTML, we have a profile photo with some meta information. Note the <code>title</code> attribute: this will display a tooltip on hover (in browsers that support it). So before any JavaScript has been downloaded, parsed, and run, a desktop browser could display something like:</p>
<p><img src="https://cdn.jim-nielsen.com/blog/2023/user-avatar-base.png" width="220" height="220" alt="Screenshot of a profile photo with a mouse cursor hovering over it displaying a browser-native tooltip."/>

</p><p>Is it what we want our end result to look like? No. Will that tooltip work everywhere? No. Is this The Best Thing Ever™️? No.</p>
<p>But that’s not the point. The point is we’re starting with a baseline, core experience that will provide basic functionality and content to a wide array of user agents before any JavaScript is required.</p>
<p>Once you’ve done everything you can in vanilla HTML to provide core elements of your baseline experience, you can begin enhancing the existing markup with additional functionality.</p>
<p>This is where HTML web components shine. You can wrap that basic functionality in a custom element and then, <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_custom_elements">using the JavaScript APIs of web components</a>, enhance the markup.</p>
<pre><code><span>&lt;<span>user-avatar</span>&gt;</span>
  <span>&lt;<span>img</span>
    <span>src</span>=<span>&#34;https://www.jim-nielsen.com/.well-known/avatar&#34;</span>
    <span>alt</span>=<span>&#34;Profile photo of Jim Nielsen&#34;</span>
    <span>width</span>=<span>&#34;32&#34;</span>
    <span>height</span>=<span>&#34;32&#34;</span>
    <span>title</span>=<span>&#34;Jim Nielsen&#34;</span>
  /&gt;</span>
<span>&lt;/<span>user-avatar</span>&gt;</span>
<span>&lt;<span>script</span>&gt;</span><span>
  <span>class</span> <span>UserAvatar</span> <span>extends</span> <span>HTMLElement</span> {
    <span>connectedCallback</span>(<span></span>) {
      
      <span>const</span> $img = <span>this</span>.<span>querySelector</span>(<span>&#34;img&#34;</span>);
      <span>const</span> src = $img.<span>getAttribute</span>(<span>&#34;src&#34;</span>);
      <span>const</span> name = $img.<span>getAttribute</span>(<span>&#34;title&#34;</span>);

      

      
      <span>this</span>.<span>insertAdjacentHTML</span>(
        <span>&#39;beforeend&#39;</span>, 
        <span>&#39;&lt;!-- code for tooltip here --&gt;&#39;</span>
      );
    }
  }
  customElements.<span>define</span>(<span>&#39;user-avatar&#39;</span>, <span>UserAvatar</span>);
</span><span>&lt;/<span>script</span>&gt;</span>
</code></pre>
<p>Again, this code is for illustration purposes, but it shows how you can leverage HTML to provide the basic functionality of a component and then you enhance it with JavaScript.</p>
<p>Now you have something that works pretty decent. It displays <em>something</em> before JavaScript without any layout shift<sup id="fnref:2"><a href="#fn:2">[2]</a></sup>. And if/when JavaScript loads, you get that nice experience we wanted from the get go.</p>
<p><img src="https://cdn.jim-nielsen.com/blog/2023/user-avatar-both.png" width="520" height="220" alt="Screenshot of a basic HTML profile photo with a `title` tooltip on the left, and an enhanced tooltip with a profile photo on the right."/>

</p><p>Hopefully this answers the question of, “I thought web components required JavaScript? How can they run before JavaScript?”</p>
<p>It’s all about approach. Web components give you an approach of augmentation, where you can provide basic functionality and then progressively enhance the experience depending on the end user’s capabilities.</p>
<p>Endnote: I know, I know, there’s a whole lot more that could be said about all the above. For example, a JS framework like <a href="https://remix.run/">Remix</a> allows you to do something very similar to the above: provide basic HTML over the wire and then enhance (i.e. hydrate) that experience with JavaScript (i.e. React). RSC looks like it’ll do something similar — but that’s all a discussion for another day.</p>
<hr/>
        </div></div>
  </body>
</html>
