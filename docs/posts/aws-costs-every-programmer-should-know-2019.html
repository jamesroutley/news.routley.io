<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://david-codes.hatanian.com/2019/06/09/aws-costs-every-programmer-should-now.html">Original</a>
    <h1>AWS costs every programmer should know (2019)</h1>
    
    <div id="readability-page-1" class="page"><article>
    <p>The title for this blog post is a direct reference to <a href="https://people.eecs.berkeley.edu/~rcs/research/interactive_latency.html">Latency Numbers Every Programmer Should Know</a>. There are several versions of those numbers available now, and I could not find the original author with certainty. Some people attribute the original numbers to <a href="https://twitter.com/jeffdean">Jeff Dean</a>.</p>

<p>When working on a project that will reach a certain scale, you need to balance several concerns. What assumptions am I making and how do I confirm them? How can I get to market quickly? Will my design support the expected scale?</p>

<p>One of the issues associated with scale, is the cost of your infrastructure. Cloud providers allow you to provisions thousands of CPUs and store terabytes of data at the snap of a finger. But that comes at a cost, and what is negligible for a few thousand users might become a burning hole in your budget when you reach millions of users.</p>

<p>In this article, I’m going to list reference numbers I find useful to keep in mind when considering an architecture. Those numbers are not meant for accurate budget estimation. They’re here to help you decide if your design makes sense or is beyond what you could ever afford. So consider the orders of magnitude and relative values rather than the absolute values.</p>

<p>Also consider that your company may get discounts from AWS, and those can make a massive difference.</p>



<p>What’s the cost of a CPU these days? I used the wonderful <a href="https://www.ec2instances.info/">ec2instances.info</a> interface to extract the median price of a vCPU.</p>

<p>You can get the source data out of <a href="https://github.com/powdahound/ec2instances.info/blob/master/www/instances.json">their Github repo</a>. I copied it and processed it using a python script <a href="https://github.com/dhatanian/aws-ec2-costs">that you can find on Github</a>. All prices are for the eu-west-1 region.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Median monthly cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 modern vCPU (4 AWS ECUs)</td>
      <td>58 $/month</td>
    </tr>
    <tr>
      <td>With 1 year convertible reservation (all up front)</td>
      <td>43 $/month</td>
    </tr>
    <tr>
      <td>With 3 years convertible reservation (all up front)</td>
      <td>30 $/month</td>
    </tr>
    <tr>
      <td>With spot pricing (estimated)</td>
      <td>30 $/month</td>
    </tr>
  </tbody>
</table>



<p>AWS represents the computing power of its machines in Elastic Compute Units, and 4 ECUs represent more or less the power of a modern CPU. So the prices above are for one CPU or core, not one instance.</p>

<p>Here’s the price of 1 ECU in $ per hour across all instance types I looked at:</p>

<p><img src="https://david-codes.hatanian.com/assets/posts/2019-06-09-aws-costs-every-programmer-should-now.md/ecu-memory-cost.png" alt="Price of 1 ECU in $ per hour"/></p>

<p>And here’s how on-demand compares with 1 year and 3 year reservations (both convertible, upfront payments):</p>

<p><img src="https://david-codes.hatanian.com/assets/posts/2019-06-09-aws-costs-every-programmer-should-now.md/ondemand-vs-reserved.png" alt="How many more reserved instances can you pay for the same price as on-demand"/></p>



<p>So you want low latency, high throughput and are planning to store everything in Redis? Then on top of those CPU costs, you’ll need to pay for RAM.</p>

<p>I used the same approach to extract the median price of 1GB of RAM on EC2. Elasticache is more or less twice as expensive for on-demand but prices drop quite quickly when looking at reserved instances.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Median monthly cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 GB RAM</td>
      <td>10 $/month</td>
    </tr>
    <tr>
      <td>1 GB RAM 1 year convertible reservation (all up front)</td>
      <td>8 $/month</td>
    </tr>
    <tr>
      <td>1 GB RAM 3 years convertible reservation (all up front)</td>
      <td>5 $/month</td>
    </tr>
    <tr>
      <td>SSD</td>
      <td>0.11 $/month</td>
    </tr>
    <tr>
      <td>Hard Disk</td>
      <td>0.05 $/month</td>
    </tr>
    <tr>
      <td>S3</td>
      <td>0.02 $/month</td>
    </tr>
    <tr>
      <td>S3 Glacier</td>
      <td>0.004 $/month</td>
    </tr>
  </tbody>
</table>

<p>While this is the pure storage cost, you also need to look at the usage patterns for your data. How much CPU will you need to run that in-memory database 24/7?</p>

<p>Same for S3: how much will you pay in writing/reading requests? I’ve seen workloads where the storage cost on S3 was negligible but the cost of writing a lot of objects in S3 made the team write their own filesystem on top of S3.</p>



<p>A few <a href="https://news.ycombinator.com/item?id=20138409">comments on HackerNews</a> pointed out that I left the bandwidth costs out. Indeed if you are serving data to end users, or need cross-region replication, you need to look into those costs as well.</p>

<table>
  <thead>
    <tr>
      <th>Type of data transfer</th>
      <th>Cost of transferring 1GB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>EU/US region to any other region</td>
      <td>0.02 $/GB</td>
    </tr>
    <tr>
      <td>APAC region to any other region</td>
      <td>0.09 $/GB</td>
    </tr>
    <tr>
      <td>EU/US region to Internet</td>
      <td>0.05 $/GB</td>
    </tr>
    <tr>
      <td>APAC region to Internet</td>
      <td>0.08 $/GB</td>
    </tr>
    <tr>
      <td>Between two AZs in the same region</td>
      <td>0.01 $/GB</td>
    </tr>
    <tr>
      <td>Inside the same AZ</td>
      <td>Free</td>
    </tr>
  </tbody>
</table>

  </article></div>
  </body>
</html>
