<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://txt.cohere.com/urzas-ai/">Original</a>
    <h1>We built an AI-powered Magic the Gathering card generator</h1>
    
    <div id="readability-page-1" class="page"><section>
        <p>Magic the Gathering (Magic) has fascinated me since I was a child. It’s pretty unique as a game in that players use asymmetric game pieces. Unlike chess, in which both players have the same pieces in front of them, in Magic, every player sits down at the table with their own deck of cards that they have handcrafted.</p><p>My obsession with the game came from the enjoyment of poring over the thousands of Magic cards released during its history and trying to build a good deck. My only complaint about Magic is that although there are thousands of cards, I really wish there were hundreds of thousands! This was the motivation behind this project—I just wanted more Magic cards.</p><p>It turns out that finetuned <a href="https://docs.cohere.ai/intro-to-llms/?ref=txt.cohere.com">large language models (LLM)</a> are actually really good at creating magic cards, and they can create hundreds of thousands of them in just a few days!</p><p>This is a story of how my two friends and I created <a href="https://urzas.ai/?ref=txt.cohere.com">Urza’s AI</a>, a website that uses Artificial Intelligence (AI) to generate Magic cards, and how over 38 thousand others joined in the fun.</p><figure><a href="https://os.cohere.ai/register?ref=txt.cohere.com"><img src="https://txt.cohere.com/content/images/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png" alt="" loading="lazy" width="2000" height="642" srcset="https://txt.cohere.com/content/images/size/w600/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 600w, https://txt.cohere.com/content/images/size/w1000/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 1000w, https://txt.cohere.com/content/images/size/w1600/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 1600w, https://txt.cohere.com/content/images/size/w2400/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 2400w" sizes="(min-width: 720px) 720px"/></a></figure><h2 id="how-we-built-it">How We Built It</h2><p>Magic the Gathering is a collectible card game played with two or more players. Each player starts with a deck of cards and 20 life points and uses those cards to deal damage to the opponent and reduce the life points to 0. Each card consists of a set of information, including its name, cost, type (out of 6 basic types), subtype, a text description about its abilities, and sometimes a small story about the card (flavor text).</p><p>Together with my colleagues, Ali Sabet and Michael Kozakov, we had this question—what if we could create an AI that, when prompted with just a card name, would generate a playable Magic card that follows the theme of that given name, complete with all the card information and an image?</p><p>It turns out we could! In the end, it took a combination of language AI (an LLM) to generate the text of a Magic card and text-to-image AI to create the card’s image based on the generated text. Here is how we built it.</p><h3 id="step-1-generating-the-text">Step 1: Generating the text</h3><p>LLMs are massive neural networks that model how the human language works. They are pre-trained with a vast body of text data, allowing them to excel in various Natural Language Processing (NLP) use cases.</p><p>One example is <a href="https://cohere.ai/generate?ref=txt.cohere.com">language generation</a>, where an LLM can take a piece of text and continue generating text whose context matches closely the one given. This is the essence of <a href="https://docs.cohere.ai/prompt-engineering-wiki/?ref=txt.cohere.com">prompt engineering</a>, which is what enables so many creative use cases out there such as in creative writing, chatbots, role-playing games, and more.</p><p>With Urza’s AI, given a card name, we wanted to generate original and complete information about the card, such as the cost, type, subtype, and description. Using Cohere’s Generate LLM model, <a href="https://docs.cohere.ai/api-reference/?ref=txt.cohere.com">accessible via an API</a>, we created a few examples of Magic card information as the prompt.</p><p>The outcome was not bad at all. The model generated a very good output, as in the screenshot below, taken from one example generation in the <a href="https://docs.cohere.ai/playground-overview/?ref=txt.cohere.com">Cohere playground</a>.</p><figure><img src="https://txt.cohere.com/content/images/2022/06/generate-card-2.jpg" alt="Prompting the Cohere Generate model to generate original Magic card information" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/generate-card-2.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/generate-card-2.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/generate-card-2.jpg 1600w, https://txt.cohere.com/content/images/2022/06/generate-card-2.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>Prompting the Cohere Generate model to generate original Magic card information</figcaption></figure><p>But though the cards were readable, they were often overpowered or uninterpretable. There was room to make them better. So we decided to take it further by <a href="https://docs.cohere.ai/finetuning-wiki?ref=txt.cohere.com">finetuning</a> a Generate model.</p><p>Finetuning is a step where you take a pre-trained LLM and customize it with your own dataset. The model then goes through a training round and thereafter, can produce outputs that are more attuned to the dataset you had given it.</p><p>So we took a dataset of all the cards released by Wizards of the Coast containing full Magic card descriptions. We finetuned a Cohere Generate model using this dataset⁠—a simple activity of uploading the dataset and kickstarting the finetune via the Playground.</p><p>The result was much richer generations that felt more realistic and playable!</p><figure><img src="https://txt.cohere.com/content/images/2022/06/generate-card-finetune-2.jpg" alt="Getting much richer generations by prompting the finetuned model" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/generate-card-finetune-2.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/generate-card-finetune-2.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/generate-card-finetune-2.jpg 1600w, https://txt.cohere.com/content/images/2022/06/generate-card-finetune-2.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>Getting much richer generations by prompting the finetuned model</figcaption></figure><p>I have saved the prompt so you can <a href="https://t.co/YxP4SZtEE8?ref=txt.cohere.com">try it out here</a>. Take it for a spin and let me know how it went!</p><h3 id="step-2-generating-the-image">Step 2: Generating the image</h3><p>A Magic card of just text without a picture wouldn’t be complete, so we needed to find a way to create card images that match the theme of the generated text.</p><p>For this, we used the <a href="http://wombo.art/?ref=txt.cohere.com">Wombo Art API</a> to generate the card image. Wombo’s API leverages another type of neural network—a model trained with text as the input and image as the output.</p><p>We provided the API with the card name, types, and subtypes. We also made a few other prompt tricks to condition the API to return the kinds of images that we wanted.</p><p>The images generated were impressive! You can see from some examples below that the images captured the themes nicely and were beautifully illustrated to boot.</p><figure><img src="https://txt.cohere.com/content/images/2022/06/example-complete-cards-1.jpg" alt="Getting highly realistic and playable cards via the Cohere and Wombo APIs" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/example-complete-cards-1.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/example-complete-cards-1.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/example-complete-cards-1.jpg 1600w, https://txt.cohere.com/content/images/2022/06/example-complete-cards-1.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>Getting highly realistic and playable cards via the Cohere and Wombo APIs</figcaption></figure><p>More examples here:</p><figure><img src="https://txt.cohere.com/content/images/2022/06/more-example-complete-cards-1.jpg" alt="More examples of cards generated" loading="lazy" width="1920" height="1920" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/more-example-complete-cards-1.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/more-example-complete-cards-1.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/more-example-complete-cards-1.jpg 1600w, https://txt.cohere.com/content/images/2022/06/more-example-complete-cards-1.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>More examples of cards generated</figcaption></figure><p>We didn’t stop there. We also wanted to use AI to generate the card back and the Mana icons. So we created some prompts and sent them to the Wombo API to generate the images.</p><p>Here’s what we got for the card back (except for the title text, which we had to add manually):</p><figure><img src="https://txt.cohere.com/content/images/2022/06/card-back-1.jpg" alt="The card back generated by the Wombo API" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/card-back-1.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/card-back-1.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/card-back-1.jpg 1600w, https://txt.cohere.com/content/images/2022/06/card-back-1.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>The card back generated by the Wombo API</figcaption></figure><p>And here are the Mana icons:</p><figure><img src="https://txt.cohere.com/content/images/2022/06/mana-icons-1.jpg" alt="The Mana icons generated by the Wombo API" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/mana-icons-1.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/mana-icons-1.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/mana-icons-1.jpg 1600w, https://txt.cohere.com/content/images/2022/06/mana-icons-1.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>The Mana icons generated by the Wombo API</figcaption></figure><h3 id="step-3-serving-the-application">Step 3: Serving the application</h3><p>With all the ingredients ready, it’s time to render a complete card. We pieced it together with a bunch of CSS and HTML stuff, which honestly turned out to be the hardest part of the whole project!</p><p>We hosted it on Urza’s AI, a website where you can enter a card name and it will take care of the rest, rendering a complete card. <a href="https://urzas.ai/?ref=txt.cohere.com">Try it out here</a>!</p><h2 id="the-outcome">The Outcome</h2><p>We didn’t know how this project would turn out, but the quality of the cards we saw has been mind-blowing. They felt super realistic and were fully playable. I have actually generated complete decks and printed them out, and the games I have played with them have been wild!</p><figure><img src="https://txt.cohere.com/content/images/2022/06/printed-cards.jpg" alt="Here are the printed cards" loading="lazy" width="2000" height="2667" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/printed-cards.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/printed-cards.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/printed-cards.jpg 1600w, https://txt.cohere.com/content/images/size/w2400/2022/06/printed-cards.jpg 2400w" sizes="(min-width: 720px) 720px"/><figcaption>Here are the printed cards</figcaption></figure><p>Thousands of people seem to agree as well. The Urza’s AI website got more than 38,000 visitors within the first four days of the launch, accumulating more than 183,000 events. We also made it to the front page of Hacker News!</p><p>The usage continues to increase and is totaling more than 40,000 users at the time of writing.</p><figure><img src="https://txt.cohere.com/content/images/2022/06/user-statistics-1.jpg" alt="Getting 38k users and 183k events within four days of launch" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/user-statistics-1.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/user-statistics-1.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/user-statistics-1.jpg 1600w, https://txt.cohere.com/content/images/2022/06/user-statistics-1.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>Getting 38k users and 183k events within four days of launch</figcaption></figure><p>Getting the servers up and running to host the site and surviving the hug of death from Hacker News was not actually that difficult because all the AI is done via network-based API requests. Our site doesn’t even have GPUs. They just make requests to Cohere and Wombo!</p><h2 id="what-made-this-possible">What Made This Possible</h2><p>LLMs are now emerging as a general-purpose answer to implementing NLP use cases. Currently, the common approach to machine learning in NLP is having specific models for specific use cases, with little flexibility within a model to perform different kinds of tasks. But with prompt engineering, we can use the same model to adapt to various use cases by shaping how we want the model to produce its outputs.</p><p>With Urza’s AI, that use case is text generation. We conditioned a model with Magic card information, and because it has been pre-trained with a massive corpus of text data, it was able to capture the prompt’s context. And it duly returned the kind of generation we were looking for.</p><p>But we are only just scratching the surface. Prompt engineering works beyond just simple text generation. We can adapt it to other tasks such as extracting information from a piece of text, paraphrasing, summarizing, classifying, and many more. LLMs’ versatility continues to surprise, and their applications continue to traverse various industries and verticals.</p><p>And if that’s still not enough, we can take an already strong pre-trained LLM up another level with finetuning. With Urza’s AI, the information we needed had a particular pattern and theme, and a baseline LLM would not have been attuned to this nuance. So we finetuned the model with the dataset, which was by no means massive, and saw a marked improvement in the quality of the output.</p><p>Finetuning a model with the Cohere platform is very accessible. You don’t need to be good at machine learning to be able to do it. It’s all done via a user interface.</p><figure><img src="https://txt.cohere.com/content/images/2022/06/cohere-finetuning-interface-1.jpg" alt="Finetuning with Cohere is a simple step via a user interface" loading="lazy" width="1920" height="1080" srcset="https://txt.cohere.com/content/images/size/w600/2022/06/cohere-finetuning-interface-1.jpg 600w, https://txt.cohere.com/content/images/size/w1000/2022/06/cohere-finetuning-interface-1.jpg 1000w, https://txt.cohere.com/content/images/size/w1600/2022/06/cohere-finetuning-interface-1.jpg 1600w, https://txt.cohere.com/content/images/2022/06/cohere-finetuning-interface-1.jpg 1920w" sizes="(min-width: 720px) 720px"/><figcaption>Finetuning with Cohere is a simple step via a user interface</figcaption></figure><h2 id="what-does-this-mean">What Does This Mean</h2><p>It’s incredible to think that via a simple API call, developers can have access to these massive LLMs, previously only within the realms of the big tech companies. Teams looking to leverage this technology can do so without having to worry about building the expertise, infrastructure, dataset, and the associated costs of training and serving a model.</p><p>I really think this is the future of AI development. The most cutting-edge neural networks will always be prohibitively large for most teams to host. So they will just make requests to hosted APIs like Cohere or Wombo.</p><p>I’m excited about empowering makers and innovators to use AI as a tool of creation. APIs such as this level up the playing field, opening up access to those who don’t have the finances and expertise to build and operate AI systems. Instead of having to mess with the technology, they can now focus solely on creating value.</p><p>Try out <a href="https://cohere.ai/generate?ref=txt.cohere.com">Cohere Generate here</a>!</p><figure><a href="https://os.cohere.ai/register?ref=txt.cohere.com"><img src="https://txt.cohere.com/content/images/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png" alt="" loading="lazy" width="2000" height="642" srcset="https://txt.cohere.com/content/images/size/w600/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 600w, https://txt.cohere.com/content/images/size/w1000/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 1000w, https://txt.cohere.com/content/images/size/w1600/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 1600w, https://txt.cohere.com/content/images/size/w2400/2022/07/Screen-Shot-2022-07-15-at-8.57.04-AM.png 2400w" sizes="(min-width: 1200px) 1200px"/></a></figure>
    </section></div>
  </body>
</html>
