<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ounapuu.ee/posts/2022/11/01/finding-use-case-for-raspberry-pi/">Original</a>
    <h1>I finally found a use case for my Raspberry Pi Model B&#43;</h1>
    
    <div id="readability-page-1" class="page"><div>
      
      <p>You have probably heard about the Raspberry Pi. It’s a nice little affordable
single-board computer with a huge community using it for all sorts of projects.</p>
<p>I got my first Raspberry Pi, <a href="https://www.raspberrypi.com/products/raspberry-pi-1-model-b-plus/">the Model B+</a>,
during my first year at university, which was around the winter of 2014/2015.
The idea of a super tiny PC that could actually do useful things was just very
fascinating to me, and I loved the way that green PCB looked.</p>
<p>Over the years, I’ve used that Pi and newer revisions of them in all sorts of
use cases: a simple Kodi media box, a Minecraft server, a web server, retro game
emulation box, and much more.</p>
<p>Because the goal of the Raspberry Pi was to be an affordable platform for
experimentation and learning for everyone, they had to keep the costs down. This
meant that the computing power that the Raspberry Pi 1 packed wasn’t much.
With the Model B+, you get one ARM CPU core that you can overclock to 1 GHz,
and 512MB of RAM. It wasn’t much even at the time of release, and it definitely
isn’t great in 2022.</p>
<p>Due to the very limited performance, the use cases for a Raspberry Pi 1 are
quite limited in 2022. Use cases that don’t require much computational power
are often better solved by other platforms. Use cases that are actually useful
to me and solve a problem I have are too much for the Pi 1. At the same time,
I absolutely hate it when I have computing equipment sitting around on a shelf
doing nothing. I can’t even sell this Pi, because it is not worth much any more
and it has some sentimental value for me.</p>
<p>Taking all that into account, and looking at my parts box, I decided to give one
idea a go: let’s build the slowest damn Syncthing backup endpoint imaginable.</p>

  <figure>
    <img src="http://blog.chaselambda.com/media/finding-use-case-for-raspberry-pi/0-setup.jpg"/>
    
  </figure>


<h3 id="the-build">The build</h3>
<p>Here’s a quick rundown of the parts:</p>
<ul>
<li>SBC: Raspberry Pi 1 Model B+</li>
<li>Storage (microSD): SanDisk 8GB that I had lying around</li>
<li>Storage (USB): Crucial BX500 1TB SATA 2.5&#34; SSD, in an IcyBox USB-SATA enclosure</li>
<li>Power: official Raspberry Pi microUSB power adapter</li>
<li>Networking: TP-Link TL-WN722N USB WiFI adapter</li>
<li>OS: Raspberry Pi OS 32-bit (lite)</li>
<li>Acoustic foam: yes.</li>
</ul>

  <figure>
    <img src="http://blog.chaselambda.com/media/finding-use-case-for-raspberry-pi/1-setup.jpg" alt="Alternate angle of the setup."/>
    
      <figcaption>Alternate angle of the setup.</figcaption>
    
  </figure>


<p>Use case: networked offsite backup of files that I cannot afford
to lose, powered by <a href="https://syncthing.net/">Syncthing</a>, <code>btrfs</code> as the
filesystem, and <a href="https://digint.ch/btrbk/">btrbk</a> as the snapshotting solution.</p>
<p>I set the OS up using the Raspberry Pi imager due to the useful options it
offered, such as automatically setting my SSH public key authentication up.
Once booted, I logged in and ran <code>sudo apt update -y</code>. I knew what to expect
regarding performance, and was still surprised at how slow things have become.
Updating the system and deploying the configuration using Ansible took hours.</p>
<p>The 1TB SSD is formatted as a <code>btrfs</code> file system and mounted to <code>/storage</code>.
For the Syncthing service, I created a separate user <code>syncthing</code> with the home
folder on <code>/storage/home/syncthing</code>. The synced data will live on <code>/storage/syncthing</code>.
Keeping the home folder on the SSD is intentional: Syncthing keeps track of
application state in a database and storing it on the microSD card will wear it
out much faster. The database can also be quite big if you have a lot of
files to sync.</p>
<p>I’m not going to go into the <code>btrbk</code> setup in much detail, but if you’re
interested in that, then <a href="http://blog.chaselambda.com/posts/2022/07/09/btrbk-is-awesome/">I do have a write-up about <code>btrbk</code></a>.
Long story short: snapshots are cool, and they help prevent data loss in case
of accidental deletions.</p>
<p>I set up Syncthing to allow access to the GUI from over the network by changing
the <code>~/.config/syncthing/config.xml</code> file while the service was stopped. Just
change the GUI listen address to <code>0.0.0.0:8384</code>, that will make the GUI accept
connections not only from localhost, but from all machines on the same network.
The next step was to set a password to the GUI and check the “Use HTTPS for GUI”
box, because you probably don’t want any rando messing your machine up.</p>
<p>The choice to go with the WiFi for networking is related to the environment
this system will eventually be deployed to. Ethernet isn’t an option there.</p>
<p>Once the system was all set up and files were syncing extremely slowly, I kept
an eye on the Pi, especially the red power LED. I had set the CPU to run at 1 GHz
using <code>raspi-config</code>, and with both the WiFi adapter and SSD connected, I had
concerns that the Pi could not supply enough power. The power limitations of the
Pi are a common source for issues and that has come up in the past as well,
especially with external storage connected to the Pi. However, with this
particular setup this has not been an issue so far. The fact that Pi is so
underpowered that it cannot even make full use of the SSD is probably a
contributing factor to the overall stability.</p>
<p>The file sync was very slow, but at least it was working. The typical transfer
speeds hovered around 1.5 MB/s. Not great, but given the fact that this setup
will operate in an environment where the download speeds are typically capped
around 15-20 Mbit/s, this will be more than enough.</p>

  <figure>
    <img src="http://blog.chaselambda.com/media/finding-use-case-for-raspberry-pi/2-htop.png" alt="`htop` showing how much the Pi is struggling under operation."/>
    
      <figcaption><code>htop</code> showing how much the Pi is struggling under operation.</figcaption>
    
  </figure>



  <figure>
    <img src="http://blog.chaselambda.com/media/finding-use-case-for-raspberry-pi/3-syncthing.png" alt="Typical transfer speed that I observed with the setup."/>
    
      <figcaption>Typical transfer speed that I observed with the setup.</figcaption>
    
  </figure>


<p>How well will this setup work over a longer time period? Only time will tell.
Just like with <a href="http://blog.chaselambda.com/posts/2021/03/20/whacky-setups-1/">other disastrous tests that I have done</a>,
I’ll try to update this post whenever anything noteworthy happens.</p>
<p>Does this setup make any sense if you need a performant Syncthing endpoint?
Hell no. However, I’m very happy that this little Pi finally has a purpose.</p>
<h3 id="alternatives">Alternatives</h3>
<p>This project was about finding a purpose for an SBC I already had lying around.</p>
<p><a href="https://www.jeffgeerling.com/blog/2022/you-cant-buy-raspberry-pi-right-now">If the price and availability of Raspberry Pi-s wasn’t a complete shitshow in
2022</a>,
I would go for a Raspberry Pi 4 in a heartbeat. I can’t, and that makes me
and most of the Raspberry Pi community very sad. The more performant Pi-s open
up so many possibilities.</p>
<p>An <a href="https://orangepi.com/index.php?route=product/product&amp;product_id=846">Orange Pi Zero</a>
running <a href="https://www.armbian.com/orange-pi-zero/">Armbian</a> was something I also
considered, since I had one lying around, but it was a bit too competent for
the job, and I might find a better use for it eventually.</p>
<p>If you wanted performance, then any x86-based PC will do just fine. My
recommendation is to go for an used PC, be it <a href="http://blog.chaselambda.com/posts/2022/05/10/thinkpad-as-a-home-server/">a laptop</a>
or <a href="https://www.servethehome.com/introducing-project-tinyminimicro-home-lab-revolution/">a very small and efficient PC</a>.
Just keep in mind that the power usage is typically higher on these setups
compared to a small ARM-based single-board computer. If a machine runs 24/7, then
the difference between 2-3 W and 10-20 W will start to matter, especially when
energy prices are quite high in your region.</p>

<p>If you prefer to share your thoughts on this post privately,
<a href="mailto:ihavesomethoughtsonyourblog@ounapuu.ee">just send me an e-mail!</a></p>
<p>Places where you can discuss this post:</p>
<ul>
<li><a href="https://news.ycombinator.com/item?id=33416894">Hacker News</a></li>
<li><a href="https://forum.level1techs.com/t/hddhermans-blog/180788/25?u=hddherman">Level1Techs forum</a></li>
<li><a href="https://www.linkedin.com/posts/%F0%9F%94%A5-herman-%C3%B5unapuu-600516152_i-finally-found-an-use-case-for-my-raspberry-activity-6993065905014378496-l1ER">LinkedIn</a></li>
<li><a href="https://www.reddit.com/user/hddherman/comments/yiyqkd/i_finally_found_an_use_case_for_my_raspberry_pi/">Reddit</a></li>
</ul>

    </div></div>
  </body>
</html>
