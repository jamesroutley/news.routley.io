<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.bhusalmanish.com.np/blog/posts/dns-explained.html">Original</a>
    <h1>DNS Explained – How Domain Names Get Resolved</h1>
    
    <div id="readability-page-1" class="page"><section>
    
  </section><article>
    <div>
      <div>

        <p>
          Last week, I pointed my domain to a new server. Changed the A record, waited... nothing. The old site kept showing up. I cleared my browser cache. Still nothing. Restarted my computer. Nothing.
        </p>

        <p>
          Three hours later, I learned about DNS propagation and TTL. That rabbit hole led me to actually understand how DNS works. Not just &#34;it translates domains to IPs&#34; - but the whole system.
        </p>

        <p>
          Here&#39;s what I learned.
        </p>

        <p>
          At its core, DNS is simple: it translates domain names into IP addresses. You type <code>example.com</code>, DNS returns <code>93.184.216.34</code>, and your browser connects to that IP. Without DNS, you&#39;d need to memorize IP addresses for every website. Nobody wants that.
        </p>

        <p>
          But the <em>how</em> is where it gets interesting.
        </p>

        <h2>DNS Hierarchy</h2>

        <p>
          Here&#39;s the mental model that finally made DNS click for me: it&#39;s organized like a chain of referrals. Each level knows about the level below it, and nobody knows everything.
        </p>

        <p><img src="https://cdn.bhusalmanish.com.np/Article%20Images/dns-explained/dns-hiererchy.png" alt="DNS Hierarchy diagram showing Root, TLDs, Domains, and Subdomains" loading="lazy"/></p><h3>Root (.)</h3>

        <p>
          Every DNS lookup starts here. I didn&#39;t even know root servers existed until I had to debug my propagation issue. There are 13 root server clusters worldwide, operated by organizations like Verisign, ICANN, and NASA. Root servers don&#39;t know where <code>example.com</code> is - but they know where to find the <code>.com</code> TLD servers. They&#39;re the starting point of the referral chain.
        </p>

        <h3>TLD (Top Level Domain)</h3>

        <p>
          You know this part - the last bit of a domain: <code>.com</code>, <code>.org</code>, <code>.in</code>, <code>.io</code>. TLD servers know all domains registered under them. The <code>.com</code> TLD knows where to find <code>example.com</code>, <code>google.com</code>, and every other <code>.com</code> domain.
        </p>

        <p>
          Common TLDs:
        </p>

        <ul>
          <li><code>.com</code> - Commercial (anyone can register)</li>
          <li><code>.org</code> - Organizations</li>
          <li><code>.net</code> - Network services</li>
          <li><code>.io</code> - British Indian Ocean Territory (popular with tech)</li>
          <li><code>.dev</code> - Developers (requires HTTPS)</li>
          <li><code>.gov</code> - US Government only</li>
          <li><code>.edu</code> - Educational institutions</li>
        </ul>

        <h3>Domain</h3>

        <p>
          The name you actually buy: <code>example</code>, <code>google</code>, <code>github</code>. Combined with TLD, you get <code>example.com</code>. This is what you purchase from registrars like Namecheap, GoDaddy, or Cloudflare. I use <a href="https://www.cloudflare.com/dns/" target="_blank" rel="noopener">Cloudflare</a> for my domains - the DNS management is clean and free. (Once you understand DNS, you might want to check out my <a href="https://www.bhusalmanish.com.np/blog/posts/deploy-drf-production.html">guide on deploying Django REST Framework to production</a> - that&#39;s where you&#39;ll actually use this knowledge.)
        </p>

        <h3>Subdomain</h3>

        <p>
          Anything before the domain: <code>api.example.com</code>, <code>mail.example.com</code>, <code>staging.example.com</code>. The cool part? You create these yourself through DNS records. No additional purchase needed. If you own <code>example.com</code>, you can create unlimited subdomains for free.
        </p>

        <h2>DNS Records</h2>

        <p>
          When I first opened my domain&#39;s DNS panel, I saw a bunch of record types I didn&#39;t understand. A, AAAA, CNAME, MX, TXT... it looked intimidating. But once you know what each one does, it&#39;s actually straightforward.
        </p>

        <h3>A Record</h3>

        <p>
          This is the one you&#39;ll use most. Maps a domain to an IPv4 address. When I moved my site to a new server, this is what I changed.
        </p>

        <pre><code>example.com    A    93.184.216.34</code></pre>

        <p>
          When someone requests <code>example.com</code>, DNS returns <code>93.184.216.34</code>.
        </p>

        <h3>AAAA Record</h3>

        <p>
          Same thing, but for IPv6 addresses. The weird name? Four A&#39;s because IPv6 addresses are four times longer than IPv4. I haven&#39;t had to set one of these up myself yet.
        </p>

        <pre><code>example.com    AAAA    2606:2800:220:1:248:1893:25c8:1946</code></pre>

        <h3>CNAME (Canonical Name)</h3>

        <p>
          This one&#39;s clever. Instead of pointing to an IP, it points to another domain. It says &#34;go ask this other domain instead.&#34;
        </p>

        <pre><code>www.example.com     CNAME    example.com
blog.example.com    CNAME    example.ghost.io</code></pre>

        <p>
          Super useful when you use third-party services. I use this to point subdomains to hosted services - your blog can point to Ghost, your docs to GitBook, without managing their IPs yourself.
        </p>

        <h3>MX (Mail Exchange)</h3>

        <p>
          Ever wondered how <code><a href="https://www.bhusalmanish.com.np/cdn-cgi/l/email-protection" data-cfemail="f9919c959596b980968c8b9d9694989097d79a9694">[email protected]</a></code> knows where to go? MX records. They specify where to deliver emails for your domain. The priority number matters - lower numbers are tried first.
        </p>

        <pre><code>example.com    MX    10    mail1.example.com
example.com    MX    20    mail2.example.com</code></pre>

        <p>
          When someone emails <code><a href="https://www.bhusalmanish.com.np/cdn-cgi/l/email-protection" data-cfemail="a3cbc6cfcfcce3c6dbc2ced3cfc68dc0ccce">[email protected]</a></code>, mail servers check the MX record to find where to deliver. If <code>mail1</code> (priority 10) is down, it tries <code>mail2</code> (priority 20).
        </p>

        <h3>TXT Record</h3>

        <p>
          This one seems random at first - it just stores text. But it&#39;s used for some important stuff.
        </p>

        <pre><code>example.com    TXT    &#34;v=spf1 include:_spf.google.com ~all&#34;
example.com    TXT    &#34;google-site-verification=abc123xyz&#34;</code></pre>

        <p>
          I&#39;ve used TXT records for:
        </p>

        <ul>
          <li><strong>Domain verification</strong> - Google, Stripe, AWS ask you to add a TXT record to prove you own the domain</li>
          <li><strong>SPF</strong> - Specifies which servers can send email on your behalf (prevents spoofing)</li>
          <li><strong>DKIM</strong> - Email authentication using cryptographic signatures</li>
          <li><strong>DMARC</strong> - Policy for handling failed SPF/DKIM checks</li>
        </ul>

        <h2>TTL (Time To Live)</h2>

        <p>
          This is what got me. Remember my three hours of confusion? The TTL on my old A record was 3600 seconds. That&#39;s one hour. Every resolver that had cached my old IP would hold onto it for up to an hour before checking again.
        </p>

        <p>
          TTL tells resolvers how long to cache a DNS result.
        </p>

        <pre><code>example.com    A    93.184.216.34    TTL=3600</code></pre>

        <p>
          This means: &#34;Cache this answer for 3600 seconds (1 hour). Don&#39;t ask again until then.&#34;
        </p>

        <p>
          Common TTL values:
        </p>

        <ul>
          <li><strong>300 (5 min)</strong> - Frequent changes, quick failover needed</li>
          <li><strong>3600 (1 hour)</strong> - Normal websites</li>
          <li><strong>86400 (1 day)</strong> - Rarely changes</li>
        </ul>

        <h3>The Trade-off</h3>

        <p>
          <strong>Low TTL</strong> = Faster updates, but more DNS queries (slightly slower first load).
        </p>

        <p>
          <strong>High TTL</strong> = Fewer DNS queries (better performance), but slower propagation when you change records.
        </p>

        <blockquote>
          Pro tip I learned the hard way: if you&#39;re planning to migrate servers, lower your TTL to 300 a few days before. After migration, old cached records expire in 5 minutes instead of hours. Wish I&#39;d known this before my migration.
        </blockquote>

        <h2>DNS Resolution Process</h2>

        <p>
          Once I traced through this whole process, everything clicked. Here&#39;s what actually happens when you type <code>api.example.com</code> in your browser:
        </p>

        <pre><code>Step 1: Browser cache
&#34;Do I have api.example.com cached?&#34; → No

Step 2: OS DNS cache
&#34;Do I have it?&#34; → No

Step 3: Router cache
&#34;Do I have it?&#34; → No

Step 4: ISP&#39;s DNS Resolver
&#34;Do I have it?&#34; → No, let me find out...

Step 5: Ask Root Server
Resolver: &#34;Where is api.example.com?&#34;
Root: &#34;I don&#39;t know, but .com TLD is at 192.5.6.30&#34;

Step 6: Ask .com TLD Server
Resolver: &#34;Where is api.example.com?&#34;
TLD: &#34;I don&#39;t know, but example.com&#39;s nameserver is at ns1.example.com&#34;

Step 7: Ask example.com&#39;s Nameserver
Resolver: &#34;Where is api.example.com?&#34;
NS: &#34;It&#39;s at 93.184.216.34&#34;

Step 8: Response flows back
Resolver caches it (based on TTL)
Returns 93.184.216.34 to your browser

Step 9: Browser connects to 93.184.216.34</code></pre>

        <p>
          Visual representation:
        </p>

        <p><img src="https://cdn.bhusalmanish.com.np/Article%20Images/dns-explained/dns-resolution-process.png" alt="DNS Resolution Process diagram showing the flow from browser through caches to nameserver" loading="lazy"/></p><p>
          Each intermediate resolver caches the result based on TTL. Subsequent requests from the same network skip most of this because the resolver already knows the answer. That&#39;s why the second visit to a site is faster than the first.
        </p>

        <h2>What is a Resolver?</h2>

        <p>
          I used to confuse resolvers and nameservers. They sound similar, but they do different jobs.
        </p>

        <p>
          A resolver is a DNS server that does the hard work of finding IP addresses for you. It handles the recursive lookup through Root → TLD → Authoritative nameservers.
        </p>

        <p>
          Your device asks a resolver: &#34;What&#39;s the IP of example.com?&#34;
          The resolver does all the work and returns: &#34;It&#39;s 93.184.216.34&#34;
        </p>

        <p>
          Common public resolvers:
        </p>

        <ul>
          <li><code>8.8.8.8</code> - Google Public DNS</li>
          <li><code>1.1.1.1</code> - Cloudflare (fastest, privacy-focused)</li>
          <li><code>208.67.222.222</code> - OpenDNS (Cisco)</li>
          <li><code>9.9.9.9</code> - Quad9 (security-focused, blocks malware)</li>
        </ul>

        <p>
          You can change which resolver you use in your network settings. I switched to <code>1.1.1.1</code> on my machines - it&#39;s noticeably faster than my ISP&#39;s default resolver.
        </p>

        <h2>What is a Nameserver?</h2>

        <p>
          A nameserver is the source of truth. It actually holds the DNS records for a domain. When you register a domain, you point it to nameservers that store your A records, CNAME records, MX records, etc.
        </p>

        <p>
          The difference between resolvers and nameservers:
        </p>

        <ul>
          <li><strong>Resolver</strong> - Finds answers by asking other servers (the messenger)</li>
          <li><strong>Nameserver</strong> - Holds the actual DNS records (the source of truth)</li>
        </ul>

        <p>
          When you buy a domain from Namecheap or GoDaddy, they give you default nameservers like:
        </p>

        <pre><code>ns1.namecheap.com
ns2.namecheap.com</code></pre>

        <p>
          You can change these to use Cloudflare, AWS Route 53, or your own nameservers:
        </p>

        <pre><code># Cloudflare nameservers
ns1.cloudflare.com
ns2.cloudflare.com

# AWS Route 53 (example)
ns-1234.awsdns-56.org
ns-789.awsdns-12.co.uk</code></pre>

        <p>
          Why bother changing nameservers? Different providers offer different features. I moved my domains to Cloudflare because they give you free DDoS protection, a CDN, and the dashboard is just nicer to use. Route 53 makes sense if you&#39;re already deep in AWS.
        </p>

        <h3>Authoritative vs Recursive</h3>

        <p>
          <strong>Authoritative nameserver</strong> - Has the final answer for a domain. When asked &#34;Where is example.com?&#34;, it responds with the actual IP because it holds the records.
        </p>

        <p>
          <strong>Recursive resolver</strong> - Doesn&#39;t hold records, but finds answers by asking authoritative servers. Your ISP&#39;s DNS server and <code>8.8.8.8</code> are recursive resolvers.
        </p>

        <h2>View DNS Cache</h2>

        <p>
          These commands saved me during my debugging session. When you need to see what&#39;s actually cached:
        </p>

        <h3>In Browser</h3>

        <pre><code># Chrome
chrome://net-internals/#dns

# Firefox
about:networking#dns

# Edge
edge://net-internals/#dns</code></pre>

        <p>
          These show all cached domains with their IPs and remaining TTL.
        </p>

        <h3>On Your Computer</h3>

        <pre><code># Windows (Command Prompt)
ipconfig /displaydns

# Mac
sudo dscacheutil -cachedump

# Linux
# Most distros use systemd-resolved
resolvectl statistics</code></pre>

        <h3>Query a Domain</h3>

        <pre><code># Using nslookup (Windows/Mac/Linux)
nslookup example.com

# Using dig (Mac/Linux - more detailed)
dig example.com

# Query specific record type
dig example.com MX
dig example.com TXT

# Query using a specific resolver
dig @8.8.8.8 example.com
dig @1.1.1.1 example.com</code></pre>

        <h2>Clear DNS Cache</h2>

        <h3>Browser</h3>

        <p>
          Go to <code>chrome://net-internals/#dns</code> and click &#34;Clear host cache&#34;.
        </p>

        <h3>Operating System</h3>

        <pre><code># Windows
ipconfig /flushdns

# Mac
sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder

# Linux (systemd)
sudo systemd-resolve --flush-caches</code></pre>

        <p>
          This is what I should&#39;ve done first. Flushing the cache forces your system to fetch fresh DNS records instead of using stale cached ones.
        </p>

        <h2>Why DNS Matters for System Design</h2>

        <p>
          Here&#39;s where DNS gets interesting beyond just &#34;hosting a website.&#34; If you&#39;re designing systems at scale, DNS becomes a tool, not just a lookup service.
        </p>

        <h3>Load Distribution</h3>

        <p>
          DNS can return different IPs for the same domain. Each request might get a different server. This is called DNS round-robin load balancing.
        </p>

        <pre><code>example.com    A    93.184.216.34
example.com    A    93.184.216.35
example.com    A    93.184.216.36</code></pre>

        <h3>Failover</h3>

        <p>
          If one server dies, DNS can stop returning its IP. Health checks detect the failure, DNS record is updated, traffic flows to healthy servers.
        </p>

        <h3>Geographic Routing</h3>

        <p>
          Return IPs of servers closest to the user. A user in Europe gets European server IPs, a user in Asia gets Asian server IPs. This is called GeoDNS or latency-based routing.
        </p>

        <h3>Caching Trade-offs</h3>

        <p>
          DNS caching reduces lookup time and load on DNS servers. But it makes instant updates impossible. If you change an IP and TTL is 24 hours, some users will hit the old IP for up to 24 hours.
        </p>

        <h2>Quick Reference</h2>

        <pre><code>┌─────────────┬────────────────────────────────────────┐
│ Term        │ What it does                           │
├─────────────┼────────────────────────────────────────┤
│ Root        │ Top of DNS tree, knows TLD locations   │
│ TLD         │ .com, .org, .io - knows domains under  │
│ Domain      │ What you buy (example, google)         │
│ Subdomain   │ What you create free (api, www, mail)  │
├─────────────┼────────────────────────────────────────┤
│ A Record    │ Domain → IPv4 address                  │
│ AAAA Record │ Domain → IPv6 address                  │
│ CNAME       │ Domain → Another domain (alias)        │
│ MX          │ Where to send email                    │
│ TXT         │ Verification, SPF, DKIM, DMARC         │
├─────────────┼────────────────────────────────────────┤
│ TTL         │ Cache duration in seconds              │
│ Resolver    │ Server that finds IPs for you          │
└─────────────┴────────────────────────────────────────┘</code></pre>

        <p>
          DNS broke my site for three hours. But now I actually understand it - not just what it does, but how it works. Next time something doesn&#39;t propagate, I&#39;ll know exactly where to look.
        </p>

        <p>
          What&#39;s something you use every day but never really understood until it broke?
        </p>

        <!-- Newsletter Signup -->
        <div>
          <h3>Get the next one.</h3>
          <p>New posts on building, breaking, and shipping products. Straight to your inbox.</p>
          
        </div>

        <!-- Author Bio -->
        <div>
          <p><img src="https://cdn.bhusalmanish.com.np/Landing%20Page/manish-bhusal-image.jpeg" alt="Manish Bhusal" loading="lazy"/></p><div>
            <h4>Manish Bhusal</h4>
            <p>Software Developer from Nepal. 3x Hackathon Winner. Building digital products and learning in public.</p>
            
          </div>
        </div>

      </div>
    </div>
  </article></div>
  </body>
</html>
