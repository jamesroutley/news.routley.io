<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://erikarow.land/notes/iex-charlists">Original</a>
    <h1>Configure IEx to Show Lists as Lists</h1>
    
    <div id="readability-page-1" class="page"><div>
<span id="whoami">
<img src="https://rolepad.com/avatar.png"/>

<span>
Hi, I’m Erika Rowland (a.k.a. <strong>erikareads</strong>).
</span>

<span>
Hi, I’m Erika. I’m an Ops-shaped Software Engineer, Toolmaker, and Resilience Engineering fan.
I like Elixir, Reading, and Design. She/Her.
</span>
</span>

<span id="timestamps">
<span>
Published on <time datetime="2023-10-02" id="published">
October 02, 2023</time>
</span>

</span>
<nav id="main-nav">
<ul>
<li>
<a href="https://rolepad.com/">Home</a>
</li>
<li>
<a href="https://rolepad.com/articles">Articles</a>
</li>
<li>
<a href="https://rolepad.com/notes">Notes</a>
</li>
<li>
<a href="https://rolepad.com/other">Other</a>
</li>
</ul>
</nav>      
<section id="Configure-IEx-to-Show-Lists-as-Lists">

<p>Charlists are a holdover from Erlang as an alternate form of string. In Erlang, strings are syntax sugar on a list of binary characters that make up that string. In Elixir, strings are syntax sugar over UTF-8 encoded binaries.<label for="fn1"></label><span><span>Erlang also has the <a href="https://www.erlang.org/doc/programming_examples/bit_syntax.html">concept of binaries</a> (called a bitstring), they just aren’t the default string implementation. Elixir chose to implement strings directly on top of bitstrings instead of lists.</span></span> Since Elixir has first class support for Erlang code, it needs to easy to convert Elixir strings into the charlists that Erlang functions expect.<label for="fn2"></label><span><span>If you’re interested in reading more, <a href="https://hexdocs.pm/elixir/1.12/List.html#module-charlists">here</a> is a note about charlists in Elixir’s documentation.</span></span></p>
<p>Elixir’s support for charlists manifests in interesting ways. By default, Elixir’s IEx renders lists that contain printable characters as charlists.</p>
<p>Thus:</p>
<pre><code>iex()&gt; Enum.chunk_every(1..10, 2)
[[1, 2], [3, 4], [5, 6], &#39;\a\b&#39;, &#39;\t\n&#39;]
</code></pre>
<p>The single-quoted <code>&#39;</code> characters on the right are charlists. However, it’s a bit annoying to have to translate between charlists and the actual lists. In this case: <code>[7, 8]</code> and <code>[9, 10]</code> that those charlists represent.</p>
<p>The pretty printing that IEx does when it returns a value is powered by Elixir’s <code>inspect</code>. <code>inspect</code> takes some configuration, as detailed in <code>Inspect.Opts</code><label for="fn3"></label><span><span>Read the rest of the options available <a href="https://hexdocs.pm/elixir/1.12/Inspect.Opts.html">here</a>.</span></span><label for="fn4"></label><span><span><code>:infer</code> is why our example above is <em>partially</em> charlists, it only recognises the list starting with <code>7</code> to be entirely printable characters and opportunistically transforms it.</span></span>:</p>
<blockquote>
<p><code>:charlists</code> - when <code>:as_charlists</code> all lists will be printed as charlists,
non-printable elements will be escaped.
When <code>:as_lists</code> all lists will be printed as lists.</p>
<p>When the default <code>:infer</code>, the list will be printed as a charlist if it is
printable, otherwise as list. See <code>List.ascii_printable?/1</code> to learn when a
charlist is printable.</p>
</blockquote>
<p><code>Kernel.inspect/2</code> accepts a list of options that are internally translated to an <code>Inspect.Opts</code> struct:</p>
<pre><code>iex()&gt; inspect(Enum.chunk_every(1..10, 2), charlists: :as_lists)
&#34;[[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]&#34;
</code></pre>
<p>Now I have a string that looks correct, but I would like IEx to return the value, but print it correctly. And I would like to not have to invoke <code>inspect</code> with my settings every time.</p>
<p>Thankfully, IEx gives us <code>IEx.configure</code> that allow me to configure my IEx session. <code>IEx.configure</code> takes a keyword list of options to set, and offers <code>inspect</code> as a possible key:</p>
<pre><code>iex()&gt; IEx.configure(inspect: [charlists: :as_lists])
:ok
iex()&gt; Enum.chunk_every(1..10, 2)
[[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]]
</code></pre>
<p>Success!</p>
<p>If I want to make this happen every time, I can add the <code>IEx.configure</code> call to <code>~/.iex.exs</code>.<label for="fn5"></label><span><span>You can set things on a per-project basis too, read more <a href="https://hexdocs.pm/iex/1.12/IEx.html#module-the-iex-exs-file">here</a>.</span></span></p>
</section>

</div></div>
  </body>
</html>
