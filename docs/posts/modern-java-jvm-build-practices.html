<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/binkley/modern-java-practices">Original</a>
    <h1>Modern Java/JVM Build Practices</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/LICENSE.md">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/public-domain.svg" alt="Public Domain" width="20%" height="auto"/>
</a>

<p dir="auto"><a href="https://github.com/binkley/modern-java-practices/actions"><img src="https://github.com/binkley/modern-java-practices/workflows/build/badge.svg" alt="build"/></a>
<a href="https://github.com/binkley/modern-java-practices/pulls"><img src="https://camo.githubusercontent.com/297d2a51e4c30bfa4b73b8f92708db8e113b98cf72ce0f4ac969e6938c8017db/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732d70722f62696e6b6c65792f6d6f6465726e2d6a6176612d7072616374696365732e737667" alt="pull requests" data-canonical-src="https://img.shields.io/github/issues-pr/binkley/modern-java-practices.svg"/></a>
<a href="https://github.com/binkley/modern-java-practices/issues/"><img src="https://camo.githubusercontent.com/4c3775d6e83e524bc3873ce2b68d12bc1afa78a053b1089df99bca6ab4c5aa1d/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6973737565732f62696e6b6c65792f6d6f6465726e2d6a6176612d7072616374696365732e737667" alt="issues" data-canonical-src="https://img.shields.io/github/issues/binkley/modern-java-practices.svg"/></a>
<a href="https://snyk.io/test/github/binkley/modern-java-practices" rel="nofollow"><img src="https://camo.githubusercontent.com/ee59e1faa2edf5ad53f0cb03eb0169fa852ba2490c1649f2eb7437e4fb36aa48/68747470733a2f2f736e796b2e696f2f746573742f6769746875622f62696e6b6c65792f6d6f6465726e2d6a6176612d7072616374696365732f62616467652e737667" alt="vulnerabilities" data-canonical-src="https://snyk.io/test/github/binkley/modern-java-practices/badge.svg"/></a>
<a href="http://unlicense.org/" rel="nofollow"><img src="https://camo.githubusercontent.com/e95e2a293e67e64dfda39526a65dbea24a673851e7a0397803e9cabcb90c5379/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d5075626c6963253230446f6d61696e2d626c75652e737667" alt="license" data-canonical-src="https://img.shields.io/badge/license-Public%20Domain-blue.svg"/></a></p>
<p dir="auto"><strong>Modern Java/JVM Build Practices</strong> is an article-as-repo on building modern
Java/JVM projects using
<a href="https://docs.gradle.org/current/userguide/userguide.html" rel="nofollow">Gradle</a> and
<a href="https://maven.apache.org/what-is-maven.html" rel="nofollow">Maven</a>, and a <em>starter project</em>
for Java.</p>
<p dir="auto">The focus is <em>best build practices</em> and <em>project hygiene</em>.
This document is <em>agnostic</em> between Gradle and Maven: discussion in each section
covers both tools (alphabetical order, Gradle before Maven).
See <a href="https://blog.frankel.ch/final-take-gradle/" rel="nofollow"><em>My Final Take on Gradle (vs.
Maven)</em></a> for an opinionated view.</p>
<p dir="auto">This is not a JVM starter for only Java:
I use it for starting my Kotlin projects, and substitute complilation and code
quality plugins.
Any language on the JVM can find practices and tips.</p>
<p dir="auto">As a <em>guide</em>, this project focuses on:</p>
<ul dir="auto">
<li>A quick starter for JVM projects using Gradle or Maven.
<a href="https://github.com/binkley/modern-java-practices/fork">Fork</a> me,
<a href="https://github.com/binkley/modern-java-practices.git">clone</a> me, copy/paste
freely!
I am <a href="http://unlicense.org/" rel="nofollow"><em>Public Domain</em></a></li>
<li>Discuss—and illustrate (through code)—sensible default practices;
highlight good build tools and plugins</li>
<li>Document pitfalls that turned up.
Some were easy to address after Internet search; some were challenging
(see &#34;Tips&#34; sections)</li>
<li>Do not be an &#34;all-in-one&#34; solution. You know your circumstances best.
I hope this project helps you discover build improvements you love.
Please share with others through
<a href="https://github.com/binkley/modern-java-practices/issues">issues</a> or
<a href="https://github.com/binkley/modern-java-practices/pulls">PRs</a></li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-two-recurring-themes" aria-hidden="true" tabindex="-1" href="#two-recurring-themes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Two recurring themes</h3>
<ul dir="auto">
<li><em>Shift problems left</em> — Find issues earlier in your build—before
you see them in production</li>
<li><em>Make developer life easier</em> — Automate build tasks often done by
hand: get your build to complain (<em>fail</em>) locally before sharing with your
team, or fail in CI before deployment</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-what-is-a-starter" aria-hidden="true" tabindex="-1" href="#what-is-a-starter"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What is a <em>Starter</em>?</h3>
<p dir="auto">A project starter has several goals:</p>
<ul dir="auto">
<li>Help a new project get up and running with minimal fuss</li>
</ul>
<p dir="auto">This starter project is focused on <em>build</em>:</p>
<ul dir="auto">
<li>Easy on-ramp for new folks to try out your project for themselves</li>
<li>Support new contributors to your project that they become productive quickly</li>
<li>Support current contributors in the build, get out of their way, and make
everyday things easy</li>
</ul>
<p dir="auto">This starter project has minimal dependencies.
The focus is on Gradle and Maven plugins and configuration so that you and
contributors can focus on the code, not on setting up the build.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-summing-up" aria-hidden="true" tabindex="-1" href="#summing-up"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Summing up</h3>
<ul dir="auto">
<li><em>I&#39;m not a great programmer; I&#39;m just a good programmer with great habits.</em>
—
<a href="https://www.goodreads.com/quotes/532211-i-m-not-a-great-programmer-i-m-just-a-good-programmer" rel="nofollow">Kent Beck</a></li>
<li><em>Make it work, make it right, make it fast</em>
— <a href="http://wiki.c2.com/?MakeItWorkMakeItRightMakeItFast" rel="nofollow">C2 Wiki</a></li>
</ul>
<p dir="auto"><strong>NB</strong> — This is a <em>living document</em>.
The project is frequently updated to pick up new dependency or plugin
versions, and improved practices; this README updates recommendations.
This is part of what <em>great habits</em> look like.
See <a href="#reusing-this-project"><em>Reusing this project</em></a> for tips on pulling in
updates.</p>
<p dir="auto">(Credit to Yegor Bugayenko for <a href="https://www.yegor256.com/2019/04/23/elegant-readme.html" rel="nofollow"><em>Elegant
READMEs</em></a>.)</p>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/try.png"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/try.png" alt="Try..." width="20%" height="auto"/></a></p>

<h2 tabindex="-1" dir="auto"><a id="user-content-try-it" aria-hidden="true" tabindex="-1" href="#try-it"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Try it</h2>
<p dir="auto">After cloning or forking this project to your machine, try out the build
combination that makes sense for you:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ./gradlew build  # Local-only build
$ ./batect build-with-gradle  # CI build with Batect
$ earthly +build-with-gradle  # CI build with Earthly
$ ./mvnw verify  # Local-only build
$ ./batect build-with-maven  # CI build with Batect
$ earthly +build-with-maven  # CI build with Earthly"><pre>$ ./gradlew build  <span><span>#</span> Local-only build</span>
$ ./batect build-with-gradle  <span><span>#</span> CI build with Batect</span>
$ earthly +build-with-gradle  <span><span>#</span> CI build with Earthly</span>
$ ./mvnw verify  <span><span>#</span> Local-only build</span>
$ ./batect build-with-maven  <span><span>#</span> CI build with Batect</span>
$ earthly +build-with-maven  <span><span>#</span> CI build with Earthly</span></pre></div>
<p dir="auto">(You may find that the &#34;CI&#34; build works great for you locally as part of your
regular command line.
Most IDEs would use the &#34;local-only&#34; build.)</p>
<p dir="auto">See what the starter program does:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ./run-with-gradle.sh
$ ./run-with-maven.sh"><pre>$ ./run-with-gradle.sh
$ ./run-with-maven.sh</pre></div>
<hr/>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/changes.png"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/changes.png" alt="Changes" width="20%" height="auto"/></a></p>

<h2 tabindex="-1" dir="auto"><a id="user-content-recent-significant-changes" aria-hidden="true" tabindex="-1" href="#recent-significant-changes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Recent significant changes</h2>
<ul dir="auto">
<li>Gradle: remove use of <code>testsets</code> plugin for integration testing in favor of
native Gradle. This is in support of Gradle 8</li>
</ul>
<hr/>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/table-of-contents.png"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/table-of-contents.png" alt="Table of Contents" width="20%" height="auto"/></a></p>

<h2 tabindex="-1" dir="auto"><a id="user-content-toc" aria-hidden="true" tabindex="-1" href="#toc"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>TOC</h2>
<ul dir="auto">
<li><a href="#try-it">Try it</a></li>
<li><a href="#recent-significant-changes">Recent significant changes</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#reusing-this-project">Reusing this project</a></li>
<li><a href="#contributing">Contributing</a></li>
<li><a href="#you-and-your-project">You and your project</a></li>
<li><a href="#getting-your-project-started">Getting your project started</a></li>
<li><a href="#the-jdk">The JDK</a></li>
<li><a href="#use-gradle-or-maven">Use Gradle or Maven</a></li>
<li><a href="#setup-your-ci">Setup your CI</a></li>
<li><a href="#keep-local-consistent-with-ci">Keep local consistent with CI</a></li>
<li><a href="#maintain-your-build">Maintain your build</a></li>
<li><a href="#choose-your-code-style">Choose your code style</a></li>
<li><a href="#generate-code">Generate code</a></li>
<li><a href="#leverage-the-compiler">Leverage the compiler</a></li>
<li><a href="#use-linting">Use linting</a></li>
<li><a href="#use-static-code-analysis">Use static code analysis</a></li>
<li><a href="#shift-security-left">Shift security left</a></li>
<li><a href="#leverage-unit-testing-and-coverage">Leverage unit testing and coverage</a></li>
<li><a href="#use-mutation-testing">Use mutation testing</a></li>
<li><a href="#use-integration-testing">Use integration testing</a></li>
<li><a href="#debugging">Debugging</a></li>
<li><a href="#samples">Samples</a></li>
<li><a href="#going-further">Going further</a></li>
<li><a href="#problems">Problems</a></li>
<li><a href="#credits">Credits</a></li>
</ul>
<hr/>
<a href="https://modernagile.org/" title="Modern Agile" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/modern-agile-wheel-english.png" alt="Modern Agile" width="20%" height="auto"/>
</a>
<h2 tabindex="-1" dir="auto"><a id="user-content-introduction" aria-hidden="true" tabindex="-1" href="#introduction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Introduction</h2>
<p dir="auto">Hi! I want you to have <em>awesome builds</em> 🟢. If you&#39;re on a <em>Java</em> project,
or a project on any
<em><a href="https://en.wikipedia.org/wiki/List_of_JVM_languages" rel="nofollow">JVM language</a></em>
(Clojure, Groovy, JRuby, Java, Jython, Kotlin, Scala, <em>et al</em>), this article is
for you.
This article assumes you are using Gradle or Maven for your build locally, and
in CI.
Some of you are using other build systems native to your source language.
Please follow along!</p>
<p dir="auto"><strong>What is the goal of this article?</strong> I want to highlight modern practies in
building Java/JVM projects with Gradle or Maven, and provide guidance, or at
least food for thought.
The sample Gradle and Maven projects use Java, but most recommendations apply to
builds for <em>any</em> JVM language.
I&#39;ll never be as clever or as talented as <a href="http://poignant.guide/book/" rel="nofollow"><em>why the lucky stiff</em></a>, but I
hope writing this makes you, developers, and others happy.</p>
<p dir="auto">See the wheel to the right?
<em>No, you do not need to be agile!</em>
(But I encourage you to explore the benefits of Agile.)
This article is for you regardless of how your team approaches software.
The point is to <em>&#34;make people awesome&#34;</em> for any project, possibly the most key
value of the Agile approach to software.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-principles-in-designing-these-builds" aria-hidden="true" tabindex="-1" href="#principles-in-designing-these-builds"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Principles in designing these builds</h3>
<ol dir="auto">
<li><em>Make it work</em>
<ul dir="auto">
<li>Can I as a Day 1 developer build the project locally?</li>
<li>Can I hand the project off to someone else to try?</li>
</ul>
</li>
<li><em>Make it right</em>
<ul dir="auto">
<li>Can I reproduce issues in the CI build, and fix it locally?</li>
<li>Can I find code and security issues from running the build?</li>
<li>Is the code clean? Am I happy to explore the project?</li>
</ul>
</li>
<li><em>Make it fast</em>
<ul dir="auto">
<li>Can I run the local build as frequently as I like, and be productive?</li>
<li>Can I have a fast cycle of code &amp; test? What about red-green-refactor?</li>
<li>Can I update my dependencies and plugins quickly and easily?</li>
</ul>
</li>
</ol>
<h3 tabindex="-1" dir="auto"><a id="user-content-goals-for-this-project" aria-hidden="true" tabindex="-1" href="#goals-for-this-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Goals for this project</h3>
<ul dir="auto">
<li>Starter build scripts for Modern Java/JVM builds in Gradle and Maven, helpful
for new projects, or refurbishing existing projects</li>
<li>Quick solutions for raising project quality and security in your local build</li>
<li>Shift <em>problems to the left</em> (&#34;to the left&#34; meaning earlier in the development
cycle). You&#39;ll get earlier feedback while still having a fast local build.
Time spent fixing issues locally is better than waiting on CI to fail, or
worse, for production to fail</li>
<li>The article focuses on Gradle and Maven: these are the most used build tools
for Modern Java/JVM projects. However, if you use a different build tool, the
principals still apply</li>
</ul>
<p dir="auto">I want to help with the question: <em>I am in Day 1 on my project</em>: How do I begin
with a local build that supports my team through the project lifetime?
And when I have an existing project, how to I catch up?</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-goal-of-this-article" aria-hidden="true" tabindex="-1" href="#goal-of-this-article"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Goal of this article</h3>
<p dir="auto"><a href="https://modernagile.org/" rel="nofollow"><em>Make people awesome</em></a> (that means <em>you</em>). This
project is based on the experiences of many, and experiments with Modern
Java/JVM builds, and shares lessons learned with you.</p>
<hr/>
<a href="https://github.com/binkley/modern-java-practices/fork" title="Reuse">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/reuse.png" alt="Reuse" width="20%" height="auto"/>
</a>
<h2 tabindex="-1" dir="auto"><a id="user-content-reusing-this-project" aria-hidden="true" tabindex="-1" href="#reusing-this-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Reusing this project</h2>
<p dir="auto">Don&#39;t forget to <a href="https://github.com/binkley/modern-java-practices/fork"><em>fork
me</em></a> or <em>clone</em> me! This
is <a href="http://unlicense.org/" rel="nofollow"><em>Public Domain</em></a> software: it is meant to be reused
by you however is sensible.
If you fork, I take care that upstream pulls work, but I&#39;d like to <a href="https://github.com/binkley/modern-java-practices/issues">hear from
you</a> if you have
trouble.
See also: <a href="https://github.com/binkley/modern-java-practices#cleaning-up"><em>Cleaning
up</em></a>.</p>
<p dir="auto">Sensible approaches:</p>
<ul dir="auto">
<li>Fork this project, and work from there, pulling down improvements (usually
version bumps on tools and dependencies)</li>
<li>Clone this project to a new repository, and work from there. Manually pull
over improvements (there is <a href="https://github.com/binkley/modern-java-practices#keep-plugins-and-dependencies-up-to-date">tooling to
help</a>)</li>
<li>Read through this repository&#39;s code and changes, and update your own
repository by hand, useful for existing repositories</li>
</ul>
<p dir="auto">If you cloned this project as a starter, you may want to stay updated on
improvements:</p>
<div data-snippet-clipboard-copy-content="git remote add upstream https://github.com/binkley/modern-java-practices.git
git fetch upstream
git merge master/upstream"><pre><code>git remote add upstream https://github.com/binkley/modern-java-practices.git
git fetch upstream
git merge master/upstream
</code></pre></div>
<p dir="auto">Once you are happy with your project, you should think about removing the
upstream remote, and reviewing changes in this repository by hand.
Your decision might depend on what merge conflicts you encounter.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips" aria-hidden="true" tabindex="-1" href="#tips"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>Consider <a href="https://stackoverflow.com/questions/30001304/clone-git-repository-without-history" rel="nofollow"><em>Clone git repository without
history?</em></a>
to start at the current tip of this project. For example, some images in
<code>README.md</code> started overlarge in earlier versions, something you may not want
in a clone</li>
<li><em>Caution</em>: Not all the images used in <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/README.md"><code>README.md</code></a> may be in the
Public Domain (this is challenging to research). Use due diligence before
sharing your clone, and other licenses may apply for these images in a
global context</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-irrelevant-files" aria-hidden="true" tabindex="-1" href="#irrelevant-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Irrelevant files</h3>
<p dir="auto">This project includes files which are helpful for maintaining itself, but may
be irrelevant to you. Some, however, may prove helpful in specific contexts as
noted:</p>
<ul dir="auto">
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/build-as-ci-does.sh"><code>build-as-ci-does.sh</code></a>
Helpful when CI has steps that local developers do not, and you want to
reproduce or explore locally a CI problem. The script should match the
actions your CI takes on pushes (this project uses GitHub actions)</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/compare-tooling-versions.sh"><code>compare-tooling-versions-sh</code></a>
If your project supports <em>both</em> Gradle and Maven builds (unlikely), a
quick way to look at dependency and plugin versions between the two.
Note that the ouput needs <em>human</em> reading: the same tool version may appear
as different lines when comparing</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/coverage.sh"><code>coverage</code></a>
Checks if the local code passes at given levels of code coverage.
The script is focused on Maven, but with edits would do the same for Gradle.
This supports the <a href="#leverage-unit-testing-and-coverage">&#34;ratchet&#34; pattern</a></li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/run-with-gradle.sh"><code>run-with-gradle.sh</code></a>
If you are a Gradle project, you will likely rename this to just <code>run</code> or
similar</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/run-with-maven.sh"><code>run-with-maven.sh</code></a>
If you are a Maven project, you will likely rename this to just <code>run</code> or
similar</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-contributing" aria-hidden="true" tabindex="-1" href="#contributing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Contributing</h2>
<p dir="auto">See <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/CONTRIBUTING.md"><code>CONTRIBUTING.md</code></a>.
Please <a href="https://github.com/binkley/modern-java-practices/issues">file issues</a>,
or contribute <a href="https://github.com/binkley/modern-java-practices/pulls">pull
requests</a>!
I&#39;d love a conversation with you.</p>
<hr/>

<h2 tabindex="-1" dir="auto"><a id="user-content-you-and-your-project" aria-hidden="true" tabindex="-1" href="#you-and-your-project"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>You and your project</h2>
<p dir="auto">There are simple ways to make your project great. Some goals to strive for:</p>
<ul dir="auto">
<li>Visitors and new developers get off to a quick start, and can understand what
the build does (if they are interested)</li>
<li>Users of your project trust it—the build does what it says on the
tin—, and they feel safe relying on your project</li>
<li>You don&#39;t get peppered with questions that are answered &#34;in the source&#34;
—because not everyone wants to read the source, and you&#39;d rather be
coding than answering questions ☺</li>
<li>Coding should feel easy. You solve <em>real</em> problems, and do not spend overmuch
much time on build details: your build supports you</li>
<li>Your code passes &#34;smell tests&#34;: no simple complaints, and you are proud of
what others see. <em>Hey!</em> You&#39;re a professional, and it shows. (This is one of
my personal fears as a programmer)</li>
<li>Your project is &#34;standard&#34;, meaning, the build is easily grasped by those
familiar with standard techniques and tooling</li>
</ul>
<p dir="auto">Hopefully this article and the sample build scripts help you!</p>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-getting-your-project-started" aria-hidden="true" tabindex="-1" href="#getting-your-project-started"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Getting your project started</h2>
<p dir="auto">To get a project off to a good start, consider these items. Even for existing
projects, you should address these as you go along or while refurbishing an
existing project:</p>
<ul dir="auto">
<li><strong>Team agreement comes first</strong>. Make sure everyone is onboard and clear on
what build standards are, and understands—at least as an
outline—what the build does for them</li>
<li>Provide a <em>good</em> <code>README.md</code>. This saves you a ton of time in the long run.
This is your <em>most important</em> step. A good resource is Yegor&#39;s
<a href="https://www.yegor256.com/2019/04/23/elegant-readme.html" rel="nofollow"><em>Elegant READMEs</em></a>
<ul dir="auto">
<li><a href="https://thethreevirtues.com/" rel="nofollow">Intelligent laziness is a virtue</a>. Time
invested in good documentation pays off</li>
<li>A good <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/README.md"><code>README.md</code></a> answers visitors questions, so you don&#39;t
spend time answering trivial questions, and explains/justifies your
project to others.</li>
<li>Fight <a href="https://en.wikipedia.org/wiki/Conway%27s_law" rel="nofollow">Conway&#39;s Law</a> with
communication!</li>
</ul>
</li>
<li>Pick a version of Java, and stick to it throughout your local build, CI
pipeline, and environment deployments. <em>Do not mix versions.</em></li>
<li>Pick <strong>Gradle</strong> or <strong>Maven</strong>, and use only one. This project provides both to
demonstrate equivalent builds for each. See
<a href="#use-gradle-or-maven">Use Gradle or Maven</a> for more discussion</li>
<li>Use build wrappers committed into your project root. These run Gradle or
Maven, and coders should always invoke <code>./gradlew</code> or <code>./mvnw</code> (use shell
<em>aliases</em> if these grow tiresome to type)
<ul dir="auto">
<li>Build wrappers are shell scripts to run Gradle or Maven. The wrapper takes
care of downloading needed tools without getting in the way. New
contributors and developers can start right away; they do not need to
install more software</li>
<li>For Gradle, use
<a href="https://docs.gradle.org/current/userguide/gradle_wrapper.html" rel="nofollow"><code>./gradlew</code></a>
(part of Gradle)</li>
<li>For Maven, use <a href="https://maven.apache.org/wrapper/" rel="nofollow"><code>./mvnw</code></a> (a plugin)</li>
</ul>
</li>
<li>Always run CI on push to a shared repository. It&#39;s a sad panda when someone is
excited about their commit, and then the commit breaks the other developers
<ul dir="auto">
<li>In CI, use caches for dependency downloads; this speeds up the feedback
cycle from CI (see <a href="#setup-your-ci">below</a>)</li>
<li>When sensible, move code quality and security checks into local builds
before changes hit CI (see <a href="#setup-local-ci">below</a>)</li>
</ul>
</li>
<li>Pick a common code style, and stay consistent; update tooling to complain on
style violations
<ul dir="auto">
<li>The team should agree on a common code style, <em>eg</em>, SUN, Google, <em>et al</em></li>
<li>See <a href="#use-linting">Use linting</a></li>
</ul>
</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-1" aria-hidden="true" tabindex="-1" href="#tips-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>
<p dir="auto">Consider using client-side Git hooks for <code>pre-push</code> to run a full, clean,
local build. This helps ensure &#34;oopsies&#34; from going to CI where they impact
everyone. The options are broad. Try web searches on:</p>
<ul dir="auto">
<li>&#34;gradle install git hooks&#34;</li>
<li>&#34;maven install git hooks&#34;</li>
</ul>
<p dir="auto">This article presently has no specific recommendations on choices of plugin or
approach for Git hooks.</p>
</li>
</ul>
<hr/>
<a href="https://adoptium.net/" title="Adoptium" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/adoptium.png" alt="Adoptium" width="20%" height="auto"/>
</a>
<h2 tabindex="-1" dir="auto"><a id="user-content-the-jdk" aria-hidden="true" tabindex="-1" href="#the-jdk"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>The JDK</h2>
<p dir="auto">For any Modern Java/JVM project, the first decision is <em>which version of Java
(the JDK)</em> to use? Some guidelines:</p>
<ul dir="auto">
<li>Java 17 is the most current LTS (&#34;long-term support&#34;) version</li>
<li>There are more recent versions with continuing improvements and additional
features to try out</li>
<li>If your personal or open-source project does not require a paid support
contract, newer Java versions are a good choice</li>
<li>For a full breakdown of the current JDK landscape (as of Jul 2022), see
<a href="https://tomgregory.com/which-jdk-version-and-vendor/" rel="nofollow"><em>Which JDK Version and Vendor Should You Use on Your
Project?</em></a>, and a short
list of recommendations at <a href="https://whichjdk.com" rel="nofollow"><em>Which Version of JDK Should I
Use?</em></a></li>
</ul>
<p dir="auto">In this project, you&#39;ll see the choice of Java 17 as this is the version to
recommend in production.</p>
<p dir="auto">In general, you will find that <a href="https://adoptium.net" rel="nofollow">Adoptium</a> is a go-to
choice for the JDK.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-2" aria-hidden="true" tabindex="-1" href="#tips-2"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>In Maven, use a property to <em>fix</em> the version of Java in place. But note
naming for that property: <code>java.version</code> is defined by the JVM, and Maven
creates a matching property. Recommended is to define your Java version with
the <code>jdk.version</code> property, which has no collision with pre-defined
properties</li>
<li>In Gradle, use the <code>javaToolchains</code> task to investigate issues with
mismatching or confusing build paths, project configuration, and Gradle
sorting it out. This is an issue for local-only builds; local builds using a
container (such as via <a href="#setup-local-ci"><em>Batect</em></a>) lower these concerns</li>
<li>In GitHub Actions, building supports cross-checking multiple JVM versions,
use
<a href="https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs">the <code>matrix</code> feature</a>.
See <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/workflows/ci-batect-maven.yml">the example GitHub actions</a></li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-managing-your-java-environment" aria-hidden="true" tabindex="-1" href="#managing-your-java-environment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Managing your Java environment</h3>
<p dir="auto">Two best-of-class tools come to mind to manage your JDK environment in projects:</p>
<ul dir="auto">
<li><a href="#jenv">jEnv</a></li>
<li><a href="#direnv">Direnv</a></li>
</ul>
<p dir="auto">Both assume UNIX-type shells (Bash, Zsh, etc).</p>
<p dir="auto">For those on Windows, you may need to use Cygwin, Git for Windows, or WSL2 to
use these.</p>
<p dir="auto">(Reminder: in general, when setting up your project environment, prefer the
latest LTS version of Java, which is 17.)</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-jenv" aria-hidden="true" tabindex="-1" href="#jenv"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Jenv</h4>
<p dir="auto"><a href="https://www.jenv.be/" rel="nofollow">jEnv</a> supports both &#34;global&#34; (meaning you, the user)
and &#34;project&#34; choices of JDK (particular to a directory and its children) in
which JDK installation to use. You may notice the
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.java-version"><code>.java-version</code></a> file: this is a per-project file for jEnv to
pick your project Java version.</p>
<p dir="auto">Do use <code>jenv enable-plugins export</code> and restart your shell. This ensures
<code>JAVA_HOME</code> is exported to match your jEnv settings. Several tools use
<code>JAVA_HOME</code> rather than the <code>java</code> or <code>javac</code> found in your <code>PATH</code>.</p>
<p dir="auto">You may also find the <code>gradle</code> and <code>maven</code> plugins for jEnv useful.</p>
<p dir="auto">There are many ways to install the JDK, most are platform-dependent. In general,
your team will be better off using a &#34;managed&#34; approach, rather than with each
person using binary installers. Popular choices include:</p>
<ul dir="auto">
<li><a href="https://adoptium.net/installation.html#linux-pkg" rel="nofollow">Apt and friends</a> for Linux
or WSL</li>
<li><a href="https://brew.sh/" rel="nofollow">Homebrew</a> for Mac</li>
<li><a href="https://sdkman.io/jdks" rel="nofollow">SDKMAN</a> for multiple platforms</li>
</ul>
<h4 tabindex="-1" dir="auto"><a id="user-content-direnv" aria-hidden="true" tabindex="-1" href="#direnv"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Direnv</h4>
<p dir="auto"><a href="https://direnv.net/" rel="nofollow">direnv</a> is more general. Rather than specifying a Java
version, you edit a <code>.envrc</code> file and add JDK-specific environment settings
(and another other environment settings) just as you would on the command-line.
Typically set are <code>PATH</code> to find <code>java</code> and <code>javac</code> programs, and <code>JAVA_HOME</code>.</p>
<hr/>

<a href="https://maven.apache.org/" title="Maven" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/maven.png" alt="Maven" width="15%" height="auto"/></a>
<a href="https://gradle.org/" title="Gradle" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/gradle.png" alt="Gradle" width="15%" height="auto"/></a> 
<h2 tabindex="-1" dir="auto"><a id="user-content-use-gradle-or-maven" aria-hidden="true" tabindex="-1" href="#use-gradle-or-maven"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use Gradle or Maven</h2>
<p dir="auto">The choice between Gradle and Maven depends on your team, your broader
ecosystem, and your project needs. In summary:</p>
<ul dir="auto">
<li>
<p dir="auto">Gradle — your build script is written in Groovy or Kotlin; dynamic,
imperative, and mutable; requires debugging your build on occasion, but less
verbose than Maven&#39;s XML. Use of &#34;parent&#34; (umbrella) projects is possible but
challenging. You can locally extend your build script either <em>inline</em>
with build code, with project plugins, or with plugins from a separate
project (perhaps shared across project for your team). If interested in custom
plugins,
<a href="https://docs.gradle.org/current/userguide/custom_plugins.html" rel="nofollow">read more here</a></p>
</li>
<li>
<p dir="auto">Maven — your build scripts is written in XML; declarative and immutable;
verbose but specific; it either works or not. Use of &#34;parent&#34; (umbrella)
projects is simple with built-in support. You can locally extend your build
with plugins from a separate project (perhaps shared across project for your
team). If interested in custom plugins,
<a href="https://maven.apache.org/guides/plugin/guide-java-plugin-development.html" rel="nofollow">read more here</a></p>
</li>
</ul>
<p dir="auto">For Modern Java/JVM projects, <strong>use Gradle or Maven</strong>. The article doesn&#39;t cover
alternative build tools:
<a href="https://www.jrebel.com/blog/2020-java-technology-report#build-tool" rel="nofollow">industry data</a>
shows Gradle or Maven are the build tools for most folks. Unless you find
yourself in a complex monorepo culture (Google, <em>etc.</em>), or there are mandates
from above, you need to select one of Gradle or Maven. However, for projects not
using Gradle or Maven, you will still find improvements for your build herein
(though details will differ).</p>
<p dir="auto">For new projects, you may find <a href="https://start.spring.io" rel="nofollow">Spring Initializr</a>,
<a href="https://micronaut.io/" rel="nofollow"><code>mn</code> from Micronaut</a>, or
<a href="https://www.jhipster.tech/" rel="nofollow">JHipster</a>, among many other project excellent
starters, more to your liking: they provide you with starter Gradle or Maven
scripts specific for those frameworks. <em>That&#39;s great!</em> This article should
still help you improve your build beyond &#34;getting started&#34;. You should pick
and choose build features as makes sense to you and your circumstances.</p>
<p dir="auto">This article offers <strong>no preference between Gradle or Maven</strong>. You need to
decide with your team and circumstances. After picking your build tool, you
might rename <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/run-with-gradle.sh">run-with-gradle.sh</a> or
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/run-with-maven.sh">runs-with-maven.sh</a> to just <code>run.sh</code> or similar.</p>
<p dir="auto">Projects using Ant <strong>should migrate</strong>. It is true that Ant is well-maintained
(the latest version dates from 2021). However, you will spend much effort in
providing modern build tooling, and effort in migrating from Ant is repaid in
smaller work for integrating modern tools. Data point: consider the number of
<a href="https://stackoverflow.com/" rel="nofollow">Stackoverflow</a> posts providing Gradle or
Maven answers to those for Ant.  <em>Consider Ant builds to be no longer
well-supported, and a form of
<a href="https://www.martinfowler.com/bliki/TechnicalDebt.html" rel="nofollow">Tech Debt</a>.</em></p>
<p dir="auto">Throughout, when covering both Gradle and Maven, Gradle will be discussed first,
then Maven. This is no expressing a preference!  It is neutral alphabetical
ordering.</p>
<p dir="auto"><strong>NB</strong> — Gradle Enterprise provides additional features for Maven as
well such as <a href="https://docs.gradle.com/enterprise/maven-build-cache/" rel="nofollow">build
caching</a> and <a href="#keep-your-build-fast">build
scans</a>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-cleaning-up" aria-hidden="true" tabindex="-1" href="#cleaning-up"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Cleaning up</h3>
<p dir="auto">Once you pick between Gradle or Maven, it is a good time to clean up.
If you have cloned the project, some renames/deletions to consider:</p>
<ul dir="auto">
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/run-with-gradle.sh">run-with-gradle.sh</a> or
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/run-with-maven.sh">runs-with-maven.sh</a> → just <code>run.sh</code> or <code>build.sh</code> or
anything you like. Remember to document in <code>README.md</code> for others</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/batect.yml">batect.yml</a> — update the task names, and remove those not
relevant. Again, don&#39;t forget about <code>README.md</code> instructions</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/workflows/ci-maven.yml">ci.yml</a> — update the jobs, and remove those
not relevant. Did I mention <code>README.md</code>?</li>
</ul>
<p dir="auto">You are ready to make great software.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keeping-gradle-or-maven-up-to-date" aria-hidden="true" tabindex="-1" href="#keeping-gradle-or-maven-up-to-date"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keeping Gradle or Maven up to date</h3>
<h4 tabindex="-1" dir="auto"><a id="user-content-gradle" aria-hidden="true" tabindex="-1" href="#gradle"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Gradle</h4>
<p dir="auto">To update Gradle:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ $EDITOR gradle.properties  # Update gradleWrapperVersion property
$ ./gradlew wrapper  # Update scripts and supporting files
$ ./gradlew wrapper  # Confirm, and download files if needed"><pre>$ <span>$EDITOR</span> gradle.properties  <span><span>#</span> Update gradleWrapperVersion property</span>
$ ./gradlew wrapper  <span><span>#</span> Update scripts and supporting files</span>
$ ./gradlew wrapper  <span><span>#</span> Confirm, and download files if needed</span></pre></div>
<h4 tabindex="-1" dir="auto"><a id="user-content-maven" aria-hidden="true" tabindex="-1" href="#maven"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Maven</h4>
<p dir="auto">To update Maven:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ $EDITOR pom.xml  # Update maven.version property
$ ./mvnw wrapper:wrapper  # Update scripts and supporting files
$ ./mvnw wrapper:wra  # Confirm, and download files if needed"><pre>$ <span>$EDITOR</span> pom.xml  <span><span>#</span> Update maven.version property</span>
$ ./mvnw wrapper:wrapper  <span><span>#</span> Update scripts and supporting files</span>
$ ./mvnw wrapper:wra  <span><span>#</span> Confirm, and download files if needed</span></pre></div>
<p dir="auto">Note that Maven wrapper is developing, and will be bundled with an upcoming
Maven release.
For now it is a separate plugin in your <code>pom.xml</code>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-3" aria-hidden="true" tabindex="-1" href="#tips-3"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>Take advantage of your shell&#39;s tab completion:
<ul dir="auto">
<li><a href="https://github.com/gradle/gradle-completion">Gradle completion</a></li>
<li><a href="https://github.com/juven/maven-bash-completion">Maven completion</a></li>
</ul>
</li>
<li>The sample Gradle and Maven build scripts often specify specific versions of
the tooling, separate from the plugin versions. This is intentional. You
should be able to update the latest tool version even when the plugin has not
yet caught up</li>
<li>Gradle itself does not provide support for &#34;profiles&#34;, a key Maven feature.
This is <em>different</em> from <em>profiling</em> build performance!  Maven profiles
can be used in many ways. The most common are to enabling/disabling build
features on the command line, tailoring the build to a particular deployment
environment, or using different credentials for other systems. If this
feature is important for your team, you can code <code>if/else</code> blocks directly
in <code>build.gradle</code>, or use a plugin such as
<a href="https://kordamp.org/kordamp-gradle-plugins/#_org_kordamp_gradle_profiles" rel="nofollow">Kordamp Profiles Gradle plugin</a>
(Kordamp has a suite of interesting Gradle plugins beyond this one; read more
on that page)</li>
<li>Gradle uses advanced terminal control, so you cannot always see what is
happening. To view Gradle steps plainly when debugging your build, use:
<div dir="auto" data-snippet-clipboard-copy-content="$ ./gradlew &lt;your tasks&gt; | cat"><pre>$ ./gradlew <span>&lt;</span>your tasks<span>&gt;</span> <span>|</span> cat</pre></div>
or save the output to a file:
<div dir="auto" data-snippet-clipboard-copy-content="$ ./gradlew &lt;your tasks&gt; | tee -o some-file"><pre>$ ./gradlew <span>&lt;</span>your tasks<span>&gt;</span> <span>|</span> tee -o some-file</pre></div>
</li>
<li>If your source code is in Kotlin, so should be your build. Gradle provides
<a href="https://kotlinlang.org/docs/reference/using-gradle.html" rel="nofollow">a Kotlin DSL for build scripts</a>
as a first-class counterpart to the traditional Groovy DSL</li>
<li>Maven colorizes output, but does not use terminal control to overwrite output</li>
<li>See <a href="#setup-your-ci">Setup your CI</a> for another approach to getting plain text
console output</li>
<li><a href="https://github.com/jcgay/maven-notifier">The Maven Notifier</a> may be to your
liking</li>
<li>If you like Maven, but XML isn&#39;t your thing, you might explore the
<a href="https://github.com/takari/polyglot-maven"><em>Polyglot for Maven</em></a> extension
which provides the POM in multiple languages/formats (<em>eg</em>, Ruby, YAML, many
others)</li>
<li>If you have a multi-module Maven build, you might consider
<a href="http://takari.io/book/30-team-maven.html#takari-smart-builder" rel="nofollow"><em>Takari Smart
Builder</em></a>
to speed it up</li>
<li>Maven best practice is to specify the version for each plugin, <em>even default
plugins</em> that come with your version of Maven. This enforces
<strong>reproducible builds</strong>. See also the
<a href="https://maven.apache.org/enforcer/maven-enforcer-plugin/" rel="nofollow">Maven Enforcer Plugin</a>
to exactly specify the version of Maven for your build</li>
</ul>
<hr/>
<p dir="auto"><a href="http://www.ambysoft.com/essays/whyAgileWorksFeedback.html" title="Why Agile Software Development Techniques Work: Improved Feedback" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/bug-costs.jpg" alt="Length of Feedback Cycle" width="20%" height="auto"/>
</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-setup-your-ci" aria-hidden="true" tabindex="-1" href="#setup-your-ci"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Setup your CI</h2>
<p dir="auto">Your CI is your &#34;source of truth&#34; for successful builds. Your goal:
<em>Everyone trusts a &#34;green&#34; CI build is solid</em>.</p>
<p dir="auto">When using GitHub, a simple starting point is
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/workflows/ci-gradle.yml"><code>ci-gradle.yml</code></a> or
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/workflows/ci-maven.yml"><code>ci-maven.yml</code></a>.
(GitLab is similar, but as this project is hosted in GitHub, there is not a
simple means to demonstrate CI at GitLab).
This project includes a workflow for Gradle and a workflow for Maven as
examples.</p>
<p dir="auto">If you use GitLab, read about the equivalent in
<a href="https://docs.gitlab.com/ee/ci/" rel="nofollow"><em>GitLab CI/CD</em></a>, or for Jenkins in
<a href="https://www.jenkins.io/doc/book/pipeline/" rel="nofollow"><em>Pipeline</em></a>.</p>
<p dir="auto">When publishing your project, consider
<a href="https://docs.github.com/en/actions/guides/publishing-java-packages-with-maven"><em>Publishing Java packages with
Maven</em></a>
for GitHub, or equivalent for other CI systems.  <strong>Do not publish from local
builds.</strong>  For GitHub, note the limitations of
<a href="https://github.community/t/download-from-github-package-registry-without-authentication/14407" rel="nofollow"><em>Download from Github Package Registry without
authentication</em>.</a></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-save-your-ci-artifacts" aria-hidden="true" tabindex="-1" href="#save-your-ci-artifacts"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Save your CI artifacts</h3>
<p dir="auto">It is helpful to preserve your build artifacts from CI, for example, to
download built jars from different CI runs for comparing their behavior
between commits without needing to rebuild locally, and also to confirm that
your local build makes the same jars as CI does.</p>
<p dir="auto">The &#34;Build with Gradle&#34; and &#34;Build with Maven&#34; CI workflows each provide a
download named &#34;jars&#34;, and the Maven build a &#34;site&#34; download.</p>
<p dir="auto">There are services to provide links to the most recent build artifacts.
One example is <a href="https://nightly.link/" rel="nofollow">nightly.link</a> (this is not an
endorsement).
You can use these links in your <code>README.md</code> or share as makes sense.
An example is
<a href="https://nightly.link/binkley/modern-java-practices/workflows/ci-maven/master/jars.zip" rel="nofollow">downloading the Maven-built jar</a>
from this project.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-4" aria-hidden="true" tabindex="-1" href="#tips-4"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>To disable ASCII colorizing printing as control sequences in CI, or
Gradle trying to overwrite lines (control sequences make for hard-to-read
CI logs), a simple approach is to use an environment setting:
<div dir="auto" data-snippet-clipboard-copy-content="TERM=dumb"><pre>TERM=dumb</pre></div>
This does not make sense for local builds, and your CI system (<em>eg</em>, GitHub)
may manage this problem already</li>
<li>With Gradle, use the <code>--warning-mode=all</code> flag for CI: this shows <em>all</em>
warnings Gradle generates, not just a summary. See
<a href="https://docs.gradle.org/current/userguide/command_line_interface.html#sec:command_line_warnings" rel="nofollow"><em>Showing or hiding
warnings</em></a>
for details</li>
<li>With Maven, use the <code>--no-transfer-progress</code> flag for CI: this avoids spamming
CI logs with download progress messages</li>
<li>For GitHub Actions, you may find a tool like
<a href="https://github.com/nektos/act"><code>act</code></a> useful for running CI actions locally
(it may not work for all projects, however, depending on your actions)</li>
</ul>
<hr/>
<p dir="auto"><a href="https://github.com/binkley/html/blob/master/blog/on-pipelines.html" title="On Pipelines">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/pipeline.png" alt="Production vs Dev pipeline" width="20%" height="auto"/>
</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-keep-local-consistent-with-ci" aria-hidden="true" tabindex="-1" href="#keep-local-consistent-with-ci"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep local consistent with CI</h2>
<p dir="auto">What is &#34;local CI&#34;?
That sounds like a contradition.
Tooling helps you reproduce locally the same build that CI uses, so that you
suffer less from version drift and other type problems, and minimize
related environment issues.
A common example is building on different JVM/JDK versions.
Ideally, excepting truly environment-specific, your local build should fail
when CI would also fail so that you can catch problems earlier in your
development process before commits are shared.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-setup-local-ci" aria-hidden="true" tabindex="-1" href="#setup-local-ci"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Setup local CI</h3>
<p dir="auto">Reflecting the principle that local builds should be like CI builds, some
tools that greatly help:</p>
<ul dir="auto">
<li>
<p dir="auto"><a href="https://batect.dev/" rel="nofollow">Batect</a> is a solid tool from Charles Korn.
It runs your build in a &#34;CI-like&#34; local environment via Docker.
This is one of your first lines of defence against &#34;it runs on my box&#34;.
(<a href="https://batect.dev/Comparison.html" rel="nofollow">Compare Batect</a> with other tools in this
space)</p>
</li>
<li>
<p dir="auto"><a href="https://earthly.dev/" rel="nofollow">Earthly</a> shares philosophy with Batect and with a
different approach to implementation.
<strong>Feedback on Earthly</strong> is
<a href="https://github.com/binkley/modern-java-practices/issues/new/choose">appreciated</a>.
<em>Earthly is experimental</em> for the template project in this repository</p>
</li>
</ul>
<p dir="auto">They are <em>both good choices</em>, but not the only ones.</p>
<p dir="auto"><em>This is an important step</em>!
It is closer to your CI builds locally.
You should strive to keep local as faithful as possible to CI and Production.</p>
<p dir="auto">You may decide not to use CI-like tooling for local builds. However, consider
that use of them raises your confidence that CI will succeed. Local CI-like
tooling is part of the theme of <em>shifting left</em> for problems.</p>
<p dir="auto">See <a href="https://batect.dev/tools/GitHubActions.html" rel="nofollow"><em>Working with CI systems</em></a>
for documentation on using Batect from within a dockerized CI environment.</p>
<p dir="auto"><strong>NB</strong> — to be as consistent as possible, the sample
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/workflows/ci-maven.yml"><code>ci.yml</code> for GitHub</a> uses Batect for the
Gradle and Maven builds, and <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/batect.yml"><code>batect.yml</code> for Batect</a> pulls
an image for <a href="https://hub.docker.com/_/adoptopenjdk" rel="nofollow">AdoptOpenJDK</a>.
So <code>ci.yml</code> does not <a href="https://github.com/actions/setup-java">setup JDK 17</a>
directly, but relies on Batect.</p>
<p dir="auto">Configure your local CI in <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/batect.yml"><code>batect.yml</code></a> or in
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/Earthfile"><code>Earthfile</code></a> with suitable tasks.
For this project, there are example tasks/targets:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ./batect -T
Available tasks:
- build-with-gradle: Build and test with Gradle
- build-with-maven: Build and test with Maven

$ earthly ls
+base
+build-with-gradle
+build-with-maven"><pre>$ ./batect -T
Available tasks:
- build-with-gradle: Build and <span>test</span> with Gradle
- build-with-maven: Build and <span>test</span> with Maven

$ earthly ls
+base
+build-with-gradle
+build-with-maven</pre></div>
<h4 tabindex="-1" dir="auto"><a id="user-content-gradle-1" aria-hidden="true" tabindex="-1" href="#gradle-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Gradle</h4>
<p dir="auto">It is helpful that your <code>batect.yml</code> calls Gradle with the <code>--no-daemon</code> flag:</p>
<ul dir="auto">
<li>There is no point in spinning up a daemon for a Docker ephemeral container;
but it is harmless either way</li>
<li>With a daemon, the Docker container&#39;s Gradle may be confused by
<code>~/.gradle/daemon</code> and <code>/.gradle/workers</code> directories mounted by Batect from
your home directory, as these refer to processes in the host, not the
container (<code>batect.yml</code> mounts your <code>~/.gradle</code> to include caches of
already-downloaded dependencies, <em>et al</em>)</li>
<li>If you encounter troubles, run locally <code>./gradlew --stop</code> to kill any local
daemons: This indicates a <em>bug</em>, and &#34;stop&#34; is a workaround.
See <a href="https://github.com/batect/batect/issues/680#issuecomment-719821099" data-hovercard-type="issue" data-hovercard-url="/batect/batect/issues/680/hovercard">a suggestion of a better approach</a></li>
</ul>
<h4 tabindex="-1" dir="auto"><a id="user-content-earthly" aria-hidden="true" tabindex="-1" href="#earthly"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Earthly</h4>
<p dir="auto">Earthly has its own caching strategies that apply to your build (such as
Gradle or Maven dependency downloads) based around Docker layers. See
<a href="https://docs.earthly.dev/docs/guides/advanced-local-caching" rel="nofollow"><em>Advanced local
caching</em></a> for more information.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-5" aria-hidden="true" tabindex="-1" href="#tips-5"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>
<p dir="auto">If you encounter issues with Gradle and Batect, try stopping the local Gradle
daemons before running Batect:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ./gradlew --stop
$ ./batect &lt;your Batect arguments&gt;"><pre>$ ./gradlew --stop
$ ./batect <span>&lt;</span>your Batect arguments<span>&gt;</span></pre></div>
</li>
<li>
<p dir="auto">The Batect builds <em>assume</em> you&#39;ve run local builds first. Plesae run
<code>./gradlew build</code> or <code>./mvnw verify</code> at least once before running
<code>./batect ...</code> to ensure cached/shared downloads are present</p>
</li>
<li>
<p dir="auto">In CI, use the <code>--permanently-enable-telemetry</code> flag to avoid CI asking a
&#34;Y/N&#34; question. This <strong>must</strong> be <em>separate step</em> from running the build
itself. See <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/workflows/ci-maven.yml"><code>ci.yml</code></a> for Gradle and Maven examples</p>
</li>
<li>
<p dir="auto">Run your local Gradle or Maven build before you run with Batect if you have
updated dependencies.  This is helpful when fetching the dependencies, and
sometimes avoids awkwardness (sometimes you may have different access rights
for the build tool caches when run as yourself directly <em>vs</em> running in a
container)</p>
</li>
</ul>
<hr/>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/maintain-build.jpg"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/maintain-build.jpg" alt="Maintain build" width="20%" height="auto"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-maintain-your-build" aria-hidden="true" tabindex="-1" href="#maintain-your-build"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Maintain your build</h2>
<p dir="auto">Treat your build as you would your codebase: Maintain it, refactor as needed,
run performance testing, <em>et al</em>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-know-what-your-build-does" aria-hidden="true" tabindex="-1" href="#know-what-your-build-does"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Know what your build does</h3>
<p dir="auto">What does your build do exactly, and in what order? You can ask Gradle or Maven
to find out:</p>
<ul dir="auto">
<li><a href="https://github.com/dorongold/gradle-task-tree">Gradle Task Tree plugin</a>
with <code>./gradlew some...tasks taskTree</code></li>
<li><a href="https://buildplan.jcgay.fr/" rel="nofollow">Maven Buildplan plugin</a>
with <code>./mvnw buildplan:list</code> (see plugin documentation for other goals and
output format)</li>
</ul>
<p dir="auto">Each of these have many options and features, and are worth exploring.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keep-your-build-clean" aria-hidden="true" tabindex="-1" href="#keep-your-build-clean"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep your build clean</h3>
<p dir="auto">Let tools tell you when you have dodgy dependencies, or an inconsistent setup.
For example, leverage <code>jdeps</code> which
<a href="https://docs.oracle.com/en/java/javase/17/docs/specs/man/jdeps.html" rel="nofollow">comes with the JDK</a>.
Jdeps spots, for example, if you have a multi-version jar as a dependency that
does not include <em>your</em> JDK version (an example of this may be is JUnit), or if
your code depends on <em>internal</em> (non-public) classes of the JDK
(important especially when using the JDK module system).</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-gradle-2" aria-hidden="true" tabindex="-1" href="#gradle-2"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Gradle</h4>
<p dir="auto">The <a href="https://github.com/kordamp/jdeps-gradle-plugin">Kordamp plugin</a> used for
Gradle does not fail the build when jdeps errors, and only generates a report
text file. See
<a href="https://github.com/kordamp/jdeps-gradle-plugin/issues/16" data-hovercard-type="issue" data-hovercard-url="/kordamp/jdeps-gradle-plugin/issues/16/hovercard">this issue</a>.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-maven-1" aria-hidden="true" tabindex="-1" href="#maven-1"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Maven</h4>
<p dir="auto">Try Maven with <code>dependency:tree -Dverbose</code>.
This will show conflicting versions of dependencies.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keep-local-builds-quiet" aria-hidden="true" tabindex="-1" href="#keep-local-builds-quiet"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep local builds quiet</h3>
<p dir="auto">It is frustrating for local devs when something horrible happened during the
build (say a production with &#34;ERROR&#34; output during a test), but:</p>
<ol dir="auto">
<li>The build is <strong>GREEN</strong>, and developers should trust that</li>
<li>There is too much output in the local build, so developers don&#39;t spot
telltale signs of trouble</li>
</ol>
<p dir="auto">There are many approaches to this problem. This project uses JDK logging as <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.logging/java/util/logging/FileHandler.html" rel="nofollow">an
example</a>,
and keeps the build quiet in
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/config/logging.properties"><code>config/logging.properties</code></a>.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keep-ci-builds-noisy" aria-hidden="true" tabindex="-1" href="#keep-ci-builds-noisy"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep CI builds noisy</h3>
<p dir="auto">In CI, this is different, and there you want as much output as possible to
diagnose the unexpected.</p>

<h3 tabindex="-1" dir="auto"><a id="user-content-keep-your-build-current" aria-hidden="true" tabindex="-1" href="#keep-your-build-current"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep your build current</h3>
<p dir="auto">An important part of <em>build hygiene</em> is keeping your build system, plugins, and
dependencies up to date. This might be simply to address bug fixes
(including bugs you weren&#39;t aware of), or might be critical security fixes. The
best policy is: <em>Stay current</em>. Others will have found—reported
problems—, and 3<sup>rd</sup>-parties may have addressed them. Leverage
the power of <a href="https://en.wikipedia.org/wiki/Linus%27s_law" rel="nofollow"><em>Linus&#39; Law</em></a> (&#34;given
enough eyeballs, all bugs are shallow&#34;).</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keep-plugins-and-dependencies-up-to-date" aria-hidden="true" tabindex="-1" href="#keep-plugins-and-dependencies-up-to-date"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep plugins and dependencies up-to-date</h3>
<ul dir="auto">
<li><a href="https://github.com/ben-manes/gradle-versions-plugin">Gradle</a>
Benjamin Manes is kind enough in his plugin project to list alternatives.
If you are moving towards <a href="https://docs.gradle.org/current/userguide/platforms.html" rel="nofollow">Gradle version
catalogs</a>, you might
consider
<a href="https://jmfayard.github.io/refreshVersions/" rel="nofollow">refreshVersions</a></li>
<li><a href="https://www.mojohaus.org/versions-maven-plugin/" rel="nofollow">Maven</a></li>
<li>Team agreement on release updates only, or if non-release plugins and
dependencies make sense for your situation</li>
<li>Each of these plugins for Gradle or Maven have their quirks.  <strong>Do not treat
them as sources of truth but as recommendations</strong>. <em>Use your judgment</em>. In
parallel, take advantage of CI tooling such as
<a href="https://github.com/dependabot">Dependabot (Github)</a> or
<a href="https://gitlab.com/dependabot-gitlab/dependabot" rel="nofollow">Dependabot (GitLab)</a></li>
</ul>
<p dir="auto">An example use which shows most outdated plugins and dependencies (note that one
Maven example modifies your <code>pom.xml</code>, a fact you can choose or avoid):</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ./gradlew dependencyUpdates
# output ommitted
$ ./mvnw versions:update-properties  # Updates pom.xml in place
$ ./mvnw versions:display-property-updates  # Just lists proposed updates
# output ommitted"><pre>$ ./gradlew dependencyUpdates
<span><span>#</span> output ommitted</span>
$ ./mvnw versions:update-properties  <span><span>#</span> Updates pom.xml in place</span>
$ ./mvnw versions:display-property-updates  <span><span>#</span> Just lists proposed updates</span>
<span><span>#</span> output ommitted</span></pre></div>
<p dir="auto">This project keeps Gradle version numbers in
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/gradle.properties"><code>gradle.properties</code></a>, and for Maven in
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/pom.xml">the POM</a>, and you should do the same.</p>
<p dir="auto">Since your <code>pom.xml</code> is in Git, <code>versions:update-properties</code> is <em>safe</em> as you
can always revert changes, but some folks want to look before doing.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-tips-6" aria-hidden="true" tabindex="-1" href="#tips-6"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h4>
<ul dir="auto">
<li>Gradle and Maven provide <em>default versions</em> of bundled plugins. In both built
tools, the version update plugins need you to be <em>explicit</em> in stating
versions for bundled plugins, so those versions are visible for update</li>
<li>Enable <em>HTML reports</em> for local use; enable <em>XML reports</em> for CI use in
integrating with report tooling</li>
<li>To open the report for Jdeps, build locally and use the
<code>&lt;project root&gt;/build/reports/jdeps/</code> (Gradle) path.
The path shown in a Docker build is relative to the interior of the container</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-automated-dependency-upgrade-prs" aria-hidden="true" tabindex="-1" href="#automated-dependency-upgrade-prs"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Automated dependency upgrade PRs</h3>
<p dir="auto"><em>NB</em> —
<a href="https://github.blog/2020-06-01-keep-all-your-packages-up-to-date-with-dependabot/" rel="nofollow">Dependabot</a>
may prove speedier for you than updating dependency versions locally, and runs
in CI (GitHub) on a schedule you pick. It submits PRs to your repository when it
finds out of date dependencies. See
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.github/dependabot.yml"><code>dependabot.yml</code></a> for an example using a daily
schedule.</p>
<p dir="auto">A similar choice is <a href="https://github.com/renovatebot/renovate">Renovate</a>.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-more-on-gradle-version-numbers" aria-hidden="true" tabindex="-1" href="#more-on-gradle-version-numbers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>More on Gradle version numbers</h4>
<p dir="auto">Your simplest approach to Gradle is to keep everything in <code>build.gradle</code>. Even
this unfortunately still requires a <code>settings.gradle</code> to define a project
artifact name, and leaves duplicate version numbers for related dependencies
scattered through <code>build.gradle</code>.</p>
<p dir="auto">Another approach is to rely on a Gradle plugin such as that from Spring Boot to
manage dependencies for you. This unfortunately does not help with plugins at
all, nor with dependencies that Spring Boot does not know about.</p>
<p dir="auto">This project uses a 3-file solution for Gradle versioning, and you should
consider doing the same:</p>
<ul dir="auto">
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/gradle.properties"><code>gradle.properties</code></a> is the sole source of truth for
version numbers, both plugins and dependencies</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/settings.gradle"><code>settings.gradle</code></a> configures plugin versions using the
properties</li>
<li><a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/build.gradle"><code>build.gradle</code></a> uses plugins without needing version numbers,
and dependencies refer to their property versions</li>
</ul>
<p dir="auto">The benefits of this approach grow for Gradle multi-project projects, where you
may have plugin and dependency versions scattered across each <code>build.gradle</code>
file for you project and subprojects.</p>
<p dir="auto">So to adjust a version, edit <code>gradle.properties</code>. To see this approach in action
for dependencies, try:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ grep junitVersion gradle.properties setttings.gradle build.gradle
gradle.properties:junitVersion=5.7.0
build.gradle:    testImplementation &#34;org.junit.jupiter:junit-jupiter:$junitVersion&#34;
build.gradle:    testImplementation &#34;org.junit.jupiter:junit-jupiter-params:$junitVersion&#34;"><pre>$ grep junitVersion gradle.properties setttings.gradle build.gradle
gradle.properties:junitVersion=5.7.0
build.gradle:    testImplementation <span><span>&#34;</span>org.junit.jupiter:junit-jupiter:<span>$junitVersion</span><span>&#34;</span></span>
build.gradle:    testImplementation <span><span>&#34;</span>org.junit.jupiter:junit-jupiter-params:<span>$junitVersion</span><span>&#34;</span></span></pre></div>
<h4 tabindex="-1" dir="auto"><a id="user-content-note-on-toolversion-property" aria-hidden="true" tabindex="-1" href="#note-on-toolversion-property"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Note on <code>toolVersion</code> property</h4>
<p dir="auto">If you use the <code>toolVersion</code> property for a plugin to update the called tool
separately from the plugin itself, <em>this is a convention</em>, not something the
Gradle API provides to plugins. As a consequence, the Versions plugin is unable
to know if your tool version is out of date. An example is the JaCoCo plugin
distributed with Gradle.</p>
<p dir="auto">Two options:</p>
<ul dir="auto">
<li>Do not use the <code>toolVersion</code> property unless needed to address a discovered
build issue, and remove it once the plugin catches up to provide the tool
version you need</li>
<li>Continue using the <code>toolVersion</code> property, and as part of running
<code>./gradlew dependencyUpdates</code>, manually check all <code>toolVersion</code>
properties, and update <code>gradle.properties</code> as accordingly</li>
</ul>
<p dir="auto"><strong>NB</strong> — Maven handles this differently, and does not have this concern.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keep-your-build-fast" aria-hidden="true" tabindex="-1" href="#keep-your-build-fast"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep your build fast</h3>
<p dir="auto">A fast local build is one of the best things you can do for your team. There are
variants of profiling your build for Gradle and Maven:</p>
<ul dir="auto">
<li><a href="https://scans.gradle.com/" rel="nofollow">Gradle build scan</a> with the <code>--scan</code> flag</li>
<li><a href="https://github.com/jcgay/maven-profiler">Maven profiler extension</a> with
the <code>-Dprofile</code> flag</li>
</ul>
<p dir="auto">See <a href="https://scans.gradle.com/s/fik7c7bq25l3w" rel="nofollow">an example build scan</a> from May
1, 2023.</p>
<p dir="auto"><strong>NB</strong> — <a href="https://scans.gradle.com/#maven" rel="nofollow">Build Scan</a> supports Maven as
well when using the paid enterprise version.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-keep-your-developers-fast" aria-hidden="true" tabindex="-1" href="#keep-your-developers-fast"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Keep your developers fast</h3>
<p dir="auto">Some shortcuts to speed up the red-green-refactor cycle:</p>
<ul dir="auto">
<li>Just validate code coverage; do not run other parts of the build:
<ul dir="auto">
<li>Gradle: <code>./gradlew clean jacocoTestReport jacocoTestCoverageVerification</code></li>
<li>Maven: <code>./mvnw clean test jacoco:report jacoco:check</code></li>
</ul>
</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-7" aria-hidden="true" tabindex="-1" href="#tips-7"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>Both <a href="#dependency-check"><em>dependency vulnerability checks</em></a> and
<a href="#use-mutation-testing"><em>mutation testing</em></a>
can take a while, depending on your project. If you find they slow your team
local build too much, these are good candidates for moving to
<a href="#setup-your-ci">CI-only steps</a>, such as a <code>-PCI</code> flag for Maven (see &#34;Tips&#34;
section of <a href="#use-gradle-or-maven">Use Gradle or Maven</a> for Gradle for an
equivalent). This project keeps them as part of the local build, as the
demonstration code is short</li>
<li>See the bottom of <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/build.gradle"><code>build.gradle</code></a> for an example of
customizing &#34;new&#34; versions reported by the Gradle <code>dependencyUpdates</code> task</li>
<li>The equivalent Maven approach for controlling the definition of &#34;new&#34; is to
use <a href="https://www.mojohaus.org/versions-maven-plugin/version-rules.html" rel="nofollow"><em>Version number
rules</em></a></li>
<li>With the Gradle plugin, you can program your build to fail if dependencies are
outdated. Read at
<a href="https://github.com/ben-manes/gradle-versions-plugin/issues/431#issuecomment-703286879" data-hovercard-type="issue" data-hovercard-url="/ben-manes/gradle-versions-plugin/issues/431/hovercard"><em>Configuration option to fail build if stuff is out of
date</em></a>
for details</li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-choose-your-code-style" aria-hidden="true" tabindex="-1" href="#choose-your-code-style"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Choose your code style</h2>
<p dir="auto">Style is an often overlooked but very critical attribute of writing. The style
of writing directly impacts the readability and understandability of the end
product</p>
<p dir="auto">There are 2 main java code styles</p>
<ul dir="auto">
<li><a href="https://www.oracle.com/technetwork/java/codeconventions-150003.pdf" rel="nofollow">Sun code style</a></li>
<li><a href="https://google.github.io/styleguide/javaguide.html" rel="nofollow">Google code style</a></li>
</ul>
<p dir="auto">It is up to you which one you should choose. But the style should be chosen and
the style should be the same for everyone.</p>
<p dir="auto">To maintain the same standard <code>config/ide/eclipse-java-google-style.xml</code>
or <code>intellij-java-google-style.xml</code> should be imported to your IDE. Checkstyle
should be configured based on the chosen standard</p>
<hr/>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/coffee-grinder.png"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/coffee-grinder.png" alt="Coffee grinder" width="20%" height="auto"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-generate-code" aria-hidden="true" tabindex="-1" href="#generate-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Generate code</h2>
<p dir="auto">When sensible, prefer to generate rather than write code. Here&#39;s why:</p>
<ul dir="auto">
<li><a href="http://threevirtues.com/" rel="nofollow">Intelligent laziness is a virtue</a></li>
<li>Tools always work, unless they have bugs, and you can fix bugs. Programmers
make typos, and fixing typos is a challenge when not obvious. Worse are <a href="https://en.wiktionary.org/wiki/thinko" rel="nofollow">_
thinkos_</a>; code generation does not &#34;
think&#34;, so is immune to this problem</li>
<li>Generated code does not need code review, only the source input for generation
needs review, and this is usually shorter and easier to understand. Only your
hand-written code needs review</li>
<li>Generated code is usually ignored by tooling such as linting or code
coverage (and there are simple workarounds when this is not the case). Your
hand-written code needs tooling to shift problems left</li>
</ul>
<p dir="auto">Note that many features for which in Java one would use code generation
(<em>eg</em>, Lombok&#39;s <a href="https://projectlombok.org/features/GetterSetter" rel="nofollow"><code>@Getter</code></a>
or <a href="https://www.projectlombok.org/features/ToString" rel="nofollow"><code>@ToString</code></a>), can be
built-in language features in other languages such as Kotlin or Scala (<em>eg</em>,
<a href="https://kotlinlang.org/docs/reference/properties.html" rel="nofollow">properties</a>
or <a href="https://kotlinlang.org/docs/reference/data-classes.html" rel="nofollow">data classes</a>).</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-lombok" aria-hidden="true" tabindex="-1" href="#lombok"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Lombok</h3>
<p dir="auto"><a href="https://projectlombok.org/" rel="nofollow">Lombok</a> is by far the most popular tool in Java for
code generation.
Lombok is an <em>annotation processor</em>, that is, a library (jar) which
cooperates with the Java compiler.
(<a href="https://blog.frankel.ch/introductory-guide-annotation-processor/#handling-annotations-at-compile-time-annotation-processors" rel="nofollow"><em>An introductory guide to annotations and annotation
processors</em></a>
is a good article if you&#39;d like to read more on how annotation processing
works.)</p>
<p dir="auto">Lombok covers many common use cases, does not have runtime dependencies, there
are plugins for popular IDEs that understand Lombok&#39;s code generation, and has
tooling integration for JaCoCo&#39;s output code coverage (see
<a href="#leverage-lombok-to-tweak-code-coverage">below</a>).</p>
<p dir="auto">Do note though, Lombok is not a panacea, and has detractors.
For example, to generate code as an annotation processor, it in places relies on
internal JDK APIs, though the situation has improved as the JDK exposes those
APIs in portable ways.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-leverage-lombok-to-tweak-code-coverage" aria-hidden="true" tabindex="-1" href="#leverage-lombok-to-tweak-code-coverage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Leverage Lombok to tweak code coverage</h4>
<p dir="auto">Be sparing in disabling code coverage!
JaCoCo knows about Lombok&#39;s
<a href="https://projectlombok.org/api/lombok/Generated.html" rel="nofollow"><code>@Generated</code></a>, and will
ignore annotated code.</p>
<p dir="auto">A typical use is for the <code>main()</code> method in a framework such as Spring Boot
or <a href="https://micronaut.io/" rel="nofollow">Micronaut</a>.
For a <em>command-line program</em>, you will want to test your <code>main()</code>.</p>
<p dir="auto">Do note that Lombok reflects on internal features of the JDK.
If you have issues, for <em>Maven</em>: use in your project the
<code>--add-opens java.base/java.lang=ALL-UNNAMED</code>
example from <code>.mvn/jvm.config</code>, and look to address these.
The solutions in the project are a &#34;workaround&#34; assuming Java 17.
This is a two-edged sword: as the JVM improves access controls, you may find,
especially dependencies, that there are times you want deep reflection.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-lombok-configuration" aria-hidden="true" tabindex="-1" href="#lombok-configuration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Lombok configuration</h4>
<p dir="auto"><a href="https://projectlombok.org/features/configuration" rel="nofollow">Configure Lombok</a> in
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/src/lombok.config"><code>src/lombok.config</code></a> rather than the project root or a
separate <code>config</code> directory.
At a minimum:</p>
<div dir="auto" data-snippet-clipboard-copy-content="config.stopBubbling=true
lombok.addLombokGeneratedAnnotation=true
lombok.anyConstructor.addConstructorProperties=true
lombok.extern.findbugs.addSuppressFBWarnings=true"><pre><span>config.stopBubbling</span>=true
<span>lombok.addLombokGeneratedAnnotation</span>=true
<span>lombok.anyConstructor.addConstructorProperties</span>=true
<span>lombok.extern.findbugs.addSuppressFBWarnings</span>=true</pre></div>
<p dir="auto">Lines:</p>
<ol dir="auto">
<li><code>stopBubbling</code> tells Lombok that there are no more configuration files higher
in the directory tree</li>
<li><code>addLombokGeneratedAnnotation</code> helps JaCoCo ignore code generated by Lombok</li>
<li><code>addConstructorProperties</code> helps JSON/XML frameworks such as Jackson
(this may not be relevant for your project, but is generally harmless, so the
benefit comes for free)</li>
<li><code>addSuppressFBWarnings</code> helps SpotBugs ignore code generated by Lombok</li>
</ol>
<h3 tabindex="-1" dir="auto"><a id="user-content-more-examples" aria-hidden="true" tabindex="-1" href="#more-examples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>More examples</h3>
<ul dir="auto">
<li>Automating <code>Dockerfile</code> — <a href="https://spring.io/blog/2021/01/04/ymnnalft-easy-docker-image-creation-with-the-spring-boot-maven-plugin-and-buildpacks" rel="nofollow"><em>YMNNALFT: Easy Docker Image Creation with
the Spring Boot Maven Plugin and
Buildpacks</em></a>
(<strong>NB</strong> — you do not need to have a Spring Boot project to use the
plugin: just <a href="https://docs.spring.io/spring-boot/docs/2.4.1/maven-plugin/reference/htmlsingle/#build-image" rel="nofollow">treat the plugin as a &#34;regular&#34;
one</a>)</li>
</ul>
<hr/>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/gear.png"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/gear.png" alt="Gear" width="20%" height="auto"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-leverage-the-compiler" aria-hidden="true" tabindex="-1" href="#leverage-the-compiler"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Leverage the compiler</h2>
<p dir="auto">Compilers targeting the JVM generally provide warning flags for dodgy code, and
a flag to turn warnings into errors: Use them.
The compiler is your first line of defense against code issues.</p>
<p dir="auto">For example, add these flags with <code>javac</code>:</p>
<ul dir="auto">
<li><code>-Werror</code> -- turn warnings into errors, and fails the build</li>
<li><code>-Xlint:all,-processing</code> -- enable all warnings excluding annotation
processing</li>
</ul>
<p dir="auto">Be judicious in disabling compiler warnings: they usually warn you for good
reasons.
For <code>javac</code>, disabled warnings might include <code>serial</code> or <code>deprecation</code>.</p>
<p dir="auto">JVM compilers support <code>-Werror</code> (<em>eg</em>, <code>javac</code>, <code>kotlinc</code>, <code>scalac</code>, <em>et al</em>);
enabling/disabling specific warnings may be compiler-specific.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-8" aria-hidden="true" tabindex="-1" href="#tips-8"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>Consider using <a href="https://errorprone.info/" rel="nofollow"><em>Error Prone</em></a>.
<em>Error Prone</em> is an excellent compiler plugin to fail problems earlier: fail
at compile-time rather than a runtime, however it can be overly strict</li>
<li>Lombok annotation processing fails <code>-Xlint:all</code>.
Use <code>-Xlint:all,-processing</code> to bypass warnings about annotation processing.
In addition, using Lombok&#39;s configuration to add suppression annotations on
generated code (so other tools will ignore generated code) needs the older
Spotbugs annotations provided as a dependency</li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-use-linting" aria-hidden="true" tabindex="-1" href="#use-linting"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use linting</h2>
<p dir="auto">&#34;Linting&#34; is static code analysis with an eye towards style and dodgy code
constructs. The term
<a href="https://en.wikipedia.org/wiki/Lint_(software)" rel="nofollow">derives from early UNIX</a>.</p>
<p dir="auto">Linting for modern languages is simple: the compiler complains on your behalf.
This is the case, for example, Golang. Having common team agreements on style
and formatting is a boon for avoiding
<a href="https://en.wikipedia.org/wiki/Law_of_triviality" rel="nofollow">bikeshedding</a>, and aids in:</p>
<ul dir="auto">
<li>Reading a code base, relying on a similar style throughout</li>
<li>Code reviews, focusing on substantive over superficial changes</li>
<li>Merging code, avoiding trivial or irrelevant conflicts</li>
</ul>
<p dir="auto">Code style and formatting are <em>entirely</em> a matter of team discussion and
agreement.
In Java, there is no recommended style, and <code>javac</code> is good at parsing almost
anything thrown at it.
However, humans reading code are not as well-equipped.</p>
<p dir="auto"><strong>Pick a team style, stick to it, and <em>enforce</em> it with tooling.</strong></p>
<p dir="auto">See the section <a href="#checkstyle"><em>Checkstyle</em></a> for more details on enforcement.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-9" aria-hidden="true" tabindex="-1" href="#tips-9"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>If you use Google Java coding conventions, consider
<a href="https://github.com/diffplug/spotless">Spotless</a> which can autoformat your
code</li>
<li>Consider use of <a href="https://editorconfig.org/" rel="nofollow">EditorConfig</a> for teams in which
editor choice is up to each developer. EditorConfig is a cross-IDE standard
means of specifying code formatting, respected by
<a href="https://www.jetbrains.com/help/idea/configuring-code-style.html#editorconfig" rel="nofollow">IntelliJ</a>,
and other major editors</li>
<li>To open the report for Checkstyle, build locally and use the
<code>&lt;project root&gt;/build/reports/checkstyle/</code> path.
The path shown in a Docker build is relative to the interior of the container</li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-use-static-code-analysis" aria-hidden="true" tabindex="-1" href="#use-static-code-analysis"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use static code analysis</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-checkstyle" aria-hidden="true" tabindex="-1" href="#checkstyle"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Checkstyle</h3>
<p dir="auto">With Java, one needs to rely on external tooling for linting. The most popular
choice is:</p>
<ul dir="auto">
<li><a href="https://checkstyle.sourceforge.io/" rel="nofollow">CheckStyle</a>
<ul dir="auto">
<li><a href="https://docs.gradle.org/current/userguide/checkstyle_plugin.html" rel="nofollow">Gradle plugin</a></li>
<li><a href="https://maven.apache.org/plugins/maven-checkstyle-plugin/index.html" rel="nofollow">Maven plugin</a></li>
</ul>
</li>
</ul>
<p dir="auto">However, Checkstyle will not auto-format code for you. For auto-formatting,
consider, depending on your team preferences, any of these build plugins:</p>
<ul dir="auto">
<li><a href="https://github.com/diffplug/spotless">Spotless</a> — Focus on Google style
guides for Java. For Gradle, use the <code>spotlessApply</code> task to reformat; for
Maven use the <code>spotless:apply</code> goal to reformat. It supports <em>many</em>
source languages, not just Java</li>
<li><a href="https://github.com/openrewrite/rewrite">Rewrite</a> — General framework
for transforming source code with many extensions and plugins for different
languages and frameworks. For Gradle, see
<a href="https://github.com/openrewrite/rewrite-gradle-plugin">Rewrite for Gradle</a>
with a focus on SUN style guides for Java; for Maven, see
<a href="https://docs.openrewrite.org/java/checkstyle" rel="nofollow">Rewrite for Maven</a> with a focus
on SUN style guides for Java</li>
</ul>
<p dir="auto">For your editor, consider the sample <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.editorconfig">.editorconfig</a> file in
this project. It is respected by IntelliJ and many other code editors.</p>
<p dir="auto">The demonstration projects assume checkstyle configuration at
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/config/checkstyle/checkstyle.xml"><code>config/checkstyle/checkstyle.xml</code></a>. This
is the default location for Gradle, and configured for Maven in the project.</p>
<p dir="auto">The Checkstyle configuration used is stock
<a href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/sun_checks.xml"><code>sun_checks.xml</code></a>
(this is SUN default style for Java) with the addition of support for
<code>@SuppressWarnings(checkstyle:...)</code>. Note that this format is <em>overly
aggressive</em> for Javadocs, and needs tweaking for most projects. See comments
in <code>build.gradle</code> about SUN <em>vs</em> Google styles for Java.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-spotbugs" aria-hidden="true" tabindex="-1" href="#spotbugs"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Spotbugs</h3>
<p dir="auto"><em>Static code analysis</em> is important in your build. This is analysis of your
source and compiled bytecode which finds known
<a href="https://spotbugs.readthedocs.io/en/latest/bugDescriptions.html" rel="nofollow">issues</a>
ranging among other things:</p>
<ul dir="auto">
<li>Idioms that your team finds poor or hard to read</li>
<li>Dangerous anti-patterns (<em>eg</em>, missing <code>null</code> checks in Java; your language
may aid you in this, <em>eg</em>, Kotlin or Scala)</li>
<li>Insecure code (see <a href="#shift-security-left">Shift security left</a>)</li>
<li>Use of outdated code patterns (<em>eg</em>, Java 5 patterns might be better expressed
with Java 17 improvements)</li>
<li><a href="https://spotbugs.github.io/spotbugs-maven-plugin/examples/violationChecking.html" rel="nofollow">Fail your
build</a>
if issues are detected</li>
</ul>
<p dir="auto">The Gradle and Maven demonstration builds use these to help you:</p>
<ul dir="auto">
<li><a href="https://pmd.github.io/latest/" rel="nofollow">PMD</a></li>
<li><a href="https://spotbugs.github.io/" rel="nofollow">SpotBugs</a></li>
</ul>
<p dir="auto">And use the <a href="https://find-sec-bugs.github.io/" rel="nofollow">Find Security Bugs</a> extension
for <a href="https://spotbugs.github.io/" rel="nofollow">Spotbugs</a>.</p>
<ul dir="auto">
<li>CPD for Gradle — see <a href="https://github.com/aaschmid/gradle-cpd-plugin">https://github.com/aaschmid/gradle-cpd-plugin</a>. CPD
works for MavenA</li>
</ul>
<h4 tabindex="-1" dir="auto"><a id="user-content-security" aria-hidden="true" tabindex="-1" href="#security"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Security</h4>
<p dir="auto">SpotBugs uses an outdated version of
<a href="https://commons.apache.org/proper/commons-bcel/" rel="nofollow">BCEL</a>.
There is a <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-42920" rel="nofollow">CVE</a>
(vulnerability) aginst BCEL that is resolved, however SpotBugs uses a version
of BCEL prior to the fix.
This project uses a forced update of BCEL for SpotBugs, however that breaks
the plugin (Gradle and Maven).</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-tips-10" aria-hidden="true" tabindex="-1" href="#tips-10"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h4>
<ul dir="auto">
<li>Edit <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/config/pmd/custom-rules.xml"><code>config/pmd/custom-rules.xml</code></a> to adjust
how PMD reviews your code (the sample in this project is from the PMD website)</li>
<li>To open the report for Spotbugs, build locally and use the
<code>&lt;project root&gt;/build/reports/spotbugs/</code> (Gradle) or
<code>&lt;project root&gt;/target/site/</code> (Maven) path.
Run <code>./mvnw site</code> for the latter.
The path shown in a Docker build is relative to the interior of the container</li>
<li>To open the report for PMD, build locally and use the
<code>&lt;project root&gt;/build/reports/pmd/</code> (Gradle) or
<code>&lt;project root/target/site/</code> (Maven) path.
The path shown in a Docker build is relative to the interior of the container</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-modernizer" aria-hidden="true" tabindex="-1" href="#modernizer"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Modernizer</h3>
<p dir="auto">Another static code analysis tool is <em>Modernizer</em> to check of use of obsolete
APIs and types; this is related to but not identical to <em>deprecated</em> APIs. An
example is moving to the JDK&#39;s <code>Objects.equals</code> from Guava&#39;s <code>Objects.equal</code>.</p>
<p dir="auto">Note that Modernizer works at the bytecode level (not source code), so is
suitable for any JVM language, not just Java.</p>
<ul dir="auto">
<li><a href="https://github.com/andygoossens/gradle-modernizer-plugin">Gradle plugin</a></li>
<li><a href="https://github.com/gaul/modernizer-maven-plugin">Maven plugin</a></li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-shift-security-left" aria-hidden="true" tabindex="-1" href="#shift-security-left"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Shift security left</h2>
<ul dir="auto">
<li><a href="https://find-sec-bugs.github.io/" rel="nofollow">Find known code security issues</a> — a
plugin for SpotBugs</li>
<li><a href="https://owasp.org/www-project-dependency-check/" rel="nofollow">DependencyCheck</a> —
verify your project dependencies against know security issues</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-checking-dependencies" aria-hidden="true" tabindex="-1" href="#checking-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Checking dependencies</h3>
<p dir="auto">Use checksums and signatures: verify what your build and project downloads!
When publishing for consumption by others, provide MD5 (checksum) files in your
upload: be a good netizen, and help others trust code downloaded from you</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-gradle-3" aria-hidden="true" tabindex="-1" href="#gradle-3"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Gradle</h4>
<p dir="auto">Read more at <a href="https://docs.gradle.org/current/userguide/dependency_verification.html" rel="nofollow"><em>Verifying
dependencies</em></a>
, an incubating feature.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-maven-2" aria-hidden="true" tabindex="-1" href="#maven-2"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Maven</h4>
<p dir="auto"><em>Always</em> run with the <code>--strict-checksums</code> (or <code>-C</code>) flag. See
<a href="https://dev.to/khmarbaise/maven-artifact-checksums---what-396j" rel="nofollow"><em>Maven Artifact Checksums -
What?</em></a> for more
information. This is easy to forget about at the local command line. The
<a href="https://maven.apache.org/configure.htm" rel="nofollow"><code>.mvn/maven.config</code></a> file helps this be
automatic, and can be checked into your project repository.</p>
<p dir="auto">An alternative is to declare <em>each</em> repository in your user <code>settings.xml</code> and
<a href="https://dzone.com/articles/maven-artifact-checksums-what" rel="nofollow">set the checksum policy to
&#34;fail&#34;</a>.</p>
<p dir="auto">However, in CI this is easy; another example of why local builds should repeat
what CI builds do. The <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/batect.yml">Batect configuration</a>
for the demonstration project says:</p>
<div dir="auto" data-snippet-clipboard-copy-content="build-maven:
  description: Build and test with Maven
  run:
    container: build-env
    command: ./mvnw --strict-checksums clean verify"><pre><span>build-maven</span>:
  <span>description</span>: <span>Build and test with Maven</span>
  <span>run</span>:
    <span>container</span>: <span>build-env</span>
    <span>command</span>: <span>./mvnw --strict-checksums clean verify</span></pre></div>
<p dir="auto">and the GitHub action says:</p>
<div dir="auto" data-snippet-clipboard-copy-content="- name: Build and test with Maven
  run: ./mvnw --strict-checksums verify"><pre>- <span>name</span>: <span>Build and test with Maven</span>
  <span>run</span>: <span>./mvnw --strict-checksums verify</span></pre></div>
<p dir="auto">(<a href="#keep-local-consistent-with-ci">Batect</a>
and <a href="#setup-your-ci">GitHub Actions</a> are discussed both above.)</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-dependency-check" aria-hidden="true" tabindex="-1" href="#dependency-check"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Dependency check</h3>
<p dir="auto"><strong>This is CRITICAL if you have any direct, indirect, or through-plugin
dependencies on Log4j. Beyond your project, you may be impacted by services you
call, so check with your organization or external services</strong></p>
<p dir="auto"><a href="https://owasp.org/www-project-dependency-check/" rel="nofollow">DependencyCheck</a> is the
current <em>best tool</em> for JVM projects to verify that your project does not rely
on external code with known security vulnerabilities ([CVEs](<a href="https://cve.mitre" rel="nofollow">https://cve.mitre</a>.
org/)) from the NVD.
That said, DependencyCheck does impact build times.
It is smart about caching, but will once a day may take time to download
data on any new NVD CVEs, and occasionally the site is down for maintenance.
You may consider leaving this check in CI-only if you find local build times
overly impacted.
Leaving these checks to CI-only is a tradeoff between &#34;shifting security left&#34;,
and speed for local builds.
I lean towards <em>security first</em>; however, you know your circumstances
best.</p>
<p dir="auto"><strong>This project fails the build if finding any CVEs for the current version of
any dependency.</strong></p>
<p dir="auto">Your build should fail, too. It is a <em>red flag</em> to you to consider the CVE, what
impact the vulnerable dependency has, and if you are comfortable with a
vulnerable dependency. It is rarely (if ever) the case you keep a vulnerable
version of a dependency.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-automate-scanning-for-secrets" aria-hidden="true" tabindex="-1" href="#automate-scanning-for-secrets"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Automate scanning for secrets</h3>
<p dir="auto">One key to shifting security left is avoiding secrets (passwords, private
identifiers, etc.) in your source code, commit history, and so on.</p>
<p dir="auto">GitHub and other repository services offer secrets scanning out of the box:
<a href="https://github.blog/2023-02-28-secret-scanning-alerts-are-now-available-and-free-for-all-public-repositories/" rel="nofollow">Secret scanning alerts are now available (and free) for all public
repositories</a>.</p>
<h4 tabindex="-1" dir="auto"><a id="user-content-tips-11" aria-hidden="true" tabindex="-1" href="#tips-11"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h4>
<ul dir="auto">
<li>To open the report for DependencyCheck, build locally and use the
<code>&lt;project root&gt;/build/reports/</code> (Gradle) or
<code>&lt;project root/target/</code> (Maven) path.
The path shown in a Docker build is relative to the interior of the container</li>
<li>Sometimes you may want to refresh your local cache of the NVD files:
<ul dir="auto">
<li>Gradle: <code>./gradlew dependencyCheckPurge depenedencyCheckUpdate</code></li>
<li>Maven: <code>./mvnw dependency-check:purge dependency-check:update-only</code></li>
</ul>
</li>
<li>Note that this project has updated to DependencyCheck 8.
As is the project worked without changes after updating.
See <a href="https://github.com/jeremylong/DependencyCheck/releases/tag/v8.0.0"><em>v8.0.0</em> release
notes</a>
when updating from DependencyCheck 8</li>
</ul>
<h4 tabindex="-1" dir="auto"><a id="user-content-notes" aria-hidden="true" tabindex="-1" href="#notes"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Notes</h4>
<p dir="auto">DependencyCheck may be your slowest quality check in local builds (competing
with mutation testing for that ignominious title). Sometimes it may fail when
the upstream source for CVEs is offline. If this is a recurring problem for you,
consider moving this check into CI. The downside that local work might use an
insecure dependency for a while. Checking daily for updated dependencies can
lessen this risk:</p>
<ul dir="auto">
<li>Gradle: <code>./gradlew dependencyUpdates</code></li>
<li>Maven: <code>./mvnw versions:update-properties</code></li>
</ul>
<p dir="auto">For non-Windows platforms, you may see this warning when <code>DependencyCheck</code> runs:</p>
<div data-snippet-clipboard-copy-content=".NET Assembly Analyzer could not be initialized and at least one &#39;exe&#39; or &#39;dll&#39; was scanned. The &#39;dotnet&#39; executable could not be found on the path; either disable the Assembly Analyzer or add the path to dotnet core in the configuration."><pre><code>.NET Assembly Analyzer could not be initialized and at least one &#39;exe&#39; or &#39;dll&#39; was scanned. The &#39;dotnet&#39; executable could not be found on the path; either disable the Assembly Analyzer or add the path to dotnet core in the configuration.
</code></pre></div>
<p dir="auto">In most situations, you are running in a Linux-based Docker container, or using
local Linux or Mac command line.  <strong>In a Windows project, this is an issue to
address, and may be a serious security concern</strong> indicating you are missing
critical Windows components. For other platforms, this is a nuisance message.</p>
<p dir="auto">On Gradle when updating to version 7.x.x of DependencyCheck from 6.x.x or
earlier, first run <code>./gradlew dependencyCheckPurge</code> to clear out the local
cache schema of CVEs.
DependencyCheck moved to schema v2 in 7.x.x from v1 in 6.x.x and earlier,
and the 7.0.0 Gradle plugin fails with the older schema version.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-dependabot" aria-hidden="true" tabindex="-1" href="#dependabot"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Dependabot</h3>
<p dir="auto">GitHub provides
<a href="https://docs.github.com/en/free-pro-team@latest/github/administering-a-repository/keeping-your-dependencies-updated-automatically">Dependabot</a>
(other systems than GitHub may have similar robot tools) which, among other
things, can automatically issue PRs to your repository when security issues are
discovered. This project uses Dependabot for Gradle and Maven.</p>
<p dir="auto"><em>NB</em> — Dependabot is more reliable than either the Gradle or Maven plugins
for dependencies.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-12" aria-hidden="true" tabindex="-1" href="#tips-12"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>See the &#34;Tips&#34; section of <a href="#use-gradle-or-maven">Gradle or Maven</a></li>
<li>With GitHub actions, consider adding a tool such as
<a href="https://dependabot.com/" rel="nofollow">Dependabot</a>, which automatically files GitHub issues
for known dependency vulnerabilities. See
<a href="#dependabot">earlier in this document</a> for an example</li>
<li>You can <em>temporarily</em> disable OWASP dependency checking via
<code>-Dowasp.skip=true</code> for either Gradle or Maven, for example if the OWASP site
is down for maintenance, and you cannot update the local CVE cache</li>
<li>The <em>log4shell security vulnerabilities</em>
(<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" rel="nofollow">CVE-2021-44228</a>,
CVE-2021-45046,
CVE-2021-45105
are extremely severe. They are so severe, this should be a top priority for
you to address regardless of other priorities. Although this project does not
use <code>log4j</code>, local testing shows that the <code>DependencyCheck</code> plugin for either
Gradle or Maven fails build when you use an older, insecure version
of <code>log4j-core</code> indirectly. Note that Gradle 7.3.3+ itself fails your build if
it detect a dependency on a vulnerable version of <code>log4j-core</code></li>
<li>The <em>BCEL security vulnerability</em>
(<a href="https://www.opencve.io/cve/CVE-2022-42920" rel="nofollow">CVE-2022-42920</a>) is critical,
and should be a top priority to address. In this project, BCEL is used by
Spotbugs.</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-todos" aria-hidden="true" tabindex="-1" href="#todos"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>TODOs</h3>
<ul dir="auto">
<li>How to automate the <code>-C</code> (checksum) flag in Maven? See
<a href="https://dev.to/khmarbaise/maven-artifact-checksums---what-396j" rel="nofollow"><em>Maven Artifact Checksums -
What?</em></a></li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-leverage-unit-testing-and-coverage" aria-hidden="true" tabindex="-1" href="#leverage-unit-testing-and-coverage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Leverage unit testing and coverage</h2>
<ul dir="auto">
<li><a href="https://www.jacoco.org/jacoco/" rel="nofollow">JaCoCo</a></li>
<li>Use the &#34;ratchet&#34; pattern to fail the build when coverage drops.
Robert Greiner talks more on this in <a href="https://robertgreiner.com/continuous-code-improvement-using-ratcheting/" rel="nofollow"><em>Continuous Code Improvement Using
Ratcheting</em></a>
This follows the agile <a href="https://dzone.com/articles/the-boy-scout-software-development-principle" rel="nofollow">&#34;Boy Scout&#34;
principle</a></li>
<li>Fluent assertions — lots of options in this area
<ul dir="auto">
<li><a href="https://assertj.github.io/doc/" rel="nofollow">AssertJ</a> — solid choice</li>
<li>Built assertions from Junit makes is difficult for developers to
distinguish &#34;actual&#34; values from &#34;expected&#34; values. This is a limitation
from Java as it lacks named parameters.
Other frameworks compatible with JUnit provide more fluent assertions such
as AssertJ.
Different choices make sense depending on your source language</li>
</ul>
</li>
</ul>
<p dir="auto">Unit testing and code coverage are foundations for code quality.
Your build should help you with these as much as possible. 100% coverage may
seem absurd;
however, levels of coverage like this come with unexpected benefits such as
finding dead code in your project or helping refactoring to be simple.
An example: with high coverage (say 95%+, your experience will vary)
simplifying your covered code may lower your coverage as uncovered code becomes
more prominent in the total ratio.</p>
<p dir="auto">Setup for needed plugins:</p>
<ul dir="auto">
<li>For Gradle use the <code>java</code> plugin</li>
<li>For Maven, use more recent versions of the
<a href="https://maven.apache.org/surefire/maven-surefire-plugin/" rel="nofollow">Maven Surefire Plugin</a></li>
</ul>
<p dir="auto">(See <a href="https://github.com/hcoles/pitest/issues/347" data-hovercard-type="issue" data-hovercard-url="/hcoles/pitest/issues/347/hovercard"><em>suggestion : Ignore the generated
code</em></a> for a Lombok/PITest issue.)</p>
<p dir="auto">To see the coverage report (on passed or failed coverage), open:</p>
<ul dir="auto">
<li>For Gradle, <code>build/reports/jacoco/test/html/index.html</code></li>
<li>For Maven, <code>target/site/jacoco/index.html</code></li>
</ul>
<p dir="auto">This project also provides the coverage report as part of Maven&#39;s project
report.</p>
<p dir="auto">The <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/coverage.sh"><code>coverage</code></a> script is helpful for checking your current
coverage state: try <code>./coverage -f all</code>.
Current limitations:</p>
<ul dir="auto">
<li>Maven builds only</li>
<li>Single module builds only</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-13" aria-hidden="true" tabindex="-1" href="#tips-13"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>With Maven, <em>do use</em> the available BOM (bill of materials) for JUnit.
An example <code>pom.xml</code> block is:
<div dir="auto" data-snippet-clipboard-copy-content="  &lt;dependencyManagement&gt;
      &lt;dependencies&gt;
          &lt;dependency&gt;
              &lt;groupId&gt;org.junit&lt;/groupId&gt;
              &lt;artifactId&gt;junit-bom&lt;/artifactId&gt;
              &lt;version&gt;${junit.version}&lt;/version&gt;
              &lt;type&gt;pom&lt;/type&gt;
              &lt;scope&gt;import&lt;/scope&gt;
          &lt;/dependency&gt;
      &lt;/dependencies&gt;
  &lt;/dependencyManagement&gt;"><pre>  &lt;<span>dependencyManagement</span>&gt;
      &lt;<span>dependencies</span>&gt;
          &lt;<span>dependency</span>&gt;
              &lt;<span>groupId</span>&gt;org.junit&lt;/<span>groupId</span>&gt;
              &lt;<span>artifactId</span>&gt;junit-bom&lt;/<span>artifactId</span>&gt;
              &lt;<span>version</span>&gt;${junit.version}&lt;/<span>version</span>&gt;
              &lt;<span>type</span>&gt;pom&lt;/<span>type</span>&gt;
              &lt;<span>scope</span>&gt;import&lt;/<span>scope</span>&gt;
          &lt;/<span>dependency</span>&gt;
      &lt;/<span>dependencies</span>&gt;
  &lt;/<span>dependencyManagement</span>&gt;</pre></div>
This helps avoid dependency conflicts from other dependencies or plugins</li>
<li>See <a href="#leverage-lombok-to-tweak-code-coverage">discussion on Lombok</a> how to
<em>sparingly</em> leverage the <code>@Generated</code> annotation for marking code that JaCoCo
should ignore</li>
<li>Discuss with your team the concept of a &#34;coverage ratchet&#34;. This means, once a
baseline coverage percentage is agreed to, the build configuration will only
raise this value, not lower it. This is fairly simple to do by periodically
examining the JaCoCo report, and raising the build coverage percentage over
time to match improvements in the report</li>
<li>Unfortunately neither Gradle&#39;s nor Maven&#39;s JaCoCo plugin will fail your build
when coverage <em>rises</em>!  This would be helpful for supporting the coverage
ratchet</li>
<li>You may find <em>mocking</em> helpful for injection. The Java community is not of one
mind on mocking, so use your judgment:
<ul dir="auto">
<li><a href="https://site.mockito.org/" rel="nofollow">Mockito</a> is the &#34;standard&#34; choice, and is a
dependency for the sample projects.
For modern versions of Mockito, please use the <code>mockito-core</code> dependency
rather than <code>mockito-inline</code>.
See <code>TheFooTest.shouldRedAlertAsStaticMock</code> for an example.
Note that this project has updated to Mockito 5.
See <a href="https://github.com/mockito/mockito/releases/tag/v5.0.0"><em>v5.0.0</em> release
notes</a> when
updating from Mockito 4</li>
<li><a href="https://powermock.github.io/" rel="nofollow">PowerMock</a> provides additional features;
however, Mockito normally covers use cases</li>
<li>Other Modern JVM languages — these languages may prefer different
mocking libraries, <em>eg</em>, <a href="https://mockk.io/" rel="nofollow">MockK</a> for Kotlin</li>
<li>You might consider complementary libraries to Mockito for specific
circumstances, <em>eg</em>,
<a href="https://github.com/stefanbirkner/system-lambda">System Lambda</a>
for checking STDOUT and STDERR, program exits, and use of system
properties (<em>eg</em>, validate logging), also a dependency for the sample
projects.  (<em>NB</em> — these are generally not parallelizable tests as
they alter the state of the JVM. Another is the
<a href="https://junit-pioneer.org/" rel="nofollow">JUnit Pioneer</a> extension pack. If you need
these, be cautious about using parallel testing features, and avoiding
<a href="https://hackernoon.com/flaky-tests-a-war-that-never-ends-9aa32fdef359" rel="nofollow">Flaky Tests</a>)</li>
</ul>
</li>
<li>To open the report for JaCoCo, build locally and use the
<code>&lt;project root&gt;/build/reports/jacoco/test/html/</code> path.
The path shown in a Docker build is relative to the interior of the container</li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-use-mutation-testing" aria-hidden="true" tabindex="-1" href="#use-mutation-testing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use mutation testing</h2>
<p dir="auto">Unit testing is great for testing your production code. But have you thought
about testing your unit tests? What that means is, how are you sure your tests
really check what you meant them to? Fortunately, there is an automated way to
do just that, no code from you required, only some build configuration.</p>
<p dir="auto">Mutation testing is a simple concept: Go &#34;break&#34; some production code, and see
if any unit tests fail. Production bytecode is changed during the build—
for example, an <code>if (x)</code> is changed to <code>if (!x)</code>—, and the unit tests run.
With good code coverage, there should now be a failing unit test.</p>
<p dir="auto">The best option for Modern Java/JVM mutation testing is
<a href="http://pitest.org/" rel="nofollow">PITest</a>. It is under active development, does rather clever
things with compiled bytecode, and has Gradle and Maven plugins. The main
drawback for your <em>local build</em> is that PITest is <em>noisy</em>, so there might be
more build output than you might expect.</p>
<p dir="auto">Mutation testing is one of the slowest parts of a local build. You might
consider moving mutation testing to CI-only to speed up local
<em>red-green-refactor</em> cycle
(<a href="https://medium.com/@tunkhine126/red-green-refactor-42b5b643b506" rel="nofollow">_Red, Green, Refactor!</a>,
<a href="https://blog.cleancoder.com/uncle-bob/2014/12/17/TheCyclesOfTDD.html" rel="nofollow"><em>The Cycles of
TDD</em></a>).
Use your judgment on the value of the CI build never or rarely failing (modulo
external resources) when local build passes <em>vs</em> the speed of pushing good code.</p>
<p dir="auto">After running a build using PITest, to see the mutation report (on passed or
failed mutation coverage), open:</p>
<ul dir="auto">
<li>For Gradle, open <code>build/reports/pitest/index.html</code></li>
<li>For Maven, open <code>target/pit-reports/index.html</code></li>
</ul>
<p dir="auto">This project provides the PIT report as part of Maven&#39;s project report.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-14" aria-hidden="true" tabindex="-1" href="#tips-14"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>Without further configuration, PITest defaults to mutating classes using
your <em>project group</em> as the package base. Example: Set the <em>project group</em>
to &#34;demo&#34; for either Gradle or Maven if your classes are underneath the
&#34;demo.*&#34; package namespace, otherwise PITest may complain that there are no
classes to mutate, or no unit tests to run</li>
<li>If you need to open modules (<em>eg</em>, <code>--add-opens</code> flags), you need to include
these flags in &#34;jvm args&#34; configuration for the plugin</li>
<li>Read more about <a href="https://testing.googleblog.com/2021/04/mutation-testing.html" rel="nofollow"><em>Mutation
Testing</em></a> from
Google</li>
<li>To open the report for PITest, build locally and use the
<code>&lt;project root&gt;/build/reports/pitest/</code> (Gradle) or
<code>&lt;project root&gt;/target/pit-reports/</code> (Maven) path.
The path shown in a Docker build is relative to the interior of the container</li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-use-integration-testing" aria-hidden="true" tabindex="-1" href="#use-integration-testing"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use integration testing</h2>
<p dir="auto">Here the project says &#34;integration testing&#34;. Your team may call it by another
name. This means bringing up your application, possibly with
<a href="http://xunitpatterns.com/Mocks,%20Fakes,%20Stubs%20and%20Dummies.html" rel="nofollow">fakes, stubs, mocks, spies, dummies, or doubles</a>
for external dependencies (databases, other services, <em>etc</em>), and running tests
against high-level functionality, but <em>not</em> starting up external dependencies
themselves (<em>ie</em>, Docker, or manual command-line steps). Think of CI: what are
called here &#34;integration tests&#34; are those which do
<em>not</em> need your CI to provide other services.</p>
<p dir="auto">An example is testing <code>STDOUT</code> and <code>STDERR</code> for a command-line application.
(If you are in Spring Framework/Boot-land, use controller tests for your REST
services.)</p>
<p dir="auto">Unlike <code>src/main/java</code> and <code>src/test/java</code>, there is no generally agreed
convention for where to put integration tests. This project keeps all tests
regardless of type in <code>src/test/java</code> for simplicity of presentation, naming
integration tests with &#34;*IT.java&#34;. A more sophisticated approach may make sense
for your project.</p>
<p dir="auto">If you&#39;d like to keep your integration tests in a separate source root from unit
tests, consider these plugins:</p>
<ul dir="auto">
<li>For Gradle, use <a href="https://docs.gradle.org/current/userguide/java_testing.html#sec:configuring_java_integration_tests" rel="nofollow">native Gradle to add new test
sets</a>.
(Previous versions of this project used the excellent
<a href="https://github.com/unbroken-dome/gradle-testsets-plugin"><code>testsets</code> plugin</a>,
however, it does not support Gradle 8)</li>
<li>For Maven, use
the <a href="https://maven.apache.org/failsafe/maven-failsafe-plugin/" rel="nofollow">Maven Failsafe Plugin</a></li>
</ul>
<p dir="auto"><strong>Caution</strong>: This project <em>duplicates</em>
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/src/test/java/demo/ApplicationIT.java"><code>ApplicationIT.java</code></a> and
<a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/src/integrationTest/java/demo/ApplicationTest.java"><code>ApplicationTest.java</code></a>
reflecting the split in philosophy between Gradle and Maven for integration
tests. Clearly in a production project, you would have only one of these.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-tips-15" aria-hidden="true" tabindex="-1" href="#tips-15"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Tips</h3>
<ul dir="auto">
<li>For Maven projects, Apache maintains Failsafe and Surefire plugins as a pair,
and share the same version numbers.
This project uses a shared <code>maven-testing-plugins.version</code> property</li>
<li>Baeldung
has <a href="https://www.baeldung.com/maven-failsafe-plugin" rel="nofollow">a good introduction article</a>
on Maven Failsafe</li>
</ul>
<hr/>
<h2 tabindex="-1" dir="auto"><a id="user-content-going-further" aria-hidden="true" tabindex="-1" href="#going-further"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Going further</h2>
<p dir="auto">Can you do more to improve your build, and shift problems left (before they hit
CI or production)?
Of course!
Below are some topics to discuss with your team about making them part of the
local build.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-the-test-pyramid" aria-hidden="true" tabindex="-1" href="#the-test-pyramid"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>The Test Pyramid</h3>
<p dir="auto"><a href="https://martinfowler.com/bliki/TestPyramid.html" title="TestPyramid" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/test-pyramid.png" alt="The test pyramid" width="20%" height="auto"/>
</a></p>
<p dir="auto">What is the &#34;Test Pyramid&#34;? This is an important conceptual framework for
validating your project at multiple levels of interaction. Canonical resources
describing the test pyramid include:</p>
<ul dir="auto">
<li><a href="https://martinfowler.com/bliki/TestPyramid.html" rel="nofollow"><em>TestPyramid</em></a></li>
<li><a href="https://martinfowler.com/articles/practical-test-pyramid.html" rel="nofollow"><em>The Practical Test
Pyramid</em></a></li>
</ul>
<p dir="auto">As you move your testing &#34;to the left&#34; (helping local builds cover more
concerns), you&#39;ll want to enhance your build with more testing at different
levels of interaction. These are not covered in this article, so research is
needed.</p>
<p dir="auto">There are alternatives to the &#34;test pyramid&#34; perspective. Consider
<a href="https://blog.korny.info/2020/01/20/the-swiss-cheese-model-and-acceptance-tests.html" rel="nofollow">swiss cheese</a>
if it makes more sense for your project.
The build techniques still apply.</p>
<p dir="auto"><strong>NB</strong> — What this article calls
<a href="#use-integration-testing">&#34;integration tests&#34;</a> may have a different name for
your team.
You may have &#34;system tests&#34; for example.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-use-automated-live-testing-when-appropriate" aria-hidden="true" tabindex="-1" href="#use-automated-live-testing-when-appropriate"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use automated live testing when appropriate</h3>
<p dir="auto">&#34;Live testing&#34; here means spinning up a database or other remote service for
local tests, and not
using <a href="http://xunitpatterns.com/Mocks,%20Fakes,%20Stubs%20and%20Dummies.html" rel="nofollow">fakes, stubs, mocks, spies, dummies, or
doubles</a>.
In these tests, your project calls on <em>real</em> external dependencies, albeit
dependencies spun up locally rather than in production or another environment.
These might be call &#34;out of process&#34; tests.</p>
<p dir="auto">This is a complex topic, and this document is no guide on these. Some
potentially useful resources to pull into your build:</p>
<ul dir="auto">
<li><a href="https://flywaydb.org/" rel="nofollow">Flyway</a> — Version your schema in production, and
version your test data</li>
<li><a href="https://github.com/localstack/localstack">LocalStack</a> — Local testing
for AWS services</li>
<li><a href="https://www.testcontainers.org/" rel="nofollow">TestContainers</a> — Local Docker for
real database instances, or any Docker-provided service</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-use-contract-testing-when-appropriate" aria-hidden="true" tabindex="-1" href="#use-contract-testing-when-appropriate"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Use contract testing when appropriate</h3>
<p dir="auto">Depending on your program, you may want additional testing specific to
circumstances. For example, with REST services and Spring Cloud, consider:</p>
<ul dir="auto">
<li><a href="https://spring.io/guides/gs/contract-rest/" rel="nofollow"><em>Consumer Driven Contracts</em></a></li>
</ul>
<p dir="auto">There are many options in this area. Find the choices which work best for you
and your project.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-provide-user-journey-tests-when-applicable" aria-hidden="true" tabindex="-1" href="#provide-user-journey-tests-when-applicable"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Provide User Journey tests when applicable</h3>
<p dir="auto">Another dimension to consider for local testing: <em>User Journey</em> tests.</p>
<ul dir="auto">
<li><a href="https://www.thoughtworks.com/insights/blog/why-test-user-journey" rel="nofollow"><em>Why test the user
journey?</em></a></li>
</ul>
<hr/>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/debugging.png"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/debugging.png" alt="Debugging in the container" width="20%" height="auto"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-debugging" aria-hidden="true" tabindex="-1" href="#debugging"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Debugging</h2>
<p dir="auto">For direct debugging without a container follow your IDE&#39;s instructions.
For debugging within the local Batect container, examples are in the Batect
tasks <code>debug-with-gradle</code> and <code>debug-with-maven</code>.
Update <code>run-with-gradle.sh</code> or <code>run-with-maven.sh</code>, or write your own
similar script to run your program with the right JVM flags for <em>remote
debugging</em> (the container is a remote process on &#34;localhost&#34; from the
perspective of your IDE).</p>
<p dir="auto">These Batect example tasks assume a command-line program that exits when
completed.
See <a href="#spring-boot">the Spring Boot</a> sample for the same approach with
long-running services.</p>
<hr/>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/images/sample.svg"><img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/sample.svg" alt="Sample" width="20%" height="auto"/></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-samples" aria-hidden="true" tabindex="-1" href="#samples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Samples</h2>
<p dir="auto">These samples are external projects, are at varying states of maturity, and
are frequently updated (espcially for dependency versions).</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-kotlin" aria-hidden="true" tabindex="-1" href="#kotlin"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Kotlin</h3>
<ul dir="auto">
<li><a href="https://github.com/binkley/kunits">KUnits</a> (Maven) is a pleasure project to
represent units of measurement in Kotlin</li>
<li><a href="https://github.com/binkley/kotlin-rational">Kotlin Rational</a> (Maven)
explores a math library for rationals (fractions) akin to <code>BigDecimal</code></li>
<li><a href="https://github.com/binkley/kotlin-magic-bus">Magic Bus</a> (Gradle) is a
library for using messaging patterns within a single application (it talks
to itself)</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-spring-boot" aria-hidden="true" tabindex="-1" href="#spring-boot"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Spring Boot</h3>
<ul dir="auto">
<li><a href="https://github.com/binkley/kotlin-spring-boot-hateoas-database">Spring Boot HATEOAS
Database</a>
(Maven) looks at Spring Boot features for Open API (Swagger), REST APIs,
HATEOAS, GraphQL, Prometheus, <em>et al</em></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-problems" aria-hidden="true" tabindex="-1" href="#problems"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Problems</h2>
<a href="https://xkcd.com/303/" title="Compiling" rel="nofollow">
<img src="https://brian.abelson.live/binkley/modern-java-practices/raw/master/images/compiling.png" alt="Compiling" width="20%" height="auto"/>
</a>
<h3 tabindex="-1" dir="auto"><a id="user-content-why-is-my-local-build-slow" aria-hidden="true" tabindex="-1" href="#why-is-my-local-build-slow"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Why is my local build slow?</h3>
<p dir="auto">Both Gradle and Maven have tools to track performance time of steps in your
build:</p>
<ul dir="auto">
<li><a href="https://scans.gradle.com/" rel="nofollow">Gradle build scans</a> — Not limited to
Enterprise licenses, just build with <code>./gradlew --scan &lt;tasks&gt;</code> and follow the
link in the output.
<a href="https://cdn.jsdelivr.net/gh/binkley/modern-java-practices/docs/profile-run/gradle-profile.html" title="A sample Gradle profile for this project" type="text/html" rel="nofollow">
See a sample Gradle profile for this project</a>.</li>
<li><a href="https://github.com/jcgay/maven-profiler">Maven profiler</a> — run
with <code>./mvnw -Dprofile &lt;goals&gt;</code> and open the local link in the output. This
project includes the setup for <a href="https://brian.abelson.live/binkley/modern-java-practices/blob/master/.mvn/extensions.xml">Maven extensions</a>.
<a href="https://cdn.jsdelivr.net/gh/binkley/modern-java-practices/docs/profile-run/maven-profile.html" title="A sample Maven profile for this project" type="text/html" rel="nofollow">
See a sample Maven profile for this project</a>.</li>
</ul>
<p dir="auto"><strong>TODO</strong>: Fix the sample profile links to display as pages, not as raw HTML.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-my-local-build-is-still-too-slow" aria-hidden="true" tabindex="-1" href="#my-local-build-is-still-too-slow"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>My local build is still too slow</h3>
<p dir="auto">Congratulations!  You care, and you notice what is happening for your team.</p>
<p dir="auto">Use the Gradle or Maven instructions
in <a href="#keep-your-build-fast">keep your build fast</a> to profile your build, and spot
where it spends time.</p>
<p dir="auto">If you find your local build is taking too long, consider testing moving these
parts to CI with the cost to you of issues arising from delayed feedback:</p>
<ul dir="auto">
<li><a href="#keep-your-build-clean">Jdeps</a></li>
<li><a href="#shift-security-left">DependencyCheck</a></li>
<li><a href="#use-integration-testing">Integration tests</a></li>
<li><a href="#use-mutation-testing">PITest</a></li>
</ul>
<p dir="auto"><em>But beware</em>!  Your local build is now drifting away from CI, so you are pushing
problems off later in your build pipeline. Not everyone pays close attention to
CI failures, that is until something bad happens in production.</p>
<p dir="auto"><em>IMPORTANT</em> — if you disable tools like the above in the <em>local</em> build,
ensure you retain them in your <em>CI</em> build. Your goal in this case is speed up
the feedback cycle locally while retaining the benefits of automated tooling.
You are making a bet: problems these tools find come up rarely (but can be
catastrophic when they do), so time saved locally repays time lost waiting for
CI to find these problems.</p>
<p dir="auto">In the Gradle and Maven samples in this repository, <em>DependencyCheck</em> and
<em>Mutation testing</em> are typically the slowest steps in a local build;
<em>Integration tests</em> are fast only because this project has very few (1), and are
samples only.
<a href="http://www.catb.org/jargon/html/Y/Your-mileage-may-vary.html" rel="nofollow">YMMV</a></p>
<p dir="auto">Every project is different; your team and stakeholders need to judge the value
of quicker feedback to programmers of these concerns, and quicker feedback from
a faster local build. There is no &#34;one size fits all&#34; recommendation.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-it-fails-in-ci-but-passes-locally" aria-hidden="true" tabindex="-1" href="#it-fails-in-ci-but-passes-locally"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>It fails in CI, but passes locally</h3>
<p dir="auto">As much as you would like local builds to be identical to CI, this can still
happen for reasons of environment. Examples can include:</p>
<ul dir="auto">
<li>Credentials needed in CI have changed: Update your CI configuration</li>
<li>Network routing has changed, and CI is in a different subnet from local:
Talk with your Infrastructure team</li>
<li>CI includes steps to push successful builds further down the line to other
environments, and something there went wrong: Talk with your Infrastructure
team</li>
<li>Dependencies break in CI: If CI uses an internal dependency repository, check
in with the maintainers of the repository</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-credits" aria-hidden="true" tabindex="-1" href="#credits"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Credits</h2>
<p dir="auto">Many thanks to:</p>
<ul dir="auto">
<li><a href="https://github.com/LemmingAvalanche">Kristoffer Haugsbakk</a> —
<em>Proofreading</em></li>
<li><a href="https://github.com/Bukharovsi">Sergei Bukharov</a> — <em>PMD enhancements</em></li>
</ul>
<p dir="auto">All suggestions and ideas welcome!
Please <a href="https://github.com/binkley/modern-java-practices/issues">file an
issue</a>. ☺</p>
</article>
          </div></div>
  </body>
</html>
