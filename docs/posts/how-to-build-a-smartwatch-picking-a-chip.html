<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ericmigi.com/blog/how-to-build-a-smartwatch-picking-a-chip/">Original</a>
    <h1>How to Build a Smartwatch: Picking a Chip</h1>
    
    <div id="readability-page-1" class="page"><div><iframe width="560" height="315" src="https://www.youtube.com/embed/umQ39BhcyMM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><p>Full video of this post is up on my podcast on <a href="https://youtu.be/umQ39BhcyMM">YouTube</a>! Subscribe on <a href="https://pca.st/m2aheg1u">PocketCasts</a>, <a href="https://creators.spotify.com/pod/show/tick-talk-w-eric">Spotify</a>, or <a href="https://podcasts.apple.com/us/podcast/tick-talk-w-eric-migicovsky/id1812362079">Apple Podcasts</a>.  </p><p><strong>TLDR:</strong></p><ul><li>We&#39;ve selected a chip for Core Time 2 - SF32LB52J. It‚Äôs from a company called SiFli, and features an open source SDK.</li><li>I‚Äôm writing a series of posts on how to make a smartwatch</li><li>Covering how to pick a chip (today), other hardware and software stuff (later)</li><li>I hope others will use PebbleOS to build interesting new smartwatches and other devices!</li></ul><p>This is the first in a series of posts around the steps you need to take in order to build a smartwatch. I want to show that it&#39;s not actually that hard to make a decent one in 2025! Hopefully the work that we&#39;re doing to make these <a href="https://store.repebble.com/">new watches</a> will help other folks to build some as well. </p><p>Smartwatches are not and should not be ‚Äòone-size fits all‚Äô devices. I really hope that the open sourcing of PebbleOS might spark someone‚Äôs imagination and enable them to build a smartwatch that fits their needs perfectly!</p><p>A smartwatch is a system made up of three main components: </p><ul><li>Watch hardware (this is the actual watch itself)</li><li>Watch software (usually referred to as the firmware or operating system)</li><li>Mobile companion app (iOS and Android app that sends notifications, downloads watchfaces etc)</li></ul><p>As I&#39;ve mentioned before, designing a consumer electronics product like a smartwatch is an exercise in constraint maximization. You need to identify a target experience goal (‚ÄùI want a smartwatch with an always-on daylight readable display that lasts for 30 days‚Äù), then break that down into features/specifications (‚Äùe-paper display‚Äù, ‚ÄúBluetooth LE‚Äù, ‚Äúwater resistant‚Äù, ‚Äú$150 retail price‚Äù) and then create a design with hardware and software components (‚ÄùSharp Memory LCD‚Äù, ‚Äú150mAh lipoly battery‚Äù, ‚ÄúFreeRTOS‚Äù etc) that meet your specifications and fulfill your goal. </p><p>After almost 20 years of building products, this process comes naturally to me - sometimes unprompted! I can look at any product and picture the exploded view, estimate manufacturing costs, and imagine how its software subsystems fit together. It‚Äôs a blessing and a curse!</p><p>You can break down watch hardware into five key systems:</p><ul><li>Microcontroller chip (usually includes Bluetooth radio)</li><li>Display</li><li>Sensors and outputs (tac switches, touch, mics, accelerometer, speakers)</li><li>Other electronic components (chips, passive components, printed circuit board, battery)</li><li>Mechanical structure (watch case, glass, buttons, strap, charge cable)</li></ul><p>Picking components for the latter 3 systems is actually quite straight forward these days. There are lots of good options available at various price points for sensors, batteries, straps, watch cases, mics, etc. Constraint maximization is relatively easy for these, I‚Äôll wrap all these up into one blog post later.</p><p>The two most challenging component decisions that need to be made when designing a smartwatch are selecting:</p><ul><li>a microcontroller and Bluetooth radio (this post)</li><li>a display (future post)</li></ul><h3>The backstory</h3><p>During the first Pebble era, we used STM32F2 microcontrollers (MCU). Why? Because over beers on one Friday evening in 2011 at the <a href="https://hackerdojo.org/">Hacker Dojo</a> a friend of mine, Hugo Fiennes, would NOT stop raving about this relatively new MCU. At the time, I was working on <a href="https://www.tumblr.com/inpulse-blog/222972860/evolution1?source=share">inPulse</a> which used an LPC2103 (8K of RAM!) - he rightly thought that we were in desperate need of an upgrade. </p><p>Honestly, this is 100% typical for me. I think that all the major chip selections I‚Äôve made have come from friends raving about a particular chip. Yes, I have a delightfully eccentric set of friends üòÇ¬†Thank you Trammell Hudson, TL Lim from Pine64, Peter Barrett and many others for your chats over the years.</p><p>An MCU is the heart of the smartwatch. Think of an MCU as a miniature computer - it contains a CPU, RAM, (usually) flash storage, i/o peripherals and sometimes radios, all within a single tiny integrated circuit. </p><p>You can the specs of the MCUs we used before on this <a href="https://github.com/PebbleA2/wiki/wiki/Watch-Comparison">helpful table</a> - 64-144MHz, 128-256KB RAM. During this era, MCUs didn‚Äôt have integrated BT radios, so we used additional chips like TI CC2564 (that model is forever etched in my brain for some reason, probably the pain of finding a decent BT stack to use with it). </p><h3>Why is picking the right MCU so important?</h3><p>Getting back to constraint maximization, the MCU sits at the focal point of the most constrained governing ‚Äòequations‚Äô - software compatibility, power consumption and cost. </p><p>The most interesting and difficult constraint is actually software compatibility. <strong>E</strong>mbedded software is much more fragmented and requirement-specific than computer operating system software. Because computers are not very hard drive space constrained, kernels can be optimized for broader compatibility - Linux contains over 17,000 device drivers. PebbleOS was effectively hardcoded to support MCUs from only one company (STM). Switching to a different brand required writing new peripheral (i2c, SPI, DMA, etc) drivers, adopting a different SDK and (sometimes) build system changes. These changes aren&#39;t risky, but they do take time to implement and test. Some MCUs do not easily support FreeRTOS (cough nRF53/54 due to lack of BLE stack).</p><p>Since we are not planning to build hundreds of thousands or millions of watches, software engineering costs cannot be amortized and end up being a significant driver to the total cost of each watch. If a chip is easier to develop software for, one might even consider paying for a higher per-unit cost chip given software development time savings.</p><p>A smartwatch must be connected 24/7 to a phone via Bluetooth, so average power consumption while connected is one of two largest power drains - the other being display.</p><h3>Picking chips for our new watches</h3><p>We decided to use Nordic‚Äôs nRF52840 for Core 2 Duo. It‚Äôs an older chip, but we were very familiar with it and knew that we could get PebbleOS up and running on it relatively quickly. Initially, we planned to use Nordic‚Äôs SoftDevice BLE stack, but thanks to the clever work of Liam (colleague of mine at Pebble and now <a href="http://rebble.io/">Rebble</a> contributor), we switched to using an open source BLE stack called <a href="https://github.com/apache/mynewt-nimble">nimBLE</a>. </p><p>While an nrf52840 is powerful enough for Core 2 Duo, for Core Time 2 we needed an MCU with more RAM and processing power.</p><p>For Core Time 2, we would have liked to stay with Nordic (since we had just spent a bunch of time porting PebbleOS to work with Nordic‚Äôs SDK and peripherals) but Nordic‚Äôs roadmap in the BLE MCU space was not very inviting. Their new low-end chip, nRF54L15, only has 256k of RAM. The bigger colour display on the Core Time 2 requires more RAM and we wanted some breathing room for new features. Also, it only recently went into mass production, so we don‚Äôt have any friends who are using it yet - not too many reviews. Nordic also has a 54H series with 1M of RAM, but the price doubles to $4-5 dollars or more - no 512K RAM option either. CT2 also requires a special interface for its 64 colour MIP display, which 2015-era Pebbles previously used a dedicated FPGA to drive. </p><p>So I was on the hunt for a new chip. I looked at a variety of options like Apollo, BES, and Dialog but couldn‚Äôt find anything that fit our needs exactly. One of the biggest stumbling blocks was lack of an open source SDK. One chip from BES looked pretty good but we ran into problems when trying to test it out - there was no open source SDK! No example code. Everything was locked behind an NDA. That wasn‚Äôt going to work for us - PebbleOS needs to be open source.</p><p>Luckily, lightning struck. I randomly got an email from the CEO of a smaller Bluetooth chip company called SiFli. We exchanged a few emails over the span of a few hours. It became clear that he was extraordinarily interested in getting his chips to power an open source smartwatch.</p><p>SiFli chips are custom-made to be the primary chip in smartwatches. They power tens of millions of smartwatches already from brands like Redmi, Oppo, Noise and many others. The smallest (!) SiFli chip <a href="https://drive.google.com/file/d/1FV5-n6thM8XkzVQeAap2eJv97sCO_NrG/view?usp=sharing">SF32LB52x</a> has over 512K of SRAM, 16M of PSRAM, has a dedicated MIP peripheral for our display - cutting out the need for a separate FPGA or expensive dedicated display interface chip like Epson.</p><p>It also has a extremely low power consumption profile: ~50uA with BLE connected. Oh and it‚Äôs less than $2! They even have several chips with 1 to 2MB SRAM options that we could switch to if necessary.</p><p>Best of all - their SDK is open source on <a href="https://github.com/OpenSiFli">Github</a> and they offered to help port PebbleOS to work on their chips.</p><p>So there you have it. The chip for Core Time 2 will be a SF32LB52J (the 1.8V variant of SF32LB527. That‚Äôs going to be etched in my long term memory for sure!</p><p>Next post: how to pick a display‚Ä¶</p><p>SiFli links:</p><ul><li><a href="https://drive.google.com/file/d/1FV5-n6thM8XkzVQeAap2eJv97sCO_NrG/view?usp=sharing">SF32LB52x reference guide</a></li><li><a href="https://github.com/OpenSiFli">https://github.com/OpenSiFli</a></li><li><a href="https://item.taobao.com/item.htm?abbucket=11&amp;detail_redpacket_pop=true&amp;id=913039901152&amp;ltk2=1746962311930er3jpr9z173xe91zr84ps&amp;ns=1&amp;priceTId=undefined&amp;query=%E6%80%9D%E6%BE%88%E7%A7%91%E6%8A%80&amp;skuId=5776328712262&amp;spm=a21n57.1.hoverItem.2&amp;utparam=%7B%22aplus_abtest%22%3A%228935e1d10ee53e64944bb19c4245a174%22%7D&amp;xxc=taobaoSearch">Buy Devkit on Taobao</a> (Aliexpress coming soon)</li></ul></div></div>
  </body>
</html>
