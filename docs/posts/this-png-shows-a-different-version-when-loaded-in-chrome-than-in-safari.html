<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lr0.org/blog/p/pngchanges/">Original</a>
    <h1>This PNG shows a different version when loaded in Chrome than in Safari</h1>
    
    <div id="readability-page-1" class="page"><div id="outline-text-whats-really-happening"><p>(1) The PNG contains an embedded ICC color profile* (likely Display-P3 or another wide-gamut color space), (2) Chrome fully honors ICC profiles and performs proper color management (3) Desktop image viewers often ignore or approximate ICC profiles to keep things simple.</p><p>Result: Chrome shows you what the image <em>actually</em> looks like according to its embedded profile, while desktop apps (and apparently Safari) show you a “helpful lie”.</p><p>The paintings came from the internet, likely screenshots from macOS, iOS,
or modern web tools that default to the Display-P3 color space. The
pixel values are encoded for Display-P3, but when Chrome renders them,
it respects that color space. Desktop apps? They just assume sRGB and
move on.</p><p>You don&#39;t want to <em>strip</em> the ICC profile, that would leave Display-P3
pixel values being interpreted as sRGB, making things worse. You need to
<em>convert</em> the pixels to sRGB:</p><div><div><pre tabindex="0"><code data-lang="sh"><span><span>magick mogrify -profile /System/Library/ColorSync/Profiles/sRGB<span>\ </span>Profile.icc *.png</span></span></code></pre></div></div><p>This command does three things: 1. Reads the embedded ICC profile 2.
Converts the pixel values from that color space to sRGB 3. Embeds a
correct sRGB ICC profile</p><p>After running this, Chrome will display the images correctly, matching
what you saw in your desktop apps all along.</p><p>Unironically we&#39;re living in a world where modern devices support Display-P3, DCI-P3, and other wider color spaces but some apps do full color management, others fake it.</p><p>The “helpful lies” that desktop image viewers tell you (ignoring ICC profiles, making assumptions about color space) work great until you need actual color accuracy. Then they break down.</p><p>Takeaways:</p><ol><li>Chrome was not wrong. it&#39;s doing proper color management by respecting the embedded ICC profile</li><li>Desktop apps might lie. they ignore color profiles to avoid confusion, but this masks the real issue</li><li>Identify might mislead you. the “Gamma” value it reports is often ImageMagick&#39;s assumption, not file metadata</li><li>Convert, don&#39;t strip. When dealing with ICC profiles, you must convert pixel values to the target color space, not just remove the
profile</li></ol><p>#<a href="https://lr0.org/blog/t/programming/">Programming</a></p></div></div>
  </body>
</html>
