<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/racket/zuo">Original</a>
    <h1>Zuo: A Tiny Racket for Scripting</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto">This is a mirror of the Zuo sources in the <code>racket/src/zuo</code> directory of
<a href="https://github.com/racket/racket">the Racket repository</a>.</p>

<p dir="auto">You should use Racket to write scripts. But what if you need something
much smaller than Racket for some reason â€” or what if you&#39;re trying
to script a build of Racket itself? Zuo is a tiny Racket with
primitives for dealing with files and running processes, and it comes
with a <code>make</code>-like embedded DSL.</p>
<p dir="auto">Zuo is a Racket variant in the sense that program files start with
<code>#lang</code>, and the module path after <code>#lang</code> determines the parsing and
expansion of the file content. That&#39;s how the <code>make</code>-like DSL is
defined, and even the base Zuo language is defined by layers of
<code>#lang</code>s. One of the early layers implements macros.</p>
<h2 dir="auto"><a id="user-content-some-example-scripts" aria-hidden="true" href="#some-example-scripts"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Some Example Scripts</h2>
<p dir="auto">See <a href="https://github.com/racket/zuo/blob/main/local/hello.zuo"><code>local/hello.zuo</code></a>,
<a href="https://github.com/racket/zuo/blob/main/local/tree.zuo"><code>local/tree.zuo</code></a>,
<a href="https://github.com/racket/zuo/blob/main/local/image.zuo"><code>local/image.zuo</code></a>, and
<a href="https://github.com/racket/zuo/blob/main/build.zuo"><code>build.zuo</code></a>.</p>
<h2 dir="auto"><a id="user-content-building-and-running-zuo" aria-hidden="true" href="#building-and-running-zuo"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Building and Running Zuo</h2>
<p dir="auto">Compile <code>zuo.c</code> with a C compiler. No additional are files needed,
other than system and C library headers. No compiler flags should be
needed, although flags like <code>-o zuo</code> or <code>-O2</code> are a good idea.</p>
<p dir="auto">You can also use <code>configure</code>, <code>make</code>, and <code>make install</code>, where <code>make</code>
targets mostly invoke a Zuo script after compiling <code>zuo.c</code>. If you
don&#39;t use <code>configure</code> but compile to <code>zuo</code> in the current directory,
then <code>./zuo build.zuo</code> and <code>./zuo build.zuo install</code> (omit the <code>./</code> on Windows)
will do the same thing as <code>make</code> and <code>make install</code> with a default
configuration.</p>
<p dir="auto">The Zuo executable runs only modules. If you run Zuo with no
command-line arguments, then it loads <code>main.zuo</code>. Otherwise, the first
argument to Zuo is a file to run or a directory containing a
<code>main.zuo</code> to run, and additional arguments are delivered to that Zuo
program via the <code>runtime-env</code> procedure. Running the command
<code>./zuo build install</code>, for example, runs the <code>build/main.zuo</code> program
with the argument <code>install</code>. Whatever initial script is run, if it has
a <code>main</code> submodule, that submodule is also run.</p>
<h2 dir="auto"><a id="user-content-library-modules-and-startup-performance" aria-hidden="true" href="#library-modules-and-startup-performance"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Library Modules and Startup Performance</h2>
<p dir="auto">Except for the built-in <code>zuo/kernel</code> language module, Zuo finds
languages and modules through a collection of libraries. By default,
Zuo looks for a directory <code>lib</code> relative to the executable as the root
of the library-collection tree. You can supply an alternate collection
path with the <code>-X</code> command-line flag.</p>
<p dir="auto">You can also create an instance of Zuo with a set of libraries
embedded as a heap image. Embedding a heap image has two advantages:</p>
<ul dir="auto">
<li>
<p dir="auto">No extra directory of library modules is necessary.</p>
</li>
<li>
<p dir="auto">Zuo can start especially quickly, competitive with the fastest
command-line programs.</p>
</li>
</ul>
<p dir="auto">The <code>local/image.zuo</code> script generates a <code>.c</code> file that is a copy of
<code>zuo.c</code> plus embedded modules. By default, the <code>zuo</code> module and its
dependencies are included, but you can specify others with <code>++lib</code>. In
addition, the default collection-root path is disabled in the
generated copy, unless you supply <code>--keep-collects</code> to
<code>local/image.zuo</code>.</p>
<p dir="auto">When you use <code>configure</code> and <code>make</code> or <code>./zuo build.zuo</code>, the default
build target creates a <code>to-run/zuo</code> that embeds the <code>zuo</code> library, as
well as a <code>to-install/zuo</code> that has the right internal path to find
other libraries after <code>make install</code> or <code>./zuo build.zuo install</code>.</p>
<p dir="auto">You can use heap images without embedding. The <code>dump-heap-and-exit</code>
Zuo kernel permitive creates a heap image, and a <code>-B</code> or <code>--boot</code>
command-line flag for Zuo uses the given boot image on startup.</p>
<p dir="auto">A boot image is machine-independent, whether in a stand-alone file or
embedded in <code>.c</code> source.</p>
<h2 dir="auto"><a id="user-content-embedding-zuo-in-another-application" aria-hidden="true" href="#embedding-zuo-in-another-application"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Embedding Zuo in Another Application</h2>
<p dir="auto">Zuo can be embedded in a larger application, with or without an
embedded boot image. To support embedding, compile <code>zuo.c</code> or the
output of <code>local/image.zuo</code> with the <code>ZUO_EMBEDDED</code> preprocessor macro
defined (to anything); the <code>zuo.h</code> header will be used in that case,
and <code>zuo.h</code> should also be used by the embedding application.
Documentation for the embedding API is provided as comments within
<code>zuo.h</code>.</p>
<h2 dir="auto"><a id="user-content-more-information" aria-hidden="true" href="#more-information"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>More Information</h2>
<p dir="auto">Install the <code>zuo-doc</code> directory as a package in Racket to render the
documentation there.</p>
</article>
          </div></div>
  </body>
</html>
