<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/xai-org/x-algorithm">Original</a>
    <h1>X For You Feed Algorithm</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">This repository contains the core recommendation system powering the &#34;For You&#34; feed on X. It combines in-network content (from accounts you follow) with out-of-network content (discovered through ML-based retrieval) and ranks everything using a Grok-based transformer model.</p>
<blockquote>
<p dir="auto"><strong>Note:</strong> The transformer implementation is ported from the <a href="https://github.com/xai-org/grok-1">Grok-1 open source release</a> by xAI, adapted for recommendation system use cases.</p>
</blockquote>

<ul dir="auto">
<li><a href="#overview">Overview</a></li>
<li><a href="#system-architecture">System Architecture</a></li>
<li><a href="#components">Components</a>
<ul dir="auto">
<li><a href="#home-mixer">Home Mixer</a></li>
<li><a href="#thunder">Thunder</a></li>
<li><a href="#phoenix">Phoenix</a></li>
<li><a href="#candidate-pipeline">Candidate Pipeline</a></li>
</ul>
</li>
<li><a href="#how-it-works">How It Works</a>
<ul dir="auto">
<li><a href="#pipeline-stages">Pipeline Stages</a></li>
<li><a href="#scoring-and-ranking">Scoring and Ranking</a></li>
<li><a href="#filtering">Filtering</a></li>
</ul>
</li>
<li><a href="#key-design-decisions">Key Design Decisions</a></li>
<li><a href="#license">License</a></li>
</ul>
<hr/>

<p dir="auto">The For You feed algorithm retrieves, ranks, and filters posts from two sources:</p>
<ol dir="auto">
<li><strong>In-Network (Thunder)</strong>: Posts from accounts you follow</li>
<li><strong>Out-of-Network (Phoenix Retrieval)</strong>: Posts discovered from a global corpus</li>
</ol>
<p dir="auto">Both sources are combined and ranked together using <strong>Phoenix</strong>, a Grok-based transformer model that predicts engagement probabilities for each post. The final score is a weighted combination of these predicted engagements.</p>
<p dir="auto">We have eliminated every single hand-engineered feature and most heuristics from the system. The Grok-based transformer does all the heavy lifting by understanding your engagement history (what you liked, replied to, shared, etc.) and using that to determine what content is relevant to you.</p>
<hr/>

<div data-snippet-clipboard-copy-content="┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    FOR YOU FEED REQUEST                                     │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                         HOME MIXER                                          │
│                                    (Orchestration Layer)                                    │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                   QUERY HYDRATION                                   │   │
│   │  ┌──────────────────────────┐    ┌──────────────────────────────────────────────┐   │   │
│   │  │ User Action Sequence     │    │ User Features                                │   │   │
│   │  │ (engagement history)     │    │ (following list, preferences, etc.)          │   │   │
│   │  └──────────────────────────┘    └──────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                  CANDIDATE SOURCES                                  │   │
│   │         ┌─────────────────────────────┐    ┌────────────────────────────────┐       │   │
│   │         │        THUNDER              │    │     PHOENIX RETRIEVAL          │       │   │
│   │         │    (In-Network Posts)       │    │   (Out-of-Network Posts)       │       │   │
│   │         │                             │    │                                │       │   │
│   │         │  Posts from accounts        │    │  ML-based similarity search    │       │   │
│   │         │  you follow                 │    │  across global corpus          │       │   │
│   │         └─────────────────────────────┘    └────────────────────────────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                      HYDRATION                                      │   │
│   │  Fetch additional data: core post metadata, author info, media entities, etc.       │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                      FILTERING                                      │   │
│   │  Remove: duplicates, old posts, self-posts, blocked authors, muted keywords, etc.   │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                       SCORING                                       │   │
│   │  ┌──────────────────────────┐                                                       │   │
│   │  │  Phoenix Scorer          │    Grok-based Transformer predicts:                   │   │
│   │  │  (ML Predictions)        │    P(like), P(reply), P(repost), P(click)...          │   │
│   │  └──────────────────────────┘                                                       │   │
│   │               │                                                                     │   │
│   │               ▼                                                                     │   │
│   │  ┌──────────────────────────┐                                                       │   │
│   │  │  Weighted Scorer         │    Weighted Score = Σ (weight × P(action))            │   │
│   │  │  (Combine predictions)   │                                                       │   │
│   │  └──────────────────────────┘                                                       │   │
│   │               │                                                                     │   │
│   │               ▼                                                                     │   │
│   │  ┌──────────────────────────┐                                                       │   │
│   │  │  Author Diversity        │    Attenuate repeated author scores                   │   │
│   │  │  Scorer                  │    to ensure feed diversity                           │   │
│   │  └──────────────────────────┘                                                       │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                      SELECTION                                      │   │
│   │                    Sort by final score, select top K candidates                     │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                              FILTERING (Post-Selection)                             │   │
│   │                 Visibility filtering (deleted/spam/violence/gore etc)               │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                     RANKED FEED RESPONSE                                    │
└─────────────────────────────────────────────────────────────────────────────────────────────┘"><pre><code>┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                    FOR YOU FEED REQUEST                                     │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                         HOME MIXER                                          │
│                                    (Orchestration Layer)                                    │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                   QUERY HYDRATION                                   │   │
│   │  ┌──────────────────────────┐    ┌──────────────────────────────────────────────┐   │   │
│   │  │ User Action Sequence     │    │ User Features                                │   │   │
│   │  │ (engagement history)     │    │ (following list, preferences, etc.)          │   │   │
│   │  └──────────────────────────┘    └──────────────────────────────────────────────┘   │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                  CANDIDATE SOURCES                                  │   │
│   │         ┌─────────────────────────────┐    ┌────────────────────────────────┐       │   │
│   │         │        THUNDER              │    │     PHOENIX RETRIEVAL          │       │   │
│   │         │    (In-Network Posts)       │    │   (Out-of-Network Posts)       │       │   │
│   │         │                             │    │                                │       │   │
│   │         │  Posts from accounts        │    │  ML-based similarity search    │       │   │
│   │         │  you follow                 │    │  across global corpus          │       │   │
│   │         └─────────────────────────────┘    └────────────────────────────────┘       │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                      HYDRATION                                      │   │
│   │  Fetch additional data: core post metadata, author info, media entities, etc.       │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                      FILTERING                                      │   │
│   │  Remove: duplicates, old posts, self-posts, blocked authors, muted keywords, etc.   │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                       SCORING                                       │   │
│   │  ┌──────────────────────────┐                                                       │   │
│   │  │  Phoenix Scorer          │    Grok-based Transformer predicts:                   │   │
│   │  │  (ML Predictions)        │    P(like), P(reply), P(repost), P(click)...          │   │
│   │  └──────────────────────────┘                                                       │   │
│   │               │                                                                     │   │
│   │               ▼                                                                     │   │
│   │  ┌──────────────────────────┐                                                       │   │
│   │  │  Weighted Scorer         │    Weighted Score = Σ (weight × P(action))            │   │
│   │  │  (Combine predictions)   │                                                       │   │
│   │  └──────────────────────────┘                                                       │   │
│   │               │                                                                     │   │
│   │               ▼                                                                     │   │
│   │  ┌──────────────────────────┐                                                       │   │
│   │  │  Author Diversity        │    Attenuate repeated author scores                   │   │
│   │  │  Scorer                  │    to ensure feed diversity                           │   │
│   │  └──────────────────────────┘                                                       │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                                      SELECTION                                      │   │
│   │                    Sort by final score, select top K candidates                     │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                              │                                              │
│                                              ▼                                              │
│   ┌─────────────────────────────────────────────────────────────────────────────────────┐   │
│   │                              FILTERING (Post-Selection)                             │   │
│   │                 Visibility filtering (deleted/spam/violence/gore etc)               │   │
│   └─────────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                             │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
                                               │
                                               ▼
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                     RANKED FEED RESPONSE                                    │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<hr/>


<p dir="auto"><strong>Location:</strong> <a href="https://github.com/xai-org/x-algorithm/blob/main/home-mixer"><code>home-mixer/</code></a></p>
<p dir="auto">The orchestration layer that assembles the For You feed. It leverages the <code>CandidatePipeline</code> framework with the following stages:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Stage</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Query Hydrators</td>
<td>Fetch user context (engagement history, following list)</td>
</tr>
<tr>
<td>Sources</td>
<td>Retrieve candidates from Thunder and Phoenix</td>
</tr>
<tr>
<td>Hydrators</td>
<td>Enrich candidates with additional data</td>
</tr>
<tr>
<td>Filters</td>
<td>Remove ineligible candidates</td>
</tr>
<tr>
<td>Scorers</td>
<td>Predict engagement and compute final scores</td>
</tr>
<tr>
<td>Selector</td>
<td>Sort by score and select top K</td>
</tr>
<tr>
<td>Post-Selection Filters</td>
<td>Final visibility and dedup checks</td>
</tr>
<tr>
<td>Side Effects</td>
<td>Cache request info for future use</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">The server exposes a gRPC endpoint (<code>ScoredPostsService</code>) that returns ranked posts for a given user.</p>
<hr/>

<p dir="auto"><strong>Location:</strong> <a href="https://github.com/xai-org/x-algorithm/blob/main/thunder"><code>thunder/</code></a></p>
<p dir="auto">An in-memory post store and realtime ingestion pipeline that tracks recent posts from all users. It:</p>
<ul dir="auto">
<li>Consumes post create/delete events from Kafka</li>
<li>Maintains per-user stores for original posts, replies/reposts, and video posts</li>
<li>Serves &#34;in-network&#34; post candidates from accounts the requesting user follows</li>
<li>Automatically trims posts older than the retention period</li>
</ul>
<p dir="auto">Thunder enables sub-millisecond lookups for in-network content without hitting an external database.</p>
<hr/>

<p dir="auto"><strong>Location:</strong> <a href="https://github.com/xai-org/x-algorithm/blob/main/phoenix"><code>phoenix/</code></a></p>
<p dir="auto">The ML component with two main functions:</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">1. Retrieval (Two-Tower Model)</h4><a id="user-content-1-retrieval-two-tower-model" aria-label="Permalink: 1. Retrieval (Two-Tower Model)" href="#1-retrieval-two-tower-model"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Finds relevant out-of-network posts:</p>
<ul dir="auto">
<li><strong>User Tower</strong>: Encodes user features and engagement history into an embedding</li>
<li><strong>Candidate Tower</strong>: Encodes all posts into embeddings</li>
<li><strong>Similarity Search</strong>: Retrieves top-K posts via dot product similarity</li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">2. Ranking (Transformer with Candidate Isolation)</h4><a id="user-content-2-ranking-transformer-with-candidate-isolation" aria-label="Permalink: 2. Ranking (Transformer with Candidate Isolation)" href="#2-ranking-transformer-with-candidate-isolation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Predicts engagement probabilities for each candidate:</p>
<ul dir="auto">
<li>Takes user context (engagement history) and candidate posts as input</li>
<li>Uses special attention masking so candidates cannot attend to each other</li>
<li>Outputs probabilities for each action type (like, reply, repost, click, etc.)</li>
</ul>
<p dir="auto">See <a href="https://github.com/xai-org/x-algorithm/blob/main/phoenix/README.md"><code>phoenix/README.md</code></a> for detailed architecture documentation.</p>
<hr/>

<p dir="auto"><strong>Location:</strong> <a href="https://github.com/xai-org/x-algorithm/blob/main/candidate-pipeline"><code>candidate-pipeline/</code></a></p>
<p dir="auto">A reusable framework for building recommendation pipelines. Defines traits for:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Trait</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Source</code></td>
<td>Fetch candidates from a data source</td>
</tr>
<tr>
<td><code>Hydrator</code></td>
<td>Enrich candidates with additional features</td>
</tr>
<tr>
<td><code>Filter</code></td>
<td>Remove candidates that shouldn&#39;t be shown</td>
</tr>
<tr>
<td><code>Scorer</code></td>
<td>Compute scores for ranking</td>
</tr>
<tr>
<td><code>Selector</code></td>
<td>Sort and select top candidates</td>
</tr>
<tr>
<td><code>SideEffect</code></td>
<td>Run async side effects (caching, logging)</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto">The framework runs sources and hydrators in parallel where possible, with configurable error handling and logging.</p>
<hr/>


<ol dir="auto">
<li>
<p dir="auto"><strong>Query Hydration</strong>: Fetch the user&#39;s recent engagements history and metadata (eg. following list)</p>
</li>
<li>
<p dir="auto"><strong>Candidate Sourcing</strong>: Retrieve candidates from:</p>
<ul dir="auto">
<li><strong>Thunder</strong>: Recent posts from followed accounts (in-network)</li>
<li><strong>Phoenix Retrieval</strong>: ML-discovered posts from the global corpus (out-of-network)</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Candidate Hydration</strong>: Enrich candidates with:</p>
<ul dir="auto">
<li>Core post data (text, media, etc.)</li>
<li>Author information (username, verification status)</li>
<li>Video duration (for video posts)</li>
<li>Subscription status</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Pre-Scoring Filters</strong>: Remove posts that are:</p>
<ul dir="auto">
<li>Duplicates</li>
<li>Too old</li>
<li>From the viewer themselves</li>
<li>From blocked/muted accounts</li>
<li>Containing muted keywords</li>
<li>Previously seen or recently served</li>
<li>Ineligible subscription content</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Scoring</strong>: Apply multiple scorers sequentially:</p>
<ul dir="auto">
<li><strong>Phoenix Scorer</strong>: Get ML predictions from the Phoenix transformer model</li>
<li><strong>Weighted Scorer</strong>: Combine predictions into a final relevance score</li>
<li><strong>Author Diversity Scorer</strong>: Attenuate repeated author scores for diversity</li>
<li><strong>OON Scorer</strong>: Adjust scores for out-of-network content</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Selection</strong>: Sort by score and select the top K candidates</p>
</li>
<li>
<p dir="auto"><strong>Post-Selection Processing</strong>: Final validation of post candidates to be served</p>
</li>
</ol>
<hr/>

<p dir="auto">The Phoenix Grok-based transformer model predicts probabilities for multiple engagement types:</p>
<div data-snippet-clipboard-copy-content="Predictions:
├── P(favorite)
├── P(reply)
├── P(repost)
├── P(quote)
├── P(click)
├── P(profile_click)
├── P(video_view)
├── P(photo_expand)
├── P(share)
├── P(dwell)
├── P(follow_author)
├── P(not_interested)
├── P(block_author)
├── P(mute_author)
└── P(report)"><pre><code>Predictions:
├── P(favorite)
├── P(reply)
├── P(repost)
├── P(quote)
├── P(click)
├── P(profile_click)
├── P(video_view)
├── P(photo_expand)
├── P(share)
├── P(dwell)
├── P(follow_author)
├── P(not_interested)
├── P(block_author)
├── P(mute_author)
└── P(report)
</code></pre></div>
<p dir="auto">The <strong>Weighted Scorer</strong> combines these into a final score:</p>
<div data-snippet-clipboard-copy-content="Final Score = Σ (weight_i × P(action_i))"><pre><code>Final Score = Σ (weight_i × P(action_i))
</code></pre></div>
<p dir="auto">Positive actions (like, repost, share) have positive weights. Negative actions (block, mute, report) have negative weights, pushing down content the user would likely dislike.</p>
<hr/>

<p dir="auto">Filters run at two stages:</p>
<p dir="auto"><strong>Pre-Scoring Filters:</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Filter</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DropDuplicatesFilter</code></td>
<td>Remove duplicate post IDs</td>
</tr>
<tr>
<td><code>CoreDataHydrationFilter</code></td>
<td>Remove posts that failed to hydrate core metadata</td>
</tr>
<tr>
<td><code>AgeFilter</code></td>
<td>Remove posts older than threshold</td>
</tr>
<tr>
<td><code>SelfpostFilter</code></td>
<td>Remove user&#39;s own posts</td>
</tr>
<tr>
<td><code>RepostDeduplicationFilter</code></td>
<td>Dedupe reposts of same content</td>
</tr>
<tr>
<td><code>IneligibleSubscriptionFilter</code></td>
<td>Remove paywalled content user can&#39;t access</td>
</tr>
<tr>
<td><code>PreviouslySeenPostsFilter</code></td>
<td>Remove posts user has already seen</td>
</tr>
<tr>
<td><code>PreviouslyServedPostsFilter</code></td>
<td>Remove posts already served in session</td>
</tr>
<tr>
<td><code>MutedKeywordFilter</code></td>
<td>Remove posts with user&#39;s muted keywords</td>
</tr>
<tr>
<td><code>AuthorSocialgraphFilter</code></td>
<td>Remove posts from blocked/muted authors</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><strong>Post-Selection Filters:</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Filter</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>VFFilter</code></td>
<td>Remove posts that are deleted/spam/violence/gore etc.</td>
</tr>
<tr>
<td><code>DedupConversationFilter</code></td>
<td>Deduplicate multiple branches of the same conversation thread</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr/>

<div dir="auto"><h3 tabindex="-1" dir="auto">1. No Hand-Engineered Features</h3><a id="user-content-1-no-hand-engineered-features" aria-label="Permalink: 1. No Hand-Engineered Features" href="#1-no-hand-engineered-features"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The system relies entirely on the Grok-based transformer to learn relevance from user engagement sequences. No manual feature engineering for content relevance. This significantly reduces the complexity in our data pipelines and serving infrastructure.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">2. Candidate Isolation in Ranking</h3><a id="user-content-2-candidate-isolation-in-ranking" aria-label="Permalink: 2. Candidate Isolation in Ranking" href="#2-candidate-isolation-in-ranking"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">During transformer inference, candidates cannot attend to each other—only to the user context. This ensures the score for a post doesn&#39;t depend on which other posts are in the batch, making scores consistent and cacheable.</p>

<p dir="auto">Both retrieval and ranking use multiple hash functions for embedding lookup</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">4. Multi-Action Prediction</h3><a id="user-content-4-multi-action-prediction" aria-label="Permalink: 4. Multi-Action Prediction" href="#4-multi-action-prediction"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Rather than predicting a single &#34;relevance&#34; score, the model predicts probabilities for many actions.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">5. Composable Pipeline Architecture</h3><a id="user-content-5-composable-pipeline-architecture" aria-label="Permalink: 5. Composable Pipeline Architecture" href="#5-composable-pipeline-architecture"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The <code>candidate-pipeline</code> crate provides a flexible framework for building recommendation pipelines with:</p>
<ul dir="auto">
<li>Separation of pipeline execution and monitoring from business logic</li>
<li>Parallel execution of independent stages and graceful error handling</li>
<li>Easy addition of new sources, hydrations, filters, and scorers</li>
</ul>
<hr/>

<p dir="auto">This project is licensed under the Apache License 2.0. See <a href="https://github.com/xai-org/x-algorithm/blob/main/LICENSE">LICENSE</a> for details.</p>
</article></div></div>
  </body>
</html>
