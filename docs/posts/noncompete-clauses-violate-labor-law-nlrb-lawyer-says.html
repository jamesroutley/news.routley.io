<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.wsj.com/articles/noncompete-clauses-violate-labor-law-nlrb-lawyer-says-459fc081">Original</a>
    <h1>Noncompete clauses violate labor law, NLRB lawyer says</h1>
    
    <div id="readability-page-1" class="page"><article>
    

    <p><strong>Monday, May 29, 2023</strong></p>

    <p>A lot of applications treat your email address as something immutable that is linked to you and which will never change. It can&#39;t be linked to someone else, and it can&#39;t change.</p>
<p>This is, of course, not true. Email addresses <em>do</em> change. I changed my work email address recently (associated with the same account) and let me tell you: almost no software handled it correctly.</p>
<p>This is the story of how badly applications handled this, how a surprising application handled it perfectly, and how you should handle this in your own code.</p>

<p>I&#39;ve held this job for about six years, and recently announced a name change at work. Everyone has been great about it, and our IT admin immediately started helping me get my name changed across all of our internal systems.</p>
<p>We started with Google, so my email address would match my new name. This was easy: GSuite has a separation of email address from the account itself, and my email address was updated. My old name was setup as an alias, so anyone or any systems with the old address could still reach me.</p>
<p>The fun ended there, though. I use Notion extensively in my work. As a Principal Engineer, a lot of my job is writing and reading documents, after all. So what would you know when I went to sign into Notion?</p>
<p>It send me through the onboarding flow again! It&#39;s setup to use our Google systems as a SAML identity provider, and helpfully thought &#34;oh hey, Nicole, nice to meet you, lemme get you an account!&#34; The problem is, I <em>had</em> an account. And now there&#39;s a new, partially configured one, for this email address that didn&#39;t exist before.</p>
<p>What we had to do to resolve it was complete the new onboarding flow, delete the new Notion account, log out, update my Google email to be my deadname email again with an alias for my name, log into Notion with deadname email, update my email to the new one via my Notion settings (this could not be done by the workspace owner or admin, only by me as the user), confirm it via the alias forwarding to my email, log out, switch my Google account back, then log in using the usual SAML login mechanism.</p>
<p>Sigh. It took us a couple of hours to figure that one out and get me back in.</p>
<p>Then there was Slack. I was logged in still for a while, but when I logged out, and tried to log back in, I ran into that same problem: it made me a new account, gross. I don&#39;t remember what exactly we did to resolve it, but they were able to get me back into my account pretty quickly--but the new one still was hanging out. And that new one could only be deleted by the Slack workspace owner, so there were a few hours until that one was cleaned up where there were two of me.</p>
<p>Datadog was a fun one. We got my account updated sort of. Using username and password login instead of SSO, I could get in, but could not update my email address or name since those had been pulled in via SSO, but not updated via the same mechanism. This one had to go through their support channels to get fixed.</p>
<p>Myriad other systems were just like this. It was an absolute mess to figure out what exactly needed to be changed and how it would impact everything else. Apparently when my email address was updated in our HR and payroll system, it created a lot of background work, too. Not as visible to me, but it sure did screw up some systems for a hot second.</p>
<p>And this brings us to the unexpected hero of the hour: Jira. The software we all love to hate, but on this day, it was my knight in shining armor. When all the other accounts were like &#34;oh hey, new email who dis&#34;, Jira just rolled with it. It noticed that I was logging in as the same identity but with a new email address, and it updated the email on my account automatically. With no fuss. And it let me know that it did it without deadnaming me, either.</p>
<p>Oh my god, whatever engineers at Atlassian implemented that so well: I <em>love you</em>, and I have mad respect for your dilligence in your implementation.</p>

<p>So, why did all these systems mess up so badly? And why was Jira&#39;s experience so smooth?</p>
<p>It just comes down to what they use as the primary identifier of an identity. Notion, Slack, all these systems, when you log in via SAML they use your email address as your primary identifier. (If I have to guess, this is because their systems evolved from ones that used email/password for logins, but they never broke apart that dependency.)</p>
<p>But that&#39;s not how SAML works. When you log in with SAML, the identity provider gives some claims<sup><a href="#1">1</a></sup>. One that it provides is the NameID, inside of Subject. This is usually something abstract, and it should be unchanging. It&#39;s a reliable way to tell if a login comes from the same person or not. On the other hand, they also include an email attribute. But this can change, and when it does... you get some weird issues if you assumed it was immutable.</p>
<p>What Atlassian/Jira is doing right is that they&#39;re actually using a static identifier to identify you, rather than your email address. This allows an incredibly smooth experience when any aspects of your attributes (such as email or name) change.</p>
<p>If you&#39;re responsible for login systems, you should decouple identity from attributes and other identifiers, since those are not as constant as you may think. Email addresses and names and phone numbers all change over time. And there&#39;s probably some security risk here, too--if you just blindly trust the email provided on the claims, I have to imagine that opens you up to some sort of impersonation attack that would be harder if you have to have the actual identity on the account itself.</p>
<p>Ultimately, if your system decouples identity from attributes and login methods, the entire system will be better designed and able to accommodate a better user experience. Updating attributes will be easier. Migrations of a company domain become possible. Having multiple login methods is natural and painless. Security posture improves. It&#39;s a win all around.</p>
<p>So please, let&#39;s stop assuming names and email addresses don&#39;t change.
And if you do have to change your name and email: good luck, and hang in there.</p>
<hr/>
<div id="1"><p><sup>1</sup></p><p><a href="https://www.samltool.com/generic_sso_res.php">This site</a> has an example of an IdP response, which is helpful for seeing what data comes back and in what form.</p>
</div>
<hr/>
<p>Post notes: This one was pretty easy to write because it came from personal experience and it&#39;s something where I&#39;ve seen the technical side as well. I didn&#39;t implement SAML for us but kept guiderails on the implementation as one of our senior engineers did the hard work of implementation.</p>
<p>But it is emotionally a little harder as I get ready to publish it. My name change is from a very personal part of me and from a recognition of my own identity. This one is baring a little bit of my soul, but through a lens of technical systems.</p>

  </article><p>
    If this post was enjoyable or useful for you, <strong>please share it!</strong>
    If you have comments, questions, or feedback, please email <a href="mailto:~ntietz/public-inbox@lists.sr.ht">my public inbox</a> or <a href="mailto:me@ntietz.com">my personal email</a>.
    To get new posts, please use my <a href="https://ntietz.com/atom.xml">RSS feed</a>.
  </p></div>
  </body>
</html>
