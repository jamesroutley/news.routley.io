<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://rachelbythebay.com/w/2024/02/21/bcast/">Original</a>
    <h1>A vintage network attack called smurf</h1>
    
    
<p>
In the vein of my
<a href="https://rachelbythebay.com/w/2018/12/26/flash/">&#34;flash&#34; story</a>
from a few years ago, here&#39;s one about &#34;smurf&#34;.
</p>
<p>
Back around 1997, there was something new going around in the realm of 
net abuse: &#34;smurfing&#34; a target.  This one involved a nice little trick 
that let you send out a relatively small amount of traffic and let 
someone else turn it into a much larger amount of traffic, and then that 
response would be directed onto your target.
</p>
<p>
This required two bits of cooperation from the environment.  First, you 
had to be able to transmit a packet of some sort with the source address 
set to your target.  Yes, this does mean &#34;spoofing&#34; the source address, 
and any responsible ISP should filter that nonsense on egress, but back 
then it was all too infrequent.
</p>
<p>
Then, you also had to send it to either the network or the broadcast 
address of some particularly juicy network that was laden with hosts 
that would reply to that sort of thing.
</p>
<p>
For example, let&#39;s say you had a network 192.0.2.0 with the netmask 
255.255.255.0 (a /24).  Then in that case, .0 would be the network and 
.255 would be the broadcast address.  Back in those days, firing a 
packet at either of those would usually make the router spew it out to 
the *Ethernet* broadcast address, and so it would hit every host on that 
subnet which could then decide to reply or not.
</p>
<p>
So, just imagine a packet &#34;from&#34; your target, seemingly addressed to 
dozens or hundreds of machines, which then all answer at once.  The 
attacker sends out a single ~1500 byte ping (for example), and the 
victim receives that multiplied by however many hosts decide to reply 
- not great!
</p>
<p>
There were some things which could be done about this.  Routers 
eventually got a config knob that let you turn off &#34;directed-broadcast&#34; 
or similar, so anything arriving from the outside for a network or 
broadcast address would just be dropped on the floor.  Unix boxes of 
different flavors also started gaining the ability to have packet 
filtering rules.  (This took far too long in some cases.)
</p>
<p>
Besides that, people running networks could follow various best 
practices and not let traffic that&#39;s claiming to be from somewhere else 
in the world egress from their network.  Any packet like that is either 
a misconfiguration on someone&#39;s part (possibly yours), or maybe some 
dummy trying to attack someone else.  Either way, it needs to be 
tracked down and dealt with.
</p>
<p>
Sometimes people would use this kind of stuff as a reason to &#34;block all 
ICMP&#34;, and then they would just
<a href="https://rachelbythebay.com/w/2015/05/15/pmtud/">create other problems</a>
like breaking path MTU discovery, and that would cause connections to 
hang with large packets and weird non-Ethernet-MTU-sized links.
</p>
<p>
Another related attack tool back then was called &#34;fraggle&#34; and it did 
the same sort of directed-broadcast shenanigans, but which used UDP 
instead of ICMP.  The effect was the same, and it also got around 
anyone who thought that filtering all ICMP was somehow a good idea.
</p>
<p>
The old days weren&#39;t always good days.
</p>

  </body>
</html>
