<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.amolas.dev/blog/choose-the-smallest-number/">Original</a>
    <h1>Choose the smallest number not chosen yet</h1>
    
    <div id="readability-page-1" class="page"><div><p>If you know me you know I love games where you can apply maths to obtain the best strategy. I’ve written several posts about this kind of games (<a href="https://www.amolas.dev/blog/counterintuitive-coin-game/">coin game paradox</a>, <a href="https://www.amolas.dev/blog/feynman-restaurant-problem/">Feynman restaurant problem</a>, and <a href="https://www.amolas.dev/blog/continuous-blackjack-i/">continuous blackjack</a>). In today’s post, I’ll present another game of the same kind: select the smallest unique integer <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup>.</p><h2 id="problem-statement"><span>Problem Statement</span><a href="#problem-statement"><i></i></a></h2><p>Imagine a game where each contestant has to pick a positive integer, and the winner is the one who chose the smallest number that nobody else has chosen. Assuming that players do not cooperate, which is the optimal strategy to maximize your winning probability?</p><h2 id="solution"><span>Solution</span><a href="#solution"><i></i></a></h2><p>To simplify the problem, let’s start with the simple scenario where you are competing against two other persons. We’re not looking for a deterministic solution, like “you have to always choose 2”, but rather a probabilistic solution. This is, we want to assign to each integer a probability of being chosen. Let’s call \(p_i\) the probability of choosing the integer \(i\), and \(P = \{ p_1, p_2, ... \}\) the set of probabilities. Our strategy is determined by \(P\). From the definition of the game, it makes sense to find the <a href="https://en.wikipedia.org/wiki/Nash_equilibrium">Nash equilibrium</a>.</p><p>To start, assume that the other two players use the equilibrium probabilities \(P\), and that you choose the integer \(i\). Let’s call \(Q_*\) the probability of winning when following strategy \(*\). The probability that you win in this circumstance comes from two components: (1) both players choose the same number \(j\) and it’s smaller than \(i\), and (2) both players choose a number that’s bigger than \(i\). This is</p><p>\[Q_i = \sum_{n=1}^{i-1} P_n^2 + \left(1 - \sum_{n=1}^i P_n\right)^2\]</p><p>Since we’re looking for the Nash equilibrium we’ve \(Q_i \leq Q_P\), this is, the best winning strategy you have is to follow the strategy \(P\). However, on the other hand, the probability of winning if you follow strategy \(P\) is</p><p>\[Q_P = \sum_{i=1}^\infty p_i Q_i\]</p><p>so \(Q_P \leq \max_i Q_i\). So we have</p><p>\[\begin{cases} Q_i \leq Q_P \\ \max_i Q_i \geq Q_P \end{cases}\]</p><p>which implies that all \(Q_i\) should be equal. Putting all together, we get that the equilibrium strategy \(P\) is given by the set of equations</p><p>\[\begin{cases} \sum_{n=1}^\infty P_n = 1 \\ Q_1 = Q_2 = Q_3 = \ldots \end{cases}\]</p><p>where \(Q_i = \sum_{n=1}^{j-1} P_n^2 + \left(1 - \sum_{n=1}^j P_n\right)^2\).</p><p>AFAIK, it doesn’t exist a closed form for the probabilities \(P\), but in the next section, I’ll show how to get the probabilities using Python.</p><h3 id="numerical-solution"><span>Numerical solution</span><a href="#numerical-solution"><i></i></a></h3><p>Here’s a snippet that allows you to get the optimal probabilities</p><div><p><code><table><tbody><tr><td><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td><pre><span>from</span> <span>scipy.optimize</span> <span>import</span> <span>scipy</span>

<span>N_TRUNCATED</span> <span>=</span> <span>10</span> <span># max number of terms to consider in our sums
</span>
<span>def</span> <span>q</span><span>(</span><span>p</span><span>,</span> <span>j</span><span>):</span>
    <span>&#34;&#34;&#34;
    Probability of winning given that other 
    players use strategy `p` and you choose integer `j`.
    &#34;&#34;&#34;</span>
    <span>return</span> <span>sum</span><span>([</span><span>x</span><span>**</span><span>2</span> <span>for</span> <span>x</span> <span>in</span> <span>p</span><span>[</span><span>0</span><span>:</span><span>j</span><span>-</span><span>1</span><span>]])</span> <span>+</span> <span>(</span><span>1</span> <span>-</span> <span>sum</span><span>(</span><span>p</span><span>[</span><span>0</span><span>:</span><span>j</span><span>]))</span><span>**</span><span>2</span>

<span>def</span> <span>equations</span><span>(</span><span>p</span><span>):</span>
    <span>&#34;&#34;&#34;
    Given a set of probabilities `p` it returns the
    values of the equations to be solved.
    The equations are:
        [
            sum(p) - 1,
            q[i] - q[j]
        ]
    We want to find the values of `p` such that the 
    each equation is equal to 0.
    &#34;&#34;&#34;</span>
    <span>norm</span> <span>=</span> <span>sum</span><span>(</span><span>p</span><span>)</span> <span>-</span> <span>1</span>
    <span>eqs</span> <span>=</span> <span>[]</span>
    <span>for</span> <span>i</span> <span>in</span> <span>range</span><span>(</span><span>1</span><span>,</span> <span>len</span><span>(</span><span>p</span><span>)):</span>
        <span># for each integer add the equation `q[i] = q[i+1]`.
</span>        <span># this way we avoid to add redundant terms. 
</span>        <span># Instead of `q1=q2, q1=q3, q2=q3`
</span>        <span># use only `q1=q2, q2=q3`.
</span>        <span>qi</span> <span>=</span> <span>q</span><span>(</span><span>p</span><span>,</span> <span>i</span><span>)</span>
        <span>qj</span> <span>=</span> <span>q</span><span>(</span><span>p</span><span>,</span> <span>i</span><span>+</span><span>1</span><span>)</span>
        <span>eqs</span><span>.</span><span>append</span><span>(</span><span>qi</span> <span>-</span> <span>qj</span><span>)</span>
    <span>return</span> <span>(</span><span>norm</span><span>,</span> <span>*</span><span>eqs</span><span>)</span>

<span>solution</span> <span>=</span> <span>fsolve</span><span>(</span><span>equations</span><span>,</span> <span>x0</span><span>=</span><span>np</span><span>.</span><span>ones</span><span>(</span><span>N_TRUNCATED</span><span>)</span><span>/</span><span>N_TRUNCATED</span><span>)</span>
</pre></td></tr></tbody></table></code></p></div><p>Notice that in the analytical solution we’re performing infinite sums. Here we’re truncating the sums up to the first <code>N_TRUNCATED</code> terms. To solve the system of equations we use <code>scipy</code>, and we set an initial guess of \(P_0 = \{ \frac{1}{\text{N_TRUNCATED}},, ..., \frac{1}{\text{N_TRUNCATED}} \}\).</p><p>Using above snippet one gets the following probabilities</p><div><p><code><table><tbody><tr><td><pre>1
2
3
</pre></td><td><pre>|   1   |   2   |   3   |   4   |   5   |   6   |   7   |   8   |   9   | 10    |
|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|-------|
| 0.456 | 0.248 | 0.135 | 0.073 | 0.040 | 0.022 | 0.012 | 0.006 | 0.004 | 0.002 |
</pre></td></tr></tbody></table></code></p></div><p>So, the best strategy is to select randomly a number using the above probabilities. With such a strategy, the expected payoff is given by <code>q(solution, 1)</code>, and it’s \(\approx 0.296\). This means, that if we follow this strategy we’ll win a little bit less than one-third of the time.</p><h2 id="next-steps"><span>Next steps</span><a href="#next-steps"><i></i></a></h2><p>In this post, we have presented the smallest unique integer game and how to derive the optimal solution. In particular, we’ve used the Nash equilibrium to compute with which probability we should choose each integer. However, we’ve solved a simplified version of the problem, since we’ve been assuming that we’re playing against only two other persons. In the following posts, we’ll see how to generalize the arguments made here when playing against \(N\) other persons.</p><hr/></div><div><div><p> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</p></div></div></div>
  </body>
</html>
