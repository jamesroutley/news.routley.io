<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/pipelight/boulette">Original</a>
    <h1>Show HN: Boulette - Protect you from yourself (even as root).</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><em>It&#39;s late.</em> ðŸ¥±</p>
<p dir="auto"><em>You finish your night coding session by typing <code>shutdown -h now</code> in a terminal.</em></p>
<p dir="auto"><em>But nothing happens.</em></p>
<p dir="auto"><em>Because it&#39;s the wrong terminal.</em></p>
<p dir="auto"><em>And suddenly your production server is unreachable.</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/oh_la_boulette.jpg"><img src="https://github.com/pipelight/boulette/raw/main/public/images/oh_la_boulette.jpg" width="200"/></a></p>
<p dir="auto">Protect you from yourself.
Hop on the boulette train!</p>
<p dir="auto"><strong>Boulette prevents you from accidentally shutting down remote hosts</strong>
by raising a warning prompt on dangerous commands.
The prompt simply asks for user confirmation,
and can also enforce a challenge resolution to decide whether to resume(or abort) the command.</p>

<p dir="auto">Prefix a critical command with <code>boulette</code> and a confirmation prompt will show up.</p>
<div dir="auto" data-snippet-clipboard-copy-content="boulette &#34;shutdown -h now&#34;"><pre>boulette <span><span>&#34;</span>shutdown -h now<span>&#34;</span></span></pre></div>
<p dir="auto">Create an alias to replace the command with the <strong>bouletteproof</strong> one.
See the <a href="#write-aliases">Write aliases</a> section.</p>
<p dir="auto">And then safely use <code>shutdown</code> ðŸ˜Œ.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/example_shutdown.png"><img src="https://github.com/pipelight/boulette/raw/main/public/images/example_shutdown.png" alt="boulette prompt"/></a></p>

<p dir="auto">In order to execute the provided command you can choose between some challenges to be resolved:</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>ask</strong>, which is the default (<code>--challenge ask</code>). You have to type &#39;y&#39; or &#39;n&#39; to resume commande execution.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/ask_challenge.png"><img src="https://github.com/pipelight/boulette/raw/main/public/images/ask_challenge.png" alt="boulette prompt"/></a></p>
</li>
<li>
<p dir="auto"><strong>hostname</strong>, enable with <code>--challenge hostname</code>. You must type the host name to resume command execution.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/hostname_challenge.png"><img src="https://github.com/pipelight/boulette/raw/main/public/images/hostname_challenge.png" alt="boulette prompt"/></a></p>
</li>
<li>
<p dir="auto"><strong>numbers</strong>, with <code>--challenge numbers</code> You must type a random 6 number sequence to resume command execution.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/numbers_challenge.png"><img src="https://github.com/pipelight/boulette/raw/main/public/images/numbers_challenge.png" alt="boulette prompt"/></a></p>
</li>
<li>
<p dir="auto"><strong>characters</strong>, with <code>--challenge chars</code> You must type a random 6 character string (Lower case &#39;a&#39; to &#39;z&#39; [a-z]) to resume command execution.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/chars_challenge.png"><img src="https://github.com/pipelight/boulette/raw/main/public/images/chars_challenge.png" alt="boulette prompt"/></a></p>
</li>
</ul>

<p dir="auto">Boulette confirmation prompt can be triggered inside <strong>ssh session only</strong> thanks to the <code>--ssh-only</code> option.</p>
<p dir="auto">When aliasing a command <code>&lt;cmd&gt;</code> with <code>boulette &lt;cmd&gt;</code>, typing <code>&lt;cmd&gt;</code> will execute transparently in a local terminal,
and will only raise a prompt when executed from inside an ssh session.</p>
<div dir="auto" data-snippet-clipboard-copy-content="alias off=&#39;boulette &#34;shutdown -h now&#34;&#39; --ssh-only"><pre><span>alias</span> off=<span><span>&#39;</span>boulette &#34;shutdown -h now&#34;<span>&#39;</span></span> --ssh-only</pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/pipelight/boulette/blob/main/public/images/example_ssh.png"><img src="https://github.com/pipelight/boulette/raw/main/public/images/example_ssh.png" alt="boulette prompt"/></a></p>

<p dir="auto">The idea is to enforce a prompt on your most dangerous commands.
We can do so by creating aliases of those commands
and <strong>prefixing them with boulette</strong>.</p>

<p dir="auto">For example, setting the following alias,</p>
<div dir="auto" data-snippet-clipboard-copy-content="alias off=&#39;boulette &#34;shutdown -h now&#34;&#39; --ssh-only"><pre><span>alias</span> off=<span><span>&#39;</span>boulette &#34;shutdown -h now&#34;<span>&#39;</span></span> --ssh-only</pre></div>
<p dir="auto">will prompt you whenever you type <code>shutdown -h now</code>.</p>
<p dir="auto">Here are the one-liners I use the most frequently.</p>
<div dir="auto" data-snippet-clipboard-copy-content="alias off=&#39;boulette &#34;shutdown -h now&#34; --ssh-only --challenge hostname&#39;
alias sus=&#39;boulette &#34;systemctl suspend&#34; --ssh-only --challenge hostname&#39;
alias reboot=&#39;boulette reboot --ssh-only --challenge hostname&#39;"><pre><span>alias</span> off=<span><span>&#39;</span>boulette &#34;shutdown -h now&#34; --ssh-only --challenge hostname<span>&#39;</span></span>
<span>alias</span> sus=<span><span>&#39;</span>boulette &#34;systemctl suspend&#34; --ssh-only --challenge hostname<span>&#39;</span></span>
<span>alias</span> reboot=<span><span>&#39;</span>boulette reboot --ssh-only --challenge hostname<span>&#39;</span></span></pre></div>

<p dir="auto">You can also enable boulette on a command and its every subcommands.</p>
<p dir="auto">Let&#39;s say you want to protect yourself from <code>shutdown</code> command ant its
every options.
This way <code>shutdown -r</code>, <code>shutdown -h now</code> and others will also raise a warning prompt.</p>
<p dir="auto">Create a shell function to wrap the command call.</p>
<ul dir="auto">
<li>for bash and zsh shells</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="shutdown () {
  boulette &#34;shutdown $argv&#34; --ssh-only --challenge hostname
}"><pre><span>shutdown</span> () {
  boulette <span><span>&#34;</span>shutdown <span>$argv</span><span>&#34;</span></span> --ssh-only --challenge hostname
}</pre></div>
<ul dir="auto">
<li>for fish shell</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="function shutdown;
  boulette &#34;shutdown $argv&#34; --ssh-only --challenge hostname
end"><pre><span>function</span> shutdown;
  boulette <span><span>&#34;</span>shutdown <span>$argv</span><span>&#34;</span></span> <span>--ssh-only</span> <span>--challenge</span> hostname
<span>end</span></pre></div>

<p dir="auto">with cargo:</p>
<div dir="auto" data-snippet-clipboard-copy-content="cargo install --git https://github.com/pipelight/boulette
"><pre>cargo install --git https://github.com/pipelight/boulette
</pre></div>
<p dir="auto">with nix(flakes):</p>
<div dir="auto" data-snippet-clipboard-copy-content="nix-shell -p https://github.com/pipelight/boulette
"><pre>nix-shell -p https://github.com/pipelight/boulette
</pre></div>

<p dir="auto">You can display a usefull help message with minimal examples.</p>

<p dir="auto">Greatly inspired by <a href="https://salsa.debian.org/debian/molly-guard" rel="nofollow">Molly-guard</a>.</p>
</article></div></div>
  </body>
</html>
