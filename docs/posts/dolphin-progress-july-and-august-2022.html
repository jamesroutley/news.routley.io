<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://dolphin-emu.org/blog/2022/09/13/dolphin-progress-report-july-and-august-2022/">Original</a>
    <h1>Dolphin Progress July and August 2022</h1>
    
    <div id="readability-page-1" class="page"><div id="entry-234">
  
  
  
  

  
  <div>
    
    <div>
      <header> 
<img src="https://dolphin-emu.org/m/user/blog/progress-report/2022-august/progressreportheader-july2022-2.jpg"/> 
<img src="https://dolphin-emu.org/m/user/blog/progress-report/2022-august/progressreportheader-july2022mini-2.jpg"/> 
</header>

<p>The Summer tends to consistently be one of the busiest times for Dolphin&#39;s development.  While sometimes the question is <em>what do we put into the Progress Report</em>, during the summer months it&#39;s usually <em>how much can we fit into the Progress Report?</em>  This summer&#39;s congestion was <em>then</em> compounded by us blog staff having a few things we&#39;ve been planning coming into fruition.  Still, the show must go on, and we&#39;re here... albeit a bit delayed.</p>
<p>As such, we&#39;ve got a huge smattering of changes to go over and many smaller ones that we couldn&#39;t quite fit in.  macOS users in general will be able to rejoice with the addition of a brand new Metal backend brought to us by veteran developer <strong><a href="https://github.com/TellowKrinkle">TellowKrinkle</a></strong>.  They also brought their graphics expertise to improve things for everyone, greatly reducing the remaining causes of shader based delays/stuttering when using Ubershaders.  If you&#39;re looking for an easier way to setup a wide variety of controllers, a new SDL2 controller backend has been added for all OSes, and even brings <em>native</em> motion control support without the use of a DSU server to non-Linux operating systems.  We also have a wide variety of emulation fixes, more graphics mods added, and the long awaited SD card &#34;folder&#34; feature!</p>
<p>All of that and it&#39;s our job to write about it.  We&#39;ve got our work cut out for us.</p>

<h3 id="notable-changes"><strong>Notable Changes</strong><a href="#notable-changes" title="Permanent link">¶</a></h3>
<h4 id="50-16965-macos-add-metal-backend-by-tellowkrinkle-and-50-17206-moltenvk-update-to-v1111-by-oatmealdome"><strong><a href="https://dolphin-emu.org/download/dev/master/5.0-16965/">5.0-16965 - macOS:  Add Metal Backend</a></strong>  by <strong><a href="https://github.com/TellowKrinkle">TellowKrinkle</a></strong> and <strong><a href="https://dolphin-emu.org/download/dev/master/5.0-17206/">5.0-17206 - MoltenVK: Update to v1.1.11</a></strong>  by <strong><a href="https://github.com/OatmealDome">OatmealDome</a></strong><a href="#50-16965-macos-add-metal-backend-by-tellowkrinkle-and-50-17206-moltenvk-update-to-v1111-by-oatmealdome" title="Permanent link">¶</a></h4>
<p>Early on in Metal&#39;s life, <strong><a href="https://github.com/Stenzek">Stenzek</a></strong> experimented with adding a Metal Graphics Backend to Dolphin.  Unfortunately, due to Dolphin&#39;s <a href="https://dolphin-emu.org/blog/2017/07/30/ubershaders/">quirks</a> and unfamiliarity with the Metal API, the effort stalled out.  However, in the midst of that struggle an alternative arrived - <a href="https://github.com/KhronosGroup/MoltenVK">MoltenVK</a>. As a translation layer between Vulkan and Metal, MoltenVK allowed us to support Metal through our Vulkan graphics backend, with little effort on our end. This proved to be a very successful compromise, and it may very well have saved our macOS support.</p>
<p>But, in theory, a <em>native</em> Metal backend would be faster than MoltenVK.  Enter <strong><a href="https://github.com/TellowKrinkle">TellowKrinkle</a></strong> the architect of <a href="https://pcsx2.net/">PCSX2</a>&#39;s macOS port and Metal Graphics Backend.  Having conquered Metal on PCSX2, they turned their attention to Dolphin and decided to try their hand at a native Metal backend.  The results were <em>immediately</em> apparent.</p>

<p><marquee behavior="alternate">The above graph is not current, please keep reading.</marquee></p>


<p>Our macOS users were extremely excited by these improvements! In GPU heavy titles, such as the GPU focused Skyloft and Elyia tests, the difference was enormous! However, something felt off. Our native Metal backend was performing <em>too much better.</em> Based on our prior experience and general industry knowledge, MoltenVK is an excellent translation layer - a native Metal implementation should only be a little faster. But the new Metal backend was functioning correctly and we weren&#39;t going to argue with improved performance, so we cautiously continued forward. When we ran our new Metal graphics backend and MoltenVK through the tests above <em>for this very Progress Report</em>, it finally hit us. The MoltenVK results we were getting, as recorded in the graph above, were far lower than the previous times <a href="https://dolphin-emu.org/blog/2021/11/13/dolphin-progress-report-september-and-october-2021/#macsimum">we&#39;ve shown</a> <a href="https://dolphin-emu.org/blog/2022/02/08/dolphin-progress-report-nov-and-dec-2021-jan-2022/#50-15538-mmu-support-for-aarch64-jit-by-josjuice">these tests</a>. It varied substantially depending on the test (hence the difficulty isolating this), but in some scenarios MoltenVK was performing up to <strong>45% worse</strong> than before! Something had gone wrong.</p>
<center>Comparing our native Metal results to our old MoltenVK results, Metal is still better, but by only a little bit.</center>
<!-- the above is a spacer -->



















































































    
    
    

    </div>
    
    
    <p> You can continue the discussion in the <a href="https://forums.dolphin-emu.org/showthread.php?tid=35067" title="Visit forum thread for this article">forum thread</a> of this article.</p>
  </div>
  

  
  
  
</div></div>
  </body>
</html>
