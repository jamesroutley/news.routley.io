<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/chettrick/discobsd">Original</a>
    <h1>DiscoBSD: 2.11BSD-Based OS for STM32 and PIC32 Microcontrollers</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<h2 dir="auto"><a id="user-content-211bsd-based-unix-like-operating-system-for-stm32-and-pic32-microcontrollers" aria-hidden="true" href="#211bsd-based-unix-like-operating-system-for-stm32-and-pic32-microcontrollers"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>2.11BSD-based UNIX-like Operating System for STM32 and PIC32 Microcontrollers</h2>
<p dir="auto">DiscoBSD is a 2.11BSD-based UNIX-like operating system for microcontrollers,
with a focus on high portability to memory constrained devices without a
memory management unit.</p>
<p dir="auto">This microcontroller-focused operating system is the continuation of RetroBSD,
a 2.11BSD-based OS targeting only the MIPS-based PIC32MX7.
DiscoBSD is multi-platform, as it also supports Arm Cortex-M4 STM32F4 devices.</p>
<p dir="auto">Source code to the system is freely available under a BSD-like license.</p>
<h2 dir="auto"><a id="user-content-discobsd-resource-requirements" aria-hidden="true" href="#discobsd-resource-requirements"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>DiscoBSD Resource Requirements</h2>
<p dir="auto">A basic, minimal system uses 128 Kbytes of flash and 128 Kbytes of RAM.</p>
<p dir="auto">The kernel is loaded into the flash and only uses 32 Kbytes of RAM.
User programs each use the remaining 96 Kbytes of RAM, via swapping.
Devices with more RAM can be used to run larger user programs.</p>
<p dir="auto">An SD card is required for the root file system.</p>
<h2 dir="auto"><a id="user-content-installing-and-running" aria-hidden="true" href="#installing-and-running"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installing and Running</h2>
<p dir="auto">Installing consists of loading the kernel into the flash memory, and imaging
the SD card with the file <code>sdcard.img</code>.</p>
<p dir="auto">Communication with DiscoBSD requires a serial port. A USB to TTL device or
the built-in VCP USB serial port on development boards can be used.</p>
<div data-snippet-clipboard-copy-content="$ cu -l /dev/cuaU0 -s 115200"><pre><code>$ cu -l /dev/cuaU0 -s 115200
</code></pre></div>
<p dir="auto">Depending on the host system, other serial port utilities such as <code>screen</code>,
<code>minicom</code>, <code>putty</code>, or <code>teraterm</code> may be used.</p>
<p dir="auto">Log in to DiscoBSD with user <code>root</code> and a blank password.
Shutdown DiscoBSD with the <code>halt</code>, <code>shutdown</code>, or <code>reboot</code> commands.</p>
<p dir="auto">Manual pages for commands are available through the <code>man</code> command.</p>
<h2 dir="auto"><a id="user-content-building" aria-hidden="true" href="#building"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Building</h2>
<p dir="auto">DiscoBSD is cross-built on UNIX-like host operating systems.</p>
<p dir="auto">From the source tree root, run:</p>

<p dir="auto">which will build a file system image in the file <code>distrib/stm32/sdcard.img</code>
and kernels in the files <code>sys/stm32/${BOARD}/unix.elf</code>.</p>
<p dir="auto">DiscoBSD/stm32 is the default port, but DiscoBSD/pic32 may be built via:</p>
<div data-snippet-clipboard-copy-content="$ MACHINE=pic32 MACHINE_ARCH=mips gmake"><pre><code>$ MACHINE=pic32 MACHINE_ARCH=mips gmake
</code></pre></div>
<p dir="auto">which will build a file system image in the file <code>distrib/pic32/sdcard.img</code>
and kernels in the files <code>sys/pic32/${BOARD}/unix.elf</code>.</p>
<h2 dir="auto"><a id="user-content-debugging" aria-hidden="true" href="#debugging"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Debugging</h2>
<p dir="auto">DiscoBSD/stm32 is debugged through OpenOCD and GDB. The <code>make</code> targets for
debugging are <code>ocd</code> and <code>gdb</code>.</p>
<p dir="auto">Debug a particular development board via:</p>
<div data-snippet-clipboard-copy-content="$ BOARD=f412gdisco gmake ocd"><pre><code>$ BOARD=f412gdisco gmake ocd
</code></pre></div>
<p dir="auto">in one terminal, and:</p>
<div data-snippet-clipboard-copy-content="$ BOARD=f412gdisco gmake gdb"><pre><code>$ BOARD=f412gdisco gmake gdb
</code></pre></div>
<p dir="auto">in another terminal.</p>
<h2 dir="auto"><a id="user-content-additional-information" aria-hidden="true" href="#additional-information"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Additional Information</h2>
<p dir="auto">Port-specific information can be found in <code>distrib/${MACHINE}/README.md</code>.</p>
<h2 dir="auto"><a id="user-content-discobsdstm32-dmesg" aria-hidden="true" href="#discobsdstm32-dmesg"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>DiscoBSD/stm32 dmesg</h2>
<div data-snippet-clipboard-copy-content="2.11 BSD UNIX for STM32, rev G274 #1: Fri Dec 30 18:42:28 PST 2022
     chris@stm32.discobsd.org:/sys/stm32/f412gdisco
cpu: STM32F412xx rev C, 100 MHz, bus 50 MHz
oscillator: phase-locked loop, clock source: high speed external
uart2: pins tx=PA2/rx=PA3, af=7, console
sd0: port sdio0, 4-bit bus
sd0: type SDHC, size 31178752 kbytes
sd0a: partition type b7, sector 2, size 102400 kbytes
sd0b: partition type b8, sector 204802, size 2048 kbytes
sd0c: partition type b7, sector 208898, size 102400 kbytes
phys mem  = 256 kbytes
user mem  = 96 kbytes
root dev  = (0,1)
swap dev  = (0,2)
root size = 102400 kbytes
swap size = 2048 kbytes
Automatic boot in progress: starting file system checks.
/dev/sd0a: 1449 files, 11899 used, 90100 free
/dev/sd0c: 3 files, 3 used, 101996 free
Updating motd... done
Starting daemons: update cron 
Sat Dec 31 17:05:27 PST 2022

2.11 BSD UNIX (name.my.domain) (console)

login: root
Password:
2.11 BSD UNIX for STM32, rev G274 #1: Fri Dec 30 18:42:28 PST 2022

Welcome to DiscoBSD.

erase ^?, kill ^U, intr ^C
# "><pre><code>2.11 BSD UNIX for STM32, rev G274 #1: Fri Dec 30 18:42:28 PST 2022
     chris@stm32.discobsd.org:/sys/stm32/f412gdisco
cpu: STM32F412xx rev C, 100 MHz, bus 50 MHz
oscillator: phase-locked loop, clock source: high speed external
uart2: pins tx=PA2/rx=PA3, af=7, console
sd0: port sdio0, 4-bit bus
sd0: type SDHC, size 31178752 kbytes
sd0a: partition type b7, sector 2, size 102400 kbytes
sd0b: partition type b8, sector 204802, size 2048 kbytes
sd0c: partition type b7, sector 208898, size 102400 kbytes
phys mem  = 256 kbytes
user mem  = 96 kbytes
root dev  = (0,1)
swap dev  = (0,2)
root size = 102400 kbytes
swap size = 2048 kbytes
Automatic boot in progress: starting file system checks.
/dev/sd0a: 1449 files, 11899 used, 90100 free
/dev/sd0c: 3 files, 3 used, 101996 free
Updating motd... done
Starting daemons: update cron 
Sat Dec 31 17:05:27 PST 2022

2.11 BSD UNIX (name.my.domain) (console)

login: root
Password:
2.11 BSD UNIX for STM32, rev G274 #1: Fri Dec 30 18:42:28 PST 2022

Welcome to DiscoBSD.

erase ^?, kill ^U, intr ^C
# 
</code></pre></div>
</article>
          </div></div>
  </body>
</html>
