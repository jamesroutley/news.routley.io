<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://annahope.me/blog/when-is-rust-as-okay/">Original</a>
    <h1>When is it okay to cast types with `as`?</h1>
    
    <div id="readability-page-1" class="page"><div>
    <article>
      

      <span> 3 min read <span></span> July 11, 2024 <span></span> #<a href="https://annahope.me/tags/rust/">rust</a>  #<a href="https://annahope.me/tags/programming/">programming</a> </span>

    


<p><small><a rel="noopener" target="_blank" href="https://travellingcryptographer.com/"><code>swan</code></a> asked me this after reading an earlier version of 
<a href="https://annahope.me/blog/rust-as/">&#34;Surprises with Rust&#39;s <code>as</code>&#34;</a>. I thought that post had already gotten long,
so I decided to break this part out. I recommend reading that post first if you want the full context.</small></p>
<p>This is a complicated question. I don&#39;t think there are absolute answers
in software engineering — and we should probably beware people who
<a rel="noopener" target="_blank" href="https://www.linkedin.com/feed/update/urn:li:activity:7209966198703161344/">try to give them.</a>
Almost every engineering decision requires trade-offs, and this is 100% the case with
using <a rel="noopener" target="_blank" href="https://doc.rust-lang.org/std/convert/trait.TryFrom.html#examples"><code>TryFrom</code></a> 
instead of <code>as</code>. <code>TryFrom</code> gives us more certainty that this
particular part of our codebase won&#39;t cause us surprises, but we trade away simplicity and convenience.</p>
<p>For me, that trade-off is worth it. When my code — or any code I have to work with — encounters something
unexpected that it can&#39;t handle correctly, I prefer it to fail as fast as possible
and give me as much relevant context as possible, instead of chugging on and
doing strange things (and making me go on a wild chase to find the cause). So, I am clearly biased against <code>as</code>.</p>
<p>With that said, casting types with <code>as</code> is <em>probably</em> okay if:</p>
<ul>
<li>You are building a toy project or a prototype just to learn or figure something out</li>
<li>And you just need to get it working and don&#39;t care about handling errors</li>
<li>And you&#39;re 100% sure that this will always be a toy project or a prototype
where you won&#39;t care about handling errors (I&#39;ve made the wrong assumption with this before)</li>
<li>And if you&#39;re not 100% sure, you leave notes/issues/tickets/<code>// TODO</code> comments to replace <code>as</code> with <code>TryFrom</code>
for when you start to care about handling errors, <em>and pinky promise to actually do that</em></li>
<li>Or you&#39;re an experienced Rust programmer doing some low-level type juggling, and
you have considered all the possible ranges and types of values your code would ever deal with,
and determined that <code>as</code> is the best option, in which case you probably don&#39;t need my advice on this
(but I would welcome your feedback!)</li>
</ul>
<p>So, in short, something like this:</p>
<pre data-lang="rust"><code data-lang="rust"><span></span><span></span><span><span>let</span> byte <span>=</span> some_char <span>as</span> <span>u8</span><span>;</span>
</span></code></pre>
<p>Otherwise, if in doubt, I don&#39;t think it would be a bad idea to use <code>TryFrom</code> instead.</p>
<p><small>I appreciate <code>swan</code>&#39;s feedback that led to this addendum, and hope that it helps!</small></p>
<hr/>


    <p><small><i>If you have feedback, I would love to hear from you! Please use one of the links below to get in touch.</i></small>
    </p>
      <nav>
        
        
      </nav>
    </article>
  </div></div>
  </body>
</html>
