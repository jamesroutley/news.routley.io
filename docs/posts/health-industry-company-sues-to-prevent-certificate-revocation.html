<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.hezmatt.org/~mpalmer/blog/2024/07/31/healthcare-company-sues-to-stop-certificate-revocation.html">Original</a>
    <h1>Health industry company sues to prevent certificate revocation</h1>
    
    <div id="readability-page-1" class="page"><div id="body">
			
			<div id="content">

				
				<p>
					Posted: Wed, 31 July 2024
					| <a href="https://www.hezmatt.org/~mpalmer/blog/2024/07/31/healthcare-company-sues-to-stop-certificate-revocation.html">permalink</a>
					| <a href="https://www.hezmatt.org/~mpalmer/blog/2024/07/31/healthcare-company-sues-to-stop-certificate-revocation.html#comments">
						
							No comments
						
					</a>
				</p>
<p>It’s not often that a company is willing to make <a href="https://storage.courtlistener.com/recap/gov.uscourts.utd.149707/gov.uscourts.utd.149707.1.0.pdf">a sworn statement to a court about how its IT practices are incompatible with the needs of the Internet</a>, but when they do… it’s popcorn time.</p>



<p>In the red corner, weighing in at… nah, I’m not going to do that schtick.</p>

<p>The plaintiff in <a href="https://www.courtlistener.com/docket/68995396/alegeus-technologies-llc-v-digicert/">the case</a> is <a href="https://www.alegeus.com/">Alegeus Technologies, LLC</a>, a Delaware Corporation that, according to their filings, “is a leading provider of a business-tobusiness, white-label funding and payment platform for healthcare carriers and third-party administrators to administer consumer-directed employee benefit programs”.
Not being subject to the US’ bonkers health care system, I have only a passing familiarity with the sorts of things they do, but presumably it involves moving a lot of money around, which is sometimes important.</p>

<p>The defendant is <a href="https://www.digicert.com/">DigiCert</a>, a CA which, based on <a href="https://www.hezmatt.org/~mpalmer/blog/2024/01/30/why-certificate-automation-matters.html">analysis I’ve done previously</a>, is the second-largest issuer of WebPKI certificates by volume.</p>



<p>According to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1910322">a recently opened Mozilla CA bug</a>, DigiCert found an issue in their “domain control validation” workflow, that meant it may have been possible for a miscreant to have <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1910322#c10">certificates issued to them that they weren’t legitimately entitled to</a>.
Given that validating domain names is basically the “YOU HAD ONE JOB!” of a CA, this is a big deal.</p>

<p>The <a href="https://cabforum.org/working-groups/server/baseline-requirements/documents/CA-Browser-Forum-TLS-BR-2.0.5.pdf">CA/Browser Forum Baseline Requirements</a> (BRs) (which all CAs are required to adhere to, by virtue of their being included in various browser and OS trust stores), say that revocation is required within 24 hours when “[t]he CA obtains evidence that the validation of domain authorization or control for any Fully‐Qualified Domain Name or IP address in the Certificate should not be relied upon” (section 4.9.1.1, point 5).</p>

<p>DigiCert appears to have at least <em>tried</em> to do the right thing, by opening the above Mozilla bug giving some details of the problem, and notifying their customers that their certificates were going to be revoked.
One may quibble about how fast they’re doing it, but they’re giving it a decent shot, at least.</p>

<p>A complicating factor in all this is that, only a touch over a month ago, <a href="https://security.googleblog.com/2024/06/sustaining-digital-certificate-security.html">Google Chrome announced the removal of another CA, Entrust, from its own trust store program</a>, citing “a pattern of compliance failures, unmet improvement commitments, and the absence of tangible, measurable progress in response to publicly disclosed incident reports”.
Many of these compliance failures were failures to revoke certificates in a timely manner.
One imagines that DigiCert would not like to gain a reputation for tardy revocation, particularly at the moment.</p>



<p>Now we come to Alegeus Technologies.
They’ve opened a civil case whose first action is to request the issuance of a Temporary Restraining Order (TRO) that prevents DigiCert from revoking certificates issued to Alegeus (which the court <a href="https://storage.courtlistener.com/recap/gov.uscourts.utd.149707/gov.uscourts.utd.149707.3.0.pdf">has issued</a>).
This is a big deal, because TROs are legal instruments that, if not obeyed, constitute contempt of court (or something similar) – and courts do <em>not</em> like people who disregard their instructions.
That means that, in the short term, those certificates aren’t getting revoked, despite the requirement imposed by root stores on DigiCert that the certificates <em>must</em> be revoked.
DigiCert is in a real “rock / hard place” situation here: revoke and get punished by the courts, or don’t revoke and potentially (though almost certainly not, in the circumstances) face removal from trust stores (which would kill, or at least massively hurt, their business).</p>

<p>The reasons that Alegeus gives for requesting the restraining order is that “[t]o
Reissue and Reinstall the Security Certificates, Alegeus must work with and
coordinate with its Clients, who are required to take steps to rectify the
certificates. Alegeus has hundreds of such Clients. Alegeus is generally
required by contract to give its clients much longer than 24 hours’ notice
before executing such a change regarding certification.”</p>

<p>In the filing, Alegeus does acknowledge that “DigiCert is a voluntary member of the Certification Authority Browser Forum (CABF), which has bylaws stating that certificates with an issue in their domain validation must be revoked within 24 hours.”
This is a misstatement of the facts, though.
It is the BRs, not the CABF bylaws, that require revocation, and the BRs apply to all CAs that wish to be included in browser and OS trust stores, not just those that are members of the CABF.
In any event, given that Alegeus was aware that DigiCert is required to revoke certificates within 24 hours, one wonders why Alegeus went ahead and signed agreements with their customers that required a lengthy notice period before changing certificates.</p>

<p>What complicates the situation is that there is apparently a <a href="https://storage.courtlistener.com/recap/gov.uscourts.utd.149707/gov.uscourts.utd.149707.1.1.pdf">Master Services Agreement</a> (MSA) that states that it “constitutes the entire agreement between the parties” – and that MSA doesn’t mention certificate revocation anywhere relevant.
That means that it’s not quite so cut-and-dried that DigiCert does, in fact, have the right to revoke those certificates.
I’d expect a lot of “update to your Master Services Agreement” emails to be going out from DigiCert (and other CAs) in the near future to clarify this point.</p>

<p>Not being a lawyer, I can’t imagine which way this case might go, but there’s one thing we <em>can</em> be sure of: some lawyers are going to able to afford that trip to a tropical paradise this year.</p>



<p>The requirement for revocation within 24 hours is an important security control in the WebPKI ecosystem.
If a certificate <em>is</em> misissued to a malicious party, or is otherwise compromised, it needs to be marked as untrustworthy as soon as possible.
While <a href="https://www.hezmatt.org/~mpalmer/blog/2024/01/16/pwned-certificates-on-the-fediverse.html#why-dont-you-just-have-the-certificates-revoked">revocation is far from perfect</a>, it is the best tool we have.</p>

<p>In this court filing, Alegeus has claimed that they are unable to switch certificates with less than 24 hours notice (due to “contractual SLAs”).
This is a pretty big problem, because there are lots of reasons why a certificate might need to be switched out Very Quickly.
As a practical example, <a href="https://www.hezmatt.org/~mpalmer/blog/2023/06/12/private-key-redaction-redux.html">someone with access to the private key for your SSL certificate might decide to use it in a blog post</a>.
Letting that sort of problem linger for an extended period of time might end up being a Pretty Big Problem of its own.
An organisation that cannot respond within hours to a compromised certificate is playing chicken with their security.</p>



<p>Contractual obligations that require you to notify anyone else of a certificate (or private key) changing are bonkers, and completely antithetical to the needs of the WebPKI.
If you have to have them, you’re going to want to start transitioning to a private PKI, wherein you can do whatever you darn well please with revocation (or not).
As these sorts of problems keep happening, trust stores (and hence CAs) are going to crack down on this sort of thing, so you may as well move sooner rather than later.</p>

<p>If you are an organisation that uses WebPKI certificates, you’ve <em>got</em> to be able to deal with any kind of certificate revocation event within hours, not days.
This basically boils down to <a href="https://www.hezmatt.org/~mpalmer/blog/2024/01/30/why-certificate-automation-matters.html">automated issuance and lifecycle management</a>, because having someone manually request and install certificates is terrible on many levels.
There isn’t currently a completed standard for notifying subscribers if their certificates need premature renewal (say, due to needing to be revoked), but the <a href="https://datatracker.ietf.org/doc/draft-ietf-acme-ari/">ACME Renewal Information Extension</a> is currently being developed to fill that need.
Ask your CA if they’re tracking this standards development, and when they intend to have the extension available for use.
(Pro-tip: if they say “we’ll start doing development when the RFC is published”, run for the hills; that’s not how responsible organisations work on the Internet).</p>



<p>If you’ve found this helpful, consider <a href="https://ko-fi.com/tobermorytech">shouting me a refreshing beverage</a>.
Reading through legal filings is thirsty work!</p>


<hr/>
			
			

			</div>
		</div></div>
  </body>
</html>
