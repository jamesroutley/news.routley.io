<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/symkat/MarkdownSite">Original</a>
    <h1>Show HN: I built an open-source web hosting platform for static sites</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/d500aaf68a382cdbf28d5b2c753dd7fe0eb657e3ee49c20d648b950c53896377/68747470733a2f2f6d61726b646f776e736974652e636f6d2f696d672f6d61726b646f776e736974652e6a7067"><img src="https://camo.githubusercontent.com/d500aaf68a382cdbf28d5b2c753dd7fe0eb657e3ee49c20d648b950c53896377/68747470733a2f2f6d61726b646f776e736974652e636f6d2f696d672f6d61726b646f776e736974652e6a7067" alt="MarkdownSite Homepage" data-canonical-src="https://markdownsite.com/img/markdownsite.jpg"/></a></p>
<p dir="auto"><strong>This is the codebase for <a href="https://markdownsite.com/" rel="nofollow">MarkdownSite</a>, an open-source hosting platform for static sites and markdown files.</strong></p>
<h2 dir="auto"><a id="user-content-what-is-markdownsite" aria-hidden="true" href="#what-is-markdownsite"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What Is MarkdownSite?</h2>
<p dir="auto">MarkdownSite is a platform for hosting websites.</p>
<p dir="auto">People who want their websites hosted enter a git url for their repository.</p>
<p dir="auto">MarkdownSite downloads their repo and turns anything in <code>public/</code> into a static website hosted at a random subdomain.</p>
<p dir="auto">Anything MarkdownSite finds in <code>site/</code> that is an <code>.md</code> file will be rendered as HTML.</p>
<p dir="auto">Once MarkdownSite downloads and builds the website, it is sent to one or more webservers and accepts traffic from the Internet.</p>
<h2 dir="auto"><a id="user-content-how-do-i-use-markdownsite" aria-hidden="true" href="#how-do-i-use-markdownsite"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How do I use MarkdownSite?</h2>
<p dir="auto">You can use <a href="https://markdownsite.com/" rel="nofollow">MarkdownSite</a> to host a website.</p>
<p dir="auto">You can build your own version of MarkdownSite to host as many websites as you want on your own infrastructure.  See the <code>devops/</code> directory for instructions on getting an instance running.</p>
<h2 dir="auto"><a id="user-content-what-are-the-directories-here" aria-hidden="true" href="#what-are-the-directories-here"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>What are the directories here?</h2>
<p dir="auto"><strong>CGI</strong> contains the Markdown::CGI program.  This renders markdown files to HTML, and is installed on the webservers.</p>
<p dir="auto"><strong>Manager-DB</strong> contains the markdownsite database schema, and the code for MarkdownSite::Manager::DB, a DBIx::Class interface to the database.</p>
<p dir="auto"><strong>Manager</strong> is MarkdownSite::Manager, a mojolicious-based webapp for submitting the repository and viewing build status.  This contains a Minion worker that handles building and deploying the websites.</p>
<p dir="auto"><strong>devops/setup</strong> contains an ansible code base to install servers by their server type, and documentation explaining it.</p>
<p dir="auto"><strong>devops/config</strong> contains an ansible code base that can be maintained and extended -- it is configuration management for an active MarkdownSite instance.</p>
<p dir="auto"><strong>devops/</strong> contains additional graphs and network diagrams,</p>
<h2 dir="auto"><a id="user-content-visual-view-of-markdownsite" aria-hidden="true" href="#visual-view-of-markdownsite"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Visual View Of MarkdownSite</h2>
<p dir="auto">This is a birds-eye view of a three-node setup, without insight server.</p>
<section data-identity="7ee4ee86-a681-453a-b604-72ca543c2ffc" data-host="https://viewscreen.githubusercontent.com" data-src="https://viewscreen.githubusercontent.com/markdown/mermaid" data-content="{&#34;data&#34;:&#34;flowchart TB\n    subgraph one[Panel Node]\n    a1[PostgresSQL]\n    a2[MarkdownSite::Manager Daemon]\n    a3[Nginx]\n    a1 &amp;lt;-- MarkdownSite::Manager::DB / Minion--&amp;gt; a2\n    a3 -- Hypnotoad PSGI --&amp;gt; a2\n\n    end\n    subgraph two[Build Node]\n    b1[Clone &amp;amp; Build Website]\n    b2[MarkdownSite::Manager Worker]\n    b2 &amp;lt;-- PSQL Private IP --&amp;gt; a1\n    end\n    subgraph three[WebServer Node]\n    c1[Lighttpd]\n    c2[Static Files]\n    c3[MarkdownSite::CGI]\n    c1 &amp;lt;-- Static File Exists --&amp;gt; c2\n    c1 &amp;lt;-- No File Exists--&amp;gt; c3\n    c3 -- Generate &amp;amp; Store HTML Page From Markdown--&amp;gt; c2  \n    end\n\n    b1 -- Ansible SSH--&amp;gt; three\n    q[Internet User] &amp;lt;-- View Hosted Website --&amp;gt;c1\n    z[MarkdownSite User] &amp;lt;-- Submit Git Repo For Hosting --&amp;gt;a3\n&#34;}" data-type="mermaid" aria-label="enrichable markdown container">
  
  
  <section aria-label="Raw mermaid code">
    <pre lang="mermaid">flowchart TB
    subgraph one[Panel Node]
    a1[PostgresSQL]
    a2[MarkdownSite::Manager Daemon]
    a3[Nginx]
    a1 &amp;lt;-- MarkdownSite::Manager::DB / Minion--&amp;gt; a2
    a3 -- Hypnotoad PSGI --&amp;gt; a2

    end
    subgraph two[Build Node]
    b1[Clone &amp;amp; Build Website]
    b2[MarkdownSite::Manager Worker]
    b2 &amp;lt;-- PSQL Private IP --&amp;gt; a1
    end
    subgraph three[WebServer Node]
    c1[Lighttpd]
    c2[Static Files]
    c3[MarkdownSite::CGI]
    c1 &amp;lt;-- Static File Exists --&amp;gt; c2
    c1 &amp;lt;-- No File Exists--&amp;gt; c3
    c3 -- Generate &amp;amp; Store HTML Page From Markdown--&amp;gt; c2  
    end

    b1 -- Ansible SSH--&amp;gt; three
    q[Internet User] &amp;lt;-- View Hosted Website --&amp;gt;c1
    z[MarkdownSite User] &amp;lt;-- Submit Git Repo For Hosting --&amp;gt;a3
</pre>
  </section>
</section>

<p dir="auto">MarkdownSite has an additional server, insight, that does metrics and graphs with Graphite, Grafana, and Collectd.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/c2fe38f6f25d1e09d247d8f51a1ac87050d795278e7a7bc51540fb61ca45c707/68747470733a2f2f6d61726b646f776e736974652e636f6d2f696d672f67726166616e612d6772617068732e706e67"><img src="https://camo.githubusercontent.com/c2fe38f6f25d1e09d247d8f51a1ac87050d795278e7a7bc51540fb61ca45c707/68747470733a2f2f6d61726b646f776e736974652e636f6d2f696d672f67726166616e612d6772617068732e706e67" alt="Grafana Graphs" data-canonical-src="https://markdownsite.com/img/grafana-graphs.png"/></a></p>
<h2 dir="auto"><a id="user-content-thanks-for-looking" aria-hidden="true" href="#thanks-for-looking"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Thanks For Looking!</h2>
<p dir="auto">Thank you for taking the time to checkout this repository.  I hope the information here has been useful.</p>
</article>
        </div></div>
  </body>
</html>
