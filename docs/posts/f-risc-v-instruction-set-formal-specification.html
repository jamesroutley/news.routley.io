<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/mrLSD/riscv-fs">Original</a>
    <h1>F# RISC-V Instruction Set formal specification</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a href="https://travis-ci.org/mrLSD/riscv-fs" rel="nofollow"><img src="https://camo.githubusercontent.com/a5d7fb852a82237357f7af33f4202290c76f28fef8a039bcfc769114cc018185/68747470733a2f2f7472617669732d63692e6f72672f6d724c53442f72697363762d66732e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/mrLSD/riscv-fs.svg?branch=master"/></a></p>
<p dir="auto"><strong>Copyright Â© Evgeny Ukhanov</strong></p>
<p dir="auto">This is a formal (and executable) specification for the
RISC-V ISA (Instruction Set Architecture), written in
<strong>F# purely functional style</strong>. We deliberately choose
an &#34;<em>extremely elementary</em>&#34; implementation of F# to make it
readable and usable by wide audience who do not know F# and who
do not plan to learn F#.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/3d3af88857328fa9c384afc75e6dad08edb7ed4285445657413472e08cbc1438/68747470733a2f2f6d69726f2e6d656469756d2e636f6d2f6d61782f323437342f312a38385a6a2d514a713438495a54694347556f356d53512e706e67"><img src="https://camo.githubusercontent.com/3d3af88857328fa9c384afc75e6dad08edb7ed4285445657413472e08cbc1438/68747470733a2f2f6d69726f2e6d656469756d2e636f6d2f6d61782f323437342f312a38385a6a2d514a713438495a54694347556f356d53512e706e67" alt="F# RISC-V ISA Formal Specification" data-canonical-src="https://miro.medium.com/max/2474/1*88Zj-QJq48IZTiCGUo5mSQ.png"/></a></p>
<p dir="auto">This is a work-in-progress, one of several similar concurrent
efforts within the <strong>ISA Formal Specification</strong>
Technical Group constituted by The RISC-V Foundation
(<a href="https://riscv.org" rel="nofollow">https://riscv.org</a>). We welcome your feedback, comments and suggestions.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-content" aria-hidden="true" href="#content"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Content</h2>
<ul dir="auto">
<li><a href="#features--current-status">Features &amp; Current status</a></li>
<li><a href="#reading-the-code">Reading the code</a></li>
<li><a href="#how-to-build-and-run-it-on-risc-v-binaries">How to build and run it on RISC-V binaries</a>
<ul dir="auto">
<li><a href="#install-.net-sdk">Install .NET SDK</a></li>
<li><a href="#make-the-application-executable">Make the application executable</a></li>
<li><a href="#run-the-application-executable">Run the application executable</a></li>
</ul>
</li>
<li><a href="#how-to-contribute">How to Contribute</a></li>
<li><a href="#references">References</a></li>
<li><a href="#licence">Licence</a></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-features--current-status" aria-hidden="true" href="#features--current-status"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Features &amp; Current status</h2>
<ul dir="auto">
<li>Supports the following features (or <em>in active development state</em>)
<ul>
<li> Base instruction set: RV32I</li>
<li> Tests RV32I</li>
<li> Base instruction set: RV64I</li>
<li> Tests RV64I</li>
<li> Standard extension M (integer multiply/divide)</li>
<li> Tests for Standard extension M RV32/RV64</li>
<li> Standard extension A (atomic memory ops)</li>
<li> Tests for Standard extension A RV32/RV64</li>
</ul>
</li>
<li>Features under development
<ul dir="auto">
<li>Standard extension C (Compressed 16-bit instructions)</li>
<li>Standard extension F (Single-precision floating point)</li>
<li>Standard extension D (Double-precision floating point)</li>
<li>Privilege Level M (Machine)</li>
<li>Privilege Level U (User)</li>
<li>Privilege Level S (Supervisor)
<ul dir="auto">
<li>Virtual Memory schemes SV32, SV39 and SV48</li>
</ul>
</li>
</ul>
</li>
<li>Application can be executed as a F# program flexible with
CLI (<em>command line interface</em>) support, which in
turn executes RISC-V ELF binaries. This is a sequential
interpretation: one-instruction-at-a-time, sequential
memory model.</li>
<li>Tests passing for RISC-V <strong>under development</strong>:
<ul dir="auto">
<li>Basic instruction flow</li>
<li><code>rv32ui-p-*, rv64ui-p-*</code> (Base instruction set)</li>
<li><code>rv32um-p-*, rv64um-p-*</code> (M extension)</li>
<li><code>rv32ua-p-*, rv64ua-p-*</code> (A extension)</li>
<li><code>rv32uc-p-*, rv64uc-p-*</code> (C extension)</li>
</ul>
</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-reading-the-code" aria-hidden="true" href="#reading-the-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Reading the code</h2>
<p dir="auto">We expect that many people might use this as a reading
reference (whether or not they build and execute it) to
clarify their understanding of RISC-V ISA semantics.</p>
<p dir="auto">Main part for reading Specification:</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Decode*.fs</strong></p>
<p dir="auto">Decodes contain decoders for specific instructions set
and notified with instruction/extension set symbol. For example <code>DecodeI.fs</code></p>
</li>
<li>
<p dir="auto"><strong>Execute*.fs</strong></p>
<p dir="auto">Executes contain executions for specific instructions set
and notified with instruction/extension set symbol. For example <code>ExecuteI.fs</code></p>
</li>
<li>
<p dir="auto">Utilities:</p>
<ul dir="auto">
<li>
<p dir="auto"><code>CLI.fs</code></p>
<p dir="auto">Contain helper function and types for
building effective CLI commands and options.</p>
</li>
<li>
<p dir="auto"><code>Bits.fs</code></p>
<p dir="auto">Basic type specific functions for
manipulations with <code>bits</code>.</p>
</li>
<li>
<p dir="auto"><code>Run.fs</code></p>
<p dir="auto">Basic Run flow - fetch, decode, execute,
logging execution flow.</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Architecture</p>
<ul dir="auto">
<li>
<p dir="auto"><code>Arch.fs</code></p>
<p dir="auto">Basic architecture types for RISC-V specification.</p>
</li>
<li>
<p dir="auto"><code>MachineState.fs</code></p>
<p dir="auto">Basic type and functions described
RISC-V machine state.</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Main app</p>
<ul dir="auto">
<li><code>Program.fs</code></li>
</ul>
<p dir="auto">Main application to execute <strong>RISC-V simulator/emulator</strong>.</p>
</li>
<li>
<p dir="auto">Test</p>
<ul dir="auto">
<li>
<p dir="auto"><code>Test/*.fs</code></p>
<p dir="auto">Contain unit-tests for instructions set
and extensions</p>
</li>
<li>
<p dir="auto">Test/asm/</p>
<p dir="auto">Contain Assembler test programs for
manual testing RISC-V CPI implementation.
It depend on <strong>risc-v toolchain</strong> and
it has special auto-build <code>Makefile</code>.</p>
</li>
</ul>
</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-how-to-build-and-run-it-on-risc-v-binaries" aria-hidden="true" href="#how-to-build-and-run-it-on-risc-v-binaries"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How to build and run it on RISC-V binaries</h2>
<p dir="auto">Application can be executed as a <em>sequential RISC-V simulator</em>
(sequential, one-instruction-at-a-time semantics), by
building and executing it as a standard F# program.</p>
<p dir="auto">Supported OS:</p>
<ul dir="auto">
<li>Linux</li>
<li>Windows</li>
<li>MacOS</li>
</ul>
<p dir="auto">Supported <strong>.NET SDK</strong>:</p>
<ul dir="auto">
<li>.NET SDK 2.2</li>
<li>.NET SDK 3.0</li>
</ul>
<h3 tabindex="-1" dir="auto"><a id="user-content-install-net-sdk" aria-hidden="true" href="#install-net-sdk"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Install .NET SDK</h3>
<p dir="auto">For Windows preferred way to use Visual Studio.</p>
<p dir="auto">Other examples will be for Linux.
Please follow to instruction <a href="https://dotnet.microsoft.com/download" rel="nofollow">https://dotnet.microsoft.com/download</a></p>
<p dir="auto">For Ubuntu:</p>
<div data-snippet-clipboard-copy-content="$ wget -q https://packages.microsoft.com/config/ubuntu/16.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
$ sudo dpkg -i packages-microsoft-prod.deb
$ sudo apt-get update
$ sudo apt-get install apt-transport-https
$ sudo apt-get update
$ sudo apt-get install dotnet-sdk-3.0"><pre><code>$ wget -q https://packages.microsoft.com/config/ubuntu/16.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
$ sudo dpkg -i packages-microsoft-prod.deb
$ sudo apt-get update
$ sudo apt-get install apt-transport-https
$ sudo apt-get update
$ sudo apt-get install dotnet-sdk-3.0
</code></pre></div>
<p dir="auto">To check installation:</p>
<p dir="auto"><code>$ dotnet --version</code></p>
<p dir="auto">will tell you what version of <code>dotnet</code> you have.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-make-the-application-executable" aria-hidden="true" href="#make-the-application-executable"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Make the application executable</h3>
<p dir="auto">You can build the application executable with:</p>
<p dir="auto"><code>$ dotnet build</code></p>
<h3 tabindex="-1" dir="auto"><a id="user-content-run-the-application-executable" aria-hidden="true" href="#run-the-application-executable"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Run the application executable</h3>
<p dir="auto">Most simple way to run immediately <code>run</code> (without
additional <code>build</code> command) to see command-line
options on the executable:</p>
<p dir="auto"><code>$ dotnet run -- --help</code></p>
<p dir="auto">If you run the application without option:</p>
<p dir="auto"><code>$ dotnet run</code></p>
<p dir="auto">you&#39;ll receive error message:</p>
<blockquote>
<p dir="auto">Wrong parameters put --help to get more information</p>
</blockquote>
<p dir="auto"><strong>Example</strong> to run specific ISA with extensions, verbosity
output and ELF file for execution in RISC-V CPI simulator:</p>
<p dir="auto"><code>$ dotnet run -- -A rv32i -v myapp.elf</code></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-how-to-contribute" aria-hidden="true" href="#how-to-contribute"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How to Contribute</h2>
<p dir="auto">Please read file <a href="http://shapr.github.io/mrLSD/riscv-fs/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-references" aria-hidden="true" href="#references"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>References</h2>
<ul dir="auto">
<li>github ISA manual: <a href="https://github.com/riscv/riscv-isa-manual">https://github.com/riscv/riscv-isa-manual</a></li>
<li>RISC-V specification: <a href="https://riscv.org/specifications/" rel="nofollow">https://riscv.org/specifications/</a></li>
<li>RISC-V Formal Verification Framework: <a href="https://github.com/SymbioticEDA/riscv-formal">https://github.com/SymbioticEDA/riscv-formal</a></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-licence" aria-hidden="true" href="#licence"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Licence</h2>
<p dir="auto"><strong>MIT License</strong></p>
</article>
          </div></div>
  </body>
</html>
