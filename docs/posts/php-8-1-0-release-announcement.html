<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.php.net/releases/8.1/en.php">Original</a>
    
    <div id="readability-page-1" class="page"><div id="layout">
  <section id="layout-content">


<section>
    <div>
        <h2 id="enumerations">
            Enumerations            <a href="https://wiki.php.net/rfc/enumerations">RFC</a> <a href="https://www.php.net/manual/en/language.enumerations.php">Doc</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>Status<br/></span><span>{</span><span>DRAFT </span><span>= </span><span>&#39;draft&#39;</span><span>;</span><span>PUBLISHED </span><span>= </span><span>&#39;published&#39;</span><span>;</span><span>ARCHIVED </span><span>= </span><span>&#39;archived&#39;</span><span>;</span><span>acceptStatus</span><span>(</span><span>string $status</span><span>) {...}</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span>enum Status<br/></span><span>{</span><span>Draft</span><span>;</span><span>Published</span><span>;</span><span>Archived</span><span>;</span><span>acceptStatus</span><span>(</span><span>Status $status</span><span>) {...}</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>
            Use enum instead of a set of constants and get validation out of the box.        </p>
    </div>

    <div>
        <h2 id="readonly_properties">
            Readonly Properties            <a href="https://wiki.php.net/rfc/readonly_properties_v2">RFC</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>BlogData<br/></span><span>{</span><span>Status $status</span><span>;</span><span>__construct</span><span>(</span><span>Status $status</span><span>) </span><span>$this</span><span>-&gt;</span><span>status </span><span>= </span><span>$status</span><span>;</span><span>getStatus</span><span>(): </span><span>Status </span><span>{</span><span>$this</span><span>-&gt;</span><span>status</span><span>;    </span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>BlogData<br/></span><span>{</span><span>readonly Status $status</span><span>;</span><span>__construct</span><span>(</span><span>Status $status</span><span>) </span><span>$this</span><span>-&gt;</span><span>status </span><span>= </span><span>$status</span><span>;</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>Readonly properties cannot be changed after initialization, i.e. after a value is assigned to them.</p>
    </div>

    <div>
        <h2 id="first_class_callable_syntax">
            First-class Callable Syntax            <a href="https://wiki.php.net/rfc/first_class_callable_syntax">RFC</a> <a href="https://www.php.net/manual/en/migration81.new-features.php#migration81.new-features.core.callable-syntax">Doc</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span>$foo </span><span>= [</span><span>$this</span><span>, </span><span>&#39;foo&#39;</span><span>];</span><span>$fn </span><span>= </span><span>Closure</span><span>::</span><span>fromCallable</span><span>(</span><span>&#39;strlen&#39;</span><span>);</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span>$foo </span><span>= </span><span>$this</span><span>-&gt;</span><span>foo</span><span>(...);</span><span>$fn </span><span>= </span><span>strlen</span><span>(...);</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>It is now possible to get a reference to any function – this is called first-class callable syntax.</p>
    </div>

    <div>
        <h2 id="new_in_initializers">
            New in initializers            <a href="https://wiki.php.net/rfc/new_in_initializers">RFC</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>Service <br/></span><span>{</span><span>Logger $logger</span><span>;</span><span>__construct</span><span>(</span><span>Logger $logger </span><span>= </span><span>null</span><span>,</span><span>$this</span><span>-&gt;</span><span>logger </span><span>= </span><span>$logger </span><span>?? new </span><span>NullLogger</span><span>();</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>Service <br/></span><span>{</span><span>Logger $logger</span><span>;</span><span>__construct</span><span>(</span><span>Logger $logger </span><span>= new </span><span>NullLogger</span><span>(),</span><span>$this</span><span>-&gt;</span><span>logger </span><span>= </span><span>$logger</span><span>;</span>
</span>
</code></p>                </div>
            </div>
        </div>

        <div>
            <p>Objects can now be used as default parameter values, static variables, and global constants, as well as in attribute arguments.</p>
            <p>This effectively makes it possible to use <strong>nested attributes</strong>.</p>        </div>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>User <br/></span><span>{</span><span>public </span><span>string $name </span><span>= </span><span>&#39;&#39;</span><span>;</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>User <br/></span><span>{</span><span>new \</span><span>Assert</span><span>\</span><span>NotNull</span><span>,</span><span>Assert</span><span>\</span><span>Length</span><span>(</span><span>min</span><span>: </span><span>6</span><span>))</span><span>string $name </span><span>= </span><span>&#39;&#39;</span><span>;</span>
</span>
</code></p>                </div>
            </div>
        </div>
    </div>

    <div>
        <h2 id="pure_intersection_types">
            Pure Intersection Types            <a href="https://wiki.php.net/rfc/pure-intersection-types">RFC</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>function </span><span>count_and_iterate</span><span>(</span><span>Iterator $value</span><span>) {</span><span>$value </span><span>instanceof </span><span>Countable</span><span>)) {</span><span>TypeError</span><span>(</span><span>&#39;value must be Countable&#39;</span><span>);</span><span>$value </span><span>as </span><span>$val</span><span>) {</span><span>$val</span><span>;</span><span>count</span><span>(</span><span>$value</span><span>);</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>function </span><span>count_and_iterate</span><span>(</span><span>Iterator</span><span>&amp;</span><span>Countable $value</span><span>) {</span><span>$value </span><span>as </span><span>$val</span><span>) {</span><span>$val</span><span>;</span><span>count</span><span>(</span><span>$value</span><span>);</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <div>
            <p>Use intersection types when a value needs to satisfy multiple type constraints at the same time.</p>
            <p>It is not currently possible to mix intersection and union types together such as <code>A&amp;B|C</code>.</p>        </div>
    </div>

    <div>
        <h2 id="never_return_type">
            Never return type            <a href="https://wiki.php.net/rfc/noreturn_type">RFC</a> <a href="https://www.php.net/manual/en/language.types.declarations.php#language.types.declarations.never">Doc</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>function </span><span>redirect</span><span>(</span><span>string $uri</span><span>) {</span><span>header</span><span>(</span><span>&#39;Location: &#39; </span><span>. </span><span>$uri</span><span>);</span><span>redirectToLoginPage</span><span>() {</span><span>redirect</span><span>(</span><span>&#39;/login&#39;</span><span>);</span><span>&#39;Hello&#39;</span><span>; </span><span>}</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>function </span><span>redirect</span><span>(</span><span>string $uri</span><span>): </span><span>never </span><span>{</span><span>header</span><span>(</span><span>&#39;Location: &#39; </span><span>. </span><span>$uri</span><span>);</span><span>redirectToLoginPage</span><span>(): </span><span>never </span><span>{</span><span>redirect</span><span>(</span><span>&#39;/login&#39;</span><span>);</span><span>&#39;Hello&#39;</span><span>; </span><span>}</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>A function or method declared with the <code>never</code> type indicates that it will not return a value and will either throw an exception or end the script’s execution with a call of <code>die()</code>, <code>exit()</code>, <code>trigger_error()</code>, or something similar.</p>
    </div>

    <div>
        <h2 id="final_class_constants">
            Final class constants            <a href="https://wiki.php.net/rfc/final_class_const">RFC</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>Foo<br/></span><span>{</span><span>XX </span><span>= </span><span>&#34;foo&#34;</span><span>;</span><span>Bar </span><span>extends </span><span>Foo<br/></span><span>{</span><span>XX </span><span>= </span><span>&#34;bar&#34;</span><span>; </span><span>}</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span></span><span>class </span><span>Foo<br/></span><span>{</span><span>XX </span><span>= </span><span>&#34;foo&#34;</span><span>;</span><span>Bar </span><span>extends </span><span>Foo<br/></span><span>{</span><span>XX </span><span>= </span><span>&#34;bar&#34;</span><span>; </span><span>}</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>It is possible to declare final class constants, so that they cannot be overridden in child classes.</p>
    </div>

    <div>
        <h2 id="explicit_octal_numeral_notation">
            Explicit Octal numeral notation            <a href="https://wiki.php.net/rfc/explicit_octal_notation">RFC</a> <a href="https://www.php.net/manual/en/migration81.new-features.php#migration81.new-features.core.octal-literal-prefix">Doc</a>
        </h2>
        <div>
            
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span>0o16 </span><span>=== </span><span>16</span><span>; </span><span>0o16 </span><span>=== </span><span>14</span><span>; </span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>It is now possible to write octal numbers with the explicit <code>0o</code> prefix.</p>
    </div>

    <div>
        <h2 id="fibers">
            Fibers            <a href="https://wiki.php.net/rfc/fibers">RFC</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span>$httpClient</span><span>-&gt;</span><span>request</span><span>(</span><span>&#39;https://example.com/&#39;</span><span>)</span><span>then</span><span>(function (</span><span>Response $response</span><span>) {</span><span>$response</span><span>-&gt;</span><span>getBody</span><span>()-&gt;</span><span>buffer</span><span>();</span><span>then</span><span>(function (</span><span>string $responseBody</span><span>) {</span><span>json_decode</span><span>(</span><span>$responseBody</span><span>)[</span><span>&#39;code&#39;</span><span>];</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span>$response </span><span>= </span><span>$httpClient</span><span>-&gt;</span><span>request</span><span>(</span><span>&#39;https://example.com/&#39;</span><span>);</span><span>json_decode</span><span>(</span><span>$response</span><span>-&gt;</span><span>getBody</span><span>()-&gt;</span><span>buffer</span><span>())[</span><span>&#39;code&#39;</span><span>];</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <div>
            <p>Fibers are primitives for implementing lightweight cooperative concurrency. They are a means of creating code blocks that can be paused and resumed like Generators, but from anywhere in the stack. Fibers themselves don&#39;t magically provide concurrency, there still needs to be an event loop. However, they allow blocking and non-blocking implementations to share the same API.</p><p>Fibers allow getting rid of the boilerplate code previously seen with <code>Promise::then()</code> or Generator based coroutines. Libraries will generally build further abstractions around Fibers, so there&#39;s no need to interact with them directly.</p>        </div>
    </div>

    <div>
        <h2 id="array_unpacking_support_for_string_keyed_arrays">
            Array unpacking support for string-keyed arrays            <a href="https://wiki.php.net/rfc/array_unpacking_string_keys">RFC</a>
        </h2>
        <div>
            <div>
                <p>PHP &lt; 8.1</p>
                <div>
                    <p><code><span>
<span>$arrayA </span><span>= [</span><span>&#39;a&#39; </span><span>=&gt; </span><span>1</span><span>];<br/></span><span>$arrayB </span><span>= [</span><span>&#39;b&#39; </span><span>=&gt; </span><span>2</span><span>];</span><span>$result </span><span>= </span><span>array_merge</span><span>([</span><span>&#39;a&#39; </span><span>=&gt; </span><span>0</span><span>], </span><span>$arrayA</span><span>, </span><span>$arrayB</span><span>);</span>
</span>
</code></p>                </div>
            </div>
            
            <div>
                <p>PHP 8.1</p>
                <div>
                    <p><code><span>
<span>$arrayA </span><span>= [</span><span>&#39;a&#39; </span><span>=&gt; </span><span>1</span><span>];<br/></span><span>$arrayB </span><span>= [</span><span>&#39;b&#39; </span><span>=&gt; </span><span>2</span><span>];</span><span>$result </span><span>= [</span><span>&#39;a&#39; </span><span>=&gt; </span><span>0</span><span>, ...</span><span>$arrayA</span><span>, ...</span><span>$arrayB</span><span>];</span>
</span>
</code></p>                </div>
            </div>
        </div>
        <p>PHP supported unpacking inside arrays through the spread operator before, but only if the arrays had integer keys. Now it is possible to unpack arrays with string keys too.</p>
    </div>
</section>

<section>
    <div>
        <h2 id="performance_improvements">Performance Improvements</h2>
        <div>
            <div>
                <p><strong>Symfony Demo App request time</strong></p></div>
            <h3>The result (relative to PHP 8.0):</h3>
            <ul>
                <li>23.0% Symfony Demo speedup</li>
                <li>3.5% WordPress speedup</li>
            </ul>
            <h3>Performance related features in PHP 8.1:</h3>
            <ul>
                <li>JIT backend for ARM64 (AArch64)</li>
                <li>Inheritance cache (avoid relinking classes in each request)</li>
                <li>Fast class name resolution (avoid lowercasing and hash lookup)</li>
                <li>timelib and ext/date performance improvements</li>
                <li>SPL file-system iterators improvements</li>
                <li>serialize/unserialize optimizations</li>
                <li>Some internal functions optimization (get_declared_classes(), explode(), strtr(), strnatcmp(), dechex())</li>
                <li>JIT improvements and fixes</li>
            </ul>
        </div>
    </div>

    <div>
        <h2 id="other_new_things">New Classes, Interfaces, and Functions</h2>
        <div>
            <ul>
                <li>New <code>#[ReturnTypeWillChange]</code> attribute.</li>
                <li>New <code>fsync</code> and <code>fdatasync</code> functions.</li>
                <li>New <code>array_is_list</code> function.</li>
                <li>New Sodium XChaCha20 functions.</li>
            </ul>
        </div>
        <h2 id="deprecations_and_bc_breaks">Deprecations and backward compatibility breaks</h2>
        <div>
            <ul>
                <li>Passing null to non-nullable internal function parameters is deprecated.</li>
                <li>Tentative return types in PHP built-in class methods</li>
                <li><code>Serializable</code> interface deprecated.</li>
                <li>HTML entity en/decode functions process single quotes and substitute by default.</li>
                <li><code>$GLOBALS</code> variable restrictions.</li>
                <li>MySQLi: Default error mode set to exceptions.</li>
                <li>Implicit incompatible float to int conversion is deprecated.</li>
                <li>finfo Extension: <code>file_info</code> resources migrated to existing finfo objects.</li>
                <li>IMAP: imap resources migrated to <code>IMAP\Connection</code> class objects.</li>
                <li>FTP Extension: Connection resources migrated to <code>FTP\Connection</code> class objects.</li>
                <li>GD Extension: Font identifiers migrated to <code>GdFont</code> class objects.</li>
                <li>LDAP: resources migrated to <code>LDAP\Connection</code>, <code>LDAP\Result</code>, and <code>LDAP\ResultEntry</code> objects.</li>
                <li>PostgreSQL: resources migrated to <code>PgSql\Connection</code>, <code>PgSql\Result</code>, and <code>PgSql\Lob</code> objects.</li>
                <li>Pspell: pspell, pspell config resources migrated to <code>PSpell\Dictionary</code>, <code>PSpell\Config</code> class objects.</li>
            </ul>
        </div>
    </div>
</section>



    </section><!-- layout-content -->
    

  </div></div>
  </body>
</html>
