<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://brian.abelson.live/log/2025/01/07/added-simple-search-functionality-to-this-site.html">Original</a>
    <h1>I added search functionality to this site using Lunr.js</h1>
    
    <div id="readability-page-1" class="page"><section>
    <div>
        <div>
            <div>
                <div>
                    <article>
                        <header>
                            
                            
                            
                            
                        </header>
                        
                        
                        
                        <center>
                            <img src="https://brian.abelson.live/assets/img/posts/2025-01-07-search-page-small.png" alt="I added search functionality to this site using Lunr.js" width="90%"/>
                        </center>
                        
                        
                        <div>
                            <p>Following <a href="https://www.stephanmiller.com/static-site-search/">this simple tutorial</a>, I added a <a href="https://brian.abelson.live/search">search page</a> to this Jeykll-site.</p>

<p>It harnesses <a href="https://lunrjs.com/">Lunr.js</a> under-the-hood. The cool thing about it is that, since Jekyll is a static-site generator, you can build the search index on each deploy using liquid templates.</p>

<div><div><pre><code>
<span>&lt;</span><span>script</span><span>&gt;</span>
  <span>// Template to generate the JSON to search</span>
  <span>window</span><span>.</span><span>store</span> <span>=</span> <span>{</span>
    <span>{</span><span>%</span> <span>for</span> <span>post</span> <span>in</span> <span>site</span><span>.</span><span>pages</span> <span>%</span><span>}</span>
    <span>{</span><span>%</span> <span>if</span> <span>post</span><span>.</span><span>exclude_from_search</span> <span>!=</span> <span>true</span> <span>%</span><span>}</span>
      <span>&#34;</span><span>{{ post.url | slugify }}</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>title</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>{{ post.title | xml_escape }}</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>categories</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>{{ post.categories | join: &#39; &#39; | xml_escape }}</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>content</span><span>&#34;</span><span>:</span> <span>{{</span> <span>post</span><span>.</span><span>content</span> <span>|</span> <span>strip_html</span> <span>|</span> <span>strip_newlines</span> <span>|</span> <span>jsonify</span> <span>}},</span>
        <span>&#34;</span><span>url</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>{{ post.url | xml_escape }}</span><span>&#34;</span>
      <span>},</span>
    <span>{</span><span>%</span> <span>endif</span> <span>%</span><span>}</span>
    <span>{</span><span>%</span> <span>endfor</span> <span>%</span><span>}</span>
    <span>{</span><span>%</span> <span>for</span> <span>post</span> <span>in</span> <span>site</span><span>.</span><span>posts</span> <span>%</span><span>}</span>
      <span>&#34;</span><span>{{ post.url | slugify }}</span><span>&#34;</span><span>:</span> <span>{</span>
        <span>&#34;</span><span>title</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>{{ post.title | xml_escape }}</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>categories</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>{{ post.categories | join: &#39; &#39; | xml_escape }}</span><span>&#34;</span><span>,</span>
        <span>&#34;</span><span>content</span><span>&#34;</span><span>:</span> <span>{{</span> <span>post</span><span>.</span><span>content</span> <span>|</span> <span>strip_html</span> <span>|</span> <span>strip_newlines</span> <span>|</span> <span>jsonify</span> <span>}},</span>
        <span>&#34;</span><span>url</span><span>&#34;</span><span>:</span> <span>&#34;</span><span>{{ post.url | xml_escape }}</span><span>&#34;</span>
      <span>}</span>
      <span>{</span><span>%</span> <span>unless</span> <span>forloop</span><span>.</span><span>last</span> <span>%</span><span>},{</span><span>%</span> <span>endunless</span> <span>%</span><span>}</span>
    <span>{</span><span>%</span> <span>endfor</span> <span>%</span><span>}</span>
  <span>};</span>
<span>&lt;</span><span>/script</span><span>&gt;
</span>
</code></pre></div></div>

<p>I added an “exclude_from_search” parameter to certain page’s <a href="https://jekyllrb.com/docs/front-matter/">front matter</a> so I can control what shows up in the search results.</p>

<p>This is mostly for my own usage, but <a href="https://brian.abelson.live/log/2025/01/02/daily-link-blog.html">maybe if I blog more</a>, it’ll be useful to others.</p>

                        </div>
                        
                        
                        
                        <hr/>
                        
                        
                    </article>
                    
                </div>
            </div>
        </div>
    </div>
</section></div>
  </body>
</html>
