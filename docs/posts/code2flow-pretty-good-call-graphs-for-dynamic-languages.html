<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/scottrogowski/code2flow">Original</a>
    <h1>Code2flow: Pretty good call graphs for dynamic languages</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
          <article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://raw.githubusercontent.com/scottrogowski/code2flow/master/assets/code2flowlogo.png"><img src="https://raw.githubusercontent.com/scottrogowski/code2flow/master/assets/code2flowlogo.png" alt="code2flow logo"/></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/8552de46aef1c3cc417c975bd72d0fbf97d390e2ea58a057909c1f9f27de85ae/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f76657273696f6e2d322e332e302d627269676874677265656e"><img src="https://camo.githubusercontent.com/8552de46aef1c3cc417c975bd72d0fbf97d390e2ea58a057909c1f9f27de85ae/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f76657273696f6e2d322e332e302d627269676874677265656e" alt="Version 2.3.0" data-canonical-src="https://img.shields.io/badge/version-2.3.0-brightgreen"/></a> <a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/09b67be8c32f58eba1128935b35db132aad8a14fc8bde5ec8d2e82bfdf69e171/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6275696c642d70617373696e672d627269676874677265656e"><img src="https://camo.githubusercontent.com/09b67be8c32f58eba1128935b35db132aad8a14fc8bde5ec8d2e82bfdf69e171/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6275696c642d70617373696e672d627269676874677265656e" alt="Build passing" data-canonical-src="https://img.shields.io/badge/build-passing-brightgreen"/></a> <a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/cf2cfe891dcb56fd88e8a7bbe16c67626c3c04e265ea60c26391ce7192fd4a69/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f7665726167652d3130302532352d627269676874677265656e"><img src="https://camo.githubusercontent.com/cf2cfe891dcb56fd88e8a7bbe16c67626c3c04e265ea60c26391ce7192fd4a69/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f636f7665726167652d3130302532352d627269676874677265656e" alt="Coverage 100%" data-canonical-src="https://img.shields.io/badge/coverage-100%25-brightgreen"/></a> <a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/d507b8c8ae6e50418b837772e25137dedb81ed0693b1c1b4e3bb9821eac61620/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d677265656e253544"><img src="https://camo.githubusercontent.com/d507b8c8ae6e50418b837772e25137dedb81ed0693b1c1b4e3bb9821eac61620/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d677265656e253544" alt="License MIT" data-canonical-src="https://img.shields.io/badge/license-MIT-green%5D"/></a></p>
<p dir="auto">Code2flow generates <a href="https://en.wikipedia.org/wiki/Call_graph" rel="nofollow">call graphs</a> for dynamic programming language. Code2flow supports Python, Javascript, Ruby, and PHP.</p>
<p dir="auto">The basic algorithm is simple:</p>
<ol dir="auto">
<li>Translate your source files into ASTs.</li>
<li>Find all function definitions.</li>
<li>Determine where those functions are called.</li>
<li>Connect the dots.</li>
</ol>
<p dir="auto">Code2flow is useful for:</p>
<ul dir="auto">
<li>Untangling spaghetti code.</li>
<li>Identifying orphaned functions.</li>
<li>Getting new developers up to speed.</li>
</ul>
<p dir="auto">Code2flow will provide a <em>pretty good estimate</em> of your project&#39;s structure. No algorithm can generate a perfect call graph for a <a href="https://en.wikipedia.org/wiki/Dynamic_programming_language" rel="nofollow">dynamic language</a> - even less so if that language is <a href="https://en.wikipedia.org/wiki/Duck_typing" rel="nofollow">duck-typed</a>. See the known limitations in the section below.</p>
<p dir="auto"><em>(Below: Code2flow running on itself (excl javascript, PHP, &amp; Ruby for clarity))</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://raw.githubusercontent.com/scottrogowski/code2flow/master/assets/code2flow_output.png"><img src="https://raw.githubusercontent.com/scottrogowski/code2flow/master/assets/code2flow_output.png" alt="code2flow running against itself"/></a></p>
<h2 dir="auto"><a id="user-content-installation" aria-hidden="true" href="#installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Installation</h2>

<p dir="auto">If you don&#39;t have it already, you will also need to install graphviz. Installation instructions can be found <a href="https://graphviz.org/download/" rel="nofollow">here</a>.</p>
<p dir="auto">Additionally, depending on the language you want to parse, you may need to install additional dependencies:</p>
<ul dir="auto">
<li>Javascript: <a href="https://www.npmjs.com/package/acorn" rel="nofollow">Acorn</a></li>
<li>Ruby: <a href="https://github.com/whitequark/parser">Parser</a></li>
<li>PHP: <a href="https://github.com/nikic/PHP-Parser">PHP-Parser</a></li>
<li>Python: No extra dependencies needed</li>
</ul>
<h2 dir="auto"><a id="user-content-usage" aria-hidden="true" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Usage</h2>
<p dir="auto">To generate a DOT file run something like:</p>
<div data-snippet-clipboard-copy-content="code2flow mypythonfile.py"><pre>code2flow mypythonfile.py</pre></div>
<p dir="auto">Or, for javascript:</p>
<div data-snippet-clipboard-copy-content="code2flow myjavascriptfile.js"><pre>code2flow myjavascriptfile.js</pre></div>
<p dir="auto">You can also specify multiple files or import directories:</p>
<div data-snippet-clipboard-copy-content="code2flow project/directory/source_a.js project/directory/source_b.js"><pre>code2flow project/directory/source_a.js project/directory/source_b.js</pre></div>
<div data-snippet-clipboard-copy-content="code2flow project/directory/*.js"><pre>code2flow project/directory/<span>*</span>.js</pre></div>
<div data-snippet-clipboard-copy-content="code2flow project/directory --language js"><pre>code2flow project/directory --language js</pre></div>
<p dir="auto">There are a ton of command line options, to see them all, run:</p>

<h2 dir="auto"><a id="user-content-how-code2flow-works" aria-hidden="true" href="#how-code2flow-works"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How code2flow works</h2>
<p dir="auto">Code2flow approximates the structure of projects in dynamic languages. It is <em>not possible</em> to generate a perfect callgraph for a dynamic language.</p>
<p dir="auto">Detailed algorithm:</p>
<ol dir="auto">
<li>Generate an AST of the source code</li>
<li>Recursively separate groups and nodes. Groups are files, modules, or classes. More precisely, groups are namespaces where functions live. Nodes are the functions themselves.</li>
<li>For all nodes, identify function calls in those nodes.</li>
<li>For all nodes, identify in-scope variables. Attempt to connect those variables to specific nodes and groups. This is where there is some ambiguity in the algorithm because it is possible to know the types of variables in dynamic languages. So, instead, heuristics must be used.</li>
<li>For all calls in all nodes, attempt to find a match from the in-scope variables. This will be an edge.</li>
<li>If a definitive match from in-scope variables cannot be found, attempt to find a single match from all other groups and nodes.</li>
<li>Trim orphaned nodes and groups.</li>
<li>Output results.</li>
</ol>
<h2 dir="auto"><a id="user-content-why-is-it-impossible-to-generate-a-perfect-call-graph" aria-hidden="true" href="#why-is-it-impossible-to-generate-a-perfect-call-graph"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Why is it impossible to generate a perfect call graph?</h2>
<p dir="auto">Consider this toy example in Python</p>
<div data-snippet-clipboard-copy-content="def func_factory(param):
    if param &lt; .5:
        return func_a
    else:
        return func_b

func = func_factory(important_variable)
func()"><pre><span>def</span> <span>func_factory</span>(<span>param</span>):
    <span>if</span> <span>param</span> <span>&lt;</span> <span>.5</span>:
        <span>return</span> <span>func_a</span>
    <span>else</span>:
        <span>return</span> <span>func_b</span>

<span>func</span> <span>=</span> <span>func_factory</span>(<span>important_variable</span>)
<span>func</span>()</pre></div>
<p dir="auto">We have no way of knowing whether <code>func</code> will point to <code>func_a</code> or <code>func_b</code> until runtime. In practice, ambiguity like this is common and is present in most non-trivial applications.</p>
<h2 dir="auto"><a id="user-content-known-limitations" aria-hidden="true" href="#known-limitations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Known limitations</h2>
<p dir="auto">Code2flow is internally powered by ASTs. Most limitations stem from a token not being named what code2flow expects it to be named.</p>
<ul dir="auto">
<li>All functions without definitions are skipped. This most often happens when a file is not included.</li>
<li>Functions with identical names in different namespaces are (loudly) skipped. E.g. If you have two classes with identically named methods, code2flow cannot distinguish between these and skips them.</li>
<li>Imported functions from outside of your project directory (including from standard libraries) which share names with your defined functions may not be handled correctly. Instead when you call the imported function, code2flow will link to your local functions. E.g. if you have a function &#34;search()&#34; and call, &#34;import searcher; searcher.search()&#34;, code2flow may link (incorrectly) to your defined function.</li>
<li>Anonymous or generated functions are skipped. This includes lambdas and factories.</li>
<li>If a function is renamed, either explicitly or by being passed around as a parameter, it will be skipped.</li>
</ul>
<h2 dir="auto"><a id="user-content-how-to-contribute" aria-hidden="true" href="#how-to-contribute"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to contribute</h2>
<ol dir="auto">
<li><strong>Open an issue</strong>: Code2flow is not perfect and there is a lot that can be improved. If you find a problem parsing your source that you can identify with a simplified example, please open an issue.</li>
<li><strong>Create a PR</strong>: Even better, if you have a fix for the issue you identified that passes unit tests, please open a PR.</li>
<li><strong>Add a language</strong>: While dense, each language implementation is between 250-400 lines of code including comments. If you want to implement another language, the existing implementations can be your guide.</li>
</ol>
<h2 dir="auto"><a id="user-content-license" aria-hidden="true" href="#license"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>License</h2>
<p dir="auto">Code2flow is licensed under the MIT license.
Prior to the rewrite in April 2021, code2flow was licensed under LGPL. The last commit under that license was 24b2cb854c6a872ba6e17409fbddb6659bf64d4c.
The April 2021 rewrite was substantial so it&#39;s probably reasonable to treat code2flow as completely MIT-licensed.</p>
<h2 dir="auto"><a id="user-content-acknowledgements" aria-hidden="true" href="#acknowledgements"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Acknowledgements</h2>
<ul dir="auto">
<li>In mid-2021, Code2flow was rewritten and two new languages were added. This was prompted and financially supported by the <a href="https://siderlabs.com/" rel="nofollow">Sider Corporation</a>.</li>
<li>The code2flow pip name was graciouly transferred to this project from <a href="https://github.com/Dheeraj1998">Dheeraj Nair</a>. He was using it for his own (unrelated) <a href="https://github.com/Dheeraj1998/code2flow">code2flow</a> project.</li>
<li>Many others have contributed through bug fixes, cleanups, and identifying issues. Thank you!!!</li>
</ul>
<h2 dir="auto"><a id="user-content-unrelated-projects" aria-hidden="true" href="#unrelated-projects"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Unrelated projects</h2>
<p dir="auto">The name, &#34;code2flow&#34;, has been used for several unrelated projects. Specifically, the domain, code2flow.com, has no association with this project. I&#39;ve never heard anything from them and it doesn&#39;t appear like they use anything from here.</p>
<h2 dir="auto"><a id="user-content-unit-tests" aria-hidden="true" href="#unit-tests"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Unit tests</h2>
<p dir="auto">Test coverage is 100%. To run:</p>
<div data-snippet-clipboard-copy-content="pip install -r requirements_dev.txt
make test"><pre><code>pip install -r requirements_dev.txt
make test
</code></pre></div>
<h2 dir="auto"><a id="user-content-feedback--contact" aria-hidden="true" href="#feedback--contact"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Feedback / Contact</h2>
<p dir="auto">Please do email!
<a href="mailto:scottmrogowski@gmail.com">scottmrogowski@gmail.com</a></p>
<h2 dir="auto"><a id="user-content-feature-requests" aria-hidden="true" href="#feature-requests"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Feature Requests</h2>
<p dir="auto">Email me. At any time, I&#39;m spread thin across a lot of projects so I will, unfortunately, turn down most requests. However, I am open to paid development for compelling features.</p>
</article>
        </div></div>
  </body>
</html>
