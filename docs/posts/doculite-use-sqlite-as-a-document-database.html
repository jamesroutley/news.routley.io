<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.npmjs.com/package/doculite">Original</a>
    <h1>Show HN: Doculite â€“ Use SQLite as a Document Database</h1>
    
    <div id="readability-page-1" class="page"><div><article> <div id="readme">
<p>DocuLite lets you use SQLite like Firebase Firestore. It&#39;s written in Typescript and an adapter on top of sqlite3 and sqlite. It support listeners on documents, collections, and basic queries. Feedback &amp; Bugs to <a href="mailto:thedoculite@gmail.com">thedoculite@gmail.com</a>.
This is early work, so please treat it appropriately.</p>

<h2><a id="user-content-1-initialize-a-db" aria-hidden="true" href="#1-initialize-a-db"><span aria-hidden="true"></span></a>1. Initialize a DB</h2>
<p>Example:</p>
<pre><code>import { Database } from &#34;doculite&#34;
const db = new Database();
</code></pre>
<h2><a id="user-content-2-create-collections-and-set-documents" aria-hidden="true" href="#2-create-collections-and-set-documents"><span aria-hidden="true"></span></a>2. Create Collections and Set Documents</h2>
<p>Collections are created on first insertion of a document. They are represented by a SQLite Table.</p>
<pre><code>// create ref to the doc. Doc ID optional.

const usersRef = db.collection(&#34;users&#34;).doc(&#34;123&#34;);
const refWithoutId = db.collection(&#34;users&#34;).doc();

// Any valid Javascript object that can be parsed to valid JSON can be inserted as a document.

await usersRef.set({ username: &#34;John Doe&#34;, createdAt: &#34;123&#34;, updatedAt: &#34;123&#34; });
await refWithoutId.set({ username: &#34;Jane Doe&#34; });

</code></pre>
<h2><a id="user-content-3-get-a-particular-document" aria-hidden="true" href="#3-get-a-particular-document"><span aria-hidden="true"></span></a>3. Get a particular document</h2>
<pre><code>// define ref
const usersRef = db.collection(&#34;users&#34;).doc(&#34;123&#34;);
// get
const user = await usersRef.get();
// print
console.log(user); // prints { username: &#34;John Doe&#34; };

</code></pre>
<h2><a id="user-content-4-update-documents-in-collections" aria-hidden="true" href="#4-update-documents-in-collections"><span aria-hidden="true"></span></a>4. Update Documents in Collections</h2>
<pre><code>// ref
const usersRef = db.collection(&#34;users&#34;).doc(&#34;123&#34;);

// Properties existing on both old and new object will be updated.
// Properties only existing on the new object will be added.

// If merge is false, properties only present on the old object will be deleted.
// Merge is true by default

await ref.set({ username: &#34;DERP Doe&#34;, updatedAt: &#34;345&#34; }, { merge: true });
// document in DB is now { username: &#34;DERP Doe&#34;, updatedAt: &#34;345&#34;, createdAt: &#34;123&#34; }

await ref.set({ username: &#34;DERP Doe&#34;, updatedAt: &#34;345&#34; }, { merge: false });
// document in DB is now { username: &#34;DERP Doe&#34;, updatedAt: &#34;345&#34; }

</code></pre>
<h2><a id="user-content-5-delete-documents-in-collection" aria-hidden="true" href="#5-delete-documents-in-collection"><span aria-hidden="true"></span></a>5. Delete Documents in Collection</h2>
<pre><code>const db = new Database();

const ref = db.collection(&#34;users&#34;).doc(&#34;deletable&#34;);

await ref.set({ username: &#34;deletableUsername&#34;, updatedAt: 123123 });

await ref.delete();

const doc = await ref.get();

console.log(doc) // prints null

</code></pre>
<h2><a id="user-content-6-listen-to-real-time-updates-of-documents" aria-hidden="true" href="#6-listen-to-real-time-updates-of-documents"><span aria-hidden="true"></span></a>6. Listen to real-time updates of documents.</h2>
<pre><code>
// ref to doc
const ref = db.collection(&#34;users&#34;).doc(&#34;123&#34;);

// snapshot listener returns unsubscribe function
const unsub = ref.onSnapshot((doc) =&gt; {
console.log(&#34;Omg the user doc is updating!&#34;, doc?.username);
});

await ref.set({ username: &#34;SHEESH Doe&#34;, updatedAt: 2 });
// prints: `Omg the user doc is updating! SHEESH Doe`

// unsub
unsub();

</code></pre>
<h2><a id="user-content-7-query-documents-in-a-collection-by-equality-comparison" aria-hidden="true" href="#7-query-documents-in-a-collection-by-equality-comparison"><span aria-hidden="true"></span></a>7. Query Documents in a collection by equality comparison</h2>
<pre><code>
const usersRef = db.collection(&#34;users&#34;);

await usersRef.doc().set({ username: &#34;Doculite&#34;, updatedAt: 234 });

const query = usersRef.where(&#34;username&#34;, &#34;Doculite&#34;);

const docs = await query.get();

const user = docs[0]

console.log(user.username) // prints `Doculite`

</code></pre>

<ol>
<li>Better query-based system</li>
<li>Stability and speed updates</li>
<li>Delete collections</li>
<li>Subcollections</li>
<li>Listeners on queries / multiple documents</li>
<li>Queries with other comparison operators (&lt;, &gt;, &gt;=, &lt;=, contains, etc.)</li>
<li>Queries for multiple variables (without indexes, probably)</li>
<li>Queries with Full Text Search (without indexes, probably)</li>
</ol>
<pre><code>
</code></pre>
</div></article></div></div>
  </body>
</html>
