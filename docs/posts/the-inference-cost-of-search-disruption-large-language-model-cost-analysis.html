<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.semianalysis.com/p/the-inference-cost-of-search-disruption">Original</a>
    <h1>The Inference Cost of Search Disruption – Large Language Model Cost Analysis</h1>
    
    <div id="readability-page-1" class="page"><div><div dir="auto"><p><span>OpenAI’s ChatGPT took the world by storm, quickly amassing </span><a href="https://www.reuters.com/technology/chatgpt-sets-record-fastest-growing-user-base-analyst-note-2023-02-01/" rel="">over 100 million active users</a><span> in January alone. This is the fastest any application has ever grown to this size, with the prior two record keepers being TikTok at 9 months and Instagram at 2.5 years. The top question on everyone’s mind is how disruptive large language models (LLMs) will be for search. Microsoft rocked the world this week with their Bing announcement, incorporating OpenAI’s technology into search.</span></p><blockquote><p>This new Bing will make Google come out and dance, and I want people to know that we made them dance.</p><p><a href="https://www.theverge.com/23589994/microsoft-ceo-satya-nadella-bing-chatgpt-google-search-ai" rel="">Satya Nadella, Microsoft CEO</a></p></blockquote><p><span>Google’s recent actions make it look like they are dancing. While </span><a href="https://www.semianalysis.com/i/97006309/tensorflow-vs-pytorch" rel="">we believe Google has better models and AI expertise</a><span> than any other firm in the world, they do not have a culture conducive to implementing and commercializing much of its leading technology. The competitive pressures from Microsoft and OpenAI are changing this rapidly.</span></p><p><span>Disruption and innovation in search don’t come for free. The </span><a href="https://www.semianalysis.com/p/the-ai-brick-wall-a-practical-limit" rel="">costs to train an LLM, as we detailed here</a><span>, are high. More importantly, inference costs far exceed training costs when deploying a model at any reasonable scale. In fact, the costs to inference ChatGPT exceed the training costs on a weekly basis. If ChatGPT-like LLMs are deployed into search, that represents a direct transfer of $30 billion of Google’s profit into the hands of the picks and shovels of the computing industry.</span></p><p><span>Today we will dive into the differing uses of LLMs for search, the daily costs of ChatGPT, the cost of inference for LLMs, Google’s search disruption effects with numbers, hardware requirements for LLM inference workloads, including performance improvement figures for Nvidia’s H100 and TPU cost comparisons, sequence length, latency criteria, the various levers that can be adjusted, the differing approaches to this problem by Microsoft, Google, and Neeva, and </span><a href="https://www.semianalysis.com/p/the-ai-brick-wall-a-practical-limit" rel="">how the model architecture of OpenAI’s next model architecture, which we detailed here</a><span> dramatically reduces costa on multiple fronts.</span></p><p>First off, let’s define the parameters of the search market. Our sources indicate that Google runs ~320,000 search queries per second. Compare this to Google’s Search business segment, which saw revenue of $162.45 billion in 2022, and you get to an average revenue per query of 1.61 cents. From here, Google has to pay for a tremendous amount of overhead from compute and networking for searches, advertising, web crawling, model development, employees, etc. A noteworthy line item in Google’s cost structure is that they paid in the neighborhood of ~$20B to be the default search engine on Apple’s products.</p><p>Google’s Services business unit has an operating margin of 34.15%. If we allocate the COGS/operating expense per query, you arrive at the cost of 1.06 cents per search query, generating 1.61 cents of revenue. This means that a search query with an LLM has to be significantly less than &lt;0.5 cents per query, or the search business would become tremendously unprofitable for Google.</p><blockquote><p>We’re excited to announce the new Bing is running on a new, next-generation OpenAI large language model that is more powerful than ChatGPT and customized specifically for search. It takes key learnings and advancements from ChatGPT and GPT-3.5 – and it is even faster, more accurate and more capable.</p><p><a href="https://blogs.microsoft.com/blog/2023/02/07/reinventing-search-with-a-new-ai-powered-microsoft-bing-and-edge-your-copilot-for-the-web/" rel="">Microsoft</a></p></blockquote><p>Estimating ChatGPT costs is a tricky proposition due to several unknown variables. We built a cost model indicating that ChatGPT costs $694,444 per day to operate in compute hardware costs. OpenAI requires ~3,617 HGX A100 servers (28,936 GPUs) to serve Chat GPT. We estimate the cost per query to be 0.36 cents.</p><h6>Our model is built from the ground up on a per-inference basis, but it lines up with Sam Altman’s tweet and an interview he did recently. We assume that OpenAI used a GPT-3 dense model architecture with a size of 175 billion parameters, hidden dimension of 16k, sequence length of 4k, average tokens per response of 2k, 15 responses per user, 13 million daily active users, FLOPS utilization rates 2x higher than FasterTransformer at &lt;2000ms latency, int8 quantization, 50% hardware utilization rates due to purely idle time, and $1 cost per GPU hour.</h6><p>Please challenge our assumptions; we would love to make this more accurate, although we believe we are in the correct ballpark.</p><p>If the ChatGPT model were ham-fisted into Google’s existing search businesses, the impact would be devastating. There would be a $36 Billion reduction in operating income. This is $36 Billion of LLM inference costs.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 1456w" sizes="100vw"/><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png" width="1456" height="480" data-attrs="{&#34;src&#34;:&#34;https://substack-post-media.s3.amazonaws.com/public/images/41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png&#34;,&#34;fullscreen&#34;:null,&#34;imageSize&#34;:null,&#34;height&#34;:480,&#34;width&#34;:1456,&#34;resizeWidth&#34;:null,&#34;bytes&#34;:123476,&#34;alt&#34;:null,&#34;title&#34;:null,&#34;type&#34;:&#34;image/png&#34;,&#34;href&#34;:null,&#34;belowTheFold&#34;:true,&#34;internalRedirect&#34;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F41a1d485-53c4-4291-8a7b-e04583bf428e_2101x692.png 1456w" sizes="100vw" loading="lazy"/></picture></div></a></figure></div><p><span>Deploying current ChatGPT into every search done by Google would require 512,820.51 A100 HGX servers with a total of 4,102,568 A100 GPUs. </span><strong>The total cost of these servers and networking exceeds $100 billion of Capex alone</strong><span>, of which Nvidia would receive a large portion. This is never going to happen, of course, but fun thought experiment if we assume no software or hardware improvements are made. We also have inference costs using Google’s TPUv4 and v5 modeled in the subscriber section, which are pretty different. We also have some H100 LLM inference performance improvement figures as well.</span></p><p>The amazing thing is that Microsoft knows that LLM insertion into search will crush the profitability of search and require massive Capex. While we estimated the operating margin shift, check out what Satya Nadella says about the gross margin.</p><blockquote><p>From now on, the [gross margin] of search is going to drop forever.</p><p><a href="https://www.ft.com/content/2d48d982-80b2-49f3-8a83-f5afef98e8eb" rel="">Satya Nadella, Microsoft CEO</a></p></blockquote><p>This doesn’t even account for the fact that search volumes likely decrease somewhat as search quality improves, the difficulties in inserting ads into an LLM’s response, or a myriad of other technical issues that we will discuss later in this report.</p><p>Microsoft is happily blowing up the profitability of the search market.</p><blockquote><p>For every one point of share gain in the search advertising market, it’s a $2 billion revenue opportunity for our advertising business.</p><p><a href="https://view.officeapps.live.com/op/view.aspx?src=https://c.s-microsoft.com/en-us/CMSFiles/Transcript223.docx?version=e69dc7f8-a0b8-7d09-ff82-f821891ad767" rel="">Microsoft</a></p></blockquote><p>Bing has a meager market share. Any share gains Microsoft grabs will give them tremendous top-line and bottom-line financials.</p><blockquote><p>I think there’s so much upside for both of us here. We’re going to discover what these new models can do, but if I were sitting on a lethargic search monopoly and had to think about a world where there was going to be a real challenge to the way that monetization of this works and new ad units, and maybe even a temporary downward pressure, I would not feel great about that.</p><p>There’s so much value here, it’s inconceivable to me that we can’t figure out how to ring the cash register on it.</p><p><a href="https://stratechery.com/2023/new-bing-and-an-interview-with-kevin-scott-and-sam-altman-about-the-microsoft-openai-partnership/" rel="">Sam Altman, CEO OpenAI on Stratechery</a><span> </span></p></blockquote><p>Meanwhile, Google is on the defensive. If their search franchise falters, they have a tremendous problem with their bottom line. Share losses will look even worse than the analysis above as Google is quite bloated in operating costs.</p><p>Google isn’t taking this lying down. Within just a couple of months of ChatGPT’s release, Google is already putting their version of search with an LLM into the public sphere. There are advantages and disadvantages from what we have seen on the new Bing vs. the new Google.</p><p><span>Bing GPT seems tremendously more potent in terms of LLM capabilities. </span><a href="https://www.reuters.com/technology/google-ai-chatbot-bard-offers-inaccurate-information-company-ad-2023-02-08/" rel="">Google has already had issues with accuracy, even in their on-stage demonstrations of this new technology</a><span>. If you measure both Bing GPT and Google Bard response time, Bard crushes Bing in response time. These model response time and quality differences are directly related to model size.</span></p><blockquote><p><span>Bard combines the breadth of the world’s knowledge with the power, intelligence, and creativity of a large language model. It draws on the information from the web to provide fresh and high-quality responses. We’re releasing it initially with </span><strong>our lightweight model version of LaMDA. This much smaller model requires significantly less computing power</strong><span>, enabling us to scale to more users, allowing for more feedback.</span></p><p><a href="https://www.youtube.com/watch?v=yLWXJ22LUEc" rel="">Google</a></p></blockquote><p>Google is playing defense on margins with this smaller model. They could have deployed their full-size LaMDA model or the far more capable and larger PaLM model, but instead, they went for something much skinnier.</p><p>This is out of necessity.</p><p>Google cannot deploy these massive models into search. It would erode their gross margins too much. We will talk more about this lighter-weight version of LaMDA later in this report, but it’s important to recognize that the latency advantage of Bard is a factor in its competitiveness.</p><div data-attrs="{&#34;url&#34;:&#34;https://www.semianalysis.com/p/the-inference-cost-of-search-disruption?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share&#34;,&#34;text&#34;:&#34;Share&#34;}"><p>If you like what you’re reading, share! It helps a lot!</p><p data-attrs="{&#34;url&#34;:&#34;https://www.semianalysis.com/p/the-inference-cost-of-search-disruption?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share&#34;,&#34;text&#34;:&#34;Share&#34;}"><a href="https://www.semianalysis.com/p/the-inference-cost-of-search-disruption?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share" rel=""><span>Share</span></a></p></div><p>Since Google’s search revenue is derived from ads, different users generate different revenue levels per search. The average suburban American woman is much more revenue per targeted ad than a male farmer in India. This also means they generate vastly different operating margins too.</p><p>Ham fisting an LLM directly into search is not the only way to improve search. Google has been using language models within search to generate embeddings for years. This should improve results for the most common searches without blowing up inference cost budgets because those can be generated once and served to many.</p><p>One of the biggest challenges with inserting LLM into search is sequence length growth and low latency criteria. We will discuss those below and how those will shape the future of search.</p><p>We will also discuss Nvidia A100, H100, and Google’s TPU in the context of LLM inference and costs per query. We will also be sharing H100 inference performance improvement and the impact that it will have on the hardware market. The competitiveness of GPU vs. TPU is inherent in this battle.</p><p><span>Furthermore, the cost per inference can be significantly reduced without new hardware. We discussed </span><a href="https://www.semianalysis.com/p/the-ai-brick-wall-a-practical-limit" rel="">OpenAI’s next LLM architecture improvement on the training side here</a><span>, but there are also improvements in inference costs. Furthermore, Google is also utilizing some unique, exciting techniques that we will also discuss below.</span></p><p data-attrs="{&#34;url&#34;:&#34;https://www.semianalysis.com/subscribe?group=true&amp;coupon=fe141654&#34;,&#34;text&#34;:&#34;Get 20% off a group subscription&#34;,&#34;action&#34;:null,&#34;class&#34;:null}"><a href="https://www.semianalysis.com/subscribe?group=true&amp;coupon=fe141654" rel=""><span>Get 20% off a group subscription</span></a></p></div></div></div>
  </body>
</html>
