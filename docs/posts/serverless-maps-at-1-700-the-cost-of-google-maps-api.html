<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://protomaps.com/blog/serverless-maps-now-open-source">Original</a>
    <h1>Serverless maps at 1/700 the cost of Google Maps API</h1>
    
    <div id="readability-page-1" class="page"><div><article><div><section><h2>Accelerating Maps</h2><p>Last year I described <a href="https://protomaps.com/blog/serverless-self-hosted-maps">Protomaps Mantle</a>, a commercial solution for self hosting planet-scale maps without running any servers. It&#39;s built on top of the open, cloud optimized <a href="https://protomaps.com/docs/pmtiles">PMTiles</a> format, and adds the option of a content delivery network in front to accelerate map tiles to users anywhere in the world.</p><p><strong>The code components of Mantle are now open source,</strong> under the same permissive licenses as the <a target="_blank" rel="noreferrer" href="https://github.com/protomaps">rest of the Protomaps software stack.</a></p><p>It&#39;s also been renamed: you can find it all at the <code>serverless/</code> directory of the <a target="_blank" rel="noreferrer" href="https://github.com/protomaps/PMTIles">PMTiles repository</a>, and get started with the docs at the new <a href="https://protomaps.com/docs/cdn">Protomaps Documentation site: CDN Integration.</a></p><p>A summary of features:</p><ul><li><p><strong>AWS Lambda and Cloudflare Workers</strong> functions for turning Z/X/Y URLs into PMTiles range requests to private storage buckets. Under 10kb compressed, with copy-and-paste deployment.</p></li><li><p><a href="https://protomaps.com/docs/cdn">Simple, 20-minute setup guides</a> on installing in your own AWS or Cloudflare account.</p></li><li><p><strong>Tested in production at scale:</strong> On AWS, response times average 100 ms for cache hits, 200 ms for misses. <em>Cloudflare is significantly slower, but is improving as Cloudflare&#39;s R2 offering matures.</em></p></li></ul><h2>Used in Production</h2><p><a target="_blank" rel="noreferrer" href="https://felt.com/blog/upload-anything">Felt</a> uses Protomaps with a CDN to serve user uploaded tilesets created with their open source tile generator, <a target="_blank" rel="noreferrer" href="https://github.com/felt/tippecanoe">Tippecanoe</a>.</p><p><a target="_blank" rel="noreferrer" href="https://openinframap.org/about">OpenInfraMap</a> uses the Protomaps Cloudflare integration to store and visualize rarely seen infrastructure from the OpenStreetMap dataset.</p><p><a target="_blank" rel="noreferrer" href="https://www.kschaul.com/post/2023/02/16/how-the-post-is-replacing-mapbox-with-open-source-solutions/">The Washington Post</a> uses the Protomaps integration with AWS Lambda and Cloudfront to affordably power <a target="_blank" rel="noreferrer" href="https://www.washingtonpost.com/business/interactive/2023/all-cash-buyers-housing-market/">interactive data stories</a>.</p><h2>Cost Comparison</h2><p>A web application with 50,000 map loads using the Google Maps API will cost <a target="_blank" rel="noreferrer" href="https://mapsplatform.google.com/pricing/">$350 per month.</a></p><p>A similar amount of traffic running through a Protomaps CDN install on Cloudflare, with an average of 20 tiles per session, costs <strong>fifty cents</strong> in <a target="_blank" rel="noreferrer" href="https://developers.cloudflare.com/workers/platform/pricing/">Cloudflare Workers request fees.</a></p><h2>Free Datasets</h2><p>Protomaps-on-CDN enables serving any tiled data at scale - vector map tiles, raster tiles, or even RGB-encoded terrain data, all from a single serverless function. Here&#39;s two free example datasets to try with your own install:</p><h4>Vector Tiles (zooms 0-10)</h4><p><a target="_blank" rel="noreferrer" href="https://protomaps.github.io/basemaps/examples/maplibre-basemap.html">Live Example Page</a></p><p><a target="_blank" rel="noreferrer" href="https://app.protomaps.com/store/planet-z10">Link to download the dataset</a></p><p><strong>A global vector tile dataset based on OpenStreetMap data.</strong> The organization of layers and tags is described at <a href="https://protomaps.com/docs/frontends/basemap-layers">Basemap Layers</a>, and <a target="_blank" rel="noreferrer" href="http://github.com/protomaps/basemaps">open source styles</a> are provided for Leaflet as well as MapLibre GL vector rendering. It&#39;s based on OpenStreetMap data only, so you can do anything you&#39;d like with the data, subject to the <a target="_blank" rel="noreferrer" href="https://wiki.osmfoundation.org/wiki/Licence/Community_Guidelines/Produced_Work_-_Guideline">ODbL Produced Work attribution requrements.</a></p><h4>Terrain RGB</h4><p><a target="_blank" rel="noreferrer" href="https://protomaps.github.io/PMTiles/examples/maplibre_raster_dem.html">Live Example page</a></p><p><a target="_blank" rel="noreferrer" href="https://app.protomaps.com/store/terrarium-z9">Link to download the dataset</a></p><p><strong>A global terrain RGB dataset</strong>, packaged from the <a target="_blank" rel="noreferrer" href="https://github.com/tilezen/joerd">Mapzen Joerd</a> project. This is designed to work with MapLibre GL JS for global hillshading.</p><p>See the <a target="_blank" rel="noreferrer" href="https://github.com/tilezen/joerd/blob/master/docs/attribution.md">Joerd README for attribution requirements.</a></p><h4>Copy these datasets!</h4><p>You can hotlink directly to these datasets, because they&#39;re stored in public buckets on Cloudflare R2 and include <code>Access-Control-Allow-Origin: *</code> headers. But be aware that these URLs might change in the future.</p><p>A solution is to copy the PMTiles files to your own S3 or R2 bucket, so they&#39;ll last forever, under your own control, and at minimal cost. Unlike a map SaaS, you can cache and remix these datasets however you like.</p><p>Finally, if you&#39;d just like to use the Protomaps-hosted deployment - it happens to run on Cloudflare - you can <a target="_blank" rel="noreferrer" href="http://app.protomaps.com/signup">register for an API key</a>. It&#39;s free for non-commercial use, and commercial use is available to our <a href="https://protomaps.com/blog/serverless-maps-now-open-source">GitHub Sponsors</a>.</p><p>Happy mapping!</p></section></div></article></div></div>
  </body>
</html>
