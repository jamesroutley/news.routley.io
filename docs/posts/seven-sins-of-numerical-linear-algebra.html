<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://nhigham.com/2022/10/11/seven-sins-of-numerical-linear-algebra/">Original</a>
    <h1>Seven sins of numerical linear algebra</h1>
    
    <div id="readability-page-1" class="page"><article id="post-8754">
	<!-- .entry-header -->

	<div>
		<p>In numerical linear algebra we are concerned with solving linear algebra problems accurately and efficiently and understanding the sensitivity of the problems to perturbations. We describe seven sins, whereby accuracy or efficiency is lost or misleading information about sensitivity is obtained.</p>

<div id="outline-container-org755dbc6">
<h2 id="org755dbc6">2. Forming the Cross-Product Matrix A^TA</h2>
<div id="text-org755dbc6">
<p> The solution to the linear least squares problem <img src="https://s0.wp.com/latex.php?latex=%5Cmin_x%5C%7C+b+-+Ax+%5C%7C_2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cmin_x%5C%7C+b+-+Ax+%5C%7C_2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cmin_x%5C%7C+b+-+Ax+%5C%7C_2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\min_x\| b - Ax \|_2"/>, where <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> is a full-rank <img src="https://s0.wp.com/latex.php?latex=m%5Ctimes+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=m%5Ctimes+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=m%5Ctimes+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="m\times n"/> matrix with <img src="https://s0.wp.com/latex.php?latex=m%5Cge+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=m%5Cge+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=m%5Cge+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="m\ge n"/>, satisfies the normal equations <img src="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A+x+%3D+A%5ETb&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A+x+%3D+A%5ETb&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5ET%5C%21A+x+%3D+A%5ETb&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^T\!A x = A^Tb"/>. It is therefore natural to form the symmetric positive definite matrix <img src="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^T\!A"/> and solve the normal equations by Cholesky factorization. While fast, this method is numerically unstable when <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> is ill conditioned. By contrast, solving the least squares problem via QR factorization is always numerically stable.</p>
<p>What is wrong with the cross-product matrix <img src="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^T\!A"/> (also known as the Gram matrix)? It squares the data, which can cause a loss of information in floating-point arithmetic. For example, if</p>
<p> <img src="https://s0.wp.com/latex.php?latex=A+%3D+%5Cbegin%7Bbmatrix%7D+1+%26+1+%5C%5C+%5Cepsilon+%26+0+%5Cend%7Bbmatrix%7D%2C++++++++%5Cquad++0+%3C+%5Cepsilon+%3C+%5Csqrt%7Bu%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A+%3D+%5Cbegin%7Bbmatrix%7D+1+%26+1+%5C%5C+%5Cepsilon+%26+0+%5Cend%7Bbmatrix%7D%2C++++++++%5Cquad++0+%3C+%5Cepsilon+%3C+%5Csqrt%7Bu%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A+%3D+%5Cbegin%7Bbmatrix%7D+1+%26+1+%5C%5C+%5Cepsilon+%26+0+%5Cend%7Bbmatrix%7D%2C++++++++%5Cquad++0+%3C+%5Cepsilon+%3C+%5Csqrt%7Bu%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A = \begin{bmatrix} 1 &amp; 1 \\ \epsilon &amp; 0 \end{bmatrix},        \quad  0 &lt; \epsilon &lt; \sqrt{u}, "/></p>
<p> where <img src="https://s0.wp.com/latex.php?latex=u&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=u&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=u&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="u"/> is the unit roundoff of the floating point arithmetic, then</p>
<p> <img src="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A+%3D+%5Cbegin%7Bbmatrix%7D+1+%2B+%5Cepsilon%5E2+%26+1+%5C%5C++++++++++++++++++++++++++++++1++++++++++++++%26+1+%5Cend%7Bbmatrix%7D+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A+%3D+%5Cbegin%7Bbmatrix%7D+1+%2B+%5Cepsilon%5E2+%26+1+%5C%5C++++++++++++++++++++++++++++++1++++++++++++++%26+1+%5Cend%7Bbmatrix%7D+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5ET%5C%21A+%3D+%5Cbegin%7Bbmatrix%7D+1+%2B+%5Cepsilon%5E2+%26+1+%5C%5C++++++++++++++++++++++++++++++1++++++++++++++%26+1+%5Cend%7Bbmatrix%7D+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^T\!A = \begin{bmatrix} 1 + \epsilon^2 &amp; 1 \\                              1              &amp; 1 \end{bmatrix} "/></p>
<p> is positive definite but, since <img src="https://s0.wp.com/latex.php?latex=%5Cepsilon%5E2%3Cu&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cepsilon%5E2%3Cu&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cepsilon%5E2%3Cu&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\epsilon^2&lt;u"/>, in floating-point arithmetic <img src="https://s0.wp.com/latex.php?latex=1%2B%5Cepsilon%5E2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=1%2B%5Cepsilon%5E2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=1%2B%5Cepsilon%5E2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="1+\epsilon^2"/> rounds to <img src="https://s0.wp.com/latex.php?latex=1&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=1&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=1&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="1"/> and so</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bf%5Ckern.2ptl%7D%28+A%5ET%5C%21A%29+%3D+%5Cbegin%7Bbmatrix%7D+1+%26+1+%5C%5C++++++++++++++++++++++++++++++++++1+%26+1+%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bf%5Ckern.2ptl%7D%28+A%5ET%5C%21A%29+%3D+%5Cbegin%7Bbmatrix%7D+1+%26+1+%5C%5C++++++++++++++++++++++++++++++++++1+%26+1+%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cmathrm%7Bf%5Ckern.2ptl%7D%28+A%5ET%5C%21A%29+%3D+%5Cbegin%7Bbmatrix%7D+1+%26+1+%5C%5C++++++++++++++++++++++++++++++++++1+%26+1+%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\mathrm{f\kern.2ptl}( A^T\!A) = \begin{bmatrix} 1 &amp; 1 \\                                  1 &amp; 1 \end{bmatrix}. "/></p>
<p> which is singular, and the information in <img src="https://s0.wp.com/latex.php?latex=%5Cepsilon&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cepsilon&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cepsilon&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\epsilon"/> has been lost.</p>
<p>Another problem with the cross product matrix is that the <img src="https://s0.wp.com/latex.php?latex=2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=2&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="2"/>-norm condition number of <img src="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^T\!A"/> is the square of that of <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/>, and this leads to numerical instability in algorithms that work with <img src="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5ET%5C%21A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^T\!A"/> when the condition number is large.</p>
</div>
</div>
<div id="outline-container-org4948847">
<h2 id="org4948847">3. Evaluating Matrix Products in an Inefficient Order</h2>

</div>
<div id="outline-container-org18e27ac">
<h2 id="org18e27ac">4. Assuming that a Matrix is Positive Definite</h2>
<div id="text-org18e27ac">
<p> Symmetric positive definite matrices (symmetric matrices with positive eigenvalues) are ubiquitous, not least because they arise in the solution of many minimization problems.  However, a matrix that is supposed to be positive definite may fail to be so for a variety of reasons. Missing or inconsistent data in forming a covariance matrix or a correlation matrix can cause a loss of definiteness, and rounding errors can cause a tiny positive eigenvalue to go negative.</p>
<p>Definiteness implies that</p>

<p>but none of these conditions, or even all taken together, guarantees that the matrix has positive eigenvalues.</p>
<p>The best way to check definiteness is to compute a Cholesky factorization, which is often needed anyway. The MATLAB function <code>chol</code> returns an error message if the factorization fails, and a second output argument can be requested, which is set to the number of the stage on which the factorization failed, or to zero if the factorization succeeded. In the case of failure, the partially computed <img src="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=R&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="R"/> factor is returned in the first argument, and it can be used to compute a direction of negative curvature (as needed in optimization), for example.</p>
<p>This sin takes the top spot in Schmelzer and Hauser’s <a href="https://arxiv.org/abs/1310.3396">Seven Sins in Portfolio Optimization</a>, because in portfolio optimization a negative eigenvalue in the covariance matrix can identify a portfolio with negative variance, promising an arbitrarily large investment with no risk!</p>
</div>
</div>
<div id="outline-container-orgab9e580">
<h2 id="orgab9e580">5. Not Exploiting Structure in the Matrix</h2>
<div id="text-orgab9e580">
<p> One of the fundamental tenets of numerical linear algebra is that one should try to exploit any matrix structure that might be present. Sparsity (a matrix having a large number of zeros) is particularly important to exploit, since algorithms intended for dense matrices may be impractical for sparse matrices because of extensive fill-in (zeros becoming nonzero). Here are two examples of structures that can be exploited.</p>
<p>Matrices from saddle point problems are symmetric indefinite and of the form</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cnotag++C+%3D++%5Cbegin%7Bbmatrix%7D+A+%26+B%5ET+%5C%5C+B+%26+0+++++++%5Cend%7Bbmatrix%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cnotag++C+%3D++%5Cbegin%7Bbmatrix%7D+A+%26+B%5ET+%5C%5C+B+%26+0+++++++%5Cend%7Bbmatrix%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cnotag++C+%3D++%5Cbegin%7Bbmatrix%7D+A+%26+B%5ET+%5C%5C+B+%26+0+++++++%5Cend%7Bbmatrix%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\notag  C =  \begin{bmatrix} A &amp; B^T \\ B &amp; 0       \end{bmatrix}, "/></p>
<p> with <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> symmetric positive definite. Much work has been done on developing numerical methods for solving <img src="https://s0.wp.com/latex.php?latex=Cx+%3D+b&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=Cx+%3D+b&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=Cx+%3D+b&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="Cx = b"/> that exploit the block structure and possible sparsity in <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> and <img src="https://s0.wp.com/latex.php?latex=B&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=B&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=B&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="B"/>. A second example is a circulant matrix</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cnotag++++C+%3D+%5Cbegin%7Bbmatrix%7D+c_1+++++%26+c_2++++%26+%5Cdots+++%26+c_n+++++%5C%5C++++++++++++++++++++++++c_n+++++%26+c_1++++%26+%5Cdots+++%26+%5Cvdots++%5C%5C++++++++++++++++++++++++%5Cvdots++%26+%5Cddots+%26+%5Cddots++%26+c_2+++++%5C%5C++++++++++++++++++++++++c_2+++++%26+%5Cdots++%26+c_n+++++%26+c_1+++++%5C%5C++++++%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cnotag++++C+%3D+%5Cbegin%7Bbmatrix%7D+c_1+++++%26+c_2++++%26+%5Cdots+++%26+c_n+++++%5C%5C++++++++++++++++++++++++c_n+++++%26+c_1++++%26+%5Cdots+++%26+%5Cvdots++%5C%5C++++++++++++++++++++++++%5Cvdots++%26+%5Cddots+%26+%5Cddots++%26+c_2+++++%5C%5C++++++++++++++++++++++++c_2+++++%26+%5Cdots++%26+c_n+++++%26+c_1+++++%5C%5C++++++%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cnotag++++C+%3D+%5Cbegin%7Bbmatrix%7D+c_1+++++%26+c_2++++%26+%5Cdots+++%26+c_n+++++%5C%5C++++++++++++++++++++++++c_n+++++%26+c_1++++%26+%5Cdots+++%26+%5Cvdots++%5C%5C++++++++++++++++++++++++%5Cvdots++%26+%5Cddots+%26+%5Cddots++%26+c_2+++++%5C%5C++++++++++++++++++++++++c_2+++++%26+%5Cdots++%26+c_n+++++%26+c_1+++++%5C%5C++++++%5Cend%7Bbmatrix%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\notag    C = \begin{bmatrix} c_1     &amp; c_2    &amp; \dots   &amp; c_n     \\                        c_n     &amp; c_1    &amp; \dots   &amp; \vdots  \\                        \vdots  &amp; \ddots &amp; \ddots  &amp; c_2     \\                        c_2     &amp; \dots  &amp; c_n     &amp; c_1     \\      \end{bmatrix}. "/></p>
<p> <a href="https://nhigham.com/2022/09/27/what-is-a-circulant-matrix/">Circulant matrices</a> have the important property that they are diagonalized by a unitary matrix called the discrete Fourier transform matrix. Using this property one can solve <img src="https://s0.wp.com/latex.php?latex=Cx+%3D+v&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=Cx+%3D+v&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=Cx+%3D+v&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="Cx = v"/> in <img src="https://s0.wp.com/latex.php?latex=O%28n+%5Clog_2n%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=O%28n+%5Clog_2n%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=O%28n+%5Clog_2n%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="O(n \log_2n)"/> operations, rather than the <img src="https://s0.wp.com/latex.php?latex=O%28n%5E3%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=O%28n%5E3%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=O%28n%5E3%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="O(n^3)"/> operations required if the circulant structure is ignored.</p>
<p>Ideally, linear algebra software would detect structure in a matrix and call an algorithm that exploits that structure. A notable example of such a meta-algorithm is the MATLAB backslash function <code>x = A\b</code> for solving <img src="https://s0.wp.com/latex.php?latex=Ax+%3D+b&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=Ax+%3D+b&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=Ax+%3D+b&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="Ax = b"/>. Backslash checks whether the matrix is triangular (or a permutation of a triangular matrix), upper Hessenberg, symmetric, or symmetric positive definite, and applies an appropriate method. It also allows <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> to be rectangular and solves the least squares problem if there are more rows than columns and the underdetermined system if there are more columns than rows.</p>
</div>
</div>
<div id="outline-container-org3a1ffef">
<h2 id="org3a1ffef">6. Using the Determinant to Detect Near Singularity</h2>

</div>
<div id="outline-container-orgc0e544d">
<h2 id="orgc0e544d">7. Using Eigenvalues to Estimate Conditioning</h2>
<div id="text-orgc0e544d">
<p> For any <img src="https://s0.wp.com/latex.php?latex=n%5Ctimes+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=n%5Ctimes+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=n%5Ctimes+n&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="n\times n"/> matrix <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> and any consistent matrix norm it is true that <img src="https://s0.wp.com/latex.php?latex=%5C%7CA%5C%7C+%5Cge+%7C%5Clambda_i%7C&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5C%7CA%5C%7C+%5Cge+%7C%5Clambda_i%7C&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5C%7CA%5C%7C+%5Cge+%7C%5Clambda_i%7C&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\|A\| \ge |\lambda_i|"/> for all <img src="https://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="i"/>, where the <img src="https://s0.wp.com/latex.php?latex=%5Clambda_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Clambda_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Clambda_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\lambda_i"/> are the eigenvalue of <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/>. Since the eigenvalues of <img src="https://s0.wp.com/latex.php?latex=A%5E%7B-1%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A%5E%7B-1%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A%5E%7B-1%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A^{-1}"/> are <img src="https://s0.wp.com/latex.php?latex=%5Clambda%5E%7B-1%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Clambda%5E%7B-1%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Clambda%5E%7B-1%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\lambda^{-1}"/>, it follows that the matrix condition number <img src="https://s0.wp.com/latex.php?latex=%5Ckappa%28A%29+%3D+%5C%7CA%5C%7C+%5C%2C+%5C%7CA%5E%7B-1%7D%5C%7C&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Ckappa%28A%29+%3D+%5C%7CA%5C%7C+%5C%2C+%5C%7CA%5E%7B-1%7D%5C%7C&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Ckappa%28A%29+%3D+%5C%7CA%5C%7C+%5C%2C+%5C%7CA%5E%7B-1%7D%5C%7C&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\kappa(A) = \|A\| \, \|A^{-1}\|"/> is bounded below by the ratio of largest to smallest eigenvalue in absolute value, that is,</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cnotag++++++%5Ckappa%28A%29+%5Cge+%5Cdisplaystyle%5Cfrac%7B+%5Cmax_i+%7C%5Clambda_i%7C+%7D++++++++++++++++++++++++++++++++++++++++++++%7B+%5Cmin_i+%7C%5Clambda_i%7C+%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cnotag++++++%5Ckappa%28A%29+%5Cge+%5Cdisplaystyle%5Cfrac%7B+%5Cmax_i+%7C%5Clambda_i%7C+%7D++++++++++++++++++++++++++++++++++++++++++++%7B+%5Cmin_i+%7C%5Clambda_i%7C+%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cnotag++++++%5Ckappa%28A%29+%5Cge+%5Cdisplaystyle%5Cfrac%7B+%5Cmax_i+%7C%5Clambda_i%7C+%7D++++++++++++++++++++++++++++++++++++++++++++%7B+%5Cmin_i+%7C%5Clambda_i%7C+%7D.+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\notag      \kappa(A) \ge \displaystyle\frac{ \max_i |\lambda_i| }                                            { \min_i |\lambda_i| }. "/></p>
<p> But as the matrix <img src="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=T&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="T"/> in (1) shows, this bound can be very weak.</p>
<p>It is singular values <i>not</i> eigenvalues that characterize the condition number for the 2-norm. Specifically,</p>
<p> <img src="https://s0.wp.com/latex.php?latex=%5Cnotag++++++++%5Ckappa_2%28A%29+%3D+%5Cdisplaystyle%5Cfrac%7B%5Csigma_1%7D%7B%5Csigma_n%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Cnotag++++++++%5Ckappa_2%28A%29+%3D+%5Cdisplaystyle%5Cfrac%7B%5Csigma_1%7D%7B%5Csigma_n%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Cnotag++++++++%5Ckappa_2%28A%29+%3D+%5Cdisplaystyle%5Cfrac%7B%5Csigma_1%7D%7B%5Csigma_n%7D%2C+&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\notag        \kappa_2(A) = \displaystyle\frac{\sigma_1}{\sigma_n}, "/></p>
<p> where <img src="https://s0.wp.com/latex.php?latex=A+%3D+U%5CSigma+V%5ET&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A+%3D+U%5CSigma+V%5ET&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A+%3D+U%5CSigma+V%5ET&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A = U\Sigma V^T"/> is a singular value decomposition (SVD), with <img src="https://s0.wp.com/latex.php?latex=U&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=U&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=U&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="U"/> and <img src="https://s0.wp.com/latex.php?latex=V&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=V&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=V&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="V"/> orthogonal and <img src="https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5Cmathrm%7Bdiag%7D%28%5Csigma_i%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5Cmathrm%7Bdiag%7D%28%5Csigma_i%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5CSigma+%3D+%5Cmathrm%7Bdiag%7D%28%5Csigma_i%29&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\Sigma = \mathrm{diag}(\sigma_i)"/>, <img src="https://s0.wp.com/latex.php?latex=%5Csigma_1+%5Cge+%5Csigma_2+%5Cge+%5Ccdots+%5Cge+%5Csigma_n+%5Cge+0&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Csigma_1+%5Cge+%5Csigma_2+%5Cge+%5Ccdots+%5Cge+%5Csigma_n+%5Cge+0&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Csigma_1+%5Cge+%5Csigma_2+%5Cge+%5Ccdots+%5Cge+%5Csigma_n+%5Cge+0&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\sigma_1 \ge \sigma_2 \ge \cdots \ge \sigma_n \ge 0"/>. If <img src="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=A&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="A"/> is symmetric, for example, then the sets <img src="https://s0.wp.com/latex.php?latex=%5C%7B+%7C%5Clambda_i%7C+%5C%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5C%7B+%7C%5Clambda_i%7C+%5C%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5C%7B+%7C%5Clambda_i%7C+%5C%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\{ |\lambda_i| \}"/> and <img src="https://s0.wp.com/latex.php?latex=%5C%7B%5Csigma_i+%5C%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5C%7B%5Csigma_i+%5C%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5C%7B%5Csigma_i+%5C%7D&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\{\sigma_i \}"/> are the same, but in general the eigenvalues <img src="https://s0.wp.com/latex.php?latex=%5Clambda_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Clambda_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Clambda_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\lambda_i"/> and singular values <img src="https://s0.wp.com/latex.php?latex=%5Csigma_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002" srcset="https://s0.wp.com/latex.php?latex=%5Csigma_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002 1x, https://s0.wp.com/latex.php?latex=%5Csigma_i&amp;bg=ffffff&amp;fg=222222&amp;s=0&amp;c=20201002&amp;zoom=4.5 4x" alt="\sigma_i"/> can be very different.</p>
</div>
</div>

			</div><!-- .entry-content -->

	
	<!-- .entry-footer -->
</article></div>
  </body>
</html>
