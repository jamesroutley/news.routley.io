<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="http://allsoftwaresucks.blogspot.com/2022/11/why-cve-2022-3602-was-not-detected-by.html">Original</a>
    <h1>Why CVE-2022-3602 was not detected by fuzz testing</h1>
    
    <div id="readability-page-1" class="page"><div id="post-body-4293164354241507668" itemprop="description articleBody">
<p>So recently a very hyped memory corruption security vulnerability was discovered in the OpenSSL punycode parser.</p><p>Some folks including Hanno (https://twitter.com/hanno/status/1587775675397726209) asked why this is still happenning, why no one wrote a fuzzer for the punycode parser and if we as the security community have learned nothing from Heartbleed.</p><p>I think we should give the developers the benefit of doubt and assume they were acting in good faith and try to see what could be improved.</p><p>In fact, there already exists a fuzz testing harness for the X.509 in the OpenSSL source code.</p><p>All of the fuzzers from the OpenSSL source tree are also supposedly automatically deployed to ClusterFuzz via OSS-Fuzz: https://github.com/google/oss-fuzz/blob/master/projects/openssl/build.sh</p><h3>Examining call chains</h3><p>Let’s start by examining the call chain for the vulnerable function.</p><ul><li>ossl_punycode_decode: called by ossl_a2ulabel</li><li>ossl_a2ulabel: ossl_a2ucompare is not really referenced anywhere in C code, only mentioned in documentation.</li></ul><p>Let&#39;s examine who calls &#34;ossl_a2ulabel&#34; then.</p><blockquote><p>openssl/crypto$ grep -rI ossl_a2ulabel .</p><p>./x509/v3_ncons.c:        if (ossl_a2ulabel(baseptr, ulabel + 1, &amp;size) &lt;= 0) {</p></blockquote><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg1S5DXCOzxUNgBr4HEmkkzR2PJd-lA4NC4wHZ9FabJ5eZ4W34STScCbEOsCotD3p966G5ssLKujy4UGjQUlghOwOamBcVgX9ZMV4KT4C2HY89-jbaNxgL5drxt1LwmDoLrvm3U26sODL-D0ztSWfWj6aCmLzFg1jhlswx_osxvWYRaokVenMsnLP7b/s1352/punycode.png"><img data-original-height="1352" data-original-width="1236" height="454" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg1S5DXCOzxUNgBr4HEmkkzR2PJd-lA4NC4wHZ9FabJ5eZ4W34STScCbEOsCotD3p966G5ssLKujy4UGjQUlghOwOamBcVgX9ZMV4KT4C2HY89-jbaNxgL5drxt1LwmDoLrvm3U26sODL-D0ztSWfWj6aCmLzFg1jhlswx_osxvWYRaokVenMsnLP7b/w416-h454/punycode.png" width="416"/></a></p></div></div>
  </body>
</html>
