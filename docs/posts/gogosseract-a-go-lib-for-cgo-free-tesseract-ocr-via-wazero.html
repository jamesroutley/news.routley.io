<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Danlock/gogosseract">Original</a>
    <h1>Show HN: Gogosseract, a Go Lib for CGo-Free Tesseract OCR via Wazero</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/41980b085ca17919db5aaee09256f29cae56f4b5bc0317394082ac7dc3ae9c97/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f436f7665726167652d37302e342532352d627269676874677265656e"><img src="https://camo.githubusercontent.com/41980b085ca17919db5aaee09256f29cae56f4b5bc0317394082ac7dc3ae9c97/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f436f7665726167652d37302e342532352d627269676874677265656e" alt="Coverage" data-canonical-src="https://img.shields.io/badge/Coverage-70.4%25-brightgreen"/></a>
<a href="https://goreportcard.com/report/github.com/danlock/gogosseract" rel="nofollow"><img src="https://camo.githubusercontent.com/a02d20523f0e90a38253e51b11b0959c629f3efbd518b32a4fcf1e18dc03eb85/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f64616e6c6f636b2f676f676f73736572616374" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/danlock/gogosseract"/></a>
<a href="https://pkg.go.dev/github.com/danlock/gogosseract" rel="nofollow"><img src="https://camo.githubusercontent.com/6a26164bd0b77c89ebb91fc5536da3bcf58ee80eb5e6210428b3f869d2d85467/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f64616e6c6f636b2f676f676f737365726163742e737667" alt="Go Reference" data-canonical-src="https://pkg.go.dev/badge/github.com/danlock/gogosseract.svg"/></a></p>
<p dir="auto">A reimplementation of <a href="https://github.com/otiai10/gosseract">https://github.com/otiai10/gosseract</a> without CGo, running Tesseract compiled to WASM with Emscripten via Wazero.</p>
<p dir="auto">Tesseract is an Optical Character Recognition library written in C++.</p>
<p dir="auto">The WASM is generated from my <a href="https://github.com/Danlock/tesseract-wasm">personal</a> fork of robertknight&#39;s well written tesseract-wasm project.</p>
<p dir="auto">Note that Tesseract is only compiled with support for the LSTM neural network OCR engine, and not for &#34;classic&#34; Tesseract.</p>

<p dir="auto">Tesseract requires training data in order to accurately recognize text. The official source is <a href="https://github.com/tesseract-ocr/tessdata_fast">here</a>. Strategies for dealing with this include downloading it at runtime, or embedding the file within your Go binary using go:embed at compile time.</p>

<p dir="auto">Tesseract can work better if the input images are preprocessed. See this page for tips.</p>
<p dir="auto"><a href="https://tesseract-ocr.github.io/tessdoc/ImproveQuality.html" rel="nofollow">https://tesseract-ocr.github.io/tessdoc/ImproveQuality.html</a></p>

<p dir="auto">Using Tesseract to parse text from an image.</p>
<div data-snippet-clipboard-copy-content="    trainingDataFile, err := os.Open(&#34;eng.traineddata&#34;)
    handleErr(err)

    cfg := gogosseract.Config{
        Language: &#34;eng&#34;,
        TrainingData: trainingDataFile,
    }
    // While Tesseract&#39;s logs are very useful for debugging, you have the option to silence or redirect it
    cfg.Stderr = io.Discard
    cfg.Stdout = io.Discard
    // Compile the Tesseract WASM and run it, loading in the TrainingData and setting any Config Variables provided
    tess, err := gogosseract.New(ctx, cfg)
    handleErr(err)

    imageFile, err := os.Open(&#34;image.png&#34;)
    handleErr(err)

    err = tess.LoadImage(ctx, imageFile, gogosseract.LoadImageOptions{})
    handleErr(err)

    text, err = tess.GetText(ctx, func(progress int32) { log.Printf(&#34;Tesseract parsing is %d%% complete.&#34;, progress) })
    handleErr(err)
    // Closing the Tesseract instance will clean up everything used by Tesseract and it&#39;s WASM module
    handleErr(tess.Close(ctx))"><pre><code>    trainingDataFile, err := os.Open(&#34;eng.traineddata&#34;)
    handleErr(err)

    cfg := gogosseract.Config{
        Language: &#34;eng&#34;,
        TrainingData: trainingDataFile,
    }
    // While Tesseract&#39;s logs are very useful for debugging, you have the option to silence or redirect it
    cfg.Stderr = io.Discard
    cfg.Stdout = io.Discard
    // Compile the Tesseract WASM and run it, loading in the TrainingData and setting any Config Variables provided
    tess, err := gogosseract.New(ctx, cfg)
    handleErr(err)

    imageFile, err := os.Open(&#34;image.png&#34;)
    handleErr(err)

    err = tess.LoadImage(ctx, imageFile, gogosseract.LoadImageOptions{})
    handleErr(err)

    text, err = tess.GetText(ctx, func(progress int32) { log.Printf(&#34;Tesseract parsing is %d%% complete.&#34;, progress) })
    handleErr(err)
    // Closing the Tesseract instance will clean up everything used by Tesseract and it&#39;s WASM module
    handleErr(tess.Close(ctx))
</code></pre></div>
<p dir="auto">Using a Pool of Tesseract workers for thread safe concurrent image parsing.</p>
<div data-snippet-clipboard-copy-content="    cfg := gogosseract.Config{
        Language: &#34;eng&#34;,
        TrainingData: trainingDataFile,
    }
    // Create 10 Tesseract instances that can process image requests concurrently.
    pool, err := gogosseract.NewPool(ctx, 10, gogosseract.PoolConfig{Config: cfg})
    handleErr(err)
    defer Pool.Close()

    // ParseImage loads the image and waits until the Tesseract worker sends back your result.
    hocr, err := pool.ParseImage(ctx, img, gogosseract.ParseImageOptions{
        IsHOCR: true,
    })
    handleErr(err)
"><pre><code>    cfg := gogosseract.Config{
        Language: &#34;eng&#34;,
        TrainingData: trainingDataFile,
    }
    // Create 10 Tesseract instances that can process image requests concurrently.
    pool, err := gogosseract.NewPool(ctx, 10, gogosseract.PoolConfig{Config: cfg})
    handleErr(err)
    defer Pool.Close()

    // ParseImage loads the image and waits until the Tesseract worker sends back your result.
    hocr, err := pool.ParseImage(ctx, img, gogosseract.ParseImageOptions{
        IsHOCR: true,
    })
    handleErr(err)

</code></pre></div>
</article>
          </div></div>
  </body>
</html>
