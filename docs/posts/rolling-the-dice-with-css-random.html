<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://webkit.org/blog/17285/rolling-the-dice-with-css-random/">Original</a>
    <h1>Rolling the dice with CSS random()</h1>
    
    <div id="readability-page-1" class="page"><div>
                                
                <p>Random functions in programming languages are amazing. You can use them to generate variations, to make things feel spontaneous and fresh. Until now there was no way to create a random number in CSS. Now, the  <code>random()</code> function is on its way. You’ll be able to create a random animation delay, layout content at a random place on the screen, create a random color, or anything you want — all without any JavaScript.</p>
<h2>The Basics</h2>
<p>This new function has three arguments in this pattern: <code>random(min, max, step)</code>. You state a minimum and maximum value to define the range from which the random number will be chosen. You can use any type of number (integer, percentage, length, angle, etc.) as long as all three arguments match. The step argument is optional, but is particularly useful for when you want to ensure round numbers.</p>
<p>For example, <code>random(0, 100, 2)</code> will choose an even number between 0 and 100, while <code>random(0turn, 1turn)</code> will be a fraction of a turn — basically, any decimal between 0 and 360 degrees.</p>
<p>Let’s take a look at how to use <code>random()</code> by going through several demos. We’ll start by creating a field of stars out of HTML and CSS.</p>
<h2>A star field with CSS and HTML</h2>
<figure><img fetchpriority="high" decoding="async" src="https://webkit.org/wp-content/uploads/starfield-demo.png" alt="A pure CSS star field using randomly placed circles, glow effects and four-pointed stars" width="2522" height="1504" srcset="https://webkit.org/wp-content/uploads/starfield-demo.png 2522w, https://webkit.org/wp-content/uploads/starfield-demo-300x179.png 300w, https://webkit.org/wp-content/uploads/starfield-demo-1024x611.png 1024w, https://webkit.org/wp-content/uploads/starfield-demo-768x458.png 768w, https://webkit.org/wp-content/uploads/starfield-demo-1536x916.png 1536w, https://webkit.org/wp-content/uploads/starfield-demo-2048x1221.png 2048w" sizes="(max-width: 2522px) 100vw, 2522px"/></figure>
<pre><code><span>&lt;<span>html</span>&gt;</span>
<span>&lt;<span>body</span>&gt;</span>
    <span>&lt;<span>div</span> <span>class</span>=<span>star</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>
    <span>&lt;<span>div</span> <span>class</span>=<span>star</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>
    …
    <span>&lt;<span>div</span> <span>class</span>=<span>star</span>&gt;</span><span>&lt;/<span>div</span>&gt;</span>
  <span>&lt;/<span>body</span>&gt;</span>
<span>&lt;/<span>html</span>&gt;</span>
</code></pre>
<p>We’ll start by creating an HTML element for each star. Then paint the sky and style the stars with white circles of any size for now to act as stars. Setting the star to be fixed positioning will make it easy to place them randomly.</p>
<pre><code><span>body</span> {
  <span>background-color</span>: <span>black</span>;
}

<span>.star</span> {
  <span>background-color</span>: <span>white</span>;
  <span>border-radius</span>: <span>50%</span>;
  <span>aspect-ratio</span>: <span>1</span>/<span>1</span>;
  <span>width</span>: <span>3px</span>;
  <span>position</span>: <span>fixed</span>;
}    
</code></pre>
<p>Now we’ll distribute the stars by setting the top and left properties to a random value, in this case 0-100% for <code>top</code> (Y-axis) and a separate random value for <code>left</code> (X-axis). By default, each <code>random()</code> function will generate different random values using a different random base value generated from a uniform distribution.</p>
<pre><code><span>.star</span> {
  <span>background-color</span>: <span>white</span>;
  <span>border-radius</span>: <span>50%</span>;
  <span>aspect-ratio</span>: <span>1</span>/<span>1</span>; 
  <span>width</span>: <span>3px</span>;
  <span>position</span>: <span>fixed</span>;
  <span>top</span>: <span>random</span>(<span>0%</span>, <span>100%</span>);
  <span>left</span>: <span>random</span>(<span>0%</span>, <span>100%</span>);
}
</code></pre>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/random-star-dots.png" alt="Randomly placed dots" width="2530" height="518" srcset="https://webkit.org/wp-content/uploads/random-star-dots.png 2530w, https://webkit.org/wp-content/uploads/random-star-dots-300x61.png 300w, https://webkit.org/wp-content/uploads/random-star-dots-1024x210.png 1024w, https://webkit.org/wp-content/uploads/random-star-dots-768x157.png 768w, https://webkit.org/wp-content/uploads/random-star-dots-1536x314.png 1536w, https://webkit.org/wp-content/uploads/random-star-dots-2048x419.png 2048w" sizes="(max-width: 2530px) 100vw, 2530px"/></figure>
<p>For a more dynamic look, make the size of the “stars” random as well.</p>
<pre><code><span>.star</span> {
   <span>background-color</span>: <span>white</span>;
   <span>border-radius</span>: <span>50%</span>;
   <span>aspect-ratio</span>: <span>1</span>/<span>1</span>; 
   <span>width</span>: <span>random</span>(<span>2px</span>, <span>10px</span>, <span>1px</span>);
   <span>position</span>: <span>fixed</span>;
   <span>top</span>: <span>random</span>(<span>0%</span>, <span>100%</span>);
   <span>left</span>: <span>random</span>(<span>0%</span>, <span>100%</span>);
 }
</code></pre>
<p>Notice that the top and left random values used percentages. But for <code>width</code> you can select a random size based on pixels instead. Just remember that whatever unit you use needs to be the same for each parameter. The third argument used in the example above is used to ensure star sizes are in <code>1px</code> increments for a well-rounded number to give a better spread of sizes for more variety.</p>
<figure><img decoding="async" src="https://webkit.org/wp-content/uploads/random-star-circle-sizes.png" alt="Randomly sized circles for stars" width="2534" height="520" srcset="https://webkit.org/wp-content/uploads/random-star-circle-sizes.png 2534w, https://webkit.org/wp-content/uploads/random-star-circle-sizes-300x62.png 300w, https://webkit.org/wp-content/uploads/random-star-circle-sizes-1024x210.png 1024w, https://webkit.org/wp-content/uploads/random-star-circle-sizes-768x158.png 768w, https://webkit.org/wp-content/uploads/random-star-circle-sizes-1536x315.png 1536w, https://webkit.org/wp-content/uploads/random-star-circle-sizes-2048x420.png 2048w" sizes="(max-width: 2534px) 100vw, 2534px"/></figure>
<p>The idea can be taken further by adding some special effects, like adding a subtle glow to the stars with layered drop shadows and blending effects.</p>
<pre><code><span>.star</span> {
    <span>--star-size</span>: <span>random</span>(<span>--random-star-size</span>, <span>1px</span>, <span>7px</span>, <span>1px</span>);
    <span>background-color</span>: <span>white</span>;
    <span>border-radius</span>: <span>50%</span>;
    <span>aspect-ratio</span>: <span>1</span>/<span>1</span>;
    <span>width</span>: <span>var</span>(<span>--star-size</span>);
    <span>position</span>: <span>fixed</span>;
    <span>top</span>: <span>random</span>(<span>0%</span>, <span>100%</span>);
    <span>left</span>: <span>random</span>(<span>0%</span>, <span>100%</span>);
    <span>filter</span>: <span>drop-shadow</span>(<span>0px</span> <span>0px</span> <span>calc</span>(<span>var</span>(<span>--star-size</span>) * <span>0.5</span>) <span>oklch</span>(<span>0.7</span> <span>0.2</span> <span>random</span>(<span>0</span>, <span>100</span>))) 
            <span>drop-shadow</span>(<span>0px</span> <span>0px</span> <span>calc</span>(<span>var</span>(<span>--star-size</span>) * <span>2</span>) <span>white</span>);
    <span>mix-blend-mode</span>: <span>hard-light</span>;
}
</code></pre>
<h3>Shared randomness and custom properties</h3>
<p>The <code>--star-size</code> custom property allows re-using the randomly generated pixel size, but there are some important details to using custom properties with <code>random()</code>. First, you’ll see what looks like another custom property as the first parameter of the <code>random()</code> function. The <code>--random-star-size</code> name used here is known as an ident. It’s used to ensure the random value generated is used in the other <code>random()</code> function calls where the same ident is provided.</p>
<p>You might be asking, why is that necessary here? It’s important to realize that setting a custom property to a CSS function isn’t like other programming languages where a variable stores a result. Custom properties are more like a simple text replacement mechanism. That means wherever you are calling that custom property with <code>var()</code> what’s actually happening is something more like text substitution, replacing the <code>var()</code> with a duplicate of the property you declared. In the case of this example, that means another <code>random()</code> call, not the resulting value of the function.</p>
<p>Back to the example, an ideal blur effect for the glow will need to be based on whatever the random size of the star ends up being. That’s doable using a <code>calc()</code> to use a factor of the star size for the blur size of the layered drop shadows. Doing that means depends on getting the same value of randomness so using the named ident is the right approach.</p>
<p>The first drop shadow also uses <code>random()</code> to select a hue with <code>oklch()</code> to add vibrant colors that are composited over a soft white glow with a <code>hard-light</code> blend mode. The combination adds a subtle, but dynamic colorization to the stars.</p>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/random-glowing-stars.png" alt="Random glowing circles for stars" width="2532" height="460" srcset="https://webkit.org/wp-content/uploads/random-glowing-stars.png 2532w, https://webkit.org/wp-content/uploads/random-glowing-stars-300x55.png 300w, https://webkit.org/wp-content/uploads/random-glowing-stars-1024x186.png 1024w, https://webkit.org/wp-content/uploads/random-glowing-stars-768x140.png 768w, https://webkit.org/wp-content/uploads/random-glowing-stars-1536x279.png 1536w, https://webkit.org/wp-content/uploads/random-glowing-stars-2048x372.png 2048w" sizes="auto, (max-width: 2532px) 100vw, 2532px"/></figure>
<p>Using a named ident shares the randomness across the properties of a single element. It’s one of the many ways to share randomness. The <code>random()</code> function has variety of approaches depending on your needs. You can also use the <code>element-shared</code> value to share a random value for a given property across all matched elements, or mix the two to share the value everywhere. Unlike a named ident, which will share the value whenever the ident is used, <code>element-shared</code> will share the random value for a given property across all the elements it applies to.</p>
<p>One way to see this work in the star field example is to add some four-pointed stars with a simple glyph.</p>
<pre><code><span>.star</span><span>.fourpointed</span> {
    <span>clip-path</span>: <span>shape</span>(<span>from</span> <span>50%</span> <span>0%</span>,<span>line</span> <span>to</span> <span>50.27%</span> <span>3.25%</span>, …);
    <span>--star-size</span>: <span>random</span>(<span>--random-four-point-size</span>, <span>20px</span>, <span>60px</span>, <span>1px</span>);
    <span>rotate</span>: <span>random</span>(<span>element-shared</span>, <span>-45deg</span>, <span>45deg</span>);
}
</code></pre>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/four-pointed-stars.png" alt="Randomly placed and rotated four-pointed stars" width="1706" height="590" srcset="https://webkit.org/wp-content/uploads/four-pointed-stars.png 1706w, https://webkit.org/wp-content/uploads/four-pointed-stars-300x104.png 300w, https://webkit.org/wp-content/uploads/four-pointed-stars-1024x354.png 1024w, https://webkit.org/wp-content/uploads/four-pointed-stars-768x266.png 768w, https://webkit.org/wp-content/uploads/four-pointed-stars-1536x531.png 1536w" sizes="auto, (max-width: 1706px) 100vw, 1706px"/></figure>
<p>A CSS <code>shape()</code> is used to define the four-pointed glyph that will clip the circular white background. The star size can still be random but will need boosted to an order of magnitude larger to feel right. A more realistic styling for these stars comes from finding a way to mimic the diffraction rays that are seen in images of stars. They all angle the same way for may important physics reasons. So while a static degree of rotation could be assigned, it’s a tad more fun and dynamic to assign one randomly. But doing that effectively means finding a way to use the same random angle for all of the four-pointed stars.</p>
<p>That’s where <code>element-shared</code> comes into play. The <code>element-shared</code> value generates a random value shared by all elements for that property. That makes all of the four-pointed stars rotate with the same random angle.</p>
<p>Here’s the complete version of the star field example that you can experiment with: <a href="https://codepen.io/jdatapple/pen/YPyELeV?editors=1100">https://codepen.io/jdatapple/pen/YPyELeV</a></p>
<h2>Randomly placed rectangles</h2>
<p>There are lots of other ways to make use of <code>random()</code>. Building on some of the concepts of the star field example, you can explore using <code>random()</code> with layout tools like <code>grid</code>.</p>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/randomly-placed-rectangles-scaled.png" alt="Randomly placed, randomly colored rectangles" width="2560" height="1238" srcset="https://webkit.org/wp-content/uploads/randomly-placed-rectangles-scaled.png 2560w, https://webkit.org/wp-content/uploads/randomly-placed-rectangles-300x145.png 300w, https://webkit.org/wp-content/uploads/randomly-placed-rectangles-1024x495.png 1024w, https://webkit.org/wp-content/uploads/randomly-placed-rectangles-768x371.png 768w, https://webkit.org/wp-content/uploads/randomly-placed-rectangles-1536x743.png 1536w, https://webkit.org/wp-content/uploads/randomly-placed-rectangles-2048x990.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px"/></figure>
<p>In this variant example, the webpage area is equally divided into 100 rows and 100 columns. Then randomly colored rectangles are positioned at random in the grid:</p>
<pre><code><span>.grid</span> {
  <span>display</span>: <span>grid</span>;
  <span>--rows</span>: <span>100</span>;
  <span>--columns</span>: <span>100</span>;
  <span>grid-template-rows</span>: <span>repeat</span>(<span>var</span>(<span>--rows</span>), <span>1</span><span>fr</span>);
  <span>grid-template-columns</span>: <span>repeat</span>(<span>var</span>(<span>--columns</span>), <span>1</span><span>fr</span>);
  <span>width</span>: <span>100</span><span>vw</span>;
  <span>height</span>: <span>100</span><span>vh</span>;
}

<span>.rectangle</span> {
  <span>background-color</span>: <span>lch</span>(<span>100%</span> <span>90%</span> <span>random</span>(<span>0deg</span>, <span>360deg</span>));
  <span>grid-area</span>: <span>random</span>(<span>1</span>, <span>var</span>(<span>--rows</span>), <span>1</span>) / <span>random</span>(<span>1</span>, <span>var</span>(<span>--columns</span>), <span>1</span>);
}
</code></pre>
<p>You can view the final result on any browser that supports <code>random()</code>: <a href="https://codepen.io/ntim/pen/dPYGJxj">https://codepen.io/ntim/pen/dPYGJxj</a></p>
<h2>Stacks of Photos</h2>
<p>Another example of making use of <code>random()</code> is creating stacks of photos that are randomly placed and oriented to look like they’ve been tossed on top of each other. You can spend a lot of time setting all of the photos just so, or let the computer procedurally generate it each time the page is loaded.</p>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/stacks-of-photos-scaled.png" alt="Stacks of desert landscape photos with images randomly rotated with randomly offset placement" width="2560" height="948" srcset="https://webkit.org/wp-content/uploads/stacks-of-photos-scaled.png 2560w, https://webkit.org/wp-content/uploads/stacks-of-photos-300x111.png 300w, https://webkit.org/wp-content/uploads/stacks-of-photos-1024x379.png 1024w, https://webkit.org/wp-content/uploads/stacks-of-photos-768x285.png 768w, https://webkit.org/wp-content/uploads/stacks-of-photos-1536x569.png 1536w, https://webkit.org/wp-content/uploads/stacks-of-photos-2048x759.png 2048w" sizes="auto, (max-width: 2560px) 100vw, 2560px"/></figure>
<pre><code><span>.stack</span> <span>img</span> {
    <span>width</span>: <span>100%</span>;
    <span>grid-column</span>: <span>1</span>;
    <span>grid-row</span>: <span>1</span>;
    <span>border</span>: <span>10px</span> <span>solid</span> <span>hsl</span>(<span>0</span>, <span>100%</span>, <span>100%</span>);
    <span>box-shadow</span>: <span>10px</span> <span>10px</span> <span>40px</span> <span>hsl</span>(<span>0</span>, <span>0%</span>, <span>0%</span>, <span>20%</span>);

    <span>--random-rotate</span>: <span>rotate</span>(<span>random</span>(<span>-1</span> * <span>var</span>(<span>--rotate-offset</span>), <span>var</span>(<span>--rotate-offset</span>)));

    <span>transition</span>: <span>.3s</span> <span>ease-out</span>;
    <span>transform</span>: <span>var</span>(<span>--random-rotate</span>);
    <span>transform-origin</span>: <span>random</span>(<span>0%</span>, <span>100%</span>) <span>random</span>(<span>0%</span>, <span>100%</span>);
}
</code></pre>
<p>More than that, it’s also straightforward to include randomness in interactivity. Adding random translation to the hover state of the images adds to the whimsy:</p>
<pre><code><span>.stack</span><span>:hover</span> <span>img</span> {
    <span>transform</span>: <span>var</span>(<span>--random-rotate</span>) <span>translateX</span>(<span>random</span>(<span>-1</span> * <span>var</span>(<span>--translate-offset</span>), <span>var</span>(<span>--translate-offset</span>))) <span>translateY</span>(<span>random</span>(<span>-1</span> * <span>var</span>(<span>--translate-offset</span>), <span>var</span>(<span>--translate-offset</span>)));
}
</code></pre>
<h2>Wheel of Fortune</h2>
<figure><img loading="lazy" decoding="async" src="https://webkit.org/wp-content/uploads/wheel-of-fortune.png" alt="Random rotation example of a wheel sliced into 20 pieces with emoji placed in every other slice and a green spin button" width="1512" height="1150" srcset="https://webkit.org/wp-content/uploads/wheel-of-fortune.png 1512w, https://webkit.org/wp-content/uploads/wheel-of-fortune-300x228.png 300w, https://webkit.org/wp-content/uploads/wheel-of-fortune-1024x779.png 1024w, https://webkit.org/wp-content/uploads/wheel-of-fortune-768x584.png 768w" sizes="auto, (max-width: 1512px) 100vw, 1512px"/></figure>
<p>The <code>random()</code> function can even be used to create interactive elements that need unpredictable outcomes. The wheel of fortune demo showcases this perfectly.</p>
<pre><code><span>@keyframes</span> <span>spin</span> {
    <span>from</span> {
        <span>rotate</span>: <span>0deg</span>;
    }
    <span>to</span> {
        <span>rotate</span>: <span>10</span><span>turn</span>; 
        <span>rotate</span>: <span>random</span>(<span>2</span><span>turn</span>, <span>10</span><span>turn</span>, <span>by</span> <span>20deg</span>);
    }
}
</code></pre>
<p>When the “SPIN” button is clicked, the <code>@keyframe</code> animation uses <code>random()</code> to generate a rotation value that sets when and where the wheel lands. This example highlights the growing capabilities available in modern CSS defining all of the interactivity, randomness, and animation in the stylesheet.</p>
<p>You can see the demo in action here: <a href="https://codepen.io/ntim/pen/WbQrMow">https://codepen.io/ntim/pen/WbQrMow</a></p>
<h2>A handy randomness reference</h2>
<p>There are lots of different ways to use <code>random()</code> depending on what you need and different ways to share the randomness between elements.</p>
<h3>Maximum randomness</h3>
<p>Both properties get a different value, and it’s different per element too, so you get lots of random rectangles.</p>
<pre><code><span>.random-rect</span> {
  <span>width</span>: <span>random</span>(<span>100px</span>, <span>200px</span>);
  <span>height</span>: <span>random</span>(<span>100px</span>, <span>200px</span>);
}
</code></pre>
<h3>Shared by name within an element</h3>
<p>Using an ident both properties get the same value, but it’s still different per element, so you get lots of random squares.</p>
<pre><code><span>.random-square</span> {
    <span>width</span>: <span>random</span>(<span>--foo</span>, <span>100px</span>, <span>200px</span>);
    <span>height</span>: <span>random</span>(<span>--foo</span>, <span>100px</span>, <span>200px</span>);
}
</code></pre>
<h3>Shared between elements within a property</h3>
<p>With <code>element-shared</code> both properties get different values, but they’re shared by every element, so you get lots of identical rectangles of a single random size.</p>
<pre><code><span>.shared-random-rect</span> {
    <span>width</span>: <span>random</span>(<span>element-shared</span>, <span>100px</span>, <span>200px</span>);
    <span>height</span>: <span>random</span>(<span>element-shared</span>, <span>100px</span>, <span>200px</span>);
}
</code></pre>
<h3>Shared by name globally</h3>
<p>Using both a named ident and <code>element-shared</code> means both properties get the same value, and every element shares the random value, so you get lots of identical squares of a single random size.</p>
<pre><code><span>.shared-random-squares</span> {
    <span>width</span>: <span>random</span>(<span>--foo</span> <span>element-shared</span>, <span>100px</span>, <span>200px</span>);
    <span>height</span>: <span>random</span>(<span>--foo</span> <span>element-shared</span>, <span>100px</span>, <span>200px</span>);
}
</code></pre>
<h2>Try it out and tell us how it goes</h2>
<p>You can try out the <code>random()</code> function today in <a href="https://developer.apple.com/safari/resources/">Safari Technology Preview!</a> However, it’s important to note that there are ongoing discussions in the CSS Working Group about the specification, and several open issues remain about whether this approach best serves developers’ needs.</p>
<p>While the examples above demonstrate the exciting possibilities, we’re actively asking for feedback from the web development community to help shape the final direction, and you can help. If you experiment with <code>random()</code> in Safari Technology Preview, we’d love to hear about your experience. What works well? What feels awkward? Does the way shared values are expressed make sense to you? Do you have use cases that are missing? Or better suggestions for the name of <code>element-shared</code>? Your feedback will directly influence how this feature moves forward from its current form. This is a chance for you to help shape CSS—try it out and let us know what you think.</p>
<p>You can share your feedback with me, Jon Davis, on <a href="https://bsky.app/profile/jondavis.bsky.social">Bluesky</a> / <a href="https://mastodon.social/@jondavis">Mastodon</a>, or our other evangelists — Jen Simmons, on <a href="https://bsky.app/profile/jensimmons.bsky.social">Bluesky</a> / <a href="https://front-end.social/@jensimmons">Mastodon</a>, or Saron Yitbarek, on <a href="https://bsky.app/profile/saron.bsky.social">BlueSky</a>. You can also follow WebKit <a href="https://www.linkedin.com/in/apple-webkit/">on LinkedIn</a>. If you find a bug or problem, please file a <a href="https://bugs.webkit.org/">WebKit bug report</a>.</p>

                            </div></div>
  </body>
</html>
