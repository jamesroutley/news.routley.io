<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://fly.io/ruby-dispatch/pairing-with-gpt-4/">Original</a>
    <h1>Pairing With GPT-4</h1>
    
    <div id="readability-page-1" class="page"><article> <dl> <dt>Author</dt> <dd> <img src="https://www.gravatar.com/avatar/0cbe06e04f80388dc83d1a2cbac48aec" alt="Brad Gessler"/> <dl> <dt>Name</dt> <dd> Brad Gessler </dd> <dt>Social Media</dt> <dd> <a href="https://twitter.com/bradgessler" target="_blank" rel="noopener noreferrer"> <span aria-hidden="true">@bradgessler</span> <span>View Twitter Profile</span> </a> </dd> </dl> </dd> </dl> <section> <figure> <img src="https://fly.io/ruby-dispatch/2023-03-23/gpt-4-cover.webp" alt=""/> <figcaption> <span>Image by</span> <svg role="img" style="pointer-events: none; width: 17px; height: 17px;" viewBox="0 0 20 20" fill="currentColor" fill-rule="evenodd"> <g buffered-rendering="static"> <path fill-rule="evenodd" d="M1 8a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 018.07 3h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0016.07 6H17a2 2 0 012 2v7a2 2 0 01-2 2H3a2 2 0 01-2-2V8zm13.5 3a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM10 14a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path> </g> </svg> <a href="https://annieruygtillustration.com/" target="_blank"> Annie Ruygt </a> </figcaption> </figure> <p><strong>GPT-4 can be helpful for beginner and senior Ruby developers, but it does have limitations. It won&#39;t write all of your software for you, but it will point you in a useful direction, especially if you prefer learning by doing.</strong></p> <p>Let&#39;s look at how well GPT-4 pairing works by picking an easy, but less well known project with some edge cases: downloading a RubyGem, parsing the docs via YARN, and dumping them into a Sqlite database.</p> <h2 id="the-initial-prompt"><a href="#the-initial-prompt" aria-label="Anchor"></a>The Initial Prompt</h2> <blockquote> <p>Create a Ruby script for me that downloads a RubyGem, parses the docs via YARD, and dumps them into a Sqlite database that&#39;s named <code>#{gem-name}-#{gem-version}.db</code>. The database should also include information from the Gem spec.</p> </blockquote> <p>GPT-4 usually starts its responses with an overview of what it&#39;s about to do, then shows how it solves the problem, followed by recapping and summing up the solution.</p> <h3 id="gpt-4-response"><a href="#gpt-4-response" aria-label="Anchor"></a>GPT-4 Response</h3><p>To create a Ruby script that downloads a RubyGem, parses the documentation using YARD, and stores the data in a SQLite database named with the gem name and version, you will need to follow these steps:</p> <ol> <li>Install the required gems: <ul> <li><code>gem install yard</code> </li><li><code>gem install sqlite3</code> </li><li><code>gem install bundler</code> </li></ul> </li><li>Create a new file named <code>gem_doc_parser.rb</code> and paste the following code: </li></ol> <div><pre><code><span>require</span> <span>&#39;yard&#39;</span>
<span>require</span> <span>&#39;sqlite3&#39;</span>
<span>require</span> <span>&#39;bundler&#39;</span>

<span>def</span> <span>download_and_parse_gem</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>gem_path</span> <span>=</span> <span>&#34;</span><span>#{</span><span>gem_name</span><span>}</span><span>-</span><span>#{</span><span>gem_version</span><span>}</span><span>&#34;</span>

  <span># Download the gem</span>
  <span>Bundler</span><span>::</span><span>CLI</span><span>.</span><span>start</span><span>([</span><span>&#34;gem&#34;</span><span>,</span> <span>gem_name</span><span>,</span> <span>&#34;--version&#34;</span><span>,</span> <span>gem_version</span><span>])</span>

  <span># Parse the gem documentation using YARD</span>
  <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>clear</span>
  <span>YARD</span><span>::</span><span>Parser</span><span>::</span><span>SourceParser</span><span>.</span><span>parse</span><span>(</span><span>gem_path</span><span>)</span>
<span>end</span>

<span>def</span> <span>create_database</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>db</span> <span>=</span> <span>SQLite3</span><span>::</span><span>Database</span><span>.</span><span>new</span><span>(</span><span>&#34;</span><span>#{</span><span>gem_name</span><span>}</span><span>-</span><span>#{</span><span>gem_version</span><span>}</span><span>.db&#34;</span><span>)</span>

  <span># Create tables for storing gem spec and documentation</span>
  <span>db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
    CREATE TABLE IF NOT EXISTS gem_spec (
      id INTEGER PRIMARY KEY,
      name TEXT,
      version TEXT
    );
</span><span>  SQL</span>

  <span>db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
    CREATE TABLE IF NOT EXISTS gem_docs (
      id INTEGER PRIMARY KEY,
      path TEXT,
      type TEXT,
      doc TEXT
    );
</span><span>  SQL</span>

  <span>db</span>
<span>end</span>

<span>def</span> <span>store_gem_spec</span><span>(</span><span>db</span><span>,</span> <span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO gem_spec (name, version) VALUES (?, ?)&#34;</span><span>,</span> <span>[</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>])</span>
<span>end</span>

<span>def</span> <span>store_docs</span><span>(</span><span>db</span><span>)</span>
  <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>all</span><span>.</span><span>each</span> <span>do</span> <span>|</span><span>object</span><span>|</span>
    <span>path</span> <span>=</span> <span>object</span><span>.</span><span>path</span>
    <span>type</span> <span>=</span> <span>object</span><span>.</span><span>type</span>
    <span>doc</span> <span>=</span> <span>object</span><span>.</span><span>docstring</span><span>.</span><span>to_raw</span>

    <span>db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO gem_docs (path, type, doc) VALUES (?, ?, ?)&#34;</span><span>,</span> <span>[</span><span>path</span><span>,</span> <span>type</span><span>,</span> <span>doc</span><span>])</span>
  <span>end</span>
<span>end</span>

<span>def</span> <span>main</span>
  <span>puts</span> <span>&#34;Enter the gem name:&#34;</span>
  <span>gem_name</span> <span>=</span> <span>gets</span><span>.</span><span>chomp</span>

  <span>puts</span> <span>&#34;Enter the gem version:&#34;</span>
  <span>gem_version</span> <span>=</span> <span>gets</span><span>.</span><span>chomp</span>

  <span>download_and_parse_gem</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>

  <span>db</span> <span>=</span> <span>create_database</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>store_gem_spec</span><span>(</span><span>db</span><span>,</span> <span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>store_docs</span><span>(</span><span>db</span><span>)</span>

  <span>puts</span> <span>&#34;Documentation has been stored in </span><span>#{</span><span>gem_name</span><span>}</span><span>-</span><span>#{</span><span>gem_version</span><span>}</span><span>.db&#34;</span>
<span>end</span>

<span>main</span>
</code></pre></div><p>This script will perform the following tasks:</p> <ol> <li>Download and parse the gem documentation using YARD </li><li>Create a SQLite database named with the gem name and version </li><li>Create tables for storing gem spec and documentation </li><li>Store the gem spec (name and version) in the database </li><li>Store the documentation in the database </li></ol> <p>To run the script, simply execute <code>ruby gem_doc_parser.rb</code> and follow the prompts to enter the gem name and version. The documentation will be stored in the specified SQLite database.</p> <h2 id="let-s-see-if-it-works"><a href="#let-s-see-if-it-works" aria-label="Anchor"></a>Let&#39;s See if It Works!</h2><p>We have GPT-4&#39;s solution. Now its time to copy the code above into <code>gem_doc_parser.rb</code> and run it.</p> <div><pre><code>Ignoring rbs-2.8.2 because its extensions are not built. Try: gem pristine rbs --version 2.8.2
Enter the gem name:
rake
Enter the gem version:
13.0.6
gem_doc_parser.rb:9:in `download_and_parse_gem&#39;: uninitialized constant Bundler::CLI (NameError)

  Bundler::CLI.start([&#34;gem&#34;, gem_name, &#34;--version&#34;, gem_version])
         ^^^^^
  from gem_doc_parser.rb:61:in `main&#39;
  from gem_doc_parser.rb:70:in `&lt;main&gt;&#39;

</code></pre></div><p>Uh oh! We already run into our first error. Let&#39;s paste that output into GPT-4 and see what it tells us.</p> <blockquote> <p>That didn&#39;t work! I got this error…</p> </blockquote> <h3 id="gpt-4-response-2"><a href="#gpt-4-response-2" aria-label="Anchor"></a>GPT-4 Response</h3><p>I apologize for the confusion. I misunderstood your initial request. You want to download and parse a specific RubyGem, not create a new gem.</p> <p>Please follow these steps to update the script:</p> <ol> <li>Replace the <code>download_and_parse_gem</code> method with the following: </li></ol> <div><pre><code><span>def</span> <span>download_and_parse_gem</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>gem_path</span> <span>=</span> <span>Bundler</span><span>::</span><span>CLI</span><span>::</span><span>Common</span><span>.</span><span>select_spec</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>).</span><span>full_gem_path</span>

  <span># Parse the gem documentation using YARD</span>
  <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>clear</span>
  <span>YARD</span><span>::</span><span>Parser</span><span>::</span><span>SourceParser</span><span>.</span><span>parse</span><span>(</span><span>gem_path</span><span>)</span>
<span>end</span>
</code></pre></div> <ol> <li>Install the <code>bundler</code> gem by running: </li></ol>  <ol> <li>Update your Gemfile to include the gem you want to download and parse: </li></ol> <div><pre><code>source &#39;https://rubygems.org&#39;

gem &#39;rake&#39;, &#39;13.0.6&#39;
</code></pre></div> <ol> <li>Install the specified gem with Bundler: </li></ol> <p>After making these updates, you should be able to run the script with <code>ruby gem_doc_parser.rb</code>. The script will parse the documentation for the gem specified in the Gemfile and store it in a SQLite database.</p> <h2 id="will-gpt-4-s-fix-work"><a href="#will-gpt-4-s-fix-work" aria-label="Anchor"></a>Will GPT-4&#39;s Fix Work?</h2><p>Ok, let&#39;s do this one more time just for fun to see if it runs.</p> <div><pre><code><span>Ignoring</span> <span>rbs</span><span>-</span><span>2.8</span><span>.</span><span>2</span> <span>because</span> <span>its</span> <span>extensions</span> <span>are</span> <span>not</span> <span>built</span><span>.</span> <span>Try</span><span>:</span> <span>gem</span> <span>pristine</span> <span>rbs</span> <span>--</span><span>version</span> <span>2.8</span><span>.</span><span>2</span>
<span>Enter</span> <span>the</span> <span>gem</span> <span>name:
</span><span>rake</span>
<span>Enter</span> <span>the</span> <span>gem</span> <span>version:
</span><span>13.0</span><span>.</span><span>6</span>
<span>gem_doc_parser</span><span>.</span><span>rb</span><span>:</span><span>6</span><span>:in</span> <span>`download_and_parse_gem&#39;: uninitialized constant Bundler::CLI (NameError)

  gem_path = Bundler::CLI::Common.select_spec(gem_name, gem_version).full_gem_path
                         ^^^^^^^^
  from gem_doc_parser.rb:58:in `</span><span>main</span><span>&#39;
  from gem_doc_parser.rb:67:in `&lt;main&gt;&#39;</span>
</code></pre></div><p>Nope!</p> <p>This is where GPT-4 can be problematic for people who might be new to software development that are trying to solve specific problems right away. If you&#39;re using it this way, you&#39;ll find that GPT-4 will give you a plausible answer, but it usually won&#39;t work on the first try.</p> <p>That&#39;s OK though, let&#39;s get more specific about how we want this to run.</p> <h2 id="more-experience-helps-gpt-4-give-better-results"><a href="#more-experience-helps-gpt-4-give-better-results" aria-label="Anchor"></a>More Experience Helps GPT-4 Give Better Results</h2><p>If you&#39;ve built applications before, you can give GPT-4 a more specific prompt and you&#39;ll get back an answer that&#39;s more inline with what you want.</p> <blockquote> <p>That doesn&#39;t work either. Let&#39;s try this instead: instead of using Bundler to install the gem, just download the .gem file directly from RubyGems, save it to a temporary path, then have Yard document that one gem and dump it into a sqlite file.</p> <p>Put all of this into one class that I can call from Ruby code. Then let&#39;s call that class from the CLI so that looks something like this:</p> <p>$ ruby gem-to-sqlite rake 13.0.6</p> </blockquote> <p>This type of prompt is something that feels more like an experienced developer talking to a developer who might just be starting out. It gives us back some more reasonable code.</p> <div><pre><code><span>require</span> <span>&#39;yard&#39;</span>
<span>require</span> <span>&#39;sqlite3&#39;</span>
<span>require</span> <span>&#39;net/http&#39;</span>
<span>require</span> <span>&#39;tmpdir&#39;</span>
<span>require</span> <span>&#39;rubygems/package&#39;</span>

<span>class</span> <span>GemToSqlite</span>
  <span>def</span> <span>initialize</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
    <span>@gem_name</span> <span>=</span> <span>gem_name</span>
    <span>@gem_version</span> <span>=</span> <span>gem_version</span>
  <span>end</span>

  <span>def</span> <span>download_gem</span>
    <span>gem_url</span> <span>=</span> <span>&#34;https://rubygems.org/downloads/</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.gem&#34;</span>
    <span>uri</span> <span>=</span> <span>URI</span><span>(</span><span>gem_url</span><span>)</span>
    <span>file_path</span> <span>=</span> <span>File</span><span>.</span><span>join</span><span>(</span><span>Dir</span><span>.</span><span>tmpdir</span><span>,</span> <span>&#34;</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.gem&#34;</span><span>)</span>

    <span>File</span><span>.</span><span>write</span><span>(</span><span>file_path</span><span>,</span> <span>Net</span><span>::</span><span>HTTP</span><span>.</span><span>get</span><span>(</span><span>uri</span><span>))</span>
    <span>file_path</span>
  <span>end</span>

  <span>def</span> <span>extract_gem</span><span>(</span><span>file_path</span><span>)</span>
    <span>spec</span> <span>=</span> <span>nil</span>
    <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>spec</span><span>.</span><span>files</span><span>.</span><span>each</span> <span>do</span> <span>|</span><span>file</span><span>|</span>
      <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>clear</span>
      <span>YARD</span><span>::</span><span>Parser</span><span>::</span><span>SourceParser</span><span>.</span><span>parse_string</span><span>(</span><span>file</span><span>)</span>
      <span>spec</span> <span>=</span> <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>spec</span>
    <span>end</span>
    <span>spec</span>
  <span>end</span>

  <span>def</span> <span>create_database</span>
    <span>db</span> <span>=</span> <span>SQLite3</span><span>::</span><span>Database</span><span>.</span><span>new</span><span>(</span><span>&#34;</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.db&#34;</span><span>)</span>

    <span>db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
      CREATE TABLE IF NOT EXISTS gem_spec (
        id INTEGER PRIMARY KEY,
        name TEXT,
        version TEXT
      );
</span><span>    SQL</span>

    <span>db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
      CREATE TABLE IF NOT EXISTS gem_docs (
        id INTEGER PRIMARY KEY,
        path TEXT,
        type TEXT,
        doc TEXT
      );
</span><span>    SQL</span>

    <span>db</span>
  <span>end</span>

  <span>def</span> <span>store_gem_spec</span><span>(</span><span>db</span><span>,</span> <span>spec</span><span>)</span>
    <span>db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO gem_spec (name, version) VALUES (?, ?)&#34;</span><span>,</span> <span>[</span><span>@gem_name</span><span>,</span> <span>@gem_version</span><span>])</span>
  <span>end</span>

  <span>def</span> <span>store_docs</span><span>(</span><span>db</span><span>)</span>
    <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>all</span><span>.</span><span>each</span> <span>do</span> <span>|</span><span>object</span><span>|</span>
      <span>path</span> <span>=</span> <span>object</span><span>.</span><span>path</span>
      <span>type</span> <span>=</span> <span>object</span><span>.</span><span>type</span>
      <span>doc</span> <span>=</span> <span>object</span><span>.</span><span>docstring</span><span>.</span><span>to_raw</span>

      <span>db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO gem_docs (path, type, doc) VALUES (?, ?, ?)&#34;</span><span>,</span> <span>[</span><span>path</span><span>,</span> <span>type</span><span>,</span> <span>doc</span><span>])</span>
    <span>end</span>
  <span>end</span>

  <span>def</span> <span>run</span>
    <span>gem_path</span> <span>=</span> <span>download_gem</span>
    <span>spec</span> <span>=</span> <span>extract_gem</span><span>(</span><span>gem_path</span><span>)</span>

    <span>db</span> <span>=</span> <span>create_database</span>
    <span>store_gem_spec</span><span>(</span><span>db</span><span>,</span> <span>spec</span><span>)</span>
    <span>store_docs</span><span>(</span><span>db</span><span>)</span>

    <span>puts</span> <span>&#34;Documentation has been stored in </span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.db&#34;</span>
  <span>end</span>
<span>end</span>
</code></pre></div><p>When I run it I get another error:</p> <div><pre><code>fly-apps/gpt4 → ruby gem_to_sqlite.rb rake 13.0.6
Ignoring rbs-2.8.2 because its extensions are not built. Try: gem pristine rbs --version 2.8.2
[warn]: Syntax error in `(stdin)`:(1,8): no .&lt;digit&gt; floating literal anymore; put 0 before dot
[warn]: ParserSyntaxError: syntax error in `(stdin)`:(1,8): no .&lt;digit&gt; floating literal anymore; put 0 before dot
[warn]: Stack trace:
  /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/yard-0.9.28/lib/yard/parser/ruby/ruby_parser.rb:601:in `on_parse_error&#39;
  /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/yard-0.9.28/lib/yard/parser/ruby/ruby_parser.rb:56:in `parse&#39;
  /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/yard-0.9.28/lib/yard/parser/ruby/ruby_parser.rb:56:in `parse&#39;
  /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/yard-0.9.28/lib/yard/parser/ruby/ruby_parser.rb:17:in `parse&#39;
  /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/yard-0.9.28/lib/yard/parser/source_parser.rb:442:in `parse&#39;
  /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/yard-0.9.28/lib/yard/parser/source_parser.rb:124:in `parse_string&#39;
</code></pre></div><p>It gives me back this fix:</p> <h3 id="gpt-4-response-3"><a href="#gpt-4-response-3" aria-label="Anchor"></a>GPT-4 Response</h3><p>Apologies for the issues you&#39;ve encountered. It appears the error is related to the YARD parser when parsing the gem. I&#39;ve updated the code to address this issue.</p> <p>Update the <code>extract_gem</code> method in the <code>gem_to_sqlite.rb</code> file with the following code:</p> <div><pre><code><span>def</span> <span>extract_gem</span><span>(</span><span>file_path</span><span>)</span>
  <span>spec</span> <span>=</span> <span>nil</span>
  <span>gem_dir</span> <span>=</span> <span>File</span><span>.</span><span>join</span><span>(</span><span>Dir</span><span>.</span><span>tmpdir</span><span>,</span> <span>&#34;</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>&#34;</span><span>)</span>

  <span># Extract the gem to a temporary directory</span>
  <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>extract_files</span><span>(</span><span>gem_dir</span><span>)</span>
  <span>spec</span> <span>=</span> <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>spec</span>

  <span># Parse the gem documentation using YARD</span>
  <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>clear</span>
  <span>Dir</span><span>.</span><span>glob</span><span>(</span><span>File</span><span>.</span><span>join</span><span>(</span><span>gem_dir</span><span>,</span> <span>&#39;**&#39;</span><span>,</span> <span>&#39;*.rb&#39;</span><span>)).</span><span>each</span> <span>do</span> <span>|</span><span>file</span><span>|</span>
    <span>YARD</span><span>::</span><span>Parser</span><span>::</span><span>SourceParser</span><span>.</span><span>parse</span><span>(</span><span>file</span><span>)</span>
  <span>end</span>

  <span>spec</span>
<span>end</span>
</code></pre></div><h2 id="an-aside-inline-the-gem-bundle"><a href="#an-aside-inline-the-gem-bundle" aria-label="Anchor"></a>An Aside: Inline the Gem Bundle</h2><p>I also remembered that I want to share this code for this post, so I asked GPT-4 to move the Gems into an inline bundler.</p> <blockquote> <p>Could you move the require statements up top into an inline bundler block?</p> </blockquote> <h3 id="gpt-4-response-4"><a href="#gpt-4-response-4" aria-label="Anchor"></a>GPT-4 Response</h3><p>Sure! You can use an inline Bundler block to manage gem dependencies. Update the <code>gem_to_sqlite.rb</code> file with the following code:</p> <div><pre><code>require &#39;bundler/inline&#39;

gemfile do
  source &#39;https://rubygems.org&#39;
  gem &#39;yard&#39;, &#39;~&gt; 0.9.28&#39;
  gem &#39;sqlite3&#39;, &#39;~&gt; 1.4&#39;
end

require &#39;yard&#39;
require &#39;sqlite3&#39;
require &#39;net/http&#39;
require &#39;tmpdir&#39;
require &#39;rubygems/package&#39;

## ... (rest of the GemToSqlite class definition)
</code></pre></div><p>It&#39;s impressive that GPT-4 is able to give me a reasonable response for an &#34;aside&#34;. Let&#39;s see if that distracted it because I ran into another bug running this.</p> <h2 id="another-bug"><a href="#another-bug" aria-label="Anchor"></a>Another Bug</h2> <blockquote> <p>I ran into another bug! Check it out:</p> </blockquote> <div><pre><code>fly-apps/gpt4 → ruby gem_to_sqlite-2.rb
<span>[</span>warn]: <span>in </span>YARD::Handlers::Ruby::VisibilityHandler: Undocumentable statement, cannot determine method name
  <span>in </span>file <span>&#39;/var/folders/_n/58_fmw2j26sc63pr7lcvcyfh0000gn/T/rake-13.0.6/lib/rake/dsl_definition.rb&#39;</span>:23:

  23: private<span>(</span><span>*</span>FileUtils.instance_methods<span>(</span><span>false</span><span>))</span>

<span>[</span>warn]: <span>in </span>YARD::Handlers::Ruby::VisibilityHandler: Undocumentable statement, cannot determine method name
  <span>in </span>file <span>&#39;/var/folders/_n/58_fmw2j26sc63pr7lcvcyfh0000gn/T/rake-13.0.6/lib/rake/dsl_definition.rb&#39;</span>:24:

  24: private<span>(</span><span>*</span>FileUtilsExt.instance_methods<span>(</span><span>false</span><span>))</span>

/Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/sqlite3-1.6.1-arm64-darwin/lib/sqlite3/statement.rb:41:in <span>`</span>bind_param<span>&#39;: can&#39;</span>t prepare Symbol <span>(</span>RuntimeError<span>)</span>
  from /Users/bradgessler/.rbenv/versions/3.2.0/lib/ruby/gems/3.2.0/gems/sqlite3-1.6.1-arm64-darwin/lib/sqlite3/statement.rb:41:in <span>`</span>block <span>in </span>bind_params<span>&#39;
</span></code></pre></div><h3 id="gpt-4-response-5"><a href="#gpt-4-response-5" aria-label="Anchor"></a>GPT-4 Response</h3><p>I apologize for the oversight. It seems that the error is related to the insertion of data into the SQLite database. The issue comes from the YARD object type being a Symbol, which SQLite doesn&#39;t support. To fix this, we need to convert the object type to a String before inserting it into the database.</p> <p>Update the <code>store_docs</code> method in the <code>gem_to_sqlite.rb</code> file with the following code:</p> <div><pre><code>def store_docs(db)
  YARD::Registry.all.each do |object|
    path = object.path
    type = object.type.to_s
    doc = object.docstring.to_raw

    db.execute(&#34;INSERT INTO gem_docs (path, type, doc) VALUES (?, ?, ?)&#34;, [path, type, doc])
  end
end
</code></pre></div><p>The only change made is converting the object type to a string using <code>to_s</code>:</p> <p>With this change, you should be able to run the script without any issues:</p> <div><pre><code>./gem-to-sqlite rake 13.0.6
</code></pre></div><p>Let&#39;s try it again!</p> <div><pre><code>fly-apps/gpt4 → ruby gem_to_sqlite-2.rb
<span>[</span>warn]: <span>in </span>YARD::Handlers::Ruby::VisibilityHandler: Undocumentable statement, cannot determine method name
  <span>in </span>file <span>&#39;/var/folders/_n/58_fmw2j26sc63pr7lcvcyfh0000gn/T/rake-13.0.6/lib/rake/dsl_definition.rb&#39;</span>:23:

  23: private<span>(</span><span>*</span>FileUtils.instance_methods<span>(</span><span>false</span><span>))</span>

<span>[</span>warn]: <span>in </span>YARD::Handlers::Ruby::VisibilityHandler: Undocumentable statement, cannot determine method name
  <span>in </span>file <span>&#39;/var/folders/_n/58_fmw2j26sc63pr7lcvcyfh0000gn/T/rake-13.0.6/lib/rake/dsl_definition.rb&#39;</span>:24:

  24: private<span>(</span><span>*</span>FileUtilsExt.instance_methods<span>(</span><span>false</span><span>))</span>

Documentation has been stored <span>in </span>rake-13.0.6.db
</code></pre></div><p>Success! Let&#39;s open up the sqlite database and make sure it has what we expect.</p> <div><pre><code>sqlite&gt; select * from gem_spec;
1|rake|13.0.6
sqlite&gt; select * from gem_docs;
1|RDoc|module|
2|RDoc::Page|module|
3|RDoc::Page::FONTS|constant|
4|RDoc::Page::STYLE|constant|
5|RDoc::Page::XHTML_PREAMBLE|constant|
6|RDoc::Page::HEADER|constant|
7|RDoc::Page::FILE_PAGE|constant|
8|RDoc::Page::CLASS_PAGE|constant|
9|RDoc::Page::METHOD_LIST|constant|
10|RDoc::Page::FOOTER|constant|
11|RDoc::Page::BODY|constant|
12|RDoc::Page::SRC_PAGE|constant|Source code ##########################
13|RDoc::Page::FR_INDEX_BODY|constant|Index ################################
14|RDoc::Page::FILE_INDEX|constant|
15|RDoc::Page::CLASS_INDEX|constant|
16|RDoc::Page::METHOD_INDEX|constant|
17|RDoc::Page::INDEX|constant|
18|Rake|module|--
Copyright 2003-2010 by Jim Weirich (jim.weirich@gmail.com)

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &#34;Software&#34;), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
++
19|Rake::CommandLineOptionError|constant|
</code></pre></div><p>Not bad! We can see our gem name and version in the <code>gem_spec</code> table and all of the docs in <code>gem_docs</code>.</p> <h2 id="let-s-have-gpt-4-clean-this-up-for-a-demo"><a href="#let-s-have-gpt-4-clean-this-up-for-a-demo" aria-label="Anchor"></a>Let&#39;s Have GPT-4 Clean This Up for a Demo</h2><p>Since I need to bundle all of this up in a way that I can share it, I&#39;m going to ask GPT-4 to do the work.</p> <blockquote> <p>It works! I need to get all of this into one file so that I can share it via a Github Gist. Could you consolidate into one file, remove any unnecessary code, and include in code comments up top how to run the script? Make sure its a <code>.rb</code> file and let&#39;s tell people to run it via <code>ruby gem-to-sqlite.rb rake 13.0.6</code> (for example)</p> </blockquote> <h3 id="gpt-4-response-6"><a href="#gpt-4-response-6" aria-label="Anchor"></a>GPT-4 Response</h3><p>Sure! Here&#39;s the consolidated version of the script as a single file named <code>gem-to-sqlite.rb</code>. I&#39;ve also added comments at the beginning of the file with instructions on how to run it.</p> <div><pre><code><span># gem-to-sqlite.rb</span>
<span>#</span>
<span># Usage: ruby gem-to-sqlite.rb &lt;gem_name&gt; &lt;gem_version&gt;</span>
<span># Example: ruby gem-to-sqlite.rb rake 13.0.6</span>

<span>require</span> <span>&#39;bundler/inline&#39;</span>

<span>gemfile</span> <span>do</span>
  <span>source</span> <span>&#39;https://rubygems.org&#39;</span>
  <span>gem</span> <span>&#39;yard&#39;</span><span>,</span> <span>&#39;~&gt; 0.9.28&#39;</span>
  <span>gem</span> <span>&#39;sqlite3&#39;</span><span>,</span> <span>&#39;~&gt; 1.4&#39;</span>
<span>end</span>

<span>require</span> <span>&#39;yard&#39;</span>
<span>require</span> <span>&#39;sqlite3&#39;</span>
<span>require</span> <span>&#39;net/http&#39;</span>
<span>require</span> <span>&#39;tmpdir&#39;</span>
<span>require</span> <span>&#39;rubygems/package&#39;</span>

<span>class</span> <span>GemToSqlite</span>
  <span>def</span> <span>initialize</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
    <span>@gem_name</span> <span>=</span> <span>gem_name</span>
    <span>@gem_version</span> <span>=</span> <span>gem_version</span>
  <span>end</span>

  <span>def</span> <span>download_gem</span>
    <span>gem_url</span> <span>=</span> <span>&#34;https://rubygems.org/downloads/</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.gem&#34;</span>
    <span>uri</span> <span>=</span> <span>URI</span><span>(</span><span>gem_url</span><span>)</span>
    <span>file_path</span> <span>=</span> <span>File</span><span>.</span><span>join</span><span>(</span><span>Dir</span><span>.</span><span>tmpdir</span><span>,</span> <span>&#34;</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.gem&#34;</span><span>)</span>

    <span>File</span><span>.</span><span>write</span><span>(</span><span>file_path</span><span>,</span> <span>Net</span><span>::</span><span>HTTP</span><span>.</span><span>get</span><span>(</span><span>uri</span><span>))</span>
    <span>file_path</span>
  <span>end</span>

  <span>def</span> <span>extract_gem</span><span>(</span><span>file_path</span><span>)</span>
    <span>spec</span> <span>=</span> <span>nil</span>
    <span>gem_dir</span> <span>=</span> <span>File</span><span>.</span><span>join</span><span>(</span><span>Dir</span><span>.</span><span>tmpdir</span><span>,</span> <span>&#34;</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>&#34;</span><span>)</span>

    <span># Extract the gem to a temporary directory</span>
    <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>extract_files</span><span>(</span><span>gem_dir</span><span>)</span>
    <span>spec</span> <span>=</span> <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>spec</span>

    <span># Parse the gem documentation using YARD</span>
    <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>clear</span>
    <span>Dir</span><span>.</span><span>glob</span><span>(</span><span>File</span><span>.</span><span>join</span><span>(</span><span>gem_dir</span><span>,</span> <span>&#39;**&#39;</span><span>,</span> <span>&#39;*.rb&#39;</span><span>)).</span><span>each</span> <span>do</span> <span>|</span><span>file</span><span>|</span>
      <span>YARD</span><span>::</span><span>Parser</span><span>::</span><span>SourceParser</span><span>.</span><span>parse</span><span>(</span><span>file</span><span>)</span>
    <span>end</span>

    <span>spec</span>
  <span>end</span>

  <span>def</span> <span>create_database</span>
    <span>db</span> <span>=</span> <span>SQLite3</span><span>::</span><span>Database</span><span>.</span><span>new</span><span>(</span><span>&#34;</span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.db&#34;</span><span>)</span>

    <span>db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
      CREATE TABLE IF NOT EXISTS gem_spec (
        id INTEGER PRIMARY KEY,
        name TEXT,
        version TEXT
      );
</span><span>    SQL</span>

    <span>db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
      CREATE TABLE IF NOT EXISTS gem_docs (
        id INTEGER PRIMARY KEY,
        path TEXT,
        type TEXT,
        doc TEXT
      );
</span><span>    SQL</span>

    <span>db</span>
  <span>end</span>

  <span>def</span> <span>store_gem_spec</span><span>(</span><span>db</span><span>,</span> <span>spec</span><span>)</span>
    <span>db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO gem_spec (name, version) VALUES (?, ?)&#34;</span><span>,</span> <span>[</span><span>@gem_name</span><span>,</span> <span>@gem_version</span><span>])</span>
  <span>end</span>

  <span>def</span> <span>store_docs</span><span>(</span><span>db</span><span>)</span>
    <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>all</span><span>.</span><span>each</span> <span>do</span> <span>|</span><span>object</span><span>|</span>
      <span>path</span> <span>=</span> <span>object</span><span>.</span><span>path</span>
      <span>type</span> <span>=</span> <span>object</span><span>.</span><span>type</span><span>.</span><span>to_s</span>
      <span>doc</span> <span>=</span> <span>object</span><span>.</span><span>docstring</span><span>.</span><span>to_raw</span>

      <span>db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO gem_docs (path, type, doc) VALUES (?, ?, ?)&#34;</span><span>,</span> <span>[</span><span>path</span><span>,</span> <span>type</span><span>,</span> <span>doc</span><span>])</span>
    <span>end</span>
  <span>end</span>

  <span>def</span> <span>run</span>
    <span>gem_path</span> <span>=</span> <span>download_gem</span>
    <span>spec</span> <span>=</span> <span>extract_gem</span><span>(</span><span>gem_path</span><span>)</span>

    <span>db</span> <span>=</span> <span>create_database</span>
    <span>store_gem_spec</span><span>(</span><span>db</span><span>,</span> <span>spec</span><span>)</span>
    <span>store_docs</span><span>(</span><span>db</span><span>)</span>

    <span>puts</span> <span>&#34;Documentation has been stored in </span><span>#{</span><span>@gem_name</span><span>}</span><span>-</span><span>#{</span><span>@gem_version</span><span>}</span><span>.db&#34;</span>
  <span>end</span>
<span>end</span>

<span>if</span> <span>ARGV</span><span>.</span><span>length</span> <span>!=</span> <span>2</span>
  <span>puts</span> <span>&#34;Usage: ruby gem-to-sqlite.rb &lt;gem_name&gt; &lt;gem_version&gt;&#34;</span>
  <span>exit</span> <span>1</span>
<span>end</span>

<span>gem_name</span> <span>=</span> <span>ARGV</span><span>[</span><span>0</span><span>]</span>
<span>gem_version</span> <span>=</span> <span>ARGV</span><span>[</span><span>1</span><span>]</span>

<span>gem_to_sqlite</span> <span>=</span> <span>GemToSqlite</span><span>.</span><span>new</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
<span>gem_to_sqlite</span><span>.</span><span>run</span>
</code></pre></div><p>That&#39;s pretty darn good, and the <a href="https://gist.github.com/bradgessler/02b201c1cc94c24836195db762ada02d">gist is available at Github</a>.</p> <h2 id="gpt-4-likes-to-fake-it-until-it-makes-it-or-you-lose-your-patience"><a href="#gpt-4-likes-to-fake-it-until-it-makes-it-or-you-lose-your-patience" aria-label="Anchor"></a>GPT-4 Likes to Fake It Until It Makes It (or You Lose Your Patience)</h2><p>Now I&#39;m going to ask it a question that will probably break it using questionably imprecise language:</p> <blockquote> <p>How could I use an instance of <code>YARD::Registry</code> instead of the <code>.all</code> singleton?</p> </blockquote> <h3 id="gpt-4-response-7"><a href="#gpt-4-response-7" aria-label="Anchor"></a>GPT-4 Response</h3><p>You can create a new instance of <code>YARD::Registry</code> and use it to parse and store the documentation. First, create an instance variable <code>@registry</code> in the <code>initialize</code> method:</p> <div><pre><code><span>def</span> <span>initialize</span><span>(</span><span>gem_name</span><span>,</span> <span>gem_version</span><span>)</span>
  <span>@gem_name</span> <span>=</span> <span>gem_name</span>
  <span>@gem_version</span> <span>=</span> <span>gem_version</span>
  <span>@registry</span> <span>=</span> <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>new</span>
<span>end</span>
</code></pre></div> <hr/> <p>Bzzt wrong! <code>YARD::Registry</code> is a module. GPT-4 doesn&#39;t necessarily know what the actual Ruby code is behind what it&#39;s telling you—it seems to be matching patterns on something that seems like it should be a class, but it&#39;s not.</p> <h2 id="let-s-make-a-version-for-squirrels"><a href="#let-s-make-a-version-for-squirrels" aria-label="Anchor"></a>Let&#39;s Make a Version for Squirrels 🐿️</h2><p>Time to get silly! We made this script for squirrels, so let&#39;s ask GPT to rename a few things to make it more understandable to squirrels.</p> <blockquote> <p>Let&#39;s rename everything to something that would make a squirrel really happy</p> </blockquote> <div><pre><code><span># squirrel_gem_nut_collector.rb</span>
<span>#</span>
<span># Usage: ruby squirrel_gem_nut_collector.rb &lt;gem_name&gt; &lt;gem_version&gt;</span>
<span># Example: ruby squirrel_gem_nut_collector.rb rake 13.0.6</span>

<span>require</span> <span>&#39;bundler/inline&#39;</span>

<span>gemfile</span> <span>do</span>
  <span>source</span> <span>&#39;https://rubygems.org&#39;</span>
  <span>gem</span> <span>&#39;yard&#39;</span><span>,</span> <span>&#39;~&gt; 0.9.28&#39;</span>
  <span>gem</span> <span>&#39;sqlite3&#39;</span><span>,</span> <span>&#39;~&gt; 1.4&#39;</span>
<span>end</span>

<span>require</span> <span>&#39;yard&#39;</span>
<span>require</span> <span>&#39;sqlite3&#39;</span>
<span>require</span> <span>&#39;net/http&#39;</span>
<span>require</span> <span>&#39;tmpdir&#39;</span>
<span>require</span> <span>&#39;rubygems/package&#39;</span>

<span>class</span> <span>SquirrelGemNutCollector</span>
  <span>def</span> <span>initialize</span><span>(</span><span>nutty_gem_name</span><span>,</span> <span>crunchy_gem_version</span><span>)</span>
    <span>@nutty_gem_name</span> <span>=</span> <span>nutty_gem_name</span>
    <span>@crunchy_gem_version</span> <span>=</span> <span>crunchy_gem_version</span>
    <span>@nut_registry</span> <span>=</span> <span>YARD</span><span>::</span><span>Registry</span><span>.</span><span>new</span>
  <span>end</span>

  <span>def</span> <span>nut_fetcher</span>
    <span>nut_url</span> <span>=</span> <span>&#34;https://rubygems.org/downloads/</span><span>#{</span><span>@nutty_gem_name</span><span>}</span><span>-</span><span>#{</span><span>@crunchy_gem_version</span><span>}</span><span>.gem&#34;</span>
    <span>uri</span> <span>=</span> <span>URI</span><span>(</span><span>nut_url</span><span>)</span>
    <span>temp_nut_path</span> <span>=</span> <span>File</span><span>.</span><span>join</span><span>(</span><span>Dir</span><span>.</span><span>tmpdir</span><span>,</span> <span>&#34;</span><span>#{</span><span>@nutty_gem_name</span><span>}</span><span>-</span><span>#{</span><span>@crunchy_gem_version</span><span>}</span><span>.gem&#34;</span><span>)</span>

    <span>File</span><span>.</span><span>write</span><span>(</span><span>temp_nut_path</span><span>,</span> <span>Net</span><span>::</span><span>HTTP</span><span>.</span><span>get</span><span>(</span><span>uri</span><span>))</span>
    <span>temp_nut_path</span>
  <span>end</span>

  <span>def</span> <span>crack_nut</span><span>(</span><span>file_path</span><span>)</span>
    <span>nut_spec</span> <span>=</span> <span>nil</span>
    <span>cracked_nut_dir</span> <span>=</span> <span>File</span><span>.</span><span>join</span><span>(</span><span>Dir</span><span>.</span><span>tmpdir</span><span>,</span> <span>&#34;</span><span>#{</span><span>@nutty_gem_name</span><span>}</span><span>-</span><span>#{</span><span>@crunchy_gem_version</span><span>}</span><span>&#34;</span><span>)</span>

    <span># Crack open the gem nut and release the code</span>
    <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>extract_files</span><span>(</span><span>cracked_nut_dir</span><span>)</span>
    <span>nut_spec</span> <span>=</span> <span>Gem</span><span>::</span><span>Package</span><span>.</span><span>new</span><span>(</span><span>file_path</span><span>).</span><span>spec</span>

    <span># Parse the code with the power of YARD</span>
    <span>@nut_registry</span><span>.</span><span>clear</span>
    <span>Dir</span><span>.</span><span>glob</span><span>(</span><span>File</span><span>.</span><span>join</span><span>(</span><span>cracked_nut_dir</span><span>,</span> <span>&#39;**&#39;</span><span>,</span> <span>&#39;*.rb&#39;</span><span>)).</span><span>each</span> <span>do</span> <span>|</span><span>file</span><span>|</span>
      <span>YARD</span><span>::</span><span>Parser</span><span>::</span><span>SourceParser</span><span>.</span><span>parse</span><span>(</span><span>file</span><span>,</span> <span>@nut_registry</span><span>)</span>
    <span>end</span>

    <span>nut_spec</span>
  <span>end</span>

  <span>def</span> <span>nut_storage</span>
    <span>nut_db</span> <span>=</span> <span>SQLite3</span><span>::</span><span>Database</span><span>.</span><span>new</span><span>(</span><span>&#34;</span><span>#{</span><span>@nutty_gem_name</span><span>}</span><span>-</span><span>#{</span><span>@crunchy_gem_version</span><span>}</span><span>.db&#34;</span><span>)</span>

    <span>nut_db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
      CREATE TABLE IF NOT EXISTS nut_specs (
        id INTEGER PRIMARY KEY,
        name TEXT,
        version TEXT
      );
</span><span>    SQL</span>

    <span>nut_db</span><span>.</span><span>execute</span> <span>&lt;&lt;-</span><span>SQL</span><span>
      CREATE TABLE IF NOT EXISTS nut_docs (
        id INTEGER PRIMARY KEY,
        path TEXT,
        type TEXT,
        doc TEXT
      );
</span><span>    SQL</span>

    <span>nut_db</span>
  <span>end</span>

  <span>def</span> <span>store_nut_specs</span><span>(</span><span>nut_db</span><span>,</span> <span>spec</span><span>)</span>
    <span>nut_db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO nut_specs (name, version) VALUES (?, ?)&#34;</span><span>,</span> <span>[</span><span>@nutty_gem_name</span><span>,</span> <span>@crunchy_gem_version</span><span>])</span>
  <span>end</span>

  <span>def</span> <span>fill_nut_storage_with_magic</span><span>(</span><span>nut_db</span><span>)</span>
    <span>@nut_registry</span><span>.</span><span>all</span><span>.</span><span>each</span> <span>do</span> <span>|</span><span>object</span><span>|</span>
      <span>nutty_path</span> <span>=</span> <span>object</span><span>.</span><span>path</span>
      <span>crunchy_type</span> <span>=</span> <span>object</span><span>.</span><span>type</span><span>.</span><span>to_s</span>
      <span>docs_of_wisdom</span> <span>=</span> <span>object</span><span>.</span><span>docstring</span><span>.</span><span>to_raw</span>

      <span>nut_db</span><span>.</span><span>execute</span><span>(</span><span>&#34;INSERT INTO nut_docs (path, type, doc) VALUES (?, ?, ?)&#34;</span><span>,</span> <span>[</span><span>nutty_path</span><span>,</span> <span>crunchy_type</span><span>,</span> <span>docs_of_wisdom</span><span>])</span>
    <span>end</span>
  <span>end</span>

  <span>def</span> <span>collect_all_the_nuts</span>
    <span>path_to_nut</span> <span>=</span> <span>nut_fetcher</span>
    <span>nut_spec</span> <span>=</span> <span>crack_nut</span><span>(</span><span>path_to_nut</span><span>)</span>

    <span>nut_db</span> <span>=</span> <span>nut_storage</span>
    <span>store_nut_specs</span><span>(</span><span>nut_db</span><span>,</span> <span>nut_spec</span><span>)</span>
    <span>fill_nut_storage_with_magic</span><span>(</span><span>nut_db</span><span>)</span>
  <span>end</span>
<span>end</span>

<span>if</span> <span>ARGV</span><span>.</span><span>size</span>
</code></pre></div><p>😆</p> <p>I&#39;ll spare you these prompts, but I can assure you they were hilarious.</p> <ul> <li>How about for a old timey prospector from the gold rush? </li><li>Could you give me a cool hip hop version? </li><li>Do one for using words a 4 year old would understand </li></ul> <h2 id="overall-gpt-4-is-a-useful-tool"><a href="#overall-gpt-4-is-a-useful-tool" aria-label="Anchor"></a>Overall GPT-4 Is a Useful Tool</h2><p>To sum it up, here&#39;s what you should keep in mind when you add GPT-4 to your set of tools:</p> <h3 id="you-still-need-to-know-what-you-re-doing"><a href="#you-still-need-to-know-what-you-re-doing" aria-label="Anchor"></a>You Still Need to Know What You&#39;re Doing</h3><p>If you&#39;re a senior developer, giving GPT-4 more specific prompts results in better responses. It can reason with you through architectural problems or write you code samples; however, many times it doesn&#39;t know the right answer but confidently tells you something anyway.</p> <p>If you&#39;re a beginner, GPT-4 will give you responses that you might be able to fix and get running, but it&#39;s not the most concise way of doing it. Often times though the code won&#39;t work and you might not know how to ask it to fix it.</p> <h3 id="it-s-great-at-jumping-contexts"><a href="#it-s-great-at-jumping-contexts" aria-label="Anchor"></a>It&#39;s Great at Jumping Contexts</h3><p>GPT-4 shines when spanning different contexts. If comfortable in one programming language or framework and need to learn a new one, GPT-4 can help explain it to you and relate it back to concepts that you&#39;re accustomed to. In a lot of ways, GPT-4 is like looking into a mirror.</p> <h3 id="it-makes-up-seemingly-plausible-answers-that-could-be-wrong"><a href="#it-makes-up-seemingly-plausible-answers-that-could-be-wrong" aria-label="Anchor"></a>It Makes Up Seemingly Plausible Answers That Could Be Wrong.</h3><p>When I asked GPT-4 how to create an instance of a <code>YARD::Registry</code>, instead of using the singleton, it told me <code>YARD::Registry.new</code> . That seems right when thinking about the structure of idiomatic Ruby code, but YARD is not, so GPT-4 has a harder time answering the question.</p> <h3 id="it-gets-stuck-when-the-contexts-get-too-large-like-if-you-re-asking-for-code-from-5-different-files"><a href="#it-gets-stuck-when-the-contexts-get-too-large-like-if-you-re-asking-for-code-from-5-different-files" aria-label="Anchor"></a>It Gets Stuck When the &#34;contexts&#34; Get Too Large, Like if You&#39;re Asking for Code From 5 Different Files</h3><p>If you give GPT-4 too broad of a problem to solve, it can get lost and forget things. If you ask it to solve a problem for you like &#34;how do I create server-side anchor tags using Turbo and Hotwire&#34;, it will give you an initial answer that seems right across 5+ files. When you start fixing errors in those files, GPT-4 will loose track of some of the files and start giving you suggestions for fixing completely different code.</p>  </section> <dl> <dt> Next post  ↑ </dt> <dd> <a href="https://fly.io/ruby-dispatch/introducing-live-elements/"> Introducing Live Elements </a> </dd> <dt> Previous post  ↓ </dt> <dd> <a href="https://fly.io/ruby-dispatch/mrsk-vs-flyio/"> MRSK vs Fly.io </a> </dd> </dl> </article></div>
  </body>
</html>
