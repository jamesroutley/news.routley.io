<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/0verread/goralim">Original</a>
    <h1>Show HN: Goralim - a rate limiting pkg for Go to handle distributed workloads</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/0verread/goralim/blob/main/images/banner.png"><img src="https://github.com/0verread/goralim/raw/main/images/banner.png" alt="banner"/></a></p>

<p dir="auto"><a href="https://github.com/0verread/goralim">goralim</a> is a Golang package that provides a rate limiter based on <a href="https://en.wikipedia.org/wiki/Token_bucket" rel="nofollow">Token bucket</a> algorithm. It is capabale to handle distributed workload with its redis database support. It has HTTP server middleware support (as of now).</p>
<blockquote>
<p dir="auto">ðŸš§ this is a beta version now and under active development. For production use, fork it and made changes based on your need.</p>
</blockquote>

<div dir="auto" data-snippet-clipboard-copy-content="go get &#34;github.com/0verread/goralim&#34; -m"><pre>go get <span><span>&#34;</span>github.com/0verread/goralim<span>&#34;</span></span> -m</pre></div>

<div dir="auto" data-snippet-clipboard-copy-content="import (
  goralim &#34;github.com/0verread/goralim&#34;
)

	// Redis initialization
	config := goralim.RedisConfig {
		HOST: &#34;127.0.0.1&#34;,
		PORT: 6379,
    // password
		PASS: &#34;&#34;,
	}
	redisStore := goralim.NewRedisClient(config)

	// setup rate limiter for a key (key can be userId/client)
	// 10 is bucket size, 5 is bucket refill rate per second
	tb := goralim.NewTokenBucket(&#34;key123&#34;, redisStore, 10, 5)

	// create HTTP server and setup a goralim middleware to put a rate limiter
	handler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		fmt.Fprintln(w, &#34;Hey There this is a Request&#34;)
	})

	rateLimitedHandler := goralim.RateLimiter(tb, handler)
	http.ListenAndServe(&#34;:8080&#34;, rateLimitedHandler)
"><pre><span>import</span> (
  goralim <span>&#34;github.com/0verread/goralim&#34;</span>
)

	<span>// Redis initialization</span>
	<span>config</span> <span>:=</span> goralim.<span>RedisConfig</span> {
		<span>HOST</span>: <span>&#34;127.0.0.1&#34;</span>,
		<span>PORT</span>: <span>6379</span>,
    <span>// password</span>
		<span>PASS</span>: <span>&#34;&#34;</span>,
	}
	<span>redisStore</span> <span>:=</span> <span>goralim</span>.<span>NewRedisClient</span>(<span>config</span>)

	<span>// setup rate limiter for a key (key can be userId/client)</span>
	<span>// 10 is bucket size, 5 is bucket refill rate per second</span>
	<span>tb</span> <span>:=</span> <span>goralim</span>.<span>NewTokenBucket</span>(<span>&#34;key123&#34;</span>, <span>redisStore</span>, <span>10</span>, <span>5</span>)

	<span>// create HTTP server and setup a goralim middleware to put a rate limiter</span>
	<span>handler</span> <span>:=</span> <span>http</span>.<span>HandlerFunc</span>(<span>func</span>(<span>w</span> http.<span>ResponseWriter</span>, <span>r</span> <span>*</span>http.<span>Request</span>) {
		<span>fmt</span>.<span>Fprintln</span>(<span>w</span>, <span>&#34;Hey There this is a Request&#34;</span>)
	})

	<span>rateLimitedHandler</span> <span>:=</span> <span>goralim</span>.<span>RateLimiter</span>(<span>tb</span>, <span>handler</span>)
	<span>http</span>.<span>ListenAndServe</span>(<span>&#34;:8080&#34;</span>, <span>rateLimitedHandler</span>)</pre></div>

<p dir="auto">Under <a href="https://github.com/0verread/goralim/blob/main/LICENSE">MIT</a> license</p>
</article></div></div>
  </body>
</html>
