<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/olvvier/apple-silicon-accelerometer">Original</a>
    <h1>Reading the undocumented MEMS accelerometer on Apple Silicon MacBooks via iokit</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">More information: <a href="https://medium.com/@oli.bourbonnais/your-macbook-has-an-accelerometer-and-you-can-read-it-in-real-time-in-python-28d9395fb180" rel="nofollow">read the article on Medium</a></p>
<p dir="auto">reading the undocumented mems accelerometer on apple silicon macbooks via iokit hid</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://writing.natwelch.com/olvvier/apple-silicon-accelerometer/blob/main/assets/demo.gif"><img src="https://writing.natwelch.com/olvvier/apple-silicon-accelerometer/raw/main/assets/demo.gif" alt="demo" data-animated-image=""/></a></p>

<p dir="auto">apple silicon chips (M1/M2/M3/M4) have a hard to find mems accelerometer managed by the sensor processing unit (SPU).
it&#39;s not exposed through any public api or framework.
this project reads raw 3-axis acceleration data at ~800hz via iokit hid callbacks.</p>
<p dir="auto">only tested on macbook pro m3 pro so far - might work on other apple silicon macs but no guarantees</p>

<p dir="auto">the sensor lives under AppleSPUHIDDevice in the iokit registry, on vendor usage page 0xFF00, usage 3.
the driver is AppleSPUHIDDriver which is part of the sensor processing unit.
we open it with IOHIDDeviceCreate and register an asynchronous callback via IOHIDDeviceRegisterInputReportCallback.
data comes as 22-byte hid reports with x/y/z as int32 little-endian at byte offsets 6, 10, 14.
divide by 65536 to get the value in g.
callback rate is ~100hz</p>
<p dir="auto">you can verify the device exists on your machine with:</p>
<div data-snippet-clipboard-copy-content="ioreg -l -w0 | grep -A5 AppleSPUHIDDevice"><pre><code>ioreg -l -w0 | grep -A5 AppleSPUHIDDevice
</code></pre></div>

<div data-snippet-clipboard-copy-content="git clone https://github.com/olvvier/apple-silicon-accelerometer
cd apple-silicon-accelerometer
pip install -r requirements.txt
sudo python3 motion_live.py"><pre><code>git clone https://github.com/olvvier/apple-silicon-accelerometer
cd apple-silicon-accelerometer
pip install -r requirements.txt
sudo python3 motion_live.py
</code></pre></div>
<p dir="auto">requires root because iokit hid device access on apple silicon needs elevated privileges</p>

<ul dir="auto">
<li>spu_sensor.py - the core: iokit bindings, device discovery, hid callback, shared memory ring buffer</li>
<li>motion_live.py - vibration detection pipeline, heartbeat bcg, terminal ui, main loop</li>
</ul>
<p dir="auto">the sensor reading logic is isolated in spu_sensor.py so you can reuse it independently</p>

<p dir="auto">place your wrists on the laptop near the trackpad and wait 10-20 seconds for the signal to stabilize.
this uses ballistocardiography - the mechanical vibrations from your heartbeat transmitted through your arms into the chassis.
experimental, not reliable, just a fun use-case to show what the sensor can pick up.
the bcg bandpass is 0.8-3hz and bpm is estimated via autocorrelation on the filtered signal</p>

<ul dir="auto">
<li>experimental / undocumented AppleSPU hid path</li>
<li>requires sudo</li>
<li>may break on future macos updates</li>
<li>use at your own risk</li>
<li>not for medical use</li>
</ul>

<ul dir="auto">
<li>macbook pro m3 pro, macos 15.6.1</li>
<li>python 3.14</li>
</ul>

<p dir="auto">MIT</p>
<hr/>
<p dir="auto">not affiliated with Apple or any employer</p>
</article></div></div>
  </body>
</html>
