<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://trigger.dev/blog/shai-hulud-postmortem">Original</a>
    <h1>Shai-Hulud compromised a dev machine and raided GitHub org access: a post-mortem</h1>
    
    <div id="readability-page-1" class="page"><div><!--$--><div><div><main><p>On November 25th, 2025, we were on a routine Slack huddle debugging a production issue when we noticed something strange: a PR in one of our internal repos was suddenly closed, showed zero changes, and had a single commit from... Linus Torvalds?</p>
<p>The commit message was just &#34;init.&#34;</p>
<p>Within seconds, our #git Slack channel exploded with notifications. Dozens of force-pushes. PRs closing across multiple repositories. All attributed to one of our engineers.</p>
<img src="https://vrklovespaper.substack.com/blog/shai-hulud-postmortem/screenshots/nicks-alert.png" alt="Nick&#39;s initial alert"/>
<p>We had been compromised by <a href="https://socket.dev/blog/shai-hulud-strikes-again-v2">Shai-Hulud 2.0</a>, a sophisticated npm supply chain worm that compromised over 500 packages, affected 25,000+ repositories, and spread across the JavaScript ecosystem. We weren&#39;t alone: <a href="https://posthog.com/blog/nov-24-shai-hulud-attack-post-mortem">PostHog</a>, Zapier, AsyncAPI, Postman, and ENS were among those hit.</p>
<p>This is the complete story of what happened, how we responded, and what we&#39;ve changed to prevent this from happening again.</p>
<blockquote>
<p>No Trigger.dev packages were ever compromised. The <code>@trigger.dev/*</code> packages and <code>trigger.dev</code> CLI were never infected with Shai-Hulud malware. This incident involved one of our engineers installing a compromised package on their development machine, which led to credential theft and unauthorized access to our GitHub organization. Our published packages remained safe throughout.</p>
</blockquote>
<hr/>
<h2 id="the-attack-timeline">The Attack Timeline</h2>
<div><table><thead><tr><th>Time (UTC)</th><th>Event</th></tr></thead><tbody><tr><td>Nov 24, 04:11</td><td>Malicious packages go live</td></tr><tr><td>Nov 24, ~20:27</td><td>Engineer compromised</td></tr><tr><td>Nov 24, 22:36</td><td>First attacker activity</td></tr><tr><td>Nov 25, 02:56-05:32</td><td>Overnight reconnaissance</td></tr><tr><td>Nov 25, 09:08-15:08</td><td>Legitimate engineer work (from Germany)</td></tr><tr><td>Nov 25, 09:10-09:17</td><td>Attacker monitors engineer activity</td></tr><tr><td>Nov 25, 15:17-15:27</td><td>Final recon</td></tr><tr><td>Nov 25, 15:27-15:37</td><td>Destructive attack</td></tr><tr><td>Nov 25, ~15:32</td><td>Detection</td></tr><tr><td>Nov 25, ~15:36</td><td>Access revoked</td></tr><tr><td>Nov 25, 16:35</td><td>AWS session blocked</td></tr><tr><td>Nov 25, 22:35</td><td>All branches restored</td></tr><tr><td>Nov 26, 20:16</td><td>GitHub App key rotated</td></tr></tbody></table></div>
<hr/>
<h2 id="the-compromise">The compromise</h2>
<p>On the evening of November 24th, around 20:27 UTC (9:27 PM local time in Germany), one of our engineers was experimenting with a new project. They ran a command that triggered <code>pnpm install</code>. At that moment, somewhere in the dependency tree, a malicious package executed.</p>
<p>We don&#39;t know exactly which package delivered the payload. The engineer was experimenting at the time and may have deleted the project directory as part of cleanup. By the time we investigated, we couldn&#39;t trace back to the specific package. The engineer checked their shell history and they&#39;d only run install commands in our main trigger repo, cloud repo, and one experimental project.</p>
<p>This is one of the frustrating realities of these attacks: once the malware runs, identifying the source becomes extremely difficult. The package doesn&#39;t announce itself. The <code>pnpm install</code> completes successfully. Everything looks normal.</p>
<p>What we do know is that the Shai-Hulud malware ran a <code>preinstall</code> script that:</p>
<ol>
<li>Downloaded and executed <a href="https://github.com/trufflesecurity/trufflehog">TruffleHog</a>, a legitimate security tool repurposed for credential theft</li>
<li>Scanned the engineer&#39;s machine for secrets: GitHub tokens, AWS credentials, npm tokens, environment variables</li>
<li>Exfiltrated everything it found</li>
</ol>
<p>When the engineer later recovered files from their compromised laptop (booted in recovery mode), they found the telltale signs:</p>
<img src="https://vrklovespaper.substack.com/blog/shai-hulud-postmortem/screenshots/trufflehog.jpg" alt="TruffleHog artifacts found on compromised machine"/>
<p>The <code>.trufflehog-cache</code> directory and <code>trufflehog_3.91.1_darwin_amd64.tar.gz</code> file found on the compromised machine. The <code>extract</code> directory was empty, likely cleaned up by the malware to cover its tracks.</p>
<hr/>
<h2 id="17-hours-of-reconnaissance">17 hours of reconnaissance</h2>
<p>The attacker had access to our engineer&#39;s GitHub account for 17 hours before doing anything visible. According to our GitHub audit logs, they operated methodically.</p>
<p>Just over two hours after the initial compromise, the attacker validated their stolen credentials and began mass cloning:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Location</th><th>Activity</th></tr></thead><tbody><tr><td>22:36:50</td><td>US</td><td>First attacker access, mass cloning begins</td></tr><tr><td>22:36-22:39</td><td>US</td><td>73 repositories cloned</td></tr><tr><td>22:48-22:50</td><td>US</td><td>~70 more repositories cloned (second wave)</td></tr><tr><td>22:55-22:56</td><td>US</td><td>~90 repositories cloned (third wave)</td></tr><tr><td>22:59-23:04</td><td>US</td><td>~70 repositories cloned (fourth wave)</td></tr><tr><td>23:32:59</td><td>India</td><td>Attacker switches to India-based infrastructure</td></tr><tr><td>23:32-23:37</td><td>India</td><td>73 repositories cloned</td></tr><tr><td>23:34-23:35</td><td>US + India</td><td>Simultaneous cloning from both locations</td></tr></tbody></table></div>
<p>The simultaneous activity from US and India confirmed we were dealing with a single attacker using multiple VPNs or servers, not separate actors.</p>
<p>While our engineer slept in Germany, the attacker continued their reconnaissance. More cloning at 02:56-02:59 UTC (middle of the night in Germany), sporadic activity until 05:32 UTC. Total repos cloned: 669 (527 from US infrastructure, 142 from India).</p>
<p>Here&#39;s where it gets unsettling. Our engineer woke up and started their normal workday:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Actor</th><th>Activity</th></tr></thead><tbody><tr><td>09:08:27</td><td>Engineer</td><td>Triggers workflow on cloud repo (from Germany)</td></tr><tr><td>09:10-09:17</td><td>Attacker</td><td>Git fetches from US, watching the engineer</td></tr><tr><td>09:08-15:08</td><td>Engineer</td><td>Normal PR reviews, CI workflows (from Germany)</td></tr></tbody></table></div>
<p>The attacker was monitoring our engineer&#39;s activity while they worked, unaware they were compromised.</p>
<p>During this period, the attacker created repositories with random string names to store stolen credentials, a known Shai-Hulud pattern:</p>
<ul>
<li><code>github.com/[username]/xfjqb74uysxcni5ztn</code></li>
<li><code>github.com/[username]/ls4uzkvwnt0qckjq27</code></li>
<li><code>github.com/[username]/uxa7vo9og0rzts362c</code></li>
</ul>
<p>They also created three repos marked with &#34;Sha1-Hulud: The Second Coming&#34; as a calling card. These repositories were empty by the time we examined them, but based on the documented Shai-Hulud behavior, they likely contained triple base64-encoded credentials.</p>
<hr/>
<h2 id="10-minutes-of-destruction">10 minutes of destruction</h2>
<p>At 15:27 UTC on November 25th, the attacker switched from reconnaissance to destruction.</p>
<p>The attack began on our <code>cloud</code> repo from India-based infrastructure:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Event</th><th>Repo</th><th>Details</th></tr></thead><tbody><tr><td>15:27:35</td><td>First force-push</td><td>triggerdotdev/cloud</td><td>Attack begins</td></tr><tr><td>15:27:37</td><td>PR closed</td><td>triggerdotdev/cloud</td><td>PR #300 closed</td></tr><tr><td>15:27:44</td><td>BLOCKED</td><td>triggerdotdev/cloud</td><td>Branch protection rejected force-push</td></tr><tr><td>15:27:50</td><td>PR closed</td><td>triggerdotdev/trigger.dev</td><td>PR #2707 closed</td></tr></tbody></table></div>
<p>The attack continued on our main repository:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Event</th><th>Details</th></tr></thead><tbody><tr><td>15:28:13</td><td>PR closed</td><td>triggerdotdev/trigger.dev PR #2706 (release PR)</td></tr><tr><td>15:30:51</td><td>PR closed</td><td>triggerdotdev/trigger.dev PR #2451</td></tr><tr><td>15:31:10</td><td>PR closed</td><td>triggerdotdev/trigger.dev PR #2382</td></tr><tr><td>15:31:16</td><td>BLOCKED</td><td>Branch protection rejected force-push to trigger.dev</td></tr><tr><td>15:31:31</td><td>PR closed</td><td>triggerdotdev/trigger.dev PR #2482</td></tr></tbody></table></div>
<p>At 15:32:43-46 UTC, 12 PRs on jsonhero-web were closed in 3 seconds. Clearly automated. PRs #47, #169, #176, #181, #189, #190, #194, #197, #204, #206, #208 all closed within a 3-second window.</p>
<p>Our critical infrastructure repository was targeted next:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Event</th><th>Details</th></tr></thead><tbody><tr><td>15:35:41</td><td>PR closed</td><td>triggerdotdev/infra PR #233</td></tr><tr><td>15:35:45</td><td>BLOCKED</td><td>Branch protection rejected force-push (India)</td></tr><tr><td>15:35:48</td><td>PR closed</td><td>triggerdotdev/infra PR #309</td></tr><tr><td>15:35:49</td><td>BLOCKED</td><td>Branch protection rejected force-push (India)</td></tr></tbody></table></div>
<p>The final PR was closed on json-infer-types at 15:37:13 UTC.</p>
<hr/>
<h2 id="detection-and-response">Detection and response</h2>
<p>We got a lucky break. One of our team members was monitoring Slack when the flood of notifications started:</p>
<img src="https://vrklovespaper.substack.com/blog/shai-hulud-postmortem/screenshots/slack-notifications.png" alt="Slack notifications showing the attack"/>
<p>Our #git Slack channel during the attack. A wall of force-pushes, all with commit message &#34;init.&#34;</p>
<p>Every malicious commit was authored as:</p>
<div></div>
<img src="https://vrklovespaper.substack.com/blog/shai-hulud-postmortem/screenshots/attacked-branch.png" alt="What an attacked branch looked like"/>
<p>An attacked branch: a single &#34;init&#34; commit attributed to Linus Torvalds, thousands of commits behind main.</p>
<p>We haven&#39;t found reports of other Shai-Hulud victims seeing this same &#34;Linus Torvalds&#34; vandalism pattern. The worm&#39;s documented behavior focuses on credential exfiltration and npm package propagation, not repository destruction. This destructive phase may have been unique to our attacker, or perhaps a manual follow-up action after the automated worm had done its credential harvesting.</p>
<p>Within 4 minutes of detection we identified the compromised account, removed them from the GitHub organization, and the attack stopped immediately.</p>
<p>Our internal Slack during those first minutes:</p>
<blockquote>
<p>&#34;Urmmm guys? what&#39;s going on?&#34;</p>
<p>&#34;add me to the call @here&#34;</p>
<p>&#34;Nick could you double check Infisical for any machine identities&#34;</p>
<p>&#34;can someone also check whether there are any reports of compromised packages in our CLI deps?&#34;</p>
</blockquote>
<p>Within the hour:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Action</th></tr></thead><tbody><tr><td>~15:36</td><td>Removed from GitHub organization</td></tr><tr><td>~15:40</td><td>Removed from Infisical (secrets manager)</td></tr><tr><td>~15:45</td><td>Removed from AWS IAM Identity Center</td></tr><tr><td>~16:00</td><td>Removed from Vercel and Cloudflare</td></tr><tr><td>16:35</td><td>AWS SSO sessions blocked via deny policy (sessions can&#39;t be revoked)</td></tr><tr><td>16:45</td><td>IAM user console login deleted</td></tr></tbody></table></div>
<hr/>
<h2 id="the-damage">The damage</h2>
<p>Repository clone actions: 669 (public and private), including infrastructure code, internal documentation, and engineering plans.</p>
<p>Branches force-pushed: 199 across 16 repositories</p>
<p>Pull requests closed: 42</p>
<p>Protected branch rejections: 4. Some of our repositories have main branch protection enabled, but we had not enabled it for all repositories at the time of the incident.</p>
<p>npm packages were <strong>not</strong> compromised. This is the difference between &#34;our repos got vandalized&#34; and &#34;our packages got compromised.&#34;</p>
<p>Our engineer didn&#39;t have an npm publishing token on their machine, and even if they did we had already required 2FA for publishing to npm. Without that, Shai-Hulud would have published malicious versions of <code>@trigger.dev/sdk</code>, <code>@trigger.dev/core</code>, and others, potentially affecting thousands of downstream users.</p>
<p>Production databases or any AWS resources were <strong>not</strong> accessed. Our AWS CloudTrail audit showed only read operations from the compromised account:</p>
<div><table><thead><tr><th>Event Type</th><th>Count</th><th>Service</th></tr></thead><tbody><tr><td>ListManagedNotificationEvents</td><td>~40</td><td>notifications</td></tr><tr><td>DescribeClusters</td><td>8</td><td>ECS</td></tr><tr><td>DescribeTasks</td><td>4</td><td>ECS</td></tr><tr><td>DescribeMetricFilters</td><td>6</td><td>CloudWatch</td></tr></tbody></table></div>
<p>These were confirmed to be legitimate operations by our engineer.</p>
<p>One nice surprise: AWS actually sent us a proactive alert about Shai-Hulud. They detected the malware&#39;s characteristic behavior (ListSecrets, GetSecretValue, BatchGetSecretValue API calls) on an old test account that hadn&#39;t been used in months, so we just deleted it. But kudos to AWS for the proactive detection and notification.</p>
<hr/>
<h2 id="the-recovery">The recovery</h2>
<p>GitHub doesn&#39;t have server-side reflog. When someone force-pushes, that history is gone from GitHub&#39;s servers.</p>
<p>But we found ways to recover.</p>
<p>Push events are retained for 90 days via the GitHub Events API. We wrote a script that fetched pre-attack commit SHAs:</p>
<div></div>
<p>Public repository forks still contained original commits. We used these to verify and restore branches.</p>
<p>Developers who hadn&#39;t run <code>git fetch --prune</code> (all of us?) still had old SHAs in their local reflog.</p>
<p>Within 7 hours, all 199 branches were restored.</p>
<hr/>
<h2 id="github-app-private-key-exposure">GitHub app private key exposure</h2>
<p>During the investigation, our engineer was going through files recovered from the compromised laptop and discovered something concerning: the private key for our GitHub App was in the trash folder.</p>
<p>When you create a private key in the GitHub App settings, GitHub automatically downloads it. The engineer had created a key at some point, and while the active file had been deleted, it was still in the trash, potentially accessible to TruffleHog.</p>
<p>Our GitHub App has the following permissions on customer repositories:</p>
<div><table><thead><tr><th>Permission</th><th>Access Level</th><th>Risk</th></tr></thead><tbody><tr><td>contents</td><td>read/write</td><td>Could read/write repository contents</td></tr><tr><td>pull_requests</td><td>read/write</td><td>Could read/create/modify PRs</td></tr><tr><td>deployments</td><td>read/write</td><td>Could create/trigger deployments</td></tr><tr><td>checks</td><td>read/write</td><td>Could create/modify check runs</td></tr><tr><td>commit_statuses</td><td>read/write</td><td>Could mark commits as passing/failing</td></tr><tr><td>metadata</td><td>read</td><td>Could read repository metadata</td></tr></tbody></table></div>
<p>To generate valid access tokens, an attacker would need both the private key (potentially compromised) and the installation ID for a specific customer (stored in our database which was not compromised, not on the compromised machine).</p>
<p>We immediately rotated the key:</p>
<div><table><thead><tr><th>Time (UTC)</th><th>Action</th></tr></thead><tbody><tr><td>Nov 26, 18:51</td><td>Private key discovered in trash folder</td></tr><tr><td>Nov 26, 19:54</td><td>New key deployed to test environment</td></tr><tr><td>Nov 26, 20:16</td><td>New key deployed to production</td></tr></tbody></table></div>
<p>We found no evidence of unauthorized access to any customer repositories. The attacker would have needed installation IDs from our database to generate tokens, and our database was not compromised as previously mentioned.</p>
<p>However, we cannot completely rule out the possibility. An attacker with the private key could theoretically have called the GitHub API to enumerate all installations. We&#39;ve contacted GitHub Support to request additional access logs. We&#39;ve also analyzed the webhook payloads to our GitHub app, looking for suspicious push or PR activity from connected installations &amp; repositories. We haven&#39;t found any evidence of unauthorized activity in these webhook payloads.</p>
<p>We&#39;ve sent out an email to potentially effected customers to notify them of the incident with detailed instructions on how to check if they were affected. Please check your email for more details if you&#39;ve used our GitHub app.</p>
<hr/>
<h2 id="technical-deep-dive-how-shai-hulud-works">Technical deep-dive: how Shai-Hulud works</h2>
<p>For those interested in the technical details, here&#39;s what we learned about the malware from <a href="https://socket.dev/blog/shai-hulud-strikes-again-v2">Socket&#39;s analysis</a> and our own investigation.</p>
<p>When npm runs the <code>preinstall</code> script, it executes <code>setup_bun.js</code>:</p>
<ol>
<li>Detects OS/architecture</li>
<li>Downloads or locates the <a href="https://bun.sh">Bun</a> runtime</li>
<li>Caches Bun in <code>~/.cache</code></li>
<li>Spawns a detached Bun process running <code>bun_environment.js</code> with output suppressed</li>
<li>Returns immediately so <code>npm install</code> completes successfully with no warnings</li>
</ol>
<p>The malware runs in the background while you think everything is fine.</p>
<p>The payload uses TruffleHog to scan <code>$HOME</code> for GitHub tokens (from env vars, gh CLI config, git credential helpers), AWS/GCP/Azure credentials, npm tokens from <code>.npmrc</code>, environment variables containing anything that looks like a secret, and GitHub Actions secrets (if running in CI).</p>
<p>Stolen credentials are uploaded to a newly-created GitHub repo with a random name. The data is triple base64-encoded to evade GitHub&#39;s secret scanning.</p>
<p>Files created:</p>
<ul>
<li><code>contents.json</code> (system info and GitHub credentials)</li>
<li><code>environment.json</code> (all environment variables)</li>
<li><code>cloud.json</code> (cloud provider credentials)</li>
<li><code>truffleSecrets.json</code> (filesystem secrets from TruffleHog)</li>
<li><code>actionsSecrets.json</code> (GitHub Actions secrets if any)</li>
</ul>
<p>If an npm publishing token is found, the malware validates the token against the npm registry, fetches packages maintained by that account, downloads each package, patches it with the malware, bumps the version, and re-publishes, infecting more packages.</p>
<p>This is how the worm spread through the npm ecosystem, starting from <a href="https://posthog.com/blog/nov-24-shai-hulud-attack-post-mortem">PostHog&#39;s compromised CI</a> on November 24th at 4:11 AM UTC. Our engineer was infected roughly 16 hours after the malicious packages went live.</p>
<p>If no credentials are found to exfiltrate or propagate, the malware attempts to delete the victim&#39;s entire home directory. Scorched earth.</p>
<p>File artifacts to look for: <code>setup_bun.js</code>, <code>bun_environment.js</code>, <code>cloud.json</code>, <code>contents.json</code>, <code>environment.json</code>, <code>truffleSecrets.json</code>, <code>actionsSecrets.json</code>, <code>.trufflehog-cache/</code> directory.</p>
<p>Malware file hashes (SHA1):</p>
<ul>
<li><code>bun_environment.js</code>: <code>d60ec97eea19fffb4809bc35b91033b52490ca11</code></li>
<li><code>bun_environment.js</code>: <code>3d7570d14d34b0ba137d502f042b27b0f37a59fa</code></li>
<li><code>setup_bun.js</code>: <code>d1829b4708126dcc7bea7437c04d1f10eacd4a16</code></li>
</ul>
<p>We&#39;ve published a <a href="https://gist.github.com/ericallam/e2ae497d99a21d500fd9fbb01e1bfa02">detection script</a> that checks for Shai-Hulud indicators.</p>
<hr/>
<h2 id="what-weve-changed">What we&#39;ve changed</h2>
<p>We disabled npm scripts globally:</p>
<div></div>
<p>This prevents <code>preinstall</code>, <code>postinstall</code>, and other lifecycle scripts from running. It&#39;s aggressive and some packages will break, but it&#39;s the only reliable protection against this class of attack.</p>
<p>We upgraded to pnpm 10. This was significant effort (had to migrate through pnpm 9 first), but pnpm 10 brings critical security improvements. Scripts are ignored by default. You can explicitly whitelist packages that need to run scripts via <code>pnpm.onlyBuiltDependencies</code>. And the <code>minimumReleaseAge</code> setting prevents installing packages published recently.</p>
<div></div>
<p>To whitelist packages that legitimately need build scripts:</p>
<div></div>
<p>This prompts you to select which packages to allow (like <code>esbuild</code>, <code>prisma</code>, <code>sharp</code>).</p>
<p>For your global pnpm config:</p>
<div></div>
<p>We switched npm publishing to OIDC. No more long-lived npm tokens anywhere. Publishing now uses <a href="https://docs.npmjs.com/trusted-publishers">npm&#39;s trusted publishers</a> with GitHub Actions OIDC. Even if an attacker compromises a developer machine, they can&#39;t publish packages because there are no credentials to steal. Publishing only happens through CI with short-lived, scoped tokens.</p>
<p>We enabled branch protection on all repositories. Not just critical repos or just OSS repos. Every repository with meaningful code now has branch protection enabled.</p>
<p>We&#39;ve adopted <a href="https://docs.commonfate.io/granted/introduction">Granted</a> for AWS SSO. Granted encrypts SSO session tokens on the client side, unlike the AWS CLI which stores them in plaintext.</p>
<p>Based on <a href="https://posthog.com/blog/nov-24-shai-hulud-attack-post-mortem">PostHog&#39;s analysis</a> of how they were initially compromised (via <code>pull_request_target</code>), we&#39;ve reviewed our GitHub Actions workflows. We now require approval for external contributor workflow runs on all our repositories (previous policy was only for public repositories).</p>
<hr/>
<h2 id="lessons-for-other-teams">Lessons for other teams</h2>
<p>The ability for packages to run arbitrary code during installation is the attack surface. Until npm fundamentally changes, add this to your <code>~/.npmrc</code>:</p>
<div></div>
<p>Yes, some things will break. Whitelist them explicitly. The inconvenience is worth it.</p>
<p>pnpm 10 ignores scripts by default and lets you set a minimum age for packages:</p>
<div></div>
<p>Newly published packages can&#39;t be installed for 3 days, giving time for malicious packages to be detected.</p>
<p>Branch protection takes 30 seconds to enable. It prevents attackers from pushing to a main branch, potentially executing malicious GitHub action workflows.</p>
<p>Long-lived npm tokens on developer machines are a liability. Use <a href="https://docs.npmjs.com/trusted-publishers">trusted publishers</a> with OIDC instead.</p>
<p>If you don&#39;t need a credential on your local machine, don&#39;t have it there. Publishing should happen through CI only.</p>
<p>Our #git Slack channel is noisy. That noise saved us.</p>
<hr/>
<h2 id="a-note-on-the-human-side">A note on the human side</h2>
<p>One of the hardest parts of this incident was that it happened to a person.</p>
<blockquote>
<p>&#34;Sorry for all the trouble guys, terrible experience&#34;</p>
</blockquote>
<p>Our compromised engineer felt terrible, even though they did absolutely nothing wrong. It could have happened to any team member.</p>
<p>Running <code>npm install</code> is not negligence. Installing dependencies is not a security failure. The security failure is in an ecosystem that allows packages to run arbitrary code silently.</p>
<p>They also discovered that the attacker had made their GitHub account star hundreds of random repositories during the compromise. Someone even emailed us: &#34;hey you starred my repo but I think it was because you were hacked, maybe remove the star?&#34;</p>
<hr/>
<h2 id="summary">Summary</h2>
<div><table><thead><tr><th>Metric</th><th>Value</th></tr></thead><tbody><tr><td>Time from compromise to first attacker activity</td><td>~2 hours</td></tr><tr><td>Time attacker had access before destructive action</td><td>~17 hours</td></tr><tr><td>Duration of destructive attack</td><td>~10 minutes (15:27-15:37 UTC)</td></tr><tr><td>Time from first malicious push to detection</td><td>~5 minutes</td></tr><tr><td>Time from detection to access revocation</td><td>~4 minutes</td></tr><tr><td>Time to full branch recovery</td><td>~7 hours</td></tr><tr><td>Repository clone actions by attacker</td><td>669</td></tr><tr><td>Repositories force-pushed</td><td>16</td></tr><tr><td>Branches affected</td><td>199</td></tr><tr><td>Pull requests closed</td><td>42</td></tr><tr><td>Protected branch rejections</td><td>4</td></tr></tbody></table></div>
<hr/>
<h2 id="resources">Resources</h2>
<p>About the Attack:</p>
<ul>
<li><a href="https://socket.dev/blog/shai-hulud-strikes-again-v2">Socket.dev: Shai-Hulud Strikes Again V2</a> - Technical deep-dive into the malware</li>
<li><a href="https://posthog.com/blog/nov-24-shai-hulud-attack-post-mortem">PostHog Post-Mortem</a> - Another company&#39;s experience with Shai-Hulud</li>
<li><a href="https://www.wiz.io/blog/shai-hulud-2-0-ongoing-supply-chain-attack">Wiz Blog: Shai-Hulud 2.0 Supply Chain Attack</a></li>
<li><a href="https://thehackernews.com/2025/11/second-sha1-hulud-wave-affects-25000.html">The Hacker News Coverage</a></li>
<li><a href="https://www.endorlabs.com/learn/shai-hulud-2-malware-campaign-targets-github-and-cloud-credentials-using-bun-runtime">Endor Labs Analysis</a></li>
<li><a href="https://helixguard.ai/blog/malicious-sha1hulud-2025-11-24">HelixGuard Advisory</a> (referenced in AWS alert)</li>
</ul>
<p>Mitigation Resources:</p>
<ul>
<li><a href="https://docs.npmjs.com/trusted-publishers">npm Trusted Publishers</a> - OIDC-based publishing</li>
<li><a href="https://pnpm.io/package_json#pnpmonlybuiltdependencies">pnpm onlyBuiltDependencies</a> - Whitelist packages allowed to run scripts</li>
<li><a href="https://pnpm.io/settings#minimumreleaseage">pnpm minimumReleaseAge</a> - Delay installation of new packages</li>
<li><a href="https://docs.commonfate.io/granted/introduction">Granted</a> - AWS SSO credential management</li>
</ul>
<hr/>
<p>Have questions about this incident? Reach out on <a href="https://twitter.com/triggerdotdev">Twitter/X</a> or <a href="https://trigger.dev/discord">Discord</a>.</p></main></div></div><!--/$--></div></div>
  </body>
</html>
