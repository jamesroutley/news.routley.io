<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Vexu/bog">Original</a>
    <h1>Bog – small, strongly typed, embeddable language</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto">Small, strongly typed, embeddable language.</p>
<h2 dir="auto"><a id="user-content-examples" aria-hidden="true" href="#examples"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a><a href="https://github.com/Vexu/bog/blob/master/examples">Examples</a></h2>
<h3 dir="auto"><a id="user-content-hello-world" aria-hidden="true" href="#hello-world"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Hello world</h3>
<div dir="auto" data-snippet-clipboard-copy-content="let {print} = import &#34;std.io&#34;
let world = &#34;world&#34;
print(f&#34;hello {world}!&#34;)"><pre><span>let</span> {print} <span>=</span> <span>import</span> <span><span>&#34;</span>std.io<span>&#34;</span></span>
<span>let</span> world <span>=</span> <span><span>&#34;</span>world<span>&#34;</span></span>
<span>print</span>(<span><span><span>f</span>&#34;</span>hello {world}!<span>&#34;</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-asyncawait" aria-hidden="true" href="#asyncawait"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Async/await</h3>
<div dir="auto" data-snippet-clipboard-copy-content="let {print} = import &#34;std.io&#34;

let foo = fn()
    print(&#34;foo started&#34;)
    let bar_frame = async bar()
    print(&#34;in foo&#34;)
    let bar_res = await bar_frame
    print(&#34;foo finished&#34;)
    return bar_res

let bar = fn()
    print(&#34;bar started&#34;)
    suspend
    print(&#34;bar resumed&#34;)
    suspend
    print(&#34;bar finished&#34;)
    return 1


print(&#34;main started&#34;)
let foo_frame = async foo()
print(&#34;in main&#34;)
let res = await foo_frame
print(&#34;main finished:&#34;, res)"><pre><span>let</span> {print} <span>=</span> <span>import</span> <span><span>&#34;</span>std.io<span>&#34;</span></span>

<span>let</span> foo <span>=</span> <span>fn</span>()
    <span>print</span>(<span><span>&#34;</span>foo started<span>&#34;</span></span>)
    <span>let</span> bar_frame <span>=</span> async <span>bar</span>()
    <span>print</span>(<span><span>&#34;</span>in foo<span>&#34;</span></span>)
    <span>let</span> bar_res <span>=</span> await bar_frame
    <span>print</span>(<span><span>&#34;</span>foo finished<span>&#34;</span></span>)
    <span>return</span> bar_res

<span>let</span> bar <span>=</span> <span>fn</span>()
    <span>print</span>(<span><span>&#34;</span>bar started<span>&#34;</span></span>)
    suspend
    <span>print</span>(<span><span>&#34;</span>bar resumed<span>&#34;</span></span>)
    suspend
    <span>print</span>(<span><span>&#34;</span>bar finished<span>&#34;</span></span>)
    <span>return</span> <span>1</span>


<span>print</span>(<span><span>&#34;</span>main started<span>&#34;</span></span>)
<span>let</span> foo_frame <span>=</span> async <span>foo</span>()
<span>print</span>(<span><span>&#34;</span>in main<span>&#34;</span></span>)
<span>let</span> res <span>=</span> await foo_frame
<span>print</span>(<span><span>&#34;</span>main finished:<span>&#34;</span></span>, res)</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="$ bog async.bog
main started
foo started
bar started
in foo
bar resumed
in main
bar finished
foo finished
main finished: 1"><pre>$ <span>bog async.bog</span>
<span>main started</span>
<span>foo started</span>
<span>bar started</span>
<span>in foo</span>
<span>bar resumed</span>
<span>in main</span>
<span>bar finished</span>
<span>foo finished</span>
<span>main finished: 1</span></pre></div>
<h3 dir="auto"><a id="user-content-calculator" aria-hidden="true" href="#calculator"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Calculator</h3>
<div dir="auto" data-snippet-clipboard-copy-content="let {input, print} = import &#34;std.io&#34;

try
    let val1 = input(&#34;first argument: &#34;) as num
    let op = input(&#34;operation: &#34;)
    let val2 = input(&#34;second argument: &#34;) as num

    match op
        &#34;*&#34; =&gt; print(val1 * val2)
        &#34;+&#34; =&gt; print(val1 + val2)
        &#34;-&#34; =&gt; print(val1 - val2)
        &#34;/&#34; =&gt; print(val1 / val2)
        &#34;**&#34; =&gt; print(val1 ** val2)
        _ =&gt; print(f&#34;unknown op: {op}&#34;)
catch
    print(&#34;that&#39;s not a number&#34;)"><pre><span>let</span> {input, print} <span>=</span> <span>import</span> <span><span>&#34;</span>std.io<span>&#34;</span></span>

<span>try</span>
    <span>let</span> val1 <span>=</span> <span>input</span>(<span><span>&#34;</span>first argument: <span>&#34;</span></span>) as num
    <span>let</span> op <span>=</span> <span>input</span>(<span><span>&#34;</span>operation: <span>&#34;</span></span>)
    <span>let</span> val2 <span>=</span> <span>input</span>(<span><span>&#34;</span>second argument: <span>&#34;</span></span>) as num

    match op
        <span><span>&#34;</span>*<span>&#34;</span></span> <span>=&gt;</span> <span>print</span>(val1 <span>*</span> val2)
        <span><span>&#34;</span>+<span>&#34;</span></span> <span>=&gt;</span> <span>print</span>(val1 <span>+</span> val2)
        <span><span>&#34;</span>-<span>&#34;</span></span> <span>=&gt;</span> <span>print</span>(val1 <span>-</span> val2)
        <span><span>&#34;</span>/<span>&#34;</span></span> <span>=&gt;</span> <span>print</span>(val1 <span>/</span> val2)
        <span><span>&#34;</span>**<span>&#34;</span></span> <span>=&gt;</span> <span>print</span>(val1 <span>**</span> val2)
        _ <span>=&gt;</span> <span>print</span>(<span><span><span>f</span>&#34;</span>unknown op: {op}<span>&#34;</span></span>)
<span>catch</span>
    <span>print</span>(<span><span>&#34;</span>that&#39;s not a number<span>&#34;</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-use-command-line-arguments" aria-hidden="true" href="#use-command-line-arguments"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Use command line arguments</h3>
<div dir="auto" data-snippet-clipboard-copy-content="# run with `path/to/bog path/here.bog arg1 arg2 &#34;foo&#34;`
let {print} = import &#34;std.io&#34;
print(import &#34;args&#34;)"><pre><span><span>#</span> run with `path/to/bog path/here.bog arg1 arg2 &#34;foo&#34;`</span>
<span>let</span> {print} <span>=</span> <span>import</span> <span><span>&#34;</span>std.io<span>&#34;</span></span>
<span>print</span>(<span>import</span> <span><span>&#34;</span>args<span>&#34;</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-loops" aria-hidden="true" href="#loops"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Loops</h3>
<div dir="auto" data-snippet-clipboard-copy-content="let mut sum = 0
for let c in &#34;hellö wörld&#34;
    match c
        &#34;h&#34; =&gt; sum += 1
        &#34;e&#34; =&gt; sum += 2
        &#34;l&#34; =&gt; sum += 3
        &#34;ö&#34; =&gt; sum += 4
        &#34;w&#34; =&gt; sum += 5
        &#34;d&#34; =&gt; sum += 6

return sum # 31"><pre><span>let</span> mut sum <span>=</span> <span>0</span>
<span>for</span> <span>let</span> c <span>in</span> <span><span>&#34;</span>hellö wörld<span>&#34;</span></span>
    match c
        <span><span>&#34;</span>h<span>&#34;</span></span> <span>=&gt;</span> sum <span>+=</span> <span>1</span>
        <span><span>&#34;</span>e<span>&#34;</span></span> <span>=&gt;</span> sum <span>+=</span> <span>2</span>
        <span><span>&#34;</span>l<span>&#34;</span></span> <span>=&gt;</span> sum <span>+=</span> <span>3</span>
        <span><span>&#34;</span>ö<span>&#34;</span></span> <span>=&gt;</span> sum <span>+=</span> <span>4</span>
        <span><span>&#34;</span>w<span>&#34;</span></span> <span>=&gt;</span> sum <span>+=</span> <span>5</span>
        <span><span>&#34;</span>d<span>&#34;</span></span> <span>=&gt;</span> sum <span>+=</span> <span>6</span>

<span>return</span> sum <span><span>#</span> 31</span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="let getSome = fn(val) if (val != 0) val - 1

let mut val = 10
while let newVal = getSome(val)
    val = newVal
return val # 0"><pre><span>let</span> getSome <span>=</span> <span>fn</span>(val) <span>if</span> (val <span>!=</span> <span>0</span>) val <span>-</span> <span>1</span>

<span>let</span> mut val <span>=</span> <span>10</span>
<span>while</span> <span>let</span> newVal <span>=</span> <span>getSome</span>(val)
    val <span>=</span> newVal
<span>return</span> val <span><span>#</span> 0</span></pre></div>
<h3 dir="auto"><a id="user-content-error-handling" aria-hidden="true" href="#error-handling"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Error handling</h3>
<div dir="auto" data-snippet-clipboard-copy-content="let {input, print} = import &#34;std.io&#34;

let fails_on_1 = fn(arg) if arg == 1 error(69)
let fails_on_2 = fn(arg) if arg == 2 error(42)
let fails_on_3 = fn(arg) if arg == 3 error(17)

let foo = fn(arg)
    try
        fails_on_1(arg)
        fails_on_2(arg)
        fails_on_3(arg)
    catch let err
        return err

    return 99

print(for let i in 0:4 foo(i)) # [99, 69, 42, 17]
print(try fails_on_1(input(&#34;give number: &#34;) as int) catch &#34;gave 1&#34;)"><pre><span>let</span> {input, print} <span>=</span> <span>import</span> <span><span>&#34;</span>std.io<span>&#34;</span></span>

<span>let</span> fails_on_1 <span>=</span> <span>fn</span>(arg) <span>if</span> arg <span>==</span> <span>1</span> <span>error</span>(<span>69</span>)
<span>let</span> fails_on_2 <span>=</span> <span>fn</span>(arg) <span>if</span> arg <span>==</span> <span>2</span> <span>error</span>(<span>42</span>)
<span>let</span> fails_on_3 <span>=</span> <span>fn</span>(arg) <span>if</span> arg <span>==</span> <span>3</span> <span>error</span>(<span>17</span>)

<span>let</span> foo <span>=</span> <span>fn</span>(arg)
    <span>try</span>
        <span>fails_on_1</span>(arg)
        <span>fails_on_2</span>(arg)
        <span>fails_on_3</span>(arg)
    <span>catch</span> <span>let</span> err
        <span>return</span> err

    <span>return</span> <span>99</span>

<span>print</span>(<span>for</span> <span>let</span> i <span>in</span> <span>0</span><span>:</span><span>4</span> <span>foo</span>(i)) <span><span>#</span> [99, 69, 42, 17]</span>
<span>print</span>(<span>try</span> <span>fails_on_1</span>(<span>input</span>(<span><span>&#34;</span>give number: <span>&#34;</span></span>) as int) <span>catch</span> <span><span>&#34;</span>gave 1<span>&#34;</span></span>)</pre></div>
<h3 dir="auto"><a id="user-content-destructuring-assignment" aria-hidden="true" href="#destructuring-assignment"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Destructuring assignment</h3>
<div dir="auto" data-snippet-clipboard-copy-content="let add = fn ((a,b)) a + b
let tuplify = fn (a,b) (a,b)
return add(tuplify(1,2)) # 3"><pre><span>let</span> add <span>=</span> fn ((a,b)) a <span>+</span> b
<span>let</span> tuplify <span>=</span> fn (a,b) (a,b)
<span>return</span> <span>add</span>(<span>tuplify</span>(<span>1</span>,<span>2</span>)) <span><span>#</span> 3</span></pre></div>
<h2 dir="auto"><a id="user-content-embed" aria-hidden="true" href="#embed"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Embed</h2>
<div dir="auto" data-snippet-clipboard-copy-content="const bog = @import(&#34;bog&#34;);

var vm = bog.Vm.init(allocator, .{ .import_files = true });
defer vm.deinit();
try vm.addStd();

const res = vm.run(source) catch |e| switch (e) {
    else =&gt; |err| return err,
    error.TokenizeError, error.ParseError, error.CompileError, error.RuntimeError =&gt; {
        try vm.errors.render(source, out_stream);
        return error.RunningBogFailed;
    },
};

const bog_bool = try res.bogToZig(bool, &amp;vm);"><pre><span>const</span> <span>bog</span> <span>=</span> <span>@import</span>(<span>&#34;bog&#34;</span>);

<span>var</span> <span>vm</span> <span>=</span> <span>bog</span>.<span>Vm</span>.<span>init</span>(<span>allocator</span>, .{ .<span>import_files</span> <span>=</span> <span>true</span> });
<span>defer</span> <span>vm</span>.<span>deinit</span>();
<span>try</span> <span>vm</span>.<span>addStd</span>();

<span>const</span> <span>res</span> <span>=</span> <span>vm</span>.<span>run</span>(<span>source</span>) <span>catch</span> <span>|</span><span>e</span><span>|</span> <span>switch</span> (<span>e</span>) {
    <span>else</span> <span>=</span><span>&gt;</span> <span>|</span><span>err</span><span>|</span> <span>return</span> <span>err</span>,
    <span>error</span>.<span>TokenizeError</span>, <span>error</span>.<span>ParseError</span>, <span>error</span>.<span>CompileError</span>, <span>error</span>.<span>RuntimeError</span> <span>=</span><span>&gt;</span> {
        <span>try</span> <span>vm</span>.<span>errors</span>.<span>render</span>(<span>source</span>, <span>out_stream</span>);
        <span>return</span> <span>error</span>.<span>RunningBogFailed</span>;
    },
};

<span>const</span> <span>bog_bool</span> <span>=</span> <span>try</span> <span>res</span>.<span>bogToZig</span>(<span>bool</span>, <span>&amp;</span><span>vm</span>);</pre></div>
<h3 dir="auto"><a id="user-content-calling-bog-functions-from-zig" aria-hidden="true" href="#calling-bog-functions-from-zig"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Calling Bog functions from Zig</h3>
<div dir="auto" data-snippet-clipboard-copy-content="var vm = Vm.init(allocator, .{});
defer vm.deinit();

const res = vm.run(source) catch |e| switch (e) {
    else =&gt; |err| return err,
    error.TokenizeError, error.ParseError, error.CompileError, error.RuntimeError =&gt; {
        try vm.errors.render(source, out_stream);
        return error.RunningBogFailed;
    },
};

const call_res = vm.call(res, &#34;bogFunction&#34;, .{1, true}) catch |e| switch (e) {
    else =&gt; |err| return err,
    error.TokenizeError, error.ParseError, error.CompileError, error.RuntimeError =&gt; {
        try vm.errors.render(source, out_stream);
        return error.CallingBogFunctionFailed;
    },
};

const bog_integer = try call_res.bogToZig(i64, &amp;vm);"><pre><span>var</span> <span>vm</span> <span>=</span> <span>Vm</span>.<span>init</span>(<span>allocator</span>, .{});
<span>defer</span> <span>vm</span>.<span>deinit</span>();

<span>const</span> <span>res</span> <span>=</span> <span>vm</span>.<span>run</span>(<span>source</span>) <span>catch</span> <span>|</span><span>e</span><span>|</span> <span>switch</span> (<span>e</span>) {
    <span>else</span> <span>=</span><span>&gt;</span> <span>|</span><span>err</span><span>|</span> <span>return</span> <span>err</span>,
    <span>error</span>.<span>TokenizeError</span>, <span>error</span>.<span>ParseError</span>, <span>error</span>.<span>CompileError</span>, <span>error</span>.<span>RuntimeError</span> <span>=</span><span>&gt;</span> {
        <span>try</span> <span>vm</span>.<span>errors</span>.<span>render</span>(<span>source</span>, <span>out_stream</span>);
        <span>return</span> <span>error</span>.<span>RunningBogFailed</span>;
    },
};

<span>const</span> <span>call_res</span> <span>=</span> <span>vm</span>.<span>call</span>(<span>res</span>, <span>&#34;bogFunction&#34;</span>, .{<span>1</span>, <span>true</span>}) <span>catch</span> <span>|</span><span>e</span><span>|</span> <span>switch</span> (<span>e</span>) {
    <span>else</span> <span>=</span><span>&gt;</span> <span>|</span><span>err</span><span>|</span> <span>return</span> <span>err</span>,
    <span>error</span>.<span>TokenizeError</span>, <span>error</span>.<span>ParseError</span>, <span>error</span>.<span>CompileError</span>, <span>error</span>.<span>RuntimeError</span> <span>=</span><span>&gt;</span> {
        <span>try</span> <span>vm</span>.<span>errors</span>.<span>render</span>(<span>source</span>, <span>out_stream</span>);
        <span>return</span> <span>error</span>.<span>CallingBogFunctionFailed</span>;
    },
};

<span>const</span> <span>bog_integer</span> <span>=</span> <span>try</span> <span>call_res</span>.<span>bogToZig</span>(<span>i64</span>, <span>&amp;</span><span>vm</span>);</pre></div>
<h3 dir="auto"><a id="user-content-calling-zig-functions-from-bog" aria-hidden="true" href="#calling-zig-functions-from-bog"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Calling Zig functions from Bog</h3>
<div dir="auto" data-snippet-clipboard-copy-content="const my_lib = struct {
    pub fn pow(val: i64) i64 {
        return val * val;
    }
};

var vm = Vm.init(allocator, .{});
defer vm.deinit();
try vm.addPackage(&#34;my_lib&#34;, my_lib);

const res = vm.run(source) catch |e| switch (e) {
    else =&gt; |err| return err,
    error.TokenizeError, error.ParseError, error.CompileError, error.RuntimeError =&gt; {
        try vm.errors.render(source, out_stream);
        return error.RunningBogFailed;
    },
};

const bog_integer = try res.bogToZig(i64, &amp;vm);
std.debug.assert(bog_integer == 8);"><pre><span>const</span> <span>my_lib</span> <span>=</span> <span>struct</span> {
    <span>pub</span> <span>fn</span> <span>pow</span>(<span>val</span>: <span>i64</span>) <span>i64</span> {
        <span>return</span> <span>val</span> <span>*</span> <span>val</span>;
    }
};

<span>var</span> <span>vm</span> <span>=</span> <span>Vm</span>.<span>init</span>(<span>allocator</span>, .{});
<span>defer</span> <span>vm</span>.<span>deinit</span>();
<span>try</span> <span>vm</span>.<span>addPackage</span>(<span>&#34;my_lib&#34;</span>, <span>my_lib</span>);

<span>const</span> <span>res</span> <span>=</span> <span>vm</span>.<span>run</span>(<span>source</span>) <span>catch</span> <span>|</span><span>e</span><span>|</span> <span>switch</span> (<span>e</span>) {
    <span>else</span> <span>=</span><span>&gt;</span> <span>|</span><span>err</span><span>|</span> <span>return</span> <span>err</span>,
    <span>error</span>.<span>TokenizeError</span>, <span>error</span>.<span>ParseError</span>, <span>error</span>.<span>CompileError</span>, <span>error</span>.<span>RuntimeError</span> <span>=</span><span>&gt;</span> {
        <span>try</span> <span>vm</span>.<span>errors</span>.<span>render</span>(<span>source</span>, <span>out_stream</span>);
        <span>return</span> <span>error</span>.<span>RunningBogFailed</span>;
    },
};

<span>const</span> <span>bog_integer</span> <span>=</span> <span>try</span> <span>res</span>.<span>bogToZig</span>(<span>i64</span>, <span>&amp;</span><span>vm</span>);
<span>std</span>.<span>debug</span>.<span>assert</span>(<span>bog_integer</span> <span>==</span> <span>8</span>);</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="let {pow} = import &#34;my_lib&#34;

return 2 * pow(2)"><pre><span>let</span> {pow} <span>=</span> <span>import</span> <span><span>&#34;</span>my_lib<span>&#34;</span></span>

<span>return</span> <span>2</span> <span>*</span> <span>pow</span>(<span>2</span>)</pre></div>
<h2 dir="auto"><a id="user-content-setup" aria-hidden="true" href="#setup"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Setup</h2>
<ul dir="auto">
<li>Download master version of Zig from <a href="https://ziglang.org/download/" rel="nofollow">https://ziglang.org/download/</a></li>
<li>Clone this repo</li>
<li>Build with <code>zig build</code></li>
<li>Run with <code>./zig-cache/bin/bog</code></li>
</ul>
</article>
          </div></div>
  </body>
</html>
