<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://citizenlab.ca/2021/12/pegasus-vs-predator-dissidents-doubly-infected-iphone-reveals-cytrox-mercenary-spyware/">Original</a>
    <h1>Pegasus vs. Predator</h1>
    
    <div id="readability-page-1" class="page"><div id="main" role="main" itemscope="" itemprop="mainContentOfPage" itemtype="http://schema.org/Blog">
			<section id="content">


						
							

     <article id="post-75733" dir="ltr" 75733role="article" itemscope="" itemprop="blogPost" itemtype="http://schema.org/BlogPosting">

        <header>
          <span dir="ltr"><a href="https://citizenlab.ca/category/research/"></a><a href="https://citizenlab.ca/category/research/">Research</a><img src="https://citizenlab.ca/wp-content/themes/citizenlab-2.0.5/library/images/chevron-right.svg" alt=""/><a href="https://citizenlab.ca/category/research/targeted-threats/">Targeted Threats</a></span>
            
            

          <!-- Display the link for the PDF version of the post -->
          
        </header>         
                <section itemprop="articleBody">
                  
<h2 id="key-findings"><strong>Key Findings</strong></h2>
<ul><li>Two Egyptians—exiled politician Ayman Nour and the host of a popular news program (who wishes to remain anonymous)—were hacked with Predator spyware, built and sold by the previously little-known mercenary spyware developer Cytrox.</li>
<li>The phone of Ayman Nour was simultaneously infected with both Cytrox’s Predator and NSO Group’s Pegasus spyware, operated by <em>two different government clients.</em></li>
<li>Both targets were hacked with Predator in June 2021, and the spyware was able to infect the then-latest version (14.6) of Apple’s iOS operating system using single-click links sent via WhatsApp.</li>
<li>We obtained samples of Predator’s “loader,” the first phase of the spyware, and analyzed their functionality. We found that Predator persists after reboot using the iOS <em>automations</em> feature.</li>
<li>We conducted Internet scanning for Predator spyware servers and found likely Predator customers in Armenia, Egypt, Greece, Indonesia, Madagascar, Oman, Saudi Arabia, and Serbia.</li>
<li>Cytrox was reported to be part of <a href="https://intellexa.com/"><span>Intellexa</span></a>, the <a href="https://gizmodo.com/the-lucrative-government-spyware-industry-has-a-new-one-1832568791"><span>so-called</span></a> “Star Alliance of spyware,” which was formed to compete with NSO Group, and which describes itself as “EU-based and regulated, with six sites and R&amp;D labs throughout Europe.”</li>
</ul><h2 id="background"><strong>1. Background</strong></h2>
<p>We confirmed the hacking of the devices of two individuals with Cytrox’s Predator spyware: Ayman Nour, a member of the Egyptian political opposition living in exile in Turkey, and an Egyptian exiled journalist who hosts a popular news program and wishes to remain anonymous.</p>
<p><a href="https://www.aljazeera.com/news/2017/11/28/ayman-nour-sisi-has-made-egypt-a-swamp-of-tyranny"><span>Ayman Nour</span></a> is the president of the Egyptian political opposition group <a href="https://www.middleeasteye.net/news/arabic-press-review-egypts-new-opposition-front-and-palestinian-self-demolish-his-home"><span>Union of the Egyptian National Forces</span></a>. Nour is also a former Egyptian presidential candidate and founder and chairperson of the <em>Ghad al-Thawra</em> party.<a id="fnref1" href="#fn1"><sup>1</sup></a> In 2005, Nour <a href="https://www.aljazeera.com/news/2017/11/28/ayman-nour-sisi-has-made-egypt-a-swamp-of-tyranny"><span>ran</span></a> against former Egyptian President Hosni Mubarak. After the election, Nour was <a href="https://www.nytimes.com/2009/02/19/world/middleeast/19egypt.html?hp"><span>convicted</span></a> of “forging signatures on petitions” filed to create his political party—a charge which was <a href="https://www.nytimes.com/2009/02/19/world/middleeast/19egypt.html?hp"><span>widely considered</span></a> to be “politically inspired”—and imprisoned for more than four years. Nour was finally <a href="https://www.nytimes.com/2009/02/19/world/middleeast/19egypt.html?hp"><span>released</span></a> from prison in 2009 on health grounds and after international pressure.</p>
<p>Nour was a candidate of the <em>Ghad Al-Thawra party</em> in the 2012 Egyptian presidential elections. He was <a href="https://www.bbc.com/news/world-middle-east-17717268"><span>excluded</span></a> from the elections along with a number of other opposition candidates. In 2013, after opposing President Abdel Fattah El-Sisi’s military coup, Nour <a href="https://carnegieendowment.org/files/CP305_Dunne_and_Hamzawy_Parties_Final_Web.pdf"><span>fled</span></a> Egypt for Lebanon. In 2015, the Egyptian embassy in Lebanon declined to renew his passport and Nour departed Lebanon for Turkey, where he has resided since 2015. He remains a <a href="https://www.aljazeera.com/news/2017/11/28/ayman-nour-sisi-has-made-egypt-a-swamp-of-tyranny"><span>vocal critic</span></a> of Sisi’s regime, describing his government as an “oppressive military regime.” He has also <a href="https://www.washingtonpost.com/world/middle_east/egyptian-president-sissi-wins-approval-from-lawmakers-to-stay-in-office-until-2030/2019/04/16/3d934824-6068-11e9-bf24-db4b9fb62aa2_story.html"><span>accused</span></a> Sisi’s government of “extreme human rights violations” and of turning the country into a “fully autocratic state.”</p>
<p>The second target whose phone we confirmed was hacked with Cytrox’s Predator spyware is an Egyptian exiled journalist and an outspoken critic of the Sisi regime. This target has chosen to remain anonymous.</p>
<h3 id="enter-cytrox"><strong>1.1. Enter: Cytrox</strong></h3>
<p>Founded in <a href="https://pitchbook.com/profiles/company/231439-87#overview"><span>2017</span></a>, Cytrox’s business activity is blandly <a href="https://www.crunchbase.com/organization/cytrox"><span>described</span></a> in Crunchbase as providing governments with an “operational cyber solution” that includes gathering information from devices and cloud services. In <a href="https://pitchbook.com/profiles/company/231439-87#overview"><span>Pitchbook</span></a>, their technology is defined as “cyber intelligence systems designed to offer security” to governments and assist with “designing, managing and implementing cyber intelligence gathering in the network, enabling businesses to gather intelligence from both end devices as well as from cloud services.”</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-1.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-1.png" alt="" width="426" height="92"/></a></p><figcaption>Figure 1: The logo of Cytrox from a North Macedonian job postings website. <a href="https://dekra.mk/en/jobs/qatester/">Source</a>.</figcaption></figure>
<p>Cytrox reportedly began life as a North <a href="https://www.forbes.com/sites/thomasbrewster/2019/08/05/a-multimillionaire-surveillance-dealer-steps-out-of-the-shadows-and-his-9-million-whatsapp-hacking-van/?sh=12a0efe31b71">Macedonian</a> start-up.<a id="fnref2" href="#fn2"><sup>2</sup></a> A review of corporate registry documents shows that Cytrox appears to have a corporate presence in Israel and Hungary.</p>
<p>Cytrox’s Israeli companies were founded in 2017 as Cytrox EMEA Ltd. and Cytrox Software Ltd. Perhaps taking a page from <a href="https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/"><span>Candiru</span></a>’s corporate obfuscation playbook, both of those companies were renamed in 2019 to Balinese Ltd. and Peterbald Ltd., respectively. We also observed one entity in Hungary, Cytrox Holdings Zrt, which was also <a href="https://www.dnb.com/business-directory/company-profiles.cytrox_holdings_z%C3%A1rtk%C3%B6r%C5%B1en_m%C5%B1k%C3%B6d%C5%91_r%C3%A9szv%C3%A9nyt%C3%A1rsas%C3%A1g.845c1fa4c3b2b109b79e138bdb55a3cb.html"><span>formed</span></a> in 2017.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Figure-2.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Figure-2.png" alt="Figure 2: Cytrox CEO Ivo Malinkovksi wearing a “More Money” shirt, and mimicking the cover of Apple co-founder Steve Jobs’ biography. &lt;a href=&#34;https://friday.mk/na-prvo-espreso-ivo-malinkovski/&#34;&gt;Source&lt;/a&gt;." width="870" height="490"/></a></p><figcaption>Figure 2: Cytrox CEO Ivo Malinkovksi wearing a “More Money” shirt, and mimicking the cover of Apple co-founder Steve Jobs’ biography. <a href="https://friday.mk/na-prvo-espreso-ivo-malinkovski/">Source</a>.</figcaption></figure>
<p>At the time of writing, we believe that Cytrox’s CEO is Ivo Malinkovksi, as stated on his <a href="https://mk.linkedin.com/in/ivo-malinkovski-54a2088b"><span>LinkedIn</span></a> page. Notably, Malinkovksi’s now-private Instagram account includes a 2019 image of him in front of the Pyramids of Giza in Egypt.</p>
<p>A 2019 report in <em>Forbes</em> states that Cytrox was “<a href="https://www.forbes.com/sites/thomasbrewster/2019/08/05/a-multimillionaire-surveillance-dealer-steps-out-of-the-shadows-and-his-9-million-whatsapp-hacking-van/?sh=12a0efe31b71"><span>rescued</span></a>” by Tal Dilian, a former Israel Defence Forces (IDF) Unit 81 <a href="https://www.haaretz.com/israel-news/tech-news/.premium.HIGHLIGHT.MAGAZINE-a-shady-israeli-intel-genius-his-cyber-spy-van-and-million-dollar-deals-1.9413973"><span>commander</span></a>, whose company WiSpear (which appears to have been <a href="https://opencorporates.com/companies/cy/HE318328"><span>renamed</span></a> <a href="https://efiling.drcor.mcit.gov.cy/DrcorPublic/SearchResults.aspx?name=%25&amp;number=318328&amp;searchtype=optStartMatch&amp;index=1&amp;lang=EN&amp;tname=%25&amp;sc=1"><span>Passitora Ltd.</span></a>) is based in Limassol, Cyprus and reportedly acquired Cytrox in 2018 <a href="https://www.atooro.com/"><span>according</span></a> to the Atooro Fund. Dilian is also known as the <a href="https://www.calcalistech.com/ctech/articles/0,7340,L-3878410,00.html#:~:text=Circles%20Technologies%20was%20founded%20by,%2C%E2%80%9D%20as%20Dilian%20told%20Forbes."><span>founder</span></a> of Circles, a prominent cellular network surveillance company. In December 2020, the Citizen Lab <a href="https://citizenlab.ca/2020/12/running-in-circles-uncovering-the-clients-of-cyberespionage-firm-circles/"><span>published</span></a> an investigation into Circles’ government clients. Dilian is also the <a href="https://www.techtimes.com/articles/266194/20211004/intellexa-founder-tal-dilian-on-the-importance-of-insightful-data-driven-intelligence-for-modern-law-enforcement.htm"><span>founder</span></a> and CEO of Intellexa.</p>
<h3 id="cytrox-a-part-of-the-intellexa-alliance"><strong>1.2. Cytrox, a Part of the “Intellexa Alliance”</strong></h3>
<p>The following section is not a complete accounting of the relationship between Cytrox and other entities. It is based on a review of a mix of media reports and a nonexhaustive review of company registries across various jurisdictions. Additional research into Intellexa and the companies that form this marketing alliance could potentially provide useful insight into how commercial surveillance companies employ complex business structures and use measures that obfuscate their operations.</p>
<h4 id="the-link-between-cytrox-and-intellexa"><strong>The Link between Cytrox and Intellexa</strong></h4>
<p>Cytrox is <a href="https://www.fastcompany.com/90369108/inside-the-shadowy-world-of-spyware-makers-that-target-activists-and-dissidents"><span>part of</span></a> the so-called “Intellexa alliance,” a marketing label for a range of mercenary surveillance vendors that <a href="https://www.fastcompany.com/90369108/inside-the-shadowy-world-of-spyware-makers-that-target-activists-and-dissidents"><span>emerged</span></a> in 2019. The consortium of companies includes Nexa Technologies (formerly Amesys), WiSpear/Passitora Ltd., Cytrox, and Senpai, along with other unnamed entities, purportedly seeking to compete against other players in the cyber surveillance market such as NSO Group and Verint.</p>
<p>Originally based in Cyprus, a <a href="https://www.intelligenceonline.com/surveillance--interception/2021/10/28/cyberintelligence-firm-intellexa-makes-paris-appearance-with-orion,109701542-art"><span>recent report</span></a> indicates that Intellexa now operates from Greece, which is also listed as the <a href="https://gr.linkedin.com/in/tal-dilian-3261424"><span>LinkedIn location</span></a> of its <a href="https://www.techtimes.com/articles/266194/20211004/intellexa-founder-tal-dilian-on-the-importance-of-insightful-data-driven-intelligence-for-modern-law-enforcement.htm"><span>founder</span></a>, Dilian. A preliminary review of corporate registry documentation suggests that the alliance has a corporate presence in not only <a href="https://www.dnb.com/business-directory/company-profiles.intellexa_sa.00b9d3be2fdd11150913f55266c391e8.html"><span>Greece</span></a> (Intellexa S.A.), but also in <a href="https://www.dnb.com/business-directory/company-profiles.intellexa_limited.661ff95d36c75c6d541d44c8f09a27ff.html"><span>Ireland</span></a> (Intellexa Limited).<a id="fnref3" href="#fn3"><sup>3</sup></a> The Dun &amp; Bradstreet entry for Intellexa S.A. and Intellexa Limited note <a href="https://www.dnb.com/business-directory/company-profiles.intellexa_sa.00b9d3be2fdd11150913f55266c391e8.html"><span>Sara-Aleksandra Fayssal Hamou</span></a> (or <a href="https://www.dnb.com/business-directory/company-profiles.intellexa_limited.661ff95d36c75c6d541d44c8f09a27ff.html"><span>Sara Hamou</span></a>) as a key principal in both companies. Hamou is <a href="https://www.haaretz.com/israel-news/tech-news/.premium.HIGHLIGHT.MAGAZINE-a-shady-israeli-intel-genius-his-cyber-spy-van-and-million-dollar-deals-1.9413973"><span>reportedly</span></a> Dilian’s second wife.</p>
<p>In our preliminary research, the specific link between Cytrox and Intellexa, as well as other companies in the “alliance,” remains murky at best. In reviewing filings in the Israeli business registry, we observed a 2020 transfer of all shares held by Cytrox Holdings Zrt (Hungary) in Cytrox EMEA Ltd./Balinese Ltd. (Israel) to Aliada Group Inc., an entity registered in the British Virgin Islands (registration no. 1926732). Prior to this share transfer, Cytrox Holdings Zrt appears to have been the sole shareholder of shares in Cytrox EMEA Ltd./Balinese and after this share transfer it seems to remain the sole shareholder in Cytrox Software Ltd./Peterbald. Further, an article from <em>Intelligence Online</em> in 2017 <a href="https://www.intelligenceonline.com/surveillance--interception/2017/09/20/with-wispear-gsm-interception-champion-tal-dilian-gets-into-wifi,108262318-art"><span>notes</span></a> that WiSpear Systems is “owned by Aliada Group Inc.”</p>
<p>Information on Aliada Group Inc. is relatively scant. The same 2017 article from <em>Intelligence Online</em> notes that Aliada Group Inc. is “backed by the private equity firm Mivtach-Shamir, which spent $3.5 million to acquire a 32% stake in Aliada in December 2016, along with an option to acquire an additional 5%.” Mivtach-Shamir is “<a href="https://www.crunchbase.com/organization/mivtach-shamir-holdings-ltd"><span>a publicly-traded Israeli investment company</span></a>” founded by Meir Shamir. In reviewing entries for WiSpear/Passitora Ltd. in Cyprus’ business registry, we noted that “Mivtah Shamir Technologies (2000) Ltd.” is listed as a director of Passitora Ltd., along with Dilian. We also found an entry in the Israeli business registry for a “Mivtach Shamir Technologies (2000) Ltd.,” which was apparently incorporated in 2000.</p>
<p>Further, a 2020 <em>Haaretz</em> <a href="https://www.haaretz.com/israel-news/tech-news/.premium.HIGHLIGHT.MAGAZINE-a-shady-israeli-intel-genius-his-cyber-spy-van-and-million-dollar-deals-1.9413973"><span>article</span></a> noted that Avi Rubinstein, a “high-tech entrepreneur, filed a lawsuit against Dilian in Tel Aviv District Court.”<a id="fnref4" href="#fn4"><sup>4</sup></a> According to <em>Haaretz</em>, Aliada Group Inc. is described in the litigation as “a group of cyberweapon companies whose products are branded under the name Intellexa.” Two other individuals, Oz Liv, who was also a commander in Unit 81, and Meir Shamir, are also named as defendants. According to <em>Haaretz</em>, these two individuals, along with Rubinstein, who filed the suit, and Dilian, are all shareholders in Aliada Group Inc.</p>
<p><em>Haaretz</em> further notes that Rubinstein is accusing Dilian, Liv, and Shamir of acting <em>“illegally to dilute [Rubinstein’s] own shares through a pyramid of companies set up overseas. Some of those companies were established via front men connected to Dilian, including his second wife, Sara Hamou”</em> (as noted above, Hamou’s name appears in corporate registry listings in the Dun &amp; Bradstreet database for Intellexa entities in Ireland and Greece). The lawsuit also reportedly claimed that <em>“this transfer of Aliada’s activities out of Israel via shell companies, first to the British Virgin Islands and later Ireland, violated both Israeli and foreign defense export control laws.”</em></p>
<p>According to the BVI Registrar of Corporate Affairs, as of the date of publication of this report, Aliada Group Inc.’s legal status is “in penalty” due to nonpayment of annual fees. In addition, the registered agent filed an intent to resign on November 12, 2021. The reason for the resignation is as yet unclear.</p>
<h4 id="intellexas-products"><strong>Intellexa’s Products</strong></h4>
<p>A <a href="https://web.archive.org/web/20211004210723/https://intellexa.com/"><span>prior version of the Intellexa website</span></a> markets “intelligence solutions” including “tactical interception.” The marketing of interception was also <a href="https://www.forbes.com/sites/thomasbrewster/2019/08/05/a-multimillionaire-surveillance-dealer-steps-out-of-the-shadows-and-his-9-million-whatsapp-hacking-van/?sh=27618a2f31b7"><span>underscored</span></a> in Dilian’s 2019 <em>Forbes</em> interview. However, at the time of writing, the website is <a href="https://web.archive.org/web/20211212011206/https://intellexa.com/"><span>considerably more vague</span></a> about the company’s activities. In its current form, Intellexa’s website and associated videos pitch a product called “Nebula” which is described as a ‘holistic’ intelligence gathering and analysis platform.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-3.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-3.png" alt="" width="871" height="489"/></a></p><figcaption>Figure 3: Text from the Intellexa website at time of writing.</figcaption></figure>
<p>The company’s website prominently features the claim that it is “EU-based and regulated.” This claim is interesting given the track record of some of Intellexa’s participating corporate entities, which have been riddled with legal issues and other controversy. For example, in June 2021, executives of Amesys and Nexa Technologies <a href="https://www.fidh.org/en/region/north-africa-middle-east/egypt/surveillance-and-torture-in-egypt-and-libya-amesys-and-nexa"><span>were indicted</span></a> by investigating judges with the crimes against humanity and war crimes unit of the Paris Judicial Court for complicity in torture in relation to product sales to the Libyan government and complicity in torture and forced dissapearance in relation to product sales to the Egyptian government.</p>
<p>Dilian has also been followed by <a href="https://www.haaretz.com/israel-news/.premium-cyprus-israel-spies-arab-world-cyber-something-wrong-1.8317030"><span>reports</span></a> of legal and other irregularities, both during his time in the Israeli military and in his new career as a mercenary surveillance tech vendor. In 2019, after courting publicity with a demonstration to <a href="https://www.forbes.com/sites/thomasbrewster/2019/08/05/a-multimillionaire-surveillance-dealer-steps-out-of-the-shadows-and-his-9-million-whatsapp-hacking-van/?sh=1783ac2b31b7"><span>Forbes</span></a> of a “$9 million signals intelligence van” with communications hacking capabilities in Cyprus, WiSpear and Tal Dilian attracted police interest. The van was confiscated by Cypriot authorities, several WiSpear/Passitora Ltd. <a href="https://www.forbes.com/sites/thomasbrewster/2019/12/20/cyprus-arrests-surveillance-company-staff-after-forbes-whatsapp-hacking-van-video-causes-stir/"><span>employees were arrested</span></a> and briefly detained, and Dilian was <a href="https://www.timesofisrael.com/israeli-spy-tech-ceo-wanted-for-questioning-by-cypriot-police/"><span>wanted for questioning</span></a>.</p>
<p>According to a 2020 <em>Reuters</em> <a href="https://www.reuters.com/article/us-health-coronavirus-spy-specialreport-idUSKCN22A2G1"><span>article</span></a> Dilian—who <a href="https://www.timesofisrael.com/israeli-spy-tech-ceo-wanted-for-questioning-by-cypriot-police/"><span>characterized</span></a> the Cypriot investigation as a “witch hunt” against him—fled Cyprus after an arrest warrant was issued in his name. An article in <em>CyprusMail</em> from November 2021 <a href="https://cyprus-mail.com/2021/11/16/akel-cries-foul-as-ag-remains-tight-lipped-over-dropping-spy-van-charges/"><span>notes</span></a> that the Attorney-General’s office decided to “drop all charges” against all three individuals involved in the “spy van” case (the case against WiSpear/Passitora Ltd. was not dropped). Reporting from the same month notes that WiSpear was fined <a href="https://news-primer.com/surveillance-company-pays-1-million-fine-after-spy-van-scandal/"><span>almost 1 million Euros</span></a> for privacy violations.</p>
<h2 id="attacks-against-the-two-targets"><strong>2. Attacks against the Two Targets</strong></h2>
<p>Nour first became suspicious after observing that his iPhone was “running hot.” We learned of Nour’s case and reviewed logs from his phone. Ultimately, we determined that his device had been exploited and infected with <em>two separate mercenary spyware tools:</em> Pegasus spyware, made by NSO Group, and Predator, which is developed by Cytrox.</p>
<p>We attribute the attacks on the two targets to the Egyptian Government with medium-high confidence. We conducted scanning (Section 4) that identified the Egyptian Government as a Cytrox Predator customer, websites used in the hacks of the two targets bore Egyptian themes, and the messages that initiated the hack were sent from Egyptian WhatsApp numbers (Section 2.5, Section 2.7).</p>
<h3 id="confirming-nso-pegasus-infection-of-ayman-nour"><strong>2.1. Confirming NSO Pegasus Infection of Ayman Nour</strong></h3>
<p>The logs showed that Nour’s phone had been repeatedly compromised with NSO Group’s Pegasus spyware since March 3, 2021. For example, evidence of execution of the following processes was identified on Nour’s phone, dating back to March 3, 2021:</p>
<div>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/tisppd/private/var/db/com.apple.xpc.roleaccountd.staging/bfrgbd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/xpccfd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/comsercvd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/rlaccountd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/launchrexd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/ckeblld</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/comnetd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/accountpfd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/jlmvskrd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/msgacntd</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/brstaged</code></p>
<p><code>/private/var/db/com.apple.xpc.roleaccountd.staging/fdlibframed</code></p>
</div>
<p>These process names all appear on a list of Pegasus indicators published by Amnesty Tech and we have also independently linked them to Pegasus. Crash logs also showed that on June 30, 2021, NSO Group’s <a href="https://googleprojectzero.blogspot.com/2021/12/a-deep-dive-into-nso-zero-click.html"><em><strong><span>FORCEDENTRY</span></strong></em> <span>exploit</span></a> (CVE-2021-30860) was fired at the phone. The exploit did <em>not</em> result in installation of the Pegasus spyware at this time.</p>
<p>Based on the traces of <em><strong>FORCEDENTRY</strong></em>, the presence of process names linked to Pegasus, and additional factors, we conclude with high confidence that the phone was repeatedly hacked with NSO Group’s Pegasus spyware starting on March 3, 2021.</p>
<h3 id="confirming-cytrox-predator-infection-of-ayman-nour"><strong>2.2. Confirming Cytrox Predator Infection of Ayman Nour</strong></h3>
<p>After confirming forensic traces of Pegasus on Nour’s iPhone, we identified the presence of additional spyware, which we attribute with high confidence to Cytrox. We further conclude with high confidence that it is unrelated to Pegasus spyware.</p>
<p>While examining the iPhone logs we determined that, on June 30, 2021, two commands <code>“/Payload2”</code> were running on the phone (PIDs 339 and 1272), and that these commands had been launched with a single argument, a URL on <code>distedc[.]com</code>. The commands were running as root.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-4-1.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-4-1.png" alt="" width="702" height="59"/></a></p><figcaption>Figure 4: Listing of commands running on Nour’s phone.</figcaption></figure>
<p>iPhone logs indicated that the process names of the commands were <em>UserEventAgent</em> and <em>com.apple.WebKit.Networking</em>, that their binaries were resident on disk in the <em>/private/var/tmp/</em> folder, and that the responsible process for both was <em>siriactionsd</em>, which is a legitimate iOS process that manages iOS shortcuts and automations.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Figure-5.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Figure-5.png" alt="Phone logs showing process names of the commands, and paths to binaries on disk." width="484" height="241"/></a></p><figcaption>Figure 5: Phone logs showing process names of the commands, and paths to binaries on disk.</figcaption></figure>
<p>While iOS has legitimate binaries with the names “com.apple.WebKit.Networking” and “UserEventAgent”, the binaries in Figures 5 do not match any known legitimate Apple version. Moreover, the legitimate iOS binaries with these names are not stored in <code>/private/var/tmp/</code>. The two suspicious processes were running as part of the “<code>com.apple.WorkflowKit.BackgroundShortcutRunner</code>” launchd coalition. We found two additional suspicious processes that had recently run in this same coalition, named “hooker” and “takePhoto”.</p>
<h3 id="attribution-to-cytrox"><strong>2.3. Attribution to Cytrox</strong></h3>
<p>We looked up the IP address for distedc[.]com on Internet scanning service <a href="https://censys.io"><span>Censys</span></a> and found that, as of October 2021, it returned an HTTP 302 redirect to <a href="https://duckduckgo.com"><span>https://duckduckgo.com</span></a>. Concluding that this might be an identifying behavior, we built a <a href="https://search.censys.io/search?resource=hosts&amp;per_page=25&amp;virtual_hosts=EXCLUDE&amp;q=services.http.response.body_hash%3A%60sha1%3A8490a34ab83d79b3b5f66dbd4484438717b6dca7%60+and+services.http.response.headers.access_control_allow_origin%3A%60*%60"><span>Censys fingerprint</span></a> for the redirect.</p>
<p>We found 28 hosts on Censys matching this fingerprint in October 2021, including an IP in Northern Macedonia, <code>62.162.5[.]58</code>, which was pointed to by <code>dev-bh.cytrox[.]com</code> in August 2020, and which also returned a redirect with <code>dev-bh.cytrox[.]com</code> in its Location header <a href="https://www.shodan.io/host/62.162.5.58/history#80"><span>on port 80 during this period</span></a>.</p>
<p>Additionally, passive DNS tool <a href="https://www.riskiq.com"><span>RiskIQ</span></a> shows that the IP 62.162.5[.]58 returned a certificate (0fb1b8da5f2e63da70b0ab3bba8438f30708282f) for teslal[.]xyz between July 2020 and September 2020. Since <code>62.162.5[.]58</code> currently returns a <code>teslal[.]xyz</code> certificate, we assume that the IP has not changed ownership since August 2020 and is thus still related to <code>cytrox[.]com</code>.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-6.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-6.png" alt="" width="1498" height="878"/></a></p><figcaption>Figure 6: Cytrox WordPress page from 2019, after apparent hacking and the placement of an SEO-link for an online casino.</figcaption></figure>
<p>The <em>cytrox.com</em> domain previously returned a WordPress page containing an email address (<a href="mailto:ivo@cytrox.com"><span>ivo@cytrox.com</span></a>), which appears to be the email of Ivo Malinkovski, CEO of Cytrox. The WordPress page is apparently unmaintained, and was apparently hacked to include spam links to an online casino (Figure 6).</p>
<p>We analyzed binaries associated with the spyware (Section 3), which revealed that the spyware is named “Predator.” We performed additional fingerprinting and scanning (Section 4) that allowed us to identify additional components of Cytrox client infrastructure.</p>
<h3 id="observation-of-additional-domains"><strong>2.4. Observation of Additional Domains</strong></h3>
<p>In addition to distedc[.]com, we observed additional domains associated with the Predator installation on the two victim phones.</p>
<figure><table headertable="true"><thead><tr><th><strong>Domain</strong></th>
<th><strong>Where Seen</strong></th>
</tr></thead><tbody><tr><td>distedc[.]com</td>
<td>As argument to running Predator process in system logs; in iOS automation for Predator persistence</td>
</tr><tr><td>gosokm[.]com</td>
<td>iOS system logs for running Predator processes showed data exfiltration here</td>
</tr><tr><td>youtubesyncapi[.]com
<p>bity[.]ws</p></td>
<td>Predator configuration echoed to system logs</td>
</tr><tr><td>egyqaz[.]com</td>
<td>Within Android Predator sample downloaded from distedc[.]com; Safari history of compromised device</td>
</tr><tr><td>almasryelyuom[.]com
<p>qwxzyl[.]com</p></td>
<td>Safari history of compromised device timestamped ~1ms before egyqaz[.]com</td>
</tr></tbody></table><figcaption><p><strong>Table 1: Domains observed in Predator spyware used to hack Egyptian targets.</strong></p></figcaption></figure>
<h3 id="how-ayman-nour-was-hacked-with-predator"><strong>2.5. How Ayman Nour was Hacked with Predator</strong></h3>
<p>We searched Nour’s phone for these domains and found that an Egyptian number on WhatsApp (+201201407978), purporting to be a “Dr. Rania Shhab,” sent four distinct links to almasryelyuom[.]com and qwxzyl[.]com to Nour’s device. The links were sent as images containing URLs. The same WhatsApp account sent a link to youtu-be[.]net, which we assess is also related, because the server response for youtu-be[.]net matches that of almasryelyuom[.]com and qwxzyl[.]com.</p>
<p>The following are examples of images accompanying the links sent by the attacker, extracted from Nour’s phone:</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-7.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-7.png" alt="" width="1138" height="288"/></a></p><figcaption>Figure 7: An image accompanying a Cytrox Predator link sent to Nour reads: “Turkey asks the Egyptian opposition channels to stop criticizing Egypt, and Cairo comments on the move…”</figcaption></figure>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-8.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-8.png" alt="" width="901" height="270"/></a></p><figcaption>Figure 8: An image accompanying a Cytrox Predator link sent to Nour reads: “The moment a car fell from the top of the [6th] October Bridge in Ramses.”</figcaption></figure><figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-9.jpg"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-9.jpg" alt="" width="454" height="136"/></a></p><figcaption>Figure 9: An image accompanying a Cytrox Predator link sent to Nour purports to be a link to the legitimate website of the Al Masry Al Youm newspaper. The actual link goes to a fake lookalike domain, almasryelyuom[.]com.</figcaption></figure>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-10.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-10.png" alt="" width="1061" height="288"/></a></p><figcaption>Figure 10: An image accompanying a Cytrox Predator link sent to Nour reads: “Breaking news.. Alexandria train accident today. Full details…”</figcaption></figure>
<h3 id="evidence-of-predator-and-pegasus-running-simultaneously"><strong>2.6. Evidence of Predator and Pegasus Running Simultaneously</strong></h3>
<p>Phone logs indicate that on June 22, 2021, Pegasus and Predator were <em>running simultaneously</em> on Nour’s phone, as these four processes were observed running simultaneously:</p>
<figure><table headertable="true"><thead><tr><th><strong>PID</strong></th>
<th><strong>Process</strong></th>
<th><strong>Spyware</strong></th>
</tr></thead><tbody><tr><td>4219</td>
<td><code>/private/var/db/com.apple.xpc.roleaccountd.staging/launchrexd</code></td>
<td>Pegasus</td>
</tr><tr><td>4257</td>
<td><code>/private/var/db/com.apple.xpc.roleaccountd.staging/fdlibframed</code></td>
<td>Pegasus</td>
</tr><tr><td>4265</td>
<td><code>/private/var/tmp/UserEventAgent</code></td>
<td>Predator</td>
</tr><tr><td>4412</td>
<td><code>/private/var/tmp/com.apple.WebKit.Networking</code></td>
<td>Predator</td>
</tr></tbody></table><figcaption><p><strong>Table 2: Pegasus and Predator processes running simultaneously on Nour’s phone on June 22, 2021.</strong></p></figcaption></figure>
<p>The phone logs indicate that the device was infected with Pegasus on June 22 at 13:26 GMT. A number of <em>Library/SMS/Attachments</em> folders were created between 13:17 and 13:21, and there were no entries whatsoever in the <em>Attachments</em> table of the <em>sms.db</em> file for June 22, suggesting that a zero-click exploit may have been the vector for Pegasus installation. Approximately an hour later, a Predator link sent to Nour on WhatsApp was opened in Safari at 14:33 GMT on the same day and Predator was installed on the device two minutes later at 14:35 GMT.</p>
<h3 id="how-second-target-was-hacked-with-predator"><strong>2.7. How Second Target was Hacked with Predator</strong></h3>
<p>The second target, an Egyptian journalist in exile who is the host of a popular news program, received one message on WhatsApp from an unknown number (+201201407595) with a link to the same almasryelyuom[.]com website.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-11.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-11.png" alt="" width="925" height="1311"/></a></p><figcaption>Figure 11: Second target is targeted with Predator.</figcaption></figure>
<p>The individual who sent the link claimed that they were an Assistant Editor at the <em>Al Masry Al Youm</em> newspaper.</p>
<h2 id="analysis-of-cytroxs-predator-spyware"><strong>3. Analysis of Cytrox’s Predator Spyware</strong></h2>
<p>We obtained Android and iOS payloads from distedc[.]com and found them to be copies of a loader for a spyware product called Predator. We believe that these payloads are invoked by a previous exploit phase that we do not have.</p>
<h3 id="initialization"><strong>3.1. Initialization</strong></h3>
<p>The iPhone executable is a 64-bit Mach-O binary which, like its Android counterpart, expects two arguments when the binary’s <code>main</code> function is called, which appear to be a kernel process task port and a pid value. The <code>main</code> function then calls <code>kmem_init</code> with these values, which proceeds to enable Predator stage 1 for continued execution. The Android sample passes its arguments to shared constants <code>SHMEMFD_VSS</code> and <code>SHMEMFD_VSS</code>.</p>
<p>Both the iOS and Android samples then call a <code>startPy</code> function to load a bundled Python 2.7 runtime. In the iOS sample, two additional built-in objects are added to the runtime: <code>predutils</code> and predconfig. The Android sample contains further additional built-in objects: injector, pc2, recorder, and voip_recorder. Upon initialization, startPy loads a frozen Python module named loader which begins by importing the Predator config from the interpreter’s predconfig module.</p>
<p>The iOS and Android configurations are slightly different. The complete configurations are available in <strong>Appendix 1</strong>. Once Predator iOS loads its configuration, it loads another frozen Python module named km_ios, a utility module that provides kernel memory management helper functions enabling additional Predator module capabilities.</p>
<p>The iOS payload also contains a _check function, which queries the phone number and the phone’s current locale country code. If the locale country code is equal to “IL” (the country code for Israel), or the phone number begins with “+972” (the telephone country code for Israel) then the spyware terminates. However, the method that Predator uses to query the phone number, CTSettingCopyMyPhoneNumber, may not work in recent versions of iOS. We could not determine how (or if) the _check function is called.</p>
<h3 id="python-loader"><strong>3.2. Python Loader</strong></h3>
<p>In addition to the frozen loader module, “src/loader.py” (“frozenpyc/src/loader.py” in the Android sample), we also found copies of what appear to be older versions of the module that do not appear to be invoked by Predator: “src/loader2.py”, “src/loader_real.py” and “src/loaderBackup03”. All of the loader versions contain multiple references to “Predator.”</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-12.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-12.png" alt="" width="706" height="458"/></a></p><figcaption>Figure 12: An excerpt of code from the loader module that mentions “Predator.”</figcaption></figure>
<p>After loading the Predator configuration, the iOS loader then wipes the device’s crash logs by removing all files in “/private/var/mobile/Library/Logs/CrashReporter/”. Then, it downloads a configuration file and additional stages of the spyware from the server (specified by predconfig’s INS_URL parameter, which is set to https://bity[.]ws).</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-13.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-13.png" alt="" width="536" height="238"/></a></p><figcaption>Figure 13: Predator on iOS wipes the crash logs.</figcaption></figure>
<p>On Android, the loader module also downloads additional files from the server (specified by predconfig’s INS_URL parameter, which is set to https://egyqaz[.]com).</p>
<h3 id="persistence-on-ios"><strong>3.3. Persistence on iOS</strong></h3>
<p>On iOS, the loader calls a get_configuration_persistency function, which downloads an iOS shortcuts automation from the spyware server to ensure persistence. The persistent payload is referred to as “Nahum,” which is the name of a minor biblical prophet. Nahum’s prophecy appears in the Hebrew Tanakh and the Christian Old Testament, and foretells the total destruction of Nineveh, a powerful fortress city.</p>
<blockquote><p><em>Nineveh is destroyed, deserted, desolate! Hearts melt with fear; knees tremble, strength is gone; faces grow pale. Where now is the city that was like a den of lions, the place where young lions were fed, where the lion and the lioness would go and their cubs would be safe?</em></p></blockquote>
<p><span>Nahum 2:10-11 GNB</span></p>
<p>The iOS automation is triggered when certain apps are opened, including a number of built-in Apple apps, such as the App Store, Camera, Mail, Maps, Safari, as well as third-party apps including Twitter, Instagram, Facebook Messenger, LinkedIn, Skype, SnapChat, Viber, Wire, TikTok, Line, OpenVPN, WhatsApp, Signal, and Telegram.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-14.jpg"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-14.jpg" alt="" width="390" height="578"/></a></p><figcaption>Figure 14: Automation on Target 2’s infected device as viewed in the “Automations” tab of the “Shortcuts” app.</figcaption></figure>
<p>The automation first checks if the phone’s battery level is greater than 9% (i.e., if the phone is not in a low-battery situation). If the phone’s battery level is adequate, then the automation downloads JavaScript code from the spyware server and substitutes this code into a block of HTML contained in the shortcut. We were unable to obtain this JavaScript code. The HTML in the shortcut also contains a JavaScript function “make_bogus_transform” which appears to create an XSLT transformation that may be invoked by the downloaded JavaScript code. The HTML code with the substituted JavaScript is then Base64-encoded, its contents are prepended with “data:text/html,” and then the automation passes this URL to WebKit to render. This presumably triggers the exploit and results in the installation of the Predator spyware.</p>
<p>While automations normally trigger visible notifications when they are run, the Predator shortcut runs entirely in the background, invisible to the user, because Predator <em>also</em> changes an option to disable automations from triggering notifications.</p>
<p>The get_configuration_persistency function also downloads an iOS profile named “com.[name redacted].disable-shortcuts-notifications”, from the spyware server.</p>
<p>We located a profile with the same name publicly released by [name redacted], a software engineering student. We are redacting the name of the student here because we do not believe they are involved in Cytrox Predator development. The profile’s sole function is to prevent iOS from displaying notifications when an automation is run. Thus, users who have been hacked with Predator do not see notifications when the spyware is launched.</p>
<figure><p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-15.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Fig-15.png" alt="" width="1158" height="753"/></a></p><figcaption>Figure 15: Profile to disable automations notifications used by Predator.</figcaption></figure>
<p>There is nothing particularly special or complex about this specific profile, and Predator’s developers could have easily crafted their own similar profile that duplicated this functionality without mentioning the software engineering student by name.</p>
<p>The <em>get_configuration_persistency</em> function also downloads binaries called “takePhoto,” “agent.dylib,” “inject,” and “hooker” on iOS14, but does not download these files on iOS13, instead logging the message “iOS 13, don’t need hooker.” We did not obtain these files, but we believe that “hooker” and “takePhoto” are the same binaries we saw running in Section 2.2.</p>
<h3 id="additional-android-details"><strong>3.4. Additional Android Details</strong></h3>
<p>We did not find a mechanism for persistence on Android, nor values in the Android configuration file that indicate persistence support. However, we found some additional code in the Android sample, including code to disable SELinux and code for an audio recording component.</p>
<p>Predator stores additional Python modules and native ELF binaries in the fs.db SQLite file which is located at the path set in DB_FILE. The Python interpreter has a frozen module called sqlimper which is responsible for interacting with this database. The database contains a table called files which has a column called file_hash and a column called file_data. The file_hash is used in place of a file name and is computed using the following routine, where n is the name:</p>
<p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Android-Details-1.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Android-Details-1.png" alt="" width="1160" height="108"/></a></p>
<p>The injector module declares one function, inject, which can inject a shared object into a running process. Interestingly, there is a function called prior to injection which attempts to disable SELinux enforcement via the SELinuxFS.</p>
<p><a href="https://citizenlab.ca/wp-content/uploads/2021/12/Android-Details-2.png"><img loading="lazy" src="https://citizenlab.ca/wp-content/uploads/2021/12/Android-Details-2.png" alt="" width="550" height="413"/></a></p>
<p>It should be noted that this approach likely will not succeed on devices that have additional checks and protections around SELinux enforcement—for example, Samsung RKP. However, there are artifacts associated with Predator that suggest approaches like RKP can be defeated by stomping on the SELinux access vector cache entries to grant the needed permissions.</p>
<p>The pc2 module contains a single function, pc2_send_command, that is used as an IPC mechanism to send commands to Predator’s audio recording component. The supported commands are START_VOIP, STOP_VOIP, START_MICRORECORDER, STOP_MICRORECORDER, and POLL_VOIP. This module works in conjunction with the recorder and voip_recorder modules. Each of the recorder modules have a start and stop function which are used to start/stop Predator’s hot mic (recorder) and call recording (voip_recorder) capabilities. Recordings are stored in /data/local/tmp/wd/r/ in MP3 format.</p>
<h2 id="scanning-to-find-cytrox-customers"><strong>4. Scanning to Find Cytrox Customers</strong></h2>
<p>We fingerprinted the behavior of the domains from Table 1 and found additional domains via Shodan and Censys.</p>
<figure><table headertable="true"><thead><tr><th><strong>Domains</strong></th>
<th><strong>Fingerprint</strong></th>
</tr></thead><tbody><tr><td>almasryelyuom[.]com
<p>qwxzyl[.]com</p>
<p>youtu-be[.]net</p></td>
<td>[<a href="https://www.shodan.io/search?query=ssl.jarm%3A%2229d29d15d29d29d00042d42d000000038eaaf490bec8dc33757f165ce01762%22+http.html_hash%3A372213971+Access-Control-Allow-Origin"><span>Shodan</span></a>, <a href="https://search.censys.io/search?resource=hosts&amp;per_page=25&amp;virtual_hosts=EXCLUDE&amp;q=services.jarm.fingerprint%3A%6029d29d15d29d29d00042d42d000000038eaaf490bec8dc33757f165ce01762%60+and+services.http.response.body_hash%3A%60sha1%3A01b1df0ce8e76f49129f112be3fb0cdfef696818%60+and+services.http.response.headers.access_control_allow_origin%3A%60*%60"><span>Censys</span></a>]</td>
</tr><tr><td>egyqaz[.]com</td>
<td>[<a href="https://www.shodan.io/search?query=http.html_hash%3A-1759424475+access-control-allow-origin"><span>Shodan</span></a>, <a href="https://search.censys.io/search?resource=hosts&amp;per_page=25&amp;virtual_hosts=EXCLUDE&amp;q=services.http.response.body_hash%3A%60sha1%3A65973405857b3df07f2189bd4ed46aed34e57154%60+and+services.http.response.headers.access_control_allow_origin%3A%60*%60"><span>Censys</span></a>]</td>
</tr><tr><td>distedc[.]com</td>
<td>[<a href="https://www.shodan.io/search?query=http.html_hash%3A-681485527+access-control-allow-origin"><span>Shodan</span></a>, <a href="https://search.censys.io/search?resource=hosts&amp;per_page=25&amp;virtual_hosts=EXCLUDE&amp;q=services.http.response.body_hash%3A%60sha1%3A8490a34ab83d79b3b5f66dbd4484438717b6dca7%60+and+services.http.response.headers.access_control_allow_origin%3A%60*%60"><span>Censys</span></a>]</td>
</tr><tr><td>gosokm[.]com</td>
<td>[<a href="https://www.shodan.io/search?query=http.html_hash%3A430832470+utf-8"><span>Shodan</span></a>, <a href="https://search.censys.io/search?resource=hosts&amp;per_page=25&amp;virtual_hosts=EXCLUDE&amp;q=services.http.response.body_hash%3A%60sha1%3A803f8750b5bb6661d45f4cb52db84567ae8c34b1%60+and+services.http.response.headers.Content_Type%3A%60text%2Fhtml%3B+charset%3Dutf-8%60"><span>Censys</span></a>]</td>
</tr><tr><td>youtubesyncapi[.]com
<p>bity[.]ws</p></td>
<td>[<a href="https://www.shodan.io/search?query=http.html_hash%3A-1826349220+access-control-allow-origin"><span>Shodan</span></a>, <a href="https://search.censys.io/search?resource=hosts&amp;per_page=25&amp;virtual_hosts=EXCLUDE&amp;q=services.http.response.body_hash%3A%60sha1%3A30f7f162d392247afc106a622e9bee9092c2677a%60+and+services.http.response.headers.access_control_allow_origin%3A%60*%60"><span>Censys</span></a>]</td>
</tr></tbody></table><figcaption><p><strong>Table 3: Shodan and Censys fingerprints for Cytrox domains.</strong></p></figcaption></figure>
<p>Of the Shodan and Censys results, we identified several servers that returned HTTP Server headers with the value “Server,” rather than “nginx,” These servers were typically hosted on consumer broadband connections available to local subscribers only, rather than cloud-hosting services that can be procured internationally. We believe that the “Server: Server” IPs on consumer broadband connections are <em>endpoint IPs</em> that indicate locations of customers. We found endpoint IPs in the following countries, so we conclude that these governments are likely among Cytrox’s customers:</p>
<p>Armenia, Egypt, Greece, Indonesia, Madagascar, Oman, Saudi Arabia, Serbia</p>
<p>Scanning also reveals a range of domains used by Cytrox that have country-specific themes, which leads us to suspect that they may be specifically targeted in relation to these countries. We list a subset of these in Table 4.</p>
<figure><table headertable="true"><thead><tr><th><strong>Country Theme</strong></th>
<th><strong>Cytrox Domain</strong></th>
</tr></thead><tbody><tr><td>Egypt</td>
<td>aramexegypt[.]com
<p>almasryelyuom[.]com</p>
<p>alraeesnews[.]net</p>
<p>bank-alahly.com</p>
<p>carrefourmisr[.]com</p>
<p>eg-gov[.]org</p>
<p>egyqaz[.]com</p>
<p>etisalategypt.tech</p>
<p>ikea-egypt[.]net</p>
<p>orangegypt[.]co</p>
<p>sinai-new[.]com</p>
<p>uberegypt.cn[.]com</p>
<p>vodafoneegypt[.]tech</p>
<p>yallakora-egy.com</p>
<p>yuom7[.]net</p></td>
</tr><tr><td>Ivory Coast</td>
<td>adibjan[.]net
<p>politique-koaci[.]info</p></td>
</tr><tr><td>Madagascar</td>
<td>tribune-mg[.]xyz</td>
</tr><tr><td>Mali</td>
<td>actumali[.]org</td>
</tr><tr><td>Saudi Arabia</td>
<td>niceonase[.]com
<p>niceonesa[.]net</p></td>
</tr><tr><td>Serbia</td>
<td>novosti[.]bid
<p>politika[.]bid</p></td>
</tr><tr><td>Trinidad &amp; Tobago</td>
<td>forwardeshoptt[.]com
<p>guardian-tt[.]me</p></td>
</tr></tbody></table><figcaption><p><strong>Table 4: Some Cytrox Predator domains indicating country themes.</strong></p></figcaption></figure>
<p>We additionally identified further domains impersonating popular companies and online sites (Table 5).</p>
<figure><table headertable="true"><thead><tr><th><strong>Legitimate Service</strong></th>
<th><strong>Cytrox Domain</strong></th>
</tr></thead><tbody><tr><td>Apple</td>
<td>applepps[.]com</td>
</tr><tr><td>Fox News</td>
<td>ffoxnewz[.]com</td>
</tr><tr><td>Google Play Store</td>
<td>playestore[.]net</td>
</tr><tr><td>Instagram</td>
<td>instegram[.]co</td>
</tr><tr><td>LinkedIn</td>
<td>lnkedin[.]org</td>
</tr><tr><td>Sephora</td>
<td>sephoragroup[.]com</td>
</tr><tr><td>Tesla Motors</td>
<td>teslal[.]shop
<p>teslal[.]xyz</p></td>
</tr><tr><td>Twitter</td>
<td>twtter[.]net
<p>tw.itter[.]me</p></td>
</tr><tr><td>WhatsApp</td>
<td>wha.tsapp[.]me</td>
</tr><tr><td>XNXX</td>
<td>xnxx-hub[.]com</td>
</tr><tr><td>YouTube</td>
<td>youtu-be[.]net
<p>youtub[.]app</p>
<p>youtubewatch[.]co</p></td>
</tr></tbody></table><figcaption><p><strong>Table 5: Some Cytrox Predator domains impersonating legitimate companies or websites.</strong></p></figcaption></figure>
<h3 id="special-note-predator-after-pegasus-for-saudi-arabia"><strong>Special Note: Predator after Pegasus for Saudi Arabia?</strong></h3>
<p>An IP address in Saudi Arabia appears to have begun matching our Cytrox Predator fingerprints at the end of July 2021, and we classify this IP address as that of a likely Predator customer. NSO Group’s June 30, 2021 transparency report mentions that NSO cut off a client, later reported to be Saudi Arabia by <a href="https://www.nytimes.com/2021/07/17/world/middleeast/israel-saudi-khashoggi-hacking-nso.html"><span>the New York Times</span></a>, apparently in response to the <a href="https://citizenlab.ca/2020/12/the-great-ipwn-journalists-hacked-with-suspected-nso-group-imessage-zero-click-exploit/"><span>revelations of spying on Al Jazeera journalists</span></a>. This may be an indication that Saudi Arabia has switched from Pegasus to Predator.</p>
<h2 id="disclosure-enforcement"><strong>5. Disclosure &amp; Enforcement</strong></h2>
<p>In accordance with the Citizen Lab’s vulnerability disclosure policy, we shared copies of Cytrox Predator forensic artifacts with Apple, which has confirmed to the Citizen Lab that they are investigating. In addition, given the abuse of WhatsApp for Predator targeting, the Citizen Lab shared forensic artifacts with Meta’s security team.</p>
<p>Today, Thursday, December 16th, Meta is taking an enforcement action against Cytrox, which includes removing approximately 300 Facebook and Instagram accounts linked to Cytrox. Their investigation also reveals an extensive list of lookalike domains used as part of social engineering and malware attacks, which are included in <a href="https://about.fb.com/news/2021/12/taking-action-against-surveillance-for-hire/">Appendix A of their report</a>.</p>
<p>The Meta report states that they believe Cytrox customers include entities in Egypt, Armenia, Greece, Saudi Arabia, Oman, Colombia, Côte d’Ivoire, Vietnam, Philippines, and Germany, and that they identified additional abusive targeting initiated by Cytrox customers around the world.</p>
<h2 id="conclusion"><strong>6. Conclusion</strong></h2>
<p>This report is the first investigation to discover Cytrox’s mercenary spyware being abused to target civil society. Remarkably, one of the victims was <em>simultaneously infected</em> with NSO Group’s Pegasus spyware. NSO Group has received outsized publicity in recent years, thanks to a growing customer list, spiraling abuse problems, and groundbreaking investigative work by civil society. Cytrox and its Predator spyware, meanwhile, are relatively unknown.</p>
<p>The targeting of a single individual with both Pegasus and Predator underscores that the practice of hacking civil society transcends any specific mercenary spyware company. Instead, it is a pattern that we expect will persist as long as autocratic governments are able to obtain sophisticated hacking technology. Absent international and domestic regulations and safeguards, journalists, human rights defenders, and opposition groups will continue to be hacked into the foreseeable future.</p>
<h3 id="the-mercenary-spyware-ecosystem"><strong>The Mercenary Spyware Ecosystem</strong></h3>
<p>Both the <a href="https://citizenlab.ca/tag/nso-group/"><span>Citizen Lab</span></a> and Amnesty International’s <a href="https://www.amnesty.org/en/search/NSO%20Group/"><span>Security Lab</span></a> have produced extensive technical reports on NSO Group. While prominent, the mercenary spyware firm was not the first nor is it the only spyware firm of its kind whose technology has been linked to abuse problems. In fact, the <a href="https://www.atlanticcouncil.org/in-depth-research-reports/issue-brief/surveillance-technology-at-the-fair/"><span>market</span></a> for offensive intrusion capabilities is large, varied, and proliferating internationally.</p>
<p>For example, prior to the Citizen Lab’s <a href="https://citizenlab.ca/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/"><span>first report</span></a> on NSO Group in 2016, we documented extensive abuses of <a href="https://citizenlab.ca/2015/03/hacking-team-reloaded-us-based-ethiopian-journalists-targeted-spyware/"><span>Hacking Team</span></a> and <a href="https://citizenlab.ca/2015/10/mapping-finfishers-continuing-proliferation/"><span>FinFisher</span></a> mercenary spyware. (Hacking Team was subsequently rebranded <a href="https://www.vice.com/en/article/xgq3qd/memento-labs-the-reborn-hacking-team-is-struggling"><span>Memento Labs</span></a> in 2019.) In 2017, we published a <a href="https://citizenlab.ca/2017/12/champing-cyberbit-ethiopian-dissidents-targeted-commercial-spyware/"><span>report</span></a> on the spyware firm, Cyberbit, whose technology was used by Ethiopia to mount a global cyber espionage campaign. We also discovered evidence that Cyberbit was marketing its spyware to known human rights abusers, including the Royal Thai Army, the Uzbek secret services, Vietnam, Kazakhstan, Rwanda, Serbia, and Nigeria. Earlier this year, we published a report on yet another spyware firm, <a href="https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/"><span>Candiru</span></a>, with our findings independently corroborated by <a href="https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/"><span>Microsoft</span></a>, <a href="https://blog.google/threat-analysis-group/how-we-protect-users-0-day-attacks/"><span>Google</span></a>, and the <a href="https://www.eset.com/int/about/newsroom/press-releases/research/eset-research-discovers-watering-hole-attacks-on-websites-in-the-middle-east-with-links-to-candiru-s/"><span>threat intelligence team</span></a> at ESET. Candiru was subsequently <a href="https://www.commerce.gov/news/press-releases/2021/11/commerce-adds-nso-group-and-other-foreign-companies-entity-list"><span>designated</span></a> alongside NSO Group on the U.S. Commerce Department’s “entity list” in November 2021 for “malicious cyber activities.”</p>
<p>As evidence continues to surface of new players in the spyware space, the same patterns of abuse will almost certainly persist until the international regulatory environment changes.</p>
<h3 id="structures-to-avoid-accountability"><strong>Structures to Avoid Accountability</strong></h3>
<p>The private intelligence and mercenary surveillance marketplace is marked by <a href="https://www.amnesty.org/en/wp-content/uploads/2021/06/DOC1041822021ENGLISH.pdf"><span>complex ownership structures</span></a>, corporate alliances, and regular rebranding. These practices frustrate investigation, regulation, and accountability. Mercenary spyware companies further evade outside scrutiny by employing complex accounting and incorporation techniques familiar to those used by arms traffickers, money launderers, kleptocrats, and corrupt officials.</p>
<p>As investigative journalists and public interest researchers continue to put a spotlight on mercenary spyware companies, we expect they will continue their efforts to evade scrutiny and accountability.</p>
<h2 id="acknowledgements"><strong>Acknowledgements</strong></h2>
<p>Thanks to to <em>M</em>.<em>S.</em> and Ayman Nour. Citizen Lab investigations depend on victims and targets graciously sharing evidence with us.</p>
<p>Thanks to Meta for investigating this case following our notification and taking enforcement actions, and to Apple.</p>
<p>Thanks to TNG.</p>
<p>Thanks to Amnesty Tech for sharing additional WHOIS details pointing to Intellexa.</p>
<p>Thanks to Team Cymru.</p>
<h2 id="appendix-1-predator-configurations"><strong>Appendix 1: Predator Configurations</strong></h2>
<p><strong>Android Configuration:</strong></p>
<figure><table headertable="true"><thead><tr><th>FS_ENDPOINT</th>
<th>heh</th>
<th>URL component when downloading additional resources</th>
</tr></thead><tbody><tr><td>INS_URL</td>
<td>https[:]//egyqaz[.]com/</td>
<td>Base URL when downloading additional resources</td>
</tr><tr><td>FIN_URL</td>
<td>https[:]//egyqaz[.]com/{}/vmq</td>
<td></td>
</tr><tr><td>DB_STAGE</td>
<td>9</td>
<td></td>
</tr><tr><td>RSA_PKEY</td>
<td>&lt;an RSA public key&gt;</td>
<td></td>
</tr><tr><td>WAIT_TIME</td>
<td>2</td>
<td></td>
</tr><tr><td>P_DIR</td>
<td>/data/local/tmp/wd/</td>
<td>Path to Predator working directory</td>
</tr><tr><td>DB_FILE</td>
<td>/data/local/tmp/wd/fs.db</td>
<td>Path to SQLite database that contains additional tools and Python modules</td>
</tr><tr><td>PE_METHOD</td>
<td>QUAILEGGS</td>
<td>The privilege escalation method to use</td>
</tr><tr><td>INS_CERT</td>
<td>&lt;an x509 cert&gt;</td>
<td></td>
</tr><tr><td>LIBPYTHON_GIT_COMMIT</td>
<td>2b2f6c3</td>
<td>Git commit hash of the project</td>
</tr><tr><td>FS_KEY</td>
<td>&lt;redacted&gt;</td>
<td>Key used to encrypt SQLite database</td>
</tr></tbody></table></figure><p><strong>iOS Configuration:</strong></p>
<figure><table headertable="true"><thead><tr><th><strong>Config Key</strong></th>
<th><strong>Config Value</strong></th>
<th><strong>Notes</strong></th>
</tr></thead><tbody><tr><td>PERSIST_FLAG</td>
<td>persistflag</td>
<td>Persistence boolean toggle</td>
</tr><tr><td>PERSIST</td>
<td>https[:]//youtubesyncapi[.]com/</td>
<td>Persistence domain endpoint</td>
</tr><tr><td>PERSIST_ID</td>
<td>PI112233445566778899EEEEEEDDEEFF</td>
<td>Persistence identifier</td>
</tr><tr><td>INS_URL</td>
<td>https[:]//bity[.]ws</td>
<td>Base URL when downloading additional resources</td>
</tr><tr><td>INP_URL</td>
<td>http[:]//192.168.2[.]1[:]8080</td>
<td></td>
</tr><tr><td>FIN_URL</td>
<td>https[:]//bity[.]ws/{}/finish</td>
<td></td>
</tr><tr><td>DB_STAGE</td>
<td>9</td>
<td></td>
</tr><tr><td>RSA_PKEY</td>
<td>&lt;an RSA public key&gt;</td>
<td></td>
</tr><tr><td>WAIT_TIME</td>
<td>2</td>
<td></td>
</tr><tr><td>P_DIR</td>
<td>/private/var/logs/keybagd/</td>
<td>Path to Predator working directory</td>
</tr><tr><td>DB_FILE</td>
<td>/private/var/logs/keybagd/fs.db</td>
<td>Path to SQLite database that contains additional tools and Python modules</td>
</tr><tr><td>ENC_FILE</td>
<td>/private/var/logs/keybagd/arm64e.encrypted</td>
<td></td>
</tr><tr><td>SHORT_FILE</td>
<td>/private/var/logs/keybagd/Shortcuts.realm</td>
<td>Shortcuts persistence file</td>
</tr><tr><td>SHORT_FILE_LOCK</td>
<td>/private/var/logs/keybagd/Shortcuts.realm.lock</td>
<td></td>
</tr><tr><td>JS_FILE</td>
<td>/private/var/logs/keybagd/jsPayload.js.encrypted</td>
<td></td>
</tr><tr><td>JS_KEY_FILE</td>
<td>/private/var/logs/keybagd/jskey.txt</td>
<td></td>
</tr><tr><td>PRED_KEY_FILE</td>
<td>/private/var/logs/keybagd/predkey.txt</td>
<td></td>
</tr><tr><td>PE_METHOD</td>
<td>NWIOS</td>
<td>The privilege escalation method to use</td>
</tr><tr><td>INS_CERT</td>
<td>&lt;an x509 cert&gt;</td>
<td></td>
</tr><tr><td>LIBPYTHON_GIT_COMMIT</td>
<td>unknown</td>
<td>Git commit hash of the project</td>
</tr><tr><td>FS_KEY</td>
<td>TEST</td>
<td>Key used to encrypt SQLite database</td>
</tr></tbody></table></figure>
                </section>
                                 
              </article> 
						
						
			</section>
		</div></div>
  </body>
</html>
