<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/AaronFriel/qmodem-4.51">Original</a>
    <h1>QModem 4.51 Source Code</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><div dir="auto"><a id="user-content-qmodem-451-source-code" aria-label="Permalink: QModem 4.51 Source Code" href="#qmodem-451-source-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">The source code release of <strong>QModem 4.51</strong>, an MS-DOS telecommunications program authored by John Friel III (1960–2024). This source snapshot reflects the state of QModem &#34;Test-Drive&#34; edition, version 4.51, as it existed in early 1992. The release is presented in the hope it may prove valuable as a historical artifact, for telecommunications enthusiasts, retrocomputing hobbyists, or anyone interested in the inner workings of a classic DOS comms package.</p>
<p dir="auto">QModem was a widely-used terminal communications program for MS-DOS, supporting a rich array of modem protocols, scripting, user customization, modem auto-configuration, and even a &#34;Host Mode&#34; for basic BBS-like operation.</p>
<hr/>
<div dir="auto"><h2 tabindex="-1" dir="auto">Historical Overview</h2><a id="user-content-historical-overview" aria-label="Permalink: Historical Overview" href="#historical-overview"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>QModem</strong> was developed throughout the 1980s and early 1990s as a competitor to programs such as Procomm, Telix, and others. It provided robust support for:</p>
<ul dir="auto">
<li>Many modem speeds and hardware types (8250, 16450, 16550 UARTs, and special hardware)</li>
<li>Internal and external file transfer protocols: XMODEM, YMODEM, ZMODEM, and user-defined protocol support via external drivers</li>
<li>Full-screen dialing directory (the <code>.FON</code> phonebook)</li>
<li>Extensive scripting and automation via its built-in script language</li>
<li>In-program configuration via a full-featured setup menu (<code>Alt-N</code>)</li>
<li>ANSI/VT100/TTY/Avatar terminal emulations</li>
<li>Host Mode: a mini BBS server included in the client!</li>
<li>Scrollback buffer, split screen terminal</li>
<li>Mouse support, custom keyboard macros, and more</li>
</ul>
<hr/>
<div dir="auto"><h2 tabindex="-1" dir="auto">File Layout and Project Structure</h2><a id="user-content-file-layout-and-project-structure" aria-label="Permalink: File Layout and Project Structure" href="#file-layout-and-project-structure"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This repository contains the complete Turbo Pascal source code, as well as supporting assembler, batch, and utility files.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Main Directories and Files</h3><a id="user-content-main-directories-and-files" aria-label="Permalink: Main Directories and Files" href="#main-directories-and-files"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><strong>.PAS</strong> — Turbo Pascal source files implementing the main program, modules, and utilities</li>
<li><strong>.ASM</strong> — x86 assembler routines for performance-critical sections and hardware interfacing</li>
<li><strong>.BAT</strong> — DOS batch files for building, testing, and packaging</li>
<li><strong>.OBJ, .INC</strong> — Included binaries and Pascal include files</li>
<li><strong>.KEY, .FON, .CNF, etc.</strong> — Sample data, key, configuration, or phonebook files</li>
</ul>
<p dir="auto">Significant modules include:</p>
<ul dir="auto">
<li><code>QMODEM.PAS</code> — Main entry point</li>
<li><code>QMMAIN.PAS</code> — Main application logic</li>
<li><code>INITIAL.PAS</code> — Global configuration, terminal, and comm settings</li>
<li><code>COMM.PAS</code> / <code>COMM2.PAS</code> — Serial communications support</li>
<li><code>DOWNLD*.PAS</code> / <code>UPLD*.PAS</code> — File transfer protocol implementations</li>
<li><code>TP*</code>, <code>OP*</code> — Support code, likely Turbo Professional or custom libraries</li>
<li><code>HOST.PAS</code> — Host Mode/BBS functionality</li>
<li><code>FONESTUF.PAS</code>, <code>QDIAL.PAS</code>, etc. — Dialing directory and phonebook features</li>
<li><code>SCRIPTS*.PAS</code> — Script engine and automation</li>
<li><code>INSTALL*.PAS</code>, <code>QINSTALL.PAS</code>, <code>RUNQINST.PAS</code> — On-disk configuration and setup utility</li>
</ul>
<hr/>
<div dir="auto"><h2 tabindex="-1" dir="auto">Building QModem</h2><a id="user-content-building-qmodem" aria-label="Permalink: Building QModem" href="#building-qmodem"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>This is a historical codebase.</strong> QModem 4.51 targets MS-DOS using Turbo Pascal 5.x/6.0, with Turbo Professional and potentially other Borland or third-party libraries.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Potential Build Approaches</h3><a id="user-content-potential-build-approaches" aria-label="Permalink: Potential Build Approaches" href="#potential-build-approaches"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto"><strong>Turbo Pascal 5.5/6.0</strong> (MS-DOS or DOSBox): This is almost certainly the original toolchain. If you have a copy, opening <code>QMODEM.PAS</code> as the project and compiling (after possibly setting appropriate memory and overlay paths) may work. Some makefiles or batch files, e.g. <code>BUILD.BAT</code>, may be helpful, but will need adaptation to your environment.</p>
</li>
<li>
<p dir="auto"><strong>TP/BP Emulation or Cross-Compilers</strong>: <a href="https://www.freepascal.org/" rel="nofollow">Free Pascal</a> includes some support for Turbo Pascal compatibility, but differences are likely extensive (including use of inline assembler, overlays, and third-party libraries).</p>
</li>
<li>
<p dir="auto"><strong>Turbo Professional &amp; Dependencies</strong>: Many of the <code>TP*</code> units (e.g. <code>TpDos</code>, <code>TpCrt</code>, etc.) are from the <a href="https://en.wikipedia.org/wiki/Turbo_Professional" rel="nofollow">Turbo Professional library</a>. You&#39;ll need the corresponding TPUs and sources for your compiler version.</p>
</li>
<li>
<p dir="auto"><strong>Manual Assembly of .ASM Files</strong>: Assembler files need to be assembled (e.g. with TURBO assembler or MASM) and linked or compiled as .OBJ for use with Turbo Pascal.</p>
</li>
<li>
<p dir="auto"><strong>Overlay Management</strong>: Note the project extensively uses Borland/Turbo Pascal overlays (<code>.OVR</code> files, see <code>OVR01.INC</code> and overlay units). Disk layout and path settings for overlays must be matched as the original program expects.</p>
</li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">Build Scripts</h4><a id="user-content-build-scripts" aria-label="Permalink: Build Scripts" href="#build-scripts"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Several build-automation batch files are included, such as:</p>
<ul dir="auto">
<li><code>BUILD.BAT</code></li>
<li><code>BUILDOVR.BAT</code></li>
<li><code>BUG.BAT</code></li>
<li><code>DEBUGOVR.BAT</code></li>
</ul>
<p dir="auto">Inspect and adapt these scripts as necessary for your own environment.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Modernization Caveats</h3><a id="user-content-modernization-caveats" aria-label="Permalink: Modernization Caveats" href="#modernization-caveats"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><strong>No supported modern environment</strong> targets this code directly. Efforts to port or run on anything but MS-DOS/Turbo Pascal 5.x/6.x are purely experimental and will require code and/or dependency adaptation.</li>
<li><strong>Third-party libraries</strong> (Turbo Professional, OpKey, possibly others) are required.</li>
<li><strong>Hardware-dependence</strong>: Much code assumes direct access to PC hardware, BIOS, and serial port interrupts.</li>
<li><strong>Overlay management</strong>: The overlay system (<code>OVERLAY.PAS</code>, etc.) must be supported as originally intended.</li>
</ul>
<hr/>
<div dir="auto"><h2 tabindex="-1" dir="auto">Usage</h2><a id="user-content-usage" aria-label="Permalink: Usage" href="#usage"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This repository is for study, education, restoration, and historical curiosity. See the original QModem documentation (not included here) for user guidance. The commands, batch files, and source code reflect MS-DOS conventions and expectations.</p>
<hr/>
<p dir="auto"><strong>John Friel III, 1960–2024</strong></p>
</article></div></div>
  </body>
</html>
