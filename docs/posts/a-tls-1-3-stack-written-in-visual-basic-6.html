<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/wqweto/VbAsyncSocket/blob/master/src/mdTlsThunks.bas">Original</a>
    <h1>A TLS 1.3 stack written in Visual Basic 6</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Visual Basic 6.0" data-tagsearch-path="src/mdTlsThunks.bas">
        <tbody><tr>
          <td id="L1" data-line-number="1"></td>
          <td id="LC1"><span>Attribute</span> <span>VB_Name</span> <span>=</span> <span>&#34;mdTlsThunks&#34;</span></td>
        </tr>
        <tr>
          <td id="L2" data-line-number="2"></td>
          <td id="LC2"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L3" data-line-number="3"></td>
          <td id="LC3"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L4" data-line-number="4"></td>
          <td id="LC4"><span>&#39; VbAsyncSocket Project (c) 2018-2023 by wqweto@gmail.com</span></td>
        </tr>
        <tr>
          <td id="L5" data-line-number="5"></td>
          <td id="LC5"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L6" data-line-number="6"></td>
          <td id="LC6"><span>&#39; Simple and thin WinSock API wrappers for VB6</span></td>
        </tr>
        <tr>
          <td id="L7" data-line-number="7"></td>
          <td id="LC7"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L8" data-line-number="8"></td>
          <td id="LC8"><span>&#39; This project is licensed under the terms of the MIT license</span></td>
        </tr>
        <tr>
          <td id="L9" data-line-number="9"></td>
          <td id="LC9"><span>&#39; See the LICENSE file in the project root for more information</span></td>
        </tr>
        <tr>
          <td id="L10" data-line-number="10"></td>
          <td id="LC10"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L11" data-line-number="11"></td>
          <td id="LC11"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L12" data-line-number="12"></td>
          <td id="LC12"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L13" data-line-number="13"></td>
          <td id="LC13"><span>&#39; Based on RFC 8446 at https://tools.ietf.org/html/rfc8446</span></td>
        </tr>
        <tr>
          <td id="L14" data-line-number="14"></td>
          <td id="LC14"><span>&#39;   and illustrated traffic-dump at https://tls13.ulfheim.net/</span></td>
        </tr>
        <tr>
          <td id="L15" data-line-number="15"></td>
          <td id="LC15"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L16" data-line-number="16"></td>
          <td id="LC16"><span>&#39; More TLS 1.3 implementations at https://github.com/h2o/picotls</span></td>
        </tr>
        <tr>
          <td id="L17" data-line-number="17"></td>
          <td id="LC17"><span>&#39;   and https://github.com/openssl/openssl</span></td>
        </tr>
        <tr>
          <td id="L18" data-line-number="18"></td>
          <td id="LC18"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L19" data-line-number="19"></td>
          <td id="LC19"><span>&#39; Additional links with TLS 1.3 resources</span></td>
        </tr>
        <tr>
          <td id="L20" data-line-number="20"></td>
          <td id="LC20"><span>&#39;   https://github.com/tlswg/tls13-spec/wiki/Implementations</span></td>
        </tr>
        <tr>
          <td id="L21" data-line-number="21"></td>
          <td id="LC21"><span>&#39;   https://sans-io.readthedocs.io/how-to-sans-io.html</span></td>
        </tr>
        <tr>
          <td id="L22" data-line-number="22"></td>
          <td id="LC22"><span>&#39;   https://www.davidwong.fr/tls13</span></td>
        </tr>
        <tr>
          <td id="L23" data-line-number="23"></td>
          <td id="LC23"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L24" data-line-number="24"></td>
          <td id="LC24"><span>&#39; Some of the cryptographic thunks are based on the following sources</span></td>
        </tr>
        <tr>
          <td id="L25" data-line-number="25"></td>
          <td id="LC25"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L26" data-line-number="26"></td>
          <td id="LC26"><span>&#39;  1. https://github.com/esxgx/easy-ecc by Kenneth MacKay</span></td>
        </tr>
        <tr>
          <td id="L27" data-line-number="27"></td>
          <td id="LC27"><span>&#39;     which is distributed under the BSD 2-clause license</span></td>
        </tr>
        <tr>
          <td id="L28" data-line-number="28"></td>
          <td id="LC28"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L29" data-line-number="29"></td>
          <td id="LC29"><span>&#39;  2. https://github.com/ctz/cifra by Joseph Birr-Pixton</span></td>
        </tr>
        <tr>
          <td id="L30" data-line-number="30"></td>
          <td id="LC30"><span>&#39;     CC0 1.0 Universal license (Public Domain Dedication)</span></td>
        </tr>
        <tr>
          <td id="L31" data-line-number="31"></td>
          <td id="LC31"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L32" data-line-number="32"></td>
          <td id="LC32"><span>&#39;  3. https://github.com/github/putty by Simon Tatham</span></td>
        </tr>
        <tr>
          <td id="L33" data-line-number="33"></td>
          <td id="LC33"><span>&#39;     which is distributed under the MIT licence</span></td>
        </tr>
        <tr>
          <td id="L34" data-line-number="34"></td>
          <td id="LC34"><span>&#39;</span></td>
        </tr>
        <tr>
          <td id="L35" data-line-number="35"></td>
          <td id="LC35"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L36" data-line-number="36"></td>
          <td id="LC36"><span>Option Explicit</span></td>
        </tr>
        <tr>
          <td id="L37" data-line-number="37"></td>
          <td id="LC37"><span>DefObj</span> <span>A-Z</span></td>
        </tr>
        <tr>
          <td id="L38" data-line-number="38"></td>
          <td id="LC38"><span>Private</span> <span>Const</span> <span>MODULE_NAME</span> <span>As</span> <span>String</span> <span>=</span> <span>&#34;mdTlsThunks&#34;</span></td>
        </tr>
        <tr>
          <td id="L39" data-line-number="39"></td>
          <td id="LC39">
</td>
        </tr>
        <tr>
          <td id="L40" data-line-number="40"></td>
          <td id="LC40"><span>#</span><span>Const</span> <span>ImplTlsServer</span> <span>=</span> <span>(ASYNCSOCKET_NO_TLSSERVER</span> <span>=</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L41" data-line-number="41"></td>
          <td id="LC41"><span>#</span><span>Const</span> <span>ImplUseShared</span> <span>=</span> <span>(ASYNCSOCKET_USE_SHARED</span> <span>&lt;&gt;</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L42" data-line-number="42"></td>
          <td id="LC42"><span>#</span><span>Const</span> <span>ImplUseDebugLog</span> <span>=</span> <span>(USE_DEBUG_LOG</span> <span>&lt;&gt;</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L43" data-line-number="43"></td>
          <td id="LC43"><span>#</span><span>Const</span> <span>ImplCaptureTraffic</span> <span>=</span> <span>CLng</span><span>(ASYNCSOCKET_CAPTURE_TRAFFIC)</span> <span>&#39;--- bitmask: 1 - traffic, 2 - derived secrets</span></td>
        </tr>
        <tr>
          <td id="L44" data-line-number="44"></td>
          <td id="LC44"><span>#</span><span>Const</span> <span>ImplExoticCiphers</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L45" data-line-number="45"></td>
          <td id="LC45"><span>#</span><span>Const</span> <span>ImplTlsServerAllowInsecureRenegotiation</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L46" data-line-number="46"></td>
          <td id="LC46"><span>#</span><span>Const</span> <span>ImplTestCrypto</span> <span>=</span> <span>(ASYNCSOCKET_TEST_CRYPTO</span> <span>&lt;&gt;</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L47" data-line-number="47"></td>
          <td id="LC47">
</td>
        </tr>
        <tr>
          <td id="L48" data-line-number="48"></td>
          <td id="LC48"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L49" data-line-number="49"></td>
          <td id="LC49"><span>&#39; API</span></td>
        </tr>
        <tr>
          <td id="L50" data-line-number="50"></td>
          <td id="LC50"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L51" data-line-number="51"></td>
          <td id="LC51">
</td>
        </tr>
        <tr>
          <td id="L52" data-line-number="52"></td>
          <td id="LC52"><span>&#39;--- for thunks</span></td>
        </tr>
        <tr>
          <td id="L53" data-line-number="53"></td>
          <td id="LC53"><span>Private</span> <span>Const</span> <span>MEM_COMMIT</span>                                <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1000</span></td>
        </tr>
        <tr>
          <td id="L54" data-line-number="54"></td>
          <td id="LC54"><span>Private</span> <span>Const</span> <span>PAGE_EXECUTE_READWRITE</span>                    <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H40</span></td>
        </tr>
        <tr>
          <td id="L55" data-line-number="55"></td>
          <td id="LC55"><span>Private</span> <span>Const</span> <span>PTR_SIZE</span>                                  <span>As</span> <span>Long</span> <span>=</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L56" data-line-number="56"></td>
          <td id="LC56"><span>&#39;--- for CryptAcquireContext</span></td>
        </tr>
        <tr>
          <td id="L57" data-line-number="57"></td>
          <td id="LC57"><span>Private</span> <span>Const</span> <span>PROV_RSA_FULL</span>                             <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L58" data-line-number="58"></td>
          <td id="LC58"><span>Private</span> <span>Const</span> <span>PROV_RSA_AES</span>                              <span>As</span> <span>Long</span> <span>=</span> <span>24</span></td>
        </tr>
        <tr>
          <td id="L59" data-line-number="59"></td>
          <td id="LC59"><span>Private</span> <span>Const</span> <span>CRYPT_VERIFYCONTEXT</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HF0000000</span></td>
        </tr>
        <tr>
          <td id="L60" data-line-number="60"></td>
          <td id="LC60"><span>&#39;--- for CryptDecodeObjectEx</span></td>
        </tr>
        <tr>
          <td id="L61" data-line-number="61"></td>
          <td id="LC61"><span>Private</span> <span>Const</span> <span>X509_ASN_ENCODING</span>                         <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L62" data-line-number="62"></td>
          <td id="LC62"><span>Private</span> <span>Const</span> <span>PKCS_7_ASN_ENCODING</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H10000</span></td>
        </tr>
        <tr>
          <td id="L63" data-line-number="63"></td>
          <td id="LC63"><span>Private</span> <span>Const</span> <span>PKCS_RSA_PRIVATE_KEY</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>43</span></td>
        </tr>
        <tr>
          <td id="L64" data-line-number="64"></td>
          <td id="LC64"><span>Private</span> <span>Const</span> <span>PKCS_PRIVATE_KEY_INFO</span>                     <span>As</span> <span>Long</span> <span>=</span> <span>44</span></td>
        </tr>
        <tr>
          <td id="L65" data-line-number="65"></td>
          <td id="LC65"><span>Private</span> <span>Const</span> <span>X509_PUBLIC_KEY_INFO</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L66" data-line-number="66"></td>
          <td id="LC66"><span>Private</span> <span>Const</span> <span>X509_ECC_PRIVATE_KEY</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>82</span></td>
        </tr>
        <tr>
          <td id="L67" data-line-number="67"></td>
          <td id="LC67"><span>Private</span> <span>Const</span> <span>CRYPT_DECODE_NOCOPY_FLAG</span>                  <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1</span></td>
        </tr>
        <tr>
          <td id="L68" data-line-number="68"></td>
          <td id="LC68"><span>Private</span> <span>Const</span> <span>CRYPT_DECODE_ALLOC_FLAG</span>                   <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H8000</span></td>
        </tr>
        <tr>
          <td id="L69" data-line-number="69"></td>
          <td id="LC69"><span>Private</span> <span>Const</span> <span>ERROR_FILE_NOT_FOUND</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L70" data-line-number="70"></td>
          <td id="LC70"><span>&#39;--- for CryptExportKey</span></td>
        </tr>
        <tr>
          <td id="L71" data-line-number="71"></td>
          <td id="LC71"><span>Private</span> <span>Const</span> <span>PUBLICKEYBLOB</span>                             <span>As</span> <span>Long</span> <span>=</span> <span>6</span></td>
        </tr>
        <tr>
          <td id="L72" data-line-number="72"></td>
          <td id="LC72"><span>&#39;--- for CryptCreateHash</span></td>
        </tr>
        <tr>
          <td id="L73" data-line-number="73"></td>
          <td id="LC73"><span>Private</span> <span>Const</span> <span>CALG_SSL3_SHAMD5</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H8008</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L74" data-line-number="74"></td>
          <td id="LC74"><span>Private</span> <span>Const</span> <span>CALG_SHA1</span>                                 <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H8004</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L75" data-line-number="75"></td>
          <td id="LC75"><span>Private</span> <span>Const</span> <span>CALG_SHA_256</span>                              <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H800C</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L76" data-line-number="76"></td>
          <td id="LC76"><span>Private</span> <span>Const</span> <span>CALG_SHA_384</span>                              <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H800D</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L77" data-line-number="77"></td>
          <td id="LC77"><span>Private</span> <span>Const</span> <span>CALG_SHA_512</span>                              <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H800E</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L78" data-line-number="78"></td>
          <td id="LC78"><span>Private</span> <span>Const</span> <span>HP_HASHVAL</span>                                <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L79" data-line-number="79"></td>
          <td id="LC79"><span>Private</span> <span>Const</span> <span>HP_HASHSIZE</span>                               <span>As</span> <span>Long</span> <span>=</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L80" data-line-number="80"></td>
          <td id="LC80"><span>&#39;--- for NCryptSignHash</span></td>
        </tr>
        <tr>
          <td id="L81" data-line-number="81"></td>
          <td id="LC81"><span>Private</span> <span>Const</span> <span>BCRYPT_PAD_PKCS1</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H2</span></td>
        </tr>
        <tr>
          <td id="L82" data-line-number="82"></td>
          <td id="LC82"><span>Private</span> <span>Const</span> <span>BCRYPT_PAD_PSS</span>                            <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H8</span></td>
        </tr>
        <tr>
          <td id="L83" data-line-number="83"></td>
          <td id="LC83"><span>&#39;--- for NCryptDecrypt</span></td>
        </tr>
        <tr>
          <td id="L84" data-line-number="84"></td>
          <td id="LC84"><span>Private</span> <span>Const</span> <span>NCRYPT_PAD_PKCS1_FLAG</span>                     <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H2</span></td>
        </tr>
        <tr>
          <td id="L85" data-line-number="85"></td>
          <td id="LC85"><span>&#39;--- OIDs</span></td>
        </tr>
        <tr>
          <td id="L86" data-line-number="86"></td>
          <td id="LC86"><span>Private</span> <span>Const</span> <span>szOID_RSA_RSA</span>                             <span>As</span> <span>String</span> <span>=</span> <span>&#34;1.2.840.113549.1.1.1&#34;</span></td>
        </tr>
        <tr>
          <td id="L87" data-line-number="87"></td>
          <td id="LC87"><span>Private</span> <span>Const</span> <span>szOID_RSA_SSA_PSS</span>                         <span>As</span> <span>String</span> <span>=</span> <span>&#34;1.2.840.113549.1.1.10&#34;</span></td>
        </tr>
        <tr>
          <td id="L88" data-line-number="88"></td>
          <td id="LC88"><span>Private</span> <span>Const</span> <span>szOID_ECC_PUBLIC_KEY</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;1.2.840.10045.2.1&#34;</span></td>
        </tr>
        <tr>
          <td id="L89" data-line-number="89"></td>
          <td id="LC89"><span>Private</span> <span>Const</span> <span>szOID_ECC_CURVE_P256</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;1.2.840.10045.3.1.7&#34;</span></td>
        </tr>
        <tr>
          <td id="L90" data-line-number="90"></td>
          <td id="LC90"><span>Private</span> <span>Const</span> <span>szOID_ECC_CURVE_P384</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;1.3.132.0.34&#34;</span></td>
        </tr>
        <tr>
          <td id="L91" data-line-number="91"></td>
          <td id="LC91"><span>Private</span> <span>Const</span> <span>szOID_ECC_CURVE_P521</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;1.3.132.0.35&#34;</span></td>
        </tr>
        <tr>
          <td id="L92" data-line-number="92"></td>
          <td id="LC92">
</td>
        </tr>
        <tr>
          <td id="L93" data-line-number="93"></td>
          <td id="LC93"><span>Private</span> <span>Declare</span> <span>Sub</span> <span>CopyMemory</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>Alias</span> <span>&#34;RtlMoveMemory&#34;</span> <span>(Destination</span> <span>As</span> <span>Any,</span> <span>Source</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>Length</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L94" data-line-number="94"></td>
          <td id="LC94"><span>Private</span> <span>Declare</span> <span>Sub</span> <span>FillMemory</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>Alias</span> <span>&#34;RtlFillMemory&#34;</span> <span>(Destination</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>Length</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>Fill</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L95" data-line-number="95"></td>
          <td id="LC95"><span>Private</span> <span>Declare</span> <span>Function</span> <span>IsBadReadPtr</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>(</span><span>ByVal</span> <span>lp</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>ucb</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L96" data-line-number="96"></td>
          <td id="LC96"><span>Private</span> <span>Declare</span> <span>Function</span> <span>VirtualAlloc</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>(</span><span>ByVal</span> <span>lpAddress</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwSize</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>flAllocationType</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>flProtect</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L97" data-line-number="97"></td>
          <td id="LC97"><span>Private</span> <span>Declare</span> <span>Function</span> <span>VirtualProtect</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>(</span><span>ByVal</span> <span>lpAddress</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwSize</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>flNewProtect</span> <span>As</span> <span>Long</span><span>,</span> <span>ByRef</span> <span>lpflOldProtect</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L98" data-line-number="98"></td>
          <td id="LC98"><span>Private</span> <span>Declare</span> <span>Function</span> <span>GetModuleHandle</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>Alias</span> <span>&#34;GetModuleHandleW&#34;</span> <span>(</span><span>ByVal</span> <span>lpModuleName</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L99" data-line-number="99"></td>
          <td id="LC99"><span>Private</span> <span>Declare</span> <span>Function</span> <span>GetProcAddress</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>(</span><span>ByVal</span> <span>hModule</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lpProcName</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L100" data-line-number="100"></td>
          <td id="LC100"><span>Private</span> <span>Declare</span> <span>Function</span> <span>lstrlenA</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>(</span><span>ByVal</span> <span>lpStr</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L101" data-line-number="101"></td>
          <td id="LC101"><span>Private</span> <span>Declare</span> <span>Function</span> <span>LocalFree</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>(</span><span>ByVal</span> <span>hMem</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L102" data-line-number="102"></td>
          <td id="LC102"><span>Private</span> <span>Declare</span> <span>Function</span> <span>GetEnvironmentVariable</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>Alias</span> <span>&#34;GetEnvironmentVariableW&#34;</span> <span>(</span><span>ByVal</span> <span>lpName</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lpBuffer</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>nSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L103" data-line-number="103"></td>
          <td id="LC103"><span>Private</span> <span>Declare</span> <span>Function</span> <span>GetVersionEx</span> <span>Lib</span> <span>&#34;kernel32&#34;</span> <span>Alias</span> <span>&#34;GetVersionExW&#34;</span> <span>(lpVersionInformation</span> <span>As</span> <span>Any)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L104" data-line-number="104"></td>
          <td id="LC104"><span>&#39;--- msvbvm60</span></td>
        </tr>
        <tr>
          <td id="L105" data-line-number="105"></td>
          <td id="LC105"><span>Private</span> <span>Declare</span> <span>Function</span> <span>ArrPtr</span> <span>Lib</span> <span>&#34;msvbvm60&#34;</span> <span>Alias</span> <span>&#34;VarPtr&#34;</span> <span>(Ptr()</span> <span>As</span> <span>Any)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L106" data-line-number="106"></td>
          <td id="LC106"><span>Private</span> <span>Declare</span> <span>Function</span> <span>vbaObjSetAddref</span> <span>Lib</span> <span>&#34;msvbvm60&#34;</span> <span>Alias</span> <span>&#34;__vbaObjSetAddref&#34;</span> <span>(oDest</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>lSrcPtr</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L107" data-line-number="107"></td>
          <td id="LC107"><span>&#39;--- advapi32</span></td>
        </tr>
        <tr>
          <td id="L108" data-line-number="108"></td>
          <td id="LC108"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptAcquireContext</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>Alias</span> <span>&#34;CryptAcquireContextW&#34;</span> <span>(phProv</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pszContainer</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pszProvider</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwProvType</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L109" data-line-number="109"></td>
          <td id="LC109"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptReleaseContext</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hProv</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L110" data-line-number="110"></td>
          <td id="LC110"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptGenRandom</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hProv</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwLen</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pbBuffer</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L111" data-line-number="111"></td>
          <td id="LC111"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptDestroyKey</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hKey</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L112" data-line-number="112"></td>
          <td id="LC112"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptExportKey</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hKey</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>hExpKey</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwBlobType</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>,</span> <span>pbData</span> <span>As</span> <span>Any,</span> <span>pdwDataLen</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L113" data-line-number="113"></td>
          <td id="LC113"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptCreateHash</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hProv</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>AlgId</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>hKey</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>,</span> <span>phHash</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L114" data-line-number="114"></td>
          <td id="LC114"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptDestroyHash</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hHash</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L115" data-line-number="115"></td>
          <td id="LC115"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptHashData</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hHash</span> <span>As</span> <span>Long</span><span>,</span> <span>pbData</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>dwDataLen</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L116" data-line-number="116"></td>
          <td id="LC116"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptGetHashParam</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hHash</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwParam</span> <span>As</span> <span>Long</span><span>,</span> <span>pbData</span> <span>As</span> <span>Any,</span> <span>pdwDataLen</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L117" data-line-number="117"></td>
          <td id="LC117"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptSetHashParam</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hHash</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwParam</span> <span>As</span> <span>Long</span><span>,</span> <span>pbData</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L118" data-line-number="118"></td>
          <td id="LC118"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptGetUserKey</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hProv</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwKeySpec</span> <span>As</span> <span>Long</span><span>,</span> <span>phUserKey</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L119" data-line-number="119"></td>
          <td id="LC119"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptSignHash</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>Alias</span> <span>&#34;CryptSignHashW&#34;</span> <span>(</span><span>ByVal</span> <span>hHash</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwKeySpec</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>szDescription</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>,</span> <span>pbSignature</span> <span>As</span> <span>Any,</span> <span>pdwSigLen</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L120" data-line-number="120"></td>
          <td id="LC120"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptDecrypt</span> <span>Lib</span> <span>&#34;advapi32&#34;</span> <span>(</span><span>ByVal</span> <span>hKey</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>hHash</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>Final</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>,</span> <span>pbData</span> <span>As</span> <span>Any,</span> <span>pdwDataLen</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L121" data-line-number="121"></td>
          <td id="LC121"><span>&#39;--- Crypt32</span></td>
        </tr>
        <tr>
          <td id="L122" data-line-number="122"></td>
          <td id="LC122"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptImportPublicKeyInfo</span> <span>Lib</span> <span>&#34;crypt32&#34;</span> <span>(</span><span>ByVal</span> <span>hCryptProv</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwCertEncodingType</span> <span>As</span> <span>Long</span><span>,</span> <span>pInfo</span> <span>As</span> <span>Any,</span> <span>phKey</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L123" data-line-number="123"></td>
          <td id="LC123"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CryptDecodeObjectEx</span> <span>Lib</span> <span>&#34;crypt32&#34;</span> <span>(</span><span>ByVal</span> <span>dwCertEncodingType</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lpszStructType</span> <span>As</span> <span>Any,</span> <span>pbEncoded</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>cbEncoded</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pDecodePara</span> <span>As</span> <span>Long</span><span>,</span> <span>pvStructInfo</span> <span>As</span> <span>Any,</span> <span>pcbStructInfo</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L124" data-line-number="124"></td>
          <td id="LC124"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CertCreateCertificateContext</span> <span>Lib</span> <span>&#34;crypt32&#34;</span> <span>(</span><span>ByVal</span> <span>dwCertEncodingType</span> <span>As</span> <span>Long</span><span>,</span> <span>pbCertEncoded</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>cbCertEncoded</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L125" data-line-number="125"></td>
          <td id="LC125"><span>Private</span> <span>Declare</span> <span>Function</span> <span>CertFreeCertificateContext</span> <span>Lib</span> <span>&#34;crypt32&#34;</span> <span>(</span><span>ByVal</span> <span>pCertContext</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L126" data-line-number="126"></td>
          <td id="LC126"><span>&#39;--- NCrypt</span></td>
        </tr>
        <tr>
          <td id="L127" data-line-number="127"></td>
          <td id="LC127"><span>Private</span> <span>Declare</span> <span>Function</span> <span>NCryptOpenStorageProvider</span> <span>Lib</span> <span>&#34;ncrypt&#34;</span> <span>(phProvider</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pszProviderName</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L128" data-line-number="128"></td>
          <td id="LC128"><span>Private</span> <span>Declare</span> <span>Function</span> <span>NCryptOpenKey</span> <span>Lib</span> <span>&#34;ncrypt&#34;</span> <span>(</span><span>ByVal</span> <span>hProvider</span> <span>As</span> <span>Long</span><span>,</span> <span>phKey</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pszKeyName</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwLegacyKeySpec</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L129" data-line-number="129"></td>
          <td id="LC129"><span>Private</span> <span>Declare</span> <span>Function</span> <span>NCryptSignHash</span> <span>Lib</span> <span>&#34;ncrypt&#34;</span> <span>(</span><span>ByVal</span> <span>hKey</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pPaddingInfo</span> <span>As</span> <span>Long</span><span>,</span> <span>pbHashValue</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>cbHashValue</span> <span>As</span> <span>Long</span><span>,</span> <span>pbSignature</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>cbSignature</span> <span>As</span> <span>Long</span><span>,</span> <span>pcbResult</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L130" data-line-number="130"></td>
          <td id="LC130"><span>Private</span> <span>Declare</span> <span>Function</span> <span>NCryptDecrypt</span> <span>Lib</span> <span>&#34;ncrypt&#34;</span> <span>(</span><span>ByVal</span> <span>hKey</span> <span>As</span> <span>Long</span><span>,</span> <span>pbInput</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>cbInput</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>pPaddingInfo</span> <span>As</span> <span>Long</span><span>,</span> <span>pbOutput</span> <span>As</span> <span>Any,</span> <span>ByVal</span> <span>cbOutput</span> <span>As</span> <span>Long</span><span>,</span> <span>pcbResult</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>dwFlags</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L131" data-line-number="131"></td>
          <td id="LC131"><span>Private</span> <span>Declare</span> <span>Function</span> <span>NCryptFreeObject</span> <span>Lib</span> <span>&#34;ncrypt&#34;</span> <span>(</span><span>ByVal</span> <span>hObject</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L132" data-line-number="132"></td>
          <td id="LC132">
</td>
        </tr>
        <tr>
          <td id="L133" data-line-number="133"></td>
          <td id="LC133"><span>Private</span> <span>Type</span> <span>CRYPT_DATA_BLOB</span></td>
        </tr>
        <tr>
          <td id="L134" data-line-number="134"></td>
          <td id="LC134">    <span>cbData</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L135" data-line-number="135"></td>
          <td id="LC135">    <span>pbData</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L136" data-line-number="136"></td>
          <td id="LC136"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L137" data-line-number="137"></td>
          <td id="LC137">
</td>
        </tr>
        <tr>
          <td id="L138" data-line-number="138"></td>
          <td id="LC138"><span>Private</span> <span>Type</span> <span>CRYPT_BIT_BLOB</span></td>
        </tr>
        <tr>
          <td id="L139" data-line-number="139"></td>
          <td id="LC139">    <span>cbData</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L140" data-line-number="140"></td>
          <td id="LC140">    <span>pbData</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L141" data-line-number="141"></td>
          <td id="LC141">    <span>cUnusedBits</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L142" data-line-number="142"></td>
          <td id="LC142"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L143" data-line-number="143"></td>
          <td id="LC143">
</td>
        </tr>
        <tr>
          <td id="L144" data-line-number="144"></td>
          <td id="LC144"><span>Private</span> <span>Type</span> <span>CRYPT_ALGORITHM_IDENTIFIER</span></td>
        </tr>
        <tr>
          <td id="L145" data-line-number="145"></td>
          <td id="LC145">    <span>pszObjId</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L146" data-line-number="146"></td>
          <td id="LC146">    <span>Parameters</span>          <span>As</span> <span>CRYPT_DATA_BLOB</span></td>
        </tr>
        <tr>
          <td id="L147" data-line-number="147"></td>
          <td id="LC147"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L148" data-line-number="148"></td>
          <td id="LC148">
</td>
        </tr>
        <tr>
          <td id="L149" data-line-number="149"></td>
          <td id="LC149"><span>Private</span> <span>Type</span> <span>CERT_PUBLIC_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L150" data-line-number="150"></td>
          <td id="LC150">    <span>Algorithm</span>           <span>As</span> <span>CRYPT_ALGORITHM_IDENTIFIER</span></td>
        </tr>
        <tr>
          <td id="L151" data-line-number="151"></td>
          <td id="LC151">    <span>PublicKey</span>           <span>As</span> <span>CRYPT_BIT_BLOB</span></td>
        </tr>
        <tr>
          <td id="L152" data-line-number="152"></td>
          <td id="LC152"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L153" data-line-number="153"></td>
          <td id="LC153">
</td>
        </tr>
        <tr>
          <td id="L154" data-line-number="154"></td>
          <td id="LC154"><span>Private</span> <span>Type</span> <span>CRYPT_ECC_PRIVATE_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L155" data-line-number="155"></td>
          <td id="LC155">    <span>dwVersion</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L156" data-line-number="156"></td>
          <td id="LC156">    <span>PrivateKey</span>          <span>As</span> <span>CRYPT_DATA_BLOB</span></td>
        </tr>
        <tr>
          <td id="L157" data-line-number="157"></td>
          <td id="LC157">    <span>szCurveOid</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L158" data-line-number="158"></td>
          <td id="LC158">    <span>PublicKey</span>           <span>As</span> <span>CRYPT_DATA_BLOB</span></td>
        </tr>
        <tr>
          <td id="L159" data-line-number="159"></td>
          <td id="LC159"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L160" data-line-number="160"></td>
          <td id="LC160">
</td>
        </tr>
        <tr>
          <td id="L161" data-line-number="161"></td>
          <td id="LC161"><span>Private</span> <span>Type</span> <span>CRYPT_PRIVATE_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L162" data-line-number="162"></td>
          <td id="LC162">    <span>Version</span>             <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L163" data-line-number="163"></td>
          <td id="LC163">    <span>Algorithm</span>           <span>As</span> <span>CRYPT_ALGORITHM_IDENTIFIER</span></td>
        </tr>
        <tr>
          <td id="L164" data-line-number="164"></td>
          <td id="LC164">    <span>PrivateKey</span>          <span>As</span> <span>CRYPT_DATA_BLOB</span></td>
        </tr>
        <tr>
          <td id="L165" data-line-number="165"></td>
          <td id="LC165">    <span>pAttributes</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L166" data-line-number="166"></td>
          <td id="LC166"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L167" data-line-number="167"></td>
          <td id="LC167">
</td>
        </tr>
        <tr>
          <td id="L168" data-line-number="168"></td>
          <td id="LC168"><span>Private</span> <span>Type</span> <span>BCRYPT_PSS_PADDING_INFO</span></td>
        </tr>
        <tr>
          <td id="L169" data-line-number="169"></td>
          <td id="LC169">    <span>pszAlgId</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L170" data-line-number="170"></td>
          <td id="LC170">    <span>cbSalt</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L171" data-line-number="171"></td>
          <td id="LC171"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L172" data-line-number="172"></td>
          <td id="LC172">
</td>
        </tr>
        <tr>
          <td id="L173" data-line-number="173"></td>
          <td id="LC173"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L174" data-line-number="174"></td>
          <td id="LC174"><span>&#39; Constants and member variables</span></td>
        </tr>
        <tr>
          <td id="L175" data-line-number="175"></td>
          <td id="LC175"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L176" data-line-number="176"></td>
          <td id="LC176">
</td>
        </tr>
        <tr>
          <td id="L177" data-line-number="177"></td>
          <td id="LC177"><span>Private</span> <span>Const</span> <span>STR_VL_ALERTS</span>                             <span>As</span> <span>String</span> <span>=</span> <span>&#34;0|Close notify|10|Unexpected message|20|Bad record mac|21|Decryption failed|22|Record overflow|30|Decompression failure|40|Handshake failure|41|No certificate|42|Bad certificate|43|Unsupported certificate|44|Certificate revoked|45|Certificate expired|46|Certificate unknown|47|Illegal parameter|48|Unknown certificate authority|50|Decode error|51|Decrypt error|70|Protocol version|71|Insufficient security|80|Internal error|90|User canceled|100|No renegotiation|109|Missing extension|110|Unsupported extension|111|Certificate unobtainable|112|Unrecognized name|113|Bad certificate status response|114|Bad certificate hash value|116|Certificate required|120|No application protocol&#34;</span></td>
        </tr>
        <tr>
          <td id="L178" data-line-number="178"></td>
          <td id="LC178"><span>Private</span> <span>Const</span> <span>STR_VL_STATES</span>                             <span>As</span> <span>String</span> <span>=</span> <span>&#34;0|New|1|Closed|2|HandshakeStart|3|ExpectServerHello|4|ExpectExtensions|5|ExpectServerFinished|6|ExpectClientHello|7|ExpectClientKeyExchange|8|ExpectClientFinished|9|PostHandshake|10|Shutdown&#34;</span></td>
        </tr>
        <tr>
          <td id="L179" data-line-number="179"></td>
          <td id="LC179"><span>Private</span> <span>Const</span> <span>STR_VL_MESSAGE_NAMES</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;1|client_hello|2|server_hello|4|new_session_ticket|5|end_of_early_data|8|encrypted_extensions|11|certificate|12|server_key_exchange|13|certificate_request|14|server_hello_done|15|certificate_verify|16|client_key_exchange|20|finished|21|certificate_url|22|certificate_status|24|key_update|25|compressed_certificate|254|message_hash&#34;</span></td>
        </tr>
        <tr>
          <td id="L180" data-line-number="180"></td>
          <td id="LC180"><span>Private</span> <span>Const</span> <span>STR_VL_EXTENSION_NAMES</span>                    <span>As</span> <span>String</span> <span>=</span> <span>&#34;0|server_name|1|max_fragment_length|2|client_certificate_url|3|trusted_ca_keys|4|truncated_hmac|5|status_request|6|user_mapping|7|client_authz|8|server_authz|9|cert_type|10|supported_groups|11|ec_point_formats|12|srp|13|signature_algorithms|14|use_srtp|15|heartbeat|16|application_layer_protocol_negotiation|17|status_request_v2|18|signed_certificate_timestamp|19|client_certificate_type|20|server_certificate_type|21|padding|22|encrypt_then_mac|23|extended_master_secret|24|token_binding|25|cached_info|26|tls_lts|27|compress_certificate|28|record_size_limit|29|pwd_protect|30|pwd_clear|31|password_salt|32|ticket_pinning|33|tls_cert_with_extern_psk|34|delegated_credentials|35|session_ticket|41|pre_shared_key|42|early_data|43|supported_versions|44|cookie|45|psk_key_exchange_modes|47|certificate_authorities|48|oid_filters|49|post_handshake_auth|&#34;</span> <span>&amp;</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L181" data-line-number="181"></td>
          <td id="LC181">                                                                    <span>&#34;50|signature_algorithms_cert|51|key_share|52|transparency_info|53|connection_id|55|external_id_hash|56|external_session_id&#34;</span></td>
        </tr>
        <tr>
          <td id="L182" data-line-number="182"></td>
          <td id="LC182"><span>Private</span> <span>Const</span> <span>STR_UNKNOWN</span>                               <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unknown (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L183" data-line-number="183"></td>
          <td id="LC183"><span>Private</span> <span>Const</span> <span>STR_FORMAT_ALERT</span>                          <span>As</span> <span>String</span> <span>=</span> <span>&#34;%1.&#34;</span></td>
        </tr>
        <tr>
          <td id="L184" data-line-number="184"></td>
          <td id="LC184"><span>&#39;--- TLS</span></td>
        </tr>
        <tr>
          <td id="L185" data-line-number="185"></td>
          <td id="LC185"><span>Private</span> <span>Const</span> <span>TLS_PROTOCOL_VERSION_TLS12</span>                <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H303</span></td>
        </tr>
        <tr>
          <td id="L186" data-line-number="186"></td>
          <td id="LC186"><span>Private</span> <span>Const</span> <span>TLS_PROTOCOL_VERSION_TLS13</span>                <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H304</span></td>
        </tr>
        <tr>
          <td id="L187" data-line-number="187"></td>
          <td id="LC187"><span>Private</span> <span>Const</span> <span>TLS_RECORD_VERSION</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>&#39;--- always legacy version</span></td>
        </tr>
        <tr>
          <td id="L188" data-line-number="188"></td>
          <td id="LC188"><span>Private</span> <span>Const</span> <span>TLS_LOCAL_LEGACY_VERSION</span>                  <span>As</span> <span>Long</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span></td>
        </tr>
        <tr>
          <td id="L189" data-line-number="189"></td>
          <td id="LC189"><span>&#39;--- TLS ContentType from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-5</span></td>
        </tr>
        <tr>
          <td id="L190" data-line-number="190"></td>
          <td id="LC190"><span>Private</span> <span>Const</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC</span>       <span>As</span> <span>Long</span> <span>=</span> <span>20</span></td>
        </tr>
        <tr>
          <td id="L191" data-line-number="191"></td>
          <td id="LC191"><span>Private</span> <span>Const</span> <span>TLS_CONTENT_TYPE_ALERT</span>                    <span>As</span> <span>Long</span> <span>=</span> <span>21</span></td>
        </tr>
        <tr>
          <td id="L192" data-line-number="192"></td>
          <td id="LC192"><span>Private</span> <span>Const</span> <span>TLS_CONTENT_TYPE_HANDSHAKE</span>                <span>As</span> <span>Long</span> <span>=</span> <span>22</span></td>
        </tr>
        <tr>
          <td id="L193" data-line-number="193"></td>
          <td id="LC193"><span>Private</span> <span>Const</span> <span>TLS_CONTENT_TYPE_APPDATA</span>                  <span>As</span> <span>Long</span> <span>=</span> <span>23</span></td>
        </tr>
        <tr>
          <td id="L194" data-line-number="194"></td>
          <td id="LC194"><span>&#39;--- TLS HandshakeType from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-7</span></td>
        </tr>
        <tr>
          <td id="L195" data-line-number="195"></td>
          <td id="LC195"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_HELLO_REQUEST</span>               <span>As</span> <span>Long</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L196" data-line-number="196"></td>
          <td id="LC196"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_CLIENT_HELLO</span>                <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L197" data-line-number="197"></td>
          <td id="LC197"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_SERVER_HELLO</span>                <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L198" data-line-number="198"></td>
          <td id="LC198"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_NEW_SESSION_TICKET</span>          <span>As</span> <span>Long</span> <span>=</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L199" data-line-number="199"></td>
          <td id="LC199"><span>&#39;Private Const TLS_HANDSHAKE_END_OF_EARLY_DATA           As Long = 5</span></td>
        </tr>
        <tr>
          <td id="L200" data-line-number="200"></td>
          <td id="LC200"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_ENCRYPTED_EXTENSIONS</span>        <span>As</span> <span>Long</span> <span>=</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L201" data-line-number="201"></td>
          <td id="LC201"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_CERTIFICATE</span>                 <span>As</span> <span>Long</span> <span>=</span> <span>11</span></td>
        </tr>
        <tr>
          <td id="L202" data-line-number="202"></td>
          <td id="LC202"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_SERVER_KEY_EXCHANGE</span>         <span>As</span> <span>Long</span> <span>=</span> <span>12</span></td>
        </tr>
        <tr>
          <td id="L203" data-line-number="203"></td>
          <td id="LC203"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_CERTIFICATE_REQUEST</span>         <span>As</span> <span>Long</span> <span>=</span> <span>13</span></td>
        </tr>
        <tr>
          <td id="L204" data-line-number="204"></td>
          <td id="LC204"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_SERVER_HELLO_DONE</span>           <span>As</span> <span>Long</span> <span>=</span> <span>14</span></td>
        </tr>
        <tr>
          <td id="L205" data-line-number="205"></td>
          <td id="LC205"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_CERTIFICATE_VERIFY</span>          <span>As</span> <span>Long</span> <span>=</span> <span>15</span></td>
        </tr>
        <tr>
          <td id="L206" data-line-number="206"></td>
          <td id="LC206"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_CLIENT_KEY_EXCHANGE</span>         <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L207" data-line-number="207"></td>
          <td id="LC207"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_FINISHED</span>                    <span>As</span> <span>Long</span> <span>=</span> <span>20</span></td>
        </tr>
        <tr>
          <td id="L208" data-line-number="208"></td>
          <td id="LC208"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_CERTIFICATE_STATUS</span>          <span>As</span> <span>Long</span> <span>=</span> <span>22</span></td>
        </tr>
        <tr>
          <td id="L209" data-line-number="209"></td>
          <td id="LC209"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_KEY_UPDATE</span>                  <span>As</span> <span>Long</span> <span>=</span> <span>24</span></td>
        </tr>
        <tr>
          <td id="L210" data-line-number="210"></td>
          <td id="LC210"><span>&#39;Private Const TLS_HANDSHAKE_COMPRESSED_CERTIFICATE      As Long = 25</span></td>
        </tr>
        <tr>
          <td id="L211" data-line-number="211"></td>
          <td id="LC211"><span>Private</span> <span>Const</span> <span>TLS_HANDSHAKE_MESSAGE_HASH</span>                <span>As</span> <span>Long</span> <span>=</span> <span>254</span></td>
        </tr>
        <tr>
          <td id="L212" data-line-number="212"></td>
          <td id="LC212"><span>&#39;--- TLS Extensions from https://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml</span></td>
        </tr>
        <tr>
          <td id="L213" data-line-number="213"></td>
          <td id="LC213"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_SERVER_NAME</span>                 <span>As</span> <span>Long</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L214" data-line-number="214"></td>
          <td id="LC214"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_STATUS_REQUEST</span>              <span>As</span> <span>Long</span> <span>=</span> <span>5</span></td>
        </tr>
        <tr>
          <td id="L215" data-line-number="215"></td>
          <td id="LC215"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_SUPPORTED_GROUPS</span>            <span>As</span> <span>Long</span> <span>=</span> <span>10</span></td>
        </tr>
        <tr>
          <td id="L216" data-line-number="216"></td>
          <td id="LC216"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_EC_POINT_FORMAT</span>             <span>As</span> <span>Long</span> <span>=</span> <span>11</span></td>
        </tr>
        <tr>
          <td id="L217" data-line-number="217"></td>
          <td id="LC217"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_SIGNATURE_ALGORITHMS</span>        <span>As</span> <span>Long</span> <span>=</span> <span>13</span></td>
        </tr>
        <tr>
          <td id="L218" data-line-number="218"></td>
          <td id="LC218"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_ALPN</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L219" data-line-number="219"></td>
          <td id="LC219"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC</span>            <span>As</span> <span>Long</span> <span>=</span> <span>22</span></td>
        </tr>
        <tr>
          <td id="L220" data-line-number="220"></td>
          <td id="LC220"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_EXTENDED_MASTER_SECRET</span>      <span>As</span> <span>Long</span> <span>=</span> <span>23</span></td>
        </tr>
        <tr>
          <td id="L221" data-line-number="221"></td>
          <td id="LC221"><span>&#39;Private Const TLS_EXTENSION_COMPRESS_CERTIFICATE        As Long = 27</span></td>
        </tr>
        <tr>
          <td id="L222" data-line-number="222"></td>
          <td id="LC222"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_SESSION_TICKET</span>              <span>As</span> <span>Long</span> <span>=</span> <span>35</span></td>
        </tr>
        <tr>
          <td id="L223" data-line-number="223"></td>
          <td id="LC223"><span>&#39;Private Const TLS_EXTENSION_PRE_SHARED_KEY              As Long = 41</span></td>
        </tr>
        <tr>
          <td id="L224" data-line-number="224"></td>
          <td id="LC224"><span>&#39;Private Const TLS_EXTENSION_EARLY_DATA                  As Long = 42</span></td>
        </tr>
        <tr>
          <td id="L225" data-line-number="225"></td>
          <td id="LC225"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_SUPPORTED_VERSIONS</span>          <span>As</span> <span>Long</span> <span>=</span> <span>43</span></td>
        </tr>
        <tr>
          <td id="L226" data-line-number="226"></td>
          <td id="LC226"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_COOKIE</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>44</span></td>
        </tr>
        <tr>
          <td id="L227" data-line-number="227"></td>
          <td id="LC227"><span>&#39;Private Const TLS_EXTENSION_PSK_KEY_EXCHANGE_MODES      As Long = 45</span></td>
        </tr>
        <tr>
          <td id="L228" data-line-number="228"></td>
          <td id="LC228"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_CERTIFICATE_AUTHORITIES</span>     <span>As</span> <span>Long</span> <span>=</span> <span>47</span></td>
        </tr>
        <tr>
          <td id="L229" data-line-number="229"></td>
          <td id="LC229"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_POST_HANDSHAKE_AUTH</span>         <span>As</span> <span>Long</span> <span>=</span> <span>49</span></td>
        </tr>
        <tr>
          <td id="L230" data-line-number="230"></td>
          <td id="LC230"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_SIGNATURE_ALGORITHMS_CERT</span>   <span>As</span> <span>Long</span> <span>=</span> <span>50</span></td>
        </tr>
        <tr>
          <td id="L231" data-line-number="231"></td>
          <td id="LC231"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_KEY_SHARE</span>                   <span>As</span> <span>Long</span> <span>=</span> <span>51</span></td>
        </tr>
        <tr>
          <td id="L232" data-line-number="232"></td>
          <td id="LC232"><span>Private</span> <span>Const</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HFF01&amp;</span></td>
        </tr>
        <tr>
          <td id="L233" data-line-number="233"></td>
          <td id="LC233"><span>&#39;--- TLS Cipher Suites from http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4</span></td>
        </tr>
        <tr>
          <td id="L234" data-line-number="234"></td>
          <td id="LC234"><span>Private</span> <span>Const</span> <span>TLS_CS_AES_128_GCM_SHA256</span>                 <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1301</span></td>
        </tr>
        <tr>
          <td id="L235" data-line-number="235"></td>
          <td id="LC235"><span>Private</span> <span>Const</span> <span>TLS_CS_AES_256_GCM_SHA384</span>                 <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1302</span></td>
        </tr>
        <tr>
          <td id="L236" data-line-number="236"></td>
          <td id="LC236"><span>Private</span> <span>Const</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256</span>           <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1303</span></td>
        </tr>
        <tr>
          <td id="L237" data-line-number="237"></td>
          <td id="LC237"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span> <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC02B</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L238" data-line-number="238"></td>
          <td id="LC238"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span> <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC02C</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L239" data-line-number="239"></td>
          <td id="LC239"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span>  <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC02F</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L240" data-line-number="240"></td>
          <td id="LC240"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</span>  <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC030</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L241" data-line-number="241"></td>
          <td id="LC241"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span> <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HCCA8</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L242" data-line-number="242"></td>
          <td id="LC242"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span> <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HCCA9</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L243" data-line-number="243"></td>
          <td id="LC243"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span>   <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC009&amp;</span></td>
        </tr>
        <tr>
          <td id="L244" data-line-number="244"></td>
          <td id="LC244"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span>   <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC00A</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L245" data-line-number="245"></td>
          <td id="LC245"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span>     <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC013&amp;</span></td>
        </tr>
        <tr>
          <td id="L246" data-line-number="246"></td>
          <td id="LC246"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span>     <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC014&amp;</span></td>
        </tr>
        <tr>
          <td id="L247" data-line-number="247"></td>
          <td id="LC247"><span>Private</span> <span>Const</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA</span>           <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H2F</span></td>
        </tr>
        <tr>
          <td id="L248" data-line-number="248"></td>
          <td id="LC248"><span>Private</span> <span>Const</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA</span>           <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H35</span></td>
        </tr>
        <tr>
          <td id="L249" data-line-number="249"></td>
          <td id="LC249"><span>Private</span> <span>Const</span> <span>TLS_CS_RSA_WITH_AES_128_GCM_SHA256</span>        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H9C</span></td>
        </tr>
        <tr>
          <td id="L250" data-line-number="250"></td>
          <td id="LC250"><span>Private</span> <span>Const</span> <span>TLS_CS_RSA_WITH_AES_256_GCM_SHA384</span>        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H9D</span></td>
        </tr>
        <tr>
          <td id="L251" data-line-number="251"></td>
          <td id="LC251"><span>Private</span> <span>Const</span> <span>TLS_CS_EMPTY_RENEGOTIATION_INFO_SCSV</span>      <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HFF</span></td>
        </tr>
        <tr>
          <td id="L252" data-line-number="252"></td>
          <td id="LC252"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</span> <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC023</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L253" data-line-number="253"></td>
          <td id="LC253"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</span> <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC024</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L254" data-line-number="254"></td>
          <td id="LC254"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</span>  <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC027</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L255" data-line-number="255"></td>
          <td id="LC255"><span>Private</span> <span>Const</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</span>  <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HC028</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L256" data-line-number="256"></td>
          <td id="LC256"><span>Private</span> <span>Const</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA256</span>        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H3C</span></td>
        </tr>
        <tr>
          <td id="L257" data-line-number="257"></td>
          <td id="LC257"><span>Private</span> <span>Const</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA256</span>        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H3D</span></td>
        </tr>
        <tr>
          <td id="L258" data-line-number="258"></td>
          <td id="LC258"><span>&#39;--- TLS Supported Groups from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8</span></td>
        </tr>
        <tr>
          <td id="L259" data-line-number="259"></td>
          <td id="LC259"><span>Private</span> <span>Const</span> <span>TLS_GROUP_SECP256R1</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>23</span></td>
        </tr>
        <tr>
          <td id="L260" data-line-number="260"></td>
          <td id="LC260"><span>Private</span> <span>Const</span> <span>TLS_GROUP_SECP384R1</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>24</span></td>
        </tr>
        <tr>
          <td id="L261" data-line-number="261"></td>
          <td id="LC261"><span>Private</span> <span>Const</span> <span>TLS_GROUP_SECP521R1</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>25</span></td>
        </tr>
        <tr>
          <td id="L262" data-line-number="262"></td>
          <td id="LC262"><span>Private</span> <span>Const</span> <span>TLS_GROUP_X25519</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>29</span></td>
        </tr>
        <tr>
          <td id="L263" data-line-number="263"></td>
          <td id="LC263"><span>Private</span> <span>Const</span> <span>TLS_GROUP_X448</span>                            <span>As</span> <span>Long</span> <span>=</span> <span>30</span></td>
        </tr>
        <tr>
          <td id="L264" data-line-number="264"></td>
          <td id="LC264"><span>Private</span> <span>Const</span> <span>TLS_GROUP_FFDHE_FIRST</span>                     <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H100</span></td>
        </tr>
        <tr>
          <td id="L265" data-line-number="265"></td>
          <td id="LC265"><span>Private</span> <span>Const</span> <span>TLS_GROUP_FFDHE_LAST</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H104</span></td>
        </tr>
        <tr>
          <td id="L266" data-line-number="266"></td>
          <td id="LC266"><span>Private</span> <span>Const</span> <span>TLS_GROUP_FFDHE_PRIVATE_USE_FIRST</span>         <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1FC</span></td>
        </tr>
        <tr>
          <td id="L267" data-line-number="267"></td>
          <td id="LC267"><span>Private</span> <span>Const</span> <span>TLS_GROUP_FFDHE_PRIVATE_USE_LAST</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1FF</span></td>
        </tr>
        <tr>
          <td id="L268" data-line-number="268"></td>
          <td id="LC268"><span>Private</span> <span>Const</span> <span>TLS_GROUP_ECDHE_PRIVATE_USE_FIRST</span>         <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HFE00&amp;</span></td>
        </tr>
        <tr>
          <td id="L269" data-line-number="269"></td>
          <td id="LC269"><span>Private</span> <span>Const</span> <span>TLS_GROUP_ECDHE_PRIVATE_USE_LAST</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;HFEFF</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L270" data-line-number="270"></td>
          <td id="LC270"><span>&#39;--- TLS Signature Scheme from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-signaturescheme</span></td>
        </tr>
        <tr>
          <td id="L271" data-line-number="271"></td>
          <td id="LC271"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1</span>              <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H201</span> <span>&#39;--- TLS 1.2</span></td>
        </tr>
        <tr>
          <td id="L272" data-line-number="272"></td>
          <td id="LC272"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_ECDSA_SHA1</span>                  <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H203</span></td>
        </tr>
        <tr>
          <td id="L273" data-line-number="273"></td>
          <td id="LC273"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA224</span>            <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H301</span></td>
        </tr>
        <tr>
          <td id="L274" data-line-number="274"></td>
          <td id="LC274"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA256</span>            <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H401</span></td>
        </tr>
        <tr>
          <td id="L275" data-line-number="275"></td>
          <td id="LC275"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA384</span>            <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H501</span></td>
        </tr>
        <tr>
          <td id="L276" data-line-number="276"></td>
          <td id="LC276"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA512</span>            <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H601</span></td>
        </tr>
        <tr>
          <td id="L277" data-line-number="277"></td>
          <td id="LC277"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256</span>      <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H403</span> <span>&#39;--- TLS 1.3</span></td>
        </tr>
        <tr>
          <td id="L278" data-line-number="278"></td>
          <td id="LC278"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384</span>      <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H503</span></td>
        </tr>
        <tr>
          <td id="L279" data-line-number="279"></td>
          <td id="LC279"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</span>      <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H603</span></td>
        </tr>
        <tr>
          <td id="L280" data-line-number="280"></td>
          <td id="LC280"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256</span>         <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H804</span></td>
        </tr>
        <tr>
          <td id="L281" data-line-number="281"></td>
          <td id="LC281"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384</span>         <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H805</span></td>
        </tr>
        <tr>
          <td id="L282" data-line-number="282"></td>
          <td id="LC282"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512</span>         <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H806</span></td>
        </tr>
        <tr>
          <td id="L283" data-line-number="283"></td>
          <td id="LC283"><span>&#39;Private Const TLS_SIGNATURE_ED25519                     As Long = &amp;H807</span></td>
        </tr>
        <tr>
          <td id="L284" data-line-number="284"></td>
          <td id="LC284"><span>&#39;Private Const TLS_SIGNATURE_ED448                       As Long = &amp;H808</span></td>
        </tr>
        <tr>
          <td id="L285" data-line-number="285"></td>
          <td id="LC285"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H809</span></td>
        </tr>
        <tr>
          <td id="L286" data-line-number="286"></td>
          <td id="LC286"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H80A</span></td>
        </tr>
        <tr>
          <td id="L287" data-line-number="287"></td>
          <td id="LC287"><span>Private</span> <span>Const</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H80B</span></td>
        </tr>
        <tr>
          <td id="L288" data-line-number="288"></td>
          <td id="LC288"><span>Private</span> <span>Const</span> <span>TLS_ALERT_LEVEL_WARNING</span>                   <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L289" data-line-number="289"></td>
          <td id="LC289"><span>Private</span> <span>Const</span> <span>TLS_ALERT_LEVEL_FATAL</span>                     <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L290" data-line-number="290"></td>
          <td id="LC290"><span>Private</span> <span>Const</span> <span>TLS_COMPRESS_NULL</span>                         <span>As</span> <span>Long</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L291" data-line-number="291"></td>
          <td id="LC291"><span>Private</span> <span>Const</span> <span>TLS_SERVER_NAME_TYPE_HOSTNAME</span>             <span>As</span> <span>Long</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L292" data-line-number="292"></td>
          <td id="LC292"><span>Private</span> <span>Const</span> <span>TLS_MAX_PLAINTEXT_RECORD_SIZE</span>             <span>As</span> <span>Long</span> <span>=</span> <span>16384</span></td>
        </tr>
        <tr>
          <td id="L293" data-line-number="293"></td>
          <td id="LC293"><span>Private</span> <span>Const</span> <span>TLS_MAX_ENCRYPTED_RECORD_SIZE</span>             <span>As</span> <span>Long</span> <span>=</span> <span>TLS_MAX_PLAINTEXT_RECORD_SIZE</span> <span>+</span> <span>1</span> <span>+</span> <span>255</span> <span>&#39;-- 1 byte content type + 255 bytes AEAD padding</span></td>
        </tr>
        <tr>
          <td id="L294" data-line-number="294"></td>
          <td id="LC294"><span>Private</span> <span>Const</span> <span>TLS_HELLO_RANDOM_SIZE</span>                     <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L295" data-line-number="295"></td>
          <td id="LC295"><span>Private</span> <span>Const</span> <span>TLS_LEGACY_SECRET_SIZE</span>                    <span>As</span> <span>Long</span> <span>=</span> <span>48</span></td>
        </tr>
        <tr>
          <td id="L296" data-line-number="296"></td>
          <td id="LC296"><span>Private</span> <span>Const</span> <span>TLS_LEGACY_SESSIONID_SIZE</span>                 <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L297" data-line-number="297"></td>
          <td id="LC297"><span>Private</span> <span>Const</span> <span>TLS_AAD_SIZE</span>                              <span>As</span> <span>Long</span> <span>=</span> <span>5</span>     <span>&#39;--- size of additional authenticated data for TLS 1.3</span></td>
        </tr>
        <tr>
          <td id="L298" data-line-number="298"></td>
          <td id="LC298"><span>Private</span> <span>Const</span> <span>TLS_LEGACY_AAD_SIZE</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>13</span>    <span>&#39;--- for TLS 1.2</span></td>
        </tr>
        <tr>
          <td id="L299" data-line-number="299"></td>
          <td id="LC299"><span>Private</span> <span>Const</span> <span>TLS_VERIFY_DATA_SIZE</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>12</span></td>
        </tr>
        <tr>
          <td id="L300" data-line-number="300"></td>
          <td id="LC300"><span>&#39;Private Const TLS_PSK_KE_MODE_PSK_DHE                   As Long = 1</span></td>
        </tr>
        <tr>
          <td id="L301" data-line-number="301"></td>
          <td id="LC301"><span>&#39;--- crypto constants</span></td>
        </tr>
        <tr>
          <td id="L302" data-line-number="302"></td>
          <td id="LC302"><span>Private</span> <span>Const</span> <span>LNG_X25519_KEYSZ</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L303" data-line-number="303"></td>
          <td id="LC303"><span>Private</span> <span>Const</span> <span>LNG_SECP256R1_KEYSZ</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L304" data-line-number="304"></td>
          <td id="LC304"><span>Private</span> <span>Const</span> <span>LNG_SECP384R1_KEYSZ</span>                       <span>As</span> <span>Long</span> <span>=</span> <span>48</span></td>
        </tr>
        <tr>
          <td id="L305" data-line-number="305"></td>
          <td id="LC305"><span>Private</span> <span>Const</span> <span>LNG_MD5_HASHSZ</span>                            <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L306" data-line-number="306"></td>
          <td id="LC306"><span>&#39;Private Const LNG_MD5_BLOCKSZ                           As Long = 64</span></td>
        </tr>
        <tr>
          <td id="L307" data-line-number="307"></td>
          <td id="LC307"><span>Private</span> <span>Const</span> <span>LNG_SHA1_HASHSZ</span>                           <span>As</span> <span>Long</span> <span>=</span> <span>20</span></td>
        </tr>
        <tr>
          <td id="L308" data-line-number="308"></td>
          <td id="LC308"><span>Private</span> <span>Const</span> <span>LNG_SHA1_BLOCKSZ</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>64</span></td>
        </tr>
        <tr>
          <td id="L309" data-line-number="309"></td>
          <td id="LC309"><span>Private</span> <span>Const</span> <span>LNG_SHA224_HASHSZ</span>                         <span>As</span> <span>Long</span> <span>=</span> <span>28</span></td>
        </tr>
        <tr>
          <td id="L310" data-line-number="310"></td>
          <td id="LC310"><span>&#39;Private Const LNG_SHA224_BLOCKSZ                        As Long = 64</span></td>
        </tr>
        <tr>
          <td id="L311" data-line-number="311"></td>
          <td id="LC311"><span>Private</span> <span>Const</span> <span>LNG_SHA256_HASHSZ</span>                         <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L312" data-line-number="312"></td>
          <td id="LC312"><span>Private</span> <span>Const</span> <span>LNG_SHA256_BLOCKSZ</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>64</span></td>
        </tr>
        <tr>
          <td id="L313" data-line-number="313"></td>
          <td id="LC313"><span>Private</span> <span>Const</span> <span>LNG_SHA384_HASHSZ</span>                         <span>As</span> <span>Long</span> <span>=</span> <span>48</span></td>
        </tr>
        <tr>
          <td id="L314" data-line-number="314"></td>
          <td id="LC314"><span>Private</span> <span>Const</span> <span>LNG_SHA384_BLOCKSZ</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>128</span></td>
        </tr>
        <tr>
          <td id="L315" data-line-number="315"></td>
          <td id="LC315"><span>Private</span> <span>Const</span> <span>LNG_SHA384_CONTEXTSZ</span>                      <span>As</span> <span>Long</span> <span>=</span> <span>200</span></td>
        </tr>
        <tr>
          <td id="L316" data-line-number="316"></td>
          <td id="LC316"><span>Private</span> <span>Const</span> <span>LNG_SHA512_HASHSZ</span>                         <span>As</span> <span>Long</span> <span>=</span> <span>64</span></td>
        </tr>
        <tr>
          <td id="L317" data-line-number="317"></td>
          <td id="LC317"><span>Private</span> <span>Const</span> <span>LNG_SHA512_BLOCKSZ</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>128</span></td>
        </tr>
        <tr>
          <td id="L318" data-line-number="318"></td>
          <td id="LC318"><span>Private</span> <span>Const</span> <span>LNG_CHACHA20_KEYSZ</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L319" data-line-number="319"></td>
          <td id="LC319"><span>Private</span> <span>Const</span> <span>LNG_CHACHA20POLY1305_IVSZ</span>                 <span>As</span> <span>Long</span> <span>=</span> <span>12</span></td>
        </tr>
        <tr>
          <td id="L320" data-line-number="320"></td>
          <td id="LC320"><span>Private</span> <span>Const</span> <span>LNG_CHACHA20POLY1305_TAGSZ</span>                <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L321" data-line-number="321"></td>
          <td id="LC321"><span>Private</span> <span>Const</span> <span>LNG_AES128_KEYSZ</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L322" data-line-number="322"></td>
          <td id="LC322"><span>Private</span> <span>Const</span> <span>LNG_AES256_KEYSZ</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L323" data-line-number="323"></td>
          <td id="LC323"><span>Private</span> <span>Const</span> <span>LNG_AESGCM_IVSZ</span>                           <span>As</span> <span>Long</span> <span>=</span> <span>12</span></td>
        </tr>
        <tr>
          <td id="L324" data-line-number="324"></td>
          <td id="LC324"><span>Private</span> <span>Const</span> <span>LNG_AESGCM_TAGSZ</span>                          <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L325" data-line-number="325"></td>
          <td id="LC325"><span>Private</span> <span>Const</span> <span>LNG_AESCBC_IVSZ</span>                           <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L326" data-line-number="326"></td>
          <td id="LC326"><span>Private</span> <span>Const</span> <span>LNG_ANS1_TYPE_SEQUENCE</span>                    <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H30</span></td>
        </tr>
        <tr>
          <td id="L327" data-line-number="327"></td>
          <td id="LC327"><span>Private</span> <span>Const</span> <span>LNG_ANS1_TYPE_INTEGER</span>                     <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H2</span></td>
        </tr>
        <tr>
          <td id="L328" data-line-number="328"></td>
          <td id="LC328"><span>Private</span> <span>Const</span> <span>LNG_HMAC_INNER_PAD</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H36</span></td>
        </tr>
        <tr>
          <td id="L329" data-line-number="329"></td>
          <td id="LC329"><span>Private</span> <span>Const</span> <span>LNG_HMAC_OUTER_PAD</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H5C</span></td>
        </tr>
        <tr>
          <td id="L330" data-line-number="330"></td>
          <td id="LC330"><span>&#39;--- errors</span></td>
        </tr>
        <tr>
          <td id="L331" data-line-number="331"></td>
          <td id="LC331"><span>Private</span> <span>Const</span> <span>ERR_CONNECTION_CLOSED</span>                     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Connection closed&#34;</span></td>
        </tr>
        <tr>
          <td id="L332" data-line-number="332"></td>
          <td id="LC332"><span>Private</span> <span>Const</span> <span>ERR_GENER_KEYPAIR_FAILED</span>                  <span>As</span> <span>String</span> <span>=</span> <span>&#34;Failed generating key pair (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L333" data-line-number="333"></td>
          <td id="LC333"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_EXCH_GROUP</span>                <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported exchange group (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L334" data-line-number="334"></td>
          <td id="LC334"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_CIPHER_SUITE</span>              <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported cipher suite (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L335" data-line-number="335"></td>
          <td id="LC335"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_SIGNATURE_SCHEME</span>          <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported signature scheme (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L336" data-line-number="336"></td>
          <td id="LC336"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_CERTIFICATE</span>               <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported certificate&#34;</span></td>
        </tr>
        <tr>
          <td id="L337" data-line-number="337"></td>
          <td id="LC337"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_PUBLIC_KEY</span>                <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported public key OID (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L338" data-line-number="338"></td>
          <td id="LC338"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_PRIVATE_KEY</span>               <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported private key&#34;</span></td>
        </tr>
        <tr>
          <td id="L339" data-line-number="339"></td>
          <td id="LC339"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_CURVE_SIZE</span>                <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported curve size (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L340" data-line-number="340"></td>
          <td id="LC340"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_CURVE_TYPE</span>                <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported curve type (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L341" data-line-number="341"></td>
          <td id="LC341"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_PROTOCOL</span>                  <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid protocol version (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L342" data-line-number="342"></td>
          <td id="LC342"><span>Private</span> <span>Const</span> <span>ERR_ENCRYPTION_FAILED</span>                     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Encryption failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L343" data-line-number="343"></td>
          <td id="LC343"><span>Private</span> <span>Const</span> <span>ERR_SIGNATURE_FAILED</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;Certificate signature failed (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L344" data-line-number="344"></td>
          <td id="LC344"><span>Private</span> <span>Const</span> <span>ERR_DECRYPTION_FAILED</span>                     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Decryption failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L345" data-line-number="345"></td>
          <td id="LC345"><span>Private</span> <span>Const</span> <span>ERR_SERVER_HANDSHAKE_FAILED</span>               <span>As</span> <span>String</span> <span>=</span> <span>&#34;Handshake verification failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L346" data-line-number="346"></td>
          <td id="LC346"><span>Private</span> <span>Const</span> <span>ERR_RECORD_MAC_FAILED</span>                     <span>As</span> <span>String</span> <span>=</span> <span>&#34;MAC verification failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L347" data-line-number="347"></td>
          <td id="LC347"><span>Private</span> <span>Const</span> <span>ERR_HELLO_RETRY_FAILED</span>                    <span>As</span> <span>String</span> <span>=</span> <span>&#34;HelloRetryRequest failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L348" data-line-number="348"></td>
          <td id="LC348"><span>Private</span> <span>Const</span> <span>ERR_NEGOTIATE_SIGNATURE_FAILED</span>            <span>As</span> <span>String</span> <span>=</span> <span>&#34;Negotiate signature type failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L349" data-line-number="349"></td>
          <td id="LC349"><span>Private</span> <span>Const</span> <span>ERR_SECURE_RENEGOTIATION_FAILED</span>           <span>As</span> <span>String</span> <span>=</span> <span>&#34;Secure renegotiation failed&#34;</span></td>
        </tr>
        <tr>
          <td id="L350" data-line-number="350"></td>
          <td id="LC350"><span>Private</span> <span>Const</span> <span>ERR_CALL_FAILED</span>                           <span>As</span> <span>String</span> <span>=</span> <span>&#34;Call failed (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L351" data-line-number="351"></td>
          <td id="LC351"><span>Private</span> <span>Const</span> <span>ERR_RECORD_OVERFLOW</span>                       <span>As</span> <span>String</span> <span>=</span> <span>&#34;Record size too big&#34;</span></td>
        </tr>
        <tr>
          <td id="L352" data-line-number="352"></td>
          <td id="LC352"><span>Private</span> <span>Const</span> <span>ERR_FATAL_ALERT</span>                           <span>As</span> <span>String</span> <span>=</span> <span>&#34;Received fatal alert&#34;</span></td>
        </tr>
        <tr>
          <td id="L353" data-line-number="353"></td>
          <td id="LC353"><span>Private</span> <span>Const</span> <span>ERR_UNEXPECTED_RECORD_TYPE</span>                <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unexpected record type (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L354" data-line-number="354"></td>
          <td id="LC354"><span>Private</span> <span>Const</span> <span>ERR_UNEXPECTED_MSG_TYPE</span>                   <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unexpected message type for %1 state (%2)&#34;</span></td>
        </tr>
        <tr>
          <td id="L355" data-line-number="355"></td>
          <td id="LC355"><span>Private</span> <span>Const</span> <span>ERR_UNEXPECTED_EXTENSION</span>                  <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unexpected extension (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L356" data-line-number="356"></td>
          <td id="LC356"><span>Private</span> <span>Const</span> <span>ERR_INVALID_STATE_HANDSHAKE</span>               <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid state for handshake content (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L357" data-line-number="357"></td>
          <td id="LC357"><span>Private</span> <span>Const</span> <span>ERR_INVALID_REMOTE_KEY</span>                    <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid remote key&#34;</span></td>
        </tr>
        <tr>
          <td id="L358" data-line-number="358"></td>
          <td id="LC358"><span>Private</span> <span>Const</span> <span>ERR_INVALID_SIZE</span>                          <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid data size&#34;</span></td>
        </tr>
        <tr>
          <td id="L359" data-line-number="359"></td>
          <td id="LC359"><span>Private</span> <span>Const</span> <span>ERR_INVALID_SIZE_EXTENSION</span>                <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid data size for %1&#34;</span></td>
        </tr>
        <tr>
          <td id="L360" data-line-number="360"></td>
          <td id="LC360"><span>Private</span> <span>Const</span> <span>ERR_INVALID_SIGNATURE</span>                     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid certificate signature&#34;</span></td>
        </tr>
        <tr>
          <td id="L361" data-line-number="361"></td>
          <td id="LC361"><span>Private</span> <span>Const</span> <span>ERR_INVALID_HASH_SIZE</span>                     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid hash size (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L362" data-line-number="362"></td>
          <td id="LC362"><span>Private</span> <span>Const</span> <span>ERR_NO_HANDSHAKE_MESSAGES</span>                 <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing handshake messages&#34;</span></td>
        </tr>
        <tr>
          <td id="L363" data-line-number="363"></td>
          <td id="LC363"><span>Private</span> <span>Const</span> <span>ERR_NO_PREVIOUS_SECRET</span>                    <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing previous %1&#34;</span></td>
        </tr>
        <tr>
          <td id="L364" data-line-number="364"></td>
          <td id="LC364"><span>Private</span> <span>Const</span> <span>ERR_NO_REMOTE_RANDOM</span>                      <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing remote random&#34;</span></td>
        </tr>
        <tr>
          <td id="L365" data-line-number="365"></td>
          <td id="LC365"><span>Private</span> <span>Const</span> <span>ERR_NO_SERVER_CERTIFICATE</span>                 <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing server certificate&#34;</span></td>
        </tr>
        <tr>
          <td id="L366" data-line-number="366"></td>
          <td id="LC366"><span>Private</span> <span>Const</span> <span>ERR_NO_SUPPORTED_CIPHER_SUITE</span>             <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing supported ciphersuite (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L367" data-line-number="367"></td>
          <td id="LC367"><span>Private</span> <span>Const</span> <span>ERR_NO_CERTIFICATE</span>                        <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing certificate&#34;</span></td>
        </tr>
        <tr>
          <td id="L368" data-line-number="368"></td>
          <td id="LC368"><span>Private</span> <span>Const</span> <span>ERR_NO_SERVER_COMPILED</span>                    <span>As</span> <span>String</span> <span>=</span> <span>&#34;Server-side TLS not compiled (ASYNCSOCKET_NO_TLSSERVER = 1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L369" data-line-number="369"></td>
          <td id="LC369"><span>Private</span> <span>Const</span> <span>ERR_NO_SUPPORTED_GROUPS</span>                   <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing supported remote group&#34;</span></td>
        </tr>
        <tr>
          <td id="L370" data-line-number="370"></td>
          <td id="LC370"><span>Private</span> <span>Const</span> <span>ERR_NO_ALPN_NEGOTIATED</span>                    <span>As</span> <span>String</span> <span>=</span> <span>&#34;No application protocol negotiated&#34;</span></td>
        </tr>
        <tr>
          <td id="L371" data-line-number="371"></td>
          <td id="LC371"><span>Private</span> <span>Const</span> <span>ERR_NO_EXTENSION</span>                          <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing extension (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L372" data-line-number="372"></td>
          <td id="LC372"><span>Private</span> <span>Const</span> <span>ERR_UNSUPPORTED_REQUEST_UPDATE</span>            <span>As</span> <span>String</span> <span>=</span> <span>&#34;Unsupported request update (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L373" data-line-number="373"></td>
          <td id="LC373"><span>Private</span> <span>Const</span> <span>ERR_INVALID_COMPRESSION</span>                   <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid compression (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L374" data-line-number="374"></td>
          <td id="LC374"><span>Private</span> <span>Const</span> <span>ERR_INVALID_SERVER_NAME</span>                   <span>As</span> <span>String</span> <span>=</span> <span>&#34;Invalid server name (%1)&#34;</span></td>
        </tr>
        <tr>
          <td id="L375" data-line-number="375"></td>
          <td id="LC375"><span>Private</span> <span>Const</span> <span>ERR_MISSING_TRAFFIC_KEYS</span>                  <span>As</span> <span>String</span> <span>=</span> <span>&#34;Missing remote traffic keys&#34;</span></td>
        </tr>
        <tr>
          <td id="L376" data-line-number="376"></td>
          <td id="LC376"><span>&#39;--- numeric</span></td>
        </tr>
        <tr>
          <td id="L377" data-line-number="377"></td>
          <td id="LC377"><span>Private</span> <span>Const</span> <span>LNG_FACILITY_WIN32</span>                        <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H80070000</span></td>
        </tr>
        <tr>
          <td id="L378" data-line-number="378"></td>
          <td id="LC378">
</td>
        </tr>
        <tr>
          <td id="L379" data-line-number="379"></td>
          <td id="LC379"><span>Private</span> <span>m_baBuffer()</span>                <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L380" data-line-number="380"></td>
          <td id="LC380"><span>Private</span> <span>m_lBuffIdx</span>                  <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L381" data-line-number="381"></td>
          <td id="LC381"><span>Private</span> <span>m_uData</span>                     <span>As</span> <span>UcsCryptoData</span></td>
        </tr>
        <tr>
          <td id="L382" data-line-number="382"></td>
          <td id="LC382"><span>Private</span> <span>m_baHelloRetryRandom()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L383" data-line-number="383"></td>
          <td id="LC383"><span>Public</span> <span>g_oRequestSocket</span>             <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L384" data-line-number="384"></td>
          <td id="LC384">
</td>
        </tr>
        <tr>
          <td id="L385" data-line-number="385"></td>
          <td id="LC385"><span>Private</span> <span>Enum</span> <span>UcsTlsLocalFeaturesEnum</span> <span>&#39;--- bitmask</span></td>
        </tr>
        <tr>
          <td id="L386" data-line-number="386"></td>
          <td id="LC386">    <span>ucsTlsSupportTls10</span> <span>=</span> <span>2</span> <span>^</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L387" data-line-number="387"></td>
          <td id="LC387">    <span>ucsTlsSupportTls11</span> <span>=</span> <span>2</span> <span>^</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L388" data-line-number="388"></td>
          <td id="LC388">    <span>ucsTlsSupportTls12</span> <span>=</span> <span>2</span> <span>^</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L389" data-line-number="389"></td>
          <td id="LC389">    <span>ucsTlsSupportTls13</span> <span>=</span> <span>2</span> <span>^</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L390" data-line-number="390"></td>
          <td id="LC390">    <span>ucsTlsIgnoreServerCertificateErrors</span> <span>=</span> <span>2</span> <span>^</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L391" data-line-number="391"></td>
          <td id="LC391">    <span>ucsTlsSupportAll</span> <span>=</span> <span>ucsTlsSupportTls10</span> <span>Or</span> <span>ucsTlsSupportTls11</span> <span>Or</span> <span>ucsTlsSupportTls12</span> <span>Or</span> <span>ucsTlsSupportTls13</span></td>
        </tr>
        <tr>
          <td id="L392" data-line-number="392"></td>
          <td id="LC392"><span>End</span> <span>Enum</span></td>
        </tr>
        <tr>
          <td id="L393" data-line-number="393"></td>
          <td id="LC393">
</td>
        </tr>
        <tr>
          <td id="L394" data-line-number="394"></td>
          <td id="LC394"><span>Private</span> <span>Enum</span> <span>UcsTlsStatesEnum</span> <span>&#39;--- sync w/ STR_VL_STATES</span></td>
        </tr>
        <tr>
          <td id="L395" data-line-number="395"></td>
          <td id="LC395">    <span>ucsTlsStateNew</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L396" data-line-number="396"></td>
          <td id="LC396">    <span>ucsTlsStateClosed</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L397" data-line-number="397"></td>
          <td id="LC397">    <span>ucsTlsStateHandshakeStart</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L398" data-line-number="398"></td>
          <td id="LC398">    <span>ucsTlsStateExpectServerHello</span> <span>=</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L399" data-line-number="399"></td>
          <td id="LC399">    <span>ucsTlsStateExpectEncryptedExtensions</span> <span>=</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L400" data-line-number="400"></td>
          <td id="LC400">    <span>ucsTlsStateExpectServerFinished</span> <span>=</span> <span>5</span>     <span>&#39;--- not used in TLS 1.3</span></td>
        </tr>
        <tr>
          <td id="L401" data-line-number="401"></td>
          <td id="LC401"><span>#</span><span>If</span> <span>ImplTlsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L402" data-line-number="402"></td>
          <td id="LC402">    <span>ucsTlsStateExpectClientHello</span> <span>=</span> <span>6</span></td>
        </tr>
        <tr>
          <td id="L403" data-line-number="403"></td>
          <td id="LC403">    <span>ucsTlsStateExpectClientKeyExchange</span> <span>=</span> <span>7</span>  <span>&#39;--- not used in TLS 1.3</span></td>
        </tr>
        <tr>
          <td id="L404" data-line-number="404"></td>
          <td id="LC404">    <span>ucsTlsStateExpectClientFinished</span> <span>=</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L405" data-line-number="405"></td>
          <td id="LC405"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L406" data-line-number="406"></td>
          <td id="LC406">    <span>ucsTlsStatePostHandshake</span> <span>=</span> <span>9</span></td>
        </tr>
        <tr>
          <td id="L407" data-line-number="407"></td>
          <td id="LC407">    <span>ucsTlsStateShutdown</span> <span>=</span> <span>10</span></td>
        </tr>
        <tr>
          <td id="L408" data-line-number="408"></td>
          <td id="LC408"><span>End</span> <span>Enum</span></td>
        </tr>
        <tr>
          <td id="L409" data-line-number="409"></td>
          <td id="LC409">
</td>
        </tr>
        <tr>
          <td id="L410" data-line-number="410"></td>
          <td id="LC410"><span>Private</span> <span>Enum</span> <span>UcsTlsCryptoAlgorithmsEnum</span></td>
        </tr>
        <tr>
          <td id="L411" data-line-number="411"></td>
          <td id="LC411">    <span>&#39;--- key exchange</span></td>
        </tr>
        <tr>
          <td id="L412" data-line-number="412"></td>
          <td id="LC412">    <span>ucsTlsAlgoExchX25519</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L413" data-line-number="413"></td>
          <td id="LC413">    <span>ucsTlsAlgoExchSecp256r1</span></td>
        </tr>
        <tr>
          <td id="L414" data-line-number="414"></td>
          <td id="LC414">    <span>ucsTlsAlgoExchSecp384r1</span></td>
        </tr>
        <tr>
          <td id="L415" data-line-number="415"></td>
          <td id="LC415">    <span>ucsTlsAlgoExchSecp521r1</span></td>
        </tr>
        <tr>
          <td id="L416" data-line-number="416"></td>
          <td id="LC416">    <span>ucsTlsAlgoExchCertificate</span></td>
        </tr>
        <tr>
          <td id="L417" data-line-number="417"></td>
          <td id="LC417">    <span>&#39;--- ciphers</span></td>
        </tr>
        <tr>
          <td id="L418" data-line-number="418"></td>
          <td id="LC418">    <span>ucsTlsAlgoBulkChacha20Poly1305</span> <span>=</span> <span>11</span> <span>&#39;--- next 3 are authenticated encryption w/ additional data</span></td>
        </tr>
        <tr>
          <td id="L419" data-line-number="419"></td>
          <td id="LC419">    <span>ucsTlsAlgoBulkAesGcm128</span></td>
        </tr>
        <tr>
          <td id="L420" data-line-number="420"></td>
          <td id="LC420">    <span>ucsTlsAlgoBulkAesGcm256</span></td>
        </tr>
        <tr>
          <td id="L421" data-line-number="421"></td>
          <td id="LC421">    <span>ucsTlsAlgoBulkAesCbc128</span>             <span>&#39;--- next 2 are legacy non-AEAD</span></td>
        </tr>
        <tr>
          <td id="L422" data-line-number="422"></td>
          <td id="LC422">    <span>ucsTlsAlgoBulkAesCbc256</span></td>
        </tr>
        <tr>
          <td id="L423" data-line-number="423"></td>
          <td id="LC423">    <span>&#39;--- hash</span></td>
        </tr>
        <tr>
          <td id="L424" data-line-number="424"></td>
          <td id="LC424">    <span>ucsTlsAlgoDigestMd5</span> <span>=</span> <span>21</span></td>
        </tr>
        <tr>
          <td id="L425" data-line-number="425"></td>
          <td id="LC425">    <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L426" data-line-number="426"></td>
          <td id="LC426">    <span>ucsTlsAlgoDigestSha224</span></td>
        </tr>
        <tr>
          <td id="L427" data-line-number="427"></td>
          <td id="LC427">    <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L428" data-line-number="428"></td>
          <td id="LC428">    <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L429" data-line-number="429"></td>
          <td id="LC429">    <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L430" data-line-number="430"></td>
          <td id="LC430">    <span>&#39;--- padding</span></td>
        </tr>
        <tr>
          <td id="L431" data-line-number="431"></td>
          <td id="LC431">    <span>ucsTlsAlgoPaddingPkcs</span> <span>=</span> <span>31</span></td>
        </tr>
        <tr>
          <td id="L432" data-line-number="432"></td>
          <td id="LC432">    <span>ucsTlsAlgoPaddingPss</span></td>
        </tr>
        <tr>
          <td id="L433" data-line-number="433"></td>
          <td id="LC433"><span>End</span> <span>Enum</span></td>
        </tr>
        <tr>
          <td id="L434" data-line-number="434"></td>
          <td id="LC434">
</td>
        </tr>
        <tr>
          <td id="L435" data-line-number="435"></td>
          <td id="LC435"><span>&#39;--- TLS Alerts https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-6</span></td>
        </tr>
        <tr>
          <td id="L436" data-line-number="436"></td>
          <td id="LC436"><span>Private</span> <span>Enum</span> <span>UcsTlsAlertDescriptionsEnum</span></td>
        </tr>
        <tr>
          <td id="L437" data-line-number="437"></td>
          <td id="LC437">    <span>uscTlsAlertCloseNotify</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L438" data-line-number="438"></td>
          <td id="LC438">    <span>uscTlsAlertUnexpectedMessage</span> <span>=</span> <span>10</span></td>
        </tr>
        <tr>
          <td id="L439" data-line-number="439"></td>
          <td id="LC439">    <span>uscTlsAlertBadRecordMac</span> <span>=</span> <span>20</span></td>
        </tr>
        <tr>
          <td id="L440" data-line-number="440"></td>
          <td id="LC440">    <span>uscTlsAlertRecordOverflow</span> <span>=</span> <span>22</span></td>
        </tr>
        <tr>
          <td id="L441" data-line-number="441"></td>
          <td id="LC441">    <span>uscTlsAlertHandshakeFailure</span> <span>=</span> <span>40</span></td>
        </tr>
        <tr>
          <td id="L442" data-line-number="442"></td>
          <td id="LC442">    <span>uscTlsAlertBadCertificate</span> <span>=</span> <span>42</span></td>
        </tr>
        <tr>
          <td id="L443" data-line-number="443"></td>
          <td id="LC443">    <span>uscTlsAlertCertificateRevoked</span> <span>=</span> <span>44</span></td>
        </tr>
        <tr>
          <td id="L444" data-line-number="444"></td>
          <td id="LC444">    <span>uscTlsAlertCertificateExpired</span> <span>=</span> <span>45</span></td>
        </tr>
        <tr>
          <td id="L445" data-line-number="445"></td>
          <td id="LC445">    <span>uscTlsAlertCertificateUnknown</span> <span>=</span> <span>46</span></td>
        </tr>
        <tr>
          <td id="L446" data-line-number="446"></td>
          <td id="LC446">    <span>uscTlsAlertIllegalParameter</span> <span>=</span> <span>47</span></td>
        </tr>
        <tr>
          <td id="L447" data-line-number="447"></td>
          <td id="LC447">    <span>uscTlsAlertUnknownCa</span> <span>=</span> <span>48</span></td>
        </tr>
        <tr>
          <td id="L448" data-line-number="448"></td>
          <td id="LC448">    <span>uscTlsAlertDecodeError</span> <span>=</span> <span>50</span></td>
        </tr>
        <tr>
          <td id="L449" data-line-number="449"></td>
          <td id="LC449">    <span>uscTlsAlertDecryptError</span> <span>=</span> <span>51</span></td>
        </tr>
        <tr>
          <td id="L450" data-line-number="450"></td>
          <td id="LC450">    <span>uscTlsAlertProtocolVersion</span> <span>=</span> <span>70</span></td>
        </tr>
        <tr>
          <td id="L451" data-line-number="451"></td>
          <td id="LC451">    <span>uscTlsAlertInternalError</span> <span>=</span> <span>80</span></td>
        </tr>
        <tr>
          <td id="L452" data-line-number="452"></td>
          <td id="LC452">    <span>uscTlsAlertUserCanceled</span> <span>=</span> <span>90</span></td>
        </tr>
        <tr>
          <td id="L453" data-line-number="453"></td>
          <td id="LC453">    <span>uscTlsAlertNoRenegotiation</span> <span>=</span> <span>100</span></td>
        </tr>
        <tr>
          <td id="L454" data-line-number="454"></td>
          <td id="LC454">    <span>uscTlsAlertMissingExtension</span> <span>=</span> <span>109</span></td>
        </tr>
        <tr>
          <td id="L455" data-line-number="455"></td>
          <td id="LC455">    <span>uscTlsAlertUnrecognizedName</span> <span>=</span> <span>112</span></td>
        </tr>
        <tr>
          <td id="L456" data-line-number="456"></td>
          <td id="LC456">    <span>uscTlsAlertCertificateRequired</span> <span>=</span> <span>116</span></td>
        </tr>
        <tr>
          <td id="L457" data-line-number="457"></td>
          <td id="LC457">    <span>uscTlsAlertNoApplicationProtocol</span> <span>=</span> <span>120</span></td>
        </tr>
        <tr>
          <td id="L458" data-line-number="458"></td>
          <td id="LC458"><span>End</span> <span>Enum</span></td>
        </tr>
        <tr>
          <td id="L459" data-line-number="459"></td>
          <td id="LC459">
</td>
        </tr>
        <tr>
          <td id="L460" data-line-number="460"></td>
          <td id="LC460"><span>Private</span> <span>Type</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L461" data-line-number="461"></td>
          <td id="LC461">    <span>Data()</span>              <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L462" data-line-number="462"></td>
          <td id="LC462">    <span>Pos</span>                 <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L463" data-line-number="463"></td>
          <td id="LC463">    <span>Size</span>                <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L464" data-line-number="464"></td>
          <td id="LC464">    <span>Stack</span>               <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L465" data-line-number="465"></td>
          <td id="LC465"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L466" data-line-number="466"></td>
          <td id="LC466">
</td>
        </tr>
        <tr>
          <td id="L467" data-line-number="467"></td>
          <td id="LC467"><span>Public</span> <span>Type</span> <span>UcsTlsContext</span></td>
        </tr>
        <tr>
          <td id="L468" data-line-number="468"></td>
          <td id="LC468">    <span>&#39;--- config</span></td>
        </tr>
        <tr>
          <td id="L469" data-line-number="469"></td>
          <td id="LC469">    <span>IsServer</span>            <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L470" data-line-number="470"></td>
          <td id="LC470">    <span>RemoteHostName</span>      <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L471" data-line-number="471"></td>
          <td id="LC471">    <span>LocalFeatures</span>       <span>As</span> <span>UcsTlsLocalFeaturesEnum</span></td>
        </tr>
        <tr>
          <td id="L472" data-line-number="472"></td>
          <td id="LC472">    <span>ClientCertCallback</span>  <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L473" data-line-number="473"></td>
          <td id="LC473">    <span>AlpnProtocols</span>       <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L474" data-line-number="474"></td>
          <td id="LC474">    <span>&#39;--- state</span></td>
        </tr>
        <tr>
          <td id="L475" data-line-number="475"></td>
          <td id="LC475">    <span>State</span>               <span>As</span> <span>UcsTlsStatesEnum</span></td>
        </tr>
        <tr>
          <td id="L476" data-line-number="476"></td>
          <td id="LC476">    <span>LastErrNumber</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L477" data-line-number="477"></td>
          <td id="LC477">    <span>LastError</span>           <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L478" data-line-number="478"></td>
          <td id="LC478">    <span>LastErrSource</span>       <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L479" data-line-number="479"></td>
          <td id="LC479">    <span>LastAlertCode</span>       <span>As</span> <span>UcsTlsAlertDescriptionsEnum</span></td>
        </tr>
        <tr>
          <td id="L480" data-line-number="480"></td>
          <td id="LC480">    <span>BlocksStack</span>         <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L481" data-line-number="481"></td>
          <td id="LC481">    <span>AlpnNegotiated</span>      <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L482" data-line-number="482"></td>
          <td id="LC482">    <span>SniRequested</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L483" data-line-number="483"></td>
          <td id="LC483">    <span>PrevRecordType</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L484" data-line-number="484"></td>
          <td id="LC484">    <span>&#39;--- handshake</span></td>
        </tr>
        <tr>
          <td id="L485" data-line-number="485"></td>
          <td id="LC485">    <span>ProtocolVersion</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L486" data-line-number="486"></td>
          <td id="LC486">    <span>LocalSessionID()</span>    <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L487" data-line-number="487"></td>
          <td id="LC487">    <span>LocalSessionTicket()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L488" data-line-number="488"></td>
          <td id="LC488">    <span>LocalExchRandom()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L489" data-line-number="489"></td>
          <td id="LC489">    <span>LocalExchPrivate()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L490" data-line-number="490"></td>
          <td id="LC490">    <span>LocalExchPublic()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L491" data-line-number="491"></td>
          <td id="LC491">    <span>LocalExchRsaEncrPriv()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L492" data-line-number="492"></td>
          <td id="LC492">    <span>LocalCertificates</span>   <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L493" data-line-number="493"></td>
          <td id="LC493">    <span>LocalPrivateKey</span>     <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L494" data-line-number="494"></td>
          <td id="LC494">    <span>LocalLegacyVerifyData()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L495" data-line-number="495"></td>
          <td id="LC495">    <span>RemoteProtocolVersion</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L496" data-line-number="496"></td>
          <td id="LC496">    <span>RemoteSessionID()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L497" data-line-number="497"></td>
          <td id="LC497">    <span>RemoteExchRandom()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L498" data-line-number="498"></td>
          <td id="LC498">    <span>RemoteExchPublic()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L499" data-line-number="499"></td>
          <td id="LC499">    <span>RemoteCertificates</span>  <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L500" data-line-number="500"></td>
          <td id="LC500">    <span>RemoteExtensions</span>    <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L501" data-line-number="501"></td>
          <td id="LC501">    <span>RemoteTickets</span>       <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L502" data-line-number="502"></td>
          <td id="LC502">    <span>RemoteSupportedGroups</span> <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L503" data-line-number="503"></td>
          <td id="LC503">    <span>RemoteCertStatuses</span>  <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L504" data-line-number="504"></td>
          <td id="LC504">    <span>RemoteLegacyVerifyData()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L505" data-line-number="505"></td>
          <td id="LC505">    <span>RemoteLegacyRenegInfo()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L506" data-line-number="506"></td>
          <td id="LC506">    <span>&#39;--- crypto settings</span></td>
        </tr>
        <tr>
          <td id="L507" data-line-number="507"></td>
          <td id="LC507">    <span>ExchGroup</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L508" data-line-number="508"></td>
          <td id="LC508">    <span>ExchAlgo</span>            <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum</span></td>
        </tr>
        <tr>
          <td id="L509" data-line-number="509"></td>
          <td id="LC509">    <span>CipherSuite</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L510" data-line-number="510"></td>
          <td id="LC510">    <span>SignatureScheme</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L511" data-line-number="511"></td>
          <td id="LC511">    <span>MacAlgo</span>             <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum</span>   <span>&#39;--- not used w/ AEAD ciphers</span></td>
        </tr>
        <tr>
          <td id="L512" data-line-number="512"></td>
          <td id="LC512">    <span>MacSize</span>             <span>As</span> <span>Long</span>                         <span>&#39;--- not used w/ AEAD ciphers</span></td>
        </tr>
        <tr>
          <td id="L513" data-line-number="513"></td>
          <td id="LC513">    <span>BulkAlgo</span>            <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum</span></td>
        </tr>
        <tr>
          <td id="L514" data-line-number="514"></td>
          <td id="LC514">    <span>KeySize</span>             <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L515" data-line-number="515"></td>
          <td id="LC515">    <span>IvSize</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L516" data-line-number="516"></td>
          <td id="LC516">    <span>IvExplicitSize</span>      <span>As</span> <span>Long</span>                         <span>&#39;--- only for AES in TLS 1.2</span></td>
        </tr>
        <tr>
          <td id="L517" data-line-number="517"></td>
          <td id="LC517">    <span>TagSize</span>             <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L518" data-line-number="518"></td>
          <td id="LC518">    <span>DigestAlgo</span>          <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum</span></td>
        </tr>
        <tr>
          <td id="L519" data-line-number="519"></td>
          <td id="LC519">    <span>DigestSize</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L520" data-line-number="520"></td>
          <td id="LC520">    <span>UseRsaKeyTransport</span>  <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L521" data-line-number="521"></td>
          <td id="LC521">    <span>&#39;--- bulk secrets</span></td>
        </tr>
        <tr>
          <td id="L522" data-line-number="522"></td>
          <td id="LC522">    <span>HandshakeMessages</span>   <span>As</span> <span>UcsBuffer</span>                    <span>&#39;--- ToDo: reduce to HandshakeHash only</span></td>
        </tr>
        <tr>
          <td id="L523" data-line-number="523"></td>
          <td id="LC523">    <span>HandshakeSecret()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L524" data-line-number="524"></td>
          <td id="LC524">    <span>MasterSecret()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L525" data-line-number="525"></td>
          <td id="LC525">    <span>LocalMacKey()</span>       <span>As</span> <span>Byte</span>                         <span>&#39;--- not used w/ AEAD ciphers</span></td>
        </tr>
        <tr>
          <td id="L526" data-line-number="526"></td>
          <td id="LC526">    <span>RemoteMacKey()</span>      <span>As</span> <span>Byte</span>                         <span>&#39;--- not used w/ AEAD ciphers</span></td>
        </tr>
        <tr>
          <td id="L527" data-line-number="527"></td>
          <td id="LC527">    <span>RemoteTrafficSecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L528" data-line-number="528"></td>
          <td id="LC528">    <span>RemoteTrafficKey()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L529" data-line-number="529"></td>
          <td id="LC529">    <span>RemoteTrafficIV()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L530" data-line-number="530"></td>
          <td id="LC530">    <span>RemoteTrafficSeqNo</span>  <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L531" data-line-number="531"></td>
          <td id="LC531">    <span>RemoteEncryptThenMac</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L532" data-line-number="532"></td>
          <td id="LC532">    <span>RemoteLegacyNextMacKey()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L533" data-line-number="533"></td>
          <td id="LC533">    <span>RemoteLegacyNextTrafficKey()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L534" data-line-number="534"></td>
          <td id="LC534">    <span>RemoteLegacyNextTrafficIV()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L535" data-line-number="535"></td>
          <td id="LC535">    <span>LocalTrafficSecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L536" data-line-number="536"></td>
          <td id="LC536">    <span>LocalTrafficKey()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L537" data-line-number="537"></td>
          <td id="LC537">    <span>LocalTrafficIV()</span>    <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L538" data-line-number="538"></td>
          <td id="LC538">    <span>LocalTrafficSeqNo</span>   <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L539" data-line-number="539"></td>
          <td id="LC539">    <span>LocalEncryptThenMac</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L540" data-line-number="540"></td>
          <td id="LC540">    <span>LocalLegacyNextMacKey()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L541" data-line-number="541"></td>
          <td id="LC541">    <span>LocalLegacyNextTrafficKey()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L542" data-line-number="542"></td>
          <td id="LC542">    <span>LocalLegacyNextTrafficIV()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L543" data-line-number="543"></td>
          <td id="LC543">    <span>&#39;--- hello retry request</span></td>
        </tr>
        <tr>
          <td id="L544" data-line-number="544"></td>
          <td id="LC544">    <span>HelloRetryRequest</span>   <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L545" data-line-number="545"></td>
          <td id="LC545">    <span>HelloRetryCipherSuite</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L546" data-line-number="546"></td>
          <td id="LC546">    <span>HelloRetryExchGroup</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L547" data-line-number="547"></td>
          <td id="LC547">    <span>HelloRetryCookie()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L548" data-line-number="548"></td>
          <td id="LC548">    <span>&#39;--- client certificate request</span></td>
        </tr>
        <tr>
          <td id="L549" data-line-number="549"></td>
          <td id="LC549">    <span>CertRequestContext()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L550" data-line-number="550"></td>
          <td id="LC550">    <span>CertRequestSignatureScheme</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L551" data-line-number="551"></td>
          <td id="LC551">    <span>CertRequestCaDn</span>     <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L552" data-line-number="552"></td>
          <td id="LC552">    <span>&#39;--- I/O buffers</span></td>
        </tr>
        <tr>
          <td id="L553" data-line-number="553"></td>
          <td id="LC553">    <span>RecvBuffer</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L554" data-line-number="554"></td>
          <td id="LC554">    <span>DecrBuffer</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L555" data-line-number="555"></td>
          <td id="LC555">    <span>SendBuffer</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L556" data-line-number="556"></td>
          <td id="LC556">    <span>MessBuffer</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L557" data-line-number="557"></td>
          <td id="LC557"><span>#</span><span>If</span> <span>ImplCaptureTraffic</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L558" data-line-number="558"></td>
          <td id="LC558">    <span>TrafficDump</span>         <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L559" data-line-number="559"></td>
          <td id="LC559"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L560" data-line-number="560"></td>
          <td id="LC560"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L561" data-line-number="561"></td>
          <td id="LC561">
</td>
        </tr>
        <tr>
          <td id="L562" data-line-number="562"></td>
          <td id="LC562"><span>Private</span> <span>Type</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L563" data-line-number="563"></td>
          <td id="LC563">    <span>AlgoObjId</span>           <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L564" data-line-number="564"></td>
          <td id="LC564">    <span>KeyBlob()</span>           <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L565" data-line-number="565"></td>
          <td id="LC565">    <span>BitLen</span>              <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L566" data-line-number="566"></td>
          <td id="LC566">    <span>Modulus()</span>           <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L567" data-line-number="567"></td>
          <td id="LC567">    <span>PubExp()</span>            <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L568" data-line-number="568"></td>
          <td id="LC568">    <span>Prime1()</span>            <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L569" data-line-number="569"></td>
          <td id="LC569">    <span>Prime2()</span>            <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L570" data-line-number="570"></td>
          <td id="LC570">    <span>Coefficient()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L571" data-line-number="571"></td>
          <td id="LC571">    <span>PrivExp()</span>           <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L572" data-line-number="572"></td>
          <td id="LC572">    <span>hNKey</span>               <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L573" data-line-number="573"></td>
          <td id="LC573">    <span>hProv</span>               <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L574" data-line-number="574"></td>
          <td id="LC574">    <span>hKey</span>                <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L575" data-line-number="575"></td>
          <td id="LC575">    <span>dwKeySpec</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L576" data-line-number="576"></td>
          <td id="LC576"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L577" data-line-number="577"></td>
          <td id="LC577">
</td>
        </tr>
        <tr>
          <td id="L578" data-line-number="578"></td>
          <td id="LC578"><span>Private</span> <span>Enum</span> <span>UcsThunkPfnIndexEnum</span></td>
        </tr>
        <tr>
          <td id="L579" data-line-number="579"></td>
          <td id="LC579">    <span>[_ucsPfnNotUsed]</span></td>
        </tr>
        <tr>
          <td id="L580" data-line-number="580"></td>
          <td id="LC580">    <span>ucsPfnCurve25519ScalarMultiply</span></td>
        </tr>
        <tr>
          <td id="L581" data-line-number="581"></td>
          <td id="LC581">    <span>ucsPfnCurve25519ScalarMultBase</span></td>
        </tr>
        <tr>
          <td id="L582" data-line-number="582"></td>
          <td id="LC582">    <span>ucsPfnSecp256r1MakeKey</span></td>
        </tr>
        <tr>
          <td id="L583" data-line-number="583"></td>
          <td id="LC583">    <span>ucsPfnSecp256r1SharedSecret</span></td>
        </tr>
        <tr>
          <td id="L584" data-line-number="584"></td>
          <td id="LC584">    <span>ucsPfnSecp256r1UncompressKey</span></td>
        </tr>
        <tr>
          <td id="L585" data-line-number="585"></td>
          <td id="LC585">    <span>ucsPfnSecp256r1Sign</span></td>
        </tr>
        <tr>
          <td id="L586" data-line-number="586"></td>
          <td id="LC586">    <span>ucsPfnSecp256r1Verify</span></td>
        </tr>
        <tr>
          <td id="L587" data-line-number="587"></td>
          <td id="LC587">    <span>ucsPfnSecp384r1MakeKey</span></td>
        </tr>
        <tr>
          <td id="L588" data-line-number="588"></td>
          <td id="LC588">    <span>ucsPfnSecp384r1SharedSecret</span></td>
        </tr>
        <tr>
          <td id="L589" data-line-number="589"></td>
          <td id="LC589">    <span>ucsPfnSecp384r1UncompressKey</span></td>
        </tr>
        <tr>
          <td id="L590" data-line-number="590"></td>
          <td id="LC590">    <span>ucsPfnSecp384r1Sign</span></td>
        </tr>
        <tr>
          <td id="L591" data-line-number="591"></td>
          <td id="LC591">    <span>ucsPfnSecp384r1Verify</span></td>
        </tr>
        <tr>
          <td id="L592" data-line-number="592"></td>
          <td id="LC592">    <span>ucsPfnSha256Init</span></td>
        </tr>
        <tr>
          <td id="L593" data-line-number="593"></td>
          <td id="LC593">    <span>ucsPfnSha256Update</span></td>
        </tr>
        <tr>
          <td id="L594" data-line-number="594"></td>
          <td id="LC594">    <span>ucsPfnSha256Final</span></td>
        </tr>
        <tr>
          <td id="L595" data-line-number="595"></td>
          <td id="LC595">    <span>ucsPfnSha384Init</span></td>
        </tr>
        <tr>
          <td id="L596" data-line-number="596"></td>
          <td id="LC596">    <span>ucsPfnSha384Update</span></td>
        </tr>
        <tr>
          <td id="L597" data-line-number="597"></td>
          <td id="LC597">    <span>ucsPfnSha384Final</span></td>
        </tr>
        <tr>
          <td id="L598" data-line-number="598"></td>
          <td id="LC598">    <span>ucsPfnSha512Init</span></td>
        </tr>
        <tr>
          <td id="L599" data-line-number="599"></td>
          <td id="LC599">    <span>ucsPfnSha512Update</span></td>
        </tr>
        <tr>
          <td id="L600" data-line-number="600"></td>
          <td id="LC600">    <span>ucsPfnSha512Final</span></td>
        </tr>
        <tr>
          <td id="L601" data-line-number="601"></td>
          <td id="LC601">    <span>ucsPfnChacha20Poly1305Encrypt</span></td>
        </tr>
        <tr>
          <td id="L602" data-line-number="602"></td>
          <td id="LC602">    <span>ucsPfnChacha20Poly1305Decrypt</span></td>
        </tr>
        <tr>
          <td id="L603" data-line-number="603"></td>
          <td id="LC603">    <span>ucsPfnAesGcmEncrypt</span></td>
        </tr>
        <tr>
          <td id="L604" data-line-number="604"></td>
          <td id="LC604">    <span>ucsPfnAesGcmDecrypt</span></td>
        </tr>
        <tr>
          <td id="L605" data-line-number="605"></td>
          <td id="LC605">    <span>ucsPfnAesCbcEncrypt</span></td>
        </tr>
        <tr>
          <td id="L606" data-line-number="606"></td>
          <td id="LC606">    <span>ucsPfnAesCbcDecrypt</span></td>
        </tr>
        <tr>
          <td id="L607" data-line-number="607"></td>
          <td id="LC607">    <span>ucsPfnRsaModExp</span></td>
        </tr>
        <tr>
          <td id="L608" data-line-number="608"></td>
          <td id="LC608">    <span>ucsPfnRsaCrtModExp</span></td>
        </tr>
        <tr>
          <td id="L609" data-line-number="609"></td>
          <td id="LC609">    <span>[_ucsPfnMax]</span></td>
        </tr>
        <tr>
          <td id="L610" data-line-number="610"></td>
          <td id="LC610"><span>End</span> <span>Enum</span></td>
        </tr>
        <tr>
          <td id="L611" data-line-number="611"></td>
          <td id="LC611">
</td>
        </tr>
        <tr>
          <td id="L612" data-line-number="612"></td>
          <td id="LC612"><span>Private</span> <span>Type</span> <span>UcsCryptoData</span></td>
        </tr>
        <tr>
          <td id="L613" data-line-number="613"></td>
          <td id="LC613">    <span>Thunk</span>               <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L614" data-line-number="614"></td>
          <td id="LC614">    <span>Glob()</span>              <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L615" data-line-number="615"></td>
          <td id="LC615">    <span>Pfn(</span><span>1</span> <span>To</span> <span>[_ucsPfnMax]</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L616" data-line-number="616"></td>
          <td id="LC616">    <span>HashCtx(</span><span>0</span> <span>To</span> <span>LNG_SHA384_CONTEXTSZ</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L617" data-line-number="617"></td>
          <td id="LC617">    <span>HashPad(</span><span>0</span> <span>To</span> <span>LNG_SHA512_BLOCKSZ</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L618" data-line-number="618"></td>
          <td id="LC618">    <span>HashFinal(</span><span>0</span> <span>To</span> <span>LNG_SHA512_HASHSZ</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L619" data-line-number="619"></td>
          <td id="LC619">    <span>hRandomProv</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L620" data-line-number="620"></td>
          <td id="LC620"><span>End</span> <span>Type</span></td>
        </tr>
        <tr>
          <td id="L621" data-line-number="621"></td>
          <td id="LC621">
</td>
        </tr>
        <tr>
          <td id="L622" data-line-number="622"></td>
          <td id="LC622"><span>#</span><span>If</span> <span>Not</span> <span>ImplUseShared</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L623" data-line-number="623"></td>
          <td id="LC623"><span>Private</span> <span>Enum</span> <span>UcsOsVersionEnum</span></td>
        </tr>
        <tr>
          <td id="L624" data-line-number="624"></td>
          <td id="LC624">    <span>ucsOsvNt4</span> <span>=</span> <span>400</span></td>
        </tr>
        <tr>
          <td id="L625" data-line-number="625"></td>
          <td id="LC625">    <span>ucsOsvWin98</span> <span>=</span> <span>410</span></td>
        </tr>
        <tr>
          <td id="L626" data-line-number="626"></td>
          <td id="LC626">    <span>ucsOsvWin2000</span> <span>=</span> <span>500</span></td>
        </tr>
        <tr>
          <td id="L627" data-line-number="627"></td>
          <td id="LC627">    <span>ucsOsvXp</span> <span>=</span> <span>501</span></td>
        </tr>
        <tr>
          <td id="L628" data-line-number="628"></td>
          <td id="LC628">    <span>ucsOsvVista</span> <span>=</span> <span>600</span></td>
        </tr>
        <tr>
          <td id="L629" data-line-number="629"></td>
          <td id="LC629">    <span>ucsOsvWin7</span> <span>=</span> <span>601</span></td>
        </tr>
        <tr>
          <td id="L630" data-line-number="630"></td>
          <td id="LC630">    <span>ucsOsvWin8</span> <span>=</span> <span>602</span></td>
        </tr>
        <tr>
          <td id="L631" data-line-number="631"></td>
          <td id="LC631">    [<span>ucsOsvWin8</span><span>.1</span>] <span>=</span> <span>603</span></td>
        </tr>
        <tr>
          <td id="L632" data-line-number="632"></td>
          <td id="LC632">    <span>ucsOsvWin10</span> <span>=</span> <span>1000</span></td>
        </tr>
        <tr>
          <td id="L633" data-line-number="633"></td>
          <td id="LC633"><span>End</span> <span>Enum</span></td>
        </tr>
        <tr>
          <td id="L634" data-line-number="634"></td>
          <td id="LC634"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L635" data-line-number="635"></td>
          <td id="LC635">
</td>
        </tr>
        <tr>
          <td id="L636" data-line-number="636"></td>
          <td id="LC636"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L637" data-line-number="637"></td>
          <td id="LC637"><span>&#39; Error handling</span></td>
        </tr>
        <tr>
          <td id="L638" data-line-number="638"></td>
          <td id="LC638"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L639" data-line-number="639"></td>
          <td id="LC639">
</td>
        </tr>
        <tr>
          <td id="L640" data-line-number="640"></td>
          <td id="LC640"><span>Private</span> <span>Sub</span> <span>ErrRaise(</span><span>ByVal</span> <span>Number</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>Source</span> <span>As</span> <span>Variant</span><span>,</span> <span>Optional</span> <span>Description</span> <span>As</span> <span>Variant</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L641" data-line-number="641"></td>
          <td id="LC641">    <span>Err.Raise</span> <span>Number,</span> <span>Source,</span> <span>Description</span></td>
        </tr>
        <tr>
          <td id="L642" data-line-number="642"></td>
          <td id="LC642"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L643" data-line-number="643"></td>
          <td id="LC643">
</td>
        </tr>
        <tr>
          <td id="L644" data-line-number="644"></td>
          <td id="LC644"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L645" data-line-number="645"></td>
          <td id="LC645"><span>&#39; Properties</span></td>
        </tr>
        <tr>
          <td id="L646" data-line-number="646"></td>
          <td id="LC646"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L647" data-line-number="647"></td>
          <td id="LC647">
</td>
        </tr>
        <tr>
          <td id="L648" data-line-number="648"></td>
          <td id="LC648"><span>Public</span> <span>Property</span> <span>Get</span> <span>TlsIsClosed(uCtx</span> <span>As</span> <span>UcsTlsContext)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L649" data-line-number="649"></td>
          <td id="LC649">    <span>TlsIsClosed</span> <span>=</span> <span>(uCtx.State</span> <span>=</span> <span>ucsTlsStateClosed)</span></td>
        </tr>
        <tr>
          <td id="L650" data-line-number="650"></td>
          <td id="LC650"><span>End</span> <span>Property</span></td>
        </tr>
        <tr>
          <td id="L651" data-line-number="651"></td>
          <td id="LC651">
</td>
        </tr>
        <tr>
          <td id="L652" data-line-number="652"></td>
          <td id="LC652"><span>Public</span> <span>Property</span> <span>Get</span> <span>TlsIsStarted(uCtx</span> <span>As</span> <span>UcsTlsContext)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L653" data-line-number="653"></td>
          <td id="LC653">    <span>TlsIsStarted</span> <span>=</span> <span>(uCtx.State</span> <span>&gt;</span> <span>ucsTlsStateClosed)</span></td>
        </tr>
        <tr>
          <td id="L654" data-line-number="654"></td>
          <td id="LC654"><span>End</span> <span>Property</span></td>
        </tr>
        <tr>
          <td id="L655" data-line-number="655"></td>
          <td id="LC655">
</td>
        </tr>
        <tr>
          <td id="L656" data-line-number="656"></td>
          <td id="LC656"><span>Public</span> <span>Property</span> <span>Get</span> <span>TlsIsReady(uCtx</span> <span>As</span> <span>UcsTlsContext)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L657" data-line-number="657"></td>
          <td id="LC657">    <span>TlsIsReady</span> <span>=</span> <span>(uCtx.State</span> <span>&gt;=</span> <span>ucsTlsStatePostHandshake)</span></td>
        </tr>
        <tr>
          <td id="L658" data-line-number="658"></td>
          <td id="LC658"><span>End</span> <span>Property</span></td>
        </tr>
        <tr>
          <td id="L659" data-line-number="659"></td>
          <td id="LC659">
</td>
        </tr>
        <tr>
          <td id="L660" data-line-number="660"></td>
          <td id="LC660"><span>Public</span> <span>Property</span> <span>Get</span> <span>TlsIsShutdown(uCtx</span> <span>As</span> <span>UcsTlsContext)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L661" data-line-number="661"></td>
          <td id="LC661">    <span>TlsIsShutdown</span> <span>=</span> <span>(uCtx.State</span> <span>=</span> <span>ucsTlsStateShutdown)</span></td>
        </tr>
        <tr>
          <td id="L662" data-line-number="662"></td>
          <td id="LC662"><span>End</span> <span>Property</span></td>
        </tr>
        <tr>
          <td id="L663" data-line-number="663"></td>
          <td id="LC663">
</td>
        </tr>
        <tr>
          <td id="L664" data-line-number="664"></td>
          <td id="LC664"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L665" data-line-number="665"></td>
          <td id="LC665"><span>&#39; TLS support</span></td>
        </tr>
        <tr>
          <td id="L666" data-line-number="666"></td>
          <td id="LC666"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L667" data-line-number="667"></td>
          <td id="LC667">
</td>
        </tr>
        <tr>
          <td id="L668" data-line-number="668"></td>
          <td id="LC668"><span>Public</span> <span>Function</span> <span>TlsInitClient(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L669" data-line-number="669"></td>
          <td id="LC669">            <span>uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L670" data-line-number="670"></td>
          <td id="LC670">            <span>Optional</span> <span>RemoteHostName</span> <span>As</span> <span>String</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L671" data-line-number="671"></td>
          <td id="LC671">            <span>Optional</span> <span>ByVal</span> <span>LocalFeatures</span> <span>As</span> <span>Long</span> <span>=</span> <span>ucsTlsSupportAll,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L672" data-line-number="672"></td>
          <td id="LC672">            <span>Optional</span> <span>ClientCertCallback</span> <span>As</span> <span>Object</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L673" data-line-number="673"></td>
          <td id="LC673">            <span>Optional</span> <span>AlpnProtocols</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L674" data-line-number="674"></td>
          <td id="LC674">    <span>Dim</span> <span>uEmpty</span>          <span>As</span> <span>UcsTlsContext</span></td>
        </tr>
        <tr>
          <td id="L675" data-line-number="675"></td>
          <td id="LC675">    </td>
        </tr>
        <tr>
          <td id="L676" data-line-number="676"></td>
          <td id="LC676">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L677" data-line-number="677"></td>
          <td id="LC677">    <span>If</span> <span>Not</span> <span>pvCryptoInit()</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L678" data-line-number="678"></td>
          <td id="LC678">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L679" data-line-number="679"></td>
          <td id="LC679">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L680" data-line-number="680"></td>
          <td id="LC680">    <span>With</span> <span>uEmpty</span></td>
        </tr>
        <tr>
          <td id="L681" data-line-number="681"></td>
          <td id="LC681">        <span>pvTlsClearLastError</span> <span>uEmpty</span></td>
        </tr>
        <tr>
          <td id="L682" data-line-number="682"></td>
          <td id="LC682">        <span>.State</span> <span>=</span> <span>ucsTlsStateHandshakeStart</span></td>
        </tr>
        <tr>
          <td id="L683" data-line-number="683"></td>
          <td id="LC683">        <span>.RemoteHostName</span> <span>=</span> <span>RemoteHostName</span></td>
        </tr>
        <tr>
          <td id="L684" data-line-number="684"></td>
          <td id="LC684">        <span>.LocalFeatures</span> <span>=</span> <span>LocalFeatures</span></td>
        </tr>
        <tr>
          <td id="L685" data-line-number="685"></td>
          <td id="LC685">        <span>.ClientCertCallback</span> <span>=</span> <span>ObjPtr(ClientCertCallback)</span></td>
        </tr>
        <tr>
          <td id="L686" data-line-number="686"></td>
          <td id="LC686">        <span>.AlpnProtocols</span> <span>=</span> <span>AlpnProtocols</span></td>
        </tr>
        <tr>
          <td id="L687" data-line-number="687"></td>
          <td id="LC687">        <span>#</span><span>If</span> <span>ImplCaptureTraffic</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L688" data-line-number="688"></td>
          <td id="LC688">            <span>Set</span> <span>.TrafficDump</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L689" data-line-number="689"></td>
          <td id="LC689">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L690" data-line-number="690"></td>
          <td id="LC690">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L691" data-line-number="691"></td>
          <td id="LC691">    <span>uCtx</span> <span>=</span> <span>uEmpty</span></td>
        </tr>
        <tr>
          <td id="L692" data-line-number="692"></td>
          <td id="LC692">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L693" data-line-number="693"></td>
          <td id="LC693">    <span>TlsInitClient</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L694" data-line-number="694"></td>
          <td id="LC694"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L695" data-line-number="695"></td>
          <td id="LC695">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L696" data-line-number="696"></td>
          <td id="LC696"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L697" data-line-number="697"></td>
          <td id="LC697">    <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>Err.Number,</span> <span>Err.Source,</span> <span>Err.Description</span></td>
        </tr>
        <tr>
          <td id="L698" data-line-number="698"></td>
          <td id="LC698">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L699" data-line-number="699"></td>
          <td id="LC699"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L700" data-line-number="700"></td>
          <td id="LC700">
</td>
        </tr>
        <tr>
          <td id="L701" data-line-number="701"></td>
          <td id="LC701"><span>Public</span> <span>Function</span> <span>TlsInitServer(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L702" data-line-number="702"></td>
          <td id="LC702">            <span>uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L703" data-line-number="703"></td>
          <td id="LC703">            <span>Optional</span> <span>RemoteHostName</span> <span>As</span> <span>String</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L704" data-line-number="704"></td>
          <td id="LC704">            <span>Optional</span> <span>Certificates</span> <span>As</span> <span>Collection,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L705" data-line-number="705"></td>
          <td id="LC705">            <span>Optional</span> <span>PrivateKey</span> <span>As</span> <span>Collection,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L706" data-line-number="706"></td>
          <td id="LC706">            <span>Optional</span> <span>AlpnProtocols</span> <span>As</span> <span>String</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L707" data-line-number="707"></td>
          <td id="LC707">            <span>Optional</span> <span>ByVal</span> <span>LocalFeatures</span> <span>As</span> <span>Long</span> <span>=</span> <span>ucsTlsSupportAll)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L708" data-line-number="708"></td>
          <td id="LC708"><span>#</span><span>If</span> <span>Not</span> <span>ImplTlsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L709" data-line-number="709"></td>
          <td id="LC709">    <span>ErrRaise</span> <span>vbObjectError,</span> <span>,</span> <span>ERR_NO_SERVER_COMPILED</span></td>
        </tr>
        <tr>
          <td id="L710" data-line-number="710"></td>
          <td id="LC710"><span>#</span><span>Else</span></td>
        </tr>
        <tr>
          <td id="L711" data-line-number="711"></td>
          <td id="LC711">    <span>Dim</span> <span>uEmpty</span>          <span>As</span> <span>UcsTlsContext</span></td>
        </tr>
        <tr>
          <td id="L712" data-line-number="712"></td>
          <td id="LC712">    </td>
        </tr>
        <tr>
          <td id="L713" data-line-number="713"></td>
          <td id="LC713">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L714" data-line-number="714"></td>
          <td id="LC714">    <span>If</span> <span>Not</span> <span>pvCryptoInit()</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L715" data-line-number="715"></td>
          <td id="LC715">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L716" data-line-number="716"></td>
          <td id="LC716">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L717" data-line-number="717"></td>
          <td id="LC717">    <span>With</span> <span>uEmpty</span></td>
        </tr>
        <tr>
          <td id="L718" data-line-number="718"></td>
          <td id="LC718">        <span>pvTlsClearLastError</span> <span>uEmpty</span></td>
        </tr>
        <tr>
          <td id="L719" data-line-number="719"></td>
          <td id="LC719">        <span>.IsServer</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L720" data-line-number="720"></td>
          <td id="LC720">        <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientHello</span></td>
        </tr>
        <tr>
          <td id="L721" data-line-number="721"></td>
          <td id="LC721">        <span>.RemoteHostName</span> <span>=</span> <span>RemoteHostName</span></td>
        </tr>
        <tr>
          <td id="L722" data-line-number="722"></td>
          <td id="LC722">        <span>.LocalFeatures</span> <span>=</span> <span>LocalFeatures</span></td>
        </tr>
        <tr>
          <td id="L723" data-line-number="723"></td>
          <td id="LC723">        <span>Set</span> <span>.LocalCertificates</span> <span>=</span> <span>Certificates</span></td>
        </tr>
        <tr>
          <td id="L724" data-line-number="724"></td>
          <td id="LC724">        <span>Set</span> <span>.LocalPrivateKey</span> <span>=</span> <span>PrivateKey</span></td>
        </tr>
        <tr>
          <td id="L725" data-line-number="725"></td>
          <td id="LC725">        <span>.AlpnProtocols</span> <span>=</span> <span>AlpnProtocols</span></td>
        </tr>
        <tr>
          <td id="L726" data-line-number="726"></td>
          <td id="LC726">        <span>#</span><span>If</span> <span>ImplCaptureTraffic</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L727" data-line-number="727"></td>
          <td id="LC727">            <span>Set</span> <span>.TrafficDump</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L728" data-line-number="728"></td>
          <td id="LC728">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L729" data-line-number="729"></td>
          <td id="LC729">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L730" data-line-number="730"></td>
          <td id="LC730">    <span>uCtx</span> <span>=</span> <span>uEmpty</span></td>
        </tr>
        <tr>
          <td id="L731" data-line-number="731"></td>
          <td id="LC731">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L732" data-line-number="732"></td>
          <td id="LC732">    <span>TlsInitServer</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L733" data-line-number="733"></td>
          <td id="LC733"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L734" data-line-number="734"></td>
          <td id="LC734">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L735" data-line-number="735"></td>
          <td id="LC735"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L736" data-line-number="736"></td>
          <td id="LC736">    <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>Err.Number,</span> <span>Err.Source,</span> <span>Err.Description</span></td>
        </tr>
        <tr>
          <td id="L737" data-line-number="737"></td>
          <td id="LC737">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L738" data-line-number="738"></td>
          <td id="LC738"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L739" data-line-number="739"></td>
          <td id="LC739"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L740" data-line-number="740"></td>
          <td id="LC740">
</td>
        </tr>
        <tr>
          <td id="L741" data-line-number="741"></td>
          <td id="LC741"><span>Public</span> <span>Function</span> <span>TlsTerminate(uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L742" data-line-number="742"></td>
          <td id="LC742">    <span>uCtx.State</span> <span>=</span> <span>ucsTlsStateClosed</span></td>
        </tr>
        <tr>
          <td id="L743" data-line-number="743"></td>
          <td id="LC743"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L744" data-line-number="744"></td>
          <td id="LC744">
</td>
        </tr>
        <tr>
          <td id="L745" data-line-number="745"></td>
          <td id="LC745"><span>Public</span> <span>Function</span> <span>TlsHandshake(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>baOutput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lOutputPos</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L746" data-line-number="746"></td>
          <td id="LC746">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TlsHandshake&#34;</span></td>
        </tr>
        <tr>
          <td id="L747" data-line-number="747"></td>
          <td id="LC747">    </td>
        </tr>
        <tr>
          <td id="L748" data-line-number="748"></td>
          <td id="LC748">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L749" data-line-number="749"></td>
          <td id="LC749">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L750" data-line-number="750"></td>
          <td id="LC750">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateClosed</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L751" data-line-number="751"></td>
          <td id="LC751">            <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>vbObjectError,</span> <span>MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>FUNC_NAME,</span> <span>ERR_CONNECTION_CLOSED</span></td>
        </tr>
        <tr>
          <td id="L752" data-line-number="752"></td>
          <td id="LC752">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L753" data-line-number="753"></td>
          <td id="LC753">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L754" data-line-number="754"></td>
          <td id="LC754">        <span>pvTlsClearLastError</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L755" data-line-number="755"></td>
          <td id="LC755">        <span>&#39;--- swap-in</span></td>
        </tr>
        <tr>
          <td id="L756" data-line-number="756"></td>
          <td id="LC756">        <span>pvArraySwap</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size,</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L757" data-line-number="757"></td>
          <td id="LC757">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateHandshakeStart</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L758" data-line-number="758"></td>
          <td id="LC758">            <span>pvTlsBuildClientHello</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L759" data-line-number="759"></td>
          <td id="LC759">            <span>.State</span> <span>=</span> <span>ucsTlsStateExpectServerHello</span></td>
        </tr>
        <tr>
          <td id="L760" data-line-number="760"></td>
          <td id="LC760">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L761" data-line-number="761"></td>
          <td id="LC761">            <span>If</span> <span>lSize</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L762" data-line-number="762"></td>
          <td id="LC762">                <span>lSize</span> <span>=</span> <span>pvArraySize(baInput)</span></td>
        </tr>
        <tr>
          <td id="L763" data-line-number="763"></td>
          <td id="LC763">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L764" data-line-number="764"></td>
          <td id="LC764">            <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L765" data-line-number="765"></td>
          <td id="LC765">                <span>If</span> <span>lSize</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L766" data-line-number="766"></td>
          <td id="LC766">                    <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Input&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baInput,</span> <span>Size:=lSize)</span></td>
        </tr>
        <tr>
          <td id="L767" data-line-number="767"></td>
          <td id="LC767">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L768" data-line-number="768"></td>
          <td id="LC768">            <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L769" data-line-number="769"></td>
          <td id="LC769">            <span>If</span> <span>Not</span> <span>pvTlsParsePayload(uCtx,</span> <span>baInput,</span> <span>lSize,</span> <span>.LastError,</span> <span>.LastAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L770" data-line-number="770"></td>
          <td id="LC770">                <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>vbObjectError,</span> <span>MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>FUNC_NAME,</span> <span>.LastError,</span> <span>.LastAlertCode</span></td>
        </tr>
        <tr>
          <td id="L771" data-line-number="771"></td>
          <td id="LC771">                <span>&#39;--- treat as warnings</span></td>
        </tr>
        <tr>
          <td id="L772" data-line-number="772"></td>
          <td id="LC772">                <span>If</span> <span>.LastAlertCode</span> <span>=</span> <span>uscTlsAlertCertificateUnknown</span> <span>Or</span> <span>.LastAlertCode</span> <span>=</span> <span>uscTlsAlertBadCertificate</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L773" data-line-number="773"></td>
          <td id="LC773">                    <span>TlsHandshake</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L774" data-line-number="774"></td>
          <td id="LC774">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L775" data-line-number="775"></td>
          <td id="LC775">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L776" data-line-number="776"></td>
          <td id="LC776">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L777" data-line-number="777"></td>
          <td id="LC777">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L778" data-line-number="778"></td>
          <td id="LC778">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L779" data-line-number="779"></td>
          <td id="LC779">        <span>TlsHandshake</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L780" data-line-number="780"></td>
          <td id="LC780"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L781" data-line-number="781"></td>
          <td id="LC781">        <span>&#39;--- swap-out</span></td>
        </tr>
        <tr>
          <td id="L782" data-line-number="782"></td>
          <td id="LC782">        <span>pvArraySwap</span> <span>baOutput,</span> <span>lOutputPos,</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size</span></td>
        </tr>
        <tr>
          <td id="L783" data-line-number="783"></td>
          <td id="LC783">        <span>pvArrayWriteEOF</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L784" data-line-number="784"></td>
          <td id="LC784">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L785" data-line-number="785"></td>
          <td id="LC785">            <span>If</span> <span>lOutputPos</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L786" data-line-number="786"></td>
          <td id="LC786">                <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Output&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baOutput,</span> <span>Size:=lOutputPos)</span></td>
        </tr>
        <tr>
          <td id="L787" data-line-number="787"></td>
          <td id="LC787">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L788" data-line-number="788"></td>
          <td id="LC788">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L789" data-line-number="789"></td>
          <td id="LC789">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L790" data-line-number="790"></td>
          <td id="LC790">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L791" data-line-number="791"></td>
          <td id="LC791"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L792" data-line-number="792"></td>
          <td id="LC792">    <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>Err.Number,</span> <span>Err.Source,</span> <span>Err.Description</span></td>
        </tr>
        <tr>
          <td id="L793" data-line-number="793"></td>
          <td id="LC793">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L794" data-line-number="794"></td>
          <td id="LC794"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L795" data-line-number="795"></td>
          <td id="LC795">
</td>
        </tr>
        <tr>
          <td id="L796" data-line-number="796"></td>
          <td id="LC796"><span>Public</span> <span>Function</span> <span>TlsReceive(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>baPlainText()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>baOutput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lOutputPos</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L797" data-line-number="797"></td>
          <td id="LC797">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TlsReceive&#34;</span></td>
        </tr>
        <tr>
          <td id="L798" data-line-number="798"></td>
          <td id="LC798">    </td>
        </tr>
        <tr>
          <td id="L799" data-line-number="799"></td>
          <td id="LC799">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L800" data-line-number="800"></td>
          <td id="LC800">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L801" data-line-number="801"></td>
          <td id="LC801">        <span>If</span> <span>lSize</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L802" data-line-number="802"></td>
          <td id="LC802">            <span>lSize</span> <span>=</span> <span>pvArraySize(baInput)</span></td>
        </tr>
        <tr>
          <td id="L803" data-line-number="803"></td>
          <td id="LC803">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L804" data-line-number="804"></td>
          <td id="LC804">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L805" data-line-number="805"></td>
          <td id="LC805">            <span>If</span> <span>lSize</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L806" data-line-number="806"></td>
          <td id="LC806">                <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Input (undecrypted)&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baInput,</span> <span>Size:=lSize)</span></td>
        </tr>
        <tr>
          <td id="L807" data-line-number="807"></td>
          <td id="LC807">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L808" data-line-number="808"></td>
          <td id="LC808">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L809" data-line-number="809"></td>
          <td id="LC809">        <span>If</span> <span>lSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L810" data-line-number="810"></td>
          <td id="LC810">            <span>&#39;--- flush</span></td>
        </tr>
        <tr>
          <td id="L811" data-line-number="811"></td>
          <td id="LC811">            <span>If</span> <span>.DecrBuffer.Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L812" data-line-number="812"></td>
          <td id="LC812">                <span>If</span> <span>lPos</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L813" data-line-number="813"></td>
          <td id="LC813">                    <span>pvArraySwap</span> <span>.DecrBuffer.Data,</span> <span>.DecrBuffer.Size,</span> <span>baPlainText,</span> <span>lPos</span></td>
        </tr>
        <tr>
          <td id="L814" data-line-number="814"></td>
          <td id="LC814">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L815" data-line-number="815"></td>
          <td id="LC815">                    <span>lPos</span> <span>=</span> <span>pvArrayWriteBlob(baPlainText,</span> <span>lPos,</span> <span>VarPtr(.DecrBuffer.Data(</span><span>0</span><span>)),</span> <span>.DecrBuffer.Size)</span></td>
        </tr>
        <tr>
          <td id="L816" data-line-number="816"></td>
          <td id="LC816">                    <span>Call</span> <span>pvArrayWriteEOF(baPlainText,</span> <span>lPos)</span></td>
        </tr>
        <tr>
          <td id="L817" data-line-number="817"></td>
          <td id="LC817">                    <span>.DecrBuffer.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L818" data-line-number="818"></td>
          <td id="LC818">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L819" data-line-number="819"></td>
          <td id="LC819">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L820" data-line-number="820"></td>
          <td id="LC820">            <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L821" data-line-number="821"></td>
          <td id="LC821">            <span>TlsReceive</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L822" data-line-number="822"></td>
          <td id="LC822">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L823" data-line-number="823"></td>
          <td id="LC823">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L824" data-line-number="824"></td>
          <td id="LC824">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateClosed</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L825" data-line-number="825"></td>
          <td id="LC825">            <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>vbObjectError,</span> <span>MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>FUNC_NAME,</span> <span>ERR_CONNECTION_CLOSED</span></td>
        </tr>
        <tr>
          <td id="L826" data-line-number="826"></td>
          <td id="LC826">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L827" data-line-number="827"></td>
          <td id="LC827">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L828" data-line-number="828"></td>
          <td id="LC828">        <span>pvTlsClearLastError</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L829" data-line-number="829"></td>
          <td id="LC829">        <span>&#39;--- swap-in</span></td>
        </tr>
        <tr>
          <td id="L830" data-line-number="830"></td>
          <td id="LC830">        <span>pvArraySwap</span> <span>.DecrBuffer.Data,</span> <span>.DecrBuffer.Size,</span> <span>baPlainText,</span> <span>lPos</span></td>
        </tr>
        <tr>
          <td id="L831" data-line-number="831"></td>
          <td id="LC831">        <span>pvArraySwap</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size,</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L832" data-line-number="832"></td>
          <td id="LC832">        <span>If</span> <span>Not</span> <span>pvTlsParsePayload(uCtx,</span> <span>baInput,</span> <span>lSize,</span> <span>.LastError,</span> <span>.LastAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L833" data-line-number="833"></td>
          <td id="LC833">            <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>vbObjectError,</span> <span>MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>FUNC_NAME,</span> <span>.LastError,</span> <span>.LastAlertCode</span></td>
        </tr>
        <tr>
          <td id="L834" data-line-number="834"></td>
          <td id="LC834">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L835" data-line-number="835"></td>
          <td id="LC835">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L836" data-line-number="836"></td>
          <td id="LC836">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L837" data-line-number="837"></td>
          <td id="LC837">        <span>TlsReceive</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L838" data-line-number="838"></td>
          <td id="LC838"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L839" data-line-number="839"></td>
          <td id="LC839">        <span>&#39;--- swap-out</span></td>
        </tr>
        <tr>
          <td id="L840" data-line-number="840"></td>
          <td id="LC840">        <span>pvArraySwap</span> <span>baPlainText,</span> <span>lPos,</span> <span>.DecrBuffer.Data,</span> <span>.DecrBuffer.Size</span></td>
        </tr>
        <tr>
          <td id="L841" data-line-number="841"></td>
          <td id="LC841">        <span>pvArrayWriteEOF</span> <span>baPlainText,</span> <span>lPos</span></td>
        </tr>
        <tr>
          <td id="L842" data-line-number="842"></td>
          <td id="LC842">        <span>pvArraySwap</span> <span>baOutput,</span> <span>lOutputPos,</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size</span></td>
        </tr>
        <tr>
          <td id="L843" data-line-number="843"></td>
          <td id="LC843">        <span>pvArrayWriteEOF</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L844" data-line-number="844"></td>
          <td id="LC844">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L845" data-line-number="845"></td>
          <td id="LC845">            <span>If</span> <span>lOutputPos</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L846" data-line-number="846"></td>
          <td id="LC846">                <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Output (encrypted)&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baOutput,</span> <span>Size:=lOutputPos)</span></td>
        </tr>
        <tr>
          <td id="L847" data-line-number="847"></td>
          <td id="LC847">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L848" data-line-number="848"></td>
          <td id="LC848">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L849" data-line-number="849"></td>
          <td id="LC849">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L850" data-line-number="850"></td>
          <td id="LC850">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L851" data-line-number="851"></td>
          <td id="LC851"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L852" data-line-number="852"></td>
          <td id="LC852">    <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>Err.Number,</span> <span>Err.Source,</span> <span>Err.Description</span></td>
        </tr>
        <tr>
          <td id="L853" data-line-number="853"></td>
          <td id="LC853">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L854" data-line-number="854"></td>
          <td id="LC854"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L855" data-line-number="855"></td>
          <td id="LC855">
</td>
        </tr>
        <tr>
          <td id="L856" data-line-number="856"></td>
          <td id="LC856"><span>Public</span> <span>Function</span> <span>TlsSend(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baPlainText()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>baOutput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lOutputPos</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L857" data-line-number="857"></td>
          <td id="LC857">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TlsSend&#34;</span></td>
        </tr>
        <tr>
          <td id="L858" data-line-number="858"></td>
          <td id="LC858">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L859" data-line-number="859"></td>
          <td id="LC859">    </td>
        </tr>
        <tr>
          <td id="L860" data-line-number="860"></td>
          <td id="LC860">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L861" data-line-number="861"></td>
          <td id="LC861">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L862" data-line-number="862"></td>
          <td id="LC862">        <span>If</span> <span>lSize</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L863" data-line-number="863"></td>
          <td id="LC863">            <span>lSize</span> <span>=</span> <span>pvArraySize(baPlainText)</span></td>
        </tr>
        <tr>
          <td id="L864" data-line-number="864"></td>
          <td id="LC864">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L865" data-line-number="865"></td>
          <td id="LC865">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateClosed</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L866" data-line-number="866"></td>
          <td id="LC866">            <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>vbObjectError,</span> <span>MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>FUNC_NAME,</span> <span>ERR_CONNECTION_CLOSED</span></td>
        </tr>
        <tr>
          <td id="L867" data-line-number="867"></td>
          <td id="LC867">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L868" data-line-number="868"></td>
          <td id="LC868">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L869" data-line-number="869"></td>
          <td id="LC869">        <span>pvTlsClearLastError</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L870" data-line-number="870"></td>
          <td id="LC870">        <span>&#39;--- swap-in</span></td>
        </tr>
        <tr>
          <td id="L871" data-line-number="871"></td>
          <td id="LC871">        <span>pvArraySwap</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size,</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L872" data-line-number="872"></td>
          <td id="LC872">        <span>Do</span> <span>While</span> <span>lPos</span> <span>&lt;</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L873" data-line-number="873"></td>
          <td id="LC873">            <span>pvTlsBuildApplicationData</span> <span>uCtx,</span> <span>.SendBuffer,</span> <span>baPlainText,</span> <span>lPos,</span> <span>Clamp(lSize</span> <span>-</span> <span>lPos,</span> <span>0</span><span>,</span> <span>TLS_MAX_PLAINTEXT_RECORD_SIZE),</span> <span>TLS_CONTENT_TYPE_APPDATA</span></td>
        </tr>
        <tr>
          <td id="L874" data-line-number="874"></td>
          <td id="LC874">            <span>lPos</span> <span>=</span> <span>lPos</span> <span>+</span> <span>TLS_MAX_PLAINTEXT_RECORD_SIZE</span></td>
        </tr>
        <tr>
          <td id="L875" data-line-number="875"></td>
          <td id="LC875">        <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L876" data-line-number="876"></td>
          <td id="LC876">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L877" data-line-number="877"></td>
          <td id="LC877">        <span>TlsSend</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L878" data-line-number="878"></td>
          <td id="LC878"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L879" data-line-number="879"></td>
          <td id="LC879">        <span>&#39;--- swap-out</span></td>
        </tr>
        <tr>
          <td id="L880" data-line-number="880"></td>
          <td id="LC880">        <span>pvArraySwap</span> <span>baOutput,</span> <span>lOutputPos,</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size</span></td>
        </tr>
        <tr>
          <td id="L881" data-line-number="881"></td>
          <td id="LC881">        <span>pvArrayWriteEOF</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L882" data-line-number="882"></td>
          <td id="LC882">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L883" data-line-number="883"></td>
          <td id="LC883">            <span>If</span> <span>lOutputPos</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L884" data-line-number="884"></td>
          <td id="LC884">                <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Output (encrypted)&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baOutput,</span> <span>Size:=lOutputPos)</span></td>
        </tr>
        <tr>
          <td id="L885" data-line-number="885"></td>
          <td id="LC885">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L886" data-line-number="886"></td>
          <td id="LC886">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L887" data-line-number="887"></td>
          <td id="LC887">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L888" data-line-number="888"></td>
          <td id="LC888">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L889" data-line-number="889"></td>
          <td id="LC889"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L890" data-line-number="890"></td>
          <td id="LC890">    <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>Err.Number,</span> <span>Err.Source,</span> <span>Err.Description</span></td>
        </tr>
        <tr>
          <td id="L891" data-line-number="891"></td>
          <td id="LC891">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L892" data-line-number="892"></td>
          <td id="LC892"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L893" data-line-number="893"></td>
          <td id="LC893">
</td>
        </tr>
        <tr>
          <td id="L894" data-line-number="894"></td>
          <td id="LC894"><span>Public</span> <span>Function</span> <span>TlsShutdown(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baOutput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lOutputPos</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L895" data-line-number="895"></td>
          <td id="LC895">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L896" data-line-number="896"></td>
          <td id="LC896">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L897" data-line-number="897"></td>
          <td id="LC897">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateClosed</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L898" data-line-number="898"></td>
          <td id="LC898">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L899" data-line-number="899"></td>
          <td id="LC899">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L900" data-line-number="900"></td>
          <td id="LC900">        <span>pvTlsClearLastError</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L901" data-line-number="901"></td>
          <td id="LC901">        <span>&#39;--- swap-in</span></td>
        </tr>
        <tr>
          <td id="L902" data-line-number="902"></td>
          <td id="LC902">        <span>pvArraySwap</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size,</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L903" data-line-number="903"></td>
          <td id="LC903">        <span>pvTlsBuildAlert</span> <span>uCtx,</span> <span>.SendBuffer,</span> <span>uscTlsAlertCloseNotify,</span> <span>TLS_ALERT_LEVEL_WARNING</span></td>
        </tr>
        <tr>
          <td id="L904" data-line-number="904"></td>
          <td id="LC904">        <span>.State</span> <span>=</span> <span>ucsTlsStateShutdown</span></td>
        </tr>
        <tr>
          <td id="L905" data-line-number="905"></td>
          <td id="LC905">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L906" data-line-number="906"></td>
          <td id="LC906">        <span>TlsShutdown</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L907" data-line-number="907"></td>
          <td id="LC907"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L908" data-line-number="908"></td>
          <td id="LC908">        <span>&#39;--- swap-out</span></td>
        </tr>
        <tr>
          <td id="L909" data-line-number="909"></td>
          <td id="LC909">        <span>pvArraySwap</span> <span>baOutput,</span> <span>lOutputPos,</span> <span>.SendBuffer.Data,</span> <span>.SendBuffer.Size</span></td>
        </tr>
        <tr>
          <td id="L910" data-line-number="910"></td>
          <td id="LC910">        <span>pvArrayWriteEOF</span> <span>baOutput,</span> <span>lOutputPos</span></td>
        </tr>
        <tr>
          <td id="L911" data-line-number="911"></td>
          <td id="LC911">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L912" data-line-number="912"></td>
          <td id="LC912">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L913" data-line-number="913"></td>
          <td id="LC913"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L914" data-line-number="914"></td>
          <td id="LC914">    <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>Err.Number,</span> <span>Err.Source,</span> <span>Err.Description</span></td>
        </tr>
        <tr>
          <td id="L915" data-line-number="915"></td>
          <td id="LC915">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L916" data-line-number="916"></td>
          <td id="LC916"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L917" data-line-number="917"></td>
          <td id="LC917">
</td>
        </tr>
        <tr>
          <td id="L918" data-line-number="918"></td>
          <td id="LC918"><span>Public</span> <span>Function</span> <span>TlsGetLastError(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>Optional</span> <span>LastErrNumber</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>LastErrSource</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L919" data-line-number="919"></td>
          <td id="LC919">    <span>LastErrNumber</span> <span>=</span> <span>uCtx.LastErrNumber</span></td>
        </tr>
        <tr>
          <td id="L920" data-line-number="920"></td>
          <td id="LC920">    <span>LastErrSource</span> <span>=</span> <span>uCtx.LastErrSource</span></td>
        </tr>
        <tr>
          <td id="L921" data-line-number="921"></td>
          <td id="LC921">    <span>TlsGetLastError</span> <span>=</span> <span>uCtx.LastError</span></td>
        </tr>
        <tr>
          <td id="L922" data-line-number="922"></td>
          <td id="LC922">    <span>If</span> <span>uCtx.LastAlertCode</span> <span>&lt;&gt;</span> <span>-</span><span>1</span> <span>And</span> <span>uCtx.LastAlertCode</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L923" data-line-number="923"></td>
          <td id="LC923">        <span>TlsGetLastError</span> <span>=</span> <span>IIf(LenB(TlsGetLastError)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TlsGetLastError</span> <span>&amp;</span> <span>&#34;. &#34;</span><span>,</span> <span>vbNullString)</span> <span>&amp;</span> <span>Replace(STR_FORMAT_ALERT,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetLastAlert(uCtx))</span></td>
        </tr>
        <tr>
          <td id="L924" data-line-number="924"></td>
          <td id="LC924">        <span>&#39;--- warnings</span></td>
        </tr>
        <tr>
          <td id="L925" data-line-number="925"></td>
          <td id="LC925">        <span>Select</span> <span>Case</span> <span>uCtx.LastAlertCode</span></td>
        </tr>
        <tr>
          <td id="L926" data-line-number="926"></td>
          <td id="LC926">        <span>Case</span> <span>uscTlsAlertCloseNotify,</span> <span>uscTlsAlertUserCanceled,</span> <span>uscTlsAlertNoRenegotiation</span></td>
        </tr>
        <tr>
          <td id="L927" data-line-number="927"></td>
          <td id="LC927">            <span>LastErrNumber</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L928" data-line-number="928"></td>
          <td id="LC928">        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L929" data-line-number="929"></td>
          <td id="LC929">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L930" data-line-number="930"></td>
          <td id="LC930"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L931" data-line-number="931"></td>
          <td id="LC931">
</td>
        </tr>
        <tr>
          <td id="L932" data-line-number="932"></td>
          <td id="LC932"><span>Private</span> <span>Function</span> <span>pvTlsGetLastAlert(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>Optional</span> <span>AlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L933" data-line-number="933"></td>
          <td id="LC933">    <span>Static</span> <span>vTexts</span>       <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L934" data-line-number="934"></td>
          <td id="LC934">    </td>
        </tr>
        <tr>
          <td id="L935" data-line-number="935"></td>
          <td id="LC935">    <span>AlertCode</span> <span>=</span> <span>uCtx.LastAlertCode</span></td>
        </tr>
        <tr>
          <td id="L936" data-line-number="936"></td>
          <td id="LC936">    <span>If</span> <span>AlertCode</span> <span>&gt;=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L937" data-line-number="937"></td>
          <td id="LC937">        <span>If</span> <span>IsEmpty(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L938" data-line-number="938"></td>
          <td id="LC938">            <span>vTexts</span> <span>=</span> <span>SplitOrReindex(STR_VL_ALERTS,</span> <span>&#34;|&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L939" data-line-number="939"></td>
          <td id="LC939">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L940" data-line-number="940"></td>
          <td id="LC940">        <span>If</span> <span>AlertCode</span> <span>&lt;=</span> <span>UBound(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L941" data-line-number="941"></td>
          <td id="LC941">            <span>pvTlsGetLastAlert</span> <span>=</span> <span>vTexts(AlertCode)</span></td>
        </tr>
        <tr>
          <td id="L942" data-line-number="942"></td>
          <td id="LC942">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L943" data-line-number="943"></td>
          <td id="LC943">        <span>If</span> <span>LenB(pvTlsGetLastAlert)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L944" data-line-number="944"></td>
          <td id="LC944">            <span>pvTlsGetLastAlert</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>AlertCode)</span></td>
        </tr>
        <tr>
          <td id="L945" data-line-number="945"></td>
          <td id="LC945">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L946" data-line-number="946"></td>
          <td id="LC946">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L947" data-line-number="947"></td>
          <td id="LC947"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L948" data-line-number="948"></td>
          <td id="LC948">
</td>
        </tr>
        <tr>
          <td id="L949" data-line-number="949"></td>
          <td id="LC949"><span>Private</span> <span>Function</span> <span>pvTlsGetStateAsText(</span><span>ByVal</span> <span>lState</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L950" data-line-number="950"></td>
          <td id="LC950">    <span>Static</span> <span>vTexts</span>       <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L951" data-line-number="951"></td>
          <td id="LC951">    </td>
        </tr>
        <tr>
          <td id="L952" data-line-number="952"></td>
          <td id="LC952">    <span>If</span> <span>IsEmpty(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L953" data-line-number="953"></td>
          <td id="LC953">        <span>vTexts</span> <span>=</span> <span>SplitOrReindex(STR_VL_STATES,</span> <span>&#34;|&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L954" data-line-number="954"></td>
          <td id="LC954">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L955" data-line-number="955"></td>
          <td id="LC955">    <span>If</span> <span>0</span> <span>&lt;=</span> <span>lState</span> <span>And</span> <span>lState</span> <span>&lt;=</span> <span>UBound(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L956" data-line-number="956"></td>
          <td id="LC956">        <span>pvTlsGetStateAsText</span> <span>=</span> <span>vTexts(lState)</span></td>
        </tr>
        <tr>
          <td id="L957" data-line-number="957"></td>
          <td id="LC957">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L958" data-line-number="958"></td>
          <td id="LC958">    <span>If</span> <span>LenB(pvTlsGetStateAsText)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L959" data-line-number="959"></td>
          <td id="LC959">        <span>pvTlsGetStateAsText</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lState)</span></td>
        </tr>
        <tr>
          <td id="L960" data-line-number="960"></td>
          <td id="LC960">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L961" data-line-number="961"></td>
          <td id="LC961"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L962" data-line-number="962"></td>
          <td id="LC962">
</td>
        </tr>
        <tr>
          <td id="L963" data-line-number="963"></td>
          <td id="LC963"><span>Private</span> <span>Function</span> <span>pvTlsGetMessageName(</span><span>ByVal</span> <span>lMessageType</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L964" data-line-number="964"></td>
          <td id="LC964">    <span>Static</span> <span>vTexts</span>       <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L965" data-line-number="965"></td>
          <td id="LC965">    </td>
        </tr>
        <tr>
          <td id="L966" data-line-number="966"></td>
          <td id="LC966">    <span>If</span> <span>IsEmpty(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L967" data-line-number="967"></td>
          <td id="LC967">        <span>vTexts</span> <span>=</span> <span>SplitOrReindex(STR_VL_MESSAGE_NAMES,</span> <span>&#34;|&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L968" data-line-number="968"></td>
          <td id="LC968">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L969" data-line-number="969"></td>
          <td id="LC969">    <span>If</span> <span>0</span> <span>&lt;=</span> <span>lMessageType</span> <span>And</span> <span>lMessageType</span> <span>&lt;=</span> <span>UBound(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L970" data-line-number="970"></td>
          <td id="LC970">        <span>pvTlsGetMessageName</span> <span>=</span> <span>vTexts(lMessageType)</span></td>
        </tr>
        <tr>
          <td id="L971" data-line-number="971"></td>
          <td id="LC971">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L972" data-line-number="972"></td>
          <td id="LC972">    <span>If</span> <span>LenB(pvTlsGetMessageName)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L973" data-line-number="973"></td>
          <td id="LC973">        <span>pvTlsGetMessageName</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lMessageType)</span></td>
        </tr>
        <tr>
          <td id="L974" data-line-number="974"></td>
          <td id="LC974">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L975" data-line-number="975"></td>
          <td id="LC975">        <span>pvTlsGetMessageName</span> <span>=</span> <span>pvTlsGetMessageName</span> <span>&amp;</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>lMessageType</span> <span>&amp;</span> <span>&#34;)&#34;</span></td>
        </tr>
        <tr>
          <td id="L976" data-line-number="976"></td>
          <td id="LC976">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L977" data-line-number="977"></td>
          <td id="LC977"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L978" data-line-number="978"></td>
          <td id="LC978">
</td>
        </tr>
        <tr>
          <td id="L979" data-line-number="979"></td>
          <td id="LC979"><span>Private</span> <span>Function</span> <span>pvTlsGetExtensionName(</span><span>ByVal</span> <span>lExtType</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L980" data-line-number="980"></td>
          <td id="LC980">    <span>Static</span> <span>vTexts</span>       <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L981" data-line-number="981"></td>
          <td id="LC981">    </td>
        </tr>
        <tr>
          <td id="L982" data-line-number="982"></td>
          <td id="LC982">    <span>If</span> <span>IsEmpty(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L983" data-line-number="983"></td>
          <td id="LC983">        <span>vTexts</span> <span>=</span> <span>SplitOrReindex(STR_VL_EXTENSION_NAMES,</span> <span>&#34;|&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L984" data-line-number="984"></td>
          <td id="LC984">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L985" data-line-number="985"></td>
          <td id="LC985">    <span>If</span> <span>0</span> <span>&lt;=</span> <span>lExtType</span> <span>And</span> <span>lExtType</span> <span>&lt;=</span> <span>UBound(vTexts)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L986" data-line-number="986"></td>
          <td id="LC986">        <span>pvTlsGetExtensionName</span> <span>=</span> <span>vTexts(lExtType)</span></td>
        </tr>
        <tr>
          <td id="L987" data-line-number="987"></td>
          <td id="LC987">    <span>ElseIf</span> <span>lExtType</span> <span>=</span> <span>&amp;HFF01&amp;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L988" data-line-number="988"></td>
          <td id="LC988">        <span>pvTlsGetExtensionName</span> <span>=</span> <span>&#34;renegotiation_info&#34;</span></td>
        </tr>
        <tr>
          <td id="L989" data-line-number="989"></td>
          <td id="LC989">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L990" data-line-number="990"></td>
          <td id="LC990">    <span>If</span> <span>LenB(pvTlsGetExtensionName)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L991" data-line-number="991"></td>
          <td id="LC991">        <span>pvTlsGetExtensionName</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lExtType)</span></td>
        </tr>
        <tr>
          <td id="L992" data-line-number="992"></td>
          <td id="LC992">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L993" data-line-number="993"></td>
          <td id="LC993">        <span>pvTlsGetExtensionName</span> <span>=</span> <span>pvTlsGetExtensionName</span> <span>&amp;</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>lExtType</span> <span>&amp;</span> <span>&#34;)&#34;</span></td>
        </tr>
        <tr>
          <td id="L994" data-line-number="994"></td>
          <td id="LC994">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L995" data-line-number="995"></td>
          <td id="LC995"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L996" data-line-number="996"></td>
          <td id="LC996">
</td>
        </tr>
        <tr>
          <td id="L997" data-line-number="997"></td>
          <td id="LC997"><span>Private</span> <span>Sub</span> <span>pvTlsBuildClientHello(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L998" data-line-number="998"></td>
          <td id="LC998">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L999" data-line-number="999"></td>
          <td id="LC999">    <span>Dim</span> <span>vElem</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L1000" data-line-number="1000"></td>
          <td id="LC1000">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1001" data-line-number="1001"></td>
          <td id="LC1001">    </td>
        </tr>
        <tr>
          <td id="L1002" data-line-number="1002"></td>
          <td id="LC1002">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1003" data-line-number="1003"></td>
          <td id="LC1003">        <span>If</span> <span>(.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>.ExchGroup</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1004" data-line-number="1004"></td>
          <td id="LC1004">            <span>&#39;--- populate preferred .ExchGroup and .LocalExchPublic</span></td>
        </tr>
        <tr>
          <td id="L1005" data-line-number="1005"></td>
          <td id="LC1005">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchX25519)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1006" data-line-number="1006"></td>
          <td id="LC1006">                <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>TLS_GROUP_X25519</span></td>
        </tr>
        <tr>
          <td id="L1007" data-line-number="1007"></td>
          <td id="LC1007">            <span>ElseIf</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1008" data-line-number="1008"></td>
          <td id="LC1008">                <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>TLS_GROUP_SECP256R1</span></td>
        </tr>
        <tr>
          <td id="L1009" data-line-number="1009"></td>
          <td id="LC1009">            <span>ElseIf</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1010" data-line-number="1010"></td>
          <td id="LC1010">                <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>TLS_GROUP_SECP384R1</span></td>
        </tr>
        <tr>
          <td id="L1011" data-line-number="1011"></td>
          <td id="LC1011">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1012" data-line-number="1012"></td>
          <td id="LC1012">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1013" data-line-number="1013"></td>
          <td id="LC1013">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1014" data-line-number="1014"></td>
          <td id="LC1014">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1015" data-line-number="1015"></td>
          <td id="LC1015">            <span>&#39;--- Handshake Header</span></td>
        </tr>
        <tr>
          <td id="L1016" data-line-number="1016"></td>
          <td id="LC1016">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1017" data-line-number="1017"></td>
          <td id="LC1017">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CLIENT_HELLO</span></td>
        </tr>
        <tr>
          <td id="L1018" data-line-number="1018"></td>
          <td id="LC1018">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1019" data-line-number="1019"></td>
          <td id="LC1019">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_LOCAL_LEGACY_VERSION,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1020" data-line-number="1020"></td>
          <td id="LC1020">                <span>pvTlsGetRandom</span> <span>.LocalExchRandom,</span> <span>TLS_HELLO_RANDOM_SIZE</span></td>
        </tr>
        <tr>
          <td id="L1021" data-line-number="1021"></td>
          <td id="LC1021">                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L1022" data-line-number="1022"></td>
          <td id="LC1022">                <span>&#39;--- Legacy Session ID</span></td>
        </tr>
        <tr>
          <td id="L1023" data-line-number="1023"></td>
          <td id="LC1023">                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1024" data-line-number="1024"></td>
          <td id="LC1024">                    <span>If</span> <span>pvArraySize(.LocalSessionID)</span> <span>=</span> <span>0</span> <span>And</span> <span>(.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1025" data-line-number="1025"></td>
          <td id="LC1025">                        <span>&#39;--- non-empty for TLS 1.2 compatibility</span></td>
        </tr>
        <tr>
          <td id="L1026" data-line-number="1026"></td>
          <td id="LC1026">                        <span>pvTlsGetRandom</span> <span>baTemp,</span> <span>TLS_HELLO_RANDOM_SIZE</span></td>
        </tr>
        <tr>
          <td id="L1027" data-line-number="1027"></td>
          <td id="LC1027">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L1028" data-line-number="1028"></td>
          <td id="LC1028">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1029" data-line-number="1029"></td>
          <td id="LC1029">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalSessionID</span></td>
        </tr>
        <tr>
          <td id="L1030" data-line-number="1030"></td>
          <td id="LC1030">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1031" data-line-number="1031"></td>
          <td id="LC1031">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1032" data-line-number="1032"></td>
          <td id="LC1032">                <span>&#39;--- Cipher Suites</span></td>
        </tr>
        <tr>
          <td id="L1033" data-line-number="1033"></td>
          <td id="LC1033">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1034" data-line-number="1034"></td>
          <td id="LC1034">                    <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>pvTlsGetSortedCipherSuites(.LocalFeatures)</span></td>
        </tr>
        <tr>
          <td id="L1035" data-line-number="1035"></td>
          <td id="LC1035">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>vElem,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1036" data-line-number="1036"></td>
          <td id="LC1036">                    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1037" data-line-number="1037"></td>
          <td id="LC1037">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1038" data-line-number="1038"></td>
          <td id="LC1038">                <span>&#39;--- Legacy Compression Methods</span></td>
        </tr>
        <tr>
          <td id="L1039" data-line-number="1039"></td>
          <td id="LC1039">                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1040" data-line-number="1040"></td>
          <td id="LC1040">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_COMPRESS_NULL</span></td>
        </tr>
        <tr>
          <td id="L1041" data-line-number="1041"></td>
          <td id="LC1041">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1042" data-line-number="1042"></td>
          <td id="LC1042">                <span>&#39;--- Extensions</span></td>
        </tr>
        <tr>
          <td id="L1043" data-line-number="1043"></td>
          <td id="LC1043">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1044" data-line-number="1044"></td>
          <td id="LC1044">                    <span>If</span> <span>LenB(.RemoteHostName)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1045" data-line-number="1045"></td>
          <td id="LC1045">                        <span>&#39;--- Extension - Server Name</span></td>
        </tr>
        <tr>
          <td id="L1046" data-line-number="1046"></td>
          <td id="LC1046">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_SERVER_NAME,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1047" data-line-number="1047"></td>
          <td id="LC1047">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1048" data-line-number="1048"></td>
          <td id="LC1048">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1049" data-line-number="1049"></td>
          <td id="LC1049">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SERVER_NAME_TYPE_HOSTNAME</span> <span>&#39;--- FQDN</span></td>
        </tr>
        <tr>
          <td id="L1050" data-line-number="1050"></td>
          <td id="LC1050">                                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1051" data-line-number="1051"></td>
          <td id="LC1051">                                    <span>pvBufferWriteString</span> <span>uOutput,</span> <span>.RemoteHostName</span></td>
        </tr>
        <tr>
          <td id="L1052" data-line-number="1052"></td>
          <td id="LC1052">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1053" data-line-number="1053"></td>
          <td id="LC1053">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1054" data-line-number="1054"></td>
          <td id="LC1054">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1055" data-line-number="1055"></td>
          <td id="LC1055">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1056" data-line-number="1056"></td>
          <td id="LC1056">                    <span>If</span> <span>LenB(.AlpnProtocols)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1057" data-line-number="1057"></td>
          <td id="LC1057">                        <span>&#39;--- Extension - ALPN</span></td>
        </tr>
        <tr>
          <td id="L1058" data-line-number="1058"></td>
          <td id="LC1058">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_ALPN,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1059" data-line-number="1059"></td>
          <td id="LC1059">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1060" data-line-number="1060"></td>
          <td id="LC1060">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1061" data-line-number="1061"></td>
          <td id="LC1061">                                <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>Split(.AlpnProtocols,</span> <span>&#34;|&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1062" data-line-number="1062"></td>
          <td id="LC1062">                                    <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1063" data-line-number="1063"></td>
          <td id="LC1063">                                        <span>pvBufferWriteString</span> <span>uOutput,</span> <span>Left$(vElem,</span> <span>255</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1064" data-line-number="1064"></td>
          <td id="LC1064">                                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1065" data-line-number="1065"></td>
          <td id="LC1065">                                <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1066" data-line-number="1066"></td>
          <td id="LC1066">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1067" data-line-number="1067"></td>
          <td id="LC1067">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1068" data-line-number="1068"></td>
          <td id="LC1068">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1069" data-line-number="1069"></td>
          <td id="LC1069">                    <span>&#39;--- Extension - Supported Groups</span></td>
        </tr>
        <tr>
          <td id="L1070" data-line-number="1070"></td>
          <td id="LC1070">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_SUPPORTED_GROUPS,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1071" data-line-number="1071"></td>
          <td id="LC1071">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1072" data-line-number="1072"></td>
          <td id="LC1072">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1073" data-line-number="1073"></td>
          <td id="LC1073">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchX25519)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1074" data-line-number="1074"></td>
          <td id="LC1074">                                <span>If</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>0</span> <span>Or</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>TLS_GROUP_X25519</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1075" data-line-number="1075"></td>
          <td id="LC1075">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_GROUP_X25519,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1076" data-line-number="1076"></td>
          <td id="LC1076">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1077" data-line-number="1077"></td>
          <td id="LC1077">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1078" data-line-number="1078"></td>
          <td id="LC1078">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1079" data-line-number="1079"></td>
          <td id="LC1079">                                <span>If</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>0</span> <span>Or</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>TLS_GROUP_SECP256R1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1080" data-line-number="1080"></td>
          <td id="LC1080">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_GROUP_SECP256R1,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1081" data-line-number="1081"></td>
          <td id="LC1081">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1082" data-line-number="1082"></td>
          <td id="LC1082">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1083" data-line-number="1083"></td>
          <td id="LC1083">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1084" data-line-number="1084"></td>
          <td id="LC1084">                                <span>If</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>0</span> <span>Or</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>TLS_GROUP_SECP384R1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1085" data-line-number="1085"></td>
          <td id="LC1085">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_GROUP_SECP384R1,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1086" data-line-number="1086"></td>
          <td id="LC1086">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1087" data-line-number="1087"></td>
          <td id="LC1087">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1088" data-line-number="1088"></td>
          <td id="LC1088">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1089" data-line-number="1089"></td>
          <td id="LC1089">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1090" data-line-number="1090"></td>
          <td id="LC1090">                    <span>&#39;--- Extension - OCSP Status Request</span></td>
        </tr>
        <tr>
          <td id="L1091" data-line-number="1091"></td>
          <td id="LC1091">                    <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_STATUS_REQUEST,</span> <span>0</span><span>,</span> <span>5</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1092" data-line-number="1092"></td>
          <td id="LC1092">                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L1093" data-line-number="1093"></td>
          <td id="LC1093">                    <span>If</span> <span>(.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1094" data-line-number="1094"></td>
          <td id="LC1094">                        <span>&#39;--- Extension - EC Point Formats</span></td>
        </tr>
        <tr>
          <td id="L1095" data-line-number="1095"></td>
          <td id="LC1095">                        <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_EC_POINT_FORMAT,</span> <span>0</span><span>,</span> <span>2</span><span>,</span> <span>1</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1096" data-line-number="1096"></td>
          <td id="LC1096">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>      <span>&#39;--- uncompressed only</span></td>
        </tr>
        <tr>
          <td id="L1097" data-line-number="1097"></td>
          <td id="LC1097">                        <span>&#39;--- Extension - Extended Master Secret</span></td>
        </tr>
        <tr>
          <td id="L1098" data-line-number="1098"></td>
          <td id="LC1098">                        <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_EXTENDED_MASTER_SECRET,</span> <span>0</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1099" data-line-number="1099"></td>
          <td id="LC1099">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>      <span>&#39;--- supported</span></td>
        </tr>
        <tr>
          <td id="L1100" data-line-number="1100"></td>
          <td id="LC1100">                        <span>&#39;--- Extension - Encrypt-then-MAC</span></td>
        </tr>
        <tr>
          <td id="L1101" data-line-number="1101"></td>
          <td id="LC1101">                        <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC,</span> <span>0</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1102" data-line-number="1102"></td>
          <td id="LC1102">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>      <span>&#39;--- supported</span></td>
        </tr>
        <tr>
          <td id="L1103" data-line-number="1103"></td>
          <td id="LC1103">                        <span>&#39;--- Extension - Renegotiation Info</span></td>
        </tr>
        <tr>
          <td id="L1104" data-line-number="1104"></td>
          <td id="LC1104">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1105" data-line-number="1105"></td>
          <td id="LC1105">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1106" data-line-number="1106"></td>
          <td id="LC1106">                            <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1107" data-line-number="1107"></td>
          <td id="LC1107">                                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalLegacyVerifyData</span></td>
        </tr>
        <tr>
          <td id="L1108" data-line-number="1108"></td>
          <td id="LC1108">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1109" data-line-number="1109"></td>
          <td id="LC1109">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1110" data-line-number="1110"></td>
          <td id="LC1110">                        <span>&#39;--- Extension - Session Ticket</span></td>
        </tr>
        <tr>
          <td id="L1111" data-line-number="1111"></td>
          <td id="LC1111">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_SESSION_TICKET,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1112" data-line-number="1112"></td>
          <td id="LC1112">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1113" data-line-number="1113"></td>
          <td id="LC1113">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>0</span><span>,</span> <span>Size:=</span><span>4</span></td>
        </tr>
        <tr>
          <td id="L1114" data-line-number="1114"></td>
          <td id="LC1114">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1115" data-line-number="1115"></td>
          <td id="LC1115">                                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalSessionTicket</span></td>
        </tr>
        <tr>
          <td id="L1116" data-line-number="1116"></td>
          <td id="LC1116">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1117" data-line-number="1117"></td>
          <td id="LC1117">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1118" data-line-number="1118"></td>
          <td id="LC1118">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1119" data-line-number="1119"></td>
          <td id="LC1119">                    <span>&#39;--- Extension - Signature Algorithms</span></td>
        </tr>
        <tr>
          <td id="L1120" data-line-number="1120"></td>
          <td id="LC1120">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_SIGNATURE_ALGORITHMS,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1121" data-line-number="1121"></td>
          <td id="LC1121">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1122" data-line-number="1122"></td>
          <td id="LC1122">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1123" data-line-number="1123"></td>
          <td id="LC1123">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1124" data-line-number="1124"></td>
          <td id="LC1124">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1125" data-line-number="1125"></td>
          <td id="LC1125">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1126" data-line-number="1126"></td>
          <td id="LC1126">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1127" data-line-number="1127"></td>
          <td id="LC1127">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1128" data-line-number="1128"></td>
          <td id="LC1128">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1129" data-line-number="1129"></td>
          <td id="LC1129">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp521r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1130" data-line-number="1130"></td>
          <td id="LC1130">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_ECDSA_SECP521R1_SHA512,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1131" data-line-number="1131"></td>
          <td id="LC1131">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1132" data-line-number="1132"></td>
          <td id="LC1132">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPss)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1133" data-line-number="1133"></td>
          <td id="LC1133">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1134" data-line-number="1134"></td>
          <td id="LC1134">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1135" data-line-number="1135"></td>
          <td id="LC1135">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1136" data-line-number="1136"></td>
          <td id="LC1136">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1137" data-line-number="1137"></td>
          <td id="LC1137">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1138" data-line-number="1138"></td>
          <td id="LC1138">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1139" data-line-number="1139"></td>
          <td id="LC1139">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1140" data-line-number="1140"></td>
          <td id="LC1140">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1141" data-line-number="1141"></td>
          <td id="LC1141">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA224,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1142" data-line-number="1142"></td>
          <td id="LC1142">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA256,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1143" data-line-number="1143"></td>
          <td id="LC1143">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA384,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1144" data-line-number="1144"></td>
          <td id="LC1144">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA512,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1145" data-line-number="1145"></td>
          <td id="LC1145">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1146" data-line-number="1146"></td>
          <td id="LC1146">                            <span>&#39;--- legacy SHA-1 based signatures</span></td>
        </tr>
        <tr>
          <td id="L1147" data-line-number="1147"></td>
          <td id="LC1147">                            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoDigestSha1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1148" data-line-number="1148"></td>
          <td id="LC1148">                                <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1149" data-line-number="1149"></td>
          <td id="LC1149">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1150" data-line-number="1150"></td>
          <td id="LC1150">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1151" data-line-number="1151"></td>
          <td id="LC1151">                                <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span> <span>Or</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1152" data-line-number="1152"></td>
          <td id="LC1152">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_SIGNATURE_ECDSA_SHA1,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1153" data-line-number="1153"></td>
          <td id="LC1153">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1154" data-line-number="1154"></td>
          <td id="LC1154">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1155" data-line-number="1155"></td>
          <td id="LC1155">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1156" data-line-number="1156"></td>
          <td id="LC1156">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1157" data-line-number="1157"></td>
          <td id="LC1157">                    <span>If</span> <span>(.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1158" data-line-number="1158"></td>
          <td id="LC1158">                        <span>&#39;--- Extension - Post Handshake Auth</span></td>
        </tr>
        <tr>
          <td id="L1159" data-line-number="1159"></td>
          <td id="LC1159">                        <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_POST_HANDSHAKE_AUTH,</span> <span>0</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1160" data-line-number="1160"></td>
          <td id="LC1160">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>     <span>&#39;--- supported</span></td>
        </tr>
        <tr>
          <td id="L1161" data-line-number="1161"></td>
          <td id="LC1161">                        <span>&#39;--- Extension - Key Share</span></td>
        </tr>
        <tr>
          <td id="L1162" data-line-number="1162"></td>
          <td id="LC1162">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_KEY_SHARE,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1163" data-line-number="1163"></td>
          <td id="LC1163">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1164" data-line-number="1164"></td>
          <td id="LC1164">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1165" data-line-number="1165"></td>
          <td id="LC1165">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.ExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1166" data-line-number="1166"></td>
          <td id="LC1166">                                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1167" data-line-number="1167"></td>
          <td id="LC1167">                                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchPublic</span></td>
        </tr>
        <tr>
          <td id="L1168" data-line-number="1168"></td>
          <td id="LC1168">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1169" data-line-number="1169"></td>
          <td id="LC1169">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1170" data-line-number="1170"></td>
          <td id="LC1170">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1171" data-line-number="1171"></td>
          <td id="LC1171">                        <span>&#39;--- Extension - Supported Versions</span></td>
        </tr>
        <tr>
          <td id="L1172" data-line-number="1172"></td>
          <td id="LC1172">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_SUPPORTED_VERSIONS,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1173" data-line-number="1173"></td>
          <td id="LC1173">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1174" data-line-number="1174"></td>
          <td id="LC1174">                            <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1175" data-line-number="1175"></td>
          <td id="LC1175">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_PROTOCOL_VERSION_TLS13,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1176" data-line-number="1176"></td>
          <td id="LC1176">                                <span>If</span> <span>(.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1177" data-line-number="1177"></td>
          <td id="LC1177">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1178" data-line-number="1178"></td>
          <td id="LC1178">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1179" data-line-number="1179"></td>
          <td id="LC1179">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1180" data-line-number="1180"></td>
          <td id="LC1180">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1181" data-line-number="1181"></td>
          <td id="LC1181">                        <span>If</span> <span>.HelloRetryRequest</span> <span>And</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_COOKIE)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1182" data-line-number="1182"></td>
          <td id="LC1182">                            <span>&#39;--- Extension - Cookie</span></td>
        </tr>
        <tr>
          <td id="L1183" data-line-number="1183"></td>
          <td id="LC1183">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_COOKIE,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1184" data-line-number="1184"></td>
          <td id="LC1184">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1185" data-line-number="1185"></td>
          <td id="LC1185">                                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1186" data-line-number="1186"></td>
          <td id="LC1186">                                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.HelloRetryCookie</span></td>
        </tr>
        <tr>
          <td id="L1187" data-line-number="1187"></td>
          <td id="LC1187">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1188" data-line-number="1188"></td>
          <td id="LC1188">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1189" data-line-number="1189"></td>
          <td id="LC1189">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1190" data-line-number="1190"></td>
          <td id="LC1190">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1191" data-line-number="1191"></td>
          <td id="LC1191">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1192" data-line-number="1192"></td>
          <td id="LC1192">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1193" data-line-number="1193"></td>
          <td id="LC1193">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1194" data-line-number="1194"></td>
          <td id="LC1194">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1195" data-line-number="1195"></td>
          <td id="LC1195">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1196" data-line-number="1196"></td>
          <td id="LC1196"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L1197" data-line-number="1197"></td>
          <td id="LC1197"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1198" data-line-number="1198"></td>
          <td id="LC1198">
</td>
        </tr>
        <tr>
          <td id="L1199" data-line-number="1199"></td>
          <td id="LC1199"><span>Private</span> <span>Sub</span> <span>pvTlsBuildClientLegacyKeyExchange(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L1200" data-line-number="1200"></td>
          <td id="LC1200">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1201" data-line-number="1201"></td>
          <td id="LC1201">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1202" data-line-number="1202"></td>
          <td id="LC1202">    <span>Dim</span> <span>baVerifyData()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1203" data-line-number="1203"></td>
          <td id="LC1203">    <span>Dim</span> <span>baSignature()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1204" data-line-number="1204"></td>
          <td id="LC1204">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1205" data-line-number="1205"></td>
          <td id="LC1205">    <span>Dim</span> <span>baCert()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1206" data-line-number="1206"></td>
          <td id="LC1206">    </td>
        </tr>
        <tr>
          <td id="L1207" data-line-number="1207"></td>
          <td id="LC1207">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1208" data-line-number="1208"></td>
          <td id="LC1208">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1209" data-line-number="1209"></td>
          <td id="LC1209">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1210" data-line-number="1210"></td>
          <td id="LC1210">            <span>If</span> <span>.CertRequestSignatureScheme</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1211" data-line-number="1211"></td>
          <td id="LC1211">                <span>&#39;--- Client Certificate</span></td>
        </tr>
        <tr>
          <td id="L1212" data-line-number="1212"></td>
          <td id="LC1212">                <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1213" data-line-number="1213"></td>
          <td id="LC1213">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L1214" data-line-number="1214"></td>
          <td id="LC1214">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1215" data-line-number="1215"></td>
          <td id="LC1215">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1216" data-line-number="1216"></td>
          <td id="LC1216">                        <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>pvCollectionCount(.LocalCertificates)</span></td>
        </tr>
        <tr>
          <td id="L1217" data-line-number="1217"></td>
          <td id="LC1217">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1218" data-line-number="1218"></td>
          <td id="LC1218">                                <span>baCert</span> <span>=</span> <span>.LocalCertificates.Item(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L1219" data-line-number="1219"></td>
          <td id="LC1219">                                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L1220" data-line-number="1220"></td>
          <td id="LC1220">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1221" data-line-number="1221"></td>
          <td id="LC1221">                        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1222" data-line-number="1222"></td>
          <td id="LC1222">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1223" data-line-number="1223"></td>
          <td id="LC1223">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1224" data-line-number="1224"></td>
          <td id="LC1224">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1225" data-line-number="1225"></td>
          <td id="LC1225">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1226" data-line-number="1226"></td>
          <td id="LC1226">            <span>&#39;--- Handshake Client Key Exchange</span></td>
        </tr>
        <tr>
          <td id="L1227" data-line-number="1227"></td>
          <td id="LC1227">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1228" data-line-number="1228"></td>
          <td id="LC1228">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CLIENT_KEY_EXCHANGE</span></td>
        </tr>
        <tr>
          <td id="L1229" data-line-number="1229"></td>
          <td id="LC1229">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1230" data-line-number="1230"></td>
          <td id="LC1230">                <span>If</span> <span>pvArraySize(.LocalExchRsaEncrPriv)</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1231" data-line-number="1231"></td>
          <td id="LC1231">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1232" data-line-number="1232"></td>
          <td id="LC1232">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchRsaEncrPriv</span></td>
        </tr>
        <tr>
          <td id="L1233" data-line-number="1233"></td>
          <td id="LC1233">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1234" data-line-number="1234"></td>
          <td id="LC1234">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1235" data-line-number="1235"></td>
          <td id="LC1235">                    <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1236" data-line-number="1236"></td>
          <td id="LC1236">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchPublic</span></td>
        </tr>
        <tr>
          <td id="L1237" data-line-number="1237"></td>
          <td id="LC1237">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1238" data-line-number="1238"></td>
          <td id="LC1238">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1239" data-line-number="1239"></td>
          <td id="LC1239">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1240" data-line-number="1240"></td>
          <td id="LC1240">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1241" data-line-number="1241"></td>
          <td id="LC1241">            <span>&#39;--- note: get handshake hash early (before certificate verify)</span></td>
        </tr>
        <tr>
          <td id="L1242" data-line-number="1242"></td>
          <td id="LC1242">            <span>pvTlsDeriveLegacySecrets</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1243" data-line-number="1243"></td>
          <td id="LC1243">            <span>If</span> <span>.CertRequestSignatureScheme</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1244" data-line-number="1244"></td>
          <td id="LC1244">                <span>&#39;--- Client Certificate Verify</span></td>
        </tr>
        <tr>
          <td id="L1245" data-line-number="1245"></td>
          <td id="LC1245">                <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1246" data-line-number="1246"></td>
          <td id="LC1246">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE_VERIFY</span></td>
        </tr>
        <tr>
          <td id="L1247" data-line-number="1247"></td>
          <td id="LC1247">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1248" data-line-number="1248"></td>
          <td id="LC1248">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.CertRequestSignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1249" data-line-number="1249"></td>
          <td id="LC1249">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1250" data-line-number="1250"></td>
          <td id="LC1250">                        <span>pvArrayWriteEOF</span> <span>.HandshakeMessages.Data,</span> <span>.HandshakeMessages.Size</span></td>
        </tr>
        <tr>
          <td id="L1251" data-line-number="1251"></td>
          <td id="LC1251">                        <span>pvTlsSignatureSign</span> <span>baSignature,</span> <span>.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>.CertRequestSignatureScheme,</span> <span>.HandshakeMessages.Data</span></td>
        </tr>
        <tr>
          <td id="L1252" data-line-number="1252"></td>
          <td id="LC1252">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baSignature</span></td>
        </tr>
        <tr>
          <td id="L1253" data-line-number="1253"></td>
          <td id="LC1253">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1254" data-line-number="1254"></td>
          <td id="LC1254">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1255" data-line-number="1255"></td>
          <td id="LC1255">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1256" data-line-number="1256"></td>
          <td id="LC1256">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1257" data-line-number="1257"></td>
          <td id="LC1257">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1258" data-line-number="1258"></td>
          <td id="LC1258">        <span>&#39;--- Legacy Change Cipher Spec</span></td>
        </tr>
        <tr>
          <td id="L1259" data-line-number="1259"></td>
          <td id="LC1259">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1260" data-line-number="1260"></td>
          <td id="LC1260">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1261" data-line-number="1261"></td>
          <td id="LC1261">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1262" data-line-number="1262"></td>
          <td id="LC1262">        <span>&#39;--- commit next epoch local secrets</span></td>
        </tr>
        <tr>
          <td id="L1263" data-line-number="1263"></td>
          <td id="LC1263">        <span>.LocalMacKey</span> <span>=</span> <span>.LocalLegacyNextMacKey</span></td>
        </tr>
        <tr>
          <td id="L1264" data-line-number="1264"></td>
          <td id="LC1264">        <span>.LocalTrafficKey</span> <span>=</span> <span>.LocalLegacyNextTrafficKey</span></td>
        </tr>
        <tr>
          <td id="L1265" data-line-number="1265"></td>
          <td id="LC1265">        <span>.LocalTrafficIV</span> <span>=</span> <span>.LocalLegacyNextTrafficIV</span></td>
        </tr>
        <tr>
          <td id="L1266" data-line-number="1266"></td>
          <td id="LC1266">        <span>.LocalTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1267" data-line-number="1267"></td>
          <td id="LC1267">        <span>.LocalEncryptThenMac</span> <span>=</span> <span>(.MacSize</span> <span>&gt;</span> <span>0</span><span>)</span> <span>And</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC)</span></td>
        </tr>
        <tr>
          <td id="L1268" data-line-number="1268"></td>
          <td id="LC1268">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1269" data-line-number="1269"></td>
          <td id="LC1269">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1270" data-line-number="1270"></td>
          <td id="LC1270">            <span>&#39;--- Client Handshake Finished</span></td>
        </tr>
        <tr>
          <td id="L1271" data-line-number="1271"></td>
          <td id="LC1271">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1272" data-line-number="1272"></td>
          <td id="LC1272">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_FINISHED</span></td>
        </tr>
        <tr>
          <td id="L1273" data-line-number="1273"></td>
          <td id="LC1273">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1274" data-line-number="1274"></td>
          <td id="LC1274">                <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1275" data-line-number="1275"></td>
          <td id="LC1275">                <span>pvTlsKdfLegacyPrf</span> <span>baVerifyData,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>&#34;client finished&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>TLS_VERIFY_DATA_SIZE</span></td>
        </tr>
        <tr>
          <td id="L1276" data-line-number="1276"></td>
          <td id="LC1276">                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baVerifyData</span></td>
        </tr>
        <tr>
          <td id="L1277" data-line-number="1277"></td>
          <td id="LC1277">                <span>&#39;--- save for secure renegotiation check</span></td>
        </tr>
        <tr>
          <td id="L1278" data-line-number="1278"></td>
          <td id="LC1278">                <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1279" data-line-number="1279"></td>
          <td id="LC1279">                    <span>.LocalLegacyVerifyData</span> <span>=</span> <span>baVerifyData</span></td>
        </tr>
        <tr>
          <td id="L1280" data-line-number="1280"></td>
          <td id="LC1280">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1281" data-line-number="1281"></td>
          <td id="LC1281">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1282" data-line-number="1282"></td>
          <td id="LC1282">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1283" data-line-number="1283"></td>
          <td id="LC1283">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1284" data-line-number="1284"></td>
          <td id="LC1284">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1285" data-line-number="1285"></td>
          <td id="LC1285"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L1286" data-line-number="1286"></td>
          <td id="LC1286"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1287" data-line-number="1287"></td>
          <td id="LC1287">
</td>
        </tr>
        <tr>
          <td id="L1288" data-line-number="1288"></td>
          <td id="LC1288"><span>Private</span> <span>Sub</span> <span>pvTlsBuildClientHandshakeFinished(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L1289" data-line-number="1289"></td>
          <td id="LC1289">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1290" data-line-number="1290"></td>
          <td id="LC1290">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1291" data-line-number="1291"></td>
          <td id="LC1291">    <span>Dim</span> <span>baCert()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1292" data-line-number="1292"></td>
          <td id="LC1292">    <span>Dim</span> <span>baSignature()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1293" data-line-number="1293"></td>
          <td id="LC1293">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1294" data-line-number="1294"></td>
          <td id="LC1294">    <span>Dim</span> <span>uVerify</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L1295" data-line-number="1295"></td>
          <td id="LC1295">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1296" data-line-number="1296"></td>
          <td id="LC1296">    <span>Dim</span> <span>baEmpty()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1297" data-line-number="1297"></td>
          <td id="LC1297">    </td>
        </tr>
        <tr>
          <td id="L1298" data-line-number="1298"></td>
          <td id="LC1298">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1299" data-line-number="1299"></td>
          <td id="LC1299">        <span>If</span> <span>.CertRequestSignatureScheme</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1300" data-line-number="1300"></td>
          <td id="LC1300">            <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1301" data-line-number="1301"></td>
          <td id="LC1301">            <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_APPDATA,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1302" data-line-number="1302"></td>
          <td id="LC1302">                <span>&#39;--- Client Certificate</span></td>
        </tr>
        <tr>
          <td id="L1303" data-line-number="1303"></td>
          <td id="LC1303">                <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1304" data-line-number="1304"></td>
          <td id="LC1304">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L1305" data-line-number="1305"></td>
          <td id="LC1305">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1306" data-line-number="1306"></td>
          <td id="LC1306">                    <span>&#39;--- certificate request context</span></td>
        </tr>
        <tr>
          <td id="L1307" data-line-number="1307"></td>
          <td id="LC1307">                    <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1308" data-line-number="1308"></td>
          <td id="LC1308">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.CertRequestContext</span></td>
        </tr>
        <tr>
          <td id="L1309" data-line-number="1309"></td>
          <td id="LC1309">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1310" data-line-number="1310"></td>
          <td id="LC1310">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1311" data-line-number="1311"></td>
          <td id="LC1311">                        <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>pvCollectionCount(.LocalCertificates)</span></td>
        </tr>
        <tr>
          <td id="L1312" data-line-number="1312"></td>
          <td id="LC1312">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1313" data-line-number="1313"></td>
          <td id="LC1313">                                <span>baCert</span> <span>=</span> <span>.LocalCertificates.Item(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L1314" data-line-number="1314"></td>
          <td id="LC1314">                                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L1315" data-line-number="1315"></td>
          <td id="LC1315">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1316" data-line-number="1316"></td>
          <td id="LC1316">                            <span>&#39;--- certificate extensions</span></td>
        </tr>
        <tr>
          <td id="L1317" data-line-number="1317"></td>
          <td id="LC1317">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1318" data-line-number="1318"></td>
          <td id="LC1318">                                <span>&#39;--- empty</span></td>
        </tr>
        <tr>
          <td id="L1319" data-line-number="1319"></td>
          <td id="LC1319">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1320" data-line-number="1320"></td>
          <td id="LC1320">                        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1321" data-line-number="1321"></td>
          <td id="LC1321">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1322" data-line-number="1322"></td>
          <td id="LC1322">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1323" data-line-number="1323"></td>
          <td id="LC1323">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1324" data-line-number="1324"></td>
          <td id="LC1324">                <span>If</span> <span>.CertRequestSignatureScheme</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1325" data-line-number="1325"></td>
          <td id="LC1325">                    <span>&#39;--- Client Certificate Verify</span></td>
        </tr>
        <tr>
          <td id="L1326" data-line-number="1326"></td>
          <td id="LC1326">                    <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1327" data-line-number="1327"></td>
          <td id="LC1327">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE_VERIFY</span></td>
        </tr>
        <tr>
          <td id="L1328" data-line-number="1328"></td>
          <td id="LC1328">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1329" data-line-number="1329"></td>
          <td id="LC1329">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.CertRequestSignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1330" data-line-number="1330"></td>
          <td id="LC1330">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1331" data-line-number="1331"></td>
          <td id="LC1331">                            <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1332" data-line-number="1332"></td>
          <td id="LC1332">                            <span>pvBufferWriteString</span> <span>uVerify,</span> <span>Space$(</span><span>64</span><span>)</span> <span>&amp;</span> <span>&#34;TLS 1.3, client CertificateVerify&#34;</span> <span>&amp;</span> <span>Chr$(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1333" data-line-number="1333"></td>
          <td id="LC1333">                            <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1334" data-line-number="1334"></td>
          <td id="LC1334">                            <span>pvBufferWriteEOF</span> <span>uVerify</span></td>
        </tr>
        <tr>
          <td id="L1335" data-line-number="1335"></td>
          <td id="LC1335">                            <span>pvTlsSignatureSign</span> <span>baSignature,</span> <span>.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>.CertRequestSignatureScheme,</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1336" data-line-number="1336"></td>
          <td id="LC1336">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baSignature</span></td>
        </tr>
        <tr>
          <td id="L1337" data-line-number="1337"></td>
          <td id="LC1337">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1338" data-line-number="1338"></td>
          <td id="LC1338">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1339" data-line-number="1339"></td>
          <td id="LC1339">                    <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1340" data-line-number="1340"></td>
          <td id="LC1340">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1341" data-line-number="1341"></td>
          <td id="LC1341">                <span>&#39;--- Record Type</span></td>
        </tr>
        <tr>
          <td id="L1342" data-line-number="1342"></td>
          <td id="LC1342">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE</span></td>
        </tr>
        <tr>
          <td id="L1343" data-line-number="1343"></td>
          <td id="LC1343">            <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1344" data-line-number="1344"></td>
          <td id="LC1344">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1345" data-line-number="1345"></td>
          <td id="LC1345">        <span>&#39;--- Legacy Change Cipher Spec</span></td>
        </tr>
        <tr>
          <td id="L1346" data-line-number="1346"></td>
          <td id="LC1346">        <span>pvArrayByte</span> <span>baTemp,</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC,</span> <span>TLS_RECORD_VERSION</span> <span>\</span> <span>&amp;H100</span><span>,</span> <span>TLS_RECORD_VERSION,</span> <span>0</span><span>,</span> <span>1</span><span>,</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1347" data-line-number="1347"></td>
          <td id="LC1347">        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L1348" data-line-number="1348"></td>
          <td id="LC1348">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1349" data-line-number="1349"></td>
          <td id="LC1349">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_APPDATA,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1350" data-line-number="1350"></td>
          <td id="LC1350">            <span>&#39;--- Client Handshake Finished</span></td>
        </tr>
        <tr>
          <td id="L1351" data-line-number="1351"></td>
          <td id="LC1351">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_FINISHED</span></td>
        </tr>
        <tr>
          <td id="L1352" data-line-number="1352"></td>
          <td id="LC1352">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1353" data-line-number="1353"></td>
          <td id="LC1353">                <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1354" data-line-number="1354"></td>
          <td id="LC1354">                <span>pvTlsHkdfExpandLabel</span> <span>baTemp,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;finished&#34;</span><span>,</span> <span>baEmpty,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L1355" data-line-number="1355"></td>
          <td id="LC1355">                <span>pvTlsHkdfExtract</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>baTemp,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1356" data-line-number="1356"></td>
          <td id="LC1356">                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1357" data-line-number="1357"></td>
          <td id="LC1357">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1358" data-line-number="1358"></td>
          <td id="LC1358">            <span>&#39;--- Record Type</span></td>
        </tr>
        <tr>
          <td id="L1359" data-line-number="1359"></td>
          <td id="LC1359">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE</span></td>
        </tr>
        <tr>
          <td id="L1360" data-line-number="1360"></td>
          <td id="LC1360">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1361" data-line-number="1361"></td>
          <td id="LC1361">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1362" data-line-number="1362"></td>
          <td id="LC1362"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L1363" data-line-number="1363"></td>
          <td id="LC1363"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1364" data-line-number="1364"></td>
          <td id="LC1364">
</td>
        </tr>
        <tr>
          <td id="L1365" data-line-number="1365"></td>
          <td id="LC1365"><span>Private</span> <span>Sub</span> <span>pvTlsBuildServerHello(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L1366" data-line-number="1366"></td>
          <td id="LC1366">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1367" data-line-number="1367"></td>
          <td id="LC1367">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1368" data-line-number="1368"></td>
          <td id="LC1368">    </td>
        </tr>
        <tr>
          <td id="L1369" data-line-number="1369"></td>
          <td id="LC1369">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1370" data-line-number="1370"></td>
          <td id="LC1370">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1371" data-line-number="1371"></td>
          <td id="LC1371">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1372" data-line-number="1372"></td>
          <td id="LC1372">            <span>&#39;--- Handshake Header</span></td>
        </tr>
        <tr>
          <td id="L1373" data-line-number="1373"></td>
          <td id="LC1373">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1374" data-line-number="1374"></td>
          <td id="LC1374">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_SERVER_HELLO</span></td>
        </tr>
        <tr>
          <td id="L1375" data-line-number="1375"></td>
          <td id="LC1375">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1376" data-line-number="1376"></td>
          <td id="LC1376">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_LOCAL_LEGACY_VERSION,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1377" data-line-number="1377"></td>
          <td id="LC1377">                <span>pvTlsGetRandom</span> <span>.LocalExchRandom,</span> <span>TLS_HELLO_RANDOM_SIZE</span></td>
        </tr>
        <tr>
          <td id="L1378" data-line-number="1378"></td>
          <td id="LC1378">                <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1379" data-line-number="1379"></td>
          <td id="LC1379">                    <span>If</span> <span>pvArraySize(m_baHelloRetryRandom)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1380" data-line-number="1380"></td>
          <td id="LC1380">                        <span>pvTlsGetHelloRetryRandom</span> <span>m_baHelloRetryRandom</span></td>
        </tr>
        <tr>
          <td id="L1381" data-line-number="1381"></td>
          <td id="LC1381">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1382" data-line-number="1382"></td>
          <td id="LC1382">                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>m_baHelloRetryRandom</span></td>
        </tr>
        <tr>
          <td id="L1383" data-line-number="1383"></td>
          <td id="LC1383">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1384" data-line-number="1384"></td>
          <td id="LC1384">                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L1385" data-line-number="1385"></td>
          <td id="LC1385">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1386" data-line-number="1386"></td>
          <td id="LC1386">                <span>&#39;--- Legacy Session ID</span></td>
        </tr>
        <tr>
          <td id="L1387" data-line-number="1387"></td>
          <td id="LC1387">                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1388" data-line-number="1388"></td>
          <td id="LC1388">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1389" data-line-number="1389"></td>
          <td id="LC1389">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.RemoteSessionID</span></td>
        </tr>
        <tr>
          <td id="L1390" data-line-number="1390"></td>
          <td id="LC1390">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1391" data-line-number="1391"></td>
          <td id="LC1391">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalSessionID</span></td>
        </tr>
        <tr>
          <td id="L1392" data-line-number="1392"></td>
          <td id="LC1392">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1393" data-line-number="1393"></td>
          <td id="LC1393">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1394" data-line-number="1394"></td>
          <td id="LC1394">                <span>&#39;--- Cipher Suite</span></td>
        </tr>
        <tr>
          <td id="L1395" data-line-number="1395"></td>
          <td id="LC1395">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>IIf(.HelloRetryRequest,</span> <span>.HelloRetryCipherSuite,</span> <span>.CipherSuite),</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1396" data-line-number="1396"></td>
          <td id="LC1396">                <span>&#39;--- Legacy Compression Method</span></td>
        </tr>
        <tr>
          <td id="L1397" data-line-number="1397"></td>
          <td id="LC1397">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_COMPRESS_NULL</span></td>
        </tr>
        <tr>
          <td id="L1398" data-line-number="1398"></td>
          <td id="LC1398">                <span>&#39;--- Extensions</span></td>
        </tr>
        <tr>
          <td id="L1399" data-line-number="1399"></td>
          <td id="LC1399">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1400" data-line-number="1400"></td>
          <td id="LC1400">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1401" data-line-number="1401"></td>
          <td id="LC1401">                        <span>&#39;--- Extension - Key Share</span></td>
        </tr>
        <tr>
          <td id="L1402" data-line-number="1402"></td>
          <td id="LC1402">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_KEY_SHARE)</span> <span>Or</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1403" data-line-number="1403"></td>
          <td id="LC1403">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_KEY_SHARE,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1404" data-line-number="1404"></td>
          <td id="LC1404">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1405" data-line-number="1405"></td>
          <td id="LC1405">                                <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1406" data-line-number="1406"></td>
          <td id="LC1406">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.HelloRetryExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1407" data-line-number="1407"></td>
          <td id="LC1407">                                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1408" data-line-number="1408"></td>
          <td id="LC1408">                                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.ExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1409" data-line-number="1409"></td>
          <td id="LC1409">                                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1410" data-line-number="1410"></td>
          <td id="LC1410">                                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchPublic</span></td>
        </tr>
        <tr>
          <td id="L1411" data-line-number="1411"></td>
          <td id="LC1411">                                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1412" data-line-number="1412"></td>
          <td id="LC1412">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1413" data-line-number="1413"></td>
          <td id="LC1413">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1414" data-line-number="1414"></td>
          <td id="LC1414">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1415" data-line-number="1415"></td>
          <td id="LC1415">                        <span>&#39;--- Extension - Supported Versions</span></td>
        </tr>
        <tr>
          <td id="L1416" data-line-number="1416"></td>
          <td id="LC1416">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_SUPPORTED_VERSIONS)</span> <span>Or</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1417" data-line-number="1417"></td>
          <td id="LC1417">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_SUPPORTED_VERSIONS,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1418" data-line-number="1418"></td>
          <td id="LC1418">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1419" data-line-number="1419"></td>
          <td id="LC1419">                                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_PROTOCOL_VERSION_TLS13,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1420" data-line-number="1420"></td>
          <td id="LC1420">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1421" data-line-number="1421"></td>
          <td id="LC1421">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1422" data-line-number="1422"></td>
          <td id="LC1422">                        <span>If</span> <span>.HelloRetryRequest</span> <span>And</span> <span>pvArraySize(.HelloRetryCookie)</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1423" data-line-number="1423"></td>
          <td id="LC1423">                            <span>&#39;--- Extension - HRR Cookie</span></td>
        </tr>
        <tr>
          <td id="L1424" data-line-number="1424"></td>
          <td id="LC1424">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_COOKIE,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1425" data-line-number="1425"></td>
          <td id="LC1425">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1426" data-line-number="1426"></td>
          <td id="LC1426">                                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1427" data-line-number="1427"></td>
          <td id="LC1427">                                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.HelloRetryCookie</span></td>
        </tr>
        <tr>
          <td id="L1428" data-line-number="1428"></td>
          <td id="LC1428">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1429" data-line-number="1429"></td>
          <td id="LC1429">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1430" data-line-number="1430"></td>
          <td id="LC1430">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1431" data-line-number="1431"></td>
          <td id="LC1431">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1432" data-line-number="1432"></td>
          <td id="LC1432">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1433" data-line-number="1433"></td>
          <td id="LC1433">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_EXTENDED_MASTER_SECRET)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1434" data-line-number="1434"></td>
          <td id="LC1434">                            <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_EXTENDED_MASTER_SECRET,</span> <span>0</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1435" data-line-number="1435"></td>
          <td id="LC1435">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>      <span>&#39;--- supported</span></td>
        </tr>
        <tr>
          <td id="L1436" data-line-number="1436"></td>
          <td id="LC1436">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1437" data-line-number="1437"></td>
          <td id="LC1437">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1438" data-line-number="1438"></td>
          <td id="LC1438">                            <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC,</span> <span>0</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1439" data-line-number="1439"></td>
          <td id="LC1439">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>      <span>&#39;--- supported</span></td>
        </tr>
        <tr>
          <td id="L1440" data-line-number="1440"></td>
          <td id="LC1440">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1441" data-line-number="1441"></td>
          <td id="LC1441">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_EC_POINT_FORMAT)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1442" data-line-number="1442"></td>
          <td id="LC1442">                            <span>pvArrayByte</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_EC_POINT_FORMAT,</span> <span>0</span><span>,</span> <span>2</span><span>,</span> <span>1</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1443" data-line-number="1443"></td>
          <td id="LC1443">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span>      <span>&#39;--- uncompressed only</span></td>
        </tr>
        <tr>
          <td id="L1444" data-line-number="1444"></td>
          <td id="LC1444">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1445" data-line-number="1445"></td>
          <td id="LC1445">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1446" data-line-number="1446"></td>
          <td id="LC1446">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1447" data-line-number="1447"></td>
          <td id="LC1447">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1448" data-line-number="1448"></td>
          <td id="LC1448">                                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1449" data-line-number="1449"></td>
          <td id="LC1449">                                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.RemoteLegacyVerifyData</span></td>
        </tr>
        <tr>
          <td id="L1450" data-line-number="1450"></td>
          <td id="LC1450">                                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalLegacyVerifyData</span></td>
        </tr>
        <tr>
          <td id="L1451" data-line-number="1451"></td>
          <td id="LC1451">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1452" data-line-number="1452"></td>
          <td id="LC1452">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1453" data-line-number="1453"></td>
          <td id="LC1453">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1454" data-line-number="1454"></td>
          <td id="LC1454">                        <span>If</span> <span>LenB(.AlpnNegotiated)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1455" data-line-number="1455"></td>
          <td id="LC1455">                            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_ALPN,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1456" data-line-number="1456"></td>
          <td id="LC1456">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1457" data-line-number="1457"></td>
          <td id="LC1457">                                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1458" data-line-number="1458"></td>
          <td id="LC1458">                                    <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1459" data-line-number="1459"></td>
          <td id="LC1459">                                        <span>pvBufferWriteString</span> <span>uOutput,</span> <span>.AlpnNegotiated</span></td>
        </tr>
        <tr>
          <td id="L1460" data-line-number="1460"></td>
          <td id="LC1460">                                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1461" data-line-number="1461"></td>
          <td id="LC1461">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1462" data-line-number="1462"></td>
          <td id="LC1462">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1463" data-line-number="1463"></td>
          <td id="LC1463">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1464" data-line-number="1464"></td>
          <td id="LC1464">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1465" data-line-number="1465"></td>
          <td id="LC1465">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1466" data-line-number="1466"></td>
          <td id="LC1466">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1467" data-line-number="1467"></td>
          <td id="LC1467">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1468" data-line-number="1468"></td>
          <td id="LC1468">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1469" data-line-number="1469"></td>
          <td id="LC1469">        <span>If</span> <span>(.HelloRetryRequest</span> <span>Or</span> <span>.HelloRetryCipherSuite</span> <span>=</span> <span>0</span><span>)</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1470" data-line-number="1470"></td>
          <td id="LC1470">            <span>&#39;--- Legacy Change Cipher Spec</span></td>
        </tr>
        <tr>
          <td id="L1471" data-line-number="1471"></td>
          <td id="LC1471">            <span>pvArrayByte</span> <span>baTemp,</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC,</span> <span>TLS_RECORD_VERSION</span> <span>\</span> <span>&amp;H100</span><span>,</span> <span>TLS_RECORD_VERSION,</span> <span>0</span><span>,</span> <span>1</span><span>,</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1472" data-line-number="1472"></td>
          <td id="LC1472">            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L1473" data-line-number="1473"></td>
          <td id="LC1473">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1474" data-line-number="1474"></td>
          <td id="LC1474">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1475" data-line-number="1475"></td>
          <td id="LC1475"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1476" data-line-number="1476"></td>
          <td id="LC1476">
</td>
        </tr>
        <tr>
          <td id="L1477" data-line-number="1477"></td>
          <td id="LC1477"><span>Private</span> <span>Sub</span> <span>pvTlsBuildServerLegacyKeyExchange(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L1478" data-line-number="1478"></td>
          <td id="LC1478">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1479" data-line-number="1479"></td>
          <td id="LC1479">    <span>Dim</span> <span>baSignature()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1480" data-line-number="1480"></td>
          <td id="LC1480">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1481" data-line-number="1481"></td>
          <td id="LC1481">    <span>Dim</span> <span>baCert()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1482" data-line-number="1482"></td>
          <td id="LC1482">    <span>Dim</span> <span>uVerify</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L1483" data-line-number="1483"></td>
          <td id="LC1483">    <span>Dim</span> <span>lSignPos</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1484" data-line-number="1484"></td>
          <td id="LC1484">    <span>Dim</span> <span>lSignSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1485" data-line-number="1485"></td>
          <td id="LC1485">    </td>
        </tr>
        <tr>
          <td id="L1486" data-line-number="1486"></td>
          <td id="LC1486">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1487" data-line-number="1487"></td>
          <td id="LC1487">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1488" data-line-number="1488"></td>
          <td id="LC1488">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1489" data-line-number="1489"></td>
          <td id="LC1489">            <span>&#39;--- Server Certificate</span></td>
        </tr>
        <tr>
          <td id="L1490" data-line-number="1490"></td>
          <td id="LC1490">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1491" data-line-number="1491"></td>
          <td id="LC1491">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L1492" data-line-number="1492"></td>
          <td id="LC1492">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1493" data-line-number="1493"></td>
          <td id="LC1493">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1494" data-line-number="1494"></td>
          <td id="LC1494">                    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>pvCollectionCount(.LocalCertificates)</span></td>
        </tr>
        <tr>
          <td id="L1495" data-line-number="1495"></td>
          <td id="LC1495">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1496" data-line-number="1496"></td>
          <td id="LC1496">                            <span>baCert</span> <span>=</span> <span>.LocalCertificates.Item(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L1497" data-line-number="1497"></td>
          <td id="LC1497">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L1498" data-line-number="1498"></td>
          <td id="LC1498">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1499" data-line-number="1499"></td>
          <td id="LC1499">                    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1500" data-line-number="1500"></td>
          <td id="LC1500">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1501" data-line-number="1501"></td>
          <td id="LC1501">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1502" data-line-number="1502"></td>
          <td id="LC1502">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1503" data-line-number="1503"></td>
          <td id="LC1503">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1504" data-line-number="1504"></td>
          <td id="LC1504">        <span>If</span> <span>Not</span> <span>.UseRsaKeyTransport</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1505" data-line-number="1505"></td>
          <td id="LC1505">            <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1506" data-line-number="1506"></td>
          <td id="LC1506">            <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1507" data-line-number="1507"></td>
          <td id="LC1507">                <span>&#39;--- Server Key Exchange</span></td>
        </tr>
        <tr>
          <td id="L1508" data-line-number="1508"></td>
          <td id="LC1508">                <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1509" data-line-number="1509"></td>
          <td id="LC1509">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_SERVER_KEY_EXCHANGE</span></td>
        </tr>
        <tr>
          <td id="L1510" data-line-number="1510"></td>
          <td id="LC1510">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1511" data-line-number="1511"></td>
          <td id="LC1511">                    <span>&#39;--- Curve Info</span></td>
        </tr>
        <tr>
          <td id="L1512" data-line-number="1512"></td>
          <td id="LC1512">                    <span>lSignPos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1513" data-line-number="1513"></td>
          <td id="LC1513">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>3</span><span>,</span> <span>Size:=</span><span>1</span> <span>&#39;--- 3 = named_curve</span></td>
        </tr>
        <tr>
          <td id="L1514" data-line-number="1514"></td>
          <td id="LC1514">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.ExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1515" data-line-number="1515"></td>
          <td id="LC1515">                    <span>&#39;--- Public Key</span></td>
        </tr>
        <tr>
          <td id="L1516" data-line-number="1516"></td>
          <td id="LC1516">                    <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1517" data-line-number="1517"></td>
          <td id="LC1517">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>.LocalExchPublic</span></td>
        </tr>
        <tr>
          <td id="L1518" data-line-number="1518"></td>
          <td id="LC1518">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1519" data-line-number="1519"></td>
          <td id="LC1519">                    <span>lSignSize</span> <span>=</span> <span>uOutput.Size</span> <span>-</span> <span>lSignPos</span></td>
        </tr>
        <tr>
          <td id="L1520" data-line-number="1520"></td>
          <td id="LC1520">                    <span>&#39;--- Signature</span></td>
        </tr>
        <tr>
          <td id="L1521" data-line-number="1521"></td>
          <td id="LC1521">                    <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>.RemoteExchRandom</span></td>
        </tr>
        <tr>
          <td id="L1522" data-line-number="1522"></td>
          <td id="LC1522">                    <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L1523" data-line-number="1523"></td>
          <td id="LC1523">                    <span>pvBufferWriteBlob</span> <span>uVerify,</span> <span>VarPtr(uOutput.Data(lSignPos)),</span> <span>lSignSize</span></td>
        </tr>
        <tr>
          <td id="L1524" data-line-number="1524"></td>
          <td id="LC1524">                    <span>pvBufferWriteEOF</span> <span>uVerify</span></td>
        </tr>
        <tr>
          <td id="L1525" data-line-number="1525"></td>
          <td id="LC1525">                    <span>pvTlsSignatureSign</span> <span>baSignature,</span> <span>.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>.SignatureScheme,</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1526" data-line-number="1526"></td>
          <td id="LC1526">                    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.SignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1527" data-line-number="1527"></td>
          <td id="LC1527">                    <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1528" data-line-number="1528"></td>
          <td id="LC1528">                        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baSignature</span></td>
        </tr>
        <tr>
          <td id="L1529" data-line-number="1529"></td>
          <td id="LC1529">                    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1530" data-line-number="1530"></td>
          <td id="LC1530">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1531" data-line-number="1531"></td>
          <td id="LC1531">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1532" data-line-number="1532"></td>
          <td id="LC1532">            <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1533" data-line-number="1533"></td>
          <td id="LC1533">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1534" data-line-number="1534"></td>
          <td id="LC1534">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1535" data-line-number="1535"></td>
          <td id="LC1535">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1536" data-line-number="1536"></td>
          <td id="LC1536">            <span>&#39;--- Server Hello Done</span></td>
        </tr>
        <tr>
          <td id="L1537" data-line-number="1537"></td>
          <td id="LC1537">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1538" data-line-number="1538"></td>
          <td id="LC1538">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_SERVER_HELLO_DONE</span></td>
        </tr>
        <tr>
          <td id="L1539" data-line-number="1539"></td>
          <td id="LC1539">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1540" data-line-number="1540"></td>
          <td id="LC1540">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1541" data-line-number="1541"></td>
          <td id="LC1541">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1542" data-line-number="1542"></td>
          <td id="LC1542">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1543" data-line-number="1543"></td>
          <td id="LC1543">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1544" data-line-number="1544"></td>
          <td id="LC1544"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1545" data-line-number="1545"></td>
          <td id="LC1545">
</td>
        </tr>
        <tr>
          <td id="L1546" data-line-number="1546"></td>
          <td id="LC1546"><span>Private</span> <span>Sub</span> <span>pvTlsBuildServerHandshakeFinished(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L1547" data-line-number="1547"></td>
          <td id="LC1547">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1548" data-line-number="1548"></td>
          <td id="LC1548">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1549" data-line-number="1549"></td>
          <td id="LC1549">    <span>Dim</span> <span>uVerify</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L1550" data-line-number="1550"></td>
          <td id="LC1550">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1551" data-line-number="1551"></td>
          <td id="LC1551">    <span>Dim</span> <span>baCert()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1552" data-line-number="1552"></td>
          <td id="LC1552">    <span>Dim</span> <span>baSignature()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1553" data-line-number="1553"></td>
          <td id="LC1553">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1554" data-line-number="1554"></td>
          <td id="LC1554">    <span>Dim</span> <span>baEmpty()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1555" data-line-number="1555"></td>
          <td id="LC1555">    </td>
        </tr>
        <tr>
          <td id="L1556" data-line-number="1556"></td>
          <td id="LC1556">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1557" data-line-number="1557"></td>
          <td id="LC1557">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1558" data-line-number="1558"></td>
          <td id="LC1558">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_APPDATA,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1559" data-line-number="1559"></td>
          <td id="LC1559">            <span>&#39;--- Server Encrypted Extensions</span></td>
        </tr>
        <tr>
          <td id="L1560" data-line-number="1560"></td>
          <td id="LC1560">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1561" data-line-number="1561"></td>
          <td id="LC1561">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_ENCRYPTED_EXTENSIONS</span></td>
        </tr>
        <tr>
          <td id="L1562" data-line-number="1562"></td>
          <td id="LC1562">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1563" data-line-number="1563"></td>
          <td id="LC1563">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1564" data-line-number="1564"></td>
          <td id="LC1564">                    <span>If</span> <span>LenB(.AlpnNegotiated)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1565" data-line-number="1565"></td>
          <td id="LC1565">                        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_EXTENSION_ALPN,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1566" data-line-number="1566"></td>
          <td id="LC1566">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1567" data-line-number="1567"></td>
          <td id="LC1567">                            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1568" data-line-number="1568"></td>
          <td id="LC1568">                                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1569" data-line-number="1569"></td>
          <td id="LC1569">                                    <span>pvBufferWriteString</span> <span>uOutput,</span> <span>.AlpnNegotiated</span></td>
        </tr>
        <tr>
          <td id="L1570" data-line-number="1570"></td>
          <td id="LC1570">                                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1571" data-line-number="1571"></td>
          <td id="LC1571">                            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1572" data-line-number="1572"></td>
          <td id="LC1572">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1573" data-line-number="1573"></td>
          <td id="LC1573">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1574" data-line-number="1574"></td>
          <td id="LC1574">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1575" data-line-number="1575"></td>
          <td id="LC1575">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1576" data-line-number="1576"></td>
          <td id="LC1576">            <span>&#39;--- Server Certificate</span></td>
        </tr>
        <tr>
          <td id="L1577" data-line-number="1577"></td>
          <td id="LC1577">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L1578" data-line-number="1578"></td>
          <td id="LC1578">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1579" data-line-number="1579"></td>
          <td id="LC1579">                <span>&#39;--- certificate request context</span></td>
        </tr>
        <tr>
          <td id="L1580" data-line-number="1580"></td>
          <td id="LC1580">                <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1581" data-line-number="1581"></td>
          <td id="LC1581">                    <span>&#39;--- empty</span></td>
        </tr>
        <tr>
          <td id="L1582" data-line-number="1582"></td>
          <td id="LC1582">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1583" data-line-number="1583"></td>
          <td id="LC1583">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1584" data-line-number="1584"></td>
          <td id="LC1584">                    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>pvCollectionCount(.LocalCertificates)</span></td>
        </tr>
        <tr>
          <td id="L1585" data-line-number="1585"></td>
          <td id="LC1585">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1586" data-line-number="1586"></td>
          <td id="LC1586">                            <span>baCert</span> <span>=</span> <span>.LocalCertificates.Item(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L1587" data-line-number="1587"></td>
          <td id="LC1587">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L1588" data-line-number="1588"></td>
          <td id="LC1588">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1589" data-line-number="1589"></td>
          <td id="LC1589">                        <span>&#39;--- certificate extensions</span></td>
        </tr>
        <tr>
          <td id="L1590" data-line-number="1590"></td>
          <td id="LC1590">                        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1591" data-line-number="1591"></td>
          <td id="LC1591">                            <span>&#39;--- empty</span></td>
        </tr>
        <tr>
          <td id="L1592" data-line-number="1592"></td>
          <td id="LC1592">                        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1593" data-line-number="1593"></td>
          <td id="LC1593">                    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1594" data-line-number="1594"></td>
          <td id="LC1594">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1595" data-line-number="1595"></td>
          <td id="LC1595">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1596" data-line-number="1596"></td>
          <td id="LC1596">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1597" data-line-number="1597"></td>
          <td id="LC1597">            <span>&#39;--- Server Certificate Verify</span></td>
        </tr>
        <tr>
          <td id="L1598" data-line-number="1598"></td>
          <td id="LC1598">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1599" data-line-number="1599"></td>
          <td id="LC1599">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_CERTIFICATE_VERIFY</span></td>
        </tr>
        <tr>
          <td id="L1600" data-line-number="1600"></td>
          <td id="LC1600">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1601" data-line-number="1601"></td>
          <td id="LC1601">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>.SignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1602" data-line-number="1602"></td>
          <td id="LC1602">                <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1603" data-line-number="1603"></td>
          <td id="LC1603">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1604" data-line-number="1604"></td>
          <td id="LC1604">                    <span>pvBufferWriteString</span> <span>uVerify,</span> <span>Space$(</span><span>64</span><span>)</span> <span>&amp;</span> <span>&#34;TLS 1.3, server CertificateVerify&#34;</span> <span>&amp;</span> <span>Chr$(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1605" data-line-number="1605"></td>
          <td id="LC1605">                    <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1606" data-line-number="1606"></td>
          <td id="LC1606">                    <span>pvBufferWriteEOF</span> <span>uVerify</span></td>
        </tr>
        <tr>
          <td id="L1607" data-line-number="1607"></td>
          <td id="LC1607">                    <span>pvTlsSignatureSign</span> <span>baSignature,</span> <span>.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>.SignatureScheme,</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1608" data-line-number="1608"></td>
          <td id="LC1608">                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baSignature</span></td>
        </tr>
        <tr>
          <td id="L1609" data-line-number="1609"></td>
          <td id="LC1609">                <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1610" data-line-number="1610"></td>
          <td id="LC1610">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1611" data-line-number="1611"></td>
          <td id="LC1611">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1612" data-line-number="1612"></td>
          <td id="LC1612">            <span>&#39;--- Server Handshake Finished</span></td>
        </tr>
        <tr>
          <td id="L1613" data-line-number="1613"></td>
          <td id="LC1613">            <span>lMessagePos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L1614" data-line-number="1614"></td>
          <td id="LC1614">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_FINISHED</span></td>
        </tr>
        <tr>
          <td id="L1615" data-line-number="1615"></td>
          <td id="LC1615">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1616" data-line-number="1616"></td>
          <td id="LC1616">                <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1617" data-line-number="1617"></td>
          <td id="LC1617">                <span>pvTlsHkdfExpandLabel</span> <span>baTemp,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;finished&#34;</span><span>,</span> <span>baEmpty,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L1618" data-line-number="1618"></td>
          <td id="LC1618">                <span>pvTlsHkdfExtract</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>baTemp,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1619" data-line-number="1619"></td>
          <td id="LC1619">                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1620" data-line-number="1620"></td>
          <td id="LC1620">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1621" data-line-number="1621"></td>
          <td id="LC1621">            <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L1622" data-line-number="1622"></td>
          <td id="LC1622">            <span>&#39;--- Record Type</span></td>
        </tr>
        <tr>
          <td id="L1623" data-line-number="1623"></td>
          <td id="LC1623">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE</span></td>
        </tr>
        <tr>
          <td id="L1624" data-line-number="1624"></td>
          <td id="LC1624">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1625" data-line-number="1625"></td>
          <td id="LC1625">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1626" data-line-number="1626"></td>
          <td id="LC1626"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1627" data-line-number="1627"></td>
          <td id="LC1627">
</td>
        </tr>
        <tr>
          <td id="L1628" data-line-number="1628"></td>
          <td id="LC1628"><span>Private</span> <span>Sub</span> <span>pvTlsBuildServerLegacyFinished(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L1629" data-line-number="1629"></td>
          <td id="LC1629">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1630" data-line-number="1630"></td>
          <td id="LC1630">    <span>Dim</span> <span>uVerify</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L1631" data-line-number="1631"></td>
          <td id="LC1631">    </td>
        </tr>
        <tr>
          <td id="L1632" data-line-number="1632"></td>
          <td id="LC1632">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1633" data-line-number="1633"></td>
          <td id="LC1633">        <span>&#39;--- Change Cipher Spec</span></td>
        </tr>
        <tr>
          <td id="L1634" data-line-number="1634"></td>
          <td id="LC1634">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1635" data-line-number="1635"></td>
          <td id="LC1635">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1636" data-line-number="1636"></td>
          <td id="LC1636">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1637" data-line-number="1637"></td>
          <td id="LC1637">        <span>&#39;--- commit next epoch local secrets</span></td>
        </tr>
        <tr>
          <td id="L1638" data-line-number="1638"></td>
          <td id="LC1638">        <span>.LocalMacKey</span> <span>=</span> <span>.LocalLegacyNextMacKey</span></td>
        </tr>
        <tr>
          <td id="L1639" data-line-number="1639"></td>
          <td id="LC1639">        <span>.LocalTrafficKey</span> <span>=</span> <span>.LocalLegacyNextTrafficKey</span></td>
        </tr>
        <tr>
          <td id="L1640" data-line-number="1640"></td>
          <td id="LC1640">        <span>.LocalTrafficIV</span> <span>=</span> <span>.LocalLegacyNextTrafficIV</span></td>
        </tr>
        <tr>
          <td id="L1641" data-line-number="1641"></td>
          <td id="LC1641">        <span>.LocalTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1642" data-line-number="1642"></td>
          <td id="LC1642">        <span>.LocalEncryptThenMac</span> <span>=</span> <span>(.MacSize</span> <span>&gt;</span> <span>0</span><span>)</span> <span>And</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC)</span></td>
        </tr>
        <tr>
          <td id="L1643" data-line-number="1643"></td>
          <td id="LC1643">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1644" data-line-number="1644"></td>
          <td id="LC1644">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1645" data-line-number="1645"></td>
          <td id="LC1645">            <span>&#39;--- Server Handshake Finished</span></td>
        </tr>
        <tr>
          <td id="L1646" data-line-number="1646"></td>
          <td id="LC1646">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_HANDSHAKE_FINISHED</span></td>
        </tr>
        <tr>
          <td id="L1647" data-line-number="1647"></td>
          <td id="LC1647">            <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L1648" data-line-number="1648"></td>
          <td id="LC1648">                <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1649" data-line-number="1649"></td>
          <td id="LC1649">                <span>pvTlsKdfLegacyPrf</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>&#34;server finished&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>TLS_VERIFY_DATA_SIZE</span></td>
        </tr>
        <tr>
          <td id="L1650" data-line-number="1650"></td>
          <td id="LC1650">                <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1651" data-line-number="1651"></td>
          <td id="LC1651">                    <span>.LocalLegacyVerifyData</span> <span>=</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1652" data-line-number="1652"></td>
          <td id="LC1652">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1653" data-line-number="1653"></td>
          <td id="LC1653">                <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L1654" data-line-number="1654"></td>
          <td id="LC1654">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L1655" data-line-number="1655"></td>
          <td id="LC1655">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1656" data-line-number="1656"></td>
          <td id="LC1656">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1657" data-line-number="1657"></td>
          <td id="LC1657"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1658" data-line-number="1658"></td>
          <td id="LC1658">
</td>
        </tr>
        <tr>
          <td id="L1659" data-line-number="1659"></td>
          <td id="LC1659"><span>Private</span> <span>Sub</span> <span>pvTlsBuildApplicationData(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>baData()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lContentType</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1660" data-line-number="1660"></td>
          <td id="LC1660">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1661" data-line-number="1661"></td>
          <td id="LC1661">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1662" data-line-number="1662"></td>
          <td id="LC1662">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_APPDATA,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1663" data-line-number="1663"></td>
          <td id="LC1663">            <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1664" data-line-number="1664"></td>
          <td id="LC1664">                <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baData(lPos)),</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L1665" data-line-number="1665"></td>
          <td id="LC1665">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1666" data-line-number="1666"></td>
          <td id="LC1666">            <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1667" data-line-number="1667"></td>
          <td id="LC1667">                <span>&#39;--- Record Type</span></td>
        </tr>
        <tr>
          <td id="L1668" data-line-number="1668"></td>
          <td id="LC1668">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>lContentType</span></td>
        </tr>
        <tr>
          <td id="L1669" data-line-number="1669"></td>
          <td id="LC1669">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1670" data-line-number="1670"></td>
          <td id="LC1670">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1671" data-line-number="1671"></td>
          <td id="LC1671">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1672" data-line-number="1672"></td>
          <td id="LC1672"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1673" data-line-number="1673"></td>
          <td id="LC1673">
</td>
        </tr>
        <tr>
          <td id="L1674" data-line-number="1674"></td>
          <td id="LC1674"><span>Private</span> <span>Sub</span> <span>pvTlsBuildAlert(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>eAlertDesc</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum,</span> <span>ByVal</span> <span>lAlertLevel</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1675" data-line-number="1675"></td>
          <td id="LC1675">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1676" data-line-number="1676"></td>
          <td id="LC1676">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1677" data-line-number="1677"></td>
          <td id="LC1677">    </td>
        </tr>
        <tr>
          <td id="L1678" data-line-number="1678"></td>
          <td id="LC1678">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1679" data-line-number="1679"></td>
          <td id="LC1679"><span>#</span><span>If</span> <span>ImplTlsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1680" data-line-number="1680"></td>
          <td id="LC1680">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientFinished</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1681" data-line-number="1681"></td>
          <td id="LC1681">            <span>&#39;--- alerts must be protected with application data traffic secrets (not handshake)</span></td>
        </tr>
        <tr>
          <td id="L1682" data-line-number="1682"></td>
          <td id="LC1682">            <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span></td>
        </tr>
        <tr>
          <td id="L1683" data-line-number="1683"></td>
          <td id="LC1683">            <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1684" data-line-number="1684"></td>
          <td id="LC1684">            <span>pvTlsDeriveApplicationSecrets</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L1685" data-line-number="1685"></td>
          <td id="LC1685">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1686" data-line-number="1686"></td>
          <td id="LC1686"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1687" data-line-number="1687"></td>
          <td id="LC1687">        <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1688" data-line-number="1688"></td>
          <td id="LC1688">            <span>&#39;--- for TLS 1.3 -&gt; tunnel alert through application data traffic protection</span></td>
        </tr>
        <tr>
          <td id="L1689" data-line-number="1689"></td>
          <td id="LC1689">            <span>pvArrayByte</span> <span>baTemp,</span> <span>lAlertLevel,</span> <span>eAlertDesc</span></td>
        </tr>
        <tr>
          <td id="L1690" data-line-number="1690"></td>
          <td id="LC1690">            <span>pvTlsBuildApplicationData</span> <span>uCtx,</span> <span>uOutput,</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>UBound(baTemp)</span> <span>+</span> <span>1</span><span>,</span> <span>TLS_CONTENT_TYPE_ALERT</span></td>
        </tr>
        <tr>
          <td id="L1691" data-line-number="1691"></td>
          <td id="LC1691">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1692" data-line-number="1692"></td>
          <td id="LC1692">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1693" data-line-number="1693"></td>
          <td id="LC1693">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L1694" data-line-number="1694"></td>
          <td id="LC1694">        <span>pvBufferWriteRecordStart</span> <span>uOutput,</span> <span>TLS_CONTENT_TYPE_ALERT,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1695" data-line-number="1695"></td>
          <td id="LC1695">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>lAlertLevel</span></td>
        </tr>
        <tr>
          <td id="L1696" data-line-number="1696"></td>
          <td id="LC1696">            <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>eAlertDesc</span></td>
        </tr>
        <tr>
          <td id="L1697" data-line-number="1697"></td>
          <td id="LC1697">        <span>pvBufferWriteRecordEnd</span> <span>uOutput,</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1698" data-line-number="1698"></td>
          <td id="LC1698">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1699" data-line-number="1699"></td>
          <td id="LC1699"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L1700" data-line-number="1700"></td>
          <td id="LC1700"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L1701" data-line-number="1701"></td>
          <td id="LC1701">
</td>
        </tr>
        <tr>
          <td id="L1702" data-line-number="1702"></td>
          <td id="LC1702"><span>Private</span> <span>Function</span> <span>pvTlsParsePayload(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L1703" data-line-number="1703"></td>
          <td id="LC1703">    <span>Dim</span> <span>lNewSize</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1704" data-line-number="1704"></td>
          <td id="LC1704">    </td>
        </tr>
        <tr>
          <td id="L1705" data-line-number="1705"></td>
          <td id="LC1705">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L1706" data-line-number="1706"></td>
          <td id="LC1706">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1707" data-line-number="1707"></td>
          <td id="LC1707">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1708" data-line-number="1708"></td>
          <td id="LC1708">        <span>pvBufferWriteBlob</span> <span>.RecvBuffer,</span> <span>VarPtr(baInput(</span><span>0</span><span>)),</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L1709" data-line-number="1709"></td>
          <td id="LC1709">        <span>If</span> <span>Not</span> <span>pvTlsParseRecord(uCtx,</span> <span>.RecvBuffer,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1710" data-line-number="1710"></td>
          <td id="LC1710">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1711" data-line-number="1711"></td>
          <td id="LC1711">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1712" data-line-number="1712"></td>
          <td id="LC1712">        <span>lNewSize</span> <span>=</span> <span>.RecvBuffer.Size</span> <span>-</span> <span>.RecvBuffer.Pos</span></td>
        </tr>
        <tr>
          <td id="L1713" data-line-number="1713"></td>
          <td id="LC1713">        <span>If</span> <span>lNewSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1714" data-line-number="1714"></td>
          <td id="LC1714">            <span>Debug.Assert</span> <span>pvArraySize(.RecvBuffer.Data)</span> <span>&gt;=</span> <span>.RecvBuffer.Pos</span> <span>+</span> <span>lNewSize</span></td>
        </tr>
        <tr>
          <td id="L1715" data-line-number="1715"></td>
          <td id="LC1715">            <span>Call</span> <span>CopyMemory(.RecvBuffer.Data(</span><span>0</span><span>),</span> <span>.RecvBuffer.Data(.RecvBuffer.Pos),</span> <span>lNewSize)</span></td>
        </tr>
        <tr>
          <td id="L1716" data-line-number="1716"></td>
          <td id="LC1716">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1717" data-line-number="1717"></td>
          <td id="LC1717">        <span>.RecvBuffer.Pos</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1718" data-line-number="1718"></td>
          <td id="LC1718">        <span>.RecvBuffer.Size</span> <span>=</span> <span>IIf(lNewSize</span> <span>&gt;</span> <span>0</span><span>,</span> <span>lNewSize,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1719" data-line-number="1719"></td>
          <td id="LC1719">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1720" data-line-number="1720"></td>
          <td id="LC1720">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1721" data-line-number="1721"></td>
          <td id="LC1721">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L1722" data-line-number="1722"></td>
          <td id="LC1722">    <span>pvTlsParsePayload</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L1723" data-line-number="1723"></td>
          <td id="LC1723"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L1724" data-line-number="1724"></td>
          <td id="LC1724">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L1725" data-line-number="1725"></td>
          <td id="LC1725"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L1726" data-line-number="1726"></td>
          <td id="LC1726">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L1727" data-line-number="1727"></td>
          <td id="LC1727">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L1728" data-line-number="1728"></td>
          <td id="LC1728">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1729" data-line-number="1729"></td>
          <td id="LC1729"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L1730" data-line-number="1730"></td>
          <td id="LC1730">
</td>
        </tr>
        <tr>
          <td id="L1731" data-line-number="1731"></td>
          <td id="LC1731"><span>Private</span> <span>Function</span> <span>pvTlsParseRecord(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L1732" data-line-number="1732"></td>
          <td id="LC1732">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsParseRecord&#34;</span></td>
        </tr>
        <tr>
          <td id="L1733" data-line-number="1733"></td>
          <td id="LC1733">    <span>Dim</span> <span>lRecordPos</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1734" data-line-number="1734"></td>
          <td id="LC1734">    <span>Dim</span> <span>lRecordSize</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1735" data-line-number="1735"></td>
          <td id="LC1735">    <span>Dim</span> <span>lRecordType</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1736" data-line-number="1736"></td>
          <td id="LC1736">    <span>Dim</span> <span>lRecordProtocol</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1737" data-line-number="1737"></td>
          <td id="LC1737">    <span>Dim</span> <span>baRemoteIV()</span>    <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1738" data-line-number="1738"></td>
          <td id="LC1738">    <span>Dim</span> <span>lEnd</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1739" data-line-number="1739"></td>
          <td id="LC1739">    <span>Dim</span> <span>uAad</span>            <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L1740" data-line-number="1740"></td>
          <td id="LC1740">    <span>Dim</span> <span>bResult</span>         <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L1741" data-line-number="1741"></td>
          <td id="LC1741">    <span>Dim</span> <span>baHmac()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1742" data-line-number="1742"></td>
          <td id="LC1742">    <span>Dim</span> <span>lPadding</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1743" data-line-number="1743"></td>
          <td id="LC1743">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1744" data-line-number="1744"></td>
          <td id="LC1744">    </td>
        </tr>
        <tr>
          <td id="L1745" data-line-number="1745"></td>
          <td id="LC1745">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L1746" data-line-number="1746"></td>
          <td id="LC1746">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L1747" data-line-number="1747"></td>
          <td id="LC1747">    <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>4</span> <span>&lt;</span> <span>uInput.Size</span></td>
        </tr>
        <tr>
          <td id="L1748" data-line-number="1748"></td>
          <td id="LC1748">        <span>lRecordPos</span> <span>=</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L1749" data-line-number="1749"></td>
          <td id="LC1749">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lRecordType</span></td>
        </tr>
        <tr>
          <td id="L1750" data-line-number="1750"></td>
          <td id="LC1750">        <span>If</span> <span>lRecordType</span> <span>&lt;</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC</span> <span>Or</span> <span>lRecordType</span> <span>&gt;</span> <span>TLS_CONTENT_TYPE_APPDATA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1751" data-line-number="1751"></td>
          <td id="LC1751">            <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1752" data-line-number="1752"></td>
          <td id="LC1752">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1753" data-line-number="1753"></td>
          <td id="LC1753">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lRecordProtocol,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1754" data-line-number="1754"></td>
          <td id="LC1754">        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lRecordSize</span></td>
        </tr>
        <tr>
          <td id="L1755" data-line-number="1755"></td>
          <td id="LC1755">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lRecordSize</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1756" data-line-number="1756"></td>
          <td id="LC1756">                <span>&#39;--- back off and bail out early</span></td>
        </tr>
        <tr>
          <td id="L1757" data-line-number="1757"></td>
          <td id="LC1757">                <span>uInput.Stack.Remove</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1758" data-line-number="1758"></td>
          <td id="LC1758">                <span>uInput.Pos</span> <span>=</span> <span>lRecordPos</span></td>
        </tr>
        <tr>
          <td id="L1759" data-line-number="1759"></td>
          <td id="LC1759">                <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L1760" data-line-number="1760"></td>
          <td id="LC1760">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1761" data-line-number="1761"></td>
          <td id="LC1761">            <span>&#39;--- try to decrypt record</span></td>
        </tr>
        <tr>
          <td id="L1762" data-line-number="1762"></td>
          <td id="LC1762">            <span>If</span> <span>pvArraySize(.RemoteTrafficKey)</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1763" data-line-number="1763"></td>
          <td id="LC1763">                <span>&#39;--- check ciphertext size</span></td>
        </tr>
        <tr>
          <td id="L1764" data-line-number="1764"></td>
          <td id="LC1764">                <span>If</span> <span>lRecordSize</span> <span>&gt;</span> <span>TLS_MAX_ENCRYPTED_RECORD_SIZE</span> <span>+</span> <span>.MacSize</span> <span>+</span> <span>.IvExplicitSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1765" data-line-number="1765"></td>
          <td id="LC1765">                    <span>GoTo</span> <span>RecordOverflow</span></td>
        </tr>
        <tr>
          <td id="L1766" data-line-number="1766"></td>
          <td id="LC1766">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1767" data-line-number="1767"></td>
          <td id="LC1767">                <span>If</span> <span>lRecordSize</span> <span>&lt;</span> <span>.TagSize</span> <span>+</span> <span>.MacSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1768" data-line-number="1768"></td>
          <td id="LC1768">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1769" data-line-number="1769"></td>
          <td id="LC1769">                        <span>GoTo</span> <span>Unencrypted</span></td>
        </tr>
        <tr>
          <td id="L1770" data-line-number="1770"></td>
          <td id="LC1770">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1771" data-line-number="1771"></td>
          <td id="LC1771">                    <span>GoTo</span> <span>RecordMacFailed</span></td>
        </tr>
        <tr>
          <td id="L1772" data-line-number="1772"></td>
          <td id="LC1772">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1773" data-line-number="1773"></td>
          <td id="LC1773">                <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lRecordSize</span> <span>-</span> <span>.TagSize</span></td>
        </tr>
        <tr>
          <td id="L1774" data-line-number="1774"></td>
          <td id="LC1774">                <span>bResult</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L1775" data-line-number="1775"></td>
          <td id="LC1775">                <span>pvArrayXor</span> <span>baRemoteIV,</span> <span>.RemoteTrafficIV,</span> <span>.RemoteTrafficSeqNo</span></td>
        </tr>
        <tr>
          <td id="L1776" data-line-number="1776"></td>
          <td id="LC1776">                <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1777" data-line-number="1777"></td>
          <td id="LC1777">                    <span>If</span> <span>lRecordType</span> <span>&lt;&gt;</span> <span>TLS_CONTENT_TYPE_APPDATA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1778" data-line-number="1778"></td>
          <td id="LC1778">                        <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1779" data-line-number="1779"></td>
          <td id="LC1779">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1780" data-line-number="1780"></td>
          <td id="LC1780">                    <span>bResult</span> <span>=</span> <span>pvTlsBulkDecrypt(.BulkAlgo,</span> <span>baRemoteIV,</span> <span>.RemoteTrafficKey,</span> <span>uInput.Data,</span> <span>lRecordPos,</span> <span>TLS_AAD_SIZE,</span> <span>uInput.Data,</span> <span>uInput.Pos,</span> <span>lRecordSize)</span></td>
        </tr>
        <tr>
          <td id="L1781" data-line-number="1781"></td>
          <td id="LC1781">                <span>ElseIf</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1782" data-line-number="1782"></td>
          <td id="LC1782">                    <span>If</span> <span>.IvExplicitSize</span> <span>&gt;</span> <span>0</span> <span>Then</span> <span>&#39;--- AES in TLS 1.2</span></td>
        </tr>
        <tr>
          <td id="L1783" data-line-number="1783"></td>
          <td id="LC1783">                        <span>pvArrayWriteBlob</span> <span>baRemoteIV,</span> <span>.IvSize</span> <span>-</span> <span>.IvExplicitSize,</span> <span>VarPtr(uInput.Data(uInput.Pos)),</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L1784" data-line-number="1784"></td>
          <td id="LC1784">                        <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L1785" data-line-number="1785"></td>
          <td id="LC1785">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1786" data-line-number="1786"></td>
          <td id="LC1786">                    <span>uAad.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1787" data-line-number="1787"></td>
          <td id="LC1787">                    <span>pvBufferWriteLong</span> <span>uAad,</span> <span>0</span><span>,</span> <span>Size:=</span><span>4</span></td>
        </tr>
        <tr>
          <td id="L1788" data-line-number="1788"></td>
          <td id="LC1788">                    <span>pvBufferWriteLong</span> <span>uAad,</span> <span>.RemoteTrafficSeqNo,</span> <span>Size:=</span><span>4</span></td>
        </tr>
        <tr>
          <td id="L1789" data-line-number="1789"></td>
          <td id="LC1789">                    <span>pvBufferWriteBlob</span> <span>uAad,</span> <span>VarPtr(uInput.Data(lRecordPos)),</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L1790" data-line-number="1790"></td>
          <td id="LC1790">                    <span>If</span> <span>Not</span> <span>.RemoteEncryptThenMac</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1791" data-line-number="1791"></td>
          <td id="LC1791">                        <span>pvBufferWriteLong</span> <span>uAad,</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1792" data-line-number="1792"></td>
          <td id="LC1792">                        <span>Debug.Assert</span> <span>uAad.Size</span> <span>=</span> <span>TLS_LEGACY_AAD_SIZE</span></td>
        </tr>
        <tr>
          <td id="L1793" data-line-number="1793"></td>
          <td id="LC1793">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1794" data-line-number="1794"></td>
          <td id="LC1794">                        <span>lEnd</span> <span>=</span> <span>lEnd</span> <span>-</span> <span>.MacSize</span></td>
        </tr>
        <tr>
          <td id="L1795" data-line-number="1795"></td>
          <td id="LC1795">                        <span>&#39;--- prepare encrypted data for MAC</span></td>
        </tr>
        <tr>
          <td id="L1796" data-line-number="1796"></td>
          <td id="LC1796">                        <span>pvBufferWriteLong</span> <span>uAad,</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span> <span>+</span> <span>.IvExplicitSize,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1797" data-line-number="1797"></td>
          <td id="LC1797">                        <span>pvBufferWriteBlob</span> <span>uAad,</span> <span>VarPtr(uInput.Data(uInput.Pos</span> <span>-</span> <span>.IvExplicitSize)),</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span> <span>+</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L1798" data-line-number="1798"></td>
          <td id="LC1798">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1799" data-line-number="1799"></td>
          <td id="LC1799">                    <span>bResult</span> <span>=</span> <span>pvTlsBulkDecrypt(.BulkAlgo,</span> <span>baRemoteIV,</span> <span>.RemoteTrafficKey,</span> <span>uAad.Data,</span> <span>0</span><span>,</span> <span>uAad.Size,</span> <span>uInput.Data,</span> <span>uInput.Pos,</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span> <span>+</span> <span>.TagSize)</span></td>
        </tr>
        <tr>
          <td id="L1800" data-line-number="1800"></td>
          <td id="LC1800">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1801" data-line-number="1801"></td>
          <td id="LC1801">                <span>If</span> <span>Not</span> <span>bResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1802" data-line-number="1802"></td>
          <td id="LC1802">                    <span>GoTo</span> <span>DecryptionFailed</span></td>
        </tr>
        <tr>
          <td id="L1803" data-line-number="1803"></td>
          <td id="LC1803">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1804" data-line-number="1804"></td>
          <td id="LC1804">                <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1805" data-line-number="1805"></td>
          <td id="LC1805">                    <span>If</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1806" data-line-number="1806"></td>
          <td id="LC1806">                        <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Input (decrypted)&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(uInput.Data,</span> <span>lRecordPos,</span> <span>lEnd</span> <span>-</span> <span>lRecordPos)</span></td>
        </tr>
        <tr>
          <td id="L1807" data-line-number="1807"></td>
          <td id="LC1807">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1808" data-line-number="1808"></td>
          <td id="LC1808">                <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1809" data-line-number="1809"></td>
          <td id="LC1809">                <span>.RemoteTrafficSeqNo</span> <span>=</span> <span>UnsignedAdd(.RemoteTrafficSeqNo,</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1810" data-line-number="1810"></td>
          <td id="LC1810">                <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1811" data-line-number="1811"></td>
          <td id="LC1811">                    <span>If</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span> <span>&gt;</span> <span>TLS_MAX_PLAINTEXT_RECORD_SIZE</span> <span>+</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1812" data-line-number="1812"></td>
          <td id="LC1812">                        <span>GoTo</span> <span>RecordOverflow</span></td>
        </tr>
        <tr>
          <td id="L1813" data-line-number="1813"></td>
          <td id="LC1813">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1814" data-line-number="1814"></td>
          <td id="LC1814">                    <span>&#39;--- trim zero padding at the end of decrypted record</span></td>
        </tr>
        <tr>
          <td id="L1815" data-line-number="1815"></td>
          <td id="LC1815">                    <span>Do</span> <span>While</span> <span>lEnd</span> <span>&gt;</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L1816" data-line-number="1816"></td>
          <td id="LC1816">                        <span>lEnd</span> <span>=</span> <span>lEnd</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1817" data-line-number="1817"></td>
          <td id="LC1817">                        <span>If</span> <span>uInput.Data(lEnd)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1818" data-line-number="1818"></td>
          <td id="LC1818">                            <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L1819" data-line-number="1819"></td>
          <td id="LC1819">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1820" data-line-number="1820"></td>
          <td id="LC1820">                    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L1821" data-line-number="1821"></td>
          <td id="LC1821">                    <span>lRecordType</span> <span>=</span> <span>uInput.Data(lEnd)</span></td>
        </tr>
        <tr>
          <td id="L1822" data-line-number="1822"></td>
          <td id="LC1822">                <span>ElseIf</span> <span>.MacSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1823" data-line-number="1823"></td>
          <td id="LC1823">                    <span>If</span> <span>Not</span> <span>.RemoteEncryptThenMac</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1824" data-line-number="1824"></td>
          <td id="LC1824">                        <span>&#39;--- remove padding and prepare decrypted data for MAC</span></td>
        </tr>
        <tr>
          <td id="L1825" data-line-number="1825"></td>
          <td id="LC1825">                        <span>lPadding</span> <span>=</span> <span>uInput.Data(lEnd</span> <span>-</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1826" data-line-number="1826"></td>
          <td id="LC1826">                        <span>If</span> <span>lEnd</span> <span>-</span> <span>(lPadding</span> <span>+</span> <span>1</span><span>)</span> <span>-</span> <span>.MacSize</span> <span>&lt;</span> <span>uInput.Pos</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1827" data-line-number="1827"></td>
          <td id="LC1827">                            <span>GoTo</span> <span>RecordMacFailed</span></td>
        </tr>
        <tr>
          <td id="L1828" data-line-number="1828"></td>
          <td id="LC1828">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1829" data-line-number="1829"></td>
          <td id="LC1829">                        <span>For</span> <span>lIdx</span> <span>=</span> <span>2</span> <span>To</span> <span>lPadding</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1830" data-line-number="1830"></td>
          <td id="LC1830">                            <span>If</span> <span>uInput.Data(lEnd</span> <span>-</span> <span>lIdx)</span> <span>&lt;&gt;</span> <span>lPadding</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1831" data-line-number="1831"></td>
          <td id="LC1831">                                <span>GoTo</span> <span>RecordMacFailed</span></td>
        </tr>
        <tr>
          <td id="L1832" data-line-number="1832"></td>
          <td id="LC1832">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1833" data-line-number="1833"></td>
          <td id="LC1833">                        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1834" data-line-number="1834"></td>
          <td id="LC1834">                        <span>lEnd</span> <span>=</span> <span>lEnd</span> <span>-</span> <span>(lPadding</span> <span>+</span> <span>1</span><span>)</span> <span>-</span> <span>.MacSize</span></td>
        </tr>
        <tr>
          <td id="L1835" data-line-number="1835"></td>
          <td id="LC1835">                        <span>uAad.Size</span> <span>=</span> <span>uAad.Size</span> <span>-</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L1836" data-line-number="1836"></td>
          <td id="LC1836">                        <span>pvBufferWriteLong</span> <span>uAad,</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L1837" data-line-number="1837"></td>
          <td id="LC1837">                        <span>pvBufferWriteBlob</span> <span>uAad,</span> <span>VarPtr(uInput.Data(uInput.Pos)),</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L1838" data-line-number="1838"></td>
          <td id="LC1838">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1839" data-line-number="1839"></td>
          <td id="LC1839">                    <span>&#39;--- calc MAC and compare</span></td>
        </tr>
        <tr>
          <td id="L1840" data-line-number="1840"></td>
          <td id="LC1840">                    <span>pvTlsGetHmac</span> <span>baHmac,</span> <span>.MacAlgo,</span> <span>.RemoteMacKey,</span> <span>uAad.Data,</span> <span>0</span><span>,</span> <span>uAad.Size</span></td>
        </tr>
        <tr>
          <td id="L1841" data-line-number="1841"></td>
          <td id="LC1841">                    <span>pvArrayAllocate</span> <span>baRemoteIV,</span> <span>.MacSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRemoteIV&#34;</span></td>
        </tr>
        <tr>
          <td id="L1842" data-line-number="1842"></td>
          <td id="LC1842">                    <span>Call</span> <span>CopyMemory(baRemoteIV(</span><span>0</span><span>),</span> <span>ByVal</span> <span>VarPtr(uInput.Data(lEnd)),</span> <span>.MacSize)</span></td>
        </tr>
        <tr>
          <td id="L1843" data-line-number="1843"></td>
          <td id="LC1843">                    <span>If</span> <span>Not</span> <span>pvArrayEqual(baHmac,</span> <span>baRemoteIV)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1844" data-line-number="1844"></td>
          <td id="LC1844">                        <span>GoTo</span> <span>RecordMacFailed</span></td>
        </tr>
        <tr>
          <td id="L1845" data-line-number="1845"></td>
          <td id="LC1845">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1846" data-line-number="1846"></td>
          <td id="LC1846">                    <span>If</span> <span>.RemoteEncryptThenMac</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1847" data-line-number="1847"></td>
          <td id="LC1847">                        <span>&#39;--- remove padding from decrypted data</span></td>
        </tr>
        <tr>
          <td id="L1848" data-line-number="1848"></td>
          <td id="LC1848">                        <span>lPadding</span> <span>=</span> <span>uInput.Data(lEnd</span> <span>-</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1849" data-line-number="1849"></td>
          <td id="LC1849">                        <span>If</span> <span>lEnd</span> <span>-</span> <span>(lPadding</span> <span>+</span> <span>1</span><span>)</span> <span>&lt;</span> <span>uInput.Pos</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1850" data-line-number="1850"></td>
          <td id="LC1850">                            <span>GoTo</span> <span>RecordMacFailed</span></td>
        </tr>
        <tr>
          <td id="L1851" data-line-number="1851"></td>
          <td id="LC1851">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1852" data-line-number="1852"></td>
          <td id="LC1852">                        <span>For</span> <span>lIdx</span> <span>=</span> <span>2</span> <span>To</span> <span>lPadding</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L1853" data-line-number="1853"></td>
          <td id="LC1853">                            <span>If</span> <span>uInput.Data(lEnd</span> <span>-</span> <span>lIdx)</span> <span>&lt;&gt;</span> <span>lPadding</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1854" data-line-number="1854"></td>
          <td id="LC1854">                                <span>GoTo</span> <span>RecordMacFailed</span></td>
        </tr>
        <tr>
          <td id="L1855" data-line-number="1855"></td>
          <td id="LC1855">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1856" data-line-number="1856"></td>
          <td id="LC1856">                        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L1857" data-line-number="1857"></td>
          <td id="LC1857">                        <span>lEnd</span> <span>=</span> <span>lEnd</span> <span>-</span> <span>(lPadding</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1858" data-line-number="1858"></td>
          <td id="LC1858">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1859" data-line-number="1859"></td>
          <td id="LC1859">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1860" data-line-number="1860"></td>
          <td id="LC1860">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1861" data-line-number="1861"></td>
          <td id="LC1861"><span>Unencrypted:</span></td>
        </tr>
        <tr>
          <td id="L1862" data-line-number="1862"></td>
          <td id="LC1862">                <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lRecordSize</span></td>
        </tr>
        <tr>
          <td id="L1863" data-line-number="1863"></td>
          <td id="LC1863">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1864" data-line-number="1864"></td>
          <td id="LC1864">            <span>&#39;--- check plaintext size</span></td>
        </tr>
        <tr>
          <td id="L1865" data-line-number="1865"></td>
          <td id="LC1865">            <span>If</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span> <span>&gt;</span> <span>TLS_MAX_PLAINTEXT_RECORD_SIZE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1866" data-line-number="1866"></td>
          <td id="LC1866">                <span>GoTo</span> <span>RecordOverflow</span></td>
        </tr>
        <tr>
          <td id="L1867" data-line-number="1867"></td>
          <td id="LC1867">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1868" data-line-number="1868"></td>
          <td id="LC1868">            <span>Select</span> <span>Case</span> <span>lRecordType</span></td>
        </tr>
        <tr>
          <td id="L1869" data-line-number="1869"></td>
          <td id="LC1869">            <span>Case</span> <span>TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC</span></td>
        </tr>
        <tr>
          <td id="L1870" data-line-number="1870"></td>
          <td id="LC1870">                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;&gt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1871" data-line-number="1871"></td>
          <td id="LC1871">                    <span>GoTo</span> <span>UnexpectedRecordSize</span></td>
        </tr>
        <tr>
          <td id="L1872" data-line-number="1872"></td>
          <td id="LC1872">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1873" data-line-number="1873"></td>
          <td id="LC1873">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1874" data-line-number="1874"></td>
          <td id="LC1874">                    <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1875" data-line-number="1875"></td>
          <td id="LC1875">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1876" data-line-number="1876"></td>
          <td id="LC1876">                <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1877" data-line-number="1877"></td>
          <td id="LC1877">                    <span>If</span> <span>pvArraySize(.RemoteLegacyNextTrafficKey)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1878" data-line-number="1878"></td>
          <td id="LC1878">                        <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1879" data-line-number="1879"></td>
          <td id="LC1879">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1880" data-line-number="1880"></td>
          <td id="LC1880">                    <span>&#39;--- commit next epoch remote secrets</span></td>
        </tr>
        <tr>
          <td id="L1881" data-line-number="1881"></td>
          <td id="LC1881">                    <span>.RemoteMacKey</span> <span>=</span> <span>.RemoteLegacyNextMacKey</span></td>
        </tr>
        <tr>
          <td id="L1882" data-line-number="1882"></td>
          <td id="LC1882">                    <span>.RemoteTrafficKey</span> <span>=</span> <span>.RemoteLegacyNextTrafficKey</span></td>
        </tr>
        <tr>
          <td id="L1883" data-line-number="1883"></td>
          <td id="LC1883">                    <span>.RemoteTrafficIV</span> <span>=</span> <span>.RemoteLegacyNextTrafficIV</span></td>
        </tr>
        <tr>
          <td id="L1884" data-line-number="1884"></td>
          <td id="LC1884">                    <span>.RemoteTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1885" data-line-number="1885"></td>
          <td id="LC1885">                    <span>.RemoteEncryptThenMac</span> <span>=</span> <span>(.MacSize</span> <span>&gt;</span> <span>0</span><span>)</span> <span>And</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC)</span></td>
        </tr>
        <tr>
          <td id="L1886" data-line-number="1886"></td>
          <td id="LC1886">                    <span>Erase</span> <span>.RemoteLegacyNextTrafficKey</span></td>
        </tr>
        <tr>
          <td id="L1887" data-line-number="1887"></td>
          <td id="LC1887">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1888" data-line-number="1888"></td>
          <td id="LC1888">            <span>Case</span> <span>TLS_CONTENT_TYPE_ALERT</span></td>
        </tr>
        <tr>
          <td id="L1889" data-line-number="1889"></td>
          <td id="LC1889">                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&lt;&gt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1890" data-line-number="1890"></td>
          <td id="LC1890">                    <span>GoTo</span> <span>UnexpectedRecordSize</span></td>
        </tr>
        <tr>
          <td id="L1891" data-line-number="1891"></td>
          <td id="LC1891">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1892" data-line-number="1892"></td>
          <td id="LC1892">                <span>Select</span> <span>Case</span> <span>uInput.Data(uInput.Pos)</span></td>
        </tr>
        <tr>
          <td id="L1893" data-line-number="1893"></td>
          <td id="LC1893">                <span>Case</span> <span>TLS_ALERT_LEVEL_FATAL</span></td>
        </tr>
        <tr>
          <td id="L1894" data-line-number="1894"></td>
          <td id="LC1894">                    <span>sError</span> <span>=</span> <span>ERR_FATAL_ALERT</span></td>
        </tr>
        <tr>
          <td id="L1895" data-line-number="1895"></td>
          <td id="LC1895">                    <span>eAlertCode</span> <span>=</span> <span>uInput.Data(uInput.Pos</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1896" data-line-number="1896"></td>
          <td id="LC1896">                    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1897" data-line-number="1897"></td>
          <td id="LC1897">                <span>Case</span> <span>TLS_ALERT_LEVEL_WARNING</span></td>
        </tr>
        <tr>
          <td id="L1898" data-line-number="1898"></td>
          <td id="LC1898">                    <span>.LastAlertCode</span> <span>=</span> <span>uInput.Data(uInput.Pos</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L1899" data-line-number="1899"></td>
          <td id="LC1899">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1900" data-line-number="1900"></td>
          <td id="LC1900">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>pvTlsGetLastAlert(uCtx)</span> <span>&amp;</span> <span>&#34; (TLS_ALERT_LEVEL_WARNING)&#34;</span></td>
        </tr>
        <tr>
          <td id="L1901" data-line-number="1901"></td>
          <td id="LC1901">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1902" data-line-number="1902"></td>
          <td id="LC1902">                    <span>If</span> <span>.LastAlertCode</span> <span>=</span> <span>uscTlsAlertCloseNotify</span> <span>And</span> <span>.State</span> <span>&lt;&gt;</span> <span>ucsTlsStateShutdown</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1903" data-line-number="1903"></td>
          <td id="LC1903">                        <span>pvTlsSetLastError</span> <span>uCtx,</span> <span>AlertCode:=uscTlsAlertCloseNotify</span></td>
        </tr>
        <tr>
          <td id="L1904" data-line-number="1904"></td>
          <td id="LC1904">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1905" data-line-number="1905"></td>
          <td id="LC1905">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L1906" data-line-number="1906"></td>
          <td id="LC1906">            <span>Case</span> <span>TLS_CONTENT_TYPE_HANDSHAKE</span></td>
        </tr>
        <tr>
          <td id="L1907" data-line-number="1907"></td>
          <td id="LC1907">                <span>If</span> <span>uInput.Pos</span> <span>=</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1908" data-line-number="1908"></td>
          <td id="LC1908">                    <span>GoTo</span> <span>UnexpectedRecordSize</span></td>
        </tr>
        <tr>
          <td id="L1909" data-line-number="1909"></td>
          <td id="LC1909">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1910" data-line-number="1910"></td>
          <td id="LC1910">                <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1911" data-line-number="1911"></td>
          <td id="LC1911">                    <span>&#39;--- RFC 8446 section 5.1: Handshake messages MUST NOT be interleaved with other record types</span></td>
        </tr>
        <tr>
          <td id="L1912" data-line-number="1912"></td>
          <td id="LC1912">                    <span>If</span> <span>.PrevRecordType</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>.PrevRecordType</span> <span>&lt;&gt;</span> <span>lRecordType</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1913" data-line-number="1913"></td>
          <td id="LC1913">                        <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1914" data-line-number="1914"></td>
          <td id="LC1914">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1915" data-line-number="1915"></td>
          <td id="LC1915">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1916" data-line-number="1916"></td>
          <td id="LC1916">                <span>If</span> <span>.MessBuffer.Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1917" data-line-number="1917"></td>
          <td id="LC1917">                    <span>pvBufferWriteBlob</span> <span>.MessBuffer,</span> <span>VarPtr(uInput.Data(uInput.Pos)),</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L1918" data-line-number="1918"></td>
          <td id="LC1918">                    <span>If</span> <span>Not</span> <span>pvTlsParseHandshake(uCtx,</span> <span>.MessBuffer,</span> <span>.MessBuffer.Size,</span> <span>lRecordProtocol,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1919" data-line-number="1919"></td>
          <td id="LC1919">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1920" data-line-number="1920"></td>
          <td id="LC1920">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1921" data-line-number="1921"></td>
          <td id="LC1921">                    <span>If</span> <span>.MessBuffer.Pos</span> <span>&gt;=</span> <span>.MessBuffer.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1922" data-line-number="1922"></td>
          <td id="LC1922">                        <span>Erase</span> <span>.MessBuffer.Data</span></td>
        </tr>
        <tr>
          <td id="L1923" data-line-number="1923"></td>
          <td id="LC1923">                        <span>.MessBuffer.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1924" data-line-number="1924"></td>
          <td id="LC1924">                        <span>.MessBuffer.Pos</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1925" data-line-number="1925"></td>
          <td id="LC1925">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1926" data-line-number="1926"></td>
          <td id="LC1926">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1927" data-line-number="1927"></td>
          <td id="LC1927">                    <span>If</span> <span>Not</span> <span>pvTlsParseHandshake(uCtx,</span> <span>uInput,</span> <span>lEnd,</span> <span>lRecordProtocol,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1928" data-line-number="1928"></td>
          <td id="LC1928">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1929" data-line-number="1929"></td>
          <td id="LC1929">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1930" data-line-number="1930"></td>
          <td id="LC1930">                    <span>If</span> <span>uInput.Pos</span> <span>&lt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1931" data-line-number="1931"></td>
          <td id="LC1931">                        <span>pvBufferWriteBlob</span> <span>.MessBuffer,</span> <span>VarPtr(uInput.Data(uInput.Pos)),</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L1932" data-line-number="1932"></td>
          <td id="LC1932">                        <span>.MessBuffer.Pos</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L1933" data-line-number="1933"></td>
          <td id="LC1933">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1934" data-line-number="1934"></td>
          <td id="LC1934">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1935" data-line-number="1935"></td>
          <td id="LC1935">            <span>Case</span> <span>TLS_CONTENT_TYPE_APPDATA</span></td>
        </tr>
        <tr>
          <td id="L1936" data-line-number="1936"></td>
          <td id="LC1936">                <span>If</span> <span>.IsServer</span> <span>And</span> <span>.State</span> <span>&lt;</span> <span>ucsTlsStatePostHandshake</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L1937" data-line-number="1937"></td>
          <td id="LC1937">                    <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1938" data-line-number="1938"></td>
          <td id="LC1938">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L1939" data-line-number="1939"></td>
          <td id="LC1939">                <span>pvBufferWriteBlob</span> <span>.DecrBuffer,</span> <span>VarPtr(uInput.Data(uInput.Pos)),</span> <span>lEnd</span> <span>-</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L1940" data-line-number="1940"></td>
          <td id="LC1940">                <span>.PrevRecordType</span> <span>=</span> <span>lRecordType</span></td>
        </tr>
        <tr>
          <td id="L1941" data-line-number="1941"></td>
          <td id="LC1941">            <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L1942" data-line-number="1942"></td>
          <td id="LC1942">                <span>GoTo</span> <span>UnexpectedRecordType</span></td>
        </tr>
        <tr>
          <td id="L1943" data-line-number="1943"></td>
          <td id="LC1943">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L1944" data-line-number="1944"></td>
          <td id="LC1944">            <span>&#39;--- note: skip AEAD&#39;s authentication tag or zero padding</span></td>
        </tr>
        <tr>
          <td id="L1945" data-line-number="1945"></td>
          <td id="LC1945">            <span>uInput.Pos</span> <span>=</span> <span>lRecordPos</span> <span>+</span> <span>lRecordSize</span> <span>+</span> <span>5</span></td>
        </tr>
        <tr>
          <td id="L1946" data-line-number="1946"></td>
          <td id="LC1946">        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L1947" data-line-number="1947"></td>
          <td id="LC1947">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L1948" data-line-number="1948"></td>
          <td id="LC1948">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L1949" data-line-number="1949"></td>
          <td id="LC1949">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L1950" data-line-number="1950"></td>
          <td id="LC1950">    <span>pvTlsParseRecord</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L1951" data-line-number="1951"></td>
          <td id="LC1951"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L1952" data-line-number="1952"></td>
          <td id="LC1952">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L1953" data-line-number="1953"></td>
          <td id="LC1953"><span>RecordOverflow:</span></td>
        </tr>
        <tr>
          <td id="L1954" data-line-number="1954"></td>
          <td id="LC1954">    <span>sError</span> <span>=</span> <span>ERR_RECORD_OVERFLOW</span></td>
        </tr>
        <tr>
          <td id="L1955" data-line-number="1955"></td>
          <td id="LC1955">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertRecordOverflow</span></td>
        </tr>
        <tr>
          <td id="L1956" data-line-number="1956"></td>
          <td id="LC1956">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1957" data-line-number="1957"></td>
          <td id="LC1957"><span>DecryptionFailed:</span></td>
        </tr>
        <tr>
          <td id="L1958" data-line-number="1958"></td>
          <td id="LC1958">    <span>sError</span> <span>=</span> <span>ERR_DECRYPTION_FAILED</span></td>
        </tr>
        <tr>
          <td id="L1959" data-line-number="1959"></td>
          <td id="LC1959">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertBadRecordMac</span></td>
        </tr>
        <tr>
          <td id="L1960" data-line-number="1960"></td>
          <td id="LC1960">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1961" data-line-number="1961"></td>
          <td id="LC1961"><span>UnexpectedRecordType:</span></td>
        </tr>
        <tr>
          <td id="L1962" data-line-number="1962"></td>
          <td id="LC1962">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNEXPECTED_RECORD_TYPE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lRecordType)</span></td>
        </tr>
        <tr>
          <td id="L1963" data-line-number="1963"></td>
          <td id="LC1963">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertUnexpectedMessage</span></td>
        </tr>
        <tr>
          <td id="L1964" data-line-number="1964"></td>
          <td id="LC1964">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1965" data-line-number="1965"></td>
          <td id="LC1965"><span>UnexpectedRecordSize:</span></td>
        </tr>
        <tr>
          <td id="L1966" data-line-number="1966"></td>
          <td id="LC1966">    <span>sError</span> <span>=</span> <span>ERR_RECORD_OVERFLOW</span></td>
        </tr>
        <tr>
          <td id="L1967" data-line-number="1967"></td>
          <td id="LC1967">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertUnexpectedMessage</span></td>
        </tr>
        <tr>
          <td id="L1968" data-line-number="1968"></td>
          <td id="LC1968">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1969" data-line-number="1969"></td>
          <td id="LC1969"><span>RecordMacFailed:</span></td>
        </tr>
        <tr>
          <td id="L1970" data-line-number="1970"></td>
          <td id="LC1970">    <span>sError</span> <span>=</span> <span>ERR_RECORD_MAC_FAILED</span></td>
        </tr>
        <tr>
          <td id="L1971" data-line-number="1971"></td>
          <td id="LC1971">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertBadRecordMac</span></td>
        </tr>
        <tr>
          <td id="L1972" data-line-number="1972"></td>
          <td id="LC1972">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1973" data-line-number="1973"></td>
          <td id="LC1973"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L1974" data-line-number="1974"></td>
          <td id="LC1974">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L1975" data-line-number="1975"></td>
          <td id="LC1975">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L1976" data-line-number="1976"></td>
          <td id="LC1976">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L1977" data-line-number="1977"></td>
          <td id="LC1977"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L1978" data-line-number="1978"></td>
          <td id="LC1978">
</td>
        </tr>
        <tr>
          <td id="L1979" data-line-number="1979"></td>
          <td id="LC1979"><span>Private</span> <span>Function</span> <span>pvTlsParseHandshake(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lInputEnd</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lRecordProtocol</span> <span>As</span> <span>Long</span><span>,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L1980" data-line-number="1980"></td>
          <td id="LC1980">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsParseHandshake&#34;</span></td>
        </tr>
        <tr>
          <td id="L1981" data-line-number="1981"></td>
          <td id="LC1981">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1982" data-line-number="1982"></td>
          <td id="LC1982">    <span>Dim</span> <span>lMessageSize</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1983" data-line-number="1983"></td>
          <td id="LC1983">    <span>Dim</span> <span>lMessageEnd</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1984" data-line-number="1984"></td>
          <td id="LC1984">    <span>Dim</span> <span>lMessageType</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1985" data-line-number="1985"></td>
          <td id="LC1985">    <span>Dim</span> <span>baMessage()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1986" data-line-number="1986"></td>
          <td id="LC1986">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1987" data-line-number="1987"></td>
          <td id="LC1987">    <span>Dim</span> <span>uVerify</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L1988" data-line-number="1988"></td>
          <td id="LC1988">    <span>Dim</span> <span>lRequestUpdate</span>  <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1989" data-line-number="1989"></td>
          <td id="LC1989">    <span>Dim</span> <span>lCurveType</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1990" data-line-number="1990"></td>
          <td id="LC1990">    <span>Dim</span> <span>lNamedCurve</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1991" data-line-number="1991"></td>
          <td id="LC1991">    <span>Dim</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1992" data-line-number="1992"></td>
          <td id="LC1992">    <span>Dim</span> <span>lSignatureSize</span>  <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1993" data-line-number="1993"></td>
          <td id="LC1993">    <span>Dim</span> <span>baSignature()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1994" data-line-number="1994"></td>
          <td id="LC1994">    <span>Dim</span> <span>baCert()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L1995" data-line-number="1995"></td>
          <td id="LC1995">    <span>Dim</span> <span>lCertSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1996" data-line-number="1996"></td>
          <td id="LC1996">    <span>Dim</span> <span>lCertEnd</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1997" data-line-number="1997"></td>
          <td id="LC1997">    <span>Dim</span> <span>lSignPos</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1998" data-line-number="1998"></td>
          <td id="LC1998">    <span>Dim</span> <span>lSignSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L1999" data-line-number="1999"></td>
          <td id="LC1999">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L2000" data-line-number="2000"></td>
          <td id="LC2000">    <span>Dim</span> <span>baEmpty()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L2001" data-line-number="2001"></td>
          <td id="LC2001">    <span>Dim</span> <span>lBlockSize</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2002" data-line-number="2002"></td>
          <td id="LC2002">    <span>Dim</span> <span>lBlockEnd</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2003" data-line-number="2003"></td>
          <td id="LC2003">    <span>Dim</span> <span>lExtType</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2004" data-line-number="2004"></td>
          <td id="LC2004">    <span>Dim</span> <span>lExtSize</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2005" data-line-number="2005"></td>
          <td id="LC2005">    <span>Dim</span> <span>lExtEnd</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2006" data-line-number="2006"></td>
          <td id="LC2006">    <span>Dim</span> <span>lStringSize</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2007" data-line-number="2007"></td>
          <td id="LC2007">    <span>Dim</span> <span>lExchGroup</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2008" data-line-number="2008"></td>
          <td id="LC2008">    <span>Dim</span> <span>lStatusType</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2009" data-line-number="2009"></td>
          <td id="LC2009">    </td>
        </tr>
        <tr>
          <td id="L2010" data-line-number="2010"></td>
          <td id="LC2010">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L2011" data-line-number="2011"></td>
          <td id="LC2011">    <span>lExtType</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L2012" data-line-number="2012"></td>
          <td id="LC2012">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2013" data-line-number="2013"></td>
          <td id="LC2013">    <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&lt;</span> <span>lInputEnd</span></td>
        </tr>
        <tr>
          <td id="L2014" data-line-number="2014"></td>
          <td id="LC2014">        <span>lMessagePos</span> <span>=</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L2015" data-line-number="2015"></td>
          <td id="LC2015">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2016" data-line-number="2016"></td>
          <td id="LC2016">        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>3</span><span>,</span> <span>BlockSize:=lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2017" data-line-number="2017"></td>
          <td id="LC2017">            <span>lMessageEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2018" data-line-number="2018"></td>
          <td id="LC2018">            <span>If</span> <span>lMessageEnd</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2019" data-line-number="2019"></td>
          <td id="LC2019">                <span>&#39;--- back off and bail out early</span></td>
        </tr>
        <tr>
          <td id="L2020" data-line-number="2020"></td>
          <td id="LC2020">                <span>uInput.Stack.Remove</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L2021" data-line-number="2021"></td>
          <td id="LC2021">                <span>uInput.Pos</span> <span>=</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L2022" data-line-number="2022"></td>
          <td id="LC2022">                <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L2023" data-line-number="2023"></td>
          <td id="LC2023">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2024" data-line-number="2024"></td>
          <td id="LC2024">            <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2025" data-line-number="2025"></td>
          <td id="LC2025"><span>&#39;                DebugLog MODULE_NAME, FUNC_NAME, &#34;.State=&#34; &amp; pvTlsGetStateAsText(.State) &amp; &#34;, lMessageType=&#34; &amp; pvTlsGetMessageName(lMessageType)</span></td>
        </tr>
        <tr>
          <td id="L2026" data-line-number="2026"></td>
          <td id="LC2026">            <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2027" data-line-number="2027"></td>
          <td id="LC2027">            <span>Select</span> <span>Case</span> <span>.State</span></td>
        </tr>
        <tr>
          <td id="L2028" data-line-number="2028"></td>
          <td id="LC2028">            <span>Case</span> <span>ucsTlsStateExpectServerHello</span></td>
        </tr>
        <tr>
          <td id="L2029" data-line-number="2029"></td>
          <td id="LC2029">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2030" data-line-number="2030"></td>
          <td id="LC2030">                <span>Case</span> <span>TLS_HANDSHAKE_SERVER_HELLO</span></td>
        </tr>
        <tr>
          <td id="L2031" data-line-number="2031"></td>
          <td id="LC2031">                    <span>If</span> <span>Not</span> <span>pvTlsParseHandshakeServerHello(uCtx,</span> <span>uInput,</span> <span>uInput.Pos</span> <span>+</span> <span>lMessageSize,</span> <span>lRecordProtocol,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2032" data-line-number="2032"></td>
          <td id="LC2032">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2033" data-line-number="2033"></td>
          <td id="LC2033">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2034" data-line-number="2034"></td>
          <td id="LC2034">                    <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2035" data-line-number="2035"></td>
          <td id="LC2035">                        <span>&#39;--- on HelloRetryRequest replace HandshakeMessages w/ &#39;synthetic handshake message&#39;</span></td>
        </tr>
        <tr>
          <td id="L2036" data-line-number="2036"></td>
          <td id="LC2036">                        <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2037" data-line-number="2037"></td>
          <td id="LC2037">                        <span>.HandshakeMessages.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2038" data-line-number="2038"></td>
          <td id="LC2038">                        <span>pvBufferWriteLong</span> <span>.HandshakeMessages,</span> <span>TLS_HANDSHAKE_MESSAGE_HASH</span></td>
        </tr>
        <tr>
          <td id="L2039" data-line-number="2039"></td>
          <td id="LC2039">                        <span>pvBufferWriteLong</span> <span>.HandshakeMessages,</span> <span>.DigestSize,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L2040" data-line-number="2040"></td>
          <td id="LC2040">                        <span>pvBufferWriteArray</span> <span>.HandshakeMessages,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2041" data-line-number="2041"></td>
          <td id="LC2041">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2042" data-line-number="2042"></td>
          <td id="LC2042">                        <span>.State</span> <span>=</span> <span>ucsTlsStateExpectEncryptedExtensions</span></td>
        </tr>
        <tr>
          <td id="L2043" data-line-number="2043"></td>
          <td id="LC2043">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2044" data-line-number="2044"></td>
          <td id="LC2044">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2045" data-line-number="2045"></td>
          <td id="LC2045">                    <span>GoTo</span> <span>UnexpectedMessageType</span></td>
        </tr>
        <tr>
          <td id="L2046" data-line-number="2046"></td>
          <td id="LC2046">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2047" data-line-number="2047"></td>
          <td id="LC2047">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uInput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span> <span>+</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L2048" data-line-number="2048"></td>
          <td id="LC2048">                <span>&#39;--- post-process ucsTlsStateExpectServerHello</span></td>
        </tr>
        <tr>
          <td id="L2049" data-line-number="2049"></td>
          <td id="LC2049">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectServerHello</span> <span>And</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2050" data-line-number="2050"></td>
          <td id="LC2050">                    <span>pvTlsBuildClientHello</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2051" data-line-number="2051"></td>
          <td id="LC2051">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2052" data-line-number="2052"></td>
          <td id="LC2052">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectEncryptedExtensions</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2053" data-line-number="2053"></td>
          <td id="LC2053">                    <span>pvTlsDeriveHandshakeSecrets</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2054" data-line-number="2054"></td>
          <td id="LC2054">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2055" data-line-number="2055"></td>
          <td id="LC2055">            <span>Case</span> <span>ucsTlsStateExpectEncryptedExtensions</span></td>
        </tr>
        <tr>
          <td id="L2056" data-line-number="2056"></td>
          <td id="LC2056">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2057" data-line-number="2057"></td>
          <td id="LC2057">                <span>Case</span> <span>TLS_HANDSHAKE_ENCRYPTED_EXTENSIONS</span></td>
        </tr>
        <tr>
          <td id="L2058" data-line-number="2058"></td>
          <td id="LC2058">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2059" data-line-number="2059"></td>
          <td id="LC2059">                    <span>lBlockEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2060" data-line-number="2060"></td>
          <td id="LC2060">                    <span>If</span> <span>lBlockEnd</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2061" data-line-number="2061"></td>
          <td id="LC2061">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2062" data-line-number="2062"></td>
          <td id="LC2062">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2063" data-line-number="2063"></td>
          <td id="LC2063">                    <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&lt;</span> <span>lBlockEnd</span></td>
        </tr>
        <tr>
          <td id="L2064" data-line-number="2064"></td>
          <td id="LC2064">                        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExtType,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2065" data-line-number="2065"></td>
          <td id="LC2065">                        <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2066" data-line-number="2066"></td>
          <td id="LC2066"><span>&#39;                            DebugLog MODULE_NAME, FUNC_NAME, &#34;EncryptedExtensions &#34; &amp; pvTlsGetExtensionName(lExtType)</span></td>
        </tr>
        <tr>
          <td id="L2067" data-line-number="2067"></td>
          <td id="LC2067">                        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2068" data-line-number="2068"></td>
          <td id="LC2068">                        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2069" data-line-number="2069"></td>
          <td id="LC2069">                            <span>lExtEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2070" data-line-number="2070"></td>
          <td id="LC2070">                            <span>If</span> <span>lExtEnd</span> <span>&gt;</span> <span>lBlockEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2071" data-line-number="2071"></td>
          <td id="LC2071">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2072" data-line-number="2072"></td>
          <td id="LC2072">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2073" data-line-number="2073"></td>
          <td id="LC2073">                            <span>Select</span> <span>Case</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L2074" data-line-number="2074"></td>
          <td id="LC2074">                            <span>Case</span> <span>TLS_EXTENSION_ALPN</span></td>
        </tr>
        <tr>
          <td id="L2075" data-line-number="2075"></td>
          <td id="LC2075">                                <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2076" data-line-number="2076"></td>
          <td id="LC2076">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2077" data-line-number="2077"></td>
          <td id="LC2077">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2078" data-line-number="2078"></td>
          <td id="LC2078">                                <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lStringSize</span></td>
        </tr>
        <tr>
          <td id="L2079" data-line-number="2079"></td>
          <td id="LC2079">                                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lStringSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lStringSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2080" data-line-number="2080"></td>
          <td id="LC2080">                                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2081" data-line-number="2081"></td>
          <td id="LC2081">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2082" data-line-number="2082"></td>
          <td id="LC2082">                                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lStringSize</span></td>
        </tr>
        <tr>
          <td id="L2083" data-line-number="2083"></td>
          <td id="LC2083">                                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lStringSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lStringSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2084" data-line-number="2084"></td>
          <td id="LC2084">                                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2085" data-line-number="2085"></td>
          <td id="LC2085">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2086" data-line-number="2086"></td>
          <td id="LC2086">                                        <span>pvBufferReadString</span> <span>uInput,</span> <span>.AlpnNegotiated,</span> <span>lStringSize</span></td>
        </tr>
        <tr>
          <td id="L2087" data-line-number="2087"></td>
          <td id="LC2087">                                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2088" data-line-number="2088"></td>
          <td id="LC2088">                                <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2089" data-line-number="2089"></td>
          <td id="LC2089">                            <span>Case</span> <span>TLS_EXTENSION_SUPPORTED_GROUPS</span></td>
        </tr>
        <tr>
          <td id="L2090" data-line-number="2090"></td>
          <td id="LC2090">                                <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2091" data-line-number="2091"></td>
          <td id="LC2091">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2092" data-line-number="2092"></td>
          <td id="LC2092">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2093" data-line-number="2093"></td>
          <td id="LC2093">                                <span>Set</span> <span>.RemoteSupportedGroups</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2094" data-line-number="2094"></td>
          <td id="LC2094">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L2095" data-line-number="2095"></td>
          <td id="LC2095">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2096" data-line-number="2096"></td>
          <td id="LC2096">                                    <span>.RemoteSupportedGroups.Add</span> <span>lExchGroup,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L2097" data-line-number="2097"></td>
          <td id="LC2097">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2098" data-line-number="2098"></td>
          <td id="LC2098">                            <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2099" data-line-number="2099"></td>
          <td id="LC2099">                                <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2100" data-line-number="2100"></td>
          <td id="LC2100">                            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2101" data-line-number="2101"></td>
          <td id="LC2101">                        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2102" data-line-number="2102"></td>
          <td id="LC2102">                    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2103" data-line-number="2103"></td>
          <td id="LC2103">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2104" data-line-number="2104"></td>
          <td id="LC2104">                <span>Case</span> <span>TLS_HANDSHAKE_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L2105" data-line-number="2105"></td>
          <td id="LC2105">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2106" data-line-number="2106"></td>
          <td id="LC2106">                        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2107" data-line-number="2107"></td>
          <td id="LC2107">                            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lCertSize</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2108" data-line-number="2108"></td>
          <td id="LC2108">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2109" data-line-number="2109"></td>
          <td id="LC2109">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2110" data-line-number="2110"></td>
          <td id="LC2110">                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lCertSize</span> <span>&#39;--- skip RemoteCertReqContext</span></td>
        </tr>
        <tr>
          <td id="L2111" data-line-number="2111"></td>
          <td id="LC2111">                        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2112" data-line-number="2112"></td>
          <td id="LC2112">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2113" data-line-number="2113"></td>
          <td id="LC2113">                    <span>Set</span> <span>.RemoteCertificates</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2114" data-line-number="2114"></td>
          <td id="LC2114">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2115" data-line-number="2115"></td>
          <td id="LC2115">                        <span>Set</span> <span>.RemoteCertStatuses</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2116" data-line-number="2116"></td>
          <td id="LC2116">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2117" data-line-number="2117"></td>
          <td id="LC2117">                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2118" data-line-number="2118"></td>
          <td id="LC2118">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2119" data-line-number="2119"></td>
          <td id="LC2119">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2120" data-line-number="2120"></td>
          <td id="LC2120">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>3</span><span>,</span> <span>BlockSize:=lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2121" data-line-number="2121"></td>
          <td id="LC2121">                        <span>lCertEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2122" data-line-number="2122"></td>
          <td id="LC2122">                        <span>If</span> <span>lCertEnd</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2123" data-line-number="2123"></td>
          <td id="LC2123">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2124" data-line-number="2124"></td>
          <td id="LC2124">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2125" data-line-number="2125"></td>
          <td id="LC2125">                        <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&lt;</span> <span>lCertEnd</span></td>
        </tr>
        <tr>
          <td id="L2126" data-line-number="2126"></td>
          <td id="LC2126">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>3</span><span>,</span> <span>BlockSize:=lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2127" data-line-number="2127"></td>
          <td id="LC2127">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lCertSize</span> <span>&gt;</span> <span>lCertEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2128" data-line-number="2128"></td>
          <td id="LC2128">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2129" data-line-number="2129"></td>
          <td id="LC2129">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2130" data-line-number="2130"></td>
          <td id="LC2130">                                <span>pvBufferReadArray</span> <span>uInput,</span> <span>baCert,</span> <span>lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2131" data-line-number="2131"></td>
          <td id="LC2131">                                <span>.RemoteCertificates.Add</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L2132" data-line-number="2132"></td>
          <td id="LC2132">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2133" data-line-number="2133"></td>
          <td id="LC2133">                            <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2134" data-line-number="2134"></td>
          <td id="LC2134">                                <span>baCert</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L2135" data-line-number="2135"></td>
          <td id="LC2135">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>lCertEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2136" data-line-number="2136"></td>
          <td id="LC2136">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2137" data-line-number="2137"></td>
          <td id="LC2137">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2138" data-line-number="2138"></td>
          <td id="LC2138">                                <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2139" data-line-number="2139"></td>
          <td id="LC2139">                                <span>lBlockEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2140" data-line-number="2140"></td>
          <td id="LC2140">                                <span>If</span> <span>lBlockEnd</span> <span>&gt;</span> <span>lCertEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2141" data-line-number="2141"></td>
          <td id="LC2141">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2142" data-line-number="2142"></td>
          <td id="LC2142">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2143" data-line-number="2143"></td>
          <td id="LC2143">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lBlockEnd</span></td>
        </tr>
        <tr>
          <td id="L2144" data-line-number="2144"></td>
          <td id="LC2144">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExtType,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2145" data-line-number="2145"></td>
          <td id="LC2145">                                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2146" data-line-number="2146"></td>
          <td id="LC2146"><span>&#39;                                        DebugLog MODULE_NAME, FUNC_NAME, &#34;CertificateExtensions &#34; &amp; pvTlsGetExtensionName(lExtType)</span></td>
        </tr>
        <tr>
          <td id="L2147" data-line-number="2147"></td>
          <td id="LC2147">                                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2148" data-line-number="2148"></td>
          <td id="LC2148">                                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2149" data-line-number="2149"></td>
          <td id="LC2149">                                        <span>lExtEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2150" data-line-number="2150"></td>
          <td id="LC2150">                                        <span>If</span> <span>lExtEnd</span> <span>&gt;</span> <span>lBlockEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2151" data-line-number="2151"></td>
          <td id="LC2151">                                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2152" data-line-number="2152"></td>
          <td id="LC2152">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2153" data-line-number="2153"></td>
          <td id="LC2153">                                        <span>Select</span> <span>Case</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L2154" data-line-number="2154"></td>
          <td id="LC2154">                                        <span>Case</span> <span>TLS_EXTENSION_STATUS_REQUEST</span></td>
        </tr>
        <tr>
          <td id="L2155" data-line-number="2155"></td>
          <td id="LC2155">                                            <span>pvBufferReadArray</span> <span>uInput,</span> <span>baCert,</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2156" data-line-number="2156"></td>
          <td id="LC2156">                                        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2157" data-line-number="2157"></td>
          <td id="LC2157">                                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2158" data-line-number="2158"></td>
          <td id="LC2158">                                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2159" data-line-number="2159"></td>
          <td id="LC2159">                                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2160" data-line-number="2160"></td>
          <td id="LC2160">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2161" data-line-number="2161"></td>
          <td id="LC2161">                                <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2162" data-line-number="2162"></td>
          <td id="LC2162">                                <span>.RemoteCertStatuses.Add</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L2163" data-line-number="2163"></td>
          <td id="LC2163">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2164" data-line-number="2164"></td>
          <td id="LC2164">                        <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2165" data-line-number="2165"></td>
          <td id="LC2165">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2166" data-line-number="2166"></td>
          <td id="LC2166">                <span>Case</span> <span>TLS_HANDSHAKE_CERTIFICATE_VERIFY</span></td>
        </tr>
        <tr>
          <td id="L2167" data-line-number="2167"></td>
          <td id="LC2167">                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2168" data-line-number="2168"></td>
          <td id="LC2168">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2169" data-line-number="2169"></td>
          <td id="LC2169">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2170" data-line-number="2170"></td>
          <td id="LC2170">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lSignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2171" data-line-number="2171"></td>
          <td id="LC2171">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSignatureSize</span></td>
        </tr>
        <tr>
          <td id="L2172" data-line-number="2172"></td>
          <td id="LC2172">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSignatureSize</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2173" data-line-number="2173"></td>
          <td id="LC2173">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2174" data-line-number="2174"></td>
          <td id="LC2174">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2175" data-line-number="2175"></td>
          <td id="LC2175">                        <span>pvBufferReadArray</span> <span>uInput,</span> <span>baSignature,</span> <span>lSignatureSize</span></td>
        </tr>
        <tr>
          <td id="L2176" data-line-number="2176"></td>
          <td id="LC2176">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2177" data-line-number="2177"></td>
          <td id="LC2177">                    <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteCertificates,</span> <span>1</span><span>,</span> <span>RetVal:=baCert)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2178" data-line-number="2178"></td>
          <td id="LC2178">                        <span>GoTo</span> <span>NoServerCertificate</span></td>
        </tr>
        <tr>
          <td id="L2179" data-line-number="2179"></td>
          <td id="LC2179">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2180" data-line-number="2180"></td>
          <td id="LC2180">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2181" data-line-number="2181"></td>
          <td id="LC2181">                    <span>pvBufferWriteString</span> <span>uVerify,</span> <span>Space$(</span><span>64</span><span>)</span> <span>&amp;</span> <span>&#34;TLS 1.3, server CertificateVerify&#34;</span> <span>&amp;</span> <span>Chr$(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2182" data-line-number="2182"></td>
          <td id="LC2182">                    <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2183" data-line-number="2183"></td>
          <td id="LC2183">                    <span>pvBufferWriteEOF</span> <span>uVerify</span></td>
        </tr>
        <tr>
          <td id="L2184" data-line-number="2184"></td>
          <td id="LC2184">                    <span>If</span> <span>Not</span> <span>pvTlsSignatureVerify(baCert,</span> <span>lSignatureScheme,</span> <span>uVerify.Data,</span> <span>baSignature,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2185" data-line-number="2185"></td>
          <td id="LC2185">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2186" data-line-number="2186"></td>
          <td id="LC2186">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2187" data-line-number="2187"></td>
          <td id="LC2187">                <span>Case</span> <span>TLS_HANDSHAKE_FINISHED</span></td>
        </tr>
        <tr>
          <td id="L2188" data-line-number="2188"></td>
          <td id="LC2188">                    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baMessage,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2189" data-line-number="2189"></td>
          <td id="LC2189">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2190" data-line-number="2190"></td>
          <td id="LC2190">                    <span>pvTlsHkdfExpandLabel</span> <span>baTemp,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;finished&#34;</span><span>,</span> <span>baEmpty,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L2191" data-line-number="2191"></td>
          <td id="LC2191">                    <span>pvTlsHkdfExtract</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>baTemp,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2192" data-line-number="2192"></td>
          <td id="LC2192">                    <span>If</span> <span>Not</span> <span>pvArrayEqual(uVerify.Data,</span> <span>baMessage)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2193" data-line-number="2193"></td>
          <td id="LC2193">                        <span>GoTo</span> <span>ServerHandshakeFailed</span></td>
        </tr>
        <tr>
          <td id="L2194" data-line-number="2194"></td>
          <td id="LC2194">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2195" data-line-number="2195"></td>
          <td id="LC2195">                    <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span></td>
        </tr>
        <tr>
          <td id="L2196" data-line-number="2196"></td>
          <td id="LC2196">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_HANDSHAKE_SERVER_KEY_EXCHANGE,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2197" data-line-number="2197"></td>
          <td id="LC2197">                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>4</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2198" data-line-number="2198"></td>
          <td id="LC2198">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2199" data-line-number="2199"></td>
          <td id="LC2199">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2200" data-line-number="2200"></td>
          <td id="LC2200">                    <span>lSignPos</span> <span>=</span> <span>uInput.Pos</span></td>
        </tr>
        <tr>
          <td id="L2201" data-line-number="2201"></td>
          <td id="LC2201">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lCurveType</span></td>
        </tr>
        <tr>
          <td id="L2202" data-line-number="2202"></td>
          <td id="LC2202">                    <span>If</span> <span>lCurveType</span> <span>&lt;&gt;</span> <span>3</span> <span>Then</span> <span>&#39;--- 3 = named_curve</span></td>
        </tr>
        <tr>
          <td id="L2203" data-line-number="2203"></td>
          <td id="LC2203">                        <span>GoTo</span> <span>UnsupportedCurveType</span></td>
        </tr>
        <tr>
          <td id="L2204" data-line-number="2204"></td>
          <td id="LC2204">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2205" data-line-number="2205"></td>
          <td id="LC2205">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lNamedCurve,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2206" data-line-number="2206"></td>
          <td id="LC2206">                    <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>lNamedCurve</span></td>
        </tr>
        <tr>
          <td id="L2207" data-line-number="2207"></td>
          <td id="LC2207">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2208" data-line-number="2208"></td>
          <td id="LC2208">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;With exchange group &#34;</span> <span>&amp;</span> <span>pvTlsGetExchGroupName(.ExchGroup)</span></td>
        </tr>
        <tr>
          <td id="L2209" data-line-number="2209"></td>
          <td id="LC2209">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2210" data-line-number="2210"></td>
          <td id="LC2210">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lSignatureSize</span></td>
        </tr>
        <tr>
          <td id="L2211" data-line-number="2211"></td>
          <td id="LC2211">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSignatureSize</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2212" data-line-number="2212"></td>
          <td id="LC2212">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2213" data-line-number="2213"></td>
          <td id="LC2213">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2214" data-line-number="2214"></td>
          <td id="LC2214">                        <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteExchPublic,</span> <span>lSignatureSize</span></td>
        </tr>
        <tr>
          <td id="L2215" data-line-number="2215"></td>
          <td id="LC2215">                        <span>If</span> <span>Not</span> <span>pvTlsCheckRemoteKey(.ExchGroup,</span> <span>.RemoteExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2216" data-line-number="2216"></td>
          <td id="LC2216">                            <span>GoTo</span> <span>InvalidRemoteKey</span></td>
        </tr>
        <tr>
          <td id="L2217" data-line-number="2217"></td>
          <td id="LC2217">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2218" data-line-number="2218"></td>
          <td id="LC2218">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2219" data-line-number="2219"></td>
          <td id="LC2219">                    <span>lSignSize</span> <span>=</span> <span>uInput.Pos</span> <span>-</span> <span>lSignPos</span></td>
        </tr>
        <tr>
          <td id="L2220" data-line-number="2220"></td>
          <td id="LC2220">                    <span>&#39;--- signature</span></td>
        </tr>
        <tr>
          <td id="L2221" data-line-number="2221"></td>
          <td id="LC2221">                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>4</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2222" data-line-number="2222"></td>
          <td id="LC2222">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2223" data-line-number="2223"></td>
          <td id="LC2223">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2224" data-line-number="2224"></td>
          <td id="LC2224">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lSignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2225" data-line-number="2225"></td>
          <td id="LC2225">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSignatureSize</span></td>
        </tr>
        <tr>
          <td id="L2226" data-line-number="2226"></td>
          <td id="LC2226">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSignatureSize</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2227" data-line-number="2227"></td>
          <td id="LC2227">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2228" data-line-number="2228"></td>
          <td id="LC2228">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2229" data-line-number="2229"></td>
          <td id="LC2229">                        <span>pvBufferReadArray</span> <span>uInput,</span> <span>baSignature,</span> <span>lSignatureSize</span></td>
        </tr>
        <tr>
          <td id="L2230" data-line-number="2230"></td>
          <td id="LC2230">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2231" data-line-number="2231"></td>
          <td id="LC2231">                    <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteCertificates,</span> <span>1</span><span>,</span> <span>RetVal:=baCert)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2232" data-line-number="2232"></td>
          <td id="LC2232">                        <span>GoTo</span> <span>NoServerCertificate</span></td>
        </tr>
        <tr>
          <td id="L2233" data-line-number="2233"></td>
          <td id="LC2233">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2234" data-line-number="2234"></td>
          <td id="LC2234">                    <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L2235" data-line-number="2235"></td>
          <td id="LC2235">                    <span>pvBufferWriteArray</span> <span>uVerify,</span> <span>.RemoteExchRandom</span></td>
        </tr>
        <tr>
          <td id="L2236" data-line-number="2236"></td>
          <td id="LC2236">                    <span>pvBufferWriteBlob</span> <span>uVerify,</span> <span>VarPtr(uInput.Data(lSignPos)),</span> <span>lSignSize</span></td>
        </tr>
        <tr>
          <td id="L2237" data-line-number="2237"></td>
          <td id="LC2237">                    <span>pvBufferWriteEOF</span> <span>uVerify</span></td>
        </tr>
        <tr>
          <td id="L2238" data-line-number="2238"></td>
          <td id="LC2238">                    <span>If</span> <span>Not</span> <span>pvTlsSignatureVerify(baCert,</span> <span>lSignatureScheme,</span> <span>uVerify.Data,</span> <span>baSignature,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2239" data-line-number="2239"></td>
          <td id="LC2239">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2240" data-line-number="2240"></td>
          <td id="LC2240">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2241" data-line-number="2241"></td>
          <td id="LC2241">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_HANDSHAKE_SERVER_HELLO_DONE,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2242" data-line-number="2242"></td>
          <td id="LC2242">                    <span>.State</span> <span>=</span> <span>ucsTlsStateExpectServerFinished</span></td>
        </tr>
        <tr>
          <td id="L2243" data-line-number="2243"></td>
          <td id="LC2243">                    <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2244" data-line-number="2244"></td>
          <td id="LC2244">                    <span>Set</span> <span>.RemoteTickets</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2245" data-line-number="2245"></td>
          <td id="LC2245">                <span>Case</span> <span>TLS_HANDSHAKE_CERTIFICATE_REQUEST</span></td>
        </tr>
        <tr>
          <td id="L2246" data-line-number="2246"></td>
          <td id="LC2246">                    <span>If</span> <span>Not</span> <span>pvTlsParseHandshakeCertificateRequest(uCtx,</span> <span>uInput,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2247" data-line-number="2247"></td>
          <td id="LC2247">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2248" data-line-number="2248"></td>
          <td id="LC2248">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2249" data-line-number="2249"></td>
          <td id="LC2249">                <span>Case</span> <span>TLS_HANDSHAKE_CERTIFICATE_STATUS</span></td>
        </tr>
        <tr>
          <td id="L2250" data-line-number="2250"></td>
          <td id="LC2250">                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2251" data-line-number="2251"></td>
          <td id="LC2251">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2252" data-line-number="2252"></td>
          <td id="LC2252">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2253" data-line-number="2253"></td>
          <td id="LC2253">                    <span>Set</span> <span>.RemoteCertStatuses</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2254" data-line-number="2254"></td>
          <td id="LC2254">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lStatusType,</span> <span>Size:=</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L2255" data-line-number="2255"></td>
          <td id="LC2255">                    <span>If</span> <span>lStatusType</span> <span>=</span> <span>1</span> <span>Then</span> <span>&#39;--- ocsp</span></td>
        </tr>
        <tr>
          <td id="L2256" data-line-number="2256"></td>
          <td id="LC2256">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2257" data-line-number="2257"></td>
          <td id="LC2257">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2258" data-line-number="2258"></td>
          <td id="LC2258">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2259" data-line-number="2259"></td>
          <td id="LC2259">                        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>3</span><span>,</span> <span>BlockSize:=lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2260" data-line-number="2260"></td>
          <td id="LC2260">                            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lCertSize</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2261" data-line-number="2261"></td>
          <td id="LC2261">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2262" data-line-number="2262"></td>
          <td id="LC2262">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2263" data-line-number="2263"></td>
          <td id="LC2263">                            <span>pvBufferReadArray</span> <span>uInput,</span> <span>baCert,</span> <span>lCertSize</span></td>
        </tr>
        <tr>
          <td id="L2264" data-line-number="2264"></td>
          <td id="LC2264">                            <span>.RemoteCertStatuses.Add</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L2265" data-line-number="2265"></td>
          <td id="LC2265">                        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2266" data-line-number="2266"></td>
          <td id="LC2266">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2267" data-line-number="2267"></td>
          <td id="LC2267">                        <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2268" data-line-number="2268"></td>
          <td id="LC2268">                            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>Replace(</span><span>&#34;Unknown status_type (%1) in certificate_status&#34;</span><span>,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lStatusType)</span></td>
        </tr>
        <tr>
          <td id="L2269" data-line-number="2269"></td>
          <td id="LC2269">                        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2270" data-line-number="2270"></td>
          <td id="LC2270">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2271" data-line-number="2271"></td>
          <td id="LC2271">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2272" data-line-number="2272"></td>
          <td id="LC2272">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2273" data-line-number="2273"></td>
          <td id="LC2273">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>Replace(</span><span>&#34;Unknown handshake message (%1) during ExpectEncryptedExtensions&#34;</span><span>,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetMessageName(lMessageType))</span></td>
        </tr>
        <tr>
          <td id="L2274" data-line-number="2274"></td>
          <td id="LC2274">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2275" data-line-number="2275"></td>
          <td id="LC2275">                    <span>&#39;--- do nothing</span></td>
        </tr>
        <tr>
          <td id="L2276" data-line-number="2276"></td>
          <td id="LC2276">                    <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2277" data-line-number="2277"></td>
          <td id="LC2277">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2278" data-line-number="2278"></td>
          <td id="LC2278">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uInput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span> <span>+</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L2279" data-line-number="2279"></td>
          <td id="LC2279">                <span>&#39;--- post-process ucsTlsStateExpectEncryptedExtensions</span></td>
        </tr>
        <tr>
          <td id="L2280" data-line-number="2280"></td>
          <td id="LC2280">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectServerFinished</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2281" data-line-number="2281"></td>
          <td id="LC2281">                    <span>If</span> <span>.UseRsaKeyTransport</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2282" data-line-number="2282"></td>
          <td id="LC2282">                        <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteCertificates,</span> <span>1</span><span>,</span> <span>RetVal:=baCert)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2283" data-line-number="2283"></td>
          <td id="LC2283">                            <span>GoTo</span> <span>NoServerCertificate</span></td>
        </tr>
        <tr>
          <td id="L2284" data-line-number="2284"></td>
          <td id="LC2284">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2285" data-line-number="2285"></td>
          <td id="LC2285">                        <span>pvTlsSetupExchRsaCertificate</span> <span>uCtx,</span> <span>baCert</span></td>
        </tr>
        <tr>
          <td id="L2286" data-line-number="2286"></td>
          <td id="LC2286">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2287" data-line-number="2287"></td>
          <td id="LC2287">                    <span>&#39;--- secure renegotiation check</span></td>
        </tr>
        <tr>
          <td id="L2288" data-line-number="2288"></td>
          <td id="LC2288">                    <span>If</span> <span>pvArraySize(.LocalLegacyVerifyData)</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2289" data-line-number="2289"></td>
          <td id="LC2289">                        <span>If</span> <span>pvArraySize(.RemoteLegacyRenegInfo)</span> <span>&lt;&gt;</span> <span>2</span> <span>*</span> <span>TLS_VERIFY_DATA_SIZE</span> <span>Or</span> <span>pvArraySize(.RemoteLegacyVerifyData)</span> <span>&lt;&gt;</span> <span>TLS_VERIFY_DATA_SIZE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2290" data-line-number="2290"></td>
          <td id="LC2290">                            <span>GoTo</span> <span>SecureRenegotiationFailed</span></td>
        </tr>
        <tr>
          <td id="L2291" data-line-number="2291"></td>
          <td id="LC2291">                        <span>ElseIf</span> <span>InStrB(.RemoteLegacyRenegInfo,</span> <span>.LocalLegacyVerifyData)</span> <span>&lt;&gt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2292" data-line-number="2292"></td>
          <td id="LC2292">                            <span>GoTo</span> <span>SecureRenegotiationFailed</span></td>
        </tr>
        <tr>
          <td id="L2293" data-line-number="2293"></td>
          <td id="LC2293">                        <span>ElseIf</span> <span>InStrB(TLS_VERIFY_DATA_SIZE</span> <span>+</span> <span>1</span><span>,</span> <span>.RemoteLegacyRenegInfo,</span> <span>.RemoteLegacyVerifyData)</span> <span>&lt;&gt;</span> <span>TLS_VERIFY_DATA_SIZE</span> <span>+</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2294" data-line-number="2294"></td>
          <td id="LC2294">                            <span>GoTo</span> <span>SecureRenegotiationFailed</span></td>
        </tr>
        <tr>
          <td id="L2295" data-line-number="2295"></td>
          <td id="LC2295">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2296" data-line-number="2296"></td>
          <td id="LC2296">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2297" data-line-number="2297"></td>
          <td id="LC2297">                    <span>pvTlsBuildClientLegacyKeyExchange</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2298" data-line-number="2298"></td>
          <td id="LC2298">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2299" data-line-number="2299"></td>
          <td id="LC2299">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2300" data-line-number="2300"></td>
          <td id="LC2300">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2301" data-line-number="2301"></td>
          <td id="LC2301">                    <span>pvTlsBuildClientHandshakeFinished</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2302" data-line-number="2302"></td>
          <td id="LC2302">                    <span>pvTlsDeriveApplicationSecrets</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2303" data-line-number="2303"></td>
          <td id="LC2303">                    <span>pvTlsResetHandshakeHash</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2304" data-line-number="2304"></td>
          <td id="LC2304">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2305" data-line-number="2305"></td>
          <td id="LC2305">            <span>Case</span> <span>ucsTlsStateExpectServerFinished</span></td>
        </tr>
        <tr>
          <td id="L2306" data-line-number="2306"></td>
          <td id="LC2306">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2307" data-line-number="2307"></td>
          <td id="LC2307">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_HANDSHAKE_NEW_SESSION_TICKET,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2308" data-line-number="2308"></td>
          <td id="LC2308">                    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baMessage,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2309" data-line-number="2309"></td>
          <td id="LC2309">                    <span>If</span> <span>Not</span> <span>.RemoteTickets</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2310" data-line-number="2310"></td>
          <td id="LC2310">                        <span>.RemoteTickets.Add</span> <span>baMessage</span></td>
        </tr>
        <tr>
          <td id="L2311" data-line-number="2311"></td>
          <td id="LC2311">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2312" data-line-number="2312"></td>
          <td id="LC2312">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_HANDSHAKE_FINISHED,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2313" data-line-number="2313"></td>
          <td id="LC2313">                    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baMessage,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2314" data-line-number="2314"></td>
          <td id="LC2314">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2315" data-line-number="2315"></td>
          <td id="LC2315">                    <span>pvTlsKdfLegacyPrf</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>&#34;server finished&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>TLS_VERIFY_DATA_SIZE</span></td>
        </tr>
        <tr>
          <td id="L2316" data-line-number="2316"></td>
          <td id="LC2316">                    <span>If</span> <span>Not</span> <span>pvArrayEqual(uVerify.Data,</span> <span>baMessage)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2317" data-line-number="2317"></td>
          <td id="LC2317">                        <span>GoTo</span> <span>ServerHandshakeFailed</span></td>
        </tr>
        <tr>
          <td id="L2318" data-line-number="2318"></td>
          <td id="LC2318">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2319" data-line-number="2319"></td>
          <td id="LC2319">                    <span>&#39;--- save for secure renegotiation check</span></td>
        </tr>
        <tr>
          <td id="L2320" data-line-number="2320"></td>
          <td id="LC2320">                    <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2321" data-line-number="2321"></td>
          <td id="LC2321">                        <span>.RemoteLegacyVerifyData</span> <span>=</span> <span>baMessage</span></td>
        </tr>
        <tr>
          <td id="L2322" data-line-number="2322"></td>
          <td id="LC2322">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2323" data-line-number="2323"></td>
          <td id="LC2323">                    <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span></td>
        </tr>
        <tr>
          <td id="L2324" data-line-number="2324"></td>
          <td id="LC2324">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2325" data-line-number="2325"></td>
          <td id="LC2325">                    <span>GoTo</span> <span>UnexpectedMessageType</span></td>
        </tr>
        <tr>
          <td id="L2326" data-line-number="2326"></td>
          <td id="LC2326">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2327" data-line-number="2327"></td>
          <td id="LC2327">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2328" data-line-number="2328"></td>
          <td id="LC2328">                    <span>pvTlsResetHandshakeHash</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2329" data-line-number="2329"></td>
          <td id="LC2329">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2330" data-line-number="2330"></td>
          <td id="LC2330">                    <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uInput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span> <span>+</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L2331" data-line-number="2331"></td>
          <td id="LC2331">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2332" data-line-number="2332"></td>
          <td id="LC2332"><span>#</span><span>If</span> <span>ImplTlsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2333" data-line-number="2333"></td>
          <td id="LC2333">            <span>Case</span> <span>ucsTlsStateExpectClientHello</span></td>
        </tr>
        <tr>
          <td id="L2334" data-line-number="2334"></td>
          <td id="LC2334"><span>RenegotiateClientHello:</span></td>
        </tr>
        <tr>
          <td id="L2335" data-line-number="2335"></td>
          <td id="LC2335">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2336" data-line-number="2336"></td>
          <td id="LC2336">                <span>Case</span> <span>TLS_HANDSHAKE_CLIENT_HELLO</span></td>
        </tr>
        <tr>
          <td id="L2337" data-line-number="2337"></td>
          <td id="LC2337">                    <span>If</span> <span>Not</span> <span>pvTlsParseHandshakeClientHello(uCtx,</span> <span>uInput,</span> <span>lMessageEnd,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2338" data-line-number="2338"></td>
          <td id="LC2338">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2339" data-line-number="2339"></td>
          <td id="LC2339">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2340" data-line-number="2340"></td>
          <td id="LC2340">                    <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2341" data-line-number="2341"></td>
          <td id="LC2341">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2342" data-line-number="2342"></td>
          <td id="LC2342">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2343" data-line-number="2343"></td>
          <td id="LC2343">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2344" data-line-number="2344"></td>
          <td id="LC2344">                        <span>If</span> <span>(.ExchGroup</span> <span>=</span> <span>0</span> <span>Or</span> <span>.CipherSuite</span> <span>=</span> <span>0</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2345" data-line-number="2345"></td>
          <td id="LC2345">                            <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2346" data-line-number="2346"></td>
          <td id="LC2346">                                <span>GoTo</span> <span>HelloRetryFailed</span></td>
        </tr>
        <tr>
          <td id="L2347" data-line-number="2347"></td>
          <td id="LC2347">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2348" data-line-number="2348"></td>
          <td id="LC2348">                            <span>.HelloRetryRequest</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L2349" data-line-number="2349"></td>
          <td id="LC2349">                            <span>If</span> <span>.ExchGroup</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2350" data-line-number="2350"></td>
          <td id="LC2350">                                <span>.HelloRetryExchGroup</span> <span>=</span> <span>.ExchGroup</span></td>
        </tr>
        <tr>
          <td id="L2351" data-line-number="2351"></td>
          <td id="LC2351">                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2352" data-line-number="2352"></td>
          <td id="LC2352">                                <span>.HelloRetryExchGroup</span> <span>=</span> <span>pvCollectionFirst(.RemoteSupportedGroups,</span> <span>Array(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L2353" data-line-number="2353"></td>
          <td id="LC2353">                                        <span>IIf(pvCryptoIsSupported(ucsTlsAlgoExchX25519),</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_GROUP_X25519,</span> <span>vbNullString),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L2354" data-line-number="2354"></td>
          <td id="LC2354">                                        <span>IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1),</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_GROUP_SECP256R1,</span> <span>vbNullString),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L2355" data-line-number="2355"></td>
          <td id="LC2355">                                        <span>IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1),</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_GROUP_SECP384R1,</span> <span>vbNullString)))</span></td>
        </tr>
        <tr>
          <td id="L2356" data-line-number="2356"></td>
          <td id="LC2356">                                <span>If</span> <span>.HelloRetryExchGroup</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2357" data-line-number="2357"></td>
          <td id="LC2357">                                    <span>GoTo</span> <span>HelloRetryFailed</span></td>
        </tr>
        <tr>
          <td id="L2358" data-line-number="2358"></td>
          <td id="LC2358">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2359" data-line-number="2359"></td>
          <td id="LC2359">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2360" data-line-number="2360"></td>
          <td id="LC2360">                            <span>If</span> <span>.CipherSuite</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2361" data-line-number="2361"></td>
          <td id="LC2361">                                <span>.HelloRetryCipherSuite</span> <span>=</span> <span>.CipherSuite</span></td>
        </tr>
        <tr>
          <td id="L2362" data-line-number="2362"></td>
          <td id="LC2362">                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2363" data-line-number="2363"></td>
          <td id="LC2363">                                <span>Select</span> <span>Case</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L2364" data-line-number="2364"></td>
          <td id="LC2364">                                <span>Case</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</span></td>
        </tr>
        <tr>
          <td id="L2365" data-line-number="2365"></td>
          <td id="LC2365">                                    <span>.HelloRetryCipherSuite</span> <span>=</span> <span>TLS_CS_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L2366" data-line-number="2366"></td>
          <td id="LC2366">                                <span>Case</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</span></td>
        </tr>
        <tr>
          <td id="L2367" data-line-number="2367"></td>
          <td id="LC2367">                                    <span>.HelloRetryCipherSuite</span> <span>=</span> <span>TLS_CS_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L2368" data-line-number="2368"></td>
          <td id="LC2368">                                <span>Case</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkChacha20Poly1305)</span></td>
        </tr>
        <tr>
          <td id="L2369" data-line-number="2369"></td>
          <td id="LC2369">                                    <span>.HelloRetryCipherSuite</span> <span>=</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L2370" data-line-number="2370"></td>
          <td id="LC2370">                                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2371" data-line-number="2371"></td>
          <td id="LC2371">                                    <span>GoTo</span> <span>HelloRetryFailed</span></td>
        </tr>
        <tr>
          <td id="L2372" data-line-number="2372"></td>
          <td id="LC2372">                                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2373" data-line-number="2373"></td>
          <td id="LC2373">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2374" data-line-number="2374"></td>
          <td id="LC2374">                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2375" data-line-number="2375"></td>
          <td id="LC2375">                            <span>.HelloRetryRequest</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L2376" data-line-number="2376"></td>
          <td id="LC2376">                            <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientFinished</span></td>
        </tr>
        <tr>
          <td id="L2377" data-line-number="2377"></td>
          <td id="LC2377">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2378" data-line-number="2378"></td>
          <td id="LC2378">                    <span>ElseIf</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2379" data-line-number="2379"></td>
          <td id="LC2379">                        <span>If</span> <span>.ExchGroup</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2380" data-line-number="2380"></td>
          <td id="LC2380">                            <span>If</span> <span>pvCollectionCount(.RemoteSupportedGroups)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2381" data-line-number="2381"></td>
          <td id="LC2381">                                <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2382" data-line-number="2382"></td>
          <td id="LC2382">                                    <span>lExchGroup</span> <span>=</span> <span>TLS_GROUP_SECP256R1</span></td>
        </tr>
        <tr>
          <td id="L2383" data-line-number="2383"></td>
          <td id="LC2383">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2384" data-line-number="2384"></td>
          <td id="LC2384">                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2385" data-line-number="2385"></td>
          <td id="LC2385">                                <span>lExchGroup</span> <span>=</span> <span>pvCollectionFirst(.RemoteSupportedGroups,</span> <span>Array(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L2386" data-line-number="2386"></td>
          <td id="LC2386">                                        <span>IIf(pvCryptoIsSupported(ucsTlsAlgoExchX25519),</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_GROUP_X25519,</span> <span>vbNullString),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L2387" data-line-number="2387"></td>
          <td id="LC2387">                                        <span>IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1),</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_GROUP_SECP256R1,</span> <span>vbNullString),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L2388" data-line-number="2388"></td>
          <td id="LC2388">                                        <span>IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1),</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_GROUP_SECP384R1,</span> <span>vbNullString)))</span></td>
        </tr>
        <tr>
          <td id="L2389" data-line-number="2389"></td>
          <td id="LC2389">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2390" data-line-number="2390"></td>
          <td id="LC2390">                            <span>If</span> <span>lExchGroup</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2391" data-line-number="2391"></td>
          <td id="LC2391">                                <span>GoTo</span> <span>NoSupportedGroups</span></td>
        </tr>
        <tr>
          <td id="L2392" data-line-number="2392"></td>
          <td id="LC2392">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2393" data-line-number="2393"></td>
          <td id="LC2393">                            <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L2394" data-line-number="2394"></td>
          <td id="LC2394">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2395" data-line-number="2395"></td>
          <td id="LC2395">                        <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientKeyExchange</span></td>
        </tr>
        <tr>
          <td id="L2396" data-line-number="2396"></td>
          <td id="LC2396">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2397" data-line-number="2397"></td>
          <td id="LC2397">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2398" data-line-number="2398"></td>
          <td id="LC2398">                    <span>GoTo</span> <span>UnexpectedMessageType</span></td>
        </tr>
        <tr>
          <td id="L2399" data-line-number="2399"></td>
          <td id="LC2399">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2400" data-line-number="2400"></td>
          <td id="LC2400">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uInput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span> <span>+</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L2401" data-line-number="2401"></td>
          <td id="LC2401">                <span>&#39;--- post-process ucsTlsStateExpectClientHello</span></td>
        </tr>
        <tr>
          <td id="L2402" data-line-number="2402"></td>
          <td id="LC2402">                <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2403" data-line-number="2403"></td>
          <td id="LC2403">                    <span>&#39;--- on HelloRetryRequest replace HandshakeMessages w/ &#39;synthetic handshake message&#39;</span></td>
        </tr>
        <tr>
          <td id="L2404" data-line-number="2404"></td>
          <td id="LC2404">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2405" data-line-number="2405"></td>
          <td id="LC2405">                    <span>.HandshakeMessages.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2406" data-line-number="2406"></td>
          <td id="LC2406">                    <span>pvBufferWriteLong</span> <span>.HandshakeMessages,</span> <span>TLS_HANDSHAKE_MESSAGE_HASH</span></td>
        </tr>
        <tr>
          <td id="L2407" data-line-number="2407"></td>
          <td id="LC2407">                    <span>pvBufferWriteLong</span> <span>.HandshakeMessages,</span> <span>.DigestSize,</span> <span>Size:=</span><span>3</span></td>
        </tr>
        <tr>
          <td id="L2408" data-line-number="2408"></td>
          <td id="LC2408">                    <span>pvBufferWriteArray</span> <span>.HandshakeMessages,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2409" data-line-number="2409"></td>
          <td id="LC2409">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2410" data-line-number="2410"></td>
          <td id="LC2410">                <span>pvTlsBuildServerHello</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2411" data-line-number="2411"></td>
          <td id="LC2411">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientFinished</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2412" data-line-number="2412"></td>
          <td id="LC2412">                    <span>pvTlsDeriveHandshakeSecrets</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2413" data-line-number="2413"></td>
          <td id="LC2413">                    <span>pvTlsBuildServerHandshakeFinished</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2414" data-line-number="2414"></td>
          <td id="LC2414">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2415" data-line-number="2415"></td>
          <td id="LC2415">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientKeyExchange</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2416" data-line-number="2416"></td>
          <td id="LC2416">                    <span>pvTlsBuildServerLegacyKeyExchange</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2417" data-line-number="2417"></td>
          <td id="LC2417">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2418" data-line-number="2418"></td>
          <td id="LC2418">            <span>Case</span> <span>ucsTlsStateExpectClientKeyExchange</span></td>
        </tr>
        <tr>
          <td id="L2419" data-line-number="2419"></td>
          <td id="LC2419">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2420" data-line-number="2420"></td>
          <td id="LC2420">                <span>Case</span> <span>TLS_HANDSHAKE_CLIENT_KEY_EXCHANGE</span></td>
        </tr>
        <tr>
          <td id="L2421" data-line-number="2421"></td>
          <td id="LC2421">                    <span>If</span> <span>.UseRsaKeyTransport</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2422" data-line-number="2422"></td>
          <td id="LC2422">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2423" data-line-number="2423"></td>
          <td id="LC2423">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2424" data-line-number="2424"></td>
          <td id="LC2424">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2425" data-line-number="2425"></td>
          <td id="LC2425">                        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lBlockSize,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2426" data-line-number="2426"></td>
          <td id="LC2426">                            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2427" data-line-number="2427"></td>
          <td id="LC2427">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2428" data-line-number="2428"></td>
          <td id="LC2428">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2429" data-line-number="2429"></td>
          <td id="LC2429">                            <span>pvBufferReadArray</span> <span>uInput,</span> <span>baTemp,</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2430" data-line-number="2430"></td>
          <td id="LC2430">                        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2431" data-line-number="2431"></td>
          <td id="LC2431">                        <span>pvTlsSetupExchRsaPreMasterSecret</span> <span>uCtx,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L2432" data-line-number="2432"></td>
          <td id="LC2432">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2433" data-line-number="2433"></td>
          <td id="LC2433">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>lMessageEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2434" data-line-number="2434"></td>
          <td id="LC2434">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2435" data-line-number="2435"></td>
          <td id="LC2435">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2436" data-line-number="2436"></td>
          <td id="LC2436">                        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2437" data-line-number="2437"></td>
          <td id="LC2437">                            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lMessageEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2438" data-line-number="2438"></td>
          <td id="LC2438">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2439" data-line-number="2439"></td>
          <td id="LC2439">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2440" data-line-number="2440"></td>
          <td id="LC2440">                            <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteExchPublic,</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2441" data-line-number="2441"></td>
          <td id="LC2441">                            <span>If</span> <span>Not</span> <span>pvTlsCheckRemoteKey(.ExchGroup,</span> <span>.RemoteExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2442" data-line-number="2442"></td>
          <td id="LC2442">                                <span>GoTo</span> <span>InvalidRemoteKey</span></td>
        </tr>
        <tr>
          <td id="L2443" data-line-number="2443"></td>
          <td id="LC2443">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2444" data-line-number="2444"></td>
          <td id="LC2444">                        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2445" data-line-number="2445"></td>
          <td id="LC2445">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2446" data-line-number="2446"></td>
          <td id="LC2446">                    <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientFinished</span></td>
        </tr>
        <tr>
          <td id="L2447" data-line-number="2447"></td>
          <td id="LC2447">                <span>Case</span> <span>TLS_HANDSHAKE_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L2448" data-line-number="2448"></td>
          <td id="LC2448">                    <span>&#39;--- ToDo: impl</span></td>
        </tr>
        <tr>
          <td id="L2449" data-line-number="2449"></td>
          <td id="LC2449">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2450" data-line-number="2450"></td>
          <td id="LC2450">                    <span>GoTo</span> <span>UnexpectedMessageType</span></td>
        </tr>
        <tr>
          <td id="L2451" data-line-number="2451"></td>
          <td id="LC2451">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2452" data-line-number="2452"></td>
          <td id="LC2452">                <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uInput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span> <span>+</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L2453" data-line-number="2453"></td>
          <td id="LC2453">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientFinished</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2454" data-line-number="2454"></td>
          <td id="LC2454">                    <span>pvTlsDeriveLegacySecrets</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2455" data-line-number="2455"></td>
          <td id="LC2455">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2456" data-line-number="2456"></td>
          <td id="LC2456">            <span>Case</span> <span>ucsTlsStateExpectClientFinished</span></td>
        </tr>
        <tr>
          <td id="L2457" data-line-number="2457"></td>
          <td id="LC2457">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2458" data-line-number="2458"></td>
          <td id="LC2458">                <span>Case</span> <span>TLS_HANDSHAKE_FINISHED</span></td>
        </tr>
        <tr>
          <td id="L2459" data-line-number="2459"></td>
          <td id="LC2459">                    <span>If</span> <span>pvArraySize(.RemoteTrafficKey)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2460" data-line-number="2460"></td>
          <td id="LC2460">                        <span>GoTo</span> <span>MissingTrafficKeys</span></td>
        </tr>
        <tr>
          <td id="L2461" data-line-number="2461"></td>
          <td id="LC2461">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2462" data-line-number="2462"></td>
          <td id="LC2462">                    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baMessage,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2463" data-line-number="2463"></td>
          <td id="LC2463">                    <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2464" data-line-number="2464"></td>
          <td id="LC2464">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2465" data-line-number="2465"></td>
          <td id="LC2465">                        <span>pvTlsHkdfExpandLabel</span> <span>baTemp,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;finished&#34;</span><span>,</span> <span>baEmpty,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L2466" data-line-number="2466"></td>
          <td id="LC2466">                        <span>pvTlsHkdfExtract</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>baTemp,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2467" data-line-number="2467"></td>
          <td id="LC2467">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2468" data-line-number="2468"></td>
          <td id="LC2468">                        <span>Debug.Assert</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span></td>
        </tr>
        <tr>
          <td id="L2469" data-line-number="2469"></td>
          <td id="LC2469">                        <span>pvTlsKdfLegacyPrf</span> <span>uVerify.Data,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>&#34;client finished&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>TLS_VERIFY_DATA_SIZE</span></td>
        </tr>
        <tr>
          <td id="L2470" data-line-number="2470"></td>
          <td id="LC2470">                        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2471" data-line-number="2471"></td>
          <td id="LC2471">                            <span>.RemoteLegacyVerifyData</span> <span>=</span> <span>uVerify.Data</span></td>
        </tr>
        <tr>
          <td id="L2472" data-line-number="2472"></td>
          <td id="LC2472">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2473" data-line-number="2473"></td>
          <td id="LC2473">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2474" data-line-number="2474"></td>
          <td id="LC2474">                    <span>If</span> <span>Not</span> <span>pvArrayEqual(uVerify.Data,</span> <span>baMessage)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2475" data-line-number="2475"></td>
          <td id="LC2475">                        <span>GoTo</span> <span>ServerHandshakeFailed</span></td>
        </tr>
        <tr>
          <td id="L2476" data-line-number="2476"></td>
          <td id="LC2476">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2477" data-line-number="2477"></td>
          <td id="LC2477">                    <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span></td>
        </tr>
        <tr>
          <td id="L2478" data-line-number="2478"></td>
          <td id="LC2478">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_HANDSHAKE_CERTIFICATE_VERIFY,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2479" data-line-number="2479"></td>
          <td id="LC2479">                    <span>&#39;--- ToDo: impl</span></td>
        </tr>
        <tr>
          <td id="L2480" data-line-number="2480"></td>
          <td id="LC2480">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2481" data-line-number="2481"></td>
          <td id="LC2481">                    <span>GoTo</span> <span>UnexpectedMessageType</span></td>
        </tr>
        <tr>
          <td id="L2482" data-line-number="2482"></td>
          <td id="LC2482">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2483" data-line-number="2483"></td>
          <td id="LC2483">                <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2484" data-line-number="2484"></td>
          <td id="LC2484">                    <span>pvTlsAppendHandshakeHash</span> <span>uCtx,</span> <span>uInput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span> <span>+</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L2485" data-line-number="2485"></td>
          <td id="LC2485">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2486" data-line-number="2486"></td>
          <td id="LC2486">                <span>&#39;--- post-process ucsTlsStateExpectClientFinished</span></td>
        </tr>
        <tr>
          <td id="L2487" data-line-number="2487"></td>
          <td id="LC2487">                <span>If</span> <span>.State</span> <span>=</span> <span>ucsTlsStatePostHandshake</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2488" data-line-number="2488"></td>
          <td id="LC2488">                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2489" data-line-number="2489"></td>
          <td id="LC2489">                        <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2490" data-line-number="2490"></td>
          <td id="LC2490">                        <span>pvTlsDeriveApplicationSecrets</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L2491" data-line-number="2491"></td>
          <td id="LC2491">                        <span>pvTlsResetHandshakeHash</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2492" data-line-number="2492"></td>
          <td id="LC2492">                        <span>Set</span> <span>.RemoteTickets</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2493" data-line-number="2493"></td>
          <td id="LC2493">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2494" data-line-number="2494"></td>
          <td id="LC2494">                        <span>Debug.Assert</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span></td>
        </tr>
        <tr>
          <td id="L2495" data-line-number="2495"></td>
          <td id="LC2495">                        <span>pvTlsBuildServerLegacyFinished</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2496" data-line-number="2496"></td>
          <td id="LC2496">                        <span>pvTlsResetHandshakeHash</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2497" data-line-number="2497"></td>
          <td id="LC2497">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2498" data-line-number="2498"></td>
          <td id="LC2498">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2499" data-line-number="2499"></td>
          <td id="LC2499"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2500" data-line-number="2500"></td>
          <td id="LC2500">            <span>Case</span> <span>ucsTlsStatePostHandshake</span></td>
        </tr>
        <tr>
          <td id="L2501" data-line-number="2501"></td>
          <td id="LC2501">                <span>Select</span> <span>Case</span> <span>lMessageType</span></td>
        </tr>
        <tr>
          <td id="L2502" data-line-number="2502"></td>
          <td id="LC2502">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>And</span> <span>Not</span> <span>.IsServer,</span> <span>TLS_HANDSHAKE_HELLO_REQUEST,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2503" data-line-number="2503"></td>
          <td id="LC2503">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2504" data-line-number="2504"></td>
          <td id="LC2504">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Received Hello Request. Will renegotiate&#34;</span></td>
        </tr>
        <tr>
          <td id="L2505" data-line-number="2505"></td>
          <td id="LC2505">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2506" data-line-number="2506"></td>
          <td id="LC2506">                    <span>If</span> <span>lMessageSize</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2507" data-line-number="2507"></td>
          <td id="LC2507">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2508" data-line-number="2508"></td>
          <td id="LC2508">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2509" data-line-number="2509"></td>
          <td id="LC2509">                    <span>.State</span> <span>=</span> <span>ucsTlsStateExpectServerHello</span></td>
        </tr>
        <tr>
          <td id="L2510" data-line-number="2510"></td>
          <td id="LC2510">                    <span>.AlpnNegotiated</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L2511" data-line-number="2511"></td>
          <td id="LC2511">                    <span>.SniRequested</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L2512" data-line-number="2512"></td>
          <td id="LC2512">                    <span>&#39;--- renegotiate ephemeral keys too</span></td>
        </tr>
        <tr>
          <td id="L2513" data-line-number="2513"></td>
          <td id="LC2513">                    <span>.ExchGroup</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2514" data-line-number="2514"></td>
          <td id="LC2514">                    <span>.CipherSuite</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2515" data-line-number="2515"></td>
          <td id="LC2515">                    <span>.SignatureScheme</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2516" data-line-number="2516"></td>
          <td id="LC2516">                    <span>.PrevRecordType</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2517" data-line-number="2517"></td>
          <td id="LC2517">                    <span>pvTlsBuildClientHello</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2518" data-line-number="2518"></td>
          <td id="LC2518"><span>#</span><span>If</span> <span>ImplTlsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2519" data-line-number="2519"></td>
          <td id="LC2519">                <span>Case</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>And</span> <span>.IsServer,</span> <span>TLS_HANDSHAKE_CLIENT_HELLO,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2520" data-line-number="2520"></td>
          <td id="LC2520">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2521" data-line-number="2521"></td>
          <td id="LC2521">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Received Client Hello. Will renegotiate&#34;</span></td>
        </tr>
        <tr>
          <td id="L2522" data-line-number="2522"></td>
          <td id="LC2522">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2523" data-line-number="2523"></td>
          <td id="LC2523">                    <span>#</span><span>If</span> <span>Not</span> <span>ImplTlsServerAllowInsecureRenegotiation</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2524" data-line-number="2524"></td>
          <td id="LC2524">                        <span>If</span> <span>pvArraySize(.RemoteLegacyVerifyData)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2525" data-line-number="2525"></td>
          <td id="LC2525">                            <span>GoTo</span> <span>SecureRenegotiationFailed</span></td>
        </tr>
        <tr>
          <td id="L2526" data-line-number="2526"></td>
          <td id="LC2526">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2527" data-line-number="2527"></td>
          <td id="LC2527">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2528" data-line-number="2528"></td>
          <td id="LC2528">                    <span>.State</span> <span>=</span> <span>ucsTlsStateExpectClientHello</span></td>
        </tr>
        <tr>
          <td id="L2529" data-line-number="2529"></td>
          <td id="LC2529">                    <span>.AlpnNegotiated</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L2530" data-line-number="2530"></td>
          <td id="LC2530">                    <span>.SniRequested</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L2531" data-line-number="2531"></td>
          <td id="LC2531">                    <span>&#39;--- renegotiate ephemeral keys too</span></td>
        </tr>
        <tr>
          <td id="L2532" data-line-number="2532"></td>
          <td id="LC2532">                    <span>.ExchGroup</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2533" data-line-number="2533"></td>
          <td id="LC2533">                    <span>.CipherSuite</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2534" data-line-number="2534"></td>
          <td id="LC2534">                    <span>.SignatureScheme</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2535" data-line-number="2535"></td>
          <td id="LC2535">                    <span>.PrevRecordType</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2536" data-line-number="2536"></td>
          <td id="LC2536">                    <span>GoTo</span> <span>RenegotiateClientHello</span></td>
        </tr>
        <tr>
          <td id="L2537" data-line-number="2537"></td>
          <td id="LC2537"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2538" data-line-number="2538"></td>
          <td id="LC2538">                <span>Case</span> <span>TLS_HANDSHAKE_NEW_SESSION_TICKET</span></td>
        </tr>
        <tr>
          <td id="L2539" data-line-number="2539"></td>
          <td id="LC2539">                    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baMessage,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L2540" data-line-number="2540"></td>
          <td id="LC2540">                    <span>If</span> <span>Not</span> <span>.RemoteTickets</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2541" data-line-number="2541"></td>
          <td id="LC2541">                        <span>.RemoteTickets.Add</span> <span>baMessage</span></td>
        </tr>
        <tr>
          <td id="L2542" data-line-number="2542"></td>
          <td id="LC2542">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2543" data-line-number="2543"></td>
          <td id="LC2543">                <span>Case</span> <span>TLS_HANDSHAKE_KEY_UPDATE</span></td>
        </tr>
        <tr>
          <td id="L2544" data-line-number="2544"></td>
          <td id="LC2544">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2545" data-line-number="2545"></td>
          <td id="LC2545">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Received TLS_HANDSHAKE_KEY_UPDATE&#34;</span></td>
        </tr>
        <tr>
          <td id="L2546" data-line-number="2546"></td>
          <td id="LC2546">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2547" data-line-number="2547"></td>
          <td id="LC2547">                    <span>If</span> <span>lMessageSize</span> <span>&lt;&gt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2548" data-line-number="2548"></td>
          <td id="LC2548">                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2549" data-line-number="2549"></td>
          <td id="LC2549">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2550" data-line-number="2550"></td>
          <td id="LC2550">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lRequestUpdate</span></td>
        </tr>
        <tr>
          <td id="L2551" data-line-number="2551"></td>
          <td id="LC2551">                    <span>If</span> <span>lRequestUpdate</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>lRequestUpdate</span> <span>&lt;&gt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2552" data-line-number="2552"></td>
          <td id="LC2552">                        <span>GoTo</span> <span>UnsupportedRequestUpdate</span></td>
        </tr>
        <tr>
          <td id="L2553" data-line-number="2553"></td>
          <td id="LC2553">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2554" data-line-number="2554"></td>
          <td id="LC2554">                    <span>If</span> <span>lRequestUpdate</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2555" data-line-number="2555"></td>
          <td id="LC2555">                        <span>&#39;--- ack by TLS_HANDSHAKE_KEY_UPDATE w/ update_not_requested(0)</span></td>
        </tr>
        <tr>
          <td id="L2556" data-line-number="2556"></td>
          <td id="LC2556">                        <span>pvArrayByte</span> <span>baTemp,</span> <span>TLS_HANDSHAKE_KEY_UPDATE,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>1</span><span>,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2557" data-line-number="2557"></td>
          <td id="LC2557">                        <span>pvTlsBuildApplicationData</span> <span>uCtx,</span> <span>.SendBuffer,</span> <span>baTemp,</span> <span>0</span><span>,</span> <span>UBound(baTemp)</span> <span>+</span> <span>1</span><span>,</span> <span>TLS_CONTENT_TYPE_HANDSHAKE</span></td>
        </tr>
        <tr>
          <td id="L2558" data-line-number="2558"></td>
          <td id="LC2558">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2559" data-line-number="2559"></td>
          <td id="LC2559">                    <span>pvTlsDeriveKeyUpdate</span> <span>uCtx,</span> <span>lRequestUpdate</span> <span>&lt;&gt;</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2560" data-line-number="2560"></td>
          <td id="LC2560">                <span>Case</span> <span>TLS_HANDSHAKE_CERTIFICATE_REQUEST</span></td>
        </tr>
        <tr>
          <td id="L2561" data-line-number="2561"></td>
          <td id="LC2561">                    <span>If</span> <span>Not</span> <span>pvTlsParseHandshakeCertificateRequest(uCtx,</span> <span>uInput,</span> <span>sError,</span> <span>eAlertCode)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2562" data-line-number="2562"></td>
          <td id="LC2562">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2563" data-line-number="2563"></td>
          <td id="LC2563">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2564" data-line-number="2564"></td>
          <td id="LC2564">                    <span>pvTlsBuildClientHandshakeFinished</span> <span>uCtx,</span> <span>.SendBuffer</span></td>
        </tr>
        <tr>
          <td id="L2565" data-line-number="2565"></td>
          <td id="LC2565">                    <span>pvTlsResetHandshakeHash</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2566" data-line-number="2566"></td>
          <td id="LC2566">                <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2567" data-line-number="2567"></td>
          <td id="LC2567">                    <span>GoTo</span> <span>UnexpectedMessageType</span></td>
        </tr>
        <tr>
          <td id="L2568" data-line-number="2568"></td>
          <td id="LC2568">                <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2569" data-line-number="2569"></td>
          <td id="LC2569">            <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2570" data-line-number="2570"></td>
          <td id="LC2570">                <span>GoTo</span> <span>InvalidStateHandshake</span></td>
        </tr>
        <tr>
          <td id="L2571" data-line-number="2571"></td>
          <td id="LC2571">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2572" data-line-number="2572"></td>
          <td id="LC2572">        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2573" data-line-number="2573"></td>
          <td id="LC2573">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2574" data-line-number="2574"></td>
          <td id="LC2574">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L2575" data-line-number="2575"></td>
          <td id="LC2575">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L2576" data-line-number="2576"></td>
          <td id="LC2576">    <span>pvTlsParseHandshake</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L2577" data-line-number="2577"></td>
          <td id="LC2577"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L2578" data-line-number="2578"></td>
          <td id="LC2578">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L2579" data-line-number="2579"></td>
          <td id="LC2579"><span>UnexpectedMessageType:</span></td>
        </tr>
        <tr>
          <td id="L2580" data-line-number="2580"></td>
          <td id="LC2580">    <span>sError</span> <span>=</span> <span>Replace(Replace(ERR_UNEXPECTED_MSG_TYPE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetStateAsText(uCtx.State)),</span> <span>&#34;%2&#34;</span><span>,</span> <span>pvTlsGetMessageName(lMessageType))</span></td>
        </tr>
        <tr>
          <td id="L2581" data-line-number="2581"></td>
          <td id="LC2581">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertUnexpectedMessage</span></td>
        </tr>
        <tr>
          <td id="L2582" data-line-number="2582"></td>
          <td id="LC2582">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2583" data-line-number="2583"></td>
          <td id="LC2583"><span>ServerHandshakeFailed:</span></td>
        </tr>
        <tr>
          <td id="L2584" data-line-number="2584"></td>
          <td id="LC2584">    <span>sError</span> <span>=</span> <span>ERR_SERVER_HANDSHAKE_FAILED</span></td>
        </tr>
        <tr>
          <td id="L2585" data-line-number="2585"></td>
          <td id="LC2585">    <span>eAlertCode</span> <span>=</span> <span>IIf(pvArraySize(uVerify.Data)</span> <span>&lt;&gt;</span> <span>pvArraySize(baMessage),</span> <span>uscTlsAlertDecodeError,</span> <span>uscTlsAlertDecryptError)</span></td>
        </tr>
        <tr>
          <td id="L2586" data-line-number="2586"></td>
          <td id="LC2586">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2587" data-line-number="2587"></td>
          <td id="LC2587"><span>HelloRetryFailed:</span></td>
        </tr>
        <tr>
          <td id="L2588" data-line-number="2588"></td>
          <td id="LC2588">    <span>sError</span> <span>=</span> <span>ERR_HELLO_RETRY_FAILED</span></td>
        </tr>
        <tr>
          <td id="L2589" data-line-number="2589"></td>
          <td id="LC2589">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L2590" data-line-number="2590"></td>
          <td id="LC2590">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2591" data-line-number="2591"></td>
          <td id="LC2591"><span>NoServerCertificate:</span></td>
        </tr>
        <tr>
          <td id="L2592" data-line-number="2592"></td>
          <td id="LC2592">    <span>sError</span> <span>=</span> <span>ERR_NO_SERVER_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L2593" data-line-number="2593"></td>
          <td id="LC2593">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertCertificateUnknown</span></td>
        </tr>
        <tr>
          <td id="L2594" data-line-number="2594"></td>
          <td id="LC2594">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2595" data-line-number="2595"></td>
          <td id="LC2595"><span>InvalidSize:</span></td>
        </tr>
        <tr>
          <td id="L2596" data-line-number="2596"></td>
          <td id="LC2596">    <span>sError</span> <span>=</span> <span>IIf(lExtType</span> <span>&lt;</span> <span>0</span><span>,</span> <span>ERR_INVALID_SIZE,</span> <span>Replace(ERR_INVALID_SIZE_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType)))</span></td>
        </tr>
        <tr>
          <td id="L2597" data-line-number="2597"></td>
          <td id="LC2597">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertDecodeError</span></td>
        </tr>
        <tr>
          <td id="L2598" data-line-number="2598"></td>
          <td id="LC2598">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2599" data-line-number="2599"></td>
          <td id="LC2599"><span>UnsupportedCurveType:</span></td>
        </tr>
        <tr>
          <td id="L2600" data-line-number="2600"></td>
          <td id="LC2600">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_CURVE_TYPE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lCurveType)</span></td>
        </tr>
        <tr>
          <td id="L2601" data-line-number="2601"></td>
          <td id="LC2601">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L2602" data-line-number="2602"></td>
          <td id="LC2602">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2603" data-line-number="2603"></td>
          <td id="LC2603"><span>InvalidStateHandshake:</span></td>
        </tr>
        <tr>
          <td id="L2604" data-line-number="2604"></td>
          <td id="LC2604">    <span>sError</span> <span>=</span> <span>Replace(ERR_INVALID_STATE_HANDSHAKE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetStateAsText(uCtx.State))</span></td>
        </tr>
        <tr>
          <td id="L2605" data-line-number="2605"></td>
          <td id="LC2605">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L2606" data-line-number="2606"></td>
          <td id="LC2606">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2607" data-line-number="2607"></td>
          <td id="LC2607"><span>SecureRenegotiationFailed:</span></td>
        </tr>
        <tr>
          <td id="L2608" data-line-number="2608"></td>
          <td id="LC2608">    <span>sError</span> <span>=</span> <span>ERR_SECURE_RENEGOTIATION_FAILED</span></td>
        </tr>
        <tr>
          <td id="L2609" data-line-number="2609"></td>
          <td id="LC2609">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L2610" data-line-number="2610"></td>
          <td id="LC2610">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2611" data-line-number="2611"></td>
          <td id="LC2611"><span>InvalidRemoteKey:</span></td>
        </tr>
        <tr>
          <td id="L2612" data-line-number="2612"></td>
          <td id="LC2612">    <span>sError</span> <span>=</span> <span>ERR_INVALID_REMOTE_KEY</span></td>
        </tr>
        <tr>
          <td id="L2613" data-line-number="2613"></td>
          <td id="LC2613">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L2614" data-line-number="2614"></td>
          <td id="LC2614">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2615" data-line-number="2615"></td>
          <td id="LC2615"><span>NoSupportedGroups:</span></td>
        </tr>
        <tr>
          <td id="L2616" data-line-number="2616"></td>
          <td id="LC2616">    <span>sError</span> <span>=</span> <span>ERR_NO_SUPPORTED_GROUPS</span></td>
        </tr>
        <tr>
          <td id="L2617" data-line-number="2617"></td>
          <td id="LC2617">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L2618" data-line-number="2618"></td>
          <td id="LC2618">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2619" data-line-number="2619"></td>
          <td id="LC2619"><span>UnsupportedRequestUpdate:</span></td>
        </tr>
        <tr>
          <td id="L2620" data-line-number="2620"></td>
          <td id="LC2620">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_REQUEST_UPDATE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lRequestUpdate)</span></td>
        </tr>
        <tr>
          <td id="L2621" data-line-number="2621"></td>
          <td id="LC2621">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L2622" data-line-number="2622"></td>
          <td id="LC2622">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2623" data-line-number="2623"></td>
          <td id="LC2623"><span>MissingTrafficKeys:</span></td>
        </tr>
        <tr>
          <td id="L2624" data-line-number="2624"></td>
          <td id="LC2624">    <span>sError</span> <span>=</span> <span>ERR_MISSING_TRAFFIC_KEYS</span></td>
        </tr>
        <tr>
          <td id="L2625" data-line-number="2625"></td>
          <td id="LC2625">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertUnexpectedMessage</span></td>
        </tr>
        <tr>
          <td id="L2626" data-line-number="2626"></td>
          <td id="LC2626">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2627" data-line-number="2627"></td>
          <td id="LC2627"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L2628" data-line-number="2628"></td>
          <td id="LC2628">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L2629" data-line-number="2629"></td>
          <td id="LC2629">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L2630" data-line-number="2630"></td>
          <td id="LC2630">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2631" data-line-number="2631"></td>
          <td id="LC2631"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L2632" data-line-number="2632"></td>
          <td id="LC2632">
</td>
        </tr>
        <tr>
          <td id="L2633" data-line-number="2633"></td>
          <td id="LC2633"><span>Private</span> <span>Function</span> <span>pvTlsParseHandshakeServerHello(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lInputEnd</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lRecordProtocol</span> <span>As</span> <span>Long</span><span>,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L2634" data-line-number="2634"></td>
          <td id="LC2634">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsParseHandshakeServerHello&#34;</span></td>
        </tr>
        <tr>
          <td id="L2635" data-line-number="2635"></td>
          <td id="LC2635">    <span>Dim</span> <span>lBlockSize</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2636" data-line-number="2636"></td>
          <td id="LC2636">    <span>Dim</span> <span>lBlockEnd</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2637" data-line-number="2637"></td>
          <td id="LC2637">    <span>Dim</span> <span>lCipherSuite</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2638" data-line-number="2638"></td>
          <td id="LC2638">    <span>Dim</span> <span>lLegacyCompress</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2639" data-line-number="2639"></td>
          <td id="LC2639">    <span>Dim</span> <span>lExtType</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2640" data-line-number="2640"></td>
          <td id="LC2640">    <span>Dim</span> <span>lExtSize</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2641" data-line-number="2641"></td>
          <td id="LC2641">    <span>Dim</span> <span>lExtEnd</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2642" data-line-number="2642"></td>
          <td id="LC2642">    <span>Dim</span> <span>lExchGroup</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2643" data-line-number="2643"></td>
          <td id="LC2643">    <span>Dim</span> <span>lPublicSize</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2644" data-line-number="2644"></td>
          <td id="LC2644">    <span>Dim</span> <span>lNameSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2645" data-line-number="2645"></td>
          <td id="LC2645">    <span>Dim</span> <span>lCookieSize</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2646" data-line-number="2646"></td>
          <td id="LC2646">    </td>
        </tr>
        <tr>
          <td id="L2647" data-line-number="2647"></td>
          <td id="LC2647">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L2648" data-line-number="2648"></td>
          <td id="LC2648">    <span>lExtType</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L2649" data-line-number="2649"></td>
          <td id="LC2649">    <span>If</span> <span>pvArraySize(m_baHelloRetryRandom)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2650" data-line-number="2650"></td>
          <td id="LC2650">        <span>pvTlsGetHelloRetryRandom</span> <span>m_baHelloRetryRandom</span></td>
        </tr>
        <tr>
          <td id="L2651" data-line-number="2651"></td>
          <td id="LC2651">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2652" data-line-number="2652"></td>
          <td id="LC2652">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2653" data-line-number="2653"></td>
          <td id="LC2653">        <span>.ProtocolVersion</span> <span>=</span> <span>IIf(lRecordProtocol</span> <span>&lt;=</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_PROTOCOL_VERSION_TLS13)</span></td>
        </tr>
        <tr>
          <td id="L2654" data-line-number="2654"></td>
          <td id="LC2654">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>.RemoteProtocolVersion,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2655" data-line-number="2655"></td>
          <td id="LC2655">        <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteExchRandom,</span> <span>TLS_HELLO_RANDOM_SIZE</span></td>
        </tr>
        <tr>
          <td id="L2656" data-line-number="2656"></td>
          <td id="LC2656">        <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2657" data-line-number="2657"></td>
          <td id="LC2657">            <span>&#39;--- clear HelloRetryRequest</span></td>
        </tr>
        <tr>
          <td id="L2658" data-line-number="2658"></td>
          <td id="LC2658">            <span>.HelloRetryRequest</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L2659" data-line-number="2659"></td>
          <td id="LC2659">            <span>.HelloRetryCipherSuite</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2660" data-line-number="2660"></td>
          <td id="LC2660">            <span>.HelloRetryExchGroup</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2661" data-line-number="2661"></td>
          <td id="LC2661">            <span>Erase</span> <span>.HelloRetryCookie</span></td>
        </tr>
        <tr>
          <td id="L2662" data-line-number="2662"></td>
          <td id="LC2662">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2663" data-line-number="2663"></td>
          <td id="LC2663">            <span>.HelloRetryRequest</span> <span>=</span> <span>(StrConv(.RemoteExchRandom,</span> <span>vbUnicode)</span> <span>=</span> <span>StrConv(m_baHelloRetryRandom,</span> <span>vbUnicode))</span></td>
        </tr>
        <tr>
          <td id="L2664" data-line-number="2664"></td>
          <td id="LC2664">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2665" data-line-number="2665"></td>
          <td id="LC2665">        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2666" data-line-number="2666"></td>
          <td id="LC2666">            <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteSessionID,</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2667" data-line-number="2667"></td>
          <td id="LC2667">        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2668" data-line-number="2668"></td>
          <td id="LC2668">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lCipherSuite,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2669" data-line-number="2669"></td>
          <td id="LC2669">        <span>pvTlsSetupCipherSuite</span> <span>uCtx,</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L2670" data-line-number="2670"></td>
          <td id="LC2670">        <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2671" data-line-number="2671"></td>
          <td id="LC2671">            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Using &#34;</span> <span>&amp;</span> <span>pvTlsGetCipherSuiteName(.CipherSuite)</span> <span>&amp;</span> <span>&#34; from &#34;</span> <span>&amp;</span> <span>.RemoteHostName</span></td>
        </tr>
        <tr>
          <td id="L2672" data-line-number="2672"></td>
          <td id="LC2672">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2673" data-line-number="2673"></td>
          <td id="LC2673">        <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2674" data-line-number="2674"></td>
          <td id="LC2674">            <span>.HelloRetryCipherSuite</span> <span>=</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L2675" data-line-number="2675"></td>
          <td id="LC2675">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2676" data-line-number="2676"></td>
          <td id="LC2676">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lLegacyCompress</span></td>
        </tr>
        <tr>
          <td id="L2677" data-line-number="2677"></td>
          <td id="LC2677">        <span>Debug.Assert</span> <span>lLegacyCompress</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2678" data-line-number="2678"></td>
          <td id="LC2678">        <span>Set</span> <span>.RemoteExtensions</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2679" data-line-number="2679"></td>
          <td id="LC2679">        <span>If</span> <span>uInput.Pos</span> <span>&lt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2680" data-line-number="2680"></td>
          <td id="LC2680">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2681" data-line-number="2681"></td>
          <td id="LC2681">                <span>lBlockEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2682" data-line-number="2682"></td>
          <td id="LC2682">                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&lt;</span> <span>lBlockEnd</span></td>
        </tr>
        <tr>
          <td id="L2683" data-line-number="2683"></td>
          <td id="LC2683">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExtType,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2684" data-line-number="2684"></td>
          <td id="LC2684">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2685" data-line-number="2685"></td>
          <td id="LC2685"><span>&#39;                        DebugLog MODULE_NAME, FUNC_NAME, &#34;ServerHello &#34; &amp; pvTlsGetExtensionName(lExtType)</span></td>
        </tr>
        <tr>
          <td id="L2686" data-line-number="2686"></td>
          <td id="LC2686">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2687" data-line-number="2687"></td>
          <td id="LC2687">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2688" data-line-number="2688"></td>
          <td id="LC2688">                        <span>lExtEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2689" data-line-number="2689"></td>
          <td id="LC2689">                        <span>If</span> <span>lExtEnd</span> <span>&gt;</span> <span>lBlockEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2690" data-line-number="2690"></td>
          <td id="LC2690">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2691" data-line-number="2691"></td>
          <td id="LC2691">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2692" data-line-number="2692"></td>
          <td id="LC2692">                        <span>Select</span> <span>Case</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L2693" data-line-number="2693"></td>
          <td id="LC2693">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_KEY_SHARE,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2694" data-line-number="2694"></td>
          <td id="LC2694">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2695" data-line-number="2695"></td>
          <td id="LC2695">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2696" data-line-number="2696"></td>
          <td id="LC2696">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2697" data-line-number="2697"></td>
          <td id="LC2697">                            <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2698" data-line-number="2698"></td>
          <td id="LC2698">                            <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L2699" data-line-number="2699"></td>
          <td id="LC2699">                            <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2700" data-line-number="2700"></td>
          <td id="LC2700">                                <span>.HelloRetryExchGroup</span> <span>=</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L2701" data-line-number="2701"></td>
          <td id="LC2701">                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2702" data-line-number="2702"></td>
          <td id="LC2702">                                <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2703" data-line-number="2703"></td>
          <td id="LC2703">                                    <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;With exchange group &#34;</span> <span>&amp;</span> <span>pvTlsGetExchGroupName(.ExchGroup)</span></td>
        </tr>
        <tr>
          <td id="L2704" data-line-number="2704"></td>
          <td id="LC2704">                                <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2705" data-line-number="2705"></td>
          <td id="LC2705">                                <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>4</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2706" data-line-number="2706"></td>
          <td id="LC2706">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2707" data-line-number="2707"></td>
          <td id="LC2707">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2708" data-line-number="2708"></td>
          <td id="LC2708">                                <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lPublicSize</span></td>
        </tr>
        <tr>
          <td id="L2709" data-line-number="2709"></td>
          <td id="LC2709">                                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lPublicSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lPublicSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2710" data-line-number="2710"></td>
          <td id="LC2710">                                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2711" data-line-number="2711"></td>
          <td id="LC2711">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2712" data-line-number="2712"></td>
          <td id="LC2712">                                    <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteExchPublic,</span> <span>lPublicSize</span></td>
        </tr>
        <tr>
          <td id="L2713" data-line-number="2713"></td>
          <td id="LC2713">                                    <span>If</span> <span>Not</span> <span>pvTlsCheckRemoteKey(.ExchGroup,</span> <span>.RemoteExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2714" data-line-number="2714"></td>
          <td id="LC2714">                                        <span>GoTo</span> <span>InvalidRemoteKey</span></td>
        </tr>
        <tr>
          <td id="L2715" data-line-number="2715"></td>
          <td id="LC2715">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2716" data-line-number="2716"></td>
          <td id="LC2716">                                <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2717" data-line-number="2717"></td>
          <td id="LC2717">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2718" data-line-number="2718"></td>
          <td id="LC2718">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_SUPPORTED_VERSIONS,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2719" data-line-number="2719"></td>
          <td id="LC2719">                            <span>If</span> <span>lExtSize</span> <span>&lt;&gt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2720" data-line-number="2720"></td>
          <td id="LC2720">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2721" data-line-number="2721"></td>
          <td id="LC2721">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2722" data-line-number="2722"></td>
          <td id="LC2722">                            <span>pvBufferReadLong</span> <span>uInput,</span> <span>.ProtocolVersion,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2723" data-line-number="2723"></td>
          <td id="LC2723">                            <span>If</span> <span>.ProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>And</span> <span>.ProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2724" data-line-number="2724"></td>
          <td id="LC2724">                                <span>GoTo</span> <span>UnsupportedProtocol</span></td>
        </tr>
        <tr>
          <td id="L2725" data-line-number="2725"></td>
          <td id="LC2725">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2726" data-line-number="2726"></td>
          <td id="LC2726">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_COOKIE,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2727" data-line-number="2727"></td>
          <td id="LC2727">                            <span>If</span> <span>Not</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2728" data-line-number="2728"></td>
          <td id="LC2728">                                <span>GoTo</span> <span>UnexpectedExtension</span></td>
        </tr>
        <tr>
          <td id="L2729" data-line-number="2729"></td>
          <td id="LC2729">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2730" data-line-number="2730"></td>
          <td id="LC2730">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2731" data-line-number="2731"></td>
          <td id="LC2731">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2732" data-line-number="2732"></td>
          <td id="LC2732">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2733" data-line-number="2733"></td>
          <td id="LC2733">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lCookieSize</span></td>
        </tr>
        <tr>
          <td id="L2734" data-line-number="2734"></td>
          <td id="LC2734">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lCookieSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lCookieSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2735" data-line-number="2735"></td>
          <td id="LC2735">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2736" data-line-number="2736"></td>
          <td id="LC2736">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2737" data-line-number="2737"></td>
          <td id="LC2737">                                <span>pvBufferReadArray</span> <span>uInput,</span> <span>.HelloRetryCookie,</span> <span>lCookieSize</span></td>
        </tr>
        <tr>
          <td id="L2738" data-line-number="2738"></td>
          <td id="LC2738">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2739" data-line-number="2739"></td>
          <td id="LC2739">                        <span>Case</span> <span>TLS_EXTENSION_ALPN</span></td>
        </tr>
        <tr>
          <td id="L2740" data-line-number="2740"></td>
          <td id="LC2740">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2741" data-line-number="2741"></td>
          <td id="LC2741">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2742" data-line-number="2742"></td>
          <td id="LC2742">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2743" data-line-number="2743"></td>
          <td id="LC2743">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2744" data-line-number="2744"></td>
          <td id="LC2744">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lNameSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lNameSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2745" data-line-number="2745"></td>
          <td id="LC2745">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2746" data-line-number="2746"></td>
          <td id="LC2746">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2747" data-line-number="2747"></td>
          <td id="LC2747">                                <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2748" data-line-number="2748"></td>
          <td id="LC2748">                                    <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lNameSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lNameSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2749" data-line-number="2749"></td>
          <td id="LC2749">                                        <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2750" data-line-number="2750"></td>
          <td id="LC2750">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2751" data-line-number="2751"></td>
          <td id="LC2751">                                    <span>pvBufferReadString</span> <span>uInput,</span> <span>.AlpnNegotiated,</span> <span>lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2752" data-line-number="2752"></td>
          <td id="LC2752">                                <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2753" data-line-number="2753"></td>
          <td id="LC2753">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2754" data-line-number="2754"></td>
          <td id="LC2754">                        <span>Case</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO</span></td>
        </tr>
        <tr>
          <td id="L2755" data-line-number="2755"></td>
          <td id="LC2755">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2756" data-line-number="2756"></td>
          <td id="LC2756">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2757" data-line-number="2757"></td>
          <td id="LC2757">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2758" data-line-number="2758"></td>
          <td id="LC2758">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>1</span><span>,</span> <span>BlockSize:=lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2759" data-line-number="2759"></td>
          <td id="LC2759">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lNameSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2760" data-line-number="2760"></td>
          <td id="LC2760">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2761" data-line-number="2761"></td>
          <td id="LC2761">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2762" data-line-number="2762"></td>
          <td id="LC2762">                                <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteLegacyRenegInfo,</span> <span>lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2763" data-line-number="2763"></td>
          <td id="LC2763">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2764" data-line-number="2764"></td>
          <td id="LC2764">                        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2765" data-line-number="2765"></td>
          <td id="LC2765">                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2766" data-line-number="2766"></td>
          <td id="LC2766">                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L2767" data-line-number="2767"></td>
          <td id="LC2767">                        <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExtType)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2768" data-line-number="2768"></td>
          <td id="LC2768">                            <span>.RemoteExtensions.Add</span> <span>lExtType,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L2769" data-line-number="2769"></td>
          <td id="LC2769">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2770" data-line-number="2770"></td>
          <td id="LC2770">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2771" data-line-number="2771"></td>
          <td id="LC2771">                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2772" data-line-number="2772"></td>
          <td id="LC2772">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2773" data-line-number="2773"></td>
          <td id="LC2773">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2774" data-line-number="2774"></td>
          <td id="LC2774">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L2775" data-line-number="2775"></td>
          <td id="LC2775">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L2776" data-line-number="2776"></td>
          <td id="LC2776">    <span>pvTlsParseHandshakeServerHello</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L2777" data-line-number="2777"></td>
          <td id="LC2777"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L2778" data-line-number="2778"></td>
          <td id="LC2778">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L2779" data-line-number="2779"></td>
          <td id="LC2779"><span>InvalidSize:</span></td>
        </tr>
        <tr>
          <td id="L2780" data-line-number="2780"></td>
          <td id="LC2780">    <span>sError</span> <span>=</span> <span>IIf(lExtType</span> <span>&lt;</span> <span>0</span><span>,</span> <span>ERR_INVALID_SIZE,</span> <span>Replace(ERR_INVALID_SIZE_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType)))</span></td>
        </tr>
        <tr>
          <td id="L2781" data-line-number="2781"></td>
          <td id="LC2781">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertDecodeError</span></td>
        </tr>
        <tr>
          <td id="L2782" data-line-number="2782"></td>
          <td id="LC2782">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2783" data-line-number="2783"></td>
          <td id="LC2783"><span>UnexpectedExtension:</span></td>
        </tr>
        <tr>
          <td id="L2784" data-line-number="2784"></td>
          <td id="LC2784">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNEXPECTED_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType))</span></td>
        </tr>
        <tr>
          <td id="L2785" data-line-number="2785"></td>
          <td id="LC2785">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L2786" data-line-number="2786"></td>
          <td id="LC2786">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2787" data-line-number="2787"></td>
          <td id="LC2787"><span>InvalidRemoteKey:</span></td>
        </tr>
        <tr>
          <td id="L2788" data-line-number="2788"></td>
          <td id="LC2788">    <span>sError</span> <span>=</span> <span>ERR_INVALID_REMOTE_KEY</span></td>
        </tr>
        <tr>
          <td id="L2789" data-line-number="2789"></td>
          <td id="LC2789">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L2790" data-line-number="2790"></td>
          <td id="LC2790">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2791" data-line-number="2791"></td>
          <td id="LC2791"><span>UnsupportedProtocol:</span></td>
        </tr>
        <tr>
          <td id="L2792" data-line-number="2792"></td>
          <td id="LC2792">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_PROTOCOL,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;&amp;H&#34;</span> <span>&amp;</span> <span>Hex$(uCtx.ProtocolVersion))</span></td>
        </tr>
        <tr>
          <td id="L2793" data-line-number="2793"></td>
          <td id="LC2793">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L2794" data-line-number="2794"></td>
          <td id="LC2794">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2795" data-line-number="2795"></td>
          <td id="LC2795"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L2796" data-line-number="2796"></td>
          <td id="LC2796">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L2797" data-line-number="2797"></td>
          <td id="LC2797">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L2798" data-line-number="2798"></td>
          <td id="LC2798">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L2799" data-line-number="2799"></td>
          <td id="LC2799"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L2800" data-line-number="2800"></td>
          <td id="LC2800">
</td>
        </tr>
        <tr>
          <td id="L2801" data-line-number="2801"></td>
          <td id="LC2801"><span>Private</span> <span>Function</span> <span>pvTlsParseHandshakeClientHello(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lInputEnd</span> <span>As</span> <span>Long</span><span>,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L2802" data-line-number="2802"></td>
          <td id="LC2802">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsParseHandshakeClientHello&#34;</span></td>
        </tr>
        <tr>
          <td id="L2803" data-line-number="2803"></td>
          <td id="LC2803">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2804" data-line-number="2804"></td>
          <td id="LC2804">    <span>Dim</span> <span>lEnd</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2805" data-line-number="2805"></td>
          <td id="LC2805">    <span>Dim</span> <span>lCipherSuite</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2806" data-line-number="2806"></td>
          <td id="LC2806">    <span>Dim</span> <span>lExtType</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2807" data-line-number="2807"></td>
          <td id="LC2807">    <span>Dim</span> <span>lExtSize</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2808" data-line-number="2808"></td>
          <td id="LC2808">    <span>Dim</span> <span>lExtEnd</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2809" data-line-number="2809"></td>
          <td id="LC2809">    <span>Dim</span> <span>lExchGroup</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2810" data-line-number="2810"></td>
          <td id="LC2810">    <span>Dim</span> <span>eExchAlgo</span>       <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum</span></td>
        </tr>
        <tr>
          <td id="L2811" data-line-number="2811"></td>
          <td id="LC2811">    <span>Dim</span> <span>lBlockSize</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2812" data-line-number="2812"></td>
          <td id="LC2812">    <span>Dim</span> <span>lProtocolVersion</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2813" data-line-number="2813"></td>
          <td id="LC2813">    <span>Dim</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2814" data-line-number="2814"></td>
          <td id="LC2814">    <span>Dim</span> <span>cCipherSuites</span>   <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2815" data-line-number="2815"></td>
          <td id="LC2815">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2816" data-line-number="2816"></td>
          <td id="LC2816">    <span>Dim</span> <span>vItem</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L2817" data-line-number="2817"></td>
          <td id="LC2817">    <span>Dim</span> <span>vElem</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L2818" data-line-number="2818"></td>
          <td id="LC2818">    <span>Dim</span> <span>uKeyInfo</span>        <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L2819" data-line-number="2819"></td>
          <td id="LC2819">    <span>Dim</span> <span>lNameType</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2820" data-line-number="2820"></td>
          <td id="LC2820">    <span>Dim</span> <span>lNameSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2821" data-line-number="2821"></td>
          <td id="LC2821">    <span>Dim</span> <span>sName</span>           <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L2822" data-line-number="2822"></td>
          <td id="LC2822">    <span>Dim</span> <span>cAlpnPrefs</span>      <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2823" data-line-number="2823"></td>
          <td id="LC2823">    <span>Dim</span> <span>lAlpnPref</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2824" data-line-number="2824"></td>
          <td id="LC2824">    <span>Dim</span> <span>lCompression</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L2825" data-line-number="2825"></td>
          <td id="LC2825">    <span>Dim</span> <span>cPrevRemoteExt</span>  <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2826" data-line-number="2826"></td>
          <td id="LC2826">    </td>
        </tr>
        <tr>
          <td id="L2827" data-line-number="2827"></td>
          <td id="LC2827">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L2828" data-line-number="2828"></td>
          <td id="LC2828">    <span>lExtType</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L2829" data-line-number="2829"></td>
          <td id="LC2829">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L2830" data-line-number="2830"></td>
          <td id="LC2830">        <span>Set</span> <span>cPrevRemoteExt</span> <span>=</span> <span>.RemoteExtensions</span></td>
        </tr>
        <tr>
          <td id="L2831" data-line-number="2831"></td>
          <td id="LC2831">        <span>Set</span> <span>.RemoteExtensions</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2832" data-line-number="2832"></td>
          <td id="LC2832">        <span>If</span> <span>Not</span> <span>pvAsn1DecodePrivateKey(.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2833" data-line-number="2833"></td>
          <td id="LC2833">            <span>GoTo</span> <span>UnsupportedCertificate</span></td>
        </tr>
        <tr>
          <td id="L2834" data-line-number="2834"></td>
          <td id="LC2834">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2835" data-line-number="2835"></td>
          <td id="LC2835">        <span>.ProtocolVersion</span> <span>=</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>Not</span> <span>.HelloRetryRequest,</span> <span>TLS_PROTOCOL_VERSION_TLS12,</span> <span>TLS_PROTOCOL_VERSION_TLS13)</span></td>
        </tr>
        <tr>
          <td id="L2836" data-line-number="2836"></td>
          <td id="LC2836">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>.RemoteProtocolVersion,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2837" data-line-number="2837"></td>
          <td id="LC2837">        <span>If</span> <span>.RemoteProtocolVersion</span> <span>&lt;</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2838" data-line-number="2838"></td>
          <td id="LC2838">            <span>GoTo</span> <span>UnsupportedProtocol</span></td>
        </tr>
        <tr>
          <td id="L2839" data-line-number="2839"></td>
          <td id="LC2839">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2840" data-line-number="2840"></td>
          <td id="LC2840">        <span>&#39;--- remote random</span></td>
        </tr>
        <tr>
          <td id="L2841" data-line-number="2841"></td>
          <td id="LC2841">        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>TLS_HELLO_RANDOM_SIZE</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2842" data-line-number="2842"></td>
          <td id="LC2842">            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2843" data-line-number="2843"></td>
          <td id="LC2843">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2844" data-line-number="2844"></td>
          <td id="LC2844">        <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteExchRandom,</span> <span>TLS_HELLO_RANDOM_SIZE</span></td>
        </tr>
        <tr>
          <td id="L2845" data-line-number="2845"></td>
          <td id="LC2845">        <span>&#39;--- session id</span></td>
        </tr>
        <tr>
          <td id="L2846" data-line-number="2846"></td>
          <td id="LC2846">        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2847" data-line-number="2847"></td>
          <td id="LC2847">            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2848" data-line-number="2848"></td>
          <td id="LC2848">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2849" data-line-number="2849"></td>
          <td id="LC2849">        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L2850" data-line-number="2850"></td>
          <td id="LC2850">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2851" data-line-number="2851"></td>
          <td id="LC2851">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2852" data-line-number="2852"></td>
          <td id="LC2852">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2853" data-line-number="2853"></td>
          <td id="LC2853">            <span>If</span> <span>lSize</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>lSize</span> <span>&lt;&gt;</span> <span>TLS_LEGACY_SESSIONID_SIZE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2854" data-line-number="2854"></td>
          <td id="LC2854">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2855" data-line-number="2855"></td>
          <td id="LC2855">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2856" data-line-number="2856"></td>
          <td id="LC2856">            <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteSessionID,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L2857" data-line-number="2857"></td>
          <td id="LC2857">        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2858" data-line-number="2858"></td>
          <td id="LC2858">        <span>&#39;--- ciphersuites</span></td>
        </tr>
        <tr>
          <td id="L2859" data-line-number="2859"></td>
          <td id="LC2859">        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2860" data-line-number="2860"></td>
          <td id="LC2860">            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2861" data-line-number="2861"></td>
          <td id="LC2861">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2862" data-line-number="2862"></td>
          <td id="LC2862">        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L2863" data-line-number="2863"></td>
          <td id="LC2863">            <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L2864" data-line-number="2864"></td>
          <td id="LC2864">            <span>If</span> <span>lEnd</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2865" data-line-number="2865"></td>
          <td id="LC2865">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2866" data-line-number="2866"></td>
          <td id="LC2866">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2867" data-line-number="2867"></td>
          <td id="LC2867">            <span>Set</span> <span>cCipherSuites</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2868" data-line-number="2868"></td>
          <td id="LC2868">            <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lEnd</span></td>
        </tr>
        <tr>
          <td id="L2869" data-line-number="2869"></td>
          <td id="LC2869">                <span>pvBufferReadLong</span> <span>uInput,</span> <span>lIdx,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2870" data-line-number="2870"></td>
          <td id="LC2870">                <span>If</span> <span>Not</span> <span>SearchCollection(cCipherSuites,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lIdx)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2871" data-line-number="2871"></td>
          <td id="LC2871">                    <span>cCipherSuites.Add</span> <span>lIdx,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lIdx</span></td>
        </tr>
        <tr>
          <td id="L2872" data-line-number="2872"></td>
          <td id="LC2872">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2873" data-line-number="2873"></td>
          <td id="LC2873">                <span>If</span> <span>lIdx</span> <span>=</span> <span>TLS_CS_EMPTY_RENEGOTIATION_INFO_SCSV</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2874" data-line-number="2874"></td>
          <td id="LC2874">                    <span>lIdx</span> <span>=</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO</span></td>
        </tr>
        <tr>
          <td id="L2875" data-line-number="2875"></td>
          <td id="LC2875">                    <span>&#39;--- 3.7, Server Behavior: Secure Renegotiation. When a ClientHello is received, the server MUST verify that it does not</span></td>
        </tr>
        <tr>
          <td id="L2876" data-line-number="2876"></td>
          <td id="LC2876">                    <span>&#39;---   contain the TLS_EMPTY_RENEGOTIATION_INFO_SCSV SCSV. If the SCSV is present, the server MUST abort the handshake.</span></td>
        </tr>
        <tr>
          <td id="L2877" data-line-number="2877"></td>
          <td id="LC2877">                    <span>If</span> <span>SearchCollection(cPrevRemoteExt,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lIdx)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2878" data-line-number="2878"></td>
          <td id="LC2878">                        <span>GoTo</span> <span>SecureRenegotiationFailed</span></td>
        </tr>
        <tr>
          <td id="L2879" data-line-number="2879"></td>
          <td id="LC2879">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2880" data-line-number="2880"></td>
          <td id="LC2880">                    <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lIdx)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2881" data-line-number="2881"></td>
          <td id="LC2881">                        <span>.RemoteExtensions.Add</span> <span>lIdx,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lIdx</span></td>
        </tr>
        <tr>
          <td id="L2882" data-line-number="2882"></td>
          <td id="LC2882">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2883" data-line-number="2883"></td>
          <td id="LC2883">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2884" data-line-number="2884"></td>
          <td id="LC2884">            <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2885" data-line-number="2885"></td>
          <td id="LC2885">            <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2886" data-line-number="2886"></td>
          <td id="LC2886">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2887" data-line-number="2887"></td>
          <td id="LC2887">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2888" data-line-number="2888"></td>
          <td id="LC2888">        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2889" data-line-number="2889"></td>
          <td id="LC2889">        <span>&#39;--- compression</span></td>
        </tr>
        <tr>
          <td id="L2890" data-line-number="2890"></td>
          <td id="LC2890">        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2891" data-line-number="2891"></td>
          <td id="LC2891">            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2892" data-line-number="2892"></td>
          <td id="LC2892">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2893" data-line-number="2893"></td>
          <td id="LC2893">        <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L2894" data-line-number="2894"></td>
          <td id="LC2894">            <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L2895" data-line-number="2895"></td>
          <td id="LC2895">            <span>If</span> <span>lEnd</span> <span>&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2896" data-line-number="2896"></td>
          <td id="LC2896">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2897" data-line-number="2897"></td>
          <td id="LC2897">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2898" data-line-number="2898"></td>
          <td id="LC2898">            <span>If</span> <span>uInput.Pos</span> <span>&lt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2899" data-line-number="2899"></td>
          <td id="LC2899">                <span>lIdx</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L2900" data-line-number="2900"></td>
          <td id="LC2900">                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>&lt;</span> <span>lEnd</span></td>
        </tr>
        <tr>
          <td id="L2901" data-line-number="2901"></td>
          <td id="LC2901">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lCompression</span></td>
        </tr>
        <tr>
          <td id="L2902" data-line-number="2902"></td>
          <td id="LC2902">                    <span>If</span> <span>lCompression</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2903" data-line-number="2903"></td>
          <td id="LC2903">                        <span>GoTo</span> <span>InvalidCompression</span></td>
        </tr>
        <tr>
          <td id="L2904" data-line-number="2904"></td>
          <td id="LC2904">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2905" data-line-number="2905"></td>
          <td id="LC2905">                    <span>If</span> <span>lCompression</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2906" data-line-number="2906"></td>
          <td id="LC2906">                        <span>lIdx</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L2907" data-line-number="2907"></td>
          <td id="LC2907">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2908" data-line-number="2908"></td>
          <td id="LC2908">                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2909" data-line-number="2909"></td>
          <td id="LC2909">                <span>If</span> <span>lIdx</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2910" data-line-number="2910"></td>
          <td id="LC2910">                    <span>GoTo</span> <span>InvalidCompression</span></td>
        </tr>
        <tr>
          <td id="L2911" data-line-number="2911"></td>
          <td id="LC2911">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2912" data-line-number="2912"></td>
          <td id="LC2912">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2913" data-line-number="2913"></td>
          <td id="LC2913">        <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2914" data-line-number="2914"></td>
          <td id="LC2914">        <span>&#39;--- extensions</span></td>
        </tr>
        <tr>
          <td id="L2915" data-line-number="2915"></td>
          <td id="LC2915">        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2916" data-line-number="2916"></td>
          <td id="LC2916">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L2917" data-line-number="2917"></td>
          <td id="LC2917">                <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L2918" data-line-number="2918"></td>
          <td id="LC2918">                <span>If</span> <span>lEnd</span> <span>&lt;&gt;</span> <span>lInputEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2919" data-line-number="2919"></td>
          <td id="LC2919">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2920" data-line-number="2920"></td>
          <td id="LC2920">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2921" data-line-number="2921"></td>
          <td id="LC2921">                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&lt;</span> <span>lEnd</span></td>
        </tr>
        <tr>
          <td id="L2922" data-line-number="2922"></td>
          <td id="LC2922">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExtType,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L2923" data-line-number="2923"></td>
          <td id="LC2923">                    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2924" data-line-number="2924"></td>
          <td id="LC2924"><span>&#39;                        DebugLog MODULE_NAME, FUNC_NAME, &#34;ClientHello &#34; &amp; pvTlsGetExtensionName(lExtType)</span></td>
        </tr>
        <tr>
          <td id="L2925" data-line-number="2925"></td>
          <td id="LC2925">                    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2926" data-line-number="2926"></td>
          <td id="LC2926">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2927" data-line-number="2927"></td>
          <td id="LC2927">                        <span>lExtEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L2928" data-line-number="2928"></td>
          <td id="LC2928">                        <span>If</span> <span>lExtEnd</span> <span>&gt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2929" data-line-number="2929"></td>
          <td id="LC2929">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2930" data-line-number="2930"></td>
          <td id="LC2930">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2931" data-line-number="2931"></td>
          <td id="LC2931">                        <span>Select</span> <span>Case</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L2932" data-line-number="2932"></td>
          <td id="LC2932">                        <span>Case</span> <span>TLS_EXTENSION_SERVER_NAME</span></td>
        </tr>
        <tr>
          <td id="L2933" data-line-number="2933"></td>
          <td id="LC2933">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2934" data-line-number="2934"></td>
          <td id="LC2934">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2935" data-line-number="2935"></td>
          <td id="LC2935">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2936" data-line-number="2936"></td>
          <td id="LC2936">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2937" data-line-number="2937"></td>
          <td id="LC2937">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2938" data-line-number="2938"></td>
          <td id="LC2938">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2939" data-line-number="2939"></td>
          <td id="LC2939">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2940" data-line-number="2940"></td>
          <td id="LC2940">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L2941" data-line-number="2941"></td>
          <td id="LC2941">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lNameType</span></td>
        </tr>
        <tr>
          <td id="L2942" data-line-number="2942"></td>
          <td id="LC2942">                                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2943" data-line-number="2943"></td>
          <td id="LC2943">                                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lNameSize</span> <span>&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lNameSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2944" data-line-number="2944"></td>
          <td id="LC2944">                                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2945" data-line-number="2945"></td>
          <td id="LC2945">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2946" data-line-number="2946"></td>
          <td id="LC2946">                                        <span>If</span> <span>lNameType</span> <span>=</span> <span>TLS_SERVER_NAME_TYPE_HOSTNAME</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2947" data-line-number="2947"></td>
          <td id="LC2947">                                            <span>If</span> <span>LenB(.SniRequested)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2948" data-line-number="2948"></td>
          <td id="LC2948">                                                <span>GoTo</span> <span>InvalidServerName</span></td>
        </tr>
        <tr>
          <td id="L2949" data-line-number="2949"></td>
          <td id="LC2949">                                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2950" data-line-number="2950"></td>
          <td id="LC2950">                                            <span>pvBufferReadString</span> <span>uInput,</span> <span>.SniRequested,</span> <span>lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2951" data-line-number="2951"></td>
          <td id="LC2951">                                            <span>If</span> <span>Not</span> <span>pvIsValidServerName(.SniRequested)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2952" data-line-number="2952"></td>
          <td id="LC2952">                                                <span>GoTo</span> <span>InvalidServerName</span></td>
        </tr>
        <tr>
          <td id="L2953" data-line-number="2953"></td>
          <td id="LC2953">                                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2954" data-line-number="2954"></td>
          <td id="LC2954">                                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L2955" data-line-number="2955"></td>
          <td id="LC2955">                                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lNameSize</span> <span>&#39;--- skip</span></td>
        </tr>
        <tr>
          <td id="L2956" data-line-number="2956"></td>
          <td id="LC2956">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2957" data-line-number="2957"></td>
          <td id="LC2957">                                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2958" data-line-number="2958"></td>
          <td id="LC2958">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2959" data-line-number="2959"></td>
          <td id="LC2959">                                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2960" data-line-number="2960"></td>
          <td id="LC2960">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2961" data-line-number="2961"></td>
          <td id="LC2961">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2962" data-line-number="2962"></td>
          <td id="LC2962">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2963" data-line-number="2963"></td>
          <td id="LC2963">                        <span>Case</span> <span>TLS_EXTENSION_ALPN</span></td>
        </tr>
        <tr>
          <td id="L2964" data-line-number="2964"></td>
          <td id="LC2964">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2965" data-line-number="2965"></td>
          <td id="LC2965">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2966" data-line-number="2966"></td>
          <td id="LC2966">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2967" data-line-number="2967"></td>
          <td id="LC2967">                            <span>Set</span> <span>cAlpnPrefs</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L2968" data-line-number="2968"></td>
          <td id="LC2968">                            <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>Split(.AlpnProtocols,</span> <span>&#34;|&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2969" data-line-number="2969"></td>
          <td id="LC2969">                                <span>cAlpnPrefs.Add</span> <span>cAlpnPrefs.Count,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>vElem</span></td>
        </tr>
        <tr>
          <td id="L2970" data-line-number="2970"></td>
          <td id="LC2970">                            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L2971" data-line-number="2971"></td>
          <td id="LC2971">                            <span>lAlpnPref</span> <span>=</span> <span>1000</span></td>
        </tr>
        <tr>
          <td id="L2972" data-line-number="2972"></td>
          <td id="LC2972">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L2973" data-line-number="2973"></td>
          <td id="LC2973">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2974" data-line-number="2974"></td>
          <td id="LC2974">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2975" data-line-number="2975"></td>
          <td id="LC2975">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2976" data-line-number="2976"></td>
          <td id="LC2976">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L2977" data-line-number="2977"></td>
          <td id="LC2977">                                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2978" data-line-number="2978"></td>
          <td id="LC2978">                                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lNameSize</span> <span>&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lNameSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2979" data-line-number="2979"></td>
          <td id="LC2979">                                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2980" data-line-number="2980"></td>
          <td id="LC2980">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2981" data-line-number="2981"></td>
          <td id="LC2981">                                        <span>pvBufferReadString</span> <span>uInput,</span> <span>sName,</span> <span>lNameSize</span></td>
        </tr>
        <tr>
          <td id="L2982" data-line-number="2982"></td>
          <td id="LC2982">                                        <span>If</span> <span>SearchCollection(cAlpnPrefs,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>sName,</span> <span>RetVal:=vElem)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2983" data-line-number="2983"></td>
          <td id="LC2983">                                            <span>If</span> <span>vElem</span> <span>&lt;</span> <span>lAlpnPref</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2984" data-line-number="2984"></td>
          <td id="LC2984">                                                <span>.AlpnNegotiated</span> <span>=</span> <span>sName</span></td>
        </tr>
        <tr>
          <td id="L2985" data-line-number="2985"></td>
          <td id="LC2985">                                                <span>lAlpnPref</span> <span>=</span> <span>vElem</span></td>
        </tr>
        <tr>
          <td id="L2986" data-line-number="2986"></td>
          <td id="LC2986">                                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2987" data-line-number="2987"></td>
          <td id="LC2987">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2988" data-line-number="2988"></td>
          <td id="LC2988">                                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2989" data-line-number="2989"></td>
          <td id="LC2989">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L2990" data-line-number="2990"></td>
          <td id="LC2990">                                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2991" data-line-number="2991"></td>
          <td id="LC2991">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L2992" data-line-number="2992"></td>
          <td id="LC2992">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2993" data-line-number="2993"></td>
          <td id="LC2993">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L2994" data-line-number="2994"></td>
          <td id="LC2994">                            <span>If</span> <span>LenB(.AlpnNegotiated)</span> <span>=</span> <span>0</span> <span>And</span> <span>cAlpnPrefs.Count</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2995" data-line-number="2995"></td>
          <td id="LC2995">                                <span>GoTo</span> <span>NoAlpnNegotiated</span></td>
        </tr>
        <tr>
          <td id="L2996" data-line-number="2996"></td>
          <td id="LC2996">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L2997" data-line-number="2997"></td>
          <td id="LC2997">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_KEY_SHARE,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L2998" data-line-number="2998"></td>
          <td id="LC2998">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L2999" data-line-number="2999"></td>
          <td id="LC2999">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3000" data-line-number="3000"></td>
          <td id="LC3000">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3001" data-line-number="3001"></td>
          <td id="LC3001">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3002" data-line-number="3002"></td>
          <td id="LC3002">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3003" data-line-number="3003"></td>
          <td id="LC3003">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3004" data-line-number="3004"></td>
          <td id="LC3004">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3005" data-line-number="3005"></td>
          <td id="LC3005">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3006" data-line-number="3006"></td>
          <td id="LC3006">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L3007" data-line-number="3007"></td>
          <td id="LC3007">                                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3008" data-line-number="3008"></td>
          <td id="LC3008">                                        <span>If</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3009" data-line-number="3009"></td>
          <td id="LC3009">                                            <span>GoTo</span> <span>InvalidRemoteKey</span></td>
        </tr>
        <tr>
          <td id="L3010" data-line-number="3010"></td>
          <td id="LC3010">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3011" data-line-number="3011"></td>
          <td id="LC3011">                                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3012" data-line-number="3012"></td>
          <td id="LC3012">                                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3013" data-line-number="3013"></td>
          <td id="LC3013">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3014" data-line-number="3014"></td>
          <td id="LC3014">                                        <span>If</span> <span>.HelloRetryRequest</span> <span>And</span> <span>lExchGroup</span> <span>&lt;&gt;</span> <span>.HelloRetryExchGroup</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3015" data-line-number="3015"></td>
          <td id="LC3015">                                            <span>lExchGroup</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3016" data-line-number="3016"></td>
          <td id="LC3016">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3017" data-line-number="3017"></td>
          <td id="LC3017">                                        <span>Select</span> <span>Case</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3018" data-line-number="3018"></td>
          <td id="LC3018">                                        <span>Case</span> <span>TLS_GROUP_X25519</span></td>
        </tr>
        <tr>
          <td id="L3019" data-line-number="3019"></td>
          <td id="LC3019">                                            <span>eExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchX25519</span></td>
        </tr>
        <tr>
          <td id="L3020" data-line-number="3020"></td>
          <td id="LC3020">                                        <span>Case</span> <span>TLS_GROUP_SECP256R1</span></td>
        </tr>
        <tr>
          <td id="L3021" data-line-number="3021"></td>
          <td id="LC3021">                                            <span>eExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchSecp256r1</span></td>
        </tr>
        <tr>
          <td id="L3022" data-line-number="3022"></td>
          <td id="LC3022">                                        <span>Case</span> <span>TLS_GROUP_SECP384R1</span></td>
        </tr>
        <tr>
          <td id="L3023" data-line-number="3023"></td>
          <td id="LC3023">                                            <span>eExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchSecp384r1</span></td>
        </tr>
        <tr>
          <td id="L3024" data-line-number="3024"></td>
          <td id="LC3024">                                        <span>Case</span> <span>TLS_GROUP_X448,</span> <span>TLS_GROUP_SECP521R1</span></td>
        </tr>
        <tr>
          <td id="L3025" data-line-number="3025"></td>
          <td id="LC3025">                                            <span>eExchAlgo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3026" data-line-number="3026"></td>
          <td id="LC3026">                                        <span>Case</span> <span>TLS_GROUP_FFDHE_FIRST</span> <span>To</span> <span>TLS_GROUP_FFDHE_LAST</span></td>
        </tr>
        <tr>
          <td id="L3027" data-line-number="3027"></td>
          <td id="LC3027">                                            <span>eExchAlgo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3028" data-line-number="3028"></td>
          <td id="LC3028">                                        <span>Case</span> <span>TLS_GROUP_FFDHE_PRIVATE_USE_FIRST</span> <span>To</span> <span>TLS_GROUP_FFDHE_PRIVATE_USE_LAST</span></td>
        </tr>
        <tr>
          <td id="L3029" data-line-number="3029"></td>
          <td id="LC3029">                                            <span>eExchAlgo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3030" data-line-number="3030"></td>
          <td id="LC3030">                                        <span>Case</span> <span>TLS_GROUP_ECDHE_PRIVATE_USE_FIRST</span> <span>To</span> <span>TLS_GROUP_ECDHE_PRIVATE_USE_LAST</span></td>
        </tr>
        <tr>
          <td id="L3031" data-line-number="3031"></td>
          <td id="LC3031">                                            <span>eExchAlgo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3032" data-line-number="3032"></td>
          <td id="LC3032">                                        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3033" data-line-number="3033"></td>
          <td id="LC3033">                                            <span>If</span> <span>(lExchGroup</span> <span>And</span> <span>&amp;HFF</span><span>)</span> <span>=</span> <span>lExchGroup</span> <span>\</span> <span>&amp;H100</span> <span>And</span> <span>(lExchGroup</span> <span>And</span> <span>&amp;HF</span><span>)</span> <span>=</span> <span>&amp;HA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3034" data-line-number="3034"></td>
          <td id="LC3034">                                                <span>eExchAlgo</span> <span>=</span> <span>0</span> <span>&#39;--- grease from RFC8701</span></td>
        </tr>
        <tr>
          <td id="L3035" data-line-number="3035"></td>
          <td id="LC3035">                                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3036" data-line-number="3036"></td>
          <td id="LC3036">                                                <span>GoTo</span> <span>UnsupportedExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3037" data-line-number="3037"></td>
          <td id="LC3037">                                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3038" data-line-number="3038"></td>
          <td id="LC3038">                                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3039" data-line-number="3039"></td>
          <td id="LC3039">                                        <span>Select</span> <span>Case</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3040" data-line-number="3040"></td>
          <td id="LC3040">                                        <span>Case</span> <span>eExchAlgo</span> <span>=</span> <span>0</span><span>,</span> <span>Not</span> <span>pvCryptoIsSupported(eExchAlgo)</span></td>
        </tr>
        <tr>
          <td id="L3041" data-line-number="3041"></td>
          <td id="LC3041">                                            <span>lExchGroup</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3042" data-line-number="3042"></td>
          <td id="LC3042">                                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3043" data-line-number="3043"></td>
          <td id="LC3043">                                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3044" data-line-number="3044"></td>
          <td id="LC3044">                                        <span>If</span> <span>lExchGroup</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3045" data-line-number="3045"></td>
          <td id="LC3045">                                            <span>pvTlsSetupExchGroup</span> <span>uCtx,</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3046" data-line-number="3046"></td>
          <td id="LC3046">                                            <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteExchPublic,</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3047" data-line-number="3047"></td>
          <td id="LC3047">                                            <span>If</span> <span>Not</span> <span>pvTlsCheckRemoteKey(.ExchGroup,</span> <span>.RemoteExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3048" data-line-number="3048"></td>
          <td id="LC3048">                                                <span>GoTo</span> <span>InvalidRemoteKey</span></td>
        </tr>
        <tr>
          <td id="L3049" data-line-number="3049"></td>
          <td id="LC3049">                                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3050" data-line-number="3050"></td>
          <td id="LC3050">                                            <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3051" data-line-number="3051"></td>
          <td id="LC3051">                                                <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;With exchange group &#34;</span> <span>&amp;</span> <span>pvTlsGetExchGroupName(.ExchGroup)</span></td>
        </tr>
        <tr>
          <td id="L3052" data-line-number="3052"></td>
          <td id="LC3052">                                            <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3053" data-line-number="3053"></td>
          <td id="LC3053">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3054" data-line-number="3054"></td>
          <td id="LC3054">                                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3055" data-line-number="3055"></td>
          <td id="LC3055">                                    <span>If</span> <span>lExchGroup</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3056" data-line-number="3056"></td>
          <td id="LC3056">                                        <span>uInput.Pos</span> <span>=</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3057" data-line-number="3057"></td>
          <td id="LC3057">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3058" data-line-number="3058"></td>
          <td id="LC3058">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3059" data-line-number="3059"></td>
          <td id="LC3059">                                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3060" data-line-number="3060"></td>
          <td id="LC3060">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3061" data-line-number="3061"></td>
          <td id="LC3061">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3062" data-line-number="3062"></td>
          <td id="LC3062">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3063" data-line-number="3063"></td>
          <td id="LC3063">                        <span>Case</span> <span>TLS_EXTENSION_SIGNATURE_ALGORITHMS</span></td>
        </tr>
        <tr>
          <td id="L3064" data-line-number="3064"></td>
          <td id="LC3064">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3065" data-line-number="3065"></td>
          <td id="LC3065">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3066" data-line-number="3066"></td>
          <td id="LC3066">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3067" data-line-number="3067"></td>
          <td id="LC3067">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3068" data-line-number="3068"></td>
          <td id="LC3068">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Or</span> <span>lBlockSize</span> <span>Mod</span> <span>2</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3069" data-line-number="3069"></td>
          <td id="LC3069">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3070" data-line-number="3070"></td>
          <td id="LC3070">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3071" data-line-number="3071"></td>
          <td id="LC3071">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3072" data-line-number="3072"></td>
          <td id="LC3072">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lSignatureScheme,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L3073" data-line-number="3073"></td>
          <td id="LC3073">                                    <span>If</span> <span>pvTlsMatchSignatureScheme(uCtx,</span> <span>lSignatureScheme,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3074" data-line-number="3074"></td>
          <td id="LC3074">                                        <span>.SignatureScheme</span> <span>=</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L3075" data-line-number="3075"></td>
          <td id="LC3075">                                        <span>uInput.Pos</span> <span>=</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3076" data-line-number="3076"></td>
          <td id="LC3076">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3077" data-line-number="3077"></td>
          <td id="LC3077">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3078" data-line-number="3078"></td>
          <td id="LC3078">                                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3079" data-line-number="3079"></td>
          <td id="LC3079">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3080" data-line-number="3080"></td>
          <td id="LC3080">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3081" data-line-number="3081"></td>
          <td id="LC3081">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3082" data-line-number="3082"></td>
          <td id="LC3082">                        <span>Case</span> <span>TLS_EXTENSION_SUPPORTED_GROUPS</span></td>
        </tr>
        <tr>
          <td id="L3083" data-line-number="3083"></td>
          <td id="LC3083">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3084" data-line-number="3084"></td>
          <td id="LC3084">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3085" data-line-number="3085"></td>
          <td id="LC3085">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3086" data-line-number="3086"></td>
          <td id="LC3086">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3087" data-line-number="3087"></td>
          <td id="LC3087">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Or</span> <span>lBlockSize</span> <span>Mod</span> <span>2</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3088" data-line-number="3088"></td>
          <td id="LC3088">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3089" data-line-number="3089"></td>
          <td id="LC3089">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3090" data-line-number="3090"></td>
          <td id="LC3090">                                <span>Set</span> <span>.RemoteSupportedGroups</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L3091" data-line-number="3091"></td>
          <td id="LC3091">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3092" data-line-number="3092"></td>
          <td id="LC3092">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExchGroup,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L3093" data-line-number="3093"></td>
          <td id="LC3093">                                    <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3094" data-line-number="3094"></td>
          <td id="LC3094">                                        <span>Select</span> <span>Case</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3095" data-line-number="3095"></td>
          <td id="LC3095">                                        <span>Case</span> <span>TLS_GROUP_SECP256R1</span> <span>To</span> <span>TLS_GROUP_SECP521R1,</span> <span>TLS_GROUP_X25519</span> <span>To</span> <span>TLS_GROUP_X448</span></td>
        </tr>
        <tr>
          <td id="L3096" data-line-number="3096"></td>
          <td id="LC3096">                                            <span>&#39;--- ecc curves</span></td>
        </tr>
        <tr>
          <td id="L3097" data-line-number="3097"></td>
          <td id="LC3097">                                        <span>Case</span> <span>TLS_GROUP_FFDHE_FIRST</span> <span>To</span> <span>TLS_GROUP_FFDHE_LAST</span></td>
        </tr>
        <tr>
          <td id="L3098" data-line-number="3098"></td>
          <td id="LC3098">                                            <span>&#39;--- ffdhe</span></td>
        </tr>
        <tr>
          <td id="L3099" data-line-number="3099"></td>
          <td id="LC3099">                                        <span>Case</span> <span>TLS_GROUP_FFDHE_PRIVATE_USE_FIRST</span> <span>To</span> <span>TLS_GROUP_FFDHE_PRIVATE_USE_LAST,</span> <span>TLS_GROUP_ECDHE_PRIVATE_USE_FIRST</span> <span>To</span> <span>TLS_GROUP_ECDHE_PRIVATE_USE_LAST</span></td>
        </tr>
        <tr>
          <td id="L3100" data-line-number="3100"></td>
          <td id="LC3100">                                            <span>&#39;--- private use</span></td>
        </tr>
        <tr>
          <td id="L3101" data-line-number="3101"></td>
          <td id="LC3101">                                        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3102" data-line-number="3102"></td>
          <td id="LC3102">                                            <span>If</span> <span>(lExchGroup</span> <span>And</span> <span>&amp;HFF</span><span>)</span> <span>=</span> <span>lExchGroup</span> <span>\</span> <span>&amp;H100</span> <span>And</span> <span>(lExchGroup</span> <span>And</span> <span>&amp;HF</span><span>)</span> <span>=</span> <span>&amp;HA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3103" data-line-number="3103"></td>
          <td id="LC3103">                                                <span>&#39;--- grease from RFC8701</span></td>
        </tr>
        <tr>
          <td id="L3104" data-line-number="3104"></td>
          <td id="LC3104">                                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3105" data-line-number="3105"></td>
          <td id="LC3105">                                                <span>GoTo</span> <span>UnsupportedExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3106" data-line-number="3106"></td>
          <td id="LC3106">                                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3107" data-line-number="3107"></td>
          <td id="LC3107">                                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3108" data-line-number="3108"></td>
          <td id="LC3108">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3109" data-line-number="3109"></td>
          <td id="LC3109">                                    <span>.RemoteSupportedGroups.Add</span> <span>lExchGroup,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3110" data-line-number="3110"></td>
          <td id="LC3110">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3111" data-line-number="3111"></td>
          <td id="LC3111">                                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3112" data-line-number="3112"></td>
          <td id="LC3112">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3113" data-line-number="3113"></td>
          <td id="LC3113">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3114" data-line-number="3114"></td>
          <td id="LC3114">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3115" data-line-number="3115"></td>
          <td id="LC3115">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_SUPPORTED_VERSIONS,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3116" data-line-number="3116"></td>
          <td id="LC3116">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3117" data-line-number="3117"></td>
          <td id="LC3117">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3118" data-line-number="3118"></td>
          <td id="LC3118">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3119" data-line-number="3119"></td>
          <td id="LC3119">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3120" data-line-number="3120"></td>
          <td id="LC3120">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Or</span> <span>lBlockSize</span> <span>Mod</span> <span>2</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3121" data-line-number="3121"></td>
          <td id="LC3121">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3122" data-line-number="3122"></td>
          <td id="LC3122">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3123" data-line-number="3123"></td>
          <td id="LC3123">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3124" data-line-number="3124"></td>
          <td id="LC3124">                                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lProtocolVersion,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L3125" data-line-number="3125"></td>
          <td id="LC3125">                                    <span>If</span> <span>lProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3126" data-line-number="3126"></td>
          <td id="LC3126">                                        <span>uInput.Pos</span> <span>=</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3127" data-line-number="3127"></td>
          <td id="LC3127">                                    <span>ElseIf</span> <span>lProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>And</span> <span>(.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3128" data-line-number="3128"></td>
          <td id="LC3128">                                        <span>uInput.Pos</span> <span>=</span> <span>lExtEnd</span></td>
        </tr>
        <tr>
          <td id="L3129" data-line-number="3129"></td>
          <td id="LC3129">                                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3130" data-line-number="3130"></td>
          <td id="LC3130">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3131" data-line-number="3131"></td>
          <td id="LC3131">                                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3132" data-line-number="3132"></td>
          <td id="LC3132">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3133" data-line-number="3133"></td>
          <td id="LC3133">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3134" data-line-number="3134"></td>
          <td id="LC3134">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3135" data-line-number="3135"></td>
          <td id="LC3135">                            <span>If</span> <span>lProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>And</span> <span>lProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3136" data-line-number="3136"></td>
          <td id="LC3136">                                <span>GoTo</span> <span>UnsupportedProtocol</span></td>
        </tr>
        <tr>
          <td id="L3137" data-line-number="3137"></td>
          <td id="LC3137">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3138" data-line-number="3138"></td>
          <td id="LC3138">                            <span>.ProtocolVersion</span> <span>=</span> <span>lProtocolVersion</span></td>
        </tr>
        <tr>
          <td id="L3139" data-line-number="3139"></td>
          <td id="LC3139">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3140" data-line-number="3140"></td>
          <td id="LC3140">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3141" data-line-number="3141"></td>
          <td id="LC3141">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3142" data-line-number="3142"></td>
          <td id="LC3142">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3143" data-line-number="3143"></td>
          <td id="LC3143">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3144" data-line-number="3144"></td>
          <td id="LC3144">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3145" data-line-number="3145"></td>
          <td id="LC3145">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3146" data-line-number="3146"></td>
          <td id="LC3146">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3147" data-line-number="3147"></td>
          <td id="LC3147">                                <span>pvBufferReadArray</span> <span>uInput,</span> <span>.RemoteLegacyRenegInfo,</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3148" data-line-number="3148"></td>
          <td id="LC3148">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3149" data-line-number="3149"></td>
          <td id="LC3149">                            <span>If</span> <span>lBlockSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3150" data-line-number="3150"></td>
          <td id="LC3150">                                <span>If</span> <span>Not</span> <span>pvArrayEqual(.RemoteLegacyRenegInfo,</span> <span>.RemoteLegacyVerifyData)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3151" data-line-number="3151"></td>
          <td id="LC3151">                                    <span>GoTo</span> <span>SecureRenegotiationFailed</span></td>
        </tr>
        <tr>
          <td id="L3152" data-line-number="3152"></td>
          <td id="LC3152">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3153" data-line-number="3153"></td>
          <td id="LC3153">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3154" data-line-number="3154"></td>
          <td id="LC3154">                        <span>Case</span> <span>IIf((.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>TLS_EXTENSION_EXTENDED_MASTER_SECRET,</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3155" data-line-number="3155"></td>
          <td id="LC3155">                            <span>If</span> <span>lExtSize</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3156" data-line-number="3156"></td>
          <td id="LC3156">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3157" data-line-number="3157"></td>
          <td id="LC3157">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3158" data-line-number="3158"></td>
          <td id="LC3158">                        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3159" data-line-number="3159"></td>
          <td id="LC3159">                            <span>If</span> <span>.HelloRetryRequest</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3160" data-line-number="3160"></td>
          <td id="LC3160">                                <span>If</span> <span>Not</span> <span>SearchCollection(cPrevRemoteExt,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExtType)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3161" data-line-number="3161"></td>
          <td id="LC3161">                                    <span>GoTo</span> <span>UnexpectedExtension</span></td>
        </tr>
        <tr>
          <td id="L3162" data-line-number="3162"></td>
          <td id="LC3162">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3163" data-line-number="3163"></td>
          <td id="LC3163">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3164" data-line-number="3164"></td>
          <td id="LC3164">                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L3165" data-line-number="3165"></td>
          <td id="LC3165">                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3166" data-line-number="3166"></td>
          <td id="LC3166">                        <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExtType)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3167" data-line-number="3167"></td>
          <td id="LC3167">                            <span>.RemoteExtensions.Add</span> <span>lExtType,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L3168" data-line-number="3168"></td>
          <td id="LC3168">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3169" data-line-number="3169"></td>
          <td id="LC3169">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3170" data-line-number="3170"></td>
          <td id="LC3170">                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3171" data-line-number="3171"></td>
          <td id="LC3171">                <span>If</span> <span>uInput.Pos</span> <span>&lt;&gt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3172" data-line-number="3172"></td>
          <td id="LC3172">                    <span>lExtType</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L3173" data-line-number="3173"></td>
          <td id="LC3173">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3174" data-line-number="3174"></td>
          <td id="LC3174">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3175" data-line-number="3175"></td>
          <td id="LC3175">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3176" data-line-number="3176"></td>
          <td id="LC3176">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3177" data-line-number="3177"></td>
          <td id="LC3177">        <span>&#39;--- match preferred ciphersuites</span></td>
        </tr>
        <tr>
          <td id="L3178" data-line-number="3178"></td>
          <td id="LC3178">        <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>pvTlsGetSortedCipherSuites(.LocalFeatures</span> <span>And</span> <span>IIf(.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13,</span> <span>ucsTlsSupportTls13,</span> <span>ucsTlsSupportTls12),</span> <span>uKeyInfo.AlgoObjId)</span></td>
        </tr>
        <tr>
          <td id="L3179" data-line-number="3179"></td>
          <td id="LC3179">            <span>If</span> <span>SearchCollection(cCipherSuites,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>vElem,</span> <span>RetVal:=vItem)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3180" data-line-number="3180"></td>
          <td id="LC3180">                <span>If</span> <span>Not</span> <span>.HelloRetryRequest</span> <span>Or</span> <span>.HelloRetryCipherSuite</span> <span>=</span> <span>vItem</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3181" data-line-number="3181"></td>
          <td id="LC3181">                    <span>lCipherSuite</span> <span>=</span> <span>vItem</span></td>
        </tr>
        <tr>
          <td id="L3182" data-line-number="3182"></td>
          <td id="LC3182">                    <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L3183" data-line-number="3183"></td>
          <td id="LC3183">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3184" data-line-number="3184"></td>
          <td id="LC3184">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3185" data-line-number="3185"></td>
          <td id="LC3185">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L3186" data-line-number="3186"></td>
          <td id="LC3186">        <span>If</span> <span>lCipherSuite</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3187" data-line-number="3187"></td>
          <td id="LC3187">            <span>GoTo</span> <span>NoCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3188" data-line-number="3188"></td>
          <td id="LC3188">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3189" data-line-number="3189"></td>
          <td id="LC3189">        <span>pvTlsSetupCipherSuite</span> <span>uCtx,</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3190" data-line-number="3190"></td>
          <td id="LC3190">        <span>If</span> <span>.SignatureScheme</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3191" data-line-number="3191"></td>
          <td id="LC3191">            <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3192" data-line-number="3192"></td>
          <td id="LC3192">                <span>GoTo</span> <span>NegotiateSignatureFailed</span></td>
        </tr>
        <tr>
          <td id="L3193" data-line-number="3193"></td>
          <td id="LC3193">            <span>ElseIf</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_SIGNATURE_ALGORITHMS_CERT)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3194" data-line-number="3194"></td>
          <td id="LC3194">                <span>GoTo</span> <span>NegotiateSignatureFailed</span></td>
        </tr>
        <tr>
          <td id="L3195" data-line-number="3195"></td>
          <td id="LC3195">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3196" data-line-number="3196"></td>
          <td id="LC3196">            <span>If</span> <span>pvTlsMatchSignatureScheme(uCtx,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3197" data-line-number="3197"></td>
          <td id="LC3197">                <span>.SignatureScheme</span> <span>=</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1</span></td>
        </tr>
        <tr>
          <td id="L3198" data-line-number="3198"></td>
          <td id="LC3198">            <span>ElseIf</span> <span>pvTlsMatchSignatureScheme(uCtx,</span> <span>TLS_SIGNATURE_ECDSA_SHA1,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3199" data-line-number="3199"></td>
          <td id="LC3199">                <span>.SignatureScheme</span> <span>=</span> <span>TLS_SIGNATURE_ECDSA_SHA1</span></td>
        </tr>
        <tr>
          <td id="L3200" data-line-number="3200"></td>
          <td id="LC3200">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3201" data-line-number="3201"></td>
          <td id="LC3201">                <span>GoTo</span> <span>NegotiateSignatureFailed</span></td>
        </tr>
        <tr>
          <td id="L3202" data-line-number="3202"></td>
          <td id="LC3202">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3203" data-line-number="3203"></td>
          <td id="LC3203">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3204" data-line-number="3204"></td>
          <td id="LC3204">        <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3205" data-line-number="3205"></td>
          <td id="LC3205">            <span>lExtType</span> <span>=</span> <span>TLS_EXTENSION_KEY_SHARE</span></td>
        </tr>
        <tr>
          <td id="L3206" data-line-number="3206"></td>
          <td id="LC3206">            <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>lExtType)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3207" data-line-number="3207"></td>
          <td id="LC3207">                <span>GoTo</span> <span>NoExtension</span></td>
        </tr>
        <tr>
          <td id="L3208" data-line-number="3208"></td>
          <td id="LC3208">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3209" data-line-number="3209"></td>
          <td id="LC3209">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3210" data-line-number="3210"></td>
          <td id="LC3210">            <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>Array(TLS_EXTENSION_EXTENDED_MASTER_SECRET,</span> <span>TLS_EXTENSION_ENCRYPT_THEN_MAC,</span> <span>TLS_EXTENSION_RENEGOTIATION_INFO)</span></td>
        </tr>
        <tr>
          <td id="L3211" data-line-number="3211"></td>
          <td id="LC3211">                <span>If</span> <span>SearchCollection(cPrevRemoteExt,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>vElem)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3212" data-line-number="3212"></td>
          <td id="LC3212">                    <span>If</span> <span>Not</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>vElem)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3213" data-line-number="3213"></td>
          <td id="LC3213">                        <span>GoTo</span> <span>NoExtension</span></td>
        </tr>
        <tr>
          <td id="L3214" data-line-number="3214"></td>
          <td id="LC3214">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3215" data-line-number="3215"></td>
          <td id="LC3215">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3216" data-line-number="3216"></td>
          <td id="LC3216">            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L3217" data-line-number="3217"></td>
          <td id="LC3217">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3218" data-line-number="3218"></td>
          <td id="LC3218">        <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3219" data-line-number="3219"></td>
          <td id="LC3219">            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Using &#34;</span> <span>&amp;</span> <span>pvTlsGetCipherSuiteName(.CipherSuite)</span> <span>&amp;</span> <span>&#34; from &#34;</span> <span>&amp;</span> <span>.RemoteHostName</span></td>
        </tr>
        <tr>
          <td id="L3220" data-line-number="3220"></td>
          <td id="LC3220">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3221" data-line-number="3221"></td>
          <td id="LC3221">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3222" data-line-number="3222"></td>
          <td id="LC3222">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L3223" data-line-number="3223"></td>
          <td id="LC3223">    <span>pvTlsParseHandshakeClientHello</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3224" data-line-number="3224"></td>
          <td id="LC3224"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L3225" data-line-number="3225"></td>
          <td id="LC3225">    <span>If</span> <span>uKeyInfo.hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3226" data-line-number="3226"></td>
          <td id="LC3226">        <span>Call</span> <span>CryptDestroyKey(uKeyInfo.hKey)</span></td>
        </tr>
        <tr>
          <td id="L3227" data-line-number="3227"></td>
          <td id="LC3227">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3228" data-line-number="3228"></td>
          <td id="LC3228">    <span>If</span> <span>uKeyInfo.hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3229" data-line-number="3229"></td>
          <td id="LC3229">        <span>Call</span> <span>CryptReleaseContext(uKeyInfo.hProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3230" data-line-number="3230"></td>
          <td id="LC3230">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3231" data-line-number="3231"></td>
          <td id="LC3231">    <span>If</span> <span>uKeyInfo.hNKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3232" data-line-number="3232"></td>
          <td id="LC3232">        <span>Call</span> <span>NCryptFreeObject(uKeyInfo.hNKey)</span></td>
        </tr>
        <tr>
          <td id="L3233" data-line-number="3233"></td>
          <td id="LC3233">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3234" data-line-number="3234"></td>
          <td id="LC3234">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3235" data-line-number="3235"></td>
          <td id="LC3235"><span>UnsupportedCertificate:</span></td>
        </tr>
        <tr>
          <td id="L3236" data-line-number="3236"></td>
          <td id="LC3236">    <span>sError</span> <span>=</span> <span>ERR_UNSUPPORTED_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L3237" data-line-number="3237"></td>
          <td id="LC3237">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L3238" data-line-number="3238"></td>
          <td id="LC3238">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3239" data-line-number="3239"></td>
          <td id="LC3239"><span>UnsupportedProtocol:</span></td>
        </tr>
        <tr>
          <td id="L3240" data-line-number="3240"></td>
          <td id="LC3240">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_PROTOCOL,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;&amp;H&#34;</span> <span>&amp;</span> <span>Hex$(uCtx.RemoteProtocolVersion))</span></td>
        </tr>
        <tr>
          <td id="L3241" data-line-number="3241"></td>
          <td id="LC3241">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertProtocolVersion</span></td>
        </tr>
        <tr>
          <td id="L3242" data-line-number="3242"></td>
          <td id="LC3242">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3243" data-line-number="3243"></td>
          <td id="LC3243"><span>NoCipherSuite:</span></td>
        </tr>
        <tr>
          <td id="L3244" data-line-number="3244"></td>
          <td id="LC3244">    <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>cCipherSuites</span></td>
        </tr>
        <tr>
          <td id="L3245" data-line-number="3245"></td>
          <td id="LC3245">        <span>sError</span> <span>=</span> <span>sError</span> <span>&amp;</span> <span>&#34;, &amp;H&#34;</span> <span>&amp;</span> <span>Hex$(vElem)</span></td>
        </tr>
        <tr>
          <td id="L3246" data-line-number="3246"></td>
          <td id="LC3246">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L3247" data-line-number="3247"></td>
          <td id="LC3247">    <span>sError</span> <span>=</span> <span>Replace(ERR_NO_SUPPORTED_CIPHER_SUITE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>Mid$(sError,</span> <span>3</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L3248" data-line-number="3248"></td>
          <td id="LC3248">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L3249" data-line-number="3249"></td>
          <td id="LC3249">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3250" data-line-number="3250"></td>
          <td id="LC3250"><span>InvalidSize:</span></td>
        </tr>
        <tr>
          <td id="L3251" data-line-number="3251"></td>
          <td id="LC3251">    <span>sError</span> <span>=</span> <span>IIf(lExtType</span> <span>&lt;</span> <span>0</span><span>,</span> <span>ERR_INVALID_SIZE,</span> <span>Replace(ERR_INVALID_SIZE_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType)))</span></td>
        </tr>
        <tr>
          <td id="L3252" data-line-number="3252"></td>
          <td id="LC3252">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertDecodeError</span></td>
        </tr>
        <tr>
          <td id="L3253" data-line-number="3253"></td>
          <td id="LC3253">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3254" data-line-number="3254"></td>
          <td id="LC3254"><span>InvalidRemoteKey:</span></td>
        </tr>
        <tr>
          <td id="L3255" data-line-number="3255"></td>
          <td id="LC3255">    <span>sError</span> <span>=</span> <span>ERR_INVALID_REMOTE_KEY</span></td>
        </tr>
        <tr>
          <td id="L3256" data-line-number="3256"></td>
          <td id="LC3256">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L3257" data-line-number="3257"></td>
          <td id="LC3257">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3258" data-line-number="3258"></td>
          <td id="LC3258"><span>NegotiateSignatureFailed:</span></td>
        </tr>
        <tr>
          <td id="L3259" data-line-number="3259"></td>
          <td id="LC3259">    <span>sError</span> <span>=</span> <span>ERR_NEGOTIATE_SIGNATURE_FAILED</span></td>
        </tr>
        <tr>
          <td id="L3260" data-line-number="3260"></td>
          <td id="LC3260">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L3261" data-line-number="3261"></td>
          <td id="LC3261">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3262" data-line-number="3262"></td>
          <td id="LC3262"><span>UnexpectedExtension:</span></td>
        </tr>
        <tr>
          <td id="L3263" data-line-number="3263"></td>
          <td id="LC3263">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNEXPECTED_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType))</span></td>
        </tr>
        <tr>
          <td id="L3264" data-line-number="3264"></td>
          <td id="LC3264">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L3265" data-line-number="3265"></td>
          <td id="LC3265">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3266" data-line-number="3266"></td>
          <td id="LC3266"><span>NoAlpnNegotiated:</span></td>
        </tr>
        <tr>
          <td id="L3267" data-line-number="3267"></td>
          <td id="LC3267">    <span>sError</span> <span>=</span> <span>ERR_NO_ALPN_NEGOTIATED</span></td>
        </tr>
        <tr>
          <td id="L3268" data-line-number="3268"></td>
          <td id="LC3268">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertNoApplicationProtocol</span></td>
        </tr>
        <tr>
          <td id="L3269" data-line-number="3269"></td>
          <td id="LC3269">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3270" data-line-number="3270"></td>
          <td id="LC3270"><span>UnsupportedExchGroup:</span></td>
        </tr>
        <tr>
          <td id="L3271" data-line-number="3271"></td>
          <td id="LC3271">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_EXCH_GROUP,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExchGroupName(lExchGroup))</span></td>
        </tr>
        <tr>
          <td id="L3272" data-line-number="3272"></td>
          <td id="LC3272">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L3273" data-line-number="3273"></td>
          <td id="LC3273">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3274" data-line-number="3274"></td>
          <td id="LC3274"><span>NoExtension:</span></td>
        </tr>
        <tr>
          <td id="L3275" data-line-number="3275"></td>
          <td id="LC3275">    <span>sError</span> <span>=</span> <span>Replace(ERR_NO_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType))</span></td>
        </tr>
        <tr>
          <td id="L3276" data-line-number="3276"></td>
          <td id="LC3276">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertMissingExtension</span></td>
        </tr>
        <tr>
          <td id="L3277" data-line-number="3277"></td>
          <td id="LC3277">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3278" data-line-number="3278"></td>
          <td id="LC3278"><span>InvalidCompression:</span></td>
        </tr>
        <tr>
          <td id="L3279" data-line-number="3279"></td>
          <td id="LC3279">    <span>sError</span> <span>=</span> <span>Replace(ERR_INVALID_COMPRESSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lCompression)</span></td>
        </tr>
        <tr>
          <td id="L3280" data-line-number="3280"></td>
          <td id="LC3280">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L3281" data-line-number="3281"></td>
          <td id="LC3281">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3282" data-line-number="3282"></td>
          <td id="LC3282"><span>InvalidServerName:</span></td>
        </tr>
        <tr>
          <td id="L3283" data-line-number="3283"></td>
          <td id="LC3283">    <span>sError</span> <span>=</span> <span>Replace(ERR_INVALID_SERVER_NAME,</span> <span>&#34;%1&#34;</span><span>,</span> <span>uCtx.SniRequested)</span></td>
        </tr>
        <tr>
          <td id="L3284" data-line-number="3284"></td>
          <td id="LC3284">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertIllegalParameter</span></td>
        </tr>
        <tr>
          <td id="L3285" data-line-number="3285"></td>
          <td id="LC3285">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3286" data-line-number="3286"></td>
          <td id="LC3286"><span>SecureRenegotiationFailed:</span></td>
        </tr>
        <tr>
          <td id="L3287" data-line-number="3287"></td>
          <td id="LC3287">    <span>sError</span> <span>=</span> <span>ERR_SECURE_RENEGOTIATION_FAILED</span></td>
        </tr>
        <tr>
          <td id="L3288" data-line-number="3288"></td>
          <td id="LC3288">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L3289" data-line-number="3289"></td>
          <td id="LC3289">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3290" data-line-number="3290"></td>
          <td id="LC3290"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L3291" data-line-number="3291"></td>
          <td id="LC3291">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L3292" data-line-number="3292"></td>
          <td id="LC3292">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L3293" data-line-number="3293"></td>
          <td id="LC3293">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3294" data-line-number="3294"></td>
          <td id="LC3294"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3295" data-line-number="3295"></td>
          <td id="LC3295">
</td>
        </tr>
        <tr>
          <td id="L3296" data-line-number="3296"></td>
          <td id="LC3296"><span>Private</span> <span>Function</span> <span>pvTlsParseHandshakeCertificateRequest(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3297" data-line-number="3297"></td>
          <td id="LC3297">    <span>Dim</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3298" data-line-number="3298"></td>
          <td id="LC3298">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3299" data-line-number="3299"></td>
          <td id="LC3299">    <span>Dim</span> <span>lEnd</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3300" data-line-number="3300"></td>
          <td id="LC3300">    <span>Dim</span> <span>lBlockSize</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3301" data-line-number="3301"></td>
          <td id="LC3301">    <span>Dim</span> <span>lBlockEnd</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3302" data-line-number="3302"></td>
          <td id="LC3302">    <span>Dim</span> <span>lExtType</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3303" data-line-number="3303"></td>
          <td id="LC3303">    <span>Dim</span> <span>lExtSize</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3304" data-line-number="3304"></td>
          <td id="LC3304">    <span>Dim</span> <span>lExtEnd</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3305" data-line-number="3305"></td>
          <td id="LC3305">    <span>Dim</span> <span>baDName()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L3306" data-line-number="3306"></td>
          <td id="LC3306">    <span>Dim</span> <span>lDnSize</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3307" data-line-number="3307"></td>
          <td id="LC3307">    <span>Dim</span> <span>uKeyInfo</span>        <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L3308" data-line-number="3308"></td>
          <td id="LC3308">    <span>Dim</span> <span>baSignatureSchemes()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L3309" data-line-number="3309"></td>
          <td id="LC3309">    <span>Dim</span> <span>lSigPos</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3310" data-line-number="3310"></td>
          <td id="LC3310">    <span>Dim</span> <span>oCallback</span>       <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L3311" data-line-number="3311"></td>
          <td id="LC3311">    <span>Dim</span> <span>bConfirmed</span>      <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3312" data-line-number="3312"></td>
          <td id="LC3312">    </td>
        </tr>
        <tr>
          <td id="L3313" data-line-number="3313"></td>
          <td id="LC3313">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L3314" data-line-number="3314"></td>
          <td id="LC3314">    <span>lExtType</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L3315" data-line-number="3315"></td>
          <td id="LC3315">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3316" data-line-number="3316"></td>
          <td id="LC3316">        <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3317" data-line-number="3317"></td>
          <td id="LC3317">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3318" data-line-number="3318"></td>
          <td id="LC3318">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3319" data-line-number="3319"></td>
          <td id="LC3319">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3320" data-line-number="3320"></td>
          <td id="LC3320">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>1</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L3321" data-line-number="3321"></td>
          <td id="LC3321">                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3322" data-line-number="3322"></td>
          <td id="LC3322">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3323" data-line-number="3323"></td>
          <td id="LC3323">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3324" data-line-number="3324"></td>
          <td id="LC3324">                <span>pvBufferReadArray</span> <span>uInput,</span> <span>.CertRequestContext,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L3325" data-line-number="3325"></td>
          <td id="LC3325">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3326" data-line-number="3326"></td>
          <td id="LC3326">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3327" data-line-number="3327"></td>
          <td id="LC3327">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3328" data-line-number="3328"></td>
          <td id="LC3328">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3329" data-line-number="3329"></td>
          <td id="LC3329">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L3330" data-line-number="3330"></td>
          <td id="LC3330">                <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L3331" data-line-number="3331"></td>
          <td id="LC3331">                <span>If</span> <span>lEnd</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3332" data-line-number="3332"></td>
          <td id="LC3332">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3333" data-line-number="3333"></td>
          <td id="LC3333">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3334" data-line-number="3334"></td>
          <td id="LC3334">                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>3</span> <span>&lt;</span> <span>lEnd</span></td>
        </tr>
        <tr>
          <td id="L3335" data-line-number="3335"></td>
          <td id="LC3335">                    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lExtType,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L3336" data-line-number="3336"></td>
          <td id="LC3336">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lExtSize</span></td>
        </tr>
        <tr>
          <td id="L3337" data-line-number="3337"></td>
          <td id="LC3337">                        <span>lExtEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L3338" data-line-number="3338"></td>
          <td id="LC3338">                        <span>If</span> <span>lExtEnd</span> <span>&gt;</span> <span>lEnd</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3339" data-line-number="3339"></td>
          <td id="LC3339">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3340" data-line-number="3340"></td>
          <td id="LC3340">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3341" data-line-number="3341"></td>
          <td id="LC3341">                        <span>Select</span> <span>Case</span> <span>lExtType</span></td>
        </tr>
        <tr>
          <td id="L3342" data-line-number="3342"></td>
          <td id="LC3342">                        <span>Case</span> <span>TLS_EXTENSION_SIGNATURE_ALGORITHMS</span></td>
        </tr>
        <tr>
          <td id="L3343" data-line-number="3343"></td>
          <td id="LC3343">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3344" data-line-number="3344"></td>
          <td id="LC3344">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3345" data-line-number="3345"></td>
          <td id="LC3345">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3346" data-line-number="3346"></td>
          <td id="LC3346">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3347" data-line-number="3347"></td>
          <td id="LC3347">                                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3348" data-line-number="3348"></td>
          <td id="LC3348">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3349" data-line-number="3349"></td>
          <td id="LC3349">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3350" data-line-number="3350"></td>
          <td id="LC3350">                                <span>pvBufferReadArray</span> <span>uInput,</span> <span>baSignatureSchemes,</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3351" data-line-number="3351"></td>
          <td id="LC3351">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3352" data-line-number="3352"></td>
          <td id="LC3352">                        <span>Case</span> <span>TLS_EXTENSION_CERTIFICATE_AUTHORITIES</span></td>
        </tr>
        <tr>
          <td id="L3353" data-line-number="3353"></td>
          <td id="LC3353">                            <span>If</span> <span>lExtSize</span> <span>&lt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3354" data-line-number="3354"></td>
          <td id="LC3354">                                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3355" data-line-number="3355"></td>
          <td id="LC3355">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3356" data-line-number="3356"></td>
          <td id="LC3356">                            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3357" data-line-number="3357"></td>
          <td id="LC3357">                                <span>lBlockEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lBlockSize</span></td>
        </tr>
        <tr>
          <td id="L3358" data-line-number="3358"></td>
          <td id="LC3358">                                <span>If</span> <span>lBlockEnd</span> <span>&lt;&gt;</span> <span>lExtEnd</span> <span>Or</span> <span>lBlockSize</span> <span>=</span> <span>0</span> <span>Or</span> <span>lBlockSize</span> <span>Mod</span> <span>2</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3359" data-line-number="3359"></td>
          <td id="LC3359">                                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3360" data-line-number="3360"></td>
          <td id="LC3360">                                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3361" data-line-number="3361"></td>
          <td id="LC3361">                                <span>Set</span> <span>.CertRequestCaDn</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L3362" data-line-number="3362"></td>
          <td id="LC3362">                                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lBlockEnd</span></td>
        </tr>
        <tr>
          <td id="L3363" data-line-number="3363"></td>
          <td id="LC3363">                                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lDnSize</span></td>
        </tr>
        <tr>
          <td id="L3364" data-line-number="3364"></td>
          <td id="LC3364">                                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lDnSize</span> <span>&gt;</span> <span>lBlockEnd</span> <span>Or</span> <span>lDnSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3365" data-line-number="3365"></td>
          <td id="LC3365">                                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3366" data-line-number="3366"></td>
          <td id="LC3366">                                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3367" data-line-number="3367"></td>
          <td id="LC3367">                                        <span>pvBufferReadArray</span> <span>uInput,</span> <span>baDName,</span> <span>lDnSize</span></td>
        </tr>
        <tr>
          <td id="L3368" data-line-number="3368"></td>
          <td id="LC3368">                                        <span>.CertRequestCaDn.Add</span> <span>baDName</span></td>
        </tr>
        <tr>
          <td id="L3369" data-line-number="3369"></td>
          <td id="LC3369">                                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3370" data-line-number="3370"></td>
          <td id="LC3370">                                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3371" data-line-number="3371"></td>
          <td id="LC3371">                            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3372" data-line-number="3372"></td>
          <td id="LC3372">                        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3373" data-line-number="3373"></td>
          <td id="LC3373">                            <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lExtSize</span></td>
        </tr>
        <tr>
          <td id="L3374" data-line-number="3374"></td>
          <td id="LC3374">                        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3375" data-line-number="3375"></td>
          <td id="LC3375">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3376" data-line-number="3376"></td>
          <td id="LC3376">                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3377" data-line-number="3377"></td>
          <td id="LC3377">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3378" data-line-number="3378"></td>
          <td id="LC3378">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3379" data-line-number="3379"></td>
          <td id="LC3379">        <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3380" data-line-number="3380"></td>
          <td id="LC3380">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3381" data-line-number="3381"></td>
          <td id="LC3381">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3382" data-line-number="3382"></td>
          <td id="LC3382">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3383" data-line-number="3383"></td>
          <td id="LC3383">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>1</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L3384" data-line-number="3384"></td>
          <td id="LC3384">                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3385" data-line-number="3385"></td>
          <td id="LC3385">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3386" data-line-number="3386"></td>
          <td id="LC3386">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3387" data-line-number="3387"></td>
          <td id="LC3387">                <span>uInput.Pos</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span> <span>&#39;--- skip certificate_types</span></td>
        </tr>
        <tr>
          <td id="L3388" data-line-number="3388"></td>
          <td id="LC3388">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3389" data-line-number="3389"></td>
          <td id="LC3389">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3390" data-line-number="3390"></td>
          <td id="LC3390">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3391" data-line-number="3391"></td>
          <td id="LC3391">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3392" data-line-number="3392"></td>
          <td id="LC3392">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L3393" data-line-number="3393"></td>
          <td id="LC3393">                <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span> <span>&gt;</span> <span>uInput.Size</span> <span>Or</span> <span>lSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3394" data-line-number="3394"></td>
          <td id="LC3394">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3395" data-line-number="3395"></td>
          <td id="LC3395">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3396" data-line-number="3396"></td>
          <td id="LC3396">                <span>pvBufferReadArray</span> <span>uInput,</span> <span>baSignatureSchemes,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L3397" data-line-number="3397"></td>
          <td id="LC3397">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3398" data-line-number="3398"></td>
          <td id="LC3398">            <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>2</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3399" data-line-number="3399"></td>
          <td id="LC3399">                <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3400" data-line-number="3400"></td>
          <td id="LC3400">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3401" data-line-number="3401"></td>
          <td id="LC3401">            <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lSize</span></td>
        </tr>
        <tr>
          <td id="L3402" data-line-number="3402"></td>
          <td id="LC3402">                <span>lEnd</span> <span>=</span> <span>uInput.Pos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L3403" data-line-number="3403"></td>
          <td id="LC3403">                <span>If</span> <span>lEnd</span> <span>&gt;</span> <span>uInput.Size</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3404" data-line-number="3404"></td>
          <td id="LC3404">                    <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3405" data-line-number="3405"></td>
          <td id="LC3405">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3406" data-line-number="3406"></td>
          <td id="LC3406">                <span>Set</span> <span>.CertRequestCaDn</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L3407" data-line-number="3407"></td>
          <td id="LC3407">                <span>Do</span> <span>While</span> <span>uInput.Pos</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lEnd</span></td>
        </tr>
        <tr>
          <td id="L3408" data-line-number="3408"></td>
          <td id="LC3408">                    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=</span><span>2</span><span>,</span> <span>BlockSize:=lDnSize</span></td>
        </tr>
        <tr>
          <td id="L3409" data-line-number="3409"></td>
          <td id="LC3409">                        <span>If</span> <span>uInput.Pos</span> <span>+</span> <span>lDnSize</span> <span>&gt;</span> <span>lEnd</span> <span>Or</span> <span>lDnSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3410" data-line-number="3410"></td>
          <td id="LC3410">                            <span>GoTo</span> <span>InvalidSize</span></td>
        </tr>
        <tr>
          <td id="L3411" data-line-number="3411"></td>
          <td id="LC3411">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3412" data-line-number="3412"></td>
          <td id="LC3412">                        <span>pvBufferReadArray</span> <span>uInput,</span> <span>baDName,</span> <span>lDnSize</span></td>
        </tr>
        <tr>
          <td id="L3413" data-line-number="3413"></td>
          <td id="LC3413">                        <span>.CertRequestCaDn.Add</span> <span>baDName</span></td>
        </tr>
        <tr>
          <td id="L3414" data-line-number="3414"></td>
          <td id="LC3414">                    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3415" data-line-number="3415"></td>
          <td id="LC3415">                <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3416" data-line-number="3416"></td>
          <td id="LC3416">            <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L3417" data-line-number="3417"></td>
          <td id="LC3417">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3418" data-line-number="3418"></td>
          <td id="LC3418">        <span>Do</span></td>
        </tr>
        <tr>
          <td id="L3419" data-line-number="3419"></td>
          <td id="LC3419">            <span>If</span> <span>Not</span> <span>pvAsn1DecodePrivateKey(.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3420" data-line-number="3420"></td>
          <td id="LC3420">                <span>GoTo</span> <span>UnsupportedPrivateKey</span></td>
        </tr>
        <tr>
          <td id="L3421" data-line-number="3421"></td>
          <td id="LC3421">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3422" data-line-number="3422"></td>
          <td id="LC3422">            <span>.CertRequestSignatureScheme</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L3423" data-line-number="3423"></td>
          <td id="LC3423">            <span>lSigPos</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3424" data-line-number="3424"></td>
          <td id="LC3424">            <span>Do</span> <span>While</span> <span>lSigPos</span> <span>&lt;</span> <span>pvArraySize(baSignatureSchemes)</span></td>
        </tr>
        <tr>
          <td id="L3425" data-line-number="3425"></td>
          <td id="LC3425">                <span>lSignatureScheme</span> <span>=</span> <span>baSignatureSchemes(lSigPos)</span> <span>*</span> <span>&amp;H100&amp;</span> <span>+</span> <span>baSignatureSchemes(lSigPos</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3426" data-line-number="3426"></td>
          <td id="LC3426">                <span>lSigPos</span> <span>=</span> <span>lSigPos</span> <span>+</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L3427" data-line-number="3427"></td>
          <td id="LC3427">                <span>If</span> <span>pvTlsMatchSignatureScheme(uCtx,</span> <span>lSignatureScheme,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3428" data-line-number="3428"></td>
          <td id="LC3428">                    <span>.CertRequestSignatureScheme</span> <span>=</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L3429" data-line-number="3429"></td>
          <td id="LC3429">                    <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L3430" data-line-number="3430"></td>
          <td id="LC3430">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3431" data-line-number="3431"></td>
          <td id="LC3431">            <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L3432" data-line-number="3432"></td>
          <td id="LC3432">            <span>bConfirmed</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L3433" data-line-number="3433"></td>
          <td id="LC3433">            <span>If</span> <span>.CertRequestSignatureScheme</span> <span>=</span> <span>-</span><span>1</span> <span>And</span> <span>.ClientCertCallback</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3434" data-line-number="3434"></td>
          <td id="LC3434">                <span>Call</span> <span>vbaObjSetAddref(oCallback,</span> <span>.ClientCertCallback)</span></td>
        </tr>
        <tr>
          <td id="L3435" data-line-number="3435"></td>
          <td id="LC3435">                <span>bConfirmed</span> <span>=</span> <span>oCallback.FireOnCertificate(.CertRequestCaDn)</span></td>
        </tr>
        <tr>
          <td id="L3436" data-line-number="3436"></td>
          <td id="LC3436">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3437" data-line-number="3437"></td>
          <td id="LC3437">        <span>Loop</span> <span>While</span> <span>bConfirmed</span></td>
        </tr>
        <tr>
          <td id="L3438" data-line-number="3438"></td>
          <td id="LC3438">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3439" data-line-number="3439"></td>
          <td id="LC3439">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L3440" data-line-number="3440"></td>
          <td id="LC3440">    <span>pvTlsParseHandshakeCertificateRequest</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3441" data-line-number="3441"></td>
          <td id="LC3441"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L3442" data-line-number="3442"></td>
          <td id="LC3442">    <span>If</span> <span>uKeyInfo.hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3443" data-line-number="3443"></td>
          <td id="LC3443">        <span>Call</span> <span>CryptDestroyKey(uKeyInfo.hKey)</span></td>
        </tr>
        <tr>
          <td id="L3444" data-line-number="3444"></td>
          <td id="LC3444">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3445" data-line-number="3445"></td>
          <td id="LC3445">    <span>If</span> <span>uKeyInfo.hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3446" data-line-number="3446"></td>
          <td id="LC3446">        <span>Call</span> <span>CryptReleaseContext(uKeyInfo.hProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3447" data-line-number="3447"></td>
          <td id="LC3447">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3448" data-line-number="3448"></td>
          <td id="LC3448">    <span>If</span> <span>uKeyInfo.hNKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3449" data-line-number="3449"></td>
          <td id="LC3449">        <span>Call</span> <span>NCryptFreeObject(uKeyInfo.hNKey)</span></td>
        </tr>
        <tr>
          <td id="L3450" data-line-number="3450"></td>
          <td id="LC3450">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3451" data-line-number="3451"></td>
          <td id="LC3451">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3452" data-line-number="3452"></td>
          <td id="LC3452"><span>UnsupportedPrivateKey:</span></td>
        </tr>
        <tr>
          <td id="L3453" data-line-number="3453"></td>
          <td id="LC3453">    <span>sError</span> <span>=</span> <span>ERR_UNSUPPORTED_PRIVATE_KEY</span></td>
        </tr>
        <tr>
          <td id="L3454" data-line-number="3454"></td>
          <td id="LC3454">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L3455" data-line-number="3455"></td>
          <td id="LC3455">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3456" data-line-number="3456"></td>
          <td id="LC3456"><span>InvalidSize:</span></td>
        </tr>
        <tr>
          <td id="L3457" data-line-number="3457"></td>
          <td id="LC3457">    <span>sError</span> <span>=</span> <span>IIf(lExtType</span> <span>&lt;</span> <span>0</span><span>,</span> <span>ERR_INVALID_SIZE,</span> <span>Replace(ERR_INVALID_SIZE_EXTENSION,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExtensionName(lExtType)))</span></td>
        </tr>
        <tr>
          <td id="L3458" data-line-number="3458"></td>
          <td id="LC3458">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertDecodeError</span></td>
        </tr>
        <tr>
          <td id="L3459" data-line-number="3459"></td>
          <td id="LC3459">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3460" data-line-number="3460"></td>
          <td id="LC3460"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L3461" data-line-number="3461"></td>
          <td id="LC3461">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L3462" data-line-number="3462"></td>
          <td id="LC3462">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L3463" data-line-number="3463"></td>
          <td id="LC3463">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3464" data-line-number="3464"></td>
          <td id="LC3464"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3465" data-line-number="3465"></td>
          <td id="LC3465">
</td>
        </tr>
        <tr>
          <td id="L3466" data-line-number="3466"></td>
          <td id="LC3466"><span>Private</span> <span>Function</span> <span>pvTlsMatchSignatureScheme(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>ByVal</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span><span>,</span> <span>uKeyInfo</span> <span>As</span> <span>UcsKeyInfo)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3467" data-line-number="3467"></td>
          <td id="LC3467">    <span>Dim</span> <span>bHasEnoughBits</span>  <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3468" data-line-number="3468"></td>
          <td id="LC3468">     </td>
        </tr>
        <tr>
          <td id="L3469" data-line-number="3469"></td>
          <td id="LC3469">    <span>Select</span> <span>Case</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L3470" data-line-number="3470"></td>
          <td id="LC3470">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3471" data-line-number="3471"></td>
          <td id="LC3471">            <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span></td>
        </tr>
        <tr>
          <td id="L3472" data-line-number="3472"></td>
          <td id="LC3472">        <span>&#39;--- PSS w/ SHA512 fails on short key lengths (min PSS size is 2 + lHashSize + lSaltSize where lSaltSize=lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L3473" data-line-number="3473"></td>
          <td id="LC3473">        <span>bHasEnoughBits</span> <span>=</span> <span>(uKeyInfo.BitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span> <span>&gt;</span> <span>2</span> <span>+</span> <span>2</span> <span>*</span> <span>pvTlsSignatureHashSize(lSignatureScheme)</span></td>
        </tr>
        <tr>
          <td id="L3474" data-line-number="3474"></td>
          <td id="LC3474">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3475" data-line-number="3475"></td>
          <td id="LC3475">    <span>Select</span> <span>Case</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L3476" data-line-number="3476"></td>
          <td id="LC3476">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1</span></td>
        </tr>
        <tr>
          <td id="L3477" data-line-number="3477"></td>
          <td id="LC3477">        <span>If</span> <span>(uCtx.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>uCtx.ProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3478" data-line-number="3478"></td>
          <td id="LC3478">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3479" data-line-number="3479"></td>
          <td id="LC3479">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoDigestSha1)</span></td>
        </tr>
        <tr>
          <td id="L3480" data-line-number="3480"></td>
          <td id="LC3480">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3481" data-line-number="3481"></td>
          <td id="LC3481">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3482" data-line-number="3482"></td>
          <td id="LC3482">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA224,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA256,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA384,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L3483" data-line-number="3483"></td>
          <td id="LC3483">        <span>If</span> <span>(uCtx.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>uCtx.ProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>And</span> <span>(uKeyInfo.hProv</span> <span>=</span> <span>0</span> <span>Or</span> <span>OsVersion</span> <span>&gt;=</span> <span>ucsOsvXp)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3484" data-line-number="3484"></td>
          <td id="LC3484">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3485" data-line-number="3485"></td>
          <td id="LC3485">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs)</span></td>
        </tr>
        <tr>
          <td id="L3486" data-line-number="3486"></td>
          <td id="LC3486">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3487" data-line-number="3487"></td>
          <td id="LC3487">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3488" data-line-number="3488"></td>
          <td id="LC3488">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512</span></td>
        </tr>
        <tr>
          <td id="L3489" data-line-number="3489"></td>
          <td id="LC3489">        <span>If</span> <span>bHasEnoughBits</span> <span>And</span> <span>uKeyInfo.hProv</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3490" data-line-number="3490"></td>
          <td id="LC3490">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3491" data-line-number="3491"></td>
          <td id="LC3491">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPss)</span></td>
        </tr>
        <tr>
          <td id="L3492" data-line-number="3492"></td>
          <td id="LC3492">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3493" data-line-number="3493"></td>
          <td id="LC3493">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3494" data-line-number="3494"></td>
          <td id="LC3494">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span></td>
        </tr>
        <tr>
          <td id="L3495" data-line-number="3495"></td>
          <td id="LC3495">        <span>If</span> <span>bHasEnoughBits</span> <span>And</span> <span>uKeyInfo.hProv</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3496" data-line-number="3496"></td>
          <td id="LC3496">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_SSA_PSS</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3497" data-line-number="3497"></td>
          <td id="LC3497">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoPaddingPss)</span></td>
        </tr>
        <tr>
          <td id="L3498" data-line-number="3498"></td>
          <td id="LC3498">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3499" data-line-number="3499"></td>
          <td id="LC3499">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3500" data-line-number="3500"></td>
          <td id="LC3500">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SHA1</span></td>
        </tr>
        <tr>
          <td id="L3501" data-line-number="3501"></td>
          <td id="LC3501">        <span>If</span> <span>(uCtx.LocalFeatures</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>uCtx.ProtocolVersion</span> <span>&lt;&gt;</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>And</span> <span>uKeyInfo.hProv</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3502" data-line-number="3502"></td>
          <td id="LC3502">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_PUBLIC_KEY</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3503" data-line-number="3503"></td>
          <td id="LC3503">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3504" data-line-number="3504"></td>
          <td id="LC3504">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P256</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3505" data-line-number="3505"></td>
          <td id="LC3505">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span></td>
        </tr>
        <tr>
          <td id="L3506" data-line-number="3506"></td>
          <td id="LC3506">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P384</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3507" data-line-number="3507"></td>
          <td id="LC3507">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</span></td>
        </tr>
        <tr>
          <td id="L3508" data-line-number="3508"></td>
          <td id="LC3508">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P521</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3509" data-line-number="3509"></td>
          <td id="LC3509">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp521r1)</span></td>
        </tr>
        <tr>
          <td id="L3510" data-line-number="3510"></td>
          <td id="LC3510">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3511" data-line-number="3511"></td>
          <td id="LC3511">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3512" data-line-number="3512"></td>
          <td id="LC3512">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256,</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384,</span> <span>TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L3513" data-line-number="3513"></td>
          <td id="LC3513">        <span>If</span> <span>uKeyInfo.hProv</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3514" data-line-number="3514"></td>
          <td id="LC3514">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_PUBLIC_KEY</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3515" data-line-number="3515"></td>
          <td id="LC3515">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3516" data-line-number="3516"></td>
          <td id="LC3516">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P256</span> <span>And</span> <span>lSignatureScheme</span> <span>=</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3517" data-line-number="3517"></td>
          <td id="LC3517">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</span></td>
        </tr>
        <tr>
          <td id="L3518" data-line-number="3518"></td>
          <td id="LC3518">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P384</span> <span>And</span> <span>lSignatureScheme</span> <span>=</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3519" data-line-number="3519"></td>
          <td id="LC3519">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</span></td>
        </tr>
        <tr>
          <td id="L3520" data-line-number="3520"></td>
          <td id="LC3520">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P521</span> <span>And</span> <span>lSignatureScheme</span> <span>=</span> <span>TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3521" data-line-number="3521"></td>
          <td id="LC3521">                <span>pvTlsMatchSignatureScheme</span> <span>=</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchSecp521r1)</span></td>
        </tr>
        <tr>
          <td id="L3522" data-line-number="3522"></td>
          <td id="LC3522">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3523" data-line-number="3523"></td>
          <td id="LC3523">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3524" data-line-number="3524"></td>
          <td id="LC3524">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3525" data-line-number="3525"></td>
          <td id="LC3525"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3526" data-line-number="3526"></td>
          <td id="LC3526">
</td>
        </tr>
        <tr>
          <td id="L3527" data-line-number="3527"></td>
          <td id="LC3527"><span>Private</span> <span>Function</span> <span>pvTlsCheckRemoteKey(</span><span>ByVal</span> <span>lExchGroup</span> <span>As</span> <span>Long</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3528" data-line-number="3528"></td>
          <td id="LC3528">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsCheckRemoteKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L3529" data-line-number="3529"></td>
          <td id="LC3529">    <span>Dim</span> <span>baCompr()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L3530" data-line-number="3530"></td>
          <td id="LC3530">    <span>Dim</span> <span>baUncompr()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L3531" data-line-number="3531"></td>
          <td id="LC3531">    </td>
        </tr>
        <tr>
          <td id="L3532" data-line-number="3532"></td>
          <td id="LC3532">    <span>Select</span> <span>Case</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3533" data-line-number="3533"></td>
          <td id="LC3533">    <span>Case</span> <span>TLS_GROUP_X25519</span></td>
        </tr>
        <tr>
          <td id="L3534" data-line-number="3534"></td>
          <td id="LC3534">        <span>If</span> <span>pvArraySize(baPublic)</span> <span>&lt;&gt;</span> <span>LNG_X25519_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3535" data-line-number="3535"></td>
          <td id="LC3535">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3536" data-line-number="3536"></td>
          <td id="LC3536">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3537" data-line-number="3537"></td>
          <td id="LC3537">        <span>&#39;--- check empty key share</span></td>
        </tr>
        <tr>
          <td id="L3538" data-line-number="3538"></td>
          <td id="LC3538">        <span>If</span> <span>pvArrayAccumulateOr(baPublic)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3539" data-line-number="3539"></td>
          <td id="LC3539">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3540" data-line-number="3540"></td>
          <td id="LC3540">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3541" data-line-number="3541"></td>
          <td id="LC3541">        <span>&#39;--- check key share of &#34;1&#34;</span></td>
        </tr>
        <tr>
          <td id="L3542" data-line-number="3542"></td>
          <td id="LC3542">        <span>If</span> <span>pvArrayAccumulateOr(baPublic,</span> <span>Pos:=</span><span>1</span><span>)</span> <span>=</span> <span>0</span> <span>And</span> <span>baPublic(</span><span>0</span><span>)</span> <span>=</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3543" data-line-number="3543"></td>
          <td id="LC3543">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3544" data-line-number="3544"></td>
          <td id="LC3544">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3545" data-line-number="3545"></td>
          <td id="LC3545">    <span>Case</span> <span>TLS_GROUP_SECP256R1</span></td>
        </tr>
        <tr>
          <td id="L3546" data-line-number="3546"></td>
          <td id="LC3546">        <span>If</span> <span>pvArraySize(baPublic)</span> <span>&lt;&gt;</span> <span>2</span> <span>*</span> <span>LNG_SECP256R1_KEYSZ</span> <span>+</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3547" data-line-number="3547"></td>
          <td id="LC3547">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3548" data-line-number="3548"></td>
          <td id="LC3548">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3549" data-line-number="3549"></td>
          <td id="LC3549">        <span>If</span> <span>baPublic(</span><span>0</span><span>)</span> <span>&lt;&gt;</span> <span>4</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3550" data-line-number="3550"></td>
          <td id="LC3550">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3551" data-line-number="3551"></td>
          <td id="LC3551">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3552" data-line-number="3552"></td>
          <td id="LC3552">        <span>pvArrayAllocate</span> <span>baCompr,</span> <span>1</span> <span>+</span> <span>LNG_SECP256R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baCompr&#34;</span></td>
        </tr>
        <tr>
          <td id="L3553" data-line-number="3553"></td>
          <td id="LC3553">        <span>baCompr(</span><span>0</span><span>)</span> <span>=</span> <span>2</span> <span>&#39;--- compressed positive</span></td>
        </tr>
        <tr>
          <td id="L3554" data-line-number="3554"></td>
          <td id="LC3554">        <span>Call</span> <span>CopyMemory(baCompr(</span><span>1</span><span>),</span> <span>baPublic(</span><span>1</span><span>),</span> <span>LNG_SECP256R1_KEYSZ)</span></td>
        </tr>
        <tr>
          <td id="L3555" data-line-number="3555"></td>
          <td id="LC3555">        <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp256r1UncompressKey(baUncompr,</span> <span>baCompr)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3556" data-line-number="3556"></td>
          <td id="LC3556">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3557" data-line-number="3557"></td>
          <td id="LC3557">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3558" data-line-number="3558"></td>
          <td id="LC3558">        <span>If</span> <span>Not</span> <span>pvArrayEqual(baUncompr,</span> <span>baPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3559" data-line-number="3559"></td>
          <td id="LC3559">            <span>baCompr(</span><span>0</span><span>)</span> <span>=</span> <span>3</span> <span>&#39;--- compressed negative</span></td>
        </tr>
        <tr>
          <td id="L3560" data-line-number="3560"></td>
          <td id="LC3560">            <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp256r1UncompressKey(baUncompr,</span> <span>baCompr)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3561" data-line-number="3561"></td>
          <td id="LC3561">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3562" data-line-number="3562"></td>
          <td id="LC3562">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3563" data-line-number="3563"></td>
          <td id="LC3563">            <span>If</span> <span>Not</span> <span>pvArrayEqual(baUncompr,</span> <span>baPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3564" data-line-number="3564"></td>
          <td id="LC3564">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3565" data-line-number="3565"></td>
          <td id="LC3565">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3566" data-line-number="3566"></td>
          <td id="LC3566">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3567" data-line-number="3567"></td>
          <td id="LC3567">    <span>Case</span> <span>TLS_GROUP_SECP384R1</span></td>
        </tr>
        <tr>
          <td id="L3568" data-line-number="3568"></td>
          <td id="LC3568">        <span>If</span> <span>pvArraySize(baPublic)</span> <span>&lt;&gt;</span> <span>2</span> <span>*</span> <span>LNG_SECP384R1_KEYSZ</span> <span>+</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3569" data-line-number="3569"></td>
          <td id="LC3569">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3570" data-line-number="3570"></td>
          <td id="LC3570">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3571" data-line-number="3571"></td>
          <td id="LC3571">        <span>If</span> <span>baPublic(</span><span>0</span><span>)</span> <span>&lt;&gt;</span> <span>4</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3572" data-line-number="3572"></td>
          <td id="LC3572">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3573" data-line-number="3573"></td>
          <td id="LC3573">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3574" data-line-number="3574"></td>
          <td id="LC3574">        <span>pvArrayAllocate</span> <span>baCompr,</span> <span>1</span> <span>+</span> <span>LNG_SECP384R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baCompr&#34;</span></td>
        </tr>
        <tr>
          <td id="L3575" data-line-number="3575"></td>
          <td id="LC3575">        <span>baCompr(</span><span>0</span><span>)</span> <span>=</span> <span>2</span> <span>&#39;--- compressed positive</span></td>
        </tr>
        <tr>
          <td id="L3576" data-line-number="3576"></td>
          <td id="LC3576">        <span>Call</span> <span>CopyMemory(baCompr(</span><span>1</span><span>),</span> <span>baPublic(</span><span>1</span><span>),</span> <span>LNG_SECP384R1_KEYSZ)</span></td>
        </tr>
        <tr>
          <td id="L3577" data-line-number="3577"></td>
          <td id="LC3577">        <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp384r1UncompressKey(baUncompr,</span> <span>baCompr)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3578" data-line-number="3578"></td>
          <td id="LC3578">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3579" data-line-number="3579"></td>
          <td id="LC3579">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3580" data-line-number="3580"></td>
          <td id="LC3580">        <span>If</span> <span>Not</span> <span>pvArrayEqual(baUncompr,</span> <span>baPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3581" data-line-number="3581"></td>
          <td id="LC3581">            <span>baCompr(</span><span>0</span><span>)</span> <span>=</span> <span>3</span> <span>&#39;--- compressed negative</span></td>
        </tr>
        <tr>
          <td id="L3582" data-line-number="3582"></td>
          <td id="LC3582">            <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp384r1UncompressKey(baUncompr,</span> <span>baCompr)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3583" data-line-number="3583"></td>
          <td id="LC3583">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3584" data-line-number="3584"></td>
          <td id="LC3584">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3585" data-line-number="3585"></td>
          <td id="LC3585">            <span>If</span> <span>Not</span> <span>pvArrayEqual(baUncompr,</span> <span>baPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3586" data-line-number="3586"></td>
          <td id="LC3586">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3587" data-line-number="3587"></td>
          <td id="LC3587">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3588" data-line-number="3588"></td>
          <td id="LC3588">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3589" data-line-number="3589"></td>
          <td id="LC3589">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3590" data-line-number="3590"></td>
          <td id="LC3590">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L3591" data-line-number="3591"></td>
          <td id="LC3591">    <span>pvTlsCheckRemoteKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3592" data-line-number="3592"></td>
          <td id="LC3592"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L3593" data-line-number="3593"></td>
          <td id="LC3593"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3594" data-line-number="3594"></td>
          <td id="LC3594">
</td>
        </tr>
        <tr>
          <td id="L3595" data-line-number="3595"></td>
          <td id="LC3595"><span>Private</span> <span>Sub</span> <span>pvTlsSetupExchGroup(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>ByVal</span> <span>lExchGroup</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3596" data-line-number="3596"></td>
          <td id="LC3596">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSetupExchGroup&#34;</span></td>
        </tr>
        <tr>
          <td id="L3597" data-line-number="3597"></td>
          <td id="LC3597">    </td>
        </tr>
        <tr>
          <td id="L3598" data-line-number="3598"></td>
          <td id="LC3598">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3599" data-line-number="3599"></td>
          <td id="LC3599">        <span>If</span> <span>.ExchGroup</span> <span>&lt;&gt;</span> <span>lExchGroup</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3600" data-line-number="3600"></td>
          <td id="LC3600">            <span>.ExchGroup</span> <span>=</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3601" data-line-number="3601"></td>
          <td id="LC3601">            <span>Select</span> <span>Case</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L3602" data-line-number="3602"></td>
          <td id="LC3602">            <span>Case</span> <span>TLS_GROUP_X25519</span></td>
        </tr>
        <tr>
          <td id="L3603" data-line-number="3603"></td>
          <td id="LC3603">                <span>.ExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchX25519</span></td>
        </tr>
        <tr>
          <td id="L3604" data-line-number="3604"></td>
          <td id="LC3604">                <span>If</span> <span>Not</span> <span>pvCryptoEcdhCurve25519MakeKey(.LocalExchPrivate,</span> <span>.LocalExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3605" data-line-number="3605"></td>
          <td id="LC3605">                    <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_GENER_KEYPAIR_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;Curve25519&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3606" data-line-number="3606"></td>
          <td id="LC3606">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3607" data-line-number="3607"></td>
          <td id="LC3607">            <span>Case</span> <span>TLS_GROUP_SECP256R1</span></td>
        </tr>
        <tr>
          <td id="L3608" data-line-number="3608"></td>
          <td id="LC3608">                <span>.ExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchSecp256r1</span></td>
        </tr>
        <tr>
          <td id="L3609" data-line-number="3609"></td>
          <td id="LC3609">                <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp256r1MakeKey(.LocalExchPrivate,</span> <span>.LocalExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3610" data-line-number="3610"></td>
          <td id="LC3610">                    <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_GENER_KEYPAIR_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;secp256r1&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3611" data-line-number="3611"></td>
          <td id="LC3611">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3612" data-line-number="3612"></td>
          <td id="LC3612">            <span>Case</span> <span>TLS_GROUP_SECP384R1</span></td>
        </tr>
        <tr>
          <td id="L3613" data-line-number="3613"></td>
          <td id="LC3613">                <span>.ExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchSecp384r1</span></td>
        </tr>
        <tr>
          <td id="L3614" data-line-number="3614"></td>
          <td id="LC3614">                <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp384r1MakeKey(.LocalExchPrivate,</span> <span>.LocalExchPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3615" data-line-number="3615"></td>
          <td id="LC3615">                    <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_GENER_KEYPAIR_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;secp384r1&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3616" data-line-number="3616"></td>
          <td id="LC3616">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3617" data-line-number="3617"></td>
          <td id="LC3617">            <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3618" data-line-number="3618"></td>
          <td id="LC3618">                <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_UNSUPPORTED_EXCH_GROUP,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetExchGroupName(.ExchGroup))</span></td>
        </tr>
        <tr>
          <td id="L3619" data-line-number="3619"></td>
          <td id="LC3619">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3620" data-line-number="3620"></td>
          <td id="LC3620">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3621" data-line-number="3621"></td>
          <td id="LC3621">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3622" data-line-number="3622"></td>
          <td id="LC3622"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L3623" data-line-number="3623"></td>
          <td id="LC3623">
</td>
        </tr>
        <tr>
          <td id="L3624" data-line-number="3624"></td>
          <td id="LC3624"><span>Private</span> <span>Sub</span> <span>pvTlsSetupExchRsaCertificate(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baCert()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3625" data-line-number="3625"></td>
          <td id="LC3625">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSetupExchRsaCertificate&#34;</span></td>
        </tr>
        <tr>
          <td id="L3626" data-line-number="3626"></td>
          <td id="LC3626">    <span>Dim</span> <span>uCertInfo</span>       <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L3627" data-line-number="3627"></td>
          <td id="LC3627">    <span>Dim</span> <span>baEnc()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L3628" data-line-number="3628"></td>
          <td id="LC3628">    </td>
        </tr>
        <tr>
          <td id="L3629" data-line-number="3629"></td>
          <td id="LC3629">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3630" data-line-number="3630"></td>
          <td id="LC3630">        <span>.ExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchCertificate</span></td>
        </tr>
        <tr>
          <td id="L3631" data-line-number="3631"></td>
          <td id="LC3631">        <span>pvTlsGetRandom</span> <span>.LocalExchPrivate,</span> <span>TLS_LEGACY_SECRET_SIZE</span></td>
        </tr>
        <tr>
          <td id="L3632" data-line-number="3632"></td>
          <td id="LC3632">        <span>Call</span> <span>CopyMemory(.LocalExchPrivate(</span><span>0</span><span>),</span> <span>TLS_LOCAL_LEGACY_VERSION,</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3633" data-line-number="3633"></td>
          <td id="LC3633">        <span>If</span> <span>Not</span> <span>pvAsn1DecodeCertificate(baCert,</span> <span>uCertInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3634" data-line-number="3634"></td>
          <td id="LC3634">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>ERR_UNSUPPORTED_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L3635" data-line-number="3635"></td>
          <td id="LC3635">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3636" data-line-number="3636"></td>
          <td id="LC3636">        <span>If</span> <span>Not</span> <span>pvCryptoEmePkcs1Encode(baEnc,</span> <span>.LocalExchPrivate,</span> <span>uCertInfo.BitLen)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3637" data-line-number="3637"></td>
          <td id="LC3637">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEmePkcs1Encode&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3638" data-line-number="3638"></td>
          <td id="LC3638">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3639" data-line-number="3639"></td>
          <td id="LC3639">        <span>If</span> <span>Not</span> <span>pvCryptoRsaModExp(baEnc,</span> <span>uCertInfo.PubExp,</span> <span>uCertInfo.Modulus,</span> <span>.LocalExchRsaEncrPriv)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3640" data-line-number="3640"></td>
          <td id="LC3640">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoRsaModExp&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3641" data-line-number="3641"></td>
          <td id="LC3641">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3642" data-line-number="3642"></td>
          <td id="LC3642">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3643" data-line-number="3643"></td>
          <td id="LC3643"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L3644" data-line-number="3644"></td>
          <td id="LC3644">
</td>
        </tr>
        <tr>
          <td id="L3645" data-line-number="3645"></td>
          <td id="LC3645"><span>Private</span> <span>Sub</span> <span>pvTlsSetupExchRsaPreMasterSecret(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baEnc()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3646" data-line-number="3646"></td>
          <td id="LC3646">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSetupExchRsaPreMasterSecret&#34;</span></td>
        </tr>
        <tr>
          <td id="L3647" data-line-number="3647"></td>
          <td id="LC3647">    <span>Dim</span> <span>uKeyInfo</span>        <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L3648" data-line-number="3648"></td>
          <td id="LC3648">    <span>Dim</span> <span>baDec()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L3649" data-line-number="3649"></td>
          <td id="LC3649">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3650" data-line-number="3650"></td>
          <td id="LC3650">    <span>Dim</span> <span>lVersion</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3651" data-line-number="3651"></td>
          <td id="LC3651">    <span>Dim</span> <span>hResult</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L3652" data-line-number="3652"></td>
          <td id="LC3652">    <span>Dim</span> <span>sErrDesc</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L3653" data-line-number="3653"></td>
          <td id="LC3653">    </td>
        </tr>
        <tr>
          <td id="L3654" data-line-number="3654"></td>
          <td id="LC3654">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3655" data-line-number="3655"></td>
          <td id="LC3655">        <span>.ExchAlgo</span> <span>=</span> <span>ucsTlsAlgoExchCertificate</span></td>
        </tr>
        <tr>
          <td id="L3656" data-line-number="3656"></td>
          <td id="LC3656">        <span>If</span> <span>Not</span> <span>pvAsn1DecodePrivateKey(.LocalCertificates,</span> <span>.LocalPrivateKey,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3657" data-line-number="3657"></td>
          <td id="LC3657">            <span>sErrDesc</span> <span>=</span> <span>ERR_UNSUPPORTED_PRIVATE_KEY</span></td>
        </tr>
        <tr>
          <td id="L3658" data-line-number="3658"></td>
          <td id="LC3658">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L3659" data-line-number="3659"></td>
          <td id="LC3659">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3660" data-line-number="3660"></td>
          <td id="LC3660">        <span>If</span> <span>uKeyInfo.hNKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3661" data-line-number="3661"></td>
          <td id="LC3661">            <span>hResult</span> <span>=</span> <span>NCryptDecrypt(uKeyInfo.hNKey,</span> <span>baEnc(</span><span>0</span><span>),</span> <span>UBound(baEnc)</span> <span>+</span> <span>1</span><span>,</span> <span>0</span><span>,</span> <span>ByVal</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>lSize,</span> <span>NCRYPT_PAD_PKCS1_FLAG)</span></td>
        </tr>
        <tr>
          <td id="L3662" data-line-number="3662"></td>
          <td id="LC3662">            <span>If</span> <span>hResult</span> <span>&lt;</span> <span>0</span> <span>Or</span> <span>lSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3663" data-line-number="3663"></td>
          <td id="LC3663">                <span>GoTo</span> <span>UseRandom</span></td>
        </tr>
        <tr>
          <td id="L3664" data-line-number="3664"></td>
          <td id="LC3664">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3665" data-line-number="3665"></td>
          <td id="LC3665">            <span>pvArrayAllocate</span> <span>baDec,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baDec&#34;</span></td>
        </tr>
        <tr>
          <td id="L3666" data-line-number="3666"></td>
          <td id="LC3666">            <span>hResult</span> <span>=</span> <span>NCryptDecrypt(uKeyInfo.hNKey,</span> <span>baEnc(</span><span>0</span><span>),</span> <span>UBound(baEnc)</span> <span>+</span> <span>1</span><span>,</span> <span>0</span><span>,</span> <span>baDec(</span><span>0</span><span>),</span> <span>lSize,</span> <span>lSize,</span> <span>NCRYPT_PAD_PKCS1_FLAG)</span></td>
        </tr>
        <tr>
          <td id="L3667" data-line-number="3667"></td>
          <td id="LC3667">            <span>If</span> <span>hResult</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3668" data-line-number="3668"></td>
          <td id="LC3668">                <span>GoTo</span> <span>UseRandom</span></td>
        </tr>
        <tr>
          <td id="L3669" data-line-number="3669"></td>
          <td id="LC3669">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3670" data-line-number="3670"></td>
          <td id="LC3670">            <span>pvArrayReallocate</span> <span>baDec,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baDec&#34;</span></td>
        </tr>
        <tr>
          <td id="L3671" data-line-number="3671"></td>
          <td id="LC3671">            <span>.LocalExchPrivate</span> <span>=</span> <span>baDec</span></td>
        </tr>
        <tr>
          <td id="L3672" data-line-number="3672"></td>
          <td id="LC3672">        <span>ElseIf</span> <span>uKeyInfo.hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>uKeyInfo.hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3673" data-line-number="3673"></td>
          <td id="LC3673">            <span>baDec</span> <span>=</span> <span>baEnc</span></td>
        </tr>
        <tr>
          <td id="L3674" data-line-number="3674"></td>
          <td id="LC3674">            <span>pvArrayReverse</span> <span>baDec</span></td>
        </tr>
        <tr>
          <td id="L3675" data-line-number="3675"></td>
          <td id="LC3675">            <span>lSize</span> <span>=</span> <span>UBound(baDec)</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L3676" data-line-number="3676"></td>
          <td id="LC3676">            <span>If</span> <span>CryptDecrypt(uKeyInfo.hKey,</span> <span>0</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>,</span> <span>baDec(</span><span>0</span><span>),</span> <span>lSize)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3677" data-line-number="3677"></td>
          <td id="LC3677">                <span>GoTo</span> <span>UseRandom</span></td>
        </tr>
        <tr>
          <td id="L3678" data-line-number="3678"></td>
          <td id="LC3678">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3679" data-line-number="3679"></td>
          <td id="LC3679">            <span>pvArrayReallocate</span> <span>baDec,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baDec&#34;</span></td>
        </tr>
        <tr>
          <td id="L3680" data-line-number="3680"></td>
          <td id="LC3680">            <span>.LocalExchPrivate</span> <span>=</span> <span>baDec</span></td>
        </tr>
        <tr>
          <td id="L3681" data-line-number="3681"></td>
          <td id="LC3681">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3682" data-line-number="3682"></td>
          <td id="LC3682">            <span>If</span> <span>Not</span> <span>pvCryptoRsaCrtModExp(baEnc,</span> <span>uKeyInfo.PrivExp,</span> <span>uKeyInfo.Modulus,</span> <span>uKeyInfo.Prime1,</span> <span>uKeyInfo.Prime2,</span> <span>uKeyInfo.Coefficient,</span> <span>baDec)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3683" data-line-number="3683"></td>
          <td id="LC3683">                <span>GoTo</span> <span>UseRandom</span></td>
        </tr>
        <tr>
          <td id="L3684" data-line-number="3684"></td>
          <td id="LC3684">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3685" data-line-number="3685"></td>
          <td id="LC3685">            <span>If</span> <span>Not</span> <span>pvCryptoEmePkcs1Decode(.LocalExchPrivate,</span> <span>baDec)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3686" data-line-number="3686"></td>
          <td id="LC3686">                <span>GoTo</span> <span>UseRandom</span></td>
        </tr>
        <tr>
          <td id="L3687" data-line-number="3687"></td>
          <td id="LC3687">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3688" data-line-number="3688"></td>
          <td id="LC3688">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3689" data-line-number="3689"></td>
          <td id="LC3689">        <span>If</span> <span>pvArraySize(.LocalExchPrivate)</span> <span>&lt;&gt;</span> <span>TLS_LEGACY_SECRET_SIZE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3690" data-line-number="3690"></td>
          <td id="LC3690">            <span>GoTo</span> <span>UseRandom</span></td>
        </tr>
        <tr>
          <td id="L3691" data-line-number="3691"></td>
          <td id="LC3691">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3692" data-line-number="3692"></td>
          <td id="LC3692">        <span>If</span> <span>pvArraySize(.LocalExchPrivate)</span> <span>&gt;=</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3693" data-line-number="3693"></td>
          <td id="LC3693">            <span>Call</span> <span>CopyMemory(lVersion,</span> <span>.LocalExchPrivate(</span><span>0</span><span>),</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3694" data-line-number="3694"></td>
          <td id="LC3694">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3695" data-line-number="3695"></td>
          <td id="LC3695">        <span>If</span> <span>lVersion</span> <span>&lt;&gt;</span> <span>.RemoteProtocolVersion</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3696" data-line-number="3696"></td>
          <td id="LC3696"><span>UseRandom:</span></td>
        </tr>
        <tr>
          <td id="L3697" data-line-number="3697"></td>
          <td id="LC3697">            <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3698" data-line-number="3698"></td>
          <td id="LC3698">                <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Will use random LocalExchPrivate&#34;</span></td>
        </tr>
        <tr>
          <td id="L3699" data-line-number="3699"></td>
          <td id="LC3699">            <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3700" data-line-number="3700"></td>
          <td id="LC3700">            <span>pvTlsGetRandom</span> <span>.LocalExchPrivate,</span> <span>TLS_LEGACY_SECRET_SIZE</span></td>
        </tr>
        <tr>
          <td id="L3701" data-line-number="3701"></td>
          <td id="LC3701">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3702" data-line-number="3702"></td>
          <td id="LC3702">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3703" data-line-number="3703"></td>
          <td id="LC3703"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L3704" data-line-number="3704"></td>
          <td id="LC3704">    <span>If</span> <span>uKeyInfo.hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3705" data-line-number="3705"></td>
          <td id="LC3705">        <span>Call</span> <span>CryptDestroyKey(uKeyInfo.hKey)</span></td>
        </tr>
        <tr>
          <td id="L3706" data-line-number="3706"></td>
          <td id="LC3706">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3707" data-line-number="3707"></td>
          <td id="LC3707">    <span>If</span> <span>uKeyInfo.hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3708" data-line-number="3708"></td>
          <td id="LC3708">        <span>Call</span> <span>CryptReleaseContext(uKeyInfo.hProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3709" data-line-number="3709"></td>
          <td id="LC3709">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3710" data-line-number="3710"></td>
          <td id="LC3710">    <span>If</span> <span>uKeyInfo.hNKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3711" data-line-number="3711"></td>
          <td id="LC3711">        <span>Call</span> <span>NCryptFreeObject(uKeyInfo.hNKey)</span></td>
        </tr>
        <tr>
          <td id="L3712" data-line-number="3712"></td>
          <td id="LC3712">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3713" data-line-number="3713"></td>
          <td id="LC3713">    <span>If</span> <span>LenB(sErrDesc)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3714" data-line-number="3714"></td>
          <td id="LC3714">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>sErrDesc</span></td>
        </tr>
        <tr>
          <td id="L3715" data-line-number="3715"></td>
          <td id="LC3715">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3716" data-line-number="3716"></td>
          <td id="LC3716"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L3717" data-line-number="3717"></td>
          <td id="LC3717">
</td>
        </tr>
        <tr>
          <td id="L3718" data-line-number="3718"></td>
          <td id="LC3718"><span>Private</span> <span>Sub</span> <span>pvTlsSetupCipherSuite(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>ByVal</span> <span>lCipherSuite</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3719" data-line-number="3719"></td>
          <td id="LC3719">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSetupCipherSuite&#34;</span></td>
        </tr>
        <tr>
          <td id="L3720" data-line-number="3720"></td>
          <td id="LC3720">    </td>
        </tr>
        <tr>
          <td id="L3721" data-line-number="3721"></td>
          <td id="LC3721">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3722" data-line-number="3722"></td>
          <td id="LC3722">        <span>If</span> <span>.CipherSuite</span> <span>&lt;&gt;</span> <span>lCipherSuite</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3723" data-line-number="3723"></td>
          <td id="LC3723">            <span>.CipherSuite</span> <span>=</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3724" data-line-number="3724"></td>
          <td id="LC3724">            <span>.BulkAlgo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3725" data-line-number="3725"></td>
          <td id="LC3725">            <span>.MacSize</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3726" data-line-number="3726"></td>
          <td id="LC3726">            <span>.KeySize</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3727" data-line-number="3727"></td>
          <td id="LC3727">            <span>.IvSize</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3728" data-line-number="3728"></td>
          <td id="LC3728">            <span>.IvExplicitSize</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3729" data-line-number="3729"></td>
          <td id="LC3729">            <span>.TagSize</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3730" data-line-number="3730"></td>
          <td id="LC3730">            <span>.DigestAlgo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3731" data-line-number="3731"></td>
          <td id="LC3731">            <span>.DigestSize</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3732" data-line-number="3732"></td>
          <td id="LC3732">            <span>.UseRsaKeyTransport</span> <span>=</span> <span>False</span></td>
        </tr>
        <tr>
          <td id="L3733" data-line-number="3733"></td>
          <td id="LC3733">            <span>Select</span> <span>Case</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3734" data-line-number="3734"></td>
          <td id="LC3734">            <span>Case</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256,</span> <span>TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3735" data-line-number="3735"></td>
          <td id="LC3735">                    <span>TLS_CS_AES_128_GCM_SHA256,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,</span> <span>TLS_CS_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3736" data-line-number="3736"></td>
          <td id="LC3736">                <span>.DigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L3737" data-line-number="3737"></td>
          <td id="LC3737">                <span>.DigestSize</span> <span>=</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L3738" data-line-number="3738"></td>
          <td id="LC3738">            <span>Case</span> <span>TLS_CS_AES_256_GCM_SHA384,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,</span> <span>TLS_CS_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3739" data-line-number="3739"></td>
          <td id="LC3739">                <span>.DigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L3740" data-line-number="3740"></td>
          <td id="LC3740">                <span>.DigestSize</span> <span>=</span> <span>LNG_SHA384_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L3741" data-line-number="3741"></td>
          <td id="LC3741">            <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3742" data-line-number="3742"></td>
          <td id="LC3742">                    <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA,</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3743" data-line-number="3743"></td>
          <td id="LC3743">                <span>.DigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L3744" data-line-number="3744"></td>
          <td id="LC3744">                <span>.DigestSize</span> <span>=</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L3745" data-line-number="3745"></td>
          <td id="LC3745">                <span>.MacAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L3746" data-line-number="3746"></td>
          <td id="LC3746">                <span>.MacSize</span> <span>=</span> <span>LNG_SHA1_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L3747" data-line-number="3747"></td>
          <td id="LC3747"><span>#</span><span>If</span> <span>ImplExoticCiphers</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3748" data-line-number="3748"></td>
          <td id="LC3748">            <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA256,</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3749" data-line-number="3749"></td>
          <td id="LC3749">                <span>.DigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L3750" data-line-number="3750"></td>
          <td id="LC3750">                <span>.DigestSize</span> <span>=</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L3751" data-line-number="3751"></td>
          <td id="LC3751">                <span>.MacAlgo</span> <span>=</span> <span>.DigestAlgo</span></td>
        </tr>
        <tr>
          <td id="L3752" data-line-number="3752"></td>
          <td id="LC3752">                <span>.MacSize</span> <span>=</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L3753" data-line-number="3753"></td>
          <td id="LC3753">            <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3754" data-line-number="3754"></td>
          <td id="LC3754">                <span>.DigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L3755" data-line-number="3755"></td>
          <td id="LC3755">                <span>.DigestSize</span> <span>=</span> <span>LNG_SHA384_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L3756" data-line-number="3756"></td>
          <td id="LC3756">                <span>.MacAlgo</span> <span>=</span> <span>.DigestAlgo</span></td>
        </tr>
        <tr>
          <td id="L3757" data-line-number="3757"></td>
          <td id="LC3757">                <span>.MacSize</span> <span>=</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L3758" data-line-number="3758"></td>
          <td id="LC3758"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3759" data-line-number="3759"></td>
          <td id="LC3759">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3760" data-line-number="3760"></td>
          <td id="LC3760">            <span>Select</span> <span>Case</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3761" data-line-number="3761"></td>
          <td id="LC3761">            <span>Case</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256,</span> <span>TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3762" data-line-number="3762"></td>
          <td id="LC3762">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkChacha20Poly1305</span></td>
        </tr>
        <tr>
          <td id="L3763" data-line-number="3763"></td>
          <td id="LC3763">                <span>.KeySize</span> <span>=</span> <span>LNG_CHACHA20_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3764" data-line-number="3764"></td>
          <td id="LC3764">                <span>.IvSize</span> <span>=</span> <span>LNG_CHACHA20POLY1305_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3765" data-line-number="3765"></td>
          <td id="LC3765">                <span>.TagSize</span> <span>=</span> <span>LNG_CHACHA20POLY1305_TAGSZ</span></td>
        </tr>
        <tr>
          <td id="L3766" data-line-number="3766"></td>
          <td id="LC3766">            <span>Case</span> <span>TLS_CS_AES_128_GCM_SHA256,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,</span> <span>TLS_CS_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3767" data-line-number="3767"></td>
          <td id="LC3767">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkAesGcm128</span></td>
        </tr>
        <tr>
          <td id="L3768" data-line-number="3768"></td>
          <td id="LC3768">                <span>.KeySize</span> <span>=</span> <span>LNG_AES128_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3769" data-line-number="3769"></td>
          <td id="LC3769">                <span>.IvSize</span> <span>=</span> <span>LNG_AESGCM_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3770" data-line-number="3770"></td>
          <td id="LC3770">                <span>If</span> <span>lCipherSuite</span> <span>&lt;&gt;</span> <span>TLS_CS_AES_128_GCM_SHA256</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3771" data-line-number="3771"></td>
          <td id="LC3771">                    <span>.IvExplicitSize</span> <span>=</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L3772" data-line-number="3772"></td>
          <td id="LC3772">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3773" data-line-number="3773"></td>
          <td id="LC3773">                <span>.TagSize</span> <span>=</span> <span>LNG_AESGCM_TAGSZ</span></td>
        </tr>
        <tr>
          <td id="L3774" data-line-number="3774"></td>
          <td id="LC3774">            <span>Case</span> <span>TLS_CS_AES_256_GCM_SHA384,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,</span> <span>TLS_CS_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3775" data-line-number="3775"></td>
          <td id="LC3775">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkAesGcm256</span></td>
        </tr>
        <tr>
          <td id="L3776" data-line-number="3776"></td>
          <td id="LC3776">                <span>.KeySize</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3777" data-line-number="3777"></td>
          <td id="LC3777">                <span>.IvSize</span> <span>=</span> <span>LNG_AESGCM_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3778" data-line-number="3778"></td>
          <td id="LC3778">                <span>If</span> <span>lCipherSuite</span> <span>&lt;&gt;</span> <span>TLS_CS_AES_256_GCM_SHA384</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3779" data-line-number="3779"></td>
          <td id="LC3779">                    <span>.IvExplicitSize</span> <span>=</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L3780" data-line-number="3780"></td>
          <td id="LC3780">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3781" data-line-number="3781"></td>
          <td id="LC3781">                <span>.TagSize</span> <span>=</span> <span>LNG_AESGCM_TAGSZ</span></td>
        </tr>
        <tr>
          <td id="L3782" data-line-number="3782"></td>
          <td id="LC3782">            <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA,</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3783" data-line-number="3783"></td>
          <td id="LC3783">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkAesCbc128</span></td>
        </tr>
        <tr>
          <td id="L3784" data-line-number="3784"></td>
          <td id="LC3784">                <span>.KeySize</span> <span>=</span> <span>LNG_AES128_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3785" data-line-number="3785"></td>
          <td id="LC3785">                <span>.IvSize</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3786" data-line-number="3786"></td>
          <td id="LC3786">                <span>.IvExplicitSize</span> <span>=</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L3787" data-line-number="3787"></td>
          <td id="LC3787">            <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA,</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3788" data-line-number="3788"></td>
          <td id="LC3788">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkAesCbc256</span></td>
        </tr>
        <tr>
          <td id="L3789" data-line-number="3789"></td>
          <td id="LC3789">                <span>.KeySize</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3790" data-line-number="3790"></td>
          <td id="LC3790">                <span>.IvSize</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3791" data-line-number="3791"></td>
          <td id="LC3791">                <span>.IvExplicitSize</span> <span>=</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L3792" data-line-number="3792"></td>
          <td id="LC3792"><span>#</span><span>If</span> <span>ImplExoticCiphers</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3793" data-line-number="3793"></td>
          <td id="LC3793">            <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3794" data-line-number="3794"></td>
          <td id="LC3794">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkAesCbc128</span></td>
        </tr>
        <tr>
          <td id="L3795" data-line-number="3795"></td>
          <td id="LC3795">                <span>.KeySize</span> <span>=</span> <span>LNG_AES128_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3796" data-line-number="3796"></td>
          <td id="LC3796">                <span>.IvSize</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3797" data-line-number="3797"></td>
          <td id="LC3797">                <span>.IvExplicitSize</span> <span>=</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L3798" data-line-number="3798"></td>
          <td id="LC3798">            <span>Case</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA256,</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3799" data-line-number="3799"></td>
          <td id="LC3799">                <span>.BulkAlgo</span> <span>=</span> <span>ucsTlsAlgoBulkAesCbc256</span></td>
        </tr>
        <tr>
          <td id="L3800" data-line-number="3800"></td>
          <td id="LC3800">                <span>.KeySize</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L3801" data-line-number="3801"></td>
          <td id="LC3801">                <span>.IvSize</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L3802" data-line-number="3802"></td>
          <td id="LC3802">                <span>.IvExplicitSize</span> <span>=</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L3803" data-line-number="3803"></td>
          <td id="LC3803"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3804" data-line-number="3804"></td>
          <td id="LC3804">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3805" data-line-number="3805"></td>
          <td id="LC3805">            <span>Select</span> <span>Case</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3806" data-line-number="3806"></td>
          <td id="LC3806">            <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA,</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3807" data-line-number="3807"></td>
          <td id="LC3807">                    <span>TLS_CS_RSA_WITH_AES_128_GCM_SHA256,</span> <span>TLS_CS_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3808" data-line-number="3808"></td>
          <td id="LC3808">                <span>.UseRsaKeyTransport</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3809" data-line-number="3809"></td>
          <td id="LC3809"><span>#</span><span>If</span> <span>ImplExoticCiphers</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3810" data-line-number="3810"></td>
          <td id="LC3810">            <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA256,</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3811" data-line-number="3811"></td>
          <td id="LC3811">                <span>.UseRsaKeyTransport</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L3812" data-line-number="3812"></td>
          <td id="LC3812"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3813" data-line-number="3813"></td>
          <td id="LC3813">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3814" data-line-number="3814"></td>
          <td id="LC3814">            <span>Select</span> <span>Case</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L3815" data-line-number="3815"></td>
          <td id="LC3815">            <span>Case</span> <span>TLS_CS_AES_128_GCM_SHA256,</span> <span>TLS_CS_AES_256_GCM_SHA384,</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3816" data-line-number="3816"></td>
          <td id="LC3816">                <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span></td>
        </tr>
        <tr>
          <td id="L3817" data-line-number="3817"></td>
          <td id="LC3817">            <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L3818" data-line-number="3818"></td>
          <td id="LC3818">            <span>If</span> <span>.BulkAlgo</span> <span>=</span> <span>0</span> <span>Or</span> <span>.DigestAlgo</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3819" data-line-number="3819"></td>
          <td id="LC3819">                <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_UNSUPPORTED_CIPHER_SUITE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetCipherSuiteName(.CipherSuite))</span></td>
        </tr>
        <tr>
          <td id="L3820" data-line-number="3820"></td>
          <td id="LC3820">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3821" data-line-number="3821"></td>
          <td id="LC3821">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3822" data-line-number="3822"></td>
          <td id="LC3822">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3823" data-line-number="3823"></td>
          <td id="LC3823"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L3824" data-line-number="3824"></td>
          <td id="LC3824">
</td>
        </tr>
        <tr>
          <td id="L3825" data-line-number="3825"></td>
          <td id="LC3825"><span>Private</span> <span>Function</span> <span>pvTlsGetSortedCipherSuites(</span><span>ByVal</span> <span>eFilter</span> <span>As</span> <span>UcsTlsLocalFeaturesEnum,</span> <span>Optional</span> <span>AlgoObjId</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L3826" data-line-number="3826"></td>
          <td id="LC3826">    <span>Const</span> <span>PREF</span>      <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1000</span></td>
        </tr>
        <tr>
          <td id="L3827" data-line-number="3827"></td>
          <td id="LC3827">    <span>Dim</span> <span>oRetVal</span>     <span>As</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L3828" data-line-number="3828"></td>
          <td id="LC3828">    <span>Dim</span> <span>bNeedEcdsa</span>  <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3829" data-line-number="3829"></td>
          <td id="LC3829">    <span>Dim</span> <span>bNeedRsa</span>    <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L3830" data-line-number="3830"></td>
          <td id="LC3830">    </td>
        </tr>
        <tr>
          <td id="L3831" data-line-number="3831"></td>
          <td id="LC3831">    <span>Set</span> <span>oRetVal</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L3832" data-line-number="3832"></td>
          <td id="LC3832">    <span>If</span> <span>(eFilter</span> <span>And</span> <span>ucsTlsSupportTls13)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3833" data-line-number="3833"></td>
          <td id="LC3833">        <span>&#39;--- first if AES preferred over Chacha20</span></td>
        </tr>
        <tr>
          <td id="L3834" data-line-number="3834"></td>
          <td id="LC3834">        <span>If</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm128)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3835" data-line-number="3835"></td>
          <td id="LC3835">            <span>oRetVal.Add</span> <span>TLS_CS_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3836" data-line-number="3836"></td>
          <td id="LC3836">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3837" data-line-number="3837"></td>
          <td id="LC3837">        <span>If</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm256)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3838" data-line-number="3838"></td>
          <td id="LC3838">            <span>oRetVal.Add</span> <span>TLS_CS_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3839" data-line-number="3839"></td>
          <td id="LC3839">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3840" data-line-number="3840"></td>
          <td id="LC3840">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkChacha20Poly1305)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3841" data-line-number="3841"></td>
          <td id="LC3841">            <span>oRetVal.Add</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3842" data-line-number="3842"></td>
          <td id="LC3842">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3843" data-line-number="3843"></td>
          <td id="LC3843">        <span>&#39;--- least preferred AES</span></td>
        </tr>
        <tr>
          <td id="L3844" data-line-number="3844"></td>
          <td id="LC3844">        <span>If</span> <span>Not</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm128)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3845" data-line-number="3845"></td>
          <td id="LC3845">            <span>oRetVal.Add</span> <span>TLS_CS_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3846" data-line-number="3846"></td>
          <td id="LC3846">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3847" data-line-number="3847"></td>
          <td id="LC3847">        <span>If</span> <span>Not</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm256)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3848" data-line-number="3848"></td>
          <td id="LC3848">            <span>oRetVal.Add</span> <span>TLS_CS_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3849" data-line-number="3849"></td>
          <td id="LC3849">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3850" data-line-number="3850"></td>
          <td id="LC3850">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3851" data-line-number="3851"></td>
          <td id="LC3851">    <span>If</span> <span>(eFilter</span> <span>And</span> <span>ucsTlsSupportTls12)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3852" data-line-number="3852"></td>
          <td id="LC3852">        <span>bNeedEcdsa</span> <span>=</span> <span>(AlgoObjId</span> <span>=</span> <span>szOID_ECC_PUBLIC_KEY</span> <span>Or</span> <span>AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P256</span> <span>Or</span> <span>AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P384</span> <span>Or</span> <span>AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P521</span> <span>Or</span> <span>LenB(AlgoObjId)</span> <span>=</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3853" data-line-number="3853"></td>
          <td id="LC3853">        <span>bNeedRsa</span> <span>=</span> <span>(AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Or</span> <span>AlgoObjId</span> <span>=</span> <span>szOID_RSA_SSA_PSS</span> <span>Or</span> <span>LenB(AlgoObjId)</span> <span>=</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3854" data-line-number="3854"></td>
          <td id="LC3854">        <span>&#39;--- first if AES preferred over Chacha20</span></td>
        </tr>
        <tr>
          <td id="L3855" data-line-number="3855"></td>
          <td id="LC3855">        <span>If</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm128)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3856" data-line-number="3856"></td>
          <td id="LC3856">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3857" data-line-number="3857"></td>
          <td id="LC3857">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3858" data-line-number="3858"></td>
          <td id="LC3858">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3859" data-line-number="3859"></td>
          <td id="LC3859">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3860" data-line-number="3860"></td>
          <td id="LC3860">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3861" data-line-number="3861"></td>
          <td id="LC3861">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3862" data-line-number="3862"></td>
          <td id="LC3862">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3863" data-line-number="3863"></td>
          <td id="LC3863">        <span>If</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm256)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3864" data-line-number="3864"></td>
          <td id="LC3864">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3865" data-line-number="3865"></td>
          <td id="LC3865">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3866" data-line-number="3866"></td>
          <td id="LC3866">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3867" data-line-number="3867"></td>
          <td id="LC3867">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3868" data-line-number="3868"></td>
          <td id="LC3868">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3869" data-line-number="3869"></td>
          <td id="LC3869">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3870" data-line-number="3870"></td>
          <td id="LC3870">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3871" data-line-number="3871"></td>
          <td id="LC3871">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkChacha20Poly1305)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3872" data-line-number="3872"></td>
          <td id="LC3872">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3873" data-line-number="3873"></td>
          <td id="LC3873">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3874" data-line-number="3874"></td>
          <td id="LC3874">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3875" data-line-number="3875"></td>
          <td id="LC3875">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3876" data-line-number="3876"></td>
          <td id="LC3876">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3877" data-line-number="3877"></td>
          <td id="LC3877">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3878" data-line-number="3878"></td>
          <td id="LC3878">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3879" data-line-number="3879"></td>
          <td id="LC3879">        <span>&#39;--- least preferred AES</span></td>
        </tr>
        <tr>
          <td id="L3880" data-line-number="3880"></td>
          <td id="LC3880">        <span>If</span> <span>Not</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm128)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3881" data-line-number="3881"></td>
          <td id="LC3881">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3882" data-line-number="3882"></td>
          <td id="LC3882">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3883" data-line-number="3883"></td>
          <td id="LC3883">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3884" data-line-number="3884"></td>
          <td id="LC3884">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3885" data-line-number="3885"></td>
          <td id="LC3885">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3886" data-line-number="3886"></td>
          <td id="LC3886">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3887" data-line-number="3887"></td>
          <td id="LC3887">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3888" data-line-number="3888"></td>
          <td id="LC3888">        <span>If</span> <span>Not</span> <span>pvCryptoIsSupported(PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm256)</span> <span>And</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3889" data-line-number="3889"></td>
          <td id="LC3889">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3890" data-line-number="3890"></td>
          <td id="LC3890">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3891" data-line-number="3891"></td>
          <td id="LC3891">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3892" data-line-number="3892"></td>
          <td id="LC3892">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3893" data-line-number="3893"></td>
          <td id="LC3893">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3894" data-line-number="3894"></td>
          <td id="LC3894">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3895" data-line-number="3895"></td>
          <td id="LC3895">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3896" data-line-number="3896"></td>
          <td id="LC3896">        <span>&#39;--- legacy AES in CBC mode</span></td>
        </tr>
        <tr>
          <td id="L3897" data-line-number="3897"></td>
          <td id="LC3897"><span>#</span><span>If</span> <span>ImplExoticCiphers</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3898" data-line-number="3898"></td>
          <td id="LC3898">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3899" data-line-number="3899"></td>
          <td id="LC3899">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3900" data-line-number="3900"></td>
          <td id="LC3900">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3901" data-line-number="3901"></td>
          <td id="LC3901">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3902" data-line-number="3902"></td>
          <td id="LC3902">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3903" data-line-number="3903"></td>
          <td id="LC3903">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3904" data-line-number="3904"></td>
          <td id="LC3904">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3905" data-line-number="3905"></td>
          <td id="LC3905">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3906" data-line-number="3906"></td>
          <td id="LC3906">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3907" data-line-number="3907"></td>
          <td id="LC3907">            <span>If</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3908" data-line-number="3908"></td>
          <td id="LC3908">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3909" data-line-number="3909"></td>
          <td id="LC3909">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3910" data-line-number="3910"></td>
          <td id="LC3910">            <span>If</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3911" data-line-number="3911"></td>
          <td id="LC3911">                <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3912" data-line-number="3912"></td>
          <td id="LC3912">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3913" data-line-number="3913"></td>
          <td id="LC3913">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3914" data-line-number="3914"></td>
          <td id="LC3914"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3915" data-line-number="3915"></td>
          <td id="LC3915">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128)</span> <span>And</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3916" data-line-number="3916"></td>
          <td id="LC3916">            <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3917" data-line-number="3917"></td>
          <td id="LC3917">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3918" data-line-number="3918"></td>
          <td id="LC3918">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128)</span> <span>And</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3919" data-line-number="3919"></td>
          <td id="LC3919">            <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3920" data-line-number="3920"></td>
          <td id="LC3920">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3921" data-line-number="3921"></td>
          <td id="LC3921">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256)</span> <span>And</span> <span>bNeedEcdsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3922" data-line-number="3922"></td>
          <td id="LC3922">            <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3923" data-line-number="3923"></td>
          <td id="LC3923">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3924" data-line-number="3924"></td>
          <td id="LC3924">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256)</span> <span>And</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3925" data-line-number="3925"></td>
          <td id="LC3925">            <span>oRetVal.Add</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3926" data-line-number="3926"></td>
          <td id="LC3926">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3927" data-line-number="3927"></td>
          <td id="LC3927">        <span>&#39;--- no perfect forward secrecy -&gt; least preferred</span></td>
        </tr>
        <tr>
          <td id="L3928" data-line-number="3928"></td>
          <td id="LC3928">        <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoExchCertificate)</span> <span>And</span> <span>bNeedRsa</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3929" data-line-number="3929"></td>
          <td id="LC3929">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3930" data-line-number="3930"></td>
          <td id="LC3930">                <span>oRetVal.Add</span> <span>TLS_CS_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3931" data-line-number="3931"></td>
          <td id="LC3931">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3932" data-line-number="3932"></td>
          <td id="LC3932">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3933" data-line-number="3933"></td>
          <td id="LC3933">                <span>oRetVal.Add</span> <span>TLS_CS_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L3934" data-line-number="3934"></td>
          <td id="LC3934">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3935" data-line-number="3935"></td>
          <td id="LC3935"><span>#</span><span>If</span> <span>ImplExoticCiphers</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3936" data-line-number="3936"></td>
          <td id="LC3936">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3937" data-line-number="3937"></td>
          <td id="LC3937">                <span>oRetVal.Add</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3938" data-line-number="3938"></td>
          <td id="LC3938">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3939" data-line-number="3939"></td>
          <td id="LC3939">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3940" data-line-number="3940"></td>
          <td id="LC3940">                <span>oRetVal.Add</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L3941" data-line-number="3941"></td>
          <td id="LC3941">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3942" data-line-number="3942"></td>
          <td id="LC3942"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3943" data-line-number="3943"></td>
          <td id="LC3943">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3944" data-line-number="3944"></td>
          <td id="LC3944">                <span>oRetVal.Add</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3945" data-line-number="3945"></td>
          <td id="LC3945">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3946" data-line-number="3946"></td>
          <td id="LC3946">            <span>If</span> <span>pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3947" data-line-number="3947"></td>
          <td id="LC3947">                <span>oRetVal.Add</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L3948" data-line-number="3948"></td>
          <td id="LC3948">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3949" data-line-number="3949"></td>
          <td id="LC3949">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3950" data-line-number="3950"></td>
          <td id="LC3950">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3951" data-line-number="3951"></td>
          <td id="LC3951">    <span>Set</span> <span>pvTlsGetSortedCipherSuites</span> <span>=</span> <span>oRetVal</span></td>
        </tr>
        <tr>
          <td id="L3952" data-line-number="3952"></td>
          <td id="LC3952"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L3953" data-line-number="3953"></td>
          <td id="LC3953">
</td>
        </tr>
        <tr>
          <td id="L3954" data-line-number="3954"></td>
          <td id="LC3954"><span>Private</span> <span>Sub</span> <span>pvTlsClearLastError(uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L3955" data-line-number="3955"></td>
          <td id="LC3955">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3956" data-line-number="3956"></td>
          <td id="LC3956">        <span>.LastErrNumber</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3957" data-line-number="3957"></td>
          <td id="LC3957">        <span>.LastErrSource</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L3958" data-line-number="3958"></td>
          <td id="LC3958">        <span>.LastError</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L3959" data-line-number="3959"></td>
          <td id="LC3959">        <span>.LastAlertCode</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L3960" data-line-number="3960"></td>
          <td id="LC3960">        <span>Set</span> <span>.BlocksStack</span> <span>=</span> <span>Nothing</span></td>
        </tr>
        <tr>
          <td id="L3961" data-line-number="3961"></td>
          <td id="LC3961">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3962" data-line-number="3962"></td>
          <td id="LC3962"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L3963" data-line-number="3963"></td>
          <td id="LC3963">
</td>
        </tr>
        <tr>
          <td id="L3964" data-line-number="3964"></td>
          <td id="LC3964"><span>Private</span> <span>Sub</span> <span>pvTlsSetLastError(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3965" data-line-number="3965"></td>
          <td id="LC3965">            <span>uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3966" data-line-number="3966"></td>
          <td id="LC3966">            <span>Optional</span> <span>ByVal</span> <span>ErrNumber</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3967" data-line-number="3967"></td>
          <td id="LC3967">            <span>Optional</span> <span>ErrSource</span> <span>As</span> <span>String</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3968" data-line-number="3968"></td>
          <td id="LC3968">            <span>Optional</span> <span>ErrDescription</span> <span>As</span> <span>String</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L3969" data-line-number="3969"></td>
          <td id="LC3969">            <span>Optional</span> <span>ByVal</span> <span>AlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum</span> <span>=</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L3970" data-line-number="3970"></td>
          <td id="LC3970">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSetLastError&#34;</span></td>
        </tr>
        <tr>
          <td id="L3971" data-line-number="3971"></td>
          <td id="LC3971">    </td>
        </tr>
        <tr>
          <td id="L3972" data-line-number="3972"></td>
          <td id="LC3972">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L3973" data-line-number="3973"></td>
          <td id="LC3973">        <span>.LastErrNumber</span> <span>=</span> <span>ErrNumber</span></td>
        </tr>
        <tr>
          <td id="L3974" data-line-number="3974"></td>
          <td id="LC3974">        <span>.LastErrSource</span> <span>=</span> <span>ErrSource</span></td>
        </tr>
        <tr>
          <td id="L3975" data-line-number="3975"></td>
          <td id="LC3975">        <span>.LastError</span> <span>=</span> <span>ErrDescription</span></td>
        </tr>
        <tr>
          <td id="L3976" data-line-number="3976"></td>
          <td id="LC3976">        <span>.LastAlertCode</span> <span>=</span> <span>AlertCode</span></td>
        </tr>
        <tr>
          <td id="L3977" data-line-number="3977"></td>
          <td id="LC3977">        <span>If</span> <span>LenB(ErrDescription)</span> <span>=</span> <span>0</span> <span>And</span> <span>AlertCode</span> <span>=</span> <span>-</span><span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3978" data-line-number="3978"></td>
          <td id="LC3978">            <span>Set</span> <span>.BlocksStack</span> <span>=</span> <span>Nothing</span></td>
        </tr>
        <tr>
          <td id="L3979" data-line-number="3979"></td>
          <td id="LC3979">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L3980" data-line-number="3980"></td>
          <td id="LC3980">            <span>If</span> <span>AlertCode</span> <span>&gt;=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3981" data-line-number="3981"></td>
          <td id="LC3981">                <span>pvTlsBuildAlert</span> <span>uCtx,</span> <span>.SendBuffer,</span> <span>AlertCode,</span> <span>TLS_ALERT_LEVEL_FATAL</span></td>
        </tr>
        <tr>
          <td id="L3982" data-line-number="3982"></td>
          <td id="LC3982">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3983" data-line-number="3983"></td>
          <td id="LC3983">            <span>.State</span> <span>=</span> <span>ucsTlsStateClosed</span></td>
        </tr>
        <tr>
          <td id="L3984" data-line-number="3984"></td>
          <td id="LC3984">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3985" data-line-number="3985"></td>
          <td id="LC3985">        <span>#</span><span>If</span> <span>ImplCaptureTraffic</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3986" data-line-number="3986"></td>
          <td id="LC3986">            <span>Clipboard.Clear</span></td>
        </tr>
        <tr>
          <td id="L3987" data-line-number="3987"></td>
          <td id="LC3987">            <span>Clipboard.SetText</span> <span>TlsConcatCollection(.TrafficDump,</span> <span>vbCrLf)</span></td>
        </tr>
        <tr>
          <td id="L3988" data-line-number="3988"></td>
          <td id="LC3988">            <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L3989" data-line-number="3989"></td>
          <td id="LC3989">                <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Traffic dump copied to clipboard&#34;</span></td>
        </tr>
        <tr>
          <td id="L3990" data-line-number="3990"></td>
          <td id="LC3990">            <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3991" data-line-number="3991"></td>
          <td id="LC3991">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L3992" data-line-number="3992"></td>
          <td id="LC3992">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L3993" data-line-number="3993"></td>
          <td id="LC3993"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L3994" data-line-number="3994"></td>
          <td id="LC3994">
</td>
        </tr>
        <tr>
          <td id="L3995" data-line-number="3995"></td>
          <td id="LC3995"><span>&#39;= HMAC-based key derivation functions ===================================</span></td>
        </tr>
        <tr>
          <td id="L3996" data-line-number="3996"></td>
          <td id="LC3996">
</td>
        </tr>
        <tr>
          <td id="L3997" data-line-number="3997"></td>
          <td id="LC3997"><span>Private</span> <span>Sub</span> <span>pvTlsDeriveHandshakeSecrets(uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L3998" data-line-number="3998"></td>
          <td id="LC3998">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsDeriveHandshakeSecrets&#34;</span></td>
        </tr>
        <tr>
          <td id="L3999" data-line-number="3999"></td>
          <td id="LC3999">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4000" data-line-number="4000"></td>
          <td id="LC4000">    <span>Dim</span> <span>baEarlySecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4001" data-line-number="4001"></td>
          <td id="LC4001">    <span>Dim</span> <span>baEmptyHash()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4002" data-line-number="4002"></td>
          <td id="LC4002">    <span>Dim</span> <span>baDerivedSecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4003" data-line-number="4003"></td>
          <td id="LC4003">    <span>Dim</span> <span>baSharedSecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4004" data-line-number="4004"></td>
          <td id="LC4004">    <span>Dim</span> <span>baEmpty()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4005" data-line-number="4005"></td>
          <td id="LC4005">    <span>Dim</span> <span>baZeroes()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4006" data-line-number="4006"></td>
          <td id="LC4006">    </td>
        </tr>
        <tr>
          <td id="L4007" data-line-number="4007"></td>
          <td id="LC4007">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4008" data-line-number="4008"></td>
          <td id="LC4008">        <span>If</span> <span>.HandshakeMessages.Size</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4009" data-line-number="4009"></td>
          <td id="LC4009">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>ERR_NO_HANDSHAKE_MESSAGES</span></td>
        </tr>
        <tr>
          <td id="L4010" data-line-number="4010"></td>
          <td id="LC4010">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4011" data-line-number="4011"></td>
          <td id="LC4011">        <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L4012" data-line-number="4012"></td>
          <td id="LC4012">        <span>pvArrayAllocate</span> <span>baZeroes,</span> <span>.DigestSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baZeroes&#34;</span></td>
        </tr>
        <tr>
          <td id="L4013" data-line-number="4013"></td>
          <td id="LC4013">        <span>pvTlsHkdfExtract</span> <span>baEarlySecret,</span> <span>.DigestAlgo,</span> <span>baZeroes,</span> <span>baZeroes</span></td>
        </tr>
        <tr>
          <td id="L4014" data-line-number="4014"></td>
          <td id="LC4014">        <span>pvTlsGetHash</span> <span>baEmptyHash,</span> <span>.DigestAlgo,</span> <span>baEmpty</span></td>
        </tr>
        <tr>
          <td id="L4015" data-line-number="4015"></td>
          <td id="LC4015">        <span>pvTlsHkdfExpandLabel</span> <span>baDerivedSecret,</span> <span>.DigestAlgo,</span> <span>baEarlySecret,</span> <span>&#34;derived&#34;</span><span>,</span> <span>baEmptyHash,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4016" data-line-number="4016"></td>
          <td id="LC4016">        <span>pvTlsGetSharedSecret</span> <span>baSharedSecret,</span> <span>.ExchAlgo,</span> <span>.LocalExchPrivate,</span> <span>.RemoteExchPublic</span></td>
        </tr>
        <tr>
          <td id="L4017" data-line-number="4017"></td>
          <td id="LC4017">        <span>pvTlsHkdfExtract</span> <span>.HandshakeSecret,</span> <span>.DigestAlgo,</span> <span>baDerivedSecret,</span> <span>baSharedSecret</span></td>
        </tr>
        <tr>
          <td id="L4018" data-line-number="4018"></td>
          <td id="LC4018">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficSecret,</span> <span>.DigestAlgo,</span> <span>.HandshakeSecret,</span> <span>IIf(.IsServer,</span> <span>&#34;c&#34;</span><span>,</span> <span>&#34;s&#34;</span><span>)</span> <span>&amp;</span> <span>&#34; hs traffic&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4019" data-line-number="4019"></td>
          <td id="LC4019">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficKey,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;key&#34;</span><span>,</span> <span>baEmpty,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4020" data-line-number="4020"></td>
          <td id="LC4020">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficIV,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;iv&#34;</span><span>,</span> <span>baEmpty,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4021" data-line-number="4021"></td>
          <td id="LC4021">        <span>.RemoteTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4022" data-line-number="4022"></td>
          <td id="LC4022">        <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>IIf(.IsServer,</span> <span>&#34;CLIENT&#34;</span><span>,</span> <span>&#34;SERVER&#34;</span><span>)</span> <span>&amp;</span> <span>&#34;_HANDSHAKE_TRAFFIC_SECRET&#34;</span><span>,</span> <span>.RemoteTrafficSecret</span></td>
        </tr>
        <tr>
          <td id="L4023" data-line-number="4023"></td>
          <td id="LC4023">        <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficSecret,</span> <span>.DigestAlgo,</span> <span>.HandshakeSecret,</span> <span>IIf(.IsServer,</span> <span>&#34;s&#34;</span><span>,</span> <span>&#34;c&#34;</span><span>)</span> <span>&amp;</span> <span>&#34; hs traffic&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4024" data-line-number="4024"></td>
          <td id="LC4024">        <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficKey,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;key&#34;</span><span>,</span> <span>baEmpty,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4025" data-line-number="4025"></td>
          <td id="LC4025">        <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficIV,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;iv&#34;</span><span>,</span> <span>baEmpty,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4026" data-line-number="4026"></td>
          <td id="LC4026">        <span>.LocalTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4027" data-line-number="4027"></td>
          <td id="LC4027">        <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>IIf(.IsServer,</span> <span>&#34;SERVER&#34;</span><span>,</span> <span>&#34;CLIENT&#34;</span><span>)</span> <span>&amp;</span> <span>&#34;_HANDSHAKE_TRAFFIC_SECRET&#34;</span><span>,</span> <span>.LocalTrafficSecret</span></td>
        </tr>
        <tr>
          <td id="L4028" data-line-number="4028"></td>
          <td id="LC4028">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4029" data-line-number="4029"></td>
          <td id="LC4029"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4030" data-line-number="4030"></td>
          <td id="LC4030">
</td>
        </tr>
        <tr>
          <td id="L4031" data-line-number="4031"></td>
          <td id="LC4031"><span>Private</span> <span>Sub</span> <span>pvTlsDeriveApplicationSecrets(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4032" data-line-number="4032"></td>
          <td id="LC4032">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsDeriveApplicationSecrets&#34;</span></td>
        </tr>
        <tr>
          <td id="L4033" data-line-number="4033"></td>
          <td id="LC4033">    <span>Dim</span> <span>baEmptyHash()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4034" data-line-number="4034"></td>
          <td id="LC4034">    <span>Dim</span> <span>baDerivedSecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4035" data-line-number="4035"></td>
          <td id="LC4035">    <span>Dim</span> <span>baEmpty()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4036" data-line-number="4036"></td>
          <td id="LC4036">    <span>Dim</span> <span>baZeroes()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4037" data-line-number="4037"></td>
          <td id="LC4037">    </td>
        </tr>
        <tr>
          <td id="L4038" data-line-number="4038"></td>
          <td id="LC4038">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4039" data-line-number="4039"></td>
          <td id="LC4039">        <span>If</span> <span>.HandshakeMessages.Size</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4040" data-line-number="4040"></td>
          <td id="LC4040">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>ERR_NO_HANDSHAKE_MESSAGES</span></td>
        </tr>
        <tr>
          <td id="L4041" data-line-number="4041"></td>
          <td id="LC4041">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4042" data-line-number="4042"></td>
          <td id="LC4042">        <span>pvTlsGetHash</span> <span>baEmptyHash,</span> <span>.DigestAlgo,</span> <span>baEmpty</span></td>
        </tr>
        <tr>
          <td id="L4043" data-line-number="4043"></td>
          <td id="LC4043">        <span>pvTlsHkdfExpandLabel</span> <span>baDerivedSecret,</span> <span>.DigestAlgo,</span> <span>.HandshakeSecret,</span> <span>&#34;derived&#34;</span><span>,</span> <span>baEmptyHash,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4044" data-line-number="4044"></td>
          <td id="LC4044">        <span>pvArrayAllocate</span> <span>baZeroes,</span> <span>.DigestSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baZeroes&#34;</span></td>
        </tr>
        <tr>
          <td id="L4045" data-line-number="4045"></td>
          <td id="LC4045">        <span>pvTlsHkdfExtract</span> <span>.MasterSecret,</span> <span>.DigestAlgo,</span> <span>baDerivedSecret,</span> <span>baZeroes</span></td>
        </tr>
        <tr>
          <td id="L4046" data-line-number="4046"></td>
          <td id="LC4046">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficSecret,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>IIf(.IsServer,</span> <span>&#34;c&#34;</span><span>,</span> <span>&#34;s&#34;</span><span>)</span> <span>&amp;</span> <span>&#34; ap traffic&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4047" data-line-number="4047"></td>
          <td id="LC4047">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficKey,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;key&#34;</span><span>,</span> <span>baEmpty,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4048" data-line-number="4048"></td>
          <td id="LC4048">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficIV,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;iv&#34;</span><span>,</span> <span>baEmpty,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4049" data-line-number="4049"></td>
          <td id="LC4049">        <span>.RemoteTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4050" data-line-number="4050"></td>
          <td id="LC4050">        <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>IIf(.IsServer,</span> <span>&#34;CLIENT&#34;</span><span>,</span> <span>&#34;SERVER&#34;</span><span>)</span> <span>&amp;</span> <span>&#34;_TRAFFIC_SECRET_0&#34;</span><span>,</span> <span>.RemoteTrafficSecret</span></td>
        </tr>
        <tr>
          <td id="L4051" data-line-number="4051"></td>
          <td id="LC4051">        <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficSecret,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>IIf(.IsServer,</span> <span>&#34;s&#34;</span><span>,</span> <span>&#34;c&#34;</span><span>)</span> <span>&amp;</span> <span>&#34; ap traffic&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4052" data-line-number="4052"></td>
          <td id="LC4052">        <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficKey,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;key&#34;</span><span>,</span> <span>baEmpty,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4053" data-line-number="4053"></td>
          <td id="LC4053">        <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficIV,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;iv&#34;</span><span>,</span> <span>baEmpty,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4054" data-line-number="4054"></td>
          <td id="LC4054">        <span>.LocalTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4055" data-line-number="4055"></td>
          <td id="LC4055">        <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>IIf(.IsServer,</span> <span>&#34;SERVER&#34;</span><span>,</span> <span>&#34;CLIENT&#34;</span><span>)</span> <span>&amp;</span> <span>&#34;_TRAFFIC_SECRET_0&#34;</span><span>,</span> <span>.LocalTrafficSecret</span></td>
        </tr>
        <tr>
          <td id="L4056" data-line-number="4056"></td>
          <td id="LC4056">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4057" data-line-number="4057"></td>
          <td id="LC4057"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4058" data-line-number="4058"></td>
          <td id="LC4058">
</td>
        </tr>
        <tr>
          <td id="L4059" data-line-number="4059"></td>
          <td id="LC4059"><span>Private</span> <span>Sub</span> <span>pvTlsDeriveKeyUpdate(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>ByVal</span> <span>bLocalUpdate</span> <span>As</span> <span>Boolean</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4060" data-line-number="4060"></td>
          <td id="LC4060">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsDeriveKeyUpdate&#34;</span></td>
        </tr>
        <tr>
          <td id="L4061" data-line-number="4061"></td>
          <td id="LC4061">    <span>Dim</span> <span>baEmpty()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4062" data-line-number="4062"></td>
          <td id="LC4062">    </td>
        </tr>
        <tr>
          <td id="L4063" data-line-number="4063"></td>
          <td id="LC4063">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4064" data-line-number="4064"></td>
          <td id="LC4064">        <span>If</span> <span>pvArraySize(.RemoteTrafficSecret)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4065" data-line-number="4065"></td>
          <td id="LC4065">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_NO_PREVIOUS_SECRET,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;RemoteTrafficSecret&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4066" data-line-number="4066"></td>
          <td id="LC4066">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4067" data-line-number="4067"></td>
          <td id="LC4067">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficSecret,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;traffic upd&#34;</span><span>,</span> <span>baEmpty,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4068" data-line-number="4068"></td>
          <td id="LC4068">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficKey,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;key&#34;</span><span>,</span> <span>baEmpty,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4069" data-line-number="4069"></td>
          <td id="LC4069">        <span>pvTlsHkdfExpandLabel</span> <span>.RemoteTrafficIV,</span> <span>.DigestAlgo,</span> <span>.RemoteTrafficSecret,</span> <span>&#34;iv&#34;</span><span>,</span> <span>baEmpty,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4070" data-line-number="4070"></td>
          <td id="LC4070">        <span>.RemoteTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4071" data-line-number="4071"></td>
          <td id="LC4071">        <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>IIf(.IsServer,</span> <span>&#34;CLIENT&#34;</span><span>,</span> <span>&#34;SERVER&#34;</span><span>)</span> <span>&amp;</span> <span>&#34;_TRAFFIC_SECRET_0&#34;</span><span>,</span> <span>.RemoteTrafficSecret</span></td>
        </tr>
        <tr>
          <td id="L4072" data-line-number="4072"></td>
          <td id="LC4072">        <span>If</span> <span>bLocalUpdate</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4073" data-line-number="4073"></td>
          <td id="LC4073">            <span>If</span> <span>pvArraySize(.LocalTrafficSecret)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4074" data-line-number="4074"></td>
          <td id="LC4074">                <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_NO_PREVIOUS_SECRET,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;LocalTrafficSecret&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4075" data-line-number="4075"></td>
          <td id="LC4075">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4076" data-line-number="4076"></td>
          <td id="LC4076">            <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficSecret,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;traffic upd&#34;</span><span>,</span> <span>baEmpty,</span> <span>.DigestSize</span></td>
        </tr>
        <tr>
          <td id="L4077" data-line-number="4077"></td>
          <td id="LC4077">            <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficKey,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;key&#34;</span><span>,</span> <span>baEmpty,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4078" data-line-number="4078"></td>
          <td id="LC4078">            <span>pvTlsHkdfExpandLabel</span> <span>.LocalTrafficIV,</span> <span>.DigestAlgo,</span> <span>.LocalTrafficSecret,</span> <span>&#34;iv&#34;</span><span>,</span> <span>baEmpty,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4079" data-line-number="4079"></td>
          <td id="LC4079">            <span>.LocalTrafficSeqNo</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4080" data-line-number="4080"></td>
          <td id="LC4080">            <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>IIf(.IsServer,</span> <span>&#34;SERVER&#34;</span><span>,</span> <span>&#34;CLIENT&#34;</span><span>)</span> <span>&amp;</span> <span>&#34;_TRAFFIC_SECRET_0&#34;</span><span>,</span> <span>.LocalTrafficSecret</span></td>
        </tr>
        <tr>
          <td id="L4081" data-line-number="4081"></td>
          <td id="LC4081">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4082" data-line-number="4082"></td>
          <td id="LC4082">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4083" data-line-number="4083"></td>
          <td id="LC4083"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4084" data-line-number="4084"></td>
          <td id="LC4084">
</td>
        </tr>
        <tr>
          <td id="L4085" data-line-number="4085"></td>
          <td id="LC4085"><span>Private</span> <span>Sub</span> <span>pvTlsHkdfExpandLabel(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>eHash</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>sLabel</span> <span>As</span> <span>String</span><span>,</span> <span>baContext()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4086" data-line-number="4086"></td>
          <td id="LC4086">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsHkdfExpandLabel&#34;</span></td>
        </tr>
        <tr>
          <td id="L4087" data-line-number="4087"></td>
          <td id="LC4087">    <span>Dim</span> <span>uOutput</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4088" data-line-number="4088"></td>
          <td id="LC4088">    <span>Dim</span> <span>uInfo</span>           <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4089" data-line-number="4089"></td>
          <td id="LC4089">    <span>Dim</span> <span>uInput</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4090" data-line-number="4090"></td>
          <td id="LC4090">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4091" data-line-number="4091"></td>
          <td id="LC4091">    <span>Dim</span> <span>baLast()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4092" data-line-number="4092"></td>
          <td id="LC4092">    </td>
        </tr>
        <tr>
          <td id="L4093" data-line-number="4093"></td>
          <td id="LC4093">    <span>sLabel</span> <span>=</span> <span>&#34;tls13 &#34;</span> <span>&amp;</span> <span>sLabel</span></td>
        </tr>
        <tr>
          <td id="L4094" data-line-number="4094"></td>
          <td id="LC4094">    <span>pvArrayAllocate</span> <span>uInfo.Data,</span> <span>3</span> <span>+</span> <span>Len(sLabel)</span> <span>+</span> <span>1</span> <span>+</span> <span>pvArraySize(baContext),</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uInfo&#34;</span></td>
        </tr>
        <tr>
          <td id="L4095" data-line-number="4095"></td>
          <td id="LC4095">    <span>pvBufferWriteLong</span> <span>uInfo,</span> <span>lSize,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L4096" data-line-number="4096"></td>
          <td id="LC4096">    <span>pvBufferWriteLong</span> <span>uInfo,</span> <span>Len(sLabel)</span></td>
        </tr>
        <tr>
          <td id="L4097" data-line-number="4097"></td>
          <td id="LC4097">    <span>pvBufferWriteString</span> <span>uInfo,</span> <span>sLabel</span></td>
        </tr>
        <tr>
          <td id="L4098" data-line-number="4098"></td>
          <td id="LC4098">    <span>pvBufferWriteLong</span> <span>uInfo,</span> <span>pvArraySize(baContext)</span></td>
        </tr>
        <tr>
          <td id="L4099" data-line-number="4099"></td>
          <td id="LC4099">    <span>pvBufferWriteArray</span> <span>uInfo,</span> <span>baContext</span></td>
        </tr>
        <tr>
          <td id="L4100" data-line-number="4100"></td>
          <td id="LC4100">    <span>pvBufferWriteEOF</span> <span>uInfo</span></td>
        </tr>
        <tr>
          <td id="L4101" data-line-number="4101"></td>
          <td id="LC4101">    <span>lIdx</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L4102" data-line-number="4102"></td>
          <td id="LC4102">    <span>Do</span> <span>While</span> <span>uOutput.Size</span> <span>&lt;</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L4103" data-line-number="4103"></td>
          <td id="LC4103">        <span>uInput.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4104" data-line-number="4104"></td>
          <td id="LC4104">        <span>pvBufferWriteArray</span> <span>uInput,</span> <span>baLast</span></td>
        </tr>
        <tr>
          <td id="L4105" data-line-number="4105"></td>
          <td id="LC4105">        <span>pvBufferWriteArray</span> <span>uInput,</span> <span>uInfo.Data</span></td>
        </tr>
        <tr>
          <td id="L4106" data-line-number="4106"></td>
          <td id="LC4106">        <span>pvBufferWriteLong</span> <span>uInput,</span> <span>lIdx</span></td>
        </tr>
        <tr>
          <td id="L4107" data-line-number="4107"></td>
          <td id="LC4107">        <span>pvBufferWriteEOF</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L4108" data-line-number="4108"></td>
          <td id="LC4108">        <span>pvTlsGetHmac</span> <span>baLast,</span> <span>eHash,</span> <span>baKey,</span> <span>uInput.Data</span></td>
        </tr>
        <tr>
          <td id="L4109" data-line-number="4109"></td>
          <td id="LC4109">        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baLast</span></td>
        </tr>
        <tr>
          <td id="L4110" data-line-number="4110"></td>
          <td id="LC4110">        <span>lIdx</span> <span>=</span> <span>lIdx</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L4111" data-line-number="4111"></td>
          <td id="LC4111">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L4112" data-line-number="4112"></td>
          <td id="LC4112">    <span>uOutput.Size</span> <span>=</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L4113" data-line-number="4113"></td>
          <td id="LC4113">    <span>pvBufferWriteEOF</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L4114" data-line-number="4114"></td>
          <td id="LC4114">    <span>baRetVal</span> <span>=</span> <span>uOutput.Data</span></td>
        </tr>
        <tr>
          <td id="L4115" data-line-number="4115"></td>
          <td id="LC4115"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4116" data-line-number="4116"></td>
          <td id="LC4116">
</td>
        </tr>
        <tr>
          <td id="L4117" data-line-number="4117"></td>
          <td id="LC4117"><span>Private</span> <span>Sub</span> <span>pvTlsHkdfExtract(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>eHash</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4118" data-line-number="4118"></td>
          <td id="LC4118">    <span>pvTlsGetHmac</span> <span>baRetVal,</span> <span>eHash,</span> <span>baKey,</span> <span>baInput</span></td>
        </tr>
        <tr>
          <td id="L4119" data-line-number="4119"></td>
          <td id="LC4119"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4120" data-line-number="4120"></td>
          <td id="LC4120">
</td>
        </tr>
        <tr>
          <td id="L4121" data-line-number="4121"></td>
          <td id="LC4121"><span>&#39;= legacy PRF-based key derivation functions =============================</span></td>
        </tr>
        <tr>
          <td id="L4122" data-line-number="4122"></td>
          <td id="LC4122">
</td>
        </tr>
        <tr>
          <td id="L4123" data-line-number="4123"></td>
          <td id="LC4123"><span>Private</span> <span>Sub</span> <span>pvTlsDeriveLegacySecrets(uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L4124" data-line-number="4124"></td>
          <td id="LC4124">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsDeriveLegacySecrets&#34;</span></td>
        </tr>
        <tr>
          <td id="L4125" data-line-number="4125"></td>
          <td id="LC4125">    <span>Dim</span> <span>baPreMasterSecret()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4126" data-line-number="4126"></td>
          <td id="LC4126">    <span>Dim</span> <span>baHandshakeHash()</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4127" data-line-number="4127"></td>
          <td id="LC4127">    <span>Dim</span> <span>uRandom</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4128" data-line-number="4128"></td>
          <td id="LC4128">    <span>Dim</span> <span>uExpanded</span>       <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4129" data-line-number="4129"></td>
          <td id="LC4129">    </td>
        </tr>
        <tr>
          <td id="L4130" data-line-number="4130"></td>
          <td id="LC4130">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4131" data-line-number="4131"></td>
          <td id="LC4131">        <span>If</span> <span>pvArraySize(.RemoteExchRandom)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4132" data-line-number="4132"></td>
          <td id="LC4132">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>ERR_NO_REMOTE_RANDOM</span></td>
        </tr>
        <tr>
          <td id="L4133" data-line-number="4133"></td>
          <td id="LC4133">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4134" data-line-number="4134"></td>
          <td id="LC4134">        <span>pvTlsGetSharedSecret</span> <span>baPreMasterSecret,</span> <span>.ExchAlgo,</span> <span>.LocalExchPrivate,</span> <span>.RemoteExchPublic</span></td>
        </tr>
        <tr>
          <td id="L4135" data-line-number="4135"></td>
          <td id="LC4135">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>2</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4136" data-line-number="4136"></td>
          <td id="LC4136">            <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPreMasterSecret&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baPreMasterSecret)</span></td>
        </tr>
        <tr>
          <td id="L4137" data-line-number="4137"></td>
          <td id="LC4137">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4138" data-line-number="4138"></td>
          <td id="LC4138">        <span>If</span> <span>SearchCollection(.RemoteExtensions,</span> <span>&#34;#&#34;</span> <span>&amp;</span> <span>TLS_EXTENSION_EXTENDED_MASTER_SECRET)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4139" data-line-number="4139"></td>
          <td id="LC4139">            <span>pvTlsGetHandshakeHash</span> <span>uCtx,</span> <span>baHandshakeHash</span></td>
        </tr>
        <tr>
          <td id="L4140" data-line-number="4140"></td>
          <td id="LC4140">            <span>pvTlsKdfLegacyPrf</span> <span>.MasterSecret,</span> <span>.DigestAlgo,</span> <span>baPreMasterSecret,</span> <span>&#34;extended master secret&#34;</span><span>,</span> <span>baHandshakeHash,</span> <span>TLS_LEGACY_SECRET_SIZE</span></td>
        </tr>
        <tr>
          <td id="L4141" data-line-number="4141"></td>
          <td id="LC4141">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4142" data-line-number="4142"></td>
          <td id="LC4142">            <span>If</span> <span>uCtx.IsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4143" data-line-number="4143"></td>
          <td id="LC4143">                <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.RemoteExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4144" data-line-number="4144"></td>
          <td id="LC4144">                <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4145" data-line-number="4145"></td>
          <td id="LC4145">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4146" data-line-number="4146"></td>
          <td id="LC4146">                <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4147" data-line-number="4147"></td>
          <td id="LC4147">                <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.RemoteExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4148" data-line-number="4148"></td>
          <td id="LC4148">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4149" data-line-number="4149"></td>
          <td id="LC4149">            <span>pvBufferWriteEOF</span> <span>uRandom</span></td>
        </tr>
        <tr>
          <td id="L4150" data-line-number="4150"></td>
          <td id="LC4150">            <span>pvTlsKdfLegacyPrf</span> <span>.MasterSecret,</span> <span>.DigestAlgo,</span> <span>baPreMasterSecret,</span> <span>&#34;master secret&#34;</span><span>,</span> <span>uRandom.Data,</span> <span>TLS_LEGACY_SECRET_SIZE</span></td>
        </tr>
        <tr>
          <td id="L4151" data-line-number="4151"></td>
          <td id="LC4151">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4152" data-line-number="4152"></td>
          <td id="LC4152">        <span>pvTlsLogSecret</span> <span>uCtx,</span> <span>&#34;CLIENT_RANDOM&#34;</span><span>,</span> <span>.MasterSecret</span></td>
        </tr>
        <tr>
          <td id="L4153" data-line-number="4153"></td>
          <td id="LC4153">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>2</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4154" data-line-number="4154"></td>
          <td id="LC4154">            <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.MasterSecret&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(.MasterSecret)</span></td>
        </tr>
        <tr>
          <td id="L4155" data-line-number="4155"></td>
          <td id="LC4155">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4156" data-line-number="4156"></td>
          <td id="LC4156">        <span>uRandom.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4157" data-line-number="4157"></td>
          <td id="LC4157">        <span>If</span> <span>uCtx.IsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4158" data-line-number="4158"></td>
          <td id="LC4158">            <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4159" data-line-number="4159"></td>
          <td id="LC4159">            <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.RemoteExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4160" data-line-number="4160"></td>
          <td id="LC4160">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4161" data-line-number="4161"></td>
          <td id="LC4161">            <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.RemoteExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4162" data-line-number="4162"></td>
          <td id="LC4162">            <span>pvBufferWriteArray</span> <span>uRandom,</span> <span>.LocalExchRandom</span></td>
        </tr>
        <tr>
          <td id="L4163" data-line-number="4163"></td>
          <td id="LC4163">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4164" data-line-number="4164"></td>
          <td id="LC4164">        <span>pvBufferWriteEOF</span> <span>uRandom</span></td>
        </tr>
        <tr>
          <td id="L4165" data-line-number="4165"></td>
          <td id="LC4165">        <span>pvTlsKdfLegacyPrf</span> <span>uExpanded.Data,</span> <span>.DigestAlgo,</span> <span>.MasterSecret,</span> <span>&#34;key expansion&#34;</span><span>,</span> <span>uRandom.Data,</span> <span>2</span> <span>*</span> <span>(.MacSize</span> <span>+</span> <span>.KeySize</span> <span>+</span> <span>.IvSize)</span></td>
        </tr>
        <tr>
          <td id="L4166" data-line-number="4166"></td>
          <td id="LC4166">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>2</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4167" data-line-number="4167"></td>
          <td id="LC4167">            <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uExpanded.Data&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(uExpanded.Data)</span></td>
        </tr>
        <tr>
          <td id="L4168" data-line-number="4168"></td>
          <td id="LC4168">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4169" data-line-number="4169"></td>
          <td id="LC4169">        <span>If</span> <span>uCtx.IsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4170" data-line-number="4170"></td>
          <td id="LC4170">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.RemoteLegacyNextMacKey,</span> <span>.MacSize</span>  <span>&#39;--- not used w/ AEAD</span></td>
        </tr>
        <tr>
          <td id="L4171" data-line-number="4171"></td>
          <td id="LC4171">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.LocalLegacyNextMacKey,</span> <span>.MacSize</span>   <span>&#39;--- not used w/ AEAD</span></td>
        </tr>
        <tr>
          <td id="L4172" data-line-number="4172"></td>
          <td id="LC4172">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4173" data-line-number="4173"></td>
          <td id="LC4173">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.LocalLegacyNextMacKey,</span> <span>.MacSize</span>   <span>&#39;--- not used w/ AEAD</span></td>
        </tr>
        <tr>
          <td id="L4174" data-line-number="4174"></td>
          <td id="LC4174">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.RemoteLegacyNextMacKey,</span> <span>.MacSize</span>  <span>&#39;--- not used w/ AEAD</span></td>
        </tr>
        <tr>
          <td id="L4175" data-line-number="4175"></td>
          <td id="LC4175">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4176" data-line-number="4176"></td>
          <td id="LC4176">        <span>If</span> <span>uCtx.IsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4177" data-line-number="4177"></td>
          <td id="LC4177">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.RemoteLegacyNextTrafficKey,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4178" data-line-number="4178"></td>
          <td id="LC4178">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.LocalLegacyNextTrafficKey,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4179" data-line-number="4179"></td>
          <td id="LC4179">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4180" data-line-number="4180"></td>
          <td id="LC4180">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.LocalLegacyNextTrafficKey,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4181" data-line-number="4181"></td>
          <td id="LC4181">            <span>pvBufferReadArray</span> <span>uExpanded,</span> <span>.RemoteLegacyNextTrafficKey,</span> <span>.KeySize</span></td>
        </tr>
        <tr>
          <td id="L4182" data-line-number="4182"></td>
          <td id="LC4182">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4183" data-line-number="4183"></td>
          <td id="LC4183">        <span>If</span> <span>uCtx.IsServer</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4184" data-line-number="4184"></td>
          <td id="LC4184">            <span>pvTlsGetRandom</span> <span>.RemoteLegacyNextTrafficIV,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4185" data-line-number="4185"></td>
          <td id="LC4185">            <span>pvBufferReadBlob</span> <span>uExpanded,</span> <span>VarPtr(.RemoteLegacyNextTrafficIV(</span><span>0</span><span>)),</span> <span>.IvSize</span> <span>-</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L4186" data-line-number="4186"></td>
          <td id="LC4186">            <span>pvTlsGetRandom</span> <span>.LocalLegacyNextTrafficIV,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4187" data-line-number="4187"></td>
          <td id="LC4187">            <span>pvBufferReadBlob</span> <span>uExpanded,</span> <span>VarPtr(.LocalLegacyNextTrafficIV(</span><span>0</span><span>)),</span> <span>.IvSize</span> <span>-</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L4188" data-line-number="4188"></td>
          <td id="LC4188">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4189" data-line-number="4189"></td>
          <td id="LC4189">            <span>pvTlsGetRandom</span> <span>.LocalLegacyNextTrafficIV,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4190" data-line-number="4190"></td>
          <td id="LC4190">            <span>pvBufferReadBlob</span> <span>uExpanded,</span> <span>VarPtr(.LocalLegacyNextTrafficIV(</span><span>0</span><span>)),</span> <span>.IvSize</span> <span>-</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L4191" data-line-number="4191"></td>
          <td id="LC4191">            <span>pvTlsGetRandom</span> <span>.RemoteLegacyNextTrafficIV,</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4192" data-line-number="4192"></td>
          <td id="LC4192">            <span>pvBufferReadBlob</span> <span>uExpanded,</span> <span>VarPtr(.RemoteLegacyNextTrafficIV(</span><span>0</span><span>)),</span> <span>.IvSize</span> <span>-</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L4193" data-line-number="4193"></td>
          <td id="LC4193">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4194" data-line-number="4194"></td>
          <td id="LC4194">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4195" data-line-number="4195"></td>
          <td id="LC4195"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4196" data-line-number="4196"></td>
          <td id="LC4196">
</td>
        </tr>
        <tr>
          <td id="L4197" data-line-number="4197"></td>
          <td id="LC4197"><span>Private</span> <span>Sub</span> <span>pvTlsKdfLegacyPrf(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>eHash</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>sLabel</span> <span>As</span> <span>String</span><span>,</span> <span>baContext()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4198" data-line-number="4198"></td>
          <td id="LC4198">    <span>Dim</span> <span>uOutput</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4199" data-line-number="4199"></td>
          <td id="LC4199">    <span>Dim</span> <span>uSeed</span>           <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4200" data-line-number="4200"></td>
          <td id="LC4200">    <span>Dim</span> <span>uInput</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4201" data-line-number="4201"></td>
          <td id="LC4201">    <span>Dim</span> <span>baLast()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4202" data-line-number="4202"></td>
          <td id="LC4202">    <span>Dim</span> <span>baHmac()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4203" data-line-number="4203"></td>
          <td id="LC4203">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4204" data-line-number="4204"></td>
          <td id="LC4204">    </td>
        </tr>
        <tr>
          <td id="L4205" data-line-number="4205"></td>
          <td id="LC4205">    <span>&#39;--- for TLS 1.2 -- PRF(secret, label, seed) = P_&lt;hash&gt;(secret, label + seed)</span></td>
        </tr>
        <tr>
          <td id="L4206" data-line-number="4206"></td>
          <td id="LC4206">    <span>pvBufferWriteString</span> <span>uSeed,</span> <span>sLabel</span></td>
        </tr>
        <tr>
          <td id="L4207" data-line-number="4207"></td>
          <td id="LC4207">    <span>pvBufferWriteArray</span> <span>uSeed,</span> <span>baContext</span></td>
        </tr>
        <tr>
          <td id="L4208" data-line-number="4208"></td>
          <td id="LC4208">    <span>pvBufferWriteEOF</span> <span>uSeed</span></td>
        </tr>
        <tr>
          <td id="L4209" data-line-number="4209"></td>
          <td id="LC4209">    <span>baLast</span> <span>=</span> <span>uSeed.Data</span></td>
        </tr>
        <tr>
          <td id="L4210" data-line-number="4210"></td>
          <td id="LC4210">    <span>Do</span> <span>While</span> <span>uOutput.Size</span> <span>&lt;</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L4211" data-line-number="4211"></td>
          <td id="LC4211">        <span>baTemp</span> <span>=</span> <span>baLast</span></td>
        </tr>
        <tr>
          <td id="L4212" data-line-number="4212"></td>
          <td id="LC4212">        <span>pvTlsGetHmac</span> <span>baLast,</span> <span>eHash,</span> <span>baKey,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L4213" data-line-number="4213"></td>
          <td id="LC4213">        <span>pvBufferWriteArray</span> <span>uInput,</span> <span>baLast</span></td>
        </tr>
        <tr>
          <td id="L4214" data-line-number="4214"></td>
          <td id="LC4214">        <span>pvBufferWriteArray</span> <span>uInput,</span> <span>uSeed.Data</span></td>
        </tr>
        <tr>
          <td id="L4215" data-line-number="4215"></td>
          <td id="LC4215">        <span>pvBufferWriteEOF</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L4216" data-line-number="4216"></td>
          <td id="LC4216">        <span>pvTlsGetHmac</span> <span>baHmac,</span> <span>eHash,</span> <span>baKey,</span> <span>uInput.Data</span></td>
        </tr>
        <tr>
          <td id="L4217" data-line-number="4217"></td>
          <td id="LC4217">        <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baHmac</span></td>
        </tr>
        <tr>
          <td id="L4218" data-line-number="4218"></td>
          <td id="LC4218">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L4219" data-line-number="4219"></td>
          <td id="LC4219">    <span>uOutput.Size</span> <span>=</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L4220" data-line-number="4220"></td>
          <td id="LC4220">    <span>pvBufferWriteEOF</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L4221" data-line-number="4221"></td>
          <td id="LC4221">    <span>baRetVal</span> <span>=</span> <span>uOutput.Data</span></td>
        </tr>
        <tr>
          <td id="L4222" data-line-number="4222"></td>
          <td id="LC4222"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4223" data-line-number="4223"></td>
          <td id="LC4223">
</td>
        </tr>
        <tr>
          <td id="L4224" data-line-number="4224"></td>
          <td id="LC4224"><span>Private</span> <span>Sub</span> <span>pvTlsGetHandshakeHash(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baRetVal()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4225" data-line-number="4225"></td>
          <td id="LC4225">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsGetHandshakeHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4226" data-line-number="4226"></td>
          <td id="LC4226">    </td>
        </tr>
        <tr>
          <td id="L4227" data-line-number="4227"></td>
          <td id="LC4227">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4228" data-line-number="4228"></td>
          <td id="LC4228">        <span>pvTlsGetHash</span> <span>baRetVal,</span> <span>.DigestAlgo,</span> <span>.HandshakeMessages.Data,</span> <span>Size:=.HandshakeMessages.Size</span></td>
        </tr>
        <tr>
          <td id="L4229" data-line-number="4229"></td>
          <td id="LC4229">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>2</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4230" data-line-number="4230"></td>
          <td id="LC4230">            <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baRetVal)</span></td>
        </tr>
        <tr>
          <td id="L4231" data-line-number="4231"></td>
          <td id="LC4231">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4232" data-line-number="4232"></td>
          <td id="LC4232">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4233" data-line-number="4233"></td>
          <td id="LC4233"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4234" data-line-number="4234"></td>
          <td id="LC4234">
</td>
        </tr>
        <tr>
          <td id="L4235" data-line-number="4235"></td>
          <td id="LC4235"><span>Private</span> <span>Sub</span> <span>pvTlsAppendHandshakeHash(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4236" data-line-number="4236"></td>
          <td id="LC4236">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsAppendHandshakeHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4237" data-line-number="4237"></td>
          <td id="LC4237">    </td>
        </tr>
        <tr>
          <td id="L4238" data-line-number="4238"></td>
          <td id="LC4238">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4239" data-line-number="4239"></td>
          <td id="LC4239">        <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>2</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4240" data-line-number="4240"></td>
          <td id="LC4240">            <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baInput(&#34;</span> <span>&amp;</span> <span>lSize</span> <span>&amp;</span> <span>&#34;)&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(baInput,</span> <span>lPos,</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L4241" data-line-number="4241"></td>
          <td id="LC4241">        <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4242" data-line-number="4242"></td>
          <td id="LC4242">        <span>pvBufferWriteBlob</span> <span>.HandshakeMessages,</span> <span>VarPtr(baInput(lPos)),</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L4243" data-line-number="4243"></td>
          <td id="LC4243">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4244" data-line-number="4244"></td>
          <td id="LC4244"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4245" data-line-number="4245"></td>
          <td id="LC4245">
</td>
        </tr>
        <tr>
          <td id="L4246" data-line-number="4246"></td>
          <td id="LC4246"><span>Private</span> <span>Sub</span> <span>pvTlsResetHandshakeHash(uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L4247" data-line-number="4247"></td>
          <td id="LC4247">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4248" data-line-number="4248"></td>
          <td id="LC4248">        <span>.HandshakeMessages.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L4249" data-line-number="4249"></td>
          <td id="LC4249">        <span>pvBufferWriteEOF</span> <span>.HandshakeMessages</span></td>
        </tr>
        <tr>
          <td id="L4250" data-line-number="4250"></td>
          <td id="LC4250">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4251" data-line-number="4251"></td>
          <td id="LC4251"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4252" data-line-number="4252"></td>
          <td id="LC4252">
</td>
        </tr>
        <tr>
          <td id="L4253" data-line-number="4253"></td>
          <td id="LC4253"><span>Private</span> <span>Sub</span> <span>pvTlsLogSecret(uCtx</span> <span>As</span> <span>UcsTlsContext,</span> <span>sLabel</span> <span>As</span> <span>String</span><span>,</span> <span>baSecret()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4254" data-line-number="4254"></td>
          <td id="LC4254">    <span>Dim</span> <span>sFileName</span>       <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4255" data-line-number="4255"></td>
          <td id="LC4255">    <span>Dim</span> <span>nFile</span>           <span>As</span> <span>Integer</span></td>
        </tr>
        <tr>
          <td id="L4256" data-line-number="4256"></td>
          <td id="LC4256">    </td>
        </tr>
        <tr>
          <td id="L4257" data-line-number="4257"></td>
          <td id="LC4257">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L4258" data-line-number="4258"></td>
          <td id="LC4258">    <span>sFileName</span> <span>=</span> <span>String</span>$<span>(</span><span>1000</span><span>,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4259" data-line-number="4259"></td>
          <td id="LC4259">    <span>Call</span> <span>GetEnvironmentVariable(StrPtr(</span><span>&#34;SSLKEYLOGFILE&#34;</span><span>),</span> <span>StrPtr(sFileName),</span> <span>Len(sFileName)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4260" data-line-number="4260"></td>
          <td id="LC4260">    <span>sFileName</span> <span>=</span> <span>Left$(sFileName,</span> <span>InStr(sFileName,</span> <span>vbNullChar)</span> <span>-</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4261" data-line-number="4261"></td>
          <td id="LC4261">    <span>If</span> <span>LenB(sFileName)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4262" data-line-number="4262"></td>
          <td id="LC4262">        <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4263" data-line-number="4263"></td>
          <td id="LC4263">            <span>Size</span> <span>=</span> <span>pvArraySize(baSecret)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L4264" data-line-number="4264"></td>
          <td id="LC4264">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4265" data-line-number="4265"></td>
          <td id="LC4265">        <span>nFile</span> <span>=</span> <span>FreeFile</span></td>
        </tr>
        <tr>
          <td id="L4266" data-line-number="4266"></td>
          <td id="LC4266">        <span>Open</span> <span>sFileName</span> <span>For</span> <span>Append</span> <span>Shared</span> <span>As</span> <span>nFile</span></td>
        </tr>
        <tr>
          <td id="L4267" data-line-number="4267"></td>
          <td id="LC4267">        <span>Print</span> <span>#nFile,</span> <span>sLabel</span> <span>&amp;</span> <span>&#34; &#34;</span> <span>&amp;</span> <span>pvToHex(VarPtr(uCtx.LocalExchRandom(</span><span>0</span><span>)),</span> <span>UBound(uCtx.LocalExchRandom)</span> <span>+</span> <span>1</span><span>)</span> <span>&amp;</span> <span>&#34; &#34;</span> <span>&amp;</span> <span>pvToHex(VarPtr(baSecret(Pos)),</span> <span>Size)</span></td>
        </tr>
        <tr>
          <td id="L4268" data-line-number="4268"></td>
          <td id="LC4268">        <span>Close</span> <span>nFile</span></td>
        </tr>
        <tr>
          <td id="L4269" data-line-number="4269"></td>
          <td id="LC4269">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4270" data-line-number="4270"></td>
          <td id="LC4270"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L4271" data-line-number="4271"></td>
          <td id="LC4271"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4272" data-line-number="4272"></td>
          <td id="LC4272">
</td>
        </tr>
        <tr>
          <td id="L4273" data-line-number="4273"></td>
          <td id="LC4273"><span>&#39;= crypto wrappers =======================================================</span></td>
        </tr>
        <tr>
          <td id="L4274" data-line-number="4274"></td>
          <td id="LC4274">
</td>
        </tr>
        <tr>
          <td id="L4275" data-line-number="4275"></td>
          <td id="LC4275"><span>Private</span> <span>Sub</span> <span>pvTlsGetRandom(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4276" data-line-number="4276"></td>
          <td id="LC4276">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsGetRandom&#34;</span></td>
        </tr>
        <tr>
          <td id="L4277" data-line-number="4277"></td>
          <td id="LC4277">    </td>
        </tr>
        <tr>
          <td id="L4278" data-line-number="4278"></td>
          <td id="LC4278">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4279" data-line-number="4279"></td>
          <td id="LC4279">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L4280" data-line-number="4280"></td>
          <td id="LC4280">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baRetVal(</span><span>0</span><span>)),</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L4281" data-line-number="4281"></td>
          <td id="LC4281">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4282" data-line-number="4282"></td>
          <td id="LC4282">        <span>baRetVal</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L4283" data-line-number="4283"></td>
          <td id="LC4283">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4284" data-line-number="4284"></td>
          <td id="LC4284"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4285" data-line-number="4285"></td>
          <td id="LC4285">
</td>
        </tr>
        <tr>
          <td id="L4286" data-line-number="4286"></td>
          <td id="LC4286"><span>Private</span> <span>Sub</span> <span>pvTlsGetHash(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>eHash</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4287" data-line-number="4287"></td>
          <td id="LC4287">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsGetHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4288" data-line-number="4288"></td>
          <td id="LC4288">
</td>
        </tr>
        <tr>
          <td id="L4289" data-line-number="4289"></td>
          <td id="LC4289">    <span>Select</span> <span>Case</span> <span>eHash</span></td>
        </tr>
        <tr>
          <td id="L4290" data-line-number="4290"></td>
          <td id="LC4290">    <span>Case</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4291" data-line-number="4291"></td>
          <td id="LC4291">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha256(baRetVal,</span> <span>baInput,</span> <span>Pos,</span> <span>Size)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4292" data-line-number="4292"></td>
          <td id="LC4292">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha256&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4293" data-line-number="4293"></td>
          <td id="LC4293">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4294" data-line-number="4294"></td>
          <td id="LC4294">    <span>Case</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4295" data-line-number="4295"></td>
          <td id="LC4295">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha384(baRetVal,</span> <span>baInput,</span> <span>Pos,</span> <span>Size)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4296" data-line-number="4296"></td>
          <td id="LC4296">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha384&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4297" data-line-number="4297"></td>
          <td id="LC4297">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4298" data-line-number="4298"></td>
          <td id="LC4298">    <span>Case</span> <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L4299" data-line-number="4299"></td>
          <td id="LC4299">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha512(baRetVal,</span> <span>baInput,</span> <span>Pos,</span> <span>Size)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4300" data-line-number="4300"></td>
          <td id="LC4300">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha512&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4301" data-line-number="4301"></td>
          <td id="LC4301">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4302" data-line-number="4302"></td>
          <td id="LC4302">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4303" data-line-number="4303"></td>
          <td id="LC4303">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>&#34;Unsupported hash type &#34;</span> <span>&amp;</span> <span>eHash</span></td>
        </tr>
        <tr>
          <td id="L4304" data-line-number="4304"></td>
          <td id="LC4304">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4305" data-line-number="4305"></td>
          <td id="LC4305"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4306" data-line-number="4306"></td>
          <td id="LC4306">
</td>
        </tr>
        <tr>
          <td id="L4307" data-line-number="4307"></td>
          <td id="LC4307"><span>Private</span> <span>Sub</span> <span>pvTlsGetHmac(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>eHash</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4308" data-line-number="4308"></td>
          <td id="LC4308">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsGetHmac&#34;</span></td>
        </tr>
        <tr>
          <td id="L4309" data-line-number="4309"></td>
          <td id="LC4309">    </td>
        </tr>
        <tr>
          <td id="L4310" data-line-number="4310"></td>
          <td id="LC4310">    <span>Select</span> <span>Case</span> <span>eHash</span></td>
        </tr>
        <tr>
          <td id="L4311" data-line-number="4311"></td>
          <td id="LC4311">    <span>Case</span> <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L4312" data-line-number="4312"></td>
          <td id="LC4312">        <span>If</span> <span>Not</span> <span>pvCryptoHmacSha1(baRetVal,</span> <span>baKey,</span> <span>baInput,</span> <span>Pos,</span> <span>Size)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4313" data-line-number="4313"></td>
          <td id="LC4313">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHmacSha1&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4314" data-line-number="4314"></td>
          <td id="LC4314">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4315" data-line-number="4315"></td>
          <td id="LC4315">    <span>Case</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4316" data-line-number="4316"></td>
          <td id="LC4316">        <span>If</span> <span>Not</span> <span>pvCryptoHmacSha256(baRetVal,</span> <span>baKey,</span> <span>baInput,</span> <span>Pos,</span> <span>Size)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4317" data-line-number="4317"></td>
          <td id="LC4317">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHmacSha256&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4318" data-line-number="4318"></td>
          <td id="LC4318">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4319" data-line-number="4319"></td>
          <td id="LC4319">    <span>Case</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4320" data-line-number="4320"></td>
          <td id="LC4320">        <span>If</span> <span>Not</span> <span>pvCryptoHmacSha384(baRetVal,</span> <span>baKey,</span> <span>baInput,</span> <span>Pos,</span> <span>Size)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4321" data-line-number="4321"></td>
          <td id="LC4321">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHmacSha384&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4322" data-line-number="4322"></td>
          <td id="LC4322">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4323" data-line-number="4323"></td>
          <td id="LC4323">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4324" data-line-number="4324"></td>
          <td id="LC4324">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>&#34;Unsupported HMAC type &#34;</span> <span>&amp;</span> <span>eHash</span></td>
        </tr>
        <tr>
          <td id="L4325" data-line-number="4325"></td>
          <td id="LC4325">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4326" data-line-number="4326"></td>
          <td id="LC4326"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4327" data-line-number="4327"></td>
          <td id="LC4327">
</td>
        </tr>
        <tr>
          <td id="L4328" data-line-number="4328"></td>
          <td id="LC4328"><span>Private</span> <span>Sub</span> <span>pvTlsGetHelloRetryRandom(baRetVal()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4329" data-line-number="4329"></td>
          <td id="LC4329">    <span>pvArrayByte</span> <span>baRetVal,</span> <span>&amp;HCF</span><span>,</span> <span>&amp;H21</span><span>,</span> <span>&amp;HAD</span><span>,</span> <span>&amp;H74</span><span>,</span> <span>&amp;HE5</span><span>,</span> <span>&amp;H9A</span><span>,</span> <span>&amp;H61</span><span>,</span> <span>&amp;H11</span><span>,</span> <span>&amp;HBE</span><span>,</span> <span>&amp;H1D</span><span>,</span> <span>&amp;H8C</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H1E</span><span>,</span> <span>&amp;H65</span><span>,</span> <span>&amp;HB8</span><span>,</span> <span>&amp;H91</span><span>,</span> <span>&amp;HC2</span><span>,</span> <span>&amp;HA2</span><span>,</span> <span>&amp;H11</span><span>,</span> <span>&amp;H16</span><span>,</span> <span>&amp;H7A</span><span>,</span> <span>&amp;HBB</span><span>,</span> <span>&amp;H8C</span><span>,</span> <span>&amp;H5E</span><span>,</span> <span>&amp;H7</span><span>,</span> <span>&amp;H9E</span><span>,</span> <span>&amp;H9</span><span>,</span> <span>&amp;HE2</span><span>,</span> <span>&amp;HC8</span><span>,</span> <span>&amp;HA8</span><span>,</span> <span>&amp;H33</span><span>,</span> <span>&amp;H9C</span></td>
        </tr>
        <tr>
          <td id="L4330" data-line-number="4330"></td>
          <td id="LC4330"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4331" data-line-number="4331"></td>
          <td id="LC4331">
</td>
        </tr>
        <tr>
          <td id="L4332" data-line-number="4332"></td>
          <td id="LC4332"><span>Private</span> <span>Function</span> <span>pvTlsBulkDecrypt(</span><span>ByVal</span> <span>eBulk</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baRemoteIV()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baRemoteKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baAad()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lAadPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lAadSize</span> <span>As</span> <span>Long</span><span>,</span> <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L4333" data-line-number="4333"></td>
          <td id="LC4333">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsBulkDecrypt&#34;</span></td>
        </tr>
        <tr>
          <td id="L4334" data-line-number="4334"></td>
          <td id="LC4334">    </td>
        </tr>
        <tr>
          <td id="L4335" data-line-number="4335"></td>
          <td id="LC4335">    <span>Select</span> <span>Case</span> <span>eBulk</span></td>
        </tr>
        <tr>
          <td id="L4336" data-line-number="4336"></td>
          <td id="LC4336">    <span>Case</span> <span>ucsTlsAlgoBulkChacha20Poly1305</span></td>
        </tr>
        <tr>
          <td id="L4337" data-line-number="4337"></td>
          <td id="LC4337">        <span>If</span> <span>Not</span> <span>pvCryptoBulkChacha20Poly1305Decrypt(baRemoteIV,</span> <span>baRemoteKey,</span> <span>baAad,</span> <span>lAadPos,</span> <span>lAadSize,</span> <span>baBuffer,</span> <span>lPos,</span> <span>lSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4338" data-line-number="4338"></td>
          <td id="LC4338">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4339" data-line-number="4339"></td>
          <td id="LC4339">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4340" data-line-number="4340"></td>
          <td id="LC4340">    <span>Case</span> <span>ucsTlsAlgoBulkAesGcm128,</span> <span>ucsTlsAlgoBulkAesGcm256</span></td>
        </tr>
        <tr>
          <td id="L4341" data-line-number="4341"></td>
          <td id="LC4341">        <span>If</span> <span>Not</span> <span>pvCryptoBulkAesGcmDecrypt(baRemoteIV,</span> <span>baRemoteKey,</span> <span>baAad,</span> <span>lAadPos,</span> <span>lAadSize,</span> <span>baBuffer,</span> <span>lPos,</span> <span>lSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4342" data-line-number="4342"></td>
          <td id="LC4342">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4343" data-line-number="4343"></td>
          <td id="LC4343">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4344" data-line-number="4344"></td>
          <td id="LC4344">    <span>Case</span> <span>ucsTlsAlgoBulkAesCbc128,</span> <span>ucsTlsAlgoBulkAesCbc256</span></td>
        </tr>
        <tr>
          <td id="L4345" data-line-number="4345"></td>
          <td id="LC4345">        <span>If</span> <span>Not</span> <span>pvCryptoBulkAesCbcDecrypt(baRemoteIV,</span> <span>baRemoteKey,</span> <span>baBuffer,</span> <span>lPos,</span> <span>lSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4346" data-line-number="4346"></td>
          <td id="LC4346">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4347" data-line-number="4347"></td>
          <td id="LC4347">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4348" data-line-number="4348"></td>
          <td id="LC4348">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4349" data-line-number="4349"></td>
          <td id="LC4349">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>&#34;Unsupported bulk type &#34;</span> <span>&amp;</span> <span>eBulk</span></td>
        </tr>
        <tr>
          <td id="L4350" data-line-number="4350"></td>
          <td id="LC4350">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4351" data-line-number="4351"></td>
          <td id="LC4351">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L4352" data-line-number="4352"></td>
          <td id="LC4352">    <span>pvTlsBulkDecrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L4353" data-line-number="4353"></td>
          <td id="LC4353"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L4354" data-line-number="4354"></td>
          <td id="LC4354"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4355" data-line-number="4355"></td>
          <td id="LC4355">
</td>
        </tr>
        <tr>
          <td id="L4356" data-line-number="4356"></td>
          <td id="LC4356"><span>Private</span> <span>Sub</span> <span>pvTlsBulkEncrypt(</span><span>ByVal</span> <span>eBulk</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baLocalIV()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baLocalKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baAad()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lAadPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lAadSize</span> <span>As</span> <span>Long</span><span>,</span> <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4357" data-line-number="4357"></td>
          <td id="LC4357">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsBulkEncrypt&#34;</span></td>
        </tr>
        <tr>
          <td id="L4358" data-line-number="4358"></td>
          <td id="LC4358">    </td>
        </tr>
        <tr>
          <td id="L4359" data-line-number="4359"></td>
          <td id="LC4359">    <span>Select</span> <span>Case</span> <span>eBulk</span></td>
        </tr>
        <tr>
          <td id="L4360" data-line-number="4360"></td>
          <td id="LC4360">    <span>Case</span> <span>ucsTlsAlgoBulkChacha20Poly1305</span></td>
        </tr>
        <tr>
          <td id="L4361" data-line-number="4361"></td>
          <td id="LC4361">        <span>If</span> <span>Not</span> <span>pvCryptoBulkChacha20Poly1305Encrypt(baLocalIV,</span> <span>baLocalKey,</span> <span>baAad,</span> <span>lAadPos,</span> <span>lAadSize,</span> <span>baBuffer,</span> <span>lPos,</span> <span>lSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4362" data-line-number="4362"></td>
          <td id="LC4362">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_ENCRYPTION_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoBulkChacha20Poly1305Encrypt&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4363" data-line-number="4363"></td>
          <td id="LC4363">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4364" data-line-number="4364"></td>
          <td id="LC4364">    <span>Case</span> <span>ucsTlsAlgoBulkAesGcm128,</span> <span>ucsTlsAlgoBulkAesGcm256</span></td>
        </tr>
        <tr>
          <td id="L4365" data-line-number="4365"></td>
          <td id="LC4365">        <span>If</span> <span>Not</span> <span>pvCryptoBulkAesGcmEncrypt(baLocalIV,</span> <span>baLocalKey,</span> <span>baAad,</span> <span>lAadPos,</span> <span>lAadSize,</span> <span>baBuffer,</span> <span>lPos,</span> <span>lSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4366" data-line-number="4366"></td>
          <td id="LC4366">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_ENCRYPTION_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoBulkAesGcmEncrypt&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4367" data-line-number="4367"></td>
          <td id="LC4367">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4368" data-line-number="4368"></td>
          <td id="LC4368">    <span>Case</span> <span>ucsTlsAlgoBulkAesCbc128,</span> <span>ucsTlsAlgoBulkAesCbc256</span></td>
        </tr>
        <tr>
          <td id="L4369" data-line-number="4369"></td>
          <td id="LC4369">        <span>If</span> <span>Not</span> <span>pvCryptoBulkAesCbcEncrypt(baLocalIV,</span> <span>baLocalKey,</span> <span>baBuffer,</span> <span>lPos,</span> <span>lSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4370" data-line-number="4370"></td>
          <td id="LC4370">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_ENCRYPTION_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoBulkAesCbcEncrypt&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4371" data-line-number="4371"></td>
          <td id="LC4371">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4372" data-line-number="4372"></td>
          <td id="LC4372">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4373" data-line-number="4373"></td>
          <td id="LC4373">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>&#34;Unsupported bulk type &#34;</span> <span>&amp;</span> <span>eBulk</span></td>
        </tr>
        <tr>
          <td id="L4374" data-line-number="4374"></td>
          <td id="LC4374">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4375" data-line-number="4375"></td>
          <td id="LC4375"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4376" data-line-number="4376"></td>
          <td id="LC4376">
</td>
        </tr>
        <tr>
          <td id="L4377" data-line-number="4377"></td>
          <td id="LC4377"><span>Private</span> <span>Sub</span> <span>pvTlsGetSharedSecret(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>eKeyX</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum,</span> <span>baPriv()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPub()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4378" data-line-number="4378"></td>
          <td id="LC4378">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsGetSharedSecret&#34;</span></td>
        </tr>
        <tr>
          <td id="L4379" data-line-number="4379"></td>
          <td id="LC4379">    </td>
        </tr>
        <tr>
          <td id="L4380" data-line-number="4380"></td>
          <td id="LC4380">    <span>Select</span> <span>Case</span> <span>eKeyX</span></td>
        </tr>
        <tr>
          <td id="L4381" data-line-number="4381"></td>
          <td id="LC4381">    <span>Case</span> <span>ucsTlsAlgoExchX25519</span></td>
        </tr>
        <tr>
          <td id="L4382" data-line-number="4382"></td>
          <td id="LC4382">        <span>If</span> <span>Not</span> <span>pvCryptoEcdhCurve25519SharedSecret(baRetVal,</span> <span>baPriv,</span> <span>baPub)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4383" data-line-number="4383"></td>
          <td id="LC4383">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEcdhCurve25519SharedSecret&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4384" data-line-number="4384"></td>
          <td id="LC4384">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4385" data-line-number="4385"></td>
          <td id="LC4385">    <span>Case</span> <span>ucsTlsAlgoExchSecp256r1</span></td>
        </tr>
        <tr>
          <td id="L4386" data-line-number="4386"></td>
          <td id="LC4386">        <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp256r1SharedSecret(baRetVal,</span> <span>baPriv,</span> <span>baPub)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4387" data-line-number="4387"></td>
          <td id="LC4387">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEcdhSecp256r1SharedSecret&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4388" data-line-number="4388"></td>
          <td id="LC4388">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4389" data-line-number="4389"></td>
          <td id="LC4389">    <span>Case</span> <span>ucsTlsAlgoExchSecp384r1</span></td>
        </tr>
        <tr>
          <td id="L4390" data-line-number="4390"></td>
          <td id="LC4390">        <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp384r1SharedSecret(baRetVal,</span> <span>baPriv,</span> <span>baPub)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4391" data-line-number="4391"></td>
          <td id="LC4391">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEcdhSecp384r1SharedSecret&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4392" data-line-number="4392"></td>
          <td id="LC4392">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4393" data-line-number="4393"></td>
          <td id="LC4393">    <span>Case</span> <span>ucsTlsAlgoExchCertificate</span></td>
        </tr>
        <tr>
          <td id="L4394" data-line-number="4394"></td>
          <td id="LC4394">        <span>baRetVal</span> <span>=</span> <span>baPriv</span></td>
        </tr>
        <tr>
          <td id="L4395" data-line-number="4395"></td>
          <td id="LC4395">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4396" data-line-number="4396"></td>
          <td id="LC4396">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>&#34;Unsupported exchange &#34;</span> <span>&amp;</span> <span>eKeyX</span></td>
        </tr>
        <tr>
          <td id="L4397" data-line-number="4397"></td>
          <td id="LC4397">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4398" data-line-number="4398"></td>
          <td id="LC4398"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4399" data-line-number="4399"></td>
          <td id="LC4399">
</td>
        </tr>
        <tr>
          <td id="L4400" data-line-number="4400"></td>
          <td id="LC4400"><span>Private</span> <span>Function</span> <span>pvTlsGetExchGroupName(</span><span>ByVal</span> <span>lExchGroup</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4401" data-line-number="4401"></td>
          <td id="LC4401">    <span>Select</span> <span>Case</span> <span>lExchGroup</span></td>
        </tr>
        <tr>
          <td id="L4402" data-line-number="4402"></td>
          <td id="LC4402">    <span>Case</span> <span>TLS_GROUP_X25519</span></td>
        </tr>
        <tr>
          <td id="L4403" data-line-number="4403"></td>
          <td id="LC4403">        <span>pvTlsGetExchGroupName</span> <span>=</span> <span>&#34;X25519&#34;</span></td>
        </tr>
        <tr>
          <td id="L4404" data-line-number="4404"></td>
          <td id="LC4404">    <span>Case</span> <span>TLS_GROUP_X448</span></td>
        </tr>
        <tr>
          <td id="L4405" data-line-number="4405"></td>
          <td id="LC4405">        <span>pvTlsGetExchGroupName</span> <span>=</span> <span>&#34;X448&#34;</span></td>
        </tr>
        <tr>
          <td id="L4406" data-line-number="4406"></td>
          <td id="LC4406">    <span>Case</span> <span>TLS_GROUP_SECP256R1</span></td>
        </tr>
        <tr>
          <td id="L4407" data-line-number="4407"></td>
          <td id="LC4407">        <span>pvTlsGetExchGroupName</span> <span>=</span> <span>&#34;secp256r1&#34;</span></td>
        </tr>
        <tr>
          <td id="L4408" data-line-number="4408"></td>
          <td id="LC4408">    <span>Case</span> <span>TLS_GROUP_SECP384R1</span></td>
        </tr>
        <tr>
          <td id="L4409" data-line-number="4409"></td>
          <td id="LC4409">        <span>pvTlsGetExchGroupName</span> <span>=</span> <span>&#34;secp384r1&#34;</span></td>
        </tr>
        <tr>
          <td id="L4410" data-line-number="4410"></td>
          <td id="LC4410">    <span>Case</span> <span>TLS_GROUP_SECP521R1</span></td>
        </tr>
        <tr>
          <td id="L4411" data-line-number="4411"></td>
          <td id="LC4411">        <span>pvTlsGetExchGroupName</span> <span>=</span> <span>&#34;secp521r1&#34;</span></td>
        </tr>
        <tr>
          <td id="L4412" data-line-number="4412"></td>
          <td id="LC4412">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4413" data-line-number="4413"></td>
          <td id="LC4413">        <span>pvTlsGetExchGroupName</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;0x&#34;</span> <span>&amp;</span> <span>Hex$(lExchGroup))</span></td>
        </tr>
        <tr>
          <td id="L4414" data-line-number="4414"></td>
          <td id="LC4414">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4415" data-line-number="4415"></td>
          <td id="LC4415"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4416" data-line-number="4416"></td>
          <td id="LC4416">
</td>
        </tr>
        <tr>
          <td id="L4417" data-line-number="4417"></td>
          <td id="LC4417"><span>Private</span> <span>Function</span> <span>pvTlsGetCipherSuiteName(</span><span>ByVal</span> <span>lCipherSuite</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4418" data-line-number="4418"></td>
          <td id="LC4418">    <span>Select</span> <span>Case</span> <span>lCipherSuite</span></td>
        </tr>
        <tr>
          <td id="L4419" data-line-number="4419"></td>
          <td id="LC4419">    <span>Case</span> <span>TLS_CS_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4420" data-line-number="4420"></td>
          <td id="LC4420">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;TLS_AES_128_GCM_SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4421" data-line-number="4421"></td>
          <td id="LC4421">    <span>Case</span> <span>TLS_CS_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4422" data-line-number="4422"></td>
          <td id="LC4422">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;TLS_AES_256_GCM_SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4423" data-line-number="4423"></td>
          <td id="LC4423">    <span>Case</span> <span>TLS_CS_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4424" data-line-number="4424"></td>
          <td id="LC4424">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;TLS_CHACHA20_POLY1305_SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4425" data-line-number="4425"></td>
          <td id="LC4425">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4426" data-line-number="4426"></td>
          <td id="LC4426">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-AES128-GCM-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4427" data-line-number="4427"></td>
          <td id="LC4427">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4428" data-line-number="4428"></td>
          <td id="LC4428">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-AES256-GCM-SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4429" data-line-number="4429"></td>
          <td id="LC4429">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4430" data-line-number="4430"></td>
          <td id="LC4430">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-AES128-GCM-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4431" data-line-number="4431"></td>
          <td id="LC4431">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4432" data-line-number="4432"></td>
          <td id="LC4432">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-AES256-GCM-SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4433" data-line-number="4433"></td>
          <td id="LC4433">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4434" data-line-number="4434"></td>
          <td id="LC4434">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-CHACHA20-POLY1305&#34;</span></td>
        </tr>
        <tr>
          <td id="L4435" data-line-number="4435"></td>
          <td id="LC4435">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4436" data-line-number="4436"></td>
          <td id="LC4436">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-CHACHA20-POLY1305&#34;</span></td>
        </tr>
        <tr>
          <td id="L4437" data-line-number="4437"></td>
          <td id="LC4437">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L4438" data-line-number="4438"></td>
          <td id="LC4438">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-AES128-SHA&#34;</span></td>
        </tr>
        <tr>
          <td id="L4439" data-line-number="4439"></td>
          <td id="LC4439">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L4440" data-line-number="4440"></td>
          <td id="LC4440">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-AES256-SHA&#34;</span></td>
        </tr>
        <tr>
          <td id="L4441" data-line-number="4441"></td>
          <td id="LC4441">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L4442" data-line-number="4442"></td>
          <td id="LC4442">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-AES128-SHA&#34;</span></td>
        </tr>
        <tr>
          <td id="L4443" data-line-number="4443"></td>
          <td id="LC4443">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L4444" data-line-number="4444"></td>
          <td id="LC4444">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-AES256-SHA&#34;</span></td>
        </tr>
        <tr>
          <td id="L4445" data-line-number="4445"></td>
          <td id="LC4445">    <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_GCM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4446" data-line-number="4446"></td>
          <td id="LC4446">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;AES128-GCM-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4447" data-line-number="4447"></td>
          <td id="LC4447">    <span>Case</span> <span>TLS_CS_RSA_WITH_AES_256_GCM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4448" data-line-number="4448"></td>
          <td id="LC4448">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;AES256-GCM-SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4449" data-line-number="4449"></td>
          <td id="LC4449">    <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L4450" data-line-number="4450"></td>
          <td id="LC4450">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;AES128-SHA&#34;</span></td>
        </tr>
        <tr>
          <td id="L4451" data-line-number="4451"></td>
          <td id="LC4451">    <span>Case</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA</span></td>
        </tr>
        <tr>
          <td id="L4452" data-line-number="4452"></td>
          <td id="LC4452">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;AES256-SHA&#34;</span></td>
        </tr>
        <tr>
          <td id="L4453" data-line-number="4453"></td>
          <td id="LC4453">    <span>Case</span> <span>TLS_CS_RSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4454" data-line-number="4454"></td>
          <td id="LC4454">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;AES128-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4455" data-line-number="4455"></td>
          <td id="LC4455">    <span>Case</span> <span>TLS_CS_RSA_WITH_AES_256_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4456" data-line-number="4456"></td>
          <td id="LC4456">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;AES256-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4457" data-line-number="4457"></td>
          <td id="LC4457">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4458" data-line-number="4458"></td>
          <td id="LC4458">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-AES128-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4459" data-line-number="4459"></td>
          <td id="LC4459">    <span>Case</span> <span>TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4460" data-line-number="4460"></td>
          <td id="LC4460">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-ECDSA-AES256-SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4461" data-line-number="4461"></td>
          <td id="LC4461">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4462" data-line-number="4462"></td>
          <td id="LC4462">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-AES128-SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4463" data-line-number="4463"></td>
          <td id="LC4463">    <span>Case</span> <span>TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4464" data-line-number="4464"></td>
          <td id="LC4464">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>&#34;ECDHE-RSA-AES256-SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4465" data-line-number="4465"></td>
          <td id="LC4465">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4466" data-line-number="4466"></td>
          <td id="LC4466">        <span>pvTlsGetCipherSuiteName</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;0x&#34;</span> <span>&amp;</span> <span>Hex$(lCipherSuite))</span></td>
        </tr>
        <tr>
          <td id="L4467" data-line-number="4467"></td>
          <td id="LC4467">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4468" data-line-number="4468"></td>
          <td id="LC4468"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4469" data-line-number="4469"></td>
          <td id="LC4469">
</td>
        </tr>
        <tr>
          <td id="L4470" data-line-number="4470"></td>
          <td id="LC4470"><span>Private</span> <span>Function</span> <span>pvTlsGetSignatureName(</span><span>ByVal</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4471" data-line-number="4471"></td>
          <td id="LC4471">    <span>Select</span> <span>Case</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L4472" data-line-number="4472"></td>
          <td id="LC4472">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1</span></td>
        </tr>
        <tr>
          <td id="L4473" data-line-number="4473"></td>
          <td id="LC4473">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PKCS1_SHA1&#34;</span></td>
        </tr>
        <tr>
          <td id="L4474" data-line-number="4474"></td>
          <td id="LC4474">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SHA1</span></td>
        </tr>
        <tr>
          <td id="L4475" data-line-number="4475"></td>
          <td id="LC4475">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;ECDSA_SHA1&#34;</span></td>
        </tr>
        <tr>
          <td id="L4476" data-line-number="4476"></td>
          <td id="LC4476">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA224</span></td>
        </tr>
        <tr>
          <td id="L4477" data-line-number="4477"></td>
          <td id="LC4477">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PKCS1_SHA224&#34;</span></td>
        </tr>
        <tr>
          <td id="L4478" data-line-number="4478"></td>
          <td id="LC4478">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4479" data-line-number="4479"></td>
          <td id="LC4479">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PKCS1_SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4480" data-line-number="4480"></td>
          <td id="LC4480">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4481" data-line-number="4481"></td>
          <td id="LC4481">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PKCS1_SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4482" data-line-number="4482"></td>
          <td id="LC4482">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4483" data-line-number="4483"></td>
          <td id="LC4483">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PKCS1_SHA512&#34;</span></td>
        </tr>
        <tr>
          <td id="L4484" data-line-number="4484"></td>
          <td id="LC4484">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4485" data-line-number="4485"></td>
          <td id="LC4485">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;ECDSA_SECP256R1_SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4486" data-line-number="4486"></td>
          <td id="LC4486">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4487" data-line-number="4487"></td>
          <td id="LC4487">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;ECDSA_SECP384R1_SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4488" data-line-number="4488"></td>
          <td id="LC4488">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4489" data-line-number="4489"></td>
          <td id="LC4489">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;ECDSA_SECP521R1_SHA512&#34;</span></td>
        </tr>
        <tr>
          <td id="L4490" data-line-number="4490"></td>
          <td id="LC4490">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4491" data-line-number="4491"></td>
          <td id="LC4491">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PSS_RSAE_SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4492" data-line-number="4492"></td>
          <td id="LC4492">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4493" data-line-number="4493"></td>
          <td id="LC4493">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PSS_RSAE_SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4494" data-line-number="4494"></td>
          <td id="LC4494">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4495" data-line-number="4495"></td>
          <td id="LC4495">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PSS_RSAE_SHA512&#34;</span></td>
        </tr>
        <tr>
          <td id="L4496" data-line-number="4496"></td>
          <td id="LC4496">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4497" data-line-number="4497"></td>
          <td id="LC4497">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PSS_PSS_SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4498" data-line-number="4498"></td>
          <td id="LC4498">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4499" data-line-number="4499"></td>
          <td id="LC4499">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PSS_PSS_SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4500" data-line-number="4500"></td>
          <td id="LC4500">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4501" data-line-number="4501"></td>
          <td id="LC4501">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>&#34;RSA_PSS_PSS_SHA512&#34;</span></td>
        </tr>
        <tr>
          <td id="L4502" data-line-number="4502"></td>
          <td id="LC4502">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4503" data-line-number="4503"></td>
          <td id="LC4503">        <span>pvTlsGetSignatureName</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;0x&#34;</span> <span>&amp;</span> <span>Hex$(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4504" data-line-number="4504"></td>
          <td id="LC4504">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4505" data-line-number="4505"></td>
          <td id="LC4505"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4506" data-line-number="4506"></td>
          <td id="LC4506">
</td>
        </tr>
        <tr>
          <td id="L4507" data-line-number="4507"></td>
          <td id="LC4507"><span>Private</span> <span>Function</span> <span>pvTlsGetHashName(</span><span>ByVal</span> <span>eAlgo</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4508" data-line-number="4508"></td>
          <td id="LC4508">    <span>Select</span> <span>Case</span> <span>eAlgo</span></td>
        </tr>
        <tr>
          <td id="L4509" data-line-number="4509"></td>
          <td id="LC4509">    <span>Case</span> <span>ucsTlsAlgoDigestMd5</span></td>
        </tr>
        <tr>
          <td id="L4510" data-line-number="4510"></td>
          <td id="LC4510">        <span>pvTlsGetHashName</span> <span>=</span> <span>&#34;MD5&#34;</span></td>
        </tr>
        <tr>
          <td id="L4511" data-line-number="4511"></td>
          <td id="LC4511">    <span>Case</span> <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L4512" data-line-number="4512"></td>
          <td id="LC4512">        <span>pvTlsGetHashName</span> <span>=</span> <span>&#34;SHA1&#34;</span></td>
        </tr>
        <tr>
          <td id="L4513" data-line-number="4513"></td>
          <td id="LC4513">    <span>Case</span> <span>ucsTlsAlgoDigestSha224</span></td>
        </tr>
        <tr>
          <td id="L4514" data-line-number="4514"></td>
          <td id="LC4514">        <span>pvTlsGetHashName</span> <span>=</span> <span>&#34;SHA224&#34;</span></td>
        </tr>
        <tr>
          <td id="L4515" data-line-number="4515"></td>
          <td id="LC4515">    <span>Case</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4516" data-line-number="4516"></td>
          <td id="LC4516">        <span>pvTlsGetHashName</span> <span>=</span> <span>&#34;SHA256&#34;</span></td>
        </tr>
        <tr>
          <td id="L4517" data-line-number="4517"></td>
          <td id="LC4517">    <span>Case</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4518" data-line-number="4518"></td>
          <td id="LC4518">        <span>pvTlsGetHashName</span> <span>=</span> <span>&#34;SHA384&#34;</span></td>
        </tr>
        <tr>
          <td id="L4519" data-line-number="4519"></td>
          <td id="LC4519">    <span>Case</span> <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L4520" data-line-number="4520"></td>
          <td id="LC4520">        <span>pvTlsGetHashName</span> <span>=</span> <span>&#34;SHA512&#34;</span></td>
        </tr>
        <tr>
          <td id="L4521" data-line-number="4521"></td>
          <td id="LC4521">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4522" data-line-number="4522"></td>
          <td id="LC4522">        <span>pvTlsGetHashName</span> <span>=</span> <span>Replace(STR_UNKNOWN,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;0x&#34;</span> <span>&amp;</span> <span>Hex$(eAlgo))</span></td>
        </tr>
        <tr>
          <td id="L4523" data-line-number="4523"></td>
          <td id="LC4523">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4524" data-line-number="4524"></td>
          <td id="LC4524"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4525" data-line-number="4525"></td>
          <td id="LC4525">
</td>
        </tr>
        <tr>
          <td id="L4526" data-line-number="4526"></td>
          <td id="LC4526"><span>Private</span> <span>Function</span> <span>pvTlsGetHashAlgId(</span><span>ByVal</span> <span>eAlgo</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4527" data-line-number="4527"></td>
          <td id="LC4527">    <span>Select</span> <span>Case</span> <span>eAlgo</span></td>
        </tr>
        <tr>
          <td id="L4528" data-line-number="4528"></td>
          <td id="LC4528">    <span>Case</span> <span>ucsTlsAlgoDigestMd5</span></td>
        </tr>
        <tr>
          <td id="L4529" data-line-number="4529"></td>
          <td id="LC4529">        <span>pvTlsGetHashAlgId</span> <span>=</span> <span>CALG_SSL3_SHAMD5</span></td>
        </tr>
        <tr>
          <td id="L4530" data-line-number="4530"></td>
          <td id="LC4530">    <span>Case</span> <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L4531" data-line-number="4531"></td>
          <td id="LC4531">        <span>pvTlsGetHashAlgId</span> <span>=</span> <span>CALG_SHA1</span></td>
        </tr>
        <tr>
          <td id="L4532" data-line-number="4532"></td>
          <td id="LC4532">    <span>Case</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4533" data-line-number="4533"></td>
          <td id="LC4533">        <span>pvTlsGetHashAlgId</span> <span>=</span> <span>CALG_SHA_256</span></td>
        </tr>
        <tr>
          <td id="L4534" data-line-number="4534"></td>
          <td id="LC4534">    <span>Case</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4535" data-line-number="4535"></td>
          <td id="LC4535">        <span>pvTlsGetHashAlgId</span> <span>=</span> <span>CALG_SHA_384</span></td>
        </tr>
        <tr>
          <td id="L4536" data-line-number="4536"></td>
          <td id="LC4536">    <span>Case</span> <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L4537" data-line-number="4537"></td>
          <td id="LC4537">        <span>pvTlsGetHashAlgId</span> <span>=</span> <span>CALG_SHA_512</span></td>
        </tr>
        <tr>
          <td id="L4538" data-line-number="4538"></td>
          <td id="LC4538">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4539" data-line-number="4539"></td>
          <td id="LC4539">        <span>pvTlsGetHashAlgId</span> <span>=</span> <span>-</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L4540" data-line-number="4540"></td>
          <td id="LC4540">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4541" data-line-number="4541"></td>
          <td id="LC4541"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4542" data-line-number="4542"></td>
          <td id="LC4542">
</td>
        </tr>
        <tr>
          <td id="L4543" data-line-number="4543"></td>
          <td id="LC4543"><span>Private</span> <span>Sub</span> <span>pvTlsSignatureSign(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>cCerts</span> <span>As</span> <span>Collection,</span> <span>cPrivKey</span> <span>As</span> <span>Collection,</span> <span>ByVal</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span><span>,</span> <span>baVerifyData()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4544" data-line-number="4544"></td>
          <td id="LC4544">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSignatureSign&#34;</span></td>
        </tr>
        <tr>
          <td id="L4545" data-line-number="4545"></td>
          <td id="LC4545">    <span>Dim</span> <span>baSignature()</span>   <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4546" data-line-number="4546"></td>
          <td id="LC4546">    <span>Dim</span> <span>uKeyInfo</span>        <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L4547" data-line-number="4547"></td>
          <td id="LC4547">    <span>Dim</span> <span>lHashSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4548" data-line-number="4548"></td>
          <td id="LC4548">    <span>Dim</span> <span>baEnc()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4549" data-line-number="4549"></td>
          <td id="LC4549">    <span>Dim</span> <span>baVerifyHash()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4550" data-line-number="4550"></td>
          <td id="LC4550">    <span>Dim</span> <span>sHashAlg</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4551" data-line-number="4551"></td>
          <td id="LC4551">    <span>Dim</span> <span>uPadInfo</span>        <span>As</span> <span>BCRYPT_PSS_PADDING_INFO</span></td>
        </tr>
        <tr>
          <td id="L4552" data-line-number="4552"></td>
          <td id="LC4552">    <span>Dim</span> <span>lPadPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4553" data-line-number="4553"></td>
          <td id="LC4553">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4554" data-line-number="4554"></td>
          <td id="LC4554">    <span>Dim</span> <span>dwFlags</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4555" data-line-number="4555"></td>
          <td id="LC4555">    <span>Dim</span> <span>lAlgId</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4556" data-line-number="4556"></td>
          <td id="LC4556">    <span>Dim</span> <span>hProvHash</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4557" data-line-number="4557"></td>
          <td id="LC4557">    <span>Dim</span> <span>hHash</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4558" data-line-number="4558"></td>
          <td id="LC4558">    <span>Dim</span> <span>hResult</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4559" data-line-number="4559"></td>
          <td id="LC4559">    <span>Dim</span> <span>sApiSource</span>      <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4560" data-line-number="4560"></td>
          <td id="LC4560">    <span>Dim</span> <span>sErrDesc</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L4561" data-line-number="4561"></td>
          <td id="LC4561">        </td>
        </tr>
        <tr>
          <td id="L4562" data-line-number="4562"></td>
          <td id="LC4562">    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4563" data-line-number="4563"></td>
          <td id="LC4563">        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;Signing with &#34;</span> <span>&amp;</span> <span>pvTlsGetSignatureName(lSignatureScheme)</span> <span>&amp;</span> <span>&#34; signature&#34;</span></td>
        </tr>
        <tr>
          <td id="L4564" data-line-number="4564"></td>
          <td id="LC4564">    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4565" data-line-number="4565"></td>
          <td id="LC4565">    <span>If</span> <span>Not</span> <span>pvAsn1DecodePrivateKey(cCerts,</span> <span>cPrivKey,</span> <span>uKeyInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4566" data-line-number="4566"></td>
          <td id="LC4566">        <span>sErrDesc</span> <span>=</span> <span>ERR_UNSUPPORTED_PRIVATE_KEY</span></td>
        </tr>
        <tr>
          <td id="L4567" data-line-number="4567"></td>
          <td id="LC4567">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4568" data-line-number="4568"></td>
          <td id="LC4568">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4569" data-line-number="4569"></td>
          <td id="LC4569">    <span>lHashSize</span> <span>=</span> <span>pvTlsSignatureHashSize(lSignatureScheme)</span></td>
        </tr>
        <tr>
          <td id="L4570" data-line-number="4570"></td>
          <td id="LC4570">    <span>If</span> <span>uKeyInfo.hNKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4571" data-line-number="4571"></td>
          <td id="LC4571">        <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4572" data-line-number="4572"></td>
          <td id="LC4572">            <span>sHashAlg</span> <span>=</span> <span>pvTlsGetHashName(pvTlsSignatureDigestAlgo(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4573" data-line-number="4573"></td>
          <td id="LC4573">            <span>uPadInfo.pszAlgId</span> <span>=</span> <span>StrPtr(sHashAlg)</span></td>
        </tr>
        <tr>
          <td id="L4574" data-line-number="4574"></td>
          <td id="LC4574">            <span>If</span> <span>(lSignatureScheme</span> <span>And</span> <span>&amp;HFF</span><span>)</span> <span>=</span> <span>(TLS_SIGNATURE_RSA_PKCS1_SHA1</span> <span>And</span> <span>&amp;HFF</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4575" data-line-number="4575"></td>
          <td id="LC4575">                <span>dwFlags</span> <span>=</span> <span>BCRYPT_PAD_PKCS1</span></td>
        </tr>
        <tr>
          <td id="L4576" data-line-number="4576"></td>
          <td id="LC4576">            <span>ElseIf</span> <span>(lSignatureScheme</span> <span>\</span> <span>&amp;H100</span><span>)</span> <span>=</span> <span>(TLS_SIGNATURE_RSA_PSS_RSAE_SHA256</span> <span>\</span> <span>&amp;H100</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4577" data-line-number="4577"></td>
          <td id="LC4577">                <span>dwFlags</span> <span>=</span> <span>BCRYPT_PAD_PSS</span></td>
        </tr>
        <tr>
          <td id="L4578" data-line-number="4578"></td>
          <td id="LC4578">                <span>uPadInfo.cbSalt</span> <span>=</span> <span>lHashSize</span></td>
        </tr>
        <tr>
          <td id="L4579" data-line-number="4579"></td>
          <td id="LC4579">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4580" data-line-number="4580"></td>
          <td id="LC4580">            <span>lPadPtr</span> <span>=</span> <span>VarPtr(uPadInfo)</span></td>
        </tr>
        <tr>
          <td id="L4581" data-line-number="4581"></td>
          <td id="LC4581">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4582" data-line-number="4582"></td>
          <td id="LC4582">        <span>pvArrayHash</span> <span>lHashSize,</span> <span>baVerifyData,</span> <span>baVerifyHash</span></td>
        </tr>
        <tr>
          <td id="L4583" data-line-number="4583"></td>
          <td id="LC4583">        <span>hResult</span> <span>=</span> <span>NCryptSignHash(uKeyInfo.hNKey,</span> <span>lPadPtr,</span> <span>baVerifyHash(</span><span>0</span><span>),</span> <span>UBound(baVerifyHash)</span> <span>+</span> <span>1</span><span>,</span> <span>ByVal</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>lSize,</span> <span>dwFlags)</span></td>
        </tr>
        <tr>
          <td id="L4584" data-line-number="4584"></td>
          <td id="LC4584">        <span>If</span> <span>hResult</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4585" data-line-number="4585"></td>
          <td id="LC4585">            <span>sApiSource</span> <span>=</span> <span>&#34;NCryptSignHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4586" data-line-number="4586"></td>
          <td id="LC4586">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4587" data-line-number="4587"></td>
          <td id="LC4587">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4588" data-line-number="4588"></td>
          <td id="LC4588">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L4589" data-line-number="4589"></td>
          <td id="LC4589">        <span>hResult</span> <span>=</span> <span>NCryptSignHash(uKeyInfo.hNKey,</span> <span>lPadPtr,</span> <span>baVerifyHash(</span><span>0</span><span>),</span> <span>UBound(baVerifyHash)</span> <span>+</span> <span>1</span><span>,</span> <span>baRetVal(</span><span>0</span><span>),</span> <span>lSize,</span> <span>lSize,</span> <span>dwFlags)</span></td>
        </tr>
        <tr>
          <td id="L4590" data-line-number="4590"></td>
          <td id="LC4590">        <span>If</span> <span>hResult</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4591" data-line-number="4591"></td>
          <td id="LC4591">            <span>sApiSource</span> <span>=</span> <span>&#34;NCryptSignHash#2&#34;</span></td>
        </tr>
        <tr>
          <td id="L4592" data-line-number="4592"></td>
          <td id="LC4592">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4593" data-line-number="4593"></td>
          <td id="LC4593">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4594" data-line-number="4594"></td>
          <td id="LC4594">        <span>pvArrayReallocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L4595" data-line-number="4595"></td>
          <td id="LC4595">        <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_PUBLIC_KEY</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4596" data-line-number="4596"></td>
          <td id="LC4596">            <span>baSignature</span> <span>=</span> <span>baRetVal</span></td>
        </tr>
        <tr>
          <td id="L4597" data-line-number="4597"></td>
          <td id="LC4597">            <span>If</span> <span>Not</span> <span>pvAsn1EncodeEcdsaSignature(baRetVal,</span> <span>baSignature,</span> <span>(UBound(baSignature)</span> <span>+</span> <span>1</span><span>)</span> <span>\</span> <span>2</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4598" data-line-number="4598"></td>
          <td id="LC4598">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;Asn1EncodeEcdsaSignature&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4599" data-line-number="4599"></td>
          <td id="LC4599">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4600" data-line-number="4600"></td>
          <td id="LC4600">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4601" data-line-number="4601"></td>
          <td id="LC4601">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4602" data-line-number="4602"></td>
          <td id="LC4602">    <span>ElseIf</span> <span>uKeyInfo.hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>uKeyInfo.hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4603" data-line-number="4603"></td>
          <td id="LC4603">        <span>Debug.Assert</span> <span>(lSignatureScheme</span> <span>And</span> <span>&amp;HFF</span><span>)</span> <span>=</span> <span>(TLS_SIGNATURE_RSA_PKCS1_SHA1</span> <span>And</span> <span>&amp;HFF</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4604" data-line-number="4604"></td>
          <td id="LC4604">        <span>lAlgId</span> <span>=</span> <span>pvTlsGetHashAlgId(pvTlsSignatureDigestAlgo(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4605" data-line-number="4605"></td>
          <td id="LC4605">        <span>If</span> <span>CryptCreateHash(uKeyInfo.hProv,</span> <span>lAlgId,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>hHash)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4606" data-line-number="4606"></td>
          <td id="LC4606">            <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L4607" data-line-number="4607"></td>
          <td id="LC4607">            <span>sApiSource</span> <span>=</span> <span>&#34;CryptCreateHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4608" data-line-number="4608"></td>
          <td id="LC4608">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4609" data-line-number="4609"></td>
          <td id="LC4609">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4610" data-line-number="4610"></td>
          <td id="LC4610">        <span>If</span> <span>CryptGetHashParam(hHash,</span> <span>HP_HASHSIZE,</span> <span>lSize,</span> <span>LenB(lSize),</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4611" data-line-number="4611"></td>
          <td id="LC4611">            <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L4612" data-line-number="4612"></td>
          <td id="LC4612">            <span>sApiSource</span> <span>=</span> <span>&#34;CryptGetHashParam(HP_HASHSIZE)&#34;</span></td>
        </tr>
        <tr>
          <td id="L4613" data-line-number="4613"></td>
          <td id="LC4613">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4614" data-line-number="4614"></td>
          <td id="LC4614">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4615" data-line-number="4615"></td>
          <td id="LC4615">        <span>If</span> <span>lSize</span> <span>&lt;&gt;</span> <span>lHashSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4616" data-line-number="4616"></td>
          <td id="LC4616">            <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_INVALID_HASH_SIZE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lSize</span> <span>&amp;</span> <span>&#34;&lt;&gt;&#34;</span> <span>&amp;</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L4617" data-line-number="4617"></td>
          <td id="LC4617">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4618" data-line-number="4618"></td>
          <td id="LC4618">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4619" data-line-number="4619"></td>
          <td id="LC4619">        <span>pvArrayHash</span> <span>lHashSize,</span> <span>baVerifyData,</span> <span>baVerifyHash</span></td>
        </tr>
        <tr>
          <td id="L4620" data-line-number="4620"></td>
          <td id="LC4620">        <span>If</span> <span>CryptSetHashParam(hHash,</span> <span>HP_HASHVAL,</span> <span>baVerifyHash(</span><span>0</span><span>),</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4621" data-line-number="4621"></td>
          <td id="LC4621">            <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L4622" data-line-number="4622"></td>
          <td id="LC4622">            <span>sApiSource</span> <span>=</span> <span>&#34;CryptSetHashParam(HP_HASHVAL)&#34;</span></td>
        </tr>
        <tr>
          <td id="L4623" data-line-number="4623"></td>
          <td id="LC4623">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4624" data-line-number="4624"></td>
          <td id="LC4624">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4625" data-line-number="4625"></td>
          <td id="LC4625">        <span>If</span> <span>CryptSignHash(hHash,</span> <span>uKeyInfo.dwKeySpec,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>ByVal</span> <span>0</span><span>,</span> <span>lSize)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4626" data-line-number="4626"></td>
          <td id="LC4626">            <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L4627" data-line-number="4627"></td>
          <td id="LC4627">            <span>sApiSource</span> <span>=</span> <span>&#34;CryptSignHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4628" data-line-number="4628"></td>
          <td id="LC4628">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4629" data-line-number="4629"></td>
          <td id="LC4629">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4630" data-line-number="4630"></td>
          <td id="LC4630">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L4631" data-line-number="4631"></td>
          <td id="LC4631">        <span>If</span> <span>CryptSignHash(hHash,</span> <span>uKeyInfo.dwKeySpec,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>baRetVal(</span><span>0</span><span>),</span> <span>lSize)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4632" data-line-number="4632"></td>
          <td id="LC4632">            <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L4633" data-line-number="4633"></td>
          <td id="LC4633">            <span>sApiSource</span> <span>=</span> <span>&#34;CryptSignHash#2&#34;</span></td>
        </tr>
        <tr>
          <td id="L4634" data-line-number="4634"></td>
          <td id="LC4634">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4635" data-line-number="4635"></td>
          <td id="LC4635">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4636" data-line-number="4636"></td>
          <td id="LC4636">        <span>pvArrayReallocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L4637" data-line-number="4637"></td>
          <td id="LC4637">        <span>pvArrayReverse</span> <span>baRetVal</span></td>
        </tr>
        <tr>
          <td id="L4638" data-line-number="4638"></td>
          <td id="LC4638">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4639" data-line-number="4639"></td>
          <td id="LC4639">        <span>Select</span> <span>Case</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L4640" data-line-number="4640"></td>
          <td id="LC4640">        <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA224,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA256,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA384,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4641" data-line-number="4641"></td>
          <td id="LC4641">            <span>Debug.Assert</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span></td>
        </tr>
        <tr>
          <td id="L4642" data-line-number="4642"></td>
          <td id="LC4642">            <span>If</span> <span>Not</span> <span>pvCryptoEmsaPkcs1Encode(baEnc,</span> <span>baVerifyData,</span> <span>uKeyInfo.BitLen,</span> <span>lHashSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4643" data-line-number="4643"></td>
          <td id="LC4643">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEmsaPkcs1Encode&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4644" data-line-number="4644"></td>
          <td id="LC4644">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4645" data-line-number="4645"></td>
          <td id="LC4645">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4646" data-line-number="4646"></td>
          <td id="LC4646">            <span>If</span> <span>Not</span> <span>pvCryptoRsaCrtModExp(baEnc,</span> <span>uKeyInfo.PrivExp,</span> <span>uKeyInfo.Modulus,</span> <span>uKeyInfo.Prime1,</span> <span>uKeyInfo.Prime2,</span> <span>uKeyInfo.Coefficient,</span> <span>baRetVal)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4647" data-line-number="4647"></td>
          <td id="LC4647">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoRsaCrtModExp&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4648" data-line-number="4648"></td>
          <td id="LC4648">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4649" data-line-number="4649"></td>
          <td id="LC4649">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4650" data-line-number="4650"></td>
          <td id="LC4650">        <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L4651" data-line-number="4651"></td>
          <td id="LC4651">                <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4652" data-line-number="4652"></td>
          <td id="LC4652">            <span>Debug.Assert</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Or</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_RSA_SSA_PSS</span></td>
        </tr>
        <tr>
          <td id="L4653" data-line-number="4653"></td>
          <td id="LC4653">            <span>If</span> <span>Not</span> <span>pvCryptoEmsaPssEncode(baEnc,</span> <span>baVerifyData,</span> <span>uKeyInfo.BitLen,</span> <span>lHashSize,</span> <span>lHashSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4654" data-line-number="4654"></td>
          <td id="LC4654">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEmsaPssEncode&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4655" data-line-number="4655"></td>
          <td id="LC4655">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4656" data-line-number="4656"></td>
          <td id="LC4656">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4657" data-line-number="4657"></td>
          <td id="LC4657">            <span>If</span> <span>Not</span> <span>pvCryptoRsaCrtModExp(baEnc,</span> <span>uKeyInfo.PrivExp,</span> <span>uKeyInfo.Modulus,</span> <span>uKeyInfo.Prime1,</span> <span>uKeyInfo.Prime2,</span> <span>uKeyInfo.Coefficient,</span> <span>baRetVal)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4658" data-line-number="4658"></td>
          <td id="LC4658">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoRsaCrtModExp&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4659" data-line-number="4659"></td>
          <td id="LC4659">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4660" data-line-number="4660"></td>
          <td id="LC4660">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4661" data-line-number="4661"></td>
          <td id="LC4661">        <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SHA1</span></td>
        </tr>
        <tr>
          <td id="L4662" data-line-number="4662"></td>
          <td id="LC4662">            <span>If</span> <span>Not</span> <span>pvCryptoHashSha1(baVerifyHash,</span> <span>baVerifyData)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4663" data-line-number="4663"></td>
          <td id="LC4663">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha1&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4664" data-line-number="4664"></td>
          <td id="LC4664">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4665" data-line-number="4665"></td>
          <td id="LC4665">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4666" data-line-number="4666"></td>
          <td id="LC4666">            <span>If</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P256</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4667" data-line-number="4667"></td>
          <td id="LC4667">                <span>GoTo</span> <span>Secp256r1Sign</span></td>
        </tr>
        <tr>
          <td id="L4668" data-line-number="4668"></td>
          <td id="LC4668">            <span>ElseIf</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P384</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4669" data-line-number="4669"></td>
          <td id="LC4669">                <span>GoTo</span> <span>Secp384r1Sign</span></td>
        </tr>
        <tr>
          <td id="L4670" data-line-number="4670"></td>
          <td id="LC4670">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4671" data-line-number="4671"></td>
          <td id="LC4671">        <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4672" data-line-number="4672"></td>
          <td id="LC4672">            <span>Debug.Assert</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P256</span></td>
        </tr>
        <tr>
          <td id="L4673" data-line-number="4673"></td>
          <td id="LC4673">            <span>If</span> <span>Not</span> <span>pvCryptoHashSha256(baVerifyHash,</span> <span>baVerifyData)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4674" data-line-number="4674"></td>
          <td id="LC4674">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha256&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4675" data-line-number="4675"></td>
          <td id="LC4675">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4676" data-line-number="4676"></td>
          <td id="LC4676">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4677" data-line-number="4677"></td>
          <td id="LC4677"><span>Secp256r1Sign:</span></td>
        </tr>
        <tr>
          <td id="L4678" data-line-number="4678"></td>
          <td id="LC4678">            <span>If</span> <span>Not</span> <span>pvCryptoEcdsaSecp256r1Sign(baSignature,</span> <span>uKeyInfo.KeyBlob,</span> <span>baVerifyHash)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4679" data-line-number="4679"></td>
          <td id="LC4679">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEcdsaSecp256r1Sign&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4680" data-line-number="4680"></td>
          <td id="LC4680">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4681" data-line-number="4681"></td>
          <td id="LC4681">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4682" data-line-number="4682"></td>
          <td id="LC4682">            <span>If</span> <span>Not</span> <span>pvAsn1EncodeEcdsaSignature(baRetVal,</span> <span>baSignature,</span> <span>LNG_SECP256R1_KEYSZ)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4683" data-line-number="4683"></td>
          <td id="LC4683">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;Asn1EncodeEcdsaSignature&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4684" data-line-number="4684"></td>
          <td id="LC4684">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4685" data-line-number="4685"></td>
          <td id="LC4685">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4686" data-line-number="4686"></td>
          <td id="LC4686">        <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4687" data-line-number="4687"></td>
          <td id="LC4687">            <span>Debug.Assert</span> <span>uKeyInfo.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P384</span></td>
        </tr>
        <tr>
          <td id="L4688" data-line-number="4688"></td>
          <td id="LC4688">            <span>If</span> <span>Not</span> <span>pvCryptoHashSha384(baVerifyHash,</span> <span>baVerifyData)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4689" data-line-number="4689"></td>
          <td id="LC4689">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha384&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4690" data-line-number="4690"></td>
          <td id="LC4690">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4691" data-line-number="4691"></td>
          <td id="LC4691">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4692" data-line-number="4692"></td>
          <td id="LC4692"><span>Secp384r1Sign:</span></td>
        </tr>
        <tr>
          <td id="L4693" data-line-number="4693"></td>
          <td id="LC4693">            <span>If</span> <span>Not</span> <span>pvCryptoEcdsaSecp384r1Sign(baSignature,</span> <span>uKeyInfo.KeyBlob,</span> <span>baVerifyHash)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4694" data-line-number="4694"></td>
          <td id="LC4694">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoEcdsaSecp384r1Sign&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4695" data-line-number="4695"></td>
          <td id="LC4695">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4696" data-line-number="4696"></td>
          <td id="LC4696">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4697" data-line-number="4697"></td>
          <td id="LC4697">            <span>If</span> <span>Not</span> <span>pvAsn1EncodeEcdsaSignature(baRetVal,</span> <span>baSignature,</span> <span>LNG_SECP384R1_KEYSZ)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4698" data-line-number="4698"></td>
          <td id="LC4698">                <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;Asn1EncodeEcdsaSignature&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4699" data-line-number="4699"></td>
          <td id="LC4699">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4700" data-line-number="4700"></td>
          <td id="LC4700">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4701" data-line-number="4701"></td>
          <td id="LC4701">        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4702" data-line-number="4702"></td>
          <td id="LC4702">            <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_SIGNATURE_SCHEME,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetSignatureName(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4703" data-line-number="4703"></td>
          <td id="LC4703">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4704" data-line-number="4704"></td>
          <td id="LC4704">        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4705" data-line-number="4705"></td>
          <td id="LC4705">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4706" data-line-number="4706"></td>
          <td id="LC4706">    <span>If</span> <span>pvArraySize(baRetVal)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4707" data-line-number="4707"></td>
          <td id="LC4707">        <span>sErrDesc</span> <span>=</span> <span>Replace(ERR_SIGNATURE_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetSignatureName(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4708" data-line-number="4708"></td>
          <td id="LC4708">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4709" data-line-number="4709"></td>
          <td id="LC4709"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L4710" data-line-number="4710"></td>
          <td id="LC4710">    <span>If</span> <span>hHash</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4711" data-line-number="4711"></td>
          <td id="LC4711">        <span>Call</span> <span>CryptDestroyHash(hHash)</span></td>
        </tr>
        <tr>
          <td id="L4712" data-line-number="4712"></td>
          <td id="LC4712">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4713" data-line-number="4713"></td>
          <td id="LC4713">    <span>If</span> <span>hProvHash</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4714" data-line-number="4714"></td>
          <td id="LC4714">        <span>Call</span> <span>CryptReleaseContext(hProvHash,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4715" data-line-number="4715"></td>
          <td id="LC4715">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4716" data-line-number="4716"></td>
          <td id="LC4716">    <span>If</span> <span>uKeyInfo.hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4717" data-line-number="4717"></td>
          <td id="LC4717">        <span>Call</span> <span>CryptDestroyKey(uKeyInfo.hKey)</span></td>
        </tr>
        <tr>
          <td id="L4718" data-line-number="4718"></td>
          <td id="LC4718">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4719" data-line-number="4719"></td>
          <td id="LC4719">    <span>If</span> <span>uKeyInfo.hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4720" data-line-number="4720"></td>
          <td id="LC4720">        <span>Call</span> <span>CryptReleaseContext(uKeyInfo.hProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4721" data-line-number="4721"></td>
          <td id="LC4721">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4722" data-line-number="4722"></td>
          <td id="LC4722">    <span>If</span> <span>uKeyInfo.hNKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4723" data-line-number="4723"></td>
          <td id="LC4723">        <span>Call</span> <span>NCryptFreeObject(uKeyInfo.hNKey)</span></td>
        </tr>
        <tr>
          <td id="L4724" data-line-number="4724"></td>
          <td id="LC4724">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4725" data-line-number="4725"></td>
          <td id="LC4725">    <span>If</span> <span>LenB(sApiSource)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4726" data-line-number="4726"></td>
          <td id="LC4726">        <span>ErrRaise</span> <span>IIf(hResult</span> <span>&lt;</span> <span>0</span><span>,</span> <span>hResult,</span> <span>hResult</span> <span>Or</span> <span>LNG_FACILITY_WIN32),</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>sApiSource</span></td>
        </tr>
        <tr>
          <td id="L4727" data-line-number="4727"></td>
          <td id="LC4727">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4728" data-line-number="4728"></td>
          <td id="LC4728">    <span>If</span> <span>LenB(sErrDesc)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4729" data-line-number="4729"></td>
          <td id="LC4729">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>sErrDesc</span></td>
        </tr>
        <tr>
          <td id="L4730" data-line-number="4730"></td>
          <td id="LC4730">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4731" data-line-number="4731"></td>
          <td id="LC4731"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4732" data-line-number="4732"></td>
          <td id="LC4732">
</td>
        </tr>
        <tr>
          <td id="L4733" data-line-number="4733"></td>
          <td id="LC4733"><span>Private</span> <span>Function</span> <span>pvTlsSignatureVerify(baCert()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span><span>,</span> <span>baVerifyData()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baSignature()</span> <span>As</span> <span>Byte</span><span>,</span> <span>sError</span> <span>As</span> <span>String</span><span>,</span> <span>eAlertCode</span> <span>As</span> <span>UcsTlsAlertDescriptionsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L4734" data-line-number="4734"></td>
          <td id="LC4734">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvTlsSignatureVerify&#34;</span></td>
        </tr>
        <tr>
          <td id="L4735" data-line-number="4735"></td>
          <td id="LC4735">    <span>Dim</span> <span>uCertInfo</span>       <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L4736" data-line-number="4736"></td>
          <td id="LC4736">    <span>Dim</span> <span>lHashSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4737" data-line-number="4737"></td>
          <td id="LC4737">    <span>Dim</span> <span>baVerifyHash()</span>  <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4738" data-line-number="4738"></td>
          <td id="LC4738">    <span>Dim</span> <span>baPlainSig()</span>    <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4739" data-line-number="4739"></td>
          <td id="LC4739">    <span>Dim</span> <span>lCurveSize</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4740" data-line-number="4740"></td>
          <td id="LC4740">    <span>Dim</span> <span>bSkip</span>           <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L4741" data-line-number="4741"></td>
          <td id="LC4741">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4742" data-line-number="4742"></td>
          <td id="LC4742">    <span>Dim</span> <span>bDeprecated</span>     <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L4743" data-line-number="4743"></td>
          <td id="LC4743">    <span>Dim</span> <span>baDecr()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4744" data-line-number="4744"></td>
          <td id="LC4744">    </td>
        </tr>
        <tr>
          <td id="L4745" data-line-number="4745"></td>
          <td id="LC4745">    <span>On</span> <span>Error</span> <span>GoTo</span> <span>EH</span></td>
        </tr>
        <tr>
          <td id="L4746" data-line-number="4746"></td>
          <td id="LC4746">    <span>If</span> <span>Not</span> <span>pvAsn1DecodeCertificate(baCert,</span> <span>uCertInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4747" data-line-number="4747"></td>
          <td id="LC4747">        <span>GoTo</span> <span>UnsupportedCertificate</span></td>
        </tr>
        <tr>
          <td id="L4748" data-line-number="4748"></td>
          <td id="LC4748">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4749" data-line-number="4749"></td>
          <td id="LC4749">    <span>lHashSize</span> <span>=</span> <span>pvTlsSignatureHashSize(lSignatureScheme)</span></td>
        </tr>
        <tr>
          <td id="L4750" data-line-number="4750"></td>
          <td id="LC4750">    <span>Select</span> <span>Case</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L4751" data-line-number="4751"></td>
          <td id="LC4751">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA1,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA224,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA256,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA384,</span> <span>TLS_SIGNATURE_RSA_PKCS1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4752" data-line-number="4752"></td>
          <td id="LC4752">        <span>If</span> <span>Not</span> <span>pvCryptoRsaModExp(baSignature,</span> <span>uCertInfo.PubExp,</span> <span>uCertInfo.Modulus,</span> <span>baDecr)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4753" data-line-number="4753"></td>
          <td id="LC4753">            <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4754" data-line-number="4754"></td>
          <td id="LC4754">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4755" data-line-number="4755"></td>
          <td id="LC4755">        <span>If</span> <span>Not</span> <span>pvCryptoEmsaPkcs1Decode(baVerifyData,</span> <span>baDecr,</span> <span>lHashSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4756" data-line-number="4756"></td>
          <td id="LC4756">            <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4757" data-line-number="4757"></td>
          <td id="LC4757">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4758" data-line-number="4758"></td>
          <td id="LC4758">    <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L4759" data-line-number="4759"></td>
          <td id="LC4759">            <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4760" data-line-number="4760"></td>
          <td id="LC4760">        <span>If</span> <span>Not</span> <span>pvCryptoRsaModExp(baSignature,</span> <span>uCertInfo.PubExp,</span> <span>uCertInfo.Modulus,</span> <span>baDecr)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4761" data-line-number="4761"></td>
          <td id="LC4761">            <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4762" data-line-number="4762"></td>
          <td id="LC4762">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4763" data-line-number="4763"></td>
          <td id="LC4763">        <span>If</span> <span>Not</span> <span>pvCryptoEmsaPssDecode(baVerifyData,</span> <span>baDecr,</span> <span>uCertInfo.BitLen,</span> <span>lHashSize,</span> <span>lHashSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4764" data-line-number="4764"></td>
          <td id="LC4764">            <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4765" data-line-number="4765"></td>
          <td id="LC4765">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4766" data-line-number="4766"></td>
          <td id="LC4766">    <span>Case</span> <span>TLS_SIGNATURE_ECDSA_SHA1,</span> <span>TLS_SIGNATURE_ECDSA_SECP256R1_SHA256,</span> <span>TLS_SIGNATURE_ECDSA_SECP384R1_SHA384,</span> <span>TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4767" data-line-number="4767"></td>
          <td id="LC4767">        <span>If</span> <span>uCertInfo.AlgoObjId</span> <span>&lt;&gt;</span> <span>szOID_ECC_PUBLIC_KEY</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4768" data-line-number="4768"></td>
          <td id="LC4768">            <span>GoTo</span> <span>UnsupportedPublicKey</span></td>
        </tr>
        <tr>
          <td id="L4769" data-line-number="4769"></td>
          <td id="LC4769">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4770" data-line-number="4770"></td>
          <td id="LC4770">        <span>pvArrayHash</span> <span>lHashSize,</span> <span>baVerifyData,</span> <span>baVerifyHash</span></td>
        </tr>
        <tr>
          <td id="L4771" data-line-number="4771"></td>
          <td id="LC4771">        <span>lCurveSize</span> <span>=</span> <span>UBound(uCertInfo.KeyBlob)</span> <span>\</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L4772" data-line-number="4772"></td>
          <td id="LC4772">        <span>If</span> <span>Not</span> <span>pvAsn1DecodeEcdsaSignature(baPlainSig,</span> <span>baSignature,</span> <span>lCurveSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4773" data-line-number="4773"></td>
          <td id="LC4773">            <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4774" data-line-number="4774"></td>
          <td id="LC4774">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4775" data-line-number="4775"></td>
          <td id="LC4775">        <span>If</span> <span>UBound(baVerifyHash)</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lCurveSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4776" data-line-number="4776"></td>
          <td id="LC4776">            <span>&#39;--- note: when hash size is less than curve size must left-pad w/ zeros (right-align hash) -&gt; deprecated</span></td>
        </tr>
        <tr>
          <td id="L4777" data-line-number="4777"></td>
          <td id="LC4777">            <span>&#39;---       incl. ECDSA_SECP384R1_SHA256 only</span></td>
        </tr>
        <tr>
          <td id="L4778" data-line-number="4778"></td>
          <td id="LC4778">            <span>baTemp</span> <span>=</span> <span>baVerifyHash</span></td>
        </tr>
        <tr>
          <td id="L4779" data-line-number="4779"></td>
          <td id="LC4779">            <span>pvArrayAllocate</span> <span>baVerifyHash,</span> <span>lCurveSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baVerifyHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L4780" data-line-number="4780"></td>
          <td id="LC4780">            <span>Call</span> <span>CopyMemory(baVerifyHash(lCurveSize</span> <span>-</span> <span>UBound(baTemp)</span> <span>-</span> <span>1</span><span>),</span> <span>baTemp(</span><span>0</span><span>),</span> <span>UBound(baTemp)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4781" data-line-number="4781"></td>
          <td id="LC4781">            <span>bDeprecated</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L4782" data-line-number="4782"></td>
          <td id="LC4782">        <span>ElseIf</span> <span>UBound(baVerifyHash)</span> <span>+</span> <span>1</span> <span>&gt;</span> <span>lCurveSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4783" data-line-number="4783"></td>
          <td id="LC4783">            <span>&#39;--- note: when hash size is above curve size the excess is ignored -&gt; deprecated</span></td>
        </tr>
        <tr>
          <td id="L4784" data-line-number="4784"></td>
          <td id="LC4784">            <span>&#39;---       incl. ECDSA_SECP256R1_SHA384, ECDSA_SECP256R1_SHA512 and ECDSA_SECP384R1_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4785" data-line-number="4785"></td>
          <td id="LC4785">            <span>bDeprecated</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L4786" data-line-number="4786"></td>
          <td id="LC4786">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4787" data-line-number="4787"></td>
          <td id="LC4787">        <span>Select</span> <span>Case</span> <span>lCurveSize</span></td>
        </tr>
        <tr>
          <td id="L4788" data-line-number="4788"></td>
          <td id="LC4788">        <span>Case</span> <span>LNG_SECP256R1_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L4789" data-line-number="4789"></td>
          <td id="LC4789">            <span>If</span> <span>Not</span> <span>pvCryptoEcdsaSecp256r1Verify(uCertInfo.KeyBlob,</span> <span>baVerifyHash,</span> <span>baPlainSig)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4790" data-line-number="4790"></td>
          <td id="LC4790">                <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4791" data-line-number="4791"></td>
          <td id="LC4791">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4792" data-line-number="4792"></td>
          <td id="LC4792">        <span>Case</span> <span>LNG_SECP384R1_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L4793" data-line-number="4793"></td>
          <td id="LC4793">            <span>If</span> <span>Not</span> <span>pvCryptoEcdsaSecp384r1Verify(uCertInfo.KeyBlob,</span> <span>baVerifyHash,</span> <span>baPlainSig)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4794" data-line-number="4794"></td>
          <td id="LC4794">                <span>GoTo</span> <span>InvalidSignature</span></td>
        </tr>
        <tr>
          <td id="L4795" data-line-number="4795"></td>
          <td id="LC4795">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4796" data-line-number="4796"></td>
          <td id="LC4796">        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4797" data-line-number="4797"></td>
          <td id="LC4797">            <span>GoTo</span> <span>UnsupportedCurveSize</span></td>
        </tr>
        <tr>
          <td id="L4798" data-line-number="4798"></td>
          <td id="LC4798">        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4799" data-line-number="4799"></td>
          <td id="LC4799">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4800" data-line-number="4800"></td>
          <td id="LC4800">        <span>GoTo</span> <span>UnsupportedSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L4801" data-line-number="4801"></td>
          <td id="LC4801">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4802" data-line-number="4802"></td>
          <td id="LC4802">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L4803" data-line-number="4803"></td>
          <td id="LC4803">    <span>pvTlsSignatureVerify</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L4804" data-line-number="4804"></td>
          <td id="LC4804"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L4805" data-line-number="4805"></td>
          <td id="LC4805">    <span>#</span><span>If</span> <span>ImplUseDebugLog</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4806" data-line-number="4806"></td>
          <td id="LC4806">        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>IIf(pvTlsSignatureVerify,</span> <span>IIf(bSkip,</span> <span>&#34;Skipping &#34;</span><span>,</span> <span>IIf(bDeprecated,</span> <span>&#34;Deprecated &#34;</span><span>,</span> <span>&#34;Valid &#34;</span><span>)),</span> <span>&#34;Invalid &#34;</span><span>)</span> <span>&amp;</span> <span>pvTlsGetSignatureName(lSignatureScheme)</span> <span>&amp;</span> <span>&#34; signature&#34;</span> <span>&amp;</span> <span>IIf(bDeprecated,</span> <span>&#34; (lCurveSize=&#34;</span> <span>&amp;</span> <span>lCurveSize</span> <span>&amp;</span> <span>&#34; from server&#39;s public key)&#34;</span><span>,</span> <span>vbNullString)</span></td>
        </tr>
        <tr>
          <td id="L4807" data-line-number="4807"></td>
          <td id="LC4807">    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4808" data-line-number="4808"></td>
          <td id="LC4808">    <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4809" data-line-number="4809"></td>
          <td id="LC4809"><span>UnsupportedCertificate:</span></td>
        </tr>
        <tr>
          <td id="L4810" data-line-number="4810"></td>
          <td id="LC4810">    <span>sError</span> <span>=</span> <span>ERR_UNSUPPORTED_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L4811" data-line-number="4811"></td>
          <td id="LC4811">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L4812" data-line-number="4812"></td>
          <td id="LC4812">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4813" data-line-number="4813"></td>
          <td id="LC4813"><span>InvalidSignature:</span></td>
        </tr>
        <tr>
          <td id="L4814" data-line-number="4814"></td>
          <td id="LC4814">    <span>sError</span> <span>=</span> <span>ERR_INVALID_SIGNATURE</span></td>
        </tr>
        <tr>
          <td id="L4815" data-line-number="4815"></td>
          <td id="LC4815">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L4816" data-line-number="4816"></td>
          <td id="LC4816">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4817" data-line-number="4817"></td>
          <td id="LC4817"><span>UnsupportedPublicKey:</span></td>
        </tr>
        <tr>
          <td id="L4818" data-line-number="4818"></td>
          <td id="LC4818">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_PUBLIC_KEY,</span> <span>&#34;%1&#34;</span><span>,</span> <span>uCertInfo.AlgoObjId)</span></td>
        </tr>
        <tr>
          <td id="L4819" data-line-number="4819"></td>
          <td id="LC4819">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L4820" data-line-number="4820"></td>
          <td id="LC4820">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4821" data-line-number="4821"></td>
          <td id="LC4821"><span>UnsupportedCurveSize:</span></td>
        </tr>
        <tr>
          <td id="L4822" data-line-number="4822"></td>
          <td id="LC4822">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_CURVE_SIZE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lCurveSize)</span></td>
        </tr>
        <tr>
          <td id="L4823" data-line-number="4823"></td>
          <td id="LC4823">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertHandshakeFailure</span></td>
        </tr>
        <tr>
          <td id="L4824" data-line-number="4824"></td>
          <td id="LC4824">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4825" data-line-number="4825"></td>
          <td id="LC4825"><span>UnsupportedSignatureScheme:</span></td>
        </tr>
        <tr>
          <td id="L4826" data-line-number="4826"></td>
          <td id="LC4826">    <span>sError</span> <span>=</span> <span>Replace(ERR_UNSUPPORTED_SIGNATURE_SCHEME,</span> <span>&#34;%1&#34;</span><span>,</span> <span>pvTlsGetSignatureName(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4827" data-line-number="4827"></td>
          <td id="LC4827">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L4828" data-line-number="4828"></td>
          <td id="LC4828">    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4829" data-line-number="4829"></td>
          <td id="LC4829"><span>EH:</span></td>
        </tr>
        <tr>
          <td id="L4830" data-line-number="4830"></td>
          <td id="LC4830">    <span>sError</span> <span>=</span> <span>Err.Description</span> <span>&amp;</span> <span>&#34; [&#34;</span> <span>&amp;</span> <span>Err.Source</span> <span>&amp;</span> <span>&#34;]&#34;</span></td>
        </tr>
        <tr>
          <td id="L4831" data-line-number="4831"></td>
          <td id="LC4831">    <span>eAlertCode</span> <span>=</span> <span>uscTlsAlertInternalError</span></td>
        </tr>
        <tr>
          <td id="L4832" data-line-number="4832"></td>
          <td id="LC4832">    <span>Resume</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L4833" data-line-number="4833"></td>
          <td id="LC4833"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4834" data-line-number="4834"></td>
          <td id="LC4834">
</td>
        </tr>
        <tr>
          <td id="L4835" data-line-number="4835"></td>
          <td id="LC4835"><span>Private</span> <span>Function</span> <span>pvTlsSignatureHashSize(</span><span>ByVal</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4836" data-line-number="4836"></td>
          <td id="LC4836">    <span>pvTlsSignatureHashSize</span> <span>=</span> <span>pvTlsDigestHashSize(pvTlsSignatureDigestAlgo(lSignatureScheme))</span></td>
        </tr>
        <tr>
          <td id="L4837" data-line-number="4837"></td>
          <td id="LC4837"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4838" data-line-number="4838"></td>
          <td id="LC4838">
</td>
        </tr>
        <tr>
          <td id="L4839" data-line-number="4839"></td>
          <td id="LC4839"><span>Private</span> <span>Function</span> <span>pvTlsSignatureDigestAlgo(</span><span>ByVal</span> <span>lSignatureScheme</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum</span></td>
        </tr>
        <tr>
          <td id="L4840" data-line-number="4840"></td>
          <td id="LC4840">    <span>Const</span> <span>TLS_SIGNATURE_ALGORITHM_RSA</span>   <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L4841" data-line-number="4841"></td>
          <td id="LC4841">    <span>Const</span> <span>TLS_SIGNATURE_ALGORITHM_DSA</span>   <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L4842" data-line-number="4842"></td>
          <td id="LC4842">    <span>Const</span> <span>TLS_SIGNATURE_ALGORITHM_ECDSA</span> <span>As</span> <span>Long</span> <span>=</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L4843" data-line-number="4843"></td>
          <td id="LC4843">    <span>Const</span> <span>TLS_HASH_ALGORITHM_MD5</span>        <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L4844" data-line-number="4844"></td>
          <td id="LC4844">    <span>Const</span> <span>TLS_HASH_ALGORITHM_SHA1</span>       <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L4845" data-line-number="4845"></td>
          <td id="LC4845">    <span>Const</span> <span>TLS_HASH_ALGORITHM_SHA224</span>     <span>As</span> <span>Long</span> <span>=</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L4846" data-line-number="4846"></td>
          <td id="LC4846">    <span>Const</span> <span>TLS_HASH_ALGORITHM_SHA256</span>     <span>As</span> <span>Long</span> <span>=</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L4847" data-line-number="4847"></td>
          <td id="LC4847">    <span>Const</span> <span>TLS_HASH_ALGORITHM_SHA384</span>     <span>As</span> <span>Long</span> <span>=</span> <span>5</span></td>
        </tr>
        <tr>
          <td id="L4848" data-line-number="4848"></td>
          <td id="LC4848">    <span>Const</span> <span>TLS_HASH_ALGORITHM_SHA512</span>     <span>As</span> <span>Long</span> <span>=</span> <span>6</span></td>
        </tr>
        <tr>
          <td id="L4849" data-line-number="4849"></td>
          <td id="LC4849">    </td>
        </tr>
        <tr>
          <td id="L4850" data-line-number="4850"></td>
          <td id="LC4850">    <span>Select</span> <span>Case</span> <span>(lSignatureScheme</span> <span>And</span> <span>&amp;HFF</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4851" data-line-number="4851"></td>
          <td id="LC4851">    <span>Case</span> <span>TLS_SIGNATURE_ALGORITHM_RSA,</span> <span>TLS_SIGNATURE_ALGORITHM_DSA,</span> <span>TLS_SIGNATURE_ALGORITHM_ECDSA</span></td>
        </tr>
        <tr>
          <td id="L4852" data-line-number="4852"></td>
          <td id="LC4852">        <span>Select</span> <span>Case</span> <span>lSignatureScheme</span> <span>\</span> <span>&amp;H100</span></td>
        </tr>
        <tr>
          <td id="L4853" data-line-number="4853"></td>
          <td id="LC4853">        <span>Case</span> <span>TLS_HASH_ALGORITHM_MD5</span></td>
        </tr>
        <tr>
          <td id="L4854" data-line-number="4854"></td>
          <td id="LC4854">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestMd5</span></td>
        </tr>
        <tr>
          <td id="L4855" data-line-number="4855"></td>
          <td id="LC4855">        <span>Case</span> <span>TLS_HASH_ALGORITHM_SHA1</span></td>
        </tr>
        <tr>
          <td id="L4856" data-line-number="4856"></td>
          <td id="LC4856">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L4857" data-line-number="4857"></td>
          <td id="LC4857">        <span>Case</span> <span>TLS_HASH_ALGORITHM_SHA224</span></td>
        </tr>
        <tr>
          <td id="L4858" data-line-number="4858"></td>
          <td id="LC4858">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha224</span></td>
        </tr>
        <tr>
          <td id="L4859" data-line-number="4859"></td>
          <td id="LC4859">        <span>Case</span> <span>TLS_HASH_ALGORITHM_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4860" data-line-number="4860"></td>
          <td id="LC4860">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4861" data-line-number="4861"></td>
          <td id="LC4861">        <span>Case</span> <span>TLS_HASH_ALGORITHM_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4862" data-line-number="4862"></td>
          <td id="LC4862">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4863" data-line-number="4863"></td>
          <td id="LC4863">        <span>Case</span> <span>TLS_HASH_ALGORITHM_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4864" data-line-number="4864"></td>
          <td id="LC4864">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L4865" data-line-number="4865"></td>
          <td id="LC4865">        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4866" data-line-number="4866"></td>
          <td id="LC4866">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4867" data-line-number="4867"></td>
          <td id="LC4867">        <span>&#39;--- 8 - Intrinsic for TLS 1.3</span></td>
        </tr>
        <tr>
          <td id="L4868" data-line-number="4868"></td>
          <td id="LC4868">        <span>Select</span> <span>Case</span> <span>lSignatureScheme</span></td>
        </tr>
        <tr>
          <td id="L4869" data-line-number="4869"></td>
          <td id="LC4869">        <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA256,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA256</span></td>
        </tr>
        <tr>
          <td id="L4870" data-line-number="4870"></td>
          <td id="LC4870">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4871" data-line-number="4871"></td>
          <td id="LC4871">        <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA384,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA384</span></td>
        </tr>
        <tr>
          <td id="L4872" data-line-number="4872"></td>
          <td id="LC4872">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4873" data-line-number="4873"></td>
          <td id="LC4873">        <span>Case</span> <span>TLS_SIGNATURE_RSA_PSS_RSAE_SHA512,</span> <span>TLS_SIGNATURE_RSA_PSS_PSS_SHA512</span></td>
        </tr>
        <tr>
          <td id="L4874" data-line-number="4874"></td>
          <td id="LC4874">            <span>pvTlsSignatureDigestAlgo</span> <span>=</span> <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L4875" data-line-number="4875"></td>
          <td id="LC4875">        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4876" data-line-number="4876"></td>
          <td id="LC4876">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4877" data-line-number="4877"></td>
          <td id="LC4877"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4878" data-line-number="4878"></td>
          <td id="LC4878">
</td>
        </tr>
        <tr>
          <td id="L4879" data-line-number="4879"></td>
          <td id="LC4879"><span>Private</span> <span>Function</span> <span>pvTlsDigestHashSize(</span><span>ByVal</span> <span>eDigestAlgo</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4880" data-line-number="4880"></td>
          <td id="LC4880">    <span>Select</span> <span>Case</span> <span>eDigestAlgo</span></td>
        </tr>
        <tr>
          <td id="L4881" data-line-number="4881"></td>
          <td id="LC4881">    <span>Case</span> <span>ucsTlsAlgoDigestMd5</span></td>
        </tr>
        <tr>
          <td id="L4882" data-line-number="4882"></td>
          <td id="LC4882">        <span>pvTlsDigestHashSize</span> <span>=</span> <span>LNG_MD5_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L4883" data-line-number="4883"></td>
          <td id="LC4883">    <span>Case</span> <span>ucsTlsAlgoDigestSha1</span></td>
        </tr>
        <tr>
          <td id="L4884" data-line-number="4884"></td>
          <td id="LC4884">        <span>pvTlsDigestHashSize</span> <span>=</span> <span>LNG_SHA1_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L4885" data-line-number="4885"></td>
          <td id="LC4885">    <span>Case</span> <span>ucsTlsAlgoDigestSha224</span></td>
        </tr>
        <tr>
          <td id="L4886" data-line-number="4886"></td>
          <td id="LC4886">        <span>pvTlsDigestHashSize</span> <span>=</span> <span>LNG_SHA224_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L4887" data-line-number="4887"></td>
          <td id="LC4887">    <span>Case</span> <span>ucsTlsAlgoDigestSha256</span></td>
        </tr>
        <tr>
          <td id="L4888" data-line-number="4888"></td>
          <td id="LC4888">        <span>pvTlsDigestHashSize</span> <span>=</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L4889" data-line-number="4889"></td>
          <td id="LC4889">    <span>Case</span> <span>ucsTlsAlgoDigestSha384</span></td>
        </tr>
        <tr>
          <td id="L4890" data-line-number="4890"></td>
          <td id="LC4890">        <span>pvTlsDigestHashSize</span> <span>=</span> <span>LNG_SHA384_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L4891" data-line-number="4891"></td>
          <td id="LC4891">    <span>Case</span> <span>ucsTlsAlgoDigestSha512</span></td>
        </tr>
        <tr>
          <td id="L4892" data-line-number="4892"></td>
          <td id="LC4892">        <span>pvTlsDigestHashSize</span> <span>=</span> <span>LNG_SHA512_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L4893" data-line-number="4893"></td>
          <td id="LC4893">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4894" data-line-number="4894"></td>
          <td id="LC4894">        <span>&#39;--- do nothing</span></td>
        </tr>
        <tr>
          <td id="L4895" data-line-number="4895"></td>
          <td id="LC4895">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L4896" data-line-number="4896"></td>
          <td id="LC4896"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L4897" data-line-number="4897"></td>
          <td id="LC4897">
</td>
        </tr>
        <tr>
          <td id="L4898" data-line-number="4898"></td>
          <td id="LC4898"><span>&#39;= buffer management =====================================================</span></td>
        </tr>
        <tr>
          <td id="L4899" data-line-number="4899"></td>
          <td id="LC4899">
</td>
        </tr>
        <tr>
          <td id="L4900" data-line-number="4900"></td>
          <td id="LC4900"><span>Private</span> <span>Sub</span> <span>pvBufferWriteRecordStart(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lContentType</span> <span>As</span> <span>Long</span><span>,</span> <span>uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L4901" data-line-number="4901"></td>
          <td id="LC4901">    <span>Dim</span> <span>lRecordPos</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4902" data-line-number="4902"></td>
          <td id="LC4902">    <span>Dim</span> <span>baLocalIV()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4903" data-line-number="4903"></td>
          <td id="LC4903">    </td>
        </tr>
        <tr>
          <td id="L4904" data-line-number="4904"></td>
          <td id="LC4904">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4905" data-line-number="4905"></td>
          <td id="LC4905">        <span>lRecordPos</span> <span>=</span> <span>uOutput.Size</span></td>
        </tr>
        <tr>
          <td id="L4906" data-line-number="4906"></td>
          <td id="LC4906">        <span>&#39;--- Record Header</span></td>
        </tr>
        <tr>
          <td id="L4907" data-line-number="4907"></td>
          <td id="LC4907">        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>lContentType</span></td>
        </tr>
        <tr>
          <td id="L4908" data-line-number="4908"></td>
          <td id="LC4908">        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>TLS_RECORD_VERSION,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L4909" data-line-number="4909"></td>
          <td id="LC4909">        <span>pvBufferWriteBlockStart</span> <span>uOutput,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L4910" data-line-number="4910"></td>
          <td id="LC4910">            <span>If</span> <span>pvArraySize(.LocalTrafficKey)</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4911" data-line-number="4911"></td>
          <td id="LC4911">                <span>pvArrayXor</span> <span>baLocalIV,</span> <span>.LocalTrafficIV,</span> <span>.LocalTrafficSeqNo</span></td>
        </tr>
        <tr>
          <td id="L4912" data-line-number="4912"></td>
          <td id="LC4912">                <span>If</span> <span>.IvExplicitSize</span> <span>&gt;</span> <span>0</span> <span>Then</span> <span>&#39;--- AES in TLS 1.2</span></td>
        </tr>
        <tr>
          <td id="L4913" data-line-number="4913"></td>
          <td id="LC4913">                    <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baLocalIV(.IvSize</span> <span>-</span> <span>.IvExplicitSize)),</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L4914" data-line-number="4914"></td>
          <td id="LC4914">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4915" data-line-number="4915"></td>
          <td id="LC4915">                <span>uOutput.Stack.Add</span> <span>Array(lRecordPos,</span> <span>uOutput.Size,</span> <span>baLocalIV),</span> <span>Before:=</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L4916" data-line-number="4916"></td>
          <td id="LC4916">                <span>&#39;--- to be continued in end-of-record. . .</span></td>
        </tr>
        <tr>
          <td id="L4917" data-line-number="4917"></td>
          <td id="LC4917">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4918" data-line-number="4918"></td>
          <td id="LC4918">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4919" data-line-number="4919"></td>
          <td id="LC4919"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4920" data-line-number="4920"></td>
          <td id="LC4920">
</td>
        </tr>
        <tr>
          <td id="L4921" data-line-number="4921"></td>
          <td id="LC4921"><span>Private</span> <span>Sub</span> <span>pvBufferWriteRecordEnd(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>uCtx</span> <span>As</span> <span>UcsTlsContext)</span></td>
        </tr>
        <tr>
          <td id="L4922" data-line-number="4922"></td>
          <td id="LC4922">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvBufferWriteRecordEnd&#34;</span></td>
        </tr>
        <tr>
          <td id="L4923" data-line-number="4923"></td>
          <td id="LC4923">    <span>Dim</span> <span>vRecordData</span>     <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L4924" data-line-number="4924"></td>
          <td id="LC4924">    <span>Dim</span> <span>lRecordPos</span>      <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4925" data-line-number="4925"></td>
          <td id="LC4925">    <span>Dim</span> <span>baLocalIV()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4926" data-line-number="4926"></td>
          <td id="LC4926">    <span>Dim</span> <span>lMessagePos</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4927" data-line-number="4927"></td>
          <td id="LC4927">    <span>Dim</span> <span>lMessageSize</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4928" data-line-number="4928"></td>
          <td id="LC4928">    <span>Dim</span> <span>uAad</span>            <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L4929" data-line-number="4929"></td>
          <td id="LC4929">    <span>Dim</span> <span>baHmac()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L4930" data-line-number="4930"></td>
          <td id="LC4930">    <span>Dim</span> <span>lPadding</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4931" data-line-number="4931"></td>
          <td id="LC4931">    </td>
        </tr>
        <tr>
          <td id="L4932" data-line-number="4932"></td>
          <td id="LC4932">    <span>With</span> <span>uCtx</span></td>
        </tr>
        <tr>
          <td id="L4933" data-line-number="4933"></td>
          <td id="LC4933">        <span>If</span> <span>pvArraySize(.LocalTrafficKey)</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4934" data-line-number="4934"></td>
          <td id="LC4934">                <span>&#39;--- . . . continues from start-of-record</span></td>
        </tr>
        <tr>
          <td id="L4935" data-line-number="4935"></td>
          <td id="LC4935">                <span>vRecordData</span> <span>=</span> <span>uOutput.Stack.Item(</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4936" data-line-number="4936"></td>
          <td id="LC4936">                <span>uOutput.Stack.Remove</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L4937" data-line-number="4937"></td>
          <td id="LC4937">                <span>lRecordPos</span> <span>=</span> <span>vRecordData(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4938" data-line-number="4938"></td>
          <td id="LC4938">                <span>lMessagePos</span> <span>=</span> <span>vRecordData(</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4939" data-line-number="4939"></td>
          <td id="LC4939">                <span>baLocalIV</span> <span>=</span> <span>vRecordData(</span><span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4940" data-line-number="4940"></td>
          <td id="LC4940">                <span>lMessageSize</span> <span>=</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L4941" data-line-number="4941"></td>
          <td id="LC4941">                <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>0</span><span>,</span> <span>.TagSize</span></td>
        </tr>
        <tr>
          <td id="L4942" data-line-number="4942"></td>
          <td id="LC4942">                <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4943" data-line-number="4943"></td>
          <td id="LC4943">                    <span>pvBufferWriteLong</span> <span>uAad,</span> <span>0</span><span>,</span> <span>Size:=</span><span>4</span></td>
        </tr>
        <tr>
          <td id="L4944" data-line-number="4944"></td>
          <td id="LC4944">                    <span>pvBufferWriteLong</span> <span>uAad,</span> <span>.LocalTrafficSeqNo,</span> <span>Size:=</span><span>4</span></td>
        </tr>
        <tr>
          <td id="L4945" data-line-number="4945"></td>
          <td id="LC4945">                    <span>pvBufferWriteBlob</span> <span>uAad,</span> <span>VarPtr(uOutput.Data(lRecordPos)),</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L4946" data-line-number="4946"></td>
          <td id="LC4946">                    <span>pvBufferWriteLong</span> <span>uAad,</span> <span>lMessageSize,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L4947" data-line-number="4947"></td>
          <td id="LC4947">                    <span>Debug.Assert</span> <span>uAad.Size</span> <span>=</span> <span>TLS_LEGACY_AAD_SIZE</span></td>
        </tr>
        <tr>
          <td id="L4948" data-line-number="4948"></td>
          <td id="LC4948">                    <span>If</span> <span>.MacSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4949" data-line-number="4949"></td>
          <td id="LC4949">                        <span>If</span> <span>Not</span> <span>.LocalEncryptThenMac</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4950" data-line-number="4950"></td>
          <td id="LC4950">                            <span>pvBufferWriteBlob</span> <span>uAad,</span> <span>VarPtr(uOutput.Data(lMessagePos)),</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L4951" data-line-number="4951"></td>
          <td id="LC4951">                            <span>pvTlsGetHmac</span> <span>baHmac,</span> <span>.MacAlgo,</span> <span>.LocalMacKey,</span> <span>uAad.Data,</span> <span>0</span><span>,</span> <span>uAad.Size</span></td>
        </tr>
        <tr>
          <td id="L4952" data-line-number="4952"></td>
          <td id="LC4952">                            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baHmac</span></td>
        </tr>
        <tr>
          <td id="L4953" data-line-number="4953"></td>
          <td id="LC4953">                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4954" data-line-number="4954"></td>
          <td id="LC4954">                            <span>pvArrayAllocate</span> <span>baHmac,</span> <span>.IvSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baHmac&#34;</span></td>
        </tr>
        <tr>
          <td id="L4955" data-line-number="4955"></td>
          <td id="LC4955">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4956" data-line-number="4956"></td>
          <td id="LC4956">                        <span>lPadding</span> <span>=</span> <span>.IvSize</span> <span>-</span> <span>(uOutput.Size</span> <span>-</span> <span>lMessagePos)</span> <span>Mod</span> <span>.IvSize</span></td>
        </tr>
        <tr>
          <td id="L4957" data-line-number="4957"></td>
          <td id="LC4957">                        <span>Debug.Assert</span> <span>lPadding</span> <span>&lt;=</span> <span>pvArraySize(baHmac)</span></td>
        </tr>
        <tr>
          <td id="L4958" data-line-number="4958"></td>
          <td id="LC4958">                        <span>Call</span> <span>FillMemory(baHmac(</span><span>0</span><span>),</span> <span>lPadding,</span> <span>lPadding</span> <span>-</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4959" data-line-number="4959"></td>
          <td id="LC4959">                        <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baHmac(</span><span>0</span><span>)),</span> <span>lPadding</span></td>
        </tr>
        <tr>
          <td id="L4960" data-line-number="4960"></td>
          <td id="LC4960">                        <span>lMessageSize</span> <span>=</span> <span>uOutput.Size</span> <span>-</span> <span>lMessagePos</span></td>
        </tr>
        <tr>
          <td id="L4961" data-line-number="4961"></td>
          <td id="LC4961">                        <span>If</span> <span>.LocalEncryptThenMac</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4962" data-line-number="4962"></td>
          <td id="LC4962">                            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>0</span><span>,</span> <span>.MacSize</span></td>
        </tr>
        <tr>
          <td id="L4963" data-line-number="4963"></td>
          <td id="LC4963">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4964" data-line-number="4964"></td>
          <td id="LC4964">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4965" data-line-number="4965"></td>
          <td id="LC4965">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4966" data-line-number="4966"></td>
          <td id="LC4966">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L4967" data-line-number="4967"></td>
          <td id="LC4967">            <span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4968" data-line-number="4968"></td>
          <td id="LC4968">                <span>If</span> <span>lMessageSize</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4969" data-line-number="4969"></td>
          <td id="LC4969">                    <span>.TrafficDump.Add</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.Output (unencrypted)&#34;</span> <span>&amp;</span> <span>vbCrLf</span> <span>&amp;</span> <span>TlsDesignDumpArray(uOutput.Data,</span> <span>lRecordPos,</span> <span>uOutput.Size</span> <span>-</span> <span>lRecordPos</span> <span>-</span> <span>.TagSize</span> <span>-</span> <span>.MacSize)</span></td>
        </tr>
        <tr>
          <td id="L4970" data-line-number="4970"></td>
          <td id="LC4970">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4971" data-line-number="4971"></td>
          <td id="LC4971">            <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4972" data-line-number="4972"></td>
          <td id="LC4972">            <span>If</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS13</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4973" data-line-number="4973"></td>
          <td id="LC4973">                <span>pvTlsBulkEncrypt</span> <span>.BulkAlgo,</span> <span>baLocalIV,</span> <span>.LocalTrafficKey,</span> <span>uOutput.Data,</span> <span>lRecordPos,</span> <span>TLS_AAD_SIZE,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L4974" data-line-number="4974"></td>
          <td id="LC4974">            <span>ElseIf</span> <span>.ProtocolVersion</span> <span>=</span> <span>TLS_PROTOCOL_VERSION_TLS12</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4975" data-line-number="4975"></td>
          <td id="LC4975">                <span>pvTlsBulkEncrypt</span> <span>.BulkAlgo,</span> <span>baLocalIV,</span> <span>.LocalTrafficKey,</span> <span>uAad.Data,</span> <span>0</span><span>,</span> <span>uAad.Size,</span> <span>uOutput.Data,</span> <span>lMessagePos,</span> <span>lMessageSize</span></td>
        </tr>
        <tr>
          <td id="L4976" data-line-number="4976"></td>
          <td id="LC4976">                <span>If</span> <span>.LocalEncryptThenMac</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4977" data-line-number="4977"></td>
          <td id="LC4977">                    <span>uAad.Size</span> <span>=</span> <span>uAad.Size</span> <span>-</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L4978" data-line-number="4978"></td>
          <td id="LC4978">                    <span>pvBufferWriteLong</span> <span>uAad,</span> <span>lMessageSize</span> <span>+</span> <span>.IvExplicitSize,</span> <span>Size:=</span><span>2</span></td>
        </tr>
        <tr>
          <td id="L4979" data-line-number="4979"></td>
          <td id="LC4979">                    <span>pvBufferWriteBlob</span> <span>uAad,</span> <span>VarPtr(uOutput.Data(lMessagePos</span> <span>-</span> <span>.IvExplicitSize)),</span> <span>lMessageSize</span> <span>+</span> <span>.IvExplicitSize</span></td>
        </tr>
        <tr>
          <td id="L4980" data-line-number="4980"></td>
          <td id="LC4980">                    <span>pvTlsGetHmac</span> <span>baHmac,</span> <span>.MacAlgo,</span> <span>.LocalMacKey,</span> <span>uAad.Data,</span> <span>0</span><span>,</span> <span>uAad.Size</span></td>
        </tr>
        <tr>
          <td id="L4981" data-line-number="4981"></td>
          <td id="LC4981">                    <span>uOutput.Size</span> <span>=</span> <span>uOutput.Size</span> <span>-</span> <span>.MacSize</span></td>
        </tr>
        <tr>
          <td id="L4982" data-line-number="4982"></td>
          <td id="LC4982">                    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baHmac</span></td>
        </tr>
        <tr>
          <td id="L4983" data-line-number="4983"></td>
          <td id="LC4983">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4984" data-line-number="4984"></td>
          <td id="LC4984">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4985" data-line-number="4985"></td>
          <td id="LC4985">            <span>.LocalTrafficSeqNo</span> <span>=</span> <span>UnsignedAdd(.LocalTrafficSeqNo,</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4986" data-line-number="4986"></td>
          <td id="LC4986">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L4987" data-line-number="4987"></td>
          <td id="LC4987">            <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L4988" data-line-number="4988"></td>
          <td id="LC4988">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4989" data-line-number="4989"></td>
          <td id="LC4989">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L4990" data-line-number="4990"></td>
          <td id="LC4990"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L4991" data-line-number="4991"></td>
          <td id="LC4991">
</td>
        </tr>
        <tr>
          <td id="L4992" data-line-number="4992"></td>
          <td id="LC4992"><span>Private</span> <span>Sub</span> <span>pvBufferWriteBlockStart(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L4993" data-line-number="4993"></td>
          <td id="LC4993">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L4994" data-line-number="4994"></td>
          <td id="LC4994">    </td>
        </tr>
        <tr>
          <td id="L4995" data-line-number="4995"></td>
          <td id="LC4995">    <span>With</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L4996" data-line-number="4996"></td>
          <td id="LC4996">        <span>If</span> <span>.Stack</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L4997" data-line-number="4997"></td>
          <td id="LC4997">            <span>Set</span> <span>.Stack</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L4998" data-line-number="4998"></td>
          <td id="LC4998">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L4999" data-line-number="4999"></td>
          <td id="LC4999">        <span>If</span> <span>.Stack.Count</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5000" data-line-number="5000"></td>
          <td id="LC5000">            <span>.Stack.Add</span> <span>.Size</span></td>
        </tr>
        <tr>
          <td id="L5001" data-line-number="5001"></td>
          <td id="LC5001">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5002" data-line-number="5002"></td>
          <td id="LC5002">            <span>.Stack.Add</span> <span>.Size,</span> <span>Before:=</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L5003" data-line-number="5003"></td>
          <td id="LC5003">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5004" data-line-number="5004"></td>
          <td id="LC5004">        <span>lPos</span> <span>=</span> <span>.Size</span></td>
        </tr>
        <tr>
          <td id="L5005" data-line-number="5005"></td>
          <td id="LC5005">        <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>0</span><span>,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L5006" data-line-number="5006"></td>
          <td id="LC5006">        <span>&#39;--- note: keep Size in uOutput.Data</span></td>
        </tr>
        <tr>
          <td id="L5007" data-line-number="5007"></td>
          <td id="LC5007">        <span>.Data(lPos)</span> <span>=</span> <span>(Size</span> <span>And</span> <span>&amp;HFF</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5008" data-line-number="5008"></td>
          <td id="LC5008">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5009" data-line-number="5009"></td>
          <td id="LC5009"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5010" data-line-number="5010"></td>
          <td id="LC5010">
</td>
        </tr>
        <tr>
          <td id="L5011" data-line-number="5011"></td>
          <td id="LC5011"><span>Private</span> <span>Sub</span> <span>pvBufferWriteBlockEnd(uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L5012" data-line-number="5012"></td>
          <td id="LC5012">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5013" data-line-number="5013"></td>
          <td id="LC5013">    </td>
        </tr>
        <tr>
          <td id="L5014" data-line-number="5014"></td>
          <td id="LC5014">    <span>With</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5015" data-line-number="5015"></td>
          <td id="LC5015">        <span>lPos</span> <span>=</span> <span>.Size</span></td>
        </tr>
        <tr>
          <td id="L5016" data-line-number="5016"></td>
          <td id="LC5016">        <span>.Size</span> <span>=</span> <span>.Stack.Item(</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5017" data-line-number="5017"></td>
          <td id="LC5017">        <span>.Stack.Remove</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5018" data-line-number="5018"></td>
          <td id="LC5018">        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>lPos</span> <span>-</span> <span>.Size</span> <span>-</span> <span>.Data(.Size),</span> <span>Size:=.Data(.Size)</span></td>
        </tr>
        <tr>
          <td id="L5019" data-line-number="5019"></td>
          <td id="LC5019">        <span>.Size</span> <span>=</span> <span>lPos</span></td>
        </tr>
        <tr>
          <td id="L5020" data-line-number="5020"></td>
          <td id="LC5020">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5021" data-line-number="5021"></td>
          <td id="LC5021"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5022" data-line-number="5022"></td>
          <td id="LC5022">
</td>
        </tr>
        <tr>
          <td id="L5023" data-line-number="5023"></td>
          <td id="LC5023"><span>Private</span> <span>Sub</span> <span>pvBufferWriteString(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>sValue</span> <span>As</span> <span>String</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5024" data-line-number="5024"></td>
          <td id="LC5024">    <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>StrConv(sValue,</span> <span>vbFromUnicode)</span></td>
        </tr>
        <tr>
          <td id="L5025" data-line-number="5025"></td>
          <td id="LC5025"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5026" data-line-number="5026"></td>
          <td id="LC5026">
</td>
        </tr>
        <tr>
          <td id="L5027" data-line-number="5027"></td>
          <td id="LC5027"><span>Private</span> <span>Sub</span> <span>pvBufferWriteArray(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>baSrc()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5028" data-line-number="5028"></td>
          <td id="LC5028">    <span>Dim</span> <span>lSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5029" data-line-number="5029"></td>
          <td id="LC5029">    </td>
        </tr>
        <tr>
          <td id="L5030" data-line-number="5030"></td>
          <td id="LC5030">    <span>With</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5031" data-line-number="5031"></td>
          <td id="LC5031">        <span>lSize</span> <span>=</span> <span>pvArraySize(baSrc)</span></td>
        </tr>
        <tr>
          <td id="L5032" data-line-number="5032"></td>
          <td id="LC5032">        <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5033" data-line-number="5033"></td>
          <td id="LC5033">            <span>.Size</span> <span>=</span> <span>pvArrayWriteBlob(.Data,</span> <span>.Size,</span> <span>VarPtr(baSrc(</span><span>0</span><span>)),</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L5034" data-line-number="5034"></td>
          <td id="LC5034">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5035" data-line-number="5035"></td>
          <td id="LC5035">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5036" data-line-number="5036"></td>
          <td id="LC5036"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5037" data-line-number="5037"></td>
          <td id="LC5037">
</td>
        </tr>
        <tr>
          <td id="L5038" data-line-number="5038"></td>
          <td id="LC5038"><span>Private</span> <span>Sub</span> <span>pvBufferWriteLong(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lValue</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5039" data-line-number="5039"></td>
          <td id="LC5039">    <span>Static</span> <span>baTemp(</span><span>0</span> <span>To</span> <span>3</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5040" data-line-number="5040"></td>
          <td id="LC5040">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5041" data-line-number="5041"></td>
          <td id="LC5041">
</td>
        </tr>
        <tr>
          <td id="L5042" data-line-number="5042"></td>
          <td id="LC5042">    <span>With</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5043" data-line-number="5043"></td>
          <td id="LC5043">        <span>If</span> <span>Size</span> <span>&lt;=</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5044" data-line-number="5044"></td>
          <td id="LC5044">            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(lValue),</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L5045" data-line-number="5045"></td>
          <td id="LC5045">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5046" data-line-number="5046"></td>
          <td id="LC5046">            <span>lPos</span> <span>=</span> <span>.Size</span></td>
        </tr>
        <tr>
          <td id="L5047" data-line-number="5047"></td>
          <td id="LC5047">            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>0</span><span>,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L5048" data-line-number="5048"></td>
          <td id="LC5048">            <span>Call</span> <span>CopyMemory(baTemp(</span><span>0</span><span>),</span> <span>lValue,</span> <span>LenB(lValue))</span></td>
        </tr>
        <tr>
          <td id="L5049" data-line-number="5049"></td>
          <td id="LC5049">            <span>.Data(lPos</span> <span>+</span> <span>0</span><span>)</span> <span>=</span> <span>baTemp(Size</span> <span>-</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5050" data-line-number="5050"></td>
          <td id="LC5050">            <span>.Data(lPos</span> <span>+</span> <span>1</span><span>)</span> <span>=</span> <span>baTemp(Size</span> <span>-</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5051" data-line-number="5051"></td>
          <td id="LC5051">            <span>If</span> <span>Size</span> <span>&gt;=</span> <span>3</span> <span>Then</span> <span>.Data(lPos</span> <span>+</span> <span>2</span><span>)</span> <span>=</span> <span>baTemp(Size</span> <span>-</span> <span>3</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5052" data-line-number="5052"></td>
          <td id="LC5052">            <span>If</span> <span>Size</span> <span>&gt;=</span> <span>4</span> <span>Then</span> <span>.Data(lPos</span> <span>+</span> <span>3</span><span>)</span> <span>=</span> <span>baTemp(Size</span> <span>-</span> <span>4</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5053" data-line-number="5053"></td>
          <td id="LC5053">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5054" data-line-number="5054"></td>
          <td id="LC5054">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5055" data-line-number="5055"></td>
          <td id="LC5055"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5056" data-line-number="5056"></td>
          <td id="LC5056">
</td>
        </tr>
        <tr>
          <td id="L5057" data-line-number="5057"></td>
          <td id="LC5057"><span>Private</span> <span>Sub</span> <span>pvBufferWriteBlob(uOutput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5058" data-line-number="5058"></td>
          <td id="LC5058">    <span>uOutput.Size</span> <span>=</span> <span>pvArrayWriteBlob(uOutput.Data,</span> <span>uOutput.Size,</span> <span>lPtr,</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L5059" data-line-number="5059"></td>
          <td id="LC5059"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5060" data-line-number="5060"></td>
          <td id="LC5060">
</td>
        </tr>
        <tr>
          <td id="L5061" data-line-number="5061"></td>
          <td id="LC5061"><span>Private</span> <span>Function</span> <span>pvArrayWriteBlob(baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5062" data-line-number="5062"></td>
          <td id="LC5062">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvArrayWriteBlob&#34;</span></td>
        </tr>
        <tr>
          <td id="L5063" data-line-number="5063"></td>
          <td id="LC5063">    <span>Dim</span> <span>lBufPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5064" data-line-number="5064"></td>
          <td id="LC5064">    </td>
        </tr>
        <tr>
          <td id="L5065" data-line-number="5065"></td>
          <td id="LC5065">    <span>&#39;--- peek long at ArrPtr(baBuffer)</span></td>
        </tr>
        <tr>
          <td id="L5066" data-line-number="5066"></td>
          <td id="LC5066">    <span>Call</span> <span>CopyMemory(lBufPtr,</span> <span>ByVal</span> <span>ArrPtr(baBuffer),</span> <span>LenB(lBufPtr))</span></td>
        </tr>
        <tr>
          <td id="L5067" data-line-number="5067"></td>
          <td id="LC5067">    <span>If</span> <span>lBufPtr</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5068" data-line-number="5068"></td>
          <td id="LC5068">        <span>pvArrayAllocate</span> <span>baBuffer,</span> <span>Clamp(lPos</span> <span>+</span> <span>lSize,</span> <span>256</span><span>),</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L5069" data-line-number="5069"></td>
          <td id="LC5069">    <span>ElseIf</span> <span>UBound(baBuffer)</span> <span>&lt;</span> <span>lPos</span> <span>+</span> <span>lSize</span> <span>-</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5070" data-line-number="5070"></td>
          <td id="LC5070">        <span>pvArrayReallocate</span> <span>baBuffer,</span> <span>lPos</span> <span>+</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L5071" data-line-number="5071"></td>
          <td id="LC5071">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5072" data-line-number="5072"></td>
          <td id="LC5072">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>And</span> <span>lPtr</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5073" data-line-number="5073"></td>
          <td id="LC5073">        <span>Debug.Assert</span> <span>IsBadReadPtr(lPtr,</span> <span>lSize)</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5074" data-line-number="5074"></td>
          <td id="LC5074">        <span>Call</span> <span>CopyMemory(baBuffer(lPos),</span> <span>ByVal</span> <span>lPtr,</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L5075" data-line-number="5075"></td>
          <td id="LC5075">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5076" data-line-number="5076"></td>
          <td id="LC5076">    <span>pvArrayWriteBlob</span> <span>=</span> <span>lPos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5077" data-line-number="5077"></td>
          <td id="LC5077"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5078" data-line-number="5078"></td>
          <td id="LC5078">
</td>
        </tr>
        <tr>
          <td id="L5079" data-line-number="5079"></td>
          <td id="LC5079"><span>Private</span> <span>Sub</span> <span>pvBufferWriteEOF(uOutput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L5080" data-line-number="5080"></td>
          <td id="LC5080">    <span>uOutput.Size</span> <span>=</span> <span>pvArrayWriteEOF(uOutput.Data,</span> <span>uOutput.Size)</span></td>
        </tr>
        <tr>
          <td id="L5081" data-line-number="5081"></td>
          <td id="LC5081"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5082" data-line-number="5082"></td>
          <td id="LC5082">
</td>
        </tr>
        <tr>
          <td id="L5083" data-line-number="5083"></td>
          <td id="LC5083"><span>Private</span> <span>Function</span> <span>pvArrayWriteEOF(baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5084" data-line-number="5084"></td>
          <td id="LC5084">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvArrayWriteEOF&#34;</span></td>
        </tr>
        <tr>
          <td id="L5085" data-line-number="5085"></td>
          <td id="LC5085">    </td>
        </tr>
        <tr>
          <td id="L5086" data-line-number="5086"></td>
          <td id="LC5086">    <span>If</span> <span>pvArraySize(baBuffer)</span> <span>&lt;&gt;</span> <span>lPos</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5087" data-line-number="5087"></td>
          <td id="LC5087">        <span>pvArrayReallocate</span> <span>baBuffer,</span> <span>lPos,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L5088" data-line-number="5088"></td>
          <td id="LC5088">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5089" data-line-number="5089"></td>
          <td id="LC5089"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5090" data-line-number="5090"></td>
          <td id="LC5090">
</td>
        </tr>
        <tr>
          <td id="L5091" data-line-number="5091"></td>
          <td id="LC5091"><span>Private</span> <span>Sub</span> <span>pvBufferReadBlockStart(uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>1</span><span>,</span> <span>Optional</span> <span>BlockSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5092" data-line-number="5092"></td>
          <td id="LC5092">    <span>With</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L5093" data-line-number="5093"></td>
          <td id="LC5093">        <span>If</span> <span>.Stack</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5094" data-line-number="5094"></td>
          <td id="LC5094">            <span>Set</span> <span>.Stack</span> <span>=</span> <span>New</span> <span>Collection</span></td>
        </tr>
        <tr>
          <td id="L5095" data-line-number="5095"></td>
          <td id="LC5095">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5096" data-line-number="5096"></td>
          <td id="LC5096">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>BlockSize,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L5097" data-line-number="5097"></td>
          <td id="LC5097">        <span>If</span> <span>.Stack.Count</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5098" data-line-number="5098"></td>
          <td id="LC5098">            <span>.Stack.Add</span> <span>uInput.Pos</span> <span>+</span> <span>BlockSize</span></td>
        </tr>
        <tr>
          <td id="L5099" data-line-number="5099"></td>
          <td id="LC5099">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5100" data-line-number="5100"></td>
          <td id="LC5100">            <span>.Stack.Add</span> <span>uInput.Pos</span> <span>+</span> <span>BlockSize,</span> <span>Before:=</span><span>1</span></td>
        </tr>
        <tr>
          <td id="L5101" data-line-number="5101"></td>
          <td id="LC5101">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5102" data-line-number="5102"></td>
          <td id="LC5102">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5103" data-line-number="5103"></td>
          <td id="LC5103"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5104" data-line-number="5104"></td>
          <td id="LC5104">
</td>
        </tr>
        <tr>
          <td id="L5105" data-line-number="5105"></td>
          <td id="LC5105"><span>Private</span> <span>Sub</span> <span>pvBufferReadBlockEnd(uInput</span> <span>As</span> <span>UcsBuffer)</span></td>
        </tr>
        <tr>
          <td id="L5106" data-line-number="5106"></td>
          <td id="LC5106">    <span>Dim</span> <span>lEnd</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5107" data-line-number="5107"></td>
          <td id="LC5107">    </td>
        </tr>
        <tr>
          <td id="L5108" data-line-number="5108"></td>
          <td id="LC5108">    <span>With</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L5109" data-line-number="5109"></td>
          <td id="LC5109">        <span>lEnd</span> <span>=</span> <span>.Stack.Item(</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5110" data-line-number="5110"></td>
          <td id="LC5110">        <span>.Stack.Remove</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5111" data-line-number="5111"></td>
          <td id="LC5111">        <span>Debug.Assert</span> <span>.Pos</span> <span>=</span> <span>lEnd</span></td>
        </tr>
        <tr>
          <td id="L5112" data-line-number="5112"></td>
          <td id="LC5112">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5113" data-line-number="5113"></td>
          <td id="LC5113"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5114" data-line-number="5114"></td>
          <td id="LC5114">
</td>
        </tr>
        <tr>
          <td id="L5115" data-line-number="5115"></td>
          <td id="LC5115"><span>Private</span> <span>Sub</span> <span>pvBufferReadLong(uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>lValue</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5116" data-line-number="5116"></td>
          <td id="LC5116">    <span>Static</span> <span>baTemp(</span><span>0</span> <span>To</span> <span>3</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5117" data-line-number="5117"></td>
          <td id="LC5117">    </td>
        </tr>
        <tr>
          <td id="L5118" data-line-number="5118"></td>
          <td id="LC5118">    <span>lValue</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5119" data-line-number="5119"></td>
          <td id="LC5119">    <span>With</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L5120" data-line-number="5120"></td>
          <td id="LC5120">        <span>If</span> <span>.Pos</span> <span>+</span> <span>Size</span> <span>&lt;=</span> <span>pvArraySize(.Data)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5121" data-line-number="5121"></td>
          <td id="LC5121">            <span>If</span> <span>Size</span> <span>&lt;=</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5122" data-line-number="5122"></td>
          <td id="LC5122">                <span>lValue</span> <span>=</span> <span>.Data(.Pos)</span></td>
        </tr>
        <tr>
          <td id="L5123" data-line-number="5123"></td>
          <td id="LC5123">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5124" data-line-number="5124"></td>
          <td id="LC5124">                <span>baTemp(Size</span> <span>-</span> <span>1</span><span>)</span> <span>=</span> <span>.Data(.Pos</span> <span>+</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5125" data-line-number="5125"></td>
          <td id="LC5125">                <span>baTemp(Size</span> <span>-</span> <span>2</span><span>)</span> <span>=</span> <span>.Data(.Pos</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5126" data-line-number="5126"></td>
          <td id="LC5126">                <span>If</span> <span>Size</span> <span>&gt;=</span> <span>3</span> <span>Then</span> <span>baTemp(Size</span> <span>-</span> <span>3</span><span>)</span> <span>=</span> <span>.Data(.Pos</span> <span>+</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5127" data-line-number="5127"></td>
          <td id="LC5127">                <span>If</span> <span>Size</span> <span>&gt;=</span> <span>4</span> <span>Then</span> <span>baTemp(Size</span> <span>-</span> <span>4</span><span>)</span> <span>=</span> <span>.Data(.Pos</span> <span>+</span> <span>3</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5128" data-line-number="5128"></td>
          <td id="LC5128">                <span>Call</span> <span>CopyMemory(lValue,</span> <span>baTemp(</span><span>0</span><span>),</span> <span>Size)</span></td>
        </tr>
        <tr>
          <td id="L5129" data-line-number="5129"></td>
          <td id="LC5129">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5130" data-line-number="5130"></td>
          <td id="LC5130">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5131" data-line-number="5131"></td>
          <td id="LC5131">        <span>.Pos</span> <span>=</span> <span>.Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L5132" data-line-number="5132"></td>
          <td id="LC5132">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5133" data-line-number="5133"></td>
          <td id="LC5133"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5134" data-line-number="5134"></td>
          <td id="LC5134">
</td>
        </tr>
        <tr>
          <td id="L5135" data-line-number="5135"></td>
          <td id="LC5135"><span>Private</span> <span>Sub</span> <span>pvBufferReadBlob(uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5136" data-line-number="5136"></td>
          <td id="LC5136">    <span>Dim</span> <span>baDest()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5137" data-line-number="5137"></td>
          <td id="LC5137">    </td>
        </tr>
        <tr>
          <td id="L5138" data-line-number="5138"></td>
          <td id="LC5138">    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baDest,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5139" data-line-number="5139"></td>
          <td id="LC5139">    <span>lSize</span> <span>=</span> <span>pvArraySize(baDest)</span></td>
        </tr>
        <tr>
          <td id="L5140" data-line-number="5140"></td>
          <td id="LC5140">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5141" data-line-number="5141"></td>
          <td id="LC5141">        <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>lPtr,</span> <span>baDest(</span><span>0</span><span>),</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L5142" data-line-number="5142"></td>
          <td id="LC5142">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5143" data-line-number="5143"></td>
          <td id="LC5143"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5144" data-line-number="5144"></td>
          <td id="LC5144">
</td>
        </tr>
        <tr>
          <td id="L5145" data-line-number="5145"></td>
          <td id="LC5145"><span>Private</span> <span>Sub</span> <span>pvBufferReadArray(uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>baDest()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5146" data-line-number="5146"></td>
          <td id="LC5146">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvBufferReadArray&#34;</span></td>
        </tr>
        <tr>
          <td id="L5147" data-line-number="5147"></td>
          <td id="LC5147">    </td>
        </tr>
        <tr>
          <td id="L5148" data-line-number="5148"></td>
          <td id="LC5148">    <span>With</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L5149" data-line-number="5149"></td>
          <td id="LC5149">        <span>If</span> <span>lSize</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5150" data-line-number="5150"></td>
          <td id="LC5150">            <span>lSize</span> <span>=</span> <span>pvArraySize(.Data)</span> <span>-</span> <span>.Pos</span></td>
        </tr>
        <tr>
          <td id="L5151" data-line-number="5151"></td>
          <td id="LC5151">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5152" data-line-number="5152"></td>
          <td id="LC5152">        <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5153" data-line-number="5153"></td>
          <td id="LC5153">            <span>pvArrayAllocate</span> <span>baDest,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baDest&#34;</span></td>
        </tr>
        <tr>
          <td id="L5154" data-line-number="5154"></td>
          <td id="LC5154">            <span>If</span> <span>.Pos</span> <span>+</span> <span>lSize</span> <span>&lt;=</span> <span>pvArraySize(.Data)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5155" data-line-number="5155"></td>
          <td id="LC5155">                <span>Call</span> <span>CopyMemory(baDest(</span><span>0</span><span>),</span> <span>.Data(.Pos),</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L5156" data-line-number="5156"></td>
          <td id="LC5156">            <span>ElseIf</span> <span>.Pos</span> <span>&lt;</span> <span>pvArraySize(.Data)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5157" data-line-number="5157"></td>
          <td id="LC5157">                <span>Call</span> <span>CopyMemory(baDest(</span><span>0</span><span>),</span> <span>.Data(.Pos),</span> <span>pvArraySize(.Data)</span> <span>-</span> <span>.Pos)</span></td>
        </tr>
        <tr>
          <td id="L5158" data-line-number="5158"></td>
          <td id="LC5158">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5159" data-line-number="5159"></td>
          <td id="LC5159">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5160" data-line-number="5160"></td>
          <td id="LC5160">            <span>Erase</span> <span>baDest</span></td>
        </tr>
        <tr>
          <td id="L5161" data-line-number="5161"></td>
          <td id="LC5161">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5162" data-line-number="5162"></td>
          <td id="LC5162">        <span>.Pos</span> <span>=</span> <span>.Pos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5163" data-line-number="5163"></td>
          <td id="LC5163">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5164" data-line-number="5164"></td>
          <td id="LC5164"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5165" data-line-number="5165"></td>
          <td id="LC5165">
</td>
        </tr>
        <tr>
          <td id="L5166" data-line-number="5166"></td>
          <td id="LC5166"><span>Private</span> <span>Sub</span> <span>pvBufferReadString(uInput</span> <span>As</span> <span>UcsBuffer,</span> <span>sValue</span> <span>As</span> <span>String</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5167" data-line-number="5167"></td>
          <td id="LC5167">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5168" data-line-number="5168"></td>
          <td id="LC5168">    </td>
        </tr>
        <tr>
          <td id="L5169" data-line-number="5169"></td>
          <td id="LC5169">    <span>pvBufferReadArray</span> <span>uInput,</span> <span>baTemp(),</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5170" data-line-number="5170"></td>
          <td id="LC5170">    <span>sValue</span> <span>=</span> <span>StrConv(baTemp,</span> <span>vbUnicode)</span></td>
        </tr>
        <tr>
          <td id="L5171" data-line-number="5171"></td>
          <td id="LC5171"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5172" data-line-number="5172"></td>
          <td id="LC5172">
</td>
        </tr>
        <tr>
          <td id="L5173" data-line-number="5173"></td>
          <td id="LC5173"><span>&#39;= arrays helpers ========================================================</span></td>
        </tr>
        <tr>
          <td id="L5174" data-line-number="5174"></td>
          <td id="LC5174">
</td>
        </tr>
        <tr>
          <td id="L5175" data-line-number="5175"></td>
          <td id="LC5175"><span>Private</span> <span>Sub</span> <span>pvArrayAllocate(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>sFuncName</span> <span>As</span> <span>String</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5176" data-line-number="5176"></td>
          <td id="LC5176">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5177" data-line-number="5177"></td>
          <td id="LC5177">        <span>ReDim</span> <span>baRetVal(</span><span>0</span> <span>To</span> <span>lSize</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5178" data-line-number="5178"></td>
          <td id="LC5178">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5179" data-line-number="5179"></td>
          <td id="LC5179">        <span>baRetVal</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L5180" data-line-number="5180"></td>
          <td id="LC5180">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5181" data-line-number="5181"></td>
          <td id="LC5181">    <span>Debug.Assert</span> <span>RedimStats(MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>sFuncName,</span> <span>UBound(baRetVal)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5182" data-line-number="5182"></td>
          <td id="LC5182"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5183" data-line-number="5183"></td>
          <td id="LC5183">
</td>
        </tr>
        <tr>
          <td id="L5184" data-line-number="5184"></td>
          <td id="LC5184"><span>Private</span> <span>Sub</span> <span>pvArrayReallocate(baArray()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>sFuncName</span> <span>As</span> <span>String</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5185" data-line-number="5185"></td>
          <td id="LC5185">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5186" data-line-number="5186"></td>
          <td id="LC5186">        <span>ReDim</span> <span>Preserve</span> <span>baArray(</span><span>0</span> <span>To</span> <span>lSize</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5187" data-line-number="5187"></td>
          <td id="LC5187">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5188" data-line-number="5188"></td>
          <td id="LC5188">        <span>baArray</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L5189" data-line-number="5189"></td>
          <td id="LC5189">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5190" data-line-number="5190"></td>
          <td id="LC5190">    <span>Debug.Assert</span> <span>RedimStats(MODULE_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>sFuncName,</span> <span>UBound(baArray)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5191" data-line-number="5191"></td>
          <td id="LC5191"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5192" data-line-number="5192"></td>
          <td id="LC5192">
</td>
        </tr>
        <tr>
          <td id="L5193" data-line-number="5193"></td>
          <td id="LC5193"><span>Private</span> <span>Property</span> <span>Get</span> <span>pvArraySize(baArray()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5194" data-line-number="5194"></td>
          <td id="LC5194">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5195" data-line-number="5195"></td>
          <td id="LC5195">    </td>
        </tr>
        <tr>
          <td id="L5196" data-line-number="5196"></td>
          <td id="LC5196">    <span>&#39;--- peek long at ArrPtr(baArray)</span></td>
        </tr>
        <tr>
          <td id="L5197" data-line-number="5197"></td>
          <td id="LC5197">    <span>Call</span> <span>CopyMemory(lPtr,</span> <span>ByVal</span> <span>ArrPtr(baArray),</span> <span>LenB(lPtr))</span></td>
        </tr>
        <tr>
          <td id="L5198" data-line-number="5198"></td>
          <td id="LC5198">    <span>If</span> <span>lPtr</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5199" data-line-number="5199"></td>
          <td id="LC5199">        <span>pvArraySize</span> <span>=</span> <span>UBound(baArray)</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5200" data-line-number="5200"></td>
          <td id="LC5200">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5201" data-line-number="5201"></td>
          <td id="LC5201"><span>End</span> <span>Property</span></td>
        </tr>
        <tr>
          <td id="L5202" data-line-number="5202"></td>
          <td id="LC5202">
</td>
        </tr>
        <tr>
          <td id="L5203" data-line-number="5203"></td>
          <td id="LC5203"><span>Private</span> <span>Sub</span> <span>pvArrayXor(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baArray()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lSeqNo</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5204" data-line-number="5204"></td>
          <td id="LC5204">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5205" data-line-number="5205"></td>
          <td id="LC5205">    </td>
        </tr>
        <tr>
          <td id="L5206" data-line-number="5206"></td>
          <td id="LC5206">    <span>baRetVal</span> <span>=</span> <span>baArray</span></td>
        </tr>
        <tr>
          <td id="L5207" data-line-number="5207"></td>
          <td id="LC5207">    <span>lIdx</span> <span>=</span> <span>pvArraySize(baRetVal)</span></td>
        </tr>
        <tr>
          <td id="L5208" data-line-number="5208"></td>
          <td id="LC5208">    <span>Do</span> <span>While</span> <span>lSeqNo</span> <span>&lt;&gt;</span> <span>0</span> <span>And</span> <span>lIdx</span> <span>&gt;</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5209" data-line-number="5209"></td>
          <td id="LC5209">        <span>lIdx</span> <span>=</span> <span>lIdx</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5210" data-line-number="5210"></td>
          <td id="LC5210">        <span>baRetVal(lIdx)</span> <span>=</span> <span>baRetVal(lIdx)</span> <span>Xor</span> <span>(lSeqNo</span> <span>And</span> <span>&amp;HFF</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5211" data-line-number="5211"></td>
          <td id="LC5211">        <span>lSeqNo</span> <span>=</span> <span>(lSeqNo</span> <span>And</span> <span>-</span><span>&amp;H100&amp;</span><span>)</span> <span>\</span> <span>&amp;H100&amp;</span></td>
        </tr>
        <tr>
          <td id="L5212" data-line-number="5212"></td>
          <td id="LC5212">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L5213" data-line-number="5213"></td>
          <td id="LC5213"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5214" data-line-number="5214"></td>
          <td id="LC5214">
</td>
        </tr>
        <tr>
          <td id="L5215" data-line-number="5215"></td>
          <td id="LC5215"><span>Private</span> <span>Sub</span> <span>pvArraySwap(baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lBufferPos</span> <span>As</span> <span>Long</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>lInputPos</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5216" data-line-number="5216"></td>
          <td id="LC5216">    <span>Dim</span> <span>lTemp</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5217" data-line-number="5217"></td>
          <td id="LC5217">    </td>
        </tr>
        <tr>
          <td id="L5218" data-line-number="5218"></td>
          <td id="LC5218">    <span>Call</span> <span>CopyMemory(lTemp,</span> <span>ByVal</span> <span>ArrPtr(baBuffer),</span> <span>LenB(lTemp))</span></td>
        </tr>
        <tr>
          <td id="L5219" data-line-number="5219"></td>
          <td id="LC5219">    <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>ArrPtr(baBuffer),</span> <span>ByVal</span> <span>ArrPtr(baInput),</span> <span>LenB(lTemp))</span></td>
        </tr>
        <tr>
          <td id="L5220" data-line-number="5220"></td>
          <td id="LC5220">    <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>ArrPtr(baInput),</span> <span>lTemp,</span> <span>LenB(lTemp))</span></td>
        </tr>
        <tr>
          <td id="L5221" data-line-number="5221"></td>
          <td id="LC5221">    <span>lTemp</span> <span>=</span> <span>lBufferPos</span></td>
        </tr>
        <tr>
          <td id="L5222" data-line-number="5222"></td>
          <td id="LC5222">    <span>lBufferPos</span> <span>=</span> <span>lInputPos</span></td>
        </tr>
        <tr>
          <td id="L5223" data-line-number="5223"></td>
          <td id="LC5223">    <span>lInputPos</span> <span>=</span> <span>lTemp</span></td>
        </tr>
        <tr>
          <td id="L5224" data-line-number="5224"></td>
          <td id="LC5224"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5225" data-line-number="5225"></td>
          <td id="LC5225">
</td>
        </tr>
        <tr>
          <td id="L5226" data-line-number="5226"></td>
          <td id="LC5226"><span>Private</span> <span>Sub</span> <span>pvArrayByte(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ParamArray</span> <span>A()</span> <span>As</span> <span>Variant</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5227" data-line-number="5227"></td>
          <td id="LC5227">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvArrayByte&#34;</span></td>
        </tr>
        <tr>
          <td id="L5228" data-line-number="5228"></td>
          <td id="LC5228">    <span>Dim</span> <span>vElem</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L5229" data-line-number="5229"></td>
          <td id="LC5229">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5230" data-line-number="5230"></td>
          <td id="LC5230">    </td>
        </tr>
        <tr>
          <td id="L5231" data-line-number="5231"></td>
          <td id="LC5231">    <span>If</span> <span>UBound(A)</span> <span>&gt;=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5232" data-line-number="5232"></td>
          <td id="LC5232">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>UBound(A)</span> <span>+</span> <span>1</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L5233" data-line-number="5233"></td>
          <td id="LC5233">        <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>A</span></td>
        </tr>
        <tr>
          <td id="L5234" data-line-number="5234"></td>
          <td id="LC5234">            <span>baRetVal(lIdx)</span> <span>=</span> <span>vElem</span> <span>And</span> <span>&amp;HFF</span></td>
        </tr>
        <tr>
          <td id="L5235" data-line-number="5235"></td>
          <td id="LC5235">            <span>lIdx</span> <span>=</span> <span>lIdx</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5236" data-line-number="5236"></td>
          <td id="LC5236">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5237" data-line-number="5237"></td>
          <td id="LC5237">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5238" data-line-number="5238"></td>
          <td id="LC5238"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5239" data-line-number="5239"></td>
          <td id="LC5239">
</td>
        </tr>
        <tr>
          <td id="L5240" data-line-number="5240"></td>
          <td id="LC5240"><span>Private</span> <span>Sub</span> <span>pvArrayHash(</span><span>ByVal</span> <span>lHashSize</span> <span>As</span> <span>Long</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baRetVal()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5241" data-line-number="5241"></td>
          <td id="LC5241">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvArrayHash&#34;</span></td>
        </tr>
        <tr>
          <td id="L5242" data-line-number="5242"></td>
          <td id="LC5242">    </td>
        </tr>
        <tr>
          <td id="L5243" data-line-number="5243"></td>
          <td id="LC5243">    <span>Select</span> <span>Case</span> <span>lHashSize</span></td>
        </tr>
        <tr>
          <td id="L5244" data-line-number="5244"></td>
          <td id="LC5244">    <span>Case</span> <span>LNG_SHA1_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5245" data-line-number="5245"></td>
          <td id="LC5245">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha1(baRetVal,</span> <span>baInput)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5246" data-line-number="5246"></td>
          <td id="LC5246">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha1&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5247" data-line-number="5247"></td>
          <td id="LC5247">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5248" data-line-number="5248"></td>
          <td id="LC5248">    <span>Case</span> <span>LNG_SHA224_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5249" data-line-number="5249"></td>
          <td id="LC5249">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha224(baRetVal,</span> <span>baInput)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5250" data-line-number="5250"></td>
          <td id="LC5250">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha224&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5251" data-line-number="5251"></td>
          <td id="LC5251">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5252" data-line-number="5252"></td>
          <td id="LC5252">    <span>Case</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5253" data-line-number="5253"></td>
          <td id="LC5253">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha256(baRetVal,</span> <span>baInput)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5254" data-line-number="5254"></td>
          <td id="LC5254">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha256&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5255" data-line-number="5255"></td>
          <td id="LC5255">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5256" data-line-number="5256"></td>
          <td id="LC5256">    <span>Case</span> <span>LNG_SHA384_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5257" data-line-number="5257"></td>
          <td id="LC5257">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha384(baRetVal,</span> <span>baInput)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5258" data-line-number="5258"></td>
          <td id="LC5258">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha384&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5259" data-line-number="5259"></td>
          <td id="LC5259">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5260" data-line-number="5260"></td>
          <td id="LC5260">    <span>Case</span> <span>LNG_SHA512_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5261" data-line-number="5261"></td>
          <td id="LC5261">        <span>If</span> <span>Not</span> <span>pvCryptoHashSha512(baRetVal,</span> <span>baInput)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5262" data-line-number="5262"></td>
          <td id="LC5262">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_CALL_FAILED,</span> <span>&#34;%1&#34;</span><span>,</span> <span>&#34;CryptoHashSha512&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5263" data-line-number="5263"></td>
          <td id="LC5263">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5264" data-line-number="5264"></td>
          <td id="LC5264">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5265" data-line-number="5265"></td>
          <td id="LC5265">        <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>Replace(ERR_INVALID_HASH_SIZE,</span> <span>&#34;%1&#34;</span><span>,</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5266" data-line-number="5266"></td>
          <td id="LC5266">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L5267" data-line-number="5267"></td>
          <td id="LC5267"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5268" data-line-number="5268"></td>
          <td id="LC5268">
</td>
        </tr>
        <tr>
          <td id="L5269" data-line-number="5269"></td>
          <td id="LC5269"><span>Private</span> <span>Sub</span> <span>pvArrayIncCounter(baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5270" data-line-number="5270"></td>
          <td id="LC5270">    <span>Do</span> <span>While</span> <span>lPos</span> <span>&gt;=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5271" data-line-number="5271"></td>
          <td id="LC5271">        <span>If</span> <span>baInput(lPos)</span> <span>&lt;</span> <span>255</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5272" data-line-number="5272"></td>
          <td id="LC5272">            <span>baInput(lPos)</span> <span>=</span> <span>baInput(lPos)</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5273" data-line-number="5273"></td>
          <td id="LC5273">            <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L5274" data-line-number="5274"></td>
          <td id="LC5274">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5275" data-line-number="5275"></td>
          <td id="LC5275">            <span>baInput(lPos)</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5276" data-line-number="5276"></td>
          <td id="LC5276">            <span>lPos</span> <span>=</span> <span>lPos</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5277" data-line-number="5277"></td>
          <td id="LC5277">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5278" data-line-number="5278"></td>
          <td id="LC5278">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L5279" data-line-number="5279"></td>
          <td id="LC5279"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5280" data-line-number="5280"></td>
          <td id="LC5280">
</td>
        </tr>
        <tr>
          <td id="L5281" data-line-number="5281"></td>
          <td id="LC5281"><span>Private</span> <span>Sub</span> <span>pvArrayReverse(baData()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>NewSize</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5282" data-line-number="5282"></td>
          <td id="LC5282">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvArrayReverse&#34;</span></td>
        </tr>
        <tr>
          <td id="L5283" data-line-number="5283"></td>
          <td id="LC5283">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5284" data-line-number="5284"></td>
          <td id="LC5284">    <span>Dim</span> <span>bTemp</span>           <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5285" data-line-number="5285"></td>
          <td id="LC5285">    <span>Dim</span> <span>baCopy()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5286" data-line-number="5286"></td>
          <td id="LC5286">    </td>
        </tr>
        <tr>
          <td id="L5287" data-line-number="5287"></td>
          <td id="LC5287">    <span>If</span> <span>NewSize</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5288" data-line-number="5288"></td>
          <td id="LC5288">        <span>baData</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L5289" data-line-number="5289"></td>
          <td id="LC5289">    <span>ElseIf</span> <span>NewSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5290" data-line-number="5290"></td>
          <td id="LC5290">        <span>baCopy</span> <span>=</span> <span>baData</span></td>
        </tr>
        <tr>
          <td id="L5291" data-line-number="5291"></td>
          <td id="LC5291">        <span>pvArrayAllocate</span> <span>baData,</span> <span>NewSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baData&#34;</span></td>
        </tr>
        <tr>
          <td id="L5292" data-line-number="5292"></td>
          <td id="LC5292">        <span>Call</span> <span>CopyMemory(baData(</span><span>0</span><span>),</span> <span>baCopy(</span><span>0</span><span>),</span> <span>IIf(NewSize</span> <span>&lt;</span> <span>UBound(baCopy)</span> <span>+</span> <span>1</span><span>,</span> <span>NewSize,</span> <span>UBound(baCopy)</span> <span>+</span> <span>1</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L5293" data-line-number="5293"></td>
          <td id="LC5293">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5294" data-line-number="5294"></td>
          <td id="LC5294">    <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baData)</span> <span>\</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L5295" data-line-number="5295"></td>
          <td id="LC5295">        <span>bTemp</span> <span>=</span> <span>baData(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L5296" data-line-number="5296"></td>
          <td id="LC5296">        <span>baData(lIdx)</span> <span>=</span> <span>baData(UBound(baData)</span> <span>-</span> <span>lIdx)</span></td>
        </tr>
        <tr>
          <td id="L5297" data-line-number="5297"></td>
          <td id="LC5297">        <span>baData(UBound(baData)</span> <span>-</span> <span>lIdx)</span> <span>=</span> <span>bTemp</span></td>
        </tr>
        <tr>
          <td id="L5298" data-line-number="5298"></td>
          <td id="LC5298">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5299" data-line-number="5299"></td>
          <td id="LC5299"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L5300" data-line-number="5300"></td>
          <td id="LC5300">
</td>
        </tr>
        <tr>
          <td id="L5301" data-line-number="5301"></td>
          <td id="LC5301"><span>Private</span> <span>Function</span> <span>pvArrayAccumulateOr(baData()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5302" data-line-number="5302"></td>
          <td id="LC5302">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5303" data-line-number="5303"></td>
          <td id="LC5303">    </td>
        </tr>
        <tr>
          <td id="L5304" data-line-number="5304"></td>
          <td id="LC5304">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5305" data-line-number="5305"></td>
          <td id="LC5305">        <span>Size</span> <span>=</span> <span>pvArraySize(baData)</span></td>
        </tr>
        <tr>
          <td id="L5306" data-line-number="5306"></td>
          <td id="LC5306">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5307" data-line-number="5307"></td>
          <td id="LC5307">    <span>For</span> <span>lIdx</span> <span>=</span> <span>Pos</span> <span>To</span> <span>Size</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5308" data-line-number="5308"></td>
          <td id="LC5308">        <span>pvArrayAccumulateOr</span> <span>=</span> <span>pvArrayAccumulateOr</span> <span>Or</span> <span>baData(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L5309" data-line-number="5309"></td>
          <td id="LC5309">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5310" data-line-number="5310"></td>
          <td id="LC5310"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5311" data-line-number="5311"></td>
          <td id="LC5311">
</td>
        </tr>
        <tr>
          <td id="L5312" data-line-number="5312"></td>
          <td id="LC5312"><span>Private</span> <span>Function</span> <span>pvArrayEqual(baFirst()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baSecond()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5313" data-line-number="5313"></td>
          <td id="LC5313">    <span>If</span> <span>pvArraySize(baFirst)</span> <span>=</span> <span>pvArraySize(baSecond)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5314" data-line-number="5314"></td>
          <td id="LC5314">        <span>pvArrayEqual</span> <span>=</span> <span>(InStrB(baFirst,</span> <span>baSecond)</span> <span>=</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5315" data-line-number="5315"></td>
          <td id="LC5315">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5316" data-line-number="5316"></td>
          <td id="LC5316"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5317" data-line-number="5317"></td>
          <td id="LC5317">
</td>
        </tr>
        <tr>
          <td id="L5318" data-line-number="5318"></td>
          <td id="LC5318"><span>Private</span> <span>Function</span> <span>pvToStringA(</span><span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5319" data-line-number="5319"></td>
          <td id="LC5319">    <span>If</span> <span>lPtr</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5320" data-line-number="5320"></td>
          <td id="LC5320">        <span>pvToStringA</span> <span>=</span> <span>String</span>$<span>(lstrlenA(lPtr),</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5321" data-line-number="5321"></td>
          <td id="LC5321">        <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>pvToStringA,</span> <span>ByVal</span> <span>lPtr,</span> <span>Len(pvToStringA))</span></td>
        </tr>
        <tr>
          <td id="L5322" data-line-number="5322"></td>
          <td id="LC5322">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5323" data-line-number="5323"></td>
          <td id="LC5323"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5324" data-line-number="5324"></td>
          <td id="LC5324">
</td>
        </tr>
        <tr>
          <td id="L5325" data-line-number="5325"></td>
          <td id="LC5325"><span>Private</span> <span>Function</span> <span>pvCollectionCount(oCol</span> <span>As</span> <span>Collection)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5326" data-line-number="5326"></td>
          <td id="LC5326">    <span>If</span> <span>Not</span> <span>oCol</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5327" data-line-number="5327"></td>
          <td id="LC5327">        <span>pvCollectionCount</span> <span>=</span> <span>oCol.Count</span></td>
        </tr>
        <tr>
          <td id="L5328" data-line-number="5328"></td>
          <td id="LC5328">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5329" data-line-number="5329"></td>
          <td id="LC5329"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5330" data-line-number="5330"></td>
          <td id="LC5330">
</td>
        </tr>
        <tr>
          <td id="L5331" data-line-number="5331"></td>
          <td id="LC5331"><span>Private</span> <span>Function</span> <span>pvCollectionFirst(oCol</span> <span>As</span> <span>Collection,</span> <span>vKeys</span> <span>As</span> <span>Variant</span><span>)</span> <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L5332" data-line-number="5332"></td>
          <td id="LC5332">    <span>Dim</span> <span>vElem</span>       <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L5333" data-line-number="5333"></td>
          <td id="LC5333">    </td>
        </tr>
        <tr>
          <td id="L5334" data-line-number="5334"></td>
          <td id="LC5334">    <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>vKeys</span></td>
        </tr>
        <tr>
          <td id="L5335" data-line-number="5335"></td>
          <td id="LC5335">        <span>If</span> <span>SearchCollection(oCol,</span> <span>vElem,</span> <span>RetVal:=pvCollectionFirst)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5336" data-line-number="5336"></td>
          <td id="LC5336">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L5337" data-line-number="5337"></td>
          <td id="LC5337">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5338" data-line-number="5338"></td>
          <td id="LC5338">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5339" data-line-number="5339"></td>
          <td id="LC5339"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5340" data-line-number="5340"></td>
          <td id="LC5340">
</td>
        </tr>
        <tr>
          <td id="L5341" data-line-number="5341"></td>
          <td id="LC5341"><span>Private</span> <span>Function</span> <span>pvToHex(</span><span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5342" data-line-number="5342"></td>
          <td id="LC5342">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;pvToHex&#34;</span></td>
        </tr>
        <tr>
          <td id="L5343" data-line-number="5343"></td>
          <td id="LC5343">    <span>Dim</span> <span>aText()</span>         <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5344" data-line-number="5344"></td>
          <td id="LC5344">    <span>Dim</span> <span>lByte</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5345" data-line-number="5345"></td>
          <td id="LC5345">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5346" data-line-number="5346"></td>
          <td id="LC5346">    </td>
        </tr>
        <tr>
          <td id="L5347" data-line-number="5347"></td>
          <td id="LC5347">    <span>If</span> <span>lSize</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5348" data-line-number="5348"></td>
          <td id="LC5348">        <span>ReDim</span> <span>aText(</span><span>0</span> <span>To</span> <span>lSize</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5349" data-line-number="5349"></td>
          <td id="LC5349">        <span>Debug.Assert</span> <span>RedimStats(FUNC_NAME</span> <span>&amp;</span> <span>&#34;.aText&#34;</span><span>,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5350" data-line-number="5350"></td>
          <td id="LC5350">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>lSize</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5351" data-line-number="5351"></td>
          <td id="LC5351">            <span>Call</span> <span>CopyMemory(lByte,</span> <span>ByVal</span> <span>lPtr,</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5352" data-line-number="5352"></td>
          <td id="LC5352">            <span>lPtr</span> <span>=</span> <span>(lPtr</span> <span>Xor</span> <span>&amp;H80000000</span><span>)</span> <span>+</span> <span>1</span> <span>Xor</span> <span>&amp;H80000000</span></td>
        </tr>
        <tr>
          <td id="L5353" data-line-number="5353"></td>
          <td id="LC5353">            <span>aText(lIdx)</span> <span>=</span> <span>Right$(</span><span>&#34;0&#34;</span> <span>&amp;</span> <span>Hex$(lByte),</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5354" data-line-number="5354"></td>
          <td id="LC5354">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5355" data-line-number="5355"></td>
          <td id="LC5355">        <span>pvToHex</span> <span>=</span> <span>Join</span><span>(aText,</span> <span>vbNullString)</span></td>
        </tr>
        <tr>
          <td id="L5356" data-line-number="5356"></td>
          <td id="LC5356">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5357" data-line-number="5357"></td>
          <td id="LC5357"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5358" data-line-number="5358"></td>
          <td id="LC5358">
</td>
        </tr>
        <tr>
          <td id="L5359" data-line-number="5359"></td>
          <td id="LC5359"><span>Private</span> <span>Function</span> <span>pvIsValidServerName(sName</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5360" data-line-number="5360"></td>
          <td id="LC5360">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5361" data-line-number="5361"></td>
          <td id="LC5361">    </td>
        </tr>
        <tr>
          <td id="L5362" data-line-number="5362"></td>
          <td id="LC5362">    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>Len(sName)</span></td>
        </tr>
        <tr>
          <td id="L5363" data-line-number="5363"></td>
          <td id="LC5363">        <span>Select</span> <span>Case</span> <span>AscW(Mid$(sName,</span> <span>lIdx,</span> <span>1</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L5364" data-line-number="5364"></td>
          <td id="LC5364">        <span>Case</span> <span>65</span> <span>To</span> <span>90</span><span>,</span> <span>97</span> <span>To</span> <span>122</span><span>,</span> <span>48</span> <span>To</span> <span>57</span><span>,</span> <span>45</span><span>,</span> <span>46</span>  <span>&#39;--- A-Z, a-z, 0-9, &#34;-&#34;, &#34;.&#34;</span></td>
        </tr>
        <tr>
          <td id="L5365" data-line-number="5365"></td>
          <td id="LC5365">            <span>&#39;--- do nothing</span></td>
        </tr>
        <tr>
          <td id="L5366" data-line-number="5366"></td>
          <td id="LC5366">        <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5367" data-line-number="5367"></td>
          <td id="LC5367">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5368" data-line-number="5368"></td>
          <td id="LC5368">        <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L5369" data-line-number="5369"></td>
          <td id="LC5369">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5370" data-line-number="5370"></td>
          <td id="LC5370">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5371" data-line-number="5371"></td>
          <td id="LC5371">    <span>pvIsValidServerName</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5372" data-line-number="5372"></td>
          <td id="LC5372"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5373" data-line-number="5373"></td>
          <td id="LC5373">
</td>
        </tr>
        <tr>
          <td id="L5374" data-line-number="5374"></td>
          <td id="LC5374"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L5375" data-line-number="5375"></td>
          <td id="LC5375"><span>&#39; Crypto</span></td>
        </tr>
        <tr>
          <td id="L5376" data-line-number="5376"></td>
          <td id="LC5376"><span>&#39;=========================================================================</span></td>
        </tr>
        <tr>
          <td id="L5377" data-line-number="5377"></td>
          <td id="LC5377">
</td>
        </tr>
        <tr>
          <td id="L5378" data-line-number="5378"></td>
          <td id="LC5378"><span>Private</span> <span>Function</span> <span>pvCryptoIsSupported(</span><span>ByVal</span> <span>eAlgo</span> <span>As</span> <span>UcsTlsCryptoAlgorithmsEnum)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5379" data-line-number="5379"></td>
          <td id="LC5379">    <span>Const</span> <span>PREF</span>          <span>As</span> <span>Long</span> <span>=</span> <span>&amp;H1000</span></td>
        </tr>
        <tr>
          <td id="L5380" data-line-number="5380"></td>
          <td id="LC5380">    </td>
        </tr>
        <tr>
          <td id="L5381" data-line-number="5381"></td>
          <td id="LC5381">    <span>Select</span> <span>Case</span> <span>eAlgo</span></td>
        </tr>
        <tr>
          <td id="L5382" data-line-number="5382"></td>
          <td id="LC5382">    <span>Case</span> <span>ucsTlsAlgoExchSecp521r1</span></td>
        </tr>
        <tr>
          <td id="L5383" data-line-number="5383"></td>
          <td id="LC5383">        <span>&#39;--- not supported</span></td>
        </tr>
        <tr>
          <td id="L5384" data-line-number="5384"></td>
          <td id="LC5384">    <span>Case</span> <span>ucsTlsAlgoBulkAesGcm128,</span> <span>ucsTlsAlgoBulkAesGcm256</span></td>
        </tr>
        <tr>
          <td id="L5385" data-line-number="5385"></td>
          <td id="LC5385">        <span>pvCryptoIsSupported</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5386" data-line-number="5386"></td>
          <td id="LC5386">    <span>Case</span> <span>ucsTlsAlgoBulkChacha20Poly1305</span></td>
        </tr>
        <tr>
          <td id="L5387" data-line-number="5387"></td>
          <td id="LC5387">        <span>pvCryptoIsSupported</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5388" data-line-number="5388"></td>
          <td id="LC5388">    <span>Case</span> <span>PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm128,</span> <span>PREF</span> <span>+</span> <span>ucsTlsAlgoBulkAesGcm256</span></td>
        </tr>
        <tr>
          <td id="L5389" data-line-number="5389"></td>
          <td id="LC5389">        <span>&#39;--- signal if AES preferred over Chacha20</span></td>
        </tr>
        <tr>
          <td id="L5390" data-line-number="5390"></td>
          <td id="LC5390">        <span>pvCryptoIsSupported</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5391" data-line-number="5391"></td>
          <td id="LC5391">    <span>Case</span> <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5392" data-line-number="5392"></td>
          <td id="LC5392">        <span>pvCryptoIsSupported</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5393" data-line-number="5393"></td>
          <td id="LC5393">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L5394" data-line-number="5394"></td>
          <td id="LC5394"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5395" data-line-number="5395"></td>
          <td id="LC5395">
</td>
        </tr>
        <tr>
          <td id="L5396" data-line-number="5396"></td>
          <td id="LC5396"><span>Private</span> <span>Function</span> <span>pvCryptoEmePkcs1Encode(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baMessage()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lBitLen</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5397" data-line-number="5397"></td>
          <td id="LC5397">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEmePkcs1Encode&#34;</span></td>
        </tr>
        <tr>
          <td id="L5398" data-line-number="5398"></td>
          <td id="LC5398">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5399" data-line-number="5399"></td>
          <td id="LC5399">    </td>
        </tr>
        <tr>
          <td id="L5400" data-line-number="5400"></td>
          <td id="LC5400">    <span>&#39;--- from RFC 8017, Section  7.2.1</span></td>
        </tr>
        <tr>
          <td id="L5401" data-line-number="5401"></td>
          <td id="LC5401">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>(lBitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L5402" data-line-number="5402"></td>
          <td id="LC5402">    <span>If</span> <span>UBound(baMessage)</span> <span>&gt;</span> <span>UBound(baRetVal)</span> <span>-</span> <span>11</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5403" data-line-number="5403"></td>
          <td id="LC5403">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5404" data-line-number="5404"></td>
          <td id="LC5404">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5405" data-line-number="5405"></td>
          <td id="LC5405">    <span>baRetVal(</span><span>1</span><span>)</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L5406" data-line-number="5406"></td>
          <td id="LC5406">    <span>pvCryptoRandomBytes</span> <span>VarPtr(baRetVal(</span><span>2</span><span>)),</span> <span>UBound(baRetVal)</span> <span>-</span> <span>UBound(baMessage)</span> <span>-</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L5407" data-line-number="5407"></td>
          <td id="LC5407">    <span>For</span> <span>lIdx</span> <span>=</span> <span>2</span> <span>To</span> <span>UBound(baRetVal)</span> <span>-</span> <span>UBound(baMessage)</span> <span>-</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L5408" data-line-number="5408"></td>
          <td id="LC5408">        <span>If</span> <span>baRetVal(lIdx)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5409" data-line-number="5409"></td>
          <td id="LC5409">            <span>baRetVal(lIdx)</span> <span>=</span> <span>42</span></td>
        </tr>
        <tr>
          <td id="L5410" data-line-number="5410"></td>
          <td id="LC5410">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5411" data-line-number="5411"></td>
          <td id="LC5411">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5412" data-line-number="5412"></td>
          <td id="LC5412">    <span>Call</span> <span>CopyMemory(baRetVal(UBound(baRetVal)</span> <span>-</span> <span>UBound(baMessage)),</span> <span>baMessage(</span><span>0</span><span>),</span> <span>UBound(baMessage)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5413" data-line-number="5413"></td>
          <td id="LC5413">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5414" data-line-number="5414"></td>
          <td id="LC5414">    <span>pvCryptoEmePkcs1Encode</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5415" data-line-number="5415"></td>
          <td id="LC5415"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5416" data-line-number="5416"></td>
          <td id="LC5416"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5417" data-line-number="5417"></td>
          <td id="LC5417">
</td>
        </tr>
        <tr>
          <td id="L5418" data-line-number="5418"></td>
          <td id="LC5418"><span>Private</span> <span>Function</span> <span>pvCryptoEmePkcs1Decode(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baMessage()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5419" data-line-number="5419"></td>
          <td id="LC5419">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEmePkcs1Decode&#34;</span></td>
        </tr>
        <tr>
          <td id="L5420" data-line-number="5420"></td>
          <td id="LC5420">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5421" data-line-number="5421"></td>
          <td id="LC5421">    </td>
        </tr>
        <tr>
          <td id="L5422" data-line-number="5422"></td>
          <td id="LC5422">    <span>If</span> <span>baMessage(</span><span>0</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Or</span> <span>baMessage(</span><span>1</span><span>)</span> <span>&lt;&gt;</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5423" data-line-number="5423"></td>
          <td id="LC5423">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5424" data-line-number="5424"></td>
          <td id="LC5424">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5425" data-line-number="5425"></td>
          <td id="LC5425">    <span>For</span> <span>lIdx</span> <span>=</span> <span>2</span> <span>To</span> <span>UBound(baMessage)</span></td>
        </tr>
        <tr>
          <td id="L5426" data-line-number="5426"></td>
          <td id="LC5426">        <span>If</span> <span>baMessage(lIdx)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5427" data-line-number="5427"></td>
          <td id="LC5427">            <span>lIdx</span> <span>=</span> <span>lIdx</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5428" data-line-number="5428"></td>
          <td id="LC5428">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L5429" data-line-number="5429"></td>
          <td id="LC5429">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5430" data-line-number="5430"></td>
          <td id="LC5430">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5431" data-line-number="5431"></td>
          <td id="LC5431">    <span>If</span> <span>lIdx</span> <span>&gt;</span> <span>UBound(baMessage)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5432" data-line-number="5432"></td>
          <td id="LC5432">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5433" data-line-number="5433"></td>
          <td id="LC5433">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5434" data-line-number="5434"></td>
          <td id="LC5434">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>UBound(baMessage)</span> <span>+</span> <span>1</span> <span>-</span> <span>lIdx,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L5435" data-line-number="5435"></td>
          <td id="LC5435">    <span>Call</span> <span>CopyMemory(baRetVal(</span><span>0</span><span>),</span> <span>baMessage(lIdx),</span> <span>UBound(baRetVal)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5436" data-line-number="5436"></td>
          <td id="LC5436">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5437" data-line-number="5437"></td>
          <td id="LC5437">    <span>pvCryptoEmePkcs1Decode</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5438" data-line-number="5438"></td>
          <td id="LC5438"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5439" data-line-number="5439"></td>
          <td id="LC5439"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5440" data-line-number="5440"></td>
          <td id="LC5440">
</td>
        </tr>
        <tr>
          <td id="L5441" data-line-number="5441"></td>
          <td id="LC5441"><span>Private</span> <span>Function</span> <span>pvCryptoEmsaPkcs1Encode(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baMessage()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lBitLen</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lHashSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5442" data-line-number="5442"></td>
          <td id="LC5442">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEmsaPkcs1Encode&#34;</span></td>
        </tr>
        <tr>
          <td id="L5443" data-line-number="5443"></td>
          <td id="LC5443">    <span>Dim</span> <span>baHash()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5444" data-line-number="5444"></td>
          <td id="LC5444">    <span>Dim</span> <span>baDerHash()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5445" data-line-number="5445"></td>
          <td id="LC5445">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5446" data-line-number="5446"></td>
          <td id="LC5446">    </td>
        </tr>
        <tr>
          <td id="L5447" data-line-number="5447"></td>
          <td id="LC5447">    <span>&#39;--- from RFC 8017, Section 9.2.</span></td>
        </tr>
        <tr>
          <td id="L5448" data-line-number="5448"></td>
          <td id="LC5448">    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baMessage,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5449" data-line-number="5449"></td>
          <td id="LC5449">    <span>If</span> <span>Not</span> <span>pvAsn1EncodePkcs1Signature(baHash,</span> <span>baDerHash)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5450" data-line-number="5450"></td>
          <td id="LC5450">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5451" data-line-number="5451"></td>
          <td id="LC5451">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5452" data-line-number="5452"></td>
          <td id="LC5452">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>(lBitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L5453" data-line-number="5453"></td>
          <td id="LC5453">    <span>baRetVal(</span><span>1</span><span>)</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5454" data-line-number="5454"></td>
          <td id="LC5454">    <span>For</span> <span>lPos</span> <span>=</span> <span>2</span> <span>To</span> <span>UBound(baRetVal)</span> <span>-</span> <span>UBound(baDerHash)</span> <span>-</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L5455" data-line-number="5455"></td>
          <td id="LC5455">        <span>baRetVal(lPos)</span> <span>=</span> <span>&amp;HFF</span></td>
        </tr>
        <tr>
          <td id="L5456" data-line-number="5456"></td>
          <td id="LC5456">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5457" data-line-number="5457"></td>
          <td id="LC5457">    <span>lPos</span> <span>=</span> <span>lPos</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5458" data-line-number="5458"></td>
          <td id="LC5458">    <span>Debug.Assert</span> <span>UBound(baRetVal)</span> <span>-</span> <span>lPos</span> <span>&gt;=</span> <span>UBound(baDerHash)</span></td>
        </tr>
        <tr>
          <td id="L5459" data-line-number="5459"></td>
          <td id="LC5459">    <span>Call</span> <span>CopyMemory(baRetVal(lPos),</span> <span>baDerHash(</span><span>0</span><span>),</span> <span>UBound(baDerHash)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5460" data-line-number="5460"></td>
          <td id="LC5460">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5461" data-line-number="5461"></td>
          <td id="LC5461">    <span>pvCryptoEmsaPkcs1Encode</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5462" data-line-number="5462"></td>
          <td id="LC5462"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5463" data-line-number="5463"></td>
          <td id="LC5463"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5464" data-line-number="5464"></td>
          <td id="LC5464">
</td>
        </tr>
        <tr>
          <td id="L5465" data-line-number="5465"></td>
          <td id="LC5465"><span>Private</span> <span>Function</span> <span>pvCryptoEmsaPkcs1Decode(baMessage()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baEnc()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lHashSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5466" data-line-number="5466"></td>
          <td id="LC5466">    <span>Dim</span> <span>baHash()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5467" data-line-number="5467"></td>
          <td id="LC5467">    <span>Dim</span> <span>baDerHash()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5468" data-line-number="5468"></td>
          <td id="LC5468">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5469" data-line-number="5469"></td>
          <td id="LC5469">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5470" data-line-number="5470"></td>
          <td id="LC5470">    </td>
        </tr>
        <tr>
          <td id="L5471" data-line-number="5471"></td>
          <td id="LC5471">    <span>If</span> <span>baEnc(</span><span>0</span><span>)</span> <span>&lt;&gt;</span> <span>&amp;H0</span> <span>Or</span> <span>baEnc(</span><span>1</span><span>)</span> <span>&lt;&gt;</span> <span>&amp;H1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5472" data-line-number="5472"></td>
          <td id="LC5472">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5473" data-line-number="5473"></td>
          <td id="LC5473">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5474" data-line-number="5474"></td>
          <td id="LC5474">    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baMessage,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5475" data-line-number="5475"></td>
          <td id="LC5475">    <span>If</span> <span>Not</span> <span>pvAsn1EncodePkcs1Signature(baHash,</span> <span>baDerHash)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5476" data-line-number="5476"></td>
          <td id="LC5476">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5477" data-line-number="5477"></td>
          <td id="LC5477">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5478" data-line-number="5478"></td>
          <td id="LC5478">    <span>For</span> <span>lPos</span> <span>=</span> <span>2</span> <span>To</span> <span>UBound(baEnc)</span> <span>-</span> <span>UBound(baDerHash)</span> <span>-</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L5479" data-line-number="5479"></td>
          <td id="LC5479">        <span>If</span> <span>baEnc(lPos)</span> <span>&lt;&gt;</span> <span>&amp;HFF</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5480" data-line-number="5480"></td>
          <td id="LC5480">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5481" data-line-number="5481"></td>
          <td id="LC5481">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5482" data-line-number="5482"></td>
          <td id="LC5482">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5483" data-line-number="5483"></td>
          <td id="LC5483">    <span>If</span> <span>baEnc(lPos)</span> <span>&lt;&gt;</span> <span>&amp;H0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5484" data-line-number="5484"></td>
          <td id="LC5484">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5485" data-line-number="5485"></td>
          <td id="LC5485">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5486" data-line-number="5486"></td>
          <td id="LC5486">    <span>lPos</span> <span>=</span> <span>lPos</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5487" data-line-number="5487"></td>
          <td id="LC5487">    <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baDerHash)</span></td>
        </tr>
        <tr>
          <td id="L5488" data-line-number="5488"></td>
          <td id="LC5488">        <span>If</span> <span>baEnc(lPos)</span> <span>&lt;&gt;</span> <span>baDerHash(lIdx)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5489" data-line-number="5489"></td>
          <td id="LC5489">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5490" data-line-number="5490"></td>
          <td id="LC5490">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5491" data-line-number="5491"></td>
          <td id="LC5491">        <span>lPos</span> <span>=</span> <span>lPos</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5492" data-line-number="5492"></td>
          <td id="LC5492">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5493" data-line-number="5493"></td>
          <td id="LC5493">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5494" data-line-number="5494"></td>
          <td id="LC5494">    <span>pvCryptoEmsaPkcs1Decode</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5495" data-line-number="5495"></td>
          <td id="LC5495"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5496" data-line-number="5496"></td>
          <td id="LC5496"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5497" data-line-number="5497"></td>
          <td id="LC5497">
</td>
        </tr>
        <tr>
          <td id="L5498" data-line-number="5498"></td>
          <td id="LC5498"><span>Private</span> <span>Function</span> <span>pvCryptoEmsaPssEncode(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baMessage()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lBitLen</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lHashSize</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSaltSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5499" data-line-number="5499"></td>
          <td id="LC5499">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEmsaPssEncode&#34;</span></td>
        </tr>
        <tr>
          <td id="L5500" data-line-number="5500"></td>
          <td id="LC5500">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5501" data-line-number="5501"></td>
          <td id="LC5501">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5502" data-line-number="5502"></td>
          <td id="LC5502">    <span>Dim</span> <span>baHash()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5503" data-line-number="5503"></td>
          <td id="LC5503">    <span>Dim</span> <span>baSalt()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5504" data-line-number="5504"></td>
          <td id="LC5504">    <span>Dim</span> <span>baSeed()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5505" data-line-number="5505"></td>
          <td id="LC5505">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5506" data-line-number="5506"></td>
          <td id="LC5506">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5507" data-line-number="5507"></td>
          <td id="LC5507">    <span>Dim</span> <span>bMask</span>           <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5508" data-line-number="5508"></td>
          <td id="LC5508">    </td>
        </tr>
        <tr>
          <td id="L5509" data-line-number="5509"></td>
          <td id="LC5509">    <span>&#39;--- from RFC 8017, Section 9.1.1.</span></td>
        </tr>
        <tr>
          <td id="L5510" data-line-number="5510"></td>
          <td id="LC5510">    <span>lSize</span> <span>=</span> <span>(lBitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L5511" data-line-number="5511"></td>
          <td id="LC5511">    <span>&#39;--- 2. Let |mHash| = |Hash(M)|, an octet string of length hLen.</span></td>
        </tr>
        <tr>
          <td id="L5512" data-line-number="5512"></td>
          <td id="LC5512">    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baMessage,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5513" data-line-number="5513"></td>
          <td id="LC5513">    <span>&#39;--- 3. If |emLen| &lt; |hLen + sLen + 2|, output &#34;encoding error&#34; and stop.</span></td>
        </tr>
        <tr>
          <td id="L5514" data-line-number="5514"></td>
          <td id="LC5514">    <span>If</span> <span>lSize</span> <span>&lt;</span> <span>lHashSize</span> <span>+</span> <span>lSaltSize</span> <span>+</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5515" data-line-number="5515"></td>
          <td id="LC5515">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5516" data-line-number="5516"></td>
          <td id="LC5516">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5517" data-line-number="5517"></td>
          <td id="LC5517">    <span>&#39;--- 4. Generate a random octet string salt of length sLen; if |sLen| = 0, then salt is the empty string.</span></td>
        </tr>
        <tr>
          <td id="L5518" data-line-number="5518"></td>
          <td id="LC5518">    <span>If</span> <span>lSaltSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5519" data-line-number="5519"></td>
          <td id="LC5519">        <span>pvArrayAllocate</span> <span>baSalt,</span> <span>lSaltSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baSalt&#34;</span></td>
        </tr>
        <tr>
          <td id="L5520" data-line-number="5520"></td>
          <td id="LC5520">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baSalt(</span><span>0</span><span>)),</span> <span>lSaltSize</span></td>
        </tr>
        <tr>
          <td id="L5521" data-line-number="5521"></td>
          <td id="LC5521">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5522" data-line-number="5522"></td>
          <td id="LC5522">        <span>baSalt</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L5523" data-line-number="5523"></td>
          <td id="LC5523">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5524" data-line-number="5524"></td>
          <td id="LC5524">    <span>&#39;--- 5. Let |M&#39;| = (0x)00 00 00 00 00 00 00 00 || mHash || salt;</span></td>
        </tr>
        <tr>
          <td id="L5525" data-line-number="5525"></td>
          <td id="LC5525">    <span>pvArrayAllocate</span> <span>baBuffer,</span> <span>8</span> <span>+</span> <span>lHashSize</span> <span>+</span> <span>lSaltSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L5526" data-line-number="5526"></td>
          <td id="LC5526">    <span>Call</span> <span>CopyMemory(baBuffer(</span><span>8</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5527" data-line-number="5527"></td>
          <td id="LC5527">    <span>Call</span> <span>CopyMemory(baBuffer(</span><span>8</span> <span>+</span> <span>lHashSize),</span> <span>baSalt(</span><span>0</span><span>),</span> <span>lSaltSize)</span></td>
        </tr>
        <tr>
          <td id="L5528" data-line-number="5528"></td>
          <td id="LC5528">    <span>&#39;--- 6. Let |H| = Hash(M&#39;), an octet string of length hLen.</span></td>
        </tr>
        <tr>
          <td id="L5529" data-line-number="5529"></td>
          <td id="LC5529">    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baBuffer,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5530" data-line-number="5530"></td>
          <td id="LC5530">    <span>&#39;--- 7. Generate an octet string |PS| consisting of |emLen - sLen - hLen - 2| zero octets. The length of PS may be 0.</span></td>
        </tr>
        <tr>
          <td id="L5531" data-line-number="5531"></td>
          <td id="LC5531">    <span>&#39;--- 8. Let |DB| = PS || 0x01 || salt; DB is an octet string of length |emLen - hLen - 1|.</span></td>
        </tr>
        <tr>
          <td id="L5532" data-line-number="5532"></td>
          <td id="LC5532">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L5533" data-line-number="5533"></td>
          <td id="LC5533">    <span>baRetVal(lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>lSaltSize</span> <span>-</span> <span>2</span><span>)</span> <span>=</span> <span>&amp;H1</span></td>
        </tr>
        <tr>
          <td id="L5534" data-line-number="5534"></td>
          <td id="LC5534">    <span>Call</span> <span>CopyMemory(baRetVal(lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>lSaltSize</span> <span>-</span> <span>1</span><span>),</span> <span>baSalt(</span><span>0</span><span>),</span> <span>lSaltSize)</span></td>
        </tr>
        <tr>
          <td id="L5535" data-line-number="5535"></td>
          <td id="LC5535">    <span>Call</span> <span>CopyMemory(baRetVal(lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5536" data-line-number="5536"></td>
          <td id="LC5536">    <span>&#39;--- 9. Let |dbMask| = MGF(H, emLen - hLen - 1).</span></td>
        </tr>
        <tr>
          <td id="L5537" data-line-number="5537"></td>
          <td id="LC5537">    <span>&#39;--- 10. Let |maskedDB| = DB \xor dbMask.</span></td>
        </tr>
        <tr>
          <td id="L5538" data-line-number="5538"></td>
          <td id="LC5538">    <span>pvArrayAllocate</span> <span>baSeed,</span> <span>lHashSize</span> <span>+</span> <span>4</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baSeed&#34;</span> <span>&#39;--- leave 4 more bytes at the end for counter</span></td>
        </tr>
        <tr>
          <td id="L5539" data-line-number="5539"></td>
          <td id="LC5539">    <span>Call</span> <span>CopyMemory(baSeed(</span><span>0</span><span>),</span> <span>baRetVal(lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span><span>),</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5540" data-line-number="5540"></td>
          <td id="LC5540">    <span>Do</span></td>
        </tr>
        <tr>
          <td id="L5541" data-line-number="5541"></td>
          <td id="LC5541">        <span>pvArrayHash</span> <span>lHashSize,</span> <span>baSeed,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5542" data-line-number="5542"></td>
          <td id="LC5542">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baHash)</span></td>
        </tr>
        <tr>
          <td id="L5543" data-line-number="5543"></td>
          <td id="LC5543">            <span>baRetVal(lPos)</span> <span>=</span> <span>baRetVal(lPos)</span> <span>Xor</span> <span>baHash(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L5544" data-line-number="5544"></td>
          <td id="LC5544">            <span>lPos</span> <span>=</span> <span>lPos</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5545" data-line-number="5545"></td>
          <td id="LC5545">            <span>If</span> <span>lPos</span> <span>&gt;=</span> <span>lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5546" data-line-number="5546"></td>
          <td id="LC5546">                <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L5547" data-line-number="5547"></td>
          <td id="LC5547">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5548" data-line-number="5548"></td>
          <td id="LC5548">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5549" data-line-number="5549"></td>
          <td id="LC5549">        <span>pvArrayIncCounter</span> <span>baSeed,</span> <span>lHashSize</span> <span>+</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L5550" data-line-number="5550"></td>
          <td id="LC5550">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L5551" data-line-number="5551"></td>
          <td id="LC5551">    <span>&#39;--- 11. Set the leftmost |8 * emLen - emBits| bits of the leftmost octet in |maskedDB| to zero.</span></td>
        </tr>
        <tr>
          <td id="L5552" data-line-number="5552"></td>
          <td id="LC5552">    <span>bMask</span> <span>=</span> <span>&amp;HFF</span> <span>\</span> <span>(</span><span>2</span> <span>^</span> <span>(lSize</span> <span>*</span> <span>8</span> <span>-</span> <span>lBitLen))</span></td>
        </tr>
        <tr>
          <td id="L5553" data-line-number="5553"></td>
          <td id="LC5553">    <span>baRetVal(</span><span>0</span><span>)</span> <span>=</span> <span>baRetVal(</span><span>0</span><span>)</span> <span>And</span> <span>(bMask</span> <span>\</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5554" data-line-number="5554"></td>
          <td id="LC5554">    <span>&#39;--- 12. Let |EM| = maskedDB || H || 0xbc.</span></td>
        </tr>
        <tr>
          <td id="L5555" data-line-number="5555"></td>
          <td id="LC5555">    <span>baRetVal(lSize</span> <span>-</span> <span>1</span><span>)</span> <span>=</span> <span>&amp;HBC</span></td>
        </tr>
        <tr>
          <td id="L5556" data-line-number="5556"></td>
          <td id="LC5556">    <span>&#39;--- 13. Output EM.</span></td>
        </tr>
        <tr>
          <td id="L5557" data-line-number="5557"></td>
          <td id="LC5557">    <span>pvCryptoEmsaPssEncode</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5558" data-line-number="5558"></td>
          <td id="LC5558"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5559" data-line-number="5559"></td>
          <td id="LC5559"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5560" data-line-number="5560"></td>
          <td id="LC5560">
</td>
        </tr>
        <tr>
          <td id="L5561" data-line-number="5561"></td>
          <td id="LC5561"><span>Private</span> <span>Function</span> <span>pvCryptoEmsaPssDecode(baMessage()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baEnc()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lBitLen</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lHashSize</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSaltSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5562" data-line-number="5562"></td>
          <td id="LC5562">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEmsaPssDecode&#34;</span></td>
        </tr>
        <tr>
          <td id="L5563" data-line-number="5563"></td>
          <td id="LC5563">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5564" data-line-number="5564"></td>
          <td id="LC5564">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5565" data-line-number="5565"></td>
          <td id="LC5565">    <span>Dim</span> <span>baSeed()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5566" data-line-number="5566"></td>
          <td id="LC5566">    <span>Dim</span> <span>baHash()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5567" data-line-number="5567"></td>
          <td id="LC5567">    <span>Dim</span> <span>baSalt()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5568" data-line-number="5568"></td>
          <td id="LC5568">    <span>Dim</span> <span>lPos</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5569" data-line-number="5569"></td>
          <td id="LC5569">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5570" data-line-number="5570"></td>
          <td id="LC5570">    <span>Dim</span> <span>bMask</span>           <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5571" data-line-number="5571"></td>
          <td id="LC5571">    </td>
        </tr>
        <tr>
          <td id="L5572" data-line-number="5572"></td>
          <td id="LC5572">    <span>&#39;--- from RFC 8017, Section 9.1.2.</span></td>
        </tr>
        <tr>
          <td id="L5573" data-line-number="5573"></td>
          <td id="LC5573">    <span>lSize</span> <span>=</span> <span>(lBitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L5574" data-line-number="5574"></td>
          <td id="LC5574">    <span>&#39;--- 3. If |emLen| &lt; |hLen + sLen + 2|, output &#34;inconsistent&#34; and stop.</span></td>
        </tr>
        <tr>
          <td id="L5575" data-line-number="5575"></td>
          <td id="LC5575">    <span>If</span> <span>lSize</span> <span>&lt;</span> <span>lHashSize</span> <span>+</span> <span>lSaltSize</span> <span>+</span> <span>2</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5576" data-line-number="5576"></td>
          <td id="LC5576">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5577" data-line-number="5577"></td>
          <td id="LC5577">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5578" data-line-number="5578"></td>
          <td id="LC5578">    <span>&#39;--- 4. If the rightmost octet of |EM| does not have hexadecimal value 0xbc, output &#34;inconsistent&#34; and stop.</span></td>
        </tr>
        <tr>
          <td id="L5579" data-line-number="5579"></td>
          <td id="LC5579">    <span>If</span> <span>baEnc(lSize</span> <span>-</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>&amp;HBC</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5580" data-line-number="5580"></td>
          <td id="LC5580">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5581" data-line-number="5581"></td>
          <td id="LC5581">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5582" data-line-number="5582"></td>
          <td id="LC5582">    <span>&#39;--- 5. Let |maskedDB| be the leftmost |emLen - hLen - 1| octets of |EM|, and let |H| be the next |hLen| octets.</span></td>
        </tr>
        <tr>
          <td id="L5583" data-line-number="5583"></td>
          <td id="LC5583">    <span>&#39;--- 6. If the leftmost |8 * emLen - emBits| bits of the leftmost octet in |maskedDB| are not all equal to zero,</span></td>
        </tr>
        <tr>
          <td id="L5584" data-line-number="5584"></td>
          <td id="LC5584">    <span>&#39;---    output &#34;inconsistent&#34; and stop.</span></td>
        </tr>
        <tr>
          <td id="L5585" data-line-number="5585"></td>
          <td id="LC5585">    <span>bMask</span> <span>=</span> <span>&amp;HFF</span> <span>\</span> <span>(</span><span>2</span> <span>^</span> <span>(lSize</span> <span>*</span> <span>8</span> <span>-</span> <span>lBitLen))</span></td>
        </tr>
        <tr>
          <td id="L5586" data-line-number="5586"></td>
          <td id="LC5586">    <span>If</span> <span>(baEnc(</span><span>0</span><span>)</span> <span>And</span> <span>Not</span> <span>bMask)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5587" data-line-number="5587"></td>
          <td id="LC5587">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5588" data-line-number="5588"></td>
          <td id="LC5588">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5589" data-line-number="5589"></td>
          <td id="LC5589">    <span>&#39;--- 7. Let |dbMask| = MGF(H, emLen - hLen - 1).</span></td>
        </tr>
        <tr>
          <td id="L5590" data-line-number="5590"></td>
          <td id="LC5590">    <span>&#39;--- 8. Let |DB| = maskedDB \xor dbMask.</span></td>
        </tr>
        <tr>
          <td id="L5591" data-line-number="5591"></td>
          <td id="LC5591">    <span>pvArrayAllocate</span> <span>baSeed,</span> <span>lHashSize</span> <span>+</span> <span>4</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baSeed&#34;</span>  <span>&#39;--- leave 4 more bytes at the end for counter</span></td>
        </tr>
        <tr>
          <td id="L5592" data-line-number="5592"></td>
          <td id="LC5592">    <span>Call</span> <span>CopyMemory(baSeed(</span><span>0</span><span>),</span> <span>baEnc(lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span><span>),</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5593" data-line-number="5593"></td>
          <td id="LC5593">    <span>Do</span></td>
        </tr>
        <tr>
          <td id="L5594" data-line-number="5594"></td>
          <td id="LC5594">        <span>pvArrayHash</span> <span>lHashSize,</span> <span>baSeed,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5595" data-line-number="5595"></td>
          <td id="LC5595">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baHash)</span></td>
        </tr>
        <tr>
          <td id="L5596" data-line-number="5596"></td>
          <td id="LC5596">            <span>baEnc(lPos)</span> <span>=</span> <span>baEnc(lPos)</span> <span>Xor</span> <span>baHash(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L5597" data-line-number="5597"></td>
          <td id="LC5597">            <span>lPos</span> <span>=</span> <span>lPos</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5598" data-line-number="5598"></td>
          <td id="LC5598">            <span>If</span> <span>lPos</span> <span>&gt;=</span> <span>lSize</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5599" data-line-number="5599"></td>
          <td id="LC5599">                <span>Exit</span> <span>Do</span></td>
        </tr>
        <tr>
          <td id="L5600" data-line-number="5600"></td>
          <td id="LC5600">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5601" data-line-number="5601"></td>
          <td id="LC5601">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5602" data-line-number="5602"></td>
          <td id="LC5602">        <span>pvArrayIncCounter</span> <span>baSeed,</span> <span>lHashSize</span> <span>+</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L5603" data-line-number="5603"></td>
          <td id="LC5603">    <span>Loop</span></td>
        </tr>
        <tr>
          <td id="L5604" data-line-number="5604"></td>
          <td id="LC5604">    <span>&#39;--- 9. Set the leftmost |8 * emLen - emBits| bits of the leftmost octet in |DB| to zero.</span></td>
        </tr>
        <tr>
          <td id="L5605" data-line-number="5605"></td>
          <td id="LC5605">    <span>&#39;--- note: troubles w/ sign bit so use (bMask \ 2) to clear MSB</span></td>
        </tr>
        <tr>
          <td id="L5606" data-line-number="5606"></td>
          <td id="LC5606">    <span>baEnc(</span><span>0</span><span>)</span> <span>=</span> <span>baEnc(</span><span>0</span><span>)</span> <span>And</span> <span>(bMask</span> <span>\</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5607" data-line-number="5607"></td>
          <td id="LC5607">    <span>&#39;--- 10. If the |emLen - hLen - sLen - 2| leftmost octets of |DB| are not zero or if the octet at position</span></td>
        </tr>
        <tr>
          <td id="L5608" data-line-number="5608"></td>
          <td id="LC5608">    <span>&#39;---     |emLen - hLen - sLen - 1| (the leftmost position is &#34;position 1&#34;) does not have hexadecimal</span></td>
        </tr>
        <tr>
          <td id="L5609" data-line-number="5609"></td>
          <td id="LC5609">    <span>&#39;---     value 0x01, output &#34;inconsistent&#34; and stop.</span></td>
        </tr>
        <tr>
          <td id="L5610" data-line-number="5610"></td>
          <td id="LC5610">    <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>lPos</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L5611" data-line-number="5611"></td>
          <td id="LC5611">        <span>If</span> <span>baEnc(lIdx)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5612" data-line-number="5612"></td>
          <td id="LC5612">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L5613" data-line-number="5613"></td>
          <td id="LC5613">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5614" data-line-number="5614"></td>
          <td id="LC5614">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5615" data-line-number="5615"></td>
          <td id="LC5615">    <span>If</span> <span>lIdx</span> <span>&lt;&gt;</span> <span>lPos</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5616" data-line-number="5616"></td>
          <td id="LC5616">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5617" data-line-number="5617"></td>
          <td id="LC5617">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5618" data-line-number="5618"></td>
          <td id="LC5618">    <span>If</span> <span>baEnc(lPos</span> <span>-</span> <span>lHashSize</span> <span>-</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>&amp;H1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5619" data-line-number="5619"></td>
          <td id="LC5619">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5620" data-line-number="5620"></td>
          <td id="LC5620">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5621" data-line-number="5621"></td>
          <td id="LC5621">    <span>&#39;--- 11. Let |salt| be the last |sLen| octets of |DB|.</span></td>
        </tr>
        <tr>
          <td id="L5622" data-line-number="5622"></td>
          <td id="LC5622">    <span>pvArrayAllocate</span> <span>baSalt,</span> <span>lSaltSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baSalt&#34;</span></td>
        </tr>
        <tr>
          <td id="L5623" data-line-number="5623"></td>
          <td id="LC5623">    <span>Call</span> <span>CopyMemory(baSalt(</span><span>0</span><span>),</span> <span>baEnc(lPos</span> <span>-</span> <span>lSaltSize),</span> <span>lSaltSize)</span></td>
        </tr>
        <tr>
          <td id="L5624" data-line-number="5624"></td>
          <td id="LC5624">    <span>&#39;--- 12. Let |M&#39;| = (0x)00 00 00 00 00 00 00 00 || mHash || salt</span></td>
        </tr>
        <tr>
          <td id="L5625" data-line-number="5625"></td>
          <td id="LC5625">    <span>pvArrayAllocate</span> <span>baSeed,</span> <span>8</span> <span>+</span> <span>lHashSize</span> <span>+</span> <span>lSaltSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baSeed&#34;</span></td>
        </tr>
        <tr>
          <td id="L5626" data-line-number="5626"></td>
          <td id="LC5626">    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baMessage,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5627" data-line-number="5627"></td>
          <td id="LC5627">    <span>Call</span> <span>CopyMemory(baSeed(</span><span>8</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5628" data-line-number="5628"></td>
          <td id="LC5628">    <span>Call</span> <span>CopyMemory(baSeed(</span><span>8</span> <span>+</span> <span>lHashSize),</span> <span>baSalt(</span><span>0</span><span>),</span> <span>lSaltSize)</span></td>
        </tr>
        <tr>
          <td id="L5629" data-line-number="5629"></td>
          <td id="LC5629">    <span>&#39;--- 13. Let |H&#39;| = Hash(M&#39;), an octet string of length |hLen|.</span></td>
        </tr>
        <tr>
          <td id="L5630" data-line-number="5630"></td>
          <td id="LC5630">    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baSeed,</span> <span>baHash</span></td>
        </tr>
        <tr>
          <td id="L5631" data-line-number="5631"></td>
          <td id="LC5631">    <span>&#39;--- |H| is still not de-masked in decrypted buffer</span></td>
        </tr>
        <tr>
          <td id="L5632" data-line-number="5632"></td>
          <td id="LC5632">    <span>pvArrayAllocate</span> <span>baBuffer,</span> <span>lHashSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L5633" data-line-number="5633"></td>
          <td id="LC5633">    <span>Call</span> <span>CopyMemory(baBuffer(</span><span>0</span><span>),</span> <span>baEnc(lPos),</span> <span>lHashSize)</span></td>
        </tr>
        <tr>
          <td id="L5634" data-line-number="5634"></td>
          <td id="LC5634">    <span>&#39;--- 14. If |H| = |H&#39;|, output &#34;consistent.&#34; Otherwise, output &#34;inconsistent.&#34;</span></td>
        </tr>
        <tr>
          <td id="L5635" data-line-number="5635"></td>
          <td id="LC5635">    <span>If</span> <span>Not</span> <span>pvArrayEqual(baHash,</span> <span>baBuffer)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5636" data-line-number="5636"></td>
          <td id="LC5636">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5637" data-line-number="5637"></td>
          <td id="LC5637">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5638" data-line-number="5638"></td>
          <td id="LC5638">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5639" data-line-number="5639"></td>
          <td id="LC5639">    <span>pvCryptoEmsaPssDecode</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5640" data-line-number="5640"></td>
          <td id="LC5640"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5641" data-line-number="5641"></td>
          <td id="LC5641"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5642" data-line-number="5642"></td>
          <td id="LC5642">
</td>
        </tr>
        <tr>
          <td id="L5643" data-line-number="5643"></td>
          <td id="LC5643"><span>Private</span> <span>Function</span> <span>pvAsn1DecodePrivateKey(cCerts</span> <span>As</span> <span>Collection,</span> <span>cPrivKey</span> <span>As</span> <span>Collection,</span> <span>uRetVal</span> <span>As</span> <span>UcsKeyInfo)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5644" data-line-number="5644"></td>
          <td id="LC5644">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Asn1DecodePrivateKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L5645" data-line-number="5645"></td>
          <td id="LC5645">    <span>Const</span> <span>IDX_KEYNAME</span>   <span>As</span> <span>Long</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5646" data-line-number="5646"></td>
          <td id="LC5646">    <span>Const</span> <span>IDX_PROVNAME</span>  <span>As</span> <span>Long</span> <span>=</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L5647" data-line-number="5647"></td>
          <td id="LC5647">    <span>Const</span> <span>IDX_PROVTYPE</span>  <span>As</span> <span>Long</span> <span>=</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L5648" data-line-number="5648"></td>
          <td id="LC5648">    <span>Const</span> <span>IDX_KEYSPEC</span>   <span>As</span> <span>Long</span> <span>=</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L5649" data-line-number="5649"></td>
          <td id="LC5649">    <span>Dim</span> <span>baPrivKey()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5650" data-line-number="5650"></td>
          <td id="LC5650">    <span>Dim</span> <span>baCert()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5651" data-line-number="5651"></td>
          <td id="LC5651">    <span>Dim</span> <span>uCertInfo</span>       <span>As</span> <span>UcsKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L5652" data-line-number="5652"></td>
          <td id="LC5652">    <span>Dim</span> <span>hNProv</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5653" data-line-number="5653"></td>
          <td id="LC5653">    <span>Dim</span> <span>hProv</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5654" data-line-number="5654"></td>
          <td id="LC5654">    <span>Dim</span> <span>lPkiPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5655" data-line-number="5655"></td>
          <td id="LC5655">    <span>Dim</span> <span>uPrivKey</span>        <span>As</span> <span>CRYPT_PRIVATE_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L5656" data-line-number="5656"></td>
          <td id="LC5656">    <span>Dim</span> <span>lKeyPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5657" data-line-number="5657"></td>
          <td id="LC5657">    <span>Dim</span> <span>lKeySize</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5658" data-line-number="5658"></td>
          <td id="LC5658">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5659" data-line-number="5659"></td>
          <td id="LC5659">    <span>Dim</span> <span>lHalfSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5660" data-line-number="5660"></td>
          <td id="LC5660">    <span>Dim</span> <span>uEccKeyInfo</span>     <span>As</span> <span>CRYPT_ECC_PRIVATE_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L5661" data-line-number="5661"></td>
          <td id="LC5661">    <span>Dim</span> <span>hResult</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5662" data-line-number="5662"></td>
          <td id="LC5662">    <span>Dim</span> <span>sApiSource</span>      <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5663" data-line-number="5663"></td>
          <td id="LC5663">    </td>
        </tr>
        <tr>
          <td id="L5664" data-line-number="5664"></td>
          <td id="LC5664">    <span>If</span> <span>pvCollectionCount(cPrivKey)</span> <span>&gt;</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5665" data-line-number="5665"></td>
          <td id="LC5665">        <span>If</span> <span>Not</span> <span>SearchCollection(cCerts,</span> <span>1</span><span>,</span> <span>RetVal:=baCert)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5666" data-line-number="5666"></td>
          <td id="LC5666">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>ERR_NO_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L5667" data-line-number="5667"></td>
          <td id="LC5667">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5668" data-line-number="5668"></td>
          <td id="LC5668">        <span>If</span> <span>Not</span> <span>pvAsn1DecodeCertificate(baCert,</span> <span>uCertInfo)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5669" data-line-number="5669"></td>
          <td id="LC5669">            <span>ErrRaise</span> <span>vbObjectError,</span> <span>FUNC_NAME,</span> <span>ERR_UNSUPPORTED_CERTIFICATE</span></td>
        </tr>
        <tr>
          <td id="L5670" data-line-number="5670"></td>
          <td id="LC5670">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5671" data-line-number="5671"></td>
          <td id="LC5671">        <span>uRetVal.AlgoObjId</span> <span>=</span> <span>uCertInfo.AlgoObjId</span></td>
        </tr>
        <tr>
          <td id="L5672" data-line-number="5672"></td>
          <td id="LC5672">        <span>uRetVal.BitLen</span> <span>=</span> <span>uCertInfo.BitLen</span></td>
        </tr>
        <tr>
          <td id="L5673" data-line-number="5673"></td>
          <td id="LC5673">        <span>With</span> <span>cPrivKey</span></td>
        </tr>
        <tr>
          <td id="L5674" data-line-number="5674"></td>
          <td id="LC5674">            <span>If</span> <span>pvCollectionCount(cPrivKey)</span> <span>=</span> <span>IDX_PROVNAME</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5675" data-line-number="5675"></td>
          <td id="LC5675">                <span>hResult</span> <span>=</span> <span>NCryptOpenStorageProvider(hNProv,</span> <span>StrPtr(.Item(IDX_PROVNAME)),</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5676" data-line-number="5676"></td>
          <td id="LC5676">                <span>If</span> <span>hResult</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5677" data-line-number="5677"></td>
          <td id="LC5677">                    <span>sApiSource</span> <span>=</span> <span>&#34;NCryptOpenStorageProvider&#34;</span></td>
        </tr>
        <tr>
          <td id="L5678" data-line-number="5678"></td>
          <td id="LC5678">                    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5679" data-line-number="5679"></td>
          <td id="LC5679">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5680" data-line-number="5680"></td>
          <td id="LC5680">                <span>hResult</span> <span>=</span> <span>NCryptOpenKey(hNProv,</span> <span>uRetVal.hNKey,</span> <span>StrPtr(.Item(IDX_KEYNAME)),</span> <span>0</span><span>,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5681" data-line-number="5681"></td>
          <td id="LC5681">                <span>If</span> <span>hResult</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5682" data-line-number="5682"></td>
          <td id="LC5682">                    <span>sApiSource</span> <span>=</span> <span>&#34;NCryptOpenKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L5683" data-line-number="5683"></td>
          <td id="LC5683">                    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5684" data-line-number="5684"></td>
          <td id="LC5684">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5685" data-line-number="5685"></td>
          <td id="LC5685">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5686" data-line-number="5686"></td>
          <td id="LC5686">                <span>If</span> <span>.Item(IDX_PROVTYPE)</span> <span>=</span> <span>PROV_RSA_FULL</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5687" data-line-number="5687"></td>
          <td id="LC5687">                    <span>&#39;--- try using PROV_RSA_AES to have SHA-2 available in pvTlsSignatureSign</span></td>
        </tr>
        <tr>
          <td id="L5688" data-line-number="5688"></td>
          <td id="LC5688">                    <span>Call</span> <span>CryptAcquireContext(hProv,</span> <span>StrPtr(.Item(IDX_KEYNAME)),</span> <span>0</span><span>,</span> <span>PROV_RSA_AES,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5689" data-line-number="5689"></td>
          <td id="LC5689">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5690" data-line-number="5690"></td>
          <td id="LC5690">                <span>If</span> <span>hProv</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5691" data-line-number="5691"></td>
          <td id="LC5691">                    <span>If</span> <span>CryptAcquireContext(hProv,</span> <span>StrPtr(.Item(IDX_KEYNAME)),</span> <span>StrPtr(.Item(IDX_PROVNAME)),</span> <span>.Item(IDX_PROVTYPE),</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5692" data-line-number="5692"></td>
          <td id="LC5692">                        <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L5693" data-line-number="5693"></td>
          <td id="LC5693">                        <span>sApiSource</span> <span>=</span> <span>&#34;CryptAcquireContext&#34;</span></td>
        </tr>
        <tr>
          <td id="L5694" data-line-number="5694"></td>
          <td id="LC5694">                        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5695" data-line-number="5695"></td>
          <td id="LC5695">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5696" data-line-number="5696"></td>
          <td id="LC5696">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5697" data-line-number="5697"></td>
          <td id="LC5697">                <span>If</span> <span>CryptGetUserKey(hProv,</span> <span>.Item(IDX_KEYSPEC),</span> <span>uRetVal.hKey)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5698" data-line-number="5698"></td>
          <td id="LC5698">                    <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L5699" data-line-number="5699"></td>
          <td id="LC5699">                    <span>sApiSource</span> <span>=</span> <span>&#34;CryptGetUserKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L5700" data-line-number="5700"></td>
          <td id="LC5700">                    <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5701" data-line-number="5701"></td>
          <td id="LC5701">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5702" data-line-number="5702"></td>
          <td id="LC5702">                <span>uRetVal.hProv</span> <span>=</span> <span>hProv:</span> <span>hProv</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5703" data-line-number="5703"></td>
          <td id="LC5703">                <span>uRetVal.dwKeySpec</span> <span>=</span> <span>.Item(IDX_KEYSPEC)</span></td>
        </tr>
        <tr>
          <td id="L5704" data-line-number="5704"></td>
          <td id="LC5704">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5705" data-line-number="5705"></td>
          <td id="LC5705">        <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L5706" data-line-number="5706"></td>
          <td id="LC5706">    <span>ElseIf</span> <span>SearchCollection(cPrivKey,</span> <span>1</span><span>,</span> <span>RetVal:=baPrivKey)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5707" data-line-number="5707"></td>
          <td id="LC5707">        <span>If</span> <span>CryptDecodeObjectEx(X509_ASN_ENCODING</span> <span>Or</span> <span>PKCS_7_ASN_ENCODING,</span> <span>PKCS_PRIVATE_KEY_INFO,</span> <span>baPrivKey(</span><span>0</span><span>),</span> <span>UBound(baPrivKey)</span> <span>+</span> <span>1</span><span>,</span> <span>CRYPT_DECODE_ALLOC_FLAG</span> <span>Or</span> <span>CRYPT_DECODE_NOCOPY_FLAG,</span> <span>0</span><span>,</span> <span>lPkiPtr,</span> <span>0</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5708" data-line-number="5708"></td>
          <td id="LC5708">            <span>Call</span> <span>CopyMemory(uPrivKey,</span> <span>ByVal</span> <span>lPkiPtr,</span> <span>LenB(uPrivKey))</span></td>
        </tr>
        <tr>
          <td id="L5709" data-line-number="5709"></td>
          <td id="LC5709">            <span>If</span> <span>CryptDecodeObjectEx(X509_ASN_ENCODING</span> <span>Or</span> <span>PKCS_7_ASN_ENCODING,</span> <span>PKCS_RSA_PRIVATE_KEY,</span> <span>ByVal</span> <span>uPrivKey.PrivateKey.pbData,</span> <span>uPrivKey.PrivateKey.cbData,</span> <span>CRYPT_DECODE_ALLOC_FLAG</span> <span>Or</span> <span>CRYPT_DECODE_NOCOPY_FLAG,</span> <span>0</span><span>,</span> <span>lKeyPtr,</span> <span>lKeySize)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5710" data-line-number="5710"></td>
          <td id="LC5710">                <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L5711" data-line-number="5711"></td>
          <td id="LC5711">                <span>sApiSource</span> <span>=</span> <span>&#34;CryptDecodeObjectEx(PKCS_RSA_PRIVATE_KEY)&#34;</span></td>
        </tr>
        <tr>
          <td id="L5712" data-line-number="5712"></td>
          <td id="LC5712">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5713" data-line-number="5713"></td>
          <td id="LC5713">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5714" data-line-number="5714"></td>
          <td id="LC5714">            <span>uRetVal.AlgoObjId</span> <span>=</span> <span>pvToStringA(uPrivKey.Algorithm.pszObjId)</span></td>
        </tr>
        <tr>
          <td id="L5715" data-line-number="5715"></td>
          <td id="LC5715">            <span>GoTo</span> <span>DecodeRsa</span></td>
        </tr>
        <tr>
          <td id="L5716" data-line-number="5716"></td>
          <td id="LC5716">        <span>ElseIf</span> <span>CryptDecodeObjectEx(X509_ASN_ENCODING</span> <span>Or</span> <span>PKCS_7_ASN_ENCODING,</span> <span>PKCS_RSA_PRIVATE_KEY,</span> <span>baPrivKey(</span><span>0</span><span>),</span> <span>UBound(baPrivKey)</span> <span>+</span> <span>1</span><span>,</span> <span>CRYPT_DECODE_ALLOC_FLAG</span> <span>Or</span> <span>CRYPT_DECODE_NOCOPY_FLAG,</span> <span>0</span><span>,</span> <span>lKeyPtr,</span> <span>lKeySize)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5717" data-line-number="5717"></td>
          <td id="LC5717">            <span>uRetVal.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span></td>
        </tr>
        <tr>
          <td id="L5718" data-line-number="5718"></td>
          <td id="LC5718"><span>DecodeRsa:</span></td>
        </tr>
        <tr>
          <td id="L5719" data-line-number="5719"></td>
          <td id="LC5719">            <span>pvArrayAllocate</span> <span>uRetVal.KeyBlob,</span> <span>lKeySize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.KeyBlob&#34;</span></td>
        </tr>
        <tr>
          <td id="L5720" data-line-number="5720"></td>
          <td id="LC5720">            <span>Call</span> <span>CopyMemory(uRetVal.KeyBlob(</span><span>0</span><span>),</span> <span>ByVal</span> <span>lKeyPtr,</span> <span>lKeySize)</span></td>
        </tr>
        <tr>
          <td id="L5721" data-line-number="5721"></td>
          <td id="LC5721">            <span>Debug.Assert</span> <span>UBound(uRetVal.KeyBlob)</span> <span>&gt;=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L5722" data-line-number="5722"></td>
          <td id="LC5722">            <span>Call</span> <span>CopyMemory(uRetVal.BitLen,</span> <span>uRetVal.KeyBlob(</span><span>12</span><span>),</span> <span>LenB(uRetVal.BitLen))</span></td>
        </tr>
        <tr>
          <td id="L5723" data-line-number="5723"></td>
          <td id="LC5723">            <span>lSize</span> <span>=</span> <span>(uRetVal.BitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L5724" data-line-number="5724"></td>
          <td id="LC5724">            <span>lHalfSize</span> <span>=</span> <span>(uRetVal.BitLen</span> <span>+</span> <span>15</span><span>)</span> <span>\</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L5725" data-line-number="5725"></td>
          <td id="LC5725">            <span>&#39;--- modulus (mod = p * q)</span></td>
        </tr>
        <tr>
          <td id="L5726" data-line-number="5726"></td>
          <td id="LC5726">            <span>pvArrayAllocate</span> <span>uRetVal.Modulus,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.Modulus&#34;</span></td>
        </tr>
        <tr>
          <td id="L5727" data-line-number="5727"></td>
          <td id="LC5727">            <span>Debug.Assert</span> <span>UBound(uRetVal.KeyBlob)</span> <span>-</span> <span>20</span> <span>&gt;=</span> <span>UBound(uRetVal.Modulus)</span></td>
        </tr>
        <tr>
          <td id="L5728" data-line-number="5728"></td>
          <td id="LC5728">            <span>Call</span> <span>CopyMemory(uRetVal.Modulus(</span><span>0</span><span>),</span> <span>uRetVal.KeyBlob(</span><span>20</span><span>),</span> <span>UBound(uRetVal.Modulus)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5729" data-line-number="5729"></td>
          <td id="LC5729">            <span>pvArrayReverse</span> <span>uRetVal.Modulus</span></td>
        </tr>
        <tr>
          <td id="L5730" data-line-number="5730"></td>
          <td id="LC5730">            <span>&#39;--- prime1 (p)</span></td>
        </tr>
        <tr>
          <td id="L5731" data-line-number="5731"></td>
          <td id="LC5731">            <span>pvArrayAllocate</span> <span>uRetVal.Prime1,</span> <span>lHalfSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.Prime1&#34;</span></td>
        </tr>
        <tr>
          <td id="L5732" data-line-number="5732"></td>
          <td id="LC5732">            <span>Debug.Assert</span> <span>UBound(uRetVal.KeyBlob)</span> <span>&gt;=</span> <span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>0</span> <span>*</span> <span>lHalfSize</span> <span>+</span> <span>UBound(uRetVal.Prime1)</span></td>
        </tr>
        <tr>
          <td id="L5733" data-line-number="5733"></td>
          <td id="LC5733">            <span>Call</span> <span>CopyMemory(uRetVal.Prime1(</span><span>0</span><span>),</span> <span>uRetVal.KeyBlob(</span><span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>0</span> <span>*</span> <span>lHalfSize),</span> <span>UBound(uRetVal.Prime1)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5734" data-line-number="5734"></td>
          <td id="LC5734">            <span>pvArrayReverse</span> <span>uRetVal.Prime1</span></td>
        </tr>
        <tr>
          <td id="L5735" data-line-number="5735"></td>
          <td id="LC5735">            <span>&#39;--- prime2 (q)</span></td>
        </tr>
        <tr>
          <td id="L5736" data-line-number="5736"></td>
          <td id="LC5736">            <span>pvArrayAllocate</span> <span>uRetVal.Prime2,</span> <span>lHalfSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.Prime2&#34;</span></td>
        </tr>
        <tr>
          <td id="L5737" data-line-number="5737"></td>
          <td id="LC5737">            <span>Debug.Assert</span> <span>UBound(uRetVal.KeyBlob)</span> <span>&gt;=</span> <span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>1</span> <span>*</span> <span>lHalfSize</span> <span>+</span> <span>UBound(uRetVal.Prime2)</span></td>
        </tr>
        <tr>
          <td id="L5738" data-line-number="5738"></td>
          <td id="LC5738">            <span>Call</span> <span>CopyMemory(uRetVal.Prime2(</span><span>0</span><span>),</span> <span>uRetVal.KeyBlob(</span><span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>1</span> <span>*</span> <span>lHalfSize),</span> <span>UBound(uRetVal.Prime2)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5739" data-line-number="5739"></td>
          <td id="LC5739">            <span>pvArrayReverse</span> <span>uRetVal.Prime2</span></td>
        </tr>
        <tr>
          <td id="L5740" data-line-number="5740"></td>
          <td id="LC5740">            <span>&#39;--- coefficient (iqmp)</span></td>
        </tr>
        <tr>
          <td id="L5741" data-line-number="5741"></td>
          <td id="LC5741">            <span>pvArrayAllocate</span> <span>uRetVal.Coefficient,</span> <span>lHalfSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.Coefficient&#34;</span></td>
        </tr>
        <tr>
          <td id="L5742" data-line-number="5742"></td>
          <td id="LC5742">            <span>Debug.Assert</span> <span>UBound(uRetVal.KeyBlob)</span> <span>&gt;=</span> <span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>4</span> <span>*</span> <span>lHalfSize</span> <span>+</span> <span>UBound(uRetVal.Coefficient)</span></td>
        </tr>
        <tr>
          <td id="L5743" data-line-number="5743"></td>
          <td id="LC5743">            <span>Call</span> <span>CopyMemory(uRetVal.Coefficient(</span><span>0</span><span>),</span> <span>uRetVal.KeyBlob(</span><span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>4</span> <span>*</span> <span>lHalfSize),</span> <span>UBound(uRetVal.Coefficient)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5744" data-line-number="5744"></td>
          <td id="LC5744">            <span>pvArrayReverse</span> <span>uRetVal.Coefficient</span></td>
        </tr>
        <tr>
          <td id="L5745" data-line-number="5745"></td>
          <td id="LC5745">            <span>&#39;--- privateExponent</span></td>
        </tr>
        <tr>
          <td id="L5746" data-line-number="5746"></td>
          <td id="LC5746">            <span>pvArrayAllocate</span> <span>uRetVal.PrivExp,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.PrivExp&#34;</span></td>
        </tr>
        <tr>
          <td id="L5747" data-line-number="5747"></td>
          <td id="LC5747">            <span>Debug.Assert</span> <span>UBound(uRetVal.KeyBlob)</span> <span>&gt;=</span> <span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>5</span> <span>*</span> <span>lHalfSize</span> <span>+</span> <span>UBound(uRetVal.PrivExp)</span></td>
        </tr>
        <tr>
          <td id="L5748" data-line-number="5748"></td>
          <td id="LC5748">            <span>Call</span> <span>CopyMemory(uRetVal.PrivExp(</span><span>0</span><span>),</span> <span>uRetVal.KeyBlob(</span><span>20</span> <span>+</span> <span>lSize</span> <span>+</span> <span>5</span> <span>*</span> <span>lHalfSize),</span> <span>UBound(uRetVal.PrivExp)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5749" data-line-number="5749"></td>
          <td id="LC5749">            <span>pvArrayReverse</span> <span>uRetVal.PrivExp</span></td>
        </tr>
        <tr>
          <td id="L5750" data-line-number="5750"></td>
          <td id="LC5750">        <span>ElseIf</span> <span>CryptDecodeObjectEx(X509_ASN_ENCODING</span> <span>Or</span> <span>PKCS_7_ASN_ENCODING,</span> <span>X509_ECC_PRIVATE_KEY,</span> <span>baPrivKey(</span><span>0</span><span>),</span> <span>UBound(baPrivKey)</span> <span>+</span> <span>1</span><span>,</span> <span>CRYPT_DECODE_ALLOC_FLAG</span> <span>Or</span> <span>CRYPT_DECODE_NOCOPY_FLAG,</span> <span>0</span><span>,</span> <span>lKeyPtr,</span> <span>0</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5751" data-line-number="5751"></td>
          <td id="LC5751">            <span>Call</span> <span>CopyMemory(uEccKeyInfo,</span> <span>ByVal</span> <span>lKeyPtr,</span> <span>LenB(uEccKeyInfo))</span></td>
        </tr>
        <tr>
          <td id="L5752" data-line-number="5752"></td>
          <td id="LC5752">            <span>uRetVal.AlgoObjId</span> <span>=</span> <span>pvToStringA(uEccKeyInfo.szCurveOid)</span></td>
        </tr>
        <tr>
          <td id="L5753" data-line-number="5753"></td>
          <td id="LC5753">            <span>pvArrayAllocate</span> <span>uRetVal.KeyBlob,</span> <span>uEccKeyInfo.PrivateKey.cbData,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.KeyBlob&#34;</span></td>
        </tr>
        <tr>
          <td id="L5754" data-line-number="5754"></td>
          <td id="LC5754">            <span>Call</span> <span>CopyMemory(uRetVal.KeyBlob(</span><span>0</span><span>),</span> <span>ByVal</span> <span>uEccKeyInfo.PrivateKey.pbData,</span> <span>uEccKeyInfo.PrivateKey.cbData)</span></td>
        </tr>
        <tr>
          <td id="L5755" data-line-number="5755"></td>
          <td id="LC5755">        <span>ElseIf</span> <span>Err.LastDllError</span> <span>=</span> <span>ERROR_FILE_NOT_FOUND</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5756" data-line-number="5756"></td>
          <td id="LC5756">            <span>&#39;--- no X509_ECC_PRIVATE_KEY struct type on NT4 -&gt; decode in a wildly speculative way</span></td>
        </tr>
        <tr>
          <td id="L5757" data-line-number="5757"></td>
          <td id="LC5757">            <span>Call</span> <span>CopyMemory(lSize,</span> <span>baPrivKey(</span><span>6</span><span>),</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5758" data-line-number="5758"></td>
          <td id="LC5758">            <span>If</span> <span>7</span> <span>+</span> <span>lSize</span> <span>&lt;=</span> <span>UBound(baPrivKey)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5759" data-line-number="5759"></td>
          <td id="LC5759">                <span>uRetVal.AlgoObjId</span> <span>=</span> <span>szOID_ECC_CURVE_P256</span></td>
        </tr>
        <tr>
          <td id="L5760" data-line-number="5760"></td>
          <td id="LC5760">                <span>pvArrayAllocate</span> <span>uRetVal.KeyBlob,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.KeyBlob&#34;</span></td>
        </tr>
        <tr>
          <td id="L5761" data-line-number="5761"></td>
          <td id="LC5761">                <span>Call</span> <span>CopyMemory(uRetVal.KeyBlob(</span><span>0</span><span>),</span> <span>baPrivKey(</span><span>7</span><span>),</span> <span>lSize)</span></td>
        </tr>
        <tr>
          <td id="L5762" data-line-number="5762"></td>
          <td id="LC5762">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5763" data-line-number="5763"></td>
          <td id="LC5763">                <span>hResult</span> <span>=</span> <span>ERROR_FILE_NOT_FOUND</span></td>
        </tr>
        <tr>
          <td id="L5764" data-line-number="5764"></td>
          <td id="LC5764">                <span>sApiSource</span> <span>=</span> <span>&#34;CryptDecodeObjectEx(X509_ECC_PRIVATE_KEY)&#34;</span></td>
        </tr>
        <tr>
          <td id="L5765" data-line-number="5765"></td>
          <td id="LC5765">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5766" data-line-number="5766"></td>
          <td id="LC5766">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5767" data-line-number="5767"></td>
          <td id="LC5767">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5768" data-line-number="5768"></td>
          <td id="LC5768">            <span>&#39;--- unsupported private key</span></td>
        </tr>
        <tr>
          <td id="L5769" data-line-number="5769"></td>
          <td id="LC5769">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5770" data-line-number="5770"></td>
          <td id="LC5770">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5771" data-line-number="5771"></td>
          <td id="LC5771">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5772" data-line-number="5772"></td>
          <td id="LC5772">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5773" data-line-number="5773"></td>
          <td id="LC5773">    <span>pvAsn1DecodePrivateKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5774" data-line-number="5774"></td>
          <td id="LC5774"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5775" data-line-number="5775"></td>
          <td id="LC5775">    <span>If</span> <span>lKeyPtr</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5776" data-line-number="5776"></td>
          <td id="LC5776">        <span>Call</span> <span>LocalFree(lKeyPtr)</span></td>
        </tr>
        <tr>
          <td id="L5777" data-line-number="5777"></td>
          <td id="LC5777">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5778" data-line-number="5778"></td>
          <td id="LC5778">    <span>If</span> <span>lPkiPtr</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5779" data-line-number="5779"></td>
          <td id="LC5779">        <span>Call</span> <span>LocalFree(lPkiPtr)</span></td>
        </tr>
        <tr>
          <td id="L5780" data-line-number="5780"></td>
          <td id="LC5780">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5781" data-line-number="5781"></td>
          <td id="LC5781">    <span>If</span> <span>hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5782" data-line-number="5782"></td>
          <td id="LC5782">        <span>Call</span> <span>CryptReleaseContext(hProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5783" data-line-number="5783"></td>
          <td id="LC5783">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5784" data-line-number="5784"></td>
          <td id="LC5784">    <span>If</span> <span>hNProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5785" data-line-number="5785"></td>
          <td id="LC5785">        <span>Call</span> <span>NCryptFreeObject(hNProv)</span></td>
        </tr>
        <tr>
          <td id="L5786" data-line-number="5786"></td>
          <td id="LC5786">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5787" data-line-number="5787"></td>
          <td id="LC5787">    <span>If</span> <span>LenB(sApiSource)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5788" data-line-number="5788"></td>
          <td id="LC5788">        <span>ErrRaise</span> <span>IIf(hResult</span> <span>&lt;</span> <span>0</span><span>,</span> <span>hResult,</span> <span>hResult</span> <span>Or</span> <span>LNG_FACILITY_WIN32),</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>sApiSource</span></td>
        </tr>
        <tr>
          <td id="L5789" data-line-number="5789"></td>
          <td id="LC5789">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5790" data-line-number="5790"></td>
          <td id="LC5790"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5791" data-line-number="5791"></td>
          <td id="LC5791">
</td>
        </tr>
        <tr>
          <td id="L5792" data-line-number="5792"></td>
          <td id="LC5792"><span>Private</span> <span>Function</span> <span>pvAsn1DecodeCertificate(baCert()</span> <span>As</span> <span>Byte</span><span>,</span> <span>uRetVal</span> <span>As</span> <span>UcsKeyInfo)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5793" data-line-number="5793"></td>
          <td id="LC5793">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Asn1DecodeCertificate&#34;</span></td>
        </tr>
        <tr>
          <td id="L5794" data-line-number="5794"></td>
          <td id="LC5794">    <span>Dim</span> <span>pCertContext</span>    <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5795" data-line-number="5795"></td>
          <td id="LC5795">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5796" data-line-number="5796"></td>
          <td id="LC5796">    <span>Dim</span> <span>uPublicKeyInfo</span>  <span>As</span> <span>CERT_PUBLIC_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L5797" data-line-number="5797"></td>
          <td id="LC5797">    <span>Dim</span> <span>hProv</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5798" data-line-number="5798"></td>
          <td id="LC5798">    <span>Dim</span> <span>hKey</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5799" data-line-number="5799"></td>
          <td id="LC5799">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5800" data-line-number="5800"></td>
          <td id="LC5800">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5801" data-line-number="5801"></td>
          <td id="LC5801">    <span>Dim</span> <span>hResult</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5802" data-line-number="5802"></td>
          <td id="LC5802">    <span>Dim</span> <span>sApiSource</span>      <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5803" data-line-number="5803"></td>
          <td id="LC5803">
</td>
        </tr>
        <tr>
          <td id="L5804" data-line-number="5804"></td>
          <td id="LC5804">    <span>pCertContext</span> <span>=</span> <span>CertCreateCertificateContext(X509_ASN_ENCODING</span> <span>Or</span> <span>PKCS_7_ASN_ENCODING,</span> <span>baCert(</span><span>0</span><span>),</span> <span>UBound(baCert)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5805" data-line-number="5805"></td>
          <td id="LC5805">    <span>If</span> <span>pCertContext</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5806" data-line-number="5806"></td>
          <td id="LC5806">        <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L5807" data-line-number="5807"></td>
          <td id="LC5807">        <span>sApiSource</span> <span>=</span> <span>&#34;CertCreateCertificateContext&#34;</span></td>
        </tr>
        <tr>
          <td id="L5808" data-line-number="5808"></td>
          <td id="LC5808">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5809" data-line-number="5809"></td>
          <td id="LC5809">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5810" data-line-number="5810"></td>
          <td id="LC5810">    <span>Call</span> <span>CopyMemory(lPtr,</span> <span>ByVal</span> <span>UnsignedAdd(pCertContext,</span> <span>12</span><span>),</span> <span>LenB(lPtr))</span>  <span>&#39;--- dereference pCertContext-&gt;pCertInfo</span></td>
        </tr>
        <tr>
          <td id="L5811" data-line-number="5811"></td>
          <td id="LC5811">    <span>lPtr</span> <span>=</span> <span>UnsignedAdd(lPtr,</span> <span>56</span><span>)</span>                                            <span>&#39;--- &amp;pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo</span></td>
        </tr>
        <tr>
          <td id="L5812" data-line-number="5812"></td>
          <td id="LC5812">    <span>Call</span> <span>CopyMemory(uPublicKeyInfo,</span> <span>ByVal</span> <span>lPtr,</span> <span>LenB(uPublicKeyInfo))</span></td>
        </tr>
        <tr>
          <td id="L5813" data-line-number="5813"></td>
          <td id="LC5813">    <span>uRetVal.AlgoObjId</span> <span>=</span> <span>pvToStringA(uPublicKeyInfo.Algorithm.pszObjId)</span></td>
        </tr>
        <tr>
          <td id="L5814" data-line-number="5814"></td>
          <td id="LC5814">    <span>pvArrayAllocate</span> <span>uRetVal.KeyBlob,</span> <span>uPublicKeyInfo.PublicKey.cbData,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.KeyBlob&#34;</span></td>
        </tr>
        <tr>
          <td id="L5815" data-line-number="5815"></td>
          <td id="LC5815">    <span>Call</span> <span>CopyMemory(uRetVal.KeyBlob(</span><span>0</span><span>),</span> <span>ByVal</span> <span>uPublicKeyInfo.PublicKey.pbData,</span> <span>uPublicKeyInfo.PublicKey.cbData)</span></td>
        </tr>
        <tr>
          <td id="L5816" data-line-number="5816"></td>
          <td id="LC5816">    <span>If</span> <span>uRetVal.AlgoObjId</span> <span>=</span> <span>szOID_RSA_RSA</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5817" data-line-number="5817"></td>
          <td id="LC5817">        <span>If</span> <span>CryptAcquireContext(hProv,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>PROV_RSA_FULL,</span> <span>CRYPT_VERIFYCONTEXT)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5818" data-line-number="5818"></td>
          <td id="LC5818">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5819" data-line-number="5819"></td>
          <td id="LC5819">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5820" data-line-number="5820"></td>
          <td id="LC5820">        <span>If</span> <span>CryptImportPublicKeyInfo(hProv,</span> <span>X509_ASN_ENCODING</span> <span>Or</span> <span>PKCS_7_ASN_ENCODING,</span> <span>ByVal</span> <span>lPtr,</span> <span>hKey)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5821" data-line-number="5821"></td>
          <td id="LC5821">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5822" data-line-number="5822"></td>
          <td id="LC5822">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5823" data-line-number="5823"></td>
          <td id="LC5823">        <span>If</span> <span>CryptExportKey(hKey,</span> <span>0</span><span>,</span> <span>PUBLICKEYBLOB,</span> <span>0</span><span>,</span> <span>ByVal</span> <span>0</span><span>,</span> <span>lSize)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5824" data-line-number="5824"></td>
          <td id="LC5824">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5825" data-line-number="5825"></td>
          <td id="LC5825">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5826" data-line-number="5826"></td>
          <td id="LC5826">        <span>pvArrayAllocate</span> <span>baBuffer,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L5827" data-line-number="5827"></td>
          <td id="LC5827">        <span>If</span> <span>CryptExportKey(hKey,</span> <span>0</span><span>,</span> <span>PUBLICKEYBLOB,</span> <span>0</span><span>,</span> <span>baBuffer(</span><span>0</span><span>),</span> <span>lSize)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5828" data-line-number="5828"></td>
          <td id="LC5828">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5829" data-line-number="5829"></td>
          <td id="LC5829">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5830" data-line-number="5830"></td>
          <td id="LC5830">        <span>&#39;--- retrieve RSA key size (in bits)</span></td>
        </tr>
        <tr>
          <td id="L5831" data-line-number="5831"></td>
          <td id="LC5831">        <span>Debug.Assert</span> <span>UBound(baBuffer)</span> <span>&gt;=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L5832" data-line-number="5832"></td>
          <td id="LC5832">        <span>Call</span> <span>CopyMemory(uRetVal.BitLen,</span> <span>baBuffer(</span><span>12</span><span>),</span> <span>LenB(uRetVal.BitLen))</span>                     <span>&#39;--- 12 = sizeof(PUBLICKEYSTRUC) + offset(RSAPUBKEY, bitlen)</span></td>
        </tr>
        <tr>
          <td id="L5833" data-line-number="5833"></td>
          <td id="LC5833">        <span>lSize</span> <span>=</span> <span>(uRetVal.BitLen</span> <span>+</span> <span>7</span><span>)</span> <span>\</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L5834" data-line-number="5834"></td>
          <td id="LC5834">        <span>&#39;--- retrieve RSA public exponent</span></td>
        </tr>
        <tr>
          <td id="L5835" data-line-number="5835"></td>
          <td id="LC5835">        <span>pvArrayAllocate</span> <span>uRetVal.PubExp,</span> <span>4</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.PubExp&#34;</span></td>
        </tr>
        <tr>
          <td id="L5836" data-line-number="5836"></td>
          <td id="LC5836">        <span>Debug.Assert</span> <span>UBound(baBuffer)</span> <span>-</span> <span>16</span> <span>&gt;=</span> <span>UBound(uRetVal.PubExp)</span></td>
        </tr>
        <tr>
          <td id="L5837" data-line-number="5837"></td>
          <td id="LC5837">        <span>Call</span> <span>CopyMemory(uRetVal.PubExp(</span><span>0</span><span>),</span> <span>baBuffer(</span><span>16</span><span>),</span> <span>UBound(uRetVal.PubExp)</span> <span>+</span> <span>1</span><span>)</span>            <span>&#39;--- 16 = sizeof(PUBLICKEYSTRUC) + offset(RSAPUBKEY, pubexp)</span></td>
        </tr>
        <tr>
          <td id="L5838" data-line-number="5838"></td>
          <td id="LC5838">        <span>pvArrayReverse</span> <span>uRetVal.PubExp,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5839" data-line-number="5839"></td>
          <td id="LC5839">        <span>&#39;--- retrieve RSA key modulus</span></td>
        </tr>
        <tr>
          <td id="L5840" data-line-number="5840"></td>
          <td id="LC5840">        <span>pvArrayAllocate</span> <span>uRetVal.Modulus,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.uRetVal.Modulus&#34;</span></td>
        </tr>
        <tr>
          <td id="L5841" data-line-number="5841"></td>
          <td id="LC5841">        <span>Debug.Assert</span> <span>UBound(baBuffer)</span> <span>-</span> <span>20</span> <span>&gt;=</span> <span>UBound(uRetVal.Modulus)</span></td>
        </tr>
        <tr>
          <td id="L5842" data-line-number="5842"></td>
          <td id="LC5842">        <span>Call</span> <span>CopyMemory(uRetVal.Modulus(</span><span>0</span><span>),</span> <span>baBuffer(</span><span>20</span><span>),</span> <span>UBound(uRetVal.Modulus)</span> <span>+</span> <span>1</span><span>)</span>          <span>&#39;--- 20 = sizeof(PUBLICKEYSTRUC) + sizeof(RSAPUBKEY)</span></td>
        </tr>
        <tr>
          <td id="L5843" data-line-number="5843"></td>
          <td id="LC5843">        <span>pvArrayReverse</span> <span>uRetVal.Modulus</span></td>
        </tr>
        <tr>
          <td id="L5844" data-line-number="5844"></td>
          <td id="LC5844">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5845" data-line-number="5845"></td>
          <td id="LC5845">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5846" data-line-number="5846"></td>
          <td id="LC5846">    <span>pvAsn1DecodeCertificate</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5847" data-line-number="5847"></td>
          <td id="LC5847"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5848" data-line-number="5848"></td>
          <td id="LC5848">    <span>If</span> <span>hKey</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5849" data-line-number="5849"></td>
          <td id="LC5849">        <span>Call</span> <span>CryptDestroyKey(hKey)</span></td>
        </tr>
        <tr>
          <td id="L5850" data-line-number="5850"></td>
          <td id="LC5850">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5851" data-line-number="5851"></td>
          <td id="LC5851">    <span>If</span> <span>hProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5852" data-line-number="5852"></td>
          <td id="LC5852">        <span>Call</span> <span>CryptReleaseContext(hProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5853" data-line-number="5853"></td>
          <td id="LC5853">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5854" data-line-number="5854"></td>
          <td id="LC5854">    <span>If</span> <span>pCertContext</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5855" data-line-number="5855"></td>
          <td id="LC5855">        <span>Call</span> <span>CertFreeCertificateContext(pCertContext)</span></td>
        </tr>
        <tr>
          <td id="L5856" data-line-number="5856"></td>
          <td id="LC5856">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5857" data-line-number="5857"></td>
          <td id="LC5857">    <span>If</span> <span>LenB(sApiSource)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5858" data-line-number="5858"></td>
          <td id="LC5858">        <span>ErrRaise</span> <span>IIf(hResult</span> <span>&lt;</span> <span>0</span><span>,</span> <span>hResult,</span> <span>hResult</span> <span>Or</span> <span>LNG_FACILITY_WIN32),</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>sApiSource</span></td>
        </tr>
        <tr>
          <td id="L5859" data-line-number="5859"></td>
          <td id="LC5859">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5860" data-line-number="5860"></td>
          <td id="LC5860"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5861" data-line-number="5861"></td>
          <td id="LC5861">
</td>
        </tr>
        <tr>
          <td id="L5862" data-line-number="5862"></td>
          <td id="LC5862"><span>Private</span> <span>Function</span> <span>pvAsn1EncodePkcs1Signature(baHash()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baRetVal()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5863" data-line-number="5863"></td>
          <td id="LC5863">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;Asn1EncodePkcs1Signature&#34;</span></td>
        </tr>
        <tr>
          <td id="L5864" data-line-number="5864"></td>
          <td id="LC5864">    <span>Dim</span> <span>baPrefix()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5865" data-line-number="5865"></td>
          <td id="LC5865">    </td>
        </tr>
        <tr>
          <td id="L5866" data-line-number="5866"></td>
          <td id="LC5866">    <span>Select</span> <span>Case</span> <span>UBound(baHash)</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5867" data-line-number="5867"></td>
          <td id="LC5867">    <span>Case</span> <span>LNG_SHA1_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5868" data-line-number="5868"></td>
          <td id="LC5868">        <span>pvArrayByte</span> <span>baPrefix,</span> <span>&amp;H30</span><span>,</span> <span>&amp;H21</span><span>,</span> <span>&amp;H30</span><span>,</span> <span>&amp;H9</span><span>,</span> <span>&amp;H6</span><span>,</span> <span>&amp;H5</span><span>,</span> <span>&amp;H2B</span><span>,</span> <span>&amp;HE</span><span>,</span> <span>&amp;H3</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H1A</span><span>,</span> <span>&amp;H5</span><span>,</span> <span>&amp;H0</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H14</span></td>
        </tr>
        <tr>
          <td id="L5869" data-line-number="5869"></td>
          <td id="LC5869">    <span>Case</span> <span>LNG_SHA224_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5870" data-line-number="5870"></td>
          <td id="LC5870">        <span>pvArrayByte</span> <span>baPrefix,</span> <span>&amp;H30</span><span>,</span> <span>&amp;H2D</span><span>,</span> <span>&amp;H30</span><span>,</span> <span>&amp;HD</span><span>,</span> <span>&amp;H6</span><span>,</span> <span>&amp;H9</span><span>,</span> <span>&amp;H60</span><span>,</span> <span>&amp;H86</span><span>,</span> <span>&amp;H48</span><span>,</span> <span>&amp;H1</span><span>,</span> <span>&amp;H65</span><span>,</span> <span>&amp;H3</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H5</span><span>,</span> <span>&amp;H0</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H1C</span></td>
        </tr>
        <tr>
          <td id="L5871" data-line-number="5871"></td>
          <td id="LC5871">    <span>Case</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5872" data-line-number="5872"></td>
          <td id="LC5872">        <span>pvArrayByte</span> <span>baPrefix,</span> <span>&amp;H30</span><span>,</span> <span>&amp;H31</span><span>,</span> <span>&amp;H30</span><span>,</span> <span>&amp;HD</span><span>,</span> <span>&amp;H6</span><span>,</span> <span>&amp;H9</span><span>,</span> <span>&amp;H60</span><span>,</span> <span>&amp;H86</span><span>,</span> <span>&amp;H48</span><span>,</span> <span>&amp;H1</span><span>,</span> <span>&amp;H65</span><span>,</span> <span>&amp;H3</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H1</span><span>,</span> <span>&amp;H5</span><span>,</span> <span>&amp;H0</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H20</span></td>
        </tr>
        <tr>
          <td id="L5873" data-line-number="5873"></td>
          <td id="LC5873">    <span>Case</span> <span>LNG_SHA384_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5874" data-line-number="5874"></td>
          <td id="LC5874">        <span>pvArrayByte</span> <span>baPrefix,</span> <span>&amp;H30</span><span>,</span> <span>&amp;H41</span><span>,</span> <span>&amp;H30</span><span>,</span> <span>&amp;HD</span><span>,</span> <span>&amp;H6</span><span>,</span> <span>&amp;H9</span><span>,</span> <span>&amp;H60</span><span>,</span> <span>&amp;H86</span><span>,</span> <span>&amp;H48</span><span>,</span> <span>&amp;H1</span><span>,</span> <span>&amp;H65</span><span>,</span> <span>&amp;H3</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H5</span><span>,</span> <span>&amp;H0</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H30</span></td>
        </tr>
        <tr>
          <td id="L5875" data-line-number="5875"></td>
          <td id="LC5875">    <span>Case</span> <span>LNG_SHA512_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L5876" data-line-number="5876"></td>
          <td id="LC5876">        <span>pvArrayByte</span> <span>baPrefix,</span> <span>&amp;H30</span><span>,</span> <span>&amp;H51</span><span>,</span> <span>&amp;H30</span><span>,</span> <span>&amp;HD</span><span>,</span> <span>&amp;H6</span><span>,</span> <span>&amp;H9</span><span>,</span> <span>&amp;H60</span><span>,</span> <span>&amp;H86</span><span>,</span> <span>&amp;H48</span><span>,</span> <span>&amp;H1</span><span>,</span> <span>&amp;H65</span><span>,</span> <span>&amp;H3</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H2</span><span>,</span> <span>&amp;H3</span><span>,</span> <span>&amp;H5</span><span>,</span> <span>&amp;H0</span><span>,</span> <span>&amp;H4</span><span>,</span> <span>&amp;H40</span></td>
        </tr>
        <tr>
          <td id="L5877" data-line-number="5877"></td>
          <td id="LC5877">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L5878" data-line-number="5878"></td>
          <td id="LC5878">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>UBound(baPrefix)</span> <span>+</span> <span>UBound(baHash)</span> <span>+</span> <span>2</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L5879" data-line-number="5879"></td>
          <td id="LC5879">    <span>Call</span> <span>CopyMemory(baRetVal(</span><span>0</span><span>),</span> <span>baPrefix(</span><span>0</span><span>),</span> <span>UBound(baPrefix)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5880" data-line-number="5880"></td>
          <td id="LC5880">    <span>Call</span> <span>CopyMemory(baRetVal(UBound(baPrefix)</span> <span>+</span> <span>1</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>UBound(baHash)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L5881" data-line-number="5881"></td>
          <td id="LC5881">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5882" data-line-number="5882"></td>
          <td id="LC5882">    <span>pvAsn1EncodePkcs1Signature</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5883" data-line-number="5883"></td>
          <td id="LC5883"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5884" data-line-number="5884"></td>
          <td id="LC5884"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5885" data-line-number="5885"></td>
          <td id="LC5885">
</td>
        </tr>
        <tr>
          <td id="L5886" data-line-number="5886"></td>
          <td id="LC5886"><span>Private</span> <span>Function</span> <span>pvAsn1DecodeEcdsaSignature(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baDerSig()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lCurveSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5887" data-line-number="5887"></td>
          <td id="LC5887">    <span>Dim</span> <span>uOutput</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L5888" data-line-number="5888"></td>
          <td id="LC5888">    <span>Dim</span> <span>uInput</span>          <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L5889" data-line-number="5889"></td>
          <td id="LC5889">    <span>Dim</span> <span>lType</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5890" data-line-number="5890"></td>
          <td id="LC5890">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5891" data-line-number="5891"></td>
          <td id="LC5891">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5892" data-line-number="5892"></td>
          <td id="LC5892">    </td>
        </tr>
        <tr>
          <td id="L5893" data-line-number="5893"></td>
          <td id="LC5893">    <span>pvArraySwap</span> <span>uInput.Data,</span> <span>0</span><span>,</span> <span>baDerSig,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5894" data-line-number="5894"></td>
          <td id="LC5894">    <span>&#39;--- ECDSA-Sig-Value ::= SEQUENCE { r INTEGER, s INTEGER }</span></td>
        </tr>
        <tr>
          <td id="L5895" data-line-number="5895"></td>
          <td id="LC5895">    <span>pvBufferReadLong</span> <span>uInput,</span> <span>lType</span></td>
        </tr>
        <tr>
          <td id="L5896" data-line-number="5896"></td>
          <td id="LC5896">    <span>If</span> <span>lType</span> <span>&lt;&gt;</span> <span>LNG_ANS1_TYPE_SEQUENCE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5897" data-line-number="5897"></td>
          <td id="LC5897">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5898" data-line-number="5898"></td>
          <td id="LC5898">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5899" data-line-number="5899"></td>
          <td id="LC5899">    <span>If</span> <span>uInput.Pos</span> <span>&lt;=</span> <span>UBound(uInput.Data)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5900" data-line-number="5900"></td>
          <td id="LC5900">        <span>lSize</span> <span>=</span> <span>uInput.Data(uInput.Pos)</span></td>
        </tr>
        <tr>
          <td id="L5901" data-line-number="5901"></td>
          <td id="LC5901">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5902" data-line-number="5902"></td>
          <td id="LC5902">    <span>&#39;--- check for long form encoding of length of sequence</span></td>
        </tr>
        <tr>
          <td id="L5903" data-line-number="5903"></td>
          <td id="LC5903">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>&amp;H83</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5904" data-line-number="5904"></td>
          <td id="LC5904">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5905" data-line-number="5905"></td>
          <td id="LC5905">    <span>ElseIf</span> <span>lSize</span> <span>&gt;</span> <span>&amp;H80</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5906" data-line-number="5906"></td>
          <td id="LC5906">        <span>lSize</span> <span>=</span> <span>lSize</span> <span>-</span> <span>&amp;H80</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5907" data-line-number="5907"></td>
          <td id="LC5907">        <span>uInput.Data(uInput.Pos)</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5908" data-line-number="5908"></td>
          <td id="LC5908">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5909" data-line-number="5909"></td>
          <td id="LC5909">        <span>lSize</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5910" data-line-number="5910"></td>
          <td id="LC5910">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5911" data-line-number="5911"></td>
          <td id="LC5911">    <span>pvBufferReadBlockStart</span> <span>uInput,</span> <span>Size:=lSize</span></td>
        </tr>
        <tr>
          <td id="L5912" data-line-number="5912"></td>
          <td id="LC5912">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lType</span></td>
        </tr>
        <tr>
          <td id="L5913" data-line-number="5913"></td>
          <td id="LC5913">        <span>If</span> <span>lType</span> <span>&lt;&gt;</span> <span>LNG_ANS1_TYPE_INTEGER</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5914" data-line-number="5914"></td>
          <td id="LC5914">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5915" data-line-number="5915"></td>
          <td id="LC5915">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5916" data-line-number="5916"></td>
          <td id="LC5916">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5917" data-line-number="5917"></td>
          <td id="LC5917">        <span>pvBufferReadArray</span> <span>uInput,</span> <span>baTemp,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5918" data-line-number="5918"></td>
          <td id="LC5918">        <span>If</span> <span>lSize</span> <span>&lt;=</span> <span>lCurveSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5919" data-line-number="5919"></td>
          <td id="LC5919">            <span>uOutput.Size</span> <span>=</span> <span>lCurveSize</span> <span>-</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5920" data-line-number="5920"></td>
          <td id="LC5920">            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L5921" data-line-number="5921"></td>
          <td id="LC5921">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5922" data-line-number="5922"></td>
          <td id="LC5922">            <span>uOutput.Size</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5923" data-line-number="5923"></td>
          <td id="LC5923">            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baTemp(lSize</span> <span>-</span> <span>lCurveSize)),</span> <span>lCurveSize</span></td>
        </tr>
        <tr>
          <td id="L5924" data-line-number="5924"></td>
          <td id="LC5924">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5925" data-line-number="5925"></td>
          <td id="LC5925">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lType</span></td>
        </tr>
        <tr>
          <td id="L5926" data-line-number="5926"></td>
          <td id="LC5926">        <span>If</span> <span>lType</span> <span>&lt;&gt;</span> <span>LNG_ANS1_TYPE_INTEGER</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5927" data-line-number="5927"></td>
          <td id="LC5927">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5928" data-line-number="5928"></td>
          <td id="LC5928">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5929" data-line-number="5929"></td>
          <td id="LC5929">        <span>pvBufferReadLong</span> <span>uInput,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5930" data-line-number="5930"></td>
          <td id="LC5930">        <span>pvBufferReadArray</span> <span>uInput,</span> <span>baTemp,</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5931" data-line-number="5931"></td>
          <td id="LC5931">        <span>If</span> <span>lSize</span> <span>&lt;=</span> <span>lCurveSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5932" data-line-number="5932"></td>
          <td id="LC5932">            <span>uOutput.Size</span> <span>=</span> <span>lCurveSize</span> <span>+</span> <span>lCurveSize</span> <span>-</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L5933" data-line-number="5933"></td>
          <td id="LC5933">            <span>pvBufferWriteArray</span> <span>uOutput,</span> <span>baTemp</span></td>
        </tr>
        <tr>
          <td id="L5934" data-line-number="5934"></td>
          <td id="LC5934">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L5935" data-line-number="5935"></td>
          <td id="LC5935">            <span>uOutput.Size</span> <span>=</span> <span>lCurveSize</span></td>
        </tr>
        <tr>
          <td id="L5936" data-line-number="5936"></td>
          <td id="LC5936">            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baTemp(lSize</span> <span>-</span> <span>lCurveSize)),</span> <span>lCurveSize</span></td>
        </tr>
        <tr>
          <td id="L5937" data-line-number="5937"></td>
          <td id="LC5937">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5938" data-line-number="5938"></td>
          <td id="LC5938">        <span>If</span> <span>uInput.Stack(</span><span>1</span><span>)</span> <span>&lt;&gt;</span> <span>uInput.Pos</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5939" data-line-number="5939"></td>
          <td id="LC5939">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L5940" data-line-number="5940"></td>
          <td id="LC5940">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5941" data-line-number="5941"></td>
          <td id="LC5941">    <span>pvBufferReadBlockEnd</span> <span>uInput</span></td>
        </tr>
        <tr>
          <td id="L5942" data-line-number="5942"></td>
          <td id="LC5942">    <span>pvBufferWriteEOF</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5943" data-line-number="5943"></td>
          <td id="LC5943">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5944" data-line-number="5944"></td>
          <td id="LC5944">    <span>pvAsn1DecodeEcdsaSignature</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5945" data-line-number="5945"></td>
          <td id="LC5945"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L5946" data-line-number="5946"></td>
          <td id="LC5946">    <span>pvArraySwap</span> <span>baDerSig,</span> <span>0</span><span>,</span> <span>uInput.Data,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5947" data-line-number="5947"></td>
          <td id="LC5947">    <span>baRetVal</span> <span>=</span> <span>uOutput.Data</span></td>
        </tr>
        <tr>
          <td id="L5948" data-line-number="5948"></td>
          <td id="LC5948"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5949" data-line-number="5949"></td>
          <td id="LC5949">
</td>
        </tr>
        <tr>
          <td id="L5950" data-line-number="5950"></td>
          <td id="LC5950"><span>Private</span> <span>Function</span> <span>pvAsn1EncodeEcdsaSignature(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPlainSig()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPartSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5951" data-line-number="5951"></td>
          <td id="LC5951">    <span>Dim</span> <span>uOutput</span>         <span>As</span> <span>UcsBuffer</span></td>
        </tr>
        <tr>
          <td id="L5952" data-line-number="5952"></td>
          <td id="LC5952">    <span>Dim</span> <span>lStart</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5953" data-line-number="5953"></td>
          <td id="LC5953">    </td>
        </tr>
        <tr>
          <td id="L5954" data-line-number="5954"></td>
          <td id="LC5954">    <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>LNG_ANS1_TYPE_SEQUENCE</span></td>
        </tr>
        <tr>
          <td id="L5955" data-line-number="5955"></td>
          <td id="LC5955">    <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5956" data-line-number="5956"></td>
          <td id="LC5956">        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>LNG_ANS1_TYPE_INTEGER</span></td>
        </tr>
        <tr>
          <td id="L5957" data-line-number="5957"></td>
          <td id="LC5957">        <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5958" data-line-number="5958"></td>
          <td id="LC5958">            <span>For</span> <span>lStart</span> <span>=</span> <span>0</span> <span>To</span> <span>lPartSize</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5959" data-line-number="5959"></td>
          <td id="LC5959">                <span>If</span> <span>baPlainSig(lStart)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5960" data-line-number="5960"></td>
          <td id="LC5960">                    <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L5961" data-line-number="5961"></td>
          <td id="LC5961">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5962" data-line-number="5962"></td>
          <td id="LC5962">            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5963" data-line-number="5963"></td>
          <td id="LC5963">            <span>If</span> <span>(baPlainSig(lStart)</span> <span>And</span> <span>&amp;H80</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5964" data-line-number="5964"></td>
          <td id="LC5964">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5965" data-line-number="5965"></td>
          <td id="LC5965">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5966" data-line-number="5966"></td>
          <td id="LC5966">            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baPlainSig(lStart)),</span> <span>lPartSize</span> <span>-</span> <span>lStart</span></td>
        </tr>
        <tr>
          <td id="L5967" data-line-number="5967"></td>
          <td id="LC5967">        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5968" data-line-number="5968"></td>
          <td id="LC5968">        <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>LNG_ANS1_TYPE_INTEGER</span></td>
        </tr>
        <tr>
          <td id="L5969" data-line-number="5969"></td>
          <td id="LC5969">        <span>pvBufferWriteBlockStart</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5970" data-line-number="5970"></td>
          <td id="LC5970">            <span>For</span> <span>lStart</span> <span>=</span> <span>0</span> <span>To</span> <span>lPartSize</span> <span>-</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L5971" data-line-number="5971"></td>
          <td id="LC5971">                <span>If</span> <span>baPlainSig(lPartSize</span> <span>+</span> <span>lStart)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5972" data-line-number="5972"></td>
          <td id="LC5972">                    <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L5973" data-line-number="5973"></td>
          <td id="LC5973">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5974" data-line-number="5974"></td>
          <td id="LC5974">            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L5975" data-line-number="5975"></td>
          <td id="LC5975">            <span>If</span> <span>(baPlainSig(lPartSize</span> <span>+</span> <span>lStart)</span> <span>And</span> <span>&amp;H80</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5976" data-line-number="5976"></td>
          <td id="LC5976">                <span>pvBufferWriteLong</span> <span>uOutput,</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L5977" data-line-number="5977"></td>
          <td id="LC5977">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L5978" data-line-number="5978"></td>
          <td id="LC5978">            <span>pvBufferWriteBlob</span> <span>uOutput,</span> <span>VarPtr(baPlainSig(lPartSize</span> <span>+</span> <span>lStart)),</span> <span>lPartSize</span> <span>-</span> <span>lStart</span></td>
        </tr>
        <tr>
          <td id="L5979" data-line-number="5979"></td>
          <td id="LC5979">        <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5980" data-line-number="5980"></td>
          <td id="LC5980">    <span>pvBufferWriteBlockEnd</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5981" data-line-number="5981"></td>
          <td id="LC5981">    <span>pvBufferWriteEOF</span> <span>uOutput</span></td>
        </tr>
        <tr>
          <td id="L5982" data-line-number="5982"></td>
          <td id="LC5982">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L5983" data-line-number="5983"></td>
          <td id="LC5983">    <span>pvAsn1EncodeEcdsaSignature</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L5984" data-line-number="5984"></td>
          <td id="LC5984">    <span>baRetVal</span> <span>=</span> <span>uOutput.Data</span></td>
        </tr>
        <tr>
          <td id="L5985" data-line-number="5985"></td>
          <td id="LC5985"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L5986" data-line-number="5986"></td>
          <td id="LC5986">
</td>
        </tr>
        <tr>
          <td id="L5987" data-line-number="5987"></td>
          <td id="LC5987"><span>Private</span> <span>Function</span> <span>pvCryptoInit()</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L5988" data-line-number="5988"></td>
          <td id="LC5988">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoInit&#34;</span></td>
        </tr>
        <tr>
          <td id="L5989" data-line-number="5989"></td>
          <td id="LC5989">    <span>Dim</span> <span>lOffset</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5990" data-line-number="5990"></td>
          <td id="LC5990">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5991" data-line-number="5991"></td>
          <td id="LC5991">    <span>Dim</span> <span>baThunk()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L5992" data-line-number="5992"></td>
          <td id="LC5992">    <span>Dim</span> <span>hResult</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L5993" data-line-number="5993"></td>
          <td id="LC5993">    <span>Dim</span> <span>sApiSource</span>      <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L5994" data-line-number="5994"></td>
          <td id="LC5994">    </td>
        </tr>
        <tr>
          <td id="L5995" data-line-number="5995"></td>
          <td id="LC5995">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L5996" data-line-number="5996"></td>
          <td id="LC5996">        <span>If</span> <span>.hRandomProv</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5997" data-line-number="5997"></td>
          <td id="LC5997">            <span>If</span> <span>CryptAcquireContext(.hRandomProv,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>PROV_RSA_FULL,</span> <span>CRYPT_VERIFYCONTEXT)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L5998" data-line-number="5998"></td>
          <td id="LC5998">                <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L5999" data-line-number="5999"></td>
          <td id="LC5999">                <span>sApiSource</span> <span>=</span> <span>&#34;CryptAcquireContext&#34;</span></td>
        </tr>
        <tr>
          <td id="L6000" data-line-number="6000"></td>
          <td id="LC6000">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6001" data-line-number="6001"></td>
          <td id="LC6001">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6002" data-line-number="6002"></td>
          <td id="LC6002">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6003" data-line-number="6003"></td>
          <td id="LC6003">        <span>If</span> <span>m_uData.Thunk</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6004" data-line-number="6004"></td>
          <td id="LC6004">            <span>&#39;--- prepare thunk/context in executable memory</span></td>
        </tr>
        <tr>
          <td id="L6005" data-line-number="6005"></td>
          <td id="LC6005">            <span>pvGetThunkData</span> <span>baThunk</span></td>
        </tr>
        <tr>
          <td id="L6006" data-line-number="6006"></td>
          <td id="LC6006">            <span>.Thunk</span> <span>=</span> <span>VirtualAlloc(</span><span>0</span><span>,</span> <span>UBound(baThunk)</span> <span>+</span> <span>1</span><span>,</span> <span>MEM_COMMIT,</span> <span>PAGE_EXECUTE_READWRITE)</span></td>
        </tr>
        <tr>
          <td id="L6007" data-line-number="6007"></td>
          <td id="LC6007">            <span>If</span> <span>.Thunk</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6008" data-line-number="6008"></td>
          <td id="LC6008">                <span>hResult</span> <span>=</span> <span>Err.LastDllError</span></td>
        </tr>
        <tr>
          <td id="L6009" data-line-number="6009"></td>
          <td id="LC6009">                <span>sApiSource</span> <span>=</span> <span>&#34;VirtualAlloc&#34;</span></td>
        </tr>
        <tr>
          <td id="L6010" data-line-number="6010"></td>
          <td id="LC6010">                <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6011" data-line-number="6011"></td>
          <td id="LC6011">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6012" data-line-number="6012"></td>
          <td id="LC6012">            <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>.Thunk,</span> <span>baThunk(</span><span>0</span><span>),</span> <span>UBound(baThunk)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6013" data-line-number="6013"></td>
          <td id="LC6013">            <span>pvGetGlobData</span> <span>.Glob</span></td>
        </tr>
        <tr>
          <td id="L6014" data-line-number="6014"></td>
          <td id="LC6014">            <span>&#39;--- init pfns from thunk addr + offsets stored at beginning of it</span></td>
        </tr>
        <tr>
          <td id="L6015" data-line-number="6015"></td>
          <td id="LC6015">            <span>For</span> <span>lIdx</span> <span>=</span> <span>LBound(.Pfn)</span> <span>To</span> <span>UBound(.Pfn)</span></td>
        </tr>
        <tr>
          <td id="L6016" data-line-number="6016"></td>
          <td id="LC6016">                <span>Call</span> <span>CopyMemory(lOffset,</span> <span>ByVal</span> <span>UnsignedAdd(.Thunk,</span> <span>LenB(lOffset)</span> <span>*</span> <span>lIdx),</span> <span>LenB(lOffset))</span></td>
        </tr>
        <tr>
          <td id="L6017" data-line-number="6017"></td>
          <td id="LC6017">                <span>.Pfn(lIdx)</span> <span>=</span> <span>UnsignedAdd(.Thunk,</span> <span>lOffset)</span></td>
        </tr>
        <tr>
          <td id="L6018" data-line-number="6018"></td>
          <td id="LC6018">            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6019" data-line-number="6019"></td>
          <td id="LC6019">            <span>&#39;--- init pfns trampolines</span></td>
        </tr>
        <tr>
          <td id="L6020" data-line-number="6020"></td>
          <td id="LC6020">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpMakeKey)</span></td>
        </tr>
        <tr>
          <td id="L6021" data-line-number="6021"></td>
          <td id="LC6021">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpSharedSecret)</span></td>
        </tr>
        <tr>
          <td id="L6022" data-line-number="6022"></td>
          <td id="LC6022">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpUncompressKey)</span></td>
        </tr>
        <tr>
          <td id="L6023" data-line-number="6023"></td>
          <td id="LC6023">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpSign)</span></td>
        </tr>
        <tr>
          <td id="L6024" data-line-number="6024"></td>
          <td id="LC6024">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpVerify)</span></td>
        </tr>
        <tr>
          <td id="L6025" data-line-number="6025"></td>
          <td id="LC6025">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallCurve25519Multiply)</span></td>
        </tr>
        <tr>
          <td id="L6026" data-line-number="6026"></td>
          <td id="LC6026">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallCurve25519MulBase)</span></td>
        </tr>
        <tr>
          <td id="L6027" data-line-number="6027"></td>
          <td id="LC6027">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6028" data-line-number="6028"></td>
          <td id="LC6028">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6029" data-line-number="6029"></td>
          <td id="LC6029">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6030" data-line-number="6030"></td>
          <td id="LC6030">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallChacha20Poly1305Encrypt)</span></td>
        </tr>
        <tr>
          <td id="L6031" data-line-number="6031"></td>
          <td id="LC6031">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallChacha20Poly1305Decrypt)</span></td>
        </tr>
        <tr>
          <td id="L6032" data-line-number="6032"></td>
          <td id="LC6032">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesGcmEncrypt)</span></td>
        </tr>
        <tr>
          <td id="L6033" data-line-number="6033"></td>
          <td id="LC6033">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesGcmDecrypt)</span></td>
        </tr>
        <tr>
          <td id="L6034" data-line-number="6034"></td>
          <td id="LC6034">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesCbcEncrypt)</span></td>
        </tr>
        <tr>
          <td id="L6035" data-line-number="6035"></td>
          <td id="LC6035">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesCbcDecrypt)</span></td>
        </tr>
        <tr>
          <td id="L6036" data-line-number="6036"></td>
          <td id="LC6036">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallRsaModExp)</span></td>
        </tr>
        <tr>
          <td id="L6037" data-line-number="6037"></td>
          <td id="LC6037">            <span>Call</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallRsaCrtModExp)</span></td>
        </tr>
        <tr>
          <td id="L6038" data-line-number="6038"></td>
          <td id="LC6038">            <span>&#39;--- init thunk&#39;s first 4 bytes -&gt; global data in C/C++</span></td>
        </tr>
        <tr>
          <td id="L6039" data-line-number="6039"></td>
          <td id="LC6039">            <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>.Thunk,</span> <span>VarPtr(.Glob(</span><span>0</span><span>)),</span> <span>4</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6040" data-line-number="6040"></td>
          <td id="LC6040">            <span>Call</span> <span>CopyMemory(.Glob(</span><span>0</span><span>),</span> <span>GetProcAddress(GetModuleHandle(StrPtr(</span><span>&#34;ole32&#34;</span><span>)),</span> <span>&#34;CoTaskMemAlloc&#34;</span><span>),</span> <span>4</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6041" data-line-number="6041"></td>
          <td id="LC6041">            <span>Call</span> <span>CopyMemory(.Glob(</span><span>4</span><span>),</span> <span>GetProcAddress(GetModuleHandle(StrPtr(</span><span>&#34;ole32&#34;</span><span>)),</span> <span>&#34;CoTaskMemRealloc&#34;</span><span>),</span> <span>4</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6042" data-line-number="6042"></td>
          <td id="LC6042">            <span>Call</span> <span>CopyMemory(.Glob(</span><span>8</span><span>),</span> <span>GetProcAddress(GetModuleHandle(StrPtr(</span><span>&#34;ole32&#34;</span><span>)),</span> <span>&#34;CoTaskMemFree&#34;</span><span>),</span> <span>4</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6043" data-line-number="6043"></td>
          <td id="LC6043">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6044" data-line-number="6044"></td>
          <td id="LC6044">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6045" data-line-number="6045"></td>
          <td id="LC6045">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6046" data-line-number="6046"></td>
          <td id="LC6046">    <span>pvCryptoInit</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6047" data-line-number="6047"></td>
          <td id="LC6047"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6048" data-line-number="6048"></td>
          <td id="LC6048">    <span>If</span> <span>LenB(sApiSource)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6049" data-line-number="6049"></td>
          <td id="LC6049">        <span>ErrRaise</span> <span>IIf(hResult</span> <span>&lt;</span> <span>0</span><span>,</span> <span>hResult,</span> <span>hResult</span> <span>Or</span> <span>LNG_FACILITY_WIN32),</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.&#34;</span> <span>&amp;</span> <span>sApiSource</span></td>
        </tr>
        <tr>
          <td id="L6050" data-line-number="6050"></td>
          <td id="LC6050">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6051" data-line-number="6051"></td>
          <td id="LC6051"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6052" data-line-number="6052"></td>
          <td id="LC6052">
</td>
        </tr>
        <tr>
          <td id="L6053" data-line-number="6053"></td>
          <td id="LC6053"><span>#</span><span>If</span> <span>False</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6054" data-line-number="6054"></td>
          <td id="LC6054"><span>Public</span> <span>Sub</span> <span>pvCryptoTerminate()</span></td>
        </tr>
        <tr>
          <td id="L6055" data-line-number="6055"></td>
          <td id="LC6055">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6056" data-line-number="6056"></td>
          <td id="LC6056">        <span>If</span> <span>.hRandomProv</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6057" data-line-number="6057"></td>
          <td id="LC6057">            <span>Call</span> <span>CryptReleaseContext(.hRandomProv,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6058" data-line-number="6058"></td>
          <td id="LC6058">            <span>.hRandomProv</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L6059" data-line-number="6059"></td>
          <td id="LC6059">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6060" data-line-number="6060"></td>
          <td id="LC6060">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6061" data-line-number="6061"></td>
          <td id="LC6061"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L6062" data-line-number="6062"></td>
          <td id="LC6062"><span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6063" data-line-number="6063"></td>
          <td id="LC6063">
</td>
        </tr>
        <tr>
          <td id="L6064" data-line-number="6064"></td>
          <td id="LC6064"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhCurve25519MakeKey(baPrivate()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6065" data-line-number="6065"></td>
          <td id="LC6065">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhCurve25519MakeKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L6066" data-line-number="6066"></td>
          <td id="LC6066">    <span>Const</span> <span>MAX_RETRIES</span>   <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L6067" data-line-number="6067"></td>
          <td id="LC6067">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6068" data-line-number="6068"></td>
          <td id="LC6068">    </td>
        </tr>
        <tr>
          <td id="L6069" data-line-number="6069"></td>
          <td id="LC6069">    <span>pvArrayAllocate</span> <span>baPrivate,</span> <span>LNG_X25519_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPrivate&#34;</span></td>
        </tr>
        <tr>
          <td id="L6070" data-line-number="6070"></td>
          <td id="LC6070">    <span>pvArrayAllocate</span> <span>baPublic,</span> <span>LNG_X25519_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPublic&#34;</span></td>
        </tr>
        <tr>
          <td id="L6071" data-line-number="6071"></td>
          <td id="LC6071">    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>MAX_RETRIES</span></td>
        </tr>
        <tr>
          <td id="L6072" data-line-number="6072"></td>
          <td id="LC6072">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baPrivate(</span><span>0</span><span>)),</span> <span>LNG_X25519_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6073" data-line-number="6073"></td>
          <td id="LC6073">        <span>If</span> <span>pvArrayAccumulateOr(baPrivate)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6074" data-line-number="6074"></td>
          <td id="LC6074">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L6075" data-line-number="6075"></td>
          <td id="LC6075">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6076" data-line-number="6076"></td>
          <td id="LC6076">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6077" data-line-number="6077"></td>
          <td id="LC6077">    <span>&#39;--- fix privkey randomness</span></td>
        </tr>
        <tr>
          <td id="L6078" data-line-number="6078"></td>
          <td id="LC6078">    <span>baPrivate(</span><span>0</span><span>)</span> <span>=</span> <span>baPrivate(</span><span>0</span><span>)</span> <span>And</span> <span>&amp;HF8</span></td>
        </tr>
        <tr>
          <td id="L6079" data-line-number="6079"></td>
          <td id="LC6079">    <span>baPrivate(LNG_X25519_KEYSZ</span> <span>-</span> <span>1</span><span>)</span> <span>=</span> <span>(baPrivate(LNG_X25519_KEYSZ</span> <span>-</span> <span>1</span><span>)</span> <span>And</span> <span>&amp;H7F</span><span>)</span> <span>Or</span> <span>&amp;H40</span></td>
        </tr>
        <tr>
          <td id="L6080" data-line-number="6080"></td>
          <td id="LC6080">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallCurve25519MulBase)</span></td>
        </tr>
        <tr>
          <td id="L6081" data-line-number="6081"></td>
          <td id="LC6081">    <span>pvCallCurve25519MulBase</span> <span>m_uData.Pfn(ucsPfnCurve25519ScalarMultBase),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6082" data-line-number="6082"></td>
          <td id="LC6082">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6083" data-line-number="6083"></td>
          <td id="LC6083">    <span>pvCryptoEcdhCurve25519MakeKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6084" data-line-number="6084"></td>
          <td id="LC6084"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6085" data-line-number="6085"></td>
          <td id="LC6085">
</td>
        </tr>
        <tr>
          <td id="L6086" data-line-number="6086"></td>
          <td id="LC6086"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhCurve25519SharedSecret(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrivate()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6087" data-line-number="6087"></td>
          <td id="LC6087">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhCurve25519SharedSecret&#34;</span></td>
        </tr>
        <tr>
          <td id="L6088" data-line-number="6088"></td>
          <td id="LC6088">    </td>
        </tr>
        <tr>
          <td id="L6089" data-line-number="6089"></td>
          <td id="LC6089">    <span>If</span> <span>UBound(baPrivate)</span> <span>=</span> <span>LNG_X25519_KEYSZ</span> <span>-</span> <span>1</span> <span>And</span> <span>UBound(baPublic)</span> <span>=</span> <span>LNG_X25519_KEYSZ</span> <span>-</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6090" data-line-number="6090"></td>
          <td id="LC6090">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_X25519_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6091" data-line-number="6091"></td>
          <td id="LC6091">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallCurve25519Multiply)</span></td>
        </tr>
        <tr>
          <td id="L6092" data-line-number="6092"></td>
          <td id="LC6092">        <span>pvCallCurve25519Multiply</span> <span>m_uData.Pfn(ucsPfnCurve25519ScalarMultiply),</span> <span>baRetVal(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>0</span><span>),</span> <span>baPublic(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6093" data-line-number="6093"></td>
          <td id="LC6093">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6094" data-line-number="6094"></td>
          <td id="LC6094">        <span>pvCryptoEcdhCurve25519SharedSecret</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6095" data-line-number="6095"></td>
          <td id="LC6095">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6096" data-line-number="6096"></td>
          <td id="LC6096"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6097" data-line-number="6097"></td>
          <td id="LC6097">
</td>
        </tr>
        <tr>
          <td id="L6098" data-line-number="6098"></td>
          <td id="LC6098"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhSecp256r1MakeKey(baPrivate()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6099" data-line-number="6099"></td>
          <td id="LC6099">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhSecp256r1MakeKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L6100" data-line-number="6100"></td>
          <td id="LC6100">    <span>Const</span> <span>MAX_RETRIES</span>   <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L6101" data-line-number="6101"></td>
          <td id="LC6101">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6102" data-line-number="6102"></td>
          <td id="LC6102">    </td>
        </tr>
        <tr>
          <td id="L6103" data-line-number="6103"></td>
          <td id="LC6103">    <span>pvArrayAllocate</span> <span>baPrivate,</span> <span>LNG_SECP256R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPrivate&#34;</span></td>
        </tr>
        <tr>
          <td id="L6104" data-line-number="6104"></td>
          <td id="LC6104">    <span>pvArrayAllocate</span> <span>baPublic,</span> <span>2</span> <span>*</span> <span>LNG_SECP256R1_KEYSZ</span> <span>+</span> <span>1</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPublic&#34;</span></td>
        </tr>
        <tr>
          <td id="L6105" data-line-number="6105"></td>
          <td id="LC6105">    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>MAX_RETRIES</span></td>
        </tr>
        <tr>
          <td id="L6106" data-line-number="6106"></td>
          <td id="LC6106">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baPrivate(</span><span>0</span><span>)),</span> <span>LNG_SECP256R1_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6107" data-line-number="6107"></td>
          <td id="LC6107">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpMakeKey)</span></td>
        </tr>
        <tr>
          <td id="L6108" data-line-number="6108"></td>
          <td id="LC6108">        <span>If</span> <span>pvCallSecpMakeKey(m_uData.Pfn(ucsPfnSecp256r1MakeKey),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>0</span><span>))</span> <span>=</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6109" data-line-number="6109"></td>
          <td id="LC6109">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L6110" data-line-number="6110"></td>
          <td id="LC6110">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6111" data-line-number="6111"></td>
          <td id="LC6111">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6112" data-line-number="6112"></td>
          <td id="LC6112">    <span>If</span> <span>lIdx</span> <span>&gt;</span> <span>MAX_RETRIES</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6113" data-line-number="6113"></td>
          <td id="LC6113">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6114" data-line-number="6114"></td>
          <td id="LC6114">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6115" data-line-number="6115"></td>
          <td id="LC6115">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6116" data-line-number="6116"></td>
          <td id="LC6116">    <span>pvCryptoEcdhSecp256r1MakeKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6117" data-line-number="6117"></td>
          <td id="LC6117"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6118" data-line-number="6118"></td>
          <td id="LC6118"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6119" data-line-number="6119"></td>
          <td id="LC6119">
</td>
        </tr>
        <tr>
          <td id="L6120" data-line-number="6120"></td>
          <td id="LC6120"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhSecp256r1SharedSecret(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrivate()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6121" data-line-number="6121"></td>
          <td id="LC6121">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhSecp256r1SharedSecret&#34;</span></td>
        </tr>
        <tr>
          <td id="L6122" data-line-number="6122"></td>
          <td id="LC6122">    </td>
        </tr>
        <tr>
          <td id="L6123" data-line-number="6123"></td>
          <td id="LC6123">    <span>If</span> <span>UBound(baPrivate)</span> <span>=</span> <span>LNG_SECP256R1_KEYSZ</span> <span>-</span> <span>1</span> <span>And</span> <span>UBound(baPublic)</span> <span>&gt;=</span> <span>LNG_SECP256R1_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6124" data-line-number="6124"></td>
          <td id="LC6124">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SECP256R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6125" data-line-number="6125"></td>
          <td id="LC6125">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpSharedSecret)</span></td>
        </tr>
        <tr>
          <td id="L6126" data-line-number="6126"></td>
          <td id="LC6126">        <span>If</span> <span>pvCallSecpSharedSecret(m_uData.Pfn(ucsPfnSecp256r1SharedSecret),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6127" data-line-number="6127"></td>
          <td id="LC6127">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6128" data-line-number="6128"></td>
          <td id="LC6128">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6129" data-line-number="6129"></td>
          <td id="LC6129">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6130" data-line-number="6130"></td>
          <td id="LC6130">        <span>pvCryptoEcdhSecp256r1SharedSecret</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6131" data-line-number="6131"></td>
          <td id="LC6131">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6132" data-line-number="6132"></td>
          <td id="LC6132"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6133" data-line-number="6133"></td>
          <td id="LC6133"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6134" data-line-number="6134"></td>
          <td id="LC6134">
</td>
        </tr>
        <tr>
          <td id="L6135" data-line-number="6135"></td>
          <td id="LC6135"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhSecp256r1UncompressKey(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6136" data-line-number="6136"></td>
          <td id="LC6136">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhSecp256r1UncompressKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L6137" data-line-number="6137"></td>
          <td id="LC6137">
</td>
        </tr>
        <tr>
          <td id="L6138" data-line-number="6138"></td>
          <td id="LC6138">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>1</span> <span>+</span> <span>2</span> <span>*</span> <span>LNG_SECP256R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6139" data-line-number="6139"></td>
          <td id="LC6139">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpUncompressKey)</span></td>
        </tr>
        <tr>
          <td id="L6140" data-line-number="6140"></td>
          <td id="LC6140">    <span>If</span> <span>pvCallSecpUncompressKey(m_uData.Pfn(ucsPfnSecp256r1UncompressKey),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6141" data-line-number="6141"></td>
          <td id="LC6141">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6142" data-line-number="6142"></td>
          <td id="LC6142">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6143" data-line-number="6143"></td>
          <td id="LC6143">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6144" data-line-number="6144"></td>
          <td id="LC6144">    <span>pvCryptoEcdhSecp256r1UncompressKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6145" data-line-number="6145"></td>
          <td id="LC6145"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6146" data-line-number="6146"></td>
          <td id="LC6146"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6147" data-line-number="6147"></td>
          <td id="LC6147">
</td>
        </tr>
        <tr>
          <td id="L6148" data-line-number="6148"></td>
          <td id="LC6148"><span>Private</span> <span>Function</span> <span>pvCryptoEcdsaSecp256r1Sign(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrivKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baHash()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6149" data-line-number="6149"></td>
          <td id="LC6149">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdsaSecp256r1Sign&#34;</span></td>
        </tr>
        <tr>
          <td id="L6150" data-line-number="6150"></td>
          <td id="LC6150">    <span>Const</span> <span>MAX_RETRIES</span>   <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L6151" data-line-number="6151"></td>
          <td id="LC6151">    <span>Dim</span> <span>baRandom()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6152" data-line-number="6152"></td>
          <td id="LC6152">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6153" data-line-number="6153"></td>
          <td id="LC6153">    </td>
        </tr>
        <tr>
          <td id="L6154" data-line-number="6154"></td>
          <td id="LC6154">    <span>pvArrayAllocate</span> <span>baRandom,</span> <span>LNG_SECP256R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRandom&#34;</span></td>
        </tr>
        <tr>
          <td id="L6155" data-line-number="6155"></td>
          <td id="LC6155">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>2</span> <span>*</span> <span>LNG_SECP256R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6156" data-line-number="6156"></td>
          <td id="LC6156">    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>MAX_RETRIES</span></td>
        </tr>
        <tr>
          <td id="L6157" data-line-number="6157"></td>
          <td id="LC6157">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baRandom(</span><span>0</span><span>)),</span> <span>LNG_SECP256R1_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6158" data-line-number="6158"></td>
          <td id="LC6158">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpSign)</span></td>
        </tr>
        <tr>
          <td id="L6159" data-line-number="6159"></td>
          <td id="LC6159">        <span>If</span> <span>pvCallSecpSign(m_uData.Pfn(ucsPfnSecp256r1Sign),</span> <span>baPrivKey(</span><span>0</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>baRandom(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6160" data-line-number="6160"></td>
          <td id="LC6160">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L6161" data-line-number="6161"></td>
          <td id="LC6161">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6162" data-line-number="6162"></td>
          <td id="LC6162">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6163" data-line-number="6163"></td>
          <td id="LC6163">    <span>If</span> <span>lIdx</span> <span>&gt;</span> <span>MAX_RETRIES</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6164" data-line-number="6164"></td>
          <td id="LC6164">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6165" data-line-number="6165"></td>
          <td id="LC6165">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6166" data-line-number="6166"></td>
          <td id="LC6166">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6167" data-line-number="6167"></td>
          <td id="LC6167">    <span>pvCryptoEcdsaSecp256r1Sign</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6168" data-line-number="6168"></td>
          <td id="LC6168"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6169" data-line-number="6169"></td>
          <td id="LC6169"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6170" data-line-number="6170"></td>
          <td id="LC6170">
</td>
        </tr>
        <tr>
          <td id="L6171" data-line-number="6171"></td>
          <td id="LC6171"><span>Private</span> <span>Function</span> <span>pvCryptoEcdsaSecp256r1Verify(baPublic()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baHash()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baSignature()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6172" data-line-number="6172"></td>
          <td id="LC6172">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpVerify)</span></td>
        </tr>
        <tr>
          <td id="L6173" data-line-number="6173"></td>
          <td id="LC6173">    <span>pvCryptoEcdsaSecp256r1Verify</span> <span>=</span> <span>(pvCallSecpVerify(m_uData.Pfn(ucsPfnSecp256r1Verify),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>baSignature(</span><span>0</span><span>))</span> <span>&lt;&gt;</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6174" data-line-number="6174"></td>
          <td id="LC6174"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6175" data-line-number="6175"></td>
          <td id="LC6175">
</td>
        </tr>
        <tr>
          <td id="L6176" data-line-number="6176"></td>
          <td id="LC6176"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhSecp384r1MakeKey(baPrivate()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6177" data-line-number="6177"></td>
          <td id="LC6177">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhSecp384r1MakeKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L6178" data-line-number="6178"></td>
          <td id="LC6178">    <span>Const</span> <span>MAX_RETRIES</span>   <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L6179" data-line-number="6179"></td>
          <td id="LC6179">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6180" data-line-number="6180"></td>
          <td id="LC6180">    </td>
        </tr>
        <tr>
          <td id="L6181" data-line-number="6181"></td>
          <td id="LC6181">    <span>pvArrayAllocate</span> <span>baPrivate,</span> <span>LNG_SECP384R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPrivate&#34;</span></td>
        </tr>
        <tr>
          <td id="L6182" data-line-number="6182"></td>
          <td id="LC6182">    <span>pvArrayAllocate</span> <span>baPublic,</span> <span>2</span> <span>*</span> <span>LNG_SECP384R1_KEYSZ</span> <span>+</span> <span>1</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baPublic&#34;</span></td>
        </tr>
        <tr>
          <td id="L6183" data-line-number="6183"></td>
          <td id="LC6183">    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>MAX_RETRIES</span></td>
        </tr>
        <tr>
          <td id="L6184" data-line-number="6184"></td>
          <td id="LC6184">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baPrivate(</span><span>0</span><span>)),</span> <span>LNG_SECP384R1_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6185" data-line-number="6185"></td>
          <td id="LC6185">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpMakeKey)</span></td>
        </tr>
        <tr>
          <td id="L6186" data-line-number="6186"></td>
          <td id="LC6186">        <span>If</span> <span>pvCallSecpMakeKey(m_uData.Pfn(ucsPfnSecp384r1MakeKey),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>0</span><span>))</span> <span>=</span> <span>1</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6187" data-line-number="6187"></td>
          <td id="LC6187">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L6188" data-line-number="6188"></td>
          <td id="LC6188">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6189" data-line-number="6189"></td>
          <td id="LC6189">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6190" data-line-number="6190"></td>
          <td id="LC6190">    <span>If</span> <span>lIdx</span> <span>&gt;</span> <span>MAX_RETRIES</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6191" data-line-number="6191"></td>
          <td id="LC6191">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6192" data-line-number="6192"></td>
          <td id="LC6192">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6193" data-line-number="6193"></td>
          <td id="LC6193">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6194" data-line-number="6194"></td>
          <td id="LC6194">    <span>pvCryptoEcdhSecp384r1MakeKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6195" data-line-number="6195"></td>
          <td id="LC6195"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6196" data-line-number="6196"></td>
          <td id="LC6196"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6197" data-line-number="6197"></td>
          <td id="LC6197">
</td>
        </tr>
        <tr>
          <td id="L6198" data-line-number="6198"></td>
          <td id="LC6198"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhSecp384r1SharedSecret(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrivate()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6199" data-line-number="6199"></td>
          <td id="LC6199">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhSecp384r1SharedSecret&#34;</span></td>
        </tr>
        <tr>
          <td id="L6200" data-line-number="6200"></td>
          <td id="LC6200">    </td>
        </tr>
        <tr>
          <td id="L6201" data-line-number="6201"></td>
          <td id="LC6201">    <span>If</span> <span>UBound(baPrivate)</span> <span>=</span> <span>LNG_SECP384R1_KEYSZ</span> <span>-</span> <span>1</span> <span>And</span> <span>UBound(baPublic)</span> <span>&gt;=</span> <span>LNG_SECP384R1_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6202" data-line-number="6202"></td>
          <td id="LC6202">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SECP384R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6203" data-line-number="6203"></td>
          <td id="LC6203">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpSharedSecret)</span></td>
        </tr>
        <tr>
          <td id="L6204" data-line-number="6204"></td>
          <td id="LC6204">        <span>If</span> <span>pvCallSecpSharedSecret(m_uData.Pfn(ucsPfnSecp384r1SharedSecret),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6205" data-line-number="6205"></td>
          <td id="LC6205">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6206" data-line-number="6206"></td>
          <td id="LC6206">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6207" data-line-number="6207"></td>
          <td id="LC6207">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6208" data-line-number="6208"></td>
          <td id="LC6208">        <span>pvCryptoEcdhSecp384r1SharedSecret</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6209" data-line-number="6209"></td>
          <td id="LC6209">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6210" data-line-number="6210"></td>
          <td id="LC6210"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6211" data-line-number="6211"></td>
          <td id="LC6211"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6212" data-line-number="6212"></td>
          <td id="LC6212">
</td>
        </tr>
        <tr>
          <td id="L6213" data-line-number="6213"></td>
          <td id="LC6213"><span>Private</span> <span>Function</span> <span>pvCryptoEcdhSecp384r1UncompressKey(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPublic()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6214" data-line-number="6214"></td>
          <td id="LC6214">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdhSecp384r1UncompressKey&#34;</span></td>
        </tr>
        <tr>
          <td id="L6215" data-line-number="6215"></td>
          <td id="LC6215">
</td>
        </tr>
        <tr>
          <td id="L6216" data-line-number="6216"></td>
          <td id="LC6216">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>1</span> <span>+</span> <span>2</span> <span>*</span> <span>LNG_SECP384R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6217" data-line-number="6217"></td>
          <td id="LC6217">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpUncompressKey)</span></td>
        </tr>
        <tr>
          <td id="L6218" data-line-number="6218"></td>
          <td id="LC6218">    <span>If</span> <span>pvCallSecpUncompressKey(m_uData.Pfn(ucsPfnSecp384r1UncompressKey),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6219" data-line-number="6219"></td>
          <td id="LC6219">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6220" data-line-number="6220"></td>
          <td id="LC6220">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6221" data-line-number="6221"></td>
          <td id="LC6221">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6222" data-line-number="6222"></td>
          <td id="LC6222">    <span>pvCryptoEcdhSecp384r1UncompressKey</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6223" data-line-number="6223"></td>
          <td id="LC6223"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6224" data-line-number="6224"></td>
          <td id="LC6224"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6225" data-line-number="6225"></td>
          <td id="LC6225">
</td>
        </tr>
        <tr>
          <td id="L6226" data-line-number="6226"></td>
          <td id="LC6226"><span>Private</span> <span>Function</span> <span>pvCryptoEcdsaSecp384r1Sign(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrivKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baHash()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6227" data-line-number="6227"></td>
          <td id="LC6227">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoEcdsaSecp384r1Sign&#34;</span></td>
        </tr>
        <tr>
          <td id="L6228" data-line-number="6228"></td>
          <td id="LC6228">    <span>Const</span> <span>MAX_RETRIES</span>   <span>As</span> <span>Long</span> <span>=</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L6229" data-line-number="6229"></td>
          <td id="LC6229">    <span>Dim</span> <span>baRandom()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6230" data-line-number="6230"></td>
          <td id="LC6230">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6231" data-line-number="6231"></td>
          <td id="LC6231">    </td>
        </tr>
        <tr>
          <td id="L6232" data-line-number="6232"></td>
          <td id="LC6232">    <span>pvArrayAllocate</span> <span>baRandom,</span> <span>LNG_SECP384R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRandom&#34;</span></td>
        </tr>
        <tr>
          <td id="L6233" data-line-number="6233"></td>
          <td id="LC6233">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>2</span> <span>*</span> <span>LNG_SECP384R1_KEYSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6234" data-line-number="6234"></td>
          <td id="LC6234">    <span>For</span> <span>lIdx</span> <span>=</span> <span>1</span> <span>To</span> <span>MAX_RETRIES</span></td>
        </tr>
        <tr>
          <td id="L6235" data-line-number="6235"></td>
          <td id="LC6235">        <span>pvCryptoRandomBytes</span> <span>VarPtr(baRandom(</span><span>0</span><span>)),</span> <span>LNG_SECP384R1_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6236" data-line-number="6236"></td>
          <td id="LC6236">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpSign)</span></td>
        </tr>
        <tr>
          <td id="L6237" data-line-number="6237"></td>
          <td id="LC6237">        <span>If</span> <span>pvCallSecpSign(m_uData.Pfn(ucsPfnSecp384r1Sign),</span> <span>baPrivKey(</span><span>0</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>baRandom(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6238" data-line-number="6238"></td>
          <td id="LC6238">            <span>Exit</span> <span>For</span></td>
        </tr>
        <tr>
          <td id="L6239" data-line-number="6239"></td>
          <td id="LC6239">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6240" data-line-number="6240"></td>
          <td id="LC6240">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6241" data-line-number="6241"></td>
          <td id="LC6241">    <span>If</span> <span>lIdx</span> <span>&gt;</span> <span>MAX_RETRIES</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6242" data-line-number="6242"></td>
          <td id="LC6242">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6243" data-line-number="6243"></td>
          <td id="LC6243">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6244" data-line-number="6244"></td>
          <td id="LC6244">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6245" data-line-number="6245"></td>
          <td id="LC6245">    <span>pvCryptoEcdsaSecp384r1Sign</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6246" data-line-number="6246"></td>
          <td id="LC6246"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6247" data-line-number="6247"></td>
          <td id="LC6247"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6248" data-line-number="6248"></td>
          <td id="LC6248">
</td>
        </tr>
        <tr>
          <td id="L6249" data-line-number="6249"></td>
          <td id="LC6249"><span>Private</span> <span>Function</span> <span>pvCryptoEcdsaSecp384r1Verify(baPublic()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baHash()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baSignature()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6250" data-line-number="6250"></td>
          <td id="LC6250">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSecpVerify)</span></td>
        </tr>
        <tr>
          <td id="L6251" data-line-number="6251"></td>
          <td id="LC6251">    <span>pvCryptoEcdsaSecp384r1Verify</span> <span>=</span> <span>(pvCallSecpVerify(m_uData.Pfn(ucsPfnSecp384r1Verify),</span> <span>baPublic(</span><span>0</span><span>),</span> <span>baHash(</span><span>0</span><span>),</span> <span>baSignature(</span><span>0</span><span>))</span> <span>&lt;&gt;</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6252" data-line-number="6252"></td>
          <td id="LC6252"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6253" data-line-number="6253"></td>
          <td id="LC6253">
</td>
        </tr>
        <tr>
          <td id="L6254" data-line-number="6254"></td>
          <td id="LC6254"><span>Private</span> <span>Function</span> <span>pvCryptoHashSha1(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6255" data-line-number="6255"></td>
          <td id="LC6255">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHashSha256&#34;</span></td>
        </tr>
        <tr>
          <td id="L6256" data-line-number="6256"></td>
          <td id="LC6256">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6257" data-line-number="6257"></td>
          <td id="LC6257">    <span>Dim</span> <span>hHash</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6258" data-line-number="6258"></td>
          <td id="LC6258">    </td>
        </tr>
        <tr>
          <td id="L6259" data-line-number="6259"></td>
          <td id="LC6259">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6260" data-line-number="6260"></td>
          <td id="LC6260">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6261" data-line-number="6261"></td>
          <td id="LC6261">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6262" data-line-number="6262"></td>
          <td id="LC6262">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6263" data-line-number="6263"></td>
          <td id="LC6263">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6264" data-line-number="6264"></td>
          <td id="LC6264">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6265" data-line-number="6265"></td>
          <td id="LC6265">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6266" data-line-number="6266"></td>
          <td id="LC6266">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6267" data-line-number="6267"></td>
          <td id="LC6267">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA1_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6268" data-line-number="6268"></td>
          <td id="LC6268">    <span>If</span> <span>CryptCreateHash(m_uData.hRandomProv,</span> <span>CALG_SHA1,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>hHash)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6269" data-line-number="6269"></td>
          <td id="LC6269">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6270" data-line-number="6270"></td>
          <td id="LC6270">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6271" data-line-number="6271"></td>
          <td id="LC6271">    <span>If</span> <span>CryptHashData(hHash,</span> <span>ByVal</span> <span>lPtr,</span> <span>Size,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6272" data-line-number="6272"></td>
          <td id="LC6272">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6273" data-line-number="6273"></td>
          <td id="LC6273">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6274" data-line-number="6274"></td>
          <td id="LC6274">    <span>If</span> <span>CryptGetHashParam(hHash,</span> <span>HP_HASHVAL,</span> <span>baRetVal(</span><span>0</span><span>),</span> <span>LNG_SHA1_HASHSZ,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6275" data-line-number="6275"></td>
          <td id="LC6275">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6276" data-line-number="6276"></td>
          <td id="LC6276">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6277" data-line-number="6277"></td>
          <td id="LC6277">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6278" data-line-number="6278"></td>
          <td id="LC6278">    <span>pvCryptoHashSha1</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6279" data-line-number="6279"></td>
          <td id="LC6279"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6280" data-line-number="6280"></td>
          <td id="LC6280">    <span>If</span> <span>hHash</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6281" data-line-number="6281"></td>
          <td id="LC6281">        <span>Call</span> <span>CryptDestroyHash(hHash)</span></td>
        </tr>
        <tr>
          <td id="L6282" data-line-number="6282"></td>
          <td id="LC6282">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6283" data-line-number="6283"></td>
          <td id="LC6283"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6284" data-line-number="6284"></td>
          <td id="LC6284">
</td>
        </tr>
        <tr>
          <td id="L6285" data-line-number="6285"></td>
          <td id="LC6285"><span>Private</span> <span>Function</span> <span>pvCryptoHashSha224(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6286" data-line-number="6286"></td>
          <td id="LC6286">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHashSha224&#34;</span></td>
        </tr>
        <tr>
          <td id="L6287" data-line-number="6287"></td>
          <td id="LC6287">    <span>Dim</span> <span>lCtxPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6288" data-line-number="6288"></td>
          <td id="LC6288">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6289" data-line-number="6289"></td>
          <td id="LC6289">    <span>Static</span> <span>H224(</span><span>0</span> <span>To</span> <span>7</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6290" data-line-number="6290"></td>
          <td id="LC6290">    </td>
        </tr>
        <tr>
          <td id="L6291" data-line-number="6291"></td>
          <td id="LC6291">    <span>If</span> <span>H224(</span><span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6292" data-line-number="6292"></td>
          <td id="LC6292">        <span>H224(</span><span>0</span><span>)</span> <span>=</span> <span>&amp;HC1059ED8</span></td>
        </tr>
        <tr>
          <td id="L6293" data-line-number="6293"></td>
          <td id="LC6293">        <span>H224(</span><span>1</span><span>)</span> <span>=</span> <span>&amp;H367CD507</span></td>
        </tr>
        <tr>
          <td id="L6294" data-line-number="6294"></td>
          <td id="LC6294">        <span>H224(</span><span>2</span><span>)</span> <span>=</span> <span>&amp;H3070DD17</span></td>
        </tr>
        <tr>
          <td id="L6295" data-line-number="6295"></td>
          <td id="LC6295">        <span>H224(</span><span>3</span><span>)</span> <span>=</span> <span>&amp;HF70E5939</span></td>
        </tr>
        <tr>
          <td id="L6296" data-line-number="6296"></td>
          <td id="LC6296">        <span>H224(</span><span>4</span><span>)</span> <span>=</span> <span>&amp;HFFC00B31</span></td>
        </tr>
        <tr>
          <td id="L6297" data-line-number="6297"></td>
          <td id="LC6297">        <span>H224(</span><span>5</span><span>)</span> <span>=</span> <span>&amp;H68581511</span></td>
        </tr>
        <tr>
          <td id="L6298" data-line-number="6298"></td>
          <td id="LC6298">        <span>H224(</span><span>6</span><span>)</span> <span>=</span> <span>&amp;H64F98FA7</span></td>
        </tr>
        <tr>
          <td id="L6299" data-line-number="6299"></td>
          <td id="LC6299">        <span>H224(</span><span>7</span><span>)</span> <span>=</span> <span>&amp;HBEFA4FA4</span></td>
        </tr>
        <tr>
          <td id="L6300" data-line-number="6300"></td>
          <td id="LC6300">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6301" data-line-number="6301"></td>
          <td id="LC6301">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6302" data-line-number="6302"></td>
          <td id="LC6302">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6303" data-line-number="6303"></td>
          <td id="LC6303">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6304" data-line-number="6304"></td>
          <td id="LC6304">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6305" data-line-number="6305"></td>
          <td id="LC6305">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6306" data-line-number="6306"></td>
          <td id="LC6306">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6307" data-line-number="6307"></td>
          <td id="LC6307">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6308" data-line-number="6308"></td>
          <td id="LC6308">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6309" data-line-number="6309"></td>
          <td id="LC6309">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA256_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6310" data-line-number="6310"></td>
          <td id="LC6310">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6311" data-line-number="6311"></td>
          <td id="LC6311">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6312" data-line-number="6312"></td>
          <td id="LC6312">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6313" data-line-number="6313"></td>
          <td id="LC6313">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6314" data-line-number="6314"></td>
          <td id="LC6314">        <span>lCtxPtr</span> <span>=</span> <span>VarPtr(.HashCtx(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6315" data-line-number="6315"></td>
          <td id="LC6315">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha256Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6316" data-line-number="6316"></td>
          <td id="LC6316">        <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>lCtxPtr,</span> <span>H224(</span><span>0</span><span>),</span> <span>32</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6317" data-line-number="6317"></td>
          <td id="LC6317">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha256Update),</span> <span>lCtxPtr,</span> <span>lPtr,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6318" data-line-number="6318"></td>
          <td id="LC6318">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha256Final),</span> <span>lCtxPtr,</span> <span>baRetVal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6319" data-line-number="6319"></td>
          <td id="LC6319">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6320" data-line-number="6320"></td>
          <td id="LC6320">    <span>pvArrayReallocate</span> <span>baRetVal,</span> <span>LNG_SHA224_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6321" data-line-number="6321"></td>
          <td id="LC6321">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6322" data-line-number="6322"></td>
          <td id="LC6322">    <span>pvCryptoHashSha224</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6323" data-line-number="6323"></td>
          <td id="LC6323"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6324" data-line-number="6324"></td>
          <td id="LC6324">
</td>
        </tr>
        <tr>
          <td id="L6325" data-line-number="6325"></td>
          <td id="LC6325"><span>Private</span> <span>Function</span> <span>pvCryptoHashSha256(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6326" data-line-number="6326"></td>
          <td id="LC6326">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHashSha256&#34;</span></td>
        </tr>
        <tr>
          <td id="L6327" data-line-number="6327"></td>
          <td id="LC6327">    <span>Dim</span> <span>lCtxPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6328" data-line-number="6328"></td>
          <td id="LC6328">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6329" data-line-number="6329"></td>
          <td id="LC6329">    </td>
        </tr>
        <tr>
          <td id="L6330" data-line-number="6330"></td>
          <td id="LC6330">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6331" data-line-number="6331"></td>
          <td id="LC6331">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6332" data-line-number="6332"></td>
          <td id="LC6332">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6333" data-line-number="6333"></td>
          <td id="LC6333">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6334" data-line-number="6334"></td>
          <td id="LC6334">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6335" data-line-number="6335"></td>
          <td id="LC6335">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6336" data-line-number="6336"></td>
          <td id="LC6336">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6337" data-line-number="6337"></td>
          <td id="LC6337">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6338" data-line-number="6338"></td>
          <td id="LC6338">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA256_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6339" data-line-number="6339"></td>
          <td id="LC6339">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6340" data-line-number="6340"></td>
          <td id="LC6340">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6341" data-line-number="6341"></td>
          <td id="LC6341">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6342" data-line-number="6342"></td>
          <td id="LC6342">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6343" data-line-number="6343"></td>
          <td id="LC6343">        <span>lCtxPtr</span> <span>=</span> <span>VarPtr(.HashCtx(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6344" data-line-number="6344"></td>
          <td id="LC6344">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha256Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6345" data-line-number="6345"></td>
          <td id="LC6345">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha256Update),</span> <span>lCtxPtr,</span> <span>lPtr,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6346" data-line-number="6346"></td>
          <td id="LC6346">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha256Final),</span> <span>lCtxPtr,</span> <span>baRetVal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6347" data-line-number="6347"></td>
          <td id="LC6347">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6348" data-line-number="6348"></td>
          <td id="LC6348">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6349" data-line-number="6349"></td>
          <td id="LC6349">    <span>pvCryptoHashSha256</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6350" data-line-number="6350"></td>
          <td id="LC6350"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6351" data-line-number="6351"></td>
          <td id="LC6351">
</td>
        </tr>
        <tr>
          <td id="L6352" data-line-number="6352"></td>
          <td id="LC6352"><span>Private</span> <span>Function</span> <span>pvCryptoHashSha384(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6353" data-line-number="6353"></td>
          <td id="LC6353">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHashSha384&#34;</span></td>
        </tr>
        <tr>
          <td id="L6354" data-line-number="6354"></td>
          <td id="LC6354">    <span>Dim</span> <span>lCtxPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6355" data-line-number="6355"></td>
          <td id="LC6355">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6356" data-line-number="6356"></td>
          <td id="LC6356">    </td>
        </tr>
        <tr>
          <td id="L6357" data-line-number="6357"></td>
          <td id="LC6357">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6358" data-line-number="6358"></td>
          <td id="LC6358">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6359" data-line-number="6359"></td>
          <td id="LC6359">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6360" data-line-number="6360"></td>
          <td id="LC6360">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6361" data-line-number="6361"></td>
          <td id="LC6361">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6362" data-line-number="6362"></td>
          <td id="LC6362">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6363" data-line-number="6363"></td>
          <td id="LC6363">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6364" data-line-number="6364"></td>
          <td id="LC6364">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6365" data-line-number="6365"></td>
          <td id="LC6365">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA384_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6366" data-line-number="6366"></td>
          <td id="LC6366">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6367" data-line-number="6367"></td>
          <td id="LC6367">        <span>lCtxPtr</span> <span>=</span> <span>VarPtr(.HashCtx(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6368" data-line-number="6368"></td>
          <td id="LC6368">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6369" data-line-number="6369"></td>
          <td id="LC6369">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6370" data-line-number="6370"></td>
          <td id="LC6370">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6371" data-line-number="6371"></td>
          <td id="LC6371">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha384Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6372" data-line-number="6372"></td>
          <td id="LC6372">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha384Update),</span> <span>lCtxPtr,</span> <span>lPtr,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6373" data-line-number="6373"></td>
          <td id="LC6373">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha384Final),</span> <span>lCtxPtr,</span> <span>baRetVal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6374" data-line-number="6374"></td>
          <td id="LC6374">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6375" data-line-number="6375"></td>
          <td id="LC6375">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6376" data-line-number="6376"></td>
          <td id="LC6376">    <span>pvCryptoHashSha384</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6377" data-line-number="6377"></td>
          <td id="LC6377"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6378" data-line-number="6378"></td>
          <td id="LC6378">
</td>
        </tr>
        <tr>
          <td id="L6379" data-line-number="6379"></td>
          <td id="LC6379"><span>Private</span> <span>Function</span> <span>pvCryptoHashSha512(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6380" data-line-number="6380"></td>
          <td id="LC6380">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHashSha512&#34;</span></td>
        </tr>
        <tr>
          <td id="L6381" data-line-number="6381"></td>
          <td id="LC6381">    <span>Dim</span> <span>lCtxPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6382" data-line-number="6382"></td>
          <td id="LC6382">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6383" data-line-number="6383"></td>
          <td id="LC6383">    </td>
        </tr>
        <tr>
          <td id="L6384" data-line-number="6384"></td>
          <td id="LC6384">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6385" data-line-number="6385"></td>
          <td id="LC6385">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6386" data-line-number="6386"></td>
          <td id="LC6386">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6387" data-line-number="6387"></td>
          <td id="LC6387">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6388" data-line-number="6388"></td>
          <td id="LC6388">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6389" data-line-number="6389"></td>
          <td id="LC6389">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6390" data-line-number="6390"></td>
          <td id="LC6390">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6391" data-line-number="6391"></td>
          <td id="LC6391">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6392" data-line-number="6392"></td>
          <td id="LC6392">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA512_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6393" data-line-number="6393"></td>
          <td id="LC6393">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6394" data-line-number="6394"></td>
          <td id="LC6394">        <span>lCtxPtr</span> <span>=</span> <span>VarPtr(.HashCtx(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6395" data-line-number="6395"></td>
          <td id="LC6395">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6396" data-line-number="6396"></td>
          <td id="LC6396">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6397" data-line-number="6397"></td>
          <td id="LC6397">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6398" data-line-number="6398"></td>
          <td id="LC6398">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha512Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6399" data-line-number="6399"></td>
          <td id="LC6399">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha512Update),</span> <span>lCtxPtr,</span> <span>lPtr,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6400" data-line-number="6400"></td>
          <td id="LC6400">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha512Final),</span> <span>lCtxPtr,</span> <span>baRetVal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6401" data-line-number="6401"></td>
          <td id="LC6401">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6402" data-line-number="6402"></td>
          <td id="LC6402">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6403" data-line-number="6403"></td>
          <td id="LC6403">    <span>pvCryptoHashSha512</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6404" data-line-number="6404"></td>
          <td id="LC6404"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6405" data-line-number="6405"></td>
          <td id="LC6405">
</td>
        </tr>
        <tr>
          <td id="L6406" data-line-number="6406"></td>
          <td id="LC6406"><span>Private</span> <span>Function</span> <span>pvCryptoHmacSha1(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6407" data-line-number="6407"></td>
          <td id="LC6407">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHmacSha1&#34;</span></td>
        </tr>
        <tr>
          <td id="L6408" data-line-number="6408"></td>
          <td id="LC6408">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6409" data-line-number="6409"></td>
          <td id="LC6409">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6410" data-line-number="6410"></td>
          <td id="LC6410">    <span>Dim</span> <span>hHash</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6411" data-line-number="6411"></td>
          <td id="LC6411">    </td>
        </tr>
        <tr>
          <td id="L6412" data-line-number="6412"></td>
          <td id="LC6412">    <span>Debug.Assert</span> <span>UBound(baKey)</span> <span>&lt;</span> <span>LNG_SHA1_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6413" data-line-number="6413"></td>
          <td id="LC6413">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6414" data-line-number="6414"></td>
          <td id="LC6414">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6415" data-line-number="6415"></td>
          <td id="LC6415">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6416" data-line-number="6416"></td>
          <td id="LC6416">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6417" data-line-number="6417"></td>
          <td id="LC6417">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6418" data-line-number="6418"></td>
          <td id="LC6418">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6419" data-line-number="6419"></td>
          <td id="LC6419">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6420" data-line-number="6420"></td>
          <td id="LC6420">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6421" data-line-number="6421"></td>
          <td id="LC6421">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6422" data-line-number="6422"></td>
          <td id="LC6422">        <span>&#39;-- inner hash</span></td>
        </tr>
        <tr>
          <td id="L6423" data-line-number="6423"></td>
          <td id="LC6423">        <span>Call</span> <span>FillMemory(.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA1_BLOCKSZ,</span> <span>LNG_HMAC_INNER_PAD)</span></td>
        </tr>
        <tr>
          <td id="L6424" data-line-number="6424"></td>
          <td id="LC6424">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baKey)</span></td>
        </tr>
        <tr>
          <td id="L6425" data-line-number="6425"></td>
          <td id="LC6425">            <span>.HashPad(lIdx)</span> <span>=</span> <span>baKey(lIdx)</span> <span>Xor</span> <span>LNG_HMAC_INNER_PAD</span></td>
        </tr>
        <tr>
          <td id="L6426" data-line-number="6426"></td>
          <td id="LC6426">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6427" data-line-number="6427"></td>
          <td id="LC6427">        <span>If</span> <span>CryptCreateHash(m_uData.hRandomProv,</span> <span>CALG_SHA1,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>hHash)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6428" data-line-number="6428"></td>
          <td id="LC6428">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6429" data-line-number="6429"></td>
          <td id="LC6429">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6430" data-line-number="6430"></td>
          <td id="LC6430">        <span>If</span> <span>CryptHashData(hHash,</span> <span>.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA1_BLOCKSZ,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6431" data-line-number="6431"></td>
          <td id="LC6431">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6432" data-line-number="6432"></td>
          <td id="LC6432">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6433" data-line-number="6433"></td>
          <td id="LC6433">        <span>If</span> <span>CryptHashData(hHash,</span> <span>ByVal</span> <span>lPtr,</span> <span>Size,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6434" data-line-number="6434"></td>
          <td id="LC6434">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6435" data-line-number="6435"></td>
          <td id="LC6435">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6436" data-line-number="6436"></td>
          <td id="LC6436">        <span>If</span> <span>CryptGetHashParam(hHash,</span> <span>HP_HASHVAL,</span> <span>.HashFinal(</span><span>0</span><span>),</span> <span>LNG_SHA1_HASHSZ,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6437" data-line-number="6437"></td>
          <td id="LC6437">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6438" data-line-number="6438"></td>
          <td id="LC6438">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6439" data-line-number="6439"></td>
          <td id="LC6439">        <span>Call</span> <span>CryptDestroyHash(hHash)</span></td>
        </tr>
        <tr>
          <td id="L6440" data-line-number="6440"></td>
          <td id="LC6440">        <span>hHash</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L6441" data-line-number="6441"></td>
          <td id="LC6441">        <span>&#39;-- outer hash</span></td>
        </tr>
        <tr>
          <td id="L6442" data-line-number="6442"></td>
          <td id="LC6442">        <span>Call</span> <span>FillMemory(.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA1_BLOCKSZ,</span> <span>LNG_HMAC_OUTER_PAD)</span></td>
        </tr>
        <tr>
          <td id="L6443" data-line-number="6443"></td>
          <td id="LC6443">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baKey)</span></td>
        </tr>
        <tr>
          <td id="L6444" data-line-number="6444"></td>
          <td id="LC6444">            <span>.HashPad(lIdx)</span> <span>=</span> <span>baKey(lIdx)</span> <span>Xor</span> <span>LNG_HMAC_OUTER_PAD</span></td>
        </tr>
        <tr>
          <td id="L6445" data-line-number="6445"></td>
          <td id="LC6445">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6446" data-line-number="6446"></td>
          <td id="LC6446">        <span>If</span> <span>CryptCreateHash(m_uData.hRandomProv,</span> <span>CALG_SHA1,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>hHash)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6447" data-line-number="6447"></td>
          <td id="LC6447">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6448" data-line-number="6448"></td>
          <td id="LC6448">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6449" data-line-number="6449"></td>
          <td id="LC6449">        <span>If</span> <span>CryptHashData(hHash,</span> <span>.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA1_BLOCKSZ,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6450" data-line-number="6450"></td>
          <td id="LC6450">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6451" data-line-number="6451"></td>
          <td id="LC6451">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6452" data-line-number="6452"></td>
          <td id="LC6452">        <span>If</span> <span>CryptHashData(hHash,</span> <span>.HashFinal(</span><span>0</span><span>),</span> <span>LNG_SHA1_HASHSZ,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6453" data-line-number="6453"></td>
          <td id="LC6453">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6454" data-line-number="6454"></td>
          <td id="LC6454">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6455" data-line-number="6455"></td>
          <td id="LC6455">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA1_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6456" data-line-number="6456"></td>
          <td id="LC6456">        <span>If</span> <span>CryptGetHashParam(hHash,</span> <span>HP_HASHVAL,</span> <span>baRetVal(</span><span>0</span><span>),</span> <span>LNG_SHA1_HASHSZ,</span> <span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6457" data-line-number="6457"></td>
          <td id="LC6457">            <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6458" data-line-number="6458"></td>
          <td id="LC6458">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6459" data-line-number="6459"></td>
          <td id="LC6459">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6460" data-line-number="6460"></td>
          <td id="LC6460">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6461" data-line-number="6461"></td>
          <td id="LC6461">    <span>pvCryptoHmacSha1</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6462" data-line-number="6462"></td>
          <td id="LC6462"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6463" data-line-number="6463"></td>
          <td id="LC6463">    <span>If</span> <span>hHash</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6464" data-line-number="6464"></td>
          <td id="LC6464">        <span>Call</span> <span>CryptDestroyHash(hHash)</span></td>
        </tr>
        <tr>
          <td id="L6465" data-line-number="6465"></td>
          <td id="LC6465">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6466" data-line-number="6466"></td>
          <td id="LC6466"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6467" data-line-number="6467"></td>
          <td id="LC6467">
</td>
        </tr>
        <tr>
          <td id="L6468" data-line-number="6468"></td>
          <td id="LC6468"><span>Private</span> <span>Function</span> <span>pvCryptoHmacSha256(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6469" data-line-number="6469"></td>
          <td id="LC6469">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHmacSha256&#34;</span></td>
        </tr>
        <tr>
          <td id="L6470" data-line-number="6470"></td>
          <td id="LC6470">    <span>Dim</span> <span>lCtxPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6471" data-line-number="6471"></td>
          <td id="LC6471">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6472" data-line-number="6472"></td>
          <td id="LC6472">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6473" data-line-number="6473"></td>
          <td id="LC6473">    </td>
        </tr>
        <tr>
          <td id="L6474" data-line-number="6474"></td>
          <td id="LC6474">    <span>Debug.Assert</span> <span>UBound(baKey)</span> <span>&lt;</span> <span>LNG_SHA256_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6475" data-line-number="6475"></td>
          <td id="LC6475">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6476" data-line-number="6476"></td>
          <td id="LC6476">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6477" data-line-number="6477"></td>
          <td id="LC6477">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6478" data-line-number="6478"></td>
          <td id="LC6478">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6479" data-line-number="6479"></td>
          <td id="LC6479">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6480" data-line-number="6480"></td>
          <td id="LC6480">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6481" data-line-number="6481"></td>
          <td id="LC6481">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6482" data-line-number="6482"></td>
          <td id="LC6482">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6483" data-line-number="6483"></td>
          <td id="LC6483">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6484" data-line-number="6484"></td>
          <td id="LC6484">        <span>lCtxPtr</span> <span>=</span> <span>VarPtr(.HashCtx(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6485" data-line-number="6485"></td>
          <td id="LC6485">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA256_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6486" data-line-number="6486"></td>
          <td id="LC6486">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6487" data-line-number="6487"></td>
          <td id="LC6487">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6488" data-line-number="6488"></td>
          <td id="LC6488">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6489" data-line-number="6489"></td>
          <td id="LC6489">        <span>&#39;-- inner hash</span></td>
        </tr>
        <tr>
          <td id="L6490" data-line-number="6490"></td>
          <td id="LC6490">        <span>Call</span> <span>FillMemory(.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA256_BLOCKSZ,</span> <span>LNG_HMAC_INNER_PAD)</span></td>
        </tr>
        <tr>
          <td id="L6491" data-line-number="6491"></td>
          <td id="LC6491">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baKey)</span></td>
        </tr>
        <tr>
          <td id="L6492" data-line-number="6492"></td>
          <td id="LC6492">            <span>.HashPad(lIdx)</span> <span>=</span> <span>baKey(lIdx)</span> <span>Xor</span> <span>LNG_HMAC_INNER_PAD</span></td>
        </tr>
        <tr>
          <td id="L6493" data-line-number="6493"></td>
          <td id="LC6493">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6494" data-line-number="6494"></td>
          <td id="LC6494">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha256Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6495" data-line-number="6495"></td>
          <td id="LC6495">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha256Update),</span> <span>lCtxPtr,</span> <span>VarPtr(.HashPad(</span><span>0</span><span>)),</span> <span>LNG_SHA256_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6496" data-line-number="6496"></td>
          <td id="LC6496">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha256Update),</span> <span>lCtxPtr,</span> <span>lPtr,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6497" data-line-number="6497"></td>
          <td id="LC6497">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha256Final),</span> <span>lCtxPtr,</span> <span>.HashFinal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6498" data-line-number="6498"></td>
          <td id="LC6498">        <span>&#39;-- outer hash</span></td>
        </tr>
        <tr>
          <td id="L6499" data-line-number="6499"></td>
          <td id="LC6499">        <span>Call</span> <span>FillMemory(.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA256_BLOCKSZ,</span> <span>LNG_HMAC_OUTER_PAD)</span></td>
        </tr>
        <tr>
          <td id="L6500" data-line-number="6500"></td>
          <td id="LC6500">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baKey)</span></td>
        </tr>
        <tr>
          <td id="L6501" data-line-number="6501"></td>
          <td id="LC6501">            <span>.HashPad(lIdx)</span> <span>=</span> <span>baKey(lIdx)</span> <span>Xor</span> <span>LNG_HMAC_OUTER_PAD</span></td>
        </tr>
        <tr>
          <td id="L6502" data-line-number="6502"></td>
          <td id="LC6502">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6503" data-line-number="6503"></td>
          <td id="LC6503">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha256Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6504" data-line-number="6504"></td>
          <td id="LC6504">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha256Update),</span> <span>lCtxPtr,</span> <span>VarPtr(.HashPad(</span><span>0</span><span>)),</span> <span>LNG_SHA256_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6505" data-line-number="6505"></td>
          <td id="LC6505">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha256Update),</span> <span>lCtxPtr,</span> <span>VarPtr(.HashFinal(</span><span>0</span><span>)),</span> <span>LNG_SHA256_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L6506" data-line-number="6506"></td>
          <td id="LC6506">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha256Final),</span> <span>lCtxPtr,</span> <span>baRetVal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6507" data-line-number="6507"></td>
          <td id="LC6507">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6508" data-line-number="6508"></td>
          <td id="LC6508">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6509" data-line-number="6509"></td>
          <td id="LC6509">    <span>pvCryptoHmacSha256</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6510" data-line-number="6510"></td>
          <td id="LC6510"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6511" data-line-number="6511"></td>
          <td id="LC6511">
</td>
        </tr>
        <tr>
          <td id="L6512" data-line-number="6512"></td>
          <td id="LC6512"><span>Private</span> <span>Function</span> <span>pvCryptoHmacSha384(baRetVal()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baInput()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6513" data-line-number="6513"></td>
          <td id="LC6513">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoHmacSha384&#34;</span></td>
        </tr>
        <tr>
          <td id="L6514" data-line-number="6514"></td>
          <td id="LC6514">    <span>Dim</span> <span>lCtxPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6515" data-line-number="6515"></td>
          <td id="LC6515">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6516" data-line-number="6516"></td>
          <td id="LC6516">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6517" data-line-number="6517"></td>
          <td id="LC6517">    </td>
        </tr>
        <tr>
          <td id="L6518" data-line-number="6518"></td>
          <td id="LC6518">    <span>Debug.Assert</span> <span>UBound(baKey)</span> <span>&lt;</span> <span>LNG_SHA384_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6519" data-line-number="6519"></td>
          <td id="LC6519">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6520" data-line-number="6520"></td>
          <td id="LC6520">        <span>Size</span> <span>=</span> <span>pvArraySize(baInput)</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6521" data-line-number="6521"></td>
          <td id="LC6521">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6522" data-line-number="6522"></td>
          <td id="LC6522">        <span>Debug.Assert</span> <span>pvArraySize(baInput)</span> <span>&gt;=</span> <span>Pos</span> <span>+</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6523" data-line-number="6523"></td>
          <td id="LC6523">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6524" data-line-number="6524"></td>
          <td id="LC6524">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6525" data-line-number="6525"></td>
          <td id="LC6525">        <span>lPtr</span> <span>=</span> <span>VarPtr(baInput(Pos))</span></td>
        </tr>
        <tr>
          <td id="L6526" data-line-number="6526"></td>
          <td id="LC6526">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6527" data-line-number="6527"></td>
          <td id="LC6527">    <span>With</span> <span>m_uData</span></td>
        </tr>
        <tr>
          <td id="L6528" data-line-number="6528"></td>
          <td id="LC6528">        <span>lCtxPtr</span> <span>=</span> <span>VarPtr(.HashCtx(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6529" data-line-number="6529"></td>
          <td id="LC6529">        <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>LNG_SHA384_HASHSZ,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6530" data-line-number="6530"></td>
          <td id="LC6530">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Init)</span></td>
        </tr>
        <tr>
          <td id="L6531" data-line-number="6531"></td>
          <td id="LC6531">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Update)</span></td>
        </tr>
        <tr>
          <td id="L6532" data-line-number="6532"></td>
          <td id="LC6532">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallSha2Final)</span></td>
        </tr>
        <tr>
          <td id="L6533" data-line-number="6533"></td>
          <td id="LC6533">        <span>&#39;-- inner hash</span></td>
        </tr>
        <tr>
          <td id="L6534" data-line-number="6534"></td>
          <td id="LC6534">        <span>Call</span> <span>FillMemory(.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA384_BLOCKSZ,</span> <span>LNG_HMAC_INNER_PAD)</span></td>
        </tr>
        <tr>
          <td id="L6535" data-line-number="6535"></td>
          <td id="LC6535">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baKey)</span></td>
        </tr>
        <tr>
          <td id="L6536" data-line-number="6536"></td>
          <td id="LC6536">            <span>.HashPad(lIdx)</span> <span>=</span> <span>baKey(lIdx)</span> <span>Xor</span> <span>LNG_HMAC_INNER_PAD</span></td>
        </tr>
        <tr>
          <td id="L6537" data-line-number="6537"></td>
          <td id="LC6537">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6538" data-line-number="6538"></td>
          <td id="LC6538">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha384Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6539" data-line-number="6539"></td>
          <td id="LC6539">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha384Update),</span> <span>lCtxPtr,</span> <span>VarPtr(.HashPad(</span><span>0</span><span>)),</span> <span>LNG_SHA384_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6540" data-line-number="6540"></td>
          <td id="LC6540">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha384Update),</span> <span>lCtxPtr,</span> <span>lPtr,</span> <span>Size</span></td>
        </tr>
        <tr>
          <td id="L6541" data-line-number="6541"></td>
          <td id="LC6541">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha384Final),</span> <span>lCtxPtr,</span> <span>.HashFinal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6542" data-line-number="6542"></td>
          <td id="LC6542">        <span>&#39;-- outer hash</span></td>
        </tr>
        <tr>
          <td id="L6543" data-line-number="6543"></td>
          <td id="LC6543">        <span>Call</span> <span>FillMemory(.HashPad(</span><span>0</span><span>),</span> <span>LNG_SHA384_BLOCKSZ,</span> <span>LNG_HMAC_OUTER_PAD)</span></td>
        </tr>
        <tr>
          <td id="L6544" data-line-number="6544"></td>
          <td id="LC6544">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baKey)</span></td>
        </tr>
        <tr>
          <td id="L6545" data-line-number="6545"></td>
          <td id="LC6545">            <span>.HashPad(lIdx)</span> <span>=</span> <span>baKey(lIdx)</span> <span>Xor</span> <span>LNG_HMAC_OUTER_PAD</span></td>
        </tr>
        <tr>
          <td id="L6546" data-line-number="6546"></td>
          <td id="LC6546">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6547" data-line-number="6547"></td>
          <td id="LC6547">        <span>pvCallSha2Init</span> <span>.Pfn(ucsPfnSha384Init),</span> <span>lCtxPtr</span></td>
        </tr>
        <tr>
          <td id="L6548" data-line-number="6548"></td>
          <td id="LC6548">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha384Update),</span> <span>lCtxPtr,</span> <span>VarPtr(.HashPad(</span><span>0</span><span>)),</span> <span>LNG_SHA384_BLOCKSZ</span></td>
        </tr>
        <tr>
          <td id="L6549" data-line-number="6549"></td>
          <td id="LC6549">        <span>pvCallSha2Update</span> <span>.Pfn(ucsPfnSha384Update),</span> <span>lCtxPtr,</span> <span>VarPtr(.HashFinal(</span><span>0</span><span>)),</span> <span>LNG_SHA384_HASHSZ</span></td>
        </tr>
        <tr>
          <td id="L6550" data-line-number="6550"></td>
          <td id="LC6550">        <span>pvCallSha2Final</span> <span>.Pfn(ucsPfnSha384Final),</span> <span>lCtxPtr,</span> <span>baRetVal(</span><span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6551" data-line-number="6551"></td>
          <td id="LC6551">    <span>End</span> <span>With</span></td>
        </tr>
        <tr>
          <td id="L6552" data-line-number="6552"></td>
          <td id="LC6552">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6553" data-line-number="6553"></td>
          <td id="LC6553">    <span>pvCryptoHmacSha384</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6554" data-line-number="6554"></td>
          <td id="LC6554"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6555" data-line-number="6555"></td>
          <td id="LC6555">
</td>
        </tr>
        <tr>
          <td id="L6556" data-line-number="6556"></td>
          <td id="LC6556"><span>Private</span> <span>Function</span> <span>pvCryptoBulkChacha20Poly1305Encrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6557" data-line-number="6557"></td>
          <td id="LC6557">            <span>baNonce()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6558" data-line-number="6558"></td>
          <td id="LC6558">            <span>baAad()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lAadPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lAadSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6559" data-line-number="6559"></td>
          <td id="LC6559">            <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6560" data-line-number="6560"></td>
          <td id="LC6560">    <span>Dim</span> <span>lAadPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6561" data-line-number="6561"></td>
          <td id="LC6561">    </td>
        </tr>
        <tr>
          <td id="L6562" data-line-number="6562"></td>
          <td id="LC6562">    <span>Debug.Assert</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_CHACHA20POLY1305_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L6563" data-line-number="6563"></td>
          <td id="LC6563">    <span>Debug.Assert</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_CHACHA20_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6564" data-line-number="6564"></td>
          <td id="LC6564">    <span>Debug.Assert</span> <span>pvArraySize(baBuffer)</span> <span>&gt;=</span> <span>lPos</span> <span>+</span> <span>lSize</span> <span>+</span> <span>LNG_CHACHA20POLY1305_TAGSZ</span></td>
        </tr>
        <tr>
          <td id="L6565" data-line-number="6565"></td>
          <td id="LC6565">    <span>If</span> <span>lAadSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6566" data-line-number="6566"></td>
          <td id="LC6566">        <span>lAadPtr</span> <span>=</span> <span>VarPtr(baAad(lAadPos))</span></td>
        </tr>
        <tr>
          <td id="L6567" data-line-number="6567"></td>
          <td id="LC6567">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6568" data-line-number="6568"></td>
          <td id="LC6568">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallChacha20Poly1305Encrypt)</span></td>
        </tr>
        <tr>
          <td id="L6569" data-line-number="6569"></td>
          <td id="LC6569">    <span>Call</span> <span>pvCallChacha20Poly1305Encrypt(m_uData.Pfn(ucsPfnChacha20Poly1305Encrypt),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6570" data-line-number="6570"></td>
          <td id="LC6570">            <span>baKey(</span><span>0</span><span>),</span> <span>baNonce(</span><span>0</span><span>),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6571" data-line-number="6571"></td>
          <td id="LC6571">            <span>lAadPtr,</span> <span>lAadSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6572" data-line-number="6572"></td>
          <td id="LC6572">            <span>baBuffer(lPos),</span> <span>lSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6573" data-line-number="6573"></td>
          <td id="LC6573">            <span>baBuffer(lPos),</span> <span>baBuffer(lPos</span> <span>+</span> <span>lSize))</span></td>
        </tr>
        <tr>
          <td id="L6574" data-line-number="6574"></td>
          <td id="LC6574">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6575" data-line-number="6575"></td>
          <td id="LC6575">    <span>pvCryptoBulkChacha20Poly1305Encrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6576" data-line-number="6576"></td>
          <td id="LC6576"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6577" data-line-number="6577"></td>
          <td id="LC6577">
</td>
        </tr>
        <tr>
          <td id="L6578" data-line-number="6578"></td>
          <td id="LC6578"><span>Private</span> <span>Function</span> <span>pvCryptoBulkChacha20Poly1305Decrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6579" data-line-number="6579"></td>
          <td id="LC6579">            <span>baNonce()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6580" data-line-number="6580"></td>
          <td id="LC6580">            <span>baAad()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lAadPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lAadSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6581" data-line-number="6581"></td>
          <td id="LC6581">            <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6582" data-line-number="6582"></td>
          <td id="LC6582">    <span>Debug.Assert</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_CHACHA20POLY1305_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L6583" data-line-number="6583"></td>
          <td id="LC6583">    <span>Debug.Assert</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_CHACHA20_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6584" data-line-number="6584"></td>
          <td id="LC6584">    <span>Debug.Assert</span> <span>pvArraySize(baBuffer)</span> <span>&gt;=</span> <span>lPos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L6585" data-line-number="6585"></td>
          <td id="LC6585">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallChacha20Poly1305Decrypt)</span></td>
        </tr>
        <tr>
          <td id="L6586" data-line-number="6586"></td>
          <td id="LC6586">    <span>If</span> <span>pvCallChacha20Poly1305Decrypt(m_uData.Pfn(ucsPfnChacha20Poly1305Decrypt),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6587" data-line-number="6587"></td>
          <td id="LC6587">            <span>baKey(</span><span>0</span><span>),</span> <span>baNonce(</span><span>0</span><span>),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6588" data-line-number="6588"></td>
          <td id="LC6588">            <span>baAad(lAadPos),</span> <span>lAadSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6589" data-line-number="6589"></td>
          <td id="LC6589">            <span>baBuffer(lPos),</span> <span>lSize</span> <span>-</span> <span>LNG_CHACHA20POLY1305_TAGSZ,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6590" data-line-number="6590"></td>
          <td id="LC6590">            <span>baBuffer(lPos</span> <span>+</span> <span>lSize</span> <span>-</span> <span>LNG_CHACHA20POLY1305_TAGSZ),</span> <span>baBuffer(lPos))</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6591" data-line-number="6591"></td>
          <td id="LC6591">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6592" data-line-number="6592"></td>
          <td id="LC6592">        <span>pvCryptoBulkChacha20Poly1305Decrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6593" data-line-number="6593"></td>
          <td id="LC6593">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6594" data-line-number="6594"></td>
          <td id="LC6594"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6595" data-line-number="6595"></td>
          <td id="LC6595">
</td>
        </tr>
        <tr>
          <td id="L6596" data-line-number="6596"></td>
          <td id="LC6596"><span>Private</span> <span>Function</span> <span>pvCryptoBulkAesGcmEncrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6597" data-line-number="6597"></td>
          <td id="LC6597">            <span>baNonce()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6598" data-line-number="6598"></td>
          <td id="LC6598">            <span>baAad()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lAadPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lAadSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6599" data-line-number="6599"></td>
          <td id="LC6599">            <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6600" data-line-number="6600"></td>
          <td id="LC6600">    <span>Dim</span> <span>lAadPtr</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6601" data-line-number="6601"></td>
          <td id="LC6601">    </td>
        </tr>
        <tr>
          <td id="L6602" data-line-number="6602"></td>
          <td id="LC6602">    <span>Debug.Assert</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_AESGCM_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L6603" data-line-number="6603"></td>
          <td id="LC6603">    <span>Debug.Assert</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES128_KEYSZ</span> <span>Or</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6604" data-line-number="6604"></td>
          <td id="LC6604">    <span>Debug.Assert</span> <span>pvArraySize(baBuffer)</span> <span>&gt;=</span> <span>lPos</span> <span>+</span> <span>lSize</span> <span>+</span> <span>LNG_AESGCM_TAGSZ</span></td>
        </tr>
        <tr>
          <td id="L6605" data-line-number="6605"></td>
          <td id="LC6605">    <span>If</span> <span>lAadSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6606" data-line-number="6606"></td>
          <td id="LC6606">        <span>lAadPtr</span> <span>=</span> <span>VarPtr(baAad(lAadPos))</span></td>
        </tr>
        <tr>
          <td id="L6607" data-line-number="6607"></td>
          <td id="LC6607">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6608" data-line-number="6608"></td>
          <td id="LC6608">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesGcmEncrypt)</span></td>
        </tr>
        <tr>
          <td id="L6609" data-line-number="6609"></td>
          <td id="LC6609">    <span>Call</span> <span>pvCallAesGcmEncrypt(m_uData.Pfn(ucsPfnAesGcmEncrypt),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6610" data-line-number="6610"></td>
          <td id="LC6610">            <span>baBuffer(lPos),</span> <span>baBuffer(lPos</span> <span>+</span> <span>lSize),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6611" data-line-number="6611"></td>
          <td id="LC6611">            <span>baBuffer(lPos),</span> <span>lSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6612" data-line-number="6612"></td>
          <td id="LC6612">            <span>lAadPtr,</span> <span>lAadSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6613" data-line-number="6613"></td>
          <td id="LC6613">            <span>baNonce(</span><span>0</span><span>),</span> <span>baKey(</span><span>0</span><span>),</span> <span>UBound(baKey)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6614" data-line-number="6614"></td>
          <td id="LC6614">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6615" data-line-number="6615"></td>
          <td id="LC6615">    <span>pvCryptoBulkAesGcmEncrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6616" data-line-number="6616"></td>
          <td id="LC6616"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6617" data-line-number="6617"></td>
          <td id="LC6617">
</td>
        </tr>
        <tr>
          <td id="L6618" data-line-number="6618"></td>
          <td id="LC6618"><span>Private</span> <span>Function</span> <span>pvCryptoBulkAesGcmDecrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6619" data-line-number="6619"></td>
          <td id="LC6619">            <span>baNonce()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6620" data-line-number="6620"></td>
          <td id="LC6620">            <span>baAad()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lAadPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lAadSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6621" data-line-number="6621"></td>
          <td id="LC6621">            <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6622" data-line-number="6622"></td>
          <td id="LC6622">    <span>Debug.Assert</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_AESGCM_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L6623" data-line-number="6623"></td>
          <td id="LC6623">    <span>Debug.Assert</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES128_KEYSZ</span> <span>Or</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6624" data-line-number="6624"></td>
          <td id="LC6624">    <span>Debug.Assert</span> <span>pvArraySize(baBuffer)</span> <span>&gt;=</span> <span>lPos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L6625" data-line-number="6625"></td>
          <td id="LC6625">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesGcmDecrypt)</span></td>
        </tr>
        <tr>
          <td id="L6626" data-line-number="6626"></td>
          <td id="LC6626">    <span>If</span> <span>pvCallAesGcmDecrypt(m_uData.Pfn(ucsPfnAesGcmDecrypt),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6627" data-line-number="6627"></td>
          <td id="LC6627">            <span>baBuffer(lPos),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6628" data-line-number="6628"></td>
          <td id="LC6628">            <span>baBuffer(lPos),</span> <span>lSize</span> <span>-</span> <span>LNG_AESGCM_TAGSZ,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6629" data-line-number="6629"></td>
          <td id="LC6629">            <span>baBuffer(lPos</span> <span>+</span> <span>lSize</span> <span>-</span> <span>LNG_AESGCM_TAGSZ),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6630" data-line-number="6630"></td>
          <td id="LC6630">            <span>baAad(lAadPos),</span> <span>lAadSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6631" data-line-number="6631"></td>
          <td id="LC6631">            <span>baNonce(</span><span>0</span><span>),</span> <span>baKey(</span><span>0</span><span>),</span> <span>UBound(baKey)</span> <span>+</span> <span>1</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6632" data-line-number="6632"></td>
          <td id="LC6632">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6633" data-line-number="6633"></td>
          <td id="LC6633">        <span>pvCryptoBulkAesGcmDecrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6634" data-line-number="6634"></td>
          <td id="LC6634">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6635" data-line-number="6635"></td>
          <td id="LC6635"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6636" data-line-number="6636"></td>
          <td id="LC6636">
</td>
        </tr>
        <tr>
          <td id="L6637" data-line-number="6637"></td>
          <td id="LC6637"><span>Private</span> <span>Function</span> <span>pvCryptoBulkAesCbcEncrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6638" data-line-number="6638"></td>
          <td id="LC6638">            <span>baNonce()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6639" data-line-number="6639"></td>
          <td id="LC6639">            <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6640" data-line-number="6640"></td>
          <td id="LC6640">    <span>Debug.Assert</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L6641" data-line-number="6641"></td>
          <td id="LC6641">    <span>Debug.Assert</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES128_KEYSZ</span> <span>Or</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6642" data-line-number="6642"></td>
          <td id="LC6642">    <span>Debug.Assert</span> <span>pvArraySize(baBuffer)</span> <span>&gt;=</span> <span>lPos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L6643" data-line-number="6643"></td>
          <td id="LC6643">    <span>Debug.Assert</span> <span>lSize</span> <span>Mod</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L6644" data-line-number="6644"></td>
          <td id="LC6644">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesCbcEncrypt)</span></td>
        </tr>
        <tr>
          <td id="L6645" data-line-number="6645"></td>
          <td id="LC6645">    <span>Call</span> <span>pvCallAesCbcEncrypt(m_uData.Pfn(ucsPfnAesCbcEncrypt),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6646" data-line-number="6646"></td>
          <td id="LC6646">            <span>baBuffer(lPos),</span> <span>baBuffer(lPos),</span> <span>lSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6647" data-line-number="6647"></td>
          <td id="LC6647">            <span>baNonce(</span><span>0</span><span>),</span> <span>baKey(</span><span>0</span><span>),</span> <span>UBound(baKey)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6648" data-line-number="6648"></td>
          <td id="LC6648">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6649" data-line-number="6649"></td>
          <td id="LC6649">    <span>pvCryptoBulkAesCbcEncrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6650" data-line-number="6650"></td>
          <td id="LC6650"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6651" data-line-number="6651"></td>
          <td id="LC6651">
</td>
        </tr>
        <tr>
          <td id="L6652" data-line-number="6652"></td>
          <td id="LC6652"><span>Private</span> <span>Function</span> <span>pvCryptoBulkAesCbcDecrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6653" data-line-number="6653"></td>
          <td id="LC6653">            <span>baNonce()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baKey()</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6654" data-line-number="6654"></td>
          <td id="LC6654">            <span>baBuffer()</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPos</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6655" data-line-number="6655"></td>
          <td id="LC6655">    <span>Debug.Assert</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L6656" data-line-number="6656"></td>
          <td id="LC6656">    <span>Debug.Assert</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES128_KEYSZ</span> <span>Or</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES256_KEYSZ</span></td>
        </tr>
        <tr>
          <td id="L6657" data-line-number="6657"></td>
          <td id="LC6657">    <span>Debug.Assert</span> <span>pvArraySize(baBuffer)</span> <span>&gt;=</span> <span>lPos</span> <span>+</span> <span>lSize</span></td>
        </tr>
        <tr>
          <td id="L6658" data-line-number="6658"></td>
          <td id="LC6658">    <span>If</span> <span>lSize</span> <span>Mod</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6659" data-line-number="6659"></td>
          <td id="LC6659">        <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallAesCbcDecrypt)</span></td>
        </tr>
        <tr>
          <td id="L6660" data-line-number="6660"></td>
          <td id="LC6660">        <span>Call</span> <span>pvCallAesCbcDecrypt(m_uData.Pfn(ucsPfnAesCbcDecrypt),</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6661" data-line-number="6661"></td>
          <td id="LC6661">                <span>baBuffer(lPos),</span> <span>baBuffer(lPos),</span> <span>lSize,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6662" data-line-number="6662"></td>
          <td id="LC6662">                <span>baNonce(</span><span>0</span><span>),</span> <span>baKey(</span><span>0</span><span>),</span> <span>UBound(baKey)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6663" data-line-number="6663"></td>
          <td id="LC6663">        <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6664" data-line-number="6664"></td>
          <td id="LC6664">        <span>pvCryptoBulkAesCbcDecrypt</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6665" data-line-number="6665"></td>
          <td id="LC6665">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6666" data-line-number="6666"></td>
          <td id="LC6666"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6667" data-line-number="6667"></td>
          <td id="LC6667">
</td>
        </tr>
        <tr>
          <td id="L6668" data-line-number="6668"></td>
          <td id="LC6668"><span>Private</span> <span>Sub</span> <span>pvCryptoRandomBytes(</span><span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6669" data-line-number="6669"></td>
          <td id="LC6669">    <span>Call</span> <span>CryptGenRandom(m_uData.hRandomProv,</span> <span>lSize,</span> <span>lPtr)</span></td>
        </tr>
        <tr>
          <td id="L6670" data-line-number="6670"></td>
          <td id="LC6670"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L6671" data-line-number="6671"></td>
          <td id="LC6671">
</td>
        </tr>
        <tr>
          <td id="L6672" data-line-number="6672"></td>
          <td id="LC6672"><span>Private</span> <span>Function</span> <span>pvCryptoRsaModExp(baBase()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baExp()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baModulus()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baRetVal()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6673" data-line-number="6673"></td>
          <td id="LC6673">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoRsaModExp&#34;</span></td>
        </tr>
        <tr>
          <td id="L6674" data-line-number="6674"></td>
          <td id="LC6674">    </td>
        </tr>
        <tr>
          <td id="L6675" data-line-number="6675"></td>
          <td id="LC6675">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>UBound(baBase)</span> <span>+</span> <span>1</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6676" data-line-number="6676"></td>
          <td id="LC6676">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallRsaModExp)</span></td>
        </tr>
        <tr>
          <td id="L6677" data-line-number="6677"></td>
          <td id="LC6677">    <span>Call</span> <span>pvCallRsaModExp(m_uData.Pfn(ucsPfnRsaModExp),</span> <span>UBound(baBase)</span> <span>+</span> <span>1</span><span>,</span> <span>baBase(</span><span>0</span><span>),</span> <span>baExp(</span><span>0</span><span>),</span> <span>baModulus(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6678" data-line-number="6678"></td>
          <td id="LC6678">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6679" data-line-number="6679"></td>
          <td id="LC6679">    <span>pvCryptoRsaModExp</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6680" data-line-number="6680"></td>
          <td id="LC6680"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6681" data-line-number="6681"></td>
          <td id="LC6681">
</td>
        </tr>
        <tr>
          <td id="L6682" data-line-number="6682"></td>
          <td id="LC6682"><span>Private</span> <span>Function</span> <span>pvCryptoRsaCrtModExp(baBase()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baExp()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baModulus()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrime1()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baPrime2()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baCoefficient()</span> <span>As</span> <span>Byte</span><span>,</span> <span>baRetVal()</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6683" data-line-number="6683"></td>
          <td id="LC6683">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;CryptoRsaCrtModExp&#34;</span></td>
        </tr>
        <tr>
          <td id="L6684" data-line-number="6684"></td>
          <td id="LC6684">    </td>
        </tr>
        <tr>
          <td id="L6685" data-line-number="6685"></td>
          <td id="LC6685">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>UBound(baBase)</span> <span>+</span> <span>1</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6686" data-line-number="6686"></td>
          <td id="LC6686">    <span>Debug.Assert</span> <span>pvPatchTrampoline(</span><span>AddressOf</span> <span>pvCallRsaCrtModExp)</span></td>
        </tr>
        <tr>
          <td id="L6687" data-line-number="6687"></td>
          <td id="LC6687">    <span>Call</span> <span>pvCallRsaCrtModExp(m_uData.Pfn(ucsPfnRsaCrtModExp),</span> <span>UBound(baBase)</span> <span>+</span> <span>1</span><span>,</span> <span>baBase(</span><span>0</span><span>),</span> <span>baExp(</span><span>0</span><span>),</span> <span>baModulus(</span><span>0</span><span>),</span> <span>baPrime1(</span><span>0</span><span>),</span> <span>baPrime2(</span><span>0</span><span>),</span> <span>baCoefficient(</span><span>0</span><span>),</span> <span>baRetVal(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6688" data-line-number="6688"></td>
          <td id="LC6688">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6689" data-line-number="6689"></td>
          <td id="LC6689">    <span>pvCryptoRsaCrtModExp</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6690" data-line-number="6690"></td>
          <td id="LC6690"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6691" data-line-number="6691"></td>
          <td id="LC6691">
</td>
        </tr>
        <tr>
          <td id="L6692" data-line-number="6692"></td>
          <td id="LC6692"><span>&#39;= private ===============================================================</span></td>
        </tr>
        <tr>
          <td id="L6693" data-line-number="6693"></td>
          <td id="LC6693">
</td>
        </tr>
        <tr>
          <td id="L6694" data-line-number="6694"></td>
          <td id="LC6694"><span>Private</span> <span>Function</span> <span>pvThunkAllocate(sText</span> <span>As</span> <span>String</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>ThunkPtr</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6695" data-line-number="6695"></td>
          <td id="LC6695">    <span>Static</span> <span>Map(</span><span>0</span> <span>To</span> <span>&amp;H3FF</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6696" data-line-number="6696"></td>
          <td id="LC6696">    <span>Dim</span> <span>baInput()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6697" data-line-number="6697"></td>
          <td id="LC6697">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6698" data-line-number="6698"></td>
          <td id="LC6698">    <span>Dim</span> <span>lChar</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6699" data-line-number="6699"></td>
          <td id="LC6699">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6700" data-line-number="6700"></td>
          <td id="LC6700">    </td>
        </tr>
        <tr>
          <td id="L6701" data-line-number="6701"></td>
          <td id="LC6701">    <span>If</span> <span>ThunkPtr</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6702" data-line-number="6702"></td>
          <td id="LC6702">        <span>pvThunkAllocate</span> <span>=</span> <span>ThunkPtr</span></td>
        </tr>
        <tr>
          <td id="L6703" data-line-number="6703"></td>
          <td id="LC6703">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6704" data-line-number="6704"></td>
          <td id="LC6704">        <span>pvThunkAllocate</span> <span>=</span> <span>VirtualAlloc(</span><span>0</span><span>,</span> <span>(Len(sText)</span> <span>\</span> <span>4</span><span>)</span> <span>*</span> <span>3</span><span>,</span> <span>MEM_COMMIT,</span> <span>PAGE_EXECUTE_READWRITE)</span></td>
        </tr>
        <tr>
          <td id="L6705" data-line-number="6705"></td>
          <td id="LC6705">        <span>If</span> <span>pvThunkAllocate</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6706" data-line-number="6706"></td>
          <td id="LC6706">            <span>Exit</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6707" data-line-number="6707"></td>
          <td id="LC6707">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6708" data-line-number="6708"></td>
          <td id="LC6708">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6709" data-line-number="6709"></td>
          <td id="LC6709">    <span>&#39;--- init decoding maps</span></td>
        </tr>
        <tr>
          <td id="L6710" data-line-number="6710"></td>
          <td id="LC6710">    <span>If</span> <span>Map(</span><span>65</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6711" data-line-number="6711"></td>
          <td id="LC6711">        <span>baInput</span> <span>=</span> <span>StrConv(</span><span>&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span><span>,</span> <span>vbFromUnicode)</span></td>
        </tr>
        <tr>
          <td id="L6712" data-line-number="6712"></td>
          <td id="LC6712">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baInput)</span></td>
        </tr>
        <tr>
          <td id="L6713" data-line-number="6713"></td>
          <td id="LC6713">            <span>lChar</span> <span>=</span> <span>baInput(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L6714" data-line-number="6714"></td>
          <td id="LC6714">            <span>Map(</span><span>&amp;H0</span> <span>+</span> <span>lChar)</span> <span>=</span> <span>lIdx</span> <span>*</span> <span>(</span><span>2</span> <span>^</span> <span>2</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6715" data-line-number="6715"></td>
          <td id="LC6715">            <span>Map(</span><span>&amp;H100</span> <span>+</span> <span>lChar)</span> <span>=</span> <span>(lIdx</span> <span>And</span> <span>&amp;H30</span><span>)</span> <span>\</span> <span>(</span><span>2</span> <span>^</span> <span>4</span><span>)</span> <span>Or</span> <span>(lIdx</span> <span>And</span> <span>&amp;HF</span><span>)</span> <span>*</span> <span>(</span><span>2</span> <span>^</span> <span>12</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6716" data-line-number="6716"></td>
          <td id="LC6716">            <span>Map(</span><span>&amp;H200</span> <span>+</span> <span>lChar)</span> <span>=</span> <span>(lIdx</span> <span>And</span> <span>&amp;H3</span><span>)</span> <span>*</span> <span>(</span><span>2</span> <span>^</span> <span>22</span><span>)</span> <span>Or</span> <span>(lIdx</span> <span>And</span> <span>&amp;H3C</span><span>)</span> <span>*</span> <span>(</span><span>2</span> <span>^</span> <span>6</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6717" data-line-number="6717"></td>
          <td id="LC6717">            <span>Map(</span><span>&amp;H300</span> <span>+</span> <span>lChar)</span> <span>=</span> <span>lIdx</span> <span>*</span> <span>(</span><span>2</span> <span>^</span> <span>16</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6718" data-line-number="6718"></td>
          <td id="LC6718">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6719" data-line-number="6719"></td>
          <td id="LC6719">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6720" data-line-number="6720"></td>
          <td id="LC6720">    <span>&#39;--- base64 decode loop</span></td>
        </tr>
        <tr>
          <td id="L6721" data-line-number="6721"></td>
          <td id="LC6721">    <span>baInput</span> <span>=</span> <span>StrConv(Replace(Replace(sText,</span> <span>vbCr,</span> <span>vbNullString),</span> <span>vbLf,</span> <span>vbNullString),</span> <span>vbFromUnicode)</span></td>
        </tr>
        <tr>
          <td id="L6722" data-line-number="6722"></td>
          <td id="LC6722">    <span>lPtr</span> <span>=</span> <span>pvThunkAllocate</span></td>
        </tr>
        <tr>
          <td id="L6723" data-line-number="6723"></td>
          <td id="LC6723">    <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(baInput)</span> <span>-</span> <span>3</span> <span>Step</span> <span>4</span></td>
        </tr>
        <tr>
          <td id="L6724" data-line-number="6724"></td>
          <td id="LC6724">        <span>lChar</span> <span>=</span> <span>Map(baInput(lIdx</span> <span>+</span> <span>0</span><span>))</span> <span>Or</span> <span>Map(</span><span>&amp;H100</span> <span>+</span> <span>baInput(lIdx</span> <span>+</span> <span>1</span><span>))</span> <span>Or</span> <span>Map(</span><span>&amp;H200</span> <span>+</span> <span>baInput(lIdx</span> <span>+</span> <span>2</span><span>))</span> <span>Or</span> <span>Map(</span><span>&amp;H300</span> <span>+</span> <span>baInput(lIdx</span> <span>+</span> <span>3</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6725" data-line-number="6725"></td>
          <td id="LC6725">        <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>lPtr,</span> <span>lChar,</span> <span>3</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6726" data-line-number="6726"></td>
          <td id="LC6726">        <span>lPtr</span> <span>=</span> <span>UnsignedAdd(lPtr,</span> <span>3</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6727" data-line-number="6727"></td>
          <td id="LC6727">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6728" data-line-number="6728"></td>
          <td id="LC6728"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6729" data-line-number="6729"></td>
          <td id="LC6729">
</td>
        </tr>
        <tr>
          <td id="L6730" data-line-number="6730"></td>
          <td id="LC6730"><span>Private</span> <span>Function</span> <span>pvPatchTrampoline(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6731" data-line-number="6731"></td>
          <td id="LC6731">    <span>Dim</span> <span>bInIDE</span>          <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6732" data-line-number="6732"></td>
          <td id="LC6732"> </td>
        </tr>
        <tr>
          <td id="L6733" data-line-number="6733"></td>
          <td id="LC6733">    <span>Debug.Assert</span> <span>pvSetTrue(bInIDE)</span></td>
        </tr>
        <tr>
          <td id="L6734" data-line-number="6734"></td>
          <td id="LC6734">    <span>If</span> <span>bInIDE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6735" data-line-number="6735"></td>
          <td id="LC6735">        <span>&#39;--- note: IDE is not large-address aware</span></td>
        </tr>
        <tr>
          <td id="L6736" data-line-number="6736"></td>
          <td id="LC6736">        <span>Call</span> <span>CopyMemory(Pfn,</span> <span>ByVal</span> <span>Pfn</span> <span>+</span> <span>&amp;H16</span><span>,</span> <span>LenB(Pfn))</span></td>
        </tr>
        <tr>
          <td id="L6737" data-line-number="6737"></td>
          <td id="LC6737">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6738" data-line-number="6738"></td>
          <td id="LC6738">        <span>Call</span> <span>VirtualProtect(Pfn,</span> <span>8</span><span>,</span> <span>PAGE_EXECUTE_READWRITE,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6739" data-line-number="6739"></td>
          <td id="LC6739">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6740" data-line-number="6740"></td>
          <td id="LC6740">    <span>&#39; 0:  58                      pop    eax</span></td>
        </tr>
        <tr>
          <td id="L6741" data-line-number="6741"></td>
          <td id="LC6741">    <span>&#39; 1:  59                      pop    ecx</span></td>
        </tr>
        <tr>
          <td id="L6742" data-line-number="6742"></td>
          <td id="LC6742">    <span>&#39; 2:  50                      push   eax</span></td>
        </tr>
        <tr>
          <td id="L6743" data-line-number="6743"></td>
          <td id="LC6743">    <span>&#39; 3:  ff e1                   jmp    ecx</span></td>
        </tr>
        <tr>
          <td id="L6744" data-line-number="6744"></td>
          <td id="LC6744">    <span>&#39; 5:  90                      nop</span></td>
        </tr>
        <tr>
          <td id="L6745" data-line-number="6745"></td>
          <td id="LC6745">    <span>&#39; 6:  90                      nop</span></td>
        </tr>
        <tr>
          <td id="L6746" data-line-number="6746"></td>
          <td id="LC6746">    <span>&#39; 7:  90                      nop</span></td>
        </tr>
        <tr>
          <td id="L6747" data-line-number="6747"></td>
          <td id="LC6747">    <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>Pfn,</span> <span>-</span><span>802975883527609.7192@</span><span>,</span> <span>8</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6748" data-line-number="6748"></td>
          <td id="LC6748">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6749" data-line-number="6749"></td>
          <td id="LC6749">    <span>pvPatchTrampoline</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6750" data-line-number="6750"></td>
          <td id="LC6750"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6751" data-line-number="6751"></td>
          <td id="LC6751">
</td>
        </tr>
        <tr>
          <td id="L6752" data-line-number="6752"></td>
          <td id="LC6752"><span>Private</span> <span>Function</span> <span>pvSetTrue(bValue</span> <span>As</span> <span>Boolean</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6753" data-line-number="6753"></td>
          <td id="LC6753">    <span>#</span><span>If</span> <span>TWINBASIC</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6754" data-line-number="6754"></td>
          <td id="LC6754">        <span>bValue</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6755" data-line-number="6755"></td>
          <td id="LC6755">    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6756" data-line-number="6756"></td>
          <td id="LC6756">    <span>pvSetTrue</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6757" data-line-number="6757"></td>
          <td id="LC6757"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6758" data-line-number="6758"></td>
          <td id="LC6758">
</td>
        </tr>
        <tr>
          <td id="L6759" data-line-number="6759"></td>
          <td id="LC6759"><span>#</span><span>If</span> <span>Not</span> <span>ImplUseShared</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6760" data-line-number="6760"></td>
          <td id="LC6760"><span>Private</span> <span>Function</span> <span>RedimStats(sFuncName</span> <span>As</span> <span>String</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6761" data-line-number="6761"></td>
          <td id="LC6761">    <span>#</span><span>If</span> <span>sFuncName</span> <span>And</span> <span>lSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6762" data-line-number="6762"></td>
          <td id="LC6762">    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6763" data-line-number="6763"></td>
          <td id="LC6763">    <span>RedimStats</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6764" data-line-number="6764"></td>
          <td id="LC6764"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6765" data-line-number="6765"></td>
          <td id="LC6765">
</td>
        </tr>
        <tr>
          <td id="L6766" data-line-number="6766"></td>
          <td id="LC6766"><span>Public</span> <span>Sub</span> <span>RemoveCollection(</span><span>ByVal</span> <span>oCol</span> <span>As</span> <span>Collection,</span> <span>Index</span> <span>As</span> <span>Variant</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6767" data-line-number="6767"></td>
          <td id="LC6767">    <span>If</span> <span>Not</span> <span>oCol</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6768" data-line-number="6768"></td>
          <td id="LC6768">        <span>pvCallCollectionRemove</span> <span>oCol,</span> <span>Index</span></td>
        </tr>
        <tr>
          <td id="L6769" data-line-number="6769"></td>
          <td id="LC6769">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6770" data-line-number="6770"></td>
          <td id="LC6770"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L6771" data-line-number="6771"></td>
          <td id="LC6771">
</td>
        </tr>
        <tr>
          <td id="L6772" data-line-number="6772"></td>
          <td id="LC6772"><span>Public</span> <span>Function</span> <span>SearchCollection(</span><span>ByVal</span> <span>oCol</span> <span>As</span> <span>Collection,</span> <span>Index</span> <span>As</span> <span>Variant</span><span>,</span> <span>Optional</span> <span>RetVal</span> <span>As</span> <span>Variant</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6773" data-line-number="6773"></td>
          <td id="LC6773">    <span>Dim</span> <span>vItem</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L6774" data-line-number="6774"></td>
          <td id="LC6774">    </td>
        </tr>
        <tr>
          <td id="L6775" data-line-number="6775"></td>
          <td id="LC6775">    <span>If</span> <span>oCol</span> <span>Is</span> <span>Nothing</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6776" data-line-number="6776"></td>
          <td id="LC6776">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6777" data-line-number="6777"></td>
          <td id="LC6777">    <span>ElseIf</span> <span>pvCallCollectionItem(oCol,</span> <span>Index,</span> <span>vItem)</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6778" data-line-number="6778"></td>
          <td id="LC6778">        <span>GoTo</span> <span>QH</span></td>
        </tr>
        <tr>
          <td id="L6779" data-line-number="6779"></td>
          <td id="LC6779">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6780" data-line-number="6780"></td>
          <td id="LC6780">    <span>If</span> <span>IsObject(vItem)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6781" data-line-number="6781"></td>
          <td id="LC6781">        <span>Set</span> <span>RetVal</span> <span>=</span> <span>vItem</span></td>
        </tr>
        <tr>
          <td id="L6782" data-line-number="6782"></td>
          <td id="LC6782">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6783" data-line-number="6783"></td>
          <td id="LC6783">        <span>RetVal</span> <span>=</span> <span>vItem</span></td>
        </tr>
        <tr>
          <td id="L6784" data-line-number="6784"></td>
          <td id="LC6784">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6785" data-line-number="6785"></td>
          <td id="LC6785">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6786" data-line-number="6786"></td>
          <td id="LC6786">    <span>SearchCollection</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6787" data-line-number="6787"></td>
          <td id="LC6787"><span>QH:</span></td>
        </tr>
        <tr>
          <td id="L6788" data-line-number="6788"></td>
          <td id="LC6788"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6789" data-line-number="6789"></td>
          <td id="LC6789">
</td>
        </tr>
        <tr>
          <td id="L6790" data-line-number="6790"></td>
          <td id="LC6790"><span>Public</span> <span>Function</span> <span>FromBase64Array(sText</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>Byte</span><span>()</span></td>
        </tr>
        <tr>
          <td id="L6791" data-line-number="6791"></td>
          <td id="LC6791">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;FromBase64Array&#34;</span></td>
        </tr>
        <tr>
          <td id="L6792" data-line-number="6792"></td>
          <td id="LC6792">    <span>Dim</span> <span>baRetVal()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6793" data-line-number="6793"></td>
          <td id="LC6793">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6794" data-line-number="6794"></td>
          <td id="LC6794">
</td>
        </tr>
        <tr>
          <td id="L6795" data-line-number="6795"></td>
          <td id="LC6795">    <span>lSize</span> <span>=</span> <span>(Len(sText)</span> <span>\</span> <span>4</span><span>)</span> <span>*</span> <span>3</span></td>
        </tr>
        <tr>
          <td id="L6796" data-line-number="6796"></td>
          <td id="LC6796">    <span>pvArrayAllocate</span> <span>baRetVal,</span> <span>lSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6797" data-line-number="6797"></td>
          <td id="LC6797">    <span>pvThunkAllocate</span> <span>sText,</span> <span>VarPtr(baRetVal(</span><span>0</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6798" data-line-number="6798"></td>
          <td id="LC6798">    <span>If</span> <span>Right$(sText,</span> <span>2</span><span>)</span> <span>=</span> <span>&#34;==&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6799" data-line-number="6799"></td>
          <td id="LC6799">        <span>pvArrayReallocate</span> <span>baRetVal,</span> <span>lSize</span> <span>-</span> <span>2</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6800" data-line-number="6800"></td>
          <td id="LC6800">    <span>ElseIf</span> <span>Right$(sText,</span> <span>1</span><span>)</span> <span>=</span> <span>&#34;=&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6801" data-line-number="6801"></td>
          <td id="LC6801">        <span>pvArrayReallocate</span> <span>baRetVal,</span> <span>lSize</span> <span>-</span> <span>1</span><span>,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baRetVal&#34;</span></td>
        </tr>
        <tr>
          <td id="L6802" data-line-number="6802"></td>
          <td id="LC6802">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6803" data-line-number="6803"></td>
          <td id="LC6803">    <span>FromBase64Array</span> <span>=</span> <span>baRetVal</span></td>
        </tr>
        <tr>
          <td id="L6804" data-line-number="6804"></td>
          <td id="LC6804"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6805" data-line-number="6805"></td>
          <td id="LC6805">
</td>
        </tr>
        <tr>
          <td id="L6806" data-line-number="6806"></td>
          <td id="LC6806"><span>Private</span> <span>Function</span> <span>UnsignedAdd(</span><span>ByVal</span> <span>lUnsignedPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSignedOffset</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6807" data-line-number="6807"></td>
          <td id="LC6807">    <span>&#39;--- note: safely add *signed* offset to *unsigned* ptr for *unsigned* retval w/o overflow in LARGEADDRESSAWARE processes</span></td>
        </tr>
        <tr>
          <td id="L6808" data-line-number="6808"></td>
          <td id="LC6808">    <span>UnsignedAdd</span> <span>=</span> <span>((lUnsignedPtr</span> <span>Xor</span> <span>&amp;H80000000</span><span>)</span> <span>+</span> <span>lSignedOffset)</span> <span>Xor</span> <span>&amp;H80000000</span></td>
        </tr>
        <tr>
          <td id="L6809" data-line-number="6809"></td>
          <td id="LC6809"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6810" data-line-number="6810"></td>
          <td id="LC6810">
</td>
        </tr>
        <tr>
          <td id="L6811" data-line-number="6811"></td>
          <td id="LC6811"><span>Private</span> <span>Function</span> <span>pvCallCollectionItem(</span><span>ByVal</span> <span>oCol</span> <span>As</span> <span>Collection,</span> <span>Index</span> <span>As</span> <span>Variant</span><span>,</span> <span>Optional</span> <span>RetVal</span> <span>As</span> <span>Variant</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6812" data-line-number="6812"></td>
          <td id="LC6812">    <span>Const</span> <span>IDX_COLLECTION_ITEM</span> <span>As</span> <span>Long</span> <span>=</span> <span>7</span></td>
        </tr>
        <tr>
          <td id="L6813" data-line-number="6813"></td>
          <td id="LC6813">    </td>
        </tr>
        <tr>
          <td id="L6814" data-line-number="6814"></td>
          <td id="LC6814">    <span>pvPatchMethodTrampoline</span> <span>AddressOf</span> <span>mdTlsThunks.pvCallCollectionItem,</span> <span>IDX_COLLECTION_ITEM</span></td>
        </tr>
        <tr>
          <td id="L6815" data-line-number="6815"></td>
          <td id="LC6815">    <span>pvCallCollectionItem</span> <span>=</span> <span>pvCallCollectionItem(oCol,</span> <span>Index,</span> <span>RetVal)</span></td>
        </tr>
        <tr>
          <td id="L6816" data-line-number="6816"></td>
          <td id="LC6816"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6817" data-line-number="6817"></td>
          <td id="LC6817">
</td>
        </tr>
        <tr>
          <td id="L6818" data-line-number="6818"></td>
          <td id="LC6818"><span>Private</span> <span>Function</span> <span>pvCallCollectionRemove(</span><span>ByVal</span> <span>oCol</span> <span>As</span> <span>Collection,</span> <span>Index</span> <span>As</span> <span>Variant</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6819" data-line-number="6819"></td>
          <td id="LC6819">    <span>Const</span> <span>IDX_COLLECTION_REMOVE</span> <span>As</span> <span>Long</span> <span>=</span> <span>10</span></td>
        </tr>
        <tr>
          <td id="L6820" data-line-number="6820"></td>
          <td id="LC6820">    </td>
        </tr>
        <tr>
          <td id="L6821" data-line-number="6821"></td>
          <td id="LC6821">    <span>pvPatchMethodTrampoline</span> <span>AddressOf</span> <span>mdTlsThunks.pvCallCollectionRemove,</span> <span>IDX_COLLECTION_REMOVE</span></td>
        </tr>
        <tr>
          <td id="L6822" data-line-number="6822"></td>
          <td id="LC6822">    <span>pvCallCollectionRemove</span> <span>=</span> <span>pvCallCollectionRemove(oCol,</span> <span>Index)</span></td>
        </tr>
        <tr>
          <td id="L6823" data-line-number="6823"></td>
          <td id="LC6823"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6824" data-line-number="6824"></td>
          <td id="LC6824">
</td>
        </tr>
        <tr>
          <td id="L6825" data-line-number="6825"></td>
          <td id="LC6825"><span>Private</span> <span>Function</span> <span>pvPatchMethodTrampoline(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lMethodIdx</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6826" data-line-number="6826"></td>
          <td id="LC6826">    <span>Dim</span> <span>bInIDE</span>          <span>As</span> <span>Boolean</span></td>
        </tr>
        <tr>
          <td id="L6827" data-line-number="6827"></td>
          <td id="LC6827">
</td>
        </tr>
        <tr>
          <td id="L6828" data-line-number="6828"></td>
          <td id="LC6828">    <span>Debug.Assert</span> <span>pvSetTrue(bInIDE)</span></td>
        </tr>
        <tr>
          <td id="L6829" data-line-number="6829"></td>
          <td id="LC6829">    <span>If</span> <span>bInIDE</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6830" data-line-number="6830"></td>
          <td id="LC6830">        <span>&#39;--- note: IDE is not large-address aware</span></td>
        </tr>
        <tr>
          <td id="L6831" data-line-number="6831"></td>
          <td id="LC6831">        <span>Call</span> <span>CopyMemory(Pfn,</span> <span>ByVal</span> <span>Pfn</span> <span>+</span> <span>&amp;H16</span><span>,</span> <span>LenB(Pfn))</span></td>
        </tr>
        <tr>
          <td id="L6832" data-line-number="6832"></td>
          <td id="LC6832">    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6833" data-line-number="6833"></td>
          <td id="LC6833">        <span>Call</span> <span>VirtualProtect(Pfn,</span> <span>12</span><span>,</span> <span>PAGE_EXECUTE_READWRITE,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6834" data-line-number="6834"></td>
          <td id="LC6834">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6835" data-line-number="6835"></td>
          <td id="LC6835">    <span>&#39; 0: 8B 44 24 04          mov         eax,dword ptr [esp+4]</span></td>
        </tr>
        <tr>
          <td id="L6836" data-line-number="6836"></td>
          <td id="LC6836">    <span>&#39; 4: 8B 00                mov         eax,dword ptr [eax]</span></td>
        </tr>
        <tr>
          <td id="L6837" data-line-number="6837"></td>
          <td id="LC6837">    <span>&#39; 6: FF A0 00 00 00 00    jmp         dword ptr [eax+lMethodIdx*4]</span></td>
        </tr>
        <tr>
          <td id="L6838" data-line-number="6838"></td>
          <td id="LC6838">    <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>Pfn,</span> <span>-</span><span>684575231150992.4725@</span><span>,</span> <span>8</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6839" data-line-number="6839"></td>
          <td id="LC6839">    <span>Call</span> <span>CopyMemory(</span><span>ByVal</span> <span>(Pfn</span> <span>Xor</span> <span>&amp;H80000000</span><span>)</span> <span>+</span> <span>8</span> <span>Xor</span> <span>&amp;H80000000</span><span>,</span> <span>lMethodIdx</span> <span>*</span> <span>PTR_SIZE,</span> <span>LenB(lMethodIdx))</span></td>
        </tr>
        <tr>
          <td id="L6840" data-line-number="6840"></td>
          <td id="LC6840">    <span>&#39;--- success</span></td>
        </tr>
        <tr>
          <td id="L6841" data-line-number="6841"></td>
          <td id="LC6841">    <span>pvPatchMethodTrampoline</span> <span>=</span> <span>True</span></td>
        </tr>
        <tr>
          <td id="L6842" data-line-number="6842"></td>
          <td id="LC6842"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6843" data-line-number="6843"></td>
          <td id="LC6843">
</td>
        </tr>
        <tr>
          <td id="L6844" data-line-number="6844"></td>
          <td id="LC6844"><span>Private</span> <span>Function</span> <span>SplitOrReindex(Expression</span> <span>As</span> <span>String</span><span>,</span> <span>Delimiter</span> <span>As</span> <span>String</span><span>)</span> <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L6845" data-line-number="6845"></td>
          <td id="LC6845">    <span>Dim</span> <span>vResult</span>         <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L6846" data-line-number="6846"></td>
          <td id="LC6846">    <span>Dim</span> <span>vTemp</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L6847" data-line-number="6847"></td>
          <td id="LC6847">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6848" data-line-number="6848"></td>
          <td id="LC6848">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6849" data-line-number="6849"></td>
          <td id="LC6849">    </td>
        </tr>
        <tr>
          <td id="L6850" data-line-number="6850"></td>
          <td id="LC6850">    <span>vResult</span> <span>=</span> <span>Split(Expression,</span> <span>Delimiter)</span></td>
        </tr>
        <tr>
          <td id="L6851" data-line-number="6851"></td>
          <td id="LC6851">    <span>&#39;--- check if reindex needed</span></td>
        </tr>
        <tr>
          <td id="L6852" data-line-number="6852"></td>
          <td id="LC6852">    <span>If</span> <span>IsNumeric(vResult(</span><span>0</span><span>))</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6853" data-line-number="6853"></td>
          <td id="LC6853">        <span>vTemp</span> <span>=</span> <span>vResult</span></td>
        </tr>
        <tr>
          <td id="L6854" data-line-number="6854"></td>
          <td id="LC6854">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(vTemp)</span> <span>Step</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L6855" data-line-number="6855"></td>
          <td id="LC6855">            <span>If</span> <span>lSize</span> <span>&lt;</span> <span>vTemp(lIdx)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6856" data-line-number="6856"></td>
          <td id="LC6856">                <span>lSize</span> <span>=</span> <span>vTemp(lIdx)</span></td>
        </tr>
        <tr>
          <td id="L6857" data-line-number="6857"></td>
          <td id="LC6857">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6858" data-line-number="6858"></td>
          <td id="LC6858">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6859" data-line-number="6859"></td>
          <td id="LC6859">        <span>ReDim</span> <span>vResult(</span><span>0</span> <span>To</span> <span>lSize)</span> <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L6860" data-line-number="6860"></td>
          <td id="LC6860">        <span>Debug.Assert</span> <span>RedimStats(MODULE_NAME</span> <span>&amp;</span> <span>&#34;.SplitOrReindex.vResult&#34;</span><span>,</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6861" data-line-number="6861"></td>
          <td id="LC6861">        <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>UBound(vTemp)</span> <span>Step</span> <span>2</span></td>
        </tr>
        <tr>
          <td id="L6862" data-line-number="6862"></td>
          <td id="LC6862">            <span>vResult(vTemp(lIdx))</span> <span>=</span> <span>vTemp(lIdx</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6863" data-line-number="6863"></td>
          <td id="LC6863">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6864" data-line-number="6864"></td>
          <td id="LC6864">        <span>SplitOrReindex</span> <span>=</span> <span>vResult</span></td>
        </tr>
        <tr>
          <td id="L6865" data-line-number="6865"></td>
          <td id="LC6865">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6866" data-line-number="6866"></td>
          <td id="LC6866"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6867" data-line-number="6867"></td>
          <td id="LC6867">
</td>
        </tr>
        <tr>
          <td id="L6868" data-line-number="6868"></td>
          <td id="LC6868"><span>Private</span> <span>Function</span> <span>Clamp(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6869" data-line-number="6869"></td>
          <td id="LC6869">            <span>ByVal</span> <span>lValue</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6870" data-line-number="6870"></td>
          <td id="LC6870">            <span>Optional</span> <span>ByVal</span> <span>lMin</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>2147483647</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L6871" data-line-number="6871"></td>
          <td id="LC6871">            <span>Optional</span> <span>ByVal</span> <span>lMax</span> <span>As</span> <span>Long</span> <span>=</span> <span>2147483647</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6872" data-line-number="6872"></td>
          <td id="LC6872">    <span>Select</span> <span>Case</span> <span>lValue</span></td>
        </tr>
        <tr>
          <td id="L6873" data-line-number="6873"></td>
          <td id="LC6873">    <span>Case</span> <span>lMin</span> <span>To</span> <span>lMax</span></td>
        </tr>
        <tr>
          <td id="L6874" data-line-number="6874"></td>
          <td id="LC6874">        <span>Clamp</span> <span>=</span> <span>lValue</span></td>
        </tr>
        <tr>
          <td id="L6875" data-line-number="6875"></td>
          <td id="LC6875">    <span>Case</span> <span>Is</span> <span>&lt;</span> <span>lMin</span></td>
        </tr>
        <tr>
          <td id="L6876" data-line-number="6876"></td>
          <td id="LC6876">        <span>Clamp</span> <span>=</span> <span>lMin</span></td>
        </tr>
        <tr>
          <td id="L6877" data-line-number="6877"></td>
          <td id="LC6877">    <span>Case</span> <span>Is</span> <span>&gt;</span> <span>lMax</span></td>
        </tr>
        <tr>
          <td id="L6878" data-line-number="6878"></td>
          <td id="LC6878">        <span>Clamp</span> <span>=</span> <span>lMax</span></td>
        </tr>
        <tr>
          <td id="L6879" data-line-number="6879"></td>
          <td id="LC6879">    <span>End</span> <span>Select</span></td>
        </tr>
        <tr>
          <td id="L6880" data-line-number="6880"></td>
          <td id="LC6880"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6881" data-line-number="6881"></td>
          <td id="LC6881">
</td>
        </tr>
        <tr>
          <td id="L6882" data-line-number="6882"></td>
          <td id="LC6882"><span>Private</span> <span>Property</span> <span>Get</span> <span>OsVersion()</span> <span>As</span> <span>UcsOsVersionEnum</span></td>
        </tr>
        <tr>
          <td id="L6883" data-line-number="6883"></td>
          <td id="LC6883">    <span>Static</span> <span>lVersion</span>     <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6884" data-line-number="6884"></td>
          <td id="LC6884">    <span>Dim</span> <span>aVer(</span><span>0</span> <span>To</span> <span>69</span><span>)</span>   <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6885" data-line-number="6885"></td>
          <td id="LC6885">    </td>
        </tr>
        <tr>
          <td id="L6886" data-line-number="6886"></td>
          <td id="LC6886">    <span>If</span> <span>lVersion</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6887" data-line-number="6887"></td>
          <td id="LC6887">        <span>aVer(</span><span>0</span><span>)</span> <span>=</span> <span>LenB(aVer(</span><span>0</span><span>))</span> <span>*</span> <span>UBound(aVer)</span>  <span>&#39;--- [0] = dwOSVersionInfoSize</span></td>
        </tr>
        <tr>
          <td id="L6888" data-line-number="6888"></td>
          <td id="LC6888">        <span>If</span> <span>GetVersionEx(aVer(</span><span>0</span><span>))</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6889" data-line-number="6889"></td>
          <td id="LC6889">            <span>lVersion</span> <span>=</span> <span>aVer(</span><span>1</span><span>)</span> <span>*</span> <span>100</span> <span>+</span> <span>aVer(</span><span>2</span><span>)</span>  <span>&#39;--- [1] = dwMajorVersion, [2] = dwMinorVersion</span></td>
        </tr>
        <tr>
          <td id="L6890" data-line-number="6890"></td>
          <td id="LC6890">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6891" data-line-number="6891"></td>
          <td id="LC6891">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6892" data-line-number="6892"></td>
          <td id="LC6892">    <span>OsVersion</span> <span>=</span> <span>lVersion</span></td>
        </tr>
        <tr>
          <td id="L6893" data-line-number="6893"></td>
          <td id="LC6893"><span>End</span> <span>Property</span></td>
        </tr>
        <tr>
          <td id="L6894" data-line-number="6894"></td>
          <td id="LC6894"><span>#</span><span>End</span> <span>If</span> <span>&#39; Not ImplUseShared</span></td>
        </tr>
        <tr>
          <td id="L6895" data-line-number="6895"></td>
          <td id="LC6895">
</td>
        </tr>
        <tr>
          <td id="L6896" data-line-number="6896"></td>
          <td id="LC6896"><span>#</span><span>If</span> <span>(ImplCaptureTraffic</span> <span>And</span> <span>1</span><span>)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6897" data-line-number="6897"></td>
          <td id="LC6897"><span>Public</span> <span>Function</span> <span>TlsDesignDumpArray(baData()</span> <span>As</span> <span>Byte</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Pos</span> <span>As</span> <span>Long</span><span>,</span> <span>Optional</span> <span>ByVal</span> <span>Size</span> <span>As</span> <span>Long</span> <span>=</span> <span>-</span><span>1</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6898" data-line-number="6898"></td>
          <td id="LC6898">    <span>If</span> <span>Size</span> <span>&lt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6899" data-line-number="6899"></td>
          <td id="LC6899">        <span>Size</span> <span>=</span> <span>UBound(baData)</span> <span>+</span> <span>1</span> <span>-</span> <span>Pos</span></td>
        </tr>
        <tr>
          <td id="L6900" data-line-number="6900"></td>
          <td id="LC6900">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6901" data-line-number="6901"></td>
          <td id="LC6901">    <span>If</span> <span>Size</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6902" data-line-number="6902"></td>
          <td id="LC6902">        <span>TlsDesignDumpArray</span> <span>=</span> <span>TlsDesignDumpMemory(VarPtr(baData(Pos)),</span> <span>Size)</span></td>
        </tr>
        <tr>
          <td id="L6903" data-line-number="6903"></td>
          <td id="LC6903">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6904" data-line-number="6904"></td>
          <td id="LC6904"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6905" data-line-number="6905"></td>
          <td id="LC6905">
</td>
        </tr>
        <tr>
          <td id="L6906" data-line-number="6906"></td>
          <td id="LC6906"><span>Public</span> <span>Function</span> <span>TlsDesignDumpMemory(</span><span>ByVal</span> <span>lPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6907" data-line-number="6907"></td>
          <td id="LC6907">    <span>Dim</span> <span>lIdx</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6908" data-line-number="6908"></td>
          <td id="LC6908">    <span>Dim</span> <span>sHex</span>            <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6909" data-line-number="6909"></td>
          <td id="LC6909">    <span>Dim</span> <span>sChar</span>           <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6910" data-line-number="6910"></td>
          <td id="LC6910">    <span>Dim</span> <span>lValue</span>          <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6911" data-line-number="6911"></td>
          <td id="LC6911">    <span>Dim</span> <span>aResult()</span>       <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6912" data-line-number="6912"></td>
          <td id="LC6912">    </td>
        </tr>
        <tr>
          <td id="L6913" data-line-number="6913"></td>
          <td id="LC6913">    <span>ReDim</span> <span>aResult(</span><span>0</span> <span>To</span> <span>(lSize</span> <span>+</span> <span>15</span><span>)</span> <span>\</span> <span>16</span><span>)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6914" data-line-number="6914"></td>
          <td id="LC6914">    <span>Debug.Assert</span> <span>RedimStats(</span><span>&#34;TlsDesignDumpMemory.aResult&#34;</span><span>,</span> <span>UBound(aResult)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6915" data-line-number="6915"></td>
          <td id="LC6915">    <span>For</span> <span>lIdx</span> <span>=</span> <span>0</span> <span>To</span> <span>((lSize</span> <span>+</span> <span>15</span><span>)</span> <span>\</span> <span>16</span><span>)</span> <span>*</span> <span>16</span></td>
        </tr>
        <tr>
          <td id="L6916" data-line-number="6916"></td>
          <td id="LC6916">        <span>If</span> <span>lIdx</span> <span>&lt;</span> <span>lSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6917" data-line-number="6917"></td>
          <td id="LC6917">            <span>If</span> <span>IsBadReadPtr(lPtr,</span> <span>1</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6918" data-line-number="6918"></td>
          <td id="LC6918">                <span>Call</span> <span>CopyMemory(lValue,</span> <span>ByVal</span> <span>lPtr,</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6919" data-line-number="6919"></td>
          <td id="LC6919">                <span>sHex</span> <span>=</span> <span>sHex</span> <span>&amp;</span> <span>Right$(</span><span>&#34;0&#34;</span> <span>&amp;</span> <span>Hex$(lValue),</span> <span>2</span><span>)</span> <span>&amp;</span> <span>&#34; &#34;</span></td>
        </tr>
        <tr>
          <td id="L6920" data-line-number="6920"></td>
          <td id="LC6920">                <span>If</span> <span>lValue</span> <span>&gt;=</span> <span>32</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6921" data-line-number="6921"></td>
          <td id="LC6921">                    <span>sChar</span> <span>=</span> <span>sChar</span> <span>&amp;</span> <span>Chr$(lValue)</span></td>
        </tr>
        <tr>
          <td id="L6922" data-line-number="6922"></td>
          <td id="LC6922">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6923" data-line-number="6923"></td>
          <td id="LC6923">                    <span>sChar</span> <span>=</span> <span>sChar</span> <span>&amp;</span> <span>&#34;.&#34;</span></td>
        </tr>
        <tr>
          <td id="L6924" data-line-number="6924"></td>
          <td id="LC6924">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6925" data-line-number="6925"></td>
          <td id="LC6925">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6926" data-line-number="6926"></td>
          <td id="LC6926">                <span>sHex</span> <span>=</span> <span>sHex</span> <span>&amp;</span> <span>&#34;?? &#34;</span></td>
        </tr>
        <tr>
          <td id="L6927" data-line-number="6927"></td>
          <td id="LC6927">                <span>sChar</span> <span>=</span> <span>sChar</span> <span>&amp;</span> <span>&#34;.&#34;</span></td>
        </tr>
        <tr>
          <td id="L6928" data-line-number="6928"></td>
          <td id="LC6928">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6929" data-line-number="6929"></td>
          <td id="LC6929">        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L6930" data-line-number="6930"></td>
          <td id="LC6930">            <span>sHex</span> <span>=</span> <span>sHex</span> <span>&amp;</span> <span>&#34;   &#34;</span></td>
        </tr>
        <tr>
          <td id="L6931" data-line-number="6931"></td>
          <td id="LC6931">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6932" data-line-number="6932"></td>
          <td id="LC6932">        <span>If</span> <span>((lIdx</span> <span>+</span> <span>1</span><span>)</span> <span>Mod</span> <span>4</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6933" data-line-number="6933"></td>
          <td id="LC6933">            <span>sHex</span> <span>=</span> <span>sHex</span> <span>&amp;</span> <span>&#34; &#34;</span></td>
        </tr>
        <tr>
          <td id="L6934" data-line-number="6934"></td>
          <td id="LC6934">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6935" data-line-number="6935"></td>
          <td id="LC6935">        <span>If</span> <span>((lIdx</span> <span>+</span> <span>1</span><span>)</span> <span>Mod</span> <span>16</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6936" data-line-number="6936"></td>
          <td id="LC6936">            <span>aResult(lIdx</span> <span>\</span> <span>16</span><span>)</span> <span>=</span> <span>Right$(</span><span>&#34;000&#34;</span> <span>&amp;</span> <span>Hex$(lIdx</span> <span>-</span> <span>15</span><span>),</span> <span>4</span><span>)</span> <span>&amp;</span> <span>&#34; - &#34;</span> <span>&amp;</span> <span>sHex</span> <span>&amp;</span> <span>sChar</span></td>
        </tr>
        <tr>
          <td id="L6937" data-line-number="6937"></td>
          <td id="LC6937">            <span>sHex</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L6938" data-line-number="6938"></td>
          <td id="LC6938">            <span>sChar</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L6939" data-line-number="6939"></td>
          <td id="LC6939">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6940" data-line-number="6940"></td>
          <td id="LC6940">        <span>lPtr</span> <span>=</span> <span>(lPtr</span> <span>Xor</span> <span>&amp;H80000000</span><span>)</span> <span>+</span> <span>1</span> <span>Xor</span> <span>&amp;H80000000</span></td>
        </tr>
        <tr>
          <td id="L6941" data-line-number="6941"></td>
          <td id="LC6941">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6942" data-line-number="6942"></td>
          <td id="LC6942">    <span>TlsDesignDumpMemory</span> <span>=</span> <span>Join</span><span>(aResult,</span> <span>vbCrLf)</span></td>
        </tr>
        <tr>
          <td id="L6943" data-line-number="6943"></td>
          <td id="LC6943"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6944" data-line-number="6944"></td>
          <td id="LC6944">
</td>
        </tr>
        <tr>
          <td id="L6945" data-line-number="6945"></td>
          <td id="LC6945"><span>Public</span> <span>Function</span> <span>TlsConcatCollection(oCol</span> <span>As</span> <span>Collection,</span> <span>Optional</span> <span>Separator</span> <span>As</span> <span>String</span> <span>=</span> <span>vbCrLf)</span> <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6946" data-line-number="6946"></td>
          <td id="LC6946">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6947" data-line-number="6947"></td>
          <td id="LC6947">    <span>Dim</span> <span>vElem</span>           <span>As</span> <span>Variant</span></td>
        </tr>
        <tr>
          <td id="L6948" data-line-number="6948"></td>
          <td id="LC6948">    </td>
        </tr>
        <tr>
          <td id="L6949" data-line-number="6949"></td>
          <td id="LC6949">    <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>oCol</span></td>
        </tr>
        <tr>
          <td id="L6950" data-line-number="6950"></td>
          <td id="LC6950">        <span>lSize</span> <span>=</span> <span>lSize</span> <span>+</span> <span>Len(vElem)</span> <span>+</span> <span>Len(Separator)</span></td>
        </tr>
        <tr>
          <td id="L6951" data-line-number="6951"></td>
          <td id="LC6951">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6952" data-line-number="6952"></td>
          <td id="LC6952">    <span>If</span> <span>lSize</span> <span>&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6953" data-line-number="6953"></td>
          <td id="LC6953">        <span>TlsConcatCollection</span> <span>=</span> <span>String</span>$<span>(lSize</span> <span>-</span> <span>Len(Separator),</span> <span>0</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6954" data-line-number="6954"></td>
          <td id="LC6954">        <span>lSize</span> <span>=</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L6955" data-line-number="6955"></td>
          <td id="LC6955">        <span>For</span> <span>Each</span> <span>vElem</span> <span>In</span> <span>oCol</span></td>
        </tr>
        <tr>
          <td id="L6956" data-line-number="6956"></td>
          <td id="LC6956">            <span>If</span> <span>lSize</span> <span>&lt;=</span> <span>Len(TlsConcatCollection)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6957" data-line-number="6957"></td>
          <td id="LC6957">                <span>Mid$(TlsConcatCollection,</span> <span>lSize,</span> <span>Len(vElem)</span> <span>+</span> <span>Len(Separator))</span> <span>=</span> <span>vElem</span> <span>&amp;</span> <span>Separator</span></td>
        </tr>
        <tr>
          <td id="L6958" data-line-number="6958"></td>
          <td id="LC6958">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6959" data-line-number="6959"></td>
          <td id="LC6959">            <span>lSize</span> <span>=</span> <span>lSize</span> <span>+</span> <span>Len(vElem)</span> <span>+</span> <span>Len(Separator)</span></td>
        </tr>
        <tr>
          <td id="L6960" data-line-number="6960"></td>
          <td id="LC6960">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L6961" data-line-number="6961"></td>
          <td id="LC6961">    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L6962" data-line-number="6962"></td>
          <td id="LC6962"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L6963" data-line-number="6963"></td>
          <td id="LC6963"><span>#</span><span>End</span> <span>If</span> <span>&#39; ImplCaptureTraffic</span></td>
        </tr>
        <tr>
          <td id="L6964" data-line-number="6964"></td>
          <td id="LC6964">
</td>
        </tr>
        <tr>
          <td id="L6965" data-line-number="6965"></td>
          <td id="LC6965"><span>#</span><span>If</span> <span>ImplTestCrypto</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6966" data-line-number="6966"></td>
          <td id="LC6966">
</td>
        </tr>
        <tr>
          <td id="L6967" data-line-number="6967"></td>
          <td id="LC6967"><span>Public</span> <span>Sub</span> <span>TestCryptoAesGcm(oJson</span> <span>As</span> <span>Object</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6968" data-line-number="6968"></td>
          <td id="LC6968">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TlsTestCryptoAesGcm&#34;</span></td>
        </tr>
        <tr>
          <td id="L6969" data-line-number="6969"></td>
          <td id="LC6969">    <span>Dim</span> <span>oGroup</span>          <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L6970" data-line-number="6970"></td>
          <td id="LC6970">    <span>Dim</span> <span>oTest</span>           <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L6971" data-line-number="6971"></td>
          <td id="LC6971">    <span>Dim</span> <span>sComment</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6972" data-line-number="6972"></td>
          <td id="LC6972">    <span>Dim</span> <span>sResult</span>         <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L6973" data-line-number="6973"></td>
          <td id="LC6973">    <span>Dim</span> <span>lPassed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6974" data-line-number="6974"></td>
          <td id="LC6974">    <span>Dim</span> <span>lFailed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6975" data-line-number="6975"></td>
          <td id="LC6975">    <span>Dim</span> <span>lSkipped</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L6976" data-line-number="6976"></td>
          <td id="LC6976">    <span>&#39;--- local</span></td>
        </tr>
        <tr>
          <td id="L6977" data-line-number="6977"></td>
          <td id="LC6977">    <span>Dim</span> <span>baNonce()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6978" data-line-number="6978"></td>
          <td id="LC6978">    <span>Dim</span> <span>baKey()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6979" data-line-number="6979"></td>
          <td id="LC6979">    <span>Dim</span> <span>baAad()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6980" data-line-number="6980"></td>
          <td id="LC6980">    <span>Dim</span> <span>baMsg()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6981" data-line-number="6981"></td>
          <td id="LC6981">    <span>Dim</span> <span>baCt()</span>          <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6982" data-line-number="6982"></td>
          <td id="LC6982">    <span>Dim</span> <span>baTag()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6983" data-line-number="6983"></td>
          <td id="LC6983">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6984" data-line-number="6984"></td>
          <td id="LC6984">    </td>
        </tr>
        <tr>
          <td id="L6985" data-line-number="6985"></td>
          <td id="LC6985">    <span>pvCryptoInit</span></td>
        </tr>
        <tr>
          <td id="L6986" data-line-number="6986"></td>
          <td id="LC6986">    <span>For</span> <span>Each</span> <span>oGroup</span> <span>In</span> <span>JsonValue(oJson,</span> <span>&#34;testGroups&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6987" data-line-number="6987"></td>
          <td id="LC6987">        <span>For</span> <span>Each</span> <span>oTest</span> <span>In</span> <span>JsonValue(oGroup,</span> <span>&#34;tests&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L6988" data-line-number="6988"></td>
          <td id="LC6988">            <span>baNonce</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;iv&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6989" data-line-number="6989"></td>
          <td id="LC6989">            <span>If</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_AESGCM_IVSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6990" data-line-number="6990"></td>
          <td id="LC6990">                <span>baKey</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;key&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6991" data-line-number="6991"></td>
          <td id="LC6991">                <span>If</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES128_KEYSZ</span> <span>Or</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES256_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L6992" data-line-number="6992"></td>
          <td id="LC6992">                    <span>baAad</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;aad&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6993" data-line-number="6993"></td>
          <td id="LC6993">                    <span>baMsg</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;msg&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6994" data-line-number="6994"></td>
          <td id="LC6994">                    <span>baCt</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;ct&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6995" data-line-number="6995"></td>
          <td id="LC6995">                    <span>baTag</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;tag&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L6996" data-line-number="6996"></td>
          <td id="LC6996">                    <span>baBuffer</span> <span>=</span> <span>baMsg</span></td>
        </tr>
        <tr>
          <td id="L6997" data-line-number="6997"></td>
          <td id="LC6997">                    <span>ReDim</span> <span>Preserve</span> <span>baBuffer(</span><span>0</span> <span>To</span> <span>UBound(baMsg)</span> <span>+</span> <span>UBound(baTag)</span> <span>+</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L6998" data-line-number="6998"></td>
          <td id="LC6998">                    <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L6999" data-line-number="6999"></td>
          <td id="LC6999">                    <span>If</span> <span>Not</span> <span>pvCryptoBulkAesGcmEncrypt(baNonce,</span> <span>baKey,</span> <span>baAad,</span> <span>0</span><span>,</span> <span>UBound(baAad)</span> <span>+</span> <span>1</span><span>,</span> <span>baBuffer,</span> <span>0</span><span>,</span> <span>UBound(baMsg)</span> <span>+</span> <span>1</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7000" data-line-number="7000"></td>
          <td id="LC7000">                        <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7001" data-line-number="7001"></td>
          <td id="LC7001">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7002" data-line-number="7002"></td>
          <td id="LC7002">                        <span>pvArrayWriteBlob</span> <span>baCt,</span> <span>UBound(baCt)</span> <span>+</span> <span>1</span><span>,</span> <span>VarPtr(baTag(</span><span>0</span><span>)),</span> <span>UBound(baTag)</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7003" data-line-number="7003"></td>
          <td id="LC7003">                        <span>If</span> <span>Not</span> <span>pvArrayEqual(baBuffer,</span> <span>baCt)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7004" data-line-number="7004"></td>
          <td id="LC7004">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7005" data-line-number="7005"></td>
          <td id="LC7005">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7006" data-line-number="7006"></td>
          <td id="LC7006">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7007" data-line-number="7007"></td>
          <td id="LC7007">                    <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7008" data-line-number="7008"></td>
          <td id="LC7008">                        <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7009" data-line-number="7009"></td>
          <td id="LC7009">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7010" data-line-number="7010"></td>
          <td id="LC7010">                        <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7011" data-line-number="7011"></td>
          <td id="LC7011">                        <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7012" data-line-number="7012"></td>
          <td id="LC7012">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span></td>
        </tr>
        <tr>
          <td id="L7013" data-line-number="7013"></td>
          <td id="LC7013">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7014" data-line-number="7014"></td>
          <td id="LC7014">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7015" data-line-number="7015"></td>
          <td id="LC7015">                    <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7016" data-line-number="7016"></td>
          <td id="LC7016">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7017" data-line-number="7017"></td>
          <td id="LC7017">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7018" data-line-number="7018"></td>
          <td id="LC7018">                <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7019" data-line-number="7019"></td>
          <td id="LC7019">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7020" data-line-number="7020"></td>
          <td id="LC7020">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7021" data-line-number="7021"></td>
          <td id="LC7021">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7022" data-line-number="7022"></td>
          <td id="LC7022">    <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[+] Passed=&#34;</span> <span>&amp;</span> <span>lPassed</span> <span>&amp;</span> <span>&#34;, Failed=&#34;</span> <span>&amp;</span> <span>lFailed</span> <span>&amp;</span> <span>&#34;, Skipped=&#34;</span> <span>&amp;</span> <span>lSkipped</span></td>
        </tr>
        <tr>
          <td id="L7023" data-line-number="7023"></td>
          <td id="LC7023"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7024" data-line-number="7024"></td>
          <td id="LC7024">
</td>
        </tr>
        <tr>
          <td id="L7025" data-line-number="7025"></td>
          <td id="LC7025"><span>Public</span> <span>Sub</span> <span>TestCryptoAesCbc(oJson</span> <span>As</span> <span>Object</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7026" data-line-number="7026"></td>
          <td id="LC7026">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TlsTestCryptoAesCbc&#34;</span></td>
        </tr>
        <tr>
          <td id="L7027" data-line-number="7027"></td>
          <td id="LC7027">    <span>Dim</span> <span>oGroup</span>          <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7028" data-line-number="7028"></td>
          <td id="LC7028">    <span>Dim</span> <span>oTest</span>           <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7029" data-line-number="7029"></td>
          <td id="LC7029">    <span>Dim</span> <span>sComment</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7030" data-line-number="7030"></td>
          <td id="LC7030">    <span>Dim</span> <span>sResult</span>         <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7031" data-line-number="7031"></td>
          <td id="LC7031">    <span>Dim</span> <span>lPassed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7032" data-line-number="7032"></td>
          <td id="LC7032">    <span>Dim</span> <span>lFailed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7033" data-line-number="7033"></td>
          <td id="LC7033">    <span>Dim</span> <span>lSkipped</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7034" data-line-number="7034"></td>
          <td id="LC7034">    <span>&#39;--- local</span></td>
        </tr>
        <tr>
          <td id="L7035" data-line-number="7035"></td>
          <td id="LC7035">    <span>Dim</span> <span>baNonce()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7036" data-line-number="7036"></td>
          <td id="LC7036">    <span>Dim</span> <span>baKey()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7037" data-line-number="7037"></td>
          <td id="LC7037">    <span>Dim</span> <span>baMsg()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7038" data-line-number="7038"></td>
          <td id="LC7038">    <span>Dim</span> <span>baCt()</span>          <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7039" data-line-number="7039"></td>
          <td id="LC7039">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7040" data-line-number="7040"></td>
          <td id="LC7040">    <span>Dim</span> <span>lPadding</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7041" data-line-number="7041"></td>
          <td id="LC7041">    <span>Dim</span> <span>baHmac(</span><span>0</span> <span>To</span> <span>15</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7042" data-line-number="7042"></td>
          <td id="LC7042">    </td>
        </tr>
        <tr>
          <td id="L7043" data-line-number="7043"></td>
          <td id="LC7043">    <span>pvCryptoInit</span></td>
        </tr>
        <tr>
          <td id="L7044" data-line-number="7044"></td>
          <td id="LC7044">    <span>For</span> <span>Each</span> <span>oGroup</span> <span>In</span> <span>JsonValue(oJson,</span> <span>&#34;testGroups&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7045" data-line-number="7045"></td>
          <td id="LC7045">        <span>For</span> <span>Each</span> <span>oTest</span> <span>In</span> <span>JsonValue(oGroup,</span> <span>&#34;tests&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7046" data-line-number="7046"></td>
          <td id="LC7046">            <span>baNonce</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;iv&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7047" data-line-number="7047"></td>
          <td id="LC7047">            <span>If</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7048" data-line-number="7048"></td>
          <td id="LC7048">                <span>baKey</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;key&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7049" data-line-number="7049"></td>
          <td id="LC7049">                <span>If</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES128_KEYSZ</span> <span>Or</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_AES256_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7050" data-line-number="7050"></td>
          <td id="LC7050">                    <span>baMsg</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;msg&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7051" data-line-number="7051"></td>
          <td id="LC7051">                    <span>baCt</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;ct&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7052" data-line-number="7052"></td>
          <td id="LC7052">                    <span>baBuffer</span> <span>=</span> <span>baMsg</span></td>
        </tr>
        <tr>
          <td id="L7053" data-line-number="7053"></td>
          <td id="LC7053">                    <span>&#39;--- PKCS5 padding (note: different than padding for TLS in pvBufferWriteRecordEnd)</span></td>
        </tr>
        <tr>
          <td id="L7054" data-line-number="7054"></td>
          <td id="LC7054">                    <span>lPadding</span> <span>=</span> <span>LNG_AESCBC_IVSZ</span> <span>-</span> <span>pvArraySize(baMsg)</span> <span>Mod</span> <span>LNG_AESCBC_IVSZ</span></td>
        </tr>
        <tr>
          <td id="L7055" data-line-number="7055"></td>
          <td id="LC7055">                    <span>Debug.Assert</span> <span>lPadding</span> <span>&lt;=</span> <span>pvArraySize(baHmac)</span></td>
        </tr>
        <tr>
          <td id="L7056" data-line-number="7056"></td>
          <td id="LC7056">                    <span>Call</span> <span>FillMemory(baHmac(</span><span>0</span><span>),</span> <span>lPadding,</span> <span>lPadding)</span></td>
        </tr>
        <tr>
          <td id="L7057" data-line-number="7057"></td>
          <td id="LC7057">                    <span>pvArrayWriteBlob</span> <span>baBuffer,</span> <span>UBound(baBuffer)</span> <span>+</span> <span>1</span><span>,</span> <span>VarPtr(baHmac(</span><span>0</span><span>)),</span> <span>lPadding</span></td>
        </tr>
        <tr>
          <td id="L7058" data-line-number="7058"></td>
          <td id="LC7058">                    <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7059" data-line-number="7059"></td>
          <td id="LC7059">                    <span>If</span> <span>Not</span> <span>pvCryptoBulkAesCbcEncrypt(baNonce,</span> <span>baKey,</span> <span>baBuffer,</span> <span>0</span><span>,</span> <span>UBound(baBuffer)</span> <span>+</span> <span>1</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7060" data-line-number="7060"></td>
          <td id="LC7060">                        <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7061" data-line-number="7061"></td>
          <td id="LC7061">                    <span>ElseIf</span> <span>Not</span> <span>pvArrayEqual(baBuffer,</span> <span>baCt)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7062" data-line-number="7062"></td>
          <td id="LC7062">                        <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7063" data-line-number="7063"></td>
          <td id="LC7063">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7064" data-line-number="7064"></td>
          <td id="LC7064">                    <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7065" data-line-number="7065"></td>
          <td id="LC7065">                        <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7066" data-line-number="7066"></td>
          <td id="LC7066">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7067" data-line-number="7067"></td>
          <td id="LC7067">                        <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7068" data-line-number="7068"></td>
          <td id="LC7068">                        <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7069" data-line-number="7069"></td>
          <td id="LC7069">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span></td>
        </tr>
        <tr>
          <td id="L7070" data-line-number="7070"></td>
          <td id="LC7070">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7071" data-line-number="7071"></td>
          <td id="LC7071">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7072" data-line-number="7072"></td>
          <td id="LC7072">                    <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7073" data-line-number="7073"></td>
          <td id="LC7073">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7074" data-line-number="7074"></td>
          <td id="LC7074">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7075" data-line-number="7075"></td>
          <td id="LC7075">                <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7076" data-line-number="7076"></td>
          <td id="LC7076">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7077" data-line-number="7077"></td>
          <td id="LC7077">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7078" data-line-number="7078"></td>
          <td id="LC7078">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7079" data-line-number="7079"></td>
          <td id="LC7079">    <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[+] Passed=&#34;</span> <span>&amp;</span> <span>lPassed</span> <span>&amp;</span> <span>&#34;, Failed=&#34;</span> <span>&amp;</span> <span>lFailed</span> <span>&amp;</span> <span>&#34;, Skipped=&#34;</span> <span>&amp;</span> <span>lSkipped</span></td>
        </tr>
        <tr>
          <td id="L7080" data-line-number="7080"></td>
          <td id="LC7080"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7081" data-line-number="7081"></td>
          <td id="LC7081">
</td>
        </tr>
        <tr>
          <td id="L7082" data-line-number="7082"></td>
          <td id="LC7082"><span>Public</span> <span>Sub</span> <span>TestCryptoChacha20(oJson</span> <span>As</span> <span>Object</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7083" data-line-number="7083"></td>
          <td id="LC7083">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TlsTestCryptoChacha20&#34;</span></td>
        </tr>
        <tr>
          <td id="L7084" data-line-number="7084"></td>
          <td id="LC7084">    <span>Dim</span> <span>oGroup</span>          <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7085" data-line-number="7085"></td>
          <td id="LC7085">    <span>Dim</span> <span>oTest</span>           <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7086" data-line-number="7086"></td>
          <td id="LC7086">    <span>Dim</span> <span>sComment</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7087" data-line-number="7087"></td>
          <td id="LC7087">    <span>Dim</span> <span>sResult</span>         <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7088" data-line-number="7088"></td>
          <td id="LC7088">    <span>Dim</span> <span>lPassed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7089" data-line-number="7089"></td>
          <td id="LC7089">    <span>Dim</span> <span>lFailed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7090" data-line-number="7090"></td>
          <td id="LC7090">    <span>Dim</span> <span>lSkipped</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7091" data-line-number="7091"></td>
          <td id="LC7091">    <span>&#39;--- local</span></td>
        </tr>
        <tr>
          <td id="L7092" data-line-number="7092"></td>
          <td id="LC7092">    <span>Dim</span> <span>baNonce()</span>       <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7093" data-line-number="7093"></td>
          <td id="LC7093">    <span>Dim</span> <span>baKey()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7094" data-line-number="7094"></td>
          <td id="LC7094">    <span>Dim</span> <span>baAad()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7095" data-line-number="7095"></td>
          <td id="LC7095">    <span>Dim</span> <span>baMsg()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7096" data-line-number="7096"></td>
          <td id="LC7096">    <span>Dim</span> <span>baCt()</span>          <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7097" data-line-number="7097"></td>
          <td id="LC7097">    <span>Dim</span> <span>baTag()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7098" data-line-number="7098"></td>
          <td id="LC7098">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7099" data-line-number="7099"></td>
          <td id="LC7099">    </td>
        </tr>
        <tr>
          <td id="L7100" data-line-number="7100"></td>
          <td id="LC7100">    <span>pvCryptoInit</span></td>
        </tr>
        <tr>
          <td id="L7101" data-line-number="7101"></td>
          <td id="LC7101">    <span>For</span> <span>Each</span> <span>oGroup</span> <span>In</span> <span>JsonValue(oJson,</span> <span>&#34;testGroups&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7102" data-line-number="7102"></td>
          <td id="LC7102">        <span>For</span> <span>Each</span> <span>oTest</span> <span>In</span> <span>JsonValue(oGroup,</span> <span>&#34;tests&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7103" data-line-number="7103"></td>
          <td id="LC7103">            <span>baNonce</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;iv&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7104" data-line-number="7104"></td>
          <td id="LC7104">            <span>If</span> <span>pvArraySize(baNonce)</span> <span>=</span> <span>LNG_CHACHA20POLY1305_IVSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7105" data-line-number="7105"></td>
          <td id="LC7105">                <span>baKey</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;key&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7106" data-line-number="7106"></td>
          <td id="LC7106">                <span>If</span> <span>pvArraySize(baKey)</span> <span>=</span> <span>LNG_CHACHA20_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7107" data-line-number="7107"></td>
          <td id="LC7107">                    <span>baAad</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;aad&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7108" data-line-number="7108"></td>
          <td id="LC7108">                    <span>baMsg</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;msg&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7109" data-line-number="7109"></td>
          <td id="LC7109">                    <span>baCt</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;ct&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7110" data-line-number="7110"></td>
          <td id="LC7110">                    <span>baTag</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;tag&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7111" data-line-number="7111"></td>
          <td id="LC7111">                    <span>baBuffer</span> <span>=</span> <span>baMsg</span></td>
        </tr>
        <tr>
          <td id="L7112" data-line-number="7112"></td>
          <td id="LC7112">                    <span>ReDim</span> <span>Preserve</span> <span>baBuffer(</span><span>0</span> <span>To</span> <span>UBound(baMsg)</span> <span>+</span> <span>UBound(baTag)</span> <span>+</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7113" data-line-number="7113"></td>
          <td id="LC7113">                    <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7114" data-line-number="7114"></td>
          <td id="LC7114">                    <span>If</span> <span>Not</span> <span>pvCryptoBulkChacha20Poly1305Encrypt(baNonce,</span> <span>baKey,</span> <span>baAad,</span> <span>0</span><span>,</span> <span>UBound(baAad)</span> <span>+</span> <span>1</span><span>,</span> <span>baBuffer,</span> <span>0</span><span>,</span> <span>UBound(baMsg)</span> <span>+</span> <span>1</span><span>)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7115" data-line-number="7115"></td>
          <td id="LC7115">                        <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7116" data-line-number="7116"></td>
          <td id="LC7116">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7117" data-line-number="7117"></td>
          <td id="LC7117">                        <span>pvArrayWriteBlob</span> <span>baCt,</span> <span>UBound(baCt)</span> <span>+</span> <span>1</span><span>,</span> <span>VarPtr(baTag(</span><span>0</span><span>)),</span> <span>UBound(baTag)</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7118" data-line-number="7118"></td>
          <td id="LC7118">                        <span>If</span> <span>Not</span> <span>pvArrayEqual(baBuffer,</span> <span>baCt)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7119" data-line-number="7119"></td>
          <td id="LC7119">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7120" data-line-number="7120"></td>
          <td id="LC7120">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7121" data-line-number="7121"></td>
          <td id="LC7121">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7122" data-line-number="7122"></td>
          <td id="LC7122">                    <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7123" data-line-number="7123"></td>
          <td id="LC7123">                        <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7124" data-line-number="7124"></td>
          <td id="LC7124">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7125" data-line-number="7125"></td>
          <td id="LC7125">                        <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7126" data-line-number="7126"></td>
          <td id="LC7126">                        <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7127" data-line-number="7127"></td>
          <td id="LC7127">                        <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span></td>
        </tr>
        <tr>
          <td id="L7128" data-line-number="7128"></td>
          <td id="LC7128">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7129" data-line-number="7129"></td>
          <td id="LC7129">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7130" data-line-number="7130"></td>
          <td id="LC7130">                    <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7131" data-line-number="7131"></td>
          <td id="LC7131">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7132" data-line-number="7132"></td>
          <td id="LC7132">            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7133" data-line-number="7133"></td>
          <td id="LC7133">                <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7134" data-line-number="7134"></td>
          <td id="LC7134">            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7135" data-line-number="7135"></td>
          <td id="LC7135">        <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7136" data-line-number="7136"></td>
          <td id="LC7136">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7137" data-line-number="7137"></td>
          <td id="LC7137">    <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[+] Passed=&#34;</span> <span>&amp;</span> <span>lPassed</span> <span>&amp;</span> <span>&#34;, Failed=&#34;</span> <span>&amp;</span> <span>lFailed</span> <span>&amp;</span> <span>&#34;, Skipped=&#34;</span> <span>&amp;</span> <span>lSkipped</span></td>
        </tr>
        <tr>
          <td id="L7138" data-line-number="7138"></td>
          <td id="LC7138"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7139" data-line-number="7139"></td>
          <td id="LC7139">
</td>
        </tr>
        <tr>
          <td id="L7140" data-line-number="7140"></td>
          <td id="LC7140"><span>Public</span> <span>Sub</span> <span>TestCryptoEcdh(oJson</span> <span>As</span> <span>Object</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7141" data-line-number="7141"></td>
          <td id="LC7141">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TestCryptoEcdh&#34;</span></td>
        </tr>
        <tr>
          <td id="L7142" data-line-number="7142"></td>
          <td id="LC7142">    <span>Dim</span> <span>oGroup</span>          <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7143" data-line-number="7143"></td>
          <td id="LC7143">    <span>Dim</span> <span>oTest</span>           <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7144" data-line-number="7144"></td>
          <td id="LC7144">    <span>Dim</span> <span>sComment</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7145" data-line-number="7145"></td>
          <td id="LC7145">    <span>Dim</span> <span>sResult</span>         <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7146" data-line-number="7146"></td>
          <td id="LC7146">    <span>Dim</span> <span>lPassed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7147" data-line-number="7147"></td>
          <td id="LC7147">    <span>Dim</span> <span>lFailed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7148" data-line-number="7148"></td>
          <td id="LC7148">    <span>Dim</span> <span>lSkipped</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7149" data-line-number="7149"></td>
          <td id="LC7149">    <span>&#39;--- local</span></td>
        </tr>
        <tr>
          <td id="L7150" data-line-number="7150"></td>
          <td id="LC7150">    <span>Dim</span> <span>baPublic()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7151" data-line-number="7151"></td>
          <td id="LC7151">    <span>Dim</span> <span>baPrivate()</span>     <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7152" data-line-number="7152"></td>
          <td id="LC7152">    <span>Dim</span> <span>baShared()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7153" data-line-number="7153"></td>
          <td id="LC7153">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7154" data-line-number="7154"></td>
          <td id="LC7154">    <span>Dim</span> <span>lPtr</span>            <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7155" data-line-number="7155"></td>
          <td id="LC7155">    <span>Dim</span> <span>lSize</span>           <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7156" data-line-number="7156"></td>
          <td id="LC7156">    <span>Dim</span> <span>uPublicKeyInfo</span>  <span>As</span> <span>CERT_PUBLIC_KEY_INFO</span></td>
        </tr>
        <tr>
          <td id="L7157" data-line-number="7157"></td>
          <td id="LC7157">    <span>Dim</span> <span>sFlags</span>          <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7158" data-line-number="7158"></td>
          <td id="LC7158">    <span>Dim</span> <span>sCurve</span>          <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7159" data-line-number="7159"></td>
          <td id="LC7159">
</td>
        </tr>
        <tr>
          <td id="L7160" data-line-number="7160"></td>
          <td id="LC7160">    <span>pvCryptoInit</span></td>
        </tr>
        <tr>
          <td id="L7161" data-line-number="7161"></td>
          <td id="LC7161">    <span>For</span> <span>Each</span> <span>oGroup</span> <span>In</span> <span>JsonValue(oJson,</span> <span>&#34;testGroups&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7162" data-line-number="7162"></td>
          <td id="LC7162">        <span>sCurve</span> <span>=</span> <span>JsonValue(oGroup,</span> <span>&#34;curve&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7163" data-line-number="7163"></td>
          <td id="LC7163">        <span>If</span> <span>sCurve</span> <span>=</span> <span>&#34;secp256r1&#34;</span> <span>Or</span> <span>sCurve</span> <span>=</span> <span>&#34;secp384r1&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7164" data-line-number="7164"></td>
          <td id="LC7164">            <span>For</span> <span>Each</span> <span>oTest</span> <span>In</span> <span>JsonValue(oGroup,</span> <span>&#34;tests&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7165" data-line-number="7165"></td>
          <td id="LC7165">                <span>baPublic</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;public&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7166" data-line-number="7166"></td>
          <td id="LC7166">                <span>baPrivate</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;private&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7167" data-line-number="7167"></td>
          <td id="LC7167">                <span>baShared</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;shared&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7168" data-line-number="7168"></td>
          <td id="LC7168">                <span>sFlags</span> <span>=</span> <span>Join</span><span>(JsonValue(oTest,</span> <span>&#34;flags/*&#34;</span><span>),</span> <span>&#34;, &#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7169" data-line-number="7169"></td>
          <td id="LC7169">                <span>If</span> <span>InStr(sFlags,</span> <span>&#34;InvalidAsn&#34;</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7170" data-line-number="7170"></td>
          <td id="LC7170">                    <span>If</span> <span>UBound(baPublic)</span> <span>&gt;=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7171" data-line-number="7171"></td>
          <td id="LC7171">                        <span>If</span> <span>CryptDecodeObjectEx(X509_ASN_ENCODING,</span> <span>X509_PUBLIC_KEY_INFO,</span> <span>baPublic(</span><span>0</span><span>),</span> <span>UBound(baPublic)</span> <span>+</span> <span>1</span><span>,</span> <span>CRYPT_DECODE_ALLOC_FLAG</span> <span>Or</span> <span>CRYPT_DECODE_NOCOPY_FLAG,</span> <span>0</span><span>,</span> <span>lPtr,</span> <span>lSize)</span> <span>&lt;&gt;</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7172" data-line-number="7172"></td>
          <td id="LC7172">                            <span>Call</span> <span>CopyMemory(uPublicKeyInfo,</span> <span>ByVal</span> <span>lPtr,</span> <span>LenB(uPublicKeyInfo))</span></td>
        </tr>
        <tr>
          <td id="L7173" data-line-number="7173"></td>
          <td id="LC7173">                            <span>Debug.Assert</span> <span>pvToStringA(uPublicKeyInfo.Algorithm.pszObjId)</span> <span>=</span> <span>szOID_ECC_PUBLIC_KEY</span></td>
        </tr>
        <tr>
          <td id="L7174" data-line-number="7174"></td>
          <td id="LC7174">                            <span>If</span> <span>uPublicKeyInfo.PublicKey.cbData</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7175" data-line-number="7175"></td>
          <td id="LC7175">                                <span>baPublic</span> <span>=</span> <span>vbNullString</span></td>
        </tr>
        <tr>
          <td id="L7176" data-line-number="7176"></td>
          <td id="LC7176">                            <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7177" data-line-number="7177"></td>
          <td id="LC7177">                                <span>ReDim</span> <span>baPublic(</span><span>0</span> <span>To</span> <span>uPublicKeyInfo.PublicKey.cbData</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7178" data-line-number="7178"></td>
          <td id="LC7178">                                <span>Call</span> <span>CopyMemory(baPublic(</span><span>0</span><span>),</span> <span>ByVal</span> <span>uPublicKeyInfo.PublicKey.pbData,</span> <span>UBound(baPublic)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7179" data-line-number="7179"></td>
          <td id="LC7179">                            <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7180" data-line-number="7180"></td>
          <td id="LC7180">                            <span>Call</span> <span>LocalFree(lPtr)</span></td>
        </tr>
        <tr>
          <td id="L7181" data-line-number="7181"></td>
          <td id="LC7181">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7182" data-line-number="7182"></td>
          <td id="LC7182">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7183" data-line-number="7183"></td>
          <td id="LC7183">                    <span>If</span> <span>UBound(baPrivate)</span> <span>&gt;=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7184" data-line-number="7184"></td>
          <td id="LC7184">                        <span>If</span> <span>baPrivate(</span><span>0</span><span>)</span> <span>=</span> <span>0</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7185" data-line-number="7185"></td>
          <td id="LC7185">                            <span>Call</span> <span>CopyMemory(baPrivate(</span><span>0</span><span>),</span> <span>baPrivate(</span><span>1</span><span>),</span> <span>UBound(baPrivate))</span></td>
        </tr>
        <tr>
          <td id="L7186" data-line-number="7186"></td>
          <td id="LC7186">                            <span>ReDim</span> <span>Preserve</span> <span>baPrivate(</span><span>0</span> <span>To</span> <span>UBound(baPrivate)</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7187" data-line-number="7187"></td>
          <td id="LC7187">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7188" data-line-number="7188"></td>
          <td id="LC7188">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7189" data-line-number="7189"></td>
          <td id="LC7189">                    <span>If</span> <span>sCurve</span> <span>=</span> <span>&#34;secp256r1&#34;</span> <span>And</span> <span>UBound(baPrivate)</span> <span>=</span> <span>LNG_SECP256R1_KEYSZ</span> <span>-</span> <span>1</span> <span>And</span> <span>UBound(baPublic)</span> <span>&gt;=</span> <span>LNG_SECP256R1_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7190" data-line-number="7190"></td>
          <td id="LC7190">                        <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7191" data-line-number="7191"></td>
          <td id="LC7191">                        <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp256r1SharedSecret(baBuffer,</span> <span>baPrivate,</span> <span>baPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7192" data-line-number="7192"></td>
          <td id="LC7192">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7193" data-line-number="7193"></td>
          <td id="LC7193">                        <span>ElseIf</span> <span>Not</span> <span>pvArrayEqual(baBuffer,</span> <span>baShared)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7194" data-line-number="7194"></td>
          <td id="LC7194">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7195" data-line-number="7195"></td>
          <td id="LC7195">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7196" data-line-number="7196"></td>
          <td id="LC7196">                        <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>&#34;acceptable&#34;</span> <span>And</span> <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7197" data-line-number="7197"></td>
          <td id="LC7197">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7198" data-line-number="7198"></td>
          <td id="LC7198">                        <span>ElseIf</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7199" data-line-number="7199"></td>
          <td id="LC7199">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7200" data-line-number="7200"></td>
          <td id="LC7200">                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7201" data-line-number="7201"></td>
          <td id="LC7201">                            <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7202" data-line-number="7202"></td>
          <td id="LC7202">                            <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7203" data-line-number="7203"></td>
          <td id="LC7203">                            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>sCurve</span> <span>&amp;</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span> <span>&amp;</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7204" data-line-number="7204"></td>
          <td id="LC7204">                                <span>IIf(LenB(sFlags)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>sFlags,</span> <span>vbNullString)</span> <span>&amp;</span> <span>&#34;, sResult=&#34;</span> <span>&amp;</span> <span>sResult</span> <span>&amp;</span> <span>&#34; vs &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7205" data-line-number="7205"></td>
          <td id="LC7205">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7206" data-line-number="7206"></td>
          <td id="LC7206">                    <span>ElseIf</span> <span>sCurve</span> <span>=</span> <span>&#34;secp384r1&#34;</span> <span>And</span> <span>UBound(baPrivate)</span> <span>=</span> <span>LNG_SECP384R1_KEYSZ</span> <span>-</span> <span>1</span> <span>And</span> <span>UBound(baPublic)</span> <span>&gt;=</span> <span>LNG_SECP384R1_KEYSZ</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7207" data-line-number="7207"></td>
          <td id="LC7207">                        <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7208" data-line-number="7208"></td>
          <td id="LC7208">                        <span>If</span> <span>Not</span> <span>pvCryptoEcdhSecp384r1SharedSecret(baBuffer,</span> <span>baPrivate,</span> <span>baPublic)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7209" data-line-number="7209"></td>
          <td id="LC7209">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7210" data-line-number="7210"></td>
          <td id="LC7210">                        <span>ElseIf</span> <span>Not</span> <span>pvArrayEqual(baBuffer,</span> <span>baShared)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7211" data-line-number="7211"></td>
          <td id="LC7211">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7212" data-line-number="7212"></td>
          <td id="LC7212">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7213" data-line-number="7213"></td>
          <td id="LC7213">                        <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>&#34;acceptable&#34;</span> <span>And</span> <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7214" data-line-number="7214"></td>
          <td id="LC7214">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7215" data-line-number="7215"></td>
          <td id="LC7215">                        <span>ElseIf</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7216" data-line-number="7216"></td>
          <td id="LC7216">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7217" data-line-number="7217"></td>
          <td id="LC7217">                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7218" data-line-number="7218"></td>
          <td id="LC7218">                            <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7219" data-line-number="7219"></td>
          <td id="LC7219">                            <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7220" data-line-number="7220"></td>
          <td id="LC7220">                            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>sCurve</span> <span>&amp;</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span> <span>&amp;</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7221" data-line-number="7221"></td>
          <td id="LC7221">                                <span>IIf(LenB(sFlags)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>sFlags,</span> <span>vbNullString)</span> <span>&amp;</span> <span>&#34;, sResult=&#34;</span> <span>&amp;</span> <span>sResult</span> <span>&amp;</span> <span>&#34; vs &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7222" data-line-number="7222"></td>
          <td id="LC7222">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7223" data-line-number="7223"></td>
          <td id="LC7223">                    <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7224" data-line-number="7224"></td>
          <td id="LC7224">                        <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7225" data-line-number="7225"></td>
          <td id="LC7225">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7226" data-line-number="7226"></td>
          <td id="LC7226">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7227" data-line-number="7227"></td>
          <td id="LC7227">                    <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7228" data-line-number="7228"></td>
          <td id="LC7228">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7229" data-line-number="7229"></td>
          <td id="LC7229">            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7230" data-line-number="7230"></td>
          <td id="LC7230">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7231" data-line-number="7231"></td>
          <td id="LC7231">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7232" data-line-number="7232"></td>
          <td id="LC7232">    <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[+] Passed=&#34;</span> <span>&amp;</span> <span>lPassed</span> <span>&amp;</span> <span>&#34;, Failed=&#34;</span> <span>&amp;</span> <span>lFailed</span> <span>&amp;</span> <span>&#34;, Skipped=&#34;</span> <span>&amp;</span> <span>lSkipped</span></td>
        </tr>
        <tr>
          <td id="L7233" data-line-number="7233"></td>
          <td id="LC7233"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7234" data-line-number="7234"></td>
          <td id="LC7234">
</td>
        </tr>
        <tr>
          <td id="L7235" data-line-number="7235"></td>
          <td id="LC7235"><span>Public</span> <span>Sub</span> <span>TestCryptoEcdsa(oJson</span> <span>As</span> <span>Object</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7236" data-line-number="7236"></td>
          <td id="LC7236">    <span>Const</span> <span>FUNC_NAME</span>     <span>As</span> <span>String</span> <span>=</span> <span>&#34;TestCryptoEcdsa&#34;</span></td>
        </tr>
        <tr>
          <td id="L7237" data-line-number="7237"></td>
          <td id="LC7237">    <span>Dim</span> <span>oGroup</span>          <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7238" data-line-number="7238"></td>
          <td id="LC7238">    <span>Dim</span> <span>oTest</span>           <span>As</span> <span>Object</span></td>
        </tr>
        <tr>
          <td id="L7239" data-line-number="7239"></td>
          <td id="LC7239">    <span>Dim</span> <span>sComment</span>        <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7240" data-line-number="7240"></td>
          <td id="LC7240">    <span>Dim</span> <span>sResult</span>         <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7241" data-line-number="7241"></td>
          <td id="LC7241">    <span>Dim</span> <span>lPassed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7242" data-line-number="7242"></td>
          <td id="LC7242">    <span>Dim</span> <span>lFailed</span>         <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7243" data-line-number="7243"></td>
          <td id="LC7243">    <span>Dim</span> <span>lSkipped</span>        <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7244" data-line-number="7244"></td>
          <td id="LC7244">    <span>&#39;--- local</span></td>
        </tr>
        <tr>
          <td id="L7245" data-line-number="7245"></td>
          <td id="LC7245">    <span>Dim</span> <span>baPublic()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7246" data-line-number="7246"></td>
          <td id="LC7246">    <span>Dim</span> <span>baMsg()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7247" data-line-number="7247"></td>
          <td id="LC7247">    <span>Dim</span> <span>baSig()</span>         <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7248" data-line-number="7248"></td>
          <td id="LC7248">    <span>Dim</span> <span>baBuffer()</span>      <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7249" data-line-number="7249"></td>
          <td id="LC7249">    <span>Dim</span> <span>sFlags</span>          <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7250" data-line-number="7250"></td>
          <td id="LC7250">    <span>Dim</span> <span>sCurve</span>          <span>As</span> <span>String</span></td>
        </tr>
        <tr>
          <td id="L7251" data-line-number="7251"></td>
          <td id="LC7251">    <span>Dim</span> <span>lCurveSize</span>      <span>As</span> <span>KeyCodeConstants</span></td>
        </tr>
        <tr>
          <td id="L7252" data-line-number="7252"></td>
          <td id="LC7252">    <span>Dim</span> <span>lHashSize</span>       <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7253" data-line-number="7253"></td>
          <td id="LC7253">    <span>Dim</span> <span>baTemp()</span>        <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7254" data-line-number="7254"></td>
          <td id="LC7254">    </td>
        </tr>
        <tr>
          <td id="L7255" data-line-number="7255"></td>
          <td id="LC7255">    <span>pvCryptoInit</span></td>
        </tr>
        <tr>
          <td id="L7256" data-line-number="7256"></td>
          <td id="LC7256">    <span>For</span> <span>Each</span> <span>oGroup</span> <span>In</span> <span>JsonValue(oJson,</span> <span>&#34;testGroups&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7257" data-line-number="7257"></td>
          <td id="LC7257">        <span>sCurve</span> <span>=</span> <span>JsonValue(oGroup,</span> <span>&#34;key/curve&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7258" data-line-number="7258"></td>
          <td id="LC7258">        <span>If</span> <span>sCurve</span> <span>=</span> <span>&#34;secp256r1&#34;</span> <span>Or</span> <span>sCurve</span> <span>=</span> <span>&#34;secp384r1&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7259" data-line-number="7259"></td>
          <td id="LC7259">            <span>baPublic</span> <span>=</span> <span>FromHex(JsonValue(oGroup,</span> <span>&#34;key/uncompressed&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7260" data-line-number="7260"></td>
          <td id="LC7260">            <span>lCurveSize</span> <span>=</span> <span>JsonValue(oGroup,</span> <span>&#34;key/keySize&#34;</span><span>)</span> <span>/</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L7261" data-line-number="7261"></td>
          <td id="LC7261">            <span>lHashSize</span> <span>=</span> <span>Replace(JsonValue(oGroup,</span> <span>&#34;sha&#34;</span><span>),</span> <span>&#34;SHA-&#34;</span><span>,</span> <span>vbNullString)</span> <span>/</span> <span>8</span></td>
        </tr>
        <tr>
          <td id="L7262" data-line-number="7262"></td>
          <td id="LC7262">            <span>For</span> <span>Each</span> <span>oTest</span> <span>In</span> <span>JsonValue(oGroup,</span> <span>&#34;tests&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7263" data-line-number="7263"></td>
          <td id="LC7263">                <span>baMsg</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;msg&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7264" data-line-number="7264"></td>
          <td id="LC7264">                <span>baTemp</span> <span>=</span> <span>FromHex(JsonValue(oTest,</span> <span>&#34;sig&#34;</span><span>))</span></td>
        </tr>
        <tr>
          <td id="L7265" data-line-number="7265"></td>
          <td id="LC7265">                <span>If</span> <span>pvAsn1DecodeEcdsaSignature(baSig,</span> <span>baTemp,</span> <span>lCurveSize)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7266" data-line-number="7266"></td>
          <td id="LC7266">                    <span>sFlags</span> <span>=</span> <span>Join</span><span>(JsonValue(oTest,</span> <span>&#34;flags/*&#34;</span><span>),</span> <span>&#34;, &#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7267" data-line-number="7267"></td>
          <td id="LC7267">                    <span>pvArrayHash</span> <span>lHashSize,</span> <span>baMsg,</span> <span>baBuffer</span></td>
        </tr>
        <tr>
          <td id="L7268" data-line-number="7268"></td>
          <td id="LC7268">                    <span>If</span> <span>UBound(baBuffer)</span> <span>+</span> <span>1</span> <span>&lt;</span> <span>lCurveSize</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7269" data-line-number="7269"></td>
          <td id="LC7269">                        <span>baTemp</span> <span>=</span> <span>baBuffer</span></td>
        </tr>
        <tr>
          <td id="L7270" data-line-number="7270"></td>
          <td id="LC7270">                        <span>pvArrayAllocate</span> <span>baBuffer,</span> <span>lCurveSize,</span> <span>FUNC_NAME</span> <span>&amp;</span> <span>&#34;.baBuffer&#34;</span></td>
        </tr>
        <tr>
          <td id="L7271" data-line-number="7271"></td>
          <td id="LC7271">                        <span>Call</span> <span>CopyMemory(baBuffer(lCurveSize</span> <span>-</span> <span>UBound(baTemp)</span> <span>-</span> <span>1</span><span>),</span> <span>baTemp(</span><span>0</span><span>),</span> <span>UBound(baTemp)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7272" data-line-number="7272"></td>
          <td id="LC7272">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7273" data-line-number="7273"></td>
          <td id="LC7273">                    <span>If</span> <span>sCurve</span> <span>=</span> <span>&#34;secp256r1&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7274" data-line-number="7274"></td>
          <td id="LC7274">                        <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7275" data-line-number="7275"></td>
          <td id="LC7275">                        <span>If</span> <span>Not</span> <span>pvCryptoEcdsaSecp256r1Verify(baPublic,</span> <span>baBuffer,</span> <span>baSig)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7276" data-line-number="7276"></td>
          <td id="LC7276">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7277" data-line-number="7277"></td>
          <td id="LC7277">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7278" data-line-number="7278"></td>
          <td id="LC7278">                        <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>&#34;acceptable&#34;</span> <span>And</span> <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7279" data-line-number="7279"></td>
          <td id="LC7279">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7280" data-line-number="7280"></td>
          <td id="LC7280">                        <span>ElseIf</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7281" data-line-number="7281"></td>
          <td id="LC7281">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7282" data-line-number="7282"></td>
          <td id="LC7282">                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7283" data-line-number="7283"></td>
          <td id="LC7283">                            <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7284" data-line-number="7284"></td>
          <td id="LC7284">                            <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7285" data-line-number="7285"></td>
          <td id="LC7285">                            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>sCurve</span> <span>&amp;</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span> <span>&amp;</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7286" data-line-number="7286"></td>
          <td id="LC7286">                                <span>IIf(LenB(sFlags)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>sFlags,</span> <span>vbNullString)</span> <span>&amp;</span> <span>&#34;, sResult=&#34;</span> <span>&amp;</span> <span>sResult</span> <span>&amp;</span> <span>&#34; vs &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7287" data-line-number="7287"></td>
          <td id="LC7287">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7288" data-line-number="7288"></td>
          <td id="LC7288">                    <span>Else</span> <span>&#39; If sCurve = &#34;secp384r1&#34; Then</span></td>
        </tr>
        <tr>
          <td id="L7289" data-line-number="7289"></td>
          <td id="LC7289">                        <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7290" data-line-number="7290"></td>
          <td id="LC7290">                        <span>If</span> <span>Not</span> <span>pvCryptoEcdsaSecp384r1Verify(baPublic,</span> <span>baBuffer,</span> <span>baSig)</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7291" data-line-number="7291"></td>
          <td id="LC7291">                            <span>sResult</span> <span>=</span> <span>&#34;invalid&#34;</span></td>
        </tr>
        <tr>
          <td id="L7292" data-line-number="7292"></td>
          <td id="LC7292">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7293" data-line-number="7293"></td>
          <td id="LC7293">                        <span>If</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>&#34;acceptable&#34;</span> <span>And</span> <span>sResult</span> <span>=</span> <span>&#34;valid&#34;</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7294" data-line-number="7294"></td>
          <td id="LC7294">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7295" data-line-number="7295"></td>
          <td id="LC7295">                        <span>ElseIf</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span> <span>=</span> <span>sResult</span> <span>Then</span></td>
        </tr>
        <tr>
          <td id="L7296" data-line-number="7296"></td>
          <td id="LC7296">                            <span>lPassed</span> <span>=</span> <span>lPassed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7297" data-line-number="7297"></td>
          <td id="LC7297">                        <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7298" data-line-number="7298"></td>
          <td id="LC7298">                            <span>lFailed</span> <span>=</span> <span>lFailed</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7299" data-line-number="7299"></td>
          <td id="LC7299">                            <span>sComment</span> <span>=</span> <span>JsonValue(oTest,</span> <span>&#34;comment&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7300" data-line-number="7300"></td>
          <td id="LC7300">                            <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[-] &#34;</span> <span>&amp;</span> <span>sCurve</span> <span>&amp;</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;tcId&#34;</span><span>)</span> <span>&amp;</span> <span>IIf(LenB(sComment)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34; (&#34;</span> <span>&amp;</span> <span>sComment</span> <span>&amp;</span> <span>&#34;)&#34;</span><span>,</span> <span>vbNullString)</span> <span>&amp;</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7301" data-line-number="7301"></td>
          <td id="LC7301">                                <span>IIf(LenB(sFlags)</span> <span>&lt;&gt;</span> <span>0</span><span>,</span> <span>&#34;, &#34;</span> <span>&amp;</span> <span>sFlags,</span> <span>vbNullString)</span> <span>&amp;</span> <span>&#34;, sResult=&#34;</span> <span>&amp;</span> <span>sResult</span> <span>&amp;</span> <span>&#34; vs &#34;</span> <span>&amp;</span> <span>JsonValue(oTest,</span> <span>&#34;result&#34;</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7302" data-line-number="7302"></td>
          <td id="LC7302">                        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7303" data-line-number="7303"></td>
          <td id="LC7303">                    <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7304" data-line-number="7304"></td>
          <td id="LC7304">                <span>Else</span></td>
        </tr>
        <tr>
          <td id="L7305" data-line-number="7305"></td>
          <td id="LC7305">                    <span>lSkipped</span> <span>=</span> <span>lSkipped</span> <span>+</span> <span>1</span></td>
        </tr>
        <tr>
          <td id="L7306" data-line-number="7306"></td>
          <td id="LC7306">                <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7307" data-line-number="7307"></td>
          <td id="LC7307">            <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7308" data-line-number="7308"></td>
          <td id="LC7308">        <span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7309" data-line-number="7309"></td>
          <td id="LC7309">    <span>Next</span></td>
        </tr>
        <tr>
          <td id="L7310" data-line-number="7310"></td>
          <td id="LC7310">    <span>DebugLog</span> <span>MODULE_NAME,</span> <span>FUNC_NAME,</span> <span>&#34;[+] Passed=&#34;</span> <span>&amp;</span> <span>lPassed</span> <span>&amp;</span> <span>&#34;, Failed=&#34;</span> <span>&amp;</span> <span>lFailed</span> <span>&amp;</span> <span>&#34;, Skipped=&#34;</span> <span>&amp;</span> <span>lSkipped</span></td>
        </tr>
        <tr>
          <td id="L7311" data-line-number="7311"></td>
          <td id="LC7311"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7312" data-line-number="7312"></td>
          <td id="LC7312">
</td>
        </tr>
        <tr>
          <td id="L7313" data-line-number="7313"></td>
          <td id="LC7313"><span>#</span><span>End</span> <span>If</span> <span>&#39; ImplTestCrypto</span></td>
        </tr>
        <tr>
          <td id="L7314" data-line-number="7314"></td>
          <td id="LC7314">
</td>
        </tr>
        <tr>
          <td id="L7315" data-line-number="7315"></td>
          <td id="LC7315"><span>&#39;= trampolines ===========================================================</span></td>
        </tr>
        <tr>
          <td id="L7316" data-line-number="7316"></td>
          <td id="LC7316">
</td>
        </tr>
        <tr>
          <td id="L7317" data-line-number="7317"></td>
          <td id="LC7317"><span>Private</span> <span>Function</span> <span>pvCallCurve25519Multiply(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pSecretPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPubKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPrivKeyPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7318" data-line-number="7318"></td>
          <td id="LC7318">    <span>&#39; void cf_curve25519_mul(uint8_t out[32], const uint8_t priv[32], const uint8_t pub[32])</span></td>
        </tr>
        <tr>
          <td id="L7319" data-line-number="7319"></td>
          <td id="LC7319"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7320" data-line-number="7320"></td>
          <td id="LC7320">
</td>
        </tr>
        <tr>
          <td id="L7321" data-line-number="7321"></td>
          <td id="LC7321"><span>Private</span> <span>Function</span> <span>pvCallCurve25519MulBase(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPubKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPrivKeyPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7322" data-line-number="7322"></td>
          <td id="LC7322">    <span>&#39; void cf_curve25519_mul_base(uint8_t out[32], const uint8_t priv[32])</span></td>
        </tr>
        <tr>
          <td id="L7323" data-line-number="7323"></td>
          <td id="LC7323"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7324" data-line-number="7324"></td>
          <td id="LC7324">
</td>
        </tr>
        <tr>
          <td id="L7325" data-line-number="7325"></td>
          <td id="LC7325"><span>Private</span> <span>Function</span> <span>pvCallSecpMakeKey(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPubKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPrivKeyPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7326" data-line-number="7326"></td>
          <td id="LC7326">    <span>&#39; int ecc_make_key(uint8_t p_publicKey[ECC_BYTES+1], uint8_t p_privateKey[ECC_BYTES]);</span></td>
        </tr>
        <tr>
          <td id="L7327" data-line-number="7327"></td>
          <td id="LC7327">    <span>&#39; int ecc_make_key384(uint8_t p_publicKey[ECC_BYTES_384+1], const uint8_t p_privateKey[ECC_BYTES_384])</span></td>
        </tr>
        <tr>
          <td id="L7328" data-line-number="7328"></td>
          <td id="LC7328"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7329" data-line-number="7329"></td>
          <td id="LC7329">
</td>
        </tr>
        <tr>
          <td id="L7330" data-line-number="7330"></td>
          <td id="LC7330"><span>Private</span> <span>Function</span> <span>pvCallSecpSharedSecret(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPubKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPrivKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pSecretPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7331" data-line-number="7331"></td>
          <td id="LC7331">    <span>&#39; int ecdh_shared_secret(const uint8_t p_publicKey[ECC_BYTES+1], const uint8_t p_privateKey[ECC_BYTES], uint8_t p_secret[ECC_BYTES]);</span></td>
        </tr>
        <tr>
          <td id="L7332" data-line-number="7332"></td>
          <td id="LC7332">    <span>&#39; int ecdh_shared_secret384(const uint8_t p_publicKey[ECC_BYTES_384+1], const uint8_t p_privateKey[ECC_BYTES_384], uint8_t p_secret[ECC_BYTES_384])</span></td>
        </tr>
        <tr>
          <td id="L7333" data-line-number="7333"></td>
          <td id="LC7333"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7334" data-line-number="7334"></td>
          <td id="LC7334">
</td>
        </tr>
        <tr>
          <td id="L7335" data-line-number="7335"></td>
          <td id="LC7335"><span>Private</span> <span>Function</span> <span>pvCallSecpUncompressKey(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPubKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pUncompressedKeyPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7336" data-line-number="7336"></td>
          <td id="LC7336">    <span>&#39; int ecdh_uncompress_key(const uint8_t p_publicKey[ECC_BYTES + 1], uint8_t p_uncompressedKey[2 * ECC_BYTES + 1])</span></td>
        </tr>
        <tr>
          <td id="L7337" data-line-number="7337"></td>
          <td id="LC7337">    <span>&#39; int ecdh_uncompress_key384(const uint8_t p_publicKey[ECC_BYTES_384 + 1], uint8_t p_uncompressedKey[2 * ECC_BYTES_384 + 1])</span></td>
        </tr>
        <tr>
          <td id="L7338" data-line-number="7338"></td>
          <td id="LC7338"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7339" data-line-number="7339"></td>
          <td id="LC7339">
</td>
        </tr>
        <tr>
          <td id="L7340" data-line-number="7340"></td>
          <td id="LC7340"><span>Private</span> <span>Function</span> <span>pvCallSecpSign(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPrivKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pHashPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pRandomPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pSignaturePtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7341" data-line-number="7341"></td>
          <td id="LC7341">    <span>&#39; int ecdsa_sign(const uint8_t p_privateKey[ECC_BYTES], const uint8_t p_hash[ECC_BYTES], uint64_t k[NUM_ECC_DIGITS], uint8_t p_signature[ECC_BYTES*2])</span></td>
        </tr>
        <tr>
          <td id="L7342" data-line-number="7342"></td>
          <td id="LC7342">    <span>&#39; int ecdsa_sign384(const uint8_t p_privateKey[ECC_BYTES_384], const uint8_t p_hash[ECC_BYTES_384], uint64_t k[NUM_ECC_DIGITS_384], uint8_t p_signature[ECC_BYTES_384*2])</span></td>
        </tr>
        <tr>
          <td id="L7343" data-line-number="7343"></td>
          <td id="LC7343"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7344" data-line-number="7344"></td>
          <td id="LC7344">
</td>
        </tr>
        <tr>
          <td id="L7345" data-line-number="7345"></td>
          <td id="LC7345"><span>Private</span> <span>Function</span> <span>pvCallSecpVerify(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPubKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pHashPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pSignaturePtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7346" data-line-number="7346"></td>
          <td id="LC7346">    <span>&#39; int ecdsa_verify(const uint8_t p_publicKey[ECC_BYTES+1], const uint8_t p_hash[ECC_BYTES], const uint8_t p_signature[ECC_BYTES*2])</span></td>
        </tr>
        <tr>
          <td id="L7347" data-line-number="7347"></td>
          <td id="LC7347">    <span>&#39; int ecdsa_verify384(const uint8_t p_publicKey[ECC_BYTES_384+1], const uint8_t p_hash[ECC_BYTES_384], const uint8_t p_signature[ECC_BYTES_384*2])</span></td>
        </tr>
        <tr>
          <td id="L7348" data-line-number="7348"></td>
          <td id="LC7348"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7349" data-line-number="7349"></td>
          <td id="LC7349">
</td>
        </tr>
        <tr>
          <td id="L7350" data-line-number="7350"></td>
          <td id="LC7350"><span>Private</span> <span>Function</span> <span>pvCallSha2Init(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lCtxPtr</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7351" data-line-number="7351"></td>
          <td id="LC7351">    <span>&#39; void cf_sha256_init(cf_sha256_context *ctx)</span></td>
        </tr>
        <tr>
          <td id="L7352" data-line-number="7352"></td>
          <td id="LC7352">    <span>&#39; void cf_sha384_init(cf_sha384_context *ctx)</span></td>
        </tr>
        <tr>
          <td id="L7353" data-line-number="7353"></td>
          <td id="LC7353">    <span>&#39; void cf_sha512_init(cf_sha512_context *ctx)</span></td>
        </tr>
        <tr>
          <td id="L7354" data-line-number="7354"></td>
          <td id="LC7354"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7355" data-line-number="7355"></td>
          <td id="LC7355">
</td>
        </tr>
        <tr>
          <td id="L7356" data-line-number="7356"></td>
          <td id="LC7356"><span>Private</span> <span>Function</span> <span>pvCallSha2Update(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lCtxPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lDataPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7357" data-line-number="7357"></td>
          <td id="LC7357">    <span>&#39; void cf_sha256_update(cf_sha256_context *ctx, const void *data, size_t nbytes)</span></td>
        </tr>
        <tr>
          <td id="L7358" data-line-number="7358"></td>
          <td id="LC7358">    <span>&#39; void cf_sha384_update(cf_sha384_context *ctx, const void *data, size_t nbytes)</span></td>
        </tr>
        <tr>
          <td id="L7359" data-line-number="7359"></td>
          <td id="LC7359">    <span>&#39; void cf_sha512_update(cf_sha512_context *ctx, const void *data, size_t nbytes)</span></td>
        </tr>
        <tr>
          <td id="L7360" data-line-number="7360"></td>
          <td id="LC7360"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7361" data-line-number="7361"></td>
          <td id="LC7361">
</td>
        </tr>
        <tr>
          <td id="L7362" data-line-number="7362"></td>
          <td id="LC7362"><span>Private</span> <span>Function</span> <span>pvCallSha2Final(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lCtxPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>pHashPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7363" data-line-number="7363"></td>
          <td id="LC7363">    <span>&#39; void cf_sha256_digest_final(cf_sha256_context *ctx, uint8_t hash[LNG_SHA256_HASHSZ])</span></td>
        </tr>
        <tr>
          <td id="L7364" data-line-number="7364"></td>
          <td id="LC7364">    <span>&#39; void cf_sha384_digest_final(cf_sha384_context *ctx, uint8_t hash[LNG_SHA384_HASHSZ])</span></td>
        </tr>
        <tr>
          <td id="L7365" data-line-number="7365"></td>
          <td id="LC7365">    <span>&#39; void cf_sha512_digest_final(cf_sha512_context *ctx, uint8_t hash[LNG_SHA384_HASHSZ])</span></td>
        </tr>
        <tr>
          <td id="L7366" data-line-number="7366"></td>
          <td id="LC7366"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7367" data-line-number="7367"></td>
          <td id="LC7367">
</td>
        </tr>
        <tr>
          <td id="L7368" data-line-number="7368"></td>
          <td id="LC7368"><span>Private</span> <span>Function</span> <span>pvCallChacha20Poly1305Encrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7369" data-line-number="7369"></td>
          <td id="LC7369">            <span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pNoncePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7370" data-line-number="7370"></td>
          <td id="LC7370">            <span>ByVal</span> <span>lHeaderPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lHeaderSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7371" data-line-number="7371"></td>
          <td id="LC7371">            <span>pPlaintTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPlaintTextSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7372" data-line-number="7372"></td>
          <td id="LC7372">            <span>pCipherTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pTagPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7373" data-line-number="7373"></td>
          <td id="LC7373">    <span>&#39; void cf_chacha20poly1305_encrypt(const uint8_t key[32], const uint8_t nonce[12], const uint8_t *header, size_t nheader,</span></td>
        </tr>
        <tr>
          <td id="L7374" data-line-number="7374"></td>
          <td id="LC7374">    <span>&#39;                                  const uint8_t *plaintext, size_t nbytes, uint8_t *ciphertext, uint8_t tag[16])</span></td>
        </tr>
        <tr>
          <td id="L7375" data-line-number="7375"></td>
          <td id="LC7375"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7376" data-line-number="7376"></td>
          <td id="LC7376">
</td>
        </tr>
        <tr>
          <td id="L7377" data-line-number="7377"></td>
          <td id="LC7377"><span>Private</span> <span>Function</span> <span>pvCallChacha20Poly1305Decrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7378" data-line-number="7378"></td>
          <td id="LC7378">            <span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pNoncePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7379" data-line-number="7379"></td>
          <td id="LC7379">            <span>pHeaderPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lHeaderSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7380" data-line-number="7380"></td>
          <td id="LC7380">            <span>pCipherTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lCipherTextSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7381" data-line-number="7381"></td>
          <td id="LC7381">            <span>pTagPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPlaintTextPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7382" data-line-number="7382"></td>
          <td id="LC7382">    <span>&#39; int cf_chacha20poly1305_decrypt(const uint8_t key[32], const uint8_t nonce[12], const uint8_t *header, size_t nheader,</span></td>
        </tr>
        <tr>
          <td id="L7383" data-line-number="7383"></td>
          <td id="LC7383">    <span>&#39;                                 const uint8_t *ciphertext, size_t nbytes, const uint8_t tag[16], uint8_t *plaintext)</span></td>
        </tr>
        <tr>
          <td id="L7384" data-line-number="7384"></td>
          <td id="LC7384"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7385" data-line-number="7385"></td>
          <td id="LC7385">
</td>
        </tr>
        <tr>
          <td id="L7386" data-line-number="7386"></td>
          <td id="LC7386"><span>Private</span> <span>Function</span> <span>pvCallAesGcmEncrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7387" data-line-number="7387"></td>
          <td id="LC7387">            <span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pCipherTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pTagPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPlaintTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPlaintTextSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7388" data-line-number="7388"></td>
          <td id="LC7388">            <span>ByVal</span> <span>lHeaderPtr</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lHeaderSize</span> <span>As</span> <span>Long</span><span>,</span> <span>pNoncePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lKeySize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7389" data-line-number="7389"></td>
          <td id="LC7389">    <span>&#39; void cf_aesgcm_encrypt(uint8_t *c, uint8_t *mac, const uint8_t *m, const size_t mlen, const uint8_t *ad, const size_t adlen,</span></td>
        </tr>
        <tr>
          <td id="L7390" data-line-number="7390"></td>
          <td id="LC7390">    <span>&#39;                        const uint8_t *npub, const uint8_t *k, size_t klen)</span></td>
        </tr>
        <tr>
          <td id="L7391" data-line-number="7391"></td>
          <td id="LC7391"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7392" data-line-number="7392"></td>
          <td id="LC7392">
</td>
        </tr>
        <tr>
          <td id="L7393" data-line-number="7393"></td>
          <td id="LC7393"><span>Private</span> <span>Function</span> <span>pvCallAesGcmDecrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7394" data-line-number="7394"></td>
          <td id="LC7394">            <span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPlaintTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pCipherTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lCipherTextSize</span> <span>As</span> <span>Long</span><span>,</span> <span>pTagPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7395" data-line-number="7395"></td>
          <td id="LC7395">            <span>pHeaderPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lHeaderSize</span> <span>As</span> <span>Long</span><span>,</span> <span>pNoncePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lKeySize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7396" data-line-number="7396"></td>
          <td id="LC7396">    <span>&#39; void cf_aesgcm_decrypt(uint8_t *m, const uint8_t *c, const size_t clen, const uint8_t *mac, const uint8_t *ad, const size_t adlen,</span></td>
        </tr>
        <tr>
          <td id="L7397" data-line-number="7397"></td>
          <td id="LC7397">    <span>&#39;                        const uint8_t *npub, const uint8_t *k, const size_t klen)</span></td>
        </tr>
        <tr>
          <td id="L7398" data-line-number="7398"></td>
          <td id="LC7398"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7399" data-line-number="7399"></td>
          <td id="LC7399">
</td>
        </tr>
        <tr>
          <td id="L7400" data-line-number="7400"></td>
          <td id="LC7400"><span>Private</span> <span>Function</span> <span>pvCallAesCbcEncrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7401" data-line-number="7401"></td>
          <td id="LC7401">            <span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pCipherTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPlaintTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lPlaintTextSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7402" data-line-number="7402"></td>
          <td id="LC7402">            <span>pNoncePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lKeySize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7403" data-line-number="7403"></td>
          <td id="LC7403">    <span>&#39; static void cf_aescbc_encrypt(uint8_t *c, const uint8_t *m, const size_t mlen,</span></td>
        </tr>
        <tr>
          <td id="L7404" data-line-number="7404"></td>
          <td id="LC7404">    <span>&#39;                               const uint8_t *npub, const uint8_t *k, const size_t klen)</span></td>
        </tr>
        <tr>
          <td id="L7405" data-line-number="7405"></td>
          <td id="LC7405"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7406" data-line-number="7406"></td>
          <td id="LC7406">
</td>
        </tr>
        <tr>
          <td id="L7407" data-line-number="7407"></td>
          <td id="LC7407"><span>Private</span> <span>Function</span> <span>pvCallAesCbcDecrypt(</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7408" data-line-number="7408"></td>
          <td id="LC7408">            <span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>pPlaintTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pCipherTextPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lCipherTextSize</span> <span>As</span> <span>Long</span><span>,</span> <span>_</span></td>
        </tr>
        <tr>
          <td id="L7409" data-line-number="7409"></td>
          <td id="LC7409">            <span>pNoncePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pKeyPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>ByVal</span> <span>lKeySize</span> <span>As</span> <span>Long</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7410" data-line-number="7410"></td>
          <td id="LC7410">    <span>&#39; static void cf_aescbc_decrypt(uint8_t *m, const uint8_t *c, const size_t clen,</span></td>
        </tr>
        <tr>
          <td id="L7411" data-line-number="7411"></td>
          <td id="LC7411">    <span>&#39;                              const uint8_t *npub, const uint8_t *k, const size_t klen)</span></td>
        </tr>
        <tr>
          <td id="L7412" data-line-number="7412"></td>
          <td id="LC7412"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7413" data-line-number="7413"></td>
          <td id="LC7413">
</td>
        </tr>
        <tr>
          <td id="L7414" data-line-number="7414"></td>
          <td id="LC7414"><span>Private</span> <span>Function</span> <span>pvCallRsaModExp(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>pBasePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pExpPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pModPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pRetPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7415" data-line-number="7415"></td>
          <td id="LC7415">    <span>&#39; static void rsa_modexp(const uint32_t maxbytes, const uint8_t *base_in, const uint8_t *exp_in, const uint8_t *mod_in, uint8_t *ret_out)</span></td>
        </tr>
        <tr>
          <td id="L7416" data-line-number="7416"></td>
          <td id="LC7416"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7417" data-line-number="7417"></td>
          <td id="LC7417">
</td>
        </tr>
        <tr>
          <td id="L7418" data-line-number="7418"></td>
          <td id="LC7418"><span>Private</span> <span>Function</span> <span>pvCallRsaCrtModExp(</span><span>ByVal</span> <span>Pfn</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>lSize</span> <span>As</span> <span>Long</span><span>,</span> <span>pBasePtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pExpPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pModPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pPPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pQPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pIqmpPtr</span> <span>As</span> <span>Byte</span><span>,</span> <span>pRetPtr</span> <span>As</span> <span>Byte</span><span>)</span> <span>As</span> <span>Long</span></td>
        </tr>
        <tr>
          <td id="L7419" data-line-number="7419"></td>
          <td id="LC7419">    <span>&#39; static void rsa_crt_modexp(const uint32_t maxbytes, const uint8_t *base_in, const uint8_t *exp_in, const uint8_t *mod_in,</span></td>
        </tr>
        <tr>
          <td id="L7420" data-line-number="7420"></td>
          <td id="LC7420">    <span>&#39;                            const uint8_t *p_in, const uint8_t *q_in, const uint8_t *iqmp_in, uint8_t *ret_out)</span></td>
        </tr>
        <tr>
          <td id="L7421" data-line-number="7421"></td>
          <td id="LC7421"><span>End</span> <span>Function</span></td>
        </tr>
        <tr>
          <td id="L7422" data-line-number="7422"></td>
          <td id="LC7422">
</td>
        </tr>
        <tr>
          <td id="L7423" data-line-number="7423"></td>
          <td id="LC7423"><span>Private</span> <span>Sub</span> <span>pvAppendBuffer(</span><span>ByVal</span> <span>a01</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a02</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a03</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a04</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a05</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a06</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a07</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a08</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a09</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a10</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a11</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a12</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a13</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a14</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a15</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a16</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a17</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a18</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a19</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a20</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a21</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a22</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a23</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a24</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a25</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a26</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a27</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a28</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a29</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a30</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a31</span> <span>As</span> <span>Long</span><span>,</span> <span>ByVal</span> <span>a32</span> <span>As</span> <span>Long</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7424" data-line-number="7424"></td>
          <td id="LC7424">    <span>#</span><span>If</span> <span>a01</span> <span>And</span> <span>a02</span> <span>And</span> <span>a03</span> <span>And</span> <span>a04</span> <span>And</span> <span>a05</span> <span>And</span> <span>a06</span> <span>And</span> <span>a07</span> <span>And</span> <span>a08</span> <span>And</span> <span>a09</span> <span>And</span> <span>a10</span> <span>And</span> <span>a11</span> <span>And</span> <span>a12</span> <span>And</span> <span>a13</span> <span>And</span> <span>a14</span> <span>And</span> <span>a15</span> <span>And</span> <span>a16</span> <span>And</span> <span>a17</span> <span>And</span> <span>a18</span> <span>And</span> <span>a19</span> <span>And</span> <span>a20</span> <span>And</span> <span>a21</span> <span>And</span> <span>a22</span> <span>And</span> <span>a23</span> <span>And</span> <span>a24</span> <span>And</span> <span>a25</span> <span>And</span> <span>a26</span> <span>And</span> <span>a27</span> <span>And</span> <span>a28</span> <span>And</span> <span>a29</span> <span>And</span> <span>a30</span> <span>And</span> <span>a31</span> <span>And</span> <span>a32</span> <span>Then</span> <span>&#39;--- touch args</span></td>
        </tr>
        <tr>
          <td id="L7425" data-line-number="7425"></td>
          <td id="LC7425">    <span>#</span><span>End</span> <span>If</span></td>
        </tr>
        <tr>
          <td id="L7426" data-line-number="7426"></td>
          <td id="LC7426">    <span>Call</span> <span>CopyMemory(m_baBuffer(m_lBuffIdx),</span> <span>a01,</span> <span>4</span> <span>*</span> <span>32</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7427" data-line-number="7427"></td>
          <td id="LC7427">    <span>m_lBuffIdx</span> <span>=</span> <span>m_lBuffIdx</span> <span>+</span> <span>4</span> <span>*</span> <span>32</span></td>
        </tr>
        <tr>
          <td id="L7428" data-line-number="7428"></td>
          <td id="LC7428"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7429" data-line-number="7429"></td>
          <td id="LC7429">
</td>
        </tr>
        <tr>
          <td id="L7430" data-line-number="7430"></td>
          <td id="LC7430"><span>Private</span> <span>Sub</span> <span>pvGetGlobData(baBuffer()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7431" data-line-number="7431"></td>
          <td id="LC7431">    <span>ReDim</span> <span>m_baBuffer(</span><span>0</span> <span>To</span> <span>2048</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7432" data-line-number="7432"></td>
          <td id="LC7432">    <span>m_lBuffIdx</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L7433" data-line-number="7433"></td>
          <td id="LC7433">    <span>&#39;--- begin thunk data</span></td>
        </tr>
        <tr>
          <td id="L7434" data-line-number="7434"></td>
          <td id="LC7434">    <span>pvAppendBuffer</span> <span>&amp;H76AC8030</span><span>,</span> <span>&amp;H76B46E90</span><span>,</span> <span>&amp;H76AC7300</span><span>,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;H27D2604B</span><span>,</span> <span>&amp;H3BCE3C3E</span><span>,</span> <span>&amp;HCC53B0F6</span><span>,</span> <span>&amp;H651D06B0</span><span>,</span> <span>&amp;H769886BC</span><span>,</span> <span>&amp;HB3EBBD55</span><span>,</span> <span>&amp;HAA3A93E7</span><span>,</span> <span>&amp;H5AC635D8</span><span>,</span> <span>&amp;HD898C296</span><span>,</span> <span>&amp;HF4A13945</span><span>,</span> <span>&amp;H2DEB33A0</span><span>,</span> <span>&amp;H77037D81</span><span>,</span> <span>&amp;H63A440F2</span><span>,</span> <span>&amp;HF8BCE6E5</span><span>,</span> <span>&amp;HE12C4247</span><span>,</span> <span>&amp;H6B17D1F2</span><span>,</span> <span>&amp;H37BF51F5</span><span>,</span> <span>&amp;HCBB64068</span><span>,</span> <span>&amp;H6B315ECE</span><span>,</span> <span>&amp;H2BCE3357</span></td>
        </tr>
        <tr>
          <td id="L7435" data-line-number="7435"></td>
          <td id="LC7435">    <span>pvAppendBuffer</span> <span>&amp;H7C0F9E16</span><span>,</span> <span>&amp;H8EE7EB4A</span><span>,</span> <span>&amp;HFE1A7F9B</span><span>,</span> <span>&amp;H4FE342E2</span><span>,</span> <span>&amp;HFC632551</span><span>,</span> <span>&amp;HF3B9CAC2</span><span>,</span> <span>&amp;HA7179E84</span><span>,</span> <span>&amp;HBCE6FAAD</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFE</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HD3EC2AEF</span><span>,</span> <span>&amp;H2A85C8ED</span><span>,</span> <span>&amp;H8A2ED19D</span><span>,</span> <span>&amp;HC656398D</span><span>,</span> <span>&amp;H5013875A</span><span>,</span> <span>&amp;H314088F</span><span>,</span> <span>&amp;HFE814112</span><span>,</span> <span>&amp;H181D9C6E</span></td>
        </tr>
        <tr>
          <td id="L7436" data-line-number="7436"></td>
          <td id="LC7436">    <span>pvAppendBuffer</span> <span>&amp;HE3F82D19</span><span>,</span> <span>&amp;H988E056B</span><span>,</span> <span>&amp;HE23EE7E4</span><span>,</span> <span>&amp;HB3312FA7</span><span>,</span> <span>&amp;H72760AB7</span><span>,</span> <span>&amp;H3A545E38</span><span>,</span> <span>&amp;HBF55296C</span><span>,</span> <span>&amp;H5502F25D</span><span>,</span> <span>&amp;H82542A38</span><span>,</span> <span>&amp;H59F741E0</span><span>,</span> <span>&amp;H8BA79B98</span><span>,</span> <span>&amp;H6E1D3B62</span><span>,</span> <span>&amp;HF320AD74</span><span>,</span> <span>&amp;H8EB1C71E</span><span>,</span> <span>&amp;HBE8B0537</span><span>,</span> <span>&amp;HAA87CA22</span><span>,</span> <span>&amp;H90EA0E5F</span><span>,</span> <span>&amp;H7A431D7C</span><span>,</span> <span>&amp;H1D7E819D</span><span>,</span> <span>&amp;HA60B1CE</span><span>,</span> <span>&amp;HB5F0B8C0</span><span>,</span> <span>&amp;HE9DA3113</span><span>,</span> <span>&amp;H289A147C</span><span>,</span> <span>&amp;HF8F41DBD</span><span>,</span> <span>&amp;H9292DC29</span><span>,</span> <span>&amp;H5D9E98BF</span><span>,</span> <span>&amp;H96262C6F</span><span>,</span> <span>&amp;H3617DE4A</span><span>,</span> <span>&amp;HCCC52973</span><span>,</span> <span>&amp;HECEC196A</span><span>,</span> <span>&amp;H48B0A77A</span><span>,</span> <span>&amp;H581A0DB2</span></td>
        </tr>
        <tr>
          <td id="L7437" data-line-number="7437"></td>
          <td id="LC7437">    <span>pvAppendBuffer</span> <span>&amp;HF4372DDF</span><span>,</span> <span>&amp;HC7634D81</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;H428A2F98</span><span>,</span> <span>&amp;H71374491</span><span>,</span> <span>&amp;HB5C0FBCF</span><span>,</span> <span>&amp;HE9B5DBA5</span><span>,</span> <span>&amp;H3956C25B</span><span>,</span> <span>&amp;H59F111F1</span><span>,</span> <span>&amp;H923F82A4</span><span>,</span> <span>&amp;HAB1C5ED5</span><span>,</span> <span>&amp;HD807AA98</span><span>,</span> <span>&amp;H12835B01</span><span>,</span> <span>&amp;H243185BE</span><span>,</span> <span>&amp;H550C7DC3</span><span>,</span> <span>&amp;H72BE5D74</span><span>,</span> <span>&amp;H80DEB1FE</span><span>,</span> <span>&amp;H9BDC06A7</span><span>,</span> <span>&amp;HC19BF174</span><span>,</span> <span>&amp;HE49B69C1</span><span>,</span> <span>&amp;HEFBE4786</span><span>,</span> <span>&amp;HFC19DC6</span><span>,</span> <span>&amp;H240CA1CC</span><span>,</span> <span>&amp;H2DE92C6F</span><span>,</span> <span>&amp;H4A7484AA</span><span>,</span> <span>&amp;H5CB0A9DC</span><span>,</span> <span>&amp;H76F988DA</span></td>
        </tr>
        <tr>
          <td id="L7438" data-line-number="7438"></td>
          <td id="LC7438">    <span>pvAppendBuffer</span> <span>&amp;H983E5152</span><span>,</span> <span>&amp;HA831C66D</span><span>,</span> <span>&amp;HB00327C8</span><span>,</span> <span>&amp;HBF597FC7</span><span>,</span> <span>&amp;HC6E00BF3</span><span>,</span> <span>&amp;HD5A79147</span><span>,</span> <span>&amp;H6CA6351</span><span>,</span> <span>&amp;H14292967</span><span>,</span> <span>&amp;H27B70A85</span><span>,</span> <span>&amp;H2E1B2138</span><span>,</span> <span>&amp;H4D2C6DFC</span><span>,</span> <span>&amp;H53380D13</span><span>,</span> <span>&amp;H650A7354</span><span>,</span> <span>&amp;H766A0ABB</span><span>,</span> <span>&amp;H81C2C92E</span><span>,</span> <span>&amp;H92722C85</span><span>,</span> <span>&amp;HA2BFE8A1</span><span>,</span> <span>&amp;HA81A664B</span><span>,</span> <span>&amp;HC24B8B70</span><span>,</span> <span>&amp;HC76C51A3</span><span>,</span> <span>&amp;HD192E819</span><span>,</span> <span>&amp;HD6990624</span><span>,</span> <span>&amp;HF40E3585</span><span>,</span> <span>&amp;H106AA070</span><span>,</span> <span>&amp;H19A4C116</span><span>,</span> <span>&amp;H1E376C08</span><span>,</span> <span>&amp;H2748774C</span><span>,</span> <span>&amp;H34B0BCB5</span><span>,</span> <span>&amp;H391C0CB3</span><span>,</span> <span>&amp;H4ED8AA4A</span><span>,</span> <span>&amp;H5B9CCA4F</span><span>,</span> <span>&amp;H682E6FF3</span></td>
        </tr>
        <tr>
          <td id="L7439" data-line-number="7439"></td>
          <td id="LC7439">    <span>pvAppendBuffer</span> <span>&amp;H748F82EE</span><span>,</span> <span>&amp;H78A5636F</span><span>,</span> <span>&amp;H84C87814</span><span>,</span> <span>&amp;H8CC70208</span><span>,</span> <span>&amp;H90BEFFFA</span><span>,</span> <span>&amp;HA4506CEB</span><span>,</span> <span>&amp;HBEF9A3F7</span><span>,</span> <span>&amp;HC67178F2</span><span>,</span> <span>&amp;HD728AE22</span><span>,</span> <span>&amp;H428A2F98</span><span>,</span> <span>&amp;H23EF65CD</span><span>,</span> <span>&amp;H71374491</span><span>,</span> <span>&amp;HEC4D3B2F</span><span>,</span> <span>&amp;HB5C0FBCF</span><span>,</span> <span>&amp;H8189DBBC</span><span>,</span> <span>&amp;HE9B5DBA5</span><span>,</span> <span>&amp;HF348B538</span><span>,</span> <span>&amp;H3956C25B</span><span>,</span> <span>&amp;HB605D019</span><span>,</span> <span>&amp;H59F111F1</span><span>,</span> <span>&amp;HAF194F9B</span><span>,</span> <span>&amp;H923F82A4</span><span>,</span> <span>&amp;HDA6D8118</span><span>,</span> <span>&amp;HAB1C5ED5</span><span>,</span> <span>&amp;HA3030242</span><span>,</span> <span>&amp;HD807AA98</span><span>,</span> <span>&amp;H45706FBE</span><span>,</span> <span>&amp;H12835B01</span><span>,</span> <span>&amp;H4EE4B28C</span><span>,</span> <span>&amp;H243185BE</span><span>,</span> <span>&amp;HD5FFB4E2</span><span>,</span> <span>&amp;H550C7DC3</span></td>
        </tr>
        <tr>
          <td id="L7440" data-line-number="7440"></td>
          <td id="LC7440">    <span>pvAppendBuffer</span> <span>&amp;HF27B896F</span><span>,</span> <span>&amp;H72BE5D74</span><span>,</span> <span>&amp;H3B1696B1</span><span>,</span> <span>&amp;H80DEB1FE</span><span>,</span> <span>&amp;H25C71235</span><span>,</span> <span>&amp;H9BDC06A7</span><span>,</span> <span>&amp;HCF692694</span><span>,</span> <span>&amp;HC19BF174</span><span>,</span> <span>&amp;H9EF14AD2</span><span>,</span> <span>&amp;HE49B69C1</span><span>,</span> <span>&amp;H384F25E3</span><span>,</span> <span>&amp;HEFBE4786</span><span>,</span> <span>&amp;H8B8CD5B5</span><span>,</span> <span>&amp;HFC19DC6</span><span>,</span> <span>&amp;H77AC9C65</span><span>,</span> <span>&amp;H240CA1CC</span><span>,</span> <span>&amp;H592B0275</span><span>,</span> <span>&amp;H2DE92C6F</span><span>,</span> <span>&amp;H6EA6E483</span><span>,</span> <span>&amp;H4A7484AA</span><span>,</span> <span>&amp;HBD41FBD4</span><span>,</span> <span>&amp;H5CB0A9DC</span><span>,</span> <span>&amp;H831153B5</span><span>,</span> <span>&amp;H76F988DA</span><span>,</span> <span>&amp;HEE66DFAB</span><span>,</span> <span>&amp;H983E5152</span><span>,</span> <span>&amp;H2DB43210</span><span>,</span> <span>&amp;HA831C66D</span><span>,</span> <span>&amp;H98FB213F</span><span>,</span> <span>&amp;HB00327C8</span><span>,</span> <span>&amp;HBEEF0EE4</span><span>,</span> <span>&amp;HBF597FC7</span></td>
        </tr>
        <tr>
          <td id="L7441" data-line-number="7441"></td>
          <td id="LC7441">    <span>pvAppendBuffer</span> <span>&amp;H3DA88FC2</span><span>,</span> <span>&amp;HC6E00BF3</span><span>,</span> <span>&amp;H930AA725</span><span>,</span> <span>&amp;HD5A79147</span><span>,</span> <span>&amp;HE003826F</span><span>,</span> <span>&amp;H6CA6351</span><span>,</span> <span>&amp;HA0E6E70</span><span>,</span> <span>&amp;H14292967</span><span>,</span> <span>&amp;H46D22FFC</span><span>,</span> <span>&amp;H27B70A85</span><span>,</span> <span>&amp;H5C26C926</span><span>,</span> <span>&amp;H2E1B2138</span><span>,</span> <span>&amp;H5AC42AED</span><span>,</span> <span>&amp;H4D2C6DFC</span><span>,</span> <span>&amp;H9D95B3DF</span><span>,</span> <span>&amp;H53380D13</span><span>,</span> <span>&amp;H8BAF63DE</span><span>,</span> <span>&amp;H650A7354</span><span>,</span> <span>&amp;H3C77B2A8</span><span>,</span> <span>&amp;H766A0ABB</span><span>,</span> <span>&amp;H47EDAEE6</span><span>,</span> <span>&amp;H81C2C92E</span><span>,</span> <span>&amp;H1482353B</span><span>,</span> <span>&amp;H92722C85</span><span>,</span> <span>&amp;H4CF10364</span><span>,</span> <span>&amp;HA2BFE8A1</span><span>,</span> <span>&amp;HBC423001</span><span>,</span> <span>&amp;HA81A664B</span><span>,</span> <span>&amp;HD0F89791</span><span>,</span> <span>&amp;HC24B8B70</span><span>,</span> <span>&amp;H654BE30</span><span>,</span> <span>&amp;HC76C51A3</span></td>
        </tr>
        <tr>
          <td id="L7442" data-line-number="7442"></td>
          <td id="LC7442">    <span>pvAppendBuffer</span> <span>&amp;HD6EF5218</span><span>,</span> <span>&amp;HD192E819</span><span>,</span> <span>&amp;H5565A910</span><span>,</span> <span>&amp;HD6990624</span><span>,</span> <span>&amp;H5771202A</span><span>,</span> <span>&amp;HF40E3585</span><span>,</span> <span>&amp;H32BBD1B8</span><span>,</span> <span>&amp;H106AA070</span><span>,</span> <span>&amp;HB8D2D0C8</span><span>,</span> <span>&amp;H19A4C116</span><span>,</span> <span>&amp;H5141AB53</span><span>,</span> <span>&amp;H1E376C08</span><span>,</span> <span>&amp;HDF8EEB99</span><span>,</span> <span>&amp;H2748774C</span><span>,</span> <span>&amp;HE19B48A8</span><span>,</span> <span>&amp;H34B0BCB5</span><span>,</span> <span>&amp;HC5C95A63</span><span>,</span> <span>&amp;H391C0CB3</span><span>,</span> <span>&amp;HE3418ACB</span><span>,</span> <span>&amp;H4ED8AA4A</span><span>,</span> <span>&amp;H7763E373</span><span>,</span> <span>&amp;H5B9CCA4F</span><span>,</span> <span>&amp;HD6B2B8A3</span><span>,</span> <span>&amp;H682E6FF3</span><span>,</span> <span>&amp;H5DEFB2FC</span><span>,</span> <span>&amp;H748F82EE</span><span>,</span> <span>&amp;H43172F60</span><span>,</span> <span>&amp;H78A5636F</span><span>,</span> <span>&amp;HA1F0AB72</span><span>,</span> <span>&amp;H84C87814</span><span>,</span> <span>&amp;H1A6439EC</span><span>,</span> <span>&amp;H8CC70208</span></td>
        </tr>
        <tr>
          <td id="L7443" data-line-number="7443"></td>
          <td id="LC7443">    <span>pvAppendBuffer</span> <span>&amp;H23631E28</span><span>,</span> <span>&amp;H90BEFFFA</span><span>,</span> <span>&amp;HDE82BDE9</span><span>,</span> <span>&amp;HA4506CEB</span><span>,</span> <span>&amp;HB2C67915</span><span>,</span> <span>&amp;HBEF9A3F7</span><span>,</span> <span>&amp;HE372532B</span><span>,</span> <span>&amp;HC67178F2</span><span>,</span> <span>&amp;HEA26619C</span><span>,</span> <span>&amp;HCA273ECE</span><span>,</span> <span>&amp;H21C0C207</span><span>,</span> <span>&amp;HD186B8C7</span><span>,</span> <span>&amp;HCDE0EB1E</span><span>,</span> <span>&amp;HEADA7DD6</span><span>,</span> <span>&amp;HEE6ED178</span><span>,</span> <span>&amp;HF57D4F7F</span><span>,</span> <span>&amp;H72176FBA</span><span>,</span> <span>&amp;H6F067AA</span><span>,</span> <span>&amp;HA2C898A6</span><span>,</span> <span>&amp;HA637DC5</span><span>,</span> <span>&amp;HBEF90DAE</span><span>,</span> <span>&amp;H113F9804</span><span>,</span> <span>&amp;H131C471B</span><span>,</span> <span>&amp;H1B710B35</span><span>,</span> <span>&amp;H23047D84</span><span>,</span> <span>&amp;H28DB77F5</span><span>,</span> <span>&amp;H40C72493</span><span>,</span> <span>&amp;H32CAAB7B</span><span>,</span> <span>&amp;H15C9BEBC</span><span>,</span> <span>&amp;H3C9EBE0A</span><span>,</span> <span>&amp;H9C100D4C</span><span>,</span> <span>&amp;H431D67C4</span></td>
        </tr>
        <tr>
          <td id="L7444" data-line-number="7444"></td>
          <td id="LC7444">    <span>pvAppendBuffer</span> <span>&amp;HCB3E42B6</span><span>,</span> <span>&amp;H4CC5D4BE</span><span>,</span> <span>&amp;HFC657E2A</span><span>,</span> <span>&amp;H597F299C</span><span>,</span> <span>&amp;H3AD6FAEC</span><span>,</span> <span>&amp;H5FCB6FAB</span><span>,</span> <span>&amp;H4A475817</span><span>,</span> <span>&amp;H6C44198C</span><span>,</span> <span>&amp;H61707865</span><span>,</span> <span>&amp;H3120646E</span><span>,</span> <span>&amp;H79622D36</span><span>,</span> <span>&amp;H6B206574</span><span>,</span> <span>&amp;H70786500</span><span>,</span> <span>&amp;H20646E61</span><span>,</span> <span>&amp;H622D3233</span><span>,</span> <span>&amp;H20657479</span><span>,</span> <span>&amp;H6B</span><span>&amp;,</span> <span>&amp;H5</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7445" data-line-number="7445"></td>
          <td id="LC7445">    <span>pvAppendBuffer</span> <span>&amp;H0&amp;</span><span>,</span> <span>&amp;HFC</span><span>&amp;,</span> <span>&amp;H7B777C63</span><span>,</span> <span>&amp;HC56F6BF2</span><span>,</span> <span>&amp;H2B670130</span><span>,</span> <span>&amp;H76ABD7FE</span><span>,</span> <span>&amp;H7DC982CA</span><span>,</span> <span>&amp;HF04759FA</span><span>,</span> <span>&amp;HAFA2D4AD</span><span>,</span> <span>&amp;HC072A49C</span><span>,</span> <span>&amp;H2693FDB7</span><span>,</span> <span>&amp;HCCF73F36</span><span>,</span> <span>&amp;HF1E5A534</span><span>,</span> <span>&amp;H1531D871</span><span>,</span> <span>&amp;HC323C704</span><span>,</span> <span>&amp;H9A059618</span><span>,</span> <span>&amp;HE2801207</span><span>,</span> <span>&amp;H75B227EB</span><span>,</span> <span>&amp;H1A2C8309</span><span>,</span> <span>&amp;HA05A6E1B</span><span>,</span> <span>&amp;HB3D63B52</span><span>,</span> <span>&amp;H842FE329</span><span>,</span> <span>&amp;HED00D153</span><span>,</span> <span>&amp;H5BB1FC20</span><span>,</span> <span>&amp;H39BECB6A</span><span>,</span> <span>&amp;HCF584C4A</span><span>,</span> <span>&amp;HFBAAEFD0</span><span>,</span> <span>&amp;H85334D43</span><span>,</span> <span>&amp;H7F02F945</span><span>,</span> <span>&amp;HA89F3C50</span><span>,</span> <span>&amp;H8F40A351</span><span>,</span> <span>&amp;HF5389D92</span></td>
        </tr>
        <tr>
          <td id="L7446" data-line-number="7446"></td>
          <td id="LC7446">    <span>pvAppendBuffer</span> <span>&amp;H21DAB6BC</span><span>,</span> <span>&amp;HD2F3FF10</span><span>,</span> <span>&amp;HEC130CCD</span><span>,</span> <span>&amp;H1744975F</span><span>,</span> <span>&amp;H3D7EA7C4</span><span>,</span> <span>&amp;H73195D64</span><span>,</span> <span>&amp;HDC4F8160</span><span>,</span> <span>&amp;H88902A22</span><span>,</span> <span>&amp;H14B8EE46</span><span>,</span> <span>&amp;HDB0B5EDE</span><span>,</span> <span>&amp;HA3A32E0</span><span>,</span> <span>&amp;H5C240649</span><span>,</span> <span>&amp;H62ACD3C2</span><span>,</span> <span>&amp;H79E49591</span><span>,</span> <span>&amp;H6D37C8E7</span><span>,</span> <span>&amp;HA94ED58D</span><span>,</span> <span>&amp;HEAF4566C</span><span>,</span> <span>&amp;H8AE7A65</span><span>,</span> <span>&amp;H2E2578BA</span><span>,</span> <span>&amp;HC6B4A61C</span><span>,</span> <span>&amp;H1F74DDE8</span><span>,</span> <span>&amp;H8A8BBD4B</span><span>,</span> <span>&amp;H66B53E70</span><span>,</span> <span>&amp;HEF60348</span><span>,</span> <span>&amp;HB9573561</span><span>,</span> <span>&amp;H9E1DC186</span><span>,</span> <span>&amp;H1198F8E1</span><span>,</span> <span>&amp;H948ED969</span><span>,</span> <span>&amp;HE9871E9B</span><span>,</span> <span>&amp;HDF2855CE</span><span>,</span> <span>&amp;HD89A18C</span><span>,</span> <span>&amp;H6842E6BF</span></td>
        </tr>
        <tr>
          <td id="L7447" data-line-number="7447"></td>
          <td id="LC7447">    <span>pvAppendBuffer</span> <span>&amp;HF2D9941</span><span>,</span> <span>&amp;H16BB54B0</span><span>,</span> <span>&amp;H402018D</span><span>,</span> <span>&amp;H40201008</span><span>,</span> <span>&amp;H52361B80</span><span>,</span> <span>&amp;H30D56A09</span><span>,</span> <span>&amp;HBF38A536</span><span>,</span> <span>&amp;H819EA340</span><span>,</span> <span>&amp;H7CFBD7F3</span><span>,</span> <span>&amp;H9B8239E3</span><span>,</span> <span>&amp;H3487FF2F</span><span>,</span> <span>&amp;HC444438E</span><span>,</span> <span>&amp;H54CBE9DE</span><span>,</span> <span>&amp;HA632947B</span><span>,</span> <span>&amp;HEE3D23C2</span><span>,</span> <span>&amp;H420B954C</span><span>,</span> <span>&amp;H84EC3FA</span><span>,</span> <span>&amp;H2866A12E</span><span>,</span> <span>&amp;H76B224D9</span><span>,</span> <span>&amp;H6D49A25B</span><span>,</span> <span>&amp;H7225D18B</span><span>,</span> <span>&amp;H8664F6F8</span><span>,</span> <span>&amp;HD4169868</span><span>,</span> <span>&amp;H5DCC5CA4</span><span>,</span> <span>&amp;H6C92B665</span><span>,</span> <span>&amp;HFD504870</span><span>,</span> <span>&amp;H5EDAB9ED</span><span>,</span> <span>&amp;HA7574615</span><span>,</span> <span>&amp;H90849D8D</span><span>,</span> <span>&amp;H8C00ABD8</span><span>,</span> <span>&amp;HF70AD3BC</span><span>,</span> <span>&amp;HB80558E4</span></td>
        </tr>
        <tr>
          <td id="L7448" data-line-number="7448"></td>
          <td id="LC7448">    <span>pvAppendBuffer</span> <span>&amp;HD00645B3</span><span>,</span> <span>&amp;HCA8F1E2C</span><span>,</span> <span>&amp;HC1020F3F</span><span>,</span> <span>&amp;H103BDAF</span><span>,</span> <span>&amp;H3A6B8A13</span><span>,</span> <span>&amp;H4F411191</span><span>,</span> <span>&amp;H97EADC67</span><span>,</span> <span>&amp;HF0CECFF2</span><span>,</span> <span>&amp;H9673E6B4</span><span>,</span> <span>&amp;HE72274AC</span><span>,</span> <span>&amp;HE28535AD</span><span>,</span> <span>&amp;H1CE837F9</span><span>,</span> <span>&amp;H476EDF75</span><span>,</span> <span>&amp;H1D711AF1</span><span>,</span> <span>&amp;H6F89C529</span><span>,</span> <span>&amp;HAA0E62B7</span><span>,</span> <span>&amp;HFC1BBE18</span><span>,</span> <span>&amp;HC64B3E56</span><span>,</span> <span>&amp;H9A2079D2</span><span>,</span> <span>&amp;H78FEC0DB</span><span>,</span> <span>&amp;H1FF45ACD</span><span>,</span> <span>&amp;H8833A8DD</span><span>,</span> <span>&amp;HB131C707</span><span>,</span> <span>&amp;H27591012</span><span>,</span> <span>&amp;H605FEC80</span><span>,</span> <span>&amp;H19A97F51</span><span>,</span> <span>&amp;H2D0D4AB5</span><span>,</span> <span>&amp;H939F7AE5</span><span>,</span> <span>&amp;HA0EF9CC9</span><span>,</span> <span>&amp;HAE4D3BE0</span><span>,</span> <span>&amp;HC8B0F52A</span><span>,</span> <span>&amp;H833CBBEB</span></td>
        </tr>
        <tr>
          <td id="L7449" data-line-number="7449"></td>
          <td id="LC7449">    <span>pvAppendBuffer</span> <span>&amp;H17619953</span><span>,</span> <span>&amp;HBA7E042B</span><span>,</span> <span>&amp;HE126D677</span><span>,</span> <span>&amp;H55631469</span><span>,</span> <span>&amp;H7D0C21</span><span>,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7450" data-line-number="7450"></td>
          <td id="LC7450">    <span>&#39;--- end thunk data</span></td>
        </tr>
        <tr>
          <td id="L7451" data-line-number="7451"></td>
          <td id="LC7451">    <span>ReDim</span> <span>baBuffer(</span><span>0</span> <span>To</span> <span>1952</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7452" data-line-number="7452"></td>
          <td id="LC7452">    <span>Call</span> <span>CopyMemory(baBuffer(</span><span>0</span><span>),</span> <span>m_baBuffer(</span><span>0</span><span>),</span> <span>UBound(baBuffer)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7453" data-line-number="7453"></td>
          <td id="LC7453">    <span>Erase</span> <span>m_baBuffer</span></td>
        </tr>
        <tr>
          <td id="L7454" data-line-number="7454"></td>
          <td id="LC7454"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7455" data-line-number="7455"></td>
          <td id="LC7455">
</td>
        </tr>
        <tr>
          <td id="L7456" data-line-number="7456"></td>
          <td id="LC7456"><span>Private</span> <span>Sub</span> <span>pvGetThunkData(baBuffer()</span> <span>As</span> <span>Byte</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7457" data-line-number="7457"></td>
          <td id="LC7457">    <span>ReDim</span> <span>m_baBuffer(</span><span>0</span> <span>To</span> <span>34176</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7458" data-line-number="7458"></td>
          <td id="LC7458">    <span>m_lBuffIdx</span> <span>=</span> <span>0</span></td>
        </tr>
        <tr>
          <td id="L7459" data-line-number="7459"></td>
          <td id="LC7459">    <span>&#39;--- begin thunk data</span></td>
        </tr>
        <tr>
          <td id="L7460" data-line-number="7460"></td>
          <td id="LC7460">    <span>pvAppendBuffer</span> <span>&amp;H480238</span><span>,</span> <span>&amp;H29DA</span><span>&amp;,</span> <span>&amp;H2CD8</span><span>&amp;,</span> <span>&amp;H3A3A</span><span>&amp;,</span> <span>&amp;H3E54</span><span>&amp;,</span> <span>&amp;H3F11</span><span>&amp;,</span> <span>&amp;H3F8B</span><span>&amp;,</span> <span>&amp;H421F</span><span>&amp;,</span> <span>&amp;H3AE4</span><span>&amp;,</span> <span>&amp;H3EAE</span><span>&amp;,</span> <span>&amp;H3F4E</span><span>&amp;,</span> <span>&amp;H40CB</span><span>&amp;,</span> <span>&amp;H45E3</span><span>&amp;,</span> <span>&amp;H3522</span><span>&amp;,</span> <span>&amp;H3572</span><span>&amp;,</span> <span>&amp;H3437</span><span>&amp;,</span> <span>&amp;H35CE</span><span>&amp;,</span> <span>&amp;H3659</span><span>&amp;,</span> <span>&amp;H35A5</span><span>&amp;,</span> <span>&amp;H378B</span><span>&amp;,</span> <span>&amp;H3816</span><span>&amp;,</span> <span>&amp;H365E</span><span>&amp;,</span> <span>&amp;H2927</span><span>&amp;,</span> <span>&amp;H28EA</span><span>&amp;,</span> <span>&amp;H1FCC</span><span>&amp;,</span> <span>&amp;H1F7D</span><span>&amp;,</span> <span>&amp;H1F2A</span><span>&amp;,</span> <span>&amp;H1ED7</span><span>&amp;,</span> <span>&amp;H6CBA</span><span>&amp;,</span> <span>&amp;H6B09</span><span>&amp;,</span> <span>&amp;HA9C45C7</span><span>,</span> <span>&amp;H89000000</span></td>
        </tr>
        <tr>
          <td id="L7461" data-line-number="7461"></td>
          <td id="LC7461">    <span>pvAppendBuffer</span> <span>&amp;H4D89AC55</span><span>,</span> <span>&amp;HB845C7B0</span><span>,</span> <span>&amp;H11</span><span>&amp;,</span> <span>&amp;H12BC45C7</span><span>,</span> <span>&amp;H8B000000</span><span>,</span> <span>&amp;HFF788584</span><span>,</span> <span>&amp;H895FFFFF</span><span>,</span> <span>&amp;H5D89F075</span><span>,</span> <span>&amp;H45C75EE8</span><span>,</span> <span>&amp;H1C0</span><span>&amp;,</span> <span>&amp;HC445C700</span><span>,</span> <span>&amp;H2</span><span>&amp;,</span> <span>&amp;H3C845C7</span><span>,</span> <span>&amp;HC7000000</span><span>,</span> <span>&amp;H4CC45</span><span>,</span> <span>&amp;H45C70000</span><span>,</span> <span>&amp;H5D0</span><span>&amp;,</span> <span>&amp;HD445C700</span><span>,</span> <span>&amp;H6</span><span>&amp;,</span> <span>&amp;H7D845C7</span><span>,</span> <span>&amp;HC7000000</span><span>,</span> <span>&amp;H8DC45</span><span>,</span> <span>&amp;H45C70000</span><span>,</span> <span>&amp;H9E0</span><span>&amp;,</span> <span>&amp;HE445C700</span><span>,</span> <span>&amp;HA</span><span>&amp;,</span> <span>&amp;H89F45589</span><span>,</span> <span>&amp;H448BF84D</span><span>,</span> <span>&amp;H8B5BC085</span><span>,</span> <span>&amp;H4C25DE5</span><span>,</span> <span>&amp;HE800</span><span>&amp;,</span> <span>&amp;H2D580000</span></td>
        </tr>
        <tr>
          <td id="L7462" data-line-number="7462"></td>
          <td id="LC7462">    <span>pvAppendBuffer</span> <span>&amp;H4740FE</span><span>,</span> <span>&amp;H47400005</span><span>,</span> <span>&amp;HC3008B00</span><span>,</span> <span>&amp;HE8</span><span>&amp;,</span> <span>&amp;H112D5800</span><span>,</span> <span>&amp;H5004741</span><span>,</span> <span>&amp;H474000</span><span>,</span> <span>&amp;HEC8B55C3</span><span>,</span> <span>&amp;H5348EC83</span><span>,</span> <span>&amp;H56105D8B</span><span>,</span> <span>&amp;H565E046A</span><span>,</span> <span>&amp;H74D0E853</span><span>,</span> <span>&amp;HC0850000</span><span>,</span> <span>&amp;H163850F</span><span>,</span> <span>&amp;H56570000</span><span>,</span> <span>&amp;H8D0C75FF</span><span>,</span> <span>&amp;HE850D845</span><span>,</span> <span>&amp;H7E77</span><span>&amp;,</span> <span>&amp;H8D087D8B</span><span>,</span> <span>&amp;H5056D845</span><span>,</span> <span>&amp;HB8458D57</span><span>,</span> <span>&amp;H7E38E850</span><span>,</span> <span>&amp;H8D560000</span><span>,</span> <span>&amp;H5050D845</span><span>,</span> <span>&amp;H7E5AE8</span><span>,</span> <span>&amp;HFF535600</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;H7E20E80C</span><span>,</span> <span>&amp;H53560000</span><span>,</span> <span>&amp;H7E45E853</span><span>,</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFF79</span></td>
        </tr>
        <tr>
          <td id="L7463" data-line-number="7463"></td>
          <td id="LC7463">    <span>pvAppendBuffer</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;HE8575753</span><span>,</span> <span>&amp;H78B7</span><span>&amp;,</span> <span>&amp;HFF67E856</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H53535010</span><span>,</span> <span>&amp;H78A5E853</span><span>,</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFF55</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;HE8535753</span><span>,</span> <span>&amp;H7E39</span><span>&amp;,</span> <span>&amp;H57575356</span><span>,</span> <span>&amp;H7DD9E8</span><span>,</span> <span>&amp;H3AE85600</span><span>,</span> <span>&amp;H83FFFFFF</span><span>,</span> <span>&amp;H575010C0</span><span>,</span> <span>&amp;H78E85357</span><span>,</span> <span>&amp;H56000078</span><span>,</span> <span>&amp;HFFFF28E8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;H57575350</span><span>,</span> <span>&amp;H7866E8</span><span>,</span> <span>&amp;H57006A00</span><span>,</span> <span>&amp;H823AE8</span><span>,</span> <span>&amp;H56C20B00</span><span>,</span> <span>&amp;HAE82574</span><span>,</span> <span>&amp;H83FFFFFF</span><span>,</span> <span>&amp;H575010C0</span><span>,</span> <span>&amp;H730FE857</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;HE8F08B57</span></td>
        </tr>
        <tr>
          <td id="L7464" data-line-number="7464"></td>
          <td id="LC7464">    <span>pvAppendBuffer</span> <span>&amp;H7FA6&amp;</span><span>,</span> <span>&amp;H91FE6C1</span><span>,</span> <span>&amp;H46A1C77</span><span>,</span> <span>&amp;H5706EB5E</span><span>,</span> <span>&amp;H7F95E8</span><span>,</span> <span>&amp;H53575600</span><span>,</span> <span>&amp;H7DA2E8</span><span>,</span> <span>&amp;HD6E85600</span><span>,</span> <span>&amp;H83FFFFFE</span><span>,</span> <span>&amp;H8D5010C0</span><span>,</span> <span>&amp;H5350B845</span><span>,</span> <span>&amp;H7DB7E853</span><span>,</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFEC1</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;H50B8458D</span><span>,</span> <span>&amp;HA2E85353</span><span>,</span> <span>&amp;H5600007D</span><span>,</span> <span>&amp;HFFFEACE8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;H458D5350</span><span>,</span> <span>&amp;HE85050B8</span><span>,</span> <span>&amp;H7D8D</span><span>&amp;,</span> <span>&amp;HB8458D56</span><span>,</span> <span>&amp;HE8575750</span><span>,</span> <span>&amp;H7D2A</span><span>&amp;,</span> <span>&amp;HFE8BE856</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H458D5010</span><span>,</span> <span>&amp;H505750D8</span><span>,</span> <span>&amp;H7D6CE8</span><span>,</span> <span>&amp;H57535600</span></td>
        </tr>
        <tr>
          <td id="L7465" data-line-number="7465"></td>
          <td id="LC7465">    <span>pvAppendBuffer</span> <span>&amp;H7F6AE8</span><span>,</span> <span>&amp;H75FF5600</span><span>,</span> <span>&amp;H60E8530C</span><span>,</span> <span>&amp;H5600007F</span><span>,</span> <span>&amp;H50D8458D</span><span>,</span> <span>&amp;HE80C75FF</span><span>,</span> <span>&amp;H7F53</span><span>&amp;,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5368EC83</span><span>,</span> <span>&amp;H56105D8B</span><span>,</span> <span>&amp;H565E066A</span><span>,</span> <span>&amp;H7348E853</span><span>,</span> <span>&amp;HC0850000</span><span>,</span> <span>&amp;H177850F</span><span>,</span> <span>&amp;H56570000</span><span>,</span> <span>&amp;H8D0C75FF</span><span>,</span> <span>&amp;HE850C845</span><span>,</span> <span>&amp;H7CEF</span><span>&amp;,</span> <span>&amp;H8D087D8B</span><span>,</span> <span>&amp;H5056C845</span><span>,</span> <span>&amp;H98458D57</span><span>,</span> <span>&amp;H7CB0E850</span><span>,</span> <span>&amp;H8D560000</span><span>,</span> <span>&amp;H5050C845</span><span>,</span> <span>&amp;H7CD2E8</span><span>,</span> <span>&amp;HFF535600</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;H7C98E80C</span><span>,</span> <span>&amp;H53560000</span><span>,</span> <span>&amp;H7CBDE853</span></td>
        </tr>
        <tr>
          <td id="L7466" data-line-number="7466"></td>
          <td id="LC7466">    <span>pvAppendBuffer</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFDF1</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H57535000</span><span>,</span> <span>&amp;H772DE857</span><span>,</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFDDD</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H53535000</span><span>,</span> <span>&amp;H7719E853</span><span>,</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFDC9</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H57535000</span><span>,</span> <span>&amp;H7CABE853</span><span>,</span> <span>&amp;H53560000</span><span>,</span> <span>&amp;H4BE85757</span><span>,</span> <span>&amp;H5600007C</span><span>,</span> <span>&amp;HFFFDACE8</span><span>,</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;H57500000</span><span>,</span> <span>&amp;HE8E85357</span><span>,</span> <span>&amp;H56000076</span><span>,</span> <span>&amp;HFFFD98E8</span><span>,</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;H53500000</span><span>,</span> <span>&amp;HD4E85757</span><span>,</span> <span>&amp;H6A000076</span><span>,</span> <span>&amp;HA8E85700</span><span>,</span> <span>&amp;HB000080</span><span>,</span> <span>&amp;H277456C2</span><span>,</span> <span>&amp;HFFFD78E8</span></td>
        </tr>
        <tr>
          <td id="L7467" data-line-number="7467"></td>
          <td id="LC7467">    <span>pvAppendBuffer</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;H57500000</span><span>,</span> <span>&amp;H717BE857</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HE8F08B57</span><span>,</span> <span>&amp;H7E12</span><span>&amp;,</span> <span>&amp;H91FE6C1</span><span>,</span> <span>&amp;H66A2C77</span><span>,</span> <span>&amp;H5706EB5E</span><span>,</span> <span>&amp;H7E01E8</span><span>,</span> <span>&amp;H53575600</span><span>,</span> <span>&amp;H7C0EE8</span><span>,</span> <span>&amp;H42E85600</span><span>,</span> <span>&amp;H5FFFFFD</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H98458D50</span><span>,</span> <span>&amp;HE8535350</span><span>,</span> <span>&amp;H7C21</span><span>&amp;,</span> <span>&amp;HFD2BE856</span><span>,</span> <span>&amp;HB005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;H5098458D</span><span>,</span> <span>&amp;HAE85353</span><span>,</span> <span>&amp;H5600007C</span><span>,</span> <span>&amp;HFFFD14E8</span><span>,</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;H53500000</span><span>,</span> <span>&amp;H5098458D</span><span>,</span> <span>&amp;H7BF3E850</span><span>,</span> <span>&amp;H8D560000</span><span>,</span> <span>&amp;H57509845</span><span>,</span> <span>&amp;H7B90E857</span></td>
        </tr>
        <tr>
          <td id="L7468" data-line-number="7468"></td>
          <td id="LC7468">    <span>pvAppendBuffer</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFFCF1</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H458D5000</span><span>,</span> <span>&amp;H505750C8</span><span>,</span> <span>&amp;H7BD0E8</span><span>,</span> <span>&amp;H57535600</span><span>,</span> <span>&amp;H7DCEE8</span><span>,</span> <span>&amp;H75FF5600</span><span>,</span> <span>&amp;HC4E8530C</span><span>,</span> <span>&amp;H5600007D</span><span>,</span> <span>&amp;H50C8458D</span><span>,</span> <span>&amp;HE80C75FF</span><span>,</span> <span>&amp;H7DB7</span><span>&amp;,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8758B56</span><span>,</span> <span>&amp;HE856046A</span><span>,</span> <span>&amp;H71B2</span><span>&amp;,</span> <span>&amp;H1474C085</span><span>,</span> <span>&amp;H468D046A</span><span>,</span> <span>&amp;HA3E85020</span><span>,</span> <span>&amp;H85000071</span><span>,</span> <span>&amp;H330574C0</span><span>,</span> <span>&amp;H2EB40C0</span><span>,</span> <span>&amp;H5D5EC033</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;H66A0875</span><span>,</span> <span>&amp;H7184E856</span><span>,</span> <span>&amp;HC0850000</span></td>
        </tr>
        <tr>
          <td id="L7469" data-line-number="7469"></td>
          <td id="LC7469">    <span>pvAppendBuffer</span> <span>&amp;H66A1474</span><span>,</span> <span>&amp;H5030468D</span><span>,</span> <span>&amp;H7175E8</span><span>,</span> <span>&amp;H74C08500</span><span>,</span> <span>&amp;H40C03305</span><span>,</span> <span>&amp;HC03302EB</span><span>,</span> <span>&amp;H4C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HA8EC81</span><span>,</span> <span>&amp;H8B530000</span><span>,</span> <span>&amp;H458D0C5D</span><span>,</span> <span>&amp;H6A5756B8</span><span>,</span> <span>&amp;HE8505304</span><span>,</span> <span>&amp;H7D37</span><span>&amp;,</span> <span>&amp;H6A20438D</span><span>,</span> <span>&amp;H45895004</span><span>,</span> <span>&amp;H78858DF8</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H7D22E8</span><span>,</span> <span>&amp;H1475FF00</span><span>,</span> <span>&amp;HFF58858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;H8D509845</span><span>,</span> <span>&amp;HFFFF7885</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;H82E850B8</span><span>,</span> <span>&amp;H6A000008</span><span>,</span> <span>&amp;H1075FF04</span><span>,</span> <span>&amp;H7C54E8</span><span>,</span> <span>&amp;H83F63300</span><span>,</span> <span>&amp;H894602E8</span><span>,</span> <span>&amp;HC0851445</span></td>
        </tr>
        <tr>
          <td id="L7470" data-line-number="7470"></td>
          <td id="LC7470">    <span>pvAppendBuffer</span> <span>&amp;HFF50577E</span><span>,</span> <span>&amp;H14E81075</span><span>,</span> <span>&amp;HB00007F</span><span>,</span> <span>&amp;H8B0475C2</span><span>,</span> <span>&amp;H3302EBCE</span><span>,</span> <span>&amp;H5E1C1C9</span><span>,</span> <span>&amp;HFF589D8D</span><span>,</span> <span>&amp;HD903FFFF</span><span>,</span> <span>&amp;H398458D</span><span>,</span> <span>&amp;H78B58DC1</span><span>,</span> <span>&amp;H53FFFFFF</span><span>,</span> <span>&amp;H4589D9F7</span><span>,</span> <span>&amp;HF10350FC</span><span>,</span> <span>&amp;H3B87D8D</span><span>,</span> <span>&amp;HE85756F9</span><span>,</span> <span>&amp;H4F3</span><span>&amp;,</span> <span>&amp;HFF535756</span><span>,</span> <span>&amp;HBBE8FC75</span><span>,</span> <span>&amp;H8B000002</span><span>,</span> <span>&amp;H89481445</span><span>,</span> <span>&amp;H16A1445</span><span>,</span> <span>&amp;H7FC0855E</span><span>,</span> <span>&amp;HFF006AA9</span><span>,</span> <span>&amp;HBCE81075</span><span>,</span> <span>&amp;HB00007E</span><span>,</span> <span>&amp;H330274C2</span><span>,</span> <span>&amp;H5E6C1F6</span><span>,</span> <span>&amp;HFF589D8D</span><span>,</span> <span>&amp;HDE03FFFF</span><span>,</span> <span>&amp;H53107589</span><span>,</span> <span>&amp;H398458D</span><span>,</span> <span>&amp;H78BD8DC6</span></td>
        </tr>
        <tr>
          <td id="L7471" data-line-number="7471"></td>
          <td id="LC7471">    <span>pvAppendBuffer</span> <span>&amp;H2BFFFFFF</span><span>,</span> <span>&amp;HB8758DFE</span><span>,</span> <span>&amp;H5010752B</span><span>,</span> <span>&amp;HA0E85657</span><span>,</span> <span>&amp;H6A000004</span><span>,</span> <span>&amp;HFB5FE804</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H458D5010</span><span>,</span> <span>&amp;H458D5098</span><span>,</span> <span>&amp;H458D50B8</span><span>,</span> <span>&amp;H3AE850D8</span><span>,</span> <span>&amp;H6A00007A</span><span>,</span> <span>&amp;H458D5704</span><span>,</span> <span>&amp;HE85050D8</span><span>,</span> <span>&amp;H79D6</span><span>&amp;,</span> <span>&amp;H75FF046A</span><span>,</span> <span>&amp;HD8458D0C</span><span>,</span> <span>&amp;HC7E85050</span><span>,</span> <span>&amp;H6A000079</span><span>,</span> <span>&amp;HFB27E804</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H458D5010</span><span>,</span> <span>&amp;HE85050D8</span><span>,</span> <span>&amp;H74A2</span><span>&amp;,</span> <span>&amp;H75FF046A</span><span>,</span> <span>&amp;HD8458DF8</span><span>,</span> <span>&amp;HA3E85050</span><span>,</span> <span>&amp;H6A000079</span><span>,</span> <span>&amp;H458D5604</span><span>,</span> <span>&amp;HE85050D8</span><span>,</span> <span>&amp;H7996</span><span>&amp;,</span> <span>&amp;H458D5657</span></td>
        </tr>
        <tr>
          <td id="L7472" data-line-number="7472"></td>
          <td id="LC7472">    <span>pvAppendBuffer</span> <span>&amp;H10450398</span><span>,</span> <span>&amp;HFBE85053</span><span>,</span> <span>&amp;H8D000001</span><span>,</span> <span>&amp;H8D50D845</span><span>,</span> <span>&amp;HFFFF5885</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;H52E85098</span><span>,</span> <span>&amp;H8B00000A</span><span>,</span> <span>&amp;H458D0875</span><span>,</span> <span>&amp;H50046A98</span><span>,</span> <span>&amp;H7BC1E856</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;HFF58858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HE8502046</span><span>,</span> <span>&amp;H7BAF</span><span>&amp;,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H10C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HF8EC81</span><span>,</span> <span>&amp;H8B530000</span><span>,</span> <span>&amp;H458D0C5D</span><span>,</span> <span>&amp;H6A575698</span><span>,</span> <span>&amp;HE8505306</span><span>,</span> <span>&amp;H7B8B</span><span>&amp;,</span> <span>&amp;H6A30438D</span><span>,</span> <span>&amp;H45895006</span><span>,</span> <span>&amp;H38858DF8</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H7B76E8</span><span>,</span> <span>&amp;H1475FF00</span><span>,</span> <span>&amp;HFF08858D</span></td>
        </tr>
        <tr>
          <td id="L7473" data-line-number="7473"></td>
          <td id="LC7473">    <span>pvAppendBuffer</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFF6885</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFF38</span><span>,</span> <span>&amp;H98458D50</span><span>,</span> <span>&amp;H74DE850</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HE81075FF</span><span>,</span> <span>&amp;H7AA5</span><span>&amp;,</span> <span>&amp;HE883DB33</span><span>,</span> <span>&amp;H45894302</span><span>,</span> <span>&amp;H7EC08514</span><span>,</span> <span>&amp;H75FF505A</span><span>,</span> <span>&amp;H7D65E810</span><span>,</span> <span>&amp;HC20B0000</span><span>,</span> <span>&amp;HC38B0475</span><span>,</span> <span>&amp;HC03302EB</span><span>,</span> <span>&amp;H8D30C06B</span><span>,</span> <span>&amp;HFFFF089D</span><span>,</span> <span>&amp;H688D8DFF</span><span>,</span> <span>&amp;H8DFFFFFF</span><span>,</span> <span>&amp;HFFFF38B5</span><span>,</span> <span>&amp;H987D8DFF</span><span>,</span> <span>&amp;HC803D803</span><span>,</span> <span>&amp;H89D8F753</span><span>,</span> <span>&amp;H351FC4D</span><span>,</span> <span>&amp;H56F803F0</span><span>,</span> <span>&amp;H4CCE857</span><span>,</span> <span>&amp;H57560000</span><span>,</span> <span>&amp;HFC75FF53</span><span>,</span> <span>&amp;H219E8</span><span>,</span> <span>&amp;H14458B00</span></td>
        </tr>
        <tr>
          <td id="L7474" data-line-number="7474"></td>
          <td id="LC7474">    <span>pvAppendBuffer</span> <span>&amp;H14458948</span><span>,</span> <span>&amp;H855B016A</span><span>,</span> <span>&amp;H6AA67FC0</span><span>,</span> <span>&amp;H1075FF00</span><span>,</span> <span>&amp;H7D0AE8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H6BDB3302</span><span>,</span> <span>&amp;H8D8D30C3</span><span>,</span> <span>&amp;HFFFFFF68</span><span>,</span> <span>&amp;HFF089D8D</span><span>,</span> <span>&amp;HBD8DFFFF</span><span>,</span> <span>&amp;HFFFFFF38</span><span>,</span> <span>&amp;H398758D</span><span>,</span> <span>&amp;H53C803D8</span><span>,</span> <span>&amp;H89F82B51</span><span>,</span> <span>&amp;HF02B104D</span><span>,</span> <span>&amp;H77E85657</span><span>,</span> <span>&amp;H6A000004</span><span>,</span> <span>&amp;HF9ABE806</span><span>,</span> <span>&amp;HB005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;HFF68858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;H8D509845</span><span>,</span> <span>&amp;HE850C845</span><span>,</span> <span>&amp;H7881</span><span>&amp;,</span> <span>&amp;H8D57066A</span><span>,</span> <span>&amp;H5050C845</span><span>,</span> <span>&amp;H781DE8</span><span>,</span> <span>&amp;HFF066A00</span><span>,</span> <span>&amp;H458D0C75</span><span>,</span> <span>&amp;HE85050C8</span></td>
        </tr>
        <tr>
          <td id="L7475" data-line-number="7475"></td>
          <td id="LC7475">    <span>pvAppendBuffer</span> <span>&amp;H780E</span><span>&amp;,</span> <span>&amp;H6EE8066A</span><span>,</span> <span>&amp;H5FFFFF9</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;HC8458D50</span><span>,</span> <span>&amp;HE7E85050</span><span>,</span> <span>&amp;H6A000072</span><span>,</span> <span>&amp;HF875FF06</span><span>,</span> <span>&amp;H50C8458D</span><span>,</span> <span>&amp;H77E8E850</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HC8458D56</span><span>,</span> <span>&amp;HDBE85050</span><span>,</span> <span>&amp;H57000077</span><span>,</span> <span>&amp;H75FF5356</span><span>,</span> <span>&amp;H154E810</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D50C8</span><span>,</span> <span>&amp;HFFFFFF08</span><span>,</span> <span>&amp;H68858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H8E3E8</span><span>,</span> <span>&amp;H8758B00</span><span>,</span> <span>&amp;HFF68858D</span><span>,</span> <span>&amp;H66AFFFF</span><span>,</span> <span>&amp;H4E85650</span><span>,</span> <span>&amp;H6A00007A</span><span>,</span> <span>&amp;H8858D06</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H5030468D</span><span>,</span> <span>&amp;H79F2E8</span><span>,</span> <span>&amp;H5B5E5F00</span></td>
        </tr>
        <tr>
          <td id="L7476" data-line-number="7476"></td>
          <td id="LC7476">    <span>pvAppendBuffer</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H20EC83EC</span><span>,</span> <span>&amp;H6A575653</span><span>,</span> <span>&amp;HE8565E04</span><span>,</span> <span>&amp;HFFFFF8E1</span><span>,</span> <span>&amp;H83085D8B</span><span>,</span> <span>&amp;H535010C0</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;HE850E045</span><span>,</span> <span>&amp;H77BD</span><span>&amp;,</span> <span>&amp;HE0458D56</span><span>,</span> <span>&amp;H88E85050</span><span>,</span> <span>&amp;H56000077</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;H4FE85353</span><span>,</span> <span>&amp;H56000077</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFF1075FF</span><span>,</span> <span>&amp;H3FE81075</span><span>,</span> <span>&amp;H56000077</span><span>,</span> <span>&amp;HFFF8A0E8</span><span>,</span> <span>&amp;HC758BFF</span><span>,</span> <span>&amp;H8B10C083</span><span>,</span> <span>&amp;H5650147D</span><span>,</span> <span>&amp;H7EE85757</span><span>,</span> <span>&amp;H6A000077</span><span>,</span> <span>&amp;H458D5704</span><span>,</span> <span>&amp;H48E850E0</span><span>,</span> <span>&amp;H6A000077</span><span>,</span> <span>&amp;HF87BE804</span><span>,</span> <span>&amp;HC083FFFF</span></td>
        </tr>
        <tr>
          <td id="L7477" data-line-number="7477"></td>
          <td id="LC7477">    <span>pvAppendBuffer</span> <span>&amp;H8D535010</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;H775CE8</span><span>,</span> <span>&amp;HE8046A00</span><span>,</span> <span>&amp;HFFFFF865</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;H7744E8</span><span>,</span> <span>&amp;HE8046A00</span><span>,</span> <span>&amp;HFFFFF84D</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;H1075FF53</span><span>,</span> <span>&amp;HE81075FF</span><span>,</span> <span>&amp;H772D</span><span>&amp;,</span> <span>&amp;H75FF046A</span><span>,</span> <span>&amp;HE8565610</span><span>,</span> <span>&amp;H76CA</span><span>&amp;,</span> <span>&amp;H2AE8046A</span><span>,</span> <span>&amp;H83FFFFF8</span><span>,</span> <span>&amp;H8D5010C0</span><span>,</span> <span>&amp;H5350E045</span><span>,</span> <span>&amp;HE81075FF</span><span>,</span> <span>&amp;H7709</span><span>&amp;,</span> <span>&amp;H75FF046A</span><span>,</span> <span>&amp;HE8575710</span><span>,</span> <span>&amp;H76A6</span><span>&amp;,</span> <span>&amp;H6E8046A</span><span>,</span> <span>&amp;H83FFFFF8</span><span>,</span> <span>&amp;H565010C0</span><span>,</span> <span>&amp;HEAE85757</span><span>,</span> <span>&amp;H6A000076</span></td>
        </tr>
        <tr>
          <td id="L7478" data-line-number="7478"></td>
          <td id="LC7478">    <span>pvAppendBuffer</span> <span>&amp;HE0458D04</span><span>,</span> <span>&amp;H1075FF50</span><span>,</span> <span>&amp;H78E2E8</span><span>,</span> <span>&amp;H5B5E5F00</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H30EC83EC</span><span>,</span> <span>&amp;H6A575653</span><span>,</span> <span>&amp;HE8575F06</span><span>,</span> <span>&amp;HFFFFF7D1</span><span>,</span> <span>&amp;HBE085D8B</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H5350C603</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;HE850D045</span><span>,</span> <span>&amp;H76A9</span><span>&amp;,</span> <span>&amp;HD0458D57</span><span>,</span> <span>&amp;H74E85050</span><span>,</span> <span>&amp;H57000076</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H3BE85353</span><span>,</span> <span>&amp;H57000076</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;HFF1075FF</span><span>,</span> <span>&amp;H2BE81075</span><span>,</span> <span>&amp;H57000076</span><span>,</span> <span>&amp;HFFF78CE8</span><span>,</span> <span>&amp;H147D8BFF</span><span>,</span> <span>&amp;H758BC603</span><span>,</span> <span>&amp;H5756500C</span><span>,</span> <span>&amp;H766BE857</span><span>,</span> <span>&amp;H66A0000</span></td>
        </tr>
        <tr>
          <td id="L7479" data-line-number="7479"></td>
          <td id="LC7479">    <span>pvAppendBuffer</span> <span>&amp;HD0458D57</span><span>,</span> <span>&amp;H7635E850</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HFFF768E8</span><span>,</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;H53500000</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H7647E850</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HFFF750E8</span><span>,</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;HFF500000</span><span>,</span> <span>&amp;H458D1075</span><span>,</span> <span>&amp;HE85050D0</span><span>,</span> <span>&amp;H762D</span><span>&amp;,</span> <span>&amp;H36E8066A</span><span>,</span> <span>&amp;H5FFFFF7</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H75FF5350</span><span>,</span> <span>&amp;H1075FF10</span><span>,</span> <span>&amp;H7614E8</span><span>,</span> <span>&amp;HFF066A00</span><span>,</span> <span>&amp;H56561075</span><span>,</span> <span>&amp;H75B1E8</span><span>,</span> <span>&amp;HE8066A00</span><span>,</span> <span>&amp;HFFFFF711</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H458D5000</span><span>,</span> <span>&amp;HFF5350D0</span><span>,</span> <span>&amp;HEEE81075</span><span>,</span> <span>&amp;H6A000075</span><span>,</span> <span>&amp;H1075FF06</span></td>
        </tr>
        <tr>
          <td id="L7480" data-line-number="7480"></td>
          <td id="LC7480">    <span>pvAppendBuffer</span> <span>&amp;H8BE85757</span><span>,</span> <span>&amp;H6A000075</span><span>,</span> <span>&amp;HF6EBE806</span><span>,</span> <span>&amp;HB005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;HE8575756</span><span>,</span> <span>&amp;H75CD</span><span>&amp;,</span> <span>&amp;H458D066A</span><span>,</span> <span>&amp;H75FF50D0</span><span>,</span> <span>&amp;H77C5E810</span><span>,</span> <span>&amp;H5E5F0000</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H57565360</span><span>,</span> <span>&amp;H535B046A</span><span>,</span> <span>&amp;HFFF6B4E8</span><span>,</span> <span>&amp;H107D8BFF</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;H8D0875FF</span><span>,</span> <span>&amp;H5057C045</span><span>,</span> <span>&amp;H7590E8</span><span>,</span> <span>&amp;H458D5300</span><span>,</span> <span>&amp;HE85050C0</span><span>,</span> <span>&amp;H755B</span><span>&amp;,</span> <span>&amp;HC0458D53</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;H751E</span><span>&amp;,</span> <span>&amp;HC0458D53</span><span>,</span> <span>&amp;HE8575750</span><span>,</span> <span>&amp;H7512</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7481" data-line-number="7481"></td>
          <td id="LC7481">    <span>pvAppendBuffer</span> <span>&amp;HF673E853</span><span>,</span> <span>&amp;H5D8BFFFF</span><span>,</span> <span>&amp;H10C0830C</span><span>,</span> <span>&amp;H5014758B</span><span>,</span> <span>&amp;H458D5653</span><span>,</span> <span>&amp;HA8E850C0</span><span>,</span> <span>&amp;H6A00006F</span><span>,</span> <span>&amp;HF657E804</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H56535010</span><span>,</span> <span>&amp;H753BE856</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;HFFF644E8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;H57E0458D</span><span>,</span> <span>&amp;H7523E850</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HBFE85353</span><span>,</span> <span>&amp;H6A000074</span><span>,</span> <span>&amp;HF61FE804</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;HFF575010</span><span>,</span> <span>&amp;H458D0875</span><span>,</span> <span>&amp;H58E850E0</span><span>,</span> <span>&amp;H6A00006F</span><span>,</span> <span>&amp;HE8575604</span><span>,</span> <span>&amp;H74CB</span><span>&amp;,</span> <span>&amp;HFEE8046A</span><span>,</span> <span>&amp;H83FFFFF5</span><span>,</span> <span>&amp;H8D5010C0</span></td>
        </tr>
        <tr>
          <td id="L7482" data-line-number="7482"></td>
          <td id="LC7482">    <span>pvAppendBuffer</span> <span>&amp;H5750E045</span><span>,</span> <span>&amp;H74DFE857</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;HFFF5E8E8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;H75FF5750</span><span>,</span> <span>&amp;HA0458D08</span><span>,</span> <span>&amp;H74C7E850</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;H63E85656</span><span>,</span> <span>&amp;H6A000074</span><span>,</span> <span>&amp;HF5C3E804</span><span>,</span> <span>&amp;H106AFFFF</span><span>,</span> <span>&amp;H50C7035F</span><span>,</span> <span>&amp;HE8565653</span><span>,</span> <span>&amp;H74A5</span><span>&amp;,</span> <span>&amp;H565E046A</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;H746AE8</span><span>,</span> <span>&amp;H9EE85600</span><span>,</span> <span>&amp;H3FFFFF5</span><span>,</span> <span>&amp;H458D50C7</span><span>,</span> <span>&amp;H458D50E0</span><span>,</span> <span>&amp;HE85050A0</span><span>,</span> <span>&amp;H747D</span><span>&amp;,</span> <span>&amp;HF587E856</span><span>,</span> <span>&amp;HC703FFFF</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;H50E0458D</span></td>
        </tr>
        <tr>
          <td id="L7483" data-line-number="7483"></td>
          <td id="LC7483">    <span>pvAppendBuffer</span> <span>&amp;H7464E8</span><span>,</span> <span>&amp;H458D5600</span><span>,</span> <span>&amp;H458D50C0</span><span>,</span> <span>&amp;HE85050E0</span><span>,</span> <span>&amp;H73FE</span><span>&amp;,</span> <span>&amp;HF55FE856</span><span>,</span> <span>&amp;HC703FFFF</span><span>,</span> <span>&amp;H458D5350</span><span>,</span> <span>&amp;HE85350E0</span><span>,</span> <span>&amp;H7441</span><span>&amp;,</span> <span>&amp;HA0458D56</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;H763AE8</span><span>,</span> <span>&amp;H5B5E5F00</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H90EC81EC</span><span>,</span> <span>&amp;H53000000</span><span>,</span> <span>&amp;H66A5756</span><span>,</span> <span>&amp;H26E8565E</span><span>,</span> <span>&amp;H8BFFFFF5</span><span>,</span> <span>&amp;HB0BB107D</span><span>,</span> <span>&amp;H3000000</span><span>,</span> <span>&amp;H75FF50C3</span><span>,</span> <span>&amp;HA0458D08</span><span>,</span> <span>&amp;HFEE85057</span><span>,</span> <span>&amp;H56000073</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;H73C9E850</span><span>,</span> <span>&amp;H8D560000</span><span>,</span> <span>&amp;HFF50A045</span><span>,</span> <span>&amp;H75FF0875</span></td>
        </tr>
        <tr>
          <td id="L7484" data-line-number="7484"></td>
          <td id="LC7484">    <span>pvAppendBuffer</span> <span>&amp;H738CE808</span><span>,</span> <span>&amp;H8D560000</span><span>,</span> <span>&amp;H5750A045</span><span>,</span> <span>&amp;H7380E857</span><span>,</span> <span>&amp;HE8560000</span><span>,</span> <span>&amp;HFFFFF4E1</span><span>,</span> <span>&amp;H314758B</span><span>,</span> <span>&amp;HC5D8BC3</span><span>,</span> <span>&amp;H8D565350</span><span>,</span> <span>&amp;HE850A045</span><span>,</span> <span>&amp;H6E17</span><span>&amp;,</span> <span>&amp;HC6E8066A</span><span>,</span> <span>&amp;H5FFFFF4</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H56565350</span><span>,</span> <span>&amp;H73A8E8</span><span>,</span> <span>&amp;HE8066A00</span><span>,</span> <span>&amp;HFFFFF4B1</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H75FF5000</span><span>,</span> <span>&amp;HD0458D08</span><span>,</span> <span>&amp;H8EE85057</span><span>,</span> <span>&amp;H6A000073</span><span>,</span> <span>&amp;HD0458D06</span><span>,</span> <span>&amp;HE8535350</span><span>,</span> <span>&amp;H732A</span><span>&amp;,</span> <span>&amp;H8AE8066A</span><span>,</span> <span>&amp;H5FFFFF4</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H75FF5750</span><span>,</span> <span>&amp;HD0458D08</span><span>,</span> <span>&amp;H6DC1E850</span></td>
        </tr>
        <tr>
          <td id="L7485" data-line-number="7485"></td>
          <td id="LC7485">    <span>pvAppendBuffer</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;H34E85756</span><span>,</span> <span>&amp;H6A000073</span><span>,</span> <span>&amp;HF467E806</span><span>,</span> <span>&amp;HB005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H46E85757</span><span>,</span> <span>&amp;H6A000073</span><span>,</span> <span>&amp;HF44FE806</span><span>,</span> <span>&amp;HB005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;H875FF57</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H7329</span><span>&amp;,</span> <span>&amp;H858D066A</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HE8565650</span><span>,</span> <span>&amp;H72C2</span><span>&amp;,</span> <span>&amp;H22E8066A</span><span>,</span> <span>&amp;HBFFFFFF4</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H5350C703</span><span>,</span> <span>&amp;H2E85656</span><span>,</span> <span>&amp;H6A000073</span><span>,</span> <span>&amp;H8D565E06</span><span>,</span> <span>&amp;H8D50A045</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;HC4E850FF</span><span>,</span> <span>&amp;H56000072</span><span>,</span> <span>&amp;HFFF3F8E8</span></td>
        </tr>
        <tr>
          <td id="L7486" data-line-number="7486"></td>
          <td id="LC7486">    <span>pvAppendBuffer</span> <span>&amp;H50C703FF</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;H5050FFFF</span><span>,</span> <span>&amp;H72D4E8</span><span>,</span> <span>&amp;HDEE85600</span><span>,</span> <span>&amp;H3FFFFF3</span><span>,</span> <span>&amp;H75FF50C7</span><span>,</span> <span>&amp;H70858D08</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H72B8E8</span><span>,</span> <span>&amp;H458D5600</span><span>,</span> <span>&amp;H458D50A0</span><span>,</span> <span>&amp;HE85050D0</span><span>,</span> <span>&amp;H7252</span><span>&amp;,</span> <span>&amp;HF3B3E856</span><span>,</span> <span>&amp;HC703FFFF</span><span>,</span> <span>&amp;H458D5350</span><span>,</span> <span>&amp;HE85350D0</span><span>,</span> <span>&amp;H7295</span><span>&amp;,</span> <span>&amp;H70858D56</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;H748B</span><span>&amp;,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H10C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H6A20EC83</span><span>,</span> <span>&amp;H875FF04</span><span>,</span> <span>&amp;HE81075FF</span><span>,</span> <span>&amp;H746F</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7487" data-line-number="7487"></td>
          <td id="LC7487">    <span>pvAppendBuffer</span> <span>&amp;H75FF046A</span><span>,</span> <span>&amp;H1475FF0C</span><span>,</span> <span>&amp;H7462E8</span><span>,</span> <span>&amp;H8D046A00</span><span>,</span> <span>&amp;HE850E045</span><span>,</span> <span>&amp;H67EE</span><span>&amp;,</span> <span>&amp;HE46583</span><span>,</span> <span>&amp;H187D83</span><span>,</span> <span>&amp;H1E045C7</span><span>,</span> <span>&amp;H74000000</span><span>,</span> <span>&amp;HFF046A0B</span><span>,</span> <span>&amp;HE8501875</span><span>,</span> <span>&amp;H743B</span><span>&amp;,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFF0C75FF</span><span>,</span> <span>&amp;HAEE80875</span><span>,</span> <span>&amp;H8D000002</span><span>,</span> <span>&amp;HFF50E045</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;HF34BE808</span><span>,</span> <span>&amp;H458DFFFF</span><span>,</span> <span>&amp;H75FF50E0</span><span>,</span> <span>&amp;H1075FF14</span><span>,</span> <span>&amp;H290E8</span><span>,</span> <span>&amp;H5DE58B00</span><span>,</span> <span>&amp;H550014C2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;HFF066A30</span><span>,</span> <span>&amp;H75FF0875</span><span>,</span> <span>&amp;H73F5E810</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HFF0C75FF</span></td>
        </tr>
        <tr>
          <td id="L7488" data-line-number="7488"></td>
          <td id="LC7488">    <span>pvAppendBuffer</span> <span>&amp;HE8E81475</span><span>,</span> <span>&amp;H6A000073</span><span>,</span> <span>&amp;HD0458D06</span><span>,</span> <span>&amp;H6774E850</span><span>,</span> <span>&amp;H65830000</span><span>,</span> <span>&amp;H7D8300D4</span><span>,</span> <span>&amp;H45C70018</span><span>,</span> <span>&amp;H1D0</span><span>&amp;,</span> <span>&amp;H6A0B7400</span><span>,</span> <span>&amp;H1875FF06</span><span>,</span> <span>&amp;H73C1E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H75FF50D0</span><span>,</span> <span>&amp;H875FF0C</span><span>,</span> <span>&amp;H27FE8</span><span>,</span> <span>&amp;HD0458D00</span><span>,</span> <span>&amp;HC75FF50</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;HFFFFF459</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;HFF1475FF</span><span>,</span> <span>&amp;H61E81075</span><span>,</span> <span>&amp;H8B000002</span><span>,</span> <span>&amp;H14C25DE5</span><span>,</span> <span>&amp;H448B5300</span><span>,</span> <span>&amp;H4C8B0C24</span><span>,</span> <span>&amp;HE1F71024</span><span>,</span> <span>&amp;H448BD88B</span><span>,</span> <span>&amp;H64F70824</span><span>,</span> <span>&amp;HD8031424</span><span>,</span> <span>&amp;H824448B</span><span>,</span> <span>&amp;HD303E1F7</span></td>
        </tr>
        <tr>
          <td id="L7489" data-line-number="7489"></td>
          <td id="LC7489">    <span>pvAppendBuffer</span> <span>&amp;H10C25B</span><span>,</span> <span>&amp;H7340F980</span><span>,</span> <span>&amp;H20F98015</span><span>,</span> <span>&amp;HA50F0673</span><span>,</span> <span>&amp;HC3E0D3C2</span><span>,</span> <span>&amp;HC033D08B</span><span>,</span> <span>&amp;HD31FE180</span><span>,</span> <span>&amp;HC033C3E2</span><span>,</span> <span>&amp;H80C3D233</span><span>,</span> <span>&amp;H157340F9</span><span>,</span> <span>&amp;H7320F980</span><span>,</span> <span>&amp;HD0AD0F06</span><span>,</span> <span>&amp;H8BC3EAD3</span><span>,</span> <span>&amp;H80D233C2</span><span>,</span> <span>&amp;HE8D31FE1</span><span>,</span> <span>&amp;H33C033C3</span><span>,</span> <span>&amp;H8B55C3D2</span><span>,</span> <span>&amp;H10558BEC</span><span>,</span> <span>&amp;H758B5653</span><span>,</span> <span>&amp;H7D8B570C</span><span>,</span> <span>&amp;H6AF22B08</span><span>,</span> <span>&amp;H5BFA2B10</span><span>,</span> <span>&amp;H3160C8B</span><span>,</span> <span>&amp;H16448B0A</span><span>,</span> <span>&amp;H4421304</span><span>,</span> <span>&amp;H8D170C89</span><span>,</span> <span>&amp;H44890852</span><span>,</span> <span>&amp;HEB83FC17</span><span>,</span> <span>&amp;H5FE57501</span><span>,</span> <span>&amp;HC25D5B5E</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H1C558BEC</span></td>
        </tr>
        <tr>
          <td id="L7490" data-line-number="7490"></td>
          <td id="LC7490">    <span>pvAppendBuffer</span> <span>&amp;H5620458B</span><span>,</span> <span>&amp;H5708758B</span><span>,</span> <span>&amp;H30C7D8B</span><span>,</span> <span>&amp;H104513D7</span><span>,</span> <span>&amp;H46891689</span><span>,</span> <span>&amp;H10453B04</span><span>,</span> <span>&amp;H4720D77</span><span>,</span> <span>&amp;H773D73B</span><span>,</span> <span>&amp;H3340C033</span><span>,</span> <span>&amp;H3304EBC9</span><span>,</span> <span>&amp;H3C88BC0</span><span>,</span> <span>&amp;H135F2445</span><span>,</span> <span>&amp;H4503284D</span><span>,</span> <span>&amp;H8468914</span><span>,</span> <span>&amp;H4D13C68B</span><span>,</span> <span>&amp;HC4E8918</span><span>,</span> <span>&amp;H24C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8B0C558B</span><span>,</span> <span>&amp;H28B084D</span><span>,</span> <span>&amp;H428B0131</span><span>,</span> <span>&amp;H4413104</span><span>,</span> <span>&amp;H3108428B</span><span>,</span> <span>&amp;H428B0841</span><span>,</span> <span>&amp;HC41310C</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H4D8B0CEC</span><span>,</span> <span>&amp;H8B565308</span><span>,</span> <span>&amp;H18B1075</span><span>,</span> <span>&amp;HC104C183</span><span>,</span> <span>&amp;H335702EE</span></td>
        </tr>
        <tr>
          <td id="L7491" data-line-number="7491"></td>
          <td id="LC7491">    <span>pvAppendBuffer</span> <span>&amp;H107589FF</span><span>,</span> <span>&amp;H8DFC4D89</span><span>,</span> <span>&amp;H48504</span><span>,</span> <span>&amp;H45890000</span><span>,</span> <span>&amp;H74F685F8</span><span>,</span> <span>&amp;HC4D292C</span><span>,</span> <span>&amp;H7589D98B</span><span>,</span> <span>&amp;HC758B08</span><span>,</span> <span>&amp;H8D087D8B</span><span>,</span> <span>&amp;HE8501E04</span><span>,</span> <span>&amp;H5A48</span><span>&amp;,</span> <span>&amp;H5B8D0389</span><span>,</span> <span>&amp;H1EF8304</span><span>,</span> <span>&amp;H758BED75</span><span>,</span> <span>&amp;H8BFE8B10</span><span>,</span> <span>&amp;H458BFC4D</span><span>,</span> <span>&amp;HC7DB33F8</span><span>,</span> <span>&amp;H10845</span><span>,</span> <span>&amp;HF83B0000</span><span>,</span> <span>&amp;H96830F</span><span>,</span> <span>&amp;HC78B0000</span><span>,</span> <span>&amp;H48DC62B</span><span>,</span> <span>&amp;H10458981</span><span>,</span> <span>&amp;HFCB9548B</span><span>,</span> <span>&amp;H3B0C5589</span><span>,</span> <span>&amp;HFF0575DE</span><span>,</span> <span>&amp;HDB330845</span><span>,</span> <span>&amp;H3475DB85</span><span>,</span> <span>&amp;HFFF104E8</span><span>,</span> <span>&amp;H58805FF</span><span>,</span> <span>&amp;H8B500000</span><span>,</span> <span>&amp;HC0C10C45</span></td>
        </tr>
        <tr>
          <td id="L7492" data-line-number="7492"></td>
          <td id="LC7492">    <span>pvAppendBuffer</span> <span>&amp;H70E85008</span><span>,</span> <span>&amp;H89000064</span><span>,</span> <span>&amp;HEAE80C45</span><span>,</span> <span>&amp;H8BFFFFF0</span><span>,</span> <span>&amp;H558B084D</span><span>,</span> <span>&amp;H84B60F0C</span><span>,</span> <span>&amp;H68808</span><span>,</span> <span>&amp;H18E0C100</span><span>,</span> <span>&amp;H20EBD033</span><span>,</span> <span>&amp;H7606FE83</span><span>,</span> <span>&amp;H4FB831E</span><span>,</span> <span>&amp;HC6E81975</span><span>,</span> <span>&amp;H5FFFFF0</span><span>,</span> <span>&amp;H588</span><span>&amp;,</span> <span>&amp;HC458B50</span><span>,</span> <span>&amp;H6435E850</span><span>,</span> <span>&amp;HD08B0000</span><span>,</span> <span>&amp;H8B10458B</span><span>,</span> <span>&amp;HFC458B08</span><span>,</span> <span>&amp;HC89CA33</span><span>,</span> <span>&amp;H458B47B8</span><span>,</span> <span>&amp;HFC4D8B10</span><span>,</span> <span>&amp;H4304C083</span><span>,</span> <span>&amp;H3B104589</span><span>,</span> <span>&amp;H820FF87D</span><span>,</span> <span>&amp;HFFFFFF74</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8D20EC83</span><span>,</span> <span>&amp;H46AE045</span><span>,</span> <span>&amp;H501075FF</span></td>
        </tr>
        <tr>
          <td id="L7493" data-line-number="7493"></td>
          <td id="LC7493">    <span>pvAppendBuffer</span> <span>&amp;H6F3AE8</span><span>,</span> <span>&amp;H8D046A00</span><span>,</span> <span>&amp;HFF50E045</span><span>,</span> <span>&amp;H75FF0875</span><span>,</span> <span>&amp;H6EFCE808</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;H6EEDE8</span><span>,</span> <span>&amp;H8D046A00</span><span>,</span> <span>&amp;HFF50E045</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;H6EDCE80C</span><span>,</span> <span>&amp;HE58B0000</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H458D30EC</span><span>,</span> <span>&amp;HFF066AD0</span><span>,</span> <span>&amp;HE8501075</span><span>,</span> <span>&amp;H6EEF</span><span>&amp;,</span> <span>&amp;H458D066A</span><span>,</span> <span>&amp;H75FF50D0</span><span>,</span> <span>&amp;H875FF08</span><span>,</span> <span>&amp;H6EB1E8</span><span>,</span> <span>&amp;HFF066A00</span><span>,</span> <span>&amp;H458D1075</span><span>,</span> <span>&amp;HE85050D0</span><span>,</span> <span>&amp;H6EA2</span><span>&amp;,</span> <span>&amp;H458D066A</span><span>,</span> <span>&amp;H75FF50D0</span><span>,</span> <span>&amp;HC75FF0C</span><span>,</span> <span>&amp;H6E91E8</span></td>
        </tr>
        <tr>
          <td id="L7494" data-line-number="7494"></td>
          <td id="LC7494">    <span>pvAppendBuffer</span> <span>&amp;H5DE58B00</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H8B565318</span><span>,</span> <span>&amp;H8B570C75</span><span>,</span> <span>&amp;H78B087D</span><span>,</span> <span>&amp;H27F063B</span><span>,</span> <span>&amp;H588D068B</span><span>,</span> <span>&amp;H5D895301</span><span>,</span> <span>&amp;H524DE8EC</span><span>,</span> <span>&amp;HD08B0000</span><span>,</span> <span>&amp;HC033C933</span><span>,</span> <span>&amp;H21E85589</span><span>,</span> <span>&amp;H2141F845</span><span>,</span> <span>&amp;H4589F445</span><span>,</span> <span>&amp;H7CD93BFC</span><span>,</span> <span>&amp;H8DC78B67</span><span>,</span> <span>&amp;HC62B045E</span><span>,</span> <span>&amp;H5589D62B</span><span>,</span> <span>&amp;H3BD08BF0</span><span>,</span> <span>&amp;H8B057F0F</span><span>,</span> <span>&amp;H2EB1A3C</span><span>,</span> <span>&amp;HE3BFF33</span><span>,</span> <span>&amp;H38B077F</span><span>,</span> <span>&amp;HEB0C4589</span><span>,</span> <span>&amp;HC658304</span><span>,</span> <span>&amp;H1C03300</span><span>,</span> <span>&amp;H7D8B0C7D</span><span>,</span> <span>&amp;H1C013F8</span><span>,</span> <span>&amp;H7D8B0C7D</span><span>,</span> <span>&amp;HF44513F0</span><span>,</span> <span>&amp;HF46583</span></td>
        </tr>
        <tr>
          <td id="L7495" data-line-number="7495"></td>
          <td id="LC7495">    <span>pvAppendBuffer</span> <span>&amp;H8BF84589</span><span>,</span> <span>&amp;HC0850C45</span><span>,</span> <span>&amp;H8B1F0489</span><span>,</span> <span>&amp;H458B087D</span><span>,</span> <span>&amp;H3B0974FC</span><span>,</span> <span>&amp;H8B057EC8</span><span>,</span> <span>&amp;HFC4589C1</span><span>,</span> <span>&amp;H4C38341</span><span>,</span> <span>&amp;H7EEC4D3B</span><span>,</span> <span>&amp;HE8558BAA</span><span>,</span> <span>&amp;H2895E5F</span><span>,</span> <span>&amp;H8B5BC28B</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5310EC83</span><span>,</span> <span>&amp;H7D8B5756</span><span>,</span> <span>&amp;H8B378B0C</span><span>,</span> <span>&amp;H2E3C1DE</span><span>,</span> <span>&amp;H89F87589</span><span>,</span> <span>&amp;H26E8F05D</span><span>,</span> <span>&amp;H53FFFFEF</span><span>,</span> <span>&amp;HD08B10FF</span><span>,</span> <span>&amp;H5589C933</span><span>,</span> <span>&amp;H7EF6850C</span><span>,</span> <span>&amp;H2B078B0F</span><span>,</span> <span>&amp;H87048BC1</span><span>,</span> <span>&amp;H418A0489</span><span>,</span> <span>&amp;HF17CCE3B</span><span>,</span> <span>&amp;H8B085D8B</span><span>,</span> <span>&amp;H7FDE3B1B</span><span>,</span> <span>&amp;H15E8D03</span><span>,</span> <span>&amp;HE7C1FB8B</span></td>
        </tr>
        <tr>
          <td id="L7496" data-line-number="7496"></td>
          <td id="LC7496">    <span>pvAppendBuffer</span> <span>&amp;HFC7D8902</span><span>,</span> <span>&amp;HFFEEF0E8</span><span>,</span> <span>&amp;H10FF57FF</span><span>,</span> <span>&amp;H5589D08B</span><span>,</span> <span>&amp;H7EDB85F4</span><span>,</span> <span>&amp;H33CB8B08</span><span>,</span> <span>&amp;HF3FA8BC0</span><span>,</span> <span>&amp;H84D8BAB</span><span>,</span> <span>&amp;H3947FF33</span><span>,</span> <span>&amp;H8B1C7C39</span><span>,</span> <span>&amp;HFCC283C3</span><span>,</span> <span>&amp;H8B02E0C1</span><span>,</span> <span>&amp;H8BD003F7</span><span>,</span> <span>&amp;H8946B104</span><span>,</span> <span>&amp;HFC528D02</span><span>,</span> <span>&amp;HF37E313B</span><span>,</span> <span>&amp;H8BF8758B</span><span>,</span> <span>&amp;H8B0C45</span><span>,</span> <span>&amp;H8458950</span><span>,</span> <span>&amp;H4F7E8</span><span>,</span> <span>&amp;H8558B00</span><span>,</span> <span>&amp;H85F84589</span><span>,</span> <span>&amp;H8B1A74C0</span><span>,</span> <span>&amp;H3BE2D3C8</span><span>,</span> <span>&amp;H6A127EF7</span><span>,</span> <span>&amp;HC82B5920</span><span>,</span> <span>&amp;H8B0C458B</span><span>,</span> <span>&amp;HE8D30440</span><span>,</span> <span>&amp;H458BD00B</span><span>,</span> <span>&amp;HE85250F8</span><span>,</span> <span>&amp;H57C8</span><span>&amp;,</span> <span>&amp;H1475FF50</span></td>
        </tr>
        <tr>
          <td id="L7497" data-line-number="7497"></td>
          <td id="LC7497">    <span>pvAppendBuffer</span> <span>&amp;HC75FF56</span><span>,</span> <span>&amp;H53F4758B</span><span>,</span> <span>&amp;H3A22E856</span><span>,</span> <span>&amp;H458B0000</span><span>,</span> <span>&amp;H74C08510</span><span>,</span> <span>&amp;H7C383923</span><span>,</span> <span>&amp;HFC4D8B1F</span><span>,</span> <span>&amp;HFCC1834B</span><span>,</span> <span>&amp;HDB85CE03</span><span>,</span> <span>&amp;H118B0478</span><span>,</span> <span>&amp;HD23302EB</span><span>,</span> <span>&amp;H83B81489</span><span>,</span> <span>&amp;H4B4704E9</span><span>,</span> <span>&amp;HEA7E383B</span><span>,</span> <span>&amp;H8BF075FF</span><span>,</span> <span>&amp;HE8530C5D</span><span>,</span> <span>&amp;H60EB</span><span>&amp;,</span> <span>&amp;HFFEE30E8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;HFC75FF08</span><span>,</span> <span>&amp;H60D9E856</span><span>,</span> <span>&amp;H1EE80000</span><span>,</span> <span>&amp;H56FFFFEE</span><span>,</span> <span>&amp;H5F0850FF</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H10C25D</span><span>,</span> <span>&amp;H56EC8B55</span><span>,</span> <span>&amp;H570C758B</span><span>,</span> <span>&amp;H80E836FF</span><span>,</span> <span>&amp;H6A000050</span><span>,</span> <span>&amp;H57F88B00</span><span>,</span> <span>&amp;H875FF56</span></td>
        </tr>
        <tr>
          <td id="L7498" data-line-number="7498"></td>
          <td id="LC7498">    <span>pvAppendBuffer</span> <span>&amp;HFFFEB0E8</span><span>,</span> <span>&amp;H13F83FF</span><span>,</span> <span>&amp;H78B1076</span><span>,</span> <span>&amp;H873C83</span><span>,</span> <span>&amp;H89480875</span><span>,</span> <span>&amp;H1F88307</span><span>,</span> <span>&amp;HC78BF077</span><span>,</span> <span>&amp;HC25D5E5F</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;HFF006AEC</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;H4E808</span><span>,</span> <span>&amp;HC25D0000</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H20EC83EC</span><span>,</span> <span>&amp;H85D8B53</span><span>,</span> <span>&amp;HC758B56</span><span>,</span> <span>&amp;H8B1B8B57</span><span>,</span> <span>&amp;HE45D89FB</span><span>,</span> <span>&amp;H4589068B</span><span>,</span> <span>&amp;H7FD83BE0</span><span>,</span> <span>&amp;H57F88B02</span><span>,</span> <span>&amp;H4FF6E8</span><span>,</span> <span>&amp;HC1CF8B00</span><span>,</span> <span>&amp;HC10302E1</span><span>,</span> <span>&amp;H8902E0C1</span><span>,</span> <span>&amp;H8AE8EC45</span><span>,</span> <span>&amp;HFFFFFFED</span><span>,</span> <span>&amp;H10FFEC75</span><span>,</span> <span>&amp;HF06583</span><span>,</span> <span>&amp;H4D89C88B</span><span>,</span> <span>&amp;H7EFF85F8</span></td>
        </tr>
        <tr>
          <td id="L7499" data-line-number="7499"></td>
          <td id="LC7499">    <span>pvAppendBuffer</span> <span>&amp;H8BC78B6E</span><span>,</span> <span>&amp;H2E0C1D7</span><span>,</span> <span>&amp;H3081C8D</span><span>,</span> <span>&amp;HFC5D89C6</span><span>,</span> <span>&amp;H8BF44589</span><span>,</span> <span>&amp;HD88B0845</span><span>,</span> <span>&amp;H5D89DE2B</span><span>,</span> <span>&amp;HF45D8BE8</span><span>,</span> <span>&amp;HB7F103B</span><span>,</span> <span>&amp;H8BE8458B</span><span>,</span> <span>&amp;H45891804</span><span>,</span> <span>&amp;H8304EBF4</span><span>,</span> <span>&amp;H8B00F465</span><span>,</span> <span>&amp;H758BF045</span><span>,</span> <span>&amp;H813489F4</span><span>,</span> <span>&amp;H3B0C758B</span><span>,</span> <span>&amp;H8B077F16</span><span>,</span> <span>&amp;HF44D890B</span><span>,</span> <span>&amp;H658304EB</span><span>,</span> <span>&amp;H4D8B00F4</span><span>,</span> <span>&amp;H458340FC</span><span>,</span> <span>&amp;HEB8304FC</span><span>,</span> <span>&amp;HF4758B04</span><span>,</span> <span>&amp;HF045894A</span><span>,</span> <span>&amp;H458BC73B</span><span>,</span> <span>&amp;H8B318908</span><span>,</span> <span>&amp;HB47CF84D</span><span>,</span> <span>&amp;H8BE45D8B</span><span>,</span> <span>&amp;H4E0C1C7</span><span>,</span> <span>&amp;H8950C103</span><span>,</span> <span>&amp;H48D0845</span><span>,</span> <span>&amp;H8B5057F9</span></td>
        </tr>
        <tr>
          <td id="L7500" data-line-number="7500"></td>
          <td id="LC7500">    <span>pvAppendBuffer</span> <span>&amp;H2E0C1C7</span><span>,</span> <span>&amp;H5150C103</span><span>,</span> <span>&amp;H3B3FE8</span><span>,</span> <span>&amp;HE0458B00</span><span>,</span> <span>&amp;H8BD80340</span><span>,</span> <span>&amp;H5D891045</span><span>,</span> <span>&amp;H74C0850C</span><span>,</span> <span>&amp;H3B008B0C</span><span>,</span> <span>&amp;H8D067FD8</span><span>,</span> <span>&amp;H5D890158</span><span>,</span> <span>&amp;H48E8530C</span><span>,</span> <span>&amp;H8B00004F</span><span>,</span> <span>&amp;H41C933F0</span><span>,</span> <span>&amp;HC18BD233</span><span>,</span> <span>&amp;H2A7C0E39</span><span>,</span> <span>&amp;H8D085D8B</span><span>,</span> <span>&amp;HC3833F0C</span><span>,</span> <span>&amp;H7FC13BFC</span><span>,</span> <span>&amp;HEB3B8B04</span><span>,</span> <span>&amp;H89FF3302</span><span>,</span> <span>&amp;HFF85863C</span><span>,</span> <span>&amp;HD08B0274</span><span>,</span> <span>&amp;H4EB8340</span><span>,</span> <span>&amp;HE57E063B</span><span>,</span> <span>&amp;H330C5D8B</span><span>,</span> <span>&amp;H458B41C9</span><span>,</span> <span>&amp;H85168910</span><span>,</span> <span>&amp;H836274C0</span><span>,</span> <span>&amp;H8300F065</span><span>,</span> <span>&amp;H3B00F465</span><span>,</span> <span>&amp;H8B567CD9</span><span>,</span> <span>&amp;H45E8DF8</span></td>
        </tr>
        <tr>
          <td id="L7501" data-line-number="7501"></td>
          <td id="LC7501">    <span>pvAppendBuffer</span> <span>&amp;H7D89FE2B</span><span>,</span> <span>&amp;H7F0E3BFC</span><span>,</span> <span>&amp;H893B8B0A</span><span>,</span> <span>&amp;H7D8B087D</span><span>,</span> <span>&amp;H8304EBFC</span><span>,</span> <span>&amp;H3B000865</span><span>,</span> <span>&amp;H8B057F08</span><span>,</span> <span>&amp;H2EB1F3C</span><span>,</span> <span>&amp;HC033FF33</span><span>,</span> <span>&amp;H13087D03</span><span>,</span> <span>&amp;HF07D03C0</span><span>,</span> <span>&amp;H45133B89</span><span>,</span> <span>&amp;HF46583F4</span><span>,</span> <span>&amp;HF0458900</span><span>,</span> <span>&amp;H674FF85</span><span>,</span> <span>&amp;H27ECA3B</span><span>,</span> <span>&amp;H458BD18B</span><span>,</span> <span>&amp;H7D8B4110</span><span>,</span> <span>&amp;H4C383FC</span><span>,</span> <span>&amp;H7E0C4D3B</span><span>,</span> <span>&amp;HEC75FFB4</span><span>,</span> <span>&amp;H57F87D8B</span><span>,</span> <span>&amp;HD0E81689</span><span>,</span> <span>&amp;HE800005E</span><span>,</span> <span>&amp;HFFFFEC15</span><span>,</span> <span>&amp;H850FF57</span><span>,</span> <span>&amp;H5EC68B5F</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H4D8BEC8B</span><span>,</span> <span>&amp;HC985560C</span><span>,</span> <span>&amp;H758B3278</span></td>
        </tr>
        <tr>
          <td id="L7502" data-line-number="7502"></td>
          <td id="LC7502">    <span>pvAppendBuffer</span> <span>&amp;HC1068B08</span><span>,</span> <span>&amp;HC83B02E0</span><span>,</span> <span>&amp;HC18B267D</span><span>,</span> <span>&amp;H3E28399</span><span>,</span> <span>&amp;HF8C1C203</span><span>,</span> <span>&amp;H3E18102</span><span>,</span> <span>&amp;H79800000</span><span>,</span> <span>&amp;HC9834905</span><span>,</span> <span>&amp;H448B41FC</span><span>,</span> <span>&amp;HE1C10486</span><span>,</span> <span>&amp;HFE8D303</span><span>,</span> <span>&amp;H2EBC0B6</span><span>,</span> <span>&amp;H5D5EC033</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H5653EC8B</span><span>,</span> <span>&amp;H570C758B</span><span>,</span> <span>&amp;H8B087D8B</span><span>,</span> <span>&amp;H830F8B16</span><span>,</span> <span>&amp;H97501F9</span><span>,</span> <span>&amp;HF704478B</span><span>,</span> <span>&amp;H23C01BD8</span><span>,</span> <span>&amp;H1FA83C8</span><span>,</span> <span>&amp;H468B0975</span><span>,</span> <span>&amp;H1BD8F704</span><span>,</span> <span>&amp;H8BD023C0</span><span>,</span> <span>&amp;H7FCA3BC1</span><span>,</span> <span>&amp;H85C28B02</span><span>,</span> <span>&amp;H8D3174C0</span><span>,</span> <span>&amp;HFE2B861C</span><span>,</span> <span>&amp;H67EC13B</span><span>,</span> <span>&amp;H86583</span><span>,</span> <span>&amp;H348B06EB</span></td>
        </tr>
        <tr>
          <td id="L7503" data-line-number="7503"></td>
          <td id="LC7503">    <span>pvAppendBuffer</span> <span>&amp;H875891F</span><span>,</span> <span>&amp;H47EC23B</span><span>,</span> <span>&amp;H7EBF633</span><span>,</span> <span>&amp;H7539338B</span><span>,</span> <span>&amp;H391B7208</span><span>,</span> <span>&amp;H11770875</span><span>,</span> <span>&amp;H8304EB83</span><span>,</span> <span>&amp;HD47501E8</span><span>,</span> <span>&amp;H5E5FC033</span><span>,</span> <span>&amp;H8C25D5B</span><span>,</span> <span>&amp;H40C03300</span><span>,</span> <span>&amp;HC883F4EB</span><span>,</span> <span>&amp;H55EFEBFF</span><span>,</span> <span>&amp;H8B53EC8B</span><span>,</span> <span>&amp;H57560C5D</span><span>,</span> <span>&amp;H9903438D</span><span>,</span> <span>&amp;H8D03E283</span><span>,</span> <span>&amp;HFFC1023C</span><span>,</span> <span>&amp;H7D895702</span><span>,</span> <span>&amp;H4DA5E80C</span><span>,</span> <span>&amp;HF08B0000</span><span>,</span> <span>&amp;H7C01FF83</span><span>,</span> <span>&amp;HC4D8B0A</span><span>,</span> <span>&amp;H33047E8D</span><span>,</span> <span>&amp;H85ABF3C0</span><span>,</span> <span>&amp;H8B3A74DB</span><span>,</span> <span>&amp;H3E7C1FB</span><span>,</span> <span>&amp;H4B084D8B</span><span>,</span> <span>&amp;H8A08EF83</span><span>,</span> <span>&amp;H4D894101</span><span>,</span> <span>&amp;H85D38B08</span><span>,</span> <span>&amp;H830379D2</span></td>
        </tr>
        <tr>
          <td id="L7504" data-line-number="7504"></td>
          <td id="LC7504">    <span>pvAppendBuffer</span> <span>&amp;HFAC103C2</span><span>,</span> <span>&amp;H81CF8B02</span><span>,</span> <span>&amp;H1FE1</span><span>&amp;,</span> <span>&amp;H49057980</span><span>,</span> <span>&amp;H41E0C983</span><span>,</span> <span>&amp;HD3C0B60F</span><span>,</span> <span>&amp;H964409E0</span><span>,</span> <span>&amp;H75DB8504</span><span>,</span> <span>&amp;H13E83CB</span><span>,</span> <span>&amp;H68B1076</span><span>,</span> <span>&amp;H863C83</span><span>,</span> <span>&amp;H89480875</span><span>,</span> <span>&amp;H1F88306</span><span>,</span> <span>&amp;H8B5FF077</span><span>,</span> <span>&amp;H5D5B5EC6</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H4D8BEC8B</span><span>,</span> <span>&amp;H78C9850C</span><span>,</span> <span>&amp;H758B563D</span><span>,</span> <span>&amp;HC1068B08</span><span>,</span> <span>&amp;HC83B05E0</span><span>,</span> <span>&amp;HC18B2F7D</span><span>,</span> <span>&amp;H1FE28399</span><span>,</span> <span>&amp;HF8C1C203</span><span>,</span> <span>&amp;H1FE18105</span><span>,</span> <span>&amp;H79800000</span><span>,</span> <span>&amp;HC9834905</span><span>,</span> <span>&amp;HD23341E0</span><span>,</span> <span>&amp;H83E2D342</span><span>,</span> <span>&amp;H7400107D</span><span>,</span> <span>&amp;H86540906</span><span>,</span> <span>&amp;HF706EB04</span></td>
        </tr>
        <tr>
          <td id="L7505" data-line-number="7505"></td>
          <td id="LC7505">    <span>pvAppendBuffer</span> <span>&amp;H865421D2</span><span>,</span> <span>&amp;HC25D5E04</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H18EC83EC</span><span>,</span> <span>&amp;H85D8B53</span><span>,</span> <span>&amp;H7D8B5756</span><span>,</span> <span>&amp;H3B338B0C</span><span>,</span> <span>&amp;H8B027F37</span><span>,</span> <span>&amp;HD0E85637</span><span>,</span> <span>&amp;H8300004C</span><span>,</span> <span>&amp;H8B00F065</span><span>,</span> <span>&amp;H89C033D0</span><span>,</span> <span>&amp;H8B40E855</span><span>,</span> <span>&amp;H7CF03BC8</span><span>,</span> <span>&amp;HF8558971</span><span>,</span> <span>&amp;H2904478D</span><span>,</span> <span>&amp;HD233F87D</span><span>,</span> <span>&amp;H29FC5D89</span><span>,</span> <span>&amp;H8942FC7D</span><span>,</span> <span>&amp;HB3BF445</span><span>,</span> <span>&amp;H5D8B0B7F</span><span>,</span> <span>&amp;H31C8BFC</span><span>,</span> <span>&amp;HEBEC5D89</span><span>,</span> <span>&amp;HEC658304</span><span>,</span> <span>&amp;H7F0F3B00</span><span>,</span> <span>&amp;HEB188B04</span><span>,</span> <span>&amp;H8BDB3302</span><span>,</span> <span>&amp;HC033F87D</span><span>,</span> <span>&amp;H5D03D3F7</span><span>,</span> <span>&amp;H3C013EC</span><span>,</span> <span>&amp;HD083DA</span><span>,</span> <span>&amp;H458BD08B</span></td>
        </tr>
        <tr>
          <td id="L7506" data-line-number="7506"></td>
          <td id="LC7506">    <span>pvAppendBuffer</span> <span>&amp;H71C89F4</span><span>,</span> <span>&amp;H850C7D8B</span><span>,</span> <span>&amp;H3B0874DB</span><span>,</span> <span>&amp;H37EF04D</span><span>,</span> <span>&amp;H8BF04D89</span><span>,</span> <span>&amp;H8341085D</span><span>,</span> <span>&amp;H458904C0</span><span>,</span> <span>&amp;H7ECE3BF4</span><span>,</span> <span>&amp;HC5589AD</span><span>,</span> <span>&amp;H8BE8558B</span><span>,</span> <span>&amp;H4D8B0C45</span><span>,</span> <span>&amp;H5F0A89F0</span><span>,</span> <span>&amp;HC0855B5E</span><span>,</span> <span>&amp;HE8520A75</span><span>,</span> <span>&amp;H3294</span><span>&amp;,</span> <span>&amp;H2EBC033</span><span>,</span> <span>&amp;HE58BC28B</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H56EC8B55</span><span>,</span> <span>&amp;H87D8B57</span><span>,</span> <span>&amp;H106AF633</span><span>,</span> <span>&amp;H59206A5A</span><span>,</span> <span>&amp;HC78BCA2B</span><span>,</span> <span>&amp;HC085E8D3</span><span>,</span> <span>&amp;HCA8B0675</span><span>,</span> <span>&amp;HF203E7D3</span><span>,</span> <span>&amp;HE975FAD1</span><span>,</span> <span>&amp;H5EC68B5F</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H8BEC8B55</span><span>,</span> <span>&amp;H83990845</span><span>,</span> <span>&amp;HC2031FE2</span></td>
        </tr>
        <tr>
          <td id="L7507" data-line-number="7507"></td>
          <td id="LC7507">    <span>pvAppendBuffer</span> <span>&amp;H5605F8C1</span><span>,</span> <span>&amp;HECE85040</span><span>,</span> <span>&amp;H6A00004B</span><span>,</span> <span>&amp;H875FF01</span><span>,</span> <span>&amp;HE856F08B</span><span>,</span> <span>&amp;HFFFFFEA7</span><span>,</span> <span>&amp;H5D5EC68B</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H5151EC8B</span><span>,</span> <span>&amp;H53084D8B</span><span>,</span> <span>&amp;HDB335756</span><span>,</span> <span>&amp;HD90481</span><span>,</span> <span>&amp;H8B000100</span><span>,</span> <span>&amp;H5483D914</span><span>,</span> <span>&amp;H8B0004D9</span><span>,</span> <span>&amp;H3304D944</span><span>,</span> <span>&amp;HC2AC0FC9</span><span>,</span> <span>&amp;H10F8C110</span><span>,</span> <span>&amp;H89F85589</span><span>,</span> <span>&amp;HFB83FC45</span><span>,</span> <span>&amp;H4103750F</span><span>,</span> <span>&amp;HD23304EB</span><span>,</span> <span>&amp;HFB83C033</span><span>,</span> <span>&amp;H17B8D0F</span><span>,</span> <span>&amp;HF61B006A</span><span>,</span> <span>&amp;HAF0FDEF7</span><span>,</span> <span>&amp;H6AD12BF7</span><span>,</span> <span>&amp;HD88325</span><span>,</span> <span>&amp;H6AE85250</span><span>,</span> <span>&amp;H3FFFFF6</span><span>,</span> <span>&amp;H4D8BF845</span><span>,</span> <span>&amp;HFC551308</span></td>
        </tr>
        <tr>
          <td id="L7508" data-line-number="7508"></td>
          <td id="LC7508">    <span>pvAppendBuffer</span> <span>&amp;H8301E883</span><span>,</span> <span>&amp;H40100DA</span><span>,</span> <span>&amp;HFC458BF1</span><span>,</span> <span>&amp;H4F15411</span><span>,</span> <span>&amp;HFF8558B</span><span>,</span> <span>&amp;HC110D0A4</span><span>,</span> <span>&amp;H142910E2</span><span>,</span> <span>&amp;HD94419D9</span><span>,</span> <span>&amp;H83DF8B04</span><span>,</span> <span>&amp;H847210FB</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H4C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5610EC83</span><span>,</span> <span>&amp;H570C758B</span><span>,</span> <span>&amp;H51B2E856</span><span>,</span> <span>&amp;H45890000</span><span>,</span> <span>&amp;H4468DF0</span><span>,</span> <span>&amp;H51A6E850</span><span>,</span> <span>&amp;H45890000</span><span>,</span> <span>&amp;H8468DF4</span><span>,</span> <span>&amp;H519AE850</span><span>,</span> <span>&amp;H45890000</span><span>,</span> <span>&amp;HC468DF8</span><span>,</span> <span>&amp;H518EE850</span><span>,</span> <span>&amp;H4D8B0000</span><span>,</span> <span>&amp;HFC458908</span><span>,</span> <span>&amp;H798D318B</span><span>,</span> <span>&amp;HC1C68B04</span><span>,</span> <span>&amp;HF80304E0</span><span>,</span> <span>&amp;H57F0458D</span><span>,</span> <span>&amp;HF6C3E850</span></td>
        </tr>
        <tr>
          <td id="L7509" data-line-number="7509"></td>
          <td id="LC7509">    <span>pvAppendBuffer</span> <span>&amp;H21EBFFFF</span><span>,</span> <span>&amp;H3B6AE8</span><span>,</span> <span>&amp;HF0458D00</span><span>,</span> <span>&amp;H3BF7E850</span><span>,</span> <span>&amp;H8D570000</span><span>,</span> <span>&amp;HE850F045</span><span>,</span> <span>&amp;HFFFFF6A9</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;H3B18E8</span><span>,</span> <span>&amp;H10EF8300</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;H7501EE83</span><span>,</span> <span>&amp;H3B3DE8D3</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;HCAE850F0</span><span>,</span> <span>&amp;H5700003B</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;HFFF67CE8</span><span>,</span> <span>&amp;H10758BFF</span><span>,</span> <span>&amp;HF075FF56</span><span>,</span> <span>&amp;H6B72E8</span><span>,</span> <span>&amp;H4468D00</span><span>,</span> <span>&amp;HF475FF50</span><span>,</span> <span>&amp;H6B66E8</span><span>,</span> <span>&amp;H8468D00</span><span>,</span> <span>&amp;HF875FF50</span><span>,</span> <span>&amp;H6B5AE8</span><span>,</span> <span>&amp;HC468D00</span><span>,</span> <span>&amp;HFC75FF50</span><span>,</span> <span>&amp;H6B4EE8</span><span>,</span> <span>&amp;H8B5E5F00</span><span>,</span> <span>&amp;HCC25DE5</span></td>
        </tr>
        <tr>
          <td id="L7510" data-line-number="7510"></td>
          <td id="LC7510">    <span>pvAppendBuffer</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5310EC83</span><span>,</span> <span>&amp;HC758B56</span><span>,</span> <span>&amp;HE1E85657</span><span>,</span> <span>&amp;H89000050</span><span>,</span> <span>&amp;H468DF045</span><span>,</span> <span>&amp;HD5E85004</span><span>,</span> <span>&amp;H89000050</span><span>,</span> <span>&amp;H468DF445</span><span>,</span> <span>&amp;HC9E85008</span><span>,</span> <span>&amp;H89000050</span><span>,</span> <span>&amp;H468DF845</span><span>,</span> <span>&amp;HBDE8500C</span><span>,</span> <span>&amp;H8B000050</span><span>,</span> <span>&amp;H4589085D</span><span>,</span> <span>&amp;HF0458DFC</span><span>,</span> <span>&amp;H5604738D</span><span>,</span> <span>&amp;HF5FBE850</span><span>,</span> <span>&amp;HFF33FFFF</span><span>,</span> <span>&amp;H4710C683</span><span>,</span> <span>&amp;H2D763B39</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;H5ABDE8</span><span>,</span> <span>&amp;HF0458D00</span><span>,</span> <span>&amp;H59B3E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H13E850F0</span><span>,</span> <span>&amp;H5600003C</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;HFFF5CCE8</span><span>,</span> <span>&amp;H10C683FF</span><span>,</span> <span>&amp;H723B3B47</span></td>
        </tr>
        <tr>
          <td id="L7511" data-line-number="7511"></td>
          <td id="LC7511">    <span>pvAppendBuffer</span> <span>&amp;HF0458DD3</span><span>,</span> <span>&amp;H5A90E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H86E850F0</span><span>,</span> <span>&amp;H56000059</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;HFFF5A8E8</span><span>,</span> <span>&amp;H10758BFF</span><span>,</span> <span>&amp;HF075FF56</span><span>,</span> <span>&amp;H6A9EE8</span><span>,</span> <span>&amp;H4468D00</span><span>,</span> <span>&amp;HF475FF50</span><span>,</span> <span>&amp;H6A92E8</span><span>,</span> <span>&amp;H8468D00</span><span>,</span> <span>&amp;HF875FF50</span><span>,</span> <span>&amp;H6A86E8</span><span>,</span> <span>&amp;HC468D00</span><span>,</span> <span>&amp;HFC75FF50</span><span>,</span> <span>&amp;H6A7AE8</span><span>,</span> <span>&amp;H5B5E5F00</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H575653EC</span><span>,</span> <span>&amp;H8B1C75FF</span><span>,</span> <span>&amp;H75FF107D</span><span>,</span> <span>&amp;H57E85718</span><span>,</span> <span>&amp;H85000004</span><span>,</span> <span>&amp;HE81F74C0</span><span>,</span> <span>&amp;HFFFFE718</span><span>,</span> <span>&amp;H475BA0BE</span><span>,</span> <span>&amp;H4000BB00</span><span>,</span> <span>&amp;HF32B0047</span></td>
        </tr>
        <tr>
          <td id="L7512" data-line-number="7512"></td>
          <td id="LC7512">    <span>pvAppendBuffer</span> <span>&amp;H5E8F003</span><span>,</span> <span>&amp;HB9FFFFE7</span><span>,</span> <span>&amp;H475AAC</span><span>,</span> <span>&amp;H75FF2CEB</span><span>,</span> <span>&amp;H147D8B1C</span><span>,</span> <span>&amp;H571875FF</span><span>,</span> <span>&amp;H3CE8</span><span>&amp;,</span> <span>&amp;HE6EAE800</span><span>,</span> <span>&amp;H1BEFFFF</span><span>,</span> <span>&amp;HBB004759</span><span>,</span> <span>&amp;H474000</span><span>,</span> <span>&amp;HF003F32B</span><span>,</span> <span>&amp;HFFE6D7E8</span><span>,</span> <span>&amp;H5831B9FF</span><span>,</span> <span>&amp;HCB2B0047</span><span>,</span> <span>&amp;H4D8BC103</span><span>,</span> <span>&amp;H8418908</span><span>,</span> <span>&amp;H890C458B</span><span>,</span> <span>&amp;H1C70471</span><span>,</span> <span>&amp;H10</span><span>&amp;,</span> <span>&amp;H5E5F3889</span><span>,</span> <span>&amp;H18C25D5B</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8758B56</span><span>,</span> <span>&amp;HF468</span><span>&amp;,</span> <span>&amp;H56006A00</span><span>,</span> <span>&amp;H3AC0E8</span><span>,</span> <span>&amp;HCC48300</span><span>,</span> <span>&amp;H10107D83</span><span>,</span> <span>&amp;H7D832074</span><span>,</span> <span>&amp;H10741810</span><span>,</span> <span>&amp;H20107D83</span></td>
        </tr>
        <tr>
          <td id="L7513" data-line-number="7513"></td>
          <td id="LC7513">    <span>pvAppendBuffer</span> <span>&amp;H6C72575</span><span>,</span> <span>&amp;HE</span><span>&amp;,</span> <span>&amp;H12EB206A</span><span>,</span> <span>&amp;HC06C7</span><span>,</span> <span>&amp;H186A0000</span><span>,</span> <span>&amp;H6C708EB</span><span>,</span> <span>&amp;HA</span><span>&amp;,</span> <span>&amp;H75FF106A</span><span>,</span> <span>&amp;HC1E8560C</span><span>,</span> <span>&amp;H5EFFFFF4</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;H51DC8B53</span><span>,</span> <span>&amp;HF0E48351</span><span>,</span> <span>&amp;H5504C483</span><span>,</span> <span>&amp;H89046B8B</span><span>,</span> <span>&amp;H8B04246C</span><span>,</span> <span>&amp;H2CEC83EC</span><span>,</span> <span>&amp;H8B084B8B</span><span>,</span> <span>&amp;H6A560C43</span><span>,</span> <span>&amp;H918B10</span><span>,</span> <span>&amp;HF000002</span><span>,</span> <span>&amp;H18B3810</span><span>,</span> <span>&amp;H2280F5E</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;H290FF8EF</span><span>,</span> <span>&amp;HE883F07D</span><span>,</span> <span>&amp;H483C740A</span><span>,</span> <span>&amp;H7401E883</span><span>,</span> <span>&amp;HE883481E</span><span>,</span> <span>&amp;H95850F01</span><span>,</span> <span>&amp;HF000000</span><span>,</span> <span>&amp;HD6030A28</span></td>
        </tr>
        <tr>
          <td id="L7514" data-line-number="7514"></td>
          <td id="LC7514">    <span>pvAppendBuffer</span> <span>&amp;HDE380F66</span><span>,</span> <span>&amp;H2280FF9</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;HFF8DE38</span><span>,</span> <span>&amp;HD6030A28</span><span>,</span> <span>&amp;HDE380F66</span><span>,</span> <span>&amp;H2280FF9</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;HFF8DE38</span><span>,</span> <span>&amp;HFF07D29</span><span>,</span> <span>&amp;HD6033A28</span><span>,</span> <span>&amp;H332280F</span><span>,</span> <span>&amp;H75290FD6</span><span>,</span> <span>&amp;H75280FE0</span><span>,</span> <span>&amp;H380F66F0</span><span>,</span> <span>&amp;H280FF7DE</span><span>,</span> <span>&amp;HFD6032A</span><span>,</span> <span>&amp;HFF07529</span><span>,</span> <span>&amp;H66F07D28</span><span>,</span> <span>&amp;H7DDE380F</span><span>,</span> <span>&amp;H22280FE0</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;H66FDDE38</span><span>,</span> <span>&amp;HFCDE380F</span><span>,</span> <span>&amp;H31A280F</span><span>,</span> <span>&amp;H380F66D6</span><span>,</span> <span>&amp;H280FFBDE</span><span>,</span> <span>&amp;H66D60312</span><span>,</span> <span>&amp;HFADE380F</span><span>,</span> <span>&amp;H30A280F</span><span>,</span> <span>&amp;H380F66D6</span><span>,</span> <span>&amp;HF66F9DE</span></td>
        </tr>
        <tr>
          <td id="L7515" data-line-number="7515"></td>
          <td id="LC7515">    <span>pvAppendBuffer</span> <span>&amp;H663ADE38</span><span>,</span> <span>&amp;H3CDE380F</span><span>,</span> <span>&amp;H380F6632</span><span>,</span> <span>&amp;H10327CDF</span><span>,</span> <span>&amp;H5E10438B</span><span>,</span> <span>&amp;H8B38110F</span><span>,</span> <span>&amp;HE38B5DE5</span><span>,</span> <span>&amp;HCC25B</span><span>,</span> <span>&amp;H51DC8B53</span><span>,</span> <span>&amp;HF0E48351</span><span>,</span> <span>&amp;H5504C483</span><span>,</span> <span>&amp;H89046B8B</span><span>,</span> <span>&amp;H8B04246C</span><span>,</span> <span>&amp;H2CEC83EC</span><span>,</span> <span>&amp;H8B084B8B</span><span>,</span> <span>&amp;H6A560C43</span><span>,</span> <span>&amp;HFC918B10</span><span>,</span> <span>&amp;HF000001</span><span>,</span> <span>&amp;H18B3810</span><span>,</span> <span>&amp;H2280F5E</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;H290FF8EF</span><span>,</span> <span>&amp;HE883F07D</span><span>,</span> <span>&amp;H483C740A</span><span>,</span> <span>&amp;H7401E883</span><span>,</span> <span>&amp;HE883481E</span><span>,</span> <span>&amp;H95850F01</span><span>,</span> <span>&amp;HF000000</span><span>,</span> <span>&amp;HD6030A28</span><span>,</span> <span>&amp;HDC380F66</span><span>,</span> <span>&amp;H2280FF9</span><span>,</span> <span>&amp;HF66D603</span></td>
        </tr>
        <tr>
          <td id="L7516" data-line-number="7516"></td>
          <td id="LC7516">    <span>pvAppendBuffer</span> <span>&amp;HFF8DC38</span><span>,</span> <span>&amp;HD6030A28</span><span>,</span> <span>&amp;HDC380F66</span><span>,</span> <span>&amp;H2280FF9</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;HFF8DC38</span><span>,</span> <span>&amp;HFF07D29</span><span>,</span> <span>&amp;HD6033A28</span><span>,</span> <span>&amp;H332280F</span><span>,</span> <span>&amp;H75290FD6</span><span>,</span> <span>&amp;H75280FE0</span><span>,</span> <span>&amp;H380F66F0</span><span>,</span> <span>&amp;H280FF7DC</span><span>,</span> <span>&amp;HFD6032A</span><span>,</span> <span>&amp;HFF07529</span><span>,</span> <span>&amp;H66F07D28</span><span>,</span> <span>&amp;H7DDC380F</span><span>,</span> <span>&amp;H22280FE0</span><span>,</span> <span>&amp;HF66D603</span><span>,</span> <span>&amp;H66FDDC38</span><span>,</span> <span>&amp;HFCDC380F</span><span>,</span> <span>&amp;H31A280F</span><span>,</span> <span>&amp;H380F66D6</span><span>,</span> <span>&amp;H280FFBDC</span><span>,</span> <span>&amp;H66D60312</span><span>,</span> <span>&amp;HFADC380F</span><span>,</span> <span>&amp;H30A280F</span><span>,</span> <span>&amp;H380F66D6</span><span>,</span> <span>&amp;HF66F9DC</span><span>,</span> <span>&amp;H663ADC38</span><span>,</span> <span>&amp;H3CDC380F</span><span>,</span> <span>&amp;H380F6632</span></td>
        </tr>
        <tr>
          <td id="L7517" data-line-number="7517"></td>
          <td id="LC7517">    <span>pvAppendBuffer</span> <span>&amp;H10327CDD</span><span>,</span> <span>&amp;H5E10438B</span><span>,</span> <span>&amp;H8B38110F</span><span>,</span> <span>&amp;HE38B5DE5</span><span>,</span> <span>&amp;HCC25B</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;H10CEC</span><span>,</span> <span>&amp;HC458B00</span><span>,</span> <span>&amp;H5756C933</span><span>,</span> <span>&amp;H1F445C7</span><span>,</span> <span>&amp;H8B080402</span><span>,</span> <span>&amp;H6788DF1</span><span>,</span> <span>&amp;H10F845C7</span><span>,</span> <span>&amp;H8D804020</span><span>,</span> <span>&amp;H4BD14</span><span>,</span> <span>&amp;HC7660000</span><span>,</span> <span>&amp;H361BFC45</span><span>,</span> <span>&amp;H89E47D89</span><span>,</span> <span>&amp;HD285E855</span><span>,</span> <span>&amp;HE7840F</span><span>,</span> <span>&amp;H7D8B0000</span><span>,</span> <span>&amp;HF4558D0C</span><span>,</span> <span>&amp;H8DF05589</span><span>,</span> <span>&amp;HFFFEF495</span><span>,</span> <span>&amp;H2E0C1FF</span><span>,</span> <span>&amp;H458BD02B</span><span>,</span> <span>&amp;HEC558908</span><span>,</span> <span>&amp;HFEF4958D</span><span>,</span> <span>&amp;HC22BFFFF</span><span>,</span> <span>&amp;H3B084589</span><span>,</span> <span>&amp;H8D1B73F7</span><span>,</span> <span>&amp;H8D8DB004</span></td>
        </tr>
        <tr>
          <td id="L7518" data-line-number="7518"></td>
          <td id="LC7518">    <span>pvAppendBuffer</span> <span>&amp;HFFFFFEF4</span><span>,</span> <span>&amp;HE850C103</span><span>,</span> <span>&amp;H4D10</span><span>&amp;,</span> <span>&amp;H33EC558B</span><span>,</span> <span>&amp;H86E9C9</span><span>,</span> <span>&amp;H848B0000</span><span>,</span> <span>&amp;HFFFEF0B5</span><span>,</span> <span>&amp;H89D233FF</span><span>,</span> <span>&amp;HC68B0C45</span><span>,</span> <span>&amp;HFF83F7F7</span><span>,</span> <span>&amp;H8B0A7508</span><span>,</span> <span>&amp;H3C0724C6</span><span>,</span> <span>&amp;H7401B004</span><span>,</span> <span>&amp;H85C18A02</span><span>,</span> <span>&amp;H663275D2</span><span>,</span> <span>&amp;HC4D6E0F</span><span>,</span> <span>&amp;H570FC033</span><span>,</span> <span>&amp;H6E0F66D2</span><span>,</span> <span>&amp;HF0458BC0</span><span>,</span> <span>&amp;HC8620F66</span><span>,</span> <span>&amp;HD1620F66</span><span>,</span> <span>&amp;HDF3A0F66</span><span>,</span> <span>&amp;HB60F00C2</span><span>,</span> <span>&amp;H3A0F6600</span><span>,</span> <span>&amp;H3301C216</span><span>,</span> <span>&amp;HF045FFD0</span><span>,</span> <span>&amp;HEB0C5589</span><span>,</span> <span>&amp;H74C08427</span><span>,</span> <span>&amp;H6E0F6623</span><span>,</span> <span>&amp;HC0330C4D</span><span>,</span> <span>&amp;H66D2570F</span><span>,</span> <span>&amp;H66C06E0F</span></td>
        </tr>
        <tr>
          <td id="L7519" data-line-number="7519"></td>
          <td id="LC7519">    <span>pvAppendBuffer</span> <span>&amp;H66C8620F</span><span>,</span> <span>&amp;H66D1620F</span><span>,</span> <span>&amp;HC2DF3A0F</span><span>,</span> <span>&amp;H3A0F6600</span><span>,</span> <span>&amp;HC4516</span><span>,</span> <span>&amp;H8BEC558B</span><span>,</span> <span>&amp;HC453302</span><span>,</span> <span>&amp;HF4B58489</span><span>,</span> <span>&amp;H83FFFFFE</span><span>,</span> <span>&amp;H458B04C2</span><span>,</span> <span>&amp;H55894608</span><span>,</span> <span>&amp;HE8753BEC</span><span>,</span> <span>&amp;HFF41820F</span><span>,</span> <span>&amp;H7D8BFFFF</span><span>,</span> <span>&amp;H10558BE4</span><span>,</span> <span>&amp;HFEF8858D</span><span>,</span> <span>&amp;HF08BFFFF</span><span>,</span> <span>&amp;H778DD62B</span><span>,</span> <span>&amp;H8758901</span><span>,</span> <span>&amp;H8310758B</span><span>,</span> <span>&amp;H6601086D</span><span>,</span> <span>&amp;H8586E0F</span><span>,</span> <span>&amp;H406E0F66</span><span>,</span> <span>&amp;H6E0F6604</span><span>,</span> <span>&amp;H6E0F6608</span><span>,</span> <span>&amp;HF66FC50</span><span>,</span> <span>&amp;HF66D062</span><span>,</span> <span>&amp;HF66CB62</span><span>,</span> <span>&amp;H290FD162</span><span>,</span> <span>&amp;H408D0214</span><span>,</span> <span>&amp;H68D47510</span><span>,</span> <span>&amp;HF0</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7520" data-line-number="7520"></td>
          <td id="LC7520">    <span>pvAppendBuffer</span> <span>&amp;HF4858D51</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H3720E8</span><span>,</span> <span>&amp;H83CF8B00</span><span>,</span> <span>&amp;HE1C10CC4</span><span>,</span> <span>&amp;H144D0304</span><span>,</span> <span>&amp;H280FD233</span><span>,</span> <span>&amp;H74D28506</span><span>,</span> <span>&amp;H2BC78B0B</span><span>,</span> <span>&amp;H660574C2</span><span>,</span> <span>&amp;HC0DB380F</span><span>,</span> <span>&amp;H4201290F</span><span>,</span> <span>&amp;H8310C683</span><span>,</span> <span>&amp;HD73B10E9</span><span>,</span> <span>&amp;H5E5FE076</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H10EC83EC</span><span>,</span> <span>&amp;H33575653</span><span>,</span> <span>&amp;HF07D8DC0</span><span>,</span> <span>&amp;H53C93340</span><span>,</span> <span>&amp;HF38BA20F</span><span>,</span> <span>&amp;H8907895B</span><span>,</span> <span>&amp;H4F890477</span><span>,</span> <span>&amp;HC578908</span><span>,</span> <span>&amp;HF845F7</span><span>,</span> <span>&amp;H74020000</span><span>,</span> <span>&amp;HF845F75F</span><span>,</span> <span>&amp;H80000</span><span>,</span> <span>&amp;H7D8B5674</span><span>,</span> <span>&amp;H8BC78B10</span><span>,</span> <span>&amp;HCE8B0875</span></td>
        </tr>
        <tr>
          <td id="L7521" data-line-number="7521"></td>
          <td id="LC7521">    <span>pvAppendBuffer</span> <span>&amp;H83D1F799</span><span>,</span> <span>&amp;HEFC103E2</span><span>,</span> <span>&amp;HC1C20302</span><span>,</span> <span>&amp;HC08302F8</span><span>,</span> <span>&amp;H8D068906</span><span>,</span> <span>&amp;HD0F70446</span><span>,</span> <span>&amp;H2E8C140</span><span>,</span> <span>&amp;H4003E083</span><span>,</span> <span>&amp;H2E9C141</span><span>,</span> <span>&amp;H8303E183</span><span>,</span> <span>&amp;H148D40C1</span><span>,</span> <span>&amp;HFC968986</span><span>,</span> <span>&amp;H8D000001</span><span>,</span> <span>&amp;H52518E0C</span><span>,</span> <span>&amp;HC75FF57</span><span>,</span> <span>&amp;H2008E89</span><span>,</span> <span>&amp;HCDE80000</span><span>,</span> <span>&amp;H33FFFFFD</span><span>,</span> <span>&amp;H2EB40C0</span><span>,</span> <span>&amp;H5E5FC033</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;HEC81EC8B</span><span>,</span> <span>&amp;H228</span><span>&amp;,</span> <span>&amp;H8D1C75FF</span><span>,</span> <span>&amp;HFFFDD885</span><span>,</span> <span>&amp;H1875FFFF</span><span>,</span> <span>&amp;H458D5050</span><span>,</span> <span>&amp;H458D501C</span><span>,</span> <span>&amp;HDBE850F4</span><span>,</span> <span>&amp;HFFFFFFFA</span><span>,</span> <span>&amp;H458D1475</span></td>
        </tr>
        <tr>
          <td id="L7522" data-line-number="7522"></td>
          <td id="LC7522">    <span>pvAppendBuffer</span> <span>&amp;H1C75FFF4</span><span>,</span> <span>&amp;HDC458D50</span><span>,</span> <span>&amp;H42FE850</span><span>,</span> <span>&amp;H458B0000</span><span>,</span> <span>&amp;H4E8C110</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;HFFDC458D</span><span>,</span> <span>&amp;HE8500C75</span><span>,</span> <span>&amp;H339</span><span>&amp;,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550018</span><span>,</span> <span>&amp;H28EC81EC</span><span>,</span> <span>&amp;HFF000002</span><span>,</span> <span>&amp;H858D1C75</span><span>,</span> <span>&amp;HFFFFFDD8</span><span>,</span> <span>&amp;H501875FF</span><span>,</span> <span>&amp;H1C458D50</span><span>,</span> <span>&amp;HF4458D50</span><span>,</span> <span>&amp;HFA88E850</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;HF4458D14</span><span>,</span> <span>&amp;H501C75FF</span><span>,</span> <span>&amp;H50DC458D</span><span>,</span> <span>&amp;H3DCE8</span><span>,</span> <span>&amp;H10458B00</span><span>,</span> <span>&amp;H5004E8C1</span><span>,</span> <span>&amp;H8D0875FF</span><span>,</span> <span>&amp;H75FFDC45</span><span>,</span> <span>&amp;H57E8500C</span><span>,</span> <span>&amp;H8B000003</span><span>,</span> <span>&amp;H18C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span></td>
        </tr>
        <tr>
          <td id="L7523" data-line-number="7523"></td>
          <td id="LC7523">    <span>pvAppendBuffer</span> <span>&amp;H210EC81</span><span>,</span> <span>&amp;H75FF0000</span><span>,</span> <span>&amp;HF0858D28</span><span>,</span> <span>&amp;HFFFFFFFD</span><span>,</span> <span>&amp;H50502475</span><span>,</span> <span>&amp;H5028458D</span><span>,</span> <span>&amp;H50F4458D</span><span>,</span> <span>&amp;HFFFA35E8</span><span>,</span> <span>&amp;H875FFFF</span><span>,</span> <span>&amp;H6AF4458D</span><span>,</span> <span>&amp;H1475FF10</span><span>,</span> <span>&amp;H75FF0C6A</span><span>,</span> <span>&amp;H1C75FF20</span><span>,</span> <span>&amp;HFF1875FF</span><span>,</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H2875FF0C</span><span>,</span> <span>&amp;HD40E850</span><span>,</span> <span>&amp;HE58B0000</span><span>,</span> <span>&amp;H24C25D</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;H210EC</span><span>,</span> <span>&amp;H2875FF00</span><span>,</span> <span>&amp;HFDF0858D</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;H8D505024</span><span>,</span> <span>&amp;H8D502845</span><span>,</span> <span>&amp;HE850F445</span><span>,</span> <span>&amp;HFFFFF9E6</span><span>,</span> <span>&amp;H75FF106A</span><span>,</span> <span>&amp;HF4458D0C</span><span>,</span> <span>&amp;H6A0875FF</span><span>,</span> <span>&amp;H2075FF0C</span></td>
        </tr>
        <tr>
          <td id="L7524" data-line-number="7524"></td>
          <td id="LC7524">    <span>pvAppendBuffer</span> <span>&amp;HFF1C75FF</span><span>,</span> <span>&amp;H75FF1875</span><span>,</span> <span>&amp;H1075FF14</span><span>,</span> <span>&amp;H502875FF</span><span>,</span> <span>&amp;HE9FE8</span><span>,</span> <span>&amp;H5DE58B00</span><span>,</span> <span>&amp;H550024C2</span><span>,</span> <span>&amp;H5751EC8B</span><span>,</span> <span>&amp;H33187D8B</span><span>,</span> <span>&amp;HFC5589D2</span><span>,</span> <span>&amp;H6374FF85</span><span>,</span> <span>&amp;HC5D8B53</span><span>,</span> <span>&amp;H8B0B8B56</span><span>,</span> <span>&amp;HF12B1075</span><span>,</span> <span>&amp;H3B184D89</span><span>,</span> <span>&amp;H8B0273FE</span><span>,</span> <span>&amp;H75D285F7</span><span>,</span> <span>&amp;H45B60F1A</span><span>,</span> <span>&amp;H8B505614</span><span>,</span> <span>&amp;HC1030845</span><span>,</span> <span>&amp;H34D7E850</span><span>,</span> <span>&amp;H4D8B0000</span><span>,</span> <span>&amp;HCC48318</span><span>,</span> <span>&amp;H85FC558B</span><span>,</span> <span>&amp;H3B0B75C9</span><span>,</span> <span>&amp;H6751075</span><span>,</span> <span>&amp;H8942D233</span><span>,</span> <span>&amp;H48DFC55</span><span>,</span> <span>&amp;H10453B0E</span><span>,</span> <span>&amp;H75FF1175</span><span>,</span> <span>&amp;H2075FF08</span><span>,</span> <span>&amp;H831C55FF</span></td>
        </tr>
        <tr>
          <td id="L7525" data-line-number="7525"></td>
          <td id="LC7525">    <span>pvAppendBuffer</span> <span>&amp;H558B0023</span><span>,</span> <span>&amp;H102EBFC</span><span>,</span> <span>&amp;H75FE2B33</span><span>,</span> <span>&amp;H5F5B5EA4</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B55001C</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;H83C68B20</span><span>,</span> <span>&amp;H840F00E8</span><span>,</span> <span>&amp;H86</span><span>&amp;,</span> <span>&amp;HFF2875FF</span><span>,</span> <span>&amp;H16A2475</span><span>,</span> <span>&amp;H7401E883</span><span>,</span> <span>&amp;H1E88361</span><span>,</span> <span>&amp;H5014458D</span><span>,</span> <span>&amp;HFF1075FF</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;HE8487408</span><span>,</span> <span>&amp;H67</span><span>&amp;,</span> <span>&amp;H8B2875FF</span><span>,</span> <span>&amp;H75FF184D</span><span>,</span> <span>&amp;H1C4D3824</span><span>,</span> <span>&amp;H468D2074</span><span>,</span> <span>&amp;HFF5150FE</span><span>,</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H875FF0C</span><span>,</span> <span>&amp;HFFFF2EE8</span><span>,</span> <span>&amp;H2875FFFF</span><span>,</span> <span>&amp;HFF1C458D</span><span>,</span> <span>&amp;H16A2475</span><span>,</span> <span>&amp;H468D25EB</span><span>,</span> <span>&amp;HFF5150FF</span></td>
        </tr>
        <tr>
          <td id="L7526" data-line-number="7526"></td>
          <td id="LC7526">    <span>pvAppendBuffer</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H875FF0C</span><span>,</span> <span>&amp;HFFFF0EE8</span><span>,</span> <span>&amp;HE81FEBFF</span><span>,</span> <span>&amp;H1F</span><span>&amp;,</span> <span>&amp;H458AD7EB</span><span>,</span> <span>&amp;H1445301C</span><span>,</span> <span>&amp;H5014458D</span><span>,</span> <span>&amp;HFF1075FF</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;H5E808</span><span>,</span> <span>&amp;H5D5E0000</span><span>,</span> <span>&amp;H550024C2</span><span>,</span> <span>&amp;H75FFEC8B</span><span>,</span> <span>&amp;H1C75FF20</span><span>,</span> <span>&amp;HFF1C75FF</span><span>,</span> <span>&amp;H75FF1875</span><span>,</span> <span>&amp;H1075FF14</span><span>,</span> <span>&amp;HFF0C75FF</span><span>,</span> <span>&amp;H4E80875</span><span>,</span> <span>&amp;H5D000000</span><span>,</span> <span>&amp;H55001CC2</span><span>,</span> <span>&amp;H458BEC8B</span><span>,</span> <span>&amp;H5D8B530C</span><span>,</span> <span>&amp;H38835614</span><span>,</span> <span>&amp;H18758B00</span><span>,</span> <span>&amp;H107D8B57</span><span>,</span> <span>&amp;HF6856274</span><span>,</span> <span>&amp;HCF8B5E74</span><span>,</span> <span>&amp;H4D89082B</span><span>,</span> <span>&amp;H72CE3B18</span><span>,</span> <span>&amp;H89CE8B05</span></td>
        </tr>
        <tr>
          <td id="L7527" data-line-number="7527"></td>
          <td id="LC7527">    <span>pvAppendBuffer</span> <span>&amp;H8B1875</span><span>,</span> <span>&amp;H51084503</span><span>,</span> <span>&amp;H79E85053</span><span>,</span> <span>&amp;H8B000033</span><span>,</span> <span>&amp;HC4830C45</span><span>,</span> <span>&amp;H184D8B0C</span><span>,</span> <span>&amp;HF12BD903</span><span>,</span> <span>&amp;H38390801</span><span>,</span> <span>&amp;H75FF2E75</span><span>,</span> <span>&amp;H2475FF08</span><span>,</span> <span>&amp;H575F685</span><span>,</span> <span>&amp;HEB2055FF</span><span>,</span> <span>&amp;H1C55FF03</span><span>,</span> <span>&amp;H830C458B</span><span>,</span> <span>&amp;H14EB0020</span><span>,</span> <span>&amp;H2475FF53</span><span>,</span> <span>&amp;H575F73B</span><span>,</span> <span>&amp;HEB2055FF</span><span>,</span> <span>&amp;H1C55FF03</span><span>,</span> <span>&amp;HF72BDF03</span><span>,</span> <span>&amp;HE873F73B</span><span>,</span> <span>&amp;H2974F685</span><span>,</span> <span>&amp;H8B0C458B</span><span>,</span> <span>&amp;H3BF82B00</span><span>,</span> <span>&amp;H8B0272FE</span><span>,</span> <span>&amp;H84503FE</span><span>,</span> <span>&amp;HE8505357</span><span>,</span> <span>&amp;H3318</span><span>&amp;,</span> <span>&amp;H30C458B</span><span>,</span> <span>&amp;HCC483DF</span><span>,</span> <span>&amp;HF72B3801</span><span>,</span> <span>&amp;H75107D8B</span></td>
        </tr>
        <tr>
          <td id="L7528" data-line-number="7528"></td>
          <td id="LC7528">    <span>pvAppendBuffer</span> <span>&amp;H5B5E5FDA</span><span>,</span> <span>&amp;H20C25D</span><span>,</span> <span>&amp;H56EC8B55</span><span>,</span> <span>&amp;H851C758B</span><span>,</span> <span>&amp;H534574F6</span><span>,</span> <span>&amp;H570C5D8B</span><span>,</span> <span>&amp;H75003B83</span><span>,</span> <span>&amp;H875FF10</span><span>,</span> <span>&amp;HFF2475FF</span><span>,</span> <span>&amp;H458B2055</span><span>,</span> <span>&amp;HEB038910</span><span>,</span> <span>&amp;H10458B03</span><span>,</span> <span>&amp;HC72B3B8B</span><span>,</span> <span>&amp;H272FE3B</span><span>,</span> <span>&amp;H4503FE8B</span><span>,</span> <span>&amp;HFF505708</span><span>,</span> <span>&amp;H75FF1475</span><span>,</span> <span>&amp;H62D4E818</span><span>,</span> <span>&amp;H3B290000</span><span>,</span> <span>&amp;H1187D01</span><span>,</span> <span>&amp;HF72B147D</span><span>,</span> <span>&amp;H5B5FC275</span><span>,</span> <span>&amp;H20C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5310EC83</span><span>,</span> <span>&amp;H56145D8B</span><span>,</span> <span>&amp;H8B08758B</span><span>,</span> <span>&amp;H89008B06</span><span>,</span> <span>&amp;HDB850845</span><span>,</span> <span>&amp;H8B575074</span><span>,</span> <span>&amp;H7D290C7D</span><span>,</span> <span>&amp;H8D068B10</span></td>
        </tr>
        <tr>
          <td id="L7529" data-line-number="7529"></td>
          <td id="LC7529">    <span>pvAppendBuffer</span> <span>&amp;H5751F04D</span><span>,</span> <span>&amp;HFF0476FF</span><span>,</span> <span>&amp;H75FF0850</span><span>,</span> <span>&amp;H8468D08</span><span>,</span> <span>&amp;HF0458D50</span><span>,</span> <span>&amp;H83E85050</span><span>,</span> <span>&amp;HFF000062</span><span>,</span> <span>&amp;H468D0875</span><span>,</span> <span>&amp;HE8505708</span><span>,</span> <span>&amp;H3260</span><span>&amp;,</span> <span>&amp;H8D0875FF</span><span>,</span> <span>&amp;H8B50F045</span><span>,</span> <span>&amp;HC7031045</span><span>,</span> <span>&amp;H324EE850</span><span>,</span> <span>&amp;H7D030000</span><span>,</span> <span>&amp;H18C48308</span><span>,</span> <span>&amp;H7501EB83</span><span>,</span> <span>&amp;H5B5E5FB8</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H10EC83EC</span><span>,</span> <span>&amp;H8758B56</span><span>,</span> <span>&amp;H147D8B57</span><span>,</span> <span>&amp;H88B068B</span><span>,</span> <span>&amp;H85084D89</span><span>,</span> <span>&amp;H8B4E74FF</span><span>,</span> <span>&amp;H568D0C45</span><span>,</span> <span>&amp;H5D8B5308</span><span>,</span> <span>&amp;H89C32B10</span><span>,</span> <span>&amp;H52510C45</span><span>,</span> <span>&amp;H8D50C303</span><span>,</span> <span>&amp;HE850F045</span></td>
        </tr>
        <tr>
          <td id="L7530" data-line-number="7530"></td>
          <td id="LC7530">    <span>pvAppendBuffer</span> <span>&amp;H621A</span><span>&amp;,</span> <span>&amp;H4E8D068B</span><span>,</span> <span>&amp;H4D8D5108</span><span>,</span> <span>&amp;H76FF51F0</span><span>,</span> <span>&amp;H450FF04</span><span>,</span> <span>&amp;H8D0875FF</span><span>,</span> <span>&amp;H53500846</span><span>,</span> <span>&amp;H31E7E8</span><span>,</span> <span>&amp;H84D8B00</span><span>,</span> <span>&amp;H8B08568D</span><span>,</span> <span>&amp;HC4830C45</span><span>,</span> <span>&amp;H83D9030C</span><span>,</span> <span>&amp;HC27501EF</span><span>,</span> <span>&amp;H8B5E5F5B</span><span>,</span> <span>&amp;H10C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8B08558B</span><span>,</span> <span>&amp;H458B0C4D</span><span>,</span> <span>&amp;H4428910</span><span>,</span> <span>&amp;H8908428D</span><span>,</span> <span>&amp;HFF31FF0A</span><span>,</span> <span>&amp;HE8501475</span><span>,</span> <span>&amp;H31AC</span><span>&amp;,</span> <span>&amp;H5D0CC483</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;HA1E8EC8B</span><span>,</span> <span>&amp;HB9FFFFDD</span><span>,</span> <span>&amp;H4768B3</span><span>,</span> <span>&amp;H4000E981</span><span>,</span> <span>&amp;HC1030047</span><span>,</span> <span>&amp;H51084D8B</span><span>,</span> <span>&amp;H1475FF50</span></td>
        </tr>
        <tr>
          <td id="L7531" data-line-number="7531"></td>
          <td id="LC7531">    <span>pvAppendBuffer</span> <span>&amp;HFF74418D</span><span>,</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H50406A0C</span><span>,</span> <span>&amp;H5034418D</span><span>,</span> <span>&amp;HFFFE73E8</span><span>,</span> <span>&amp;H10C25DFF</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5370EC83</span><span>,</span> <span>&amp;H14758B56</span><span>,</span> <span>&amp;H71E85657</span><span>,</span> <span>&amp;H8D000046</span><span>,</span> <span>&amp;HF88B044E</span><span>,</span> <span>&amp;HD07D8951</span><span>,</span> <span>&amp;H4663E8</span><span>,</span> <span>&amp;H84E8D00</span><span>,</span> <span>&amp;H51F84589</span><span>,</span> <span>&amp;HE8CC4589</span><span>,</span> <span>&amp;H4654</span><span>&amp;,</span> <span>&amp;H890C4E8D</span><span>,</span> <span>&amp;H8951F445</span><span>,</span> <span>&amp;H45E8C845</span><span>,</span> <span>&amp;H8B000046</span><span>,</span> <span>&amp;H89560875</span><span>,</span> <span>&amp;H4589F045</span><span>,</span> <span>&amp;H4636E8C4</span><span>,</span> <span>&amp;H4E8D0000</span><span>,</span> <span>&amp;HD4458904</span><span>,</span> <span>&amp;HC0458951</span><span>,</span> <span>&amp;H4627E8</span><span>,</span> <span>&amp;H84E8D00</span><span>,</span> <span>&amp;H51E84589</span><span>,</span> <span>&amp;HE8BC4589</span></td>
        </tr>
        <tr>
          <td id="L7532" data-line-number="7532"></td>
          <td id="LC7532">    <span>pvAppendBuffer</span> <span>&amp;H4618&amp;</span><span>,</span> <span>&amp;H890C4E8D</span><span>,</span> <span>&amp;H8951E445</span><span>,</span> <span>&amp;H9E8B845</span><span>,</span> <span>&amp;H8B000046</span><span>,</span> <span>&amp;H89560C75</span><span>,</span> <span>&amp;H4589E045</span><span>,</span> <span>&amp;H45FAE8B4</span><span>,</span> <span>&amp;H4E8D0000</span><span>,</span> <span>&amp;HFC458904</span><span>,</span> <span>&amp;HB0458951</span><span>,</span> <span>&amp;H45EBE8</span><span>,</span> <span>&amp;H84E8D00</span><span>,</span> <span>&amp;H51084589</span><span>,</span> <span>&amp;HE8AC4589</span><span>,</span> <span>&amp;H45DC</span><span>&amp;,</span> <span>&amp;H890C4E8D</span><span>,</span> <span>&amp;H89511445</span><span>,</span> <span>&amp;HCDE8A845</span><span>,</span> <span>&amp;H8B000045</span><span>,</span> <span>&amp;H89561075</span><span>,</span> <span>&amp;H45890C45</span><span>,</span> <span>&amp;H45BEE8A4</span><span>,</span> <span>&amp;H4E8D0000</span><span>,</span> <span>&amp;H51D88B04</span><span>,</span> <span>&amp;HE8A05D89</span><span>,</span> <span>&amp;H45B0</span><span>&amp;,</span> <span>&amp;H89084E8D</span><span>,</span> <span>&amp;H8951DC45</span><span>,</span> <span>&amp;HA1E89C45</span><span>,</span> <span>&amp;H8D000045</span><span>,</span> <span>&amp;H45890C4E</span></td>
        </tr>
        <tr>
          <td id="L7533" data-line-number="7533"></td>
          <td id="LC7533">    <span>pvAppendBuffer</span> <span>&amp;H458951D8</span><span>,</span> <span>&amp;H4592E898</span><span>,</span> <span>&amp;H4D8B0000</span><span>,</span> <span>&amp;H8BF08BDC</span><span>,</span> <span>&amp;H7589D855</span><span>,</span> <span>&amp;H9045C794</span><span>,</span> <span>&amp;HA</span><span>&amp;,</span> <span>&amp;H758B06EB</span><span>,</span> <span>&amp;H107D8BEC</span><span>,</span> <span>&amp;H8BD47D03</span><span>,</span> <span>&amp;HDF33FC45</span><span>,</span> <span>&amp;H310C3C1</span><span>,</span> <span>&amp;HFC4589C3</span><span>,</span> <span>&amp;HC1D44533</span><span>,</span> <span>&amp;HF8030CC0</span><span>,</span> <span>&amp;H7D89DF33</span><span>,</span> <span>&amp;HFC7D8B10</span><span>,</span> <span>&amp;H308C3C1</span><span>,</span> <span>&amp;HFC7D89FB</span><span>,</span> <span>&amp;H458BF833</span><span>,</span> <span>&amp;HE84503F8</span><span>,</span> <span>&amp;H4589C833</span><span>,</span> <span>&amp;H8458BF8</span><span>,</span> <span>&amp;H310C1C1</span><span>,</span> <span>&amp;H7C7C1C1</span><span>,</span> <span>&amp;H33084589</span><span>,</span> <span>&amp;HC0C1E845</span><span>,</span> <span>&amp;HF845010C</span><span>,</span> <span>&amp;HC1F84D33</span><span>,</span> <span>&amp;H4D0108C1</span><span>,</span> <span>&amp;HDC4D8908</span><span>,</span> <span>&amp;H33084D8B</span></td>
        </tr>
        <tr>
          <td id="L7534" data-line-number="7534"></td>
          <td id="LC7534">    <span>pvAppendBuffer</span> <span>&amp;HF4458BC8</span><span>,</span> <span>&amp;H33E44503</span><span>,</span> <span>&amp;HF44589D0</span><span>,</span> <span>&amp;HC114458B</span><span>,</span> <span>&amp;HC20310C2</span><span>,</span> <span>&amp;H8907C1C1</span><span>,</span> <span>&amp;H45331445</span><span>,</span> <span>&amp;HCC0C1E4</span><span>,</span> <span>&amp;H33F44501</span><span>,</span> <span>&amp;HC2C1F455</span><span>,</span> <span>&amp;H14550108</span><span>,</span> <span>&amp;H89104D01</span><span>,</span> <span>&amp;H558BD855</span><span>,</span> <span>&amp;H8BD03314</span><span>,</span> <span>&amp;H4503F045</span><span>,</span> <span>&amp;H89F033E0</span><span>,</span> <span>&amp;H458BF045</span><span>,</span> <span>&amp;H10C6C10C</span><span>,</span> <span>&amp;HC2C1C603</span><span>,</span> <span>&amp;HC458907</span><span>,</span> <span>&amp;HC1E04533</span><span>,</span> <span>&amp;H45010CC0</span><span>,</span> <span>&amp;HF07533F0</span><span>,</span> <span>&amp;H108C6C1</span><span>,</span> <span>&amp;H75890C75</span><span>,</span> <span>&amp;HC758BEC</span><span>,</span> <span>&amp;H458BF033</span><span>,</span> <span>&amp;H104533EC</span><span>,</span> <span>&amp;H110C0C1</span><span>,</span> <span>&amp;H45891445</span><span>,</span> <span>&amp;H14458BEC</span><span>,</span> <span>&amp;HC6C1C133</span></td>
        </tr>
        <tr>
          <td id="L7535" data-line-number="7535"></td>
          <td id="LC7535">    <span>pvAppendBuffer</span> <span>&amp;HCC0C107</span><span>,</span> <span>&amp;H8B104501</span><span>,</span> <span>&amp;H4D33EC4D</span><span>,</span> <span>&amp;H8C1C110</span><span>,</span> <span>&amp;H89144D01</span><span>,</span> <span>&amp;H4D8BEC4D</span><span>,</span> <span>&amp;H8BC83314</span><span>,</span> <span>&amp;HC1C10C45</span><span>,</span> <span>&amp;HE84D8907</span><span>,</span> <span>&amp;H3F84D8B</span><span>,</span> <span>&amp;HC1D933CA</span><span>,</span> <span>&amp;HC30310C3</span><span>,</span> <span>&amp;H330C4589</span><span>,</span> <span>&amp;HF4558BC2</span><span>,</span> <span>&amp;H30CC0C1</span><span>,</span> <span>&amp;H33C803D6</span><span>,</span> <span>&amp;HF84D89D9</span><span>,</span> <span>&amp;HC10C4D8B</span><span>,</span> <span>&amp;HCB0308C3</span><span>,</span> <span>&amp;H330C4D89</span><span>,</span> <span>&amp;HFC458BC8</span><span>,</span> <span>&amp;H8907C1C1</span><span>,</span> <span>&amp;H4D8BE44D</span><span>,</span> <span>&amp;HC1CA33DC</span><span>,</span> <span>&amp;HC10310C1</span><span>,</span> <span>&amp;H33FC4589</span><span>,</span> <span>&amp;HF0758BC6</span><span>,</span> <span>&amp;H30CC0C1</span><span>,</span> <span>&amp;H33D003F7</span><span>,</span> <span>&amp;HF45589CA</span><span>,</span> <span>&amp;HC1FC558B</span><span>,</span> <span>&amp;HD10308C1</span></td>
        </tr>
        <tr>
          <td id="L7536" data-line-number="7536"></td>
          <td id="LC7536">    <span>pvAppendBuffer</span> <span>&amp;H33FC5589</span><span>,</span> <span>&amp;H8458BD0</span><span>,</span> <span>&amp;H8907C2C1</span><span>,</span> <span>&amp;H558BE055</span><span>,</span> <span>&amp;HC1D633D8</span><span>,</span> <span>&amp;HC20310C2</span><span>,</span> <span>&amp;H33084589</span><span>,</span> <span>&amp;H87D8BC7</span><span>,</span> <span>&amp;H30CC0C1</span><span>,</span> <span>&amp;H89D633F0</span><span>,</span> <span>&amp;HC2C1F075</span><span>,</span> <span>&amp;H89FA0308</span><span>,</span> <span>&amp;HF833087D</span><span>,</span> <span>&amp;H8307C7C1</span><span>,</span> <span>&amp;H8901906D</span><span>,</span> <span>&amp;H850FD47D</span><span>,</span> <span>&amp;HFFFFFE5A</span><span>,</span> <span>&amp;H3D0458B</span><span>,</span> <span>&amp;H45891045</span><span>,</span> <span>&amp;HCC458BD0</span><span>,</span> <span>&amp;H89F84503</span><span>,</span> <span>&amp;H458BCC45</span><span>,</span> <span>&amp;HF44503C8</span><span>,</span> <span>&amp;H8BC84589</span><span>,</span> <span>&amp;H4503BC45</span><span>,</span> <span>&amp;HBC4589E8</span><span>,</span> <span>&amp;H3B8458B</span><span>,</span> <span>&amp;H4589E445</span><span>,</span> <span>&amp;HB4458BB8</span><span>,</span> <span>&amp;H89E04503</span><span>,</span> <span>&amp;H458BB445</span><span>,</span> <span>&amp;H84503AC</span></td>
        </tr>
        <tr>
          <td id="L7537" data-line-number="7537"></td>
          <td id="LC7537">    <span>pvAppendBuffer</span> <span>&amp;H89A05D01</span><span>,</span> <span>&amp;H458BAC45</span><span>,</span> <span>&amp;H144503A8</span><span>,</span> <span>&amp;H8B985501</span><span>,</span> <span>&amp;H5D8B1855</span><span>,</span> <span>&amp;HA84589D0</span><span>,</span> <span>&amp;H3A4458B</span><span>,</span> <span>&amp;H45890C45</span><span>,</span> <span>&amp;H94458BA4</span><span>,</span> <span>&amp;H88EC4503</span><span>,</span> <span>&amp;H9445891A</span><span>,</span> <span>&amp;HE8C1C38B</span><span>,</span> <span>&amp;H1428808</span><span>,</span> <span>&amp;HE8C1C38B</span><span>,</span> <span>&amp;H2428810</span><span>,</span> <span>&amp;HC1C47501</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HCC5D8B03</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C104</span><span>,</span> <span>&amp;H8B054288</span><span>,</span> <span>&amp;HC07D01C3</span><span>,</span> <span>&amp;H8810E8C1</span><span>,</span> <span>&amp;H7D8B0642</span><span>,</span> <span>&amp;HB07D01FC</span><span>,</span> <span>&amp;HC19C4D01</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HC85D8B07</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C108</span><span>,</span> <span>&amp;H8B094288</span><span>,</span> <span>&amp;H10E8C1C3</span></td>
        </tr>
        <tr>
          <td id="L7538" data-line-number="7538"></td>
          <td id="LC7538">    <span>pvAppendBuffer</span> <span>&amp;HC10A4288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HC45D8B0B</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C10C</span><span>,</span> <span>&amp;H8B0D4288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC10E4288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HC05D8B0F</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C110</span><span>,</span> <span>&amp;H8B114288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC1124288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HBC5D8B13</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C114</span><span>,</span> <span>&amp;H8B154288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC1164288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HB85D8B17</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C118</span><span>,</span> <span>&amp;H8B194288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC11A4288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HB45D8B1B</span><span>,</span> <span>&amp;H5A88C38B</span></td>
        </tr>
        <tr>
          <td id="L7539" data-line-number="7539"></td>
          <td id="LC7539">    <span>pvAppendBuffer</span> <span>&amp;H8E8C11C</span><span>,</span> <span>&amp;H8B1D4288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC11E4288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HB05D8B1F</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C120</span><span>,</span> <span>&amp;H8B214288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC1224288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HAC5D8B23</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C124</span><span>,</span> <span>&amp;H8B254288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC1264288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HA85D8B27</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C128</span><span>,</span> <span>&amp;H8B294288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC12A4288</span><span>,</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HA45D8B2B</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C12C</span><span>,</span> <span>&amp;H8B2D4288</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HC12E4288</span></td>
        </tr>
        <tr>
          <td id="L7540" data-line-number="7540"></td>
          <td id="LC7540">    <span>pvAppendBuffer</span> <span>&amp;H5A8818EB</span><span>,</span> <span>&amp;HA05D8B2F</span><span>,</span> <span>&amp;H5A88C38B</span><span>,</span> <span>&amp;H8E8C130</span><span>,</span> <span>&amp;H8D314288</span><span>,</span> <span>&amp;HC38B3C4A</span><span>,</span> <span>&amp;HC118EBC1</span><span>,</span> <span>&amp;H428810E8</span><span>,</span> <span>&amp;H335A8832</span><span>,</span> <span>&amp;H8B9C5D8B</span><span>,</span> <span>&amp;H345A88C3</span><span>,</span> <span>&amp;H8808E8C1</span><span>,</span> <span>&amp;HC38B3542</span><span>,</span> <span>&amp;H8810E8C1</span><span>,</span> <span>&amp;HEBC13642</span><span>,</span> <span>&amp;H375A8818</span><span>,</span> <span>&amp;H8B985D8B</span><span>,</span> <span>&amp;H385A88C3</span><span>,</span> <span>&amp;H8808E8C1</span><span>,</span> <span>&amp;HC38B3942</span><span>,</span> <span>&amp;H8810E8C1</span><span>,</span> <span>&amp;HEBC13A42</span><span>,</span> <span>&amp;H3B5A8818</span><span>,</span> <span>&amp;H8B94558B</span><span>,</span> <span>&amp;H8E8C1C2</span><span>,</span> <span>&amp;H41881188</span><span>,</span> <span>&amp;H5FC28B01</span><span>,</span> <span>&amp;HC110E8C1</span><span>,</span> <span>&amp;H885E18EA</span><span>,</span> <span>&amp;H51880241</span><span>,</span> <span>&amp;HE58B5B03</span><span>,</span> <span>&amp;H14C25D</span></td>
        </tr>
        <tr>
          <td id="L7541" data-line-number="7541"></td>
          <td id="LC7541">    <span>pvAppendBuffer</span> <span>&amp;H56EC8B55</span><span>,</span> <span>&amp;H8B1075FF</span><span>,</span> <span>&amp;H75FF0875</span><span>,</span> <span>&amp;H22E8560C</span><span>,</span> <span>&amp;H6A000045</span><span>,</span> <span>&amp;H1475FF10</span><span>,</span> <span>&amp;H5020468D</span><span>,</span> <span>&amp;H2C67E8</span><span>,</span> <span>&amp;H18458B00</span><span>,</span> <span>&amp;H830CC483</span><span>,</span> <span>&amp;H89007466</span><span>,</span> <span>&amp;H5D5E7846</span><span>,</span> <span>&amp;H550014C2</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;HFF570875</span><span>,</span> <span>&amp;H76FF0C75</span><span>,</span> <span>&amp;H207E8D30</span><span>,</span> <span>&amp;H10468D57</span><span>,</span> <span>&amp;HCAE85650</span><span>,</span> <span>&amp;H8BFFFFFA</span><span>,</span> <span>&amp;HC9337856</span><span>,</span> <span>&amp;H75010780</span><span>,</span> <span>&amp;HCA3B410B</span><span>,</span> <span>&amp;H4800674</span><span>,</span> <span>&amp;HF5740139</span><span>,</span> <span>&amp;HC25D5E5F</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H10EC83EC</span><span>,</span> <span>&amp;H6AF0458D</span><span>,</span> <span>&amp;H2075FF10</span><span>,</span> <span>&amp;H2C0AE850</span><span>,</span> <span>&amp;HC4830000</span></td>
        </tr>
        <tr>
          <td id="L7542" data-line-number="7542"></td>
          <td id="LC7542">    <span>pvAppendBuffer</span> <span>&amp;HF0458D0C</span><span>,</span> <span>&amp;HFF006A50</span><span>,</span> <span>&amp;H75FF2475</span><span>,</span> <span>&amp;H1875FF1C</span><span>,</span> <span>&amp;HFF1475FF</span><span>,</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H875FF0C</span><span>,</span> <span>&amp;H3ECBE8</span><span>,</span> <span>&amp;H5DE58B00</span><span>,</span> <span>&amp;H550020C2</span><span>,</span> <span>&amp;H75FFEC8B</span><span>,</span> <span>&amp;HFF016A24</span><span>,</span> <span>&amp;H75FF2075</span><span>,</span> <span>&amp;H1875FF1C</span><span>,</span> <span>&amp;HFF1475FF</span><span>,</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H875FF0C</span><span>,</span> <span>&amp;H3EA3E8</span><span>,</span> <span>&amp;H20C25D00</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HFFD7B7E8</span><span>,</span> <span>&amp;H7886B9FF</span><span>,</span> <span>&amp;HE9810047</span><span>,</span> <span>&amp;H474000</span><span>,</span> <span>&amp;H4D8BC103</span><span>,</span> <span>&amp;HFF505108</span><span>,</span> <span>&amp;H18B1475</span><span>,</span> <span>&amp;HFF1075FF</span><span>,</span> <span>&amp;H30FF0C75</span><span>,</span> <span>&amp;H5028418D</span><span>,</span> <span>&amp;H5018418D</span><span>,</span> <span>&amp;HFFF887E8</span></td>
        </tr>
        <tr>
          <td id="L7543" data-line-number="7543"></td>
          <td id="LC7543">    <span>pvAppendBuffer</span> <span>&amp;H10C25DFF</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8B084D8B</span><span>,</span> <span>&amp;H41890C45</span><span>,</span> <span>&amp;H10458B2C</span><span>,</span> <span>&amp;H5D304189</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;H346A0875</span><span>,</span> <span>&amp;HE856006A</span><span>,</span> <span>&amp;H2B81</span><span>&amp;,</span> <span>&amp;H830C4D8B</span><span>,</span> <span>&amp;H8B002C66</span><span>,</span> <span>&amp;H28668301</span><span>,</span> <span>&amp;H30468900</span><span>,</span> <span>&amp;H8910458B</span><span>,</span> <span>&amp;H468D0446</span><span>,</span> <span>&amp;HFF0E8908</span><span>,</span> <span>&amp;H1475FF31</span><span>,</span> <span>&amp;H2B36E850</span><span>,</span> <span>&amp;HC4830000</span><span>,</span> <span>&amp;HC25D5E18</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H20EC81EC</span><span>,</span> <span>&amp;H53000004</span><span>,</span> <span>&amp;HDB335756</span><span>,</span> <span>&amp;HFD6085C7</span><span>,</span> <span>&amp;HDB41FFFF</span><span>,</span> <span>&amp;H706A0000</span><span>,</span> <span>&amp;HFD70858D</span><span>,</span> <span>&amp;H9D89FFFF</span><span>,</span> <span>&amp;HFFFFFD64</span></td>
        </tr>
        <tr>
          <td id="L7544" data-line-number="7544"></td>
          <td id="LC7544">    <span>pvAppendBuffer</span> <span>&amp;H85C75053</span><span>,</span> <span>&amp;HFFFFFD68</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;HFD6C9D89</span><span>,</span> <span>&amp;H16E8FFFF</span><span>,</span> <span>&amp;H8B00002B</span><span>,</span> <span>&amp;H858D0C75</span><span>,</span> <span>&amp;HFFFFFF60</span><span>,</span> <span>&amp;H50561F6A</span><span>,</span> <span>&amp;H2ADFE8</span><span>,</span> <span>&amp;H1F468A00</span><span>,</span> <span>&amp;H8018C483</span><span>,</span> <span>&amp;HFFFF60A5</span><span>,</span> <span>&amp;H3F24F8FF</span><span>,</span> <span>&amp;H8588400C</span><span>,</span> <span>&amp;HFFFFFF7F</span><span>,</span> <span>&amp;HFBE0858D</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;H70E85010</span><span>,</span> <span>&amp;H6A00004A</span><span>,</span> <span>&amp;H1E6A591E</span><span>,</span> <span>&amp;HFE609D89</span><span>,</span> <span>&amp;HB58DFFFF</span><span>,</span> <span>&amp;HFFFFFE60</span><span>,</span> <span>&amp;HFE649D89</span><span>,</span> <span>&amp;HBD8DFFFF</span><span>,</span> <span>&amp;HFFFFFE68</span><span>,</span> <span>&amp;H8959A5F3</span><span>,</span> <span>&amp;H758D805D</span><span>,</span> <span>&amp;H845D8980</span><span>,</span> <span>&amp;HF3887D8D</span><span>,</span> <span>&amp;H591E6AA5</span></td>
        </tr>
        <tr>
          <td id="L7545" data-line-number="7545"></td>
          <td id="LC7545">    <span>pvAppendBuffer</span> <span>&amp;HFEE09D89</span><span>,</span> <span>&amp;HB58DFFFF</span><span>,</span> <span>&amp;HFFFFFEE0</span><span>,</span> <span>&amp;HFEE49D89</span><span>,</span> <span>&amp;HBD8DFFFF</span><span>,</span> <span>&amp;HFFFFFEE8</span><span>,</span> <span>&amp;H206AA5F3</span><span>,</span> <span>&amp;HE0B58D59</span><span>,</span> <span>&amp;H89FFFFFB</span><span>,</span> <span>&amp;HFFFE649D</span><span>,</span> <span>&amp;HE0BD8DFF</span><span>,</span> <span>&amp;H89FFFFFD</span><span>,</span> <span>&amp;HA5F3845D</span><span>,</span> <span>&amp;HFEBBFF33</span><span>,</span> <span>&amp;H47000000</span><span>,</span> <span>&amp;HFE60BD89</span><span>,</span> <span>&amp;H7D89FFFF</span><span>,</span> <span>&amp;HFC38B80</span><span>,</span> <span>&amp;HF8C1CBB6</span><span>,</span> <span>&amp;H7E18303</span><span>,</span> <span>&amp;H5B4B60F</span><span>,</span> <span>&amp;HFFFFFF60</span><span>,</span> <span>&amp;HFDE0858D</span><span>,</span> <span>&amp;HEED3FFFF</span><span>,</span> <span>&amp;H5056F723</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;H4244E8</span><span>,</span> <span>&amp;H858D5600</span><span>,</span> <span>&amp;HFFFFFE60</span><span>,</span> <span>&amp;HE0858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H4230E8</span></td>
        </tr>
        <tr>
          <td id="L7546" data-line-number="7546"></td>
          <td id="LC7546">    <span>pvAppendBuffer</span> <span>&amp;HE0858D00</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;HFCE0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFE3AA</span><span>,</span> <span>&amp;HFEE0858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;H50508045</span><span>,</span> <span>&amp;H48B9E8</span><span>,</span> <span>&amp;H60858D00</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFDE0858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFEE085</span><span>,</span> <span>&amp;H7FE850FF</span><span>,</span> <span>&amp;H8DFFFFE3</span><span>,</span> <span>&amp;HFFFE6085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFDE0</span><span>,</span> <span>&amp;H8BE85050</span><span>,</span> <span>&amp;H8D000048</span><span>,</span> <span>&amp;HFFFCE085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFE60</span><span>,</span> <span>&amp;H4863E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D5080</span><span>,</span> <span>&amp;HFFFFFC60</span><span>,</span> <span>&amp;H4853E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D5080</span></td>
        </tr>
        <tr>
          <td id="L7547" data-line-number="7547"></td>
          <td id="LC7547">    <span>pvAppendBuffer</span> <span>&amp;HFFFFFEE0</span><span>,</span> <span>&amp;H80458D50</span><span>,</span> <span>&amp;H364EE850</span><span>,</span> <span>&amp;H858D0000</span><span>,</span> <span>&amp;HFFFFFCE0</span><span>,</span> <span>&amp;HE0858D50</span><span>,</span> <span>&amp;H50FFFFFD</span><span>,</span> <span>&amp;HFEE0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3634</span><span>&amp;,</span> <span>&amp;HFEE0858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;H8D508045</span><span>,</span> <span>&amp;HFFFCE085</span><span>,</span> <span>&amp;H3E850FF</span><span>,</span> <span>&amp;H8DFFFFE3</span><span>,</span> <span>&amp;HFFFEE085</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;HE8505080</span><span>,</span> <span>&amp;H4812</span><span>&amp;,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;HFDE0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H47ED</span><span>&amp;,</span> <span>&amp;HFC60858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFE6085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFEE0</span><span>,</span> <span>&amp;H47E8E850</span><span>,</span> <span>&amp;H858D0000</span><span>,</span> <span>&amp;HFFFFFD60</span></td>
        </tr>
        <tr>
          <td id="L7548" data-line-number="7548"></td>
          <td id="LC7548">    <span>pvAppendBuffer</span> <span>&amp;HE0858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;H35CBE8</span><span>,</span> <span>&amp;H60858D00</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;HE2A0E850</span><span>,</span> <span>&amp;H458DFFFF</span><span>,</span> <span>&amp;H858D5080</span><span>,</span> <span>&amp;HFFFFFEE0</span><span>,</span> <span>&amp;HA9E85050</span><span>,</span> <span>&amp;H8D000035</span><span>,</span> <span>&amp;HFFFC6085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFE60</span><span>,</span> <span>&amp;H80458D50</span><span>,</span> <span>&amp;H3592E850</span><span>,</span> <span>&amp;H858D0000</span><span>,</span> <span>&amp;HFFFFFBE0</span><span>,</span> <span>&amp;HE0858D50</span><span>,</span> <span>&amp;H50FFFFFD</span><span>,</span> <span>&amp;HFE60858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3578</span><span>&amp;,</span> <span>&amp;HFCE0858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFDE085</span><span>,</span> <span>&amp;H56E850FF</span><span>,</span> <span>&amp;H56000047</span><span>,</span> <span>&amp;HFDE0858D</span><span>,</span> <span>&amp;H8D50FFFF</span></td>
        </tr>
        <tr>
          <td id="L7549" data-line-number="7549"></td>
          <td id="LC7549">    <span>pvAppendBuffer</span> <span>&amp;HE8508045</span><span>,</span> <span>&amp;H40A9</span><span>&amp;,</span> <span>&amp;H60858D56</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFEE0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H4095</span><span>&amp;,</span> <span>&amp;HF01EB83</span><span>,</span> <span>&amp;HFFFE2089</span><span>,</span> <span>&amp;HE0858DFF</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H266FE850</span><span>,</span> <span>&amp;H858D0000</span><span>,</span> <span>&amp;HFFFFFEE0</span><span>,</span> <span>&amp;H80458D50</span><span>,</span> <span>&amp;H19E85050</span><span>,</span> <span>&amp;H8D000035</span><span>,</span> <span>&amp;HFF508045</span><span>,</span> <span>&amp;H8AE80875</span><span>,</span> <span>&amp;H5F000037</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H6A5720EC</span><span>,</span> <span>&amp;HC0335907</span><span>,</span> <span>&amp;H9E045C6</span><span>,</span> <span>&amp;HF3E17D8D</span><span>,</span> <span>&amp;HAAAB66AB</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFF0C75FF</span><span>,</span> <span>&amp;HDBE80875</span><span>,</span> <span>&amp;H5FFFFFFC</span></td>
        </tr>
        <tr>
          <td id="L7550" data-line-number="7550"></td>
          <td id="LC7550">    <span>pvAppendBuffer</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H14EC81EC</span><span>,</span> <span>&amp;H53000001</span><span>,</span> <span>&amp;HC0335756</span><span>,</span> <span>&amp;H3308758B</span><span>,</span> <span>&amp;HE17D8DDB</span><span>,</span> <span>&amp;HABE05D88</span><span>,</span> <span>&amp;HAB66ABAB</span><span>,</span> <span>&amp;HE0458DAA</span><span>,</span> <span>&amp;H75FF5050</span><span>,</span> <span>&amp;H456FF0C</span><span>,</span> <span>&amp;HC247D83</span><span>,</span> <span>&amp;HC6A1E75</span><span>,</span> <span>&amp;H8D2075FF</span><span>,</span> <span>&amp;HE850F045</span><span>,</span> <span>&amp;H27C4</span><span>&amp;,</span> <span>&amp;H660CC483</span><span>,</span> <span>&amp;H88FD5D89</span><span>,</span> <span>&amp;H45C6FC5D</span><span>,</span> <span>&amp;H32EB01FF</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFEEC858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H1E1A</span><span>&amp;,</span> <span>&amp;H8D2475FF</span><span>,</span> <span>&amp;HFFFEEC85</span><span>,</span> <span>&amp;H2075FFFF</span><span>,</span> <span>&amp;H1CF1E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D50F0</span><span>,</span> <span>&amp;HFFFFFEEC</span></td>
        </tr>
        <tr>
          <td id="L7551" data-line-number="7551"></td>
          <td id="LC7551">    <span>pvAppendBuffer</span> <span>&amp;H1D7EE850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D50E0</span><span>,</span> <span>&amp;HFFFFFF3C</span><span>,</span> <span>&amp;H1DE8E850</span><span>,</span> <span>&amp;H75FF0000</span><span>,</span> <span>&amp;H3C858D1C</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HE8501875</span><span>,</span> <span>&amp;H1CA1</span><span>&amp;,</span> <span>&amp;H5D88C033</span><span>,</span> <span>&amp;HD17D8DD0</span><span>,</span> <span>&amp;H66ABABAB</span><span>,</span> <span>&amp;H458DAAAB</span><span>,</span> <span>&amp;H75FF50F0</span><span>,</span> <span>&amp;H8C458D0C</span><span>,</span> <span>&amp;HD4E85056</span><span>,</span> <span>&amp;H6AFFFFFB</span><span>,</span> <span>&amp;H8D0C6A04</span><span>,</span> <span>&amp;HE8508C45</span><span>,</span> <span>&amp;HFFFFFBB1</span><span>,</span> <span>&amp;H458D106A</span><span>,</span> <span>&amp;H8D5050D0</span><span>,</span> <span>&amp;HE8508C45</span><span>,</span> <span>&amp;HFFFFFB69</span><span>,</span> <span>&amp;H8D1475FF</span><span>,</span> <span>&amp;HFFFF3C85</span><span>,</span> <span>&amp;H1075FFFF</span><span>,</span> <span>&amp;H1C71E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D50C0</span><span>,</span> <span>&amp;HFFFFFF3C</span></td>
        </tr>
        <tr>
          <td id="L7552" data-line-number="7552"></td>
          <td id="LC7552">    <span>pvAppendBuffer</span> <span>&amp;H1CFEE850</span><span>,</span> <span>&amp;H758B0000</span><span>,</span> <span>&amp;HD0458D2C</span><span>,</span> <span>&amp;H458D5056</span><span>,</span> <span>&amp;HE85050C0</span><span>,</span> <span>&amp;H5706</span><span>&amp;,</span> <span>&amp;H85C04D8D</span><span>,</span> <span>&amp;H8B1874F6</span><span>,</span> <span>&amp;HC18B2855</span><span>,</span> <span>&amp;H48AD02B</span><span>,</span> <span>&amp;HA01320A</span><span>,</span> <span>&amp;HEE8341D8</span><span>,</span> <span>&amp;H84F37501</span><span>,</span> <span>&amp;HFF1675DB</span><span>,</span> <span>&amp;H458D1475</span><span>,</span> <span>&amp;H3075FF8C</span><span>,</span> <span>&amp;H501075FF</span><span>,</span> <span>&amp;HFFFB04E8</span><span>,</span> <span>&amp;HEBF633FF</span><span>,</span> <span>&amp;H46F63303</span><span>,</span> <span>&amp;H7D8DC033</span><span>,</span> <span>&amp;H506AABE0</span><span>,</span> <span>&amp;HABAB006A</span><span>,</span> <span>&amp;HE0458AAB</span><span>,</span> <span>&amp;H33F07D8D</span><span>,</span> <span>&amp;HABABABC0</span><span>,</span> <span>&amp;HF0458AAB</span><span>,</span> <span>&amp;H33D07D8D</span><span>,</span> <span>&amp;HABABABC0</span><span>,</span> <span>&amp;HD0458AAB</span><span>,</span> <span>&amp;H33C07D8D</span><span>,</span> <span>&amp;HABABABC0</span></td>
        </tr>
        <tr>
          <td id="L7553" data-line-number="7553"></td>
          <td id="LC7553">    <span>pvAppendBuffer</span> <span>&amp;HC0458AAB</span><span>,</span> <span>&amp;HFF3C858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H269D</span><span>&amp;,</span> <span>&amp;HFF3C8D8A</span><span>,</span> <span>&amp;H458DFFFF</span><span>,</span> <span>&amp;H6A346A8C</span><span>,</span> <span>&amp;H8AE85000</span><span>,</span> <span>&amp;H8A000026</span><span>,</span> <span>&amp;HC4838C4D</span><span>,</span> <span>&amp;H5FC68B18</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H2CC25D</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;H114EC</span><span>,</span> <span>&amp;H57565300</span><span>,</span> <span>&amp;H758BC033</span><span>,</span> <span>&amp;H8DDB3308</span><span>,</span> <span>&amp;H5D88E17D</span><span>,</span> <span>&amp;HABABABE0</span><span>,</span> <span>&amp;H8DAAAB66</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;HFF0C75FF</span><span>,</span> <span>&amp;H7D830456</span><span>,</span> <span>&amp;H1E750C24</span><span>,</span> <span>&amp;H75FF0C6A</span><span>,</span> <span>&amp;HF0458D20</span><span>,</span> <span>&amp;H2616E850</span><span>,</span> <span>&amp;HC4830000</span><span>,</span> <span>&amp;H5D89660C</span><span>,</span> <span>&amp;HFC5D88FD</span><span>,</span> <span>&amp;H1FF45C6</span></td>
        </tr>
        <tr>
          <td id="L7554" data-line-number="7554"></td>
          <td id="LC7554">    <span>pvAppendBuffer</span> <span>&amp;H458D32EB</span><span>,</span> <span>&amp;H858D50E0</span><span>,</span> <span>&amp;HFFFFFEEC</span><span>,</span> <span>&amp;H1C6CE850</span><span>,</span> <span>&amp;H75FF0000</span><span>,</span> <span>&amp;HEC858D24</span><span>,</span> <span>&amp;HFFFFFFFE</span><span>,</span> <span>&amp;HE8502075</span><span>,</span> <span>&amp;H1B43</span><span>&amp;,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;HFEEC858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H1BD0</span><span>&amp;,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFF3C858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H1C3A</span><span>&amp;,</span> <span>&amp;H8D1C75FF</span><span>,</span> <span>&amp;HFFFF3C85</span><span>,</span> <span>&amp;H1875FFFF</span><span>,</span> <span>&amp;H1AF3E850</span><span>,</span> <span>&amp;HC0330000</span><span>,</span> <span>&amp;H8DD05D88</span><span>,</span> <span>&amp;HABABD17D</span><span>,</span> <span>&amp;HAAAB66AB</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;H8D0C75FF</span><span>,</span> <span>&amp;H50568C45</span><span>,</span> <span>&amp;HFFFA26E8</span><span>,</span> <span>&amp;H6A046AFF</span><span>,</span> <span>&amp;H8C458D0C</span><span>,</span> <span>&amp;HFA03E850</span></td>
        </tr>
        <tr>
          <td id="L7555" data-line-number="7555"></td>
          <td id="LC7555">    <span>pvAppendBuffer</span> <span>&amp;H106AFFFF</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H8C458D50</span><span>,</span> <span>&amp;HF9BBE850</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;H8C458D14</span><span>,</span> <span>&amp;HFF2875FF</span><span>,</span> <span>&amp;HE8501075</span><span>,</span> <span>&amp;HFFFFF9A9</span><span>,</span> <span>&amp;H8D1475FF</span><span>,</span> <span>&amp;HFFFF3C85</span><span>,</span> <span>&amp;H2875FFFF</span><span>,</span> <span>&amp;H1AB1E850</span><span>,</span> <span>&amp;HC0330000</span><span>,</span> <span>&amp;H8DC05D88</span><span>,</span> <span>&amp;HABABC17D</span><span>,</span> <span>&amp;HAAAB66AB</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;HFF3C858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H1B30</span><span>&amp;,</span> <span>&amp;H8D3075FF</span><span>,</span> <span>&amp;H8D50D045</span><span>,</span> <span>&amp;HFF50C045</span><span>,</span> <span>&amp;H37E82C75</span><span>,</span> <span>&amp;H33000055</span><span>,</span> <span>&amp;HE07D8DC0</span><span>,</span> <span>&amp;HABABABAB</span><span>,</span> <span>&amp;H8DE0458A</span><span>,</span> <span>&amp;HC033F07D</span><span>,</span> <span>&amp;HABABABAB</span><span>,</span> <span>&amp;H8DF0458A</span></td>
        </tr>
        <tr>
          <td id="L7556" data-line-number="7556"></td>
          <td id="LC7556">    <span>pvAppendBuffer</span> <span>&amp;HC033D07D</span><span>,</span> <span>&amp;H53506AAB</span><span>,</span> <span>&amp;H8AABABAB</span><span>,</span> <span>&amp;H7D8DD045</span><span>,</span> <span>&amp;HABC033C0</span><span>,</span> <span>&amp;H8AABABAB</span><span>,</span> <span>&amp;H858DC045</span><span>,</span> <span>&amp;HFFFFFF3C</span><span>,</span> <span>&amp;H2507E850</span><span>,</span> <span>&amp;H858A0000</span><span>,</span> <span>&amp;HFFFFFF3C</span><span>,</span> <span>&amp;H458D346A</span><span>,</span> <span>&amp;HE850538C</span><span>,</span> <span>&amp;H24F5</span><span>&amp;,</span> <span>&amp;H838C458A</span><span>,</span> <span>&amp;H5E5F18C4</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H55002CC2</span><span>,</span> <span>&amp;H558BEC8B</span><span>,</span> <span>&amp;H104D8B0C</span><span>,</span> <span>&amp;H8758B56</span><span>,</span> <span>&amp;H233068B</span><span>,</span> <span>&amp;H468B0189</span><span>,</span> <span>&amp;H4423304</span><span>,</span> <span>&amp;H8B044189</span><span>,</span> <span>&amp;H42330846</span><span>,</span> <span>&amp;H8418908</span><span>,</span> <span>&amp;H330C468B</span><span>,</span> <span>&amp;H41890C42</span><span>,</span> <span>&amp;HC25D5E0C</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H8B5351EC</span></td>
        </tr>
        <tr>
          <td id="L7557" data-line-number="7557"></td>
          <td id="LC7557">    <span>pvAppendBuffer</span> <span>&amp;H57560C5D</span><span>,</span> <span>&amp;H66087D8B</span><span>,</span> <span>&amp;HFC45C7</span><span>,</span> <span>&amp;H8B0F8BE1</span><span>,</span> <span>&amp;H83E8D1C1</span><span>,</span> <span>&amp;H38901E1</span><span>,</span> <span>&amp;H8B04578B</span><span>,</span> <span>&amp;H83E8D1C2</span><span>,</span> <span>&amp;HE1C101E2</span><span>,</span> <span>&amp;HC1C80B1F</span><span>,</span> <span>&amp;H4B891FE2</span><span>,</span> <span>&amp;H8778B04</span><span>,</span> <span>&amp;HE8D1C68B</span><span>,</span> <span>&amp;HB01E683</span><span>,</span> <span>&amp;H1FE6C1D0</span><span>,</span> <span>&amp;H8B085389</span><span>,</span> <span>&amp;HC18B0C4F</span><span>,</span> <span>&amp;HE183E8D1</span><span>,</span> <span>&amp;H5FF00B01</span><span>,</span> <span>&amp;HF0C7389</span><span>,</span> <span>&amp;HFC0D44B6</span><span>,</span> <span>&amp;H3118E0C1</span><span>,</span> <span>&amp;H8B5B5E03</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8758B56</span><span>,</span> <span>&amp;H5E85657</span><span>,</span> <span>&amp;H8B000039</span><span>,</span> <span>&amp;H7890C7D</span><span>,</span> <span>&amp;H5004468D</span><span>,</span> <span>&amp;H38F7E8</span><span>,</span> <span>&amp;H4478900</span></td>
        </tr>
        <tr>
          <td id="L7558" data-line-number="7558"></td>
          <td id="LC7558">    <span>pvAppendBuffer</span> <span>&amp;H5008468D</span><span>,</span> <span>&amp;H38EBE8</span><span>,</span> <span>&amp;H8478900</span><span>,</span> <span>&amp;H500C468D</span><span>,</span> <span>&amp;H38DFE8</span><span>,</span> <span>&amp;HC478900</span><span>,</span> <span>&amp;HC25D5E5F</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H20EC83EC</span><span>,</span> <span>&amp;H56E0458D</span><span>,</span> <span>&amp;H6A106A57</span><span>,</span> <span>&amp;HFAE85000</span><span>,</span> <span>&amp;H6A000023</span><span>,</span> <span>&amp;HC75FF10</span><span>,</span> <span>&amp;H50F0458D</span><span>,</span> <span>&amp;H23C7E8</span><span>,</span> <span>&amp;H87D8B00</span><span>,</span> <span>&amp;H3318C483</span><span>,</span> <span>&amp;H83C68BF6</span><span>,</span> <span>&amp;H1F6A1FE0</span><span>,</span> <span>&amp;H8BC82B59</span><span>,</span> <span>&amp;H5F8C1C6</span><span>,</span> <span>&amp;HD387048B</span><span>,</span> <span>&amp;H7401A8E8</span><span>,</span> <span>&amp;H8BC93312</span><span>,</span> <span>&amp;H31F00D44</span><span>,</span> <span>&amp;H83E00D44</span><span>,</span> <span>&amp;HF98304C1</span><span>,</span> <span>&amp;H8DF07210</span><span>,</span> <span>&amp;H5050F045</span><span>,</span> <span>&amp;HFFFEFDE8</span><span>,</span> <span>&amp;HFE8146FF</span></td>
        </tr>
        <tr>
          <td id="L7559" data-line-number="7559"></td>
          <td id="LC7559">    <span>pvAppendBuffer</span> <span>&amp;H80&amp;</span><span>,</span> <span>&amp;H106AC37C</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HE81075FF</span><span>,</span> <span>&amp;H2374&amp;</span><span>,</span> <span>&amp;H5F0CC483</span><span>,</span> <span>&amp;H5DE58B5E</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H458BEC8B</span><span>,</span> <span>&amp;H100F08</span><span>,</span> <span>&amp;H660C458B</span><span>,</span> <span>&amp;H1BE8700F</span><span>,</span> <span>&amp;HFD5280F</span><span>,</span> <span>&amp;H100FDD28</span><span>,</span> <span>&amp;H10458B00</span><span>,</span> <span>&amp;HC8700F66</span><span>,</span> <span>&amp;HC5280F1B</span><span>,</span> <span>&amp;H443A0F66</span><span>,</span> <span>&amp;HF6601C1</span><span>,</span> <span>&amp;H10D1443A</span><span>,</span> <span>&amp;HD0EF0F66</span><span>,</span> <span>&amp;H443A0F66</span><span>,</span> <span>&amp;HF6600D9</span><span>,</span> <span>&amp;H11E9443A</span><span>,</span> <span>&amp;H66C2280F</span><span>,</span> <span>&amp;H8DA730F</span><span>,</span> <span>&amp;HF8730F66</span><span>,</span> <span>&amp;HEF0F6608</span><span>,</span> <span>&amp;HEF0F66EA</span><span>,</span> <span>&amp;HE5280FD8</span><span>,</span> <span>&amp;H66C3280F</span><span>,</span> <span>&amp;H1FD4720F</span></td>
        </tr>
        <tr>
          <td id="L7560" data-line-number="7560"></td>
          <td id="LC7560">    <span>pvAppendBuffer</span> <span>&amp;HD0720F66</span><span>,</span> <span>&amp;H720F661F</span><span>,</span> <span>&amp;H280F01F3</span><span>,</span> <span>&amp;H730F66C8</span><span>,</span> <span>&amp;HF6604FC</span><span>,</span> <span>&amp;H660CD873</span><span>,</span> <span>&amp;H4F9730F</span><span>,</span> <span>&amp;HCBEB0F66</span><span>,</span> <span>&amp;HF5720F66</span><span>,</span> <span>&amp;HD9280F01</span><span>,</span> <span>&amp;HE5EB0F66</span><span>,</span> <span>&amp;HF3720F66</span><span>,</span> <span>&amp;HEB0F661F</span><span>,</span> <span>&amp;HC1280FE0</span><span>,</span> <span>&amp;HF0720F66</span><span>,</span> <span>&amp;HEF0F661E</span><span>,</span> <span>&amp;HC1280FD8</span><span>,</span> <span>&amp;HF0720F66</span><span>,</span> <span>&amp;HEF0F6619</span><span>,</span> <span>&amp;HD3280FD8</span><span>,</span> <span>&amp;HDB730F66</span><span>,</span> <span>&amp;H730F6604</span><span>,</span> <span>&amp;HF660CFA</span><span>,</span> <span>&amp;H280FD1EF</span><span>,</span> <span>&amp;HC2280FCA</span><span>,</span> <span>&amp;HD1720F66</span><span>,</span> <span>&amp;H720F6602</span><span>,</span> <span>&amp;HF6601D0</span><span>,</span> <span>&amp;H280FC8EF</span><span>,</span> <span>&amp;H720F66C2</span><span>,</span> <span>&amp;HF6607D0</span><span>,</span> <span>&amp;HF66C8EF</span></td>
        </tr>
        <tr>
          <td id="L7561" data-line-number="7561"></td>
          <td id="LC7561">    <span>pvAppendBuffer</span> <span>&amp;HF66CBEF</span><span>,</span> <span>&amp;HF66CAEF</span><span>,</span> <span>&amp;HF66CCEF</span><span>,</span> <span>&amp;HF1BC170</span><span>,</span> <span>&amp;HC25D0011</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;H7D8B570C</span><span>,</span> <span>&amp;H37FF5608</span><span>,</span> <span>&amp;H519EE8</span><span>,</span> <span>&amp;H4468D00</span><span>,</span> <span>&amp;H477FF50</span><span>,</span> <span>&amp;H5192E8</span><span>,</span> <span>&amp;H8468D00</span><span>,</span> <span>&amp;H877FF50</span><span>,</span> <span>&amp;H5186E8</span><span>,</span> <span>&amp;HC468D00</span><span>,</span> <span>&amp;HC77FF50</span><span>,</span> <span>&amp;H517AE8</span><span>,</span> <span>&amp;H5D5E5F00</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H758B5644</span><span>,</span> <span>&amp;HA8BE8308</span><span>,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;HE8560674</span><span>,</span> <span>&amp;H3395</span><span>&amp;,</span> <span>&amp;HB60FC933</span><span>,</span> <span>&amp;H880E84</span><span>,</span> <span>&amp;H44890000</span><span>,</span> <span>&amp;H8341BC8D</span><span>,</span> <span>&amp;HEE7210F9</span></td>
        </tr>
        <tr>
          <td id="L7562" data-line-number="7562"></td>
          <td id="LC7562">    <span>pvAppendBuffer</span> <span>&amp;HFC6583</span><span>,</span> <span>&amp;H3302E856</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;HE85650BC</span><span>,</span> <span>&amp;H32AA</span><span>&amp;,</span> <span>&amp;H330C558B</span><span>,</span> <span>&amp;H8E048AC9</span><span>,</span> <span>&amp;H41110488</span><span>,</span> <span>&amp;H7210F983</span><span>,</span> <span>&amp;HAC68F4</span><span>,</span> <span>&amp;H6A0000</span><span>,</span> <span>&amp;H21FBE856</span><span>,</span> <span>&amp;H68A0000</span><span>,</span> <span>&amp;H5E0CC483</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;HAC6808</span><span>,</span> <span>&amp;H6A0000</span><span>,</span> <span>&amp;H21DBE856</span><span>,</span> <span>&amp;H4D8B0000</span><span>,</span> <span>&amp;HFCBA0C</span><span>,</span> <span>&amp;H106A0000</span><span>,</span> <span>&amp;HF1075FF</span><span>,</span> <span>&amp;H468901B6</span><span>,</span> <span>&amp;H41B60F44</span><span>,</span> <span>&amp;H48468901</span><span>,</span> <span>&amp;H241B60F</span><span>,</span> <span>&amp;HF4C4689</span><span>,</span> <span>&amp;H830341B6</span><span>,</span> <span>&amp;H46890FE0</span><span>,</span> <span>&amp;H41B60F50</span></td>
        </tr>
        <tr>
          <td id="L7563" data-line-number="7563"></td>
          <td id="LC7563">    <span>pvAppendBuffer</span> <span>&amp;H89C22304</span><span>,</span> <span>&amp;HB60F5446</span><span>,</span> <span>&amp;H46890541</span><span>,</span> <span>&amp;H41B60F58</span><span>,</span> <span>&amp;H5C468906</span><span>,</span> <span>&amp;H741B60F</span><span>,</span> <span>&amp;H890FE083</span><span>,</span> <span>&amp;HB60F6046</span><span>,</span> <span>&amp;HC2230841</span><span>,</span> <span>&amp;HF644689</span><span>,</span> <span>&amp;H890941B6</span><span>,</span> <span>&amp;HB60F6846</span><span>,</span> <span>&amp;H46890A41</span><span>,</span> <span>&amp;H41B60F6C</span><span>,</span> <span>&amp;HFE0830B</span><span>,</span> <span>&amp;HF704689</span><span>,</span> <span>&amp;H230C41B6</span><span>,</span> <span>&amp;H744689C2</span><span>,</span> <span>&amp;HD41B60F</span><span>,</span> <span>&amp;HF784689</span><span>,</span> <span>&amp;H890E41B6</span><span>,</span> <span>&amp;HB60F7C46</span><span>,</span> <span>&amp;HA6830F41</span><span>,</span> <span>&amp;H84</span><span>&amp;,</span> <span>&amp;HFE08300</span><span>,</span> <span>&amp;H808689</span><span>,</span> <span>&amp;H868D0000</span><span>,</span> <span>&amp;H88</span><span>&amp;,</span> <span>&amp;H2112E850</span><span>,</span> <span>&amp;HC4830000</span><span>,</span> <span>&amp;HC25D5E18</span><span>,</span> <span>&amp;H8B55000C</span></td>
        </tr>
        <tr>
          <td id="L7564" data-line-number="7564"></td>
          <td id="LC7564">    <span>pvAppendBuffer</span> <span>&amp;HCD06E8EC</span><span>,</span> <span>&amp;HBAB9FFFF</span><span>,</span> <span>&amp;H810047A7</span><span>,</span> <span>&amp;H474000E9</span><span>,</span> <span>&amp;H8BC10300</span><span>,</span> <span>&amp;H5051084D</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;HA881</span><span>&amp;,</span> <span>&amp;HC75FF00</span><span>,</span> <span>&amp;H8D50106A</span><span>,</span> <span>&amp;H9881</span><span>&amp;,</span> <span>&amp;HE85000</span><span>,</span> <span>&amp;H5DFFFFED</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H5756530C</span><span>,</span> <span>&amp;HFFCCC7E8</span><span>,</span> <span>&amp;H84D8BFF</span><span>,</span> <span>&amp;H47AE28BE</span><span>,</span> <span>&amp;H5A406A00</span><span>,</span> <span>&amp;H4000EE81</span><span>,</span> <span>&amp;HF0030047</span><span>,</span> <span>&amp;H8B64798D</span><span>,</span> <span>&amp;HE2F76041</span><span>,</span> <span>&amp;H703006A</span><span>,</span> <span>&amp;H515ADA8B</span><span>,</span> <span>&amp;H13F08B56</span><span>,</span> <span>&amp;H58406ADA</span><span>,</span> <span>&amp;H83084E8D</span><span>,</span> <span>&amp;HC12B3FE1</span><span>,</span> <span>&amp;H68525250</span><span>,</span> <span>&amp;H80</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7565" data-line-number="7565"></td>
          <td id="LC7565">    <span>pvAppendBuffer</span> <span>&amp;H8B57406A</span><span>,</span> <span>&amp;H478D087D</span><span>,</span> <span>&amp;H7E85020</span><span>,</span> <span>&amp;H8DFFFFEC</span><span>,</span> <span>&amp;HF50F445</span><span>,</span> <span>&amp;H5303F3A4</span><span>,</span> <span>&amp;H5603E6C1</span><span>,</span> <span>&amp;H4FCDE8</span><span>,</span> <span>&amp;H8D086A00</span><span>,</span> <span>&amp;H5750F445</span><span>,</span> <span>&amp;HC5E8</span><span>&amp;,</span> <span>&amp;HC758B00</span><span>,</span> <span>&amp;HE837FF56</span><span>,</span> <span>&amp;H4F8F</span><span>&amp;,</span> <span>&amp;H5004468D</span><span>,</span> <span>&amp;HE80477FF</span><span>,</span> <span>&amp;H4F83</span><span>&amp;,</span> <span>&amp;H5008468D</span><span>,</span> <span>&amp;HE80877FF</span><span>,</span> <span>&amp;H4F77</span><span>&amp;,</span> <span>&amp;H500C468D</span><span>,</span> <span>&amp;HE80C77FF</span><span>,</span> <span>&amp;H4F6B</span><span>&amp;,</span> <span>&amp;H5010468D</span><span>,</span> <span>&amp;HE81077FF</span><span>,</span> <span>&amp;H4F5F</span><span>&amp;,</span> <span>&amp;H5014468D</span><span>,</span> <span>&amp;HE81477FF</span><span>,</span> <span>&amp;H4F53</span><span>&amp;,</span> <span>&amp;H5018468D</span><span>,</span> <span>&amp;HE81877FF</span><span>,</span> <span>&amp;H4F47</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7566" data-line-number="7566"></td>
          <td id="LC7566">    <span>pvAppendBuffer</span> <span>&amp;H501C468D</span><span>,</span> <span>&amp;HE81C77FF</span><span>,</span> <span>&amp;H4F3B</span><span>&amp;,</span> <span>&amp;H6A686A</span><span>,</span> <span>&amp;H2017E857</span><span>,</span> <span>&amp;HC4830000</span><span>,</span> <span>&amp;H5B5E5F0C</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;H6A686A08</span><span>,</span> <span>&amp;HFAE85600</span><span>,</span> <span>&amp;H8300001F</span><span>,</span> <span>&amp;H6C70CC4</span><span>,</span> <span>&amp;H6A09E667</span><span>,</span> <span>&amp;H850446C7</span><span>,</span> <span>&amp;HC7BB67AE</span><span>,</span> <span>&amp;HF3720846</span><span>,</span> <span>&amp;H46C73C6E</span><span>,</span> <span>&amp;H4FF53A0C</span><span>,</span> <span>&amp;H1046C7A5</span><span>,</span> <span>&amp;H510E527F</span><span>,</span> <span>&amp;H8C1446C7</span><span>,</span> <span>&amp;HC79B0568</span><span>,</span> <span>&amp;HD9AB1846</span><span>,</span> <span>&amp;H46C71F83</span><span>,</span> <span>&amp;HE0CD191C</span><span>,</span> <span>&amp;HC25D5E5B</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;HCB92E8EC</span><span>,</span> <span>&amp;H28B9FFFF</span><span>,</span> <span>&amp;H810047AE</span></td>
        </tr>
        <tr>
          <td id="L7567" data-line-number="7567"></td>
          <td id="LC7567">    <span>pvAppendBuffer</span> <span>&amp;H474000E9</span><span>,</span> <span>&amp;H8BC10300</span><span>,</span> <span>&amp;H5051084D</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;H75FF6441</span><span>,</span> <span>&amp;H50406A0C</span><span>,</span> <span>&amp;H5020418D</span><span>,</span> <span>&amp;HFFEB92E8</span><span>,</span> <span>&amp;HCC25DFF</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8D40EC83</span><span>,</span> <span>&amp;HFF50C045</span><span>,</span> <span>&amp;HA7E80875</span><span>,</span> <span>&amp;H6A000000</span><span>,</span> <span>&amp;HC0458D30</span><span>,</span> <span>&amp;HC75FF50</span><span>,</span> <span>&amp;H1F43E8</span><span>,</span> <span>&amp;HCC48300</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;HC86808</span><span>,</span> <span>&amp;H6A0000</span><span>,</span> <span>&amp;H1F4BE856</span><span>,</span> <span>&amp;HC4830000</span><span>,</span> <span>&amp;HD806C70C</span><span>,</span> <span>&amp;HC7C1059E</span><span>,</span> <span>&amp;H9D5D0446</span><span>,</span> <span>&amp;H46C7CBBB</span><span>,</span> <span>&amp;H7CD50708</span><span>,</span> <span>&amp;HC46C736</span><span>,</span> <span>&amp;H629A292A</span></td>
        </tr>
        <tr>
          <td id="L7568" data-line-number="7568"></td>
          <td id="LC7568">    <span>pvAppendBuffer</span> <span>&amp;H171046C7</span><span>,</span> <span>&amp;HC73070DD</span><span>,</span> <span>&amp;H15A1446</span><span>,</span> <span>&amp;H46C79159</span><span>,</span> <span>&amp;HE593918</span><span>,</span> <span>&amp;H1C46C7F7</span><span>,</span> <span>&amp;H152FECD8</span><span>,</span> <span>&amp;H312046C7</span><span>,</span> <span>&amp;HC7FFC00B</span><span>,</span> <span>&amp;H26672446</span><span>,</span> <span>&amp;H46C76733</span><span>,</span> <span>&amp;H58151128</span><span>,</span> <span>&amp;H2C46C768</span><span>,</span> <span>&amp;H8EB44A87</span><span>,</span> <span>&amp;HA73046C7</span><span>,</span> <span>&amp;HC764F98F</span><span>,</span> <span>&amp;H2E0D3446</span><span>,</span> <span>&amp;H46C7DB0C</span><span>,</span> <span>&amp;HFA4FA438</span><span>,</span> <span>&amp;H3C46C7BE</span><span>,</span> <span>&amp;H47B5481D</span><span>,</span> <span>&amp;H4C25D5E</span><span>,</span> <span>&amp;H1B8E900</span><span>,</span> <span>&amp;H8B550000</span><span>,</span> <span>&amp;H8B5151EC</span><span>,</span> <span>&amp;H80B90845</span><span>,</span> <span>&amp;H53000000</span><span>,</span> <span>&amp;HB08D5756</span><span>,</span> <span>&amp;HC4</span><span>&amp;,</span> <span>&amp;HC0808B</span><span>,</span> <span>&amp;HE1F70000</span><span>,</span> <span>&amp;HFA8BD88B</span></td>
        </tr>
        <tr>
          <td id="L7569" data-line-number="7569"></td>
          <td id="LC7569">    <span>pvAppendBuffer</span> <span>&amp;HD7831E03</span><span>,</span> <span>&amp;HCA82E800</span><span>,</span> <span>&amp;H558BFFFF</span><span>,</span> <span>&amp;HAFCEB908</span><span>,</span> <span>&amp;H81520047</span><span>,</span> <span>&amp;H474000E9</span><span>,</span> <span>&amp;H8DC10300</span><span>,</span> <span>&amp;H8350104B</span><span>,</span> <span>&amp;H80B87FE1</span><span>,</span> <span>&amp;H2B000000</span><span>,</span> <span>&amp;H6A50C1</span><span>,</span> <span>&amp;H80B8006A</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;H428D5650</span><span>,</span> <span>&amp;HD7E85040</span><span>,</span> <span>&amp;H8DFFFFE9</span><span>,</span> <span>&amp;H6A50F845</span><span>,</span> <span>&amp;HE8006A00</span><span>,</span> <span>&amp;H4DA2</span><span>&amp;,</span> <span>&amp;H458D086A</span><span>,</span> <span>&amp;H75FF50F8</span><span>,</span> <span>&amp;H13CE808</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;HA40F50F8</span><span>,</span> <span>&amp;HC15703DF</span><span>,</span> <span>&amp;HE85303E3</span><span>,</span> <span>&amp;H4D82</span><span>&amp;,</span> <span>&amp;H8D085D8B</span><span>,</span> <span>&amp;H86AF845</span><span>,</span> <span>&amp;H1BE85350</span><span>,</span> <span>&amp;H8B000001</span><span>,</span> <span>&amp;HFF560C75</span></td>
        </tr>
        <tr>
          <td id="L7570" data-line-number="7570"></td>
          <td id="LC7570">    <span>pvAppendBuffer</span> <span>&amp;H33FF0473</span><span>,</span> <span>&amp;H4D65E8</span><span>,</span> <span>&amp;H8468D00</span><span>,</span> <span>&amp;HC73FF50</span><span>,</span> <span>&amp;HE80873FF</span><span>,</span> <span>&amp;H4D56</span><span>&amp;,</span> <span>&amp;H5010468D</span><span>,</span> <span>&amp;HFF1473FF</span><span>,</span> <span>&amp;H47E81073</span><span>,</span> <span>&amp;H8D00004D</span><span>,</span> <span>&amp;HFF501846</span><span>,</span> <span>&amp;H73FF1C73</span><span>,</span> <span>&amp;H4D38E818</span><span>,</span> <span>&amp;H468D0000</span><span>,</span> <span>&amp;H73FF5020</span><span>,</span> <span>&amp;H2073FF24</span><span>,</span> <span>&amp;H4D29E8</span><span>,</span> <span>&amp;H28468D00</span><span>,</span> <span>&amp;H2C73FF50</span><span>,</span> <span>&amp;HE82873FF</span><span>,</span> <span>&amp;H4D1A</span><span>&amp;,</span> <span>&amp;H5030468D</span><span>,</span> <span>&amp;HFF3473FF</span><span>,</span> <span>&amp;HBE83073</span><span>,</span> <span>&amp;H8D00004D</span><span>,</span> <span>&amp;HFF503846</span><span>,</span> <span>&amp;H73FF3C73</span><span>,</span> <span>&amp;H4CFCE838</span><span>,</span> <span>&amp;HC8680000</span><span>,</span> <span>&amp;H6A000000</span><span>,</span> <span>&amp;HAEE85300</span><span>,</span> <span>&amp;H8300001D</span></td>
        </tr>
        <tr>
          <td id="L7571" data-line-number="7571"></td>
          <td id="LC7571">    <span>pvAppendBuffer</span> <span>&amp;H5E5F0CC4</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;HC8680875</span><span>,</span> <span>&amp;H6A000000</span><span>,</span> <span>&amp;H8EE85600</span><span>,</span> <span>&amp;H8300001D</span><span>,</span> <span>&amp;H6C70CC4</span><span>,</span> <span>&amp;HF3BCC908</span><span>,</span> <span>&amp;H670446C7</span><span>,</span> <span>&amp;HC76A09E6</span><span>,</span> <span>&amp;HA73B0846</span><span>,</span> <span>&amp;H46C784CA</span><span>,</span> <span>&amp;H67AE850C</span><span>,</span> <span>&amp;H1046C7BB</span><span>,</span> <span>&amp;HFE94F82B</span><span>,</span> <span>&amp;H721446C7</span><span>,</span> <span>&amp;HC73C6EF3</span><span>,</span> <span>&amp;H36F11846</span><span>,</span> <span>&amp;H46C75F1D</span><span>,</span> <span>&amp;H4FF53A1C</span><span>,</span> <span>&amp;H2046C7A5</span><span>,</span> <span>&amp;HADE682D1</span><span>,</span> <span>&amp;H7F2446C7</span><span>,</span> <span>&amp;HC7510E52</span><span>,</span> <span>&amp;H6C1F2846</span><span>,</span> <span>&amp;H46C72B3E</span><span>,</span> <span>&amp;H5688C2C</span><span>,</span> <span>&amp;H3046C79B</span><span>,</span> <span>&amp;HFB41BD6B</span><span>,</span> <span>&amp;HAB3446C7</span></td>
        </tr>
        <tr>
          <td id="L7572" data-line-number="7572"></td>
          <td id="LC7572">    <span>pvAppendBuffer</span> <span>&amp;HC71F83D9</span><span>,</span> <span>&amp;H21793846</span><span>,</span> <span>&amp;H46C7137E</span><span>,</span> <span>&amp;HE0CD193C</span><span>,</span> <span>&amp;HC25D5E5B</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;HC8EEE8EC</span><span>,</span> <span>&amp;HCEB9FFFF</span><span>,</span> <span>&amp;H810047AF</span><span>,</span> <span>&amp;H474000E9</span><span>,</span> <span>&amp;H8BC10300</span><span>,</span> <span>&amp;H5051084D</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;HC481</span><span>&amp;,</span> <span>&amp;HC75FF00</span><span>,</span> <span>&amp;H8068</span><span>&amp;,</span> <span>&amp;H418D5000</span><span>,</span> <span>&amp;HE8E85040</span><span>,</span> <span>&amp;H5DFFFFE8</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H5756EC8B</span><span>,</span> <span>&amp;HFFC8A0E8</span><span>,</span> <span>&amp;H87D8BFF</span><span>,</span> <span>&amp;HC8D0F8B</span><span>,</span> <span>&amp;H48D</span><span>&amp;,</span> <span>&amp;H10FF5100</span><span>,</span> <span>&amp;HF08B0F8B</span><span>,</span> <span>&amp;H48D0C8D</span><span>,</span> <span>&amp;H51000000</span><span>,</span> <span>&amp;H8DE85657</span><span>,</span> <span>&amp;H8300001C</span><span>,</span> <span>&amp;HC68B0CC4</span></td>
        </tr>
        <tr>
          <td id="L7573" data-line-number="7573"></td>
          <td id="LC7573">    <span>pvAppendBuffer</span> <span>&amp;HC25D5E5F</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;HC75FF08</span><span>,</span> <span>&amp;H468D0E8B</span><span>,</span> <span>&amp;H76FF5008</span><span>,</span> <span>&amp;H451FF04</span><span>,</span> <span>&amp;H8B2C568B</span><span>,</span> <span>&amp;HD603304E</span><span>,</span> <span>&amp;H8504EB5E</span><span>,</span> <span>&amp;H490874C9</span><span>,</span> <span>&amp;H80A4480</span><span>,</span> <span>&amp;H5DF47401</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H4D8BEC8B</span><span>,</span> <span>&amp;H40C03308</span><span>,</span> <span>&amp;HF7E0139</span><span>,</span> <span>&amp;H813C83</span><span>,</span> <span>&amp;HC830975</span><span>,</span> <span>&amp;H3B40FF81</span><span>,</span> <span>&amp;HFFF17C01</span><span>,</span> <span>&amp;HC25D810C</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;HC458BEC</span><span>,</span> <span>&amp;H33575653</span><span>,</span> <span>&amp;H1A788DDB</span><span>,</span> <span>&amp;H8918C083</span><span>,</span> <span>&amp;HB60F0C45</span><span>,</span> <span>&amp;H8B99FF47</span><span>,</span> <span>&amp;H8BF28BC8</span><span>,</span> <span>&amp;H6D830C45</span><span>,</span> <span>&amp;HB60F080C</span></td>
        </tr>
        <tr>
          <td id="L7574" data-line-number="7574"></td>
          <td id="LC7574">    <span>pvAppendBuffer</span> <span>&amp;HA40F9900</span><span>,</span> <span>&amp;HF20B08C2</span><span>,</span> <span>&amp;HB08E0C1</span><span>,</span> <span>&amp;H7B60FC8</span><span>,</span> <span>&amp;H8CEA40F</span><span>,</span> <span>&amp;HF87F8D99</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0947B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0A47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0B47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0C47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0D47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;H8BC80BF2</span><span>,</span> <span>&amp;HC890845</span><span>,</span> <span>&amp;HD87489D8</span><span>,</span> <span>&amp;HFB834304</span><span>,</span> <span>&amp;H6B820F04</span></td>
        </tr>
        <tr>
          <td id="L7575" data-line-number="7575"></td>
          <td id="LC7575">    <span>pvAppendBuffer</span> <span>&amp;H5FFFFFFF</span><span>,</span> <span>&amp;HC25D5B5E</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;HC458BEC</span><span>,</span> <span>&amp;H33575653</span><span>,</span> <span>&amp;H2A788DDB</span><span>,</span> <span>&amp;H8928C083</span><span>,</span> <span>&amp;HB60F0C45</span><span>,</span> <span>&amp;H8B99FF47</span><span>,</span> <span>&amp;H8BF28BC8</span><span>,</span> <span>&amp;H6D830C45</span><span>,</span> <span>&amp;HB60F080C</span><span>,</span> <span>&amp;HA40F9900</span><span>,</span> <span>&amp;HF20B08C2</span><span>,</span> <span>&amp;HB08E0C1</span><span>,</span> <span>&amp;H7B60FC8</span><span>,</span> <span>&amp;H8CEA40F</span><span>,</span> <span>&amp;HF87F8D99</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0947B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0A47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0B47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span></td>
        </tr>
        <tr>
          <td id="L7576" data-line-number="7576"></td>
          <td id="LC7576">    <span>pvAppendBuffer</span> <span>&amp;HF0C47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;HFC80BF2</span><span>,</span> <span>&amp;HF0D47B6</span><span>,</span> <span>&amp;H9908CEA4</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;H8BC80BF2</span><span>,</span> <span>&amp;HC890845</span><span>,</span> <span>&amp;HD87489D8</span><span>,</span> <span>&amp;HFB834304</span><span>,</span> <span>&amp;H6B820F06</span><span>,</span> <span>&amp;H5FFFFFFF</span><span>,</span> <span>&amp;HC25D5B5E</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H60EC83EC</span><span>,</span> <span>&amp;HFFE0458D</span><span>,</span> <span>&amp;HE8500C75</span><span>,</span> <span>&amp;HFFFFFE8E</span><span>,</span> <span>&amp;H458D046A</span><span>,</span> <span>&amp;HABE850E0</span><span>,</span> <span>&amp;H8500003B</span><span>,</span> <span>&amp;H330474C0</span><span>,</span> <span>&amp;H567FEBC0</span><span>,</span> <span>&amp;H458D046A</span><span>,</span> <span>&amp;H8EE850E0</span><span>,</span> <span>&amp;HBEFFFFC6</span><span>,</span> <span>&amp;H90</span><span>&amp;,</span> <span>&amp;HE850C603</span><span>,</span> <span>&amp;H3B3B</span><span>&amp;,</span> <span>&amp;H7401F883</span><span>,</span> <span>&amp;HE8046A14</span></td>
        </tr>
        <tr>
          <td id="L7577" data-line-number="7577"></td>
          <td id="LC7577">    <span>pvAppendBuffer</span> <span>&amp;HFFFFC675</span><span>,</span> <span>&amp;H8D50C603</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;H4919E8</span><span>,</span> <span>&amp;H8D006A00</span><span>,</span> <span>&amp;HE850E045</span><span>,</span> <span>&amp;HFFFFC65D</span><span>,</span> <span>&amp;H5050C083</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;HFFC9F4E8</span><span>,</span> <span>&amp;HA0458DFF</span><span>,</span> <span>&amp;HC98FE850</span><span>,</span> <span>&amp;HC085FFFF</span><span>,</span> <span>&amp;HC0330474</span><span>,</span> <span>&amp;H758B23EB</span><span>,</span> <span>&amp;HA04D8D08</span><span>,</span> <span>&amp;H14E8D51</span><span>,</span> <span>&amp;H510406C6</span><span>,</span> <span>&amp;HD2E8</span><span>&amp;,</span> <span>&amp;HC04D8D00</span><span>,</span> <span>&amp;H214E8D51</span><span>,</span> <span>&amp;HC5E851</span><span>,</span> <span>&amp;HC0330000</span><span>,</span> <span>&amp;HE58B5E40</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;H90EC</span><span>&amp;,</span> <span>&amp;HD0458D00</span><span>,</span> <span>&amp;H500C75FF</span><span>,</span> <span>&amp;HFFFE91E8</span><span>,</span> <span>&amp;H8D066AFF</span><span>,</span> <span>&amp;HE850D045</span></td>
        </tr>
        <tr>
          <td id="L7578" data-line-number="7578"></td>
          <td id="LC7578">    <span>pvAppendBuffer</span> <span>&amp;H3AFE</span><span>&amp;,</span> <span>&amp;H774C085</span><span>,</span> <span>&amp;H8AE9C033</span><span>,</span> <span>&amp;H56000000</span><span>,</span> <span>&amp;H458D066A</span><span>,</span> <span>&amp;HDEE850D0</span><span>,</span> <span>&amp;HBEFFFFC5</span><span>,</span> <span>&amp;H170</span><span>&amp;,</span> <span>&amp;HE850C603</span><span>,</span> <span>&amp;H3A8B</span><span>&amp;,</span> <span>&amp;H7401F883</span><span>,</span> <span>&amp;HE8066A14</span><span>,</span> <span>&amp;HFFFFC5C5</span><span>,</span> <span>&amp;H8D50C603</span><span>,</span> <span>&amp;H5050D045</span><span>,</span> <span>&amp;H4869E8</span><span>,</span> <span>&amp;H8D006A00</span><span>,</span> <span>&amp;HE850D045</span><span>,</span> <span>&amp;HFFFFC5AD</span><span>,</span> <span>&amp;H11005</span><span>,</span> <span>&amp;H858D5000</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HCAEBE850</span><span>,</span> <span>&amp;H858DFFFF</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HC905E850</span><span>,</span> <span>&amp;HC085FFFF</span><span>,</span> <span>&amp;HC0330474</span><span>,</span> <span>&amp;H758B26EB</span><span>,</span> <span>&amp;H708D8D08</span><span>,</span> <span>&amp;H51FFFFFF</span><span>,</span> <span>&amp;HC6014E8D</span></td>
        </tr>
        <tr>
          <td id="L7579" data-line-number="7579"></td>
          <td id="LC7579">    <span>pvAppendBuffer</span> <span>&amp;HE8510406</span><span>,</span> <span>&amp;HAE</span><span>&amp;,</span> <span>&amp;H51A04D8D</span><span>,</span> <span>&amp;H51314E8D</span><span>,</span> <span>&amp;HA1E8</span><span>&amp;,</span> <span>&amp;H40C03300</span><span>,</span> <span>&amp;H5DE58B5E</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H458BEC8B</span><span>,</span> <span>&amp;H57565308</span><span>,</span> <span>&amp;H8D0C7D8B</span><span>,</span> <span>&amp;HF6331848</span><span>,</span> <span>&amp;H8D084D89</span><span>,</span> <span>&amp;H448A1A58</span><span>,</span> <span>&amp;H18807F7</span><span>,</span> <span>&amp;H448A28B1</span><span>,</span> <span>&amp;H438806F7</span><span>,</span> <span>&amp;HF7048BFF</span><span>,</span> <span>&amp;H4F7548B</span><span>,</span> <span>&amp;HFFD2D2E8</span><span>,</span> <span>&amp;HB10388FF</span><span>,</span> <span>&amp;HF7048B20</span><span>,</span> <span>&amp;H4F7548B</span><span>,</span> <span>&amp;HFFD2C2E8</span><span>,</span> <span>&amp;H14388FF</span><span>,</span> <span>&amp;H8BF85B8D</span><span>,</span> <span>&amp;H448BF70C</span><span>,</span> <span>&amp;HAC0F04F7</span><span>,</span> <span>&amp;HE8C118C1</span><span>,</span> <span>&amp;HA4B8818</span><span>,</span> <span>&amp;H8BF70C8B</span><span>,</span> <span>&amp;HF04F744</span></td>
        </tr>
        <tr>
          <td id="L7580" data-line-number="7580"></td>
          <td id="LC7580">    <span>pvAppendBuffer</span> <span>&amp;HC110C1AC</span><span>,</span> <span>&amp;H4B8810E8</span><span>,</span> <span>&amp;HF70C8B0B</span><span>,</span> <span>&amp;H4F7448B</span><span>,</span> <span>&amp;H8C1AC0F</span><span>,</span> <span>&amp;H8808E8C1</span><span>,</span> <span>&amp;H48A0C4B</span><span>,</span> <span>&amp;H4D8B46F7</span><span>,</span> <span>&amp;H8E98308</span><span>,</span> <span>&amp;H890D4388</span><span>,</span> <span>&amp;HFE83084D</span><span>,</span> <span>&amp;H5F877204</span><span>,</span> <span>&amp;HC25D5B5E</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H8458BEC</span><span>,</span> <span>&amp;H8B575653</span><span>,</span> <span>&amp;H488D0C7D</span><span>,</span> <span>&amp;H89F63328</span><span>,</span> <span>&amp;H588D084D</span><span>,</span> <span>&amp;HF7448A2A</span><span>,</span> <span>&amp;HB1018807</span><span>,</span> <span>&amp;HF7448A28</span><span>,</span> <span>&amp;HFF438806</span><span>,</span> <span>&amp;H8BF7048B</span><span>,</span> <span>&amp;HE804F754</span><span>,</span> <span>&amp;HFFFFD23B</span><span>,</span> <span>&amp;H20B10388</span><span>,</span> <span>&amp;H8BF7048B</span><span>,</span> <span>&amp;HE804F754</span><span>,</span> <span>&amp;HFFFFD22B</span><span>,</span> <span>&amp;H8D014388</span><span>,</span> <span>&amp;HC8BF85B</span></td>
        </tr>
        <tr>
          <td id="L7581" data-line-number="7581"></td>
          <td id="LC7581">    <span>pvAppendBuffer</span> <span>&amp;HF7448BF7</span><span>,</span> <span>&amp;HC1AC0F04</span><span>,</span> <span>&amp;H18E8C118</span><span>,</span> <span>&amp;H8B0A4B88</span><span>,</span> <span>&amp;H448BF70C</span><span>,</span> <span>&amp;HAC0F04F7</span><span>,</span> <span>&amp;HE8C110C1</span><span>,</span> <span>&amp;HB4B8810</span><span>,</span> <span>&amp;H8BF70C8B</span><span>,</span> <span>&amp;HF04F744</span><span>,</span> <span>&amp;HC108C1AC</span><span>,</span> <span>&amp;H4B8808E8</span><span>,</span> <span>&amp;HF7048A0C</span><span>,</span> <span>&amp;H84D8B46</span><span>,</span> <span>&amp;H8808E983</span><span>,</span> <span>&amp;H4D890D43</span><span>,</span> <span>&amp;H6FE8308</span><span>,</span> <span>&amp;H5E5F8772</span><span>,</span> <span>&amp;H8C25D5B</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5320EC83</span><span>,</span> <span>&amp;H33085D8B</span><span>,</span> <span>&amp;H758B56C0</span><span>,</span> <span>&amp;H66A570C</span><span>,</span> <span>&amp;HE4458959</span><span>,</span> <span>&amp;HC7E87D8D</span><span>,</span> <span>&amp;H3E045</span><span>,</span> <span>&amp;HABF30000</span><span>,</span> <span>&amp;H5001468D</span><span>,</span> <span>&amp;HFBE0E853</span><span>,</span> <span>&amp;H3E80FFFF</span><span>,</span> <span>&amp;H8D0F7504</span></td>
        </tr>
        <tr>
          <td id="L7582" data-line-number="7582"></td>
          <td id="LC7582">    <span>pvAppendBuffer</span> <span>&amp;H8D502146</span><span>,</span> <span>&amp;HE8502043</span><span>,</span> <span>&amp;HFFFFFBCE</span><span>,</span> <span>&amp;H46A76EB</span><span>,</span> <span>&amp;H207B8D53</span><span>,</span> <span>&amp;H42A5E857</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;HFFC3D8E8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;HE0458D50</span><span>,</span> <span>&amp;HE8575750</span><span>,</span> <span>&amp;H42B9</span><span>&amp;,</span> <span>&amp;H5753046A</span><span>,</span> <span>&amp;H4258E857</span><span>,</span> <span>&amp;H46A0000</span><span>,</span> <span>&amp;HFFC3B8E8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;HC3AFE850</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H57575030</span><span>,</span> <span>&amp;H3CEEE8</span><span>,</span> <span>&amp;H5DE85700</span><span>,</span> <span>&amp;H8A000018</span><span>,</span> <span>&amp;H240F8B06</span><span>,</span> <span>&amp;HC0B60F01</span><span>,</span> <span>&amp;H9901E183</span><span>,</span> <span>&amp;H675C83B</span><span>,</span> <span>&amp;HC23BC033</span><span>,</span> <span>&amp;H46A1274</span><span>,</span> <span>&amp;HC37FE857</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;HE8575010</span></td>
        </tr>
        <tr>
          <td id="L7583" data-line-number="7583"></td>
          <td id="LC7583">    <span>pvAppendBuffer</span> <span>&amp;H4626&amp;</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5330EC83</span><span>,</span> <span>&amp;H33085D8B</span><span>,</span> <span>&amp;H758B56C0</span><span>,</span> <span>&amp;HA6A570C</span><span>,</span> <span>&amp;HD4458959</span><span>,</span> <span>&amp;HC7D87D8D</span><span>,</span> <span>&amp;H3D045</span><span>,</span> <span>&amp;HABF30000</span><span>,</span> <span>&amp;H5001468D</span><span>,</span> <span>&amp;HFBD0E853</span><span>,</span> <span>&amp;H3E80FFFF</span><span>,</span> <span>&amp;H8D0F7504</span><span>,</span> <span>&amp;H8D503146</span><span>,</span> <span>&amp;HE8503043</span><span>,</span> <span>&amp;HFFFFFBBE</span><span>,</span> <span>&amp;H66A7DEB</span><span>,</span> <span>&amp;H307B8D53</span><span>,</span> <span>&amp;H41E5E857</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HFFC318E8</span><span>,</span> <span>&amp;HB005FF</span><span>,</span> <span>&amp;H8D500000</span><span>,</span> <span>&amp;H5750D045</span><span>,</span> <span>&amp;H41F7E857</span><span>,</span> <span>&amp;H66A0000</span><span>,</span> <span>&amp;HE8575753</span><span>,</span> <span>&amp;H4196</span><span>&amp;,</span> <span>&amp;HF6E8066A</span></td>
        </tr>
        <tr>
          <td id="L7584" data-line-number="7584"></td>
          <td id="LC7584">    <span>pvAppendBuffer</span> <span>&amp;HBBFFFFC2</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;HE850C303</span><span>,</span> <span>&amp;HFFFFC2E9</span><span>,</span> <span>&amp;HE005</span><span>&amp;,</span> <span>&amp;H57575000</span><span>,</span> <span>&amp;H3C26E8</span><span>,</span> <span>&amp;H29E85700</span><span>,</span> <span>&amp;H8A000018</span><span>,</span> <span>&amp;H240F8B06</span><span>,</span> <span>&amp;HC0B60F01</span><span>,</span> <span>&amp;H9901E183</span><span>,</span> <span>&amp;H675C83B</span><span>,</span> <span>&amp;HC23BC033</span><span>,</span> <span>&amp;H66A1174</span><span>,</span> <span>&amp;HC2B7E857</span><span>,</span> <span>&amp;HC303FFFF</span><span>,</span> <span>&amp;H5FE85750</span><span>,</span> <span>&amp;H5F000045</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;HA0EC</span><span>&amp;,</span> <span>&amp;H60858D00</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HE8500875</span><span>,</span> <span>&amp;HFFFFFE61</span><span>,</span> <span>&amp;H8D0C75FF</span><span>,</span> <span>&amp;HE850E045</span><span>,</span> <span>&amp;HFFFFFA62</span><span>,</span> <span>&amp;H458D006A</span><span>,</span> <span>&amp;H858D50E0</span></td>
        </tr>
        <tr>
          <td id="L7585" data-line-number="7585"></td>
          <td id="LC7585">    <span>pvAppendBuffer</span> <span>&amp;HFFFFFF60</span><span>,</span> <span>&amp;HA0458D50</span><span>,</span> <span>&amp;HC60FE850</span><span>,</span> <span>&amp;H458DFFFF</span><span>,</span> <span>&amp;H75FF50A0</span><span>,</span> <span>&amp;HFD05E810</span><span>,</span> <span>&amp;H458DFFFF</span><span>,</span> <span>&amp;H9EE850A0</span><span>,</span> <span>&amp;HF7FFFFC5</span><span>,</span> <span>&amp;H40C01BD8</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;HF0EC81EC</span><span>,</span> <span>&amp;H8D000000</span><span>,</span> <span>&amp;HFFFF1085</span><span>,</span> <span>&amp;H875FFFF</span><span>,</span> <span>&amp;HFEC7E850</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;HD0458D0C</span><span>,</span> <span>&amp;HFAB8E850</span><span>,</span> <span>&amp;H6AFFFF</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;HFF10858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;H5EE850FF</span><span>,</span> <span>&amp;H8DFFFFC7</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;H75FF50FF</span><span>,</span> <span>&amp;HFD3CE810</span><span>,</span> <span>&amp;H858DFFFF</span><span>,</span> <span>&amp;HFFFFFF70</span></td>
        </tr>
        <tr>
          <td id="L7586" data-line-number="7586"></td>
          <td id="LC7586">    <span>pvAppendBuffer</span> <span>&amp;HC569E850</span><span>,</span> <span>&amp;HD8F7FFFF</span><span>,</span> <span>&amp;H8B40C01B</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8D40EC83</span><span>,</span> <span>&amp;HFF56C045</span><span>,</span> <span>&amp;HE8500875</span><span>,</span> <span>&amp;HFFFFFDA9</span><span>,</span> <span>&amp;H8D0C758B</span><span>,</span> <span>&amp;H8D50C045</span><span>,</span> <span>&amp;H6C60146</span><span>,</span> <span>&amp;H68E85004</span><span>,</span> <span>&amp;H8DFFFFFC</span><span>,</span> <span>&amp;H8D50E045</span><span>,</span> <span>&amp;HE8502146</span><span>,</span> <span>&amp;HFFFFFC5B</span><span>,</span> <span>&amp;H5E40C033</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H60EC83EC</span><span>,</span> <span>&amp;H56A0458D</span><span>,</span> <span>&amp;H500875FF</span><span>,</span> <span>&amp;HFFFE2CE8</span><span>,</span> <span>&amp;HC758BFF</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;HC601468D</span><span>,</span> <span>&amp;HE8500406</span><span>,</span> <span>&amp;HFFFFFCC2</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H5031468D</span><span>,</span> <span>&amp;HFFFCB5E8</span></td>
        </tr>
        <tr>
          <td id="L7587" data-line-number="7587"></td>
          <td id="LC7587">    <span>pvAppendBuffer</span> <span>&amp;H40C033FF</span><span>,</span> <span>&amp;H5DE58B5E</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;HEC81EC8B</span><span>,</span> <span>&amp;H80</span><span>&amp;,</span> <span>&amp;H7D8B5753</span><span>,</span> <span>&amp;H5B046A10</span><span>,</span> <span>&amp;H5FE85753</span><span>,</span> <span>&amp;H85000036</span><span>,</span> <span>&amp;H330774C0</span><span>,</span> <span>&amp;H115E9C0</span><span>,</span> <span>&amp;H53560000</span><span>,</span> <span>&amp;HC143E857</span><span>,</span> <span>&amp;H90BEFFFF</span><span>,</span> <span>&amp;H3000000</span><span>,</span> <span>&amp;HF0E850C6</span><span>,</span> <span>&amp;H83000035</span><span>,</span> <span>&amp;H107401F8</span><span>,</span> <span>&amp;HC12BE853</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;HE8575750</span><span>,</span> <span>&amp;H43D2</span><span>&amp;,</span> <span>&amp;HE857006A</span><span>,</span> <span>&amp;HFFFFC119</span><span>,</span> <span>&amp;H5050C083</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;HFFC4B0E8</span><span>,</span> <span>&amp;H458D53FF</span><span>,</span> <span>&amp;H2E85080</span><span>,</span> <span>&amp;H3FFFFC1</span><span>,</span> <span>&amp;HB4E850C6</span><span>,</span> <span>&amp;H83000035</span></td>
        </tr>
        <tr>
          <td id="L7588" data-line-number="7588"></td>
          <td id="LC7588">    <span>pvAppendBuffer</span> <span>&amp;H137401F8</span><span>,</span> <span>&amp;HC0EFE853</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;H80458D50</span><span>,</span> <span>&amp;H93E85050</span><span>,</span> <span>&amp;H53000043</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;H35E1E8</span><span>,</span> <span>&amp;H74C08500</span><span>,</span> <span>&amp;HE9C03307</span><span>,</span> <span>&amp;H96</span><span>&amp;,</span> <span>&amp;H8D14758B</span><span>,</span> <span>&amp;H56508045</span><span>,</span> <span>&amp;HFFFB66E8</span><span>,</span> <span>&amp;H875FFFF</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;HFFF895E8</span><span>,</span> <span>&amp;HC0AFE8FF</span><span>,</span> <span>&amp;H9005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;H3C41E8</span><span>,</span> <span>&amp;HC75FF00</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;HFFF86DE8</span><span>,</span> <span>&amp;H86E853FF</span><span>,</span> <span>&amp;H5FFFFC0</span><span>,</span> <span>&amp;H90</span><span>&amp;,</span> <span>&amp;HE0458D50</span><span>,</span> <span>&amp;HC0458D50</span></td>
        </tr>
        <tr>
          <td id="L7589" data-line-number="7589"></td>
          <td id="LC7589">    <span>pvAppendBuffer</span> <span>&amp;HE0458D50</span><span>,</span> <span>&amp;H39B9E850</span><span>,</span> <span>&amp;HE8530000</span><span>,</span> <span>&amp;HFFFFC069</span><span>,</span> <span>&amp;H90BB</span><span>&amp;,</span> <span>&amp;H50C30300</span><span>,</span> <span>&amp;HE3E85757</span><span>,</span> <span>&amp;HE8000039</span><span>,</span> <span>&amp;HFFFFC055</span><span>,</span> <span>&amp;H4D8DC303</span><span>,</span> <span>&amp;H515750E0</span><span>,</span> <span>&amp;H3BF0E851</span><span>,</span> <span>&amp;H4D8D0000</span><span>,</span> <span>&amp;H4E8D51E0</span><span>,</span> <span>&amp;HE0E85120</span><span>,</span> <span>&amp;H33FFFFFA</span><span>,</span> <span>&amp;H5F5E40C0</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;HEC81EC8B</span><span>,</span> <span>&amp;HC0</span><span>&amp;,</span> <span>&amp;H7D8B5753</span><span>,</span> <span>&amp;H5B066A10</span><span>,</span> <span>&amp;H1FE85753</span><span>,</span> <span>&amp;H85000035</span><span>,</span> <span>&amp;H330774C0</span><span>,</span> <span>&amp;H129E9C0</span><span>,</span> <span>&amp;H53560000</span><span>,</span> <span>&amp;HC003E857</span><span>,</span> <span>&amp;H70BEFFFF</span><span>,</span> <span>&amp;H3000001</span><span>,</span> <span>&amp;HB0E850C6</span></td>
        </tr>
        <tr>
          <td id="L7590" data-line-number="7590"></td>
          <td id="LC7590">    <span>pvAppendBuffer</span> <span>&amp;H83000034</span><span>,</span> <span>&amp;H107401F8</span><span>,</span> <span>&amp;HBFEBE853</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;HE8575750</span><span>,</span> <span>&amp;H4292</span><span>&amp;,</span> <span>&amp;HE857006A</span><span>,</span> <span>&amp;HFFFFBFD9</span><span>,</span> <span>&amp;H11005</span><span>,</span> <span>&amp;H858D5000</span><span>,</span> <span>&amp;HFFFFFF40</span><span>,</span> <span>&amp;HC517E850</span><span>,</span> <span>&amp;H8D53FFFF</span><span>,</span> <span>&amp;HFFFF4085</span><span>,</span> <span>&amp;HBAE850FF</span><span>,</span> <span>&amp;H3FFFFBF</span><span>,</span> <span>&amp;H6CE850C6</span><span>,</span> <span>&amp;H83000034</span><span>,</span> <span>&amp;H167401F8</span><span>,</span> <span>&amp;HBFA7E853</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;H40858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H4248E850</span><span>,</span> <span>&amp;H8D530000</span><span>,</span> <span>&amp;HFFFF4085</span><span>,</span> <span>&amp;H93E850FF</span><span>,</span> <span>&amp;H85000034</span><span>,</span> <span>&amp;H330774C0</span><span>,</span> <span>&amp;H9CE9C0</span><span>,</span> <span>&amp;H758B0000</span><span>,</span> <span>&amp;H40858D14</span></td>
        </tr>
        <tr>
          <td id="L7591" data-line-number="7591"></td>
          <td id="LC7591">    <span>pvAppendBuffer</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFAACE856</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;HA0458D08</span><span>,</span> <span>&amp;HF7F4E850</span><span>,</span> <span>&amp;H5EE8FFFF</span><span>,</span> <span>&amp;H5FFFFBF</span><span>,</span> <span>&amp;H170</span><span>&amp;,</span> <span>&amp;HA0458D50</span><span>,</span> <span>&amp;H40858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H50D0458D</span><span>,</span> <span>&amp;H3C54E8</span><span>,</span> <span>&amp;HC75FF00</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;HFFF7C9E8</span><span>,</span> <span>&amp;H32E853FF</span><span>,</span> <span>&amp;H5FFFFBF</span><span>,</span> <span>&amp;H170</span><span>&amp;,</span> <span>&amp;HD0458D50</span><span>,</span> <span>&amp;HA0458D50</span><span>,</span> <span>&amp;HD0458D50</span><span>,</span> <span>&amp;H3865E850</span><span>,</span> <span>&amp;HE8530000</span><span>,</span> <span>&amp;HFFFFBF15</span><span>,</span> <span>&amp;H170BB</span><span>,</span> <span>&amp;H50C30300</span><span>,</span> <span>&amp;H8FE85757</span><span>,</span> <span>&amp;HE8000038</span><span>,</span> <span>&amp;HFFFFBF01</span><span>,</span> <span>&amp;H4D8DC303</span><span>,</span> <span>&amp;H515750D0</span></td>
        </tr>
        <tr>
          <td id="L7592" data-line-number="7592"></td>
          <td id="LC7592">    <span>pvAppendBuffer</span> <span>&amp;H3C03E851</span><span>,</span> <span>&amp;H4D8D0000</span><span>,</span> <span>&amp;H4E8D51D0</span><span>,</span> <span>&amp;H23E85130</span><span>,</span> <span>&amp;H33FFFFFA</span><span>,</span> <span>&amp;H5F5E40C0</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;HEC81EC8B</span><span>,</span> <span>&amp;H1B0</span><span>&amp;,</span> <span>&amp;HFE50858D</span><span>,</span> <span>&amp;H5653FFFF</span><span>,</span> <span>&amp;H500875FF</span><span>,</span> <span>&amp;HFFFA94E8</span><span>,</span> <span>&amp;H10758BFF</span><span>,</span> <span>&amp;HFF30858D</span><span>,</span> <span>&amp;H5056FFFF</span><span>,</span> <span>&amp;HFFF691E8</span><span>,</span> <span>&amp;H20468DFF</span><span>,</span> <span>&amp;H90458D50</span><span>,</span> <span>&amp;HF684E850</span><span>,</span> <span>&amp;H46AFFFF</span><span>,</span> <span>&amp;H858D535B</span><span>,</span> <span>&amp;HFFFFFF30</span><span>,</span> <span>&amp;H339CE850</span><span>,</span> <span>&amp;HC0850000</span><span>,</span> <span>&amp;H36B850F</span><span>,</span> <span>&amp;H8D530000</span><span>,</span> <span>&amp;HE8509045</span><span>,</span> <span>&amp;H338A</span><span>&amp;,</span> <span>&amp;H850FC085</span><span>,</span> <span>&amp;H359</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7593" data-line-number="7593"></td>
          <td id="LC7593">    <span>pvAppendBuffer</span> <span>&amp;H30858D53</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFFBE6CE8</span><span>,</span> <span>&amp;H90BEFF</span><span>,</span> <span>&amp;HC6030000</span><span>,</span> <span>&amp;H3319E850</span><span>,</span> <span>&amp;HF8830000</span><span>,</span> <span>&amp;H36850F01</span><span>,</span> <span>&amp;H53000003</span><span>,</span> <span>&amp;H5090458D</span><span>,</span> <span>&amp;HFFBE4CE8</span><span>,</span> <span>&amp;H50C603FF</span><span>,</span> <span>&amp;H32FEE8</span><span>,</span> <span>&amp;H1F88300</span><span>,</span> <span>&amp;H31B850F</span><span>,</span> <span>&amp;H53570000</span><span>,</span> <span>&amp;HFFBE34E8</span><span>,</span> <span>&amp;H50C603FF</span><span>,</span> <span>&amp;H5090458D</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;H37ADE8</span><span>,</span> <span>&amp;HC75FF00</span><span>,</span> <span>&amp;HFF50858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFF5F6</span><span>,</span> <span>&amp;HFFBE10E8</span><span>,</span> <span>&amp;H50C603FF</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFF50858D</span><span>,</span> <span>&amp;H5050FFFF</span><span>,</span> <span>&amp;H39A5E8</span><span>,</span> <span>&amp;HBDF7E800</span></td>
        </tr>
        <tr>
          <td id="L7594" data-line-number="7594"></td>
          <td id="LC7594">    <span>pvAppendBuffer</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;HE0458D50</span><span>,</span> <span>&amp;H30858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFF10858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3986</span><span>&amp;,</span> <span>&amp;H50858D53</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFEB0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3EBF</span><span>&amp;,</span> <span>&amp;H70858D53</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFED0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3EAB</span><span>&amp;,</span> <span>&amp;HBDAFE853</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H858D5050</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;H3E95E850</span><span>,</span> <span>&amp;HE8530000</span><span>,</span> <span>&amp;HFFFFBD99</span><span>,</span> <span>&amp;H5070C083</span><span>,</span> <span>&amp;H5090458D</span><span>,</span> <span>&amp;H3E82E8</span><span>,</span> <span>&amp;H86E85300</span><span>,</span> <span>&amp;H83FFFFBD</span><span>,</span> <span>&amp;H8D5010C0</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;H858D50FF</span></td>
        </tr>
        <tr>
          <td id="L7595" data-line-number="7595"></td>
          <td id="LC7595">    <span>pvAppendBuffer</span> <span>&amp;HFFFFFEB0</span><span>,</span> <span>&amp;HE0458D50</span><span>,</span> <span>&amp;H3C5BE850</span><span>,</span> <span>&amp;H858D0000</span><span>,</span> <span>&amp;HFFFFFED0</span><span>,</span> <span>&amp;HB0858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H5090458D</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFC45A</span><span>,</span> <span>&amp;HBD47E853</span><span>,</span> <span>&amp;HC083FFFF</span><span>,</span> <span>&amp;H458D5010</span><span>,</span> <span>&amp;HE85050E0</span><span>,</span> <span>&amp;H36C2</span><span>&amp;,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFED0858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFEB085</span><span>,</span> <span>&amp;H9AE850FF</span><span>,</span> <span>&amp;H83FFFFCC</span><span>,</span> <span>&amp;HE800D065</span><span>,</span> <span>&amp;HFFFFBD19</span><span>,</span> <span>&amp;H8950C083</span><span>,</span> <span>&amp;H858DD445</span><span>,</span> <span>&amp;HFFFFFE50</span><span>,</span> <span>&amp;H8DD84589</span><span>,</span> <span>&amp;HFFFEB085</span><span>,</span> <span>&amp;HDC4589FF</span><span>,</span> <span>&amp;HFF10858D</span><span>,</span> <span>&amp;H5053FFFF</span></td>
        </tr>
        <tr>
          <td id="L7596" data-line-number="7596"></td>
          <td id="LC7596">    <span>pvAppendBuffer</span> <span>&amp;H3D44E8</span><span>,</span> <span>&amp;H8DF08B00</span><span>,</span> <span>&amp;HFFFF5085</span><span>,</span> <span>&amp;HE85053FF</span><span>,</span> <span>&amp;H3D35</span><span>&amp;,</span> <span>&amp;HFE3BF88B</span><span>,</span> <span>&amp;HFE8B0277</span><span>,</span> <span>&amp;H56FF778D</span><span>,</span> <span>&amp;HFF50858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3FF3</span><span>&amp;,</span> <span>&amp;H574C20B</span><span>,</span> <span>&amp;HEB43DB33</span><span>,</span> <span>&amp;H56DB3302</span><span>,</span> <span>&amp;HFF10858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3FDB</span><span>&amp;,</span> <span>&amp;H574C20B</span><span>,</span> <span>&amp;HEB5E026A</span><span>,</span> <span>&amp;H6AF63302</span><span>,</span> <span>&amp;H8DF30B04</span><span>,</span> <span>&amp;H535BB045</span><span>,</span> <span>&amp;HD0B5748B</span><span>,</span> <span>&amp;H8CE85056</span><span>,</span> <span>&amp;H5300003D</span><span>,</span> <span>&amp;H5020468D</span><span>,</span> <span>&amp;HFEF0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3D7B</span><span>&amp;,</span> <span>&amp;HE0458D53</span><span>,</span> <span>&amp;H3108E850</span><span>,</span> <span>&amp;H65830000</span></td>
        </tr>
        <tr>
          <td id="L7597" data-line-number="7597"></td>
          <td id="LC7597">    <span>pvAppendBuffer</span> <span>&amp;H778D00E4</span><span>,</span> <span>&amp;HE045C7FE</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H880FF685</span><span>,</span> <span>&amp;HD5</span><span>&amp;,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;HFEF0858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HE850B045</span><span>,</span> <span>&amp;HFFFFBC75</span><span>,</span> <span>&amp;H50858D56</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H3F6AE8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H47FF3305</span><span>,</span> <span>&amp;HFF3302EB</span><span>,</span> <span>&amp;H10858D56</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H3F52E8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H58026A05</span><span>,</span> <span>&amp;HC03302EB</span><span>,</span> <span>&amp;H7C8BF80B</span><span>,</span> <span>&amp;HFF85D0BD</span><span>,</span> <span>&amp;H57537E74</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3CFF</span><span>&amp;,</span> <span>&amp;H20478D53</span><span>,</span> <span>&amp;H90458D50</span><span>,</span> <span>&amp;H3CF1E850</span><span>,</span> <span>&amp;H458D0000</span></td>
        </tr>
        <tr>
          <td id="L7598" data-line-number="7598"></td>
          <td id="LC7598">    <span>pvAppendBuffer</span> <span>&amp;H458D50E0</span><span>,</span> <span>&amp;H858D5090</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HCB5FE850</span><span>,</span> <span>&amp;HE853FFFF</span><span>,</span> <span>&amp;HFFFFBBE1</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;H8D50B045</span><span>,</span> <span>&amp;HFFFE9085</span><span>,</span> <span>&amp;HB6E850FF</span><span>,</span> <span>&amp;H8D00003A</span><span>,</span> <span>&amp;HFFFEF085</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;H458D50B0</span><span>,</span> <span>&amp;H858D5090</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HC2B8E850</span><span>,</span> <span>&amp;H8D53FFFF</span><span>,</span> <span>&amp;HFFFE9085</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;HE85050E0</span><span>,</span> <span>&amp;H3A32</span><span>&amp;,</span> <span>&amp;HF01EE83</span><span>,</span> <span>&amp;HFFFF2B89</span><span>,</span> <span>&amp;H8AE853FF</span><span>,</span> <span>&amp;H83FFFFBB</span><span>,</span> <span>&amp;H8D5010C0</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;H3505E8</span><span>,</span> <span>&amp;HE0458D00</span></td>
        </tr>
        <tr>
          <td id="L7599" data-line-number="7599"></td>
          <td id="LC7599">    <span>pvAppendBuffer</span> <span>&amp;HF0858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H50B0458D</span><span>,</span> <span>&amp;HFFCAE0E8</span><span>,</span> <span>&amp;H458D53FF</span><span>,</span> <span>&amp;H5EE850B0</span><span>,</span> <span>&amp;HBEFFFFBB</span><span>,</span> <span>&amp;H90</span><span>&amp;,</span> <span>&amp;HE850C603</span><span>,</span> <span>&amp;H300B</span><span>&amp;,</span> <span>&amp;H1F8835F</span><span>,</span> <span>&amp;HE8531374</span><span>,</span> <span>&amp;HFFFFBB45</span><span>,</span> <span>&amp;H8D50C603</span><span>,</span> <span>&amp;H5050B045</span><span>,</span> <span>&amp;H3DE9E8</span><span>,</span> <span>&amp;H858D5300</span><span>,</span> <span>&amp;HFFFFFF30</span><span>,</span> <span>&amp;HB0458D50</span><span>,</span> <span>&amp;H2FE1E850</span><span>,</span> <span>&amp;HD8F70000</span><span>,</span> <span>&amp;HEB40C01B</span><span>,</span> <span>&amp;H5EC03302</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;HEC81EC8B</span><span>,</span> <span>&amp;H280</span><span>&amp;,</span> <span>&amp;HFD80858D</span><span>,</span> <span>&amp;H5653FFFF</span><span>,</span> <span>&amp;H500875FF</span><span>,</span> <span>&amp;HFFF790E8</span><span>,</span> <span>&amp;H10758BFF</span></td>
        </tr>
        <tr>
          <td id="L7600" data-line-number="7600"></td>
          <td id="LC7600">    <span>pvAppendBuffer</span> <span>&amp;HFED0858D</span><span>,</span> <span>&amp;H5056FFFF</span><span>,</span> <span>&amp;HFFF37DE8</span><span>,</span> <span>&amp;H30468DFF</span><span>,</span> <span>&amp;H60858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFFF36DE8</span><span>,</span> <span>&amp;H5B066AFF</span><span>,</span> <span>&amp;HD0858D53</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H2FD5E8</span><span>,</span> <span>&amp;HFC08500</span><span>,</span> <span>&amp;H39185</span><span>,</span> <span>&amp;H858D5300</span><span>,</span> <span>&amp;HFFFFFF60</span><span>,</span> <span>&amp;H2FC0E850</span><span>,</span> <span>&amp;HC0850000</span><span>,</span> <span>&amp;H37C850F</span><span>,</span> <span>&amp;H8D530000</span><span>,</span> <span>&amp;HFFFED085</span><span>,</span> <span>&amp;HA2E850FF</span><span>,</span> <span>&amp;HBEFFFFBA</span><span>,</span> <span>&amp;H170</span><span>&amp;,</span> <span>&amp;HE850C603</span><span>,</span> <span>&amp;H2F4F</span><span>&amp;,</span> <span>&amp;HF01F883</span><span>,</span> <span>&amp;H35985</span><span>,</span> <span>&amp;H858D5300</span><span>,</span> <span>&amp;HFFFFFF60</span><span>,</span> <span>&amp;HBA7FE850</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;H2F31E850</span></td>
        </tr>
        <tr>
          <td id="L7601" data-line-number="7601"></td>
          <td id="LC7601">    <span>pvAppendBuffer</span> <span>&amp;HF8830000</span><span>,</span> <span>&amp;H3B850F01</span><span>,</span> <span>&amp;H57000003</span><span>,</span> <span>&amp;HBA67E853</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;H60858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;H33DDE8</span><span>,</span> <span>&amp;HC75FF00</span><span>,</span> <span>&amp;HFF00858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFF2D6</span><span>,</span> <span>&amp;HFFBA40E8</span><span>,</span> <span>&amp;H50C603FF</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;HFF00858D</span><span>,</span> <span>&amp;H5050FFFF</span><span>,</span> <span>&amp;H373CE8</span><span>,</span> <span>&amp;HBA27E800</span><span>,</span> <span>&amp;HC603FFFF</span><span>,</span> <span>&amp;HC0458D50</span><span>,</span> <span>&amp;HD0858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFEA0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H371D</span><span>&amp;,</span> <span>&amp;H80858D53</span><span>,</span> <span>&amp;H50FFFFFD</span><span>,</span> <span>&amp;HFE10858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3AEF</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7602" data-line-number="7602"></td>
          <td id="LC7602">    <span>pvAppendBuffer</span> <span>&amp;HB0858D53</span><span>,</span> <span>&amp;H50FFFFFD</span><span>,</span> <span>&amp;HFE40858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3ADB</span><span>&amp;,</span> <span>&amp;HB9DFE853</span><span>,</span> <span>&amp;HC683FFFF</span><span>,</span> <span>&amp;H50C603A0</span><span>,</span> <span>&amp;HFF30858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3AC3</span><span>&amp;,</span> <span>&amp;HB9C7E853</span><span>,</span> <span>&amp;H4005FFFF</span><span>,</span> <span>&amp;H50000001</span><span>,</span> <span>&amp;HFF60858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3AAB</span><span>&amp;,</span> <span>&amp;HB9AFE853</span><span>,</span> <span>&amp;HB0BFFFFF</span><span>,</span> <span>&amp;H3000000</span><span>,</span> <span>&amp;H858D50C7</span><span>,</span> <span>&amp;HFFFFFF30</span><span>,</span> <span>&amp;H10858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;H3880E8</span><span>,</span> <span>&amp;H40858D00</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFE10858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFF6085</span><span>,</span> <span>&amp;H858D50FF</span></td>
        </tr>
        <tr>
          <td id="L7603" data-line-number="7603"></td>
          <td id="LC7603">    <span>pvAppendBuffer</span> <span>&amp;HFFFFFF30</span><span>,</span> <span>&amp;HC18CE850</span><span>,</span> <span>&amp;HE853FFFF</span><span>,</span> <span>&amp;HFFFFB969</span><span>,</span> <span>&amp;H8D50C703</span><span>,</span> <span>&amp;H5050C045</span><span>,</span> <span>&amp;H32E5E8</span><span>,</span> <span>&amp;HC0458D00</span><span>,</span> <span>&amp;H40858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFE10858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFC908</span><span>,</span> <span>&amp;HF06583</span><span>,</span> <span>&amp;HFFB93CE8</span><span>,</span> <span>&amp;H89C603FF</span><span>,</span> <span>&amp;H858DF445</span><span>,</span> <span>&amp;HFFFFFD80</span><span>,</span> <span>&amp;H8DF84589</span><span>,</span> <span>&amp;HFFFE1085</span><span>,</span> <span>&amp;HFC4589FF</span><span>,</span> <span>&amp;HFEA0858D</span><span>,</span> <span>&amp;H5053FFFF</span><span>,</span> <span>&amp;H3968E8</span><span>,</span> <span>&amp;H8DF08B00</span><span>,</span> <span>&amp;HFFFF0085</span><span>,</span> <span>&amp;HE85053FF</span><span>,</span> <span>&amp;H3959</span><span>&amp;,</span> <span>&amp;HFE3BF88B</span><span>,</span> <span>&amp;HFE8B0277</span><span>,</span> <span>&amp;H56FF778D</span><span>,</span> <span>&amp;HFF00858D</span></td>
        </tr>
        <tr>
          <td id="L7604" data-line-number="7604"></td>
          <td id="LC7604">    <span>pvAppendBuffer</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3C17&amp;</span><span>,</span> <span>&amp;H574C20B</span><span>,</span> <span>&amp;HEB43DB33</span><span>,</span> <span>&amp;H56DB3302</span><span>,</span> <span>&amp;HFEA0858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H3BFF</span><span>&amp;,</span> <span>&amp;H574C20B</span><span>,</span> <span>&amp;HEB5E026A</span><span>,</span> <span>&amp;H6AF63302</span><span>,</span> <span>&amp;H8DF30B06</span><span>,</span> <span>&amp;H535B9045</span><span>,</span> <span>&amp;HF0B5748B</span><span>,</span> <span>&amp;HB0E85056</span><span>,</span> <span>&amp;H53000039</span><span>,</span> <span>&amp;H5030468D</span><span>,</span> <span>&amp;HFE70858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H399F</span><span>&amp;,</span> <span>&amp;HC0458D53</span><span>,</span> <span>&amp;H2D2CE850</span><span>,</span> <span>&amp;H65830000</span><span>,</span> <span>&amp;H778D00C4</span><span>,</span> <span>&amp;HC045C7FE</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H880FF685</span><span>,</span> <span>&amp;HE4</span><span>&amp;,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;HFE70858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HE8509045</span></td>
        </tr>
        <tr>
          <td id="L7605" data-line-number="7605"></td>
          <td id="LC7605">    <span>pvAppendBuffer</span> <span>&amp;HFFFFBA21</span><span>,</span> <span>&amp;H858D56</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H3B8EE8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H47FF3305</span><span>,</span> <span>&amp;HFF3302EB</span><span>,</span> <span>&amp;HA0858D56</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;H3B76E8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H58026A05</span><span>,</span> <span>&amp;HC03302EB</span><span>,</span> <span>&amp;H7C8BF80B</span><span>,</span> <span>&amp;HFF85F0BD</span><span>,</span> <span>&amp;H89840F</span><span>,</span> <span>&amp;H57530000</span><span>,</span> <span>&amp;HFF30858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H391F</span><span>&amp;,</span> <span>&amp;H30478D53</span><span>,</span> <span>&amp;H60858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H390EE8</span><span>,</span> <span>&amp;HC0458D00</span><span>,</span> <span>&amp;H60858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFF30858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFC7C4</span><span>,</span> <span>&amp;HB7FBE853</span><span>,</span> <span>&amp;HB005FFFF</span></td>
        </tr>
        <tr>
          <td id="L7606" data-line-number="7606"></td>
          <td id="LC7606">    <span>pvAppendBuffer</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;HFF30858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;H8D509045</span><span>,</span> <span>&amp;HFFFDE085</span><span>,</span> <span>&amp;HCEE850FF</span><span>,</span> <span>&amp;H8D000036</span><span>,</span> <span>&amp;HFFFE7085</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;H858D5090</span><span>,</span> <span>&amp;HFFFFFF60</span><span>,</span> <span>&amp;H30858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFFBFDDE8</span><span>,</span> <span>&amp;H858D53FF</span><span>,</span> <span>&amp;HFFFFFDE0</span><span>,</span> <span>&amp;HC0458D50</span><span>,</span> <span>&amp;H47E85050</span><span>,</span> <span>&amp;H83000036</span><span>,</span> <span>&amp;H890F01EE</span><span>,</span> <span>&amp;HFFFFFF1C</span><span>,</span> <span>&amp;HB79FE853</span><span>,</span> <span>&amp;HB005FFFF</span><span>,</span> <span>&amp;H50000000</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;H3118E850</span><span>,</span> <span>&amp;H458D0000</span><span>,</span> <span>&amp;H858D50C0</span><span>,</span> <span>&amp;HFFFFFE70</span><span>,</span> <span>&amp;H90458D50</span><span>,</span> <span>&amp;HC73EE850</span><span>,</span> <span>&amp;H8D53FFFF</span></td>
        </tr>
        <tr>
          <td id="L7607" data-line-number="7607"></td>
          <td id="LC7607">    <span>pvAppendBuffer</span> <span>&amp;HE8509045</span><span>,</span> <span>&amp;HFFFFB771</span><span>,</span> <span>&amp;H170BE</span><span>,</span> <span>&amp;H50C60300</span><span>,</span> <span>&amp;H2C1EE8</span><span>,</span> <span>&amp;HF8835F00</span><span>,</span> <span>&amp;H53137401</span><span>,</span> <span>&amp;HFFB758E8</span><span>,</span> <span>&amp;H50C603FF</span><span>,</span> <span>&amp;H5090458D</span><span>,</span> <span>&amp;H39FCE850</span><span>,</span> <span>&amp;H8D530000</span><span>,</span> <span>&amp;HFFFED085</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;HF4E85090</span><span>,</span> <span>&amp;HF700002B</span><span>,</span> <span>&amp;H40C01BD8</span><span>,</span> <span>&amp;HC03302EB</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;H56EC8B55</span><span>,</span> <span>&amp;H8B08758B</span><span>,</span> <span>&amp;H85048D06</span><span>,</span> <span>&amp;H4</span><span>&amp;,</span> <span>&amp;HC8E85650</span><span>,</span> <span>&amp;HE8000029</span><span>,</span> <span>&amp;HFFFFB70D</span><span>,</span> <span>&amp;H850FF56</span><span>,</span> <span>&amp;H4C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8B084D8B</span><span>,</span> <span>&amp;H7E8C1C1</span></td>
        </tr>
        <tr>
          <td id="L7608" data-line-number="7608"></td>
          <td id="LC7608">    <span>pvAppendBuffer</span> <span>&amp;H7F7FE181</span><span>,</span> <span>&amp;H125FF7F</span><span>,</span> <span>&amp;H3010101</span><span>,</span> <span>&amp;H1BC06BC9</span><span>,</span> <span>&amp;HC25DC133</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;HB6EEE8EC</span><span>,</span> <span>&amp;HD1B9FFFF</span><span>,</span> <span>&amp;H8100478A</span><span>,</span> <span>&amp;H474000E9</span><span>,</span> <span>&amp;H8BC10300</span><span>,</span> <span>&amp;H5051084D</span><span>,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;H75FF3041</span><span>,</span> <span>&amp;H50106A0C</span><span>,</span> <span>&amp;H5020418D</span><span>,</span> <span>&amp;HFFD6EEE8</span><span>,</span> <span>&amp;HCC25DFF</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8B084D8B</span><span>,</span> <span>&amp;HFF501045</span><span>,</span> <span>&amp;H41010C75</span><span>,</span> <span>&amp;H51835138</span><span>,</span> <span>&amp;HB3E8003C</span><span>,</span> <span>&amp;H5DFFFFFF</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;H7E830875</span><span>,</span> <span>&amp;HD750148</span><span>,</span> <span>&amp;H20E856</span><span>,</span> <span>&amp;H46C70000</span><span>,</span> <span>&amp;H248</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7609" data-line-number="7609"></td>
          <td id="LC7609">    <span>pvAppendBuffer</span> <span>&amp;H10458B00</span><span>,</span> <span>&amp;H50404601</span><span>,</span> <span>&amp;H830C75FF</span><span>,</span> <span>&amp;H56004456</span><span>,</span> <span>&amp;HFFFF81E8</span><span>,</span> <span>&amp;HC25D5EFF</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;H304E8B08</span><span>,</span> <span>&amp;H2474C985</span><span>,</span> <span>&amp;H2B58106A</span><span>,</span> <span>&amp;H468D50C1</span><span>,</span> <span>&amp;H6AC10320</span><span>,</span> <span>&amp;H72E85000</span><span>,</span> <span>&amp;H8300000A</span><span>,</span> <span>&amp;H468D0CC4</span><span>,</span> <span>&amp;HE8565020</span><span>,</span> <span>&amp;H9</span><span>&amp;,</span> <span>&amp;H306683</span><span>,</span> <span>&amp;H4C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8D10EC83</span><span>,</span> <span>&amp;H5756F045</span><span>,</span> <span>&amp;HC75FF50</span><span>,</span> <span>&amp;HFFE5FCE8</span><span>,</span> <span>&amp;H87D8BFF</span><span>,</span> <span>&amp;H8DF0458D</span><span>,</span> <span>&amp;H56561077</span><span>,</span> <span>&amp;HE551E850</span><span>,</span> <span>&amp;H5756FFFF</span><span>,</span> <span>&amp;H4C57FF56</span><span>,</span> <span>&amp;HE58B5E5F</span></td>
        </tr>
        <tr>
          <td id="L7610" data-line-number="7610"></td>
          <td id="LC7610">    <span>pvAppendBuffer</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H51EC8B55</span><span>,</span> <span>&amp;H758B5651</span><span>,</span> <span>&amp;H487E8308</span><span>,</span> <span>&amp;H83067401</span><span>,</span> <span>&amp;H7502487E</span><span>,</span> <span>&amp;H7BE8560A</span><span>,</span> <span>&amp;H83FFFFFF</span><span>,</span> <span>&amp;H8B004866</span><span>,</span> <span>&amp;H458D384E</span><span>,</span> <span>&amp;H468B50F8</span><span>,</span> <span>&amp;HC8A40F3C</span><span>,</span> <span>&amp;H3E1C103</span><span>,</span> <span>&amp;H33E85150</span><span>,</span> <span>&amp;H6A000039</span><span>,</span> <span>&amp;HF8458D08</span><span>,</span> <span>&amp;HCFE85650</span><span>,</span> <span>&amp;H8BFFFFFE</span><span>,</span> <span>&amp;H458D404E</span><span>,</span> <span>&amp;H468B50F8</span><span>,</span> <span>&amp;HC8A40F44</span><span>,</span> <span>&amp;H3E1C103</span><span>,</span> <span>&amp;HFE85150</span><span>,</span> <span>&amp;H6A000039</span><span>,</span> <span>&amp;HF8458D08</span><span>,</span> <span>&amp;HABE85650</span><span>,</span> <span>&amp;HFFFFFFFE</span><span>,</span> <span>&amp;H468D0C75</span><span>,</span> <span>&amp;H1FE85010</span><span>,</span> <span>&amp;H5EFFFFE7</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span></td>
        </tr>
        <tr>
          <td id="L7611" data-line-number="7611"></td>
          <td id="LC7611">    <span>pvAppendBuffer</span> <span>&amp;H10EC83EC</span><span>,</span> <span>&amp;H8B575653</span><span>,</span> <span>&amp;H506A087D</span><span>,</span> <span>&amp;HE857006A</span><span>,</span> <span>&amp;H999</span><span>&amp;,</span> <span>&amp;H570CC483</span><span>,</span> <span>&amp;HE80C75FF</span><span>,</span> <span>&amp;HFFFFE541</span><span>,</span> <span>&amp;HC933C033</span><span>,</span> <span>&amp;H47895340</span><span>,</span> <span>&amp;H8BA20F48</span><span>,</span> <span>&amp;H5D8D5BF3</span><span>,</span> <span>&amp;H890389F0</span><span>,</span> <span>&amp;H4B890473</span><span>,</span> <span>&amp;HC538908</span><span>,</span> <span>&amp;HFFB54BE8</span><span>,</span> <span>&amp;HF845F6FF</span><span>,</span> <span>&amp;H719FB902</span><span>,</span> <span>&amp;H5750047</span><span>,</span> <span>&amp;H47711EB9</span><span>,</span> <span>&amp;HE98100</span><span>,</span> <span>&amp;H3004740</span><span>,</span> <span>&amp;H4C4789C1</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5614558B</span><span>,</span> <span>&amp;HEA83F633</span><span>,</span> <span>&amp;H8B307801</span><span>,</span> <span>&amp;H8B530C45</span><span>,</span> <span>&amp;H2B57085D</span><span>,</span> <span>&amp;H903C8DD8</span></td>
        </tr>
        <tr>
          <td id="L7612" data-line-number="7612"></td>
          <td id="LC7612">    <span>pvAppendBuffer</span> <span>&amp;H8B104529</span><span>,</span> <span>&amp;HC0333B0C</span><span>,</span> <span>&amp;HC013CE03</span><span>,</span> <span>&amp;HD0830F03</span><span>,</span> <span>&amp;H1EA8300</span><span>,</span> <span>&amp;H458BF08B</span><span>,</span> <span>&amp;H380C8910</span><span>,</span> <span>&amp;H79FC7F8D</span><span>,</span> <span>&amp;H8B5B5FE2</span><span>,</span> <span>&amp;HC25D5EC6</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H8B5653EC</span><span>,</span> <span>&amp;HC68B1075</span><span>,</span> <span>&amp;H1FE28399</span><span>,</span> <span>&amp;H23C8D57</span><span>,</span> <span>&amp;H8105FFC1</span><span>,</span> <span>&amp;H1FE6</span><span>&amp;,</span> <span>&amp;H4E057980</span><span>,</span> <span>&amp;H46E0CE83</span><span>,</span> <span>&amp;H8B0C558B</span><span>,</span> <span>&amp;H59206ADE</span><span>,</span> <span>&amp;HC28BCE2B</span><span>,</span> <span>&amp;HDBF7E8D3</span><span>,</span> <span>&amp;HDB1BCE8B</span><span>,</span> <span>&amp;HD823E2D3</span><span>,</span> <span>&amp;H5D89C933</span><span>,</span> <span>&amp;H85D8B10</span><span>,</span> <span>&amp;H110758B</span><span>,</span> <span>&amp;H1304BB54</span><span>,</span> <span>&amp;H75F685C9</span><span>,</span> <span>&amp;H74C98504</span><span>,</span> <span>&amp;HBB448B2C</span></td>
        </tr>
        <tr>
          <td id="L7613" data-line-number="7613"></td>
          <td id="LC7613">    <span>pvAppendBuffer</span> <span>&amp;H3D23308</span><span>,</span> <span>&amp;H3D213C1</span><span>,</span> <span>&amp;HBB4489C6</span><span>,</span> <span>&amp;HD28308</span><span>,</span> <span>&amp;H8503C783</span><span>,</span> <span>&amp;H8D1274D2</span><span>,</span> <span>&amp;HC033BB34</span><span>,</span> <span>&amp;H768D1601</span><span>,</span> <span>&amp;H8BC01304</span><span>,</span> <span>&amp;H75D285D0</span><span>,</span> <span>&amp;H5B5E5FF1</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H558B30EC</span><span>,</span> <span>&amp;H5D8B5314</span><span>,</span> <span>&amp;H56C38B0C</span><span>,</span> <span>&amp;H2BFF3357</span><span>,</span> <span>&amp;HEC4589C2</span><span>,</span> <span>&amp;H1EB880F</span><span>,</span> <span>&amp;H558B0000</span><span>,</span> <span>&amp;H8BC88BEC</span><span>,</span> <span>&amp;HE1C10845</span><span>,</span> <span>&amp;HFC4D8905</span><span>,</span> <span>&amp;H85B8348B</span><span>,</span> <span>&amp;H470C75F6</span><span>,</span> <span>&amp;H8920E983</span><span>,</span> <span>&amp;HBCE9FC4D</span><span>,</span> <span>&amp;H56000001</span><span>,</span> <span>&amp;HFFCA53E8</span><span>,</span> <span>&amp;H8BD08BFF</span><span>,</span> <span>&amp;HD45589CA</span><span>,</span> <span>&amp;HD285E6D3</span></td>
        </tr>
        <tr>
          <td id="L7614" data-line-number="7614"></td>
          <td id="LC7614">    <span>pvAppendBuffer</span> <span>&amp;H478D177E</span><span>,</span> <span>&amp;H7DC33B01</span><span>,</span> <span>&amp;H8458B10</span><span>,</span> <span>&amp;H2B59206A</span><span>,</span> <span>&amp;HB8548BCA</span><span>,</span> <span>&amp;HBEAD304</span><span>,</span> <span>&amp;H205D8BF2</span><span>,</span> <span>&amp;H65F7C68B</span><span>,</span> <span>&amp;HFC458B1C</span><span>,</span> <span>&amp;H2BE1C383</span><span>,</span> <span>&amp;HF28BD445</span><span>,</span> <span>&amp;H7589D803</span><span>,</span> <span>&amp;HF45D89F0</span><span>,</span> <span>&amp;HFB831F79</span><span>,</span> <span>&amp;H748E0FE0</span><span>,</span> <span>&amp;HF7000001</span><span>,</span> <span>&amp;H33CB8BDB</span><span>,</span> <span>&amp;H89EED3DB</span><span>,</span> <span>&amp;H5D89F075</span><span>,</span> <span>&amp;HFF685F4</span><span>,</span> <span>&amp;H15E84</span><span>,</span> <span>&amp;H25C38B00</span><span>,</span> <span>&amp;H8000001F</span><span>,</span> <span>&amp;H83480579</span><span>,</span> <span>&amp;H8B40E0C8</span><span>,</span> <span>&amp;H45890C4D</span><span>,</span> <span>&amp;H99C38BDC</span><span>,</span> <span>&amp;H31FE283</span><span>,</span> <span>&amp;H14558BC2</span><span>,</span> <span>&amp;H2B05F8C1</span><span>,</span> <span>&amp;HDC458BC8</span><span>,</span> <span>&amp;HC085CA2B</span></td>
        </tr>
        <tr>
          <td id="L7615" data-line-number="7615"></td>
          <td id="LC7615">    <span>pvAppendBuffer</span> <span>&amp;H45217575</span><span>,</span> <span>&amp;H45214AF0</span><span>,</span> <span>&amp;H89CA03DC</span><span>,</span> <span>&amp;H4D89E455</span><span>,</span> <span>&amp;HE845C7E0</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H8C0FCF3B</span><span>,</span> <span>&amp;HEF</span><span>&amp;,</span> <span>&amp;H8B08458B</span><span>,</span> <span>&amp;H48D105D</span><span>,</span> <span>&amp;HF8458988</span><span>,</span> <span>&amp;H479D285</span><span>,</span> <span>&amp;H3EBC033</span><span>,</span> <span>&amp;HF793048B</span><span>,</span> <span>&amp;HF04503E6</span><span>,</span> <span>&amp;HD283D0F7</span><span>,</span> <span>&amp;H89C93300</span><span>,</span> <span>&amp;H558BF055</span><span>,</span> <span>&amp;H130203F8</span><span>,</span> <span>&amp;HE84503C9</span><span>,</span> <span>&amp;H4D130289</span><span>,</span> <span>&amp;HE4558BDC</span><span>,</span> <span>&amp;H4F86D83</span><span>,</span> <span>&amp;HDC65834A</span><span>,</span> <span>&amp;HE84D8900</span><span>,</span> <span>&amp;H49E04D8B</span><span>,</span> <span>&amp;H89E45589</span><span>,</span> <span>&amp;HCF3BE04D</span><span>,</span> <span>&amp;H95E9BA7D</span><span>,</span> <span>&amp;H83000000</span><span>,</span> <span>&amp;H4A00E865</span><span>,</span> <span>&amp;H5589CA03</span></td>
        </tr>
        <tr>
          <td id="L7616" data-line-number="7616"></td>
          <td id="LC7616">    <span>pvAppendBuffer</span> <span>&amp;HD44D89D8</span><span>,</span> <span>&amp;H8C0FCF3B</span><span>,</span> <span>&amp;H83</span><span>&amp;,</span> <span>&amp;H2B5B206A</span><span>,</span> <span>&amp;HE445C7D8</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H8308458B</span><span>,</span> <span>&amp;H8900E065</span><span>,</span> <span>&amp;H5D8BD05D</span><span>,</span> <span>&amp;H88048DDC</span><span>,</span> <span>&amp;H85F84589</span><span>,</span> <span>&amp;H330479D2</span><span>,</span> <span>&amp;H8B06EBC0</span><span>,</span> <span>&amp;H48B1045</span><span>,</span> <span>&amp;H8BE6F790</span><span>,</span> <span>&amp;H3F08BCB</span><span>,</span> <span>&amp;HD283E075</span><span>,</span> <span>&amp;H89C03300</span><span>,</span> <span>&amp;HD68BE055</span><span>,</span> <span>&amp;H550BE2D3</span><span>,</span> <span>&amp;HF84D8BE8</span><span>,</span> <span>&amp;H1103D2F7</span><span>,</span> <span>&amp;H5503C013</span><span>,</span> <span>&amp;HD083E4</span><span>,</span> <span>&amp;H8BE44589</span><span>,</span> <span>&amp;HD04D8BC1</span><span>,</span> <span>&amp;HD68B1089</span><span>,</span> <span>&amp;H83F0758B</span><span>,</span> <span>&amp;HEAD304E8</span><span>,</span> <span>&amp;H89D44D8B</span><span>,</span> <span>&amp;H558BE855</span><span>,</span> <span>&amp;H45894AD8</span></td>
        </tr>
        <tr>
          <td id="L7617" data-line-number="7617"></td>
          <td id="LC7617">    <span>pvAppendBuffer</span> <span>&amp;H558949F8</span><span>,</span> <span>&amp;HD44D89D8</span><span>,</span> <span>&amp;H9F7DCF3B</span><span>,</span> <span>&amp;H83F45D8B</span><span>,</span> <span>&amp;H7400187D</span><span>,</span> <span>&amp;HFF56530A</span><span>,</span> <span>&amp;H8BE81875</span><span>,</span> <span>&amp;H8BFFFFFD</span><span>,</span> <span>&amp;H4D8BEC55</span><span>,</span> <span>&amp;H8458BFC</span><span>,</span> <span>&amp;H3B0C5D8B</span><span>,</span> <span>&amp;H298E0FFA</span><span>,</span> <span>&amp;H8BFFFFFE</span><span>,</span> <span>&amp;H558B0C5D</span><span>,</span> <span>&amp;H87D8B14</span><span>,</span> <span>&amp;HDB85C933</span><span>,</span> <span>&amp;H458B247E</span><span>,</span> <span>&amp;H8DD32B10</span><span>,</span> <span>&amp;H48D9034</span><span>,</span> <span>&amp;H79C0850A</span><span>,</span> <span>&amp;HEBC03304</span><span>,</span> <span>&amp;H39068B02</span><span>,</span> <span>&amp;H67728F04</span><span>,</span> <span>&amp;H83410877</span><span>,</span> <span>&amp;HCB3B04C6</span><span>,</span> <span>&amp;H6583E47C</span><span>,</span> <span>&amp;H538D000C</span><span>,</span> <span>&amp;H845C7FF</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H3978D285</span><span>,</span> <span>&amp;H8B10458B</span><span>,</span> <span>&amp;H3F32BF2</span></td>
        </tr>
        <tr>
          <td id="L7618" data-line-number="7618"></td>
          <td id="LC7618">    <span>pvAppendBuffer</span> <span>&amp;H1C8D1475</span><span>,</span> <span>&amp;H79F685B0</span><span>,</span> <span>&amp;HEBC93304</span><span>,</span> <span>&amp;H330B8B02</span><span>,</span> <span>&amp;H3D1F7C0</span><span>,</span> <span>&amp;HC013970C</span><span>,</span> <span>&amp;H89084D03</span><span>,</span> <span>&amp;H4513970C</span><span>,</span> <span>&amp;H65834E0C</span><span>,</span> <span>&amp;HEB83000C</span><span>,</span> <span>&amp;H1EA8304</span><span>,</span> <span>&amp;H79084589</span><span>,</span> <span>&amp;H187D83D4</span><span>,</span> <span>&amp;H6A0C7400</span><span>,</span> <span>&amp;HFF016A00</span><span>,</span> <span>&amp;HE7E81875</span><span>,</span> <span>&amp;H5FFFFFFC</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H1CC25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H8B5328EC</span><span>,</span> <span>&amp;H5756145D</span><span>,</span> <span>&amp;HF32FB83</span><span>,</span> <span>&amp;H1B88E</span><span>,</span> <span>&amp;H18758B00</span><span>,</span> <span>&amp;H2B99C38B</span><span>,</span> <span>&amp;H8BF88BC2</span><span>,</span> <span>&amp;HFFD156C3</span><span>,</span> <span>&amp;H1075FF57</span><span>,</span> <span>&amp;H7D89C72B</span><span>,</span> <span>&amp;HC75FFF0</span><span>,</span> <span>&amp;HFFFC4589</span></td>
        </tr>
        <tr>
          <td id="L7619" data-line-number="7619"></td>
          <td id="LC7619">    <span>pvAppendBuffer</span> <span>&amp;HC5E80875</span><span>,</span> <span>&amp;H8BFFFFFF</span><span>,</span> <span>&amp;H8B561045</span><span>,</span> <span>&amp;H8D56FC75</span><span>,</span> <span>&amp;H458BF814</span><span>,</span> <span>&amp;H5589520C</span><span>,</span> <span>&amp;HB80C8DD8</span><span>,</span> <span>&amp;H5108458B</span><span>,</span> <span>&amp;H8DDC4D89</span><span>,</span> <span>&amp;H8950B804</span><span>,</span> <span>&amp;H9DE8E445</span><span>,</span> <span>&amp;H8BFFFFFF</span><span>,</span> <span>&amp;H468D184D</span><span>,</span> <span>&amp;H6AF63301</span><span>,</span> <span>&amp;H81148D04</span><span>,</span> <span>&amp;H89047A8D</span><span>,</span> <span>&amp;HF4558932</span><span>,</span> <span>&amp;H8904518D</span><span>,</span> <span>&amp;HEC558937</span><span>,</span> <span>&amp;H558B3289</span><span>,</span> <span>&amp;HE07D89F0</span><span>,</span> <span>&amp;H855F3189</span><span>,</span> <span>&amp;H3467ED2</span><span>,</span> <span>&amp;H8DC22BC0</span><span>,</span> <span>&amp;H45898104</span><span>,</span> <span>&amp;HFC458BE8</span><span>,</span> <span>&amp;H8DC22B40</span><span>,</span> <span>&amp;H4D8B8104</span><span>,</span> <span>&amp;HF845890C</span><span>,</span> <span>&amp;H2B08458B</span><span>,</span> <span>&amp;HC5589C1</span><span>,</span> <span>&amp;H89E8558B</span></td>
        </tr>
        <tr>
          <td id="L7620" data-line-number="7620"></td>
          <td id="LC7620">    <span>pvAppendBuffer</span> <span>&amp;H5D8B0845</span><span>,</span> <span>&amp;H8048BF8</span><span>,</span> <span>&amp;H89F87D01</span><span>,</span> <span>&amp;H3018B03</span><span>,</span> <span>&amp;H145D8BCF</span><span>,</span> <span>&amp;HD7030289</span><span>,</span> <span>&amp;H10C6D83</span><span>,</span> <span>&amp;H7508458B</span><span>,</span> <span>&amp;HFC75FFE1</span><span>,</span> <span>&amp;H50EC458B</span><span>,</span> <span>&amp;H50E475FF</span><span>,</span> <span>&amp;HFFFBB4E8</span><span>,</span> <span>&amp;H184D8BFF</span><span>,</span> <span>&amp;H89FC75FF</span><span>,</span> <span>&amp;HE0458B01</span><span>,</span> <span>&amp;HDC75FF50</span><span>,</span> <span>&amp;HFB9FE850</span><span>,</span> <span>&amp;H4D8BFFFF</span><span>,</span> <span>&amp;HFC558BF4</span><span>,</span> <span>&amp;H8B018942</span><span>,</span> <span>&amp;H48D184D</span><span>,</span> <span>&amp;HC4589D1</span><span>,</span> <span>&amp;HE0C1C28B</span><span>,</span> <span>&amp;H50C10304</span><span>,</span> <span>&amp;HC75FF52</span><span>,</span> <span>&amp;H51F475FF</span><span>,</span> <span>&amp;HFFFEDFE8</span><span>,</span> <span>&amp;H184D8BFF</span><span>,</span> <span>&amp;H8DF0558B</span><span>,</span> <span>&amp;H71890841</span><span>,</span> <span>&amp;HDC45890C</span><span>,</span> <span>&amp;H48D3089</span></td>
        </tr>
        <tr>
          <td id="L7621" data-line-number="7621"></td>
          <td id="LC7621">    <span>pvAppendBuffer</span> <span>&amp;H4718912</span><span>,</span> <span>&amp;H45893189</span><span>,</span> <span>&amp;H7EC08508</span><span>,</span> <span>&amp;HFC458B1E</span><span>,</span> <span>&amp;H40105D8B</span><span>,</span> <span>&amp;H558BC22B</span><span>,</span> <span>&amp;HC10C8D08</span><span>,</span> <span>&amp;H46B3048B</span><span>,</span> <span>&amp;HCF030189</span><span>,</span> <span>&amp;HF47CF23B</span><span>,</span> <span>&amp;H8B145D8B</span><span>,</span> <span>&amp;H48DFC75</span><span>,</span> <span>&amp;H458B5036</span><span>,</span> <span>&amp;H75FF50DC</span><span>,</span> <span>&amp;H26E850D8</span><span>,</span> <span>&amp;H8BFFFFFB</span><span>,</span> <span>&amp;H189EC4D</span><span>,</span> <span>&amp;H8B01468D</span><span>,</span> <span>&amp;H348D184D</span><span>,</span> <span>&amp;HC458B00</span><span>,</span> <span>&amp;H50515056</span><span>,</span> <span>&amp;H1F2E8</span><span>,</span> <span>&amp;HFC4D8B00</span><span>,</span> <span>&amp;H1418D56</span><span>,</span> <span>&amp;H458BD82B</span><span>,</span> <span>&amp;H2BDB0310</span><span>,</span> <span>&amp;H98048DD9</span><span>,</span> <span>&amp;HC75FF50</span><span>,</span> <span>&amp;HFAEFE850</span><span>,</span> <span>&amp;HF08BFFFF</span><span>,</span> <span>&amp;H840FF685</span><span>,</span> <span>&amp;H87</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7622" data-line-number="7622"></td>
          <td id="LC7622">    <span>pvAppendBuffer</span> <span>&amp;H8310558B</span><span>,</span> <span>&amp;H148DFCC2</span><span>,</span> <span>&amp;H1C0339A</span><span>,</span> <span>&amp;H2BC01332</span><span>,</span> <span>&amp;H85F08BD7</span><span>,</span> <span>&amp;HEBF275F6</span><span>,</span> <span>&amp;H10558B6E</span><span>,</span> <span>&amp;H851B0C8D</span><span>,</span> <span>&amp;H33067EC9</span><span>,</span> <span>&amp;HF3FA8BC0</span><span>,</span> <span>&amp;H8458BAB</span><span>,</span> <span>&amp;H3B980C8D</span><span>,</span> <span>&amp;H8B5476C8</span><span>,</span> <span>&amp;H148D0C75</span><span>,</span> <span>&amp;HFCC283DA</span><span>,</span> <span>&amp;H5589046A</span><span>,</span> <span>&amp;H9E348D10</span><span>,</span> <span>&amp;H5F147589</span><span>,</span> <span>&amp;H186583</span><span>,</span> <span>&amp;HDA8BCF2B</span><span>,</span> <span>&amp;H760C753B</span><span>,</span> <span>&amp;H2B018B21</span><span>,</span> <span>&amp;H326F7F7</span><span>,</span> <span>&amp;HD2831845</span><span>,</span> <span>&amp;H83030100</span><span>,</span> <span>&amp;HDF2B00D2</span><span>,</span> <span>&amp;H3B185589</span><span>,</span> <span>&amp;HE5770C75</span><span>,</span> <span>&amp;H8B08458B</span><span>,</span> <span>&amp;H758B1055</span><span>,</span> <span>&amp;H89D72B18</span><span>,</span> <span>&amp;H14758B33</span></td>
        </tr>
        <tr>
          <td id="L7623" data-line-number="7623"></td>
          <td id="LC7623">    <span>pvAppendBuffer</span> <span>&amp;H3B105589</span><span>,</span> <span>&amp;H5FC177C8</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H14C25D</span><span>,</span> <span>&amp;H51EC8B55</span><span>,</span> <span>&amp;H5D8B5351</span><span>,</span> <span>&amp;H83575614</span><span>,</span> <span>&amp;H8E0F32FB</span><span>,</span> <span>&amp;HA1</span><span>&amp;,</span> <span>&amp;H8B0C7D8B</span><span>,</span> <span>&amp;H8758BC3</span><span>,</span> <span>&amp;H8BC22B99</span><span>,</span> <span>&amp;H8BC88BD3</span><span>,</span> <span>&amp;HF9D11845</span><span>,</span> <span>&amp;H4D89D12B</span><span>,</span> <span>&amp;HF85589FC</span><span>,</span> <span>&amp;H53D81C8D</span><span>,</span> <span>&amp;HC8048D52</span><span>,</span> <span>&amp;H8F048D50</span><span>,</span> <span>&amp;H8E048D50</span><span>,</span> <span>&amp;HFD76E850</span><span>,</span> <span>&amp;H4D8BFFFF</span><span>,</span> <span>&amp;H18458BFC</span><span>,</span> <span>&amp;H48D5153</span><span>,</span> <span>&amp;H458B5088</span><span>,</span> <span>&amp;H87048DF8</span><span>,</span> <span>&amp;HA1E85650</span><span>,</span> <span>&amp;H53FFFFFF</span><span>,</span> <span>&amp;H8BFC75FF</span><span>,</span> <span>&amp;H5753185D</span><span>,</span> <span>&amp;H8DF87D8B</span><span>,</span> <span>&amp;HE850BE04</span></td>
        </tr>
        <tr>
          <td id="L7624" data-line-number="7624"></td>
          <td id="LC7624">    <span>pvAppendBuffer</span> <span>&amp;HFFFFFF8C</span><span>,</span> <span>&amp;H85FC758B</span><span>,</span> <span>&amp;H8B1B7EFF</span><span>,</span> <span>&amp;HC8D1045</span><span>,</span> <span>&amp;H77048DB0</span><span>,</span> <span>&amp;H8B83148D</span><span>,</span> <span>&amp;H4528D02</span><span>,</span> <span>&amp;H498D0189</span><span>,</span> <span>&amp;H1EF8304</span><span>,</span> <span>&amp;H5356F175</span><span>,</span> <span>&amp;H50B3048D</span><span>,</span> <span>&amp;HF9B3E853</span><span>,</span> <span>&amp;H458BFFFF</span><span>,</span> <span>&amp;H75FF5614</span><span>,</span> <span>&amp;H83048D10</span><span>,</span> <span>&amp;HA2E85350</span><span>,</span> <span>&amp;HEBFFFFF9</span><span>,</span> <span>&amp;H7EDB857D</span><span>,</span> <span>&amp;H107D8B09</span><span>,</span> <span>&amp;HC033CB8B</span><span>,</span> <span>&amp;H458BABF3</span><span>,</span> <span>&amp;H107D8B08</span><span>,</span> <span>&amp;H8D980C8D</span><span>,</span> <span>&amp;H75899F34</span><span>,</span> <span>&amp;H76C83B14</span><span>,</span> <span>&amp;HC458B5D</span><span>,</span> <span>&amp;H8B98048D</span><span>,</span> <span>&amp;HC083085D</span><span>,</span> <span>&amp;HFC4589FC</span><span>,</span> <span>&amp;H106583</span><span>,</span> <span>&amp;H8304E983</span><span>,</span> <span>&amp;H89001865</span></td>
        </tr>
        <tr>
          <td id="L7625" data-line-number="7625"></td>
          <td id="LC7625">    <span>pvAppendBuffer</span> <span>&amp;H45890C75</span><span>,</span> <span>&amp;H76F73BF8</span><span>,</span> <span>&amp;H8BDE8B2F</span><span>,</span> <span>&amp;H83068BF0</span><span>,</span> <span>&amp;H21F704EB</span><span>,</span> <span>&amp;H3FC768D</span><span>,</span> <span>&amp;HD28303</span><span>,</span> <span>&amp;H89104503</span><span>,</span> <span>&amp;H18551303</span><span>,</span> <span>&amp;H186583</span><span>,</span> <span>&amp;H3B105589</span><span>,</span> <span>&amp;H8BDE77DF</span><span>,</span> <span>&amp;H5D8B1475</span><span>,</span> <span>&amp;HFC458B08</span><span>,</span> <span>&amp;H8904EE83</span><span>,</span> <span>&amp;HCB3B1475</span><span>,</span> <span>&amp;H5E5FB277</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550014C2</span><span>,</span> <span>&amp;H8B51EC8B</span><span>,</span> <span>&amp;H65831455</span><span>,</span> <span>&amp;HEA8300FC</span><span>,</span> <span>&amp;H1445C701</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H458B3978</span><span>,</span> <span>&amp;H8B565308</span><span>,</span> <span>&amp;H8B570C75</span><span>,</span> <span>&amp;H1C8D107D</span><span>,</span> <span>&amp;H2BF02B90</span><span>,</span> <span>&amp;H1E0C8BF8</span><span>,</span> <span>&amp;HD1F7C033</span><span>,</span> <span>&amp;HC0130B03</span></td>
        </tr>
        <tr>
          <td id="L7626" data-line-number="7626"></td>
          <td id="LC7626">    <span>pvAppendBuffer</span> <span>&amp;H89144D03</span><span>,</span> <span>&amp;H5B8D1F0C</span><span>,</span> <span>&amp;HFC4513FC</span><span>,</span> <span>&amp;HFC6583</span><span>,</span> <span>&amp;H8901EA83</span><span>,</span> <span>&amp;HDD791445</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H10C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H80EC81</span><span>,</span> <span>&amp;H8B560000</span><span>,</span> <span>&amp;H6A570C75</span><span>,</span> <span>&amp;H7D8D5920</span><span>,</span> <span>&amp;HBEA5F380</span><span>,</span> <span>&amp;HFD</span><span>&amp;,</span> <span>&amp;H5080458D</span><span>,</span> <span>&amp;H2087E850</span><span>,</span> <span>&amp;HFE830000</span><span>,</span> <span>&amp;H83127402</span><span>,</span> <span>&amp;HD7404FE</span><span>,</span> <span>&amp;H8D0C75FF</span><span>,</span> <span>&amp;H50508045</span><span>,</span> <span>&amp;HE7FE8</span><span>,</span> <span>&amp;H1EE8300</span><span>,</span> <span>&amp;H7D8BDA79</span><span>,</span> <span>&amp;H80758D08</span><span>,</span> <span>&amp;HF359206A</span><span>,</span> <span>&amp;H8B5E5FA5</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HFF575653</span><span>,</span> <span>&amp;H72E80875</span></td>
        </tr>
        <tr>
          <td id="L7627" data-line-number="7627"></td>
          <td id="LC7627">    <span>pvAppendBuffer</span> <span>&amp;H8BFFFFF6</span><span>,</span> <span>&amp;H6AE853D8</span><span>,</span> <span>&amp;H8BFFFFF6</span><span>,</span> <span>&amp;H62E852D0</span><span>,</span> <span>&amp;H8BFFFFF6</span><span>,</span> <span>&amp;H87D33F8</span><span>,</span> <span>&amp;HC78BF78B</span><span>,</span> <span>&amp;HCFC1C333</span><span>,</span> <span>&amp;HC1F23308</span><span>,</span> <span>&amp;HCE8B08C0</span><span>,</span> <span>&amp;H3310C9C1</span><span>,</span> <span>&amp;H33C733C1</span><span>,</span> <span>&amp;HC3335FC6</span><span>,</span> <span>&amp;H5E084533</span><span>,</span> <span>&amp;H4C25D5B</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8758B56</span><span>,</span> <span>&amp;HAAE836FF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;H6890476</span><span>,</span> <span>&amp;HFFFFA0E8</span><span>,</span> <span>&amp;H876FFFF</span><span>,</span> <span>&amp;HE8044689</span><span>,</span> <span>&amp;HFFFFFF95</span><span>,</span> <span>&amp;H890C76FF</span><span>,</span> <span>&amp;H8AE80846</span><span>,</span> <span>&amp;H89FFFFFF</span><span>,</span> <span>&amp;H5D5E0C46</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H8B53EC8B</span><span>,</span> <span>&amp;H5756085D</span><span>,</span> <span>&amp;H77BB60F</span></td>
        </tr>
        <tr>
          <td id="L7628" data-line-number="7628"></td>
          <td id="LC7628">    <span>pvAppendBuffer</span> <span>&amp;H243B60F</span><span>,</span> <span>&amp;HB73B60F</span><span>,</span> <span>&amp;HF53B60F</span><span>,</span> <span>&amp;HB08E7C1</span><span>,</span> <span>&amp;H4BB60FF8</span><span>,</span> <span>&amp;H43B60F03</span><span>,</span> <span>&amp;H8E7C10D</span><span>,</span> <span>&amp;HE6C1F80B</span><span>,</span> <span>&amp;H43B60F08</span><span>,</span> <span>&amp;H8E7C108</span><span>,</span> <span>&amp;HE2C1F80B</span><span>,</span> <span>&amp;H43B60F08</span><span>,</span> <span>&amp;HC1F00B06</span><span>,</span> <span>&amp;HB60F08E1</span><span>,</span> <span>&amp;HE6C10143</span><span>,</span> <span>&amp;HFF00B08</span><span>,</span> <span>&amp;HC10C43B6</span><span>,</span> <span>&amp;HF00B08E6</span><span>,</span> <span>&amp;HA43B60F</span><span>,</span> <span>&amp;HB60FD00B</span><span>,</span> <span>&amp;HE2C10543</span><span>,</span> <span>&amp;HFD00B08</span><span>,</span> <span>&amp;HE2C103B6</span><span>,</span> <span>&amp;HFD00B08</span><span>,</span> <span>&amp;HB0E43B6</span><span>,</span> <span>&amp;HC5389C8</span><span>,</span> <span>&amp;H943B60F</span><span>,</span> <span>&amp;HB08E1C1</span><span>,</span> <span>&amp;H87389C8</span><span>,</span> <span>&amp;H443B60F</span><span>,</span> <span>&amp;HC1047B89</span><span>,</span> <span>&amp;HB5F08E1</span></td>
        </tr>
        <tr>
          <td id="L7629" data-line-number="7629"></td>
          <td id="LC7629">    <span>pvAppendBuffer</span> <span>&amp;HB895EC8</span><span>,</span> <span>&amp;H4C25D5B</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H66E85756</span><span>,</span> <span>&amp;H8BFFFFAC</span><span>,</span> <span>&amp;H93BF0875</span><span>,</span> <span>&amp;H3000006</span><span>,</span> <span>&amp;H36FF50C7</span><span>,</span> <span>&amp;H1FD2E8</span><span>,</span> <span>&amp;HE8068900</span><span>,</span> <span>&amp;HFFFFAC4D</span><span>,</span> <span>&amp;HFF50C703</span><span>,</span> <span>&amp;HC0E80476</span><span>,</span> <span>&amp;H8900001F</span><span>,</span> <span>&amp;H3AE80446</span><span>,</span> <span>&amp;H3FFFFAC</span><span>,</span> <span>&amp;H76FF50C7</span><span>,</span> <span>&amp;H1FADE808</span><span>,</span> <span>&amp;H46890000</span><span>,</span> <span>&amp;HAC27E808</span><span>,</span> <span>&amp;HC703FFFF</span><span>,</span> <span>&amp;HC76FF50</span><span>,</span> <span>&amp;H1F9AE8</span><span>,</span> <span>&amp;H46895F00</span><span>,</span> <span>&amp;HC25D5E0C</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;HC7D83EC</span><span>,</span> <span>&amp;H56157400</span><span>,</span> <span>&amp;H8B0C75FF</span><span>,</span> <span>&amp;H6A0875</span><span>,</span> <span>&amp;H2FE856</span><span>,</span> <span>&amp;H68A0000</span></td>
        </tr>
        <tr>
          <td id="L7630" data-line-number="7630"></td>
          <td id="LC7630">    <span>pvAppendBuffer</span> <span>&amp;H5E0CC483</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H8BEC8B55</span><span>,</span> <span>&amp;H458B1055</span><span>,</span> <span>&amp;HF08B5608</span><span>,</span> <span>&amp;H1274D285</span><span>,</span> <span>&amp;HC7D8B57</span><span>,</span> <span>&amp;HC8AF82B</span><span>,</span> <span>&amp;H460E8837</span><span>,</span> <span>&amp;H7501EA83</span><span>,</span> <span>&amp;H5D5E5FF5</span><span>,</span> <span>&amp;HEC8B55C3</span><span>,</span> <span>&amp;H85104D8B</span><span>,</span> <span>&amp;HF1F74C9</span><span>,</span> <span>&amp;H560C45B6</span><span>,</span> <span>&amp;HC069F18B</span><span>,</span> <span>&amp;H1010101</span><span>,</span> <span>&amp;H87D8B57</span><span>,</span> <span>&amp;HF302E9C1</span><span>,</span> <span>&amp;H83CE8BAB</span><span>,</span> <span>&amp;HAAF303E1</span><span>,</span> <span>&amp;H458B5E5F</span><span>,</span> <span>&amp;H55C35D08</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;HE8560875</span><span>,</span> <span>&amp;HFFFFF48D</span><span>,</span> <span>&amp;HCE8BD08B</span><span>,</span> <span>&amp;HC9C1D633</span><span>,</span> <span>&amp;H8C2C110</span><span>,</span> <span>&amp;H3308CEC1</span><span>,</span> <span>&amp;H33D633D1</span><span>,</span> <span>&amp;HC25D5EC2</span></td>
        </tr>
        <tr>
          <td id="L7631" data-line-number="7631"></td>
          <td id="LC7631">    <span>pvAppendBuffer</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;H758B56EC</span><span>,</span> <span>&amp;HE836FF08</span><span>,</span> <span>&amp;HFFFFFFCB</span><span>,</span> <span>&amp;H890476FF</span><span>,</span> <span>&amp;HFFC1E806</span><span>,</span> <span>&amp;H76FFFFFF</span><span>,</span> <span>&amp;H4468908</span><span>,</span> <span>&amp;HFFFFB6E8</span><span>,</span> <span>&amp;HC76FFFF</span><span>,</span> <span>&amp;HE8084689</span><span>,</span> <span>&amp;HFFFFFFAB</span><span>,</span> <span>&amp;H5E0C4689</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H658340EC</span><span>,</span> <span>&amp;HC03300C4</span><span>,</span> <span>&amp;H53E44521</span><span>,</span> <span>&amp;H66A5756</span><span>,</span> <span>&amp;H8DDB3359</span><span>,</span> <span>&amp;H66AC87D</span><span>,</span> <span>&amp;HC05D8943</span><span>,</span> <span>&amp;H6A59ABF3</span><span>,</span> <span>&amp;HE87D8D04</span><span>,</span> <span>&amp;HF3E05D89</span><span>,</span> <span>&amp;H8D575FAB</span><span>,</span> <span>&amp;HE850C045</span><span>,</span> <span>&amp;HFFFFAB09</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;H1F0CE8</span><span>,</span> <span>&amp;H458D5700</span></td>
        </tr>
        <tr>
          <td id="L7632" data-line-number="7632"></td>
          <td id="LC7632">    <span>pvAppendBuffer</span> <span>&amp;H42E850C0</span><span>,</span> <span>&amp;H8D00002B</span><span>,</span> <span>&amp;H26EBFF70</span><span>,</span> <span>&amp;H50E0458D</span><span>,</span> <span>&amp;H29AAE8</span><span>,</span> <span>&amp;H458D5600</span><span>,</span> <span>&amp;HE850C0</span><span>,</span> <span>&amp;HB00002E</span><span>,</span> <span>&amp;H570E74C2</span><span>,</span> <span>&amp;H8D0875FF</span><span>,</span> <span>&amp;H5050E045</span><span>,</span> <span>&amp;H2961E8</span><span>,</span> <span>&amp;H458D4E00</span><span>,</span> <span>&amp;H3B5057E0</span><span>,</span> <span>&amp;HFFD177F3</span><span>,</span> <span>&amp;HACE80875</span><span>,</span> <span>&amp;H5F00002B</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H658360EC</span><span>,</span> <span>&amp;HC03300A4</span><span>,</span> <span>&amp;H53D44521</span><span>,</span> <span>&amp;HA6A5756</span><span>,</span> <span>&amp;H8DDB3359</span><span>,</span> <span>&amp;HA6AA87D</span><span>,</span> <span>&amp;HA05D8943</span><span>,</span> <span>&amp;H6A59ABF3</span><span>,</span> <span>&amp;HD87D8D06</span><span>,</span> <span>&amp;HF3D05D89</span><span>,</span> <span>&amp;H8D575FAB</span><span>,</span> <span>&amp;HE850A045</span></td>
        </tr>
        <tr>
          <td id="L7633" data-line-number="7633"></td>
          <td id="LC7633">    <span>pvAppendBuffer</span> <span>&amp;HFFFFAA75</span><span>,</span> <span>&amp;HB005</span><span>&amp;,</span> <span>&amp;H458D5000</span><span>,</span> <span>&amp;H76E850A0</span><span>,</span> <span>&amp;H5700001E</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;H2AACE8</span><span>,</span> <span>&amp;HFF708D00</span><span>,</span> <span>&amp;H458D26EB</span><span>,</span> <span>&amp;H14E850D0</span><span>,</span> <span>&amp;H56000029</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;H2D6AE8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H75FF570E</span><span>,</span> <span>&amp;HD0458D08</span><span>,</span> <span>&amp;HCBE85050</span><span>,</span> <span>&amp;H4E000028</span><span>,</span> <span>&amp;H57D0458D</span><span>,</span> <span>&amp;H77F33B50</span><span>,</span> <span>&amp;H875FFD1</span><span>,</span> <span>&amp;H2B16E8</span><span>,</span> <span>&amp;H5B5E5F00</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550004</span><span>,</span> <span>&amp;H14EC83EC</span><span>,</span> <span>&amp;HFF575653</span><span>,</span> <span>&amp;H5CE80C75</span><span>,</span> <span>&amp;HFFFFFFE1</span><span>,</span> <span>&amp;H45890875</span><span>,</span> <span>&amp;HE151E8FC</span><span>,</span> <span>&amp;HF08BFFFF</span></td>
        </tr>
        <tr>
          <td id="L7634" data-line-number="7634"></td>
          <td id="LC7634">    <span>pvAppendBuffer</span> <span>&amp;HFFA9F4E8</span><span>,</span> <span>&amp;H79405FF</span><span>,</span> <span>&amp;HE8500000</span><span>,</span> <span>&amp;HFFFFE13F</span><span>,</span> <span>&amp;HE8084589</span><span>,</span> <span>&amp;HFFFFA9E1</span><span>,</span> <span>&amp;H79805</span><span>,</span> <span>&amp;H2CE85000</span><span>,</span> <span>&amp;H33FFFFE1</span><span>,</span> <span>&amp;H43F88BDB</span><span>,</span> <span>&amp;H89F85D89</span><span>,</span> <span>&amp;HC6E8EC5D</span><span>,</span> <span>&amp;HE9FFFFA9</span><span>,</span> <span>&amp;HA6</span><span>&amp;,</span> <span>&amp;HFFA9BCE8</span><span>,</span> <span>&amp;H79405FF</span><span>,</span> <span>&amp;H56500000</span><span>,</span> <span>&amp;HFFBDEEE8</span><span>,</span> <span>&amp;HFC085FF</span><span>,</span> <span>&amp;H10684</span><span>,</span> <span>&amp;HE836FF00</span><span>,</span> <span>&amp;HC1F</span><span>&amp;,</span> <span>&amp;H8BF44589</span><span>,</span> <span>&amp;H30FFFC45</span><span>,</span> <span>&amp;HC12E8</span><span>,</span> <span>&amp;H45895000</span><span>,</span> <span>&amp;HF4458BF0</span><span>,</span> <span>&amp;H75FF5650</span><span>,</span> <span>&amp;HBA3FE8FC</span><span>,</span> <span>&amp;H4D8BFFFF</span><span>,</span> <span>&amp;H761939F4</span><span>,</span> <span>&amp;H83018B0F</span></td>
        </tr>
        <tr>
          <td id="L7635" data-line-number="7635"></td>
          <td id="LC7635">    <span>pvAppendBuffer</span> <span>&amp;H7500813C</span><span>,</span> <span>&amp;H1894807</span><span>,</span> <span>&amp;HF177C33B</span><span>,</span> <span>&amp;H39F04D8B</span><span>,</span> <span>&amp;H8B0F7619</span><span>,</span> <span>&amp;H813C8301</span><span>,</span> <span>&amp;H48077500</span><span>,</span> <span>&amp;HC33B0189</span><span>,</span> <span>&amp;H75FFF177</span><span>,</span> <span>&amp;HF226E8FC</span><span>,</span> <span>&amp;H458BFFFF</span><span>,</span> <span>&amp;HFC7589F4</span><span>,</span> <span>&amp;H5608758B</span><span>,</span> <span>&amp;HF075FF57</span><span>,</span> <span>&amp;H89F44589</span><span>,</span> <span>&amp;H73E8087D</span><span>,</span> <span>&amp;HF7FFFFBB</span><span>,</span> <span>&amp;HF88BEC5D</span><span>,</span> <span>&amp;HF202E856</span><span>,</span> <span>&amp;H75FFFFFF</span><span>,</span> <span>&amp;HF1FAE8F0</span><span>,</span> <span>&amp;H1EE8FFFF</span><span>,</span> <span>&amp;H8BFFFFA9</span><span>,</span> <span>&amp;H9805F475</span><span>,</span> <span>&amp;H50000007</span><span>,</span> <span>&amp;HBD4DE856</span><span>,</span> <span>&amp;HC085FFFF</span><span>,</span> <span>&amp;HFF46850F</span><span>,</span> <span>&amp;HE856FFFF</span><span>,</span> <span>&amp;HFFFFF1D8</span><span>,</span> <span>&amp;HE8FC75FF</span><span>,</span> <span>&amp;HFFFFF1D0</span></td>
        </tr>
        <tr>
          <td id="L7636" data-line-number="7636"></td>
          <td id="LC7636">    <span>pvAppendBuffer</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;HFFFFF1C8</span><span>,</span> <span>&amp;HEC7D83</span><span>,</span> <span>&amp;HBE8D0F</span><span>,</span> <span>&amp;H458B0000</span><span>,</span> <span>&amp;HE830FF0C</span><span>,</span> <span>&amp;HB5B</span><span>&amp;,</span> <span>&amp;HC933F08B</span><span>,</span> <span>&amp;H7589C033</span><span>,</span> <span>&amp;H63940EC</span><span>,</span> <span>&amp;H988C0F</span><span>,</span> <span>&amp;H458B0000</span><span>,</span> <span>&amp;H4568D0C</span><span>,</span> <span>&amp;H7D89C72B</span><span>,</span> <span>&amp;HFC7529FC</span><span>,</span> <span>&amp;H8BF44589</span><span>,</span> <span>&amp;H1E3B0C75</span><span>,</span> <span>&amp;H7FEC758B</span><span>,</span> <span>&amp;HFC458B2E</span><span>,</span> <span>&amp;H8BF44503</span><span>,</span> <span>&amp;H45891004</span><span>,</span> <span>&amp;H5624EBF0</span><span>,</span> <span>&amp;HFFF173E8</span><span>,</span> <span>&amp;HFC75FFFF</span><span>,</span> <span>&amp;HFFF16BE8</span><span>,</span> <span>&amp;H875FFFF</span><span>,</span> <span>&amp;HFFF163E8</span><span>,</span> <span>&amp;H5DE857FF</span><span>,</span> <span>&amp;H33FFFFF1</span><span>,</span> <span>&amp;H835BEBC0</span><span>,</span> <span>&amp;H3B00F065</span><span>,</span> <span>&amp;H8B0B7F1F</span></td>
        </tr>
        <tr>
          <td id="L7637" data-line-number="7637"></td>
          <td id="LC7637">    <span>pvAppendBuffer</span> <span>&amp;H48BFC45</span><span>,</span> <span>&amp;H8458910</span><span>,</span> <span>&amp;H658304EB</span><span>,</span> <span>&amp;H458B0008</span><span>,</span> <span>&amp;H8452BF0</span><span>,</span> <span>&amp;H2B0855F7</span><span>,</span> <span>&amp;H850289C1</span><span>,</span> <span>&amp;H3B0874C9</span><span>,</span> <span>&amp;HC91B0845</span><span>,</span> <span>&amp;H3907EB41</span><span>,</span> <span>&amp;HC91B0845</span><span>,</span> <span>&amp;HC085D9F7</span><span>,</span> <span>&amp;H74F8458B</span><span>,</span> <span>&amp;H89C38B05</span><span>,</span> <span>&amp;H8343F845</span><span>,</span> <span>&amp;H1E3B04C2</span><span>,</span> <span>&amp;HFF798E0F</span><span>,</span> <span>&amp;H8957FFFF</span><span>,</span> <span>&amp;HF102E806</span><span>,</span> <span>&amp;HFE8BFFFF</span><span>,</span> <span>&amp;H5E5FC78B</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H5756531C</span><span>,</span> <span>&amp;H8B107D8B</span><span>,</span> <span>&amp;HC1DE8B37</span><span>,</span> <span>&amp;H5D8902E3</span><span>,</span> <span>&amp;HA803E8E8</span><span>,</span> <span>&amp;HFF53FFFF</span><span>,</span> <span>&amp;H33D08B10</span><span>,</span> <span>&amp;H105589C9</span></td>
        </tr>
        <tr>
          <td id="L7638" data-line-number="7638"></td>
          <td id="LC7638">    <span>pvAppendBuffer</span> <span>&amp;HF7EF685</span><span>,</span> <span>&amp;HC12B078B</span><span>,</span> <span>&amp;H8987048B</span><span>,</span> <span>&amp;H3B418A04</span><span>,</span> <span>&amp;H8BF17CCE</span><span>,</span> <span>&amp;H4D8B087D</span><span>,</span> <span>&amp;H3B078B0C</span><span>,</span> <span>&amp;H8B027601</span><span>,</span> <span>&amp;H8D198BCF</span><span>,</span> <span>&amp;HC63B1B04</span><span>,</span> <span>&amp;HC68B0A7F</span><span>,</span> <span>&amp;H8BC22B99</span><span>,</span> <span>&amp;H43FBD1D8</span><span>,</span> <span>&amp;HE0C1C38B</span><span>,</span> <span>&amp;HE4458902</span><span>,</span> <span>&amp;HFFA7B8E8</span><span>,</span> <span>&amp;HC1CB8BFF</span><span>,</span> <span>&amp;HFF5102E1</span><span>,</span> <span>&amp;H89D38B10</span><span>,</span> <span>&amp;H172BFC45</span><span>,</span> <span>&amp;HC7ED285</span><span>,</span> <span>&amp;H8BFC7D8B</span><span>,</span> <span>&amp;HF3C033CA</span><span>,</span> <span>&amp;H87D8BAB</span><span>,</span> <span>&amp;HC933078B</span><span>,</span> <span>&amp;H1A7EC085</span><span>,</span> <span>&amp;H8DFC7D8B</span><span>,</span> <span>&amp;H7D8B9714</span><span>,</span> <span>&amp;H41C12B08</span><span>,</span> <span>&amp;H8987048B</span><span>,</span> <span>&amp;H4528D02</span><span>,</span> <span>&amp;HC83B078B</span></td>
        </tr>
        <tr>
          <td id="L7639" data-line-number="7639"></td>
          <td id="LC7639">    <span>pvAppendBuffer</span> <span>&amp;H72E8EF7C</span><span>,</span> <span>&amp;H8BFFFFA7</span><span>,</span> <span>&amp;H2E1C1CB</span><span>,</span> <span>&amp;H8B10FF51</span><span>,</span> <span>&amp;HCB8B0C55</span><span>,</span> <span>&amp;H7D89F88B</span><span>,</span> <span>&amp;H890A2BF8</span><span>,</span> <span>&amp;HC985084D</span><span>,</span> <span>&amp;HC033077E</span><span>,</span> <span>&amp;H4D8BABF3</span><span>,</span> <span>&amp;H33028B08</span><span>,</span> <span>&amp;H7EC085FF</span><span>,</span> <span>&amp;HF8558B1A</span><span>,</span> <span>&amp;H8B8A0C8D</span><span>,</span> <span>&amp;HC72B0C55</span><span>,</span> <span>&amp;H82048B47</span><span>,</span> <span>&amp;H498D0189</span><span>,</span> <span>&amp;H3B028B04</span><span>,</span> <span>&amp;H8BEF7CF8</span><span>,</span> <span>&amp;H3E7C1FB</span><span>,</span> <span>&amp;HE8EC7D89</span><span>,</span> <span>&amp;HFFFFA721</span><span>,</span> <span>&amp;H5310FF57</span><span>,</span> <span>&amp;HE8084589</span><span>,</span> <span>&amp;H96F</span><span>&amp;,</span> <span>&amp;HE7C1F88B</span><span>,</span> <span>&amp;HF07D8902</span><span>,</span> <span>&amp;HFFA708E8</span><span>,</span> <span>&amp;H10FF57FF</span><span>,</span> <span>&amp;H89107D8B</span><span>,</span> <span>&amp;H3F8B0C45</span><span>,</span> <span>&amp;HBD46E857</span></td>
        </tr>
        <tr>
          <td id="L7640" data-line-number="7640"></td>
          <td id="LC7640">    <span>pvAppendBuffer</span> <span>&amp;H4589FFFF</span><span>,</span> <span>&amp;H74C085F4</span><span>,</span> <span>&amp;HD3C88B18</span><span>,</span> <span>&amp;H1FE83E7</span><span>,</span> <span>&amp;H206A0F7E</span><span>,</span> <span>&amp;H8BC82B59</span><span>,</span> <span>&amp;H408B1045</span><span>,</span> <span>&amp;HBE8D304</span><span>,</span> <span>&amp;HC75FFF8</span><span>,</span> <span>&amp;H875FF53</span><span>,</span> <span>&amp;HFFF875FF</span><span>,</span> <span>&amp;H19E8FC75</span><span>,</span> <span>&amp;HFFFFFFF5</span><span>,</span> <span>&amp;HDB03F475</span><span>,</span> <span>&amp;H1006E857</span><span>,</span> <span>&amp;H6A500000</span><span>,</span> <span>&amp;H75FF5600</span><span>,</span> <span>&amp;H75FF5310</span><span>,</span> <span>&amp;HF262E808</span><span>,</span> <span>&amp;HF33BFFFF</span><span>,</span> <span>&amp;HF38B027C</span><span>,</span> <span>&amp;H91DE856</span><span>,</span> <span>&amp;HD2330000</span><span>,</span> <span>&amp;HF685F88B</span><span>,</span> <span>&amp;H458B197E</span><span>,</span> <span>&amp;H8DDE2B08</span><span>,</span> <span>&amp;HF8B981C</span><span>,</span> <span>&amp;HCA2B038B</span><span>,</span> <span>&amp;H45B8D42</span><span>,</span> <span>&amp;H3B8F0489</span><span>,</span> <span>&amp;H83EF7CD6</span><span>,</span> <span>&amp;H1076013F</span></td>
        </tr>
        <tr>
          <td id="L7641" data-line-number="7641"></td>
          <td id="LC7641">    <span>pvAppendBuffer</span> <span>&amp;H3C83078B</span><span>,</span> <span>&amp;H8750087</span><span>,</span> <span>&amp;H83078948</span><span>,</span> <span>&amp;HF07701F8</span><span>,</span> <span>&amp;H8BF075FF</span><span>,</span> <span>&amp;HE8530C5D</span><span>,</span> <span>&amp;H1913</span><span>&amp;,</span> <span>&amp;HFFA658E8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;HEC75FF08</span><span>,</span> <span>&amp;H53085D8B</span><span>,</span> <span>&amp;H18FEE8</span><span>,</span> <span>&amp;HA643E800</span><span>,</span> <span>&amp;HFF53FFFF</span><span>,</span> <span>&amp;H75FF0850</span><span>,</span> <span>&amp;H105D8BE8</span><span>,</span> <span>&amp;H18E9E853</span><span>,</span> <span>&amp;H2EE80000</span><span>,</span> <span>&amp;H53FFFFA6</span><span>,</span> <span>&amp;H8B0850FF</span><span>,</span> <span>&amp;H5D8BE475</span><span>,</span> <span>&amp;HE85356FC</span><span>,</span> <span>&amp;H18D3</span><span>&amp;,</span> <span>&amp;HFFA618E8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;HF85D8B08</span><span>,</span> <span>&amp;HC0E85356</span><span>,</span> <span>&amp;HE8000018</span><span>,</span> <span>&amp;HFFFFA605</span><span>,</span> <span>&amp;H850FF53</span><span>,</span> <span>&amp;H5E5FC78B</span><span>,</span> <span>&amp;H5DE58B5B</span></td>
        </tr>
        <tr>
          <td id="L7642" data-line-number="7642"></td>
          <td id="LC7642">    <span>pvAppendBuffer</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H5D8B532C</span><span>,</span> <span>&amp;H4438D10</span><span>,</span> <span>&amp;H890100F6</span><span>,</span> <span>&amp;H1175E045</span><span>,</span> <span>&amp;HC75FF53</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;H36A</span><span>&amp;,</span> <span>&amp;H35EE9</span><span>,</span> <span>&amp;H53575600</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;HFFFFB7B4</span><span>,</span> <span>&amp;HF08B1B8B</span><span>,</span> <span>&amp;H5D89CB8B</span><span>,</span> <span>&amp;H5E1C1DC</span><span>,</span> <span>&amp;HBC2EE851</span><span>,</span> <span>&amp;HF88BFFFF</span><span>,</span> <span>&amp;H1075FF57</span><span>,</span> <span>&amp;HFFFB91E8</span><span>,</span> <span>&amp;H1075FFFF</span><span>,</span> <span>&amp;H57084589</span><span>,</span> <span>&amp;HFD7DE856</span><span>,</span> <span>&amp;H8956FFFF</span><span>,</span> <span>&amp;H69E8F045</span><span>,</span> <span>&amp;HFFFFFFEE</span><span>,</span> <span>&amp;HE8571075</span><span>,</span> <span>&amp;HFFFFB778</span><span>,</span> <span>&amp;HFC458957</span><span>,</span> <span>&amp;HFFEE57E8</span><span>,</span> <span>&amp;HC1FB8BFF</span><span>,</span> <span>&amp;H7D8902E7</span></td>
        </tr>
        <tr>
          <td id="L7643" data-line-number="7643"></td>
          <td id="LC7643">    <span>pvAppendBuffer</span> <span>&amp;HA573E8D8</span><span>,</span> <span>&amp;HFF57FFFF</span><span>,</span> <span>&amp;HEC458910</span><span>,</span> <span>&amp;H197EDB85</span><span>,</span> <span>&amp;H8DE04D8B</span><span>,</span> <span>&amp;HD003FC57</span><span>,</span> <span>&amp;H18BF38B</span><span>,</span> <span>&amp;H8904498D</span><span>,</span> <span>&amp;HFC528D02</span><span>,</span> <span>&amp;H7501EE83</span><span>,</span> <span>&amp;HA54BE8F1</span><span>,</span> <span>&amp;HFF57FFFF</span><span>,</span> <span>&amp;H33F08B10</span><span>,</span> <span>&amp;HF47589C9</span><span>,</span> <span>&amp;H2D7EDB85</span><span>,</span> <span>&amp;H8308558B</span><span>,</span> <span>&amp;HC283FCC7</span><span>,</span> <span>&amp;H8BF70304</span><span>,</span> <span>&amp;HF3B087D</span><span>,</span> <span>&amp;H28B047D</span><span>,</span> <span>&amp;HC03302EB</span><span>,</span> <span>&amp;H83410689</span><span>,</span> <span>&amp;HEE8304C2</span><span>,</span> <span>&amp;H7CCB3B04</span><span>,</span> <span>&amp;HF4758BE9</span><span>,</span> <span>&amp;HE7C1FB8B</span><span>,</span> <span>&amp;H8458B02</span><span>,</span> <span>&amp;HEDDEE850</span><span>,</span> <span>&amp;H2E8FFFF</span><span>,</span> <span>&amp;H57FFFFA5</span><span>,</span> <span>&amp;HD08B10FF</span><span>,</span> <span>&amp;H85E85589</span></td>
        </tr>
        <tr>
          <td id="L7644" data-line-number="7644"></td>
          <td id="LC7644">    <span>pvAppendBuffer</span> <span>&amp;H330D7EDB</span><span>,</span> <span>&amp;H8BCB8BC0</span><span>,</span> <span>&amp;H8BABF3FA</span><span>,</span> <span>&amp;H2E7C1FB</span><span>,</span> <span>&amp;H52565653</span><span>,</span> <span>&amp;HFFF6B2E8</span><span>,</span> <span>&amp;H85C033FF</span><span>,</span> <span>&amp;H8B2D7EDB</span><span>,</span> <span>&amp;H4D8BE855</span><span>,</span> <span>&amp;HFCC283F0</span><span>,</span> <span>&amp;H304C183</span><span>,</span> <span>&amp;HF07D8BD7</span><span>,</span> <span>&amp;H47D073B</span><span>,</span> <span>&amp;H2EB318B</span><span>,</span> <span>&amp;H3289F633</span><span>,</span> <span>&amp;H4C18340</span><span>,</span> <span>&amp;H3B04EA83</span><span>,</span> <span>&amp;H8BE97CC3</span><span>,</span> <span>&amp;H2E7C1FB</span><span>,</span> <span>&amp;H51F04D8B</span><span>,</span> <span>&amp;HFFED7BE8</span><span>,</span> <span>&amp;HC1F38BFF</span><span>,</span> <span>&amp;H758903E6</span><span>,</span> <span>&amp;HA497E8E0</span><span>,</span> <span>&amp;HFF56FFFF</span><span>,</span> <span>&amp;H89F08B10</span><span>,</span> <span>&amp;H8AE80875</span><span>,</span> <span>&amp;H8BFFFFA4</span><span>,</span> <span>&amp;H3E1C1CB</span><span>,</span> <span>&amp;H3310FF51</span><span>,</span> <span>&amp;HF84589C9</span><span>,</span> <span>&amp;H2C7EDB85</span></td>
        </tr>
        <tr>
          <td id="L7645" data-line-number="7645"></td>
          <td id="LC7645">    <span>pvAppendBuffer</span> <span>&amp;H8BFC7D8B</span><span>,</span> <span>&amp;H3E0C1C3</span><span>,</span> <span>&amp;H3FCC083</span><span>,</span> <span>&amp;H4578DF0</span><span>,</span> <span>&amp;H47D0F3B</span><span>,</span> <span>&amp;H2EB028B</span><span>,</span> <span>&amp;H689C033</span><span>,</span> <span>&amp;H4C28341</span><span>,</span> <span>&amp;H3B04EE83</span><span>,</span> <span>&amp;H8BE97CCB</span><span>,</span> <span>&amp;H2E7C1FB</span><span>,</span> <span>&amp;HE8FC75FF</span><span>,</span> <span>&amp;HFFFFED1C</span><span>,</span> <span>&amp;H699E853</span><span>,</span> <span>&amp;HF36B0000</span><span>,</span> <span>&amp;HC1F00303</span><span>,</span> <span>&amp;H758902E6</span><span>,</span> <span>&amp;HA42FE8D4</span><span>,</span> <span>&amp;HFF56FFFF</span><span>,</span> <span>&amp;HC4D8B10</span><span>,</span> <span>&amp;H4589D233</span><span>,</span> <span>&amp;H891F6AFC</span><span>,</span> <span>&amp;H18BF055</span><span>,</span> <span>&amp;H5EE44589</span><span>,</span> <span>&amp;H317EC085</span><span>,</span> <span>&amp;H3C8DD88B</span><span>,</span> <span>&amp;H8BC03399</span><span>,</span> <span>&amp;HE0D340CE</span><span>,</span> <span>&amp;H10750785</span><span>,</span> <span>&amp;H7901EE83</span><span>,</span> <span>&amp;H421F6A07</span><span>,</span> <span>&amp;H5E04EF83</span></td>
        </tr>
        <tr>
          <td id="L7646" data-line-number="7646"></td>
          <td id="LC7646">    <span>pvAppendBuffer</span> <span>&amp;HE57CD33B</span><span>,</span> <span>&amp;H8BDC5D8B</span><span>,</span> <span>&amp;HE4458BFB</span><span>,</span> <span>&amp;H890C4D8B</span><span>,</span> <span>&amp;HE7C1F055</span><span>,</span> <span>&amp;HFD03B02</span><span>,</span> <span>&amp;H978D</span><span>&amp;,</span> <span>&amp;HFF68500</span><span>,</span> <span>&amp;H8088</span><span>&amp;,</span> <span>&amp;H84D8B00</span><span>,</span> <span>&amp;H8DFC75FF</span><span>,</span> <span>&amp;HFF530F04</span><span>,</span> <span>&amp;H5050F875</span><span>,</span> <span>&amp;HFFF213E8</span><span>,</span> <span>&amp;H75FF53FF</span><span>,</span> <span>&amp;HF475FFFC</span><span>,</span> <span>&amp;HFFEC75FF</span><span>,</span> <span>&amp;HE6E8F875</span><span>,</span> <span>&amp;H8B000003</span><span>,</span> <span>&amp;HCE8B0C45</span><span>,</span> <span>&amp;HC033108B</span><span>,</span> <span>&amp;H40F0552B</span><span>,</span> <span>&amp;H4D8BE0D3</span><span>,</span> <span>&amp;H9104850C</span><span>,</span> <span>&amp;H75FF2C74</span><span>,</span> <span>&amp;HF8458BFC</span><span>,</span> <span>&amp;H875FF53</span><span>,</span> <span>&amp;H75FFC703</span><span>,</span> <span>&amp;HD5E850E8</span><span>,</span> <span>&amp;H53FFFFF1</span><span>,</span> <span>&amp;HFFFC75FF</span><span>,</span> <span>&amp;H75FFF475</span></td>
        </tr>
        <tr>
          <td id="L7647" data-line-number="7647"></td>
          <td id="LC7647">    <span>pvAppendBuffer</span> <span>&amp;H875FFEC</span><span>,</span> <span>&amp;H3A8E8</span><span>,</span> <span>&amp;H84D8B00</span><span>,</span> <span>&amp;H458B0CEB</span><span>,</span> <span>&amp;HF84D8B08</span><span>,</span> <span>&amp;H89084D89</span><span>,</span> <span>&amp;HEE83F845</span><span>,</span> <span>&amp;H8B897901</span><span>,</span> <span>&amp;H4D8BF055</span><span>,</span> <span>&amp;H1F6A420C</span><span>,</span> <span>&amp;H5EF05589</span><span>,</span> <span>&amp;H8C0F113B</span><span>,</span> <span>&amp;HFFFFFF69</span><span>,</span> <span>&amp;HFC75FF53</span><span>,</span> <span>&amp;HFFF475FF</span><span>,</span> <span>&amp;H75FFEC75</span><span>,</span> <span>&amp;H36BE808</span><span>,</span> <span>&amp;H458B0000</span><span>,</span> <span>&amp;HE830FF10</span><span>,</span> <span>&amp;H5A7</span><span>&amp;,</span> <span>&amp;HF08BD233</span><span>,</span> <span>&amp;H1E7EDB85</span><span>,</span> <span>&amp;H308458B</span><span>,</span> <span>&amp;HC4589C7</span><span>,</span> <span>&amp;HE8BF88B</span><span>,</span> <span>&amp;HCA2B078B</span><span>,</span> <span>&amp;H47F8D42</span><span>,</span> <span>&amp;H3B8E0489</span><span>,</span> <span>&amp;H8BEF7CD3</span><span>,</span> <span>&amp;H3E83D87D</span><span>,</span> <span>&amp;H8B107601</span><span>,</span> <span>&amp;H863C8306</span></td>
        </tr>
        <tr>
          <td id="L7648" data-line-number="7648"></td>
          <td id="LC7648">    <span>pvAppendBuffer</span> <span>&amp;H48087500</span><span>,</span> <span>&amp;HF8830689</span><span>,</span> <span>&amp;HFFF07701</span><span>,</span> <span>&amp;H5D8BD475</span><span>,</span> <span>&amp;H98E853FC</span><span>,</span> <span>&amp;HE8000015</span><span>,</span> <span>&amp;HFFFFA2DD</span><span>,</span> <span>&amp;H850FF53</span><span>,</span> <span>&amp;H8BE075FF</span><span>,</span> <span>&amp;HE853085D</span><span>,</span> <span>&amp;H1583</span><span>&amp;,</span> <span>&amp;HFFA2C8E8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;HE075FF08</span><span>,</span> <span>&amp;H53F85D8B</span><span>,</span> <span>&amp;H156EE8</span><span>,</span> <span>&amp;HA2B3E800</span><span>,</span> <span>&amp;HFF53FFFF</span><span>,</span> <span>&amp;H5D8B0850</span><span>,</span> <span>&amp;HE85357F4</span><span>,</span> <span>&amp;H155B</span><span>&amp;,</span> <span>&amp;HFFA2A0E8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;HEC5D8B08</span><span>,</span> <span>&amp;H48E85357</span><span>,</span> <span>&amp;HE8000015</span><span>,</span> <span>&amp;HFFFFA28D</span><span>,</span> <span>&amp;H850FF53</span><span>,</span> <span>&amp;H57E85D8B</span><span>,</span> <span>&amp;H1535E853</span><span>,</span> <span>&amp;H7AE80000</span><span>,</span> <span>&amp;H53FFFFA2</span></td>
        </tr>
        <tr>
          <td id="L7649" data-line-number="7649"></td>
          <td id="LC7649">    <span>pvAppendBuffer</span> <span>&amp;H5F0850FF</span><span>,</span> <span>&amp;H5B5EC68B</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H2CEC83EC</span><span>,</span> <span>&amp;H758B5653</span><span>,</span> <span>&amp;HFF565710</span><span>,</span> <span>&amp;H45E80875</span><span>,</span> <span>&amp;H8BFFFFB4</span><span>,</span> <span>&amp;HC1FB8B1E</span><span>,</span> <span>&amp;H458902E7</span><span>,</span> <span>&amp;HE45D89E0</span><span>,</span> <span>&amp;HE8D47D89</span><span>,</span> <span>&amp;HFFFFA241</span><span>,</span> <span>&amp;H8B10FF57</span><span>,</span> <span>&amp;H89C933D0</span><span>,</span> <span>&amp;HDB85F855</span><span>,</span> <span>&amp;H68B0F7E</span><span>,</span> <span>&amp;H48BC12B</span><span>,</span> <span>&amp;H8A048986</span><span>,</span> <span>&amp;H7CCB3B41</span><span>,</span> <span>&amp;HA21FE8F1</span><span>,</span> <span>&amp;HFF57FFFF</span><span>,</span> <span>&amp;HE0758B10</span><span>,</span> <span>&amp;HF88BD38B</span><span>,</span> <span>&amp;H2BEC7D89</span><span>,</span> <span>&amp;H7ED28516</span><span>,</span> <span>&amp;H33CA8B09</span><span>,</span> <span>&amp;H8BABF3C0</span><span>,</span> <span>&amp;H68BEC7D</span><span>,</span> <span>&amp;HC085C933</span><span>,</span> <span>&amp;H148D147E</span></td>
        </tr>
        <tr>
          <td id="L7650" data-line-number="7650"></td>
          <td id="LC7650">    <span>pvAppendBuffer</span> <span>&amp;H41C12B97</span><span>,</span> <span>&amp;H8986048B</span><span>,</span> <span>&amp;H4528D02</span><span>,</span> <span>&amp;HC83B068B</span><span>,</span> <span>&amp;HFB8BEF7C</span><span>,</span> <span>&amp;H8903E7C1</span><span>,</span> <span>&amp;HDAE8DC7D</span><span>,</span> <span>&amp;H57FFFFA1</span><span>,</span> <span>&amp;HF08B10FF</span><span>,</span> <span>&amp;HE8F47589</span><span>,</span> <span>&amp;HFFFFA1CD</span><span>,</span> <span>&amp;H8910FF57</span><span>,</span> <span>&amp;H48D0845</span><span>,</span> <span>&amp;H7EC0851B</span><span>,</span> <span>&amp;H8BC88B0D</span><span>,</span> <span>&amp;HF3C033FE</span><span>,</span> <span>&amp;HC1FB8BAB</span><span>,</span> <span>&amp;HC75303E7</span><span>,</span> <span>&amp;H1FC3744</span><span>,</span> <span>&amp;HE8000000</span><span>,</span> <span>&amp;H3FF</span><span>&amp;,</span> <span>&amp;HE6C1F08B</span><span>,</span> <span>&amp;HD8758902</span><span>,</span> <span>&amp;HFFA198E8</span><span>,</span> <span>&amp;H10FF56FF</span><span>,</span> <span>&amp;H330C4D8B</span><span>,</span> <span>&amp;HF04589F6</span><span>,</span> <span>&amp;H75891F6A</span><span>,</span> <span>&amp;H5F018BFC</span><span>,</span> <span>&amp;H267EC085</span><span>,</span> <span>&amp;H8B81148D</span><span>,</span> <span>&amp;H8BC033D9</span></td>
        </tr>
        <tr>
          <td id="L7651" data-line-number="7651"></td>
          <td id="LC7651">    <span>pvAppendBuffer</span> <span>&amp;HE0D340CF</span><span>,</span> <span>&amp;H10750285</span><span>,</span> <span>&amp;H7901EF83</span><span>,</span> <span>&amp;H461F6A07</span><span>,</span> <span>&amp;H5F04EA83</span><span>,</span> <span>&amp;HE57C333B</span><span>,</span> <span>&amp;H89E45D8B</span><span>,</span> <span>&amp;H758BFC75</span><span>,</span> <span>&amp;H56368BF8</span><span>,</span> <span>&amp;HFFB79FE8</span><span>,</span> <span>&amp;HE84589FF</span><span>,</span> <span>&amp;H1874C085</span><span>,</span> <span>&amp;HE6D3C88B</span><span>,</span> <span>&amp;H7E01FB83</span><span>,</span> <span>&amp;H59206A0F</span><span>,</span> <span>&amp;H458BC82B</span><span>,</span> <span>&amp;H4408BF8</span><span>,</span> <span>&amp;HF00BE8D3</span><span>,</span> <span>&amp;HA76E856</span><span>,</span> <span>&amp;H4D8B0000</span><span>,</span> <span>&amp;HE445890C</span><span>,</span> <span>&amp;HE9FC458B</span><span>,</span> <span>&amp;H94</span><span>&amp;,</span> <span>&amp;H880FFF85</span><span>,</span> <span>&amp;H85</span><span>&amp;,</span> <span>&amp;HFFF4758B</span><span>,</span> <span>&amp;H48DF075</span><span>,</span> <span>&amp;H75FF539E</span><span>,</span> <span>&amp;HE8505008</span><span>,</span> <span>&amp;HFFFFEF54</span><span>,</span> <span>&amp;H8DE875FF</span><span>,</span> <span>&amp;H75FF1B04</span></td>
        </tr>
        <tr>
          <td id="L7652" data-line-number="7652"></td>
          <td id="LC7652">    <span>pvAppendBuffer</span> <span>&amp;H53006AE4</span><span>,</span> <span>&amp;H50F875FF</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;HFFFFECA0</span><span>,</span> <span>&amp;H8B0C458B</span><span>,</span> <span>&amp;H33108BCF</span><span>,</span> <span>&amp;HFC552BC0</span><span>,</span> <span>&amp;H8BE0D340</span><span>,</span> <span>&amp;H4850C4D</span><span>,</span> <span>&amp;HFF2F7491</span><span>,</span> <span>&amp;H458BF075</span><span>,</span> <span>&amp;HFF565308</span><span>,</span> <span>&amp;H48DEC75</span><span>,</span> <span>&amp;H11E85098</span><span>,</span> <span>&amp;HFFFFFFEF</span><span>,</span> <span>&amp;H48DE875</span><span>,</span> <span>&amp;HE475FF1B</span><span>,</span> <span>&amp;HFF53006A</span><span>,</span> <span>&amp;H5650F875</span><span>,</span> <span>&amp;HFFEC5FE8</span><span>,</span> <span>&amp;HC4D8BFF</span><span>,</span> <span>&amp;HC68B08EB</span><span>,</span> <span>&amp;H8908758B</span><span>,</span> <span>&amp;HEF830845</span><span>,</span> <span>&amp;H8B847901</span><span>,</span> <span>&amp;H7589FC45</span><span>,</span> <span>&amp;H1F6A40F4</span><span>,</span> <span>&amp;H5FFC4589</span><span>,</span> <span>&amp;H8C0F013B</span><span>,</span> <span>&amp;HFFFFFF64</span><span>,</span> <span>&amp;HFF10458B</span><span>,</span> <span>&amp;H2F5E830</span></td>
        </tr>
        <tr>
          <td id="L7653" data-line-number="7653"></td>
          <td id="LC7653">    <span>pvAppendBuffer</span> <span>&amp;HD2330000</span><span>,</span> <span>&amp;HDB85F08B</span><span>,</span> <span>&amp;H458B177E</span><span>,</span> <span>&amp;H983C8DF4</span><span>,</span> <span>&amp;H78B0E8B</span><span>,</span> <span>&amp;H8D42CA2B</span><span>,</span> <span>&amp;H489047F</span><span>,</span> <span>&amp;H7CD33B8E</span><span>,</span> <span>&amp;H13E83EF</span><span>,</span> <span>&amp;H68B1076</span><span>,</span> <span>&amp;H863C83</span><span>,</span> <span>&amp;H89480875</span><span>,</span> <span>&amp;H1F88306</span><span>,</span> <span>&amp;H7D8BF077</span><span>,</span> <span>&amp;HF45D8BDC</span><span>,</span> <span>&amp;HECE85357</span><span>,</span> <span>&amp;HE8000012</span><span>,</span> <span>&amp;HFFFFA031</span><span>,</span> <span>&amp;H850FF53</span><span>,</span> <span>&amp;H8BD875FF</span><span>,</span> <span>&amp;HE853F05D</span><span>,</span> <span>&amp;H12D7</span><span>&amp;,</span> <span>&amp;HFFA01CE8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;H85D8B08</span><span>,</span> <span>&amp;HC4E85357</span><span>,</span> <span>&amp;HE8000012</span><span>,</span> <span>&amp;HFFFFA009</span><span>,</span> <span>&amp;H850FF53</span><span>,</span> <span>&amp;H8BD45D8B</span><span>,</span> <span>&amp;H5753F87D</span><span>,</span> <span>&amp;H12AEE8</span></td>
        </tr>
        <tr>
          <td id="L7654" data-line-number="7654"></td>
          <td id="LC7654">    <span>pvAppendBuffer</span> <span>&amp;H9FF3E800</span><span>,</span> <span>&amp;HFF57FFFF</span><span>,</span> <span>&amp;H8B530850</span><span>,</span> <span>&amp;HE853EC5D</span><span>,</span> <span>&amp;H129B</span><span>&amp;,</span> <span>&amp;HFF9FE0E8</span><span>,</span> <span>&amp;H50FF53FF</span><span>,</span> <span>&amp;HE0458B08</span><span>,</span> <span>&amp;HE8AAE850</span><span>,</span> <span>&amp;H8B5FFFFF</span><span>,</span> <span>&amp;H8B5B5EC6</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5308458B</span><span>,</span> <span>&amp;H56145D8B</span><span>,</span> <span>&amp;H187D8B57</span><span>,</span> <span>&amp;H8D0CF76B</span><span>,</span> <span>&amp;H4589B804</span><span>,</span> <span>&amp;H56F30314</span><span>,</span> <span>&amp;H75FF5357</span><span>,</span> <span>&amp;H39E85010</span><span>,</span> <span>&amp;H56FFFFF0</span><span>,</span> <span>&amp;H8D18758B</span><span>,</span> <span>&amp;H5756BB3C</span><span>,</span> <span>&amp;H530C75FF</span><span>,</span> <span>&amp;HFFEDE3E8</span><span>,</span> <span>&amp;H85D8BFF</span><span>,</span> <span>&amp;H5036048D</span><span>,</span> <span>&amp;HE8535753</span><span>,</span> <span>&amp;HFFFFEA6D</span><span>,</span> <span>&amp;H3314558B</span><span>,</span> <span>&amp;H104589C9</span></td>
        </tr>
        <tr>
          <td id="L7655" data-line-number="7655"></td>
          <td id="LC7655">    <span>pvAppendBuffer</span> <span>&amp;HF685F98B</span><span>,</span> <span>&amp;H48B167E</span><span>,</span> <span>&amp;H8D0289BB</span><span>,</span> <span>&amp;HC890452</span><span>,</span> <span>&amp;HFE3B47BB</span><span>,</span> <span>&amp;H558BF07C</span><span>,</span> <span>&amp;H10458B14</span><span>,</span> <span>&amp;H2A75C085</span><span>,</span> <span>&amp;H267EF685</span><span>,</span> <span>&amp;H8B0C5D8B</span><span>,</span> <span>&amp;H3B078BFA</span><span>,</span> <span>&amp;H8758B04</span><span>,</span> <span>&amp;H4C78341</span><span>,</span> <span>&amp;HF17CCE3B</span><span>,</span> <span>&amp;HE7DCE3B</span><span>,</span> <span>&amp;H8D087D8B</span><span>,</span> <span>&amp;H48B3104</span><span>,</span> <span>&amp;H8B043B87</span><span>,</span> <span>&amp;H52560B76</span><span>,</span> <span>&amp;H520C75FF</span><span>,</span> <span>&amp;HFFF0F6E8</span><span>,</span> <span>&amp;H5B5E5FFF</span><span>,</span> <span>&amp;H14C25D</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;H108EC</span><span>,</span> <span>&amp;HF8A58300</span><span>,</span> <span>&amp;HFFFFFE</span><span>,</span> <span>&amp;HFEFCA583</span><span>,</span> <span>&amp;H8B00FFFF</span><span>,</span> <span>&amp;H57560C45</span><span>,</span> <span>&amp;H8D593C6A</span><span>,</span> <span>&amp;HFFFEF8B5</span></td>
        </tr>
        <tr>
          <td id="L7656" data-line-number="7656"></td>
          <td id="LC7656">    <span>pvAppendBuffer</span> <span>&amp;HF845C7FF</span><span>,</span> <span>&amp;H10&amp;</span><span>,</span> <span>&amp;HFF00BD8D</span><span>,</span> <span>&amp;HA5F3FFFF</span><span>,</span> <span>&amp;HFEF8B58D</span><span>,</span> <span>&amp;HCE8BFFFF</span><span>,</span> <span>&amp;H2BFC7589</span><span>,</span> <span>&amp;HC4589C1</span><span>,</span> <span>&amp;H300C8B53</span><span>,</span> <span>&amp;H448BFE8B</span><span>,</span> <span>&amp;HDB330430</span><span>,</span> <span>&amp;H8910758B</span><span>,</span> <span>&amp;H4589F44D</span><span>,</span> <span>&amp;HFF5150F0</span><span>,</span> <span>&amp;HFF04DE74</span><span>,</span> <span>&amp;H1EE8DE34</span><span>,</span> <span>&amp;H1FFFFAC</span><span>,</span> <span>&amp;HF44D8B07</span><span>,</span> <span>&amp;H43045711</span><span>,</span> <span>&amp;H8DF0458B</span><span>,</span> <span>&amp;HFB83087F</span><span>,</span> <span>&amp;H8BDE7210</span><span>,</span> <span>&amp;H458BFC75</span><span>,</span> <span>&amp;H8C6830C</span><span>,</span> <span>&amp;H1F86D83</span><span>,</span> <span>&amp;H75FC7589</span><span>,</span> <span>&amp;H5BF633B8</span><span>,</span> <span>&amp;H266A006A</span><span>,</span> <span>&amp;H7CF5B4FF</span><span>,</span> <span>&amp;HFFFFFFFF</span><span>,</span> <span>&amp;HFF78F5B4</span><span>,</span> <span>&amp;HDEE8FFFF</span></td>
        </tr>
        <tr>
          <td id="L7657" data-line-number="7657"></td>
          <td id="LC7657">    <span>pvAppendBuffer</span> <span>&amp;H1FFFFAB</span><span>,</span> <span>&amp;HFEF8F584</span><span>,</span> <span>&amp;H9411FFFF</span><span>,</span> <span>&amp;HFFFEFCF5</span><span>,</span> <span>&amp;HFE8346FF</span><span>,</span> <span>&amp;H8BD5720F</span><span>,</span> <span>&amp;HB58D087D</span><span>,</span> <span>&amp;HFFFFFEF8</span><span>,</span> <span>&amp;HFF59206A</span><span>,</span> <span>&amp;HA5F30875</span><span>,</span> <span>&amp;HFFB4F2E8</span><span>,</span> <span>&amp;H875FFFF</span><span>,</span> <span>&amp;HFFB4EAE8</span><span>,</span> <span>&amp;H8B5E5FFF</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5310EC83</span><span>,</span> <span>&amp;HDB335756</span><span>,</span> <span>&amp;HC75FF53</span><span>,</span> <span>&amp;H1475FF53</span><span>,</span> <span>&amp;HFFAB8CE8</span><span>,</span> <span>&amp;H75FF53FF</span><span>,</span> <span>&amp;HF045890C</span><span>,</span> <span>&amp;HFF53F28B</span><span>,</span> <span>&amp;H7AE81875</span><span>,</span> <span>&amp;H53FFFFAB</span><span>,</span> <span>&amp;H891075FF</span><span>,</span> <span>&amp;HFA8BF445</span><span>,</span> <span>&amp;H1875FF53</span><span>,</span> <span>&amp;HFFAB68E8</span><span>,</span> <span>&amp;H75FF53FF</span><span>,</span> <span>&amp;HFC458910</span></td>
        </tr>
        <tr>
          <td id="L7658" data-line-number="7658"></td>
          <td id="LC7658">    <span>pvAppendBuffer</span> <span>&amp;H1475FF53</span><span>,</span> <span>&amp;HE8F85589</span><span>,</span> <span>&amp;HFFFFAB55</span><span>,</span> <span>&amp;H458BD88B</span><span>,</span> <span>&amp;H6ADE03F4</span><span>,</span> <span>&amp;HD6135E00</span><span>,</span> <span>&amp;HD713D803</span><span>,</span> <span>&amp;HD77D73B</span><span>,</span> <span>&amp;HD83B0472</span><span>,</span> <span>&amp;H75010773</span><span>,</span> <span>&amp;HF85583FC</span><span>,</span> <span>&amp;H8458B01</span><span>,</span> <span>&amp;H4D0BC933</span><span>,</span> <span>&amp;H5FDE0BF0</span><span>,</span> <span>&amp;H3308895E</span><span>,</span> <span>&amp;HFC5503C9</span><span>,</span> <span>&amp;H13045889</span><span>,</span> <span>&amp;H5089F84D</span><span>,</span> <span>&amp;HC488908</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550014C2</span><span>,</span> <span>&amp;H4D8BEC8B</span><span>,</span> <span>&amp;HF6335608</span><span>,</span> <span>&amp;HC18B0DEB</span><span>,</span> <span>&amp;HD1C22B99</span><span>,</span> <span>&amp;H41C82BF8</span><span>,</span> <span>&amp;H838E348D</span><span>,</span> <span>&amp;HEE7F32F9</span><span>,</span> <span>&amp;H5D5EC68B</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H8B53EC8B</span><span>,</span> <span>&amp;H5756085D</span></td>
        </tr>
        <tr>
          <td id="L7659" data-line-number="7659"></td>
          <td id="LC7659">    <span>pvAppendBuffer</span> <span>&amp;H49D348D</span><span>,</span> <span>&amp;HE8000000</span><span>,</span> <span>&amp;HFFFF9D6D</span><span>,</span> <span>&amp;H5610FF56</span><span>,</span> <span>&amp;H6AF88B</span><span>,</span> <span>&amp;HF193E857</span><span>,</span> <span>&amp;HC483FFFF</span><span>,</span> <span>&amp;H8B1F890C</span><span>,</span> <span>&amp;H5B5E5FC7</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H8B5330EC</span><span>,</span> <span>&amp;H5756085D</span><span>,</span> <span>&amp;H75FF066A</span><span>,</span> <span>&amp;H30E8530C</span><span>,</span> <span>&amp;H6A00001E</span><span>,</span> <span>&amp;HFF206A06</span><span>,</span> <span>&amp;H458D0C75</span><span>,</span> <span>&amp;H5AE850D0</span><span>,</span> <span>&amp;H6A000012</span><span>,</span> <span>&amp;H8DF08B06</span><span>,</span> <span>&amp;H458D084B</span><span>,</span> <span>&amp;H50FA8BD0</span><span>,</span> <span>&amp;HC3835151</span><span>,</span> <span>&amp;H1123E838</span><span>,</span> <span>&amp;HC6030000</span><span>,</span> <span>&amp;H75FF066A</span><span>,</span> <span>&amp;H1303890C</span><span>,</span> <span>&amp;H8458BD7</span><span>,</span> <span>&amp;H8910C083</span><span>,</span> <span>&amp;H50500453</span><span>,</span> <span>&amp;H1108E8</span></td>
        </tr>
        <tr>
          <td id="L7660" data-line-number="7660"></td>
          <td id="LC7660">    <span>pvAppendBuffer</span> <span>&amp;H84D8B00</span><span>,</span> <span>&amp;H4189066A</span><span>,</span> <span>&amp;HD0458D40</span><span>,</span> <span>&amp;H89515150</span><span>,</span> <span>&amp;H93E84451</span><span>,</span> <span>&amp;H8B00001F</span><span>,</span> <span>&amp;HF003084D</span><span>,</span> <span>&amp;H518BFA13</span><span>,</span> <span>&amp;H8BD62B30</span><span>,</span> <span>&amp;HF71B3471</span><span>,</span> <span>&amp;H7234713B</span><span>,</span> <span>&amp;H3B05771D</span><span>,</span> <span>&amp;H16763051</span><span>,</span> <span>&amp;HEBFFCF83</span><span>,</span> <span>&amp;H85B8D03</span><span>,</span> <span>&amp;H7B113B01</span><span>,</span> <span>&amp;H23038B04</span><span>,</span> <span>&amp;HC73B0443</span><span>,</span> <span>&amp;H895FEF74</span><span>,</span> <span>&amp;H895E3471</span><span>,</span> <span>&amp;H8B5B3051</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H108EC81</span><span>,</span> <span>&amp;H56530000</span><span>,</span> <span>&amp;HC75FF57</span><span>,</span> <span>&amp;HFF78858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H919</span><span>&amp;,</span> <span>&amp;HFF78858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFB31F</span></td>
        </tr>
        <tr>
          <td id="L7661" data-line-number="7661"></td>
          <td id="LC7661">    <span>pvAppendBuffer</span> <span>&amp;HFF78858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFB313</span><span>,</span> <span>&amp;HFF78858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFB307</span><span>,</span> <span>&amp;HFEF89D8D</span><span>,</span> <span>&amp;H45C7FFFF</span><span>,</span> <span>&amp;H20C</span><span>&amp;,</span> <span>&amp;H8BF63300</span><span>,</span> <span>&amp;HFFFF788D</span><span>,</span> <span>&amp;H7C858BFF</span><span>,</span> <span>&amp;H81FFFFFF</span><span>,</span> <span>&amp;HFFEDE9</span><span>,</span> <span>&amp;H1B086A00</span><span>,</span> <span>&amp;HF88D89C6</span><span>,</span> <span>&amp;H89FFFFFE</span><span>,</span> <span>&amp;HFFFEFC85</span><span>,</span> <span>&amp;H548B5FFF</span><span>,</span> <span>&amp;H448BF83B</span><span>,</span> <span>&amp;H8C8BFC3B</span><span>,</span> <span>&amp;HFFFF783D</span><span>,</span> <span>&amp;HF85589FF</span><span>,</span> <span>&amp;H10C2AC0F</span><span>,</span> <span>&amp;H7C3D848B</span><span>,</span> <span>&amp;H83FFFFFF</span><span>,</span> <span>&amp;H748901E2</span><span>,</span> <span>&amp;HCA2BFC3B</span><span>,</span> <span>&amp;HE981C61B</span><span>,</span> <span>&amp;HFFFF</span><span>&amp;,</span> <span>&amp;HF83D8C89</span><span>,</span> <span>&amp;H1BFFFFFE</span></td>
        </tr>
        <tr>
          <td id="L7662" data-line-number="7662"></td>
          <td id="LC7662">    <span>pvAppendBuffer</span> <span>&amp;H3D8489C6</span><span>,</span> <span>&amp;HFFFFFEFC</span><span>,</span> <span>&amp;HF845B70F</span><span>,</span> <span>&amp;HF83B4489</span><span>,</span> <span>&amp;H8308C783</span><span>,</span> <span>&amp;HB27278FF</span><span>,</span> <span>&amp;HFF688D8B</span><span>,</span> <span>&amp;H858BFFFF</span><span>,</span> <span>&amp;HFFFFFF6C</span><span>,</span> <span>&amp;HFF0558B</span><span>,</span> <span>&amp;HF10C1AC</span><span>,</span> <span>&amp;HFF6885B7</span><span>,</span> <span>&amp;HE183FFFF</span><span>,</span> <span>&amp;H68858901</span><span>,</span> <span>&amp;H2BFFFFFF</span><span>,</span> <span>&amp;H6CB589D1</span><span>,</span> <span>&amp;H8BFFFFFF</span><span>,</span> <span>&amp;HCE1BF44D</span><span>,</span> <span>&amp;H7FFFEA81</span><span>,</span> <span>&amp;H95890000</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HC033CE1B</span><span>,</span> <span>&amp;HFF748D89</span><span>,</span> <span>&amp;HF40FFFF</span><span>,</span> <span>&amp;H8310CAAC</span><span>,</span> <span>&amp;HF9C101E2</span><span>,</span> <span>&amp;H50C22B10</span><span>,</span> <span>&amp;HFEF8858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HFFFF7885</span><span>,</span> <span>&amp;HB2E850FF</span><span>,</span> <span>&amp;H83000007</span></td>
        </tr>
        <tr>
          <td id="L7663" data-line-number="7663"></td>
          <td id="LC7663">    <span>pvAppendBuffer</span> <span>&amp;HF010C6D</span><span>,</span> <span>&amp;HFFFF1E85</span><span>,</span> <span>&amp;H8558BFF</span><span>,</span> <span>&amp;H78F5848A</span><span>,</span> <span>&amp;H8BFFFFFF</span><span>,</span> <span>&amp;HFF78F58C</span><span>,</span> <span>&amp;H488FFFF</span><span>,</span> <span>&amp;HF5848B72</span><span>,</span> <span>&amp;HFFFFFF7C</span><span>,</span> <span>&amp;H8C1AC0F</span><span>,</span> <span>&amp;H8808F8C1</span><span>,</span> <span>&amp;H4601724C</span><span>,</span> <span>&amp;H7210FE83</span><span>,</span> <span>&amp;H5B5E5FD7</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H84D8BEC</span><span>,</span> <span>&amp;H8B56D233</span><span>,</span> <span>&amp;H6A570C75</span><span>,</span> <span>&amp;H5FF12B11</span><span>,</span> <span>&amp;H30E048B</span><span>,</span> <span>&amp;HFD00301</span><span>,</span> <span>&amp;HEAC1C2B6</span><span>,</span> <span>&amp;H8D018908</span><span>,</span> <span>&amp;HEF830449</span><span>,</span> <span>&amp;H5FE97501</span><span>,</span> <span>&amp;H8C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HC75FF56</span><span>,</span> <span>&amp;H5608758B</span><span>,</span> <span>&amp;HFFFFC1E8</span><span>,</span> <span>&amp;H44468DFF</span></td>
        </tr>
        <tr>
          <td id="L7664" data-line-number="7664"></td>
          <td id="LC7664">    <span>pvAppendBuffer</span> <span>&amp;H15E85650</span><span>,</span> <span>&amp;H5E000001</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H8B5344EC</span><span>,</span> <span>&amp;H5756085D</span><span>,</span> <span>&amp;H8B59116A</span><span>,</span> <span>&amp;HBC7D8DF3</span><span>,</span> <span>&amp;HD2E8A5F3</span><span>,</span> <span>&amp;H5FFFF9A</span><span>,</span> <span>&amp;H544</span><span>&amp;,</span> <span>&amp;HBC458D50</span><span>,</span> <span>&amp;HFF88E850</span><span>,</span> <span>&amp;H458BFFFF</span><span>,</span> <span>&amp;H25D0F7FC</span><span>,</span> <span>&amp;H80</span><span>&amp;,</span> <span>&amp;H8D5E116A</span><span>,</span> <span>&amp;HD0F7FF50</span><span>,</span> <span>&amp;HC11FEAC1</span><span>,</span> <span>&amp;HD0231FE8</span><span>,</span> <span>&amp;HF7BC458D</span><span>,</span> <span>&amp;H89C32BD2</span><span>,</span> <span>&amp;H7A8D0845</span><span>,</span> <span>&amp;H8BD7F701</span><span>,</span> <span>&amp;H428D180C</span><span>,</span> <span>&amp;H23032301</span><span>,</span> <span>&amp;H8BC80BCF</span><span>,</span> <span>&amp;HB890845</span><span>,</span> <span>&amp;H83045B8D</span><span>,</span> <span>&amp;HE77501EE</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H4C25DE5</span></td>
        </tr>
        <tr>
          <td id="L7665" data-line-number="7665"></td>
          <td id="LC7665">    <span>pvAppendBuffer</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8D44EC83</span><span>,</span> <span>&amp;H6A56BC45</span><span>,</span> <span>&amp;H56F63344</span><span>,</span> <span>&amp;HEE97E850</span><span>,</span> <span>&amp;H4D8BFFFF</span><span>,</span> <span>&amp;HCC48308</span><span>,</span> <span>&amp;HA8918B</span><span>,</span> <span>&amp;HD2850000</span><span>,</span> <span>&amp;HB60F1174</span><span>,</span> <span>&amp;H983184</span><span>,</span> <span>&amp;H44890000</span><span>,</span> <span>&amp;H3B46BCB5</span><span>,</span> <span>&amp;H8DEF72F2</span><span>,</span> <span>&amp;H44C7BC45</span><span>,</span> <span>&amp;H1BC95</span><span>,</span> <span>&amp;H51500000</span><span>,</span> <span>&amp;HFFFF24E8</span><span>,</span> <span>&amp;HE58B5EFF</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H8BEC8B55</span><span>,</span> <span>&amp;H3356084D</span><span>,</span> <span>&amp;HD68B57F6</span><span>,</span> <span>&amp;H1403FE8B</span><span>,</span> <span>&amp;HC2B60FB9</span><span>,</span> <span>&amp;H8908EAC1</span><span>,</span> <span>&amp;H8347B904</span><span>,</span> <span>&amp;HEE7C10FF</span><span>,</span> <span>&amp;H8B405103</span><span>,</span> <span>&amp;H2EAC1C2</span><span>,</span> <span>&amp;H6B03E083</span><span>,</span> <span>&amp;H418905D2</span></td>
        </tr>
        <tr>
          <td id="L7666" data-line-number="7666"></td>
          <td id="LC7666">    <span>pvAppendBuffer</span> <span>&amp;HB1140340</span><span>,</span> <span>&amp;HC1C2B60F</span><span>,</span> <span>&amp;H48908EA</span><span>,</span> <span>&amp;HFE8346B1</span><span>,</span> <span>&amp;H1EE7C10</span><span>,</span> <span>&amp;H5E5F4051</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H8B534CEC</span><span>,</span> <span>&amp;H458D0C5D</span><span>,</span> <span>&amp;H2BD233B4</span><span>,</span> <span>&amp;H895756D8</span><span>,</span> <span>&amp;HFF33FC5D</span><span>,</span> <span>&amp;HD285C933</span><span>,</span> <span>&amp;H48D1E78</span><span>,</span> <span>&amp;H85D8B93</span><span>,</span> <span>&amp;H3B4758D</span><span>,</span> <span>&amp;H8B048BF0</span><span>,</span> <span>&amp;H8D06AF0F</span><span>,</span> <span>&amp;HF803FC76</span><span>,</span> <span>&amp;H7ECA3B41</span><span>,</span> <span>&amp;HFC5D8BF0</span><span>,</span> <span>&amp;H8901728D</span><span>,</span> <span>&amp;HCE8BF875</span><span>,</span> <span>&amp;H7D11FE83</span><span>,</span> <span>&amp;H85D8B2D</span><span>,</span> <span>&amp;HC62BC28B</span><span>,</span> <span>&amp;H830C758B</span><span>,</span> <span>&amp;H348D44C6</span><span>,</span> <span>&amp;H8B048B86</span><span>,</span> <span>&amp;H8D06AF0F</span><span>,</span> <span>&amp;HC069FC76</span></td>
        </tr>
        <tr>
          <td id="L7667" data-line-number="7667"></td>
          <td id="LC7667">    <span>pvAppendBuffer</span> <span>&amp;H140&amp;</span><span>,</span> <span>&amp;H8341F803</span><span>,</span> <span>&amp;HE97C11F9</span><span>,</span> <span>&amp;H8BF8758B</span><span>,</span> <span>&amp;H7C89FC5D</span><span>,</span> <span>&amp;HD68BB495</span><span>,</span> <span>&amp;H7C11FA83</span><span>,</span> <span>&amp;HB4458D95</span><span>,</span> <span>&amp;HFF2AE850</span><span>,</span> <span>&amp;H7D8BFFFF</span><span>,</span> <span>&amp;HB4758D08</span><span>,</span> <span>&amp;HF359116A</span><span>,</span> <span>&amp;H5B5E5FA5</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;HC558BEC</span><span>,</span> <span>&amp;H3344EC83</span><span>,</span> <span>&amp;H4B60FC9</span><span>,</span> <span>&amp;H8D448911</span><span>,</span> <span>&amp;HF98341BC</span><span>,</span> <span>&amp;H8DF27C10</span><span>,</span> <span>&amp;H45C7BC45</span><span>,</span> <span>&amp;H1FC</span><span>&amp;,</span> <span>&amp;H75FF5000</span><span>,</span> <span>&amp;HFE07E808</span><span>,</span> <span>&amp;HE58BFFFF</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H81EC8B55</span><span>,</span> <span>&amp;H178EC</span><span>,</span> <span>&amp;H57565300</span><span>,</span> <span>&amp;H7D8DC033</span><span>,</span> <span>&amp;H88DB33B1</span></td>
        </tr>
        <tr>
          <td id="L7668" data-line-number="7668"></td>
          <td id="LC7668">    <span>pvAppendBuffer</span> <span>&amp;H6AABB05D</span><span>,</span> <span>&amp;HC75FF0C</span><span>,</span> <span>&amp;HAB66ABAB</span><span>,</span> <span>&amp;HB4458DAA</span><span>,</span> <span>&amp;HECF2E850</span><span>,</span> <span>&amp;HC483FFFF</span><span>,</span> <span>&amp;HD05D880C</span><span>,</span> <span>&amp;H7D8DC033</span><span>,</span> <span>&amp;H59076AD1</span><span>,</span> <span>&amp;H46AABF3</span><span>,</span> <span>&amp;H8DAAAB66</span><span>,</span> <span>&amp;H6A50B045</span><span>,</span> <span>&amp;H875FF20</span><span>,</span> <span>&amp;HFF34858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFC040</span><span>,</span> <span>&amp;H458D206A</span><span>,</span> <span>&amp;H8D5050D0</span><span>,</span> <span>&amp;HFFFF3485</span><span>,</span> <span>&amp;H10E850FF</span><span>,</span> <span>&amp;H8DFFFFBB</span><span>,</span> <span>&amp;H8D50E045</span><span>,</span> <span>&amp;H8D50D045</span><span>,</span> <span>&amp;HFFFE8885</span><span>,</span> <span>&amp;HD7E850FF</span><span>,</span> <span>&amp;H6AFFFFCA</span><span>,</span> <span>&amp;HC0335908</span><span>,</span> <span>&amp;HF3D07D8D</span><span>,</span> <span>&amp;HD0458AAB</span><span>,</span> <span>&amp;H458D206A</span><span>,</span> <span>&amp;H8D5050D0</span><span>,</span> <span>&amp;HFFFF3485</span></td>
        </tr>
        <tr>
          <td id="L7669" data-line-number="7669"></td>
          <td id="LC7669">    <span>pvAppendBuffer</span> <span>&amp;HDCE850FF</span><span>,</span> <span>&amp;H33FFFFBA</span><span>,</span> <span>&amp;HD07D8DC0</span><span>,</span> <span>&amp;HFF59086A</span><span>,</span> <span>&amp;HABF31475</span><span>,</span> <span>&amp;H8DD0458A</span><span>,</span> <span>&amp;H75FFF17D</span><span>,</span> <span>&amp;H88C03310</span><span>,</span> <span>&amp;HABABF05D</span><span>,</span> <span>&amp;HAAAB66AB</span><span>,</span> <span>&amp;HFE88858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFCB4A</span><span>,</span> <span>&amp;HF714458B</span><span>,</span> <span>&amp;HFE083D8</span><span>,</span> <span>&amp;HF0458D50</span><span>,</span> <span>&amp;H88858D50</span><span>,</span> <span>&amp;H50FFFFFE</span><span>,</span> <span>&amp;HFFCB31E8</span><span>,</span> <span>&amp;H1C758BFF</span><span>,</span> <span>&amp;H7D8BC033</span><span>,</span> <span>&amp;H45894018</span><span>,</span> <span>&amp;H4539560C</span><span>,</span> <span>&amp;HFF167524</span><span>,</span> <span>&amp;H858D2075</span><span>,</span> <span>&amp;HFFFFFF34</span><span>,</span> <span>&amp;H74E85057</span><span>,</span> <span>&amp;H56FFFFBA</span><span>,</span> <span>&amp;HEB2075FF</span><span>,</span> <span>&amp;H858D5701</span><span>,</span> <span>&amp;HFFFFFE88</span><span>,</span> <span>&amp;HCAFCE850</span></td>
        </tr>
        <tr>
          <td id="L7670" data-line-number="7670"></td>
          <td id="LC7670">    <span>pvAppendBuffer</span> <span>&amp;HC68BFFFF</span><span>,</span> <span>&amp;HE083D8F7</span><span>,</span> <span>&amp;H458D500F</span><span>,</span> <span>&amp;H858D50F0</span><span>,</span> <span>&amp;HFFFFFE88</span><span>,</span> <span>&amp;HCAE4E850</span><span>,</span> <span>&amp;H458DFFFF</span><span>,</span> <span>&amp;HFF5350F0</span><span>,</span> <span>&amp;HA0E81475</span><span>,</span> <span>&amp;H8D00001B</span><span>,</span> <span>&amp;H5350F845</span><span>,</span> <span>&amp;H1B95E856</span><span>,</span> <span>&amp;H106A0000</span><span>,</span> <span>&amp;H458D535B</span><span>,</span> <span>&amp;H858D50F0</span><span>,</span> <span>&amp;HFFFFFE88</span><span>,</span> <span>&amp;HCAB8E850</span><span>,</span> <span>&amp;H7D83FFFF</span><span>,</span> <span>&amp;H2C750124</span><span>,</span> <span>&amp;H8D2875FF</span><span>,</span> <span>&amp;HFFFE8885</span><span>,</span> <span>&amp;H78E850FF</span><span>,</span> <span>&amp;H6AFFFFC9</span><span>,</span> <span>&amp;H34858D7C</span><span>,</span> <span>&amp;H6AFFFFFF</span><span>,</span> <span>&amp;HC2E85000</span><span>,</span> <span>&amp;H8AFFFFEB</span><span>,</span> <span>&amp;HFFFF3485</span><span>,</span> <span>&amp;HCC483FF</span><span>,</span> <span>&amp;H73EBC033</span><span>,</span> <span>&amp;H50C0458D</span><span>,</span> <span>&amp;HFE88858D</span></td>
        </tr>
        <tr>
          <td id="L7671" data-line-number="7671"></td>
          <td id="LC7671">    <span>pvAppendBuffer</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFC94B</span><span>,</span> <span>&amp;H8D287D8B</span><span>,</span> <span>&amp;HC18BC04D</span><span>,</span> <span>&amp;HF82BD232</span><span>,</span> <span>&amp;H320F048A</span><span>,</span> <span>&amp;H41D00A01</span><span>,</span> <span>&amp;H7501EB83</span><span>,</span> <span>&amp;H187D8BF3</span><span>,</span> <span>&amp;H2075FF56</span><span>,</span> <span>&amp;H1275D284</span><span>,</span> <span>&amp;H34858D57</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFFB9AAE8</span><span>,</span> <span>&amp;HC5D21FF</span><span>,</span> <span>&amp;H23E805EB</span><span>,</span> <span>&amp;H6AFFFFEB</span><span>,</span> <span>&amp;H34858D7C</span><span>,</span> <span>&amp;H6AFFFFFF</span><span>,</span> <span>&amp;H5AE85000</span><span>,</span> <span>&amp;H8AFFFFEB</span><span>,</span> <span>&amp;HFFFF348D</span><span>,</span> <span>&amp;HC07D8DFF</span><span>,</span> <span>&amp;H330CC483</span><span>,</span> <span>&amp;HABABABC0</span><span>,</span> <span>&amp;HC04D8AAB</span><span>,</span> <span>&amp;H5F0C458B</span><span>,</span> <span>&amp;HE58B5B5E</span><span>,</span> <span>&amp;H24C25D</span><span>,</span> <span>&amp;H8BEC8B55</span><span>,</span> <span>&amp;HB60F0855</span><span>,</span> <span>&amp;H4AB60F02</span></td>
        </tr>
        <tr>
          <td id="L7672" data-line-number="7672"></td>
          <td id="LC7672">    <span>pvAppendBuffer</span> <span>&amp;H8E0C101</span><span>,</span> <span>&amp;HB60FC10B</span><span>,</span> <span>&amp;HE0C1024A</span><span>,</span> <span>&amp;HFC10B08</span><span>,</span> <span>&amp;HC1034AB6</span><span>,</span> <span>&amp;HC10B08E0</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H8BEC8B55</span><span>,</span> <span>&amp;HB60F0855</span><span>,</span> <span>&amp;HB60F0342</span><span>,</span> <span>&amp;HE0C1024A</span><span>,</span> <span>&amp;HFC10B08</span><span>,</span> <span>&amp;HC1014AB6</span><span>,</span> <span>&amp;HC10B08E0</span><span>,</span> <span>&amp;HC10AB60F</span><span>,</span> <span>&amp;HC10B08E0</span><span>,</span> <span>&amp;H4C25D</span><span>,</span> <span>&amp;H53EC8B55</span><span>,</span> <span>&amp;H33085D8B</span><span>,</span> <span>&amp;HC1CB8BD2</span><span>,</span> <span>&amp;H564110E9</span><span>,</span> <span>&amp;H8D006A57</span><span>,</span> <span>&amp;HFFFFFF81</span><span>,</span> <span>&amp;H8BF1F77F</span><span>,</span> <span>&amp;H10E6C1F0</span><span>,</span> <span>&amp;HE3F7C68B</span><span>,</span> <span>&amp;HCE03C88B</span><span>,</span> <span>&amp;HD283D1F7</span><span>,</span> <span>&amp;H83C03300</span><span>,</span> <span>&amp;HD2F701C1</span><span>,</span> <span>&amp;HC203C013</span><span>,</span> <span>&amp;HE8C1E6F7</span></td>
        </tr>
        <tr>
          <td id="L7673" data-line-number="7673"></td>
          <td id="LC7673">    <span>pvAppendBuffer</span> <span>&amp;H3FA8B1F</span><span>,</span> <span>&amp;H8BF80BFF</span><span>,</span> <span>&amp;H8BE3F7C7</span><span>,</span> <span>&amp;H3CA8BF0</span><span>,</span> <span>&amp;HBAF7</span><span>&amp;,</span> <span>&amp;H13588000</span><span>,</span> <span>&amp;H72CA3BC8</span><span>,</span> <span>&amp;H33D3F718</span><span>,</span> <span>&amp;H13F303C0</span><span>,</span> <span>&amp;H1C683C0</span><span>,</span> <span>&amp;H4900D083</span><span>,</span> <span>&amp;H3B4FC803</span><span>,</span> <span>&amp;HEBEC73CA</span><span>,</span> <span>&amp;H3D23319</span><span>,</span> <span>&amp;HEBD013F3</span><span>,</span> <span>&amp;HC9334707</span><span>,</span> <span>&amp;HC813F303</span><span>,</span> <span>&amp;HFA81D103</span><span>,</span> <span>&amp;H80000000</span><span>,</span> <span>&amp;HC78BEF72</span><span>,</span> <span>&amp;H5D5B5E5F</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H458BEC8B</span><span>,</span> <span>&amp;HC558B08</span><span>,</span> <span>&amp;H406A5756</span><span>,</span> <span>&amp;H104D2B59</span><span>,</span> <span>&amp;HFFA397E8</span><span>,</span> <span>&amp;H104D8BFF</span><span>,</span> <span>&amp;H458BF08B</span><span>,</span> <span>&amp;H8BFA8B08</span><span>,</span> <span>&amp;HA4E80C55</span><span>,</span> <span>&amp;HBFFFFA3</span></td>
        </tr>
        <tr>
          <td id="L7674" data-line-number="7674"></td>
          <td id="LC7674">    <span>pvAppendBuffer</span> <span>&amp;H5FD70BC6</span><span>,</span> <span>&amp;HCC25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H5324EC83</span><span>,</span> <span>&amp;H7D8B5756</span><span>,</span> <span>&amp;H75FF5708</span><span>,</span> <span>&amp;HAA95E80C</span><span>,</span> <span>&amp;HFF57FFFF</span><span>,</span> <span>&amp;H45891075</span><span>,</span> <span>&amp;HAA89E808</span><span>,</span> <span>&amp;HFF57FFFF</span><span>,</span> <span>&amp;H45891475</span><span>,</span> <span>&amp;HAA7DE80C</span><span>,</span> <span>&amp;HF78BFFFF</span><span>,</span> <span>&amp;HD1F04589</span><span>,</span> <span>&amp;H75FF56EE</span><span>,</span> <span>&amp;HAA6DE818</span><span>,</span> <span>&amp;HFF56FFFF</span><span>,</span> <span>&amp;HD88B1C75</span><span>,</span> <span>&amp;HE8EC5D89</span><span>,</span> <span>&amp;HFFFFAA5F</span><span>,</span> <span>&amp;H2075FF56</span><span>,</span> <span>&amp;HE8104589</span><span>,</span> <span>&amp;HFFFFAA53</span><span>,</span> <span>&amp;HE8458953</span><span>,</span> <span>&amp;HFFCCE6E8</span><span>,</span> <span>&amp;H458950FF</span><span>,</span> <span>&amp;HCD45E81C</span><span>,</span> <span>&amp;H758BFFFF</span><span>,</span> <span>&amp;HD4E85610</span><span>,</span> <span>&amp;H50FFFFCC</span><span>,</span> <span>&amp;HE8204589</span></td>
        </tr>
        <tr>
          <td id="L7675" data-line-number="7675"></td>
          <td id="LC7675">    <span>pvAppendBuffer</span> <span>&amp;HFFFFCD33</span><span>,</span> <span>&amp;HFF1C75FF</span><span>,</span> <span>&amp;H59E80C75</span><span>,</span> <span>&amp;HFFFFFFA7</span><span>,</span> <span>&amp;H45892075</span><span>,</span> <span>&amp;HC75FFFC</span><span>,</span> <span>&amp;HFFA74BE8</span><span>,</span> <span>&amp;H75FF53FF</span><span>,</span> <span>&amp;HF84589FC</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;HFFFFEF57</span><span>,</span> <span>&amp;HF875FF56</span><span>,</span> <span>&amp;H75FFD88B</span><span>,</span> <span>&amp;H145D8908</span><span>,</span> <span>&amp;HFFEF46E8</span><span>,</span> <span>&amp;H56F08BFF</span><span>,</span> <span>&amp;H18758953</span><span>,</span> <span>&amp;HFFA96EE8</span><span>,</span> <span>&amp;H79C085FF</span><span>,</span> <span>&amp;HEC75FF19</span><span>,</span> <span>&amp;HE853F38B</span><span>,</span> <span>&amp;HFFFFA52F</span><span>,</span> <span>&amp;H89D88B56</span><span>,</span> <span>&amp;HEDE81445</span><span>,</span> <span>&amp;H8BFFFFDD</span><span>,</span> <span>&amp;H53561875</span><span>,</span> <span>&amp;HFFAA9DE8</span><span>,</span> <span>&amp;H1075FFFF</span><span>,</span> <span>&amp;HFFF44589</span><span>,</span> <span>&amp;H27E8E875</span><span>,</span> <span>&amp;H56FFFFA7</span><span>,</span> <span>&amp;H89F475FF</span></td>
        </tr>
        <tr>
          <td id="L7676" data-line-number="7676"></td>
          <td id="LC7676">    <span>pvAppendBuffer</span> <span>&amp;HE850E045</span><span>,</span> <span>&amp;HFFFFA72E</span><span>,</span> <span>&amp;H89F075FF</span><span>,</span> <span>&amp;HE850DC45</span><span>,</span> <span>&amp;HFFFFA6D4</span><span>,</span> <span>&amp;H85E44589</span><span>,</span> <span>&amp;H8B1A74FF</span><span>,</span> <span>&amp;HD88B2475</span><span>,</span> <span>&amp;HE853574F</span><span>,</span> <span>&amp;HFFFFA8CB</span><span>,</span> <span>&amp;H85460688</span><span>,</span> <span>&amp;H8BF175FF</span><span>,</span> <span>&amp;H758B145D</span><span>,</span> <span>&amp;H1C75FF18</span><span>,</span> <span>&amp;HFFDD93E8</span><span>,</span> <span>&amp;H2075FFFF</span><span>,</span> <span>&amp;HFFDD8BE8</span><span>,</span> <span>&amp;HFC75FFFF</span><span>,</span> <span>&amp;HFFDD83E8</span><span>,</span> <span>&amp;HF875FFFF</span><span>,</span> <span>&amp;HFFDD7BE8</span><span>,</span> <span>&amp;H75E853FF</span><span>,</span> <span>&amp;H56FFFFDD</span><span>,</span> <span>&amp;HFFDD6FE8</span><span>,</span> <span>&amp;HF475FFFF</span><span>,</span> <span>&amp;HFFDD67E8</span><span>,</span> <span>&amp;HE075FFFF</span><span>,</span> <span>&amp;HFFDD5FE8</span><span>,</span> <span>&amp;HDC75FFFF</span><span>,</span> <span>&amp;HFFDD57E8</span><span>,</span> <span>&amp;H875FFFF</span><span>,</span> <span>&amp;HFFDD4FE8</span></td>
        </tr>
        <tr>
          <td id="L7677" data-line-number="7677"></td>
          <td id="LC7677">    <span>pvAppendBuffer</span> <span>&amp;HC75FFFF</span><span>,</span> <span>&amp;HFFDD47E8</span><span>,</span> <span>&amp;HF075FFFF</span><span>,</span> <span>&amp;HFFDD3FE8</span><span>,</span> <span>&amp;HEC75FFFF</span><span>,</span> <span>&amp;HFFDD37E8</span><span>,</span> <span>&amp;H1075FFFF</span><span>,</span> <span>&amp;HFFDD2FE8</span><span>,</span> <span>&amp;HE875FFFF</span><span>,</span> <span>&amp;HFFDD27E8</span><span>,</span> <span>&amp;HE475FFFF</span><span>,</span> <span>&amp;HFFDD1FE8</span><span>,</span> <span>&amp;H5B5E5FFF</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550020</span><span>,</span> <span>&amp;H8B5653EC</span><span>,</span> <span>&amp;H56570875</span><span>,</span> <span>&amp;HE80C75FF</span><span>,</span> <span>&amp;HFFFFA8E7</span><span>,</span> <span>&amp;H1075FF56</span><span>,</span> <span>&amp;H5D89D88B</span><span>,</span> <span>&amp;HA8D9E80C</span><span>,</span> <span>&amp;HFF56FFFF</span><span>,</span> <span>&amp;HF88B1475</span><span>,</span> <span>&amp;HE8087D89</span><span>,</span> <span>&amp;HFFFFA8CB</span><span>,</span> <span>&amp;H89535750</span><span>,</span> <span>&amp;H10E81045</span><span>,</span> <span>&amp;H8BFFFFEE</span><span>,</span> <span>&amp;H74F685D8</span><span>,</span> <span>&amp;H187D8B15</span><span>,</span> <span>&amp;HE853564E</span></td>
        </tr>
        <tr>
          <td id="L7678" data-line-number="7678"></td>
          <td id="LC7678">    <span>pvAppendBuffer</span> <span>&amp;HFFFFA7EF</span><span>,</span> <span>&amp;H85470788</span><span>,</span> <span>&amp;H8BF175F6</span><span>,</span> <span>&amp;H75FF087D</span><span>,</span> <span>&amp;HDCBAE80C</span><span>,</span> <span>&amp;HE857FFFF</span><span>,</span> <span>&amp;HFFFFDCB4</span><span>,</span> <span>&amp;HE81075FF</span><span>,</span> <span>&amp;HFFFFDCAC</span><span>,</span> <span>&amp;HDCA6E853</span><span>,</span> <span>&amp;H5E5FFFFF</span><span>,</span> <span>&amp;H14C25D5B</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H458B5151</span><span>,</span> <span>&amp;H5D8B5310</span><span>,</span> <span>&amp;HF7564808</span><span>,</span> <span>&amp;H1045C7D0</span><span>,</span> <span>&amp;H10</span><span>&amp;,</span> <span>&amp;H7D8B5799</span><span>,</span> <span>&amp;H89DF2B0C</span><span>,</span> <span>&amp;H5589FC45</span><span>,</span> <span>&amp;H3B348BF8</span><span>,</span> <span>&amp;H43B548B</span><span>,</span> <span>&amp;H4F8B078B</span><span>,</span> <span>&amp;H23C63304</span><span>,</span> <span>&amp;HCA33FC45</span><span>,</span> <span>&amp;H33F84D23</span><span>,</span> <span>&amp;H89D133F0</span><span>,</span> <span>&amp;H54893B34</span><span>,</span> <span>&amp;H731043B</span><span>,</span> <span>&amp;H31087F8D</span><span>,</span> <span>&amp;H6D83FC4F</span></td>
        </tr>
        <tr>
          <td id="L7679" data-line-number="7679"></td>
          <td id="LC7679">    <span>pvAppendBuffer</span> <span>&amp;HD1750110</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H8B0C558B</span><span>,</span> <span>&amp;HD12B084D</span><span>,</span> <span>&amp;H5E106A56</span><span>,</span> <span>&amp;H890A048B</span><span>,</span> <span>&amp;H8498D01</span><span>,</span> <span>&amp;HFC0A448B</span><span>,</span> <span>&amp;H83FC4189</span><span>,</span> <span>&amp;HEC7501EE</span><span>,</span> <span>&amp;H8C25D5E</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H106A5653</span><span>,</span> <span>&amp;H105D395B</span><span>,</span> <span>&amp;H7D833674</span><span>,</span> <span>&amp;H5A752010</span><span>,</span> <span>&amp;H570C758B</span><span>,</span> <span>&amp;H53087D8B</span><span>,</span> <span>&amp;H31E85756</span><span>,</span> <span>&amp;H53FFFFE7</span><span>,</span> <span>&amp;H5010468D</span><span>,</span> <span>&amp;H5010478D</span><span>,</span> <span>&amp;HFFE723E8</span><span>,</span> <span>&amp;H18C483FF</span><span>,</span> <span>&amp;HFF930CE8</span><span>,</span> <span>&amp;H53105FF</span><span>,</span> <span>&amp;H47890000</span><span>,</span> <span>&amp;H2AEB5F30</span><span>,</span> <span>&amp;H5308758B</span><span>,</span> <span>&amp;H560C75FF</span></td>
        </tr>
        <tr>
          <td id="L7680" data-line-number="7680"></td>
          <td id="LC7680">    <span>pvAppendBuffer</span> <span>&amp;HFFE703E8</span><span>,</span> <span>&amp;H75FF53FF</span><span>,</span> <span>&amp;H10468D0C</span><span>,</span> <span>&amp;HE6F6E850</span><span>,</span> <span>&amp;HC483FFFF</span><span>,</span> <span>&amp;H92DFE818</span><span>,</span> <span>&amp;H2005FFFF</span><span>,</span> <span>&amp;H89000005</span><span>,</span> <span>&amp;H5B5E3046</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;H8B536CEC</span><span>,</span> <span>&amp;H5756085D</span><span>,</span> <span>&amp;HA0BFF633</span><span>,</span> <span>&amp;H8B000001</span><span>,</span> <span>&amp;H104B8B03</span><span>,</span> <span>&amp;H8BF84589</span><span>,</span> <span>&amp;H45890443</span><span>,</span> <span>&amp;H8438BF0</span><span>,</span> <span>&amp;H8BEC4589</span><span>,</span> <span>&amp;H45890C43</span><span>,</span> <span>&amp;H14438BE0</span><span>,</span> <span>&amp;H8BE84589</span><span>,</span> <span>&amp;H45891843</span><span>,</span> <span>&amp;H1C438BE4</span><span>,</span> <span>&amp;H89945D8D</span><span>,</span> <span>&amp;HDF2BF44D</span><span>,</span> <span>&amp;H89DC4589</span><span>,</span> <span>&amp;H7D89D875</span><span>,</span> <span>&amp;H10FE83D4</span><span>,</span> <span>&amp;H758B1773</span><span>,</span> <span>&amp;H71E8560C</span></td>
        </tr>
        <tr>
          <td id="L7681" data-line-number="7681"></td>
          <td id="LC7681">    <span>pvAppendBuffer</span> <span>&amp;H83FFFFFB</span><span>,</span> <span>&amp;H458904C6</span><span>,</span> <span>&amp;H3B0489FC</span><span>,</span> <span>&amp;HEB0C7589</span><span>,</span> <span>&amp;H17E8D5D</span><span>,</span> <span>&amp;H8D0FE683</span><span>,</span> <span>&amp;HE083FD47</span><span>,</span> <span>&amp;H85548B0F</span><span>,</span> <span>&amp;H83C78B94</span><span>,</span> <span>&amp;H4C8B0FE0</span><span>,</span> <span>&amp;HC18B9485</span><span>,</span> <span>&amp;H890EC0C1</span><span>,</span> <span>&amp;HC18BFC45</span><span>,</span> <span>&amp;H3107C8C1</span><span>,</span> <span>&amp;HC28BFC45</span><span>,</span> <span>&amp;H3103E9C1</span><span>,</span> <span>&amp;HCA8BFC4D</span><span>,</span> <span>&amp;HC10DC0C1</span><span>,</span> <span>&amp;HC8330FC1</span><span>,</span> <span>&amp;H330AEAC1</span><span>,</span> <span>&amp;HF8478DCA</span><span>,</span> <span>&amp;H83FC558B</span><span>,</span> <span>&amp;H7D8B0FE0</span><span>,</span> <span>&amp;H3D103D4</span><span>,</span> <span>&amp;H3948554</span><span>,</span> <span>&amp;H8994B554</span><span>,</span> <span>&amp;H5489FC55</span><span>,</span> <span>&amp;H6E894B5</span><span>,</span> <span>&amp;H8BFFFF92</span><span>,</span> <span>&amp;HD68BF475</span><span>,</span> <span>&amp;HCAC1CE8B</span><span>,</span> <span>&amp;H7C1C10B</span></td>
        </tr>
        <tr>
          <td id="L7682" data-line-number="7682"></td>
          <td id="LC7682">    <span>pvAppendBuffer</span> <span>&amp;HCE8BD133</span><span>,</span> <span>&amp;HF706C9C1</span><span>,</span> <span>&amp;HE47523D6</span><span>,</span> <span>&amp;HC8BD133</span><span>,</span> <span>&amp;H4C78338</span><span>,</span> <span>&amp;H3E8458B</span><span>,</span> <span>&amp;HF44523CA</span><span>,</span> <span>&amp;H33FC4D03</span><span>,</span> <span>&amp;H89F103F0</span><span>,</span> <span>&amp;H4D8BD47D</span><span>,</span> <span>&amp;H3D18BF8</span><span>,</span> <span>&amp;HC18BDC75</span><span>,</span> <span>&amp;HC10AC0C1</span><span>,</span> <span>&amp;HD0330DCA</span><span>,</span> <span>&amp;HC8C1C18B</span><span>,</span> <span>&amp;H8BD03302</span><span>,</span> <span>&amp;HC88BF045</span><span>,</span> <span>&amp;H33F84523</span><span>,</span> <span>&amp;H4D23F84D</span><span>,</span> <span>&amp;H8BC833EC</span><span>,</span> <span>&amp;H4589E445</span><span>,</span> <span>&amp;H8BD103DC</span><span>,</span> <span>&amp;H4D8BE845</span><span>,</span> <span>&amp;HE44589E0</span><span>,</span> <span>&amp;H458BCE03</span><span>,</span> <span>&amp;HE84589F4</span><span>,</span> <span>&amp;H89EC458B</span><span>,</span> <span>&amp;H458BE045</span><span>,</span> <span>&amp;HEC4589F0</span><span>,</span> <span>&amp;H89F8458B</span><span>,</span> <span>&amp;H48DF045</span><span>,</span> <span>&amp;HD8758B32</span></td>
        </tr>
        <tr>
          <td id="L7683" data-line-number="7683"></td>
          <td id="LC7683">    <span>pvAppendBuffer</span> <span>&amp;HF44D8946</span><span>,</span> <span>&amp;H89F84589</span><span>,</span> <span>&amp;HFF81D875</span><span>,</span> <span>&amp;H2A0</span><span>&amp;,</span> <span>&amp;HFEDF820F</span><span>,</span> <span>&amp;H5D8BFFFF</span><span>,</span> <span>&amp;H15E5F08</span><span>,</span> <span>&amp;HF0458B03</span><span>,</span> <span>&amp;H8B044301</span><span>,</span> <span>&amp;H4301EC45</span><span>,</span> <span>&amp;HE0458B08</span><span>,</span> <span>&amp;H8B0C4301</span><span>,</span> <span>&amp;H4301E845</span><span>,</span> <span>&amp;HE4458B14</span><span>,</span> <span>&amp;H1184301</span><span>,</span> <span>&amp;H458B104B</span><span>,</span> <span>&amp;H1C4301DC</span><span>,</span> <span>&amp;H5B6043FF</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;HDCEC81EC</span><span>,</span> <span>&amp;H8B000000</span><span>,</span> <span>&amp;H56530845</span><span>,</span> <span>&amp;H4488B57</span><span>,</span> <span>&amp;H8BF84D89</span><span>,</span> <span>&amp;H108B0848</span><span>,</span> <span>&amp;H8BD84D89</span><span>,</span> <span>&amp;H4D890C48</span><span>,</span> <span>&amp;H10488BEC</span><span>,</span> <span>&amp;H8BD44D89</span><span>,</span> <span>&amp;H4D891448</span><span>,</span> <span>&amp;H18488BD0</span></td>
        </tr>
        <tr>
          <td id="L7684" data-line-number="7684"></td>
          <td id="LC7684">    <span>pvAppendBuffer</span> <span>&amp;H8BB84D89</span><span>,</span> <span>&amp;H4D891C48</span><span>,</span> <span>&amp;H20488BB4</span><span>,</span> <span>&amp;H8BE84D89</span><span>,</span> <span>&amp;H4D892448</span><span>,</span> <span>&amp;H28488BFC</span><span>,</span> <span>&amp;H8BCC4D89</span><span>,</span> <span>&amp;H4D892C48</span><span>,</span> <span>&amp;H30488BC8</span><span>,</span> <span>&amp;H8BC44D89</span><span>,</span> <span>&amp;H4D893448</span><span>,</span> <span>&amp;H38488BC0</span><span>,</span> <span>&amp;H893C408B</span><span>,</span> <span>&amp;H858DAC45</span><span>,</span> <span>&amp;HFFFFFF24</span><span>,</span> <span>&amp;HB9B04D89</span><span>,</span> <span>&amp;H2A0</span><span>&amp;,</span> <span>&amp;H33E05589</span><span>,</span> <span>&amp;H89C12BD2</span><span>,</span> <span>&amp;H4D89BC55</span><span>,</span> <span>&amp;HA44589DC</span><span>,</span> <span>&amp;H7310FA83</span><span>,</span> <span>&amp;HC7D8B36</span><span>,</span> <span>&amp;H5004478D</span><span>,</span> <span>&amp;HFFF98FE8</span><span>,</span> <span>&amp;HD88B57FF</span><span>,</span> <span>&amp;H85E8F633</span><span>,</span> <span>&amp;H8BFFFFF9</span><span>,</span> <span>&amp;HF00BDC4D</span><span>,</span> <span>&amp;H83A4458B</span><span>,</span> <span>&amp;H5D8908C7</span><span>,</span> <span>&amp;HF07589F4</span></td>
        </tr>
        <tr>
          <td id="L7685" data-line-number="7685"></td>
          <td id="LC7685">    <span>pvAppendBuffer</span> <span>&amp;H890C7D89</span><span>,</span> <span>&amp;H7489081C</span><span>,</span> <span>&amp;HD6E90408</span><span>,</span> <span>&amp;H8D000000</span><span>,</span> <span>&amp;HE083FE42</span><span>,</span> <span>&amp;H8B3D6A0F</span><span>,</span> <span>&amp;HFF24C5BC</span><span>,</span> <span>&amp;HB48BFFFF</span><span>,</span> <span>&amp;HFFFF28C5</span><span>,</span> <span>&amp;H1428DFF</span><span>,</span> <span>&amp;H830FE083</span><span>,</span> <span>&amp;H57560FE2</span><span>,</span> <span>&amp;H8BA85589</span><span>,</span> <span>&amp;HFF24C58C</span><span>,</span> <span>&amp;H9C8BFFFF</span><span>,</span> <span>&amp;HFFFF28C5</span><span>,</span> <span>&amp;HE44D89FF</span><span>,</span> <span>&amp;HFFFA0EE8</span><span>,</span> <span>&amp;H56136AFF</span><span>,</span> <span>&amp;HF4458957</span><span>,</span> <span>&amp;HE8F05589</span><span>,</span> <span>&amp;HFFFFF9FF</span><span>,</span> <span>&amp;H33F44D8B</span><span>,</span> <span>&amp;HF0458BC8</span><span>,</span> <span>&amp;H6F7AC0F</span><span>,</span> <span>&amp;HC233086A</span><span>,</span> <span>&amp;H5306EEC1</span><span>,</span> <span>&amp;H33E475FF</span><span>,</span> <span>&amp;H89C633CF</span><span>,</span> <span>&amp;H4589F44D</span><span>,</span> <span>&amp;HF9D9E8F0</span><span>,</span> <span>&amp;H16AFFFF</span></td>
        </tr>
        <tr>
          <td id="L7686" data-line-number="7686"></td>
          <td id="LC7686">    <span>pvAppendBuffer</span> <span>&amp;HE475FF53</span><span>,</span> <span>&amp;HFA8BF08B</span><span>,</span> <span>&amp;HFFF9CAE8</span><span>,</span> <span>&amp;HF44D8BFF</span><span>,</span> <span>&amp;H458BF033</span><span>,</span> <span>&amp;H8BFA33E4</span><span>,</span> <span>&amp;HAC0FF055</span><span>,</span> <span>&amp;HF03307D8</span><span>,</span> <span>&amp;H8B07EBC1</span><span>,</span> <span>&amp;HFB33BC45</span><span>,</span> <span>&amp;HD713CE03</span><span>,</span> <span>&amp;H83F9C083</span><span>,</span> <span>&amp;H8C030FE0</span><span>,</span> <span>&amp;HFFFF24C5</span><span>,</span> <span>&amp;HC59413FF</span><span>,</span> <span>&amp;HFFFFFF28</span><span>,</span> <span>&amp;H3A8458B</span><span>,</span> <span>&amp;HFF24C58C</span><span>,</span> <span>&amp;H4D89FFFF</span><span>,</span> <span>&amp;HC59413F4</span><span>,</span> <span>&amp;HFFFFFF28</span><span>,</span> <span>&amp;H24C58C89</span><span>,</span> <span>&amp;H89FFFFFF</span><span>,</span> <span>&amp;H9489F055</span><span>,</span> <span>&amp;HFFFF28C5</span><span>,</span> <span>&amp;HE8758BFF</span><span>,</span> <span>&amp;H75FF296A</span><span>,</span> <span>&amp;H64E856FC</span><span>,</span> <span>&amp;H6AFFFFF9</span><span>,</span> <span>&amp;HFC75FF12</span><span>,</span> <span>&amp;HFA8BD88B</span><span>,</span> <span>&amp;HF955E856</span></td>
        </tr>
        <tr>
          <td id="L7687" data-line-number="7687"></td>
          <td id="LC7687">    <span>pvAppendBuffer</span> <span>&amp;HE6AFFFF</span><span>,</span> <span>&amp;H33FC75FF</span><span>,</span> <span>&amp;H56FA33D8</span><span>,</span> <span>&amp;HFFF946E8</span><span>,</span> <span>&amp;H33D833FF</span><span>,</span> <span>&amp;H8F5FE8FA</span><span>,</span> <span>&amp;H4D8BFFFF</span><span>,</span> <span>&amp;H8BD6F7DC</span><span>,</span> <span>&amp;HD2F7FC55</span><span>,</span> <span>&amp;H1C03276A</span><span>,</span> <span>&amp;HF875FF08</span><span>,</span> <span>&amp;H4087C13</span><span>,</span> <span>&amp;H23C47523</span><span>,</span> <span>&amp;H4D8BC055</span><span>,</span> <span>&amp;HE84D23CC</span><span>,</span> <span>&amp;H33C8458B</span><span>,</span> <span>&amp;HFC4523F1</span><span>,</span> <span>&amp;HDE03D033</span><span>,</span> <span>&amp;H13E0758B</span><span>,</span> <span>&amp;HF45D03FA</span><span>,</span> <span>&amp;HF07D1356</span><span>,</span> <span>&amp;H89B05D03</span><span>,</span> <span>&amp;H7D13A85D</span><span>,</span> <span>&amp;HE47D89AC</span><span>,</span> <span>&amp;HFFF8F2E8</span><span>,</span> <span>&amp;HFF226AFF</span><span>,</span> <span>&amp;HF88BF875</span><span>,</span> <span>&amp;HE856DA8B</span><span>,</span> <span>&amp;HFFFFF8E3</span><span>,</span> <span>&amp;H75FF1C6A</span><span>,</span> <span>&amp;H33F833F8</span><span>,</span> <span>&amp;HD4E856DA</span></td>
        </tr>
        <tr>
          <td id="L7688" data-line-number="7688"></td>
          <td id="LC7688">    <span>pvAppendBuffer</span> <span>&amp;H8BFFFFF8</span><span>,</span> <span>&amp;HDA33D84D</span><span>,</span> <span>&amp;H33EC558B</span><span>,</span> <span>&amp;HF85533F8</span><span>,</span> <span>&amp;H7533F18B</span><span>,</span> <span>&amp;HD05523E0</span><span>,</span> <span>&amp;H23EC458B</span><span>,</span> <span>&amp;H7523F845</span><span>,</span> <span>&amp;H23D033D4</span><span>,</span> <span>&amp;H458BE04D</span><span>,</span> <span>&amp;H89F133C4</span><span>,</span> <span>&amp;HF703B045</span><span>,</span> <span>&amp;H89C0458B</span><span>,</span> <span>&amp;HDA13AC45</span><span>,</span> <span>&amp;H89CC458B</span><span>,</span> <span>&amp;H458BC445</span><span>,</span> <span>&amp;HA84D8BC8</span><span>,</span> <span>&amp;H8BB84D03</span><span>,</span> <span>&amp;H5513E455</span><span>,</span> <span>&amp;HA87503B4</span><span>,</span> <span>&amp;H8BC04589</span><span>,</span> <span>&amp;H5D13E845</span><span>,</span> <span>&amp;HCC4589E4</span><span>,</span> <span>&amp;H89FC458B</span><span>,</span> <span>&amp;H558BFC55</span><span>,</span> <span>&amp;HB85589D4</span><span>,</span> <span>&amp;H89D0558B</span><span>,</span> <span>&amp;H558BB455</span><span>,</span> <span>&amp;HD45589D8</span><span>,</span> <span>&amp;H89EC558B</span><span>,</span> <span>&amp;H558BD055</span><span>,</span> <span>&amp;HD85589E0</span></td>
        </tr>
        <tr>
          <td id="L7689" data-line-number="7689"></td>
          <td id="LC7689">    <span>pvAppendBuffer</span> <span>&amp;H89F8558B</span><span>,</span> <span>&amp;H4D8BE84D</span><span>,</span> <span>&amp;HEC5589DC</span><span>,</span> <span>&amp;H8B08C183</span><span>,</span> <span>&amp;H8942BC55</span><span>,</span> <span>&amp;H7589C845</span><span>,</span> <span>&amp;HF85D89E0</span><span>,</span> <span>&amp;H89BC5589</span><span>,</span> <span>&amp;HF981DC4D</span><span>,</span> <span>&amp;H520</span><span>&amp;,</span> <span>&amp;HFDA6820F</span><span>,</span> <span>&amp;H458BFFFF</span><span>,</span> <span>&amp;HD8558B08</span><span>,</span> <span>&amp;H5FD44D8B</span><span>,</span> <span>&amp;H758B3001</span><span>,</span> <span>&amp;H45811B4</span><span>,</span> <span>&amp;H8B085001</span><span>,</span> <span>&amp;H5011EC55</span><span>,</span> <span>&amp;H1048010C</span><span>,</span> <span>&amp;H11D04D8B</span><span>,</span> <span>&amp;H558B1448</span><span>,</span> <span>&amp;H185001B8</span><span>,</span> <span>&amp;H11E84D8B</span><span>,</span> <span>&amp;H48011C70</span><span>,</span> <span>&amp;HFC4D8B20</span><span>,</span> <span>&amp;H8B244811</span><span>,</span> <span>&amp;H4801CC4D</span><span>,</span> <span>&amp;HC84D8B28</span><span>,</span> <span>&amp;H8B2C4811</span><span>,</span> <span>&amp;H4801C44D</span><span>,</span> <span>&amp;HC04D8B30</span><span>,</span> <span>&amp;H8B344811</span></td>
        </tr>
        <tr>
          <td id="L7690" data-line-number="7690"></td>
          <td id="LC7690">    <span>pvAppendBuffer</span> <span>&amp;H4801B04D</span><span>,</span> <span>&amp;HAC4D8B38</span><span>,</span> <span>&amp;HFF3C4811</span><span>,</span> <span>&amp;HC080</span><span>&amp;,</span> <span>&amp;H8B5B5E00</span><span>,</span> <span>&amp;H8C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H85D8B53</span><span>,</span> <span>&amp;HB60F5756</span><span>,</span> <span>&amp;HB60F077B</span><span>,</span> <span>&amp;HB60F0A43</span><span>,</span> <span>&amp;HB60F0B73</span><span>,</span> <span>&amp;HE7C10F53</span><span>,</span> <span>&amp;HFF80B08</span><span>,</span> <span>&amp;HF034BB6</span><span>,</span> <span>&amp;HC10D43B6</span><span>,</span> <span>&amp;HF80B08E7</span><span>,</span> <span>&amp;HF08E6C1</span><span>,</span> <span>&amp;HE7C103B6</span><span>,</span> <span>&amp;HC1F80B08</span><span>,</span> <span>&amp;HB60F08E2</span><span>,</span> <span>&amp;HF00B0E43</span><span>,</span> <span>&amp;HF08E1C1</span><span>,</span> <span>&amp;HC10143B6</span><span>,</span> <span>&amp;HF00B08E6</span><span>,</span> <span>&amp;H443B60F</span><span>,</span> <span>&amp;HB08E6C1</span><span>,</span> <span>&amp;H43B60FF0</span><span>,</span> <span>&amp;HFD00B02</span><span>,</span> <span>&amp;HC10543B6</span><span>,</span> <span>&amp;HD00B08E2</span><span>,</span> <span>&amp;H843B60F</span></td>
        </tr>
        <tr>
          <td id="L7691" data-line-number="7691"></td>
          <td id="LC7691">    <span>pvAppendBuffer</span> <span>&amp;HB08E2C1</span><span>,</span> <span>&amp;H43B60FD0</span><span>,</span> <span>&amp;H89C80B06</span><span>,</span> <span>&amp;HB60F047B</span><span>,</span> <span>&amp;HE1C10943</span><span>,</span> <span>&amp;H89C80B08</span><span>,</span> <span>&amp;HB60F0873</span><span>,</span> <span>&amp;HE1C10C43</span><span>,</span> <span>&amp;HC80B5F08</span><span>,</span> <span>&amp;H5E0C5389</span><span>,</span> <span>&amp;H5D5B0B89</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H458BEC8B</span><span>,</span> <span>&amp;H74C08508</span><span>,</span> <span>&amp;HC4D8B10</span><span>,</span> <span>&amp;H974C985</span><span>,</span> <span>&amp;H400000C6</span><span>,</span> <span>&amp;H7501E983</span><span>,</span> <span>&amp;H8C25DF7</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HFF0C75FF</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;HEDFEE808</span><span>,</span> <span>&amp;HC25DFFFF</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H10558BEC</span><span>,</span> <span>&amp;H758B5653</span><span>,</span> <span>&amp;H7D8B570C</span><span>,</span> <span>&amp;H6AF22B08</span><span>,</span> <span>&amp;H5BFA2B10</span><span>,</span> <span>&amp;H2B160C8B</span><span>,</span> <span>&amp;H16448B0A</span></td>
        </tr>
        <tr>
          <td id="L7692" data-line-number="7692"></td>
          <td id="LC7692">    <span>pvAppendBuffer</span> <span>&amp;H4421B04</span><span>,</span> <span>&amp;H8D170C89</span><span>,</span> <span>&amp;H44890852</span><span>,</span> <span>&amp;HEB83FC17</span><span>,</span> <span>&amp;H5FE57501</span><span>,</span> <span>&amp;HC25D5B5E</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;HE85756EC</span><span>,</span> <span>&amp;HFFFF8CD5</span><span>,</span> <span>&amp;HBF08758B</span><span>,</span> <span>&amp;H588</span><span>&amp;,</span> <span>&amp;HFF50C703</span><span>,</span> <span>&amp;H41E836</span><span>,</span> <span>&amp;H6890000</span><span>,</span> <span>&amp;HFF8CBCE8</span><span>,</span> <span>&amp;H50C703FF</span><span>,</span> <span>&amp;HE80476FF</span><span>,</span> <span>&amp;H2F</span><span>&amp;,</span> <span>&amp;HE8044689</span><span>,</span> <span>&amp;HFFFF8CA9</span><span>,</span> <span>&amp;HFF50C703</span><span>,</span> <span>&amp;H1CE80876</span><span>,</span> <span>&amp;H89000000</span><span>,</span> <span>&amp;H96E80846</span><span>,</span> <span>&amp;H3FFFF8C</span><span>,</span> <span>&amp;H76FF50C7</span><span>,</span> <span>&amp;H9E80C</span><span>,</span> <span>&amp;H895F0000</span><span>,</span> <span>&amp;H5D5E0C46</span><span>,</span> <span>&amp;H550004C2</span><span>,</span> <span>&amp;H558BEC8B</span><span>,</span> <span>&amp;H5D8B530C</span></td>
        </tr>
        <tr>
          <td id="L7693" data-line-number="7693"></td>
          <td id="LC7693">    <span>pvAppendBuffer</span> <span>&amp;HC1C38B08</span><span>,</span> <span>&amp;HCB8B18E8</span><span>,</span> <span>&amp;H8E9C156</span><span>,</span> <span>&amp;HFC9B60F</span><span>,</span> <span>&amp;H8B1034B6</span><span>,</span> <span>&amp;H10E8C1C3</span><span>,</span> <span>&amp;HFC0B60F</span><span>,</span> <span>&amp;HC1110CB6</span><span>,</span> <span>&amp;HB60F08E6</span><span>,</span> <span>&amp;HC60B1004</span><span>,</span> <span>&amp;HB08E0C1</span><span>,</span> <span>&amp;HCBB60FC1</span><span>,</span> <span>&amp;H5E08E0C1</span><span>,</span> <span>&amp;HCB60F5B</span><span>,</span> <span>&amp;H5DC10B11</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H5653EC8B</span><span>,</span> <span>&amp;H87D8B57</span><span>,</span> <span>&amp;H458BDB33</span><span>,</span> <span>&amp;H44B60F0C</span><span>,</span> <span>&amp;H8B990158</span><span>,</span> <span>&amp;H8BF28BC8</span><span>,</span> <span>&amp;HA40F0C45</span><span>,</span> <span>&amp;HE1C108CE</span><span>,</span> <span>&amp;H4B60F08</span><span>,</span> <span>&amp;HC8039958</span><span>,</span> <span>&amp;H13DF0C89</span><span>,</span> <span>&amp;HDF7489F2</span><span>,</span> <span>&amp;HFB834304</span><span>,</span> <span>&amp;H81D37210</span><span>,</span> <span>&amp;H7FFF7867</span><span>,</span> <span>&amp;H67830000</span></td>
        </tr>
        <tr>
          <td id="L7694" data-line-number="7694"></td>
          <td id="LC7694">    <span>pvAppendBuffer</span> <span>&amp;H5E5F007C</span><span>,</span> <span>&amp;H8C25D5B</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;H145D8B53</span><span>,</span> <span>&amp;HD233C933</span><span>,</span> <span>&amp;H6774DB85</span><span>,</span> <span>&amp;H560C458B</span><span>,</span> <span>&amp;H2B10758B</span><span>,</span> <span>&amp;H84529F0</span><span>,</span> <span>&amp;H10758957</span><span>,</span> <span>&amp;H306348B</span><span>,</span> <span>&amp;HC758930</span><span>,</span> <span>&amp;H8B10758B</span><span>,</span> <span>&amp;H748B0C7D</span><span>,</span> <span>&amp;H70130406</span><span>,</span> <span>&amp;H89F90304</span><span>,</span> <span>&amp;HF2130C7D</span><span>,</span> <span>&amp;H7D8B383B</span><span>,</span> <span>&amp;H3B057508</span><span>,</span> <span>&amp;H17740470</span><span>,</span> <span>&amp;H7704703B</span><span>,</span> <span>&amp;H8B07720E</span><span>,</span> <span>&amp;HC4D3908</span><span>,</span> <span>&amp;HC9330573</span><span>,</span> <span>&amp;H3302EB41</span><span>,</span> <span>&amp;H8BD233C9</span><span>,</span> <span>&amp;H74890C5D</span><span>,</span> <span>&amp;H758B0407</span><span>,</span> <span>&amp;H71C8910</span><span>,</span> <span>&amp;H8308C083</span><span>,</span> <span>&amp;H7501146D</span><span>,</span> <span>&amp;H8B5E5FAB</span></td>
        </tr>
        <tr>
          <td id="L7695" data-line-number="7695"></td>
          <td id="LC7695">    <span>pvAppendBuffer</span> <span>&amp;HC25D5BC1</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;HC4D8BEC</span><span>,</span> <span>&amp;H1F74C985</span><span>,</span> <span>&amp;H7D8B5756</span><span>,</span> <span>&amp;HCD0C8D08</span><span>,</span> <span>&amp;HFFFFFFFB</span><span>,</span> <span>&amp;HE9C1F78B</span><span>,</span> <span>&amp;H278302</span><span>,</span> <span>&amp;H46783</span><span>,</span> <span>&amp;HF308C783</span><span>,</span> <span>&amp;H5D5E5FA5</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H4D8BEC8B</span><span>,</span> <span>&amp;H1E98310</span><span>,</span> <span>&amp;H30785756</span><span>,</span> <span>&amp;H8B0C458B</span><span>,</span> <span>&amp;HF02B0875</span><span>,</span> <span>&amp;H8BC8148D</span><span>,</span> <span>&amp;H8B04167C</span><span>,</span> <span>&amp;H7A3B1604</span><span>,</span> <span>&amp;H72267704</span><span>,</span> <span>&amp;H77023B1F</span><span>,</span> <span>&amp;H47A3B20</span><span>,</span> <span>&amp;H4771672</span><span>,</span> <span>&amp;H1072023B</span><span>,</span> <span>&amp;H8308EA83</span><span>,</span> <span>&amp;HDB7901E9</span><span>,</span> <span>&amp;H5E5FC033</span><span>,</span> <span>&amp;HCC25D</span><span>,</span> <span>&amp;HEBFFC883</span><span>,</span> <span>&amp;H40C033F5</span></td>
        </tr>
        <tr>
          <td id="L7696" data-line-number="7696"></td>
          <td id="LC7696">    <span>pvAppendBuffer</span> <span>&amp;H8B55F0EB</span><span>,</span> <span>&amp;H39C933EC</span><span>,</span> <span>&amp;H12760C4D</span><span>,</span> <span>&amp;H8B08558B</span><span>,</span> <span>&amp;H440BCA04</span><span>,</span> <span>&amp;HD7504CA</span><span>,</span> <span>&amp;HC4D3B41</span><span>,</span> <span>&amp;HC033F172</span><span>,</span> <span>&amp;H8C25D40</span><span>,</span> <span>&amp;HEBC03300</span><span>,</span> <span>&amp;HEC8B55F8</span><span>,</span> <span>&amp;H33535151</span><span>,</span> <span>&amp;H89D38BDB</span><span>,</span> <span>&amp;H5539FC55</span><span>,</span> <span>&amp;H8B5B7614</span><span>,</span> <span>&amp;H406A084D</span><span>,</span> <span>&amp;H10452B58</span><span>,</span> <span>&amp;H8BF84589</span><span>,</span> <span>&amp;HC12B0C45</span><span>,</span> <span>&amp;HC458956</span><span>,</span> <span>&amp;H8748B57</span><span>,</span> <span>&amp;H8BD68B04</span><span>,</span> <span>&amp;HC78B083C</span><span>,</span> <span>&amp;HE8104D8B</span><span>,</span> <span>&amp;HFFFF9820</span><span>,</span> <span>&amp;HB084D8B</span><span>,</span> <span>&amp;HFC550BC3</span><span>,</span> <span>&amp;HC78B0189</span><span>,</span> <span>&amp;H8B045189</span><span>,</span> <span>&amp;HF84D8BD6</span><span>,</span> <span>&amp;HFF9826E8</span><span>,</span> <span>&amp;H84D8BFF</span></td>
        </tr>
        <tr>
          <td id="L7697" data-line-number="7697"></td>
          <td id="LC7697">    <span>pvAppendBuffer</span> <span>&amp;H458BD88B</span><span>,</span> <span>&amp;H8C1830C</span><span>,</span> <span>&amp;H1146D83</span><span>,</span> <span>&amp;H89FC5589</span><span>,</span> <span>&amp;HBD75084D</span><span>,</span> <span>&amp;HC38B5E5F</span><span>,</span> <span>&amp;H5DE58B5B</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H8B565328</span><span>,</span> <span>&amp;H8B570C75</span><span>,</span> <span>&amp;H46A087D</span><span>,</span> <span>&amp;H38E85756</span><span>,</span> <span>&amp;H8B00000B</span><span>,</span> <span>&amp;HC9332C46</span><span>,</span> <span>&amp;H8BE44589</span><span>,</span> <span>&amp;H45893046</span><span>,</span> <span>&amp;H34468BE8</span><span>,</span> <span>&amp;H8BEC4589</span><span>,</span> <span>&amp;H45893846</span><span>,</span> <span>&amp;H3C468BF0</span><span>,</span> <span>&amp;H4589046A</span><span>,</span> <span>&amp;HD8458DF4</span><span>,</span> <span>&amp;H5050016A</span><span>,</span> <span>&amp;H89D84D89</span><span>,</span> <span>&amp;H4D89DC4D</span><span>,</span> <span>&amp;HFF3BE8E0</span><span>,</span> <span>&amp;H46AFFFF</span><span>,</span> <span>&amp;H458DD88B</span><span>,</span> <span>&amp;H575750D8</span><span>,</span> <span>&amp;HFFFE0CE8</span><span>,</span> <span>&amp;H384E8BFF</span></td>
        </tr>
        <tr>
          <td id="L7698" data-line-number="7698"></td>
          <td id="LC7698">    <span>pvAppendBuffer</span> <span>&amp;H468BD803</span><span>,</span> <span>&amp;H3C568B30</span><span>,</span> <span>&amp;HE06583</span><span>,</span> <span>&amp;HF46583</span><span>,</span> <span>&amp;H33E44589</span><span>,</span> <span>&amp;H34460BC0</span><span>,</span> <span>&amp;H4589046A</span><span>,</span> <span>&amp;HD8458DE8</span><span>,</span> <span>&amp;H5050016A</span><span>,</span> <span>&amp;H89EC4D89</span><span>,</span> <span>&amp;HFAE8F055</span><span>,</span> <span>&amp;H6AFFFFFE</span><span>,</span> <span>&amp;H8DD80304</span><span>,</span> <span>&amp;H5750D845</span><span>,</span> <span>&amp;HFDCBE857</span><span>,</span> <span>&amp;HD803FFFF</span><span>,</span> <span>&amp;H8920468B</span><span>,</span> <span>&amp;H468BD845</span><span>,</span> <span>&amp;HDC458924</span><span>,</span> <span>&amp;H8928468B</span><span>,</span> <span>&amp;HC033E045</span><span>,</span> <span>&amp;H89E44589</span><span>,</span> <span>&amp;H4589E845</span><span>,</span> <span>&amp;H38468BEC</span><span>,</span> <span>&amp;H8BF04589</span><span>,</span> <span>&amp;H46A3C46</span><span>,</span> <span>&amp;H8DF44589</span><span>,</span> <span>&amp;H5750D845</span><span>,</span> <span>&amp;HFD93E857</span><span>,</span> <span>&amp;HD803FFFF</span><span>,</span> <span>&amp;H33244E8B</span><span>,</span> <span>&amp;H34568BC0</span></td>
        </tr>
        <tr>
          <td id="L7699" data-line-number="7699"></td>
          <td id="LC7699">    <span>pvAppendBuffer</span> <span>&amp;H8928460B</span><span>,</span> <span>&amp;H468BDC45</span><span>,</span> <span>&amp;HF8458930</span><span>,</span> <span>&amp;H460BC033</span><span>,</span> <span>&amp;HE045892C</span><span>,</span> <span>&amp;H8938468B</span><span>,</span> <span>&amp;H468BE845</span><span>,</span> <span>&amp;HEC45893C</span><span>,</span> <span>&amp;H460BC033</span><span>,</span> <span>&amp;H89046A20</span><span>,</span> <span>&amp;H458DF445</span><span>,</span> <span>&amp;H4D8950D8</span><span>,</span> <span>&amp;H57CA8BD8</span><span>,</span> <span>&amp;HE44D8957</span><span>,</span> <span>&amp;HE8F05589</span><span>,</span> <span>&amp;HFFFFFD49</span><span>,</span> <span>&amp;H334568B</span><span>,</span> <span>&amp;H2C4E8BD8</span><span>,</span> <span>&amp;H460BC033</span><span>,</span> <span>&amp;HDC458930</span><span>,</span> <span>&amp;H8920468B</span><span>,</span> <span>&amp;HD233E055</span><span>,</span> <span>&amp;H4D89C20B</span><span>,</span> <span>&amp;H89046AD8</span><span>,</span> <span>&amp;HC933F045</span><span>,</span> <span>&amp;H8D284E0B</span><span>,</span> <span>&amp;H5750D845</span><span>,</span> <span>&amp;HE4558957</span><span>,</span> <span>&amp;H89E85589</span><span>,</span> <span>&amp;H4D89EC55</span><span>,</span> <span>&amp;HBACE8F4</span><span>,</span> <span>&amp;H568B0000</span></td>
        </tr>
        <tr>
          <td id="L7700" data-line-number="7700"></td>
          <td id="LC7700">    <span>pvAppendBuffer</span> <span>&amp;H8BD82B24</span><span>,</span> <span>&amp;H20B13046</span><span>,</span> <span>&amp;HE86583</span><span>,</span> <span>&amp;HEC6583</span><span>,</span> <span>&amp;H8BD84589</span><span>,</span> <span>&amp;H45893446</span><span>,</span> <span>&amp;H38468BDC</span><span>,</span> <span>&amp;H8BE04589</span><span>,</span> <span>&amp;H45893C46</span><span>,</span> <span>&amp;H20468BE4</span><span>,</span> <span>&amp;HFF9676E8</span><span>,</span> <span>&amp;H2C560BFF</span><span>,</span> <span>&amp;H4589046A</span><span>,</span> <span>&amp;HD8458DF0</span><span>,</span> <span>&amp;H89575750</span><span>,</span> <span>&amp;H67E8F455</span><span>,</span> <span>&amp;H8B00000B</span><span>,</span> <span>&amp;HD82B344E</span><span>,</span> <span>&amp;H8BFC5D89</span><span>,</span> <span>&amp;H568B305E</span><span>,</span> <span>&amp;HBC03320</span><span>,</span> <span>&amp;H7E8B3846</span><span>,</span> <span>&amp;HDC458924</span><span>,</span> <span>&amp;H460BC033</span><span>,</span> <span>&amp;H89F6333C</span><span>,</span> <span>&amp;H558BE455</span><span>,</span> <span>&amp;HE045890C</span><span>,</span> <span>&amp;HB1D84D89</span><span>,</span> <span>&amp;H28428B20</span><span>,</span> <span>&amp;HE82C528B</span><span>,</span> <span>&amp;HFFFF9608</span><span>,</span> <span>&amp;HF06583</span></td>
        </tr>
        <tr>
          <td id="L7701" data-line-number="7701"></td>
          <td id="LC7701">    <span>pvAppendBuffer</span> <span>&amp;H46AF80B</span><span>,</span> <span>&amp;H8DF45D89</span><span>,</span> <span>&amp;H535BD845</span><span>,</span> <span>&amp;HE87D8950</span><span>,</span> <span>&amp;H7D8BF20B</span><span>,</span> <span>&amp;H89575708</span><span>,</span> <span>&amp;HBE8EC75</span><span>,</span> <span>&amp;H8B00000B</span><span>,</span> <span>&amp;H758B0C4D</span><span>,</span> <span>&amp;HE06583FC</span><span>,</span> <span>&amp;H83F02B00</span><span>,</span> <span>&amp;H8B00F065</span><span>,</span> <span>&amp;H45893841</span><span>,</span> <span>&amp;H3C418BD8</span><span>,</span> <span>&amp;H8BDC4589</span><span>,</span> <span>&amp;H45892441</span><span>,</span> <span>&amp;H28418BE4</span><span>,</span> <span>&amp;H8BE84589</span><span>,</span> <span>&amp;H45892C41</span><span>,</span> <span>&amp;H34418BEC</span><span>,</span> <span>&amp;HF4458953</span><span>,</span> <span>&amp;H50D8458D</span><span>,</span> <span>&amp;HCBE85757</span><span>,</span> <span>&amp;H2B00000A</span><span>,</span> <span>&amp;H531E79F0</span><span>,</span> <span>&amp;HFF8810E8</span><span>,</span> <span>&amp;H10C083FF</span><span>,</span> <span>&amp;HE8575750</span><span>,</span> <span>&amp;HFFFFFC15</span><span>,</span> <span>&amp;HEB78F003</span><span>,</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H8C25DE5</span></td>
        </tr>
        <tr>
          <td id="L7702" data-line-number="7702"></td>
          <td id="LC7702">    <span>pvAppendBuffer</span> <span>&amp;H75F68500</span><span>,</span> <span>&amp;HE8575315</span><span>,</span> <span>&amp;HFFFF87ED</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;HFFFC9EE8</span><span>,</span> <span>&amp;H1F883FF</span><span>,</span> <span>&amp;HE853DE74</span><span>,</span> <span>&amp;HFFFF87D9</span><span>,</span> <span>&amp;H5010C083</span><span>,</span> <span>&amp;H7FE85757</span><span>,</span> <span>&amp;H2B00000A</span><span>,</span> <span>&amp;H55D2EBF0</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H758B5668</span><span>,</span> <span>&amp;H66A570C</span><span>,</span> <span>&amp;H57307E8D</span><span>,</span> <span>&amp;HFFFCBDE8</span><span>,</span> <span>&amp;HFC085FF</span><span>,</span> <span>&amp;H9385</span><span>&amp;,</span> <span>&amp;H5D8D5300</span><span>,</span> <span>&amp;H83DE2B98</span><span>,</span> <span>&amp;H8D00FC65</span><span>,</span> <span>&amp;H65839845</span><span>,</span> <span>&amp;H66A00F8</span><span>,</span> <span>&amp;HFC20E850</span><span>,</span> <span>&amp;H66AFFFF</span><span>,</span> <span>&amp;H50C8458D</span><span>,</span> <span>&amp;HFFFC15E8</span><span>,</span> <span>&amp;H458D57FF</span><span>,</span> <span>&amp;H2DE85098</span><span>,</span> <span>&amp;H6AFFFFEA</span><span>,</span> <span>&amp;H3E85706</span></td>
        </tr>
        <tr>
          <td id="L7703" data-line-number="7703"></td>
          <td id="LC7703">    <span>pvAppendBuffer</span> <span>&amp;H6AFFFFFC</span><span>,</span> <span>&amp;H5EC68B09</span><span>,</span> <span>&amp;H303148B</span><span>,</span> <span>&amp;H34C8B10</span><span>,</span> <span>&amp;H4481304</span><span>,</span> <span>&amp;H13FC5503</span><span>,</span> <span>&amp;H103BF84D</span><span>,</span> <span>&amp;H483B0575</span><span>,</span> <span>&amp;H3B1C7404</span><span>,</span> <span>&amp;HF770448</span><span>,</span> <span>&amp;H103B0472</span><span>,</span> <span>&amp;H45C70973</span><span>,</span> <span>&amp;H1FC</span><span>&amp;,</span> <span>&amp;H8304EB00</span><span>,</span> <span>&amp;H8300FC65</span><span>,</span> <span>&amp;H8900F865</span><span>,</span> <span>&amp;H4488910</span><span>,</span> <span>&amp;H8308C083</span><span>,</span> <span>&amp;HBC7501EE</span><span>,</span> <span>&amp;HE857066A</span><span>,</span> <span>&amp;HFFFFFC2E</span><span>,</span> <span>&amp;H850C758B</span><span>,</span> <span>&amp;H74840FC0</span><span>,</span> <span>&amp;H5BFFFFFF</span><span>,</span> <span>&amp;H12E8066A</span><span>,</span> <span>&amp;HBFFFFF87</span><span>,</span> <span>&amp;HB0</span><span>&amp;,</span> <span>&amp;H6E816EB</span><span>,</span> <span>&amp;H3FFFF87</span><span>,</span> <span>&amp;H565650C7</span><span>,</span> <span>&amp;H9ADE8</span><span>,</span> <span>&amp;HE8066A00</span></td>
        </tr>
        <tr>
          <td id="L7704" data-line-number="7704"></td>
          <td id="LC7704">    <span>pvAppendBuffer</span> <span>&amp;HFFFF86F5</span><span>,</span> <span>&amp;H5650C703</span><span>,</span> <span>&amp;HFFFBA6E8</span><span>,</span> <span>&amp;H85066AFF</span><span>,</span> <span>&amp;H56DB7FC0</span><span>,</span> <span>&amp;HE80875FF</span><span>,</span> <span>&amp;H7D3</span><span>&amp;,</span> <span>&amp;HE58B5E5F</span><span>,</span> <span>&amp;H8C25D</span><span>,</span> <span>&amp;H83EC8B55</span><span>,</span> <span>&amp;HFF04107D</span><span>,</span> <span>&amp;H75FF0C75</span><span>,</span> <span>&amp;HE8077508</span><span>,</span> <span>&amp;HFFFFFC67</span><span>,</span> <span>&amp;HF0E805EB</span><span>,</span> <span>&amp;H5DFFFFFE</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H75FFEC8B</span><span>,</span> <span>&amp;H1075FF18</span><span>,</span> <span>&amp;HFF0C75FF</span><span>,</span> <span>&amp;HB2E80875</span><span>,</span> <span>&amp;HBFFFFFA</span><span>,</span> <span>&amp;HFF1275C2</span><span>,</span> <span>&amp;H75FF1875</span><span>,</span> <span>&amp;H875FF14</span><span>,</span> <span>&amp;HFFFB4AE8</span><span>,</span> <span>&amp;H78C085FF</span><span>,</span> <span>&amp;H1875FF11</span><span>,</span> <span>&amp;HFF1475FF</span><span>,</span> <span>&amp;H75FF0875</span><span>,</span> <span>&amp;H92CE808</span><span>,</span> <span>&amp;HC25D0000</span></td>
        </tr>
        <tr>
          <td id="L7705" data-line-number="7705"></td>
          <td id="LC7705">    <span>pvAppendBuffer</span> <span>&amp;H8B550014</span><span>,</span> <span>&amp;HC0EC81EC</span><span>,</span> <span>&amp;H56000000</span><span>,</span> <span>&amp;H5614758B</span><span>,</span> <span>&amp;HE80C75FF</span><span>,</span> <span>&amp;HFFFFFB6A</span><span>,</span> <span>&amp;H74C08556</span><span>,</span> <span>&amp;H875FF0D</span><span>,</span> <span>&amp;HFFFAE1E8</span><span>,</span> <span>&amp;H1F1E9FF</span><span>,</span> <span>&amp;H75FF0000</span><span>,</span> <span>&amp;H40858D0C</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H736E8</span><span>,</span> <span>&amp;H75FF5600</span><span>,</span> <span>&amp;H70858D10</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H726E8</span><span>,</span> <span>&amp;H458D5600</span><span>,</span> <span>&amp;HB3E850D0</span><span>,</span> <span>&amp;H83FFFFFA</span><span>,</span> <span>&amp;H8D00D465</span><span>,</span> <span>&amp;H5056A045</span><span>,</span> <span>&amp;H1D045C7</span><span>,</span> <span>&amp;HE8000000</span><span>,</span> <span>&amp;HFFFFFA9E</span><span>,</span> <span>&amp;H70858D56</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HFF40858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;HFFFFFAB7</span><span>,</span> <span>&amp;HC985C88B</span></td>
        </tr>
        <tr>
          <td id="L7706" data-line-number="7706"></td>
          <td id="LC7706">    <span>pvAppendBuffer</span> <span>&amp;H188840F</span><span>,</span> <span>&amp;H57530000</span><span>,</span> <span>&amp;HFF40858B</span><span>,</span> <span>&amp;HDB33FFFF</span><span>,</span> <span>&amp;H3301E083</span><span>,</span> <span>&amp;H56C30BFF</span><span>,</span> <span>&amp;H858D0E75</span><span>,</span> <span>&amp;HFFFFFF40</span><span>,</span> <span>&amp;H684E850</span><span>,</span> <span>&amp;H77EB0000</span><span>,</span> <span>&amp;HFF70858B</span><span>,</span> <span>&amp;HE083FFFF</span><span>,</span> <span>&amp;HC88301</span><span>,</span> <span>&amp;H858D1175</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;H668E850</span><span>,</span> <span>&amp;HECE90000</span><span>,</span> <span>&amp;H85000000</span><span>,</span> <span>&amp;H948E0FC9</span><span>,</span> <span>&amp;H8D000000</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFF40</span><span>,</span> <span>&amp;H47E85050</span><span>,</span> <span>&amp;H56000008</span><span>,</span> <span>&amp;HFF40858D</span><span>,</span> <span>&amp;HE850FFFF</span><span>,</span> <span>&amp;H63A</span><span>&amp;,</span> <span>&amp;HA0458D56</span><span>,</span> <span>&amp;HD0458D50</span><span>,</span> <span>&amp;HFA35E850</span><span>,</span> <span>&amp;HC085FFFF</span></td>
        </tr>
        <tr>
          <td id="L7707" data-line-number="7707"></td>
          <td id="LC7707">    <span>pvAppendBuffer</span> <span>&amp;HFF560E79</span><span>,</span> <span>&amp;H458D1075</span><span>,</span> <span>&amp;HE85050D0</span><span>,</span> <span>&amp;HFFFFF979</span><span>,</span> <span>&amp;HA0458D56</span><span>,</span> <span>&amp;HD0458D50</span><span>,</span> <span>&amp;HBE85050</span><span>,</span> <span>&amp;H8B000008</span><span>,</span> <span>&amp;HE083D045</span><span>,</span> <span>&amp;HC88301</span><span>,</span> <span>&amp;HFF561274</span><span>,</span> <span>&amp;H458D1075</span><span>,</span> <span>&amp;HE85050D0</span><span>,</span> <span>&amp;HFFFFF951</span><span>,</span> <span>&amp;HDA8BF88B</span><span>,</span> <span>&amp;HD0458D56</span><span>,</span> <span>&amp;H5E4E850</span><span>,</span> <span>&amp;HFB0B0000</span><span>,</span> <span>&amp;HA0840F</span><span>,</span> <span>&amp;H448B0000</span><span>,</span> <span>&amp;H4C81C8F5</span><span>,</span> <span>&amp;HCCF5</span><span>&amp;,</span> <span>&amp;H44898000</span><span>,</span> <span>&amp;H8BE9C8F5</span><span>,</span> <span>&amp;H8D000000</span><span>,</span> <span>&amp;HFFFF4085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFF70</span><span>,</span> <span>&amp;HB3E85050</span><span>,</span> <span>&amp;H56000007</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;HE850FFFF</span></td>
        </tr>
        <tr>
          <td id="L7708" data-line-number="7708"></td>
          <td id="LC7708">    <span>pvAppendBuffer</span> <span>&amp;H5A6&amp;</span><span>,</span> <span>&amp;HD0458D56</span><span>,</span> <span>&amp;HA0458D50</span><span>,</span> <span>&amp;HF9A1E850</span><span>,</span> <span>&amp;HC085FFFF</span><span>,</span> <span>&amp;HFF560E79</span><span>,</span> <span>&amp;H458D1075</span><span>,</span> <span>&amp;HE85050A0</span><span>,</span> <span>&amp;HFFFFF8E5</span><span>,</span> <span>&amp;HD0458D56</span><span>,</span> <span>&amp;HA0458D50</span><span>,</span> <span>&amp;H77E85050</span><span>,</span> <span>&amp;H8B000007</span><span>,</span> <span>&amp;HE083A045</span><span>,</span> <span>&amp;HC88301</span><span>,</span> <span>&amp;HFF561274</span><span>,</span> <span>&amp;H458D1075</span><span>,</span> <span>&amp;HE85050A0</span><span>,</span> <span>&amp;HFFFFF8BD</span><span>,</span> <span>&amp;HDA8BF88B</span><span>,</span> <span>&amp;HA0458D56</span><span>,</span> <span>&amp;H550E850</span><span>,</span> <span>&amp;HFB0B0000</span><span>,</span> <span>&amp;H448B1074</span><span>,</span> <span>&amp;H4C8198F5</span><span>,</span> <span>&amp;H9CF5</span><span>&amp;,</span> <span>&amp;H44898000</span><span>,</span> <span>&amp;H8D5698F5</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;H858D50FF</span><span>,</span> <span>&amp;HFFFFFF40</span><span>,</span> <span>&amp;HF931E850</span></td>
        </tr>
        <tr>
          <td id="L7709" data-line-number="7709"></td>
          <td id="LC7709">    <span>pvAppendBuffer</span> <span>&amp;HC88BFFFF</span><span>,</span> <span>&amp;H850FC985</span><span>,</span> <span>&amp;HFFFFFE7C</span><span>,</span> <span>&amp;H8D565B5F</span><span>,</span> <span>&amp;HFF50D045</span><span>,</span> <span>&amp;H54E80875</span><span>,</span> <span>&amp;H5E000005</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H80EC81EC</span><span>,</span> <span>&amp;H53000000</span><span>,</span> <span>&amp;H46A5756</span><span>,</span> <span>&amp;H75FF535B</span><span>,</span> <span>&amp;H48FE814</span><span>,</span> <span>&amp;HFF530000</span><span>,</span> <span>&amp;HF08B1075</span><span>,</span> <span>&amp;HFF80458D</span><span>,</span> <span>&amp;HE8500C75</span><span>,</span> <span>&amp;H34A</span><span>&amp;,</span> <span>&amp;HA0458D53</span><span>,</span> <span>&amp;H473E850</span><span>,</span> <span>&amp;HF88B0000</span><span>,</span> <span>&amp;H874FF85</span><span>,</span> <span>&amp;H100C781</span><span>,</span> <span>&amp;HCEB0000</span><span>,</span> <span>&amp;H80458D53</span><span>,</span> <span>&amp;H45BE850</span><span>,</span> <span>&amp;HF88B0000</span><span>,</span> <span>&amp;H73FE3B53</span><span>,</span> <span>&amp;H80458D0C</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;HFAE9</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7710" data-line-number="7710"></td>
          <td id="LC7710">    <span>pvAppendBuffer</span> <span>&amp;HC0458D00</span><span>,</span> <span>&amp;HF87CE850</span><span>,</span> <span>&amp;H8D53FFFF</span><span>,</span> <span>&amp;HE850E045</span><span>,</span> <span>&amp;HFFFFF872</span><span>,</span> <span>&amp;HC62BC78B</span><span>,</span> <span>&amp;HEEC1F08B</span><span>,</span> <span>&amp;HE0835306</span><span>,</span> <span>&amp;H501A743F</span><span>,</span> <span>&amp;H8D1475FF</span><span>,</span> <span>&amp;H48DC045</span><span>,</span> <span>&amp;HF6E850F0</span><span>,</span> <span>&amp;H89FFFFF8</span><span>,</span> <span>&amp;H89E0F544</span><span>,</span> <span>&amp;HEBE4F554</span><span>,</span> <span>&amp;H1475FF0F</span><span>,</span> <span>&amp;H8DC0458D</span><span>,</span> <span>&amp;HE850F004</span><span>,</span> <span>&amp;H4A3</span><span>&amp;,</span> <span>&amp;H85D8B53</span><span>,</span> <span>&amp;HF830E853</span><span>,</span> <span>&amp;H6383FFFF</span><span>,</span> <span>&amp;H3C70004</span><span>,</span> <span>&amp;H1</span><span>&amp;,</span> <span>&amp;H815E046A</span><span>,</span> <span>&amp;H100FF</span><span>,</span> <span>&amp;H56117700</span><span>,</span> <span>&amp;H8D1475FF</span><span>,</span> <span>&amp;HE850C045</span><span>,</span> <span>&amp;HFFFFF83B</span><span>,</span> <span>&amp;H7978C085</span><span>,</span> <span>&amp;HA0458D56</span></td>
        </tr>
        <tr>
          <td id="L7711" data-line-number="7711"></td>
          <td id="LC7711">    <span>pvAppendBuffer</span> <span>&amp;HE0458D50</span><span>,</span> <span>&amp;HF829E850</span><span>,</span> <span>&amp;HC085FFFF</span><span>,</span> <span>&amp;H40751478</span><span>,</span> <span>&amp;H80458D56</span><span>,</span> <span>&amp;HC0458D50</span><span>,</span> <span>&amp;HF815E850</span><span>,</span> <span>&amp;HC085FFFF</span><span>,</span> <span>&amp;H8D562E7F</span><span>,</span> <span>&amp;H8D50C045</span><span>,</span> <span>&amp;H50508045</span><span>,</span> <span>&amp;H5F9E8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H8D53560C</span><span>,</span> <span>&amp;H5050A045</span><span>,</span> <span>&amp;H5E9E8</span><span>,</span> <span>&amp;H458D5600</span><span>,</span> <span>&amp;H458D50E0</span><span>,</span> <span>&amp;HE85050A0</span><span>,</span> <span>&amp;H5DA</span><span>&amp;,</span> <span>&amp;H8DE0758B</span><span>,</span> <span>&amp;H46AE045</span><span>,</span> <span>&amp;H1FE6C150</span><span>,</span> <span>&amp;H3C9E8</span><span>,</span> <span>&amp;H8D046A00</span><span>,</span> <span>&amp;HE850C045</span><span>,</span> <span>&amp;H3BE</span><span>&amp;,</span> <span>&amp;H4FDC7509</span><span>,</span> <span>&amp;HFFFF6BE9</span><span>,</span> <span>&amp;H458D56FF</span><span>,</span> <span>&amp;HE8535080</span><span>,</span> <span>&amp;H3EF</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7712" data-line-number="7712"></td>
          <td id="LC7712">    <span>pvAppendBuffer</span> <span>&amp;H8B5B5E5F</span><span>,</span> <span>&amp;H10C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HC0EC81</span><span>,</span> <span>&amp;H56530000</span><span>,</span> <span>&amp;H5B066A57</span><span>,</span> <span>&amp;H1475FF53</span><span>,</span> <span>&amp;H328E8</span><span>,</span> <span>&amp;H75FF5300</span><span>,</span> <span>&amp;H8DF08B10</span><span>,</span> <span>&amp;HFFFF4085</span><span>,</span> <span>&amp;HC75FFFF</span><span>,</span> <span>&amp;H1E0E850</span><span>,</span> <span>&amp;H8D530000</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;H6E850FF</span><span>,</span> <span>&amp;H8B000003</span><span>,</span> <span>&amp;H74FF85F8</span><span>,</span> <span>&amp;H80C78108</span><span>,</span> <span>&amp;HEB000001</span><span>,</span> <span>&amp;H858D530F</span><span>,</span> <span>&amp;HFFFFFF40</span><span>,</span> <span>&amp;H2EBE850</span><span>,</span> <span>&amp;HF88B0000</span><span>,</span> <span>&amp;H73FE3B53</span><span>,</span> <span>&amp;H40858D0F</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;HE90875FF</span><span>,</span> <span>&amp;H110</span><span>&amp;,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;HFFF709E8</span><span>,</span> <span>&amp;H458D53FF</span></td>
        </tr>
        <tr>
          <td id="L7713" data-line-number="7713"></td>
          <td id="LC7713">    <span>pvAppendBuffer</span> <span>&amp;HFFE850D0</span><span>,</span> <span>&amp;H8BFFFFF6</span><span>,</span> <span>&amp;H8BC62BC7</span><span>,</span> <span>&amp;H6EEC1F0</span><span>,</span> <span>&amp;H3FE08353</span><span>,</span> <span>&amp;HFF501A74</span><span>,</span> <span>&amp;H458D1475</span><span>,</span> <span>&amp;HF0048DA0</span><span>,</span> <span>&amp;HF783E850</span><span>,</span> <span>&amp;H4489FFFF</span><span>,</span> <span>&amp;H5489D0F5</span><span>,</span> <span>&amp;HFEBD4F5</span><span>,</span> <span>&amp;H8D1475FF</span><span>,</span> <span>&amp;H48DA045</span><span>,</span> <span>&amp;H30E850F0</span><span>,</span> <span>&amp;H53000003</span><span>,</span> <span>&amp;H53085D8B</span><span>,</span> <span>&amp;HFFF6BDE8</span><span>,</span> <span>&amp;H46383FF</span><span>,</span> <span>&amp;H103C700</span><span>,</span> <span>&amp;H6A000000</span><span>,</span> <span>&amp;HFF815E06</span><span>,</span> <span>&amp;H180</span><span>&amp;,</span> <span>&amp;HFF561577</span><span>,</span> <span>&amp;H458D1475</span><span>,</span> <span>&amp;HC8E850A0</span><span>,</span> <span>&amp;H85FFFFF6</span><span>,</span> <span>&amp;H88880FC0</span><span>,</span> <span>&amp;H56000000</span><span>,</span> <span>&amp;HFF70858D</span><span>,</span> <span>&amp;H8D50FFFF</span><span>,</span> <span>&amp;HE850D045</span></td>
        </tr>
        <tr>
          <td id="L7714" data-line-number="7714"></td>
          <td id="LC7714">    <span>pvAppendBuffer</span> <span>&amp;HFFFFF6AF</span><span>,</span> <span>&amp;H1778C085</span><span>,</span> <span>&amp;H8D564C75</span><span>,</span> <span>&amp;HFFFF4085</span><span>,</span> <span>&amp;H458D50FF</span><span>,</span> <span>&amp;H98E850A0</span><span>,</span> <span>&amp;H85FFFFF6</span><span>,</span> <span>&amp;H56377FC0</span><span>,</span> <span>&amp;H50A0458D</span><span>,</span> <span>&amp;HFF40858D</span><span>,</span> <span>&amp;H5050FFFF</span><span>,</span> <span>&amp;H479E8</span><span>,</span> <span>&amp;H74C20B00</span><span>,</span> <span>&amp;H8D53560F</span><span>,</span> <span>&amp;HFFFF7085</span><span>,</span> <span>&amp;HE85050FF</span><span>,</span> <span>&amp;H466</span><span>&amp;,</span> <span>&amp;HD0458D56</span><span>,</span> <span>&amp;H70858D50</span><span>,</span> <span>&amp;H50FFFFFF</span><span>,</span> <span>&amp;H454E850</span><span>,</span> <span>&amp;H758B0000</span><span>,</span> <span>&amp;HD0458DD0</span><span>,</span> <span>&amp;HC150066A</span><span>,</span> <span>&amp;H43E81FE6</span><span>,</span> <span>&amp;H6A000002</span><span>,</span> <span>&amp;HA0458D06</span><span>,</span> <span>&amp;H238E850</span><span>,</span> <span>&amp;H75090000</span><span>,</span> <span>&amp;H58E94FCC</span><span>,</span> <span>&amp;H56FFFFFF</span><span>,</span> <span>&amp;HFF40858D</span></td>
        </tr>
        <tr>
          <td id="L7715" data-line-number="7715"></td>
          <td id="LC7715">    <span>pvAppendBuffer</span> <span>&amp;H5350FFFF</span><span>,</span> <span>&amp;H266E8</span><span>,</span> <span>&amp;H5B5E5F00</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B550010</span><span>,</span> <span>&amp;H60EC83EC</span><span>,</span> <span>&amp;HFFA0458D</span><span>,</span> <span>&amp;H75FF1475</span><span>,</span> <span>&amp;HC75FF10</span><span>,</span> <span>&amp;H6CE850</span><span>,</span> <span>&amp;H75FF0000</span><span>,</span> <span>&amp;HA0458D14</span><span>,</span> <span>&amp;H875FF50</span><span>,</span> <span>&amp;HFFFA6BE8</span><span>,</span> <span>&amp;H5DE58BFF</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;HA0458D60</span><span>,</span> <span>&amp;HFF1075FF</span><span>,</span> <span>&amp;HE8500C75</span><span>,</span> <span>&amp;H247</span><span>&amp;,</span> <span>&amp;H8D1075FF</span><span>,</span> <span>&amp;HFF50A045</span><span>,</span> <span>&amp;H41E80875</span><span>,</span> <span>&amp;H8BFFFFFA</span><span>,</span> <span>&amp;HCC25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HFF1875FF</span><span>,</span> <span>&amp;H75FF1075</span><span>,</span> <span>&amp;H875FF0C</span><span>,</span> <span>&amp;H3ADE8</span><span>,</span> <span>&amp;H74C20B00</span></td>
        </tr>
        <tr>
          <td id="L7716" data-line-number="7716"></td>
          <td id="LC7716">    <span>pvAppendBuffer</span> <span>&amp;H1875FF11</span><span>,</span> <span>&amp;HFF1475FF</span><span>,</span> <span>&amp;H75FF0875</span><span>,</span> <span>&amp;HF4F7E808</span><span>,</span> <span>&amp;HC25DFFFF</span><span>,</span> <span>&amp;H8B550014</span><span>,</span> <span>&amp;H54EC83EC</span><span>,</span> <span>&amp;H3314558B</span><span>,</span> <span>&amp;H335653C0</span><span>,</span> <span>&amp;H21C933F6</span><span>,</span> <span>&amp;H2140E475</span><span>,</span> <span>&amp;H3357E875</span><span>,</span> <span>&amp;HDC7589FF</span><span>,</span> <span>&amp;H7D89C22B</span><span>,</span> <span>&amp;HF04D89E0</span><span>,</span> <span>&amp;H3EC4589</span><span>,</span> <span>&amp;H1BCA3BC1</span><span>,</span> <span>&amp;HFC6583DB</span><span>,</span> <span>&amp;HF8658300</span><span>,</span> <span>&amp;H23D3F700</span><span>,</span> <span>&amp;HFD93BD8</span><span>,</span> <span>&amp;HA387</span><span>&amp;,</span> <span>&amp;H10758B00</span><span>,</span> <span>&amp;HC32BC18B</span><span>,</span> <span>&amp;H8BC6348D</span><span>,</span> <span>&amp;H7589E445</span><span>,</span> <span>&amp;HFDA3BF4</span><span>,</span> <span>&amp;H8383</span><span>&amp;,</span> <span>&amp;H476FF00</span><span>,</span> <span>&amp;HFF0C458B</span><span>,</span> <span>&amp;HD874FF36</span><span>,</span> <span>&amp;HD834FF04</span></td>
        </tr>
        <tr>
          <td id="L7717" data-line-number="7717"></td>
          <td id="LC7717">    <span>pvAppendBuffer</span> <span>&amp;H50BC458D</span><span>,</span> <span>&amp;HFFE234E8</span><span>,</span> <span>&amp;H8DF08BFF</span><span>,</span> <span>&amp;HEC83CC7D</span><span>,</span> <span>&amp;HA5A5A510</span><span>,</span> <span>&amp;H8BFC8BA5</span><span>,</span> <span>&amp;H10EC83F0</span><span>,</span> <span>&amp;HA5AC458D</span><span>,</span> <span>&amp;H8BA5A5A5</span><span>,</span> <span>&amp;HDC758DFC</span><span>,</span> <span>&amp;HA5A5A550</span><span>,</span> <span>&amp;H8E48E8A5</span><span>,</span> <span>&amp;HF08BFFFF</span><span>,</span> <span>&amp;HA5DC7D8D</span><span>,</span> <span>&amp;H8BA5A5A5</span><span>,</span> <span>&amp;H453BE845</span><span>,</span> <span>&amp;HE4458BD8</span><span>,</span> <span>&amp;H5720C77</span><span>,</span> <span>&amp;H73D4453B</span><span>,</span> <span>&amp;H41C93305</span><span>,</span> <span>&amp;HC93302EB</span><span>,</span> <span>&amp;H33F4758B</span><span>,</span> <span>&amp;HFC4D01D2</span><span>,</span> <span>&amp;H11F04D8B</span><span>,</span> <span>&amp;H8B43F855</span><span>,</span> <span>&amp;HEE831455</span><span>,</span> <span>&amp;HF4758908</span><span>,</span> <span>&amp;H860FD93B</span><span>,</span> <span>&amp;HFFFFFF75</span><span>,</span> <span>&amp;H8BE07D8B</span><span>,</span> <span>&amp;H3EBDC75</span><span>,</span> <span>&amp;H8BE4458B</span></td>
        </tr>
        <tr>
          <td id="L7718" data-line-number="7718"></td>
          <td id="LC7718">    <span>pvAppendBuffer</span> <span>&amp;H3489085D</span><span>,</span> <span>&amp;H8BF08BCB</span><span>,</span> <span>&amp;H4589FC45</span><span>,</span> <span>&amp;HF8458BE4</span><span>,</span> <span>&amp;H4CB7C89</span><span>,</span> <span>&amp;HE87D8B41</span><span>,</span> <span>&amp;H8DE84589</span><span>,</span> <span>&amp;HFFFF5504</span><span>,</span> <span>&amp;HC83BFFFF</span><span>,</span> <span>&amp;H8BDC7589</span><span>,</span> <span>&amp;H7D89EC45</span><span>,</span> <span>&amp;HF04D89E0</span><span>,</span> <span>&amp;HFF09820F</span><span>,</span> <span>&amp;HD203FFFF</span><span>,</span> <span>&amp;HFCD37C89</span><span>,</span> <span>&amp;HD374895F</span><span>,</span> <span>&amp;H8B5B5EF8</span><span>,</span> <span>&amp;H10C25DE5</span><span>,</span> <span>&amp;HEC8B5500</span><span>,</span> <span>&amp;HC75FF56</span><span>,</span> <span>&amp;H5608758B</span><span>,</span> <span>&amp;H2EE8</span><span>&amp;,</span> <span>&amp;H85C88B00</span><span>,</span> <span>&amp;H8B2374C9</span><span>,</span> <span>&amp;H57FCCE54</span><span>,</span> <span>&amp;HF8CE7C8B</span><span>,</span> <span>&amp;H7EBF633</span><span>,</span> <span>&amp;H1D7AC0F</span><span>,</span> <span>&amp;H8B46EAD1</span><span>,</span> <span>&amp;H75C20BC7</span><span>,</span> <span>&amp;H6E1C1F3</span><span>,</span> <span>&amp;HC0418D5F</span></td>
        </tr>
        <tr>
          <td id="L7719" data-line-number="7719"></td>
          <td id="LC7719">    <span>pvAppendBuffer</span> <span>&amp;H5D5EC603</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H4D8BEC8B</span><span>,</span> <span>&amp;H1E9830C</span><span>,</span> <span>&amp;H558B1178</span><span>,</span> <span>&amp;HCA048B08</span><span>,</span> <span>&amp;H4CA440B</span><span>,</span> <span>&amp;HE9830575</span><span>,</span> <span>&amp;H8DF27901</span><span>,</span> <span>&amp;HC25D0141</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;HC458BEC</span><span>,</span> <span>&amp;H8B575653</span><span>,</span> <span>&amp;H6583087D</span><span>,</span> <span>&amp;HDB330008</span><span>,</span> <span>&amp;HEBC7348D</span><span>,</span> <span>&amp;HFC4E8B23</span><span>,</span> <span>&amp;H8B08EE83</span><span>,</span> <span>&amp;HFC28B16</span><span>,</span> <span>&amp;HB01C8AC</span><span>,</span> <span>&amp;HE9D10845</span><span>,</span> <span>&amp;H689CB0B</span><span>,</span> <span>&amp;H4E89DA8B</span><span>,</span> <span>&amp;H1FE3C104</span><span>,</span> <span>&amp;H86583</span><span>,</span> <span>&amp;HD977F73B</span><span>,</span> <span>&amp;H5D5B5E5F</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H558BEC8B</span><span>,</span> <span>&amp;H74D28510</span><span>,</span> <span>&amp;H84D8B1E</span><span>,</span> <span>&amp;HC758B56</span></td>
        </tr>
        <tr>
          <td id="L7720" data-line-number="7720"></td>
          <td id="LC7720">    <span>pvAppendBuffer</span> <span>&amp;H48BF12B</span><span>,</span> <span>&amp;H8D01890E</span><span>,</span> <span>&amp;H448B0849</span><span>,</span> <span>&amp;H4189FC0E</span><span>,</span> <span>&amp;H1EA83FC</span><span>,</span> <span>&amp;H5D5EEC75</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;HEC83EC8B</span><span>,</span> <span>&amp;H10558B5C</span><span>,</span> <span>&amp;H5653C033</span><span>,</span> <span>&amp;HC933F633</span><span>,</span> <span>&amp;H40DC7521</span><span>,</span> <span>&amp;H57E07521</span><span>,</span> <span>&amp;H7589FF33</span><span>,</span> <span>&amp;H89C22BD4</span><span>,</span> <span>&amp;H4D89D87D</span><span>,</span> <span>&amp;HE44589E8</span><span>,</span> <span>&amp;HCA3BC103</span><span>,</span> <span>&amp;H6583DB1B</span><span>,</span> <span>&amp;H658300FC</span><span>,</span> <span>&amp;HD3F700F8</span><span>,</span> <span>&amp;HD93BD823</span><span>,</span> <span>&amp;HFF870F</span><span>,</span> <span>&amp;H7D8B0000</span><span>,</span> <span>&amp;H2BC18B0C</span><span>,</span> <span>&amp;HC7348DC3</span><span>,</span> <span>&amp;H89DC458B</span><span>,</span> <span>&amp;HD18BEC75</span><span>,</span> <span>&amp;H5589D32B</span><span>,</span> <span>&amp;HFDA3BF0</span><span>,</span> <span>&amp;HD587</span><span>&amp;,</span> <span>&amp;H476FF00</span></td>
        </tr>
        <tr>
          <td id="L7721" data-line-number="7721"></td>
          <td id="LC7721">    <span>pvAppendBuffer</span> <span>&amp;HFFB4458D</span><span>,</span> <span>&amp;HDF74FF36</span><span>,</span> <span>&amp;HDF34FF04</span><span>,</span> <span>&amp;HE02BE850</span><span>,</span> <span>&amp;H7D8DFFFF</span><span>,</span> <span>&amp;HA5F08BC4</span><span>,</span> <span>&amp;H3BA5A5A5</span><span>,</span> <span>&amp;H4373F05D</span><span>,</span> <span>&amp;H8BD04D8B</span><span>,</span> <span>&amp;HC8558BC1</span><span>,</span> <span>&amp;HE8C1F28B</span><span>,</span> <span>&amp;HFC45011F</span><span>,</span> <span>&amp;H83CC458B</span><span>,</span> <span>&amp;H3300F855</span><span>,</span> <span>&amp;HC1A40FFF</span><span>,</span> <span>&amp;H1FEEC101</span><span>,</span> <span>&amp;HF90BC003</span><span>,</span> <span>&amp;H7D89F00B</span><span>,</span> <span>&amp;HC4458BF4</span><span>,</span> <span>&amp;H1C2A40F</span><span>,</span> <span>&amp;H3F07589</span><span>,</span> <span>&amp;HCC7589C0</span><span>,</span> <span>&amp;H89D07D89</span><span>,</span> <span>&amp;H5589C445</span><span>,</span> <span>&amp;H8B0CEBC8</span><span>,</span> <span>&amp;H4589D045</span><span>,</span> <span>&amp;HCC458BF4</span><span>,</span> <span>&amp;H83F04589</span><span>,</span> <span>&amp;H758D10EC</span><span>,</span> <span>&amp;H8DFC8BC4</span><span>,</span> <span>&amp;HEC83A445</span><span>,</span> <span>&amp;HA5A5A510</span></td>
        </tr>
        <tr>
          <td id="L7722" data-line-number="7722"></td>
          <td id="LC7722">    <span>pvAppendBuffer</span> <span>&amp;H8DFC8BA5</span><span>,</span> <span>&amp;HA550D475</span><span>,</span> <span>&amp;HE8A5A5A5</span><span>,</span> <span>&amp;HFFFF8BEA</span><span>,</span> <span>&amp;H7D8DF08B</span><span>,</span> <span>&amp;HA5A5A5D4</span><span>,</span> <span>&amp;HE0458BA5</span><span>,</span> <span>&amp;H8BF4453B</span><span>,</span> <span>&amp;HC77DC45</span><span>,</span> <span>&amp;H453B0572</span><span>,</span> <span>&amp;H330573F0</span><span>,</span> <span>&amp;H2EB41C9</span><span>,</span> <span>&amp;H758BC933</span><span>,</span> <span>&amp;H1D233EC</span><span>,</span> <span>&amp;H4D8BFC4D</span><span>,</span> <span>&amp;HF85511E8</span><span>,</span> <span>&amp;HC7D8B43</span><span>,</span> <span>&amp;H8908EE83</span><span>,</span> <span>&amp;HD93BEC75</span><span>,</span> <span>&amp;HFF1C860F</span><span>,</span> <span>&amp;H7D8BFFFF</span><span>,</span> <span>&amp;HD4758BD8</span><span>,</span> <span>&amp;HEB10558B</span><span>,</span> <span>&amp;HDC458B03</span><span>,</span> <span>&amp;H89085D8B</span><span>,</span> <span>&amp;HF08BCB34</span><span>,</span> <span>&amp;H89FC458B</span><span>,</span> <span>&amp;H458BDC45</span><span>,</span> <span>&amp;HCB7C89F8</span><span>,</span> <span>&amp;H7D8B4104</span><span>,</span> <span>&amp;HE04589E0</span><span>,</span> <span>&amp;HFF55048D</span></td>
        </tr>
        <tr>
          <td id="L7723" data-line-number="7723"></td>
          <td id="LC7723">    <span>pvAppendBuffer</span> <span>&amp;H3BFFFFFF</span><span>,</span> <span>&amp;HD47589C8</span><span>,</span> <span>&amp;H89E4458B</span><span>,</span> <span>&amp;H4D89D87D</span><span>,</span> <span>&amp;HAD820FE8</span><span>,</span> <span>&amp;H3FFFFFE</span><span>,</span> <span>&amp;HD37C89D2</span><span>,</span> <span>&amp;H74895FFC</span><span>,</span> <span>&amp;H5B5EF8D3</span><span>,</span> <span>&amp;HC25DE58B</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H5D8B53EC</span><span>,</span> <span>&amp;H33C93314</span><span>,</span> <span>&amp;H74DB85D2</span><span>,</span> <span>&amp;HC458B5F</span><span>,</span> <span>&amp;H29104529</span><span>,</span> <span>&amp;H57560845</span><span>,</span> <span>&amp;H8B107D8B</span><span>,</span> <span>&amp;H7342B30</span><span>,</span> <span>&amp;H8B0C7589</span><span>,</span> <span>&amp;H741B0470</span><span>,</span> <span>&amp;H7D8B0407</span><span>,</span> <span>&amp;H89F92B0C</span><span>,</span> <span>&amp;HF21B0C7D</span><span>,</span> <span>&amp;H7D8B383B</span><span>,</span> <span>&amp;H3B057508</span><span>,</span> <span>&amp;H17740470</span><span>,</span> <span>&amp;H7204703B</span><span>,</span> <span>&amp;H8B07770E</span><span>,</span> <span>&amp;HC4D3908</span><span>,</span> <span>&amp;HC9330576</span><span>,</span> <span>&amp;H3302EB41</span></td>
        </tr>
        <tr>
          <td id="L7724" data-line-number="7724"></td>
          <td id="LC7724">    <span>pvAppendBuffer</span> <span>&amp;H8BD233C9</span><span>,</span> <span>&amp;H1C890C5D</span><span>,</span> <span>&amp;H7748907</span><span>,</span> <span>&amp;H8C08304</span><span>,</span> <span>&amp;H1146D83</span><span>,</span> <span>&amp;H5E5FAE75</span><span>,</span> <span>&amp;H5D5BC18B</span><span>,</span> <span>&amp;H550010C2</span><span>,</span> <span>&amp;H8B56EC8B</span><span>,</span> <span>&amp;HC0330C75</span><span>,</span> <span>&amp;H8340CE8B</span><span>,</span> <span>&amp;HD2333FE1</span><span>,</span> <span>&amp;HFF8A4FE8</span><span>,</span> <span>&amp;H84D8BFF</span><span>,</span> <span>&amp;H2306EEC1</span><span>,</span> <span>&amp;H5423F104</span><span>,</span> <span>&amp;H5D5E04F1</span><span>,</span> <span>&amp;H550008C2</span><span>,</span> <span>&amp;H558BEC8B</span><span>,</span> <span>&amp;H8BC28B08</span><span>,</span> <span>&amp;HE8C10C4D</span><span>,</span> <span>&amp;H8B018818</span><span>,</span> <span>&amp;H10E8C1C2</span><span>,</span> <span>&amp;H8B014188</span><span>,</span> <span>&amp;H8E8C1C2</span><span>,</span> <span>&amp;H88024188</span><span>,</span> <span>&amp;HC25D0351</span><span>,</span> <span>&amp;H8B550008</span><span>,</span> <span>&amp;H8558BEC</span><span>,</span> <span>&amp;H8B53CA8B</span><span>,</span> <span>&amp;HC38B0C5D</span><span>,</span> <span>&amp;H5618E8C1</span></td>
        </tr>
        <tr>
          <td id="L7725" data-line-number="7725"></td>
          <td id="LC7725">    <span>pvAppendBuffer</span> <span>&amp;H8810758B</span><span>,</span> <span>&amp;HC1C38B06</span><span>,</span> <span>&amp;H468810E8</span><span>,</span> <span>&amp;HC1C38B01</span><span>,</span> <span>&amp;H468808E8</span><span>,</span> <span>&amp;HFC38B02</span><span>,</span> <span>&amp;H8818C1AC</span><span>,</span> <span>&amp;HE8C1035E</span><span>,</span> <span>&amp;H44E8818</span><span>,</span> <span>&amp;HCA8BC38B</span><span>,</span> <span>&amp;H10C1AC0F</span><span>,</span> <span>&amp;H8B10E8C1</span><span>,</span> <span>&amp;H54E88C2</span><span>,</span> <span>&amp;H8D8AC0F</span><span>,</span> <span>&amp;H88064688</span><span>,</span> <span>&amp;HEBC10756</span><span>,</span> <span>&amp;H5D5B5E08</span><span>,</span> <span>&amp;H55000CC2</span><span>,</span> <span>&amp;H558BEC8B</span><span>,</span> <span>&amp;H53CA8B08</span><span>,</span> <span>&amp;H8B0C5D8B</span><span>,</span> <span>&amp;HC1AC0FC3</span><span>,</span> <span>&amp;H758B5608</span><span>,</span> <span>&amp;H8E8C110</span><span>,</span> <span>&amp;H1688C38B</span><span>,</span> <span>&amp;H8B014E88</span><span>,</span> <span>&amp;HC1AC0FCA</span><span>,</span> <span>&amp;H10E8C110</span><span>,</span> <span>&amp;H4E88C38B</span><span>,</span> <span>&amp;HC2AC0F02</span><span>,</span> <span>&amp;H18E8C118</span><span>,</span> <span>&amp;H8B035688</span></td>
        </tr>
        <tr>
          <td id="L7726" data-line-number="7726"></td>
          <td id="LC7726">    <span>pvAppendBuffer</span> <span>&amp;H45E88C3</span><span>,</span> <span>&amp;H8808E8C1</span><span>,</span> <span>&amp;HC38B0546</span><span>,</span> <span>&amp;HC110E8C1</span><span>,</span> <span>&amp;H468818EB</span><span>,</span> <span>&amp;H75E8806</span><span>,</span> <span>&amp;HC25D5B5E</span><span>,</span> <span>&amp;H8B55000C</span><span>,</span> <span>&amp;H14558BEC</span><span>,</span> <span>&amp;H1F74D285</span><span>,</span> <span>&amp;H56104D8B</span><span>,</span> <span>&amp;H570C758B</span><span>,</span> <span>&amp;H2B087D8B</span><span>,</span> <span>&amp;H8AF92BF1</span><span>,</span> <span>&amp;H1320E04</span><span>,</span> <span>&amp;H410F0488</span><span>,</span> <span>&amp;H7501EA83</span><span>,</span> <span>&amp;H5D5E5FF2</span><span>,</span> <span>&amp;H10C2</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;,</span> <span>&amp;H0</span><span>&amp;</span></td>
        </tr>
        <tr>
          <td id="L7727" data-line-number="7727"></td>
          <td id="LC7727">    <span>&#39;--- end thunk data</span></td>
        </tr>
        <tr>
          <td id="L7728" data-line-number="7728"></td>
          <td id="LC7728">    <span>ReDim</span> <span>baBuffer(</span><span>0</span> <span>To</span> <span>34125</span> <span>-</span> <span>1</span><span>)</span> <span>As</span> <span>Byte</span></td>
        </tr>
        <tr>
          <td id="L7729" data-line-number="7729"></td>
          <td id="LC7729">    <span>Call</span> <span>CopyMemory(baBuffer(</span><span>0</span><span>),</span> <span>m_baBuffer(</span><span>0</span><span>),</span> <span>UBound(baBuffer)</span> <span>+</span> <span>1</span><span>)</span></td>
        </tr>
        <tr>
          <td id="L7730" data-line-number="7730"></td>
          <td id="LC7730">    <span>Erase</span> <span>m_baBuffer</span></td>
        </tr>
        <tr>
          <td id="L7731" data-line-number="7731"></td>
          <td id="LC7731"><span>End</span> <span>Sub</span></td>
        </tr>
        <tr>
          <td id="L7732" data-line-number="7732"></td>
          <td id="LC7732">
</td>
        </tr>
  </tbody></div></div>
  </body>
</html>
