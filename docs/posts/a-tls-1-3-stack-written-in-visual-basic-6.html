<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/wqweto/VbAsyncSocket/blob/master/src/mdTlsThunks.bas">Original</a>
    <h1>A TLS 1.3 stack written in Visual Basic 6</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="" data-tab-size="8" data-paste-markdown-skip="" data-tagsearch-lang="Visual Basic 6.0" data-tagsearch-path="src/mdTlsThunks.bas">
        <tbody><tr>
          <td id="L1" data-line-number="1"></td>
          <td id="LC1">Attribute VB_Name = &#34;mdTlsThunks&#34;</td>
        </tr>
        <tr>
          <td id="L2" data-line-number="2"></td>
          <td id="LC2">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L3" data-line-number="3"></td>
          <td id="LC3">&#39;</td>
        </tr>
        <tr>
          <td id="L4" data-line-number="4"></td>
          <td id="LC4">&#39; VbAsyncSocket Project (c) 2018-2023 by wqweto@gmail.com</td>
        </tr>
        <tr>
          <td id="L5" data-line-number="5"></td>
          <td id="LC5">&#39;</td>
        </tr>
        <tr>
          <td id="L6" data-line-number="6"></td>
          <td id="LC6">&#39; Simple and thin WinSock API wrappers for VB6</td>
        </tr>
        <tr>
          <td id="L7" data-line-number="7"></td>
          <td id="LC7">&#39;</td>
        </tr>
        <tr>
          <td id="L8" data-line-number="8"></td>
          <td id="LC8">&#39; This project is licensed under the terms of the MIT license</td>
        </tr>
        <tr>
          <td id="L9" data-line-number="9"></td>
          <td id="LC9">&#39; See the LICENSE file in the project root for more information</td>
        </tr>
        <tr>
          <td id="L10" data-line-number="10"></td>
          <td id="LC10">&#39;</td>
        </tr>
        <tr>
          <td id="L11" data-line-number="11"></td>
          <td id="LC11">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L12" data-line-number="12"></td>
          <td id="LC12">&#39;</td>
        </tr>
        <tr>
          <td id="L13" data-line-number="13"></td>
          <td id="LC13">&#39; Based on RFC 8446 at https://tools.ietf.org/html/rfc8446</td>
        </tr>
        <tr>
          <td id="L14" data-line-number="14"></td>
          <td id="LC14">&#39;   and illustrated traffic-dump at https://tls13.ulfheim.net/</td>
        </tr>
        <tr>
          <td id="L15" data-line-number="15"></td>
          <td id="LC15">&#39;</td>
        </tr>
        <tr>
          <td id="L16" data-line-number="16"></td>
          <td id="LC16">&#39; More TLS 1.3 implementations at https://github.com/h2o/picotls</td>
        </tr>
        <tr>
          <td id="L17" data-line-number="17"></td>
          <td id="LC17">&#39;   and https://github.com/openssl/openssl</td>
        </tr>
        <tr>
          <td id="L18" data-line-number="18"></td>
          <td id="LC18">&#39;</td>
        </tr>
        <tr>
          <td id="L19" data-line-number="19"></td>
          <td id="LC19">&#39; Additional links with TLS 1.3 resources</td>
        </tr>
        <tr>
          <td id="L20" data-line-number="20"></td>
          <td id="LC20">&#39;   https://github.com/tlswg/tls13-spec/wiki/Implementations</td>
        </tr>
        <tr>
          <td id="L21" data-line-number="21"></td>
          <td id="LC21">&#39;   https://sans-io.readthedocs.io/how-to-sans-io.html</td>
        </tr>
        <tr>
          <td id="L22" data-line-number="22"></td>
          <td id="LC22">&#39;   https://www.davidwong.fr/tls13</td>
        </tr>
        <tr>
          <td id="L23" data-line-number="23"></td>
          <td id="LC23">&#39;</td>
        </tr>
        <tr>
          <td id="L24" data-line-number="24"></td>
          <td id="LC24">&#39; Some of the cryptographic thunks are based on the following sources</td>
        </tr>
        <tr>
          <td id="L25" data-line-number="25"></td>
          <td id="LC25">&#39;</td>
        </tr>
        <tr>
          <td id="L26" data-line-number="26"></td>
          <td id="LC26">&#39;  1. https://github.com/esxgx/easy-ecc by Kenneth MacKay</td>
        </tr>
        <tr>
          <td id="L27" data-line-number="27"></td>
          <td id="LC27">&#39;     which is distributed under the BSD 2-clause license</td>
        </tr>
        <tr>
          <td id="L28" data-line-number="28"></td>
          <td id="LC28">&#39;</td>
        </tr>
        <tr>
          <td id="L29" data-line-number="29"></td>
          <td id="LC29">&#39;  2. https://github.com/ctz/cifra by Joseph Birr-Pixton</td>
        </tr>
        <tr>
          <td id="L30" data-line-number="30"></td>
          <td id="LC30">&#39;     CC0 1.0 Universal license (Public Domain Dedication)</td>
        </tr>
        <tr>
          <td id="L31" data-line-number="31"></td>
          <td id="LC31">&#39;</td>
        </tr>
        <tr>
          <td id="L32" data-line-number="32"></td>
          <td id="LC32">&#39;  3. https://github.com/github/putty by Simon Tatham</td>
        </tr>
        <tr>
          <td id="L33" data-line-number="33"></td>
          <td id="LC33">&#39;     which is distributed under the MIT licence</td>
        </tr>
        <tr>
          <td id="L34" data-line-number="34"></td>
          <td id="LC34">&#39;</td>
        </tr>
        <tr>
          <td id="L35" data-line-number="35"></td>
          <td id="LC35">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L36" data-line-number="36"></td>
          <td id="LC36">Option Explicit</td>
        </tr>
        <tr>
          <td id="L37" data-line-number="37"></td>
          <td id="LC37">DefObj A-Z</td>
        </tr>
        <tr>
          <td id="L38" data-line-number="38"></td>
          <td id="LC38">Private Const MODULE_NAME As String = &#34;mdTlsThunks&#34;</td>
        </tr>
        <tr>
          <td id="L39" data-line-number="39"></td>
          <td id="LC39">
</td>
        </tr>
        <tr>
          <td id="L40" data-line-number="40"></td>
          <td id="LC40">#Const ImplTlsServer = (ASYNCSOCKET_NO_TLSSERVER = 0)</td>
        </tr>
        <tr>
          <td id="L41" data-line-number="41"></td>
          <td id="LC41">#Const ImplUseShared = (ASYNCSOCKET_USE_SHARED &lt;&gt; 0)</td>
        </tr>
        <tr>
          <td id="L42" data-line-number="42"></td>
          <td id="LC42">#Const ImplUseDebugLog = (USE_DEBUG_LOG &lt;&gt; 0)</td>
        </tr>
        <tr>
          <td id="L43" data-line-number="43"></td>
          <td id="LC43">#Const ImplCaptureTraffic = CLng(ASYNCSOCKET_CAPTURE_TRAFFIC) &#39;--- bitmask: 1 - traffic, 2 - derived secrets</td>
        </tr>
        <tr>
          <td id="L44" data-line-number="44"></td>
          <td id="LC44">#Const ImplExoticCiphers = False</td>
        </tr>
        <tr>
          <td id="L45" data-line-number="45"></td>
          <td id="LC45">#Const ImplTlsServerAllowInsecureRenegotiation = False</td>
        </tr>
        <tr>
          <td id="L46" data-line-number="46"></td>
          <td id="LC46">#Const ImplTestCrypto = (ASYNCSOCKET_TEST_CRYPTO &lt;&gt; 0)</td>
        </tr>
        <tr>
          <td id="L47" data-line-number="47"></td>
          <td id="LC47">
</td>
        </tr>
        <tr>
          <td id="L48" data-line-number="48"></td>
          <td id="LC48">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L49" data-line-number="49"></td>
          <td id="LC49">&#39; API</td>
        </tr>
        <tr>
          <td id="L50" data-line-number="50"></td>
          <td id="LC50">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L51" data-line-number="51"></td>
          <td id="LC51">
</td>
        </tr>
        <tr>
          <td id="L52" data-line-number="52"></td>
          <td id="LC52">&#39;--- for thunks</td>
        </tr>
        <tr>
          <td id="L53" data-line-number="53"></td>
          <td id="LC53">Private Const MEM_COMMIT                                As Long = &amp;H1000</td>
        </tr>
        <tr>
          <td id="L54" data-line-number="54"></td>
          <td id="LC54">Private Const PAGE_EXECUTE_READWRITE                    As Long = &amp;H40</td>
        </tr>
        <tr>
          <td id="L55" data-line-number="55"></td>
          <td id="LC55">Private Const PTR_SIZE                                  As Long = 4</td>
        </tr>
        <tr>
          <td id="L56" data-line-number="56"></td>
          <td id="LC56">&#39;--- for CryptAcquireContext</td>
        </tr>
        <tr>
          <td id="L57" data-line-number="57"></td>
          <td id="LC57">Private Const PROV_RSA_FULL                             As Long = 1</td>
        </tr>
        <tr>
          <td id="L58" data-line-number="58"></td>
          <td id="LC58">Private Const PROV_RSA_AES                              As Long = 24</td>
        </tr>
        <tr>
          <td id="L59" data-line-number="59"></td>
          <td id="LC59">Private Const CRYPT_VERIFYCONTEXT                       As Long = &amp;HF0000000</td>
        </tr>
        <tr>
          <td id="L60" data-line-number="60"></td>
          <td id="LC60">&#39;--- for CryptDecodeObjectEx</td>
        </tr>
        <tr>
          <td id="L61" data-line-number="61"></td>
          <td id="LC61">Private Const X509_ASN_ENCODING                         As Long = 1</td>
        </tr>
        <tr>
          <td id="L62" data-line-number="62"></td>
          <td id="LC62">Private Const PKCS_7_ASN_ENCODING                       As Long = &amp;H10000</td>
        </tr>
        <tr>
          <td id="L63" data-line-number="63"></td>
          <td id="LC63">Private Const PKCS_RSA_PRIVATE_KEY                      As Long = 43</td>
        </tr>
        <tr>
          <td id="L64" data-line-number="64"></td>
          <td id="LC64">Private Const PKCS_PRIVATE_KEY_INFO                     As Long = 44</td>
        </tr>
        <tr>
          <td id="L65" data-line-number="65"></td>
          <td id="LC65">Private Const X509_PUBLIC_KEY_INFO                      As Long = 8</td>
        </tr>
        <tr>
          <td id="L66" data-line-number="66"></td>
          <td id="LC66">Private Const X509_ECC_PRIVATE_KEY                      As Long = 82</td>
        </tr>
        <tr>
          <td id="L67" data-line-number="67"></td>
          <td id="LC67">Private Const CRYPT_DECODE_NOCOPY_FLAG                  As Long = &amp;H1</td>
        </tr>
        <tr>
          <td id="L68" data-line-number="68"></td>
          <td id="LC68">Private Const CRYPT_DECODE_ALLOC_FLAG                   As Long = &amp;H8000</td>
        </tr>
        <tr>
          <td id="L69" data-line-number="69"></td>
          <td id="LC69">Private Const ERROR_FILE_NOT_FOUND                      As Long = 2</td>
        </tr>
        <tr>
          <td id="L70" data-line-number="70"></td>
          <td id="LC70">&#39;--- for CryptExportKey</td>
        </tr>
        <tr>
          <td id="L71" data-line-number="71"></td>
          <td id="LC71">Private Const PUBLICKEYBLOB                             As Long = 6</td>
        </tr>
        <tr>
          <td id="L72" data-line-number="72"></td>
          <td id="LC72">&#39;--- for CryptCreateHash</td>
        </tr>
        <tr>
          <td id="L73" data-line-number="73"></td>
          <td id="LC73">Private Const CALG_SSL3_SHAMD5                          As Long = &amp;H8008&amp;</td>
        </tr>
        <tr>
          <td id="L74" data-line-number="74"></td>
          <td id="LC74">Private Const CALG_SHA1                                 As Long = &amp;H8004&amp;</td>
        </tr>
        <tr>
          <td id="L75" data-line-number="75"></td>
          <td id="LC75">Private Const CALG_SHA_256                              As Long = &amp;H800C&amp;</td>
        </tr>
        <tr>
          <td id="L76" data-line-number="76"></td>
          <td id="LC76">Private Const CALG_SHA_384                              As Long = &amp;H800D&amp;</td>
        </tr>
        <tr>
          <td id="L77" data-line-number="77"></td>
          <td id="LC77">Private Const CALG_SHA_512                              As Long = &amp;H800E&amp;</td>
        </tr>
        <tr>
          <td id="L78" data-line-number="78"></td>
          <td id="LC78">Private Const HP_HASHVAL                                As Long = 2</td>
        </tr>
        <tr>
          <td id="L79" data-line-number="79"></td>
          <td id="LC79">Private Const HP_HASHSIZE                               As Long = 4</td>
        </tr>
        <tr>
          <td id="L80" data-line-number="80"></td>
          <td id="LC80">&#39;--- for NCryptSignHash</td>
        </tr>
        <tr>
          <td id="L81" data-line-number="81"></td>
          <td id="LC81">Private Const BCRYPT_PAD_PKCS1                          As Long = &amp;H2</td>
        </tr>
        <tr>
          <td id="L82" data-line-number="82"></td>
          <td id="LC82">Private Const BCRYPT_PAD_PSS                            As Long = &amp;H8</td>
        </tr>
        <tr>
          <td id="L83" data-line-number="83"></td>
          <td id="LC83">&#39;--- for NCryptDecrypt</td>
        </tr>
        <tr>
          <td id="L84" data-line-number="84"></td>
          <td id="LC84">Private Const NCRYPT_PAD_PKCS1_FLAG                     As Long = &amp;H2</td>
        </tr>
        <tr>
          <td id="L85" data-line-number="85"></td>
          <td id="LC85">&#39;--- OIDs</td>
        </tr>
        <tr>
          <td id="L86" data-line-number="86"></td>
          <td id="LC86">Private Const szOID_RSA_RSA                             As String = &#34;1.2.840.113549.1.1.1&#34;</td>
        </tr>
        <tr>
          <td id="L87" data-line-number="87"></td>
          <td id="LC87">Private Const szOID_RSA_SSA_PSS                         As String = &#34;1.2.840.113549.1.1.10&#34;</td>
        </tr>
        <tr>
          <td id="L88" data-line-number="88"></td>
          <td id="LC88">Private Const szOID_ECC_PUBLIC_KEY                      As String = &#34;1.2.840.10045.2.1&#34;</td>
        </tr>
        <tr>
          <td id="L89" data-line-number="89"></td>
          <td id="LC89">Private Const szOID_ECC_CURVE_P256                      As String = &#34;1.2.840.10045.3.1.7&#34;</td>
        </tr>
        <tr>
          <td id="L90" data-line-number="90"></td>
          <td id="LC90">Private Const szOID_ECC_CURVE_P384                      As String = &#34;1.3.132.0.34&#34;</td>
        </tr>
        <tr>
          <td id="L91" data-line-number="91"></td>
          <td id="LC91">Private Const szOID_ECC_CURVE_P521                      As String = &#34;1.3.132.0.35&#34;</td>
        </tr>
        <tr>
          <td id="L92" data-line-number="92"></td>
          <td id="LC92">
</td>
        </tr>
        <tr>
          <td id="L93" data-line-number="93"></td>
          <td id="LC93">Private Declare Sub CopyMemory Lib &#34;kernel32&#34; Alias &#34;RtlMoveMemory&#34; (Destination As Any, Source As Any, ByVal Length As Long)</td>
        </tr>
        <tr>
          <td id="L94" data-line-number="94"></td>
          <td id="LC94">Private Declare Sub FillMemory Lib &#34;kernel32&#34; Alias &#34;RtlFillMemory&#34; (Destination As Any, ByVal Length As Long, ByVal Fill As Byte)</td>
        </tr>
        <tr>
          <td id="L95" data-line-number="95"></td>
          <td id="LC95">Private Declare Function IsBadReadPtr Lib &#34;kernel32&#34; (ByVal lp As Long, ByVal ucb As Long) As Long</td>
        </tr>
        <tr>
          <td id="L96" data-line-number="96"></td>
          <td id="LC96">Private Declare Function VirtualAlloc Lib &#34;kernel32&#34; (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long) As Long</td>
        </tr>
        <tr>
          <td id="L97" data-line-number="97"></td>
          <td id="LC97">Private Declare Function VirtualProtect Lib &#34;kernel32&#34; (ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flNewProtect As Long, ByRef lpflOldProtect As Long) As Long</td>
        </tr>
        <tr>
          <td id="L98" data-line-number="98"></td>
          <td id="LC98">Private Declare Function GetModuleHandle Lib &#34;kernel32&#34; Alias &#34;GetModuleHandleW&#34; (ByVal lpModuleName As Long) As Long</td>
        </tr>
        <tr>
          <td id="L99" data-line-number="99"></td>
          <td id="LC99">Private Declare Function GetProcAddress Lib &#34;kernel32&#34; (ByVal hModule As Long, ByVal lpProcName As String) As Long</td>
        </tr>
        <tr>
          <td id="L100" data-line-number="100"></td>
          <td id="LC100">Private Declare Function lstrlenA Lib &#34;kernel32&#34; (ByVal lpStr As Long) As Long</td>
        </tr>
        <tr>
          <td id="L101" data-line-number="101"></td>
          <td id="LC101">Private Declare Function LocalFree Lib &#34;kernel32&#34; (ByVal hMem As Long) As Long</td>
        </tr>
        <tr>
          <td id="L102" data-line-number="102"></td>
          <td id="LC102">Private Declare Function GetEnvironmentVariable Lib &#34;kernel32&#34; Alias &#34;GetEnvironmentVariableW&#34; (ByVal lpName As Long, ByVal lpBuffer As Long, ByVal nSize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L103" data-line-number="103"></td>
          <td id="LC103">Private Declare Function GetVersionEx Lib &#34;kernel32&#34; Alias &#34;GetVersionExW&#34; (lpVersionInformation As Any) As Long</td>
        </tr>
        <tr>
          <td id="L104" data-line-number="104"></td>
          <td id="LC104">&#39;--- msvbvm60</td>
        </tr>
        <tr>
          <td id="L105" data-line-number="105"></td>
          <td id="LC105">Private Declare Function ArrPtr Lib &#34;msvbvm60&#34; Alias &#34;VarPtr&#34; (Ptr() As Any) As Long</td>
        </tr>
        <tr>
          <td id="L106" data-line-number="106"></td>
          <td id="LC106">Private Declare Function vbaObjSetAddref Lib &#34;msvbvm60&#34; Alias &#34;__vbaObjSetAddref&#34; (oDest As Any, ByVal lSrcPtr As Long) As Long</td>
        </tr>
        <tr>
          <td id="L107" data-line-number="107"></td>
          <td id="LC107">&#39;--- advapi32</td>
        </tr>
        <tr>
          <td id="L108" data-line-number="108"></td>
          <td id="LC108">Private Declare Function CryptAcquireContext Lib &#34;advapi32&#34; Alias &#34;CryptAcquireContextW&#34; (phProv As Long, ByVal pszContainer As Long, ByVal pszProvider As Long, ByVal dwProvType As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L109" data-line-number="109"></td>
          <td id="LC109">Private Declare Function CryptReleaseContext Lib &#34;advapi32&#34; (ByVal hProv As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L110" data-line-number="110"></td>
          <td id="LC110">Private Declare Function CryptGenRandom Lib &#34;advapi32&#34; (ByVal hProv As Long, ByVal dwLen As Long, ByVal pbBuffer As Long) As Long</td>
        </tr>
        <tr>
          <td id="L111" data-line-number="111"></td>
          <td id="LC111">Private Declare Function CryptDestroyKey Lib &#34;advapi32&#34; (ByVal hKey As Long) As Long</td>
        </tr>
        <tr>
          <td id="L112" data-line-number="112"></td>
          <td id="LC112">Private Declare Function CryptExportKey Lib &#34;advapi32&#34; (ByVal hKey As Long, ByVal hExpKey As Long, ByVal dwBlobType As Long, ByVal dwFlags As Long, pbData As Any, pdwDataLen As Long) As Long</td>
        </tr>
        <tr>
          <td id="L113" data-line-number="113"></td>
          <td id="LC113">Private Declare Function CryptCreateHash Lib &#34;advapi32&#34; (ByVal hProv As Long, ByVal AlgId As Long, ByVal hKey As Long, ByVal dwFlags As Long, phHash As Long) As Long</td>
        </tr>
        <tr>
          <td id="L114" data-line-number="114"></td>
          <td id="LC114">Private Declare Function CryptDestroyHash Lib &#34;advapi32&#34; (ByVal hHash As Long) As Long</td>
        </tr>
        <tr>
          <td id="L115" data-line-number="115"></td>
          <td id="LC115">Private Declare Function CryptHashData Lib &#34;advapi32&#34; (ByVal hHash As Long, pbData As Any, ByVal dwDataLen As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L116" data-line-number="116"></td>
          <td id="LC116">Private Declare Function CryptGetHashParam Lib &#34;advapi32&#34; (ByVal hHash As Long, ByVal dwParam As Long, pbData As Any, pdwDataLen As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L117" data-line-number="117"></td>
          <td id="LC117">Private Declare Function CryptSetHashParam Lib &#34;advapi32&#34; (ByVal hHash As Long, ByVal dwParam As Long, pbData As Any, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L118" data-line-number="118"></td>
          <td id="LC118">Private Declare Function CryptGetUserKey Lib &#34;advapi32&#34; (ByVal hProv As Long, ByVal dwKeySpec As Long, phUserKey As Long) As Long</td>
        </tr>
        <tr>
          <td id="L119" data-line-number="119"></td>
          <td id="LC119">Private Declare Function CryptSignHash Lib &#34;advapi32&#34; Alias &#34;CryptSignHashW&#34; (ByVal hHash As Long, ByVal dwKeySpec As Long, ByVal szDescription As Long, ByVal dwFlags As Long, pbSignature As Any, pdwSigLen As Long) As Long</td>
        </tr>
        <tr>
          <td id="L120" data-line-number="120"></td>
          <td id="LC120">Private Declare Function CryptDecrypt Lib &#34;advapi32&#34; (ByVal hKey As Long, ByVal hHash As Long, ByVal Final As Long, ByVal dwFlags As Long, pbData As Any, pdwDataLen As Long) As Long</td>
        </tr>
        <tr>
          <td id="L121" data-line-number="121"></td>
          <td id="LC121">&#39;--- Crypt32</td>
        </tr>
        <tr>
          <td id="L122" data-line-number="122"></td>
          <td id="LC122">Private Declare Function CryptImportPublicKeyInfo Lib &#34;crypt32&#34; (ByVal hCryptProv As Long, ByVal dwCertEncodingType As Long, pInfo As Any, phKey As Long) As Long</td>
        </tr>
        <tr>
          <td id="L123" data-line-number="123"></td>
          <td id="LC123">Private Declare Function CryptDecodeObjectEx Lib &#34;crypt32&#34; (ByVal dwCertEncodingType As Long, ByVal lpszStructType As Any, pbEncoded As Any, ByVal cbEncoded As Long, ByVal dwFlags As Long, ByVal pDecodePara As Long, pvStructInfo As Any, pcbStructInfo As Long) As Long</td>
        </tr>
        <tr>
          <td id="L124" data-line-number="124"></td>
          <td id="LC124">Private Declare Function CertCreateCertificateContext Lib &#34;crypt32&#34; (ByVal dwCertEncodingType As Long, pbCertEncoded As Any, ByVal cbCertEncoded As Long) As Long</td>
        </tr>
        <tr>
          <td id="L125" data-line-number="125"></td>
          <td id="LC125">Private Declare Function CertFreeCertificateContext Lib &#34;crypt32&#34; (ByVal pCertContext As Long) As Long</td>
        </tr>
        <tr>
          <td id="L126" data-line-number="126"></td>
          <td id="LC126">&#39;--- NCrypt</td>
        </tr>
        <tr>
          <td id="L127" data-line-number="127"></td>
          <td id="LC127">Private Declare Function NCryptOpenStorageProvider Lib &#34;ncrypt&#34; (phProvider As Long, ByVal pszProviderName As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L128" data-line-number="128"></td>
          <td id="LC128">Private Declare Function NCryptOpenKey Lib &#34;ncrypt&#34; (ByVal hProvider As Long, phKey As Long, ByVal pszKeyName As Long, ByVal dwLegacyKeySpec As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L129" data-line-number="129"></td>
          <td id="LC129">Private Declare Function NCryptSignHash Lib &#34;ncrypt&#34; (ByVal hKey As Long, ByVal pPaddingInfo As Long, pbHashValue As Any, ByVal cbHashValue As Long, pbSignature As Any, ByVal cbSignature As Long, pcbResult As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L130" data-line-number="130"></td>
          <td id="LC130">Private Declare Function NCryptDecrypt Lib &#34;ncrypt&#34; (ByVal hKey As Long, pbInput As Any, ByVal cbInput As Long, ByVal pPaddingInfo As Long, pbOutput As Any, ByVal cbOutput As Long, pcbResult As Long, ByVal dwFlags As Long) As Long</td>
        </tr>
        <tr>
          <td id="L131" data-line-number="131"></td>
          <td id="LC131">Private Declare Function NCryptFreeObject Lib &#34;ncrypt&#34; (ByVal hObject As Long) As Long</td>
        </tr>
        <tr>
          <td id="L132" data-line-number="132"></td>
          <td id="LC132">
</td>
        </tr>
        <tr>
          <td id="L133" data-line-number="133"></td>
          <td id="LC133">Private Type CRYPT_DATA_BLOB</td>
        </tr>
        <tr>
          <td id="L134" data-line-number="134"></td>
          <td id="LC134">    cbData              As Long</td>
        </tr>
        <tr>
          <td id="L135" data-line-number="135"></td>
          <td id="LC135">    pbData              As Long</td>
        </tr>
        <tr>
          <td id="L136" data-line-number="136"></td>
          <td id="LC136">End Type</td>
        </tr>
        <tr>
          <td id="L137" data-line-number="137"></td>
          <td id="LC137">
</td>
        </tr>
        <tr>
          <td id="L138" data-line-number="138"></td>
          <td id="LC138">Private Type CRYPT_BIT_BLOB</td>
        </tr>
        <tr>
          <td id="L139" data-line-number="139"></td>
          <td id="LC139">    cbData              As Long</td>
        </tr>
        <tr>
          <td id="L140" data-line-number="140"></td>
          <td id="LC140">    pbData              As Long</td>
        </tr>
        <tr>
          <td id="L141" data-line-number="141"></td>
          <td id="LC141">    cUnusedBits         As Long</td>
        </tr>
        <tr>
          <td id="L142" data-line-number="142"></td>
          <td id="LC142">End Type</td>
        </tr>
        <tr>
          <td id="L143" data-line-number="143"></td>
          <td id="LC143">
</td>
        </tr>
        <tr>
          <td id="L144" data-line-number="144"></td>
          <td id="LC144">Private Type CRYPT_ALGORITHM_IDENTIFIER</td>
        </tr>
        <tr>
          <td id="L145" data-line-number="145"></td>
          <td id="LC145">    pszObjId            As Long</td>
        </tr>
        <tr>
          <td id="L146" data-line-number="146"></td>
          <td id="LC146">    Parameters          As CRYPT_DATA_BLOB</td>
        </tr>
        <tr>
          <td id="L147" data-line-number="147"></td>
          <td id="LC147">End Type</td>
        </tr>
        <tr>
          <td id="L148" data-line-number="148"></td>
          <td id="LC148">
</td>
        </tr>
        <tr>
          <td id="L149" data-line-number="149"></td>
          <td id="LC149">Private Type CERT_PUBLIC_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L150" data-line-number="150"></td>
          <td id="LC150">    Algorithm           As CRYPT_ALGORITHM_IDENTIFIER</td>
        </tr>
        <tr>
          <td id="L151" data-line-number="151"></td>
          <td id="LC151">    PublicKey           As CRYPT_BIT_BLOB</td>
        </tr>
        <tr>
          <td id="L152" data-line-number="152"></td>
          <td id="LC152">End Type</td>
        </tr>
        <tr>
          <td id="L153" data-line-number="153"></td>
          <td id="LC153">
</td>
        </tr>
        <tr>
          <td id="L154" data-line-number="154"></td>
          <td id="LC154">Private Type CRYPT_ECC_PRIVATE_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L155" data-line-number="155"></td>
          <td id="LC155">    dwVersion           As Long</td>
        </tr>
        <tr>
          <td id="L156" data-line-number="156"></td>
          <td id="LC156">    PrivateKey          As CRYPT_DATA_BLOB</td>
        </tr>
        <tr>
          <td id="L157" data-line-number="157"></td>
          <td id="LC157">    szCurveOid          As Long</td>
        </tr>
        <tr>
          <td id="L158" data-line-number="158"></td>
          <td id="LC158">    PublicKey           As CRYPT_DATA_BLOB</td>
        </tr>
        <tr>
          <td id="L159" data-line-number="159"></td>
          <td id="LC159">End Type</td>
        </tr>
        <tr>
          <td id="L160" data-line-number="160"></td>
          <td id="LC160">
</td>
        </tr>
        <tr>
          <td id="L161" data-line-number="161"></td>
          <td id="LC161">Private Type CRYPT_PRIVATE_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L162" data-line-number="162"></td>
          <td id="LC162">    Version             As Long</td>
        </tr>
        <tr>
          <td id="L163" data-line-number="163"></td>
          <td id="LC163">    Algorithm           As CRYPT_ALGORITHM_IDENTIFIER</td>
        </tr>
        <tr>
          <td id="L164" data-line-number="164"></td>
          <td id="LC164">    PrivateKey          As CRYPT_DATA_BLOB</td>
        </tr>
        <tr>
          <td id="L165" data-line-number="165"></td>
          <td id="LC165">    pAttributes         As Long</td>
        </tr>
        <tr>
          <td id="L166" data-line-number="166"></td>
          <td id="LC166">End Type</td>
        </tr>
        <tr>
          <td id="L167" data-line-number="167"></td>
          <td id="LC167">
</td>
        </tr>
        <tr>
          <td id="L168" data-line-number="168"></td>
          <td id="LC168">Private Type BCRYPT_PSS_PADDING_INFO</td>
        </tr>
        <tr>
          <td id="L169" data-line-number="169"></td>
          <td id="LC169">    pszAlgId            As Long</td>
        </tr>
        <tr>
          <td id="L170" data-line-number="170"></td>
          <td id="LC170">    cbSalt              As Long</td>
        </tr>
        <tr>
          <td id="L171" data-line-number="171"></td>
          <td id="LC171">End Type</td>
        </tr>
        <tr>
          <td id="L172" data-line-number="172"></td>
          <td id="LC172">
</td>
        </tr>
        <tr>
          <td id="L173" data-line-number="173"></td>
          <td id="LC173">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L174" data-line-number="174"></td>
          <td id="LC174">&#39; Constants and member variables</td>
        </tr>
        <tr>
          <td id="L175" data-line-number="175"></td>
          <td id="LC175">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L176" data-line-number="176"></td>
          <td id="LC176">
</td>
        </tr>
        <tr>
          <td id="L177" data-line-number="177"></td>
          <td id="LC177">Private Const STR_VL_ALERTS                             As String = &#34;0|Close notify|10|Unexpected message|20|Bad record mac|21|Decryption failed|22|Record overflow|30|Decompression failure|40|Handshake failure|41|No certificate|42|Bad certificate|43|Unsupported certificate|44|Certificate revoked|45|Certificate expired|46|Certificate unknown|47|Illegal parameter|48|Unknown certificate authority|50|Decode error|51|Decrypt error|70|Protocol version|71|Insufficient security|80|Internal error|90|User canceled|100|No renegotiation|109|Missing extension|110|Unsupported extension|111|Certificate unobtainable|112|Unrecognized name|113|Bad certificate status response|114|Bad certificate hash value|116|Certificate required|120|No application protocol&#34;</td>
        </tr>
        <tr>
          <td id="L178" data-line-number="178"></td>
          <td id="LC178">Private Const STR_VL_STATES                             As String = &#34;0|New|1|Closed|2|HandshakeStart|3|ExpectServerHello|4|ExpectExtensions|5|ExpectServerFinished|6|ExpectClientHello|7|ExpectClientKeyExchange|8|ExpectClientFinished|9|PostHandshake|10|Shutdown&#34;</td>
        </tr>
        <tr>
          <td id="L179" data-line-number="179"></td>
          <td id="LC179">Private Const STR_VL_MESSAGE_NAMES                      As String = &#34;1|client_hello|2|server_hello|4|new_session_ticket|5|end_of_early_data|8|encrypted_extensions|11|certificate|12|server_key_exchange|13|certificate_request|14|server_hello_done|15|certificate_verify|16|client_key_exchange|20|finished|21|certificate_url|22|certificate_status|24|key_update|25|compressed_certificate|254|message_hash&#34;</td>
        </tr>
        <tr>
          <td id="L180" data-line-number="180"></td>
          <td id="LC180">Private Const STR_VL_EXTENSION_NAMES                    As String = &#34;0|server_name|1|max_fragment_length|2|client_certificate_url|3|trusted_ca_keys|4|truncated_hmac|5|status_request|6|user_mapping|7|client_authz|8|server_authz|9|cert_type|10|supported_groups|11|ec_point_formats|12|srp|13|signature_algorithms|14|use_srtp|15|heartbeat|16|application_layer_protocol_negotiation|17|status_request_v2|18|signed_certificate_timestamp|19|client_certificate_type|20|server_certificate_type|21|padding|22|encrypt_then_mac|23|extended_master_secret|24|token_binding|25|cached_info|26|tls_lts|27|compress_certificate|28|record_size_limit|29|pwd_protect|30|pwd_clear|31|password_salt|32|ticket_pinning|33|tls_cert_with_extern_psk|34|delegated_credentials|35|session_ticket|41|pre_shared_key|42|early_data|43|supported_versions|44|cookie|45|psk_key_exchange_modes|47|certificate_authorities|48|oid_filters|49|post_handshake_auth|&#34; &amp; _</td>
        </tr>
        <tr>
          <td id="L181" data-line-number="181"></td>
          <td id="LC181">                                                                    &#34;50|signature_algorithms_cert|51|key_share|52|transparency_info|53|connection_id|55|external_id_hash|56|external_session_id&#34;</td>
        </tr>
        <tr>
          <td id="L182" data-line-number="182"></td>
          <td id="LC182">Private Const STR_UNKNOWN                               As String = &#34;Unknown (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L183" data-line-number="183"></td>
          <td id="LC183">Private Const STR_FORMAT_ALERT                          As String = &#34;%1.&#34;</td>
        </tr>
        <tr>
          <td id="L184" data-line-number="184"></td>
          <td id="LC184">&#39;--- TLS</td>
        </tr>
        <tr>
          <td id="L185" data-line-number="185"></td>
          <td id="LC185">Private Const TLS_PROTOCOL_VERSION_TLS12                As Long = &amp;H303</td>
        </tr>
        <tr>
          <td id="L186" data-line-number="186"></td>
          <td id="LC186">Private Const TLS_PROTOCOL_VERSION_TLS13                As Long = &amp;H304</td>
        </tr>
        <tr>
          <td id="L187" data-line-number="187"></td>
          <td id="LC187">Private Const TLS_RECORD_VERSION                        As Long = TLS_PROTOCOL_VERSION_TLS12 &#39;--- always legacy version</td>
        </tr>
        <tr>
          <td id="L188" data-line-number="188"></td>
          <td id="LC188">Private Const TLS_LOCAL_LEGACY_VERSION                  As Long = TLS_PROTOCOL_VERSION_TLS12</td>
        </tr>
        <tr>
          <td id="L189" data-line-number="189"></td>
          <td id="LC189">&#39;--- TLS ContentType from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-5</td>
        </tr>
        <tr>
          <td id="L190" data-line-number="190"></td>
          <td id="LC190">Private Const TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC       As Long = 20</td>
        </tr>
        <tr>
          <td id="L191" data-line-number="191"></td>
          <td id="LC191">Private Const TLS_CONTENT_TYPE_ALERT                    As Long = 21</td>
        </tr>
        <tr>
          <td id="L192" data-line-number="192"></td>
          <td id="LC192">Private Const TLS_CONTENT_TYPE_HANDSHAKE                As Long = 22</td>
        </tr>
        <tr>
          <td id="L193" data-line-number="193"></td>
          <td id="LC193">Private Const TLS_CONTENT_TYPE_APPDATA                  As Long = 23</td>
        </tr>
        <tr>
          <td id="L194" data-line-number="194"></td>
          <td id="LC194">&#39;--- TLS HandshakeType from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-7</td>
        </tr>
        <tr>
          <td id="L195" data-line-number="195"></td>
          <td id="LC195">Private Const TLS_HANDSHAKE_HELLO_REQUEST               As Long = 0</td>
        </tr>
        <tr>
          <td id="L196" data-line-number="196"></td>
          <td id="LC196">Private Const TLS_HANDSHAKE_CLIENT_HELLO                As Long = 1</td>
        </tr>
        <tr>
          <td id="L197" data-line-number="197"></td>
          <td id="LC197">Private Const TLS_HANDSHAKE_SERVER_HELLO                As Long = 2</td>
        </tr>
        <tr>
          <td id="L198" data-line-number="198"></td>
          <td id="LC198">Private Const TLS_HANDSHAKE_NEW_SESSION_TICKET          As Long = 4</td>
        </tr>
        <tr>
          <td id="L199" data-line-number="199"></td>
          <td id="LC199">&#39;Private Const TLS_HANDSHAKE_END_OF_EARLY_DATA           As Long = 5</td>
        </tr>
        <tr>
          <td id="L200" data-line-number="200"></td>
          <td id="LC200">Private Const TLS_HANDSHAKE_ENCRYPTED_EXTENSIONS        As Long = 8</td>
        </tr>
        <tr>
          <td id="L201" data-line-number="201"></td>
          <td id="LC201">Private Const TLS_HANDSHAKE_CERTIFICATE                 As Long = 11</td>
        </tr>
        <tr>
          <td id="L202" data-line-number="202"></td>
          <td id="LC202">Private Const TLS_HANDSHAKE_SERVER_KEY_EXCHANGE         As Long = 12</td>
        </tr>
        <tr>
          <td id="L203" data-line-number="203"></td>
          <td id="LC203">Private Const TLS_HANDSHAKE_CERTIFICATE_REQUEST         As Long = 13</td>
        </tr>
        <tr>
          <td id="L204" data-line-number="204"></td>
          <td id="LC204">Private Const TLS_HANDSHAKE_SERVER_HELLO_DONE           As Long = 14</td>
        </tr>
        <tr>
          <td id="L205" data-line-number="205"></td>
          <td id="LC205">Private Const TLS_HANDSHAKE_CERTIFICATE_VERIFY          As Long = 15</td>
        </tr>
        <tr>
          <td id="L206" data-line-number="206"></td>
          <td id="LC206">Private Const TLS_HANDSHAKE_CLIENT_KEY_EXCHANGE         As Long = 16</td>
        </tr>
        <tr>
          <td id="L207" data-line-number="207"></td>
          <td id="LC207">Private Const TLS_HANDSHAKE_FINISHED                    As Long = 20</td>
        </tr>
        <tr>
          <td id="L208" data-line-number="208"></td>
          <td id="LC208">Private Const TLS_HANDSHAKE_CERTIFICATE_STATUS          As Long = 22</td>
        </tr>
        <tr>
          <td id="L209" data-line-number="209"></td>
          <td id="LC209">Private Const TLS_HANDSHAKE_KEY_UPDATE                  As Long = 24</td>
        </tr>
        <tr>
          <td id="L210" data-line-number="210"></td>
          <td id="LC210">&#39;Private Const TLS_HANDSHAKE_COMPRESSED_CERTIFICATE      As Long = 25</td>
        </tr>
        <tr>
          <td id="L211" data-line-number="211"></td>
          <td id="LC211">Private Const TLS_HANDSHAKE_MESSAGE_HASH                As Long = 254</td>
        </tr>
        <tr>
          <td id="L212" data-line-number="212"></td>
          <td id="LC212">&#39;--- TLS Extensions from https://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml</td>
        </tr>
        <tr>
          <td id="L213" data-line-number="213"></td>
          <td id="LC213">Private Const TLS_EXTENSION_SERVER_NAME                 As Long = 0</td>
        </tr>
        <tr>
          <td id="L214" data-line-number="214"></td>
          <td id="LC214">Private Const TLS_EXTENSION_STATUS_REQUEST              As Long = 5</td>
        </tr>
        <tr>
          <td id="L215" data-line-number="215"></td>
          <td id="LC215">Private Const TLS_EXTENSION_SUPPORTED_GROUPS            As Long = 10</td>
        </tr>
        <tr>
          <td id="L216" data-line-number="216"></td>
          <td id="LC216">Private Const TLS_EXTENSION_EC_POINT_FORMAT             As Long = 11</td>
        </tr>
        <tr>
          <td id="L217" data-line-number="217"></td>
          <td id="LC217">Private Const TLS_EXTENSION_SIGNATURE_ALGORITHMS        As Long = 13</td>
        </tr>
        <tr>
          <td id="L218" data-line-number="218"></td>
          <td id="LC218">Private Const TLS_EXTENSION_ALPN                        As Long = 16</td>
        </tr>
        <tr>
          <td id="L219" data-line-number="219"></td>
          <td id="LC219">Private Const TLS_EXTENSION_ENCRYPT_THEN_MAC            As Long = 22</td>
        </tr>
        <tr>
          <td id="L220" data-line-number="220"></td>
          <td id="LC220">Private Const TLS_EXTENSION_EXTENDED_MASTER_SECRET      As Long = 23</td>
        </tr>
        <tr>
          <td id="L221" data-line-number="221"></td>
          <td id="LC221">&#39;Private Const TLS_EXTENSION_COMPRESS_CERTIFICATE        As Long = 27</td>
        </tr>
        <tr>
          <td id="L222" data-line-number="222"></td>
          <td id="LC222">Private Const TLS_EXTENSION_SESSION_TICKET              As Long = 35</td>
        </tr>
        <tr>
          <td id="L223" data-line-number="223"></td>
          <td id="LC223">&#39;Private Const TLS_EXTENSION_PRE_SHARED_KEY              As Long = 41</td>
        </tr>
        <tr>
          <td id="L224" data-line-number="224"></td>
          <td id="LC224">&#39;Private Const TLS_EXTENSION_EARLY_DATA                  As Long = 42</td>
        </tr>
        <tr>
          <td id="L225" data-line-number="225"></td>
          <td id="LC225">Private Const TLS_EXTENSION_SUPPORTED_VERSIONS          As Long = 43</td>
        </tr>
        <tr>
          <td id="L226" data-line-number="226"></td>
          <td id="LC226">Private Const TLS_EXTENSION_COOKIE                      As Long = 44</td>
        </tr>
        <tr>
          <td id="L227" data-line-number="227"></td>
          <td id="LC227">&#39;Private Const TLS_EXTENSION_PSK_KEY_EXCHANGE_MODES      As Long = 45</td>
        </tr>
        <tr>
          <td id="L228" data-line-number="228"></td>
          <td id="LC228">Private Const TLS_EXTENSION_CERTIFICATE_AUTHORITIES     As Long = 47</td>
        </tr>
        <tr>
          <td id="L229" data-line-number="229"></td>
          <td id="LC229">Private Const TLS_EXTENSION_POST_HANDSHAKE_AUTH         As Long = 49</td>
        </tr>
        <tr>
          <td id="L230" data-line-number="230"></td>
          <td id="LC230">Private Const TLS_EXTENSION_SIGNATURE_ALGORITHMS_CERT   As Long = 50</td>
        </tr>
        <tr>
          <td id="L231" data-line-number="231"></td>
          <td id="LC231">Private Const TLS_EXTENSION_KEY_SHARE                   As Long = 51</td>
        </tr>
        <tr>
          <td id="L232" data-line-number="232"></td>
          <td id="LC232">Private Const TLS_EXTENSION_RENEGOTIATION_INFO          As Long = &amp;HFF01&amp;</td>
        </tr>
        <tr>
          <td id="L233" data-line-number="233"></td>
          <td id="LC233">&#39;--- TLS Cipher Suites from http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4</td>
        </tr>
        <tr>
          <td id="L234" data-line-number="234"></td>
          <td id="LC234">Private Const TLS_CS_AES_128_GCM_SHA256                 As Long = &amp;H1301</td>
        </tr>
        <tr>
          <td id="L235" data-line-number="235"></td>
          <td id="LC235">Private Const TLS_CS_AES_256_GCM_SHA384                 As Long = &amp;H1302</td>
        </tr>
        <tr>
          <td id="L236" data-line-number="236"></td>
          <td id="LC236">Private Const TLS_CS_CHACHA20_POLY1305_SHA256           As Long = &amp;H1303</td>
        </tr>
        <tr>
          <td id="L237" data-line-number="237"></td>
          <td id="LC237">Private Const TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 As Long = &amp;HC02B&amp;</td>
        </tr>
        <tr>
          <td id="L238" data-line-number="238"></td>
          <td id="LC238">Private Const TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 As Long = &amp;HC02C&amp;</td>
        </tr>
        <tr>
          <td id="L239" data-line-number="239"></td>
          <td id="LC239">Private Const TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256  As Long = &amp;HC02F&amp;</td>
        </tr>
        <tr>
          <td id="L240" data-line-number="240"></td>
          <td id="LC240">Private Const TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384  As Long = &amp;HC030&amp;</td>
        </tr>
        <tr>
          <td id="L241" data-line-number="241"></td>
          <td id="LC241">Private Const TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 As Long = &amp;HCCA8&amp;</td>
        </tr>
        <tr>
          <td id="L242" data-line-number="242"></td>
          <td id="LC242">Private Const TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 As Long = &amp;HCCA9&amp;</td>
        </tr>
        <tr>
          <td id="L243" data-line-number="243"></td>
          <td id="LC243">Private Const TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA   As Long = &amp;HC009&amp;</td>
        </tr>
        <tr>
          <td id="L244" data-line-number="244"></td>
          <td id="LC244">Private Const TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA   As Long = &amp;HC00A&amp;</td>
        </tr>
        <tr>
          <td id="L245" data-line-number="245"></td>
          <td id="LC245">Private Const TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA     As Long = &amp;HC013&amp;</td>
        </tr>
        <tr>
          <td id="L246" data-line-number="246"></td>
          <td id="LC246">Private Const TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA     As Long = &amp;HC014&amp;</td>
        </tr>
        <tr>
          <td id="L247" data-line-number="247"></td>
          <td id="LC247">Private Const TLS_CS_RSA_WITH_AES_128_CBC_SHA           As Long = &amp;H2F</td>
        </tr>
        <tr>
          <td id="L248" data-line-number="248"></td>
          <td id="LC248">Private Const TLS_CS_RSA_WITH_AES_256_CBC_SHA           As Long = &amp;H35</td>
        </tr>
        <tr>
          <td id="L249" data-line-number="249"></td>
          <td id="LC249">Private Const TLS_CS_RSA_WITH_AES_128_GCM_SHA256        As Long = &amp;H9C</td>
        </tr>
        <tr>
          <td id="L250" data-line-number="250"></td>
          <td id="LC250">Private Const TLS_CS_RSA_WITH_AES_256_GCM_SHA384        As Long = &amp;H9D</td>
        </tr>
        <tr>
          <td id="L251" data-line-number="251"></td>
          <td id="LC251">Private Const TLS_CS_EMPTY_RENEGOTIATION_INFO_SCSV      As Long = &amp;HFF</td>
        </tr>
        <tr>
          <td id="L252" data-line-number="252"></td>
          <td id="LC252">Private Const TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 As Long = &amp;HC023&amp;</td>
        </tr>
        <tr>
          <td id="L253" data-line-number="253"></td>
          <td id="LC253">Private Const TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 As Long = &amp;HC024&amp;</td>
        </tr>
        <tr>
          <td id="L254" data-line-number="254"></td>
          <td id="LC254">Private Const TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256  As Long = &amp;HC027&amp;</td>
        </tr>
        <tr>
          <td id="L255" data-line-number="255"></td>
          <td id="LC255">Private Const TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384  As Long = &amp;HC028&amp;</td>
        </tr>
        <tr>
          <td id="L256" data-line-number="256"></td>
          <td id="LC256">Private Const TLS_CS_RSA_WITH_AES_128_CBC_SHA256        As Long = &amp;H3C</td>
        </tr>
        <tr>
          <td id="L257" data-line-number="257"></td>
          <td id="LC257">Private Const TLS_CS_RSA_WITH_AES_256_CBC_SHA256        As Long = &amp;H3D</td>
        </tr>
        <tr>
          <td id="L258" data-line-number="258"></td>
          <td id="LC258">&#39;--- TLS Supported Groups from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8</td>
        </tr>
        <tr>
          <td id="L259" data-line-number="259"></td>
          <td id="LC259">Private Const TLS_GROUP_SECP256R1                       As Long = 23</td>
        </tr>
        <tr>
          <td id="L260" data-line-number="260"></td>
          <td id="LC260">Private Const TLS_GROUP_SECP384R1                       As Long = 24</td>
        </tr>
        <tr>
          <td id="L261" data-line-number="261"></td>
          <td id="LC261">Private Const TLS_GROUP_SECP521R1                       As Long = 25</td>
        </tr>
        <tr>
          <td id="L262" data-line-number="262"></td>
          <td id="LC262">Private Const TLS_GROUP_X25519                          As Long = 29</td>
        </tr>
        <tr>
          <td id="L263" data-line-number="263"></td>
          <td id="LC263">Private Const TLS_GROUP_X448                            As Long = 30</td>
        </tr>
        <tr>
          <td id="L264" data-line-number="264"></td>
          <td id="LC264">Private Const TLS_GROUP_FFDHE_FIRST                     As Long = &amp;H100</td>
        </tr>
        <tr>
          <td id="L265" data-line-number="265"></td>
          <td id="LC265">Private Const TLS_GROUP_FFDHE_LAST                      As Long = &amp;H104</td>
        </tr>
        <tr>
          <td id="L266" data-line-number="266"></td>
          <td id="LC266">Private Const TLS_GROUP_FFDHE_PRIVATE_USE_FIRST         As Long = &amp;H1FC</td>
        </tr>
        <tr>
          <td id="L267" data-line-number="267"></td>
          <td id="LC267">Private Const TLS_GROUP_FFDHE_PRIVATE_USE_LAST          As Long = &amp;H1FF</td>
        </tr>
        <tr>
          <td id="L268" data-line-number="268"></td>
          <td id="LC268">Private Const TLS_GROUP_ECDHE_PRIVATE_USE_FIRST         As Long = &amp;HFE00&amp;</td>
        </tr>
        <tr>
          <td id="L269" data-line-number="269"></td>
          <td id="LC269">Private Const TLS_GROUP_ECDHE_PRIVATE_USE_LAST          As Long = &amp;HFEFF&amp;</td>
        </tr>
        <tr>
          <td id="L270" data-line-number="270"></td>
          <td id="LC270">&#39;--- TLS Signature Scheme from https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-signaturescheme</td>
        </tr>
        <tr>
          <td id="L271" data-line-number="271"></td>
          <td id="LC271">Private Const TLS_SIGNATURE_RSA_PKCS1_SHA1              As Long = &amp;H201 &#39;--- TLS 1.2</td>
        </tr>
        <tr>
          <td id="L272" data-line-number="272"></td>
          <td id="LC272">Private Const TLS_SIGNATURE_ECDSA_SHA1                  As Long = &amp;H203</td>
        </tr>
        <tr>
          <td id="L273" data-line-number="273"></td>
          <td id="LC273">Private Const TLS_SIGNATURE_RSA_PKCS1_SHA224            As Long = &amp;H301</td>
        </tr>
        <tr>
          <td id="L274" data-line-number="274"></td>
          <td id="LC274">Private Const TLS_SIGNATURE_RSA_PKCS1_SHA256            As Long = &amp;H401</td>
        </tr>
        <tr>
          <td id="L275" data-line-number="275"></td>
          <td id="LC275">Private Const TLS_SIGNATURE_RSA_PKCS1_SHA384            As Long = &amp;H501</td>
        </tr>
        <tr>
          <td id="L276" data-line-number="276"></td>
          <td id="LC276">Private Const TLS_SIGNATURE_RSA_PKCS1_SHA512            As Long = &amp;H601</td>
        </tr>
        <tr>
          <td id="L277" data-line-number="277"></td>
          <td id="LC277">Private Const TLS_SIGNATURE_ECDSA_SECP256R1_SHA256      As Long = &amp;H403 &#39;--- TLS 1.3</td>
        </tr>
        <tr>
          <td id="L278" data-line-number="278"></td>
          <td id="LC278">Private Const TLS_SIGNATURE_ECDSA_SECP384R1_SHA384      As Long = &amp;H503</td>
        </tr>
        <tr>
          <td id="L279" data-line-number="279"></td>
          <td id="LC279">Private Const TLS_SIGNATURE_ECDSA_SECP521R1_SHA512      As Long = &amp;H603</td>
        </tr>
        <tr>
          <td id="L280" data-line-number="280"></td>
          <td id="LC280">Private Const TLS_SIGNATURE_RSA_PSS_RSAE_SHA256         As Long = &amp;H804</td>
        </tr>
        <tr>
          <td id="L281" data-line-number="281"></td>
          <td id="LC281">Private Const TLS_SIGNATURE_RSA_PSS_RSAE_SHA384         As Long = &amp;H805</td>
        </tr>
        <tr>
          <td id="L282" data-line-number="282"></td>
          <td id="LC282">Private Const TLS_SIGNATURE_RSA_PSS_RSAE_SHA512         As Long = &amp;H806</td>
        </tr>
        <tr>
          <td id="L283" data-line-number="283"></td>
          <td id="LC283">&#39;Private Const TLS_SIGNATURE_ED25519                     As Long = &amp;H807</td>
        </tr>
        <tr>
          <td id="L284" data-line-number="284"></td>
          <td id="LC284">&#39;Private Const TLS_SIGNATURE_ED448                       As Long = &amp;H808</td>
        </tr>
        <tr>
          <td id="L285" data-line-number="285"></td>
          <td id="LC285">Private Const TLS_SIGNATURE_RSA_PSS_PSS_SHA256          As Long = &amp;H809</td>
        </tr>
        <tr>
          <td id="L286" data-line-number="286"></td>
          <td id="LC286">Private Const TLS_SIGNATURE_RSA_PSS_PSS_SHA384          As Long = &amp;H80A</td>
        </tr>
        <tr>
          <td id="L287" data-line-number="287"></td>
          <td id="LC287">Private Const TLS_SIGNATURE_RSA_PSS_PSS_SHA512          As Long = &amp;H80B</td>
        </tr>
        <tr>
          <td id="L288" data-line-number="288"></td>
          <td id="LC288">Private Const TLS_ALERT_LEVEL_WARNING                   As Long = 1</td>
        </tr>
        <tr>
          <td id="L289" data-line-number="289"></td>
          <td id="LC289">Private Const TLS_ALERT_LEVEL_FATAL                     As Long = 2</td>
        </tr>
        <tr>
          <td id="L290" data-line-number="290"></td>
          <td id="LC290">Private Const TLS_COMPRESS_NULL                         As Long = 0</td>
        </tr>
        <tr>
          <td id="L291" data-line-number="291"></td>
          <td id="LC291">Private Const TLS_SERVER_NAME_TYPE_HOSTNAME             As Long = 0</td>
        </tr>
        <tr>
          <td id="L292" data-line-number="292"></td>
          <td id="LC292">Private Const TLS_MAX_PLAINTEXT_RECORD_SIZE             As Long = 16384</td>
        </tr>
        <tr>
          <td id="L293" data-line-number="293"></td>
          <td id="LC293">Private Const TLS_MAX_ENCRYPTED_RECORD_SIZE             As Long = TLS_MAX_PLAINTEXT_RECORD_SIZE + 1 + 255 &#39;-- 1 byte content type + 255 bytes AEAD padding</td>
        </tr>
        <tr>
          <td id="L294" data-line-number="294"></td>
          <td id="LC294">Private Const TLS_HELLO_RANDOM_SIZE                     As Long = 32</td>
        </tr>
        <tr>
          <td id="L295" data-line-number="295"></td>
          <td id="LC295">Private Const TLS_LEGACY_SECRET_SIZE                    As Long = 48</td>
        </tr>
        <tr>
          <td id="L296" data-line-number="296"></td>
          <td id="LC296">Private Const TLS_LEGACY_SESSIONID_SIZE                 As Long = 32</td>
        </tr>
        <tr>
          <td id="L297" data-line-number="297"></td>
          <td id="LC297">Private Const TLS_AAD_SIZE                              As Long = 5     &#39;--- size of additional authenticated data for TLS 1.3</td>
        </tr>
        <tr>
          <td id="L298" data-line-number="298"></td>
          <td id="LC298">Private Const TLS_LEGACY_AAD_SIZE                       As Long = 13    &#39;--- for TLS 1.2</td>
        </tr>
        <tr>
          <td id="L299" data-line-number="299"></td>
          <td id="LC299">Private Const TLS_VERIFY_DATA_SIZE                      As Long = 12</td>
        </tr>
        <tr>
          <td id="L300" data-line-number="300"></td>
          <td id="LC300">&#39;Private Const TLS_PSK_KE_MODE_PSK_DHE                   As Long = 1</td>
        </tr>
        <tr>
          <td id="L301" data-line-number="301"></td>
          <td id="LC301">&#39;--- crypto constants</td>
        </tr>
        <tr>
          <td id="L302" data-line-number="302"></td>
          <td id="LC302">Private Const LNG_X25519_KEYSZ                          As Long = 32</td>
        </tr>
        <tr>
          <td id="L303" data-line-number="303"></td>
          <td id="LC303">Private Const LNG_SECP256R1_KEYSZ                       As Long = 32</td>
        </tr>
        <tr>
          <td id="L304" data-line-number="304"></td>
          <td id="LC304">Private Const LNG_SECP384R1_KEYSZ                       As Long = 48</td>
        </tr>
        <tr>
          <td id="L305" data-line-number="305"></td>
          <td id="LC305">Private Const LNG_MD5_HASHSZ                            As Long = 16</td>
        </tr>
        <tr>
          <td id="L306" data-line-number="306"></td>
          <td id="LC306">&#39;Private Const LNG_MD5_BLOCKSZ                           As Long = 64</td>
        </tr>
        <tr>
          <td id="L307" data-line-number="307"></td>
          <td id="LC307">Private Const LNG_SHA1_HASHSZ                           As Long = 20</td>
        </tr>
        <tr>
          <td id="L308" data-line-number="308"></td>
          <td id="LC308">Private Const LNG_SHA1_BLOCKSZ                          As Long = 64</td>
        </tr>
        <tr>
          <td id="L309" data-line-number="309"></td>
          <td id="LC309">Private Const LNG_SHA224_HASHSZ                         As Long = 28</td>
        </tr>
        <tr>
          <td id="L310" data-line-number="310"></td>
          <td id="LC310">&#39;Private Const LNG_SHA224_BLOCKSZ                        As Long = 64</td>
        </tr>
        <tr>
          <td id="L311" data-line-number="311"></td>
          <td id="LC311">Private Const LNG_SHA256_HASHSZ                         As Long = 32</td>
        </tr>
        <tr>
          <td id="L312" data-line-number="312"></td>
          <td id="LC312">Private Const LNG_SHA256_BLOCKSZ                        As Long = 64</td>
        </tr>
        <tr>
          <td id="L313" data-line-number="313"></td>
          <td id="LC313">Private Const LNG_SHA384_HASHSZ                         As Long = 48</td>
        </tr>
        <tr>
          <td id="L314" data-line-number="314"></td>
          <td id="LC314">Private Const LNG_SHA384_BLOCKSZ                        As Long = 128</td>
        </tr>
        <tr>
          <td id="L315" data-line-number="315"></td>
          <td id="LC315">Private Const LNG_SHA384_CONTEXTSZ                      As Long = 200</td>
        </tr>
        <tr>
          <td id="L316" data-line-number="316"></td>
          <td id="LC316">Private Const LNG_SHA512_HASHSZ                         As Long = 64</td>
        </tr>
        <tr>
          <td id="L317" data-line-number="317"></td>
          <td id="LC317">Private Const LNG_SHA512_BLOCKSZ                        As Long = 128</td>
        </tr>
        <tr>
          <td id="L318" data-line-number="318"></td>
          <td id="LC318">Private Const LNG_CHACHA20_KEYSZ                        As Long = 32</td>
        </tr>
        <tr>
          <td id="L319" data-line-number="319"></td>
          <td id="LC319">Private Const LNG_CHACHA20POLY1305_IVSZ                 As Long = 12</td>
        </tr>
        <tr>
          <td id="L320" data-line-number="320"></td>
          <td id="LC320">Private Const LNG_CHACHA20POLY1305_TAGSZ                As Long = 16</td>
        </tr>
        <tr>
          <td id="L321" data-line-number="321"></td>
          <td id="LC321">Private Const LNG_AES128_KEYSZ                          As Long = 16</td>
        </tr>
        <tr>
          <td id="L322" data-line-number="322"></td>
          <td id="LC322">Private Const LNG_AES256_KEYSZ                          As Long = 32</td>
        </tr>
        <tr>
          <td id="L323" data-line-number="323"></td>
          <td id="LC323">Private Const LNG_AESGCM_IVSZ                           As Long = 12</td>
        </tr>
        <tr>
          <td id="L324" data-line-number="324"></td>
          <td id="LC324">Private Const LNG_AESGCM_TAGSZ                          As Long = 16</td>
        </tr>
        <tr>
          <td id="L325" data-line-number="325"></td>
          <td id="LC325">Private Const LNG_AESCBC_IVSZ                           As Long = 16</td>
        </tr>
        <tr>
          <td id="L326" data-line-number="326"></td>
          <td id="LC326">Private Const LNG_ANS1_TYPE_SEQUENCE                    As Long = &amp;H30</td>
        </tr>
        <tr>
          <td id="L327" data-line-number="327"></td>
          <td id="LC327">Private Const LNG_ANS1_TYPE_INTEGER                     As Long = &amp;H2</td>
        </tr>
        <tr>
          <td id="L328" data-line-number="328"></td>
          <td id="LC328">Private Const LNG_HMAC_INNER_PAD                        As Long = &amp;H36</td>
        </tr>
        <tr>
          <td id="L329" data-line-number="329"></td>
          <td id="LC329">Private Const LNG_HMAC_OUTER_PAD                        As Long = &amp;H5C</td>
        </tr>
        <tr>
          <td id="L330" data-line-number="330"></td>
          <td id="LC330">&#39;--- errors</td>
        </tr>
        <tr>
          <td id="L331" data-line-number="331"></td>
          <td id="LC331">Private Const ERR_CONNECTION_CLOSED                     As String = &#34;Connection closed&#34;</td>
        </tr>
        <tr>
          <td id="L332" data-line-number="332"></td>
          <td id="LC332">Private Const ERR_GENER_KEYPAIR_FAILED                  As String = &#34;Failed generating key pair (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L333" data-line-number="333"></td>
          <td id="LC333">Private Const ERR_UNSUPPORTED_EXCH_GROUP                As String = &#34;Unsupported exchange group (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L334" data-line-number="334"></td>
          <td id="LC334">Private Const ERR_UNSUPPORTED_CIPHER_SUITE              As String = &#34;Unsupported cipher suite (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L335" data-line-number="335"></td>
          <td id="LC335">Private Const ERR_UNSUPPORTED_SIGNATURE_SCHEME          As String = &#34;Unsupported signature scheme (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L336" data-line-number="336"></td>
          <td id="LC336">Private Const ERR_UNSUPPORTED_CERTIFICATE               As String = &#34;Unsupported certificate&#34;</td>
        </tr>
        <tr>
          <td id="L337" data-line-number="337"></td>
          <td id="LC337">Private Const ERR_UNSUPPORTED_PUBLIC_KEY                As String = &#34;Unsupported public key OID (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L338" data-line-number="338"></td>
          <td id="LC338">Private Const ERR_UNSUPPORTED_PRIVATE_KEY               As String = &#34;Unsupported private key&#34;</td>
        </tr>
        <tr>
          <td id="L339" data-line-number="339"></td>
          <td id="LC339">Private Const ERR_UNSUPPORTED_CURVE_SIZE                As String = &#34;Unsupported curve size (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L340" data-line-number="340"></td>
          <td id="LC340">Private Const ERR_UNSUPPORTED_CURVE_TYPE                As String = &#34;Unsupported curve type (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L341" data-line-number="341"></td>
          <td id="LC341">Private Const ERR_UNSUPPORTED_PROTOCOL                  As String = &#34;Invalid protocol version (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L342" data-line-number="342"></td>
          <td id="LC342">Private Const ERR_ENCRYPTION_FAILED                     As String = &#34;Encryption failed&#34;</td>
        </tr>
        <tr>
          <td id="L343" data-line-number="343"></td>
          <td id="LC343">Private Const ERR_SIGNATURE_FAILED                      As String = &#34;Certificate signature failed (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L344" data-line-number="344"></td>
          <td id="LC344">Private Const ERR_DECRYPTION_FAILED                     As String = &#34;Decryption failed&#34;</td>
        </tr>
        <tr>
          <td id="L345" data-line-number="345"></td>
          <td id="LC345">Private Const ERR_SERVER_HANDSHAKE_FAILED               As String = &#34;Handshake verification failed&#34;</td>
        </tr>
        <tr>
          <td id="L346" data-line-number="346"></td>
          <td id="LC346">Private Const ERR_RECORD_MAC_FAILED                     As String = &#34;MAC verification failed&#34;</td>
        </tr>
        <tr>
          <td id="L347" data-line-number="347"></td>
          <td id="LC347">Private Const ERR_HELLO_RETRY_FAILED                    As String = &#34;HelloRetryRequest failed&#34;</td>
        </tr>
        <tr>
          <td id="L348" data-line-number="348"></td>
          <td id="LC348">Private Const ERR_NEGOTIATE_SIGNATURE_FAILED            As String = &#34;Negotiate signature type failed&#34;</td>
        </tr>
        <tr>
          <td id="L349" data-line-number="349"></td>
          <td id="LC349">Private Const ERR_SECURE_RENEGOTIATION_FAILED           As String = &#34;Secure renegotiation failed&#34;</td>
        </tr>
        <tr>
          <td id="L350" data-line-number="350"></td>
          <td id="LC350">Private Const ERR_CALL_FAILED                           As String = &#34;Call failed (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L351" data-line-number="351"></td>
          <td id="LC351">Private Const ERR_RECORD_OVERFLOW                       As String = &#34;Record size too big&#34;</td>
        </tr>
        <tr>
          <td id="L352" data-line-number="352"></td>
          <td id="LC352">Private Const ERR_FATAL_ALERT                           As String = &#34;Received fatal alert&#34;</td>
        </tr>
        <tr>
          <td id="L353" data-line-number="353"></td>
          <td id="LC353">Private Const ERR_UNEXPECTED_RECORD_TYPE                As String = &#34;Unexpected record type (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L354" data-line-number="354"></td>
          <td id="LC354">Private Const ERR_UNEXPECTED_MSG_TYPE                   As String = &#34;Unexpected message type for %1 state (%2)&#34;</td>
        </tr>
        <tr>
          <td id="L355" data-line-number="355"></td>
          <td id="LC355">Private Const ERR_UNEXPECTED_EXTENSION                  As String = &#34;Unexpected extension (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L356" data-line-number="356"></td>
          <td id="LC356">Private Const ERR_INVALID_STATE_HANDSHAKE               As String = &#34;Invalid state for handshake content (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L357" data-line-number="357"></td>
          <td id="LC357">Private Const ERR_INVALID_REMOTE_KEY                    As String = &#34;Invalid remote key&#34;</td>
        </tr>
        <tr>
          <td id="L358" data-line-number="358"></td>
          <td id="LC358">Private Const ERR_INVALID_SIZE                          As String = &#34;Invalid data size&#34;</td>
        </tr>
        <tr>
          <td id="L359" data-line-number="359"></td>
          <td id="LC359">Private Const ERR_INVALID_SIZE_EXTENSION                As String = &#34;Invalid data size for %1&#34;</td>
        </tr>
        <tr>
          <td id="L360" data-line-number="360"></td>
          <td id="LC360">Private Const ERR_INVALID_SIGNATURE                     As String = &#34;Invalid certificate signature&#34;</td>
        </tr>
        <tr>
          <td id="L361" data-line-number="361"></td>
          <td id="LC361">Private Const ERR_INVALID_HASH_SIZE                     As String = &#34;Invalid hash size (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L362" data-line-number="362"></td>
          <td id="LC362">Private Const ERR_NO_HANDSHAKE_MESSAGES                 As String = &#34;Missing handshake messages&#34;</td>
        </tr>
        <tr>
          <td id="L363" data-line-number="363"></td>
          <td id="LC363">Private Const ERR_NO_PREVIOUS_SECRET                    As String = &#34;Missing previous %1&#34;</td>
        </tr>
        <tr>
          <td id="L364" data-line-number="364"></td>
          <td id="LC364">Private Const ERR_NO_REMOTE_RANDOM                      As String = &#34;Missing remote random&#34;</td>
        </tr>
        <tr>
          <td id="L365" data-line-number="365"></td>
          <td id="LC365">Private Const ERR_NO_SERVER_CERTIFICATE                 As String = &#34;Missing server certificate&#34;</td>
        </tr>
        <tr>
          <td id="L366" data-line-number="366"></td>
          <td id="LC366">Private Const ERR_NO_SUPPORTED_CIPHER_SUITE             As String = &#34;Missing supported ciphersuite (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L367" data-line-number="367"></td>
          <td id="LC367">Private Const ERR_NO_CERTIFICATE                        As String = &#34;Missing certificate&#34;</td>
        </tr>
        <tr>
          <td id="L368" data-line-number="368"></td>
          <td id="LC368">Private Const ERR_NO_SERVER_COMPILED                    As String = &#34;Server-side TLS not compiled (ASYNCSOCKET_NO_TLSSERVER = 1)&#34;</td>
        </tr>
        <tr>
          <td id="L369" data-line-number="369"></td>
          <td id="LC369">Private Const ERR_NO_SUPPORTED_GROUPS                   As String = &#34;Missing supported remote group&#34;</td>
        </tr>
        <tr>
          <td id="L370" data-line-number="370"></td>
          <td id="LC370">Private Const ERR_NO_ALPN_NEGOTIATED                    As String = &#34;No application protocol negotiated&#34;</td>
        </tr>
        <tr>
          <td id="L371" data-line-number="371"></td>
          <td id="LC371">Private Const ERR_NO_EXTENSION                          As String = &#34;Missing extension (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L372" data-line-number="372"></td>
          <td id="LC372">Private Const ERR_UNSUPPORTED_REQUEST_UPDATE            As String = &#34;Unsupported request update (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L373" data-line-number="373"></td>
          <td id="LC373">Private Const ERR_INVALID_COMPRESSION                   As String = &#34;Invalid compression (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L374" data-line-number="374"></td>
          <td id="LC374">Private Const ERR_INVALID_SERVER_NAME                   As String = &#34;Invalid server name (%1)&#34;</td>
        </tr>
        <tr>
          <td id="L375" data-line-number="375"></td>
          <td id="LC375">Private Const ERR_MISSING_TRAFFIC_KEYS                  As String = &#34;Missing remote traffic keys&#34;</td>
        </tr>
        <tr>
          <td id="L376" data-line-number="376"></td>
          <td id="LC376">&#39;--- numeric</td>
        </tr>
        <tr>
          <td id="L377" data-line-number="377"></td>
          <td id="LC377">Private Const LNG_FACILITY_WIN32                        As Long = &amp;H80070000</td>
        </tr>
        <tr>
          <td id="L378" data-line-number="378"></td>
          <td id="LC378">
</td>
        </tr>
        <tr>
          <td id="L379" data-line-number="379"></td>
          <td id="LC379">Private m_baBuffer()                As Byte</td>
        </tr>
        <tr>
          <td id="L380" data-line-number="380"></td>
          <td id="LC380">Private m_lBuffIdx                  As Long</td>
        </tr>
        <tr>
          <td id="L381" data-line-number="381"></td>
          <td id="LC381">Private m_uData                     As UcsCryptoData</td>
        </tr>
        <tr>
          <td id="L382" data-line-number="382"></td>
          <td id="LC382">Private m_baHelloRetryRandom()      As Byte</td>
        </tr>
        <tr>
          <td id="L383" data-line-number="383"></td>
          <td id="LC383">Public g_oRequestSocket             As Object</td>
        </tr>
        <tr>
          <td id="L384" data-line-number="384"></td>
          <td id="LC384">
</td>
        </tr>
        <tr>
          <td id="L385" data-line-number="385"></td>
          <td id="LC385">Private Enum UcsTlsLocalFeaturesEnum &#39;--- bitmask</td>
        </tr>
        <tr>
          <td id="L386" data-line-number="386"></td>
          <td id="LC386">    ucsTlsSupportTls10 = 2 ^ 0</td>
        </tr>
        <tr>
          <td id="L387" data-line-number="387"></td>
          <td id="LC387">    ucsTlsSupportTls11 = 2 ^ 1</td>
        </tr>
        <tr>
          <td id="L388" data-line-number="388"></td>
          <td id="LC388">    ucsTlsSupportTls12 = 2 ^ 2</td>
        </tr>
        <tr>
          <td id="L389" data-line-number="389"></td>
          <td id="LC389">    ucsTlsSupportTls13 = 2 ^ 3</td>
        </tr>
        <tr>
          <td id="L390" data-line-number="390"></td>
          <td id="LC390">    ucsTlsIgnoreServerCertificateErrors = 2 ^ 4</td>
        </tr>
        <tr>
          <td id="L391" data-line-number="391"></td>
          <td id="LC391">    ucsTlsSupportAll = ucsTlsSupportTls10 Or ucsTlsSupportTls11 Or ucsTlsSupportTls12 Or ucsTlsSupportTls13</td>
        </tr>
        <tr>
          <td id="L392" data-line-number="392"></td>
          <td id="LC392">End Enum</td>
        </tr>
        <tr>
          <td id="L393" data-line-number="393"></td>
          <td id="LC393">
</td>
        </tr>
        <tr>
          <td id="L394" data-line-number="394"></td>
          <td id="LC394">Private Enum UcsTlsStatesEnum &#39;--- sync w/ STR_VL_STATES</td>
        </tr>
        <tr>
          <td id="L395" data-line-number="395"></td>
          <td id="LC395">    ucsTlsStateNew = 0</td>
        </tr>
        <tr>
          <td id="L396" data-line-number="396"></td>
          <td id="LC396">    ucsTlsStateClosed = 1</td>
        </tr>
        <tr>
          <td id="L397" data-line-number="397"></td>
          <td id="LC397">    ucsTlsStateHandshakeStart = 2</td>
        </tr>
        <tr>
          <td id="L398" data-line-number="398"></td>
          <td id="LC398">    ucsTlsStateExpectServerHello = 3</td>
        </tr>
        <tr>
          <td id="L399" data-line-number="399"></td>
          <td id="LC399">    ucsTlsStateExpectEncryptedExtensions = 4</td>
        </tr>
        <tr>
          <td id="L400" data-line-number="400"></td>
          <td id="LC400">    ucsTlsStateExpectServerFinished = 5     &#39;--- not used in TLS 1.3</td>
        </tr>
        <tr>
          <td id="L401" data-line-number="401"></td>
          <td id="LC401">#If ImplTlsServer Then</td>
        </tr>
        <tr>
          <td id="L402" data-line-number="402"></td>
          <td id="LC402">    ucsTlsStateExpectClientHello = 6</td>
        </tr>
        <tr>
          <td id="L403" data-line-number="403"></td>
          <td id="LC403">    ucsTlsStateExpectClientKeyExchange = 7  &#39;--- not used in TLS 1.3</td>
        </tr>
        <tr>
          <td id="L404" data-line-number="404"></td>
          <td id="LC404">    ucsTlsStateExpectClientFinished = 8</td>
        </tr>
        <tr>
          <td id="L405" data-line-number="405"></td>
          <td id="LC405">#End If</td>
        </tr>
        <tr>
          <td id="L406" data-line-number="406"></td>
          <td id="LC406">    ucsTlsStatePostHandshake = 9</td>
        </tr>
        <tr>
          <td id="L407" data-line-number="407"></td>
          <td id="LC407">    ucsTlsStateShutdown = 10</td>
        </tr>
        <tr>
          <td id="L408" data-line-number="408"></td>
          <td id="LC408">End Enum</td>
        </tr>
        <tr>
          <td id="L409" data-line-number="409"></td>
          <td id="LC409">
</td>
        </tr>
        <tr>
          <td id="L410" data-line-number="410"></td>
          <td id="LC410">Private Enum UcsTlsCryptoAlgorithmsEnum</td>
        </tr>
        <tr>
          <td id="L411" data-line-number="411"></td>
          <td id="LC411">    &#39;--- key exchange</td>
        </tr>
        <tr>
          <td id="L412" data-line-number="412"></td>
          <td id="LC412">    ucsTlsAlgoExchX25519 = 1</td>
        </tr>
        <tr>
          <td id="L413" data-line-number="413"></td>
          <td id="LC413">    ucsTlsAlgoExchSecp256r1</td>
        </tr>
        <tr>
          <td id="L414" data-line-number="414"></td>
          <td id="LC414">    ucsTlsAlgoExchSecp384r1</td>
        </tr>
        <tr>
          <td id="L415" data-line-number="415"></td>
          <td id="LC415">    ucsTlsAlgoExchSecp521r1</td>
        </tr>
        <tr>
          <td id="L416" data-line-number="416"></td>
          <td id="LC416">    ucsTlsAlgoExchCertificate</td>
        </tr>
        <tr>
          <td id="L417" data-line-number="417"></td>
          <td id="LC417">    &#39;--- ciphers</td>
        </tr>
        <tr>
          <td id="L418" data-line-number="418"></td>
          <td id="LC418">    ucsTlsAlgoBulkChacha20Poly1305 = 11 &#39;--- next 3 are authenticated encryption w/ additional data</td>
        </tr>
        <tr>
          <td id="L419" data-line-number="419"></td>
          <td id="LC419">    ucsTlsAlgoBulkAesGcm128</td>
        </tr>
        <tr>
          <td id="L420" data-line-number="420"></td>
          <td id="LC420">    ucsTlsAlgoBulkAesGcm256</td>
        </tr>
        <tr>
          <td id="L421" data-line-number="421"></td>
          <td id="LC421">    ucsTlsAlgoBulkAesCbc128             &#39;--- next 2 are legacy non-AEAD</td>
        </tr>
        <tr>
          <td id="L422" data-line-number="422"></td>
          <td id="LC422">    ucsTlsAlgoBulkAesCbc256</td>
        </tr>
        <tr>
          <td id="L423" data-line-number="423"></td>
          <td id="LC423">    &#39;--- hash</td>
        </tr>
        <tr>
          <td id="L424" data-line-number="424"></td>
          <td id="LC424">    ucsTlsAlgoDigestMd5 = 21</td>
        </tr>
        <tr>
          <td id="L425" data-line-number="425"></td>
          <td id="LC425">    ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L426" data-line-number="426"></td>
          <td id="LC426">    ucsTlsAlgoDigestSha224</td>
        </tr>
        <tr>
          <td id="L427" data-line-number="427"></td>
          <td id="LC427">    ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L428" data-line-number="428"></td>
          <td id="LC428">    ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L429" data-line-number="429"></td>
          <td id="LC429">    ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L430" data-line-number="430"></td>
          <td id="LC430">    &#39;--- padding</td>
        </tr>
        <tr>
          <td id="L431" data-line-number="431"></td>
          <td id="LC431">    ucsTlsAlgoPaddingPkcs = 31</td>
        </tr>
        <tr>
          <td id="L432" data-line-number="432"></td>
          <td id="LC432">    ucsTlsAlgoPaddingPss</td>
        </tr>
        <tr>
          <td id="L433" data-line-number="433"></td>
          <td id="LC433">End Enum</td>
        </tr>
        <tr>
          <td id="L434" data-line-number="434"></td>
          <td id="LC434">
</td>
        </tr>
        <tr>
          <td id="L435" data-line-number="435"></td>
          <td id="LC435">&#39;--- TLS Alerts https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-6</td>
        </tr>
        <tr>
          <td id="L436" data-line-number="436"></td>
          <td id="LC436">Private Enum UcsTlsAlertDescriptionsEnum</td>
        </tr>
        <tr>
          <td id="L437" data-line-number="437"></td>
          <td id="LC437">    uscTlsAlertCloseNotify = 0</td>
        </tr>
        <tr>
          <td id="L438" data-line-number="438"></td>
          <td id="LC438">    uscTlsAlertUnexpectedMessage = 10</td>
        </tr>
        <tr>
          <td id="L439" data-line-number="439"></td>
          <td id="LC439">    uscTlsAlertBadRecordMac = 20</td>
        </tr>
        <tr>
          <td id="L440" data-line-number="440"></td>
          <td id="LC440">    uscTlsAlertRecordOverflow = 22</td>
        </tr>
        <tr>
          <td id="L441" data-line-number="441"></td>
          <td id="LC441">    uscTlsAlertHandshakeFailure = 40</td>
        </tr>
        <tr>
          <td id="L442" data-line-number="442"></td>
          <td id="LC442">    uscTlsAlertBadCertificate = 42</td>
        </tr>
        <tr>
          <td id="L443" data-line-number="443"></td>
          <td id="LC443">    uscTlsAlertCertificateRevoked = 44</td>
        </tr>
        <tr>
          <td id="L444" data-line-number="444"></td>
          <td id="LC444">    uscTlsAlertCertificateExpired = 45</td>
        </tr>
        <tr>
          <td id="L445" data-line-number="445"></td>
          <td id="LC445">    uscTlsAlertCertificateUnknown = 46</td>
        </tr>
        <tr>
          <td id="L446" data-line-number="446"></td>
          <td id="LC446">    uscTlsAlertIllegalParameter = 47</td>
        </tr>
        <tr>
          <td id="L447" data-line-number="447"></td>
          <td id="LC447">    uscTlsAlertUnknownCa = 48</td>
        </tr>
        <tr>
          <td id="L448" data-line-number="448"></td>
          <td id="LC448">    uscTlsAlertDecodeError = 50</td>
        </tr>
        <tr>
          <td id="L449" data-line-number="449"></td>
          <td id="LC449">    uscTlsAlertDecryptError = 51</td>
        </tr>
        <tr>
          <td id="L450" data-line-number="450"></td>
          <td id="LC450">    uscTlsAlertProtocolVersion = 70</td>
        </tr>
        <tr>
          <td id="L451" data-line-number="451"></td>
          <td id="LC451">    uscTlsAlertInternalError = 80</td>
        </tr>
        <tr>
          <td id="L452" data-line-number="452"></td>
          <td id="LC452">    uscTlsAlertUserCanceled = 90</td>
        </tr>
        <tr>
          <td id="L453" data-line-number="453"></td>
          <td id="LC453">    uscTlsAlertNoRenegotiation = 100</td>
        </tr>
        <tr>
          <td id="L454" data-line-number="454"></td>
          <td id="LC454">    uscTlsAlertMissingExtension = 109</td>
        </tr>
        <tr>
          <td id="L455" data-line-number="455"></td>
          <td id="LC455">    uscTlsAlertUnrecognizedName = 112</td>
        </tr>
        <tr>
          <td id="L456" data-line-number="456"></td>
          <td id="LC456">    uscTlsAlertCertificateRequired = 116</td>
        </tr>
        <tr>
          <td id="L457" data-line-number="457"></td>
          <td id="LC457">    uscTlsAlertNoApplicationProtocol = 120</td>
        </tr>
        <tr>
          <td id="L458" data-line-number="458"></td>
          <td id="LC458">End Enum</td>
        </tr>
        <tr>
          <td id="L459" data-line-number="459"></td>
          <td id="LC459">
</td>
        </tr>
        <tr>
          <td id="L460" data-line-number="460"></td>
          <td id="LC460">Private Type UcsBuffer</td>
        </tr>
        <tr>
          <td id="L461" data-line-number="461"></td>
          <td id="LC461">    Data()              As Byte</td>
        </tr>
        <tr>
          <td id="L462" data-line-number="462"></td>
          <td id="LC462">    Pos                 As Long</td>
        </tr>
        <tr>
          <td id="L463" data-line-number="463"></td>
          <td id="LC463">    Size                As Long</td>
        </tr>
        <tr>
          <td id="L464" data-line-number="464"></td>
          <td id="LC464">    Stack               As Collection</td>
        </tr>
        <tr>
          <td id="L465" data-line-number="465"></td>
          <td id="LC465">End Type</td>
        </tr>
        <tr>
          <td id="L466" data-line-number="466"></td>
          <td id="LC466">
</td>
        </tr>
        <tr>
          <td id="L467" data-line-number="467"></td>
          <td id="LC467">Public Type UcsTlsContext</td>
        </tr>
        <tr>
          <td id="L468" data-line-number="468"></td>
          <td id="LC468">    &#39;--- config</td>
        </tr>
        <tr>
          <td id="L469" data-line-number="469"></td>
          <td id="LC469">    IsServer            As Boolean</td>
        </tr>
        <tr>
          <td id="L470" data-line-number="470"></td>
          <td id="LC470">    RemoteHostName      As String</td>
        </tr>
        <tr>
          <td id="L471" data-line-number="471"></td>
          <td id="LC471">    LocalFeatures       As UcsTlsLocalFeaturesEnum</td>
        </tr>
        <tr>
          <td id="L472" data-line-number="472"></td>
          <td id="LC472">    ClientCertCallback  As Long</td>
        </tr>
        <tr>
          <td id="L473" data-line-number="473"></td>
          <td id="LC473">    AlpnProtocols       As String</td>
        </tr>
        <tr>
          <td id="L474" data-line-number="474"></td>
          <td id="LC474">    &#39;--- state</td>
        </tr>
        <tr>
          <td id="L475" data-line-number="475"></td>
          <td id="LC475">    State               As UcsTlsStatesEnum</td>
        </tr>
        <tr>
          <td id="L476" data-line-number="476"></td>
          <td id="LC476">    LastErrNumber       As Long</td>
        </tr>
        <tr>
          <td id="L477" data-line-number="477"></td>
          <td id="LC477">    LastError           As String</td>
        </tr>
        <tr>
          <td id="L478" data-line-number="478"></td>
          <td id="LC478">    LastErrSource       As String</td>
        </tr>
        <tr>
          <td id="L479" data-line-number="479"></td>
          <td id="LC479">    LastAlertCode       As UcsTlsAlertDescriptionsEnum</td>
        </tr>
        <tr>
          <td id="L480" data-line-number="480"></td>
          <td id="LC480">    BlocksStack         As Collection</td>
        </tr>
        <tr>
          <td id="L481" data-line-number="481"></td>
          <td id="LC481">    AlpnNegotiated      As String</td>
        </tr>
        <tr>
          <td id="L482" data-line-number="482"></td>
          <td id="LC482">    SniRequested        As String</td>
        </tr>
        <tr>
          <td id="L483" data-line-number="483"></td>
          <td id="LC483">    PrevRecordType      As Long</td>
        </tr>
        <tr>
          <td id="L484" data-line-number="484"></td>
          <td id="LC484">    &#39;--- handshake</td>
        </tr>
        <tr>
          <td id="L485" data-line-number="485"></td>
          <td id="LC485">    ProtocolVersion     As Long</td>
        </tr>
        <tr>
          <td id="L486" data-line-number="486"></td>
          <td id="LC486">    LocalSessionID()    As Byte</td>
        </tr>
        <tr>
          <td id="L487" data-line-number="487"></td>
          <td id="LC487">    LocalSessionTicket() As Byte</td>
        </tr>
        <tr>
          <td id="L488" data-line-number="488"></td>
          <td id="LC488">    LocalExchRandom()   As Byte</td>
        </tr>
        <tr>
          <td id="L489" data-line-number="489"></td>
          <td id="LC489">    LocalExchPrivate()  As Byte</td>
        </tr>
        <tr>
          <td id="L490" data-line-number="490"></td>
          <td id="LC490">    LocalExchPublic()   As Byte</td>
        </tr>
        <tr>
          <td id="L491" data-line-number="491"></td>
          <td id="LC491">    LocalExchRsaEncrPriv() As Byte</td>
        </tr>
        <tr>
          <td id="L492" data-line-number="492"></td>
          <td id="LC492">    LocalCertificates   As Collection</td>
        </tr>
        <tr>
          <td id="L493" data-line-number="493"></td>
          <td id="LC493">    LocalPrivateKey     As Collection</td>
        </tr>
        <tr>
          <td id="L494" data-line-number="494"></td>
          <td id="LC494">    LocalLegacyVerifyData() As Byte</td>
        </tr>
        <tr>
          <td id="L495" data-line-number="495"></td>
          <td id="LC495">    RemoteProtocolVersion As Long</td>
        </tr>
        <tr>
          <td id="L496" data-line-number="496"></td>
          <td id="LC496">    RemoteSessionID()   As Byte</td>
        </tr>
        <tr>
          <td id="L497" data-line-number="497"></td>
          <td id="LC497">    RemoteExchRandom()  As Byte</td>
        </tr>
        <tr>
          <td id="L498" data-line-number="498"></td>
          <td id="LC498">    RemoteExchPublic()  As Byte</td>
        </tr>
        <tr>
          <td id="L499" data-line-number="499"></td>
          <td id="LC499">    RemoteCertificates  As Collection</td>
        </tr>
        <tr>
          <td id="L500" data-line-number="500"></td>
          <td id="LC500">    RemoteExtensions    As Collection</td>
        </tr>
        <tr>
          <td id="L501" data-line-number="501"></td>
          <td id="LC501">    RemoteTickets       As Collection</td>
        </tr>
        <tr>
          <td id="L502" data-line-number="502"></td>
          <td id="LC502">    RemoteSupportedGroups As Collection</td>
        </tr>
        <tr>
          <td id="L503" data-line-number="503"></td>
          <td id="LC503">    RemoteCertStatuses  As Collection</td>
        </tr>
        <tr>
          <td id="L504" data-line-number="504"></td>
          <td id="LC504">    RemoteLegacyVerifyData() As Byte</td>
        </tr>
        <tr>
          <td id="L505" data-line-number="505"></td>
          <td id="LC505">    RemoteLegacyRenegInfo() As Byte</td>
        </tr>
        <tr>
          <td id="L506" data-line-number="506"></td>
          <td id="LC506">    &#39;--- crypto settings</td>
        </tr>
        <tr>
          <td id="L507" data-line-number="507"></td>
          <td id="LC507">    ExchGroup           As Long</td>
        </tr>
        <tr>
          <td id="L508" data-line-number="508"></td>
          <td id="LC508">    ExchAlgo            As UcsTlsCryptoAlgorithmsEnum</td>
        </tr>
        <tr>
          <td id="L509" data-line-number="509"></td>
          <td id="LC509">    CipherSuite         As Long</td>
        </tr>
        <tr>
          <td id="L510" data-line-number="510"></td>
          <td id="LC510">    SignatureScheme     As Long</td>
        </tr>
        <tr>
          <td id="L511" data-line-number="511"></td>
          <td id="LC511">    MacAlgo             As UcsTlsCryptoAlgorithmsEnum   &#39;--- not used w/ AEAD ciphers</td>
        </tr>
        <tr>
          <td id="L512" data-line-number="512"></td>
          <td id="LC512">    MacSize             As Long                         &#39;--- not used w/ AEAD ciphers</td>
        </tr>
        <tr>
          <td id="L513" data-line-number="513"></td>
          <td id="LC513">    BulkAlgo            As UcsTlsCryptoAlgorithmsEnum</td>
        </tr>
        <tr>
          <td id="L514" data-line-number="514"></td>
          <td id="LC514">    KeySize             As Long</td>
        </tr>
        <tr>
          <td id="L515" data-line-number="515"></td>
          <td id="LC515">    IvSize              As Long</td>
        </tr>
        <tr>
          <td id="L516" data-line-number="516"></td>
          <td id="LC516">    IvExplicitSize      As Long                         &#39;--- only for AES in TLS 1.2</td>
        </tr>
        <tr>
          <td id="L517" data-line-number="517"></td>
          <td id="LC517">    TagSize             As Long</td>
        </tr>
        <tr>
          <td id="L518" data-line-number="518"></td>
          <td id="LC518">    DigestAlgo          As UcsTlsCryptoAlgorithmsEnum</td>
        </tr>
        <tr>
          <td id="L519" data-line-number="519"></td>
          <td id="LC519">    DigestSize          As Long</td>
        </tr>
        <tr>
          <td id="L520" data-line-number="520"></td>
          <td id="LC520">    UseRsaKeyTransport  As Boolean</td>
        </tr>
        <tr>
          <td id="L521" data-line-number="521"></td>
          <td id="LC521">    &#39;--- bulk secrets</td>
        </tr>
        <tr>
          <td id="L522" data-line-number="522"></td>
          <td id="LC522">    HandshakeMessages   As UcsBuffer                    &#39;--- ToDo: reduce to HandshakeHash only</td>
        </tr>
        <tr>
          <td id="L523" data-line-number="523"></td>
          <td id="LC523">    HandshakeSecret()   As Byte</td>
        </tr>
        <tr>
          <td id="L524" data-line-number="524"></td>
          <td id="LC524">    MasterSecret()      As Byte</td>
        </tr>
        <tr>
          <td id="L525" data-line-number="525"></td>
          <td id="LC525">    LocalMacKey()       As Byte                         &#39;--- not used w/ AEAD ciphers</td>
        </tr>
        <tr>
          <td id="L526" data-line-number="526"></td>
          <td id="LC526">    RemoteMacKey()      As Byte                         &#39;--- not used w/ AEAD ciphers</td>
        </tr>
        <tr>
          <td id="L527" data-line-number="527"></td>
          <td id="LC527">    RemoteTrafficSecret() As Byte</td>
        </tr>
        <tr>
          <td id="L528" data-line-number="528"></td>
          <td id="LC528">    RemoteTrafficKey()  As Byte</td>
        </tr>
        <tr>
          <td id="L529" data-line-number="529"></td>
          <td id="LC529">    RemoteTrafficIV()   As Byte</td>
        </tr>
        <tr>
          <td id="L530" data-line-number="530"></td>
          <td id="LC530">    RemoteTrafficSeqNo  As Long</td>
        </tr>
        <tr>
          <td id="L531" data-line-number="531"></td>
          <td id="LC531">    RemoteEncryptThenMac As Boolean</td>
        </tr>
        <tr>
          <td id="L532" data-line-number="532"></td>
          <td id="LC532">    RemoteLegacyNextMacKey() As Byte</td>
        </tr>
        <tr>
          <td id="L533" data-line-number="533"></td>
          <td id="LC533">    RemoteLegacyNextTrafficKey() As Byte</td>
        </tr>
        <tr>
          <td id="L534" data-line-number="534"></td>
          <td id="LC534">    RemoteLegacyNextTrafficIV() As Byte</td>
        </tr>
        <tr>
          <td id="L535" data-line-number="535"></td>
          <td id="LC535">    LocalTrafficSecret() As Byte</td>
        </tr>
        <tr>
          <td id="L536" data-line-number="536"></td>
          <td id="LC536">    LocalTrafficKey()   As Byte</td>
        </tr>
        <tr>
          <td id="L537" data-line-number="537"></td>
          <td id="LC537">    LocalTrafficIV()    As Byte</td>
        </tr>
        <tr>
          <td id="L538" data-line-number="538"></td>
          <td id="LC538">    LocalTrafficSeqNo   As Long</td>
        </tr>
        <tr>
          <td id="L539" data-line-number="539"></td>
          <td id="LC539">    LocalEncryptThenMac As Boolean</td>
        </tr>
        <tr>
          <td id="L540" data-line-number="540"></td>
          <td id="LC540">    LocalLegacyNextMacKey() As Byte</td>
        </tr>
        <tr>
          <td id="L541" data-line-number="541"></td>
          <td id="LC541">    LocalLegacyNextTrafficKey() As Byte</td>
        </tr>
        <tr>
          <td id="L542" data-line-number="542"></td>
          <td id="LC542">    LocalLegacyNextTrafficIV() As Byte</td>
        </tr>
        <tr>
          <td id="L543" data-line-number="543"></td>
          <td id="LC543">    &#39;--- hello retry request</td>
        </tr>
        <tr>
          <td id="L544" data-line-number="544"></td>
          <td id="LC544">    HelloRetryRequest   As Boolean</td>
        </tr>
        <tr>
          <td id="L545" data-line-number="545"></td>
          <td id="LC545">    HelloRetryCipherSuite As Long</td>
        </tr>
        <tr>
          <td id="L546" data-line-number="546"></td>
          <td id="LC546">    HelloRetryExchGroup As Long</td>
        </tr>
        <tr>
          <td id="L547" data-line-number="547"></td>
          <td id="LC547">    HelloRetryCookie()  As Byte</td>
        </tr>
        <tr>
          <td id="L548" data-line-number="548"></td>
          <td id="LC548">    &#39;--- client certificate request</td>
        </tr>
        <tr>
          <td id="L549" data-line-number="549"></td>
          <td id="LC549">    CertRequestContext() As Byte</td>
        </tr>
        <tr>
          <td id="L550" data-line-number="550"></td>
          <td id="LC550">    CertRequestSignatureScheme As Long</td>
        </tr>
        <tr>
          <td id="L551" data-line-number="551"></td>
          <td id="LC551">    CertRequestCaDn     As Collection</td>
        </tr>
        <tr>
          <td id="L552" data-line-number="552"></td>
          <td id="LC552">    &#39;--- I/O buffers</td>
        </tr>
        <tr>
          <td id="L553" data-line-number="553"></td>
          <td id="LC553">    RecvBuffer          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L554" data-line-number="554"></td>
          <td id="LC554">    DecrBuffer          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L555" data-line-number="555"></td>
          <td id="LC555">    SendBuffer          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L556" data-line-number="556"></td>
          <td id="LC556">    MessBuffer          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L557" data-line-number="557"></td>
          <td id="LC557">#If ImplCaptureTraffic &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L558" data-line-number="558"></td>
          <td id="LC558">    TrafficDump         As Collection</td>
        </tr>
        <tr>
          <td id="L559" data-line-number="559"></td>
          <td id="LC559">#End If</td>
        </tr>
        <tr>
          <td id="L560" data-line-number="560"></td>
          <td id="LC560">End Type</td>
        </tr>
        <tr>
          <td id="L561" data-line-number="561"></td>
          <td id="LC561">
</td>
        </tr>
        <tr>
          <td id="L562" data-line-number="562"></td>
          <td id="LC562">Private Type UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L563" data-line-number="563"></td>
          <td id="LC563">    AlgoObjId           As String</td>
        </tr>
        <tr>
          <td id="L564" data-line-number="564"></td>
          <td id="LC564">    KeyBlob()           As Byte</td>
        </tr>
        <tr>
          <td id="L565" data-line-number="565"></td>
          <td id="LC565">    BitLen              As Long</td>
        </tr>
        <tr>
          <td id="L566" data-line-number="566"></td>
          <td id="LC566">    Modulus()           As Byte</td>
        </tr>
        <tr>
          <td id="L567" data-line-number="567"></td>
          <td id="LC567">    PubExp()            As Byte</td>
        </tr>
        <tr>
          <td id="L568" data-line-number="568"></td>
          <td id="LC568">    Prime1()            As Byte</td>
        </tr>
        <tr>
          <td id="L569" data-line-number="569"></td>
          <td id="LC569">    Prime2()            As Byte</td>
        </tr>
        <tr>
          <td id="L570" data-line-number="570"></td>
          <td id="LC570">    Coefficient()       As Byte</td>
        </tr>
        <tr>
          <td id="L571" data-line-number="571"></td>
          <td id="LC571">    PrivExp()           As Byte</td>
        </tr>
        <tr>
          <td id="L572" data-line-number="572"></td>
          <td id="LC572">    hNKey               As Long</td>
        </tr>
        <tr>
          <td id="L573" data-line-number="573"></td>
          <td id="LC573">    hProv               As Long</td>
        </tr>
        <tr>
          <td id="L574" data-line-number="574"></td>
          <td id="LC574">    hKey                As Long</td>
        </tr>
        <tr>
          <td id="L575" data-line-number="575"></td>
          <td id="LC575">    dwKeySpec           As Long</td>
        </tr>
        <tr>
          <td id="L576" data-line-number="576"></td>
          <td id="LC576">End Type</td>
        </tr>
        <tr>
          <td id="L577" data-line-number="577"></td>
          <td id="LC577">
</td>
        </tr>
        <tr>
          <td id="L578" data-line-number="578"></td>
          <td id="LC578">Private Enum UcsThunkPfnIndexEnum</td>
        </tr>
        <tr>
          <td id="L579" data-line-number="579"></td>
          <td id="LC579">    [_ucsPfnNotUsed]</td>
        </tr>
        <tr>
          <td id="L580" data-line-number="580"></td>
          <td id="LC580">    ucsPfnCurve25519ScalarMultiply</td>
        </tr>
        <tr>
          <td id="L581" data-line-number="581"></td>
          <td id="LC581">    ucsPfnCurve25519ScalarMultBase</td>
        </tr>
        <tr>
          <td id="L582" data-line-number="582"></td>
          <td id="LC582">    ucsPfnSecp256r1MakeKey</td>
        </tr>
        <tr>
          <td id="L583" data-line-number="583"></td>
          <td id="LC583">    ucsPfnSecp256r1SharedSecret</td>
        </tr>
        <tr>
          <td id="L584" data-line-number="584"></td>
          <td id="LC584">    ucsPfnSecp256r1UncompressKey</td>
        </tr>
        <tr>
          <td id="L585" data-line-number="585"></td>
          <td id="LC585">    ucsPfnSecp256r1Sign</td>
        </tr>
        <tr>
          <td id="L586" data-line-number="586"></td>
          <td id="LC586">    ucsPfnSecp256r1Verify</td>
        </tr>
        <tr>
          <td id="L587" data-line-number="587"></td>
          <td id="LC587">    ucsPfnSecp384r1MakeKey</td>
        </tr>
        <tr>
          <td id="L588" data-line-number="588"></td>
          <td id="LC588">    ucsPfnSecp384r1SharedSecret</td>
        </tr>
        <tr>
          <td id="L589" data-line-number="589"></td>
          <td id="LC589">    ucsPfnSecp384r1UncompressKey</td>
        </tr>
        <tr>
          <td id="L590" data-line-number="590"></td>
          <td id="LC590">    ucsPfnSecp384r1Sign</td>
        </tr>
        <tr>
          <td id="L591" data-line-number="591"></td>
          <td id="LC591">    ucsPfnSecp384r1Verify</td>
        </tr>
        <tr>
          <td id="L592" data-line-number="592"></td>
          <td id="LC592">    ucsPfnSha256Init</td>
        </tr>
        <tr>
          <td id="L593" data-line-number="593"></td>
          <td id="LC593">    ucsPfnSha256Update</td>
        </tr>
        <tr>
          <td id="L594" data-line-number="594"></td>
          <td id="LC594">    ucsPfnSha256Final</td>
        </tr>
        <tr>
          <td id="L595" data-line-number="595"></td>
          <td id="LC595">    ucsPfnSha384Init</td>
        </tr>
        <tr>
          <td id="L596" data-line-number="596"></td>
          <td id="LC596">    ucsPfnSha384Update</td>
        </tr>
        <tr>
          <td id="L597" data-line-number="597"></td>
          <td id="LC597">    ucsPfnSha384Final</td>
        </tr>
        <tr>
          <td id="L598" data-line-number="598"></td>
          <td id="LC598">    ucsPfnSha512Init</td>
        </tr>
        <tr>
          <td id="L599" data-line-number="599"></td>
          <td id="LC599">    ucsPfnSha512Update</td>
        </tr>
        <tr>
          <td id="L600" data-line-number="600"></td>
          <td id="LC600">    ucsPfnSha512Final</td>
        </tr>
        <tr>
          <td id="L601" data-line-number="601"></td>
          <td id="LC601">    ucsPfnChacha20Poly1305Encrypt</td>
        </tr>
        <tr>
          <td id="L602" data-line-number="602"></td>
          <td id="LC602">    ucsPfnChacha20Poly1305Decrypt</td>
        </tr>
        <tr>
          <td id="L603" data-line-number="603"></td>
          <td id="LC603">    ucsPfnAesGcmEncrypt</td>
        </tr>
        <tr>
          <td id="L604" data-line-number="604"></td>
          <td id="LC604">    ucsPfnAesGcmDecrypt</td>
        </tr>
        <tr>
          <td id="L605" data-line-number="605"></td>
          <td id="LC605">    ucsPfnAesCbcEncrypt</td>
        </tr>
        <tr>
          <td id="L606" data-line-number="606"></td>
          <td id="LC606">    ucsPfnAesCbcDecrypt</td>
        </tr>
        <tr>
          <td id="L607" data-line-number="607"></td>
          <td id="LC607">    ucsPfnRsaModExp</td>
        </tr>
        <tr>
          <td id="L608" data-line-number="608"></td>
          <td id="LC608">    ucsPfnRsaCrtModExp</td>
        </tr>
        <tr>
          <td id="L609" data-line-number="609"></td>
          <td id="LC609">    [_ucsPfnMax]</td>
        </tr>
        <tr>
          <td id="L610" data-line-number="610"></td>
          <td id="LC610">End Enum</td>
        </tr>
        <tr>
          <td id="L611" data-line-number="611"></td>
          <td id="LC611">
</td>
        </tr>
        <tr>
          <td id="L612" data-line-number="612"></td>
          <td id="LC612">Private Type UcsCryptoData</td>
        </tr>
        <tr>
          <td id="L613" data-line-number="613"></td>
          <td id="LC613">    Thunk               As Long</td>
        </tr>
        <tr>
          <td id="L614" data-line-number="614"></td>
          <td id="LC614">    Glob()              As Byte</td>
        </tr>
        <tr>
          <td id="L615" data-line-number="615"></td>
          <td id="LC615">    Pfn(1 To [_ucsPfnMax] - 1) As Long</td>
        </tr>
        <tr>
          <td id="L616" data-line-number="616"></td>
          <td id="LC616">    HashCtx(0 To LNG_SHA384_CONTEXTSZ - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L617" data-line-number="617"></td>
          <td id="LC617">    HashPad(0 To LNG_SHA512_BLOCKSZ - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L618" data-line-number="618"></td>
          <td id="LC618">    HashFinal(0 To LNG_SHA512_HASHSZ - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L619" data-line-number="619"></td>
          <td id="LC619">    hRandomProv         As Long</td>
        </tr>
        <tr>
          <td id="L620" data-line-number="620"></td>
          <td id="LC620">End Type</td>
        </tr>
        <tr>
          <td id="L621" data-line-number="621"></td>
          <td id="LC621">
</td>
        </tr>
        <tr>
          <td id="L622" data-line-number="622"></td>
          <td id="LC622">#If Not ImplUseShared Then</td>
        </tr>
        <tr>
          <td id="L623" data-line-number="623"></td>
          <td id="LC623">Private Enum UcsOsVersionEnum</td>
        </tr>
        <tr>
          <td id="L624" data-line-number="624"></td>
          <td id="LC624">    ucsOsvNt4 = 400</td>
        </tr>
        <tr>
          <td id="L625" data-line-number="625"></td>
          <td id="LC625">    ucsOsvWin98 = 410</td>
        </tr>
        <tr>
          <td id="L626" data-line-number="626"></td>
          <td id="LC626">    ucsOsvWin2000 = 500</td>
        </tr>
        <tr>
          <td id="L627" data-line-number="627"></td>
          <td id="LC627">    ucsOsvXp = 501</td>
        </tr>
        <tr>
          <td id="L628" data-line-number="628"></td>
          <td id="LC628">    ucsOsvVista = 600</td>
        </tr>
        <tr>
          <td id="L629" data-line-number="629"></td>
          <td id="LC629">    ucsOsvWin7 = 601</td>
        </tr>
        <tr>
          <td id="L630" data-line-number="630"></td>
          <td id="LC630">    ucsOsvWin8 = 602</td>
        </tr>
        <tr>
          <td id="L631" data-line-number="631"></td>
          <td id="LC631">    [ucsOsvWin8.1] = 603</td>
        </tr>
        <tr>
          <td id="L632" data-line-number="632"></td>
          <td id="LC632">    ucsOsvWin10 = 1000</td>
        </tr>
        <tr>
          <td id="L633" data-line-number="633"></td>
          <td id="LC633">End Enum</td>
        </tr>
        <tr>
          <td id="L634" data-line-number="634"></td>
          <td id="LC634">#End If</td>
        </tr>
        <tr>
          <td id="L635" data-line-number="635"></td>
          <td id="LC635">
</td>
        </tr>
        <tr>
          <td id="L636" data-line-number="636"></td>
          <td id="LC636">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L637" data-line-number="637"></td>
          <td id="LC637">&#39; Error handling</td>
        </tr>
        <tr>
          <td id="L638" data-line-number="638"></td>
          <td id="LC638">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L639" data-line-number="639"></td>
          <td id="LC639">
</td>
        </tr>
        <tr>
          <td id="L640" data-line-number="640"></td>
          <td id="LC640">Private Sub ErrRaise(ByVal Number As Long, Optional Source As Variant, Optional Description As Variant)</td>
        </tr>
        <tr>
          <td id="L641" data-line-number="641"></td>
          <td id="LC641">    Err.Raise Number, Source, Description</td>
        </tr>
        <tr>
          <td id="L642" data-line-number="642"></td>
          <td id="LC642">End Sub</td>
        </tr>
        <tr>
          <td id="L643" data-line-number="643"></td>
          <td id="LC643">
</td>
        </tr>
        <tr>
          <td id="L644" data-line-number="644"></td>
          <td id="LC644">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L645" data-line-number="645"></td>
          <td id="LC645">&#39; Properties</td>
        </tr>
        <tr>
          <td id="L646" data-line-number="646"></td>
          <td id="LC646">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L647" data-line-number="647"></td>
          <td id="LC647">
</td>
        </tr>
        <tr>
          <td id="L648" data-line-number="648"></td>
          <td id="LC648">Public Property Get TlsIsClosed(uCtx As UcsTlsContext) As Boolean</td>
        </tr>
        <tr>
          <td id="L649" data-line-number="649"></td>
          <td id="LC649">    TlsIsClosed = (uCtx.State = ucsTlsStateClosed)</td>
        </tr>
        <tr>
          <td id="L650" data-line-number="650"></td>
          <td id="LC650">End Property</td>
        </tr>
        <tr>
          <td id="L651" data-line-number="651"></td>
          <td id="LC651">
</td>
        </tr>
        <tr>
          <td id="L652" data-line-number="652"></td>
          <td id="LC652">Public Property Get TlsIsStarted(uCtx As UcsTlsContext) As Boolean</td>
        </tr>
        <tr>
          <td id="L653" data-line-number="653"></td>
          <td id="LC653">    TlsIsStarted = (uCtx.State &gt; ucsTlsStateClosed)</td>
        </tr>
        <tr>
          <td id="L654" data-line-number="654"></td>
          <td id="LC654">End Property</td>
        </tr>
        <tr>
          <td id="L655" data-line-number="655"></td>
          <td id="LC655">
</td>
        </tr>
        <tr>
          <td id="L656" data-line-number="656"></td>
          <td id="LC656">Public Property Get TlsIsReady(uCtx As UcsTlsContext) As Boolean</td>
        </tr>
        <tr>
          <td id="L657" data-line-number="657"></td>
          <td id="LC657">    TlsIsReady = (uCtx.State &gt;= ucsTlsStatePostHandshake)</td>
        </tr>
        <tr>
          <td id="L658" data-line-number="658"></td>
          <td id="LC658">End Property</td>
        </tr>
        <tr>
          <td id="L659" data-line-number="659"></td>
          <td id="LC659">
</td>
        </tr>
        <tr>
          <td id="L660" data-line-number="660"></td>
          <td id="LC660">Public Property Get TlsIsShutdown(uCtx As UcsTlsContext) As Boolean</td>
        </tr>
        <tr>
          <td id="L661" data-line-number="661"></td>
          <td id="LC661">    TlsIsShutdown = (uCtx.State = ucsTlsStateShutdown)</td>
        </tr>
        <tr>
          <td id="L662" data-line-number="662"></td>
          <td id="LC662">End Property</td>
        </tr>
        <tr>
          <td id="L663" data-line-number="663"></td>
          <td id="LC663">
</td>
        </tr>
        <tr>
          <td id="L664" data-line-number="664"></td>
          <td id="LC664">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L665" data-line-number="665"></td>
          <td id="LC665">&#39; TLS support</td>
        </tr>
        <tr>
          <td id="L666" data-line-number="666"></td>
          <td id="LC666">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L667" data-line-number="667"></td>
          <td id="LC667">
</td>
        </tr>
        <tr>
          <td id="L668" data-line-number="668"></td>
          <td id="LC668">Public Function TlsInitClient( _</td>
        </tr>
        <tr>
          <td id="L669" data-line-number="669"></td>
          <td id="LC669">            uCtx As UcsTlsContext, _</td>
        </tr>
        <tr>
          <td id="L670" data-line-number="670"></td>
          <td id="LC670">            Optional RemoteHostName As String, _</td>
        </tr>
        <tr>
          <td id="L671" data-line-number="671"></td>
          <td id="LC671">            Optional ByVal LocalFeatures As Long = ucsTlsSupportAll, _</td>
        </tr>
        <tr>
          <td id="L672" data-line-number="672"></td>
          <td id="LC672">            Optional ClientCertCallback As Object, _</td>
        </tr>
        <tr>
          <td id="L673" data-line-number="673"></td>
          <td id="LC673">            Optional AlpnProtocols As String) As Boolean</td>
        </tr>
        <tr>
          <td id="L674" data-line-number="674"></td>
          <td id="LC674">    Dim uEmpty          As UcsTlsContext</td>
        </tr>
        <tr>
          <td id="L675" data-line-number="675"></td>
          <td id="LC675">    </td>
        </tr>
        <tr>
          <td id="L676" data-line-number="676"></td>
          <td id="LC676">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L677" data-line-number="677"></td>
          <td id="LC677">    If Not pvCryptoInit() Then</td>
        </tr>
        <tr>
          <td id="L678" data-line-number="678"></td>
          <td id="LC678">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L679" data-line-number="679"></td>
          <td id="LC679">    End If</td>
        </tr>
        <tr>
          <td id="L680" data-line-number="680"></td>
          <td id="LC680">    With uEmpty</td>
        </tr>
        <tr>
          <td id="L681" data-line-number="681"></td>
          <td id="LC681">        pvTlsClearLastError uEmpty</td>
        </tr>
        <tr>
          <td id="L682" data-line-number="682"></td>
          <td id="LC682">        .State = ucsTlsStateHandshakeStart</td>
        </tr>
        <tr>
          <td id="L683" data-line-number="683"></td>
          <td id="LC683">        .RemoteHostName = RemoteHostName</td>
        </tr>
        <tr>
          <td id="L684" data-line-number="684"></td>
          <td id="LC684">        .LocalFeatures = LocalFeatures</td>
        </tr>
        <tr>
          <td id="L685" data-line-number="685"></td>
          <td id="LC685">        .ClientCertCallback = ObjPtr(ClientCertCallback)</td>
        </tr>
        <tr>
          <td id="L686" data-line-number="686"></td>
          <td id="LC686">        .AlpnProtocols = AlpnProtocols</td>
        </tr>
        <tr>
          <td id="L687" data-line-number="687"></td>
          <td id="LC687">        #If ImplCaptureTraffic &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L688" data-line-number="688"></td>
          <td id="LC688">            Set .TrafficDump = New Collection</td>
        </tr>
        <tr>
          <td id="L689" data-line-number="689"></td>
          <td id="LC689">        #End If</td>
        </tr>
        <tr>
          <td id="L690" data-line-number="690"></td>
          <td id="LC690">    End With</td>
        </tr>
        <tr>
          <td id="L691" data-line-number="691"></td>
          <td id="LC691">    uCtx = uEmpty</td>
        </tr>
        <tr>
          <td id="L692" data-line-number="692"></td>
          <td id="LC692">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L693" data-line-number="693"></td>
          <td id="LC693">    TlsInitClient = True</td>
        </tr>
        <tr>
          <td id="L694" data-line-number="694"></td>
          <td id="LC694">QH:</td>
        </tr>
        <tr>
          <td id="L695" data-line-number="695"></td>
          <td id="LC695">    Exit Function</td>
        </tr>
        <tr>
          <td id="L696" data-line-number="696"></td>
          <td id="LC696">EH:</td>
        </tr>
        <tr>
          <td id="L697" data-line-number="697"></td>
          <td id="LC697">    pvTlsSetLastError uCtx, Err.Number, Err.Source, Err.Description</td>
        </tr>
        <tr>
          <td id="L698" data-line-number="698"></td>
          <td id="LC698">    Resume QH</td>
        </tr>
        <tr>
          <td id="L699" data-line-number="699"></td>
          <td id="LC699">End Function</td>
        </tr>
        <tr>
          <td id="L700" data-line-number="700"></td>
          <td id="LC700">
</td>
        </tr>
        <tr>
          <td id="L701" data-line-number="701"></td>
          <td id="LC701">Public Function TlsInitServer( _</td>
        </tr>
        <tr>
          <td id="L702" data-line-number="702"></td>
          <td id="LC702">            uCtx As UcsTlsContext, _</td>
        </tr>
        <tr>
          <td id="L703" data-line-number="703"></td>
          <td id="LC703">            Optional RemoteHostName As String, _</td>
        </tr>
        <tr>
          <td id="L704" data-line-number="704"></td>
          <td id="LC704">            Optional Certificates As Collection, _</td>
        </tr>
        <tr>
          <td id="L705" data-line-number="705"></td>
          <td id="LC705">            Optional PrivateKey As Collection, _</td>
        </tr>
        <tr>
          <td id="L706" data-line-number="706"></td>
          <td id="LC706">            Optional AlpnProtocols As String, _</td>
        </tr>
        <tr>
          <td id="L707" data-line-number="707"></td>
          <td id="LC707">            Optional ByVal LocalFeatures As Long = ucsTlsSupportAll) As Boolean</td>
        </tr>
        <tr>
          <td id="L708" data-line-number="708"></td>
          <td id="LC708">#If Not ImplTlsServer Then</td>
        </tr>
        <tr>
          <td id="L709" data-line-number="709"></td>
          <td id="LC709">    ErrRaise vbObjectError, , ERR_NO_SERVER_COMPILED</td>
        </tr>
        <tr>
          <td id="L710" data-line-number="710"></td>
          <td id="LC710">#Else</td>
        </tr>
        <tr>
          <td id="L711" data-line-number="711"></td>
          <td id="LC711">    Dim uEmpty          As UcsTlsContext</td>
        </tr>
        <tr>
          <td id="L712" data-line-number="712"></td>
          <td id="LC712">    </td>
        </tr>
        <tr>
          <td id="L713" data-line-number="713"></td>
          <td id="LC713">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L714" data-line-number="714"></td>
          <td id="LC714">    If Not pvCryptoInit() Then</td>
        </tr>
        <tr>
          <td id="L715" data-line-number="715"></td>
          <td id="LC715">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L716" data-line-number="716"></td>
          <td id="LC716">    End If</td>
        </tr>
        <tr>
          <td id="L717" data-line-number="717"></td>
          <td id="LC717">    With uEmpty</td>
        </tr>
        <tr>
          <td id="L718" data-line-number="718"></td>
          <td id="LC718">        pvTlsClearLastError uEmpty</td>
        </tr>
        <tr>
          <td id="L719" data-line-number="719"></td>
          <td id="LC719">        .IsServer = True</td>
        </tr>
        <tr>
          <td id="L720" data-line-number="720"></td>
          <td id="LC720">        .State = ucsTlsStateExpectClientHello</td>
        </tr>
        <tr>
          <td id="L721" data-line-number="721"></td>
          <td id="LC721">        .RemoteHostName = RemoteHostName</td>
        </tr>
        <tr>
          <td id="L722" data-line-number="722"></td>
          <td id="LC722">        .LocalFeatures = LocalFeatures</td>
        </tr>
        <tr>
          <td id="L723" data-line-number="723"></td>
          <td id="LC723">        Set .LocalCertificates = Certificates</td>
        </tr>
        <tr>
          <td id="L724" data-line-number="724"></td>
          <td id="LC724">        Set .LocalPrivateKey = PrivateKey</td>
        </tr>
        <tr>
          <td id="L725" data-line-number="725"></td>
          <td id="LC725">        .AlpnProtocols = AlpnProtocols</td>
        </tr>
        <tr>
          <td id="L726" data-line-number="726"></td>
          <td id="LC726">        #If ImplCaptureTraffic &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L727" data-line-number="727"></td>
          <td id="LC727">            Set .TrafficDump = New Collection</td>
        </tr>
        <tr>
          <td id="L728" data-line-number="728"></td>
          <td id="LC728">        #End If</td>
        </tr>
        <tr>
          <td id="L729" data-line-number="729"></td>
          <td id="LC729">    End With</td>
        </tr>
        <tr>
          <td id="L730" data-line-number="730"></td>
          <td id="LC730">    uCtx = uEmpty</td>
        </tr>
        <tr>
          <td id="L731" data-line-number="731"></td>
          <td id="LC731">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L732" data-line-number="732"></td>
          <td id="LC732">    TlsInitServer = True</td>
        </tr>
        <tr>
          <td id="L733" data-line-number="733"></td>
          <td id="LC733">QH:</td>
        </tr>
        <tr>
          <td id="L734" data-line-number="734"></td>
          <td id="LC734">    Exit Function</td>
        </tr>
        <tr>
          <td id="L735" data-line-number="735"></td>
          <td id="LC735">EH:</td>
        </tr>
        <tr>
          <td id="L736" data-line-number="736"></td>
          <td id="LC736">    pvTlsSetLastError uCtx, Err.Number, Err.Source, Err.Description</td>
        </tr>
        <tr>
          <td id="L737" data-line-number="737"></td>
          <td id="LC737">    Resume QH</td>
        </tr>
        <tr>
          <td id="L738" data-line-number="738"></td>
          <td id="LC738">#End If</td>
        </tr>
        <tr>
          <td id="L739" data-line-number="739"></td>
          <td id="LC739">End Function</td>
        </tr>
        <tr>
          <td id="L740" data-line-number="740"></td>
          <td id="LC740">
</td>
        </tr>
        <tr>
          <td id="L741" data-line-number="741"></td>
          <td id="LC741">Public Function TlsTerminate(uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L742" data-line-number="742"></td>
          <td id="LC742">    uCtx.State = ucsTlsStateClosed</td>
        </tr>
        <tr>
          <td id="L743" data-line-number="743"></td>
          <td id="LC743">End Function</td>
        </tr>
        <tr>
          <td id="L744" data-line-number="744"></td>
          <td id="LC744">
</td>
        </tr>
        <tr>
          <td id="L745" data-line-number="745"></td>
          <td id="LC745">Public Function TlsHandshake(uCtx As UcsTlsContext, baInput() As Byte, ByVal lSize As Long, baOutput() As Byte, lOutputPos As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L746" data-line-number="746"></td>
          <td id="LC746">    Const FUNC_NAME     As String = &#34;TlsHandshake&#34;</td>
        </tr>
        <tr>
          <td id="L747" data-line-number="747"></td>
          <td id="LC747">    </td>
        </tr>
        <tr>
          <td id="L748" data-line-number="748"></td>
          <td id="LC748">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L749" data-line-number="749"></td>
          <td id="LC749">    With uCtx</td>
        </tr>
        <tr>
          <td id="L750" data-line-number="750"></td>
          <td id="LC750">        If .State = ucsTlsStateClosed Then</td>
        </tr>
        <tr>
          <td id="L751" data-line-number="751"></td>
          <td id="LC751">            pvTlsSetLastError uCtx, vbObjectError, MODULE_NAME &amp; &#34;.&#34; &amp; FUNC_NAME, ERR_CONNECTION_CLOSED</td>
        </tr>
        <tr>
          <td id="L752" data-line-number="752"></td>
          <td id="LC752">            Exit Function</td>
        </tr>
        <tr>
          <td id="L753" data-line-number="753"></td>
          <td id="LC753">        End If</td>
        </tr>
        <tr>
          <td id="L754" data-line-number="754"></td>
          <td id="LC754">        pvTlsClearLastError uCtx</td>
        </tr>
        <tr>
          <td id="L755" data-line-number="755"></td>
          <td id="LC755">        &#39;--- swap-in</td>
        </tr>
        <tr>
          <td id="L756" data-line-number="756"></td>
          <td id="LC756">        pvArraySwap .SendBuffer.Data, .SendBuffer.Size, baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L757" data-line-number="757"></td>
          <td id="LC757">        If .State = ucsTlsStateHandshakeStart Then</td>
        </tr>
        <tr>
          <td id="L758" data-line-number="758"></td>
          <td id="LC758">            pvTlsBuildClientHello uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L759" data-line-number="759"></td>
          <td id="LC759">            .State = ucsTlsStateExpectServerHello</td>
        </tr>
        <tr>
          <td id="L760" data-line-number="760"></td>
          <td id="LC760">        Else</td>
        </tr>
        <tr>
          <td id="L761" data-line-number="761"></td>
          <td id="LC761">            If lSize &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L762" data-line-number="762"></td>
          <td id="LC762">                lSize = pvArraySize(baInput)</td>
        </tr>
        <tr>
          <td id="L763" data-line-number="763"></td>
          <td id="LC763">            End If</td>
        </tr>
        <tr>
          <td id="L764" data-line-number="764"></td>
          <td id="LC764">            #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L765" data-line-number="765"></td>
          <td id="LC765">                If lSize &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L766" data-line-number="766"></td>
          <td id="LC766">                    .TrafficDump.Add FUNC_NAME &amp; &#34;.Input&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baInput, Size:=lSize)</td>
        </tr>
        <tr>
          <td id="L767" data-line-number="767"></td>
          <td id="LC767">                End If</td>
        </tr>
        <tr>
          <td id="L768" data-line-number="768"></td>
          <td id="LC768">            #End If</td>
        </tr>
        <tr>
          <td id="L769" data-line-number="769"></td>
          <td id="LC769">            If Not pvTlsParsePayload(uCtx, baInput, lSize, .LastError, .LastAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L770" data-line-number="770"></td>
          <td id="LC770">                pvTlsSetLastError uCtx, vbObjectError, MODULE_NAME &amp; &#34;.&#34; &amp; FUNC_NAME, .LastError, .LastAlertCode</td>
        </tr>
        <tr>
          <td id="L771" data-line-number="771"></td>
          <td id="LC771">                &#39;--- treat as warnings</td>
        </tr>
        <tr>
          <td id="L772" data-line-number="772"></td>
          <td id="LC772">                If .LastAlertCode = uscTlsAlertCertificateUnknown Or .LastAlertCode = uscTlsAlertBadCertificate Then</td>
        </tr>
        <tr>
          <td id="L773" data-line-number="773"></td>
          <td id="LC773">                    TlsHandshake = True</td>
        </tr>
        <tr>
          <td id="L774" data-line-number="774"></td>
          <td id="LC774">                End If</td>
        </tr>
        <tr>
          <td id="L775" data-line-number="775"></td>
          <td id="LC775">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L776" data-line-number="776"></td>
          <td id="LC776">            End If</td>
        </tr>
        <tr>
          <td id="L777" data-line-number="777"></td>
          <td id="LC777">        End If</td>
        </tr>
        <tr>
          <td id="L778" data-line-number="778"></td>
          <td id="LC778">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L779" data-line-number="779"></td>
          <td id="LC779">        TlsHandshake = True</td>
        </tr>
        <tr>
          <td id="L780" data-line-number="780"></td>
          <td id="LC780">QH:</td>
        </tr>
        <tr>
          <td id="L781" data-line-number="781"></td>
          <td id="LC781">        &#39;--- swap-out</td>
        </tr>
        <tr>
          <td id="L782" data-line-number="782"></td>
          <td id="LC782">        pvArraySwap baOutput, lOutputPos, .SendBuffer.Data, .SendBuffer.Size</td>
        </tr>
        <tr>
          <td id="L783" data-line-number="783"></td>
          <td id="LC783">        pvArrayWriteEOF baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L784" data-line-number="784"></td>
          <td id="LC784">        #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L785" data-line-number="785"></td>
          <td id="LC785">            If lOutputPos &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L786" data-line-number="786"></td>
          <td id="LC786">                .TrafficDump.Add FUNC_NAME &amp; &#34;.Output&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baOutput, Size:=lOutputPos)</td>
        </tr>
        <tr>
          <td id="L787" data-line-number="787"></td>
          <td id="LC787">            End If</td>
        </tr>
        <tr>
          <td id="L788" data-line-number="788"></td>
          <td id="LC788">        #End If</td>
        </tr>
        <tr>
          <td id="L789" data-line-number="789"></td>
          <td id="LC789">    End With</td>
        </tr>
        <tr>
          <td id="L790" data-line-number="790"></td>
          <td id="LC790">    Exit Function</td>
        </tr>
        <tr>
          <td id="L791" data-line-number="791"></td>
          <td id="LC791">EH:</td>
        </tr>
        <tr>
          <td id="L792" data-line-number="792"></td>
          <td id="LC792">    pvTlsSetLastError uCtx, Err.Number, Err.Source, Err.Description</td>
        </tr>
        <tr>
          <td id="L793" data-line-number="793"></td>
          <td id="LC793">    Resume QH</td>
        </tr>
        <tr>
          <td id="L794" data-line-number="794"></td>
          <td id="LC794">End Function</td>
        </tr>
        <tr>
          <td id="L795" data-line-number="795"></td>
          <td id="LC795">
</td>
        </tr>
        <tr>
          <td id="L796" data-line-number="796"></td>
          <td id="LC796">Public Function TlsReceive(uCtx As UcsTlsContext, baInput() As Byte, ByVal lSize As Long, baPlainText() As Byte, lPos As Long, baOutput() As Byte, lOutputPos As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L797" data-line-number="797"></td>
          <td id="LC797">    Const FUNC_NAME     As String = &#34;TlsReceive&#34;</td>
        </tr>
        <tr>
          <td id="L798" data-line-number="798"></td>
          <td id="LC798">    </td>
        </tr>
        <tr>
          <td id="L799" data-line-number="799"></td>
          <td id="LC799">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L800" data-line-number="800"></td>
          <td id="LC800">    With uCtx</td>
        </tr>
        <tr>
          <td id="L801" data-line-number="801"></td>
          <td id="LC801">        If lSize &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L802" data-line-number="802"></td>
          <td id="LC802">            lSize = pvArraySize(baInput)</td>
        </tr>
        <tr>
          <td id="L803" data-line-number="803"></td>
          <td id="LC803">        End If</td>
        </tr>
        <tr>
          <td id="L804" data-line-number="804"></td>
          <td id="LC804">        #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L805" data-line-number="805"></td>
          <td id="LC805">            If lSize &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L806" data-line-number="806"></td>
          <td id="LC806">                .TrafficDump.Add FUNC_NAME &amp; &#34;.Input (undecrypted)&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baInput, Size:=lSize)</td>
        </tr>
        <tr>
          <td id="L807" data-line-number="807"></td>
          <td id="LC807">            End If</td>
        </tr>
        <tr>
          <td id="L808" data-line-number="808"></td>
          <td id="LC808">        #End If</td>
        </tr>
        <tr>
          <td id="L809" data-line-number="809"></td>
          <td id="LC809">        If lSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L810" data-line-number="810"></td>
          <td id="LC810">            &#39;--- flush</td>
        </tr>
        <tr>
          <td id="L811" data-line-number="811"></td>
          <td id="LC811">            If .DecrBuffer.Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L812" data-line-number="812"></td>
          <td id="LC812">                If lPos = 0 Then</td>
        </tr>
        <tr>
          <td id="L813" data-line-number="813"></td>
          <td id="LC813">                    pvArraySwap .DecrBuffer.Data, .DecrBuffer.Size, baPlainText, lPos</td>
        </tr>
        <tr>
          <td id="L814" data-line-number="814"></td>
          <td id="LC814">                Else</td>
        </tr>
        <tr>
          <td id="L815" data-line-number="815"></td>
          <td id="LC815">                    lPos = pvArrayWriteBlob(baPlainText, lPos, VarPtr(.DecrBuffer.Data(0)), .DecrBuffer.Size)</td>
        </tr>
        <tr>
          <td id="L816" data-line-number="816"></td>
          <td id="LC816">                    Call pvArrayWriteEOF(baPlainText, lPos)</td>
        </tr>
        <tr>
          <td id="L817" data-line-number="817"></td>
          <td id="LC817">                    .DecrBuffer.Size = 0</td>
        </tr>
        <tr>
          <td id="L818" data-line-number="818"></td>
          <td id="LC818">                End If</td>
        </tr>
        <tr>
          <td id="L819" data-line-number="819"></td>
          <td id="LC819">            End If</td>
        </tr>
        <tr>
          <td id="L820" data-line-number="820"></td>
          <td id="LC820">            &#39;--- success</td>
        </tr>
        <tr>
          <td id="L821" data-line-number="821"></td>
          <td id="LC821">            TlsReceive = True</td>
        </tr>
        <tr>
          <td id="L822" data-line-number="822"></td>
          <td id="LC822">            Exit Function</td>
        </tr>
        <tr>
          <td id="L823" data-line-number="823"></td>
          <td id="LC823">        End If</td>
        </tr>
        <tr>
          <td id="L824" data-line-number="824"></td>
          <td id="LC824">        If .State = ucsTlsStateClosed Then</td>
        </tr>
        <tr>
          <td id="L825" data-line-number="825"></td>
          <td id="LC825">            pvTlsSetLastError uCtx, vbObjectError, MODULE_NAME &amp; &#34;.&#34; &amp; FUNC_NAME, ERR_CONNECTION_CLOSED</td>
        </tr>
        <tr>
          <td id="L826" data-line-number="826"></td>
          <td id="LC826">            Exit Function</td>
        </tr>
        <tr>
          <td id="L827" data-line-number="827"></td>
          <td id="LC827">        End If</td>
        </tr>
        <tr>
          <td id="L828" data-line-number="828"></td>
          <td id="LC828">        pvTlsClearLastError uCtx</td>
        </tr>
        <tr>
          <td id="L829" data-line-number="829"></td>
          <td id="LC829">        &#39;--- swap-in</td>
        </tr>
        <tr>
          <td id="L830" data-line-number="830"></td>
          <td id="LC830">        pvArraySwap .DecrBuffer.Data, .DecrBuffer.Size, baPlainText, lPos</td>
        </tr>
        <tr>
          <td id="L831" data-line-number="831"></td>
          <td id="LC831">        pvArraySwap .SendBuffer.Data, .SendBuffer.Size, baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L832" data-line-number="832"></td>
          <td id="LC832">        If Not pvTlsParsePayload(uCtx, baInput, lSize, .LastError, .LastAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L833" data-line-number="833"></td>
          <td id="LC833">            pvTlsSetLastError uCtx, vbObjectError, MODULE_NAME &amp; &#34;.&#34; &amp; FUNC_NAME, .LastError, .LastAlertCode</td>
        </tr>
        <tr>
          <td id="L834" data-line-number="834"></td>
          <td id="LC834">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L835" data-line-number="835"></td>
          <td id="LC835">        End If</td>
        </tr>
        <tr>
          <td id="L836" data-line-number="836"></td>
          <td id="LC836">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L837" data-line-number="837"></td>
          <td id="LC837">        TlsReceive = True</td>
        </tr>
        <tr>
          <td id="L838" data-line-number="838"></td>
          <td id="LC838">QH:</td>
        </tr>
        <tr>
          <td id="L839" data-line-number="839"></td>
          <td id="LC839">        &#39;--- swap-out</td>
        </tr>
        <tr>
          <td id="L840" data-line-number="840"></td>
          <td id="LC840">        pvArraySwap baPlainText, lPos, .DecrBuffer.Data, .DecrBuffer.Size</td>
        </tr>
        <tr>
          <td id="L841" data-line-number="841"></td>
          <td id="LC841">        pvArrayWriteEOF baPlainText, lPos</td>
        </tr>
        <tr>
          <td id="L842" data-line-number="842"></td>
          <td id="LC842">        pvArraySwap baOutput, lOutputPos, .SendBuffer.Data, .SendBuffer.Size</td>
        </tr>
        <tr>
          <td id="L843" data-line-number="843"></td>
          <td id="LC843">        pvArrayWriteEOF baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L844" data-line-number="844"></td>
          <td id="LC844">        #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L845" data-line-number="845"></td>
          <td id="LC845">            If lOutputPos &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L846" data-line-number="846"></td>
          <td id="LC846">                .TrafficDump.Add FUNC_NAME &amp; &#34;.Output (encrypted)&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baOutput, Size:=lOutputPos)</td>
        </tr>
        <tr>
          <td id="L847" data-line-number="847"></td>
          <td id="LC847">            End If</td>
        </tr>
        <tr>
          <td id="L848" data-line-number="848"></td>
          <td id="LC848">        #End If</td>
        </tr>
        <tr>
          <td id="L849" data-line-number="849"></td>
          <td id="LC849">    End With</td>
        </tr>
        <tr>
          <td id="L850" data-line-number="850"></td>
          <td id="LC850">    Exit Function</td>
        </tr>
        <tr>
          <td id="L851" data-line-number="851"></td>
          <td id="LC851">EH:</td>
        </tr>
        <tr>
          <td id="L852" data-line-number="852"></td>
          <td id="LC852">    pvTlsSetLastError uCtx, Err.Number, Err.Source, Err.Description</td>
        </tr>
        <tr>
          <td id="L853" data-line-number="853"></td>
          <td id="LC853">    Resume QH</td>
        </tr>
        <tr>
          <td id="L854" data-line-number="854"></td>
          <td id="LC854">End Function</td>
        </tr>
        <tr>
          <td id="L855" data-line-number="855"></td>
          <td id="LC855">
</td>
        </tr>
        <tr>
          <td id="L856" data-line-number="856"></td>
          <td id="LC856">Public Function TlsSend(uCtx As UcsTlsContext, baPlainText() As Byte, ByVal lSize As Long, baOutput() As Byte, lOutputPos As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L857" data-line-number="857"></td>
          <td id="LC857">    Const FUNC_NAME     As String = &#34;TlsSend&#34;</td>
        </tr>
        <tr>
          <td id="L858" data-line-number="858"></td>
          <td id="LC858">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L859" data-line-number="859"></td>
          <td id="LC859">    </td>
        </tr>
        <tr>
          <td id="L860" data-line-number="860"></td>
          <td id="LC860">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L861" data-line-number="861"></td>
          <td id="LC861">    With uCtx</td>
        </tr>
        <tr>
          <td id="L862" data-line-number="862"></td>
          <td id="LC862">        If lSize &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L863" data-line-number="863"></td>
          <td id="LC863">            lSize = pvArraySize(baPlainText)</td>
        </tr>
        <tr>
          <td id="L864" data-line-number="864"></td>
          <td id="LC864">        End If</td>
        </tr>
        <tr>
          <td id="L865" data-line-number="865"></td>
          <td id="LC865">        If .State = ucsTlsStateClosed Then</td>
        </tr>
        <tr>
          <td id="L866" data-line-number="866"></td>
          <td id="LC866">            pvTlsSetLastError uCtx, vbObjectError, MODULE_NAME &amp; &#34;.&#34; &amp; FUNC_NAME, ERR_CONNECTION_CLOSED</td>
        </tr>
        <tr>
          <td id="L867" data-line-number="867"></td>
          <td id="LC867">            Exit Function</td>
        </tr>
        <tr>
          <td id="L868" data-line-number="868"></td>
          <td id="LC868">        End If</td>
        </tr>
        <tr>
          <td id="L869" data-line-number="869"></td>
          <td id="LC869">        pvTlsClearLastError uCtx</td>
        </tr>
        <tr>
          <td id="L870" data-line-number="870"></td>
          <td id="LC870">        &#39;--- swap-in</td>
        </tr>
        <tr>
          <td id="L871" data-line-number="871"></td>
          <td id="LC871">        pvArraySwap .SendBuffer.Data, .SendBuffer.Size, baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L872" data-line-number="872"></td>
          <td id="LC872">        Do While lPos &lt; lSize</td>
        </tr>
        <tr>
          <td id="L873" data-line-number="873"></td>
          <td id="LC873">            pvTlsBuildApplicationData uCtx, .SendBuffer, baPlainText, lPos, Clamp(lSize - lPos, 0, TLS_MAX_PLAINTEXT_RECORD_SIZE), TLS_CONTENT_TYPE_APPDATA</td>
        </tr>
        <tr>
          <td id="L874" data-line-number="874"></td>
          <td id="LC874">            lPos = lPos + TLS_MAX_PLAINTEXT_RECORD_SIZE</td>
        </tr>
        <tr>
          <td id="L875" data-line-number="875"></td>
          <td id="LC875">        Loop</td>
        </tr>
        <tr>
          <td id="L876" data-line-number="876"></td>
          <td id="LC876">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L877" data-line-number="877"></td>
          <td id="LC877">        TlsSend = True</td>
        </tr>
        <tr>
          <td id="L878" data-line-number="878"></td>
          <td id="LC878">QH:</td>
        </tr>
        <tr>
          <td id="L879" data-line-number="879"></td>
          <td id="LC879">        &#39;--- swap-out</td>
        </tr>
        <tr>
          <td id="L880" data-line-number="880"></td>
          <td id="LC880">        pvArraySwap baOutput, lOutputPos, .SendBuffer.Data, .SendBuffer.Size</td>
        </tr>
        <tr>
          <td id="L881" data-line-number="881"></td>
          <td id="LC881">        pvArrayWriteEOF baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L882" data-line-number="882"></td>
          <td id="LC882">        #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L883" data-line-number="883"></td>
          <td id="LC883">            If lOutputPos &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L884" data-line-number="884"></td>
          <td id="LC884">                .TrafficDump.Add FUNC_NAME &amp; &#34;.Output (encrypted)&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baOutput, Size:=lOutputPos)</td>
        </tr>
        <tr>
          <td id="L885" data-line-number="885"></td>
          <td id="LC885">            End If</td>
        </tr>
        <tr>
          <td id="L886" data-line-number="886"></td>
          <td id="LC886">        #End If</td>
        </tr>
        <tr>
          <td id="L887" data-line-number="887"></td>
          <td id="LC887">    End With</td>
        </tr>
        <tr>
          <td id="L888" data-line-number="888"></td>
          <td id="LC888">    Exit Function</td>
        </tr>
        <tr>
          <td id="L889" data-line-number="889"></td>
          <td id="LC889">EH:</td>
        </tr>
        <tr>
          <td id="L890" data-line-number="890"></td>
          <td id="LC890">    pvTlsSetLastError uCtx, Err.Number, Err.Source, Err.Description</td>
        </tr>
        <tr>
          <td id="L891" data-line-number="891"></td>
          <td id="LC891">    Resume QH</td>
        </tr>
        <tr>
          <td id="L892" data-line-number="892"></td>
          <td id="LC892">End Function</td>
        </tr>
        <tr>
          <td id="L893" data-line-number="893"></td>
          <td id="LC893">
</td>
        </tr>
        <tr>
          <td id="L894" data-line-number="894"></td>
          <td id="LC894">Public Function TlsShutdown(uCtx As UcsTlsContext, baOutput() As Byte, lOutputPos As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L895" data-line-number="895"></td>
          <td id="LC895">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L896" data-line-number="896"></td>
          <td id="LC896">    With uCtx</td>
        </tr>
        <tr>
          <td id="L897" data-line-number="897"></td>
          <td id="LC897">        If .State = ucsTlsStateClosed Then</td>
        </tr>
        <tr>
          <td id="L898" data-line-number="898"></td>
          <td id="LC898">            Exit Function</td>
        </tr>
        <tr>
          <td id="L899" data-line-number="899"></td>
          <td id="LC899">        End If</td>
        </tr>
        <tr>
          <td id="L900" data-line-number="900"></td>
          <td id="LC900">        pvTlsClearLastError uCtx</td>
        </tr>
        <tr>
          <td id="L901" data-line-number="901"></td>
          <td id="LC901">        &#39;--- swap-in</td>
        </tr>
        <tr>
          <td id="L902" data-line-number="902"></td>
          <td id="LC902">        pvArraySwap .SendBuffer.Data, .SendBuffer.Size, baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L903" data-line-number="903"></td>
          <td id="LC903">        pvTlsBuildAlert uCtx, .SendBuffer, uscTlsAlertCloseNotify, TLS_ALERT_LEVEL_WARNING</td>
        </tr>
        <tr>
          <td id="L904" data-line-number="904"></td>
          <td id="LC904">        .State = ucsTlsStateShutdown</td>
        </tr>
        <tr>
          <td id="L905" data-line-number="905"></td>
          <td id="LC905">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L906" data-line-number="906"></td>
          <td id="LC906">        TlsShutdown = True</td>
        </tr>
        <tr>
          <td id="L907" data-line-number="907"></td>
          <td id="LC907">QH:</td>
        </tr>
        <tr>
          <td id="L908" data-line-number="908"></td>
          <td id="LC908">        &#39;--- swap-out</td>
        </tr>
        <tr>
          <td id="L909" data-line-number="909"></td>
          <td id="LC909">        pvArraySwap baOutput, lOutputPos, .SendBuffer.Data, .SendBuffer.Size</td>
        </tr>
        <tr>
          <td id="L910" data-line-number="910"></td>
          <td id="LC910">        pvArrayWriteEOF baOutput, lOutputPos</td>
        </tr>
        <tr>
          <td id="L911" data-line-number="911"></td>
          <td id="LC911">    End With</td>
        </tr>
        <tr>
          <td id="L912" data-line-number="912"></td>
          <td id="LC912">    Exit Function</td>
        </tr>
        <tr>
          <td id="L913" data-line-number="913"></td>
          <td id="LC913">EH:</td>
        </tr>
        <tr>
          <td id="L914" data-line-number="914"></td>
          <td id="LC914">    pvTlsSetLastError uCtx, Err.Number, Err.Source, Err.Description</td>
        </tr>
        <tr>
          <td id="L915" data-line-number="915"></td>
          <td id="LC915">    Resume QH</td>
        </tr>
        <tr>
          <td id="L916" data-line-number="916"></td>
          <td id="LC916">End Function</td>
        </tr>
        <tr>
          <td id="L917" data-line-number="917"></td>
          <td id="LC917">
</td>
        </tr>
        <tr>
          <td id="L918" data-line-number="918"></td>
          <td id="LC918">Public Function TlsGetLastError(uCtx As UcsTlsContext, Optional LastErrNumber As Long, Optional LastErrSource As String) As String</td>
        </tr>
        <tr>
          <td id="L919" data-line-number="919"></td>
          <td id="LC919">    LastErrNumber = uCtx.LastErrNumber</td>
        </tr>
        <tr>
          <td id="L920" data-line-number="920"></td>
          <td id="LC920">    LastErrSource = uCtx.LastErrSource</td>
        </tr>
        <tr>
          <td id="L921" data-line-number="921"></td>
          <td id="LC921">    TlsGetLastError = uCtx.LastError</td>
        </tr>
        <tr>
          <td id="L922" data-line-number="922"></td>
          <td id="LC922">    If uCtx.LastAlertCode &lt;&gt; -1 And uCtx.LastAlertCode &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L923" data-line-number="923"></td>
          <td id="LC923">        TlsGetLastError = IIf(LenB(TlsGetLastError) &lt;&gt; 0, TlsGetLastError &amp; &#34;. &#34;, vbNullString) &amp; Replace(STR_FORMAT_ALERT, &#34;%1&#34;, pvTlsGetLastAlert(uCtx))</td>
        </tr>
        <tr>
          <td id="L924" data-line-number="924"></td>
          <td id="LC924">        &#39;--- warnings</td>
        </tr>
        <tr>
          <td id="L925" data-line-number="925"></td>
          <td id="LC925">        Select Case uCtx.LastAlertCode</td>
        </tr>
        <tr>
          <td id="L926" data-line-number="926"></td>
          <td id="LC926">        Case uscTlsAlertCloseNotify, uscTlsAlertUserCanceled, uscTlsAlertNoRenegotiation</td>
        </tr>
        <tr>
          <td id="L927" data-line-number="927"></td>
          <td id="LC927">            LastErrNumber = 0</td>
        </tr>
        <tr>
          <td id="L928" data-line-number="928"></td>
          <td id="LC928">        End Select</td>
        </tr>
        <tr>
          <td id="L929" data-line-number="929"></td>
          <td id="LC929">    End If</td>
        </tr>
        <tr>
          <td id="L930" data-line-number="930"></td>
          <td id="LC930">End Function</td>
        </tr>
        <tr>
          <td id="L931" data-line-number="931"></td>
          <td id="LC931">
</td>
        </tr>
        <tr>
          <td id="L932" data-line-number="932"></td>
          <td id="LC932">Private Function pvTlsGetLastAlert(uCtx As UcsTlsContext, Optional AlertCode As UcsTlsAlertDescriptionsEnum) As String</td>
        </tr>
        <tr>
          <td id="L933" data-line-number="933"></td>
          <td id="LC933">    Static vTexts       As Variant</td>
        </tr>
        <tr>
          <td id="L934" data-line-number="934"></td>
          <td id="LC934">    </td>
        </tr>
        <tr>
          <td id="L935" data-line-number="935"></td>
          <td id="LC935">    AlertCode = uCtx.LastAlertCode</td>
        </tr>
        <tr>
          <td id="L936" data-line-number="936"></td>
          <td id="LC936">    If AlertCode &gt;= 0 Then</td>
        </tr>
        <tr>
          <td id="L937" data-line-number="937"></td>
          <td id="LC937">        If IsEmpty(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L938" data-line-number="938"></td>
          <td id="LC938">            vTexts = SplitOrReindex(STR_VL_ALERTS, &#34;|&#34;)</td>
        </tr>
        <tr>
          <td id="L939" data-line-number="939"></td>
          <td id="LC939">        End If</td>
        </tr>
        <tr>
          <td id="L940" data-line-number="940"></td>
          <td id="LC940">        If AlertCode &lt;= UBound(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L941" data-line-number="941"></td>
          <td id="LC941">            pvTlsGetLastAlert = vTexts(AlertCode)</td>
        </tr>
        <tr>
          <td id="L942" data-line-number="942"></td>
          <td id="LC942">        End If</td>
        </tr>
        <tr>
          <td id="L943" data-line-number="943"></td>
          <td id="LC943">        If LenB(pvTlsGetLastAlert) = 0 Then</td>
        </tr>
        <tr>
          <td id="L944" data-line-number="944"></td>
          <td id="LC944">            pvTlsGetLastAlert = Replace(STR_UNKNOWN, &#34;%1&#34;, AlertCode)</td>
        </tr>
        <tr>
          <td id="L945" data-line-number="945"></td>
          <td id="LC945">        End If</td>
        </tr>
        <tr>
          <td id="L946" data-line-number="946"></td>
          <td id="LC946">    End If</td>
        </tr>
        <tr>
          <td id="L947" data-line-number="947"></td>
          <td id="LC947">End Function</td>
        </tr>
        <tr>
          <td id="L948" data-line-number="948"></td>
          <td id="LC948">
</td>
        </tr>
        <tr>
          <td id="L949" data-line-number="949"></td>
          <td id="LC949">Private Function pvTlsGetStateAsText(ByVal lState As Long) As String</td>
        </tr>
        <tr>
          <td id="L950" data-line-number="950"></td>
          <td id="LC950">    Static vTexts       As Variant</td>
        </tr>
        <tr>
          <td id="L951" data-line-number="951"></td>
          <td id="LC951">    </td>
        </tr>
        <tr>
          <td id="L952" data-line-number="952"></td>
          <td id="LC952">    If IsEmpty(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L953" data-line-number="953"></td>
          <td id="LC953">        vTexts = SplitOrReindex(STR_VL_STATES, &#34;|&#34;)</td>
        </tr>
        <tr>
          <td id="L954" data-line-number="954"></td>
          <td id="LC954">    End If</td>
        </tr>
        <tr>
          <td id="L955" data-line-number="955"></td>
          <td id="LC955">    If 0 &lt;= lState And lState &lt;= UBound(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L956" data-line-number="956"></td>
          <td id="LC956">        pvTlsGetStateAsText = vTexts(lState)</td>
        </tr>
        <tr>
          <td id="L957" data-line-number="957"></td>
          <td id="LC957">    End If</td>
        </tr>
        <tr>
          <td id="L958" data-line-number="958"></td>
          <td id="LC958">    If LenB(pvTlsGetStateAsText) = 0 Then</td>
        </tr>
        <tr>
          <td id="L959" data-line-number="959"></td>
          <td id="LC959">        pvTlsGetStateAsText = Replace(STR_UNKNOWN, &#34;%1&#34;, lState)</td>
        </tr>
        <tr>
          <td id="L960" data-line-number="960"></td>
          <td id="LC960">    End If</td>
        </tr>
        <tr>
          <td id="L961" data-line-number="961"></td>
          <td id="LC961">End Function</td>
        </tr>
        <tr>
          <td id="L962" data-line-number="962"></td>
          <td id="LC962">
</td>
        </tr>
        <tr>
          <td id="L963" data-line-number="963"></td>
          <td id="LC963">Private Function pvTlsGetMessageName(ByVal lMessageType As Long) As String</td>
        </tr>
        <tr>
          <td id="L964" data-line-number="964"></td>
          <td id="LC964">    Static vTexts       As Variant</td>
        </tr>
        <tr>
          <td id="L965" data-line-number="965"></td>
          <td id="LC965">    </td>
        </tr>
        <tr>
          <td id="L966" data-line-number="966"></td>
          <td id="LC966">    If IsEmpty(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L967" data-line-number="967"></td>
          <td id="LC967">        vTexts = SplitOrReindex(STR_VL_MESSAGE_NAMES, &#34;|&#34;)</td>
        </tr>
        <tr>
          <td id="L968" data-line-number="968"></td>
          <td id="LC968">    End If</td>
        </tr>
        <tr>
          <td id="L969" data-line-number="969"></td>
          <td id="LC969">    If 0 &lt;= lMessageType And lMessageType &lt;= UBound(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L970" data-line-number="970"></td>
          <td id="LC970">        pvTlsGetMessageName = vTexts(lMessageType)</td>
        </tr>
        <tr>
          <td id="L971" data-line-number="971"></td>
          <td id="LC971">    End If</td>
        </tr>
        <tr>
          <td id="L972" data-line-number="972"></td>
          <td id="LC972">    If LenB(pvTlsGetMessageName) = 0 Then</td>
        </tr>
        <tr>
          <td id="L973" data-line-number="973"></td>
          <td id="LC973">        pvTlsGetMessageName = Replace(STR_UNKNOWN, &#34;%1&#34;, lMessageType)</td>
        </tr>
        <tr>
          <td id="L974" data-line-number="974"></td>
          <td id="LC974">    Else</td>
        </tr>
        <tr>
          <td id="L975" data-line-number="975"></td>
          <td id="LC975">        pvTlsGetMessageName = pvTlsGetMessageName &amp; &#34; (&#34; &amp; lMessageType &amp; &#34;)&#34;</td>
        </tr>
        <tr>
          <td id="L976" data-line-number="976"></td>
          <td id="LC976">    End If</td>
        </tr>
        <tr>
          <td id="L977" data-line-number="977"></td>
          <td id="LC977">End Function</td>
        </tr>
        <tr>
          <td id="L978" data-line-number="978"></td>
          <td id="LC978">
</td>
        </tr>
        <tr>
          <td id="L979" data-line-number="979"></td>
          <td id="LC979">Private Function pvTlsGetExtensionName(ByVal lExtType As Long) As String</td>
        </tr>
        <tr>
          <td id="L980" data-line-number="980"></td>
          <td id="LC980">    Static vTexts       As Variant</td>
        </tr>
        <tr>
          <td id="L981" data-line-number="981"></td>
          <td id="LC981">    </td>
        </tr>
        <tr>
          <td id="L982" data-line-number="982"></td>
          <td id="LC982">    If IsEmpty(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L983" data-line-number="983"></td>
          <td id="LC983">        vTexts = SplitOrReindex(STR_VL_EXTENSION_NAMES, &#34;|&#34;)</td>
        </tr>
        <tr>
          <td id="L984" data-line-number="984"></td>
          <td id="LC984">    End If</td>
        </tr>
        <tr>
          <td id="L985" data-line-number="985"></td>
          <td id="LC985">    If 0 &lt;= lExtType And lExtType &lt;= UBound(vTexts) Then</td>
        </tr>
        <tr>
          <td id="L986" data-line-number="986"></td>
          <td id="LC986">        pvTlsGetExtensionName = vTexts(lExtType)</td>
        </tr>
        <tr>
          <td id="L987" data-line-number="987"></td>
          <td id="LC987">    ElseIf lExtType = &amp;HFF01&amp; Then</td>
        </tr>
        <tr>
          <td id="L988" data-line-number="988"></td>
          <td id="LC988">        pvTlsGetExtensionName = &#34;renegotiation_info&#34;</td>
        </tr>
        <tr>
          <td id="L989" data-line-number="989"></td>
          <td id="LC989">    End If</td>
        </tr>
        <tr>
          <td id="L990" data-line-number="990"></td>
          <td id="LC990">    If LenB(pvTlsGetExtensionName) = 0 Then</td>
        </tr>
        <tr>
          <td id="L991" data-line-number="991"></td>
          <td id="LC991">        pvTlsGetExtensionName = Replace(STR_UNKNOWN, &#34;%1&#34;, lExtType)</td>
        </tr>
        <tr>
          <td id="L992" data-line-number="992"></td>
          <td id="LC992">    Else</td>
        </tr>
        <tr>
          <td id="L993" data-line-number="993"></td>
          <td id="LC993">        pvTlsGetExtensionName = pvTlsGetExtensionName &amp; &#34; (&#34; &amp; lExtType &amp; &#34;)&#34;</td>
        </tr>
        <tr>
          <td id="L994" data-line-number="994"></td>
          <td id="LC994">    End If</td>
        </tr>
        <tr>
          <td id="L995" data-line-number="995"></td>
          <td id="LC995">End Function</td>
        </tr>
        <tr>
          <td id="L996" data-line-number="996"></td>
          <td id="LC996">
</td>
        </tr>
        <tr>
          <td id="L997" data-line-number="997"></td>
          <td id="LC997">Private Sub pvTlsBuildClientHello(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L998" data-line-number="998"></td>
          <td id="LC998">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L999" data-line-number="999"></td>
          <td id="LC999">    Dim vElem           As Variant</td>
        </tr>
        <tr>
          <td id="L1000" data-line-number="1000"></td>
          <td id="LC1000">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L1001" data-line-number="1001"></td>
          <td id="LC1001">    </td>
        </tr>
        <tr>
          <td id="L1002" data-line-number="1002"></td>
          <td id="LC1002">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1003" data-line-number="1003"></td>
          <td id="LC1003">        If (.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0 And .ExchGroup = 0 Then</td>
        </tr>
        <tr>
          <td id="L1004" data-line-number="1004"></td>
          <td id="LC1004">            &#39;--- populate preferred .ExchGroup and .LocalExchPublic</td>
        </tr>
        <tr>
          <td id="L1005" data-line-number="1005"></td>
          <td id="LC1005">            If pvCryptoIsSupported(ucsTlsAlgoExchX25519) Then</td>
        </tr>
        <tr>
          <td id="L1006" data-line-number="1006"></td>
          <td id="LC1006">                pvTlsSetupExchGroup uCtx, TLS_GROUP_X25519</td>
        </tr>
        <tr>
          <td id="L1007" data-line-number="1007"></td>
          <td id="LC1007">            ElseIf pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1) Then</td>
        </tr>
        <tr>
          <td id="L1008" data-line-number="1008"></td>
          <td id="LC1008">                pvTlsSetupExchGroup uCtx, TLS_GROUP_SECP256R1</td>
        </tr>
        <tr>
          <td id="L1009" data-line-number="1009"></td>
          <td id="LC1009">            ElseIf pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1) Then</td>
        </tr>
        <tr>
          <td id="L1010" data-line-number="1010"></td>
          <td id="LC1010">                pvTlsSetupExchGroup uCtx, TLS_GROUP_SECP384R1</td>
        </tr>
        <tr>
          <td id="L1011" data-line-number="1011"></td>
          <td id="LC1011">            End If</td>
        </tr>
        <tr>
          <td id="L1012" data-line-number="1012"></td>
          <td id="LC1012">        End If</td>
        </tr>
        <tr>
          <td id="L1013" data-line-number="1013"></td>
          <td id="LC1013">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1014" data-line-number="1014"></td>
          <td id="LC1014">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1015" data-line-number="1015"></td>
          <td id="LC1015">            &#39;--- Handshake Header</td>
        </tr>
        <tr>
          <td id="L1016" data-line-number="1016"></td>
          <td id="LC1016">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1017" data-line-number="1017"></td>
          <td id="LC1017">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_CLIENT_HELLO</td>
        </tr>
        <tr>
          <td id="L1018" data-line-number="1018"></td>
          <td id="LC1018">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1019" data-line-number="1019"></td>
          <td id="LC1019">                pvBufferWriteLong uOutput, TLS_LOCAL_LEGACY_VERSION, Size:=2</td>
        </tr>
        <tr>
          <td id="L1020" data-line-number="1020"></td>
          <td id="LC1020">                pvTlsGetRandom .LocalExchRandom, TLS_HELLO_RANDOM_SIZE</td>
        </tr>
        <tr>
          <td id="L1021" data-line-number="1021"></td>
          <td id="LC1021">                pvBufferWriteArray uOutput, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L1022" data-line-number="1022"></td>
          <td id="LC1022">                &#39;--- Legacy Session ID</td>
        </tr>
        <tr>
          <td id="L1023" data-line-number="1023"></td>
          <td id="LC1023">                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1024" data-line-number="1024"></td>
          <td id="LC1024">                    If pvArraySize(.LocalSessionID) = 0 And (.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1025" data-line-number="1025"></td>
          <td id="LC1025">                        &#39;--- non-empty for TLS 1.2 compatibility</td>
        </tr>
        <tr>
          <td id="L1026" data-line-number="1026"></td>
          <td id="LC1026">                        pvTlsGetRandom baTemp, TLS_HELLO_RANDOM_SIZE</td>
        </tr>
        <tr>
          <td id="L1027" data-line-number="1027"></td>
          <td id="LC1027">                        pvBufferWriteArray uOutput, baTemp</td>
        </tr>
        <tr>
          <td id="L1028" data-line-number="1028"></td>
          <td id="LC1028">                    Else</td>
        </tr>
        <tr>
          <td id="L1029" data-line-number="1029"></td>
          <td id="LC1029">                        pvBufferWriteArray uOutput, .LocalSessionID</td>
        </tr>
        <tr>
          <td id="L1030" data-line-number="1030"></td>
          <td id="LC1030">                    End If</td>
        </tr>
        <tr>
          <td id="L1031" data-line-number="1031"></td>
          <td id="LC1031">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1032" data-line-number="1032"></td>
          <td id="LC1032">                &#39;--- Cipher Suites</td>
        </tr>
        <tr>
          <td id="L1033" data-line-number="1033"></td>
          <td id="LC1033">                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1034" data-line-number="1034"></td>
          <td id="LC1034">                    For Each vElem In pvTlsGetSortedCipherSuites(.LocalFeatures)</td>
        </tr>
        <tr>
          <td id="L1035" data-line-number="1035"></td>
          <td id="LC1035">                        pvBufferWriteLong uOutput, vElem, Size:=2</td>
        </tr>
        <tr>
          <td id="L1036" data-line-number="1036"></td>
          <td id="LC1036">                    Next</td>
        </tr>
        <tr>
          <td id="L1037" data-line-number="1037"></td>
          <td id="LC1037">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1038" data-line-number="1038"></td>
          <td id="LC1038">                &#39;--- Legacy Compression Methods</td>
        </tr>
        <tr>
          <td id="L1039" data-line-number="1039"></td>
          <td id="LC1039">                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1040" data-line-number="1040"></td>
          <td id="LC1040">                    pvBufferWriteLong uOutput, TLS_COMPRESS_NULL</td>
        </tr>
        <tr>
          <td id="L1041" data-line-number="1041"></td>
          <td id="LC1041">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1042" data-line-number="1042"></td>
          <td id="LC1042">                &#39;--- Extensions</td>
        </tr>
        <tr>
          <td id="L1043" data-line-number="1043"></td>
          <td id="LC1043">                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1044" data-line-number="1044"></td>
          <td id="LC1044">                    If LenB(.RemoteHostName) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1045" data-line-number="1045"></td>
          <td id="LC1045">                        &#39;--- Extension - Server Name</td>
        </tr>
        <tr>
          <td id="L1046" data-line-number="1046"></td>
          <td id="LC1046">                        pvBufferWriteLong uOutput, TLS_EXTENSION_SERVER_NAME, Size:=2</td>
        </tr>
        <tr>
          <td id="L1047" data-line-number="1047"></td>
          <td id="LC1047">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1048" data-line-number="1048"></td>
          <td id="LC1048">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1049" data-line-number="1049"></td>
          <td id="LC1049">                                pvBufferWriteLong uOutput, TLS_SERVER_NAME_TYPE_HOSTNAME &#39;--- FQDN</td>
        </tr>
        <tr>
          <td id="L1050" data-line-number="1050"></td>
          <td id="LC1050">                                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1051" data-line-number="1051"></td>
          <td id="LC1051">                                    pvBufferWriteString uOutput, .RemoteHostName</td>
        </tr>
        <tr>
          <td id="L1052" data-line-number="1052"></td>
          <td id="LC1052">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1053" data-line-number="1053"></td>
          <td id="LC1053">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1054" data-line-number="1054"></td>
          <td id="LC1054">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1055" data-line-number="1055"></td>
          <td id="LC1055">                    End If</td>
        </tr>
        <tr>
          <td id="L1056" data-line-number="1056"></td>
          <td id="LC1056">                    If LenB(.AlpnProtocols) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1057" data-line-number="1057"></td>
          <td id="LC1057">                        &#39;--- Extension - ALPN</td>
        </tr>
        <tr>
          <td id="L1058" data-line-number="1058"></td>
          <td id="LC1058">                        pvBufferWriteLong uOutput, TLS_EXTENSION_ALPN, Size:=2</td>
        </tr>
        <tr>
          <td id="L1059" data-line-number="1059"></td>
          <td id="LC1059">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1060" data-line-number="1060"></td>
          <td id="LC1060">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1061" data-line-number="1061"></td>
          <td id="LC1061">                                For Each vElem In Split(.AlpnProtocols, &#34;|&#34;)</td>
        </tr>
        <tr>
          <td id="L1062" data-line-number="1062"></td>
          <td id="LC1062">                                    pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1063" data-line-number="1063"></td>
          <td id="LC1063">                                        pvBufferWriteString uOutput, Left$(vElem, 255)</td>
        </tr>
        <tr>
          <td id="L1064" data-line-number="1064"></td>
          <td id="LC1064">                                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1065" data-line-number="1065"></td>
          <td id="LC1065">                                Next</td>
        </tr>
        <tr>
          <td id="L1066" data-line-number="1066"></td>
          <td id="LC1066">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1067" data-line-number="1067"></td>
          <td id="LC1067">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1068" data-line-number="1068"></td>
          <td id="LC1068">                    End If</td>
        </tr>
        <tr>
          <td id="L1069" data-line-number="1069"></td>
          <td id="LC1069">                    &#39;--- Extension - Supported Groups</td>
        </tr>
        <tr>
          <td id="L1070" data-line-number="1070"></td>
          <td id="LC1070">                    pvBufferWriteLong uOutput, TLS_EXTENSION_SUPPORTED_GROUPS, Size:=2</td>
        </tr>
        <tr>
          <td id="L1071" data-line-number="1071"></td>
          <td id="LC1071">                    pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1072" data-line-number="1072"></td>
          <td id="LC1072">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1073" data-line-number="1073"></td>
          <td id="LC1073">                            If pvCryptoIsSupported(ucsTlsAlgoExchX25519) Then</td>
        </tr>
        <tr>
          <td id="L1074" data-line-number="1074"></td>
          <td id="LC1074">                                If .HelloRetryExchGroup = 0 Or .HelloRetryExchGroup = TLS_GROUP_X25519 Then</td>
        </tr>
        <tr>
          <td id="L1075" data-line-number="1075"></td>
          <td id="LC1075">                                    pvBufferWriteLong uOutput, TLS_GROUP_X25519, Size:=2</td>
        </tr>
        <tr>
          <td id="L1076" data-line-number="1076"></td>
          <td id="LC1076">                                End If</td>
        </tr>
        <tr>
          <td id="L1077" data-line-number="1077"></td>
          <td id="LC1077">                            End If</td>
        </tr>
        <tr>
          <td id="L1078" data-line-number="1078"></td>
          <td id="LC1078">                            If pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1) Then</td>
        </tr>
        <tr>
          <td id="L1079" data-line-number="1079"></td>
          <td id="LC1079">                                If .HelloRetryExchGroup = 0 Or .HelloRetryExchGroup = TLS_GROUP_SECP256R1 Then</td>
        </tr>
        <tr>
          <td id="L1080" data-line-number="1080"></td>
          <td id="LC1080">                                    pvBufferWriteLong uOutput, TLS_GROUP_SECP256R1, Size:=2</td>
        </tr>
        <tr>
          <td id="L1081" data-line-number="1081"></td>
          <td id="LC1081">                                End If</td>
        </tr>
        <tr>
          <td id="L1082" data-line-number="1082"></td>
          <td id="LC1082">                            End If</td>
        </tr>
        <tr>
          <td id="L1083" data-line-number="1083"></td>
          <td id="LC1083">                            If pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1) Then</td>
        </tr>
        <tr>
          <td id="L1084" data-line-number="1084"></td>
          <td id="LC1084">                                If .HelloRetryExchGroup = 0 Or .HelloRetryExchGroup = TLS_GROUP_SECP384R1 Then</td>
        </tr>
        <tr>
          <td id="L1085" data-line-number="1085"></td>
          <td id="LC1085">                                    pvBufferWriteLong uOutput, TLS_GROUP_SECP384R1, Size:=2</td>
        </tr>
        <tr>
          <td id="L1086" data-line-number="1086"></td>
          <td id="LC1086">                                End If</td>
        </tr>
        <tr>
          <td id="L1087" data-line-number="1087"></td>
          <td id="LC1087">                            End If</td>
        </tr>
        <tr>
          <td id="L1088" data-line-number="1088"></td>
          <td id="LC1088">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1089" data-line-number="1089"></td>
          <td id="LC1089">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1090" data-line-number="1090"></td>
          <td id="LC1090">                    &#39;--- Extension - OCSP Status Request</td>
        </tr>
        <tr>
          <td id="L1091" data-line-number="1091"></td>
          <td id="LC1091">                    pvArrayByte baTemp, 0, TLS_EXTENSION_STATUS_REQUEST, 0, 5, 1, 0, 0, 0, 0</td>
        </tr>
        <tr>
          <td id="L1092" data-line-number="1092"></td>
          <td id="LC1092">                    pvBufferWriteArray uOutput, baTemp</td>
        </tr>
        <tr>
          <td id="L1093" data-line-number="1093"></td>
          <td id="LC1093">                    If (.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1094" data-line-number="1094"></td>
          <td id="LC1094">                        &#39;--- Extension - EC Point Formats</td>
        </tr>
        <tr>
          <td id="L1095" data-line-number="1095"></td>
          <td id="LC1095">                        pvArrayByte baTemp, 0, TLS_EXTENSION_EC_POINT_FORMAT, 0, 2, 1, 0</td>
        </tr>
        <tr>
          <td id="L1096" data-line-number="1096"></td>
          <td id="LC1096">                        pvBufferWriteArray uOutput, baTemp      &#39;--- uncompressed only</td>
        </tr>
        <tr>
          <td id="L1097" data-line-number="1097"></td>
          <td id="LC1097">                        &#39;--- Extension - Extended Master Secret</td>
        </tr>
        <tr>
          <td id="L1098" data-line-number="1098"></td>
          <td id="LC1098">                        pvArrayByte baTemp, 0, TLS_EXTENSION_EXTENDED_MASTER_SECRET, 0, 0</td>
        </tr>
        <tr>
          <td id="L1099" data-line-number="1099"></td>
          <td id="LC1099">                        pvBufferWriteArray uOutput, baTemp      &#39;--- supported</td>
        </tr>
        <tr>
          <td id="L1100" data-line-number="1100"></td>
          <td id="LC1100">                        &#39;--- Extension - Encrypt-then-MAC</td>
        </tr>
        <tr>
          <td id="L1101" data-line-number="1101"></td>
          <td id="LC1101">                        pvArrayByte baTemp, 0, TLS_EXTENSION_ENCRYPT_THEN_MAC, 0, 0</td>
        </tr>
        <tr>
          <td id="L1102" data-line-number="1102"></td>
          <td id="LC1102">                        pvBufferWriteArray uOutput, baTemp      &#39;--- supported</td>
        </tr>
        <tr>
          <td id="L1103" data-line-number="1103"></td>
          <td id="LC1103">                        &#39;--- Extension - Renegotiation Info</td>
        </tr>
        <tr>
          <td id="L1104" data-line-number="1104"></td>
          <td id="LC1104">                        pvBufferWriteLong uOutput, TLS_EXTENSION_RENEGOTIATION_INFO, Size:=2</td>
        </tr>
        <tr>
          <td id="L1105" data-line-number="1105"></td>
          <td id="LC1105">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1106" data-line-number="1106"></td>
          <td id="LC1106">                            pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1107" data-line-number="1107"></td>
          <td id="LC1107">                                pvBufferWriteArray uOutput, .LocalLegacyVerifyData</td>
        </tr>
        <tr>
          <td id="L1108" data-line-number="1108"></td>
          <td id="LC1108">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1109" data-line-number="1109"></td>
          <td id="LC1109">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1110" data-line-number="1110"></td>
          <td id="LC1110">                        &#39;--- Extension - Session Ticket</td>
        </tr>
        <tr>
          <td id="L1111" data-line-number="1111"></td>
          <td id="LC1111">                        pvBufferWriteLong uOutput, TLS_EXTENSION_SESSION_TICKET, Size:=2</td>
        </tr>
        <tr>
          <td id="L1112" data-line-number="1112"></td>
          <td id="LC1112">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1113" data-line-number="1113"></td>
          <td id="LC1113">                            pvBufferWriteLong uOutput, 0, Size:=4</td>
        </tr>
        <tr>
          <td id="L1114" data-line-number="1114"></td>
          <td id="LC1114">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1115" data-line-number="1115"></td>
          <td id="LC1115">                                pvBufferWriteArray uOutput, .LocalSessionTicket</td>
        </tr>
        <tr>
          <td id="L1116" data-line-number="1116"></td>
          <td id="LC1116">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1117" data-line-number="1117"></td>
          <td id="LC1117">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1118" data-line-number="1118"></td>
          <td id="LC1118">                    End If</td>
        </tr>
        <tr>
          <td id="L1119" data-line-number="1119"></td>
          <td id="LC1119">                    &#39;--- Extension - Signature Algorithms</td>
        </tr>
        <tr>
          <td id="L1120" data-line-number="1120"></td>
          <td id="LC1120">                    pvBufferWriteLong uOutput, TLS_EXTENSION_SIGNATURE_ALGORITHMS, Size:=2</td>
        </tr>
        <tr>
          <td id="L1121" data-line-number="1121"></td>
          <td id="LC1121">                    pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1122" data-line-number="1122"></td>
          <td id="LC1122">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1123" data-line-number="1123"></td>
          <td id="LC1123">                            If pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1) Then</td>
        </tr>
        <tr>
          <td id="L1124" data-line-number="1124"></td>
          <td id="LC1124">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_ECDSA_SECP256R1_SHA256, Size:=2</td>
        </tr>
        <tr>
          <td id="L1125" data-line-number="1125"></td>
          <td id="LC1125">                            End If</td>
        </tr>
        <tr>
          <td id="L1126" data-line-number="1126"></td>
          <td id="LC1126">                            If pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1) Then</td>
        </tr>
        <tr>
          <td id="L1127" data-line-number="1127"></td>
          <td id="LC1127">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_ECDSA_SECP384R1_SHA384, Size:=2</td>
        </tr>
        <tr>
          <td id="L1128" data-line-number="1128"></td>
          <td id="LC1128">                            End If</td>
        </tr>
        <tr>
          <td id="L1129" data-line-number="1129"></td>
          <td id="LC1129">                            If pvCryptoIsSupported(ucsTlsAlgoExchSecp521r1) Then</td>
        </tr>
        <tr>
          <td id="L1130" data-line-number="1130"></td>
          <td id="LC1130">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_ECDSA_SECP521R1_SHA512, Size:=2</td>
        </tr>
        <tr>
          <td id="L1131" data-line-number="1131"></td>
          <td id="LC1131">                            End If</td>
        </tr>
        <tr>
          <td id="L1132" data-line-number="1132"></td>
          <td id="LC1132">                            If pvCryptoIsSupported(ucsTlsAlgoPaddingPss) Then</td>
        </tr>
        <tr>
          <td id="L1133" data-line-number="1133"></td>
          <td id="LC1133">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PSS_RSAE_SHA256, Size:=2</td>
        </tr>
        <tr>
          <td id="L1134" data-line-number="1134"></td>
          <td id="LC1134">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PSS_RSAE_SHA384, Size:=2</td>
        </tr>
        <tr>
          <td id="L1135" data-line-number="1135"></td>
          <td id="LC1135">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PSS_RSAE_SHA512, Size:=2</td>
        </tr>
        <tr>
          <td id="L1136" data-line-number="1136"></td>
          <td id="LC1136">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PSS_PSS_SHA256, Size:=2</td>
        </tr>
        <tr>
          <td id="L1137" data-line-number="1137"></td>
          <td id="LC1137">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PSS_PSS_SHA384, Size:=2</td>
        </tr>
        <tr>
          <td id="L1138" data-line-number="1138"></td>
          <td id="LC1138">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PSS_PSS_SHA512, Size:=2</td>
        </tr>
        <tr>
          <td id="L1139" data-line-number="1139"></td>
          <td id="LC1139">                            End If</td>
        </tr>
        <tr>
          <td id="L1140" data-line-number="1140"></td>
          <td id="LC1140">                            If pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs) Then</td>
        </tr>
        <tr>
          <td id="L1141" data-line-number="1141"></td>
          <td id="LC1141">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PKCS1_SHA224, Size:=2</td>
        </tr>
        <tr>
          <td id="L1142" data-line-number="1142"></td>
          <td id="LC1142">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PKCS1_SHA256, Size:=2</td>
        </tr>
        <tr>
          <td id="L1143" data-line-number="1143"></td>
          <td id="LC1143">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PKCS1_SHA384, Size:=2</td>
        </tr>
        <tr>
          <td id="L1144" data-line-number="1144"></td>
          <td id="LC1144">                                pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PKCS1_SHA512, Size:=2</td>
        </tr>
        <tr>
          <td id="L1145" data-line-number="1145"></td>
          <td id="LC1145">                            End If</td>
        </tr>
        <tr>
          <td id="L1146" data-line-number="1146"></td>
          <td id="LC1146">                            &#39;--- legacy SHA-1 based signatures</td>
        </tr>
        <tr>
          <td id="L1147" data-line-number="1147"></td>
          <td id="LC1147">                            If pvCryptoIsSupported(ucsTlsAlgoDigestSha1) Then</td>
        </tr>
        <tr>
          <td id="L1148" data-line-number="1148"></td>
          <td id="LC1148">                                If pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs) Then</td>
        </tr>
        <tr>
          <td id="L1149" data-line-number="1149"></td>
          <td id="LC1149">                                    pvBufferWriteLong uOutput, TLS_SIGNATURE_RSA_PKCS1_SHA1, Size:=2</td>
        </tr>
        <tr>
          <td id="L1150" data-line-number="1150"></td>
          <td id="LC1150">                                End If</td>
        </tr>
        <tr>
          <td id="L1151" data-line-number="1151"></td>
          <td id="LC1151">                                If pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1) Or pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1) Then</td>
        </tr>
        <tr>
          <td id="L1152" data-line-number="1152"></td>
          <td id="LC1152">                                    pvBufferWriteLong uOutput, TLS_SIGNATURE_ECDSA_SHA1, Size:=2</td>
        </tr>
        <tr>
          <td id="L1153" data-line-number="1153"></td>
          <td id="LC1153">                                End If</td>
        </tr>
        <tr>
          <td id="L1154" data-line-number="1154"></td>
          <td id="LC1154">                            End If</td>
        </tr>
        <tr>
          <td id="L1155" data-line-number="1155"></td>
          <td id="LC1155">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1156" data-line-number="1156"></td>
          <td id="LC1156">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1157" data-line-number="1157"></td>
          <td id="LC1157">                    If (.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1158" data-line-number="1158"></td>
          <td id="LC1158">                        &#39;--- Extension - Post Handshake Auth</td>
        </tr>
        <tr>
          <td id="L1159" data-line-number="1159"></td>
          <td id="LC1159">                        pvArrayByte baTemp, 0, TLS_EXTENSION_POST_HANDSHAKE_AUTH, 0, 0</td>
        </tr>
        <tr>
          <td id="L1160" data-line-number="1160"></td>
          <td id="LC1160">                        pvBufferWriteArray uOutput, baTemp     &#39;--- supported</td>
        </tr>
        <tr>
          <td id="L1161" data-line-number="1161"></td>
          <td id="LC1161">                        &#39;--- Extension - Key Share</td>
        </tr>
        <tr>
          <td id="L1162" data-line-number="1162"></td>
          <td id="LC1162">                        pvBufferWriteLong uOutput, TLS_EXTENSION_KEY_SHARE, Size:=2</td>
        </tr>
        <tr>
          <td id="L1163" data-line-number="1163"></td>
          <td id="LC1163">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1164" data-line-number="1164"></td>
          <td id="LC1164">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1165" data-line-number="1165"></td>
          <td id="LC1165">                                pvBufferWriteLong uOutput, .ExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L1166" data-line-number="1166"></td>
          <td id="LC1166">                                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1167" data-line-number="1167"></td>
          <td id="LC1167">                                    pvBufferWriteArray uOutput, .LocalExchPublic</td>
        </tr>
        <tr>
          <td id="L1168" data-line-number="1168"></td>
          <td id="LC1168">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1169" data-line-number="1169"></td>
          <td id="LC1169">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1170" data-line-number="1170"></td>
          <td id="LC1170">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1171" data-line-number="1171"></td>
          <td id="LC1171">                        &#39;--- Extension - Supported Versions</td>
        </tr>
        <tr>
          <td id="L1172" data-line-number="1172"></td>
          <td id="LC1172">                        pvBufferWriteLong uOutput, TLS_EXTENSION_SUPPORTED_VERSIONS, Size:=2</td>
        </tr>
        <tr>
          <td id="L1173" data-line-number="1173"></td>
          <td id="LC1173">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1174" data-line-number="1174"></td>
          <td id="LC1174">                            pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1175" data-line-number="1175"></td>
          <td id="LC1175">                                pvBufferWriteLong uOutput, TLS_PROTOCOL_VERSION_TLS13, Size:=2</td>
        </tr>
        <tr>
          <td id="L1176" data-line-number="1176"></td>
          <td id="LC1176">                                If (.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1177" data-line-number="1177"></td>
          <td id="LC1177">                                    pvBufferWriteLong uOutput, TLS_PROTOCOL_VERSION_TLS12, Size:=2</td>
        </tr>
        <tr>
          <td id="L1178" data-line-number="1178"></td>
          <td id="LC1178">                                End If</td>
        </tr>
        <tr>
          <td id="L1179" data-line-number="1179"></td>
          <td id="LC1179">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1180" data-line-number="1180"></td>
          <td id="LC1180">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1181" data-line-number="1181"></td>
          <td id="LC1181">                        If .HelloRetryRequest And SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_COOKIE) Then</td>
        </tr>
        <tr>
          <td id="L1182" data-line-number="1182"></td>
          <td id="LC1182">                            &#39;--- Extension - Cookie</td>
        </tr>
        <tr>
          <td id="L1183" data-line-number="1183"></td>
          <td id="LC1183">                            pvBufferWriteLong uOutput, TLS_EXTENSION_COOKIE, Size:=2</td>
        </tr>
        <tr>
          <td id="L1184" data-line-number="1184"></td>
          <td id="LC1184">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1185" data-line-number="1185"></td>
          <td id="LC1185">                                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1186" data-line-number="1186"></td>
          <td id="LC1186">                                    pvBufferWriteArray uOutput, .HelloRetryCookie</td>
        </tr>
        <tr>
          <td id="L1187" data-line-number="1187"></td>
          <td id="LC1187">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1188" data-line-number="1188"></td>
          <td id="LC1188">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1189" data-line-number="1189"></td>
          <td id="LC1189">                        End If</td>
        </tr>
        <tr>
          <td id="L1190" data-line-number="1190"></td>
          <td id="LC1190">                    End If</td>
        </tr>
        <tr>
          <td id="L1191" data-line-number="1191"></td>
          <td id="LC1191">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1192" data-line-number="1192"></td>
          <td id="LC1192">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1193" data-line-number="1193"></td>
          <td id="LC1193">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1194" data-line-number="1194"></td>
          <td id="LC1194">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1195" data-line-number="1195"></td>
          <td id="LC1195">    End With</td>
        </tr>
        <tr>
          <td id="L1196" data-line-number="1196"></td>
          <td id="LC1196">QH:</td>
        </tr>
        <tr>
          <td id="L1197" data-line-number="1197"></td>
          <td id="LC1197">End Sub</td>
        </tr>
        <tr>
          <td id="L1198" data-line-number="1198"></td>
          <td id="LC1198">
</td>
        </tr>
        <tr>
          <td id="L1199" data-line-number="1199"></td>
          <td id="LC1199">Private Sub pvTlsBuildClientLegacyKeyExchange(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L1200" data-line-number="1200"></td>
          <td id="LC1200">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L1201" data-line-number="1201"></td>
          <td id="LC1201">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L1202" data-line-number="1202"></td>
          <td id="LC1202">    Dim baVerifyData()  As Byte</td>
        </tr>
        <tr>
          <td id="L1203" data-line-number="1203"></td>
          <td id="LC1203">    Dim baSignature()   As Byte</td>
        </tr>
        <tr>
          <td id="L1204" data-line-number="1204"></td>
          <td id="LC1204">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L1205" data-line-number="1205"></td>
          <td id="LC1205">    Dim baCert()        As Byte</td>
        </tr>
        <tr>
          <td id="L1206" data-line-number="1206"></td>
          <td id="LC1206">    </td>
        </tr>
        <tr>
          <td id="L1207" data-line-number="1207"></td>
          <td id="LC1207">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1208" data-line-number="1208"></td>
          <td id="LC1208">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1209" data-line-number="1209"></td>
          <td id="LC1209">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1210" data-line-number="1210"></td>
          <td id="LC1210">            If .CertRequestSignatureScheme &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1211" data-line-number="1211"></td>
          <td id="LC1211">                &#39;--- Client Certificate</td>
        </tr>
        <tr>
          <td id="L1212" data-line-number="1212"></td>
          <td id="LC1212">                lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1213" data-line-number="1213"></td>
          <td id="LC1213">                pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L1214" data-line-number="1214"></td>
          <td id="LC1214">                pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1215" data-line-number="1215"></td>
          <td id="LC1215">                    pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1216" data-line-number="1216"></td>
          <td id="LC1216">                        For lIdx = 1 To pvCollectionCount(.LocalCertificates)</td>
        </tr>
        <tr>
          <td id="L1217" data-line-number="1217"></td>
          <td id="LC1217">                            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1218" data-line-number="1218"></td>
          <td id="LC1218">                                baCert = .LocalCertificates.Item(lIdx)</td>
        </tr>
        <tr>
          <td id="L1219" data-line-number="1219"></td>
          <td id="LC1219">                                pvBufferWriteArray uOutput, baCert</td>
        </tr>
        <tr>
          <td id="L1220" data-line-number="1220"></td>
          <td id="LC1220">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1221" data-line-number="1221"></td>
          <td id="LC1221">                        Next</td>
        </tr>
        <tr>
          <td id="L1222" data-line-number="1222"></td>
          <td id="LC1222">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1223" data-line-number="1223"></td>
          <td id="LC1223">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1224" data-line-number="1224"></td>
          <td id="LC1224">                pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1225" data-line-number="1225"></td>
          <td id="LC1225">            End If</td>
        </tr>
        <tr>
          <td id="L1226" data-line-number="1226"></td>
          <td id="LC1226">            &#39;--- Handshake Client Key Exchange</td>
        </tr>
        <tr>
          <td id="L1227" data-line-number="1227"></td>
          <td id="LC1227">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1228" data-line-number="1228"></td>
          <td id="LC1228">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_CLIENT_KEY_EXCHANGE</td>
        </tr>
        <tr>
          <td id="L1229" data-line-number="1229"></td>
          <td id="LC1229">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1230" data-line-number="1230"></td>
          <td id="LC1230">                If pvArraySize(.LocalExchRsaEncrPriv) &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1231" data-line-number="1231"></td>
          <td id="LC1231">                    pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1232" data-line-number="1232"></td>
          <td id="LC1232">                        pvBufferWriteArray uOutput, .LocalExchRsaEncrPriv</td>
        </tr>
        <tr>
          <td id="L1233" data-line-number="1233"></td>
          <td id="LC1233">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1234" data-line-number="1234"></td>
          <td id="LC1234">                Else</td>
        </tr>
        <tr>
          <td id="L1235" data-line-number="1235"></td>
          <td id="LC1235">                    pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1236" data-line-number="1236"></td>
          <td id="LC1236">                        pvBufferWriteArray uOutput, .LocalExchPublic</td>
        </tr>
        <tr>
          <td id="L1237" data-line-number="1237"></td>
          <td id="LC1237">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1238" data-line-number="1238"></td>
          <td id="LC1238">                End If</td>
        </tr>
        <tr>
          <td id="L1239" data-line-number="1239"></td>
          <td id="LC1239">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1240" data-line-number="1240"></td>
          <td id="LC1240">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1241" data-line-number="1241"></td>
          <td id="LC1241">            &#39;--- note: get handshake hash early (before certificate verify)</td>
        </tr>
        <tr>
          <td id="L1242" data-line-number="1242"></td>
          <td id="LC1242">            pvTlsDeriveLegacySecrets uCtx</td>
        </tr>
        <tr>
          <td id="L1243" data-line-number="1243"></td>
          <td id="LC1243">            If .CertRequestSignatureScheme &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1244" data-line-number="1244"></td>
          <td id="LC1244">                &#39;--- Client Certificate Verify</td>
        </tr>
        <tr>
          <td id="L1245" data-line-number="1245"></td>
          <td id="LC1245">                lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1246" data-line-number="1246"></td>
          <td id="LC1246">                pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE_VERIFY</td>
        </tr>
        <tr>
          <td id="L1247" data-line-number="1247"></td>
          <td id="LC1247">                pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1248" data-line-number="1248"></td>
          <td id="LC1248">                    pvBufferWriteLong uOutput, .CertRequestSignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L1249" data-line-number="1249"></td>
          <td id="LC1249">                    pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1250" data-line-number="1250"></td>
          <td id="LC1250">                        pvArrayWriteEOF .HandshakeMessages.Data, .HandshakeMessages.Size</td>
        </tr>
        <tr>
          <td id="L1251" data-line-number="1251"></td>
          <td id="LC1251">                        pvTlsSignatureSign baSignature, .LocalCertificates, .LocalPrivateKey, .CertRequestSignatureScheme, .HandshakeMessages.Data</td>
        </tr>
        <tr>
          <td id="L1252" data-line-number="1252"></td>
          <td id="LC1252">                        pvBufferWriteArray uOutput, baSignature</td>
        </tr>
        <tr>
          <td id="L1253" data-line-number="1253"></td>
          <td id="LC1253">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1254" data-line-number="1254"></td>
          <td id="LC1254">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1255" data-line-number="1255"></td>
          <td id="LC1255">                pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1256" data-line-number="1256"></td>
          <td id="LC1256">            End If</td>
        </tr>
        <tr>
          <td id="L1257" data-line-number="1257"></td>
          <td id="LC1257">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1258" data-line-number="1258"></td>
          <td id="LC1258">        &#39;--- Legacy Change Cipher Spec</td>
        </tr>
        <tr>
          <td id="L1259" data-line-number="1259"></td>
          <td id="LC1259">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC, uCtx</td>
        </tr>
        <tr>
          <td id="L1260" data-line-number="1260"></td>
          <td id="LC1260">            pvBufferWriteLong uOutput, 1</td>
        </tr>
        <tr>
          <td id="L1261" data-line-number="1261"></td>
          <td id="LC1261">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1262" data-line-number="1262"></td>
          <td id="LC1262">        &#39;--- commit next epoch local secrets</td>
        </tr>
        <tr>
          <td id="L1263" data-line-number="1263"></td>
          <td id="LC1263">        .LocalMacKey = .LocalLegacyNextMacKey</td>
        </tr>
        <tr>
          <td id="L1264" data-line-number="1264"></td>
          <td id="LC1264">        .LocalTrafficKey = .LocalLegacyNextTrafficKey</td>
        </tr>
        <tr>
          <td id="L1265" data-line-number="1265"></td>
          <td id="LC1265">        .LocalTrafficIV = .LocalLegacyNextTrafficIV</td>
        </tr>
        <tr>
          <td id="L1266" data-line-number="1266"></td>
          <td id="LC1266">        .LocalTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L1267" data-line-number="1267"></td>
          <td id="LC1267">        .LocalEncryptThenMac = (.MacSize &gt; 0) And SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_ENCRYPT_THEN_MAC)</td>
        </tr>
        <tr>
          <td id="L1268" data-line-number="1268"></td>
          <td id="LC1268">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1269" data-line-number="1269"></td>
          <td id="LC1269">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1270" data-line-number="1270"></td>
          <td id="LC1270">            &#39;--- Client Handshake Finished</td>
        </tr>
        <tr>
          <td id="L1271" data-line-number="1271"></td>
          <td id="LC1271">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1272" data-line-number="1272"></td>
          <td id="LC1272">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_FINISHED</td>
        </tr>
        <tr>
          <td id="L1273" data-line-number="1273"></td>
          <td id="LC1273">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1274" data-line-number="1274"></td>
          <td id="LC1274">                pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1275" data-line-number="1275"></td>
          <td id="LC1275">                pvTlsKdfLegacyPrf baVerifyData, .DigestAlgo, .MasterSecret, &#34;client finished&#34;, baHandshakeHash, TLS_VERIFY_DATA_SIZE</td>
        </tr>
        <tr>
          <td id="L1276" data-line-number="1276"></td>
          <td id="LC1276">                pvBufferWriteArray uOutput, baVerifyData</td>
        </tr>
        <tr>
          <td id="L1277" data-line-number="1277"></td>
          <td id="LC1277">                &#39;--- save for secure renegotiation check</td>
        </tr>
        <tr>
          <td id="L1278" data-line-number="1278"></td>
          <td id="LC1278">                If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_RENEGOTIATION_INFO) Then</td>
        </tr>
        <tr>
          <td id="L1279" data-line-number="1279"></td>
          <td id="LC1279">                    .LocalLegacyVerifyData = baVerifyData</td>
        </tr>
        <tr>
          <td id="L1280" data-line-number="1280"></td>
          <td id="LC1280">                End If</td>
        </tr>
        <tr>
          <td id="L1281" data-line-number="1281"></td>
          <td id="LC1281">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1282" data-line-number="1282"></td>
          <td id="LC1282">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1283" data-line-number="1283"></td>
          <td id="LC1283">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1284" data-line-number="1284"></td>
          <td id="LC1284">    End With</td>
        </tr>
        <tr>
          <td id="L1285" data-line-number="1285"></td>
          <td id="LC1285">QH:</td>
        </tr>
        <tr>
          <td id="L1286" data-line-number="1286"></td>
          <td id="LC1286">End Sub</td>
        </tr>
        <tr>
          <td id="L1287" data-line-number="1287"></td>
          <td id="LC1287">
</td>
        </tr>
        <tr>
          <td id="L1288" data-line-number="1288"></td>
          <td id="LC1288">Private Sub pvTlsBuildClientHandshakeFinished(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L1289" data-line-number="1289"></td>
          <td id="LC1289">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L1290" data-line-number="1290"></td>
          <td id="LC1290">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L1291" data-line-number="1291"></td>
          <td id="LC1291">    Dim baCert()        As Byte</td>
        </tr>
        <tr>
          <td id="L1292" data-line-number="1292"></td>
          <td id="LC1292">    Dim baSignature()   As Byte</td>
        </tr>
        <tr>
          <td id="L1293" data-line-number="1293"></td>
          <td id="LC1293">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L1294" data-line-number="1294"></td>
          <td id="LC1294">    Dim uVerify         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L1295" data-line-number="1295"></td>
          <td id="LC1295">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L1296" data-line-number="1296"></td>
          <td id="LC1296">    Dim baEmpty()       As Byte</td>
        </tr>
        <tr>
          <td id="L1297" data-line-number="1297"></td>
          <td id="LC1297">    </td>
        </tr>
        <tr>
          <td id="L1298" data-line-number="1298"></td>
          <td id="LC1298">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1299" data-line-number="1299"></td>
          <td id="LC1299">        If .CertRequestSignatureScheme &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1300" data-line-number="1300"></td>
          <td id="LC1300">            &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1301" data-line-number="1301"></td>
          <td id="LC1301">            pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_APPDATA, uCtx</td>
        </tr>
        <tr>
          <td id="L1302" data-line-number="1302"></td>
          <td id="LC1302">                &#39;--- Client Certificate</td>
        </tr>
        <tr>
          <td id="L1303" data-line-number="1303"></td>
          <td id="LC1303">                lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1304" data-line-number="1304"></td>
          <td id="LC1304">                pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L1305" data-line-number="1305"></td>
          <td id="LC1305">                pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1306" data-line-number="1306"></td>
          <td id="LC1306">                    &#39;--- certificate request context</td>
        </tr>
        <tr>
          <td id="L1307" data-line-number="1307"></td>
          <td id="LC1307">                    pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1308" data-line-number="1308"></td>
          <td id="LC1308">                        pvBufferWriteArray uOutput, .CertRequestContext</td>
        </tr>
        <tr>
          <td id="L1309" data-line-number="1309"></td>
          <td id="LC1309">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1310" data-line-number="1310"></td>
          <td id="LC1310">                    pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1311" data-line-number="1311"></td>
          <td id="LC1311">                        For lIdx = 1 To pvCollectionCount(.LocalCertificates)</td>
        </tr>
        <tr>
          <td id="L1312" data-line-number="1312"></td>
          <td id="LC1312">                            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1313" data-line-number="1313"></td>
          <td id="LC1313">                                baCert = .LocalCertificates.Item(lIdx)</td>
        </tr>
        <tr>
          <td id="L1314" data-line-number="1314"></td>
          <td id="LC1314">                                pvBufferWriteArray uOutput, baCert</td>
        </tr>
        <tr>
          <td id="L1315" data-line-number="1315"></td>
          <td id="LC1315">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1316" data-line-number="1316"></td>
          <td id="LC1316">                            &#39;--- certificate extensions</td>
        </tr>
        <tr>
          <td id="L1317" data-line-number="1317"></td>
          <td id="LC1317">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1318" data-line-number="1318"></td>
          <td id="LC1318">                                &#39;--- empty</td>
        </tr>
        <tr>
          <td id="L1319" data-line-number="1319"></td>
          <td id="LC1319">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1320" data-line-number="1320"></td>
          <td id="LC1320">                        Next</td>
        </tr>
        <tr>
          <td id="L1321" data-line-number="1321"></td>
          <td id="LC1321">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1322" data-line-number="1322"></td>
          <td id="LC1322">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1323" data-line-number="1323"></td>
          <td id="LC1323">                pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1324" data-line-number="1324"></td>
          <td id="LC1324">                If .CertRequestSignatureScheme &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1325" data-line-number="1325"></td>
          <td id="LC1325">                    &#39;--- Client Certificate Verify</td>
        </tr>
        <tr>
          <td id="L1326" data-line-number="1326"></td>
          <td id="LC1326">                    lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1327" data-line-number="1327"></td>
          <td id="LC1327">                    pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE_VERIFY</td>
        </tr>
        <tr>
          <td id="L1328" data-line-number="1328"></td>
          <td id="LC1328">                    pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1329" data-line-number="1329"></td>
          <td id="LC1329">                        pvBufferWriteLong uOutput, .CertRequestSignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L1330" data-line-number="1330"></td>
          <td id="LC1330">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1331" data-line-number="1331"></td>
          <td id="LC1331">                            pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1332" data-line-number="1332"></td>
          <td id="LC1332">                            pvBufferWriteString uVerify, Space$(64) &amp; &#34;TLS 1.3, client CertificateVerify&#34; &amp; Chr$(0)</td>
        </tr>
        <tr>
          <td id="L1333" data-line-number="1333"></td>
          <td id="LC1333">                            pvBufferWriteArray uVerify, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1334" data-line-number="1334"></td>
          <td id="LC1334">                            pvBufferWriteEOF uVerify</td>
        </tr>
        <tr>
          <td id="L1335" data-line-number="1335"></td>
          <td id="LC1335">                            pvTlsSignatureSign baSignature, .LocalCertificates, .LocalPrivateKey, .CertRequestSignatureScheme, uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1336" data-line-number="1336"></td>
          <td id="LC1336">                            pvBufferWriteArray uOutput, baSignature</td>
        </tr>
        <tr>
          <td id="L1337" data-line-number="1337"></td>
          <td id="LC1337">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1338" data-line-number="1338"></td>
          <td id="LC1338">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1339" data-line-number="1339"></td>
          <td id="LC1339">                    pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1340" data-line-number="1340"></td>
          <td id="LC1340">                End If</td>
        </tr>
        <tr>
          <td id="L1341" data-line-number="1341"></td>
          <td id="LC1341">                &#39;--- Record Type</td>
        </tr>
        <tr>
          <td id="L1342" data-line-number="1342"></td>
          <td id="LC1342">                pvBufferWriteLong uOutput, TLS_CONTENT_TYPE_HANDSHAKE</td>
        </tr>
        <tr>
          <td id="L1343" data-line-number="1343"></td>
          <td id="LC1343">            pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1344" data-line-number="1344"></td>
          <td id="LC1344">        End If</td>
        </tr>
        <tr>
          <td id="L1345" data-line-number="1345"></td>
          <td id="LC1345">        &#39;--- Legacy Change Cipher Spec</td>
        </tr>
        <tr>
          <td id="L1346" data-line-number="1346"></td>
          <td id="LC1346">        pvArrayByte baTemp, TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC, TLS_RECORD_VERSION \ &amp;H100, TLS_RECORD_VERSION, 0, 1, 1</td>
        </tr>
        <tr>
          <td id="L1347" data-line-number="1347"></td>
          <td id="LC1347">        pvBufferWriteArray uOutput, baTemp</td>
        </tr>
        <tr>
          <td id="L1348" data-line-number="1348"></td>
          <td id="LC1348">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1349" data-line-number="1349"></td>
          <td id="LC1349">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_APPDATA, uCtx</td>
        </tr>
        <tr>
          <td id="L1350" data-line-number="1350"></td>
          <td id="LC1350">            &#39;--- Client Handshake Finished</td>
        </tr>
        <tr>
          <td id="L1351" data-line-number="1351"></td>
          <td id="LC1351">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_FINISHED</td>
        </tr>
        <tr>
          <td id="L1352" data-line-number="1352"></td>
          <td id="LC1352">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1353" data-line-number="1353"></td>
          <td id="LC1353">                pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1354" data-line-number="1354"></td>
          <td id="LC1354">                pvTlsHkdfExpandLabel baTemp, .DigestAlgo, .LocalTrafficSecret, &#34;finished&#34;, baEmpty, .DigestSize</td>
        </tr>
        <tr>
          <td id="L1355" data-line-number="1355"></td>
          <td id="LC1355">                pvTlsHkdfExtract uVerify.Data, .DigestAlgo, baTemp, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1356" data-line-number="1356"></td>
          <td id="LC1356">                pvBufferWriteArray uOutput, uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1357" data-line-number="1357"></td>
          <td id="LC1357">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1358" data-line-number="1358"></td>
          <td id="LC1358">            &#39;--- Record Type</td>
        </tr>
        <tr>
          <td id="L1359" data-line-number="1359"></td>
          <td id="LC1359">            pvBufferWriteLong uOutput, TLS_CONTENT_TYPE_HANDSHAKE</td>
        </tr>
        <tr>
          <td id="L1360" data-line-number="1360"></td>
          <td id="LC1360">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1361" data-line-number="1361"></td>
          <td id="LC1361">    End With</td>
        </tr>
        <tr>
          <td id="L1362" data-line-number="1362"></td>
          <td id="LC1362">QH:</td>
        </tr>
        <tr>
          <td id="L1363" data-line-number="1363"></td>
          <td id="LC1363">End Sub</td>
        </tr>
        <tr>
          <td id="L1364" data-line-number="1364"></td>
          <td id="LC1364">
</td>
        </tr>
        <tr>
          <td id="L1365" data-line-number="1365"></td>
          <td id="LC1365">Private Sub pvTlsBuildServerHello(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L1366" data-line-number="1366"></td>
          <td id="LC1366">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L1367" data-line-number="1367"></td>
          <td id="LC1367">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L1368" data-line-number="1368"></td>
          <td id="LC1368">    </td>
        </tr>
        <tr>
          <td id="L1369" data-line-number="1369"></td>
          <td id="LC1369">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1370" data-line-number="1370"></td>
          <td id="LC1370">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1371" data-line-number="1371"></td>
          <td id="LC1371">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1372" data-line-number="1372"></td>
          <td id="LC1372">            &#39;--- Handshake Header</td>
        </tr>
        <tr>
          <td id="L1373" data-line-number="1373"></td>
          <td id="LC1373">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1374" data-line-number="1374"></td>
          <td id="LC1374">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_SERVER_HELLO</td>
        </tr>
        <tr>
          <td id="L1375" data-line-number="1375"></td>
          <td id="LC1375">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1376" data-line-number="1376"></td>
          <td id="LC1376">                pvBufferWriteLong uOutput, TLS_LOCAL_LEGACY_VERSION, Size:=2</td>
        </tr>
        <tr>
          <td id="L1377" data-line-number="1377"></td>
          <td id="LC1377">                pvTlsGetRandom .LocalExchRandom, TLS_HELLO_RANDOM_SIZE</td>
        </tr>
        <tr>
          <td id="L1378" data-line-number="1378"></td>
          <td id="LC1378">                If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L1379" data-line-number="1379"></td>
          <td id="LC1379">                    If pvArraySize(m_baHelloRetryRandom) = 0 Then</td>
        </tr>
        <tr>
          <td id="L1380" data-line-number="1380"></td>
          <td id="LC1380">                        pvTlsGetHelloRetryRandom m_baHelloRetryRandom</td>
        </tr>
        <tr>
          <td id="L1381" data-line-number="1381"></td>
          <td id="LC1381">                    End If</td>
        </tr>
        <tr>
          <td id="L1382" data-line-number="1382"></td>
          <td id="LC1382">                    pvBufferWriteArray uOutput, m_baHelloRetryRandom</td>
        </tr>
        <tr>
          <td id="L1383" data-line-number="1383"></td>
          <td id="LC1383">                Else</td>
        </tr>
        <tr>
          <td id="L1384" data-line-number="1384"></td>
          <td id="LC1384">                    pvBufferWriteArray uOutput, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L1385" data-line-number="1385"></td>
          <td id="LC1385">                End If</td>
        </tr>
        <tr>
          <td id="L1386" data-line-number="1386"></td>
          <td id="LC1386">                &#39;--- Legacy Session ID</td>
        </tr>
        <tr>
          <td id="L1387" data-line-number="1387"></td>
          <td id="LC1387">                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1388" data-line-number="1388"></td>
          <td id="LC1388">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1389" data-line-number="1389"></td>
          <td id="LC1389">                        pvBufferWriteArray uOutput, .RemoteSessionID</td>
        </tr>
        <tr>
          <td id="L1390" data-line-number="1390"></td>
          <td id="LC1390">                    Else</td>
        </tr>
        <tr>
          <td id="L1391" data-line-number="1391"></td>
          <td id="LC1391">                        pvBufferWriteArray uOutput, .LocalSessionID</td>
        </tr>
        <tr>
          <td id="L1392" data-line-number="1392"></td>
          <td id="LC1392">                    End If</td>
        </tr>
        <tr>
          <td id="L1393" data-line-number="1393"></td>
          <td id="LC1393">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1394" data-line-number="1394"></td>
          <td id="LC1394">                &#39;--- Cipher Suite</td>
        </tr>
        <tr>
          <td id="L1395" data-line-number="1395"></td>
          <td id="LC1395">                pvBufferWriteLong uOutput, IIf(.HelloRetryRequest, .HelloRetryCipherSuite, .CipherSuite), Size:=2</td>
        </tr>
        <tr>
          <td id="L1396" data-line-number="1396"></td>
          <td id="LC1396">                &#39;--- Legacy Compression Method</td>
        </tr>
        <tr>
          <td id="L1397" data-line-number="1397"></td>
          <td id="LC1397">                pvBufferWriteLong uOutput, TLS_COMPRESS_NULL</td>
        </tr>
        <tr>
          <td id="L1398" data-line-number="1398"></td>
          <td id="LC1398">                &#39;--- Extensions</td>
        </tr>
        <tr>
          <td id="L1399" data-line-number="1399"></td>
          <td id="LC1399">                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1400" data-line-number="1400"></td>
          <td id="LC1400">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1401" data-line-number="1401"></td>
          <td id="LC1401">                        &#39;--- Extension - Key Share</td>
        </tr>
        <tr>
          <td id="L1402" data-line-number="1402"></td>
          <td id="LC1402">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_KEY_SHARE) Or .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L1403" data-line-number="1403"></td>
          <td id="LC1403">                            pvBufferWriteLong uOutput, TLS_EXTENSION_KEY_SHARE, Size:=2</td>
        </tr>
        <tr>
          <td id="L1404" data-line-number="1404"></td>
          <td id="LC1404">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1405" data-line-number="1405"></td>
          <td id="LC1405">                                If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L1406" data-line-number="1406"></td>
          <td id="LC1406">                                    pvBufferWriteLong uOutput, .HelloRetryExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L1407" data-line-number="1407"></td>
          <td id="LC1407">                                Else</td>
        </tr>
        <tr>
          <td id="L1408" data-line-number="1408"></td>
          <td id="LC1408">                                    pvBufferWriteLong uOutput, .ExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L1409" data-line-number="1409"></td>
          <td id="LC1409">                                    pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1410" data-line-number="1410"></td>
          <td id="LC1410">                                        pvBufferWriteArray uOutput, .LocalExchPublic</td>
        </tr>
        <tr>
          <td id="L1411" data-line-number="1411"></td>
          <td id="LC1411">                                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1412" data-line-number="1412"></td>
          <td id="LC1412">                                End If</td>
        </tr>
        <tr>
          <td id="L1413" data-line-number="1413"></td>
          <td id="LC1413">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1414" data-line-number="1414"></td>
          <td id="LC1414">                        End If</td>
        </tr>
        <tr>
          <td id="L1415" data-line-number="1415"></td>
          <td id="LC1415">                        &#39;--- Extension - Supported Versions</td>
        </tr>
        <tr>
          <td id="L1416" data-line-number="1416"></td>
          <td id="LC1416">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_SUPPORTED_VERSIONS) Or .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L1417" data-line-number="1417"></td>
          <td id="LC1417">                            pvBufferWriteLong uOutput, TLS_EXTENSION_SUPPORTED_VERSIONS, Size:=2</td>
        </tr>
        <tr>
          <td id="L1418" data-line-number="1418"></td>
          <td id="LC1418">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1419" data-line-number="1419"></td>
          <td id="LC1419">                                pvBufferWriteLong uOutput, TLS_PROTOCOL_VERSION_TLS13, Size:=2</td>
        </tr>
        <tr>
          <td id="L1420" data-line-number="1420"></td>
          <td id="LC1420">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1421" data-line-number="1421"></td>
          <td id="LC1421">                        End If</td>
        </tr>
        <tr>
          <td id="L1422" data-line-number="1422"></td>
          <td id="LC1422">                        If .HelloRetryRequest And pvArraySize(.HelloRetryCookie) &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1423" data-line-number="1423"></td>
          <td id="LC1423">                            &#39;--- Extension - HRR Cookie</td>
        </tr>
        <tr>
          <td id="L1424" data-line-number="1424"></td>
          <td id="LC1424">                            pvBufferWriteLong uOutput, TLS_EXTENSION_COOKIE, Size:=2</td>
        </tr>
        <tr>
          <td id="L1425" data-line-number="1425"></td>
          <td id="LC1425">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1426" data-line-number="1426"></td>
          <td id="LC1426">                                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1427" data-line-number="1427"></td>
          <td id="LC1427">                                    pvBufferWriteArray uOutput, .HelloRetryCookie</td>
        </tr>
        <tr>
          <td id="L1428" data-line-number="1428"></td>
          <td id="LC1428">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1429" data-line-number="1429"></td>
          <td id="LC1429">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1430" data-line-number="1430"></td>
          <td id="LC1430">                        End If</td>
        </tr>
        <tr>
          <td id="L1431" data-line-number="1431"></td>
          <td id="LC1431">                    End If</td>
        </tr>
        <tr>
          <td id="L1432" data-line-number="1432"></td>
          <td id="LC1432">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L1433" data-line-number="1433"></td>
          <td id="LC1433">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_EXTENDED_MASTER_SECRET) Then</td>
        </tr>
        <tr>
          <td id="L1434" data-line-number="1434"></td>
          <td id="LC1434">                            pvArrayByte baTemp, 0, TLS_EXTENSION_EXTENDED_MASTER_SECRET, 0, 0</td>
        </tr>
        <tr>
          <td id="L1435" data-line-number="1435"></td>
          <td id="LC1435">                            pvBufferWriteArray uOutput, baTemp      &#39;--- supported</td>
        </tr>
        <tr>
          <td id="L1436" data-line-number="1436"></td>
          <td id="LC1436">                        End If</td>
        </tr>
        <tr>
          <td id="L1437" data-line-number="1437"></td>
          <td id="LC1437">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_ENCRYPT_THEN_MAC) Then</td>
        </tr>
        <tr>
          <td id="L1438" data-line-number="1438"></td>
          <td id="LC1438">                            pvArrayByte baTemp, 0, TLS_EXTENSION_ENCRYPT_THEN_MAC, 0, 0</td>
        </tr>
        <tr>
          <td id="L1439" data-line-number="1439"></td>
          <td id="LC1439">                            pvBufferWriteArray uOutput, baTemp      &#39;--- supported</td>
        </tr>
        <tr>
          <td id="L1440" data-line-number="1440"></td>
          <td id="LC1440">                        End If</td>
        </tr>
        <tr>
          <td id="L1441" data-line-number="1441"></td>
          <td id="LC1441">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_EC_POINT_FORMAT) Then</td>
        </tr>
        <tr>
          <td id="L1442" data-line-number="1442"></td>
          <td id="LC1442">                            pvArrayByte baTemp, 0, TLS_EXTENSION_EC_POINT_FORMAT, 0, 2, 1, 0</td>
        </tr>
        <tr>
          <td id="L1443" data-line-number="1443"></td>
          <td id="LC1443">                            pvBufferWriteArray uOutput, baTemp      &#39;--- uncompressed only</td>
        </tr>
        <tr>
          <td id="L1444" data-line-number="1444"></td>
          <td id="LC1444">                        End If</td>
        </tr>
        <tr>
          <td id="L1445" data-line-number="1445"></td>
          <td id="LC1445">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_RENEGOTIATION_INFO) Then</td>
        </tr>
        <tr>
          <td id="L1446" data-line-number="1446"></td>
          <td id="LC1446">                            pvBufferWriteLong uOutput, TLS_EXTENSION_RENEGOTIATION_INFO, Size:=2</td>
        </tr>
        <tr>
          <td id="L1447" data-line-number="1447"></td>
          <td id="LC1447">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1448" data-line-number="1448"></td>
          <td id="LC1448">                                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1449" data-line-number="1449"></td>
          <td id="LC1449">                                    pvBufferWriteArray uOutput, .RemoteLegacyVerifyData</td>
        </tr>
        <tr>
          <td id="L1450" data-line-number="1450"></td>
          <td id="LC1450">                                    pvBufferWriteArray uOutput, .LocalLegacyVerifyData</td>
        </tr>
        <tr>
          <td id="L1451" data-line-number="1451"></td>
          <td id="LC1451">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1452" data-line-number="1452"></td>
          <td id="LC1452">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1453" data-line-number="1453"></td>
          <td id="LC1453">                        End If</td>
        </tr>
        <tr>
          <td id="L1454" data-line-number="1454"></td>
          <td id="LC1454">                        If LenB(.AlpnNegotiated) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1455" data-line-number="1455"></td>
          <td id="LC1455">                            pvBufferWriteLong uOutput, TLS_EXTENSION_ALPN, Size:=2</td>
        </tr>
        <tr>
          <td id="L1456" data-line-number="1456"></td>
          <td id="LC1456">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1457" data-line-number="1457"></td>
          <td id="LC1457">                                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1458" data-line-number="1458"></td>
          <td id="LC1458">                                    pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1459" data-line-number="1459"></td>
          <td id="LC1459">                                        pvBufferWriteString uOutput, .AlpnNegotiated</td>
        </tr>
        <tr>
          <td id="L1460" data-line-number="1460"></td>
          <td id="LC1460">                                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1461" data-line-number="1461"></td>
          <td id="LC1461">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1462" data-line-number="1462"></td>
          <td id="LC1462">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1463" data-line-number="1463"></td>
          <td id="LC1463">                        End If</td>
        </tr>
        <tr>
          <td id="L1464" data-line-number="1464"></td>
          <td id="LC1464">                    End If</td>
        </tr>
        <tr>
          <td id="L1465" data-line-number="1465"></td>
          <td id="LC1465">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1466" data-line-number="1466"></td>
          <td id="LC1466">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1467" data-line-number="1467"></td>
          <td id="LC1467">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1468" data-line-number="1468"></td>
          <td id="LC1468">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1469" data-line-number="1469"></td>
          <td id="LC1469">        If (.HelloRetryRequest Or .HelloRetryCipherSuite = 0) And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1470" data-line-number="1470"></td>
          <td id="LC1470">            &#39;--- Legacy Change Cipher Spec</td>
        </tr>
        <tr>
          <td id="L1471" data-line-number="1471"></td>
          <td id="LC1471">            pvArrayByte baTemp, TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC, TLS_RECORD_VERSION \ &amp;H100, TLS_RECORD_VERSION, 0, 1, 1</td>
        </tr>
        <tr>
          <td id="L1472" data-line-number="1472"></td>
          <td id="LC1472">            pvBufferWriteArray uOutput, baTemp</td>
        </tr>
        <tr>
          <td id="L1473" data-line-number="1473"></td>
          <td id="LC1473">        End If</td>
        </tr>
        <tr>
          <td id="L1474" data-line-number="1474"></td>
          <td id="LC1474">    End With</td>
        </tr>
        <tr>
          <td id="L1475" data-line-number="1475"></td>
          <td id="LC1475">End Sub</td>
        </tr>
        <tr>
          <td id="L1476" data-line-number="1476"></td>
          <td id="LC1476">
</td>
        </tr>
        <tr>
          <td id="L1477" data-line-number="1477"></td>
          <td id="LC1477">Private Sub pvTlsBuildServerLegacyKeyExchange(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L1478" data-line-number="1478"></td>
          <td id="LC1478">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L1479" data-line-number="1479"></td>
          <td id="LC1479">    Dim baSignature()   As Byte</td>
        </tr>
        <tr>
          <td id="L1480" data-line-number="1480"></td>
          <td id="LC1480">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L1481" data-line-number="1481"></td>
          <td id="LC1481">    Dim baCert()        As Byte</td>
        </tr>
        <tr>
          <td id="L1482" data-line-number="1482"></td>
          <td id="LC1482">    Dim uVerify         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L1483" data-line-number="1483"></td>
          <td id="LC1483">    Dim lSignPos        As Long</td>
        </tr>
        <tr>
          <td id="L1484" data-line-number="1484"></td>
          <td id="LC1484">    Dim lSignSize       As Long</td>
        </tr>
        <tr>
          <td id="L1485" data-line-number="1485"></td>
          <td id="LC1485">    </td>
        </tr>
        <tr>
          <td id="L1486" data-line-number="1486"></td>
          <td id="LC1486">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1487" data-line-number="1487"></td>
          <td id="LC1487">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1488" data-line-number="1488"></td>
          <td id="LC1488">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1489" data-line-number="1489"></td>
          <td id="LC1489">            &#39;--- Server Certificate</td>
        </tr>
        <tr>
          <td id="L1490" data-line-number="1490"></td>
          <td id="LC1490">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1491" data-line-number="1491"></td>
          <td id="LC1491">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L1492" data-line-number="1492"></td>
          <td id="LC1492">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1493" data-line-number="1493"></td>
          <td id="LC1493">                pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1494" data-line-number="1494"></td>
          <td id="LC1494">                    For lIdx = 1 To pvCollectionCount(.LocalCertificates)</td>
        </tr>
        <tr>
          <td id="L1495" data-line-number="1495"></td>
          <td id="LC1495">                        pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1496" data-line-number="1496"></td>
          <td id="LC1496">                            baCert = .LocalCertificates.Item(lIdx)</td>
        </tr>
        <tr>
          <td id="L1497" data-line-number="1497"></td>
          <td id="LC1497">                            pvBufferWriteArray uOutput, baCert</td>
        </tr>
        <tr>
          <td id="L1498" data-line-number="1498"></td>
          <td id="LC1498">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1499" data-line-number="1499"></td>
          <td id="LC1499">                    Next</td>
        </tr>
        <tr>
          <td id="L1500" data-line-number="1500"></td>
          <td id="LC1500">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1501" data-line-number="1501"></td>
          <td id="LC1501">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1502" data-line-number="1502"></td>
          <td id="LC1502">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1503" data-line-number="1503"></td>
          <td id="LC1503">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1504" data-line-number="1504"></td>
          <td id="LC1504">        If Not .UseRsaKeyTransport Then</td>
        </tr>
        <tr>
          <td id="L1505" data-line-number="1505"></td>
          <td id="LC1505">            &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1506" data-line-number="1506"></td>
          <td id="LC1506">            pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1507" data-line-number="1507"></td>
          <td id="LC1507">                &#39;--- Server Key Exchange</td>
        </tr>
        <tr>
          <td id="L1508" data-line-number="1508"></td>
          <td id="LC1508">                lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1509" data-line-number="1509"></td>
          <td id="LC1509">                pvBufferWriteLong uOutput, TLS_HANDSHAKE_SERVER_KEY_EXCHANGE</td>
        </tr>
        <tr>
          <td id="L1510" data-line-number="1510"></td>
          <td id="LC1510">                pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1511" data-line-number="1511"></td>
          <td id="LC1511">                    &#39;--- Curve Info</td>
        </tr>
        <tr>
          <td id="L1512" data-line-number="1512"></td>
          <td id="LC1512">                    lSignPos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1513" data-line-number="1513"></td>
          <td id="LC1513">                    pvBufferWriteLong uOutput, 3, Size:=1 &#39;--- 3 = named_curve</td>
        </tr>
        <tr>
          <td id="L1514" data-line-number="1514"></td>
          <td id="LC1514">                    pvBufferWriteLong uOutput, .ExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L1515" data-line-number="1515"></td>
          <td id="LC1515">                    &#39;--- Public Key</td>
        </tr>
        <tr>
          <td id="L1516" data-line-number="1516"></td>
          <td id="LC1516">                    pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1517" data-line-number="1517"></td>
          <td id="LC1517">                        pvBufferWriteArray uOutput, .LocalExchPublic</td>
        </tr>
        <tr>
          <td id="L1518" data-line-number="1518"></td>
          <td id="LC1518">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1519" data-line-number="1519"></td>
          <td id="LC1519">                    lSignSize = uOutput.Size - lSignPos</td>
        </tr>
        <tr>
          <td id="L1520" data-line-number="1520"></td>
          <td id="LC1520">                    &#39;--- Signature</td>
        </tr>
        <tr>
          <td id="L1521" data-line-number="1521"></td>
          <td id="LC1521">                    pvBufferWriteArray uVerify, .RemoteExchRandom</td>
        </tr>
        <tr>
          <td id="L1522" data-line-number="1522"></td>
          <td id="LC1522">                    pvBufferWriteArray uVerify, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L1523" data-line-number="1523"></td>
          <td id="LC1523">                    pvBufferWriteBlob uVerify, VarPtr(uOutput.Data(lSignPos)), lSignSize</td>
        </tr>
        <tr>
          <td id="L1524" data-line-number="1524"></td>
          <td id="LC1524">                    pvBufferWriteEOF uVerify</td>
        </tr>
        <tr>
          <td id="L1525" data-line-number="1525"></td>
          <td id="LC1525">                    pvTlsSignatureSign baSignature, .LocalCertificates, .LocalPrivateKey, .SignatureScheme, uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1526" data-line-number="1526"></td>
          <td id="LC1526">                    pvBufferWriteLong uOutput, .SignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L1527" data-line-number="1527"></td>
          <td id="LC1527">                    pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1528" data-line-number="1528"></td>
          <td id="LC1528">                        pvBufferWriteArray uOutput, baSignature</td>
        </tr>
        <tr>
          <td id="L1529" data-line-number="1529"></td>
          <td id="LC1529">                    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1530" data-line-number="1530"></td>
          <td id="LC1530">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1531" data-line-number="1531"></td>
          <td id="LC1531">                pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1532" data-line-number="1532"></td>
          <td id="LC1532">            pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1533" data-line-number="1533"></td>
          <td id="LC1533">        End If</td>
        </tr>
        <tr>
          <td id="L1534" data-line-number="1534"></td>
          <td id="LC1534">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1535" data-line-number="1535"></td>
          <td id="LC1535">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1536" data-line-number="1536"></td>
          <td id="LC1536">            &#39;--- Server Hello Done</td>
        </tr>
        <tr>
          <td id="L1537" data-line-number="1537"></td>
          <td id="LC1537">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1538" data-line-number="1538"></td>
          <td id="LC1538">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_SERVER_HELLO_DONE</td>
        </tr>
        <tr>
          <td id="L1539" data-line-number="1539"></td>
          <td id="LC1539">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1540" data-line-number="1540"></td>
          <td id="LC1540">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1541" data-line-number="1541"></td>
          <td id="LC1541">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1542" data-line-number="1542"></td>
          <td id="LC1542">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1543" data-line-number="1543"></td>
          <td id="LC1543">    End With</td>
        </tr>
        <tr>
          <td id="L1544" data-line-number="1544"></td>
          <td id="LC1544">End Sub</td>
        </tr>
        <tr>
          <td id="L1545" data-line-number="1545"></td>
          <td id="LC1545">
</td>
        </tr>
        <tr>
          <td id="L1546" data-line-number="1546"></td>
          <td id="LC1546">Private Sub pvTlsBuildServerHandshakeFinished(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L1547" data-line-number="1547"></td>
          <td id="LC1547">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L1548" data-line-number="1548"></td>
          <td id="LC1548">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L1549" data-line-number="1549"></td>
          <td id="LC1549">    Dim uVerify         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L1550" data-line-number="1550"></td>
          <td id="LC1550">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L1551" data-line-number="1551"></td>
          <td id="LC1551">    Dim baCert()        As Byte</td>
        </tr>
        <tr>
          <td id="L1552" data-line-number="1552"></td>
          <td id="LC1552">    Dim baSignature()   As Byte</td>
        </tr>
        <tr>
          <td id="L1553" data-line-number="1553"></td>
          <td id="LC1553">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L1554" data-line-number="1554"></td>
          <td id="LC1554">    Dim baEmpty()       As Byte</td>
        </tr>
        <tr>
          <td id="L1555" data-line-number="1555"></td>
          <td id="LC1555">    </td>
        </tr>
        <tr>
          <td id="L1556" data-line-number="1556"></td>
          <td id="LC1556">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1557" data-line-number="1557"></td>
          <td id="LC1557">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1558" data-line-number="1558"></td>
          <td id="LC1558">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_APPDATA, uCtx</td>
        </tr>
        <tr>
          <td id="L1559" data-line-number="1559"></td>
          <td id="LC1559">            &#39;--- Server Encrypted Extensions</td>
        </tr>
        <tr>
          <td id="L1560" data-line-number="1560"></td>
          <td id="LC1560">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1561" data-line-number="1561"></td>
          <td id="LC1561">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_ENCRYPTED_EXTENSIONS</td>
        </tr>
        <tr>
          <td id="L1562" data-line-number="1562"></td>
          <td id="LC1562">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1563" data-line-number="1563"></td>
          <td id="LC1563">                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1564" data-line-number="1564"></td>
          <td id="LC1564">                    If LenB(.AlpnNegotiated) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1565" data-line-number="1565"></td>
          <td id="LC1565">                        pvBufferWriteLong uOutput, TLS_EXTENSION_ALPN, Size:=2</td>
        </tr>
        <tr>
          <td id="L1566" data-line-number="1566"></td>
          <td id="LC1566">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1567" data-line-number="1567"></td>
          <td id="LC1567">                            pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1568" data-line-number="1568"></td>
          <td id="LC1568">                                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1569" data-line-number="1569"></td>
          <td id="LC1569">                                    pvBufferWriteString uOutput, .AlpnNegotiated</td>
        </tr>
        <tr>
          <td id="L1570" data-line-number="1570"></td>
          <td id="LC1570">                                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1571" data-line-number="1571"></td>
          <td id="LC1571">                            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1572" data-line-number="1572"></td>
          <td id="LC1572">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1573" data-line-number="1573"></td>
          <td id="LC1573">                    End If</td>
        </tr>
        <tr>
          <td id="L1574" data-line-number="1574"></td>
          <td id="LC1574">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1575" data-line-number="1575"></td>
          <td id="LC1575">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1576" data-line-number="1576"></td>
          <td id="LC1576">            &#39;--- Server Certificate</td>
        </tr>
        <tr>
          <td id="L1577" data-line-number="1577"></td>
          <td id="LC1577">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L1578" data-line-number="1578"></td>
          <td id="LC1578">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1579" data-line-number="1579"></td>
          <td id="LC1579">                &#39;--- certificate request context</td>
        </tr>
        <tr>
          <td id="L1580" data-line-number="1580"></td>
          <td id="LC1580">                pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L1581" data-line-number="1581"></td>
          <td id="LC1581">                    &#39;--- empty</td>
        </tr>
        <tr>
          <td id="L1582" data-line-number="1582"></td>
          <td id="LC1582">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1583" data-line-number="1583"></td>
          <td id="LC1583">                pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1584" data-line-number="1584"></td>
          <td id="LC1584">                    For lIdx = 1 To pvCollectionCount(.LocalCertificates)</td>
        </tr>
        <tr>
          <td id="L1585" data-line-number="1585"></td>
          <td id="LC1585">                        pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1586" data-line-number="1586"></td>
          <td id="LC1586">                            baCert = .LocalCertificates.Item(lIdx)</td>
        </tr>
        <tr>
          <td id="L1587" data-line-number="1587"></td>
          <td id="LC1587">                            pvBufferWriteArray uOutput, baCert</td>
        </tr>
        <tr>
          <td id="L1588" data-line-number="1588"></td>
          <td id="LC1588">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1589" data-line-number="1589"></td>
          <td id="LC1589">                        &#39;--- certificate extensions</td>
        </tr>
        <tr>
          <td id="L1590" data-line-number="1590"></td>
          <td id="LC1590">                        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1591" data-line-number="1591"></td>
          <td id="LC1591">                            &#39;--- empty</td>
        </tr>
        <tr>
          <td id="L1592" data-line-number="1592"></td>
          <td id="LC1592">                        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1593" data-line-number="1593"></td>
          <td id="LC1593">                    Next</td>
        </tr>
        <tr>
          <td id="L1594" data-line-number="1594"></td>
          <td id="LC1594">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1595" data-line-number="1595"></td>
          <td id="LC1595">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1596" data-line-number="1596"></td>
          <td id="LC1596">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1597" data-line-number="1597"></td>
          <td id="LC1597">            &#39;--- Server Certificate Verify</td>
        </tr>
        <tr>
          <td id="L1598" data-line-number="1598"></td>
          <td id="LC1598">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1599" data-line-number="1599"></td>
          <td id="LC1599">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_CERTIFICATE_VERIFY</td>
        </tr>
        <tr>
          <td id="L1600" data-line-number="1600"></td>
          <td id="LC1600">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1601" data-line-number="1601"></td>
          <td id="LC1601">                pvBufferWriteLong uOutput, .SignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L1602" data-line-number="1602"></td>
          <td id="LC1602">                pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L1603" data-line-number="1603"></td>
          <td id="LC1603">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1604" data-line-number="1604"></td>
          <td id="LC1604">                    pvBufferWriteString uVerify, Space$(64) &amp; &#34;TLS 1.3, server CertificateVerify&#34; &amp; Chr$(0)</td>
        </tr>
        <tr>
          <td id="L1605" data-line-number="1605"></td>
          <td id="LC1605">                    pvBufferWriteArray uVerify, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1606" data-line-number="1606"></td>
          <td id="LC1606">                    pvBufferWriteEOF uVerify</td>
        </tr>
        <tr>
          <td id="L1607" data-line-number="1607"></td>
          <td id="LC1607">                    pvTlsSignatureSign baSignature, .LocalCertificates, .LocalPrivateKey, .SignatureScheme, uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1608" data-line-number="1608"></td>
          <td id="LC1608">                    pvBufferWriteArray uOutput, baSignature</td>
        </tr>
        <tr>
          <td id="L1609" data-line-number="1609"></td>
          <td id="LC1609">                pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1610" data-line-number="1610"></td>
          <td id="LC1610">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1611" data-line-number="1611"></td>
          <td id="LC1611">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1612" data-line-number="1612"></td>
          <td id="LC1612">            &#39;--- Server Handshake Finished</td>
        </tr>
        <tr>
          <td id="L1613" data-line-number="1613"></td>
          <td id="LC1613">            lMessagePos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L1614" data-line-number="1614"></td>
          <td id="LC1614">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_FINISHED</td>
        </tr>
        <tr>
          <td id="L1615" data-line-number="1615"></td>
          <td id="LC1615">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1616" data-line-number="1616"></td>
          <td id="LC1616">                pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1617" data-line-number="1617"></td>
          <td id="LC1617">                pvTlsHkdfExpandLabel baTemp, .DigestAlgo, .LocalTrafficSecret, &#34;finished&#34;, baEmpty, .DigestSize</td>
        </tr>
        <tr>
          <td id="L1618" data-line-number="1618"></td>
          <td id="LC1618">                pvTlsHkdfExtract uVerify.Data, .DigestAlgo, baTemp, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1619" data-line-number="1619"></td>
          <td id="LC1619">                pvBufferWriteArray uOutput, uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1620" data-line-number="1620"></td>
          <td id="LC1620">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1621" data-line-number="1621"></td>
          <td id="LC1621">            pvTlsAppendHandshakeHash uCtx, uOutput.Data, lMessagePos, uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L1622" data-line-number="1622"></td>
          <td id="LC1622">            &#39;--- Record Type</td>
        </tr>
        <tr>
          <td id="L1623" data-line-number="1623"></td>
          <td id="LC1623">            pvBufferWriteLong uOutput, TLS_CONTENT_TYPE_HANDSHAKE</td>
        </tr>
        <tr>
          <td id="L1624" data-line-number="1624"></td>
          <td id="LC1624">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1625" data-line-number="1625"></td>
          <td id="LC1625">    End With</td>
        </tr>
        <tr>
          <td id="L1626" data-line-number="1626"></td>
          <td id="LC1626">End Sub</td>
        </tr>
        <tr>
          <td id="L1627" data-line-number="1627"></td>
          <td id="LC1627">
</td>
        </tr>
        <tr>
          <td id="L1628" data-line-number="1628"></td>
          <td id="LC1628">Private Sub pvTlsBuildServerLegacyFinished(uCtx As UcsTlsContext, uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L1629" data-line-number="1629"></td>
          <td id="LC1629">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L1630" data-line-number="1630"></td>
          <td id="LC1630">    Dim uVerify         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L1631" data-line-number="1631"></td>
          <td id="LC1631">    </td>
        </tr>
        <tr>
          <td id="L1632" data-line-number="1632"></td>
          <td id="LC1632">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1633" data-line-number="1633"></td>
          <td id="LC1633">        &#39;--- Change Cipher Spec</td>
        </tr>
        <tr>
          <td id="L1634" data-line-number="1634"></td>
          <td id="LC1634">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC, uCtx</td>
        </tr>
        <tr>
          <td id="L1635" data-line-number="1635"></td>
          <td id="LC1635">            pvBufferWriteLong uOutput, 1</td>
        </tr>
        <tr>
          <td id="L1636" data-line-number="1636"></td>
          <td id="LC1636">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1637" data-line-number="1637"></td>
          <td id="LC1637">        &#39;--- commit next epoch local secrets</td>
        </tr>
        <tr>
          <td id="L1638" data-line-number="1638"></td>
          <td id="LC1638">        .LocalMacKey = .LocalLegacyNextMacKey</td>
        </tr>
        <tr>
          <td id="L1639" data-line-number="1639"></td>
          <td id="LC1639">        .LocalTrafficKey = .LocalLegacyNextTrafficKey</td>
        </tr>
        <tr>
          <td id="L1640" data-line-number="1640"></td>
          <td id="LC1640">        .LocalTrafficIV = .LocalLegacyNextTrafficIV</td>
        </tr>
        <tr>
          <td id="L1641" data-line-number="1641"></td>
          <td id="LC1641">        .LocalTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L1642" data-line-number="1642"></td>
          <td id="LC1642">        .LocalEncryptThenMac = (.MacSize &gt; 0) And SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_ENCRYPT_THEN_MAC)</td>
        </tr>
        <tr>
          <td id="L1643" data-line-number="1643"></td>
          <td id="LC1643">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1644" data-line-number="1644"></td>
          <td id="LC1644">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_HANDSHAKE, uCtx</td>
        </tr>
        <tr>
          <td id="L1645" data-line-number="1645"></td>
          <td id="LC1645">            &#39;--- Server Handshake Finished</td>
        </tr>
        <tr>
          <td id="L1646" data-line-number="1646"></td>
          <td id="LC1646">            pvBufferWriteLong uOutput, TLS_HANDSHAKE_FINISHED</td>
        </tr>
        <tr>
          <td id="L1647" data-line-number="1647"></td>
          <td id="LC1647">            pvBufferWriteBlockStart uOutput, Size:=3</td>
        </tr>
        <tr>
          <td id="L1648" data-line-number="1648"></td>
          <td id="LC1648">                pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1649" data-line-number="1649"></td>
          <td id="LC1649">                pvTlsKdfLegacyPrf uVerify.Data, .DigestAlgo, .MasterSecret, &#34;server finished&#34;, baHandshakeHash, TLS_VERIFY_DATA_SIZE</td>
        </tr>
        <tr>
          <td id="L1650" data-line-number="1650"></td>
          <td id="LC1650">                If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_RENEGOTIATION_INFO) Then</td>
        </tr>
        <tr>
          <td id="L1651" data-line-number="1651"></td>
          <td id="LC1651">                    .LocalLegacyVerifyData = uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1652" data-line-number="1652"></td>
          <td id="LC1652">                End If</td>
        </tr>
        <tr>
          <td id="L1653" data-line-number="1653"></td>
          <td id="LC1653">                pvBufferWriteArray uOutput, uVerify.Data</td>
        </tr>
        <tr>
          <td id="L1654" data-line-number="1654"></td>
          <td id="LC1654">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L1655" data-line-number="1655"></td>
          <td id="LC1655">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1656" data-line-number="1656"></td>
          <td id="LC1656">    End With</td>
        </tr>
        <tr>
          <td id="L1657" data-line-number="1657"></td>
          <td id="LC1657">End Sub</td>
        </tr>
        <tr>
          <td id="L1658" data-line-number="1658"></td>
          <td id="LC1658">
</td>
        </tr>
        <tr>
          <td id="L1659" data-line-number="1659"></td>
          <td id="LC1659">Private Sub pvTlsBuildApplicationData(uCtx As UcsTlsContext, uOutput As UcsBuffer, baData() As Byte, ByVal lPos As Long, ByVal lSize As Long, ByVal lContentType As Long)</td>
        </tr>
        <tr>
          <td id="L1660" data-line-number="1660"></td>
          <td id="LC1660">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1661" data-line-number="1661"></td>
          <td id="LC1661">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1662" data-line-number="1662"></td>
          <td id="LC1662">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_APPDATA, uCtx</td>
        </tr>
        <tr>
          <td id="L1663" data-line-number="1663"></td>
          <td id="LC1663">            If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1664" data-line-number="1664"></td>
          <td id="LC1664">                pvBufferWriteBlob uOutput, VarPtr(baData(lPos)), lSize</td>
        </tr>
        <tr>
          <td id="L1665" data-line-number="1665"></td>
          <td id="LC1665">            End If</td>
        </tr>
        <tr>
          <td id="L1666" data-line-number="1666"></td>
          <td id="LC1666">            If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1667" data-line-number="1667"></td>
          <td id="LC1667">                &#39;--- Record Type</td>
        </tr>
        <tr>
          <td id="L1668" data-line-number="1668"></td>
          <td id="LC1668">                pvBufferWriteLong uOutput, lContentType</td>
        </tr>
        <tr>
          <td id="L1669" data-line-number="1669"></td>
          <td id="LC1669">            End If</td>
        </tr>
        <tr>
          <td id="L1670" data-line-number="1670"></td>
          <td id="LC1670">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1671" data-line-number="1671"></td>
          <td id="LC1671">    End With</td>
        </tr>
        <tr>
          <td id="L1672" data-line-number="1672"></td>
          <td id="LC1672">End Sub</td>
        </tr>
        <tr>
          <td id="L1673" data-line-number="1673"></td>
          <td id="LC1673">
</td>
        </tr>
        <tr>
          <td id="L1674" data-line-number="1674"></td>
          <td id="LC1674">Private Sub pvTlsBuildAlert(uCtx As UcsTlsContext, uOutput As UcsBuffer, ByVal eAlertDesc As UcsTlsAlertDescriptionsEnum, ByVal lAlertLevel As Long)</td>
        </tr>
        <tr>
          <td id="L1675" data-line-number="1675"></td>
          <td id="LC1675">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L1676" data-line-number="1676"></td>
          <td id="LC1676">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L1677" data-line-number="1677"></td>
          <td id="LC1677">    </td>
        </tr>
        <tr>
          <td id="L1678" data-line-number="1678"></td>
          <td id="LC1678">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1679" data-line-number="1679"></td>
          <td id="LC1679">#If ImplTlsServer Then</td>
        </tr>
        <tr>
          <td id="L1680" data-line-number="1680"></td>
          <td id="LC1680">        If .State = ucsTlsStateExpectClientFinished And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1681" data-line-number="1681"></td>
          <td id="LC1681">            &#39;--- alerts must be protected with application data traffic secrets (not handshake)</td>
        </tr>
        <tr>
          <td id="L1682" data-line-number="1682"></td>
          <td id="LC1682">            .State = ucsTlsStatePostHandshake</td>
        </tr>
        <tr>
          <td id="L1683" data-line-number="1683"></td>
          <td id="LC1683">            pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1684" data-line-number="1684"></td>
          <td id="LC1684">            pvTlsDeriveApplicationSecrets uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L1685" data-line-number="1685"></td>
          <td id="LC1685">        End If</td>
        </tr>
        <tr>
          <td id="L1686" data-line-number="1686"></td>
          <td id="LC1686">#End If</td>
        </tr>
        <tr>
          <td id="L1687" data-line-number="1687"></td>
          <td id="LC1687">        If .State = ucsTlsStatePostHandshake And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1688" data-line-number="1688"></td>
          <td id="LC1688">            &#39;--- for TLS 1.3 -&gt; tunnel alert through application data traffic protection</td>
        </tr>
        <tr>
          <td id="L1689" data-line-number="1689"></td>
          <td id="LC1689">            pvArrayByte baTemp, lAlertLevel, eAlertDesc</td>
        </tr>
        <tr>
          <td id="L1690" data-line-number="1690"></td>
          <td id="LC1690">            pvTlsBuildApplicationData uCtx, uOutput, baTemp, 0, UBound(baTemp) + 1, TLS_CONTENT_TYPE_ALERT</td>
        </tr>
        <tr>
          <td id="L1691" data-line-number="1691"></td>
          <td id="LC1691">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L1692" data-line-number="1692"></td>
          <td id="LC1692">        End If</td>
        </tr>
        <tr>
          <td id="L1693" data-line-number="1693"></td>
          <td id="LC1693">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L1694" data-line-number="1694"></td>
          <td id="LC1694">        pvBufferWriteRecordStart uOutput, TLS_CONTENT_TYPE_ALERT, uCtx</td>
        </tr>
        <tr>
          <td id="L1695" data-line-number="1695"></td>
          <td id="LC1695">            pvBufferWriteLong uOutput, lAlertLevel</td>
        </tr>
        <tr>
          <td id="L1696" data-line-number="1696"></td>
          <td id="LC1696">            pvBufferWriteLong uOutput, eAlertDesc</td>
        </tr>
        <tr>
          <td id="L1697" data-line-number="1697"></td>
          <td id="LC1697">        pvBufferWriteRecordEnd uOutput, uCtx</td>
        </tr>
        <tr>
          <td id="L1698" data-line-number="1698"></td>
          <td id="LC1698">    End With</td>
        </tr>
        <tr>
          <td id="L1699" data-line-number="1699"></td>
          <td id="LC1699">QH:</td>
        </tr>
        <tr>
          <td id="L1700" data-line-number="1700"></td>
          <td id="LC1700">End Sub</td>
        </tr>
        <tr>
          <td id="L1701" data-line-number="1701"></td>
          <td id="LC1701">
</td>
        </tr>
        <tr>
          <td id="L1702" data-line-number="1702"></td>
          <td id="LC1702">Private Function pvTlsParsePayload(uCtx As UcsTlsContext, baInput() As Byte, lSize As Long, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L1703" data-line-number="1703"></td>
          <td id="LC1703">    Dim lNewSize        As Long</td>
        </tr>
        <tr>
          <td id="L1704" data-line-number="1704"></td>
          <td id="LC1704">    </td>
        </tr>
        <tr>
          <td id="L1705" data-line-number="1705"></td>
          <td id="LC1705">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L1706" data-line-number="1706"></td>
          <td id="LC1706">    If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1707" data-line-number="1707"></td>
          <td id="LC1707">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1708" data-line-number="1708"></td>
          <td id="LC1708">        pvBufferWriteBlob .RecvBuffer, VarPtr(baInput(0)), lSize</td>
        </tr>
        <tr>
          <td id="L1709" data-line-number="1709"></td>
          <td id="LC1709">        If Not pvTlsParseRecord(uCtx, .RecvBuffer, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L1710" data-line-number="1710"></td>
          <td id="LC1710">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L1711" data-line-number="1711"></td>
          <td id="LC1711">        End If</td>
        </tr>
        <tr>
          <td id="L1712" data-line-number="1712"></td>
          <td id="LC1712">        lNewSize = .RecvBuffer.Size - .RecvBuffer.Pos</td>
        </tr>
        <tr>
          <td id="L1713" data-line-number="1713"></td>
          <td id="LC1713">        If lNewSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1714" data-line-number="1714"></td>
          <td id="LC1714">            Debug.Assert pvArraySize(.RecvBuffer.Data) &gt;= .RecvBuffer.Pos + lNewSize</td>
        </tr>
        <tr>
          <td id="L1715" data-line-number="1715"></td>
          <td id="LC1715">            Call CopyMemory(.RecvBuffer.Data(0), .RecvBuffer.Data(.RecvBuffer.Pos), lNewSize)</td>
        </tr>
        <tr>
          <td id="L1716" data-line-number="1716"></td>
          <td id="LC1716">        End If</td>
        </tr>
        <tr>
          <td id="L1717" data-line-number="1717"></td>
          <td id="LC1717">        .RecvBuffer.Pos = 0</td>
        </tr>
        <tr>
          <td id="L1718" data-line-number="1718"></td>
          <td id="LC1718">        .RecvBuffer.Size = IIf(lNewSize &gt; 0, lNewSize, 0)</td>
        </tr>
        <tr>
          <td id="L1719" data-line-number="1719"></td>
          <td id="LC1719">    End With</td>
        </tr>
        <tr>
          <td id="L1720" data-line-number="1720"></td>
          <td id="LC1720">    End If</td>
        </tr>
        <tr>
          <td id="L1721" data-line-number="1721"></td>
          <td id="LC1721">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L1722" data-line-number="1722"></td>
          <td id="LC1722">    pvTlsParsePayload = True</td>
        </tr>
        <tr>
          <td id="L1723" data-line-number="1723"></td>
          <td id="LC1723">QH:</td>
        </tr>
        <tr>
          <td id="L1724" data-line-number="1724"></td>
          <td id="LC1724">    Exit Function</td>
        </tr>
        <tr>
          <td id="L1725" data-line-number="1725"></td>
          <td id="LC1725">EH:</td>
        </tr>
        <tr>
          <td id="L1726" data-line-number="1726"></td>
          <td id="LC1726">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L1727" data-line-number="1727"></td>
          <td id="LC1727">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L1728" data-line-number="1728"></td>
          <td id="LC1728">    Resume QH</td>
        </tr>
        <tr>
          <td id="L1729" data-line-number="1729"></td>
          <td id="LC1729">End Function</td>
        </tr>
        <tr>
          <td id="L1730" data-line-number="1730"></td>
          <td id="LC1730">
</td>
        </tr>
        <tr>
          <td id="L1731" data-line-number="1731"></td>
          <td id="LC1731">Private Function pvTlsParseRecord(uCtx As UcsTlsContext, uInput As UcsBuffer, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L1732" data-line-number="1732"></td>
          <td id="LC1732">    Const FUNC_NAME     As String = &#34;pvTlsParseRecord&#34;</td>
        </tr>
        <tr>
          <td id="L1733" data-line-number="1733"></td>
          <td id="LC1733">    Dim lRecordPos      As Long</td>
        </tr>
        <tr>
          <td id="L1734" data-line-number="1734"></td>
          <td id="LC1734">    Dim lRecordSize     As Long</td>
        </tr>
        <tr>
          <td id="L1735" data-line-number="1735"></td>
          <td id="LC1735">    Dim lRecordType     As Long</td>
        </tr>
        <tr>
          <td id="L1736" data-line-number="1736"></td>
          <td id="LC1736">    Dim lRecordProtocol As Long</td>
        </tr>
        <tr>
          <td id="L1737" data-line-number="1737"></td>
          <td id="LC1737">    Dim baRemoteIV()    As Byte</td>
        </tr>
        <tr>
          <td id="L1738" data-line-number="1738"></td>
          <td id="LC1738">    Dim lEnd            As Long</td>
        </tr>
        <tr>
          <td id="L1739" data-line-number="1739"></td>
          <td id="LC1739">    Dim uAad            As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L1740" data-line-number="1740"></td>
          <td id="LC1740">    Dim bResult         As Boolean</td>
        </tr>
        <tr>
          <td id="L1741" data-line-number="1741"></td>
          <td id="LC1741">    Dim baHmac()        As Byte</td>
        </tr>
        <tr>
          <td id="L1742" data-line-number="1742"></td>
          <td id="LC1742">    Dim lPadding        As Long</td>
        </tr>
        <tr>
          <td id="L1743" data-line-number="1743"></td>
          <td id="LC1743">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L1744" data-line-number="1744"></td>
          <td id="LC1744">    </td>
        </tr>
        <tr>
          <td id="L1745" data-line-number="1745"></td>
          <td id="LC1745">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L1746" data-line-number="1746"></td>
          <td id="LC1746">    With uCtx</td>
        </tr>
        <tr>
          <td id="L1747" data-line-number="1747"></td>
          <td id="LC1747">    Do While uInput.Pos + 4 &lt; uInput.Size</td>
        </tr>
        <tr>
          <td id="L1748" data-line-number="1748"></td>
          <td id="LC1748">        lRecordPos = uInput.Pos</td>
        </tr>
        <tr>
          <td id="L1749" data-line-number="1749"></td>
          <td id="LC1749">        pvBufferReadLong uInput, lRecordType</td>
        </tr>
        <tr>
          <td id="L1750" data-line-number="1750"></td>
          <td id="LC1750">        If lRecordType &lt; TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC Or lRecordType &gt; TLS_CONTENT_TYPE_APPDATA Then</td>
        </tr>
        <tr>
          <td id="L1751" data-line-number="1751"></td>
          <td id="LC1751">            GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1752" data-line-number="1752"></td>
          <td id="LC1752">        End If</td>
        </tr>
        <tr>
          <td id="L1753" data-line-number="1753"></td>
          <td id="LC1753">        pvBufferReadLong uInput, lRecordProtocol, Size:=2</td>
        </tr>
        <tr>
          <td id="L1754" data-line-number="1754"></td>
          <td id="LC1754">        pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lRecordSize</td>
        </tr>
        <tr>
          <td id="L1755" data-line-number="1755"></td>
          <td id="LC1755">            If uInput.Pos + lRecordSize &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L1756" data-line-number="1756"></td>
          <td id="LC1756">                &#39;--- back off and bail out early</td>
        </tr>
        <tr>
          <td id="L1757" data-line-number="1757"></td>
          <td id="LC1757">                uInput.Stack.Remove 1</td>
        </tr>
        <tr>
          <td id="L1758" data-line-number="1758"></td>
          <td id="LC1758">                uInput.Pos = lRecordPos</td>
        </tr>
        <tr>
          <td id="L1759" data-line-number="1759"></td>
          <td id="LC1759">                Exit Do</td>
        </tr>
        <tr>
          <td id="L1760" data-line-number="1760"></td>
          <td id="LC1760">            End If</td>
        </tr>
        <tr>
          <td id="L1761" data-line-number="1761"></td>
          <td id="LC1761">            &#39;--- try to decrypt record</td>
        </tr>
        <tr>
          <td id="L1762" data-line-number="1762"></td>
          <td id="LC1762">            If pvArraySize(.RemoteTrafficKey) &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1763" data-line-number="1763"></td>
          <td id="LC1763">                &#39;--- check ciphertext size</td>
        </tr>
        <tr>
          <td id="L1764" data-line-number="1764"></td>
          <td id="LC1764">                If lRecordSize &gt; TLS_MAX_ENCRYPTED_RECORD_SIZE + .MacSize + .IvExplicitSize Then</td>
        </tr>
        <tr>
          <td id="L1765" data-line-number="1765"></td>
          <td id="LC1765">                    GoTo RecordOverflow</td>
        </tr>
        <tr>
          <td id="L1766" data-line-number="1766"></td>
          <td id="LC1766">                End If</td>
        </tr>
        <tr>
          <td id="L1767" data-line-number="1767"></td>
          <td id="LC1767">                If lRecordSize &lt; .TagSize + .MacSize Then</td>
        </tr>
        <tr>
          <td id="L1768" data-line-number="1768"></td>
          <td id="LC1768">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1769" data-line-number="1769"></td>
          <td id="LC1769">                        GoTo Unencrypted</td>
        </tr>
        <tr>
          <td id="L1770" data-line-number="1770"></td>
          <td id="LC1770">                    End If</td>
        </tr>
        <tr>
          <td id="L1771" data-line-number="1771"></td>
          <td id="LC1771">                    GoTo RecordMacFailed</td>
        </tr>
        <tr>
          <td id="L1772" data-line-number="1772"></td>
          <td id="LC1772">                End If</td>
        </tr>
        <tr>
          <td id="L1773" data-line-number="1773"></td>
          <td id="LC1773">                lEnd = uInput.Pos + lRecordSize - .TagSize</td>
        </tr>
        <tr>
          <td id="L1774" data-line-number="1774"></td>
          <td id="LC1774">                bResult = False</td>
        </tr>
        <tr>
          <td id="L1775" data-line-number="1775"></td>
          <td id="LC1775">                pvArrayXor baRemoteIV, .RemoteTrafficIV, .RemoteTrafficSeqNo</td>
        </tr>
        <tr>
          <td id="L1776" data-line-number="1776"></td>
          <td id="LC1776">                If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1777" data-line-number="1777"></td>
          <td id="LC1777">                    If lRecordType &lt;&gt; TLS_CONTENT_TYPE_APPDATA Then</td>
        </tr>
        <tr>
          <td id="L1778" data-line-number="1778"></td>
          <td id="LC1778">                        GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1779" data-line-number="1779"></td>
          <td id="LC1779">                    End If</td>
        </tr>
        <tr>
          <td id="L1780" data-line-number="1780"></td>
          <td id="LC1780">                    bResult = pvTlsBulkDecrypt(.BulkAlgo, baRemoteIV, .RemoteTrafficKey, uInput.Data, lRecordPos, TLS_AAD_SIZE, uInput.Data, uInput.Pos, lRecordSize)</td>
        </tr>
        <tr>
          <td id="L1781" data-line-number="1781"></td>
          <td id="LC1781">                ElseIf .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L1782" data-line-number="1782"></td>
          <td id="LC1782">                    If .IvExplicitSize &gt; 0 Then &#39;--- AES in TLS 1.2</td>
        </tr>
        <tr>
          <td id="L1783" data-line-number="1783"></td>
          <td id="LC1783">                        pvArrayWriteBlob baRemoteIV, .IvSize - .IvExplicitSize, VarPtr(uInput.Data(uInput.Pos)), .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L1784" data-line-number="1784"></td>
          <td id="LC1784">                        uInput.Pos = uInput.Pos + .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L1785" data-line-number="1785"></td>
          <td id="LC1785">                    End If</td>
        </tr>
        <tr>
          <td id="L1786" data-line-number="1786"></td>
          <td id="LC1786">                    uAad.Size = 0</td>
        </tr>
        <tr>
          <td id="L1787" data-line-number="1787"></td>
          <td id="LC1787">                    pvBufferWriteLong uAad, 0, Size:=4</td>
        </tr>
        <tr>
          <td id="L1788" data-line-number="1788"></td>
          <td id="LC1788">                    pvBufferWriteLong uAad, .RemoteTrafficSeqNo, Size:=4</td>
        </tr>
        <tr>
          <td id="L1789" data-line-number="1789"></td>
          <td id="LC1789">                    pvBufferWriteBlob uAad, VarPtr(uInput.Data(lRecordPos)), 3</td>
        </tr>
        <tr>
          <td id="L1790" data-line-number="1790"></td>
          <td id="LC1790">                    If Not .RemoteEncryptThenMac Then</td>
        </tr>
        <tr>
          <td id="L1791" data-line-number="1791"></td>
          <td id="LC1791">                        pvBufferWriteLong uAad, lEnd - uInput.Pos, Size:=2</td>
        </tr>
        <tr>
          <td id="L1792" data-line-number="1792"></td>
          <td id="LC1792">                        Debug.Assert uAad.Size = TLS_LEGACY_AAD_SIZE</td>
        </tr>
        <tr>
          <td id="L1793" data-line-number="1793"></td>
          <td id="LC1793">                    Else</td>
        </tr>
        <tr>
          <td id="L1794" data-line-number="1794"></td>
          <td id="LC1794">                        lEnd = lEnd - .MacSize</td>
        </tr>
        <tr>
          <td id="L1795" data-line-number="1795"></td>
          <td id="LC1795">                        &#39;--- prepare encrypted data for MAC</td>
        </tr>
        <tr>
          <td id="L1796" data-line-number="1796"></td>
          <td id="LC1796">                        pvBufferWriteLong uAad, lEnd - uInput.Pos + .IvExplicitSize, Size:=2</td>
        </tr>
        <tr>
          <td id="L1797" data-line-number="1797"></td>
          <td id="LC1797">                        pvBufferWriteBlob uAad, VarPtr(uInput.Data(uInput.Pos - .IvExplicitSize)), lEnd - uInput.Pos + .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L1798" data-line-number="1798"></td>
          <td id="LC1798">                    End If</td>
        </tr>
        <tr>
          <td id="L1799" data-line-number="1799"></td>
          <td id="LC1799">                    bResult = pvTlsBulkDecrypt(.BulkAlgo, baRemoteIV, .RemoteTrafficKey, uAad.Data, 0, uAad.Size, uInput.Data, uInput.Pos, lEnd - uInput.Pos + .TagSize)</td>
        </tr>
        <tr>
          <td id="L1800" data-line-number="1800"></td>
          <td id="LC1800">                End If</td>
        </tr>
        <tr>
          <td id="L1801" data-line-number="1801"></td>
          <td id="LC1801">                If Not bResult Then</td>
        </tr>
        <tr>
          <td id="L1802" data-line-number="1802"></td>
          <td id="LC1802">                    GoTo DecryptionFailed</td>
        </tr>
        <tr>
          <td id="L1803" data-line-number="1803"></td>
          <td id="LC1803">                End If</td>
        </tr>
        <tr>
          <td id="L1804" data-line-number="1804"></td>
          <td id="LC1804">                #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1805" data-line-number="1805"></td>
          <td id="LC1805">                    If lEnd - uInput.Pos &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1806" data-line-number="1806"></td>
          <td id="LC1806">                        .TrafficDump.Add FUNC_NAME &amp; &#34;.Input (decrypted)&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(uInput.Data, lRecordPos, lEnd - lRecordPos)</td>
        </tr>
        <tr>
          <td id="L1807" data-line-number="1807"></td>
          <td id="LC1807">                    End If</td>
        </tr>
        <tr>
          <td id="L1808" data-line-number="1808"></td>
          <td id="LC1808">                #End If</td>
        </tr>
        <tr>
          <td id="L1809" data-line-number="1809"></td>
          <td id="LC1809">                .RemoteTrafficSeqNo = UnsignedAdd(.RemoteTrafficSeqNo, 1)</td>
        </tr>
        <tr>
          <td id="L1810" data-line-number="1810"></td>
          <td id="LC1810">                If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1811" data-line-number="1811"></td>
          <td id="LC1811">                    If lEnd - uInput.Pos &gt; TLS_MAX_PLAINTEXT_RECORD_SIZE + 1 Then</td>
        </tr>
        <tr>
          <td id="L1812" data-line-number="1812"></td>
          <td id="LC1812">                        GoTo RecordOverflow</td>
        </tr>
        <tr>
          <td id="L1813" data-line-number="1813"></td>
          <td id="LC1813">                    End If</td>
        </tr>
        <tr>
          <td id="L1814" data-line-number="1814"></td>
          <td id="LC1814">                    &#39;--- trim zero padding at the end of decrypted record</td>
        </tr>
        <tr>
          <td id="L1815" data-line-number="1815"></td>
          <td id="LC1815">                    Do While lEnd &gt; uInput.Pos</td>
        </tr>
        <tr>
          <td id="L1816" data-line-number="1816"></td>
          <td id="LC1816">                        lEnd = lEnd - 1</td>
        </tr>
        <tr>
          <td id="L1817" data-line-number="1817"></td>
          <td id="LC1817">                        If uInput.Data(lEnd) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1818" data-line-number="1818"></td>
          <td id="LC1818">                            Exit Do</td>
        </tr>
        <tr>
          <td id="L1819" data-line-number="1819"></td>
          <td id="LC1819">                        End If</td>
        </tr>
        <tr>
          <td id="L1820" data-line-number="1820"></td>
          <td id="LC1820">                    Loop</td>
        </tr>
        <tr>
          <td id="L1821" data-line-number="1821"></td>
          <td id="LC1821">                    lRecordType = uInput.Data(lEnd)</td>
        </tr>
        <tr>
          <td id="L1822" data-line-number="1822"></td>
          <td id="LC1822">                ElseIf .MacSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1823" data-line-number="1823"></td>
          <td id="LC1823">                    If Not .RemoteEncryptThenMac Then</td>
        </tr>
        <tr>
          <td id="L1824" data-line-number="1824"></td>
          <td id="LC1824">                        &#39;--- remove padding and prepare decrypted data for MAC</td>
        </tr>
        <tr>
          <td id="L1825" data-line-number="1825"></td>
          <td id="LC1825">                        lPadding = uInput.Data(lEnd - 1)</td>
        </tr>
        <tr>
          <td id="L1826" data-line-number="1826"></td>
          <td id="LC1826">                        If lEnd - (lPadding + 1) - .MacSize &lt; uInput.Pos Then</td>
        </tr>
        <tr>
          <td id="L1827" data-line-number="1827"></td>
          <td id="LC1827">                            GoTo RecordMacFailed</td>
        </tr>
        <tr>
          <td id="L1828" data-line-number="1828"></td>
          <td id="LC1828">                        End If</td>
        </tr>
        <tr>
          <td id="L1829" data-line-number="1829"></td>
          <td id="LC1829">                        For lIdx = 2 To lPadding + 1</td>
        </tr>
        <tr>
          <td id="L1830" data-line-number="1830"></td>
          <td id="LC1830">                            If uInput.Data(lEnd - lIdx) &lt;&gt; lPadding Then</td>
        </tr>
        <tr>
          <td id="L1831" data-line-number="1831"></td>
          <td id="LC1831">                                GoTo RecordMacFailed</td>
        </tr>
        <tr>
          <td id="L1832" data-line-number="1832"></td>
          <td id="LC1832">                            End If</td>
        </tr>
        <tr>
          <td id="L1833" data-line-number="1833"></td>
          <td id="LC1833">                        Next</td>
        </tr>
        <tr>
          <td id="L1834" data-line-number="1834"></td>
          <td id="LC1834">                        lEnd = lEnd - (lPadding + 1) - .MacSize</td>
        </tr>
        <tr>
          <td id="L1835" data-line-number="1835"></td>
          <td id="LC1835">                        uAad.Size = uAad.Size - 2</td>
        </tr>
        <tr>
          <td id="L1836" data-line-number="1836"></td>
          <td id="LC1836">                        pvBufferWriteLong uAad, lEnd - uInput.Pos, Size:=2</td>
        </tr>
        <tr>
          <td id="L1837" data-line-number="1837"></td>
          <td id="LC1837">                        pvBufferWriteBlob uAad, VarPtr(uInput.Data(uInput.Pos)), lEnd - uInput.Pos</td>
        </tr>
        <tr>
          <td id="L1838" data-line-number="1838"></td>
          <td id="LC1838">                    End If</td>
        </tr>
        <tr>
          <td id="L1839" data-line-number="1839"></td>
          <td id="LC1839">                    &#39;--- calc MAC and compare</td>
        </tr>
        <tr>
          <td id="L1840" data-line-number="1840"></td>
          <td id="LC1840">                    pvTlsGetHmac baHmac, .MacAlgo, .RemoteMacKey, uAad.Data, 0, uAad.Size</td>
        </tr>
        <tr>
          <td id="L1841" data-line-number="1841"></td>
          <td id="LC1841">                    pvArrayAllocate baRemoteIV, .MacSize, FUNC_NAME &amp; &#34;.baRemoteIV&#34;</td>
        </tr>
        <tr>
          <td id="L1842" data-line-number="1842"></td>
          <td id="LC1842">                    Call CopyMemory(baRemoteIV(0), ByVal VarPtr(uInput.Data(lEnd)), .MacSize)</td>
        </tr>
        <tr>
          <td id="L1843" data-line-number="1843"></td>
          <td id="LC1843">                    If Not pvArrayEqual(baHmac, baRemoteIV) Then</td>
        </tr>
        <tr>
          <td id="L1844" data-line-number="1844"></td>
          <td id="LC1844">                        GoTo RecordMacFailed</td>
        </tr>
        <tr>
          <td id="L1845" data-line-number="1845"></td>
          <td id="LC1845">                    End If</td>
        </tr>
        <tr>
          <td id="L1846" data-line-number="1846"></td>
          <td id="LC1846">                    If .RemoteEncryptThenMac Then</td>
        </tr>
        <tr>
          <td id="L1847" data-line-number="1847"></td>
          <td id="LC1847">                        &#39;--- remove padding from decrypted data</td>
        </tr>
        <tr>
          <td id="L1848" data-line-number="1848"></td>
          <td id="LC1848">                        lPadding = uInput.Data(lEnd - 1)</td>
        </tr>
        <tr>
          <td id="L1849" data-line-number="1849"></td>
          <td id="LC1849">                        If lEnd - (lPadding + 1) &lt; uInput.Pos Then</td>
        </tr>
        <tr>
          <td id="L1850" data-line-number="1850"></td>
          <td id="LC1850">                            GoTo RecordMacFailed</td>
        </tr>
        <tr>
          <td id="L1851" data-line-number="1851"></td>
          <td id="LC1851">                        End If</td>
        </tr>
        <tr>
          <td id="L1852" data-line-number="1852"></td>
          <td id="LC1852">                        For lIdx = 2 To lPadding + 1</td>
        </tr>
        <tr>
          <td id="L1853" data-line-number="1853"></td>
          <td id="LC1853">                            If uInput.Data(lEnd - lIdx) &lt;&gt; lPadding Then</td>
        </tr>
        <tr>
          <td id="L1854" data-line-number="1854"></td>
          <td id="LC1854">                                GoTo RecordMacFailed</td>
        </tr>
        <tr>
          <td id="L1855" data-line-number="1855"></td>
          <td id="LC1855">                            End If</td>
        </tr>
        <tr>
          <td id="L1856" data-line-number="1856"></td>
          <td id="LC1856">                        Next</td>
        </tr>
        <tr>
          <td id="L1857" data-line-number="1857"></td>
          <td id="LC1857">                        lEnd = lEnd - (lPadding + 1)</td>
        </tr>
        <tr>
          <td id="L1858" data-line-number="1858"></td>
          <td id="LC1858">                    End If</td>
        </tr>
        <tr>
          <td id="L1859" data-line-number="1859"></td>
          <td id="LC1859">                End If</td>
        </tr>
        <tr>
          <td id="L1860" data-line-number="1860"></td>
          <td id="LC1860">            Else</td>
        </tr>
        <tr>
          <td id="L1861" data-line-number="1861"></td>
          <td id="LC1861">Unencrypted:</td>
        </tr>
        <tr>
          <td id="L1862" data-line-number="1862"></td>
          <td id="LC1862">                lEnd = uInput.Pos + lRecordSize</td>
        </tr>
        <tr>
          <td id="L1863" data-line-number="1863"></td>
          <td id="LC1863">            End If</td>
        </tr>
        <tr>
          <td id="L1864" data-line-number="1864"></td>
          <td id="LC1864">            &#39;--- check plaintext size</td>
        </tr>
        <tr>
          <td id="L1865" data-line-number="1865"></td>
          <td id="LC1865">            If lEnd - uInput.Pos &gt; TLS_MAX_PLAINTEXT_RECORD_SIZE Then</td>
        </tr>
        <tr>
          <td id="L1866" data-line-number="1866"></td>
          <td id="LC1866">                GoTo RecordOverflow</td>
        </tr>
        <tr>
          <td id="L1867" data-line-number="1867"></td>
          <td id="LC1867">            End If</td>
        </tr>
        <tr>
          <td id="L1868" data-line-number="1868"></td>
          <td id="LC1868">            Select Case lRecordType</td>
        </tr>
        <tr>
          <td id="L1869" data-line-number="1869"></td>
          <td id="LC1869">            Case TLS_CONTENT_TYPE_CHANGE_CIPHER_SPEC</td>
        </tr>
        <tr>
          <td id="L1870" data-line-number="1870"></td>
          <td id="LC1870">                If uInput.Pos + 1 &lt;&gt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L1871" data-line-number="1871"></td>
          <td id="LC1871">                    GoTo UnexpectedRecordSize</td>
        </tr>
        <tr>
          <td id="L1872" data-line-number="1872"></td>
          <td id="LC1872">                End If</td>
        </tr>
        <tr>
          <td id="L1873" data-line-number="1873"></td>
          <td id="LC1873">                If .State = ucsTlsStatePostHandshake Then</td>
        </tr>
        <tr>
          <td id="L1874" data-line-number="1874"></td>
          <td id="LC1874">                    GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1875" data-line-number="1875"></td>
          <td id="LC1875">                End If</td>
        </tr>
        <tr>
          <td id="L1876" data-line-number="1876"></td>
          <td id="LC1876">                If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L1877" data-line-number="1877"></td>
          <td id="LC1877">                    If pvArraySize(.RemoteLegacyNextTrafficKey) = 0 Then</td>
        </tr>
        <tr>
          <td id="L1878" data-line-number="1878"></td>
          <td id="LC1878">                        GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1879" data-line-number="1879"></td>
          <td id="LC1879">                    End If</td>
        </tr>
        <tr>
          <td id="L1880" data-line-number="1880"></td>
          <td id="LC1880">                    &#39;--- commit next epoch remote secrets</td>
        </tr>
        <tr>
          <td id="L1881" data-line-number="1881"></td>
          <td id="LC1881">                    .RemoteMacKey = .RemoteLegacyNextMacKey</td>
        </tr>
        <tr>
          <td id="L1882" data-line-number="1882"></td>
          <td id="LC1882">                    .RemoteTrafficKey = .RemoteLegacyNextTrafficKey</td>
        </tr>
        <tr>
          <td id="L1883" data-line-number="1883"></td>
          <td id="LC1883">                    .RemoteTrafficIV = .RemoteLegacyNextTrafficIV</td>
        </tr>
        <tr>
          <td id="L1884" data-line-number="1884"></td>
          <td id="LC1884">                    .RemoteTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L1885" data-line-number="1885"></td>
          <td id="LC1885">                    .RemoteEncryptThenMac = (.MacSize &gt; 0) And SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_ENCRYPT_THEN_MAC)</td>
        </tr>
        <tr>
          <td id="L1886" data-line-number="1886"></td>
          <td id="LC1886">                    Erase .RemoteLegacyNextTrafficKey</td>
        </tr>
        <tr>
          <td id="L1887" data-line-number="1887"></td>
          <td id="LC1887">                End If</td>
        </tr>
        <tr>
          <td id="L1888" data-line-number="1888"></td>
          <td id="LC1888">            Case TLS_CONTENT_TYPE_ALERT</td>
        </tr>
        <tr>
          <td id="L1889" data-line-number="1889"></td>
          <td id="LC1889">                If uInput.Pos + 2 &lt;&gt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L1890" data-line-number="1890"></td>
          <td id="LC1890">                    GoTo UnexpectedRecordSize</td>
        </tr>
        <tr>
          <td id="L1891" data-line-number="1891"></td>
          <td id="LC1891">                End If</td>
        </tr>
        <tr>
          <td id="L1892" data-line-number="1892"></td>
          <td id="LC1892">                Select Case uInput.Data(uInput.Pos)</td>
        </tr>
        <tr>
          <td id="L1893" data-line-number="1893"></td>
          <td id="LC1893">                Case TLS_ALERT_LEVEL_FATAL</td>
        </tr>
        <tr>
          <td id="L1894" data-line-number="1894"></td>
          <td id="LC1894">                    sError = ERR_FATAL_ALERT</td>
        </tr>
        <tr>
          <td id="L1895" data-line-number="1895"></td>
          <td id="LC1895">                    eAlertCode = uInput.Data(uInput.Pos + 1)</td>
        </tr>
        <tr>
          <td id="L1896" data-line-number="1896"></td>
          <td id="LC1896">                    GoTo QH</td>
        </tr>
        <tr>
          <td id="L1897" data-line-number="1897"></td>
          <td id="LC1897">                Case TLS_ALERT_LEVEL_WARNING</td>
        </tr>
        <tr>
          <td id="L1898" data-line-number="1898"></td>
          <td id="LC1898">                    .LastAlertCode = uInput.Data(uInput.Pos + 1)</td>
        </tr>
        <tr>
          <td id="L1899" data-line-number="1899"></td>
          <td id="LC1899">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L1900" data-line-number="1900"></td>
          <td id="LC1900">                        DebugLog MODULE_NAME, FUNC_NAME, pvTlsGetLastAlert(uCtx) &amp; &#34; (TLS_ALERT_LEVEL_WARNING)&#34;</td>
        </tr>
        <tr>
          <td id="L1901" data-line-number="1901"></td>
          <td id="LC1901">                    #End If</td>
        </tr>
        <tr>
          <td id="L1902" data-line-number="1902"></td>
          <td id="LC1902">                    If .LastAlertCode = uscTlsAlertCloseNotify And .State &lt;&gt; ucsTlsStateShutdown Then</td>
        </tr>
        <tr>
          <td id="L1903" data-line-number="1903"></td>
          <td id="LC1903">                        pvTlsSetLastError uCtx, AlertCode:=uscTlsAlertCloseNotify</td>
        </tr>
        <tr>
          <td id="L1904" data-line-number="1904"></td>
          <td id="LC1904">                    End If</td>
        </tr>
        <tr>
          <td id="L1905" data-line-number="1905"></td>
          <td id="LC1905">                End Select</td>
        </tr>
        <tr>
          <td id="L1906" data-line-number="1906"></td>
          <td id="LC1906">            Case TLS_CONTENT_TYPE_HANDSHAKE</td>
        </tr>
        <tr>
          <td id="L1907" data-line-number="1907"></td>
          <td id="LC1907">                If uInput.Pos = lEnd Then</td>
        </tr>
        <tr>
          <td id="L1908" data-line-number="1908"></td>
          <td id="LC1908">                    GoTo UnexpectedRecordSize</td>
        </tr>
        <tr>
          <td id="L1909" data-line-number="1909"></td>
          <td id="LC1909">                End If</td>
        </tr>
        <tr>
          <td id="L1910" data-line-number="1910"></td>
          <td id="LC1910">                If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L1911" data-line-number="1911"></td>
          <td id="LC1911">                    &#39;--- RFC 8446 section 5.1: Handshake messages MUST NOT be interleaved with other record types</td>
        </tr>
        <tr>
          <td id="L1912" data-line-number="1912"></td>
          <td id="LC1912">                    If .PrevRecordType &lt;&gt; 0 And .PrevRecordType &lt;&gt; lRecordType Then</td>
        </tr>
        <tr>
          <td id="L1913" data-line-number="1913"></td>
          <td id="LC1913">                        GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1914" data-line-number="1914"></td>
          <td id="LC1914">                    End If</td>
        </tr>
        <tr>
          <td id="L1915" data-line-number="1915"></td>
          <td id="LC1915">                End If</td>
        </tr>
        <tr>
          <td id="L1916" data-line-number="1916"></td>
          <td id="LC1916">                If .MessBuffer.Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L1917" data-line-number="1917"></td>
          <td id="LC1917">                    pvBufferWriteBlob .MessBuffer, VarPtr(uInput.Data(uInput.Pos)), lEnd - uInput.Pos</td>
        </tr>
        <tr>
          <td id="L1918" data-line-number="1918"></td>
          <td id="LC1918">                    If Not pvTlsParseHandshake(uCtx, .MessBuffer, .MessBuffer.Size, lRecordProtocol, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L1919" data-line-number="1919"></td>
          <td id="LC1919">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L1920" data-line-number="1920"></td>
          <td id="LC1920">                    End If</td>
        </tr>
        <tr>
          <td id="L1921" data-line-number="1921"></td>
          <td id="LC1921">                    If .MessBuffer.Pos &gt;= .MessBuffer.Size Then</td>
        </tr>
        <tr>
          <td id="L1922" data-line-number="1922"></td>
          <td id="LC1922">                        Erase .MessBuffer.Data</td>
        </tr>
        <tr>
          <td id="L1923" data-line-number="1923"></td>
          <td id="LC1923">                        .MessBuffer.Size = 0</td>
        </tr>
        <tr>
          <td id="L1924" data-line-number="1924"></td>
          <td id="LC1924">                        .MessBuffer.Pos = 0</td>
        </tr>
        <tr>
          <td id="L1925" data-line-number="1925"></td>
          <td id="LC1925">                    End If</td>
        </tr>
        <tr>
          <td id="L1926" data-line-number="1926"></td>
          <td id="LC1926">                Else</td>
        </tr>
        <tr>
          <td id="L1927" data-line-number="1927"></td>
          <td id="LC1927">                    If Not pvTlsParseHandshake(uCtx, uInput, lEnd, lRecordProtocol, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L1928" data-line-number="1928"></td>
          <td id="LC1928">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L1929" data-line-number="1929"></td>
          <td id="LC1929">                    End If</td>
        </tr>
        <tr>
          <td id="L1930" data-line-number="1930"></td>
          <td id="LC1930">                    If uInput.Pos &lt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L1931" data-line-number="1931"></td>
          <td id="LC1931">                        pvBufferWriteBlob .MessBuffer, VarPtr(uInput.Data(uInput.Pos)), lEnd - uInput.Pos</td>
        </tr>
        <tr>
          <td id="L1932" data-line-number="1932"></td>
          <td id="LC1932">                        .MessBuffer.Pos = 0</td>
        </tr>
        <tr>
          <td id="L1933" data-line-number="1933"></td>
          <td id="LC1933">                    End If</td>
        </tr>
        <tr>
          <td id="L1934" data-line-number="1934"></td>
          <td id="LC1934">                End If</td>
        </tr>
        <tr>
          <td id="L1935" data-line-number="1935"></td>
          <td id="LC1935">            Case TLS_CONTENT_TYPE_APPDATA</td>
        </tr>
        <tr>
          <td id="L1936" data-line-number="1936"></td>
          <td id="LC1936">                If .IsServer And .State &lt; ucsTlsStatePostHandshake Then</td>
        </tr>
        <tr>
          <td id="L1937" data-line-number="1937"></td>
          <td id="LC1937">                    GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1938" data-line-number="1938"></td>
          <td id="LC1938">                End If</td>
        </tr>
        <tr>
          <td id="L1939" data-line-number="1939"></td>
          <td id="LC1939">                pvBufferWriteBlob .DecrBuffer, VarPtr(uInput.Data(uInput.Pos)), lEnd - uInput.Pos</td>
        </tr>
        <tr>
          <td id="L1940" data-line-number="1940"></td>
          <td id="LC1940">                .PrevRecordType = lRecordType</td>
        </tr>
        <tr>
          <td id="L1941" data-line-number="1941"></td>
          <td id="LC1941">            Case Else</td>
        </tr>
        <tr>
          <td id="L1942" data-line-number="1942"></td>
          <td id="LC1942">                GoTo UnexpectedRecordType</td>
        </tr>
        <tr>
          <td id="L1943" data-line-number="1943"></td>
          <td id="LC1943">            End Select</td>
        </tr>
        <tr>
          <td id="L1944" data-line-number="1944"></td>
          <td id="LC1944">            &#39;--- note: skip AEAD&#39;s authentication tag or zero padding</td>
        </tr>
        <tr>
          <td id="L1945" data-line-number="1945"></td>
          <td id="LC1945">            uInput.Pos = lRecordPos + lRecordSize + 5</td>
        </tr>
        <tr>
          <td id="L1946" data-line-number="1946"></td>
          <td id="LC1946">        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L1947" data-line-number="1947"></td>
          <td id="LC1947">    Loop</td>
        </tr>
        <tr>
          <td id="L1948" data-line-number="1948"></td>
          <td id="LC1948">    End With</td>
        </tr>
        <tr>
          <td id="L1949" data-line-number="1949"></td>
          <td id="LC1949">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L1950" data-line-number="1950"></td>
          <td id="LC1950">    pvTlsParseRecord = True</td>
        </tr>
        <tr>
          <td id="L1951" data-line-number="1951"></td>
          <td id="LC1951">QH:</td>
        </tr>
        <tr>
          <td id="L1952" data-line-number="1952"></td>
          <td id="LC1952">    Exit Function</td>
        </tr>
        <tr>
          <td id="L1953" data-line-number="1953"></td>
          <td id="LC1953">RecordOverflow:</td>
        </tr>
        <tr>
          <td id="L1954" data-line-number="1954"></td>
          <td id="LC1954">    sError = ERR_RECORD_OVERFLOW</td>
        </tr>
        <tr>
          <td id="L1955" data-line-number="1955"></td>
          <td id="LC1955">    eAlertCode = uscTlsAlertRecordOverflow</td>
        </tr>
        <tr>
          <td id="L1956" data-line-number="1956"></td>
          <td id="LC1956">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L1957" data-line-number="1957"></td>
          <td id="LC1957">DecryptionFailed:</td>
        </tr>
        <tr>
          <td id="L1958" data-line-number="1958"></td>
          <td id="LC1958">    sError = ERR_DECRYPTION_FAILED</td>
        </tr>
        <tr>
          <td id="L1959" data-line-number="1959"></td>
          <td id="LC1959">    eAlertCode = uscTlsAlertBadRecordMac</td>
        </tr>
        <tr>
          <td id="L1960" data-line-number="1960"></td>
          <td id="LC1960">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L1961" data-line-number="1961"></td>
          <td id="LC1961">UnexpectedRecordType:</td>
        </tr>
        <tr>
          <td id="L1962" data-line-number="1962"></td>
          <td id="LC1962">    sError = Replace(ERR_UNEXPECTED_RECORD_TYPE, &#34;%1&#34;, lRecordType)</td>
        </tr>
        <tr>
          <td id="L1963" data-line-number="1963"></td>
          <td id="LC1963">    eAlertCode = uscTlsAlertUnexpectedMessage</td>
        </tr>
        <tr>
          <td id="L1964" data-line-number="1964"></td>
          <td id="LC1964">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L1965" data-line-number="1965"></td>
          <td id="LC1965">UnexpectedRecordSize:</td>
        </tr>
        <tr>
          <td id="L1966" data-line-number="1966"></td>
          <td id="LC1966">    sError = ERR_RECORD_OVERFLOW</td>
        </tr>
        <tr>
          <td id="L1967" data-line-number="1967"></td>
          <td id="LC1967">    eAlertCode = uscTlsAlertUnexpectedMessage</td>
        </tr>
        <tr>
          <td id="L1968" data-line-number="1968"></td>
          <td id="LC1968">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L1969" data-line-number="1969"></td>
          <td id="LC1969">RecordMacFailed:</td>
        </tr>
        <tr>
          <td id="L1970" data-line-number="1970"></td>
          <td id="LC1970">    sError = ERR_RECORD_MAC_FAILED</td>
        </tr>
        <tr>
          <td id="L1971" data-line-number="1971"></td>
          <td id="LC1971">    eAlertCode = uscTlsAlertBadRecordMac</td>
        </tr>
        <tr>
          <td id="L1972" data-line-number="1972"></td>
          <td id="LC1972">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L1973" data-line-number="1973"></td>
          <td id="LC1973">EH:</td>
        </tr>
        <tr>
          <td id="L1974" data-line-number="1974"></td>
          <td id="LC1974">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L1975" data-line-number="1975"></td>
          <td id="LC1975">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L1976" data-line-number="1976"></td>
          <td id="LC1976">    Resume QH</td>
        </tr>
        <tr>
          <td id="L1977" data-line-number="1977"></td>
          <td id="LC1977">End Function</td>
        </tr>
        <tr>
          <td id="L1978" data-line-number="1978"></td>
          <td id="LC1978">
</td>
        </tr>
        <tr>
          <td id="L1979" data-line-number="1979"></td>
          <td id="LC1979">Private Function pvTlsParseHandshake(uCtx As UcsTlsContext, uInput As UcsBuffer, ByVal lInputEnd As Long, ByVal lRecordProtocol As Long, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L1980" data-line-number="1980"></td>
          <td id="LC1980">    Const FUNC_NAME     As String = &#34;pvTlsParseHandshake&#34;</td>
        </tr>
        <tr>
          <td id="L1981" data-line-number="1981"></td>
          <td id="LC1981">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L1982" data-line-number="1982"></td>
          <td id="LC1982">    Dim lMessageSize    As Long</td>
        </tr>
        <tr>
          <td id="L1983" data-line-number="1983"></td>
          <td id="LC1983">    Dim lMessageEnd     As Long</td>
        </tr>
        <tr>
          <td id="L1984" data-line-number="1984"></td>
          <td id="LC1984">    Dim lMessageType    As Long</td>
        </tr>
        <tr>
          <td id="L1985" data-line-number="1985"></td>
          <td id="LC1985">    Dim baMessage()     As Byte</td>
        </tr>
        <tr>
          <td id="L1986" data-line-number="1986"></td>
          <td id="LC1986">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L1987" data-line-number="1987"></td>
          <td id="LC1987">    Dim uVerify         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L1988" data-line-number="1988"></td>
          <td id="LC1988">    Dim lRequestUpdate  As Long</td>
        </tr>
        <tr>
          <td id="L1989" data-line-number="1989"></td>
          <td id="LC1989">    Dim lCurveType      As Long</td>
        </tr>
        <tr>
          <td id="L1990" data-line-number="1990"></td>
          <td id="LC1990">    Dim lNamedCurve     As Long</td>
        </tr>
        <tr>
          <td id="L1991" data-line-number="1991"></td>
          <td id="LC1991">    Dim lSignatureScheme As Long</td>
        </tr>
        <tr>
          <td id="L1992" data-line-number="1992"></td>
          <td id="LC1992">    Dim lSignatureSize  As Long</td>
        </tr>
        <tr>
          <td id="L1993" data-line-number="1993"></td>
          <td id="LC1993">    Dim baSignature()   As Byte</td>
        </tr>
        <tr>
          <td id="L1994" data-line-number="1994"></td>
          <td id="LC1994">    Dim baCert()        As Byte</td>
        </tr>
        <tr>
          <td id="L1995" data-line-number="1995"></td>
          <td id="LC1995">    Dim lCertSize       As Long</td>
        </tr>
        <tr>
          <td id="L1996" data-line-number="1996"></td>
          <td id="LC1996">    Dim lCertEnd        As Long</td>
        </tr>
        <tr>
          <td id="L1997" data-line-number="1997"></td>
          <td id="LC1997">    Dim lSignPos        As Long</td>
        </tr>
        <tr>
          <td id="L1998" data-line-number="1998"></td>
          <td id="LC1998">    Dim lSignSize       As Long</td>
        </tr>
        <tr>
          <td id="L1999" data-line-number="1999"></td>
          <td id="LC1999">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L2000" data-line-number="2000"></td>
          <td id="LC2000">    Dim baEmpty()       As Byte</td>
        </tr>
        <tr>
          <td id="L2001" data-line-number="2001"></td>
          <td id="LC2001">    Dim lBlockSize      As Long</td>
        </tr>
        <tr>
          <td id="L2002" data-line-number="2002"></td>
          <td id="LC2002">    Dim lBlockEnd       As Long</td>
        </tr>
        <tr>
          <td id="L2003" data-line-number="2003"></td>
          <td id="LC2003">    Dim lExtType        As Long</td>
        </tr>
        <tr>
          <td id="L2004" data-line-number="2004"></td>
          <td id="LC2004">    Dim lExtSize        As Long</td>
        </tr>
        <tr>
          <td id="L2005" data-line-number="2005"></td>
          <td id="LC2005">    Dim lExtEnd         As Long</td>
        </tr>
        <tr>
          <td id="L2006" data-line-number="2006"></td>
          <td id="LC2006">    Dim lStringSize     As Long</td>
        </tr>
        <tr>
          <td id="L2007" data-line-number="2007"></td>
          <td id="LC2007">    Dim lExchGroup      As Long</td>
        </tr>
        <tr>
          <td id="L2008" data-line-number="2008"></td>
          <td id="LC2008">    Dim lStatusType     As Long</td>
        </tr>
        <tr>
          <td id="L2009" data-line-number="2009"></td>
          <td id="LC2009">    </td>
        </tr>
        <tr>
          <td id="L2010" data-line-number="2010"></td>
          <td id="LC2010">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L2011" data-line-number="2011"></td>
          <td id="LC2011">    lExtType = -1</td>
        </tr>
        <tr>
          <td id="L2012" data-line-number="2012"></td>
          <td id="LC2012">    With uCtx</td>
        </tr>
        <tr>
          <td id="L2013" data-line-number="2013"></td>
          <td id="LC2013">    Do While uInput.Pos + 3 &lt; lInputEnd</td>
        </tr>
        <tr>
          <td id="L2014" data-line-number="2014"></td>
          <td id="LC2014">        lMessagePos = uInput.Pos</td>
        </tr>
        <tr>
          <td id="L2015" data-line-number="2015"></td>
          <td id="LC2015">        pvBufferReadLong uInput, lMessageType</td>
        </tr>
        <tr>
          <td id="L2016" data-line-number="2016"></td>
          <td id="LC2016">        pvBufferReadBlockStart uInput, Size:=3, BlockSize:=lMessageSize</td>
        </tr>
        <tr>
          <td id="L2017" data-line-number="2017"></td>
          <td id="LC2017">            lMessageEnd = uInput.Pos + lMessageSize</td>
        </tr>
        <tr>
          <td id="L2018" data-line-number="2018"></td>
          <td id="LC2018">            If lMessageEnd &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2019" data-line-number="2019"></td>
          <td id="LC2019">                &#39;--- back off and bail out early</td>
        </tr>
        <tr>
          <td id="L2020" data-line-number="2020"></td>
          <td id="LC2020">                uInput.Stack.Remove 1</td>
        </tr>
        <tr>
          <td id="L2021" data-line-number="2021"></td>
          <td id="LC2021">                uInput.Pos = lMessagePos</td>
        </tr>
        <tr>
          <td id="L2022" data-line-number="2022"></td>
          <td id="LC2022">                Exit Do</td>
        </tr>
        <tr>
          <td id="L2023" data-line-number="2023"></td>
          <td id="LC2023">            End If</td>
        </tr>
        <tr>
          <td id="L2024" data-line-number="2024"></td>
          <td id="LC2024">            #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2025" data-line-number="2025"></td>
          <td id="LC2025">&#39;                DebugLog MODULE_NAME, FUNC_NAME, &#34;.State=&#34; &amp; pvTlsGetStateAsText(.State) &amp; &#34;, lMessageType=&#34; &amp; pvTlsGetMessageName(lMessageType)</td>
        </tr>
        <tr>
          <td id="L2026" data-line-number="2026"></td>
          <td id="LC2026">            #End If</td>
        </tr>
        <tr>
          <td id="L2027" data-line-number="2027"></td>
          <td id="LC2027">            Select Case .State</td>
        </tr>
        <tr>
          <td id="L2028" data-line-number="2028"></td>
          <td id="LC2028">            Case ucsTlsStateExpectServerHello</td>
        </tr>
        <tr>
          <td id="L2029" data-line-number="2029"></td>
          <td id="LC2029">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2030" data-line-number="2030"></td>
          <td id="LC2030">                Case TLS_HANDSHAKE_SERVER_HELLO</td>
        </tr>
        <tr>
          <td id="L2031" data-line-number="2031"></td>
          <td id="LC2031">                    If Not pvTlsParseHandshakeServerHello(uCtx, uInput, uInput.Pos + lMessageSize, lRecordProtocol, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L2032" data-line-number="2032"></td>
          <td id="LC2032">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L2033" data-line-number="2033"></td>
          <td id="LC2033">                    End If</td>
        </tr>
        <tr>
          <td id="L2034" data-line-number="2034"></td>
          <td id="LC2034">                    If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2035" data-line-number="2035"></td>
          <td id="LC2035">                        &#39;--- on HelloRetryRequest replace HandshakeMessages w/ &#39;synthetic handshake message&#39;</td>
        </tr>
        <tr>
          <td id="L2036" data-line-number="2036"></td>
          <td id="LC2036">                        pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2037" data-line-number="2037"></td>
          <td id="LC2037">                        .HandshakeMessages.Size = 0</td>
        </tr>
        <tr>
          <td id="L2038" data-line-number="2038"></td>
          <td id="LC2038">                        pvBufferWriteLong .HandshakeMessages, TLS_HANDSHAKE_MESSAGE_HASH</td>
        </tr>
        <tr>
          <td id="L2039" data-line-number="2039"></td>
          <td id="LC2039">                        pvBufferWriteLong .HandshakeMessages, .DigestSize, Size:=3</td>
        </tr>
        <tr>
          <td id="L2040" data-line-number="2040"></td>
          <td id="LC2040">                        pvBufferWriteArray .HandshakeMessages, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2041" data-line-number="2041"></td>
          <td id="LC2041">                    Else</td>
        </tr>
        <tr>
          <td id="L2042" data-line-number="2042"></td>
          <td id="LC2042">                        .State = ucsTlsStateExpectEncryptedExtensions</td>
        </tr>
        <tr>
          <td id="L2043" data-line-number="2043"></td>
          <td id="LC2043">                    End If</td>
        </tr>
        <tr>
          <td id="L2044" data-line-number="2044"></td>
          <td id="LC2044">                Case Else</td>
        </tr>
        <tr>
          <td id="L2045" data-line-number="2045"></td>
          <td id="LC2045">                    GoTo UnexpectedMessageType</td>
        </tr>
        <tr>
          <td id="L2046" data-line-number="2046"></td>
          <td id="LC2046">                End Select</td>
        </tr>
        <tr>
          <td id="L2047" data-line-number="2047"></td>
          <td id="LC2047">                pvTlsAppendHandshakeHash uCtx, uInput.Data, lMessagePos, lMessageSize + 4</td>
        </tr>
        <tr>
          <td id="L2048" data-line-number="2048"></td>
          <td id="LC2048">                &#39;--- post-process ucsTlsStateExpectServerHello</td>
        </tr>
        <tr>
          <td id="L2049" data-line-number="2049"></td>
          <td id="LC2049">                If .State = ucsTlsStateExpectServerHello And .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2050" data-line-number="2050"></td>
          <td id="LC2050">                    pvTlsBuildClientHello uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2051" data-line-number="2051"></td>
          <td id="LC2051">                End If</td>
        </tr>
        <tr>
          <td id="L2052" data-line-number="2052"></td>
          <td id="LC2052">                If .State = ucsTlsStateExpectEncryptedExtensions And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2053" data-line-number="2053"></td>
          <td id="LC2053">                    pvTlsDeriveHandshakeSecrets uCtx</td>
        </tr>
        <tr>
          <td id="L2054" data-line-number="2054"></td>
          <td id="LC2054">                End If</td>
        </tr>
        <tr>
          <td id="L2055" data-line-number="2055"></td>
          <td id="LC2055">            Case ucsTlsStateExpectEncryptedExtensions</td>
        </tr>
        <tr>
          <td id="L2056" data-line-number="2056"></td>
          <td id="LC2056">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2057" data-line-number="2057"></td>
          <td id="LC2057">                Case TLS_HANDSHAKE_ENCRYPTED_EXTENSIONS</td>
        </tr>
        <tr>
          <td id="L2058" data-line-number="2058"></td>
          <td id="LC2058">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2059" data-line-number="2059"></td>
          <td id="LC2059">                    lBlockEnd = uInput.Pos + lBlockSize</td>
        </tr>
        <tr>
          <td id="L2060" data-line-number="2060"></td>
          <td id="LC2060">                    If lBlockEnd &lt;&gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2061" data-line-number="2061"></td>
          <td id="LC2061">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2062" data-line-number="2062"></td>
          <td id="LC2062">                    End If</td>
        </tr>
        <tr>
          <td id="L2063" data-line-number="2063"></td>
          <td id="LC2063">                    Do While uInput.Pos + 3 &lt; lBlockEnd</td>
        </tr>
        <tr>
          <td id="L2064" data-line-number="2064"></td>
          <td id="LC2064">                        pvBufferReadLong uInput, lExtType, Size:=2</td>
        </tr>
        <tr>
          <td id="L2065" data-line-number="2065"></td>
          <td id="LC2065">                        #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2066" data-line-number="2066"></td>
          <td id="LC2066">&#39;                            DebugLog MODULE_NAME, FUNC_NAME, &#34;EncryptedExtensions &#34; &amp; pvTlsGetExtensionName(lExtType)</td>
        </tr>
        <tr>
          <td id="L2067" data-line-number="2067"></td>
          <td id="LC2067">                        #End If</td>
        </tr>
        <tr>
          <td id="L2068" data-line-number="2068"></td>
          <td id="LC2068">                        pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lExtSize</td>
        </tr>
        <tr>
          <td id="L2069" data-line-number="2069"></td>
          <td id="LC2069">                            lExtEnd = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2070" data-line-number="2070"></td>
          <td id="LC2070">                            If lExtEnd &gt; lBlockEnd Then</td>
        </tr>
        <tr>
          <td id="L2071" data-line-number="2071"></td>
          <td id="LC2071">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2072" data-line-number="2072"></td>
          <td id="LC2072">                            End If</td>
        </tr>
        <tr>
          <td id="L2073" data-line-number="2073"></td>
          <td id="LC2073">                            Select Case lExtType</td>
        </tr>
        <tr>
          <td id="L2074" data-line-number="2074"></td>
          <td id="LC2074">                            Case TLS_EXTENSION_ALPN</td>
        </tr>
        <tr>
          <td id="L2075" data-line-number="2075"></td>
          <td id="LC2075">                                If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2076" data-line-number="2076"></td>
          <td id="LC2076">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2077" data-line-number="2077"></td>
          <td id="LC2077">                                End If</td>
        </tr>
        <tr>
          <td id="L2078" data-line-number="2078"></td>
          <td id="LC2078">                                pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lStringSize</td>
        </tr>
        <tr>
          <td id="L2079" data-line-number="2079"></td>
          <td id="LC2079">                                    If uInput.Pos + lStringSize &lt;&gt; lExtEnd Or lStringSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2080" data-line-number="2080"></td>
          <td id="LC2080">                                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2081" data-line-number="2081"></td>
          <td id="LC2081">                                    End If</td>
        </tr>
        <tr>
          <td id="L2082" data-line-number="2082"></td>
          <td id="LC2082">                                    pvBufferReadBlockStart uInput, BlockSize:=lStringSize</td>
        </tr>
        <tr>
          <td id="L2083" data-line-number="2083"></td>
          <td id="LC2083">                                        If uInput.Pos + lStringSize &lt;&gt; lExtEnd Or lStringSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2084" data-line-number="2084"></td>
          <td id="LC2084">                                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2085" data-line-number="2085"></td>
          <td id="LC2085">                                        End If</td>
        </tr>
        <tr>
          <td id="L2086" data-line-number="2086"></td>
          <td id="LC2086">                                        pvBufferReadString uInput, .AlpnNegotiated, lStringSize</td>
        </tr>
        <tr>
          <td id="L2087" data-line-number="2087"></td>
          <td id="LC2087">                                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2088" data-line-number="2088"></td>
          <td id="LC2088">                                pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2089" data-line-number="2089"></td>
          <td id="LC2089">                            Case TLS_EXTENSION_SUPPORTED_GROUPS</td>
        </tr>
        <tr>
          <td id="L2090" data-line-number="2090"></td>
          <td id="LC2090">                                If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2091" data-line-number="2091"></td>
          <td id="LC2091">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2092" data-line-number="2092"></td>
          <td id="LC2092">                                End If</td>
        </tr>
        <tr>
          <td id="L2093" data-line-number="2093"></td>
          <td id="LC2093">                                Set .RemoteSupportedGroups = New Collection</td>
        </tr>
        <tr>
          <td id="L2094" data-line-number="2094"></td>
          <td id="LC2094">                                Do While uInput.Pos + 1 &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L2095" data-line-number="2095"></td>
          <td id="LC2095">                                    pvBufferReadLong uInput, lExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L2096" data-line-number="2096"></td>
          <td id="LC2096">                                    .RemoteSupportedGroups.Add lExchGroup, &#34;#&#34; &amp; lExchGroup</td>
        </tr>
        <tr>
          <td id="L2097" data-line-number="2097"></td>
          <td id="LC2097">                                Loop</td>
        </tr>
        <tr>
          <td id="L2098" data-line-number="2098"></td>
          <td id="LC2098">                            Case Else</td>
        </tr>
        <tr>
          <td id="L2099" data-line-number="2099"></td>
          <td id="LC2099">                                uInput.Pos = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2100" data-line-number="2100"></td>
          <td id="LC2100">                            End Select</td>
        </tr>
        <tr>
          <td id="L2101" data-line-number="2101"></td>
          <td id="LC2101">                        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2102" data-line-number="2102"></td>
          <td id="LC2102">                    Loop</td>
        </tr>
        <tr>
          <td id="L2103" data-line-number="2103"></td>
          <td id="LC2103">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2104" data-line-number="2104"></td>
          <td id="LC2104">                Case TLS_HANDSHAKE_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L2105" data-line-number="2105"></td>
          <td id="LC2105">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2106" data-line-number="2106"></td>
          <td id="LC2106">                        pvBufferReadBlockStart uInput, BlockSize:=lCertSize</td>
        </tr>
        <tr>
          <td id="L2107" data-line-number="2107"></td>
          <td id="LC2107">                            If uInput.Pos + lCertSize &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2108" data-line-number="2108"></td>
          <td id="LC2108">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2109" data-line-number="2109"></td>
          <td id="LC2109">                            End If</td>
        </tr>
        <tr>
          <td id="L2110" data-line-number="2110"></td>
          <td id="LC2110">                            uInput.Pos = uInput.Pos + lCertSize &#39;--- skip RemoteCertReqContext</td>
        </tr>
        <tr>
          <td id="L2111" data-line-number="2111"></td>
          <td id="LC2111">                        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2112" data-line-number="2112"></td>
          <td id="LC2112">                    End If</td>
        </tr>
        <tr>
          <td id="L2113" data-line-number="2113"></td>
          <td id="LC2113">                    Set .RemoteCertificates = New Collection</td>
        </tr>
        <tr>
          <td id="L2114" data-line-number="2114"></td>
          <td id="LC2114">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2115" data-line-number="2115"></td>
          <td id="LC2115">                        Set .RemoteCertStatuses = New Collection</td>
        </tr>
        <tr>
          <td id="L2116" data-line-number="2116"></td>
          <td id="LC2116">                    End If</td>
        </tr>
        <tr>
          <td id="L2117" data-line-number="2117"></td>
          <td id="LC2117">                    If uInput.Pos + 3 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2118" data-line-number="2118"></td>
          <td id="LC2118">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2119" data-line-number="2119"></td>
          <td id="LC2119">                    End If</td>
        </tr>
        <tr>
          <td id="L2120" data-line-number="2120"></td>
          <td id="LC2120">                    pvBufferReadBlockStart uInput, Size:=3, BlockSize:=lCertSize</td>
        </tr>
        <tr>
          <td id="L2121" data-line-number="2121"></td>
          <td id="LC2121">                        lCertEnd = uInput.Pos + lCertSize</td>
        </tr>
        <tr>
          <td id="L2122" data-line-number="2122"></td>
          <td id="LC2122">                        If lCertEnd &lt;&gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2123" data-line-number="2123"></td>
          <td id="LC2123">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2124" data-line-number="2124"></td>
          <td id="LC2124">                        End If</td>
        </tr>
        <tr>
          <td id="L2125" data-line-number="2125"></td>
          <td id="LC2125">                        Do While uInput.Pos + 2 &lt; lCertEnd</td>
        </tr>
        <tr>
          <td id="L2126" data-line-number="2126"></td>
          <td id="LC2126">                            pvBufferReadBlockStart uInput, Size:=3, BlockSize:=lCertSize</td>
        </tr>
        <tr>
          <td id="L2127" data-line-number="2127"></td>
          <td id="LC2127">                                If uInput.Pos + lCertSize &gt; lCertEnd Then</td>
        </tr>
        <tr>
          <td id="L2128" data-line-number="2128"></td>
          <td id="LC2128">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2129" data-line-number="2129"></td>
          <td id="LC2129">                                End If</td>
        </tr>
        <tr>
          <td id="L2130" data-line-number="2130"></td>
          <td id="LC2130">                                pvBufferReadArray uInput, baCert, lCertSize</td>
        </tr>
        <tr>
          <td id="L2131" data-line-number="2131"></td>
          <td id="LC2131">                                .RemoteCertificates.Add baCert</td>
        </tr>
        <tr>
          <td id="L2132" data-line-number="2132"></td>
          <td id="LC2132">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2133" data-line-number="2133"></td>
          <td id="LC2133">                            If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2134" data-line-number="2134"></td>
          <td id="LC2134">                                baCert = vbNullString</td>
        </tr>
        <tr>
          <td id="L2135" data-line-number="2135"></td>
          <td id="LC2135">                                If uInput.Pos + 2 &gt; lCertEnd Then</td>
        </tr>
        <tr>
          <td id="L2136" data-line-number="2136"></td>
          <td id="LC2136">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2137" data-line-number="2137"></td>
          <td id="LC2137">                                End If</td>
        </tr>
        <tr>
          <td id="L2138" data-line-number="2138"></td>
          <td id="LC2138">                                pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2139" data-line-number="2139"></td>
          <td id="LC2139">                                lBlockEnd = uInput.Pos + lBlockSize</td>
        </tr>
        <tr>
          <td id="L2140" data-line-number="2140"></td>
          <td id="LC2140">                                If lBlockEnd &gt; lCertEnd Then</td>
        </tr>
        <tr>
          <td id="L2141" data-line-number="2141"></td>
          <td id="LC2141">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2142" data-line-number="2142"></td>
          <td id="LC2142">                                End If</td>
        </tr>
        <tr>
          <td id="L2143" data-line-number="2143"></td>
          <td id="LC2143">                                Do While uInput.Pos + 1 &lt; lBlockEnd</td>
        </tr>
        <tr>
          <td id="L2144" data-line-number="2144"></td>
          <td id="LC2144">                                    pvBufferReadLong uInput, lExtType, Size:=2</td>
        </tr>
        <tr>
          <td id="L2145" data-line-number="2145"></td>
          <td id="LC2145">                                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2146" data-line-number="2146"></td>
          <td id="LC2146">&#39;                                        DebugLog MODULE_NAME, FUNC_NAME, &#34;CertificateExtensions &#34; &amp; pvTlsGetExtensionName(lExtType)</td>
        </tr>
        <tr>
          <td id="L2147" data-line-number="2147"></td>
          <td id="LC2147">                                    #End If</td>
        </tr>
        <tr>
          <td id="L2148" data-line-number="2148"></td>
          <td id="LC2148">                                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lExtSize</td>
        </tr>
        <tr>
          <td id="L2149" data-line-number="2149"></td>
          <td id="LC2149">                                        lExtEnd = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2150" data-line-number="2150"></td>
          <td id="LC2150">                                        If lExtEnd &gt; lBlockEnd Then</td>
        </tr>
        <tr>
          <td id="L2151" data-line-number="2151"></td>
          <td id="LC2151">                                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2152" data-line-number="2152"></td>
          <td id="LC2152">                                        End If</td>
        </tr>
        <tr>
          <td id="L2153" data-line-number="2153"></td>
          <td id="LC2153">                                        Select Case lExtType</td>
        </tr>
        <tr>
          <td id="L2154" data-line-number="2154"></td>
          <td id="LC2154">                                        Case TLS_EXTENSION_STATUS_REQUEST</td>
        </tr>
        <tr>
          <td id="L2155" data-line-number="2155"></td>
          <td id="LC2155">                                            pvBufferReadArray uInput, baCert, lExtSize</td>
        </tr>
        <tr>
          <td id="L2156" data-line-number="2156"></td>
          <td id="LC2156">                                        Case Else</td>
        </tr>
        <tr>
          <td id="L2157" data-line-number="2157"></td>
          <td id="LC2157">                                            uInput.Pos = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2158" data-line-number="2158"></td>
          <td id="LC2158">                                        End Select</td>
        </tr>
        <tr>
          <td id="L2159" data-line-number="2159"></td>
          <td id="LC2159">                                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2160" data-line-number="2160"></td>
          <td id="LC2160">                                Loop</td>
        </tr>
        <tr>
          <td id="L2161" data-line-number="2161"></td>
          <td id="LC2161">                                pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2162" data-line-number="2162"></td>
          <td id="LC2162">                                .RemoteCertStatuses.Add baCert</td>
        </tr>
        <tr>
          <td id="L2163" data-line-number="2163"></td>
          <td id="LC2163">                            End If</td>
        </tr>
        <tr>
          <td id="L2164" data-line-number="2164"></td>
          <td id="LC2164">                        Loop</td>
        </tr>
        <tr>
          <td id="L2165" data-line-number="2165"></td>
          <td id="LC2165">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2166" data-line-number="2166"></td>
          <td id="LC2166">                Case TLS_HANDSHAKE_CERTIFICATE_VERIFY</td>
        </tr>
        <tr>
          <td id="L2167" data-line-number="2167"></td>
          <td id="LC2167">                    If uInput.Pos + 2 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2168" data-line-number="2168"></td>
          <td id="LC2168">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2169" data-line-number="2169"></td>
          <td id="LC2169">                    End If</td>
        </tr>
        <tr>
          <td id="L2170" data-line-number="2170"></td>
          <td id="LC2170">                    pvBufferReadLong uInput, lSignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L2171" data-line-number="2171"></td>
          <td id="LC2171">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSignatureSize</td>
        </tr>
        <tr>
          <td id="L2172" data-line-number="2172"></td>
          <td id="LC2172">                        If uInput.Pos + lSignatureSize &lt;&gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2173" data-line-number="2173"></td>
          <td id="LC2173">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2174" data-line-number="2174"></td>
          <td id="LC2174">                        End If</td>
        </tr>
        <tr>
          <td id="L2175" data-line-number="2175"></td>
          <td id="LC2175">                        pvBufferReadArray uInput, baSignature, lSignatureSize</td>
        </tr>
        <tr>
          <td id="L2176" data-line-number="2176"></td>
          <td id="LC2176">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2177" data-line-number="2177"></td>
          <td id="LC2177">                    If Not SearchCollection(.RemoteCertificates, 1, RetVal:=baCert) Then</td>
        </tr>
        <tr>
          <td id="L2178" data-line-number="2178"></td>
          <td id="LC2178">                        GoTo NoServerCertificate</td>
        </tr>
        <tr>
          <td id="L2179" data-line-number="2179"></td>
          <td id="LC2179">                    End If</td>
        </tr>
        <tr>
          <td id="L2180" data-line-number="2180"></td>
          <td id="LC2180">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2181" data-line-number="2181"></td>
          <td id="LC2181">                    pvBufferWriteString uVerify, Space$(64) &amp; &#34;TLS 1.3, server CertificateVerify&#34; &amp; Chr$(0)</td>
        </tr>
        <tr>
          <td id="L2182" data-line-number="2182"></td>
          <td id="LC2182">                    pvBufferWriteArray uVerify, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2183" data-line-number="2183"></td>
          <td id="LC2183">                    pvBufferWriteEOF uVerify</td>
        </tr>
        <tr>
          <td id="L2184" data-line-number="2184"></td>
          <td id="LC2184">                    If Not pvTlsSignatureVerify(baCert, lSignatureScheme, uVerify.Data, baSignature, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L2185" data-line-number="2185"></td>
          <td id="LC2185">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L2186" data-line-number="2186"></td>
          <td id="LC2186">                    End If</td>
        </tr>
        <tr>
          <td id="L2187" data-line-number="2187"></td>
          <td id="LC2187">                Case TLS_HANDSHAKE_FINISHED</td>
        </tr>
        <tr>
          <td id="L2188" data-line-number="2188"></td>
          <td id="LC2188">                    pvBufferReadArray uInput, baMessage, lMessageSize</td>
        </tr>
        <tr>
          <td id="L2189" data-line-number="2189"></td>
          <td id="LC2189">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2190" data-line-number="2190"></td>
          <td id="LC2190">                    pvTlsHkdfExpandLabel baTemp, .DigestAlgo, .RemoteTrafficSecret, &#34;finished&#34;, baEmpty, .DigestSize</td>
        </tr>
        <tr>
          <td id="L2191" data-line-number="2191"></td>
          <td id="LC2191">                    pvTlsHkdfExtract uVerify.Data, .DigestAlgo, baTemp, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2192" data-line-number="2192"></td>
          <td id="LC2192">                    If Not pvArrayEqual(uVerify.Data, baMessage) Then</td>
        </tr>
        <tr>
          <td id="L2193" data-line-number="2193"></td>
          <td id="LC2193">                        GoTo ServerHandshakeFailed</td>
        </tr>
        <tr>
          <td id="L2194" data-line-number="2194"></td>
          <td id="LC2194">                    End If</td>
        </tr>
        <tr>
          <td id="L2195" data-line-number="2195"></td>
          <td id="LC2195">                    .State = ucsTlsStatePostHandshake</td>
        </tr>
        <tr>
          <td id="L2196" data-line-number="2196"></td>
          <td id="LC2196">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12, TLS_HANDSHAKE_SERVER_KEY_EXCHANGE, -1)</td>
        </tr>
        <tr>
          <td id="L2197" data-line-number="2197"></td>
          <td id="LC2197">                    If uInput.Pos + 4 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2198" data-line-number="2198"></td>
          <td id="LC2198">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2199" data-line-number="2199"></td>
          <td id="LC2199">                    End If</td>
        </tr>
        <tr>
          <td id="L2200" data-line-number="2200"></td>
          <td id="LC2200">                    lSignPos = uInput.Pos</td>
        </tr>
        <tr>
          <td id="L2201" data-line-number="2201"></td>
          <td id="LC2201">                    pvBufferReadLong uInput, lCurveType</td>
        </tr>
        <tr>
          <td id="L2202" data-line-number="2202"></td>
          <td id="LC2202">                    If lCurveType &lt;&gt; 3 Then &#39;--- 3 = named_curve</td>
        </tr>
        <tr>
          <td id="L2203" data-line-number="2203"></td>
          <td id="LC2203">                        GoTo UnsupportedCurveType</td>
        </tr>
        <tr>
          <td id="L2204" data-line-number="2204"></td>
          <td id="LC2204">                    End If</td>
        </tr>
        <tr>
          <td id="L2205" data-line-number="2205"></td>
          <td id="LC2205">                    pvBufferReadLong uInput, lNamedCurve, Size:=2</td>
        </tr>
        <tr>
          <td id="L2206" data-line-number="2206"></td>
          <td id="LC2206">                    pvTlsSetupExchGroup uCtx, lNamedCurve</td>
        </tr>
        <tr>
          <td id="L2207" data-line-number="2207"></td>
          <td id="LC2207">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2208" data-line-number="2208"></td>
          <td id="LC2208">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;With exchange group &#34; &amp; pvTlsGetExchGroupName(.ExchGroup)</td>
        </tr>
        <tr>
          <td id="L2209" data-line-number="2209"></td>
          <td id="LC2209">                    #End If</td>
        </tr>
        <tr>
          <td id="L2210" data-line-number="2210"></td>
          <td id="LC2210">                    pvBufferReadBlockStart uInput, BlockSize:=lSignatureSize</td>
        </tr>
        <tr>
          <td id="L2211" data-line-number="2211"></td>
          <td id="LC2211">                        If uInput.Pos + lSignatureSize &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2212" data-line-number="2212"></td>
          <td id="LC2212">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2213" data-line-number="2213"></td>
          <td id="LC2213">                        End If</td>
        </tr>
        <tr>
          <td id="L2214" data-line-number="2214"></td>
          <td id="LC2214">                        pvBufferReadArray uInput, .RemoteExchPublic, lSignatureSize</td>
        </tr>
        <tr>
          <td id="L2215" data-line-number="2215"></td>
          <td id="LC2215">                        If Not pvTlsCheckRemoteKey(.ExchGroup, .RemoteExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L2216" data-line-number="2216"></td>
          <td id="LC2216">                            GoTo InvalidRemoteKey</td>
        </tr>
        <tr>
          <td id="L2217" data-line-number="2217"></td>
          <td id="LC2217">                        End If</td>
        </tr>
        <tr>
          <td id="L2218" data-line-number="2218"></td>
          <td id="LC2218">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2219" data-line-number="2219"></td>
          <td id="LC2219">                    lSignSize = uInput.Pos - lSignPos</td>
        </tr>
        <tr>
          <td id="L2220" data-line-number="2220"></td>
          <td id="LC2220">                    &#39;--- signature</td>
        </tr>
        <tr>
          <td id="L2221" data-line-number="2221"></td>
          <td id="LC2221">                    If uInput.Pos + 4 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2222" data-line-number="2222"></td>
          <td id="LC2222">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2223" data-line-number="2223"></td>
          <td id="LC2223">                    End If</td>
        </tr>
        <tr>
          <td id="L2224" data-line-number="2224"></td>
          <td id="LC2224">                    pvBufferReadLong uInput, lSignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L2225" data-line-number="2225"></td>
          <td id="LC2225">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSignatureSize</td>
        </tr>
        <tr>
          <td id="L2226" data-line-number="2226"></td>
          <td id="LC2226">                        If uInput.Pos + lSignatureSize &lt;&gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2227" data-line-number="2227"></td>
          <td id="LC2227">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2228" data-line-number="2228"></td>
          <td id="LC2228">                        End If</td>
        </tr>
        <tr>
          <td id="L2229" data-line-number="2229"></td>
          <td id="LC2229">                        pvBufferReadArray uInput, baSignature, lSignatureSize</td>
        </tr>
        <tr>
          <td id="L2230" data-line-number="2230"></td>
          <td id="LC2230">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2231" data-line-number="2231"></td>
          <td id="LC2231">                    If Not SearchCollection(.RemoteCertificates, 1, RetVal:=baCert) Then</td>
        </tr>
        <tr>
          <td id="L2232" data-line-number="2232"></td>
          <td id="LC2232">                        GoTo NoServerCertificate</td>
        </tr>
        <tr>
          <td id="L2233" data-line-number="2233"></td>
          <td id="LC2233">                    End If</td>
        </tr>
        <tr>
          <td id="L2234" data-line-number="2234"></td>
          <td id="LC2234">                    pvBufferWriteArray uVerify, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L2235" data-line-number="2235"></td>
          <td id="LC2235">                    pvBufferWriteArray uVerify, .RemoteExchRandom</td>
        </tr>
        <tr>
          <td id="L2236" data-line-number="2236"></td>
          <td id="LC2236">                    pvBufferWriteBlob uVerify, VarPtr(uInput.Data(lSignPos)), lSignSize</td>
        </tr>
        <tr>
          <td id="L2237" data-line-number="2237"></td>
          <td id="LC2237">                    pvBufferWriteEOF uVerify</td>
        </tr>
        <tr>
          <td id="L2238" data-line-number="2238"></td>
          <td id="LC2238">                    If Not pvTlsSignatureVerify(baCert, lSignatureScheme, uVerify.Data, baSignature, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L2239" data-line-number="2239"></td>
          <td id="LC2239">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L2240" data-line-number="2240"></td>
          <td id="LC2240">                    End If</td>
        </tr>
        <tr>
          <td id="L2241" data-line-number="2241"></td>
          <td id="LC2241">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12, TLS_HANDSHAKE_SERVER_HELLO_DONE, -1)</td>
        </tr>
        <tr>
          <td id="L2242" data-line-number="2242"></td>
          <td id="LC2242">                    .State = ucsTlsStateExpectServerFinished</td>
        </tr>
        <tr>
          <td id="L2243" data-line-number="2243"></td>
          <td id="LC2243">                    uInput.Pos = uInput.Pos + lMessageSize</td>
        </tr>
        <tr>
          <td id="L2244" data-line-number="2244"></td>
          <td id="LC2244">                    Set .RemoteTickets = New Collection</td>
        </tr>
        <tr>
          <td id="L2245" data-line-number="2245"></td>
          <td id="LC2245">                Case TLS_HANDSHAKE_CERTIFICATE_REQUEST</td>
        </tr>
        <tr>
          <td id="L2246" data-line-number="2246"></td>
          <td id="LC2246">                    If Not pvTlsParseHandshakeCertificateRequest(uCtx, uInput, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L2247" data-line-number="2247"></td>
          <td id="LC2247">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L2248" data-line-number="2248"></td>
          <td id="LC2248">                    End If</td>
        </tr>
        <tr>
          <td id="L2249" data-line-number="2249"></td>
          <td id="LC2249">                Case TLS_HANDSHAKE_CERTIFICATE_STATUS</td>
        </tr>
        <tr>
          <td id="L2250" data-line-number="2250"></td>
          <td id="LC2250">                    If uInput.Pos + 1 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2251" data-line-number="2251"></td>
          <td id="LC2251">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2252" data-line-number="2252"></td>
          <td id="LC2252">                    End If</td>
        </tr>
        <tr>
          <td id="L2253" data-line-number="2253"></td>
          <td id="LC2253">                    Set .RemoteCertStatuses = New Collection</td>
        </tr>
        <tr>
          <td id="L2254" data-line-number="2254"></td>
          <td id="LC2254">                    pvBufferReadLong uInput, lStatusType, Size:=1</td>
        </tr>
        <tr>
          <td id="L2255" data-line-number="2255"></td>
          <td id="LC2255">                    If lStatusType = 1 Then &#39;--- ocsp</td>
        </tr>
        <tr>
          <td id="L2256" data-line-number="2256"></td>
          <td id="LC2256">                        If uInput.Pos + 3 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2257" data-line-number="2257"></td>
          <td id="LC2257">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2258" data-line-number="2258"></td>
          <td id="LC2258">                        End If</td>
        </tr>
        <tr>
          <td id="L2259" data-line-number="2259"></td>
          <td id="LC2259">                        pvBufferReadBlockStart uInput, Size:=3, BlockSize:=lCertSize</td>
        </tr>
        <tr>
          <td id="L2260" data-line-number="2260"></td>
          <td id="LC2260">                            If uInput.Pos + lCertSize &lt;&gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2261" data-line-number="2261"></td>
          <td id="LC2261">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2262" data-line-number="2262"></td>
          <td id="LC2262">                            End If</td>
        </tr>
        <tr>
          <td id="L2263" data-line-number="2263"></td>
          <td id="LC2263">                            pvBufferReadArray uInput, baCert, lCertSize</td>
        </tr>
        <tr>
          <td id="L2264" data-line-number="2264"></td>
          <td id="LC2264">                            .RemoteCertStatuses.Add baCert</td>
        </tr>
        <tr>
          <td id="L2265" data-line-number="2265"></td>
          <td id="LC2265">                        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2266" data-line-number="2266"></td>
          <td id="LC2266">                    Else</td>
        </tr>
        <tr>
          <td id="L2267" data-line-number="2267"></td>
          <td id="LC2267">                        #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2268" data-line-number="2268"></td>
          <td id="LC2268">                            DebugLog MODULE_NAME, FUNC_NAME, Replace(&#34;Unknown status_type (%1) in certificate_status&#34;, &#34;%1&#34;, lStatusType)</td>
        </tr>
        <tr>
          <td id="L2269" data-line-number="2269"></td>
          <td id="LC2269">                        #End If</td>
        </tr>
        <tr>
          <td id="L2270" data-line-number="2270"></td>
          <td id="LC2270">                    End If</td>
        </tr>
        <tr>
          <td id="L2271" data-line-number="2271"></td>
          <td id="LC2271">                Case Else</td>
        </tr>
        <tr>
          <td id="L2272" data-line-number="2272"></td>
          <td id="LC2272">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2273" data-line-number="2273"></td>
          <td id="LC2273">                        DebugLog MODULE_NAME, FUNC_NAME, Replace(&#34;Unknown handshake message (%1) during ExpectEncryptedExtensions&#34;, &#34;%1&#34;, pvTlsGetMessageName(lMessageType))</td>
        </tr>
        <tr>
          <td id="L2274" data-line-number="2274"></td>
          <td id="LC2274">                    #End If</td>
        </tr>
        <tr>
          <td id="L2275" data-line-number="2275"></td>
          <td id="LC2275">                    &#39;--- do nothing</td>
        </tr>
        <tr>
          <td id="L2276" data-line-number="2276"></td>
          <td id="LC2276">                    uInput.Pos = uInput.Pos + lMessageSize</td>
        </tr>
        <tr>
          <td id="L2277" data-line-number="2277"></td>
          <td id="LC2277">                End Select</td>
        </tr>
        <tr>
          <td id="L2278" data-line-number="2278"></td>
          <td id="LC2278">                pvTlsAppendHandshakeHash uCtx, uInput.Data, lMessagePos, lMessageSize + 4</td>
        </tr>
        <tr>
          <td id="L2279" data-line-number="2279"></td>
          <td id="LC2279">                &#39;--- post-process ucsTlsStateExpectEncryptedExtensions</td>
        </tr>
        <tr>
          <td id="L2280" data-line-number="2280"></td>
          <td id="LC2280">                If .State = ucsTlsStateExpectServerFinished And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L2281" data-line-number="2281"></td>
          <td id="LC2281">                    If .UseRsaKeyTransport Then</td>
        </tr>
        <tr>
          <td id="L2282" data-line-number="2282"></td>
          <td id="LC2282">                        If Not SearchCollection(.RemoteCertificates, 1, RetVal:=baCert) Then</td>
        </tr>
        <tr>
          <td id="L2283" data-line-number="2283"></td>
          <td id="LC2283">                            GoTo NoServerCertificate</td>
        </tr>
        <tr>
          <td id="L2284" data-line-number="2284"></td>
          <td id="LC2284">                        End If</td>
        </tr>
        <tr>
          <td id="L2285" data-line-number="2285"></td>
          <td id="LC2285">                        pvTlsSetupExchRsaCertificate uCtx, baCert</td>
        </tr>
        <tr>
          <td id="L2286" data-line-number="2286"></td>
          <td id="LC2286">                    End If</td>
        </tr>
        <tr>
          <td id="L2287" data-line-number="2287"></td>
          <td id="LC2287">                    &#39;--- secure renegotiation check</td>
        </tr>
        <tr>
          <td id="L2288" data-line-number="2288"></td>
          <td id="LC2288">                    If pvArraySize(.LocalLegacyVerifyData) &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2289" data-line-number="2289"></td>
          <td id="LC2289">                        If pvArraySize(.RemoteLegacyRenegInfo) &lt;&gt; 2 * TLS_VERIFY_DATA_SIZE Or pvArraySize(.RemoteLegacyVerifyData) &lt;&gt; TLS_VERIFY_DATA_SIZE Then</td>
        </tr>
        <tr>
          <td id="L2290" data-line-number="2290"></td>
          <td id="LC2290">                            GoTo SecureRenegotiationFailed</td>
        </tr>
        <tr>
          <td id="L2291" data-line-number="2291"></td>
          <td id="LC2291">                        ElseIf InStrB(.RemoteLegacyRenegInfo, .LocalLegacyVerifyData) &lt;&gt; 1 Then</td>
        </tr>
        <tr>
          <td id="L2292" data-line-number="2292"></td>
          <td id="LC2292">                            GoTo SecureRenegotiationFailed</td>
        </tr>
        <tr>
          <td id="L2293" data-line-number="2293"></td>
          <td id="LC2293">                        ElseIf InStrB(TLS_VERIFY_DATA_SIZE + 1, .RemoteLegacyRenegInfo, .RemoteLegacyVerifyData) &lt;&gt; TLS_VERIFY_DATA_SIZE + 1 Then</td>
        </tr>
        <tr>
          <td id="L2294" data-line-number="2294"></td>
          <td id="LC2294">                            GoTo SecureRenegotiationFailed</td>
        </tr>
        <tr>
          <td id="L2295" data-line-number="2295"></td>
          <td id="LC2295">                        End If</td>
        </tr>
        <tr>
          <td id="L2296" data-line-number="2296"></td>
          <td id="LC2296">                    End If</td>
        </tr>
        <tr>
          <td id="L2297" data-line-number="2297"></td>
          <td id="LC2297">                    pvTlsBuildClientLegacyKeyExchange uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2298" data-line-number="2298"></td>
          <td id="LC2298">                End If</td>
        </tr>
        <tr>
          <td id="L2299" data-line-number="2299"></td>
          <td id="LC2299">                If .State = ucsTlsStatePostHandshake And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2300" data-line-number="2300"></td>
          <td id="LC2300">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2301" data-line-number="2301"></td>
          <td id="LC2301">                    pvTlsBuildClientHandshakeFinished uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2302" data-line-number="2302"></td>
          <td id="LC2302">                    pvTlsDeriveApplicationSecrets uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2303" data-line-number="2303"></td>
          <td id="LC2303">                    pvTlsResetHandshakeHash uCtx</td>
        </tr>
        <tr>
          <td id="L2304" data-line-number="2304"></td>
          <td id="LC2304">                End If</td>
        </tr>
        <tr>
          <td id="L2305" data-line-number="2305"></td>
          <td id="LC2305">            Case ucsTlsStateExpectServerFinished</td>
        </tr>
        <tr>
          <td id="L2306" data-line-number="2306"></td>
          <td id="LC2306">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2307" data-line-number="2307"></td>
          <td id="LC2307">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12, TLS_HANDSHAKE_NEW_SESSION_TICKET, -1)</td>
        </tr>
        <tr>
          <td id="L2308" data-line-number="2308"></td>
          <td id="LC2308">                    pvBufferReadArray uInput, baMessage, lMessageSize</td>
        </tr>
        <tr>
          <td id="L2309" data-line-number="2309"></td>
          <td id="LC2309">                    If Not .RemoteTickets Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L2310" data-line-number="2310"></td>
          <td id="LC2310">                        .RemoteTickets.Add baMessage</td>
        </tr>
        <tr>
          <td id="L2311" data-line-number="2311"></td>
          <td id="LC2311">                    End If</td>
        </tr>
        <tr>
          <td id="L2312" data-line-number="2312"></td>
          <td id="LC2312">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12, TLS_HANDSHAKE_FINISHED, -1)</td>
        </tr>
        <tr>
          <td id="L2313" data-line-number="2313"></td>
          <td id="LC2313">                    pvBufferReadArray uInput, baMessage, lMessageSize</td>
        </tr>
        <tr>
          <td id="L2314" data-line-number="2314"></td>
          <td id="LC2314">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2315" data-line-number="2315"></td>
          <td id="LC2315">                    pvTlsKdfLegacyPrf uVerify.Data, .DigestAlgo, .MasterSecret, &#34;server finished&#34;, baHandshakeHash, TLS_VERIFY_DATA_SIZE</td>
        </tr>
        <tr>
          <td id="L2316" data-line-number="2316"></td>
          <td id="LC2316">                    If Not pvArrayEqual(uVerify.Data, baMessage) Then</td>
        </tr>
        <tr>
          <td id="L2317" data-line-number="2317"></td>
          <td id="LC2317">                        GoTo ServerHandshakeFailed</td>
        </tr>
        <tr>
          <td id="L2318" data-line-number="2318"></td>
          <td id="LC2318">                    End If</td>
        </tr>
        <tr>
          <td id="L2319" data-line-number="2319"></td>
          <td id="LC2319">                    &#39;--- save for secure renegotiation check</td>
        </tr>
        <tr>
          <td id="L2320" data-line-number="2320"></td>
          <td id="LC2320">                    If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_RENEGOTIATION_INFO) Then</td>
        </tr>
        <tr>
          <td id="L2321" data-line-number="2321"></td>
          <td id="LC2321">                        .RemoteLegacyVerifyData = baMessage</td>
        </tr>
        <tr>
          <td id="L2322" data-line-number="2322"></td>
          <td id="LC2322">                    End If</td>
        </tr>
        <tr>
          <td id="L2323" data-line-number="2323"></td>
          <td id="LC2323">                    .State = ucsTlsStatePostHandshake</td>
        </tr>
        <tr>
          <td id="L2324" data-line-number="2324"></td>
          <td id="LC2324">                Case Else</td>
        </tr>
        <tr>
          <td id="L2325" data-line-number="2325"></td>
          <td id="LC2325">                    GoTo UnexpectedMessageType</td>
        </tr>
        <tr>
          <td id="L2326" data-line-number="2326"></td>
          <td id="LC2326">                End Select</td>
        </tr>
        <tr>
          <td id="L2327" data-line-number="2327"></td>
          <td id="LC2327">                If .State = ucsTlsStatePostHandshake Then</td>
        </tr>
        <tr>
          <td id="L2328" data-line-number="2328"></td>
          <td id="LC2328">                    pvTlsResetHandshakeHash uCtx</td>
        </tr>
        <tr>
          <td id="L2329" data-line-number="2329"></td>
          <td id="LC2329">                Else</td>
        </tr>
        <tr>
          <td id="L2330" data-line-number="2330"></td>
          <td id="LC2330">                    pvTlsAppendHandshakeHash uCtx, uInput.Data, lMessagePos, lMessageSize + 4</td>
        </tr>
        <tr>
          <td id="L2331" data-line-number="2331"></td>
          <td id="LC2331">                End If</td>
        </tr>
        <tr>
          <td id="L2332" data-line-number="2332"></td>
          <td id="LC2332">#If ImplTlsServer Then</td>
        </tr>
        <tr>
          <td id="L2333" data-line-number="2333"></td>
          <td id="LC2333">            Case ucsTlsStateExpectClientHello</td>
        </tr>
        <tr>
          <td id="L2334" data-line-number="2334"></td>
          <td id="LC2334">RenegotiateClientHello:</td>
        </tr>
        <tr>
          <td id="L2335" data-line-number="2335"></td>
          <td id="LC2335">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2336" data-line-number="2336"></td>
          <td id="LC2336">                Case TLS_HANDSHAKE_CLIENT_HELLO</td>
        </tr>
        <tr>
          <td id="L2337" data-line-number="2337"></td>
          <td id="LC2337">                    If Not pvTlsParseHandshakeClientHello(uCtx, uInput, lMessageEnd, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L2338" data-line-number="2338"></td>
          <td id="LC2338">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L2339" data-line-number="2339"></td>
          <td id="LC2339">                    End If</td>
        </tr>
        <tr>
          <td id="L2340" data-line-number="2340"></td>
          <td id="LC2340">                    If uInput.Pos &lt;&gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2341" data-line-number="2341"></td>
          <td id="LC2341">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2342" data-line-number="2342"></td>
          <td id="LC2342">                    End If</td>
        </tr>
        <tr>
          <td id="L2343" data-line-number="2343"></td>
          <td id="LC2343">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2344" data-line-number="2344"></td>
          <td id="LC2344">                        If (.ExchGroup = 0 Or .CipherSuite = 0) Then</td>
        </tr>
        <tr>
          <td id="L2345" data-line-number="2345"></td>
          <td id="LC2345">                            If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2346" data-line-number="2346"></td>
          <td id="LC2346">                                GoTo HelloRetryFailed</td>
        </tr>
        <tr>
          <td id="L2347" data-line-number="2347"></td>
          <td id="LC2347">                            End If</td>
        </tr>
        <tr>
          <td id="L2348" data-line-number="2348"></td>
          <td id="LC2348">                            .HelloRetryRequest = True</td>
        </tr>
        <tr>
          <td id="L2349" data-line-number="2349"></td>
          <td id="LC2349">                            If .ExchGroup &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2350" data-line-number="2350"></td>
          <td id="LC2350">                                .HelloRetryExchGroup = .ExchGroup</td>
        </tr>
        <tr>
          <td id="L2351" data-line-number="2351"></td>
          <td id="LC2351">                            Else</td>
        </tr>
        <tr>
          <td id="L2352" data-line-number="2352"></td>
          <td id="LC2352">                                .HelloRetryExchGroup = pvCollectionFirst(.RemoteSupportedGroups, Array( _</td>
        </tr>
        <tr>
          <td id="L2353" data-line-number="2353"></td>
          <td id="LC2353">                                        IIf(pvCryptoIsSupported(ucsTlsAlgoExchX25519), &#34;#&#34; &amp; TLS_GROUP_X25519, vbNullString), _</td>
        </tr>
        <tr>
          <td id="L2354" data-line-number="2354"></td>
          <td id="LC2354">                                        IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1), &#34;#&#34; &amp; TLS_GROUP_SECP256R1, vbNullString), _</td>
        </tr>
        <tr>
          <td id="L2355" data-line-number="2355"></td>
          <td id="LC2355">                                        IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1), &#34;#&#34; &amp; TLS_GROUP_SECP384R1, vbNullString)))</td>
        </tr>
        <tr>
          <td id="L2356" data-line-number="2356"></td>
          <td id="LC2356">                                If .HelloRetryExchGroup = 0 Then</td>
        </tr>
        <tr>
          <td id="L2357" data-line-number="2357"></td>
          <td id="LC2357">                                    GoTo HelloRetryFailed</td>
        </tr>
        <tr>
          <td id="L2358" data-line-number="2358"></td>
          <td id="LC2358">                                End If</td>
        </tr>
        <tr>
          <td id="L2359" data-line-number="2359"></td>
          <td id="LC2359">                            End If</td>
        </tr>
        <tr>
          <td id="L2360" data-line-number="2360"></td>
          <td id="LC2360">                            If .CipherSuite &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2361" data-line-number="2361"></td>
          <td id="LC2361">                                .HelloRetryCipherSuite = .CipherSuite</td>
        </tr>
        <tr>
          <td id="L2362" data-line-number="2362"></td>
          <td id="LC2362">                            Else</td>
        </tr>
        <tr>
          <td id="L2363" data-line-number="2363"></td>
          <td id="LC2363">                                Select Case True</td>
        </tr>
        <tr>
          <td id="L2364" data-line-number="2364"></td>
          <td id="LC2364">                                Case pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128)</td>
        </tr>
        <tr>
          <td id="L2365" data-line-number="2365"></td>
          <td id="LC2365">                                    .HelloRetryCipherSuite = TLS_CS_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L2366" data-line-number="2366"></td>
          <td id="LC2366">                                Case pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256)</td>
        </tr>
        <tr>
          <td id="L2367" data-line-number="2367"></td>
          <td id="LC2367">                                    .HelloRetryCipherSuite = TLS_CS_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L2368" data-line-number="2368"></td>
          <td id="LC2368">                                Case pvCryptoIsSupported(ucsTlsAlgoBulkChacha20Poly1305)</td>
        </tr>
        <tr>
          <td id="L2369" data-line-number="2369"></td>
          <td id="LC2369">                                    .HelloRetryCipherSuite = TLS_CS_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L2370" data-line-number="2370"></td>
          <td id="LC2370">                                Case Else</td>
        </tr>
        <tr>
          <td id="L2371" data-line-number="2371"></td>
          <td id="LC2371">                                    GoTo HelloRetryFailed</td>
        </tr>
        <tr>
          <td id="L2372" data-line-number="2372"></td>
          <td id="LC2372">                                End Select</td>
        </tr>
        <tr>
          <td id="L2373" data-line-number="2373"></td>
          <td id="LC2373">                            End If</td>
        </tr>
        <tr>
          <td id="L2374" data-line-number="2374"></td>
          <td id="LC2374">                        Else</td>
        </tr>
        <tr>
          <td id="L2375" data-line-number="2375"></td>
          <td id="LC2375">                            .HelloRetryRequest = False</td>
        </tr>
        <tr>
          <td id="L2376" data-line-number="2376"></td>
          <td id="LC2376">                            .State = ucsTlsStateExpectClientFinished</td>
        </tr>
        <tr>
          <td id="L2377" data-line-number="2377"></td>
          <td id="LC2377">                        End If</td>
        </tr>
        <tr>
          <td id="L2378" data-line-number="2378"></td>
          <td id="LC2378">                    ElseIf .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L2379" data-line-number="2379"></td>
          <td id="LC2379">                        If .ExchGroup = 0 Then</td>
        </tr>
        <tr>
          <td id="L2380" data-line-number="2380"></td>
          <td id="LC2380">                            If pvCollectionCount(.RemoteSupportedGroups) = 0 Then</td>
        </tr>
        <tr>
          <td id="L2381" data-line-number="2381"></td>
          <td id="LC2381">                                If pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1) Then</td>
        </tr>
        <tr>
          <td id="L2382" data-line-number="2382"></td>
          <td id="LC2382">                                    lExchGroup = TLS_GROUP_SECP256R1</td>
        </tr>
        <tr>
          <td id="L2383" data-line-number="2383"></td>
          <td id="LC2383">                                End If</td>
        </tr>
        <tr>
          <td id="L2384" data-line-number="2384"></td>
          <td id="LC2384">                            Else</td>
        </tr>
        <tr>
          <td id="L2385" data-line-number="2385"></td>
          <td id="LC2385">                                lExchGroup = pvCollectionFirst(.RemoteSupportedGroups, Array( _</td>
        </tr>
        <tr>
          <td id="L2386" data-line-number="2386"></td>
          <td id="LC2386">                                        IIf(pvCryptoIsSupported(ucsTlsAlgoExchX25519), &#34;#&#34; &amp; TLS_GROUP_X25519, vbNullString), _</td>
        </tr>
        <tr>
          <td id="L2387" data-line-number="2387"></td>
          <td id="LC2387">                                        IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1), &#34;#&#34; &amp; TLS_GROUP_SECP256R1, vbNullString), _</td>
        </tr>
        <tr>
          <td id="L2388" data-line-number="2388"></td>
          <td id="LC2388">                                        IIf(pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1), &#34;#&#34; &amp; TLS_GROUP_SECP384R1, vbNullString)))</td>
        </tr>
        <tr>
          <td id="L2389" data-line-number="2389"></td>
          <td id="LC2389">                            End If</td>
        </tr>
        <tr>
          <td id="L2390" data-line-number="2390"></td>
          <td id="LC2390">                            If lExchGroup = 0 Then</td>
        </tr>
        <tr>
          <td id="L2391" data-line-number="2391"></td>
          <td id="LC2391">                                GoTo NoSupportedGroups</td>
        </tr>
        <tr>
          <td id="L2392" data-line-number="2392"></td>
          <td id="LC2392">                            End If</td>
        </tr>
        <tr>
          <td id="L2393" data-line-number="2393"></td>
          <td id="LC2393">                            pvTlsSetupExchGroup uCtx, lExchGroup</td>
        </tr>
        <tr>
          <td id="L2394" data-line-number="2394"></td>
          <td id="LC2394">                        End If</td>
        </tr>
        <tr>
          <td id="L2395" data-line-number="2395"></td>
          <td id="LC2395">                        .State = ucsTlsStateExpectClientKeyExchange</td>
        </tr>
        <tr>
          <td id="L2396" data-line-number="2396"></td>
          <td id="LC2396">                    End If</td>
        </tr>
        <tr>
          <td id="L2397" data-line-number="2397"></td>
          <td id="LC2397">                Case Else</td>
        </tr>
        <tr>
          <td id="L2398" data-line-number="2398"></td>
          <td id="LC2398">                    GoTo UnexpectedMessageType</td>
        </tr>
        <tr>
          <td id="L2399" data-line-number="2399"></td>
          <td id="LC2399">                End Select</td>
        </tr>
        <tr>
          <td id="L2400" data-line-number="2400"></td>
          <td id="LC2400">                pvTlsAppendHandshakeHash uCtx, uInput.Data, lMessagePos, lMessageSize + 4</td>
        </tr>
        <tr>
          <td id="L2401" data-line-number="2401"></td>
          <td id="LC2401">                &#39;--- post-process ucsTlsStateExpectClientHello</td>
        </tr>
        <tr>
          <td id="L2402" data-line-number="2402"></td>
          <td id="LC2402">                If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2403" data-line-number="2403"></td>
          <td id="LC2403">                    &#39;--- on HelloRetryRequest replace HandshakeMessages w/ &#39;synthetic handshake message&#39;</td>
        </tr>
        <tr>
          <td id="L2404" data-line-number="2404"></td>
          <td id="LC2404">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2405" data-line-number="2405"></td>
          <td id="LC2405">                    .HandshakeMessages.Size = 0</td>
        </tr>
        <tr>
          <td id="L2406" data-line-number="2406"></td>
          <td id="LC2406">                    pvBufferWriteLong .HandshakeMessages, TLS_HANDSHAKE_MESSAGE_HASH</td>
        </tr>
        <tr>
          <td id="L2407" data-line-number="2407"></td>
          <td id="LC2407">                    pvBufferWriteLong .HandshakeMessages, .DigestSize, Size:=3</td>
        </tr>
        <tr>
          <td id="L2408" data-line-number="2408"></td>
          <td id="LC2408">                    pvBufferWriteArray .HandshakeMessages, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2409" data-line-number="2409"></td>
          <td id="LC2409">                End If</td>
        </tr>
        <tr>
          <td id="L2410" data-line-number="2410"></td>
          <td id="LC2410">                pvTlsBuildServerHello uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2411" data-line-number="2411"></td>
          <td id="LC2411">                If .State = ucsTlsStateExpectClientFinished Then</td>
        </tr>
        <tr>
          <td id="L2412" data-line-number="2412"></td>
          <td id="LC2412">                    pvTlsDeriveHandshakeSecrets uCtx</td>
        </tr>
        <tr>
          <td id="L2413" data-line-number="2413"></td>
          <td id="LC2413">                    pvTlsBuildServerHandshakeFinished uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2414" data-line-number="2414"></td>
          <td id="LC2414">                End If</td>
        </tr>
        <tr>
          <td id="L2415" data-line-number="2415"></td>
          <td id="LC2415">                If .State = ucsTlsStateExpectClientKeyExchange Then</td>
        </tr>
        <tr>
          <td id="L2416" data-line-number="2416"></td>
          <td id="LC2416">                    pvTlsBuildServerLegacyKeyExchange uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2417" data-line-number="2417"></td>
          <td id="LC2417">                End If</td>
        </tr>
        <tr>
          <td id="L2418" data-line-number="2418"></td>
          <td id="LC2418">            Case ucsTlsStateExpectClientKeyExchange</td>
        </tr>
        <tr>
          <td id="L2419" data-line-number="2419"></td>
          <td id="LC2419">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2420" data-line-number="2420"></td>
          <td id="LC2420">                Case TLS_HANDSHAKE_CLIENT_KEY_EXCHANGE</td>
        </tr>
        <tr>
          <td id="L2421" data-line-number="2421"></td>
          <td id="LC2421">                    If .UseRsaKeyTransport Then</td>
        </tr>
        <tr>
          <td id="L2422" data-line-number="2422"></td>
          <td id="LC2422">                        If uInput.Pos + 2 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2423" data-line-number="2423"></td>
          <td id="LC2423">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2424" data-line-number="2424"></td>
          <td id="LC2424">                        End If</td>
        </tr>
        <tr>
          <td id="L2425" data-line-number="2425"></td>
          <td id="LC2425">                        pvBufferReadBlockStart uInput, BlockSize:=lBlockSize, Size:=2</td>
        </tr>
        <tr>
          <td id="L2426" data-line-number="2426"></td>
          <td id="LC2426">                            If uInput.Pos + lBlockSize &lt;&gt; lMessageEnd Or lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2427" data-line-number="2427"></td>
          <td id="LC2427">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2428" data-line-number="2428"></td>
          <td id="LC2428">                            End If</td>
        </tr>
        <tr>
          <td id="L2429" data-line-number="2429"></td>
          <td id="LC2429">                            pvBufferReadArray uInput, baTemp, lBlockSize</td>
        </tr>
        <tr>
          <td id="L2430" data-line-number="2430"></td>
          <td id="LC2430">                        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2431" data-line-number="2431"></td>
          <td id="LC2431">                        pvTlsSetupExchRsaPreMasterSecret uCtx, baTemp</td>
        </tr>
        <tr>
          <td id="L2432" data-line-number="2432"></td>
          <td id="LC2432">                    Else</td>
        </tr>
        <tr>
          <td id="L2433" data-line-number="2433"></td>
          <td id="LC2433">                        If uInput.Pos + 1 &gt; lMessageEnd Then</td>
        </tr>
        <tr>
          <td id="L2434" data-line-number="2434"></td>
          <td id="LC2434">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2435" data-line-number="2435"></td>
          <td id="LC2435">                        End If</td>
        </tr>
        <tr>
          <td id="L2436" data-line-number="2436"></td>
          <td id="LC2436">                        pvBufferReadBlockStart uInput, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2437" data-line-number="2437"></td>
          <td id="LC2437">                            If uInput.Pos + lBlockSize &lt;&gt; lMessageEnd Or lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2438" data-line-number="2438"></td>
          <td id="LC2438">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2439" data-line-number="2439"></td>
          <td id="LC2439">                            End If</td>
        </tr>
        <tr>
          <td id="L2440" data-line-number="2440"></td>
          <td id="LC2440">                            pvBufferReadArray uInput, .RemoteExchPublic, lBlockSize</td>
        </tr>
        <tr>
          <td id="L2441" data-line-number="2441"></td>
          <td id="LC2441">                            If Not pvTlsCheckRemoteKey(.ExchGroup, .RemoteExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L2442" data-line-number="2442"></td>
          <td id="LC2442">                                GoTo InvalidRemoteKey</td>
        </tr>
        <tr>
          <td id="L2443" data-line-number="2443"></td>
          <td id="LC2443">                            End If</td>
        </tr>
        <tr>
          <td id="L2444" data-line-number="2444"></td>
          <td id="LC2444">                        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2445" data-line-number="2445"></td>
          <td id="LC2445">                    End If</td>
        </tr>
        <tr>
          <td id="L2446" data-line-number="2446"></td>
          <td id="LC2446">                    .State = ucsTlsStateExpectClientFinished</td>
        </tr>
        <tr>
          <td id="L2447" data-line-number="2447"></td>
          <td id="LC2447">                Case TLS_HANDSHAKE_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L2448" data-line-number="2448"></td>
          <td id="LC2448">                    &#39;--- ToDo: impl</td>
        </tr>
        <tr>
          <td id="L2449" data-line-number="2449"></td>
          <td id="LC2449">                Case Else</td>
        </tr>
        <tr>
          <td id="L2450" data-line-number="2450"></td>
          <td id="LC2450">                    GoTo UnexpectedMessageType</td>
        </tr>
        <tr>
          <td id="L2451" data-line-number="2451"></td>
          <td id="LC2451">                End Select</td>
        </tr>
        <tr>
          <td id="L2452" data-line-number="2452"></td>
          <td id="LC2452">                pvTlsAppendHandshakeHash uCtx, uInput.Data, lMessagePos, lMessageSize + 4</td>
        </tr>
        <tr>
          <td id="L2453" data-line-number="2453"></td>
          <td id="LC2453">                If .State = ucsTlsStateExpectClientFinished Then</td>
        </tr>
        <tr>
          <td id="L2454" data-line-number="2454"></td>
          <td id="LC2454">                    pvTlsDeriveLegacySecrets uCtx</td>
        </tr>
        <tr>
          <td id="L2455" data-line-number="2455"></td>
          <td id="LC2455">                End If</td>
        </tr>
        <tr>
          <td id="L2456" data-line-number="2456"></td>
          <td id="LC2456">            Case ucsTlsStateExpectClientFinished</td>
        </tr>
        <tr>
          <td id="L2457" data-line-number="2457"></td>
          <td id="LC2457">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2458" data-line-number="2458"></td>
          <td id="LC2458">                Case TLS_HANDSHAKE_FINISHED</td>
        </tr>
        <tr>
          <td id="L2459" data-line-number="2459"></td>
          <td id="LC2459">                    If pvArraySize(.RemoteTrafficKey) = 0 Then</td>
        </tr>
        <tr>
          <td id="L2460" data-line-number="2460"></td>
          <td id="LC2460">                        GoTo MissingTrafficKeys</td>
        </tr>
        <tr>
          <td id="L2461" data-line-number="2461"></td>
          <td id="LC2461">                    End If</td>
        </tr>
        <tr>
          <td id="L2462" data-line-number="2462"></td>
          <td id="LC2462">                    pvBufferReadArray uInput, baMessage, lMessageSize</td>
        </tr>
        <tr>
          <td id="L2463" data-line-number="2463"></td>
          <td id="LC2463">                    pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2464" data-line-number="2464"></td>
          <td id="LC2464">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2465" data-line-number="2465"></td>
          <td id="LC2465">                        pvTlsHkdfExpandLabel baTemp, .DigestAlgo, .RemoteTrafficSecret, &#34;finished&#34;, baEmpty, .DigestSize</td>
        </tr>
        <tr>
          <td id="L2466" data-line-number="2466"></td>
          <td id="LC2466">                        pvTlsHkdfExtract uVerify.Data, .DigestAlgo, baTemp, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2467" data-line-number="2467"></td>
          <td id="LC2467">                    Else</td>
        </tr>
        <tr>
          <td id="L2468" data-line-number="2468"></td>
          <td id="LC2468">                        Debug.Assert .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12</td>
        </tr>
        <tr>
          <td id="L2469" data-line-number="2469"></td>
          <td id="LC2469">                        pvTlsKdfLegacyPrf uVerify.Data, .DigestAlgo, .MasterSecret, &#34;client finished&#34;, baHandshakeHash, TLS_VERIFY_DATA_SIZE</td>
        </tr>
        <tr>
          <td id="L2470" data-line-number="2470"></td>
          <td id="LC2470">                        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_RENEGOTIATION_INFO) Then</td>
        </tr>
        <tr>
          <td id="L2471" data-line-number="2471"></td>
          <td id="LC2471">                            .RemoteLegacyVerifyData = uVerify.Data</td>
        </tr>
        <tr>
          <td id="L2472" data-line-number="2472"></td>
          <td id="LC2472">                        End If</td>
        </tr>
        <tr>
          <td id="L2473" data-line-number="2473"></td>
          <td id="LC2473">                    End If</td>
        </tr>
        <tr>
          <td id="L2474" data-line-number="2474"></td>
          <td id="LC2474">                    If Not pvArrayEqual(uVerify.Data, baMessage) Then</td>
        </tr>
        <tr>
          <td id="L2475" data-line-number="2475"></td>
          <td id="LC2475">                        GoTo ServerHandshakeFailed</td>
        </tr>
        <tr>
          <td id="L2476" data-line-number="2476"></td>
          <td id="LC2476">                    End If</td>
        </tr>
        <tr>
          <td id="L2477" data-line-number="2477"></td>
          <td id="LC2477">                    .State = ucsTlsStatePostHandshake</td>
        </tr>
        <tr>
          <td id="L2478" data-line-number="2478"></td>
          <td id="LC2478">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12, TLS_HANDSHAKE_CERTIFICATE_VERIFY, -1)</td>
        </tr>
        <tr>
          <td id="L2479" data-line-number="2479"></td>
          <td id="LC2479">                    &#39;--- ToDo: impl</td>
        </tr>
        <tr>
          <td id="L2480" data-line-number="2480"></td>
          <td id="LC2480">                Case Else</td>
        </tr>
        <tr>
          <td id="L2481" data-line-number="2481"></td>
          <td id="LC2481">                    GoTo UnexpectedMessageType</td>
        </tr>
        <tr>
          <td id="L2482" data-line-number="2482"></td>
          <td id="LC2482">                End Select</td>
        </tr>
        <tr>
          <td id="L2483" data-line-number="2483"></td>
          <td id="LC2483">                If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L2484" data-line-number="2484"></td>
          <td id="LC2484">                    pvTlsAppendHandshakeHash uCtx, uInput.Data, lMessagePos, lMessageSize + 4</td>
        </tr>
        <tr>
          <td id="L2485" data-line-number="2485"></td>
          <td id="LC2485">                End If</td>
        </tr>
        <tr>
          <td id="L2486" data-line-number="2486"></td>
          <td id="LC2486">                &#39;--- post-process ucsTlsStateExpectClientFinished</td>
        </tr>
        <tr>
          <td id="L2487" data-line-number="2487"></td>
          <td id="LC2487">                If .State = ucsTlsStatePostHandshake Then</td>
        </tr>
        <tr>
          <td id="L2488" data-line-number="2488"></td>
          <td id="LC2488">                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2489" data-line-number="2489"></td>
          <td id="LC2489">                        pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2490" data-line-number="2490"></td>
          <td id="LC2490">                        pvTlsDeriveApplicationSecrets uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L2491" data-line-number="2491"></td>
          <td id="LC2491">                        pvTlsResetHandshakeHash uCtx</td>
        </tr>
        <tr>
          <td id="L2492" data-line-number="2492"></td>
          <td id="LC2492">                        Set .RemoteTickets = New Collection</td>
        </tr>
        <tr>
          <td id="L2493" data-line-number="2493"></td>
          <td id="LC2493">                    Else</td>
        </tr>
        <tr>
          <td id="L2494" data-line-number="2494"></td>
          <td id="LC2494">                        Debug.Assert .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12</td>
        </tr>
        <tr>
          <td id="L2495" data-line-number="2495"></td>
          <td id="LC2495">                        pvTlsBuildServerLegacyFinished uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2496" data-line-number="2496"></td>
          <td id="LC2496">                        pvTlsResetHandshakeHash uCtx</td>
        </tr>
        <tr>
          <td id="L2497" data-line-number="2497"></td>
          <td id="LC2497">                    End If</td>
        </tr>
        <tr>
          <td id="L2498" data-line-number="2498"></td>
          <td id="LC2498">                End If</td>
        </tr>
        <tr>
          <td id="L2499" data-line-number="2499"></td>
          <td id="LC2499">#End If</td>
        </tr>
        <tr>
          <td id="L2500" data-line-number="2500"></td>
          <td id="LC2500">            Case ucsTlsStatePostHandshake</td>
        </tr>
        <tr>
          <td id="L2501" data-line-number="2501"></td>
          <td id="LC2501">                Select Case lMessageType</td>
        </tr>
        <tr>
          <td id="L2502" data-line-number="2502"></td>
          <td id="LC2502">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 And Not .IsServer, TLS_HANDSHAKE_HELLO_REQUEST, -1)</td>
        </tr>
        <tr>
          <td id="L2503" data-line-number="2503"></td>
          <td id="LC2503">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2504" data-line-number="2504"></td>
          <td id="LC2504">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;Received Hello Request. Will renegotiate&#34;</td>
        </tr>
        <tr>
          <td id="L2505" data-line-number="2505"></td>
          <td id="LC2505">                    #End If</td>
        </tr>
        <tr>
          <td id="L2506" data-line-number="2506"></td>
          <td id="LC2506">                    If lMessageSize &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2507" data-line-number="2507"></td>
          <td id="LC2507">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2508" data-line-number="2508"></td>
          <td id="LC2508">                    End If</td>
        </tr>
        <tr>
          <td id="L2509" data-line-number="2509"></td>
          <td id="LC2509">                    .State = ucsTlsStateExpectServerHello</td>
        </tr>
        <tr>
          <td id="L2510" data-line-number="2510"></td>
          <td id="LC2510">                    .AlpnNegotiated = vbNullString</td>
        </tr>
        <tr>
          <td id="L2511" data-line-number="2511"></td>
          <td id="LC2511">                    .SniRequested = vbNullString</td>
        </tr>
        <tr>
          <td id="L2512" data-line-number="2512"></td>
          <td id="LC2512">                    &#39;--- renegotiate ephemeral keys too</td>
        </tr>
        <tr>
          <td id="L2513" data-line-number="2513"></td>
          <td id="LC2513">                    .ExchGroup = 0</td>
        </tr>
        <tr>
          <td id="L2514" data-line-number="2514"></td>
          <td id="LC2514">                    .CipherSuite = 0</td>
        </tr>
        <tr>
          <td id="L2515" data-line-number="2515"></td>
          <td id="LC2515">                    .SignatureScheme = 0</td>
        </tr>
        <tr>
          <td id="L2516" data-line-number="2516"></td>
          <td id="LC2516">                    .PrevRecordType = 0</td>
        </tr>
        <tr>
          <td id="L2517" data-line-number="2517"></td>
          <td id="LC2517">                    pvTlsBuildClientHello uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2518" data-line-number="2518"></td>
          <td id="LC2518">#If ImplTlsServer Then</td>
        </tr>
        <tr>
          <td id="L2519" data-line-number="2519"></td>
          <td id="LC2519">                Case IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 And .IsServer, TLS_HANDSHAKE_CLIENT_HELLO, -1)</td>
        </tr>
        <tr>
          <td id="L2520" data-line-number="2520"></td>
          <td id="LC2520">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2521" data-line-number="2521"></td>
          <td id="LC2521">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;Received Client Hello. Will renegotiate&#34;</td>
        </tr>
        <tr>
          <td id="L2522" data-line-number="2522"></td>
          <td id="LC2522">                    #End If</td>
        </tr>
        <tr>
          <td id="L2523" data-line-number="2523"></td>
          <td id="LC2523">                    #If Not ImplTlsServerAllowInsecureRenegotiation Then</td>
        </tr>
        <tr>
          <td id="L2524" data-line-number="2524"></td>
          <td id="LC2524">                        If pvArraySize(.RemoteLegacyVerifyData) = 0 Then</td>
        </tr>
        <tr>
          <td id="L2525" data-line-number="2525"></td>
          <td id="LC2525">                            GoTo SecureRenegotiationFailed</td>
        </tr>
        <tr>
          <td id="L2526" data-line-number="2526"></td>
          <td id="LC2526">                        End If</td>
        </tr>
        <tr>
          <td id="L2527" data-line-number="2527"></td>
          <td id="LC2527">                    #End If</td>
        </tr>
        <tr>
          <td id="L2528" data-line-number="2528"></td>
          <td id="LC2528">                    .State = ucsTlsStateExpectClientHello</td>
        </tr>
        <tr>
          <td id="L2529" data-line-number="2529"></td>
          <td id="LC2529">                    .AlpnNegotiated = vbNullString</td>
        </tr>
        <tr>
          <td id="L2530" data-line-number="2530"></td>
          <td id="LC2530">                    .SniRequested = vbNullString</td>
        </tr>
        <tr>
          <td id="L2531" data-line-number="2531"></td>
          <td id="LC2531">                    &#39;--- renegotiate ephemeral keys too</td>
        </tr>
        <tr>
          <td id="L2532" data-line-number="2532"></td>
          <td id="LC2532">                    .ExchGroup = 0</td>
        </tr>
        <tr>
          <td id="L2533" data-line-number="2533"></td>
          <td id="LC2533">                    .CipherSuite = 0</td>
        </tr>
        <tr>
          <td id="L2534" data-line-number="2534"></td>
          <td id="LC2534">                    .SignatureScheme = 0</td>
        </tr>
        <tr>
          <td id="L2535" data-line-number="2535"></td>
          <td id="LC2535">                    .PrevRecordType = 0</td>
        </tr>
        <tr>
          <td id="L2536" data-line-number="2536"></td>
          <td id="LC2536">                    GoTo RenegotiateClientHello</td>
        </tr>
        <tr>
          <td id="L2537" data-line-number="2537"></td>
          <td id="LC2537">#End If</td>
        </tr>
        <tr>
          <td id="L2538" data-line-number="2538"></td>
          <td id="LC2538">                Case TLS_HANDSHAKE_NEW_SESSION_TICKET</td>
        </tr>
        <tr>
          <td id="L2539" data-line-number="2539"></td>
          <td id="LC2539">                    pvBufferReadArray uInput, baMessage, lMessageSize</td>
        </tr>
        <tr>
          <td id="L2540" data-line-number="2540"></td>
          <td id="LC2540">                    If Not .RemoteTickets Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L2541" data-line-number="2541"></td>
          <td id="LC2541">                        .RemoteTickets.Add baMessage</td>
        </tr>
        <tr>
          <td id="L2542" data-line-number="2542"></td>
          <td id="LC2542">                    End If</td>
        </tr>
        <tr>
          <td id="L2543" data-line-number="2543"></td>
          <td id="LC2543">                Case TLS_HANDSHAKE_KEY_UPDATE</td>
        </tr>
        <tr>
          <td id="L2544" data-line-number="2544"></td>
          <td id="LC2544">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2545" data-line-number="2545"></td>
          <td id="LC2545">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;Received TLS_HANDSHAKE_KEY_UPDATE&#34;</td>
        </tr>
        <tr>
          <td id="L2546" data-line-number="2546"></td>
          <td id="LC2546">                    #End If</td>
        </tr>
        <tr>
          <td id="L2547" data-line-number="2547"></td>
          <td id="LC2547">                    If lMessageSize &lt;&gt; 1 Then</td>
        </tr>
        <tr>
          <td id="L2548" data-line-number="2548"></td>
          <td id="LC2548">                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2549" data-line-number="2549"></td>
          <td id="LC2549">                    End If</td>
        </tr>
        <tr>
          <td id="L2550" data-line-number="2550"></td>
          <td id="LC2550">                    pvBufferReadLong uInput, lRequestUpdate</td>
        </tr>
        <tr>
          <td id="L2551" data-line-number="2551"></td>
          <td id="LC2551">                    If lRequestUpdate &lt;&gt; 0 And lRequestUpdate &lt;&gt; 1 Then</td>
        </tr>
        <tr>
          <td id="L2552" data-line-number="2552"></td>
          <td id="LC2552">                        GoTo UnsupportedRequestUpdate</td>
        </tr>
        <tr>
          <td id="L2553" data-line-number="2553"></td>
          <td id="LC2553">                    End If</td>
        </tr>
        <tr>
          <td id="L2554" data-line-number="2554"></td>
          <td id="LC2554">                    If lRequestUpdate &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2555" data-line-number="2555"></td>
          <td id="LC2555">                        &#39;--- ack by TLS_HANDSHAKE_KEY_UPDATE w/ update_not_requested(0)</td>
        </tr>
        <tr>
          <td id="L2556" data-line-number="2556"></td>
          <td id="LC2556">                        pvArrayByte baTemp, TLS_HANDSHAKE_KEY_UPDATE, 0, 0, 1, 0</td>
        </tr>
        <tr>
          <td id="L2557" data-line-number="2557"></td>
          <td id="LC2557">                        pvTlsBuildApplicationData uCtx, .SendBuffer, baTemp, 0, UBound(baTemp) + 1, TLS_CONTENT_TYPE_HANDSHAKE</td>
        </tr>
        <tr>
          <td id="L2558" data-line-number="2558"></td>
          <td id="LC2558">                    End If</td>
        </tr>
        <tr>
          <td id="L2559" data-line-number="2559"></td>
          <td id="LC2559">                    pvTlsDeriveKeyUpdate uCtx, lRequestUpdate &lt;&gt; 0</td>
        </tr>
        <tr>
          <td id="L2560" data-line-number="2560"></td>
          <td id="LC2560">                Case TLS_HANDSHAKE_CERTIFICATE_REQUEST</td>
        </tr>
        <tr>
          <td id="L2561" data-line-number="2561"></td>
          <td id="LC2561">                    If Not pvTlsParseHandshakeCertificateRequest(uCtx, uInput, sError, eAlertCode) Then</td>
        </tr>
        <tr>
          <td id="L2562" data-line-number="2562"></td>
          <td id="LC2562">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L2563" data-line-number="2563"></td>
          <td id="LC2563">                    End If</td>
        </tr>
        <tr>
          <td id="L2564" data-line-number="2564"></td>
          <td id="LC2564">                    pvTlsBuildClientHandshakeFinished uCtx, .SendBuffer</td>
        </tr>
        <tr>
          <td id="L2565" data-line-number="2565"></td>
          <td id="LC2565">                    pvTlsResetHandshakeHash uCtx</td>
        </tr>
        <tr>
          <td id="L2566" data-line-number="2566"></td>
          <td id="LC2566">                Case Else</td>
        </tr>
        <tr>
          <td id="L2567" data-line-number="2567"></td>
          <td id="LC2567">                    GoTo UnexpectedMessageType</td>
        </tr>
        <tr>
          <td id="L2568" data-line-number="2568"></td>
          <td id="LC2568">                End Select</td>
        </tr>
        <tr>
          <td id="L2569" data-line-number="2569"></td>
          <td id="LC2569">            Case Else</td>
        </tr>
        <tr>
          <td id="L2570" data-line-number="2570"></td>
          <td id="LC2570">                GoTo InvalidStateHandshake</td>
        </tr>
        <tr>
          <td id="L2571" data-line-number="2571"></td>
          <td id="LC2571">            End Select</td>
        </tr>
        <tr>
          <td id="L2572" data-line-number="2572"></td>
          <td id="LC2572">        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2573" data-line-number="2573"></td>
          <td id="LC2573">    Loop</td>
        </tr>
        <tr>
          <td id="L2574" data-line-number="2574"></td>
          <td id="LC2574">    End With</td>
        </tr>
        <tr>
          <td id="L2575" data-line-number="2575"></td>
          <td id="LC2575">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L2576" data-line-number="2576"></td>
          <td id="LC2576">    pvTlsParseHandshake = True</td>
        </tr>
        <tr>
          <td id="L2577" data-line-number="2577"></td>
          <td id="LC2577">QH:</td>
        </tr>
        <tr>
          <td id="L2578" data-line-number="2578"></td>
          <td id="LC2578">    Exit Function</td>
        </tr>
        <tr>
          <td id="L2579" data-line-number="2579"></td>
          <td id="LC2579">UnexpectedMessageType:</td>
        </tr>
        <tr>
          <td id="L2580" data-line-number="2580"></td>
          <td id="LC2580">    sError = Replace(Replace(ERR_UNEXPECTED_MSG_TYPE, &#34;%1&#34;, pvTlsGetStateAsText(uCtx.State)), &#34;%2&#34;, pvTlsGetMessageName(lMessageType))</td>
        </tr>
        <tr>
          <td id="L2581" data-line-number="2581"></td>
          <td id="LC2581">    eAlertCode = uscTlsAlertUnexpectedMessage</td>
        </tr>
        <tr>
          <td id="L2582" data-line-number="2582"></td>
          <td id="LC2582">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2583" data-line-number="2583"></td>
          <td id="LC2583">ServerHandshakeFailed:</td>
        </tr>
        <tr>
          <td id="L2584" data-line-number="2584"></td>
          <td id="LC2584">    sError = ERR_SERVER_HANDSHAKE_FAILED</td>
        </tr>
        <tr>
          <td id="L2585" data-line-number="2585"></td>
          <td id="LC2585">    eAlertCode = IIf(pvArraySize(uVerify.Data) &lt;&gt; pvArraySize(baMessage), uscTlsAlertDecodeError, uscTlsAlertDecryptError)</td>
        </tr>
        <tr>
          <td id="L2586" data-line-number="2586"></td>
          <td id="LC2586">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2587" data-line-number="2587"></td>
          <td id="LC2587">HelloRetryFailed:</td>
        </tr>
        <tr>
          <td id="L2588" data-line-number="2588"></td>
          <td id="LC2588">    sError = ERR_HELLO_RETRY_FAILED</td>
        </tr>
        <tr>
          <td id="L2589" data-line-number="2589"></td>
          <td id="LC2589">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L2590" data-line-number="2590"></td>
          <td id="LC2590">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2591" data-line-number="2591"></td>
          <td id="LC2591">NoServerCertificate:</td>
        </tr>
        <tr>
          <td id="L2592" data-line-number="2592"></td>
          <td id="LC2592">    sError = ERR_NO_SERVER_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L2593" data-line-number="2593"></td>
          <td id="LC2593">    eAlertCode = uscTlsAlertCertificateUnknown</td>
        </tr>
        <tr>
          <td id="L2594" data-line-number="2594"></td>
          <td id="LC2594">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2595" data-line-number="2595"></td>
          <td id="LC2595">InvalidSize:</td>
        </tr>
        <tr>
          <td id="L2596" data-line-number="2596"></td>
          <td id="LC2596">    sError = IIf(lExtType &lt; 0, ERR_INVALID_SIZE, Replace(ERR_INVALID_SIZE_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType)))</td>
        </tr>
        <tr>
          <td id="L2597" data-line-number="2597"></td>
          <td id="LC2597">    eAlertCode = uscTlsAlertDecodeError</td>
        </tr>
        <tr>
          <td id="L2598" data-line-number="2598"></td>
          <td id="LC2598">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2599" data-line-number="2599"></td>
          <td id="LC2599">UnsupportedCurveType:</td>
        </tr>
        <tr>
          <td id="L2600" data-line-number="2600"></td>
          <td id="LC2600">    sError = Replace(ERR_UNSUPPORTED_CURVE_TYPE, &#34;%1&#34;, lCurveType)</td>
        </tr>
        <tr>
          <td id="L2601" data-line-number="2601"></td>
          <td id="LC2601">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L2602" data-line-number="2602"></td>
          <td id="LC2602">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2603" data-line-number="2603"></td>
          <td id="LC2603">InvalidStateHandshake:</td>
        </tr>
        <tr>
          <td id="L2604" data-line-number="2604"></td>
          <td id="LC2604">    sError = Replace(ERR_INVALID_STATE_HANDSHAKE, &#34;%1&#34;, pvTlsGetStateAsText(uCtx.State))</td>
        </tr>
        <tr>
          <td id="L2605" data-line-number="2605"></td>
          <td id="LC2605">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L2606" data-line-number="2606"></td>
          <td id="LC2606">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2607" data-line-number="2607"></td>
          <td id="LC2607">SecureRenegotiationFailed:</td>
        </tr>
        <tr>
          <td id="L2608" data-line-number="2608"></td>
          <td id="LC2608">    sError = ERR_SECURE_RENEGOTIATION_FAILED</td>
        </tr>
        <tr>
          <td id="L2609" data-line-number="2609"></td>
          <td id="LC2609">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L2610" data-line-number="2610"></td>
          <td id="LC2610">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2611" data-line-number="2611"></td>
          <td id="LC2611">InvalidRemoteKey:</td>
        </tr>
        <tr>
          <td id="L2612" data-line-number="2612"></td>
          <td id="LC2612">    sError = ERR_INVALID_REMOTE_KEY</td>
        </tr>
        <tr>
          <td id="L2613" data-line-number="2613"></td>
          <td id="LC2613">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L2614" data-line-number="2614"></td>
          <td id="LC2614">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2615" data-line-number="2615"></td>
          <td id="LC2615">NoSupportedGroups:</td>
        </tr>
        <tr>
          <td id="L2616" data-line-number="2616"></td>
          <td id="LC2616">    sError = ERR_NO_SUPPORTED_GROUPS</td>
        </tr>
        <tr>
          <td id="L2617" data-line-number="2617"></td>
          <td id="LC2617">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L2618" data-line-number="2618"></td>
          <td id="LC2618">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2619" data-line-number="2619"></td>
          <td id="LC2619">UnsupportedRequestUpdate:</td>
        </tr>
        <tr>
          <td id="L2620" data-line-number="2620"></td>
          <td id="LC2620">    sError = Replace(ERR_UNSUPPORTED_REQUEST_UPDATE, &#34;%1&#34;, lRequestUpdate)</td>
        </tr>
        <tr>
          <td id="L2621" data-line-number="2621"></td>
          <td id="LC2621">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L2622" data-line-number="2622"></td>
          <td id="LC2622">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2623" data-line-number="2623"></td>
          <td id="LC2623">MissingTrafficKeys:</td>
        </tr>
        <tr>
          <td id="L2624" data-line-number="2624"></td>
          <td id="LC2624">    sError = ERR_MISSING_TRAFFIC_KEYS</td>
        </tr>
        <tr>
          <td id="L2625" data-line-number="2625"></td>
          <td id="LC2625">    eAlertCode = uscTlsAlertUnexpectedMessage</td>
        </tr>
        <tr>
          <td id="L2626" data-line-number="2626"></td>
          <td id="LC2626">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2627" data-line-number="2627"></td>
          <td id="LC2627">EH:</td>
        </tr>
        <tr>
          <td id="L2628" data-line-number="2628"></td>
          <td id="LC2628">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L2629" data-line-number="2629"></td>
          <td id="LC2629">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L2630" data-line-number="2630"></td>
          <td id="LC2630">    Resume QH</td>
        </tr>
        <tr>
          <td id="L2631" data-line-number="2631"></td>
          <td id="LC2631">End Function</td>
        </tr>
        <tr>
          <td id="L2632" data-line-number="2632"></td>
          <td id="LC2632">
</td>
        </tr>
        <tr>
          <td id="L2633" data-line-number="2633"></td>
          <td id="LC2633">Private Function pvTlsParseHandshakeServerHello(uCtx As UcsTlsContext, uInput As UcsBuffer, ByVal lInputEnd As Long, ByVal lRecordProtocol As Long, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L2634" data-line-number="2634"></td>
          <td id="LC2634">    Const FUNC_NAME     As String = &#34;pvTlsParseHandshakeServerHello&#34;</td>
        </tr>
        <tr>
          <td id="L2635" data-line-number="2635"></td>
          <td id="LC2635">    Dim lBlockSize      As Long</td>
        </tr>
        <tr>
          <td id="L2636" data-line-number="2636"></td>
          <td id="LC2636">    Dim lBlockEnd       As Long</td>
        </tr>
        <tr>
          <td id="L2637" data-line-number="2637"></td>
          <td id="LC2637">    Dim lCipherSuite    As Long</td>
        </tr>
        <tr>
          <td id="L2638" data-line-number="2638"></td>
          <td id="LC2638">    Dim lLegacyCompress As Long</td>
        </tr>
        <tr>
          <td id="L2639" data-line-number="2639"></td>
          <td id="LC2639">    Dim lExtType        As Long</td>
        </tr>
        <tr>
          <td id="L2640" data-line-number="2640"></td>
          <td id="LC2640">    Dim lExtSize        As Long</td>
        </tr>
        <tr>
          <td id="L2641" data-line-number="2641"></td>
          <td id="LC2641">    Dim lExtEnd         As Long</td>
        </tr>
        <tr>
          <td id="L2642" data-line-number="2642"></td>
          <td id="LC2642">    Dim lExchGroup      As Long</td>
        </tr>
        <tr>
          <td id="L2643" data-line-number="2643"></td>
          <td id="LC2643">    Dim lPublicSize     As Long</td>
        </tr>
        <tr>
          <td id="L2644" data-line-number="2644"></td>
          <td id="LC2644">    Dim lNameSize       As Long</td>
        </tr>
        <tr>
          <td id="L2645" data-line-number="2645"></td>
          <td id="LC2645">    Dim lCookieSize     As Long</td>
        </tr>
        <tr>
          <td id="L2646" data-line-number="2646"></td>
          <td id="LC2646">    </td>
        </tr>
        <tr>
          <td id="L2647" data-line-number="2647"></td>
          <td id="LC2647">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L2648" data-line-number="2648"></td>
          <td id="LC2648">    lExtType = -1</td>
        </tr>
        <tr>
          <td id="L2649" data-line-number="2649"></td>
          <td id="LC2649">    If pvArraySize(m_baHelloRetryRandom) = 0 Then</td>
        </tr>
        <tr>
          <td id="L2650" data-line-number="2650"></td>
          <td id="LC2650">        pvTlsGetHelloRetryRandom m_baHelloRetryRandom</td>
        </tr>
        <tr>
          <td id="L2651" data-line-number="2651"></td>
          <td id="LC2651">    End If</td>
        </tr>
        <tr>
          <td id="L2652" data-line-number="2652"></td>
          <td id="LC2652">    With uCtx</td>
        </tr>
        <tr>
          <td id="L2653" data-line-number="2653"></td>
          <td id="LC2653">        .ProtocolVersion = IIf(lRecordProtocol &lt;= TLS_PROTOCOL_VERSION_TLS12, TLS_PROTOCOL_VERSION_TLS12, TLS_PROTOCOL_VERSION_TLS13)</td>
        </tr>
        <tr>
          <td id="L2654" data-line-number="2654"></td>
          <td id="LC2654">        pvBufferReadLong uInput, .RemoteProtocolVersion, Size:=2</td>
        </tr>
        <tr>
          <td id="L2655" data-line-number="2655"></td>
          <td id="LC2655">        pvBufferReadArray uInput, .RemoteExchRandom, TLS_HELLO_RANDOM_SIZE</td>
        </tr>
        <tr>
          <td id="L2656" data-line-number="2656"></td>
          <td id="LC2656">        If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2657" data-line-number="2657"></td>
          <td id="LC2657">            &#39;--- clear HelloRetryRequest</td>
        </tr>
        <tr>
          <td id="L2658" data-line-number="2658"></td>
          <td id="LC2658">            .HelloRetryRequest = False</td>
        </tr>
        <tr>
          <td id="L2659" data-line-number="2659"></td>
          <td id="LC2659">            .HelloRetryCipherSuite = 0</td>
        </tr>
        <tr>
          <td id="L2660" data-line-number="2660"></td>
          <td id="LC2660">            .HelloRetryExchGroup = 0</td>
        </tr>
        <tr>
          <td id="L2661" data-line-number="2661"></td>
          <td id="LC2661">            Erase .HelloRetryCookie</td>
        </tr>
        <tr>
          <td id="L2662" data-line-number="2662"></td>
          <td id="LC2662">        Else</td>
        </tr>
        <tr>
          <td id="L2663" data-line-number="2663"></td>
          <td id="LC2663">            .HelloRetryRequest = (StrConv(.RemoteExchRandom, vbUnicode) = StrConv(m_baHelloRetryRandom, vbUnicode))</td>
        </tr>
        <tr>
          <td id="L2664" data-line-number="2664"></td>
          <td id="LC2664">        End If</td>
        </tr>
        <tr>
          <td id="L2665" data-line-number="2665"></td>
          <td id="LC2665">        pvBufferReadBlockStart uInput, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2666" data-line-number="2666"></td>
          <td id="LC2666">            pvBufferReadArray uInput, .RemoteSessionID, lBlockSize</td>
        </tr>
        <tr>
          <td id="L2667" data-line-number="2667"></td>
          <td id="LC2667">        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2668" data-line-number="2668"></td>
          <td id="LC2668">        pvBufferReadLong uInput, lCipherSuite, Size:=2</td>
        </tr>
        <tr>
          <td id="L2669" data-line-number="2669"></td>
          <td id="LC2669">        pvTlsSetupCipherSuite uCtx, lCipherSuite</td>
        </tr>
        <tr>
          <td id="L2670" data-line-number="2670"></td>
          <td id="LC2670">        #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2671" data-line-number="2671"></td>
          <td id="LC2671">            DebugLog MODULE_NAME, FUNC_NAME, &#34;Using &#34; &amp; pvTlsGetCipherSuiteName(.CipherSuite) &amp; &#34; from &#34; &amp; .RemoteHostName</td>
        </tr>
        <tr>
          <td id="L2672" data-line-number="2672"></td>
          <td id="LC2672">        #End If</td>
        </tr>
        <tr>
          <td id="L2673" data-line-number="2673"></td>
          <td id="LC2673">        If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2674" data-line-number="2674"></td>
          <td id="LC2674">            .HelloRetryCipherSuite = lCipherSuite</td>
        </tr>
        <tr>
          <td id="L2675" data-line-number="2675"></td>
          <td id="LC2675">        End If</td>
        </tr>
        <tr>
          <td id="L2676" data-line-number="2676"></td>
          <td id="LC2676">        pvBufferReadLong uInput, lLegacyCompress</td>
        </tr>
        <tr>
          <td id="L2677" data-line-number="2677"></td>
          <td id="LC2677">        Debug.Assert lLegacyCompress = 0</td>
        </tr>
        <tr>
          <td id="L2678" data-line-number="2678"></td>
          <td id="LC2678">        Set .RemoteExtensions = New Collection</td>
        </tr>
        <tr>
          <td id="L2679" data-line-number="2679"></td>
          <td id="LC2679">        If uInput.Pos &lt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2680" data-line-number="2680"></td>
          <td id="LC2680">            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2681" data-line-number="2681"></td>
          <td id="LC2681">                lBlockEnd = uInput.Pos + lBlockSize</td>
        </tr>
        <tr>
          <td id="L2682" data-line-number="2682"></td>
          <td id="LC2682">                Do While uInput.Pos + 3 &lt; lBlockEnd</td>
        </tr>
        <tr>
          <td id="L2683" data-line-number="2683"></td>
          <td id="LC2683">                    pvBufferReadLong uInput, lExtType, Size:=2</td>
        </tr>
        <tr>
          <td id="L2684" data-line-number="2684"></td>
          <td id="LC2684">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2685" data-line-number="2685"></td>
          <td id="LC2685">&#39;                        DebugLog MODULE_NAME, FUNC_NAME, &#34;ServerHello &#34; &amp; pvTlsGetExtensionName(lExtType)</td>
        </tr>
        <tr>
          <td id="L2686" data-line-number="2686"></td>
          <td id="LC2686">                    #End If</td>
        </tr>
        <tr>
          <td id="L2687" data-line-number="2687"></td>
          <td id="LC2687">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lExtSize</td>
        </tr>
        <tr>
          <td id="L2688" data-line-number="2688"></td>
          <td id="LC2688">                        lExtEnd = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2689" data-line-number="2689"></td>
          <td id="LC2689">                        If lExtEnd &gt; lBlockEnd Then</td>
        </tr>
        <tr>
          <td id="L2690" data-line-number="2690"></td>
          <td id="LC2690">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2691" data-line-number="2691"></td>
          <td id="LC2691">                        End If</td>
        </tr>
        <tr>
          <td id="L2692" data-line-number="2692"></td>
          <td id="LC2692">                        Select Case lExtType</td>
        </tr>
        <tr>
          <td id="L2693" data-line-number="2693"></td>
          <td id="LC2693">                        Case IIf((.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0, TLS_EXTENSION_KEY_SHARE, -1)</td>
        </tr>
        <tr>
          <td id="L2694" data-line-number="2694"></td>
          <td id="LC2694">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2695" data-line-number="2695"></td>
          <td id="LC2695">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2696" data-line-number="2696"></td>
          <td id="LC2696">                            End If</td>
        </tr>
        <tr>
          <td id="L2697" data-line-number="2697"></td>
          <td id="LC2697">                            pvBufferReadLong uInput, lExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L2698" data-line-number="2698"></td>
          <td id="LC2698">                            pvTlsSetupExchGroup uCtx, lExchGroup</td>
        </tr>
        <tr>
          <td id="L2699" data-line-number="2699"></td>
          <td id="LC2699">                            If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2700" data-line-number="2700"></td>
          <td id="LC2700">                                .HelloRetryExchGroup = lExchGroup</td>
        </tr>
        <tr>
          <td id="L2701" data-line-number="2701"></td>
          <td id="LC2701">                            Else</td>
        </tr>
        <tr>
          <td id="L2702" data-line-number="2702"></td>
          <td id="LC2702">                                #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2703" data-line-number="2703"></td>
          <td id="LC2703">                                    DebugLog MODULE_NAME, FUNC_NAME, &#34;With exchange group &#34; &amp; pvTlsGetExchGroupName(.ExchGroup)</td>
        </tr>
        <tr>
          <td id="L2704" data-line-number="2704"></td>
          <td id="LC2704">                                #End If</td>
        </tr>
        <tr>
          <td id="L2705" data-line-number="2705"></td>
          <td id="LC2705">                                If lExtSize &lt; 4 Then</td>
        </tr>
        <tr>
          <td id="L2706" data-line-number="2706"></td>
          <td id="LC2706">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2707" data-line-number="2707"></td>
          <td id="LC2707">                                End If</td>
        </tr>
        <tr>
          <td id="L2708" data-line-number="2708"></td>
          <td id="LC2708">                                pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lPublicSize</td>
        </tr>
        <tr>
          <td id="L2709" data-line-number="2709"></td>
          <td id="LC2709">                                    If uInput.Pos + lPublicSize &lt;&gt; lExtEnd Or lPublicSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2710" data-line-number="2710"></td>
          <td id="LC2710">                                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2711" data-line-number="2711"></td>
          <td id="LC2711">                                    End If</td>
        </tr>
        <tr>
          <td id="L2712" data-line-number="2712"></td>
          <td id="LC2712">                                    pvBufferReadArray uInput, .RemoteExchPublic, lPublicSize</td>
        </tr>
        <tr>
          <td id="L2713" data-line-number="2713"></td>
          <td id="LC2713">                                    If Not pvTlsCheckRemoteKey(.ExchGroup, .RemoteExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L2714" data-line-number="2714"></td>
          <td id="LC2714">                                        GoTo InvalidRemoteKey</td>
        </tr>
        <tr>
          <td id="L2715" data-line-number="2715"></td>
          <td id="LC2715">                                    End If</td>
        </tr>
        <tr>
          <td id="L2716" data-line-number="2716"></td>
          <td id="LC2716">                                pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2717" data-line-number="2717"></td>
          <td id="LC2717">                            End If</td>
        </tr>
        <tr>
          <td id="L2718" data-line-number="2718"></td>
          <td id="LC2718">                        Case IIf((.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0, TLS_EXTENSION_SUPPORTED_VERSIONS, -1)</td>
        </tr>
        <tr>
          <td id="L2719" data-line-number="2719"></td>
          <td id="LC2719">                            If lExtSize &lt;&gt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2720" data-line-number="2720"></td>
          <td id="LC2720">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2721" data-line-number="2721"></td>
          <td id="LC2721">                            End If</td>
        </tr>
        <tr>
          <td id="L2722" data-line-number="2722"></td>
          <td id="LC2722">                            pvBufferReadLong uInput, .ProtocolVersion, Size:=2</td>
        </tr>
        <tr>
          <td id="L2723" data-line-number="2723"></td>
          <td id="LC2723">                            If .ProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS12 And .ProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2724" data-line-number="2724"></td>
          <td id="LC2724">                                GoTo UnsupportedProtocol</td>
        </tr>
        <tr>
          <td id="L2725" data-line-number="2725"></td>
          <td id="LC2725">                            End If</td>
        </tr>
        <tr>
          <td id="L2726" data-line-number="2726"></td>
          <td id="LC2726">                        Case IIf((.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0, TLS_EXTENSION_COOKIE, -1)</td>
        </tr>
        <tr>
          <td id="L2727" data-line-number="2727"></td>
          <td id="LC2727">                            If Not .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L2728" data-line-number="2728"></td>
          <td id="LC2728">                                GoTo UnexpectedExtension</td>
        </tr>
        <tr>
          <td id="L2729" data-line-number="2729"></td>
          <td id="LC2729">                            End If</td>
        </tr>
        <tr>
          <td id="L2730" data-line-number="2730"></td>
          <td id="LC2730">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2731" data-line-number="2731"></td>
          <td id="LC2731">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2732" data-line-number="2732"></td>
          <td id="LC2732">                            End If</td>
        </tr>
        <tr>
          <td id="L2733" data-line-number="2733"></td>
          <td id="LC2733">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lCookieSize</td>
        </tr>
        <tr>
          <td id="L2734" data-line-number="2734"></td>
          <td id="LC2734">                                If uInput.Pos + lCookieSize &lt;&gt; lExtEnd Or lCookieSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2735" data-line-number="2735"></td>
          <td id="LC2735">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2736" data-line-number="2736"></td>
          <td id="LC2736">                                End If</td>
        </tr>
        <tr>
          <td id="L2737" data-line-number="2737"></td>
          <td id="LC2737">                                pvBufferReadArray uInput, .HelloRetryCookie, lCookieSize</td>
        </tr>
        <tr>
          <td id="L2738" data-line-number="2738"></td>
          <td id="LC2738">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2739" data-line-number="2739"></td>
          <td id="LC2739">                        Case TLS_EXTENSION_ALPN</td>
        </tr>
        <tr>
          <td id="L2740" data-line-number="2740"></td>
          <td id="LC2740">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2741" data-line-number="2741"></td>
          <td id="LC2741">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2742" data-line-number="2742"></td>
          <td id="LC2742">                            End If</td>
        </tr>
        <tr>
          <td id="L2743" data-line-number="2743"></td>
          <td id="LC2743">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lNameSize</td>
        </tr>
        <tr>
          <td id="L2744" data-line-number="2744"></td>
          <td id="LC2744">                                If uInput.Pos + lNameSize &lt;&gt; lExtEnd Or lNameSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2745" data-line-number="2745"></td>
          <td id="LC2745">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2746" data-line-number="2746"></td>
          <td id="LC2746">                                End If</td>
        </tr>
        <tr>
          <td id="L2747" data-line-number="2747"></td>
          <td id="LC2747">                                pvBufferReadBlockStart uInput, BlockSize:=lNameSize</td>
        </tr>
        <tr>
          <td id="L2748" data-line-number="2748"></td>
          <td id="LC2748">                                    If uInput.Pos + lNameSize &lt;&gt; lExtEnd Or lNameSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2749" data-line-number="2749"></td>
          <td id="LC2749">                                        GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2750" data-line-number="2750"></td>
          <td id="LC2750">                                    End If</td>
        </tr>
        <tr>
          <td id="L2751" data-line-number="2751"></td>
          <td id="LC2751">                                    pvBufferReadString uInput, .AlpnNegotiated, lNameSize</td>
        </tr>
        <tr>
          <td id="L2752" data-line-number="2752"></td>
          <td id="LC2752">                                pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2753" data-line-number="2753"></td>
          <td id="LC2753">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2754" data-line-number="2754"></td>
          <td id="LC2754">                        Case TLS_EXTENSION_RENEGOTIATION_INFO</td>
        </tr>
        <tr>
          <td id="L2755" data-line-number="2755"></td>
          <td id="LC2755">                            If lExtSize &lt; 1 Then</td>
        </tr>
        <tr>
          <td id="L2756" data-line-number="2756"></td>
          <td id="LC2756">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2757" data-line-number="2757"></td>
          <td id="LC2757">                            End If</td>
        </tr>
        <tr>
          <td id="L2758" data-line-number="2758"></td>
          <td id="LC2758">                            pvBufferReadBlockStart uInput, Size:=1, BlockSize:=lNameSize</td>
        </tr>
        <tr>
          <td id="L2759" data-line-number="2759"></td>
          <td id="LC2759">                                If uInput.Pos + lNameSize &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L2760" data-line-number="2760"></td>
          <td id="LC2760">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2761" data-line-number="2761"></td>
          <td id="LC2761">                                End If</td>
        </tr>
        <tr>
          <td id="L2762" data-line-number="2762"></td>
          <td id="LC2762">                                pvBufferReadArray uInput, .RemoteLegacyRenegInfo, lNameSize</td>
        </tr>
        <tr>
          <td id="L2763" data-line-number="2763"></td>
          <td id="LC2763">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2764" data-line-number="2764"></td>
          <td id="LC2764">                        Case Else</td>
        </tr>
        <tr>
          <td id="L2765" data-line-number="2765"></td>
          <td id="LC2765">                            uInput.Pos = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2766" data-line-number="2766"></td>
          <td id="LC2766">                        End Select</td>
        </tr>
        <tr>
          <td id="L2767" data-line-number="2767"></td>
          <td id="LC2767">                        If Not SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; lExtType) Then</td>
        </tr>
        <tr>
          <td id="L2768" data-line-number="2768"></td>
          <td id="LC2768">                            .RemoteExtensions.Add lExtType, &#34;#&#34; &amp; lExtType</td>
        </tr>
        <tr>
          <td id="L2769" data-line-number="2769"></td>
          <td id="LC2769">                        End If</td>
        </tr>
        <tr>
          <td id="L2770" data-line-number="2770"></td>
          <td id="LC2770">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2771" data-line-number="2771"></td>
          <td id="LC2771">                Loop</td>
        </tr>
        <tr>
          <td id="L2772" data-line-number="2772"></td>
          <td id="LC2772">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2773" data-line-number="2773"></td>
          <td id="LC2773">        End If</td>
        </tr>
        <tr>
          <td id="L2774" data-line-number="2774"></td>
          <td id="LC2774">    End With</td>
        </tr>
        <tr>
          <td id="L2775" data-line-number="2775"></td>
          <td id="LC2775">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L2776" data-line-number="2776"></td>
          <td id="LC2776">    pvTlsParseHandshakeServerHello = True</td>
        </tr>
        <tr>
          <td id="L2777" data-line-number="2777"></td>
          <td id="LC2777">QH:</td>
        </tr>
        <tr>
          <td id="L2778" data-line-number="2778"></td>
          <td id="LC2778">    Exit Function</td>
        </tr>
        <tr>
          <td id="L2779" data-line-number="2779"></td>
          <td id="LC2779">InvalidSize:</td>
        </tr>
        <tr>
          <td id="L2780" data-line-number="2780"></td>
          <td id="LC2780">    sError = IIf(lExtType &lt; 0, ERR_INVALID_SIZE, Replace(ERR_INVALID_SIZE_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType)))</td>
        </tr>
        <tr>
          <td id="L2781" data-line-number="2781"></td>
          <td id="LC2781">    eAlertCode = uscTlsAlertDecodeError</td>
        </tr>
        <tr>
          <td id="L2782" data-line-number="2782"></td>
          <td id="LC2782">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2783" data-line-number="2783"></td>
          <td id="LC2783">UnexpectedExtension:</td>
        </tr>
        <tr>
          <td id="L2784" data-line-number="2784"></td>
          <td id="LC2784">    sError = Replace(ERR_UNEXPECTED_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType))</td>
        </tr>
        <tr>
          <td id="L2785" data-line-number="2785"></td>
          <td id="LC2785">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L2786" data-line-number="2786"></td>
          <td id="LC2786">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2787" data-line-number="2787"></td>
          <td id="LC2787">InvalidRemoteKey:</td>
        </tr>
        <tr>
          <td id="L2788" data-line-number="2788"></td>
          <td id="LC2788">    sError = ERR_INVALID_REMOTE_KEY</td>
        </tr>
        <tr>
          <td id="L2789" data-line-number="2789"></td>
          <td id="LC2789">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L2790" data-line-number="2790"></td>
          <td id="LC2790">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2791" data-line-number="2791"></td>
          <td id="LC2791">UnsupportedProtocol:</td>
        </tr>
        <tr>
          <td id="L2792" data-line-number="2792"></td>
          <td id="LC2792">    sError = Replace(ERR_UNSUPPORTED_PROTOCOL, &#34;%1&#34;, &#34;&amp;H&#34; &amp; Hex$(uCtx.ProtocolVersion))</td>
        </tr>
        <tr>
          <td id="L2793" data-line-number="2793"></td>
          <td id="LC2793">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L2794" data-line-number="2794"></td>
          <td id="LC2794">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L2795" data-line-number="2795"></td>
          <td id="LC2795">EH:</td>
        </tr>
        <tr>
          <td id="L2796" data-line-number="2796"></td>
          <td id="LC2796">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L2797" data-line-number="2797"></td>
          <td id="LC2797">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L2798" data-line-number="2798"></td>
          <td id="LC2798">    Resume QH</td>
        </tr>
        <tr>
          <td id="L2799" data-line-number="2799"></td>
          <td id="LC2799">End Function</td>
        </tr>
        <tr>
          <td id="L2800" data-line-number="2800"></td>
          <td id="LC2800">
</td>
        </tr>
        <tr>
          <td id="L2801" data-line-number="2801"></td>
          <td id="LC2801">Private Function pvTlsParseHandshakeClientHello(uCtx As UcsTlsContext, uInput As UcsBuffer, ByVal lInputEnd As Long, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L2802" data-line-number="2802"></td>
          <td id="LC2802">    Const FUNC_NAME     As String = &#34;pvTlsParseHandshakeClientHello&#34;</td>
        </tr>
        <tr>
          <td id="L2803" data-line-number="2803"></td>
          <td id="LC2803">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L2804" data-line-number="2804"></td>
          <td id="LC2804">    Dim lEnd            As Long</td>
        </tr>
        <tr>
          <td id="L2805" data-line-number="2805"></td>
          <td id="LC2805">    Dim lCipherSuite    As Long</td>
        </tr>
        <tr>
          <td id="L2806" data-line-number="2806"></td>
          <td id="LC2806">    Dim lExtType        As Long</td>
        </tr>
        <tr>
          <td id="L2807" data-line-number="2807"></td>
          <td id="LC2807">    Dim lExtSize        As Long</td>
        </tr>
        <tr>
          <td id="L2808" data-line-number="2808"></td>
          <td id="LC2808">    Dim lExtEnd         As Long</td>
        </tr>
        <tr>
          <td id="L2809" data-line-number="2809"></td>
          <td id="LC2809">    Dim lExchGroup      As Long</td>
        </tr>
        <tr>
          <td id="L2810" data-line-number="2810"></td>
          <td id="LC2810">    Dim eExchAlgo       As UcsTlsCryptoAlgorithmsEnum</td>
        </tr>
        <tr>
          <td id="L2811" data-line-number="2811"></td>
          <td id="LC2811">    Dim lBlockSize      As Long</td>
        </tr>
        <tr>
          <td id="L2812" data-line-number="2812"></td>
          <td id="LC2812">    Dim lProtocolVersion As Long</td>
        </tr>
        <tr>
          <td id="L2813" data-line-number="2813"></td>
          <td id="LC2813">    Dim lSignatureScheme As Long</td>
        </tr>
        <tr>
          <td id="L2814" data-line-number="2814"></td>
          <td id="LC2814">    Dim cCipherSuites   As Collection</td>
        </tr>
        <tr>
          <td id="L2815" data-line-number="2815"></td>
          <td id="LC2815">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L2816" data-line-number="2816"></td>
          <td id="LC2816">    Dim vItem           As Variant</td>
        </tr>
        <tr>
          <td id="L2817" data-line-number="2817"></td>
          <td id="LC2817">    Dim vElem           As Variant</td>
        </tr>
        <tr>
          <td id="L2818" data-line-number="2818"></td>
          <td id="LC2818">    Dim uKeyInfo        As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L2819" data-line-number="2819"></td>
          <td id="LC2819">    Dim lNameType       As Long</td>
        </tr>
        <tr>
          <td id="L2820" data-line-number="2820"></td>
          <td id="LC2820">    Dim lNameSize       As Long</td>
        </tr>
        <tr>
          <td id="L2821" data-line-number="2821"></td>
          <td id="LC2821">    Dim sName           As String</td>
        </tr>
        <tr>
          <td id="L2822" data-line-number="2822"></td>
          <td id="LC2822">    Dim cAlpnPrefs      As Collection</td>
        </tr>
        <tr>
          <td id="L2823" data-line-number="2823"></td>
          <td id="LC2823">    Dim lAlpnPref       As Long</td>
        </tr>
        <tr>
          <td id="L2824" data-line-number="2824"></td>
          <td id="LC2824">    Dim lCompression    As Long</td>
        </tr>
        <tr>
          <td id="L2825" data-line-number="2825"></td>
          <td id="LC2825">    Dim cPrevRemoteExt  As Collection</td>
        </tr>
        <tr>
          <td id="L2826" data-line-number="2826"></td>
          <td id="LC2826">    </td>
        </tr>
        <tr>
          <td id="L2827" data-line-number="2827"></td>
          <td id="LC2827">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L2828" data-line-number="2828"></td>
          <td id="LC2828">    lExtType = -1</td>
        </tr>
        <tr>
          <td id="L2829" data-line-number="2829"></td>
          <td id="LC2829">    With uCtx</td>
        </tr>
        <tr>
          <td id="L2830" data-line-number="2830"></td>
          <td id="LC2830">        Set cPrevRemoteExt = .RemoteExtensions</td>
        </tr>
        <tr>
          <td id="L2831" data-line-number="2831"></td>
          <td id="LC2831">        Set .RemoteExtensions = New Collection</td>
        </tr>
        <tr>
          <td id="L2832" data-line-number="2832"></td>
          <td id="LC2832">        If Not pvAsn1DecodePrivateKey(.LocalCertificates, .LocalPrivateKey, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L2833" data-line-number="2833"></td>
          <td id="LC2833">            GoTo UnsupportedCertificate</td>
        </tr>
        <tr>
          <td id="L2834" data-line-number="2834"></td>
          <td id="LC2834">        End If</td>
        </tr>
        <tr>
          <td id="L2835" data-line-number="2835"></td>
          <td id="LC2835">        .ProtocolVersion = IIf((.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 And Not .HelloRetryRequest, TLS_PROTOCOL_VERSION_TLS12, TLS_PROTOCOL_VERSION_TLS13)</td>
        </tr>
        <tr>
          <td id="L2836" data-line-number="2836"></td>
          <td id="LC2836">        pvBufferReadLong uInput, .RemoteProtocolVersion, Size:=2</td>
        </tr>
        <tr>
          <td id="L2837" data-line-number="2837"></td>
          <td id="LC2837">        If .RemoteProtocolVersion &lt; TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L2838" data-line-number="2838"></td>
          <td id="LC2838">            GoTo UnsupportedProtocol</td>
        </tr>
        <tr>
          <td id="L2839" data-line-number="2839"></td>
          <td id="LC2839">        End If</td>
        </tr>
        <tr>
          <td id="L2840" data-line-number="2840"></td>
          <td id="LC2840">        &#39;--- remote random</td>
        </tr>
        <tr>
          <td id="L2841" data-line-number="2841"></td>
          <td id="LC2841">        If uInput.Pos + TLS_HELLO_RANDOM_SIZE &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2842" data-line-number="2842"></td>
          <td id="LC2842">            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2843" data-line-number="2843"></td>
          <td id="LC2843">        End If</td>
        </tr>
        <tr>
          <td id="L2844" data-line-number="2844"></td>
          <td id="LC2844">        pvBufferReadArray uInput, .RemoteExchRandom, TLS_HELLO_RANDOM_SIZE</td>
        </tr>
        <tr>
          <td id="L2845" data-line-number="2845"></td>
          <td id="LC2845">        &#39;--- session id</td>
        </tr>
        <tr>
          <td id="L2846" data-line-number="2846"></td>
          <td id="LC2846">        If uInput.Pos + 1 &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2847" data-line-number="2847"></td>
          <td id="LC2847">            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2848" data-line-number="2848"></td>
          <td id="LC2848">        End If</td>
        </tr>
        <tr>
          <td id="L2849" data-line-number="2849"></td>
          <td id="LC2849">        pvBufferReadBlockStart uInput, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L2850" data-line-number="2850"></td>
          <td id="LC2850">            If uInput.Pos + lSize &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2851" data-line-number="2851"></td>
          <td id="LC2851">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2852" data-line-number="2852"></td>
          <td id="LC2852">            End If</td>
        </tr>
        <tr>
          <td id="L2853" data-line-number="2853"></td>
          <td id="LC2853">            If lSize &lt;&gt; 0 And lSize &lt;&gt; TLS_LEGACY_SESSIONID_SIZE Then</td>
        </tr>
        <tr>
          <td id="L2854" data-line-number="2854"></td>
          <td id="LC2854">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2855" data-line-number="2855"></td>
          <td id="LC2855">            End If</td>
        </tr>
        <tr>
          <td id="L2856" data-line-number="2856"></td>
          <td id="LC2856">            pvBufferReadArray uInput, .RemoteSessionID, lSize</td>
        </tr>
        <tr>
          <td id="L2857" data-line-number="2857"></td>
          <td id="LC2857">        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2858" data-line-number="2858"></td>
          <td id="LC2858">        &#39;--- ciphersuites</td>
        </tr>
        <tr>
          <td id="L2859" data-line-number="2859"></td>
          <td id="LC2859">        If uInput.Pos + 2 &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2860" data-line-number="2860"></td>
          <td id="LC2860">            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2861" data-line-number="2861"></td>
          <td id="LC2861">        End If</td>
        </tr>
        <tr>
          <td id="L2862" data-line-number="2862"></td>
          <td id="LC2862">        pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L2863" data-line-number="2863"></td>
          <td id="LC2863">            lEnd = uInput.Pos + lSize</td>
        </tr>
        <tr>
          <td id="L2864" data-line-number="2864"></td>
          <td id="LC2864">            If lEnd &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2865" data-line-number="2865"></td>
          <td id="LC2865">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2866" data-line-number="2866"></td>
          <td id="LC2866">            End If</td>
        </tr>
        <tr>
          <td id="L2867" data-line-number="2867"></td>
          <td id="LC2867">            Set cCipherSuites = New Collection</td>
        </tr>
        <tr>
          <td id="L2868" data-line-number="2868"></td>
          <td id="LC2868">            Do While uInput.Pos + 1 &lt; lEnd</td>
        </tr>
        <tr>
          <td id="L2869" data-line-number="2869"></td>
          <td id="LC2869">                pvBufferReadLong uInput, lIdx, Size:=2</td>
        </tr>
        <tr>
          <td id="L2870" data-line-number="2870"></td>
          <td id="LC2870">                If Not SearchCollection(cCipherSuites, &#34;#&#34; &amp; lIdx) Then</td>
        </tr>
        <tr>
          <td id="L2871" data-line-number="2871"></td>
          <td id="LC2871">                    cCipherSuites.Add lIdx, &#34;#&#34; &amp; lIdx</td>
        </tr>
        <tr>
          <td id="L2872" data-line-number="2872"></td>
          <td id="LC2872">                End If</td>
        </tr>
        <tr>
          <td id="L2873" data-line-number="2873"></td>
          <td id="LC2873">                If lIdx = TLS_CS_EMPTY_RENEGOTIATION_INFO_SCSV And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L2874" data-line-number="2874"></td>
          <td id="LC2874">                    lIdx = TLS_EXTENSION_RENEGOTIATION_INFO</td>
        </tr>
        <tr>
          <td id="L2875" data-line-number="2875"></td>
          <td id="LC2875">                    &#39;--- 3.7, Server Behavior: Secure Renegotiation. When a ClientHello is received, the server MUST verify that it does not</td>
        </tr>
        <tr>
          <td id="L2876" data-line-number="2876"></td>
          <td id="LC2876">                    &#39;---   contain the TLS_EMPTY_RENEGOTIATION_INFO_SCSV SCSV. If the SCSV is present, the server MUST abort the handshake.</td>
        </tr>
        <tr>
          <td id="L2877" data-line-number="2877"></td>
          <td id="LC2877">                    If SearchCollection(cPrevRemoteExt, &#34;#&#34; &amp; lIdx) Then</td>
        </tr>
        <tr>
          <td id="L2878" data-line-number="2878"></td>
          <td id="LC2878">                        GoTo SecureRenegotiationFailed</td>
        </tr>
        <tr>
          <td id="L2879" data-line-number="2879"></td>
          <td id="LC2879">                    End If</td>
        </tr>
        <tr>
          <td id="L2880" data-line-number="2880"></td>
          <td id="LC2880">                    If Not SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; lIdx) Then</td>
        </tr>
        <tr>
          <td id="L2881" data-line-number="2881"></td>
          <td id="LC2881">                        .RemoteExtensions.Add lIdx, &#34;#&#34; &amp; lIdx</td>
        </tr>
        <tr>
          <td id="L2882" data-line-number="2882"></td>
          <td id="LC2882">                    End If</td>
        </tr>
        <tr>
          <td id="L2883" data-line-number="2883"></td>
          <td id="LC2883">                End If</td>
        </tr>
        <tr>
          <td id="L2884" data-line-number="2884"></td>
          <td id="LC2884">            Loop</td>
        </tr>
        <tr>
          <td id="L2885" data-line-number="2885"></td>
          <td id="LC2885">            If uInput.Pos &lt;&gt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L2886" data-line-number="2886"></td>
          <td id="LC2886">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2887" data-line-number="2887"></td>
          <td id="LC2887">            End If</td>
        </tr>
        <tr>
          <td id="L2888" data-line-number="2888"></td>
          <td id="LC2888">        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2889" data-line-number="2889"></td>
          <td id="LC2889">        &#39;--- compression</td>
        </tr>
        <tr>
          <td id="L2890" data-line-number="2890"></td>
          <td id="LC2890">        If uInput.Pos + 1 &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2891" data-line-number="2891"></td>
          <td id="LC2891">            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2892" data-line-number="2892"></td>
          <td id="LC2892">        End If</td>
        </tr>
        <tr>
          <td id="L2893" data-line-number="2893"></td>
          <td id="LC2893">        pvBufferReadBlockStart uInput, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L2894" data-line-number="2894"></td>
          <td id="LC2894">            lEnd = uInput.Pos + lSize</td>
        </tr>
        <tr>
          <td id="L2895" data-line-number="2895"></td>
          <td id="LC2895">            If lEnd &gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2896" data-line-number="2896"></td>
          <td id="LC2896">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2897" data-line-number="2897"></td>
          <td id="LC2897">            End If</td>
        </tr>
        <tr>
          <td id="L2898" data-line-number="2898"></td>
          <td id="LC2898">            If uInput.Pos &lt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L2899" data-line-number="2899"></td>
          <td id="LC2899">                lIdx = 1</td>
        </tr>
        <tr>
          <td id="L2900" data-line-number="2900"></td>
          <td id="LC2900">                Do While uInput.Pos &lt; lEnd</td>
        </tr>
        <tr>
          <td id="L2901" data-line-number="2901"></td>
          <td id="LC2901">                    pvBufferReadLong uInput, lCompression</td>
        </tr>
        <tr>
          <td id="L2902" data-line-number="2902"></td>
          <td id="LC2902">                    If lCompression &lt;&gt; 0 And .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L2903" data-line-number="2903"></td>
          <td id="LC2903">                        GoTo InvalidCompression</td>
        </tr>
        <tr>
          <td id="L2904" data-line-number="2904"></td>
          <td id="LC2904">                    End If</td>
        </tr>
        <tr>
          <td id="L2905" data-line-number="2905"></td>
          <td id="LC2905">                    If lCompression = 0 Then</td>
        </tr>
        <tr>
          <td id="L2906" data-line-number="2906"></td>
          <td id="LC2906">                        lIdx = 0</td>
        </tr>
        <tr>
          <td id="L2907" data-line-number="2907"></td>
          <td id="LC2907">                    End If</td>
        </tr>
        <tr>
          <td id="L2908" data-line-number="2908"></td>
          <td id="LC2908">                Loop</td>
        </tr>
        <tr>
          <td id="L2909" data-line-number="2909"></td>
          <td id="LC2909">                If lIdx &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2910" data-line-number="2910"></td>
          <td id="LC2910">                    GoTo InvalidCompression</td>
        </tr>
        <tr>
          <td id="L2911" data-line-number="2911"></td>
          <td id="LC2911">                End If</td>
        </tr>
        <tr>
          <td id="L2912" data-line-number="2912"></td>
          <td id="LC2912">            End If</td>
        </tr>
        <tr>
          <td id="L2913" data-line-number="2913"></td>
          <td id="LC2913">        pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2914" data-line-number="2914"></td>
          <td id="LC2914">        &#39;--- extensions</td>
        </tr>
        <tr>
          <td id="L2915" data-line-number="2915"></td>
          <td id="LC2915">        If uInput.Pos + 1 &lt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2916" data-line-number="2916"></td>
          <td id="LC2916">            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L2917" data-line-number="2917"></td>
          <td id="LC2917">                lEnd = uInput.Pos + lSize</td>
        </tr>
        <tr>
          <td id="L2918" data-line-number="2918"></td>
          <td id="LC2918">                If lEnd &lt;&gt; lInputEnd Then</td>
        </tr>
        <tr>
          <td id="L2919" data-line-number="2919"></td>
          <td id="LC2919">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2920" data-line-number="2920"></td>
          <td id="LC2920">                End If</td>
        </tr>
        <tr>
          <td id="L2921" data-line-number="2921"></td>
          <td id="LC2921">                Do While uInput.Pos + 3 &lt; lEnd</td>
        </tr>
        <tr>
          <td id="L2922" data-line-number="2922"></td>
          <td id="LC2922">                    pvBufferReadLong uInput, lExtType, Size:=2</td>
        </tr>
        <tr>
          <td id="L2923" data-line-number="2923"></td>
          <td id="LC2923">                    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L2924" data-line-number="2924"></td>
          <td id="LC2924">&#39;                        DebugLog MODULE_NAME, FUNC_NAME, &#34;ClientHello &#34; &amp; pvTlsGetExtensionName(lExtType)</td>
        </tr>
        <tr>
          <td id="L2925" data-line-number="2925"></td>
          <td id="LC2925">                    #End If</td>
        </tr>
        <tr>
          <td id="L2926" data-line-number="2926"></td>
          <td id="LC2926">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lExtSize</td>
        </tr>
        <tr>
          <td id="L2927" data-line-number="2927"></td>
          <td id="LC2927">                        lExtEnd = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L2928" data-line-number="2928"></td>
          <td id="LC2928">                        If lExtEnd &gt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L2929" data-line-number="2929"></td>
          <td id="LC2929">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2930" data-line-number="2930"></td>
          <td id="LC2930">                        End If</td>
        </tr>
        <tr>
          <td id="L2931" data-line-number="2931"></td>
          <td id="LC2931">                        Select Case lExtType</td>
        </tr>
        <tr>
          <td id="L2932" data-line-number="2932"></td>
          <td id="LC2932">                        Case TLS_EXTENSION_SERVER_NAME</td>
        </tr>
        <tr>
          <td id="L2933" data-line-number="2933"></td>
          <td id="LC2933">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2934" data-line-number="2934"></td>
          <td id="LC2934">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2935" data-line-number="2935"></td>
          <td id="LC2935">                            End If</td>
        </tr>
        <tr>
          <td id="L2936" data-line-number="2936"></td>
          <td id="LC2936">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2937" data-line-number="2937"></td>
          <td id="LC2937">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Or lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2938" data-line-number="2938"></td>
          <td id="LC2938">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2939" data-line-number="2939"></td>
          <td id="LC2939">                                End If</td>
        </tr>
        <tr>
          <td id="L2940" data-line-number="2940"></td>
          <td id="LC2940">                                Do While uInput.Pos + 2 &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L2941" data-line-number="2941"></td>
          <td id="LC2941">                                    pvBufferReadLong uInput, lNameType</td>
        </tr>
        <tr>
          <td id="L2942" data-line-number="2942"></td>
          <td id="LC2942">                                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lNameSize</td>
        </tr>
        <tr>
          <td id="L2943" data-line-number="2943"></td>
          <td id="LC2943">                                        If uInput.Pos + lNameSize &gt; lExtEnd Or lNameSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2944" data-line-number="2944"></td>
          <td id="LC2944">                                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2945" data-line-number="2945"></td>
          <td id="LC2945">                                        End If</td>
        </tr>
        <tr>
          <td id="L2946" data-line-number="2946"></td>
          <td id="LC2946">                                        If lNameType = TLS_SERVER_NAME_TYPE_HOSTNAME Then</td>
        </tr>
        <tr>
          <td id="L2947" data-line-number="2947"></td>
          <td id="LC2947">                                            If LenB(.SniRequested) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2948" data-line-number="2948"></td>
          <td id="LC2948">                                                GoTo InvalidServerName</td>
        </tr>
        <tr>
          <td id="L2949" data-line-number="2949"></td>
          <td id="LC2949">                                            End If</td>
        </tr>
        <tr>
          <td id="L2950" data-line-number="2950"></td>
          <td id="LC2950">                                            pvBufferReadString uInput, .SniRequested, lNameSize</td>
        </tr>
        <tr>
          <td id="L2951" data-line-number="2951"></td>
          <td id="LC2951">                                            If Not pvIsValidServerName(.SniRequested) Then</td>
        </tr>
        <tr>
          <td id="L2952" data-line-number="2952"></td>
          <td id="LC2952">                                                GoTo InvalidServerName</td>
        </tr>
        <tr>
          <td id="L2953" data-line-number="2953"></td>
          <td id="LC2953">                                            End If</td>
        </tr>
        <tr>
          <td id="L2954" data-line-number="2954"></td>
          <td id="LC2954">                                        Else</td>
        </tr>
        <tr>
          <td id="L2955" data-line-number="2955"></td>
          <td id="LC2955">                                            uInput.Pos = uInput.Pos + lNameSize &#39;--- skip</td>
        </tr>
        <tr>
          <td id="L2956" data-line-number="2956"></td>
          <td id="LC2956">                                        End If</td>
        </tr>
        <tr>
          <td id="L2957" data-line-number="2957"></td>
          <td id="LC2957">                                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2958" data-line-number="2958"></td>
          <td id="LC2958">                                Loop</td>
        </tr>
        <tr>
          <td id="L2959" data-line-number="2959"></td>
          <td id="LC2959">                                If uInput.Pos &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L2960" data-line-number="2960"></td>
          <td id="LC2960">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2961" data-line-number="2961"></td>
          <td id="LC2961">                                End If</td>
        </tr>
        <tr>
          <td id="L2962" data-line-number="2962"></td>
          <td id="LC2962">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2963" data-line-number="2963"></td>
          <td id="LC2963">                        Case TLS_EXTENSION_ALPN</td>
        </tr>
        <tr>
          <td id="L2964" data-line-number="2964"></td>
          <td id="LC2964">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2965" data-line-number="2965"></td>
          <td id="LC2965">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2966" data-line-number="2966"></td>
          <td id="LC2966">                            End If</td>
        </tr>
        <tr>
          <td id="L2967" data-line-number="2967"></td>
          <td id="LC2967">                            Set cAlpnPrefs = New Collection</td>
        </tr>
        <tr>
          <td id="L2968" data-line-number="2968"></td>
          <td id="LC2968">                            For Each vElem In Split(.AlpnProtocols, &#34;|&#34;)</td>
        </tr>
        <tr>
          <td id="L2969" data-line-number="2969"></td>
          <td id="LC2969">                                cAlpnPrefs.Add cAlpnPrefs.Count, &#34;#&#34; &amp; vElem</td>
        </tr>
        <tr>
          <td id="L2970" data-line-number="2970"></td>
          <td id="LC2970">                            Next</td>
        </tr>
        <tr>
          <td id="L2971" data-line-number="2971"></td>
          <td id="LC2971">                            lAlpnPref = 1000</td>
        </tr>
        <tr>
          <td id="L2972" data-line-number="2972"></td>
          <td id="LC2972">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L2973" data-line-number="2973"></td>
          <td id="LC2973">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Or lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2974" data-line-number="2974"></td>
          <td id="LC2974">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2975" data-line-number="2975"></td>
          <td id="LC2975">                                End If</td>
        </tr>
        <tr>
          <td id="L2976" data-line-number="2976"></td>
          <td id="LC2976">                                Do While uInput.Pos &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L2977" data-line-number="2977"></td>
          <td id="LC2977">                                    pvBufferReadBlockStart uInput, BlockSize:=lNameSize</td>
        </tr>
        <tr>
          <td id="L2978" data-line-number="2978"></td>
          <td id="LC2978">                                        If uInput.Pos + lNameSize &gt; lExtEnd Or lNameSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L2979" data-line-number="2979"></td>
          <td id="LC2979">                                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2980" data-line-number="2980"></td>
          <td id="LC2980">                                        End If</td>
        </tr>
        <tr>
          <td id="L2981" data-line-number="2981"></td>
          <td id="LC2981">                                        pvBufferReadString uInput, sName, lNameSize</td>
        </tr>
        <tr>
          <td id="L2982" data-line-number="2982"></td>
          <td id="LC2982">                                        If SearchCollection(cAlpnPrefs, &#34;#&#34; &amp; sName, RetVal:=vElem) Then</td>
        </tr>
        <tr>
          <td id="L2983" data-line-number="2983"></td>
          <td id="LC2983">                                            If vElem &lt; lAlpnPref Then</td>
        </tr>
        <tr>
          <td id="L2984" data-line-number="2984"></td>
          <td id="LC2984">                                                .AlpnNegotiated = sName</td>
        </tr>
        <tr>
          <td id="L2985" data-line-number="2985"></td>
          <td id="LC2985">                                                lAlpnPref = vElem</td>
        </tr>
        <tr>
          <td id="L2986" data-line-number="2986"></td>
          <td id="LC2986">                                            End If</td>
        </tr>
        <tr>
          <td id="L2987" data-line-number="2987"></td>
          <td id="LC2987">                                        End If</td>
        </tr>
        <tr>
          <td id="L2988" data-line-number="2988"></td>
          <td id="LC2988">                                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2989" data-line-number="2989"></td>
          <td id="LC2989">                                Loop</td>
        </tr>
        <tr>
          <td id="L2990" data-line-number="2990"></td>
          <td id="LC2990">                                If uInput.Pos &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L2991" data-line-number="2991"></td>
          <td id="LC2991">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L2992" data-line-number="2992"></td>
          <td id="LC2992">                                End If</td>
        </tr>
        <tr>
          <td id="L2993" data-line-number="2993"></td>
          <td id="LC2993">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L2994" data-line-number="2994"></td>
          <td id="LC2994">                            If LenB(.AlpnNegotiated) = 0 And cAlpnPrefs.Count &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L2995" data-line-number="2995"></td>
          <td id="LC2995">                                GoTo NoAlpnNegotiated</td>
        </tr>
        <tr>
          <td id="L2996" data-line-number="2996"></td>
          <td id="LC2996">                            End If</td>
        </tr>
        <tr>
          <td id="L2997" data-line-number="2997"></td>
          <td id="LC2997">                        Case IIf((.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0, TLS_EXTENSION_KEY_SHARE, -1)</td>
        </tr>
        <tr>
          <td id="L2998" data-line-number="2998"></td>
          <td id="LC2998">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L2999" data-line-number="2999"></td>
          <td id="LC2999">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3000" data-line-number="3000"></td>
          <td id="LC3000">                            End If</td>
        </tr>
        <tr>
          <td id="L3001" data-line-number="3001"></td>
          <td id="LC3001">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3002" data-line-number="3002"></td>
          <td id="LC3002">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L3003" data-line-number="3003"></td>
          <td id="LC3003">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3004" data-line-number="3004"></td>
          <td id="LC3004">                                End If</td>
        </tr>
        <tr>
          <td id="L3005" data-line-number="3005"></td>
          <td id="LC3005">                                Do While uInput.Pos + 3 &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L3006" data-line-number="3006"></td>
          <td id="LC3006">                                    pvBufferReadLong uInput, lExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L3007" data-line-number="3007"></td>
          <td id="LC3007">                                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3008" data-line-number="3008"></td>
          <td id="LC3008">                                        If lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3009" data-line-number="3009"></td>
          <td id="LC3009">                                            GoTo InvalidRemoteKey</td>
        </tr>
        <tr>
          <td id="L3010" data-line-number="3010"></td>
          <td id="LC3010">                                        End If</td>
        </tr>
        <tr>
          <td id="L3011" data-line-number="3011"></td>
          <td id="LC3011">                                        If uInput.Pos + lBlockSize &gt; lExtEnd Or lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3012" data-line-number="3012"></td>
          <td id="LC3012">                                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3013" data-line-number="3013"></td>
          <td id="LC3013">                                        End If</td>
        </tr>
        <tr>
          <td id="L3014" data-line-number="3014"></td>
          <td id="LC3014">                                        If .HelloRetryRequest And lExchGroup &lt;&gt; .HelloRetryExchGroup Then</td>
        </tr>
        <tr>
          <td id="L3015" data-line-number="3015"></td>
          <td id="LC3015">                                            lExchGroup = 0</td>
        </tr>
        <tr>
          <td id="L3016" data-line-number="3016"></td>
          <td id="LC3016">                                        End If</td>
        </tr>
        <tr>
          <td id="L3017" data-line-number="3017"></td>
          <td id="LC3017">                                        Select Case lExchGroup</td>
        </tr>
        <tr>
          <td id="L3018" data-line-number="3018"></td>
          <td id="LC3018">                                        Case TLS_GROUP_X25519</td>
        </tr>
        <tr>
          <td id="L3019" data-line-number="3019"></td>
          <td id="LC3019">                                            eExchAlgo = ucsTlsAlgoExchX25519</td>
        </tr>
        <tr>
          <td id="L3020" data-line-number="3020"></td>
          <td id="LC3020">                                        Case TLS_GROUP_SECP256R1</td>
        </tr>
        <tr>
          <td id="L3021" data-line-number="3021"></td>
          <td id="LC3021">                                            eExchAlgo = ucsTlsAlgoExchSecp256r1</td>
        </tr>
        <tr>
          <td id="L3022" data-line-number="3022"></td>
          <td id="LC3022">                                        Case TLS_GROUP_SECP384R1</td>
        </tr>
        <tr>
          <td id="L3023" data-line-number="3023"></td>
          <td id="LC3023">                                            eExchAlgo = ucsTlsAlgoExchSecp384r1</td>
        </tr>
        <tr>
          <td id="L3024" data-line-number="3024"></td>
          <td id="LC3024">                                        Case TLS_GROUP_X448, TLS_GROUP_SECP521R1</td>
        </tr>
        <tr>
          <td id="L3025" data-line-number="3025"></td>
          <td id="LC3025">                                            eExchAlgo = 0</td>
        </tr>
        <tr>
          <td id="L3026" data-line-number="3026"></td>
          <td id="LC3026">                                        Case TLS_GROUP_FFDHE_FIRST To TLS_GROUP_FFDHE_LAST</td>
        </tr>
        <tr>
          <td id="L3027" data-line-number="3027"></td>
          <td id="LC3027">                                            eExchAlgo = 0</td>
        </tr>
        <tr>
          <td id="L3028" data-line-number="3028"></td>
          <td id="LC3028">                                        Case TLS_GROUP_FFDHE_PRIVATE_USE_FIRST To TLS_GROUP_FFDHE_PRIVATE_USE_LAST</td>
        </tr>
        <tr>
          <td id="L3029" data-line-number="3029"></td>
          <td id="LC3029">                                            eExchAlgo = 0</td>
        </tr>
        <tr>
          <td id="L3030" data-line-number="3030"></td>
          <td id="LC3030">                                        Case TLS_GROUP_ECDHE_PRIVATE_USE_FIRST To TLS_GROUP_ECDHE_PRIVATE_USE_LAST</td>
        </tr>
        <tr>
          <td id="L3031" data-line-number="3031"></td>
          <td id="LC3031">                                            eExchAlgo = 0</td>
        </tr>
        <tr>
          <td id="L3032" data-line-number="3032"></td>
          <td id="LC3032">                                        Case Else</td>
        </tr>
        <tr>
          <td id="L3033" data-line-number="3033"></td>
          <td id="LC3033">                                            If (lExchGroup And &amp;HFF) = lExchGroup \ &amp;H100 And (lExchGroup And &amp;HF) = &amp;HA Then</td>
        </tr>
        <tr>
          <td id="L3034" data-line-number="3034"></td>
          <td id="LC3034">                                                eExchAlgo = 0 &#39;--- grease from RFC8701</td>
        </tr>
        <tr>
          <td id="L3035" data-line-number="3035"></td>
          <td id="LC3035">                                            Else</td>
        </tr>
        <tr>
          <td id="L3036" data-line-number="3036"></td>
          <td id="LC3036">                                                GoTo UnsupportedExchGroup</td>
        </tr>
        <tr>
          <td id="L3037" data-line-number="3037"></td>
          <td id="LC3037">                                            End If</td>
        </tr>
        <tr>
          <td id="L3038" data-line-number="3038"></td>
          <td id="LC3038">                                        End Select</td>
        </tr>
        <tr>
          <td id="L3039" data-line-number="3039"></td>
          <td id="LC3039">                                        Select Case True</td>
        </tr>
        <tr>
          <td id="L3040" data-line-number="3040"></td>
          <td id="LC3040">                                        Case eExchAlgo = 0, Not pvCryptoIsSupported(eExchAlgo)</td>
        </tr>
        <tr>
          <td id="L3041" data-line-number="3041"></td>
          <td id="LC3041">                                            lExchGroup = 0</td>
        </tr>
        <tr>
          <td id="L3042" data-line-number="3042"></td>
          <td id="LC3042">                                            uInput.Pos = uInput.Pos + lBlockSize</td>
        </tr>
        <tr>
          <td id="L3043" data-line-number="3043"></td>
          <td id="LC3043">                                        End Select</td>
        </tr>
        <tr>
          <td id="L3044" data-line-number="3044"></td>
          <td id="LC3044">                                        If lExchGroup &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3045" data-line-number="3045"></td>
          <td id="LC3045">                                            pvTlsSetupExchGroup uCtx, lExchGroup</td>
        </tr>
        <tr>
          <td id="L3046" data-line-number="3046"></td>
          <td id="LC3046">                                            pvBufferReadArray uInput, .RemoteExchPublic, lBlockSize</td>
        </tr>
        <tr>
          <td id="L3047" data-line-number="3047"></td>
          <td id="LC3047">                                            If Not pvTlsCheckRemoteKey(.ExchGroup, .RemoteExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L3048" data-line-number="3048"></td>
          <td id="LC3048">                                                GoTo InvalidRemoteKey</td>
        </tr>
        <tr>
          <td id="L3049" data-line-number="3049"></td>
          <td id="LC3049">                                            End If</td>
        </tr>
        <tr>
          <td id="L3050" data-line-number="3050"></td>
          <td id="LC3050">                                            #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L3051" data-line-number="3051"></td>
          <td id="LC3051">                                                DebugLog MODULE_NAME, FUNC_NAME, &#34;With exchange group &#34; &amp; pvTlsGetExchGroupName(.ExchGroup)</td>
        </tr>
        <tr>
          <td id="L3052" data-line-number="3052"></td>
          <td id="LC3052">                                            #End If</td>
        </tr>
        <tr>
          <td id="L3053" data-line-number="3053"></td>
          <td id="LC3053">                                        End If</td>
        </tr>
        <tr>
          <td id="L3054" data-line-number="3054"></td>
          <td id="LC3054">                                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3055" data-line-number="3055"></td>
          <td id="LC3055">                                    If lExchGroup &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3056" data-line-number="3056"></td>
          <td id="LC3056">                                        uInput.Pos = lExtEnd</td>
        </tr>
        <tr>
          <td id="L3057" data-line-number="3057"></td>
          <td id="LC3057">                                    End If</td>
        </tr>
        <tr>
          <td id="L3058" data-line-number="3058"></td>
          <td id="LC3058">                                Loop</td>
        </tr>
        <tr>
          <td id="L3059" data-line-number="3059"></td>
          <td id="LC3059">                                If uInput.Pos &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L3060" data-line-number="3060"></td>
          <td id="LC3060">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3061" data-line-number="3061"></td>
          <td id="LC3061">                                End If</td>
        </tr>
        <tr>
          <td id="L3062" data-line-number="3062"></td>
          <td id="LC3062">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3063" data-line-number="3063"></td>
          <td id="LC3063">                        Case TLS_EXTENSION_SIGNATURE_ALGORITHMS</td>
        </tr>
        <tr>
          <td id="L3064" data-line-number="3064"></td>
          <td id="LC3064">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L3065" data-line-number="3065"></td>
          <td id="LC3065">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3066" data-line-number="3066"></td>
          <td id="LC3066">                            End If</td>
        </tr>
        <tr>
          <td id="L3067" data-line-number="3067"></td>
          <td id="LC3067">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3068" data-line-number="3068"></td>
          <td id="LC3068">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Or lBlockSize = 0 Or lBlockSize Mod 2 &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3069" data-line-number="3069"></td>
          <td id="LC3069">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3070" data-line-number="3070"></td>
          <td id="LC3070">                                End If</td>
        </tr>
        <tr>
          <td id="L3071" data-line-number="3071"></td>
          <td id="LC3071">                                Do While uInput.Pos + 1 &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L3072" data-line-number="3072"></td>
          <td id="LC3072">                                    pvBufferReadLong uInput, lSignatureScheme, Size:=2</td>
        </tr>
        <tr>
          <td id="L3073" data-line-number="3073"></td>
          <td id="LC3073">                                    If pvTlsMatchSignatureScheme(uCtx, lSignatureScheme, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L3074" data-line-number="3074"></td>
          <td id="LC3074">                                        .SignatureScheme = lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L3075" data-line-number="3075"></td>
          <td id="LC3075">                                        uInput.Pos = lExtEnd</td>
        </tr>
        <tr>
          <td id="L3076" data-line-number="3076"></td>
          <td id="LC3076">                                    End If</td>
        </tr>
        <tr>
          <td id="L3077" data-line-number="3077"></td>
          <td id="LC3077">                                Loop</td>
        </tr>
        <tr>
          <td id="L3078" data-line-number="3078"></td>
          <td id="LC3078">                                If uInput.Pos &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L3079" data-line-number="3079"></td>
          <td id="LC3079">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3080" data-line-number="3080"></td>
          <td id="LC3080">                                End If</td>
        </tr>
        <tr>
          <td id="L3081" data-line-number="3081"></td>
          <td id="LC3081">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3082" data-line-number="3082"></td>
          <td id="LC3082">                        Case TLS_EXTENSION_SUPPORTED_GROUPS</td>
        </tr>
        <tr>
          <td id="L3083" data-line-number="3083"></td>
          <td id="LC3083">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L3084" data-line-number="3084"></td>
          <td id="LC3084">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3085" data-line-number="3085"></td>
          <td id="LC3085">                            End If</td>
        </tr>
        <tr>
          <td id="L3086" data-line-number="3086"></td>
          <td id="LC3086">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3087" data-line-number="3087"></td>
          <td id="LC3087">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Or lBlockSize = 0 Or lBlockSize Mod 2 &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3088" data-line-number="3088"></td>
          <td id="LC3088">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3089" data-line-number="3089"></td>
          <td id="LC3089">                                End If</td>
        </tr>
        <tr>
          <td id="L3090" data-line-number="3090"></td>
          <td id="LC3090">                                Set .RemoteSupportedGroups = New Collection</td>
        </tr>
        <tr>
          <td id="L3091" data-line-number="3091"></td>
          <td id="LC3091">                                Do While uInput.Pos + 1 &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L3092" data-line-number="3092"></td>
          <td id="LC3092">                                    pvBufferReadLong uInput, lExchGroup, Size:=2</td>
        </tr>
        <tr>
          <td id="L3093" data-line-number="3093"></td>
          <td id="LC3093">                                    If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L3094" data-line-number="3094"></td>
          <td id="LC3094">                                        Select Case lExchGroup</td>
        </tr>
        <tr>
          <td id="L3095" data-line-number="3095"></td>
          <td id="LC3095">                                        Case TLS_GROUP_SECP256R1 To TLS_GROUP_SECP521R1, TLS_GROUP_X25519 To TLS_GROUP_X448</td>
        </tr>
        <tr>
          <td id="L3096" data-line-number="3096"></td>
          <td id="LC3096">                                            &#39;--- ecc curves</td>
        </tr>
        <tr>
          <td id="L3097" data-line-number="3097"></td>
          <td id="LC3097">                                        Case TLS_GROUP_FFDHE_FIRST To TLS_GROUP_FFDHE_LAST</td>
        </tr>
        <tr>
          <td id="L3098" data-line-number="3098"></td>
          <td id="LC3098">                                            &#39;--- ffdhe</td>
        </tr>
        <tr>
          <td id="L3099" data-line-number="3099"></td>
          <td id="LC3099">                                        Case TLS_GROUP_FFDHE_PRIVATE_USE_FIRST To TLS_GROUP_FFDHE_PRIVATE_USE_LAST, TLS_GROUP_ECDHE_PRIVATE_USE_FIRST To TLS_GROUP_ECDHE_PRIVATE_USE_LAST</td>
        </tr>
        <tr>
          <td id="L3100" data-line-number="3100"></td>
          <td id="LC3100">                                            &#39;--- private use</td>
        </tr>
        <tr>
          <td id="L3101" data-line-number="3101"></td>
          <td id="LC3101">                                        Case Else</td>
        </tr>
        <tr>
          <td id="L3102" data-line-number="3102"></td>
          <td id="LC3102">                                            If (lExchGroup And &amp;HFF) = lExchGroup \ &amp;H100 And (lExchGroup And &amp;HF) = &amp;HA Then</td>
        </tr>
        <tr>
          <td id="L3103" data-line-number="3103"></td>
          <td id="LC3103">                                                &#39;--- grease from RFC8701</td>
        </tr>
        <tr>
          <td id="L3104" data-line-number="3104"></td>
          <td id="LC3104">                                            Else</td>
        </tr>
        <tr>
          <td id="L3105" data-line-number="3105"></td>
          <td id="LC3105">                                                GoTo UnsupportedExchGroup</td>
        </tr>
        <tr>
          <td id="L3106" data-line-number="3106"></td>
          <td id="LC3106">                                            End If</td>
        </tr>
        <tr>
          <td id="L3107" data-line-number="3107"></td>
          <td id="LC3107">                                        End Select</td>
        </tr>
        <tr>
          <td id="L3108" data-line-number="3108"></td>
          <td id="LC3108">                                    End If</td>
        </tr>
        <tr>
          <td id="L3109" data-line-number="3109"></td>
          <td id="LC3109">                                    .RemoteSupportedGroups.Add lExchGroup, &#34;#&#34; &amp; lExchGroup</td>
        </tr>
        <tr>
          <td id="L3110" data-line-number="3110"></td>
          <td id="LC3110">                                Loop</td>
        </tr>
        <tr>
          <td id="L3111" data-line-number="3111"></td>
          <td id="LC3111">                                If uInput.Pos &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L3112" data-line-number="3112"></td>
          <td id="LC3112">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3113" data-line-number="3113"></td>
          <td id="LC3113">                                End If</td>
        </tr>
        <tr>
          <td id="L3114" data-line-number="3114"></td>
          <td id="LC3114">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3115" data-line-number="3115"></td>
          <td id="LC3115">                        Case IIf((.LocalFeatures And ucsTlsSupportTls13) &lt;&gt; 0, TLS_EXTENSION_SUPPORTED_VERSIONS, -1)</td>
        </tr>
        <tr>
          <td id="L3116" data-line-number="3116"></td>
          <td id="LC3116">                            If lExtSize &lt; 1 Then</td>
        </tr>
        <tr>
          <td id="L3117" data-line-number="3117"></td>
          <td id="LC3117">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3118" data-line-number="3118"></td>
          <td id="LC3118">                            End If</td>
        </tr>
        <tr>
          <td id="L3119" data-line-number="3119"></td>
          <td id="LC3119">                            pvBufferReadBlockStart uInput, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3120" data-line-number="3120"></td>
          <td id="LC3120">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Or lBlockSize = 0 Or lBlockSize Mod 2 &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3121" data-line-number="3121"></td>
          <td id="LC3121">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3122" data-line-number="3122"></td>
          <td id="LC3122">                                End If</td>
        </tr>
        <tr>
          <td id="L3123" data-line-number="3123"></td>
          <td id="LC3123">                                Do While uInput.Pos + 1 &lt; lExtEnd</td>
        </tr>
        <tr>
          <td id="L3124" data-line-number="3124"></td>
          <td id="LC3124">                                    pvBufferReadLong uInput, lProtocolVersion, Size:=2</td>
        </tr>
        <tr>
          <td id="L3125" data-line-number="3125"></td>
          <td id="LC3125">                                    If lProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L3126" data-line-number="3126"></td>
          <td id="LC3126">                                        uInput.Pos = lExtEnd</td>
        </tr>
        <tr>
          <td id="L3127" data-line-number="3127"></td>
          <td id="LC3127">                                    ElseIf lProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 And (.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3128" data-line-number="3128"></td>
          <td id="LC3128">                                        uInput.Pos = lExtEnd</td>
        </tr>
        <tr>
          <td id="L3129" data-line-number="3129"></td>
          <td id="LC3129">                                    End If</td>
        </tr>
        <tr>
          <td id="L3130" data-line-number="3130"></td>
          <td id="LC3130">                                Loop</td>
        </tr>
        <tr>
          <td id="L3131" data-line-number="3131"></td>
          <td id="LC3131">                                If uInput.Pos &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L3132" data-line-number="3132"></td>
          <td id="LC3132">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3133" data-line-number="3133"></td>
          <td id="LC3133">                                End If</td>
        </tr>
        <tr>
          <td id="L3134" data-line-number="3134"></td>
          <td id="LC3134">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3135" data-line-number="3135"></td>
          <td id="LC3135">                            If lProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS13 And lProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L3136" data-line-number="3136"></td>
          <td id="LC3136">                                GoTo UnsupportedProtocol</td>
        </tr>
        <tr>
          <td id="L3137" data-line-number="3137"></td>
          <td id="LC3137">                            End If</td>
        </tr>
        <tr>
          <td id="L3138" data-line-number="3138"></td>
          <td id="LC3138">                            .ProtocolVersion = lProtocolVersion</td>
        </tr>
        <tr>
          <td id="L3139" data-line-number="3139"></td>
          <td id="LC3139">                        Case IIf((.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0, TLS_EXTENSION_RENEGOTIATION_INFO, -1)</td>
        </tr>
        <tr>
          <td id="L3140" data-line-number="3140"></td>
          <td id="LC3140">                            If lExtSize &lt; 1 Then</td>
        </tr>
        <tr>
          <td id="L3141" data-line-number="3141"></td>
          <td id="LC3141">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3142" data-line-number="3142"></td>
          <td id="LC3142">                            End If</td>
        </tr>
        <tr>
          <td id="L3143" data-line-number="3143"></td>
          <td id="LC3143">                            pvBufferReadBlockStart uInput, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3144" data-line-number="3144"></td>
          <td id="LC3144">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Then</td>
        </tr>
        <tr>
          <td id="L3145" data-line-number="3145"></td>
          <td id="LC3145">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3146" data-line-number="3146"></td>
          <td id="LC3146">                                End If</td>
        </tr>
        <tr>
          <td id="L3147" data-line-number="3147"></td>
          <td id="LC3147">                                pvBufferReadArray uInput, .RemoteLegacyRenegInfo, lBlockSize</td>
        </tr>
        <tr>
          <td id="L3148" data-line-number="3148"></td>
          <td id="LC3148">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3149" data-line-number="3149"></td>
          <td id="LC3149">                            If lBlockSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3150" data-line-number="3150"></td>
          <td id="LC3150">                                If Not pvArrayEqual(.RemoteLegacyRenegInfo, .RemoteLegacyVerifyData) Then</td>
        </tr>
        <tr>
          <td id="L3151" data-line-number="3151"></td>
          <td id="LC3151">                                    GoTo SecureRenegotiationFailed</td>
        </tr>
        <tr>
          <td id="L3152" data-line-number="3152"></td>
          <td id="LC3152">                                End If</td>
        </tr>
        <tr>
          <td id="L3153" data-line-number="3153"></td>
          <td id="LC3153">                            End If</td>
        </tr>
        <tr>
          <td id="L3154" data-line-number="3154"></td>
          <td id="LC3154">                        Case IIf((.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0, TLS_EXTENSION_EXTENDED_MASTER_SECRET, -1)</td>
        </tr>
        <tr>
          <td id="L3155" data-line-number="3155"></td>
          <td id="LC3155">                            If lExtSize &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3156" data-line-number="3156"></td>
          <td id="LC3156">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3157" data-line-number="3157"></td>
          <td id="LC3157">                            End If</td>
        </tr>
        <tr>
          <td id="L3158" data-line-number="3158"></td>
          <td id="LC3158">                        Case Else</td>
        </tr>
        <tr>
          <td id="L3159" data-line-number="3159"></td>
          <td id="LC3159">                            If .HelloRetryRequest Then</td>
        </tr>
        <tr>
          <td id="L3160" data-line-number="3160"></td>
          <td id="LC3160">                                If Not SearchCollection(cPrevRemoteExt, &#34;#&#34; &amp; lExtType) Then</td>
        </tr>
        <tr>
          <td id="L3161" data-line-number="3161"></td>
          <td id="LC3161">                                    GoTo UnexpectedExtension</td>
        </tr>
        <tr>
          <td id="L3162" data-line-number="3162"></td>
          <td id="LC3162">                                End If</td>
        </tr>
        <tr>
          <td id="L3163" data-line-number="3163"></td>
          <td id="LC3163">                            End If</td>
        </tr>
        <tr>
          <td id="L3164" data-line-number="3164"></td>
          <td id="LC3164">                            uInput.Pos = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L3165" data-line-number="3165"></td>
          <td id="LC3165">                        End Select</td>
        </tr>
        <tr>
          <td id="L3166" data-line-number="3166"></td>
          <td id="LC3166">                        If Not SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; lExtType) Then</td>
        </tr>
        <tr>
          <td id="L3167" data-line-number="3167"></td>
          <td id="LC3167">                            .RemoteExtensions.Add lExtType, &#34;#&#34; &amp; lExtType</td>
        </tr>
        <tr>
          <td id="L3168" data-line-number="3168"></td>
          <td id="LC3168">                        End If</td>
        </tr>
        <tr>
          <td id="L3169" data-line-number="3169"></td>
          <td id="LC3169">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3170" data-line-number="3170"></td>
          <td id="LC3170">                Loop</td>
        </tr>
        <tr>
          <td id="L3171" data-line-number="3171"></td>
          <td id="LC3171">                If uInput.Pos &lt;&gt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L3172" data-line-number="3172"></td>
          <td id="LC3172">                    lExtType = -1</td>
        </tr>
        <tr>
          <td id="L3173" data-line-number="3173"></td>
          <td id="LC3173">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3174" data-line-number="3174"></td>
          <td id="LC3174">                End If</td>
        </tr>
        <tr>
          <td id="L3175" data-line-number="3175"></td>
          <td id="LC3175">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3176" data-line-number="3176"></td>
          <td id="LC3176">        End If</td>
        </tr>
        <tr>
          <td id="L3177" data-line-number="3177"></td>
          <td id="LC3177">        &#39;--- match preferred ciphersuites</td>
        </tr>
        <tr>
          <td id="L3178" data-line-number="3178"></td>
          <td id="LC3178">        For Each vElem In pvTlsGetSortedCipherSuites(.LocalFeatures And IIf(.ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13, ucsTlsSupportTls13, ucsTlsSupportTls12), uKeyInfo.AlgoObjId)</td>
        </tr>
        <tr>
          <td id="L3179" data-line-number="3179"></td>
          <td id="LC3179">            If SearchCollection(cCipherSuites, &#34;#&#34; &amp; vElem, RetVal:=vItem) Then</td>
        </tr>
        <tr>
          <td id="L3180" data-line-number="3180"></td>
          <td id="LC3180">                If Not .HelloRetryRequest Or .HelloRetryCipherSuite = vItem Then</td>
        </tr>
        <tr>
          <td id="L3181" data-line-number="3181"></td>
          <td id="LC3181">                    lCipherSuite = vItem</td>
        </tr>
        <tr>
          <td id="L3182" data-line-number="3182"></td>
          <td id="LC3182">                    Exit For</td>
        </tr>
        <tr>
          <td id="L3183" data-line-number="3183"></td>
          <td id="LC3183">                End If</td>
        </tr>
        <tr>
          <td id="L3184" data-line-number="3184"></td>
          <td id="LC3184">            End If</td>
        </tr>
        <tr>
          <td id="L3185" data-line-number="3185"></td>
          <td id="LC3185">        Next</td>
        </tr>
        <tr>
          <td id="L3186" data-line-number="3186"></td>
          <td id="LC3186">        If lCipherSuite = 0 Then</td>
        </tr>
        <tr>
          <td id="L3187" data-line-number="3187"></td>
          <td id="LC3187">            GoTo NoCipherSuite</td>
        </tr>
        <tr>
          <td id="L3188" data-line-number="3188"></td>
          <td id="LC3188">        End If</td>
        </tr>
        <tr>
          <td id="L3189" data-line-number="3189"></td>
          <td id="LC3189">        pvTlsSetupCipherSuite uCtx, lCipherSuite</td>
        </tr>
        <tr>
          <td id="L3190" data-line-number="3190"></td>
          <td id="LC3190">        If .SignatureScheme = 0 Then</td>
        </tr>
        <tr>
          <td id="L3191" data-line-number="3191"></td>
          <td id="LC3191">            If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L3192" data-line-number="3192"></td>
          <td id="LC3192">                GoTo NegotiateSignatureFailed</td>
        </tr>
        <tr>
          <td id="L3193" data-line-number="3193"></td>
          <td id="LC3193">            ElseIf SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_SIGNATURE_ALGORITHMS_CERT) Then</td>
        </tr>
        <tr>
          <td id="L3194" data-line-number="3194"></td>
          <td id="LC3194">                GoTo NegotiateSignatureFailed</td>
        </tr>
        <tr>
          <td id="L3195" data-line-number="3195"></td>
          <td id="LC3195">            End If</td>
        </tr>
        <tr>
          <td id="L3196" data-line-number="3196"></td>
          <td id="LC3196">            If pvTlsMatchSignatureScheme(uCtx, TLS_SIGNATURE_RSA_PKCS1_SHA1, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L3197" data-line-number="3197"></td>
          <td id="LC3197">                .SignatureScheme = TLS_SIGNATURE_RSA_PKCS1_SHA1</td>
        </tr>
        <tr>
          <td id="L3198" data-line-number="3198"></td>
          <td id="LC3198">            ElseIf pvTlsMatchSignatureScheme(uCtx, TLS_SIGNATURE_ECDSA_SHA1, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L3199" data-line-number="3199"></td>
          <td id="LC3199">                .SignatureScheme = TLS_SIGNATURE_ECDSA_SHA1</td>
        </tr>
        <tr>
          <td id="L3200" data-line-number="3200"></td>
          <td id="LC3200">            Else</td>
        </tr>
        <tr>
          <td id="L3201" data-line-number="3201"></td>
          <td id="LC3201">                GoTo NegotiateSignatureFailed</td>
        </tr>
        <tr>
          <td id="L3202" data-line-number="3202"></td>
          <td id="LC3202">            End If</td>
        </tr>
        <tr>
          <td id="L3203" data-line-number="3203"></td>
          <td id="LC3203">        End If</td>
        </tr>
        <tr>
          <td id="L3204" data-line-number="3204"></td>
          <td id="LC3204">        If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L3205" data-line-number="3205"></td>
          <td id="LC3205">            lExtType = TLS_EXTENSION_KEY_SHARE</td>
        </tr>
        <tr>
          <td id="L3206" data-line-number="3206"></td>
          <td id="LC3206">            If Not SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; lExtType) Then</td>
        </tr>
        <tr>
          <td id="L3207" data-line-number="3207"></td>
          <td id="LC3207">                GoTo NoExtension</td>
        </tr>
        <tr>
          <td id="L3208" data-line-number="3208"></td>
          <td id="LC3208">            End If</td>
        </tr>
        <tr>
          <td id="L3209" data-line-number="3209"></td>
          <td id="LC3209">        Else</td>
        </tr>
        <tr>
          <td id="L3210" data-line-number="3210"></td>
          <td id="LC3210">            For Each vElem In Array(TLS_EXTENSION_EXTENDED_MASTER_SECRET, TLS_EXTENSION_ENCRYPT_THEN_MAC, TLS_EXTENSION_RENEGOTIATION_INFO)</td>
        </tr>
        <tr>
          <td id="L3211" data-line-number="3211"></td>
          <td id="LC3211">                If SearchCollection(cPrevRemoteExt, &#34;#&#34; &amp; vElem) Then</td>
        </tr>
        <tr>
          <td id="L3212" data-line-number="3212"></td>
          <td id="LC3212">                    If Not SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; vElem) Then</td>
        </tr>
        <tr>
          <td id="L3213" data-line-number="3213"></td>
          <td id="LC3213">                        GoTo NoExtension</td>
        </tr>
        <tr>
          <td id="L3214" data-line-number="3214"></td>
          <td id="LC3214">                    End If</td>
        </tr>
        <tr>
          <td id="L3215" data-line-number="3215"></td>
          <td id="LC3215">                End If</td>
        </tr>
        <tr>
          <td id="L3216" data-line-number="3216"></td>
          <td id="LC3216">            Next</td>
        </tr>
        <tr>
          <td id="L3217" data-line-number="3217"></td>
          <td id="LC3217">        End If</td>
        </tr>
        <tr>
          <td id="L3218" data-line-number="3218"></td>
          <td id="LC3218">        #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L3219" data-line-number="3219"></td>
          <td id="LC3219">            DebugLog MODULE_NAME, FUNC_NAME, &#34;Using &#34; &amp; pvTlsGetCipherSuiteName(.CipherSuite) &amp; &#34; from &#34; &amp; .RemoteHostName</td>
        </tr>
        <tr>
          <td id="L3220" data-line-number="3220"></td>
          <td id="LC3220">        #End If</td>
        </tr>
        <tr>
          <td id="L3221" data-line-number="3221"></td>
          <td id="LC3221">    End With</td>
        </tr>
        <tr>
          <td id="L3222" data-line-number="3222"></td>
          <td id="LC3222">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L3223" data-line-number="3223"></td>
          <td id="LC3223">    pvTlsParseHandshakeClientHello = True</td>
        </tr>
        <tr>
          <td id="L3224" data-line-number="3224"></td>
          <td id="LC3224">QH:</td>
        </tr>
        <tr>
          <td id="L3225" data-line-number="3225"></td>
          <td id="LC3225">    If uKeyInfo.hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3226" data-line-number="3226"></td>
          <td id="LC3226">        Call CryptDestroyKey(uKeyInfo.hKey)</td>
        </tr>
        <tr>
          <td id="L3227" data-line-number="3227"></td>
          <td id="LC3227">    End If</td>
        </tr>
        <tr>
          <td id="L3228" data-line-number="3228"></td>
          <td id="LC3228">    If uKeyInfo.hProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3229" data-line-number="3229"></td>
          <td id="LC3229">        Call CryptReleaseContext(uKeyInfo.hProv, 0)</td>
        </tr>
        <tr>
          <td id="L3230" data-line-number="3230"></td>
          <td id="LC3230">    End If</td>
        </tr>
        <tr>
          <td id="L3231" data-line-number="3231"></td>
          <td id="LC3231">    If uKeyInfo.hNKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3232" data-line-number="3232"></td>
          <td id="LC3232">        Call NCryptFreeObject(uKeyInfo.hNKey)</td>
        </tr>
        <tr>
          <td id="L3233" data-line-number="3233"></td>
          <td id="LC3233">    End If</td>
        </tr>
        <tr>
          <td id="L3234" data-line-number="3234"></td>
          <td id="LC3234">    Exit Function</td>
        </tr>
        <tr>
          <td id="L3235" data-line-number="3235"></td>
          <td id="LC3235">UnsupportedCertificate:</td>
        </tr>
        <tr>
          <td id="L3236" data-line-number="3236"></td>
          <td id="LC3236">    sError = ERR_UNSUPPORTED_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L3237" data-line-number="3237"></td>
          <td id="LC3237">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L3238" data-line-number="3238"></td>
          <td id="LC3238">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3239" data-line-number="3239"></td>
          <td id="LC3239">UnsupportedProtocol:</td>
        </tr>
        <tr>
          <td id="L3240" data-line-number="3240"></td>
          <td id="LC3240">    sError = Replace(ERR_UNSUPPORTED_PROTOCOL, &#34;%1&#34;, &#34;&amp;H&#34; &amp; Hex$(uCtx.RemoteProtocolVersion))</td>
        </tr>
        <tr>
          <td id="L3241" data-line-number="3241"></td>
          <td id="LC3241">    eAlertCode = uscTlsAlertProtocolVersion</td>
        </tr>
        <tr>
          <td id="L3242" data-line-number="3242"></td>
          <td id="LC3242">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3243" data-line-number="3243"></td>
          <td id="LC3243">NoCipherSuite:</td>
        </tr>
        <tr>
          <td id="L3244" data-line-number="3244"></td>
          <td id="LC3244">    For Each vElem In cCipherSuites</td>
        </tr>
        <tr>
          <td id="L3245" data-line-number="3245"></td>
          <td id="LC3245">        sError = sError &amp; &#34;, &amp;H&#34; &amp; Hex$(vElem)</td>
        </tr>
        <tr>
          <td id="L3246" data-line-number="3246"></td>
          <td id="LC3246">    Next</td>
        </tr>
        <tr>
          <td id="L3247" data-line-number="3247"></td>
          <td id="LC3247">    sError = Replace(ERR_NO_SUPPORTED_CIPHER_SUITE, &#34;%1&#34;, Mid$(sError, 3))</td>
        </tr>
        <tr>
          <td id="L3248" data-line-number="3248"></td>
          <td id="LC3248">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L3249" data-line-number="3249"></td>
          <td id="LC3249">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3250" data-line-number="3250"></td>
          <td id="LC3250">InvalidSize:</td>
        </tr>
        <tr>
          <td id="L3251" data-line-number="3251"></td>
          <td id="LC3251">    sError = IIf(lExtType &lt; 0, ERR_INVALID_SIZE, Replace(ERR_INVALID_SIZE_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType)))</td>
        </tr>
        <tr>
          <td id="L3252" data-line-number="3252"></td>
          <td id="LC3252">    eAlertCode = uscTlsAlertDecodeError</td>
        </tr>
        <tr>
          <td id="L3253" data-line-number="3253"></td>
          <td id="LC3253">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3254" data-line-number="3254"></td>
          <td id="LC3254">InvalidRemoteKey:</td>
        </tr>
        <tr>
          <td id="L3255" data-line-number="3255"></td>
          <td id="LC3255">    sError = ERR_INVALID_REMOTE_KEY</td>
        </tr>
        <tr>
          <td id="L3256" data-line-number="3256"></td>
          <td id="LC3256">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L3257" data-line-number="3257"></td>
          <td id="LC3257">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3258" data-line-number="3258"></td>
          <td id="LC3258">NegotiateSignatureFailed:</td>
        </tr>
        <tr>
          <td id="L3259" data-line-number="3259"></td>
          <td id="LC3259">    sError = ERR_NEGOTIATE_SIGNATURE_FAILED</td>
        </tr>
        <tr>
          <td id="L3260" data-line-number="3260"></td>
          <td id="LC3260">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L3261" data-line-number="3261"></td>
          <td id="LC3261">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3262" data-line-number="3262"></td>
          <td id="LC3262">UnexpectedExtension:</td>
        </tr>
        <tr>
          <td id="L3263" data-line-number="3263"></td>
          <td id="LC3263">    sError = Replace(ERR_UNEXPECTED_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType))</td>
        </tr>
        <tr>
          <td id="L3264" data-line-number="3264"></td>
          <td id="LC3264">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L3265" data-line-number="3265"></td>
          <td id="LC3265">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3266" data-line-number="3266"></td>
          <td id="LC3266">NoAlpnNegotiated:</td>
        </tr>
        <tr>
          <td id="L3267" data-line-number="3267"></td>
          <td id="LC3267">    sError = ERR_NO_ALPN_NEGOTIATED</td>
        </tr>
        <tr>
          <td id="L3268" data-line-number="3268"></td>
          <td id="LC3268">    eAlertCode = uscTlsAlertNoApplicationProtocol</td>
        </tr>
        <tr>
          <td id="L3269" data-line-number="3269"></td>
          <td id="LC3269">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3270" data-line-number="3270"></td>
          <td id="LC3270">UnsupportedExchGroup:</td>
        </tr>
        <tr>
          <td id="L3271" data-line-number="3271"></td>
          <td id="LC3271">    sError = Replace(ERR_UNSUPPORTED_EXCH_GROUP, &#34;%1&#34;, pvTlsGetExchGroupName(lExchGroup))</td>
        </tr>
        <tr>
          <td id="L3272" data-line-number="3272"></td>
          <td id="LC3272">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L3273" data-line-number="3273"></td>
          <td id="LC3273">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3274" data-line-number="3274"></td>
          <td id="LC3274">NoExtension:</td>
        </tr>
        <tr>
          <td id="L3275" data-line-number="3275"></td>
          <td id="LC3275">    sError = Replace(ERR_NO_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType))</td>
        </tr>
        <tr>
          <td id="L3276" data-line-number="3276"></td>
          <td id="LC3276">    eAlertCode = uscTlsAlertMissingExtension</td>
        </tr>
        <tr>
          <td id="L3277" data-line-number="3277"></td>
          <td id="LC3277">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3278" data-line-number="3278"></td>
          <td id="LC3278">InvalidCompression:</td>
        </tr>
        <tr>
          <td id="L3279" data-line-number="3279"></td>
          <td id="LC3279">    sError = Replace(ERR_INVALID_COMPRESSION, &#34;%1&#34;, lCompression)</td>
        </tr>
        <tr>
          <td id="L3280" data-line-number="3280"></td>
          <td id="LC3280">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L3281" data-line-number="3281"></td>
          <td id="LC3281">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3282" data-line-number="3282"></td>
          <td id="LC3282">InvalidServerName:</td>
        </tr>
        <tr>
          <td id="L3283" data-line-number="3283"></td>
          <td id="LC3283">    sError = Replace(ERR_INVALID_SERVER_NAME, &#34;%1&#34;, uCtx.SniRequested)</td>
        </tr>
        <tr>
          <td id="L3284" data-line-number="3284"></td>
          <td id="LC3284">    eAlertCode = uscTlsAlertIllegalParameter</td>
        </tr>
        <tr>
          <td id="L3285" data-line-number="3285"></td>
          <td id="LC3285">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3286" data-line-number="3286"></td>
          <td id="LC3286">SecureRenegotiationFailed:</td>
        </tr>
        <tr>
          <td id="L3287" data-line-number="3287"></td>
          <td id="LC3287">    sError = ERR_SECURE_RENEGOTIATION_FAILED</td>
        </tr>
        <tr>
          <td id="L3288" data-line-number="3288"></td>
          <td id="LC3288">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L3289" data-line-number="3289"></td>
          <td id="LC3289">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3290" data-line-number="3290"></td>
          <td id="LC3290">EH:</td>
        </tr>
        <tr>
          <td id="L3291" data-line-number="3291"></td>
          <td id="LC3291">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L3292" data-line-number="3292"></td>
          <td id="LC3292">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L3293" data-line-number="3293"></td>
          <td id="LC3293">    Resume QH</td>
        </tr>
        <tr>
          <td id="L3294" data-line-number="3294"></td>
          <td id="LC3294">End Function</td>
        </tr>
        <tr>
          <td id="L3295" data-line-number="3295"></td>
          <td id="LC3295">
</td>
        </tr>
        <tr>
          <td id="L3296" data-line-number="3296"></td>
          <td id="LC3296">Private Function pvTlsParseHandshakeCertificateRequest(uCtx As UcsTlsContext, uInput As UcsBuffer, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L3297" data-line-number="3297"></td>
          <td id="LC3297">    Dim lSignatureScheme As Long</td>
        </tr>
        <tr>
          <td id="L3298" data-line-number="3298"></td>
          <td id="LC3298">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L3299" data-line-number="3299"></td>
          <td id="LC3299">    Dim lEnd            As Long</td>
        </tr>
        <tr>
          <td id="L3300" data-line-number="3300"></td>
          <td id="LC3300">    Dim lBlockSize      As Long</td>
        </tr>
        <tr>
          <td id="L3301" data-line-number="3301"></td>
          <td id="LC3301">    Dim lBlockEnd       As Long</td>
        </tr>
        <tr>
          <td id="L3302" data-line-number="3302"></td>
          <td id="LC3302">    Dim lExtType        As Long</td>
        </tr>
        <tr>
          <td id="L3303" data-line-number="3303"></td>
          <td id="LC3303">    Dim lExtSize        As Long</td>
        </tr>
        <tr>
          <td id="L3304" data-line-number="3304"></td>
          <td id="LC3304">    Dim lExtEnd         As Long</td>
        </tr>
        <tr>
          <td id="L3305" data-line-number="3305"></td>
          <td id="LC3305">    Dim baDName()       As Byte</td>
        </tr>
        <tr>
          <td id="L3306" data-line-number="3306"></td>
          <td id="LC3306">    Dim lDnSize         As Long</td>
        </tr>
        <tr>
          <td id="L3307" data-line-number="3307"></td>
          <td id="LC3307">    Dim uKeyInfo        As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L3308" data-line-number="3308"></td>
          <td id="LC3308">    Dim baSignatureSchemes() As Byte</td>
        </tr>
        <tr>
          <td id="L3309" data-line-number="3309"></td>
          <td id="LC3309">    Dim lSigPos         As Long</td>
        </tr>
        <tr>
          <td id="L3310" data-line-number="3310"></td>
          <td id="LC3310">    Dim oCallback       As Object</td>
        </tr>
        <tr>
          <td id="L3311" data-line-number="3311"></td>
          <td id="LC3311">    Dim bConfirmed      As Boolean</td>
        </tr>
        <tr>
          <td id="L3312" data-line-number="3312"></td>
          <td id="LC3312">    </td>
        </tr>
        <tr>
          <td id="L3313" data-line-number="3313"></td>
          <td id="LC3313">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L3314" data-line-number="3314"></td>
          <td id="LC3314">    lExtType = -1</td>
        </tr>
        <tr>
          <td id="L3315" data-line-number="3315"></td>
          <td id="LC3315">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3316" data-line-number="3316"></td>
          <td id="LC3316">        If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L3317" data-line-number="3317"></td>
          <td id="LC3317">            If uInput.Pos + 1 &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3318" data-line-number="3318"></td>
          <td id="LC3318">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3319" data-line-number="3319"></td>
          <td id="LC3319">            End If</td>
        </tr>
        <tr>
          <td id="L3320" data-line-number="3320"></td>
          <td id="LC3320">            pvBufferReadBlockStart uInput, Size:=1, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L3321" data-line-number="3321"></td>
          <td id="LC3321">                If uInput.Pos + lSize &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3322" data-line-number="3322"></td>
          <td id="LC3322">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3323" data-line-number="3323"></td>
          <td id="LC3323">                End If</td>
        </tr>
        <tr>
          <td id="L3324" data-line-number="3324"></td>
          <td id="LC3324">                pvBufferReadArray uInput, .CertRequestContext, lSize</td>
        </tr>
        <tr>
          <td id="L3325" data-line-number="3325"></td>
          <td id="LC3325">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3326" data-line-number="3326"></td>
          <td id="LC3326">            If uInput.Pos + 2 &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3327" data-line-number="3327"></td>
          <td id="LC3327">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3328" data-line-number="3328"></td>
          <td id="LC3328">            End If</td>
        </tr>
        <tr>
          <td id="L3329" data-line-number="3329"></td>
          <td id="LC3329">            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L3330" data-line-number="3330"></td>
          <td id="LC3330">                lEnd = uInput.Pos + lSize</td>
        </tr>
        <tr>
          <td id="L3331" data-line-number="3331"></td>
          <td id="LC3331">                If lEnd &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3332" data-line-number="3332"></td>
          <td id="LC3332">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3333" data-line-number="3333"></td>
          <td id="LC3333">                End If</td>
        </tr>
        <tr>
          <td id="L3334" data-line-number="3334"></td>
          <td id="LC3334">                Do While uInput.Pos + 3 &lt; lEnd</td>
        </tr>
        <tr>
          <td id="L3335" data-line-number="3335"></td>
          <td id="LC3335">                    pvBufferReadLong uInput, lExtType, Size:=2</td>
        </tr>
        <tr>
          <td id="L3336" data-line-number="3336"></td>
          <td id="LC3336">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lExtSize</td>
        </tr>
        <tr>
          <td id="L3337" data-line-number="3337"></td>
          <td id="LC3337">                        lExtEnd = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L3338" data-line-number="3338"></td>
          <td id="LC3338">                        If lExtEnd &gt; lEnd Then</td>
        </tr>
        <tr>
          <td id="L3339" data-line-number="3339"></td>
          <td id="LC3339">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3340" data-line-number="3340"></td>
          <td id="LC3340">                        End If</td>
        </tr>
        <tr>
          <td id="L3341" data-line-number="3341"></td>
          <td id="LC3341">                        Select Case lExtType</td>
        </tr>
        <tr>
          <td id="L3342" data-line-number="3342"></td>
          <td id="LC3342">                        Case TLS_EXTENSION_SIGNATURE_ALGORITHMS</td>
        </tr>
        <tr>
          <td id="L3343" data-line-number="3343"></td>
          <td id="LC3343">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L3344" data-line-number="3344"></td>
          <td id="LC3344">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3345" data-line-number="3345"></td>
          <td id="LC3345">                            End If</td>
        </tr>
        <tr>
          <td id="L3346" data-line-number="3346"></td>
          <td id="LC3346">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3347" data-line-number="3347"></td>
          <td id="LC3347">                                If uInput.Pos + lBlockSize &lt;&gt; lExtEnd Or lBlockSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3348" data-line-number="3348"></td>
          <td id="LC3348">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3349" data-line-number="3349"></td>
          <td id="LC3349">                                End If</td>
        </tr>
        <tr>
          <td id="L3350" data-line-number="3350"></td>
          <td id="LC3350">                                pvBufferReadArray uInput, baSignatureSchemes, lBlockSize</td>
        </tr>
        <tr>
          <td id="L3351" data-line-number="3351"></td>
          <td id="LC3351">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3352" data-line-number="3352"></td>
          <td id="LC3352">                        Case TLS_EXTENSION_CERTIFICATE_AUTHORITIES</td>
        </tr>
        <tr>
          <td id="L3353" data-line-number="3353"></td>
          <td id="LC3353">                            If lExtSize &lt; 2 Then</td>
        </tr>
        <tr>
          <td id="L3354" data-line-number="3354"></td>
          <td id="LC3354">                                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3355" data-line-number="3355"></td>
          <td id="LC3355">                            End If</td>
        </tr>
        <tr>
          <td id="L3356" data-line-number="3356"></td>
          <td id="LC3356">                            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lBlockSize</td>
        </tr>
        <tr>
          <td id="L3357" data-line-number="3357"></td>
          <td id="LC3357">                                lBlockEnd = uInput.Pos + lBlockSize</td>
        </tr>
        <tr>
          <td id="L3358" data-line-number="3358"></td>
          <td id="LC3358">                                If lBlockEnd &lt;&gt; lExtEnd Or lBlockSize = 0 Or lBlockSize Mod 2 &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3359" data-line-number="3359"></td>
          <td id="LC3359">                                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3360" data-line-number="3360"></td>
          <td id="LC3360">                                End If</td>
        </tr>
        <tr>
          <td id="L3361" data-line-number="3361"></td>
          <td id="LC3361">                                Set .CertRequestCaDn = New Collection</td>
        </tr>
        <tr>
          <td id="L3362" data-line-number="3362"></td>
          <td id="LC3362">                                Do While uInput.Pos + 1 &lt; lBlockEnd</td>
        </tr>
        <tr>
          <td id="L3363" data-line-number="3363"></td>
          <td id="LC3363">                                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lDnSize</td>
        </tr>
        <tr>
          <td id="L3364" data-line-number="3364"></td>
          <td id="LC3364">                                        If uInput.Pos + lDnSize &gt; lBlockEnd Or lDnSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3365" data-line-number="3365"></td>
          <td id="LC3365">                                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3366" data-line-number="3366"></td>
          <td id="LC3366">                                        End If</td>
        </tr>
        <tr>
          <td id="L3367" data-line-number="3367"></td>
          <td id="LC3367">                                        pvBufferReadArray uInput, baDName, lDnSize</td>
        </tr>
        <tr>
          <td id="L3368" data-line-number="3368"></td>
          <td id="LC3368">                                        .CertRequestCaDn.Add baDName</td>
        </tr>
        <tr>
          <td id="L3369" data-line-number="3369"></td>
          <td id="LC3369">                                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3370" data-line-number="3370"></td>
          <td id="LC3370">                                Loop</td>
        </tr>
        <tr>
          <td id="L3371" data-line-number="3371"></td>
          <td id="LC3371">                            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3372" data-line-number="3372"></td>
          <td id="LC3372">                        Case Else</td>
        </tr>
        <tr>
          <td id="L3373" data-line-number="3373"></td>
          <td id="LC3373">                            uInput.Pos = uInput.Pos + lExtSize</td>
        </tr>
        <tr>
          <td id="L3374" data-line-number="3374"></td>
          <td id="LC3374">                        End Select</td>
        </tr>
        <tr>
          <td id="L3375" data-line-number="3375"></td>
          <td id="LC3375">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3376" data-line-number="3376"></td>
          <td id="LC3376">                Loop</td>
        </tr>
        <tr>
          <td id="L3377" data-line-number="3377"></td>
          <td id="LC3377">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3378" data-line-number="3378"></td>
          <td id="LC3378">        End If</td>
        </tr>
        <tr>
          <td id="L3379" data-line-number="3379"></td>
          <td id="LC3379">        If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L3380" data-line-number="3380"></td>
          <td id="LC3380">            If uInput.Pos + 1 &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3381" data-line-number="3381"></td>
          <td id="LC3381">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3382" data-line-number="3382"></td>
          <td id="LC3382">            End If</td>
        </tr>
        <tr>
          <td id="L3383" data-line-number="3383"></td>
          <td id="LC3383">            pvBufferReadBlockStart uInput, Size:=1, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L3384" data-line-number="3384"></td>
          <td id="LC3384">                If uInput.Pos + lSize &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3385" data-line-number="3385"></td>
          <td id="LC3385">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3386" data-line-number="3386"></td>
          <td id="LC3386">                End If</td>
        </tr>
        <tr>
          <td id="L3387" data-line-number="3387"></td>
          <td id="LC3387">                uInput.Pos = uInput.Pos + lSize &#39;--- skip certificate_types</td>
        </tr>
        <tr>
          <td id="L3388" data-line-number="3388"></td>
          <td id="LC3388">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3389" data-line-number="3389"></td>
          <td id="LC3389">            If uInput.Pos + 2 &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3390" data-line-number="3390"></td>
          <td id="LC3390">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3391" data-line-number="3391"></td>
          <td id="LC3391">            End If</td>
        </tr>
        <tr>
          <td id="L3392" data-line-number="3392"></td>
          <td id="LC3392">            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L3393" data-line-number="3393"></td>
          <td id="LC3393">                If uInput.Pos + lSize &gt; uInput.Size Or lSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3394" data-line-number="3394"></td>
          <td id="LC3394">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3395" data-line-number="3395"></td>
          <td id="LC3395">                End If</td>
        </tr>
        <tr>
          <td id="L3396" data-line-number="3396"></td>
          <td id="LC3396">                pvBufferReadArray uInput, baSignatureSchemes, lSize</td>
        </tr>
        <tr>
          <td id="L3397" data-line-number="3397"></td>
          <td id="LC3397">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3398" data-line-number="3398"></td>
          <td id="LC3398">            If uInput.Pos + 2 &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3399" data-line-number="3399"></td>
          <td id="LC3399">                GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3400" data-line-number="3400"></td>
          <td id="LC3400">            End If</td>
        </tr>
        <tr>
          <td id="L3401" data-line-number="3401"></td>
          <td id="LC3401">            pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lSize</td>
        </tr>
        <tr>
          <td id="L3402" data-line-number="3402"></td>
          <td id="LC3402">                lEnd = uInput.Pos + lSize</td>
        </tr>
        <tr>
          <td id="L3403" data-line-number="3403"></td>
          <td id="LC3403">                If lEnd &gt; uInput.Size Then</td>
        </tr>
        <tr>
          <td id="L3404" data-line-number="3404"></td>
          <td id="LC3404">                    GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3405" data-line-number="3405"></td>
          <td id="LC3405">                End If</td>
        </tr>
        <tr>
          <td id="L3406" data-line-number="3406"></td>
          <td id="LC3406">                Set .CertRequestCaDn = New Collection</td>
        </tr>
        <tr>
          <td id="L3407" data-line-number="3407"></td>
          <td id="LC3407">                Do While uInput.Pos + 1 &lt; lEnd</td>
        </tr>
        <tr>
          <td id="L3408" data-line-number="3408"></td>
          <td id="LC3408">                    pvBufferReadBlockStart uInput, Size:=2, BlockSize:=lDnSize</td>
        </tr>
        <tr>
          <td id="L3409" data-line-number="3409"></td>
          <td id="LC3409">                        If uInput.Pos + lDnSize &gt; lEnd Or lDnSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3410" data-line-number="3410"></td>
          <td id="LC3410">                            GoTo InvalidSize</td>
        </tr>
        <tr>
          <td id="L3411" data-line-number="3411"></td>
          <td id="LC3411">                        End If</td>
        </tr>
        <tr>
          <td id="L3412" data-line-number="3412"></td>
          <td id="LC3412">                        pvBufferReadArray uInput, baDName, lDnSize</td>
        </tr>
        <tr>
          <td id="L3413" data-line-number="3413"></td>
          <td id="LC3413">                        .CertRequestCaDn.Add baDName</td>
        </tr>
        <tr>
          <td id="L3414" data-line-number="3414"></td>
          <td id="LC3414">                    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3415" data-line-number="3415"></td>
          <td id="LC3415">                Loop</td>
        </tr>
        <tr>
          <td id="L3416" data-line-number="3416"></td>
          <td id="LC3416">            pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L3417" data-line-number="3417"></td>
          <td id="LC3417">        End If</td>
        </tr>
        <tr>
          <td id="L3418" data-line-number="3418"></td>
          <td id="LC3418">        Do</td>
        </tr>
        <tr>
          <td id="L3419" data-line-number="3419"></td>
          <td id="LC3419">            If Not pvAsn1DecodePrivateKey(.LocalCertificates, .LocalPrivateKey, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L3420" data-line-number="3420"></td>
          <td id="LC3420">                GoTo UnsupportedPrivateKey</td>
        </tr>
        <tr>
          <td id="L3421" data-line-number="3421"></td>
          <td id="LC3421">            End If</td>
        </tr>
        <tr>
          <td id="L3422" data-line-number="3422"></td>
          <td id="LC3422">            .CertRequestSignatureScheme = -1</td>
        </tr>
        <tr>
          <td id="L3423" data-line-number="3423"></td>
          <td id="LC3423">            lSigPos = 0</td>
        </tr>
        <tr>
          <td id="L3424" data-line-number="3424"></td>
          <td id="LC3424">            Do While lSigPos &lt; pvArraySize(baSignatureSchemes)</td>
        </tr>
        <tr>
          <td id="L3425" data-line-number="3425"></td>
          <td id="LC3425">                lSignatureScheme = baSignatureSchemes(lSigPos) * &amp;H100&amp; + baSignatureSchemes(lSigPos + 1)</td>
        </tr>
        <tr>
          <td id="L3426" data-line-number="3426"></td>
          <td id="LC3426">                lSigPos = lSigPos + 2</td>
        </tr>
        <tr>
          <td id="L3427" data-line-number="3427"></td>
          <td id="LC3427">                If pvTlsMatchSignatureScheme(uCtx, lSignatureScheme, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L3428" data-line-number="3428"></td>
          <td id="LC3428">                    .CertRequestSignatureScheme = lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L3429" data-line-number="3429"></td>
          <td id="LC3429">                    Exit Do</td>
        </tr>
        <tr>
          <td id="L3430" data-line-number="3430"></td>
          <td id="LC3430">                End If</td>
        </tr>
        <tr>
          <td id="L3431" data-line-number="3431"></td>
          <td id="LC3431">            Loop</td>
        </tr>
        <tr>
          <td id="L3432" data-line-number="3432"></td>
          <td id="LC3432">            bConfirmed = False</td>
        </tr>
        <tr>
          <td id="L3433" data-line-number="3433"></td>
          <td id="LC3433">            If .CertRequestSignatureScheme = -1 And .ClientCertCallback &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3434" data-line-number="3434"></td>
          <td id="LC3434">                Call vbaObjSetAddref(oCallback, .ClientCertCallback)</td>
        </tr>
        <tr>
          <td id="L3435" data-line-number="3435"></td>
          <td id="LC3435">                bConfirmed = oCallback.FireOnCertificate(.CertRequestCaDn)</td>
        </tr>
        <tr>
          <td id="L3436" data-line-number="3436"></td>
          <td id="LC3436">            End If</td>
        </tr>
        <tr>
          <td id="L3437" data-line-number="3437"></td>
          <td id="LC3437">        Loop While bConfirmed</td>
        </tr>
        <tr>
          <td id="L3438" data-line-number="3438"></td>
          <td id="LC3438">    End With</td>
        </tr>
        <tr>
          <td id="L3439" data-line-number="3439"></td>
          <td id="LC3439">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L3440" data-line-number="3440"></td>
          <td id="LC3440">    pvTlsParseHandshakeCertificateRequest = True</td>
        </tr>
        <tr>
          <td id="L3441" data-line-number="3441"></td>
          <td id="LC3441">QH:</td>
        </tr>
        <tr>
          <td id="L3442" data-line-number="3442"></td>
          <td id="LC3442">    If uKeyInfo.hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3443" data-line-number="3443"></td>
          <td id="LC3443">        Call CryptDestroyKey(uKeyInfo.hKey)</td>
        </tr>
        <tr>
          <td id="L3444" data-line-number="3444"></td>
          <td id="LC3444">    End If</td>
        </tr>
        <tr>
          <td id="L3445" data-line-number="3445"></td>
          <td id="LC3445">    If uKeyInfo.hProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3446" data-line-number="3446"></td>
          <td id="LC3446">        Call CryptReleaseContext(uKeyInfo.hProv, 0)</td>
        </tr>
        <tr>
          <td id="L3447" data-line-number="3447"></td>
          <td id="LC3447">    End If</td>
        </tr>
        <tr>
          <td id="L3448" data-line-number="3448"></td>
          <td id="LC3448">    If uKeyInfo.hNKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3449" data-line-number="3449"></td>
          <td id="LC3449">        Call NCryptFreeObject(uKeyInfo.hNKey)</td>
        </tr>
        <tr>
          <td id="L3450" data-line-number="3450"></td>
          <td id="LC3450">    End If</td>
        </tr>
        <tr>
          <td id="L3451" data-line-number="3451"></td>
          <td id="LC3451">    Exit Function</td>
        </tr>
        <tr>
          <td id="L3452" data-line-number="3452"></td>
          <td id="LC3452">UnsupportedPrivateKey:</td>
        </tr>
        <tr>
          <td id="L3453" data-line-number="3453"></td>
          <td id="LC3453">    sError = ERR_UNSUPPORTED_PRIVATE_KEY</td>
        </tr>
        <tr>
          <td id="L3454" data-line-number="3454"></td>
          <td id="LC3454">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L3455" data-line-number="3455"></td>
          <td id="LC3455">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3456" data-line-number="3456"></td>
          <td id="LC3456">InvalidSize:</td>
        </tr>
        <tr>
          <td id="L3457" data-line-number="3457"></td>
          <td id="LC3457">    sError = IIf(lExtType &lt; 0, ERR_INVALID_SIZE, Replace(ERR_INVALID_SIZE_EXTENSION, &#34;%1&#34;, pvTlsGetExtensionName(lExtType)))</td>
        </tr>
        <tr>
          <td id="L3458" data-line-number="3458"></td>
          <td id="LC3458">    eAlertCode = uscTlsAlertDecodeError</td>
        </tr>
        <tr>
          <td id="L3459" data-line-number="3459"></td>
          <td id="LC3459">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L3460" data-line-number="3460"></td>
          <td id="LC3460">EH:</td>
        </tr>
        <tr>
          <td id="L3461" data-line-number="3461"></td>
          <td id="LC3461">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L3462" data-line-number="3462"></td>
          <td id="LC3462">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L3463" data-line-number="3463"></td>
          <td id="LC3463">    Resume QH</td>
        </tr>
        <tr>
          <td id="L3464" data-line-number="3464"></td>
          <td id="LC3464">End Function</td>
        </tr>
        <tr>
          <td id="L3465" data-line-number="3465"></td>
          <td id="LC3465">
</td>
        </tr>
        <tr>
          <td id="L3466" data-line-number="3466"></td>
          <td id="LC3466">Private Function pvTlsMatchSignatureScheme(uCtx As UcsTlsContext, ByVal lSignatureScheme As Long, uKeyInfo As UcsKeyInfo) As Boolean</td>
        </tr>
        <tr>
          <td id="L3467" data-line-number="3467"></td>
          <td id="LC3467">    Dim bHasEnoughBits  As Boolean</td>
        </tr>
        <tr>
          <td id="L3468" data-line-number="3468"></td>
          <td id="LC3468">     </td>
        </tr>
        <tr>
          <td id="L3469" data-line-number="3469"></td>
          <td id="LC3469">    Select Case lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L3470" data-line-number="3470"></td>
          <td id="LC3470">    Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA256, TLS_SIGNATURE_RSA_PSS_RSAE_SHA384, TLS_SIGNATURE_RSA_PSS_RSAE_SHA512, _</td>
        </tr>
        <tr>
          <td id="L3471" data-line-number="3471"></td>
          <td id="LC3471">            TLS_SIGNATURE_RSA_PSS_PSS_SHA256, TLS_SIGNATURE_RSA_PSS_PSS_SHA384, TLS_SIGNATURE_RSA_PSS_PSS_SHA512</td>
        </tr>
        <tr>
          <td id="L3472" data-line-number="3472"></td>
          <td id="LC3472">        &#39;--- PSS w/ SHA512 fails on short key lengths (min PSS size is 2 + lHashSize + lSaltSize where lSaltSize=lHashSize)</td>
        </tr>
        <tr>
          <td id="L3473" data-line-number="3473"></td>
          <td id="LC3473">        bHasEnoughBits = (uKeyInfo.BitLen + 7) \ 8 &gt; 2 + 2 * pvTlsSignatureHashSize(lSignatureScheme)</td>
        </tr>
        <tr>
          <td id="L3474" data-line-number="3474"></td>
          <td id="LC3474">    End Select</td>
        </tr>
        <tr>
          <td id="L3475" data-line-number="3475"></td>
          <td id="LC3475">    Select Case lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L3476" data-line-number="3476"></td>
          <td id="LC3476">    Case TLS_SIGNATURE_RSA_PKCS1_SHA1</td>
        </tr>
        <tr>
          <td id="L3477" data-line-number="3477"></td>
          <td id="LC3477">        If (uCtx.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 And uCtx.ProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L3478" data-line-number="3478"></td>
          <td id="LC3478">            If uKeyInfo.AlgoObjId = szOID_RSA_RSA Then</td>
        </tr>
        <tr>
          <td id="L3479" data-line-number="3479"></td>
          <td id="LC3479">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs) And pvCryptoIsSupported(ucsTlsAlgoDigestSha1)</td>
        </tr>
        <tr>
          <td id="L3480" data-line-number="3480"></td>
          <td id="LC3480">            End If</td>
        </tr>
        <tr>
          <td id="L3481" data-line-number="3481"></td>
          <td id="LC3481">        End If</td>
        </tr>
        <tr>
          <td id="L3482" data-line-number="3482"></td>
          <td id="LC3482">    Case TLS_SIGNATURE_RSA_PKCS1_SHA224, TLS_SIGNATURE_RSA_PKCS1_SHA256, TLS_SIGNATURE_RSA_PKCS1_SHA384, TLS_SIGNATURE_RSA_PKCS1_SHA512</td>
        </tr>
        <tr>
          <td id="L3483" data-line-number="3483"></td>
          <td id="LC3483">        If (uCtx.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 And uCtx.ProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS13 And (uKeyInfo.hProv = 0 Or OsVersion &gt;= ucsOsvXp) Then</td>
        </tr>
        <tr>
          <td id="L3484" data-line-number="3484"></td>
          <td id="LC3484">            If uKeyInfo.AlgoObjId = szOID_RSA_RSA Then</td>
        </tr>
        <tr>
          <td id="L3485" data-line-number="3485"></td>
          <td id="LC3485">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoPaddingPkcs)</td>
        </tr>
        <tr>
          <td id="L3486" data-line-number="3486"></td>
          <td id="LC3486">            End If</td>
        </tr>
        <tr>
          <td id="L3487" data-line-number="3487"></td>
          <td id="LC3487">        End If</td>
        </tr>
        <tr>
          <td id="L3488" data-line-number="3488"></td>
          <td id="LC3488">    Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA256, TLS_SIGNATURE_RSA_PSS_RSAE_SHA384, TLS_SIGNATURE_RSA_PSS_RSAE_SHA512</td>
        </tr>
        <tr>
          <td id="L3489" data-line-number="3489"></td>
          <td id="LC3489">        If bHasEnoughBits And uKeyInfo.hProv = 0 Then</td>
        </tr>
        <tr>
          <td id="L3490" data-line-number="3490"></td>
          <td id="LC3490">            If uKeyInfo.AlgoObjId = szOID_RSA_RSA Then</td>
        </tr>
        <tr>
          <td id="L3491" data-line-number="3491"></td>
          <td id="LC3491">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoPaddingPss)</td>
        </tr>
        <tr>
          <td id="L3492" data-line-number="3492"></td>
          <td id="LC3492">            End If</td>
        </tr>
        <tr>
          <td id="L3493" data-line-number="3493"></td>
          <td id="LC3493">        End If</td>
        </tr>
        <tr>
          <td id="L3494" data-line-number="3494"></td>
          <td id="LC3494">    Case TLS_SIGNATURE_RSA_PSS_PSS_SHA256, TLS_SIGNATURE_RSA_PSS_PSS_SHA384, TLS_SIGNATURE_RSA_PSS_PSS_SHA512</td>
        </tr>
        <tr>
          <td id="L3495" data-line-number="3495"></td>
          <td id="LC3495">        If bHasEnoughBits And uKeyInfo.hProv = 0 Then</td>
        </tr>
        <tr>
          <td id="L3496" data-line-number="3496"></td>
          <td id="LC3496">            If uKeyInfo.AlgoObjId = szOID_RSA_SSA_PSS Then</td>
        </tr>
        <tr>
          <td id="L3497" data-line-number="3497"></td>
          <td id="LC3497">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoPaddingPss)</td>
        </tr>
        <tr>
          <td id="L3498" data-line-number="3498"></td>
          <td id="LC3498">            End If</td>
        </tr>
        <tr>
          <td id="L3499" data-line-number="3499"></td>
          <td id="LC3499">        End If</td>
        </tr>
        <tr>
          <td id="L3500" data-line-number="3500"></td>
          <td id="LC3500">    Case TLS_SIGNATURE_ECDSA_SHA1</td>
        </tr>
        <tr>
          <td id="L3501" data-line-number="3501"></td>
          <td id="LC3501">        If (uCtx.LocalFeatures And ucsTlsSupportTls12) &lt;&gt; 0 And uCtx.ProtocolVersion &lt;&gt; TLS_PROTOCOL_VERSION_TLS13 And uKeyInfo.hProv = 0 Then</td>
        </tr>
        <tr>
          <td id="L3502" data-line-number="3502"></td>
          <td id="LC3502">            If uKeyInfo.AlgoObjId = szOID_ECC_PUBLIC_KEY Then</td>
        </tr>
        <tr>
          <td id="L3503" data-line-number="3503"></td>
          <td id="LC3503">                pvTlsMatchSignatureScheme = True</td>
        </tr>
        <tr>
          <td id="L3504" data-line-number="3504"></td>
          <td id="LC3504">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P256 Then</td>
        </tr>
        <tr>
          <td id="L3505" data-line-number="3505"></td>
          <td id="LC3505">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</td>
        </tr>
        <tr>
          <td id="L3506" data-line-number="3506"></td>
          <td id="LC3506">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P384 Then</td>
        </tr>
        <tr>
          <td id="L3507" data-line-number="3507"></td>
          <td id="LC3507">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</td>
        </tr>
        <tr>
          <td id="L3508" data-line-number="3508"></td>
          <td id="LC3508">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P521 Then</td>
        </tr>
        <tr>
          <td id="L3509" data-line-number="3509"></td>
          <td id="LC3509">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoExchSecp521r1)</td>
        </tr>
        <tr>
          <td id="L3510" data-line-number="3510"></td>
          <td id="LC3510">            End If</td>
        </tr>
        <tr>
          <td id="L3511" data-line-number="3511"></td>
          <td id="LC3511">        End If</td>
        </tr>
        <tr>
          <td id="L3512" data-line-number="3512"></td>
          <td id="LC3512">    Case TLS_SIGNATURE_ECDSA_SECP256R1_SHA256, TLS_SIGNATURE_ECDSA_SECP384R1_SHA384, TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</td>
        </tr>
        <tr>
          <td id="L3513" data-line-number="3513"></td>
          <td id="LC3513">        If uKeyInfo.hProv = 0 Then</td>
        </tr>
        <tr>
          <td id="L3514" data-line-number="3514"></td>
          <td id="LC3514">            If uKeyInfo.AlgoObjId = szOID_ECC_PUBLIC_KEY Then</td>
        </tr>
        <tr>
          <td id="L3515" data-line-number="3515"></td>
          <td id="LC3515">                pvTlsMatchSignatureScheme = True</td>
        </tr>
        <tr>
          <td id="L3516" data-line-number="3516"></td>
          <td id="LC3516">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P256 And lSignatureScheme = TLS_SIGNATURE_ECDSA_SECP256R1_SHA256 Then</td>
        </tr>
        <tr>
          <td id="L3517" data-line-number="3517"></td>
          <td id="LC3517">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoExchSecp256r1)</td>
        </tr>
        <tr>
          <td id="L3518" data-line-number="3518"></td>
          <td id="LC3518">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P384 And lSignatureScheme = TLS_SIGNATURE_ECDSA_SECP384R1_SHA384 Then</td>
        </tr>
        <tr>
          <td id="L3519" data-line-number="3519"></td>
          <td id="LC3519">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoExchSecp384r1)</td>
        </tr>
        <tr>
          <td id="L3520" data-line-number="3520"></td>
          <td id="LC3520">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P521 And lSignatureScheme = TLS_SIGNATURE_ECDSA_SECP521R1_SHA512 Then</td>
        </tr>
        <tr>
          <td id="L3521" data-line-number="3521"></td>
          <td id="LC3521">                pvTlsMatchSignatureScheme = pvCryptoIsSupported(ucsTlsAlgoExchSecp521r1)</td>
        </tr>
        <tr>
          <td id="L3522" data-line-number="3522"></td>
          <td id="LC3522">            End If</td>
        </tr>
        <tr>
          <td id="L3523" data-line-number="3523"></td>
          <td id="LC3523">        End If</td>
        </tr>
        <tr>
          <td id="L3524" data-line-number="3524"></td>
          <td id="LC3524">    End Select</td>
        </tr>
        <tr>
          <td id="L3525" data-line-number="3525"></td>
          <td id="LC3525">End Function</td>
        </tr>
        <tr>
          <td id="L3526" data-line-number="3526"></td>
          <td id="LC3526">
</td>
        </tr>
        <tr>
          <td id="L3527" data-line-number="3527"></td>
          <td id="LC3527">Private Function pvTlsCheckRemoteKey(ByVal lExchGroup As Long, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L3528" data-line-number="3528"></td>
          <td id="LC3528">    Const FUNC_NAME     As String = &#34;pvTlsCheckRemoteKey&#34;</td>
        </tr>
        <tr>
          <td id="L3529" data-line-number="3529"></td>
          <td id="LC3529">    Dim baCompr()       As Byte</td>
        </tr>
        <tr>
          <td id="L3530" data-line-number="3530"></td>
          <td id="LC3530">    Dim baUncompr()     As Byte</td>
        </tr>
        <tr>
          <td id="L3531" data-line-number="3531"></td>
          <td id="LC3531">    </td>
        </tr>
        <tr>
          <td id="L3532" data-line-number="3532"></td>
          <td id="LC3532">    Select Case lExchGroup</td>
        </tr>
        <tr>
          <td id="L3533" data-line-number="3533"></td>
          <td id="LC3533">    Case TLS_GROUP_X25519</td>
        </tr>
        <tr>
          <td id="L3534" data-line-number="3534"></td>
          <td id="LC3534">        If pvArraySize(baPublic) &lt;&gt; LNG_X25519_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L3535" data-line-number="3535"></td>
          <td id="LC3535">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3536" data-line-number="3536"></td>
          <td id="LC3536">        End If</td>
        </tr>
        <tr>
          <td id="L3537" data-line-number="3537"></td>
          <td id="LC3537">        &#39;--- check empty key share</td>
        </tr>
        <tr>
          <td id="L3538" data-line-number="3538"></td>
          <td id="LC3538">        If pvArrayAccumulateOr(baPublic) = 0 Then</td>
        </tr>
        <tr>
          <td id="L3539" data-line-number="3539"></td>
          <td id="LC3539">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3540" data-line-number="3540"></td>
          <td id="LC3540">        End If</td>
        </tr>
        <tr>
          <td id="L3541" data-line-number="3541"></td>
          <td id="LC3541">        &#39;--- check key share of &#34;1&#34;</td>
        </tr>
        <tr>
          <td id="L3542" data-line-number="3542"></td>
          <td id="LC3542">        If pvArrayAccumulateOr(baPublic, Pos:=1) = 0 And baPublic(0) = 1 Then</td>
        </tr>
        <tr>
          <td id="L3543" data-line-number="3543"></td>
          <td id="LC3543">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3544" data-line-number="3544"></td>
          <td id="LC3544">        End If</td>
        </tr>
        <tr>
          <td id="L3545" data-line-number="3545"></td>
          <td id="LC3545">    Case TLS_GROUP_SECP256R1</td>
        </tr>
        <tr>
          <td id="L3546" data-line-number="3546"></td>
          <td id="LC3546">        If pvArraySize(baPublic) &lt;&gt; 2 * LNG_SECP256R1_KEYSZ + 1 Then</td>
        </tr>
        <tr>
          <td id="L3547" data-line-number="3547"></td>
          <td id="LC3547">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3548" data-line-number="3548"></td>
          <td id="LC3548">        End If</td>
        </tr>
        <tr>
          <td id="L3549" data-line-number="3549"></td>
          <td id="LC3549">        If baPublic(0) &lt;&gt; 4 Then</td>
        </tr>
        <tr>
          <td id="L3550" data-line-number="3550"></td>
          <td id="LC3550">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3551" data-line-number="3551"></td>
          <td id="LC3551">        End If</td>
        </tr>
        <tr>
          <td id="L3552" data-line-number="3552"></td>
          <td id="LC3552">        pvArrayAllocate baCompr, 1 + LNG_SECP256R1_KEYSZ, FUNC_NAME &amp; &#34;.baCompr&#34;</td>
        </tr>
        <tr>
          <td id="L3553" data-line-number="3553"></td>
          <td id="LC3553">        baCompr(0) = 2 &#39;--- compressed positive</td>
        </tr>
        <tr>
          <td id="L3554" data-line-number="3554"></td>
          <td id="LC3554">        Call CopyMemory(baCompr(1), baPublic(1), LNG_SECP256R1_KEYSZ)</td>
        </tr>
        <tr>
          <td id="L3555" data-line-number="3555"></td>
          <td id="LC3555">        If Not pvCryptoEcdhSecp256r1UncompressKey(baUncompr, baCompr) Then</td>
        </tr>
        <tr>
          <td id="L3556" data-line-number="3556"></td>
          <td id="LC3556">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3557" data-line-number="3557"></td>
          <td id="LC3557">        End If</td>
        </tr>
        <tr>
          <td id="L3558" data-line-number="3558"></td>
          <td id="LC3558">        If Not pvArrayEqual(baUncompr, baPublic) Then</td>
        </tr>
        <tr>
          <td id="L3559" data-line-number="3559"></td>
          <td id="LC3559">            baCompr(0) = 3 &#39;--- compressed negative</td>
        </tr>
        <tr>
          <td id="L3560" data-line-number="3560"></td>
          <td id="LC3560">            If Not pvCryptoEcdhSecp256r1UncompressKey(baUncompr, baCompr) Then</td>
        </tr>
        <tr>
          <td id="L3561" data-line-number="3561"></td>
          <td id="LC3561">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L3562" data-line-number="3562"></td>
          <td id="LC3562">            End If</td>
        </tr>
        <tr>
          <td id="L3563" data-line-number="3563"></td>
          <td id="LC3563">            If Not pvArrayEqual(baUncompr, baPublic) Then</td>
        </tr>
        <tr>
          <td id="L3564" data-line-number="3564"></td>
          <td id="LC3564">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L3565" data-line-number="3565"></td>
          <td id="LC3565">            End If</td>
        </tr>
        <tr>
          <td id="L3566" data-line-number="3566"></td>
          <td id="LC3566">        End If</td>
        </tr>
        <tr>
          <td id="L3567" data-line-number="3567"></td>
          <td id="LC3567">    Case TLS_GROUP_SECP384R1</td>
        </tr>
        <tr>
          <td id="L3568" data-line-number="3568"></td>
          <td id="LC3568">        If pvArraySize(baPublic) &lt;&gt; 2 * LNG_SECP384R1_KEYSZ + 1 Then</td>
        </tr>
        <tr>
          <td id="L3569" data-line-number="3569"></td>
          <td id="LC3569">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3570" data-line-number="3570"></td>
          <td id="LC3570">        End If</td>
        </tr>
        <tr>
          <td id="L3571" data-line-number="3571"></td>
          <td id="LC3571">        If baPublic(0) &lt;&gt; 4 Then</td>
        </tr>
        <tr>
          <td id="L3572" data-line-number="3572"></td>
          <td id="LC3572">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3573" data-line-number="3573"></td>
          <td id="LC3573">        End If</td>
        </tr>
        <tr>
          <td id="L3574" data-line-number="3574"></td>
          <td id="LC3574">        pvArrayAllocate baCompr, 1 + LNG_SECP384R1_KEYSZ, FUNC_NAME &amp; &#34;.baCompr&#34;</td>
        </tr>
        <tr>
          <td id="L3575" data-line-number="3575"></td>
          <td id="LC3575">        baCompr(0) = 2 &#39;--- compressed positive</td>
        </tr>
        <tr>
          <td id="L3576" data-line-number="3576"></td>
          <td id="LC3576">        Call CopyMemory(baCompr(1), baPublic(1), LNG_SECP384R1_KEYSZ)</td>
        </tr>
        <tr>
          <td id="L3577" data-line-number="3577"></td>
          <td id="LC3577">        If Not pvCryptoEcdhSecp384r1UncompressKey(baUncompr, baCompr) Then</td>
        </tr>
        <tr>
          <td id="L3578" data-line-number="3578"></td>
          <td id="LC3578">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3579" data-line-number="3579"></td>
          <td id="LC3579">        End If</td>
        </tr>
        <tr>
          <td id="L3580" data-line-number="3580"></td>
          <td id="LC3580">        If Not pvArrayEqual(baUncompr, baPublic) Then</td>
        </tr>
        <tr>
          <td id="L3581" data-line-number="3581"></td>
          <td id="LC3581">            baCompr(0) = 3 &#39;--- compressed negative</td>
        </tr>
        <tr>
          <td id="L3582" data-line-number="3582"></td>
          <td id="LC3582">            If Not pvCryptoEcdhSecp384r1UncompressKey(baUncompr, baCompr) Then</td>
        </tr>
        <tr>
          <td id="L3583" data-line-number="3583"></td>
          <td id="LC3583">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L3584" data-line-number="3584"></td>
          <td id="LC3584">            End If</td>
        </tr>
        <tr>
          <td id="L3585" data-line-number="3585"></td>
          <td id="LC3585">            If Not pvArrayEqual(baUncompr, baPublic) Then</td>
        </tr>
        <tr>
          <td id="L3586" data-line-number="3586"></td>
          <td id="LC3586">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L3587" data-line-number="3587"></td>
          <td id="LC3587">            End If</td>
        </tr>
        <tr>
          <td id="L3588" data-line-number="3588"></td>
          <td id="LC3588">        End If</td>
        </tr>
        <tr>
          <td id="L3589" data-line-number="3589"></td>
          <td id="LC3589">    End Select</td>
        </tr>
        <tr>
          <td id="L3590" data-line-number="3590"></td>
          <td id="LC3590">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L3591" data-line-number="3591"></td>
          <td id="LC3591">    pvTlsCheckRemoteKey = True</td>
        </tr>
        <tr>
          <td id="L3592" data-line-number="3592"></td>
          <td id="LC3592">QH:</td>
        </tr>
        <tr>
          <td id="L3593" data-line-number="3593"></td>
          <td id="LC3593">End Function</td>
        </tr>
        <tr>
          <td id="L3594" data-line-number="3594"></td>
          <td id="LC3594">
</td>
        </tr>
        <tr>
          <td id="L3595" data-line-number="3595"></td>
          <td id="LC3595">Private Sub pvTlsSetupExchGroup(uCtx As UcsTlsContext, ByVal lExchGroup As Long)</td>
        </tr>
        <tr>
          <td id="L3596" data-line-number="3596"></td>
          <td id="LC3596">    Const FUNC_NAME     As String = &#34;pvTlsSetupExchGroup&#34;</td>
        </tr>
        <tr>
          <td id="L3597" data-line-number="3597"></td>
          <td id="LC3597">    </td>
        </tr>
        <tr>
          <td id="L3598" data-line-number="3598"></td>
          <td id="LC3598">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3599" data-line-number="3599"></td>
          <td id="LC3599">        If .ExchGroup &lt;&gt; lExchGroup Then</td>
        </tr>
        <tr>
          <td id="L3600" data-line-number="3600"></td>
          <td id="LC3600">            .ExchGroup = lExchGroup</td>
        </tr>
        <tr>
          <td id="L3601" data-line-number="3601"></td>
          <td id="LC3601">            Select Case lExchGroup</td>
        </tr>
        <tr>
          <td id="L3602" data-line-number="3602"></td>
          <td id="LC3602">            Case TLS_GROUP_X25519</td>
        </tr>
        <tr>
          <td id="L3603" data-line-number="3603"></td>
          <td id="LC3603">                .ExchAlgo = ucsTlsAlgoExchX25519</td>
        </tr>
        <tr>
          <td id="L3604" data-line-number="3604"></td>
          <td id="LC3604">                If Not pvCryptoEcdhCurve25519MakeKey(.LocalExchPrivate, .LocalExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L3605" data-line-number="3605"></td>
          <td id="LC3605">                    ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_GENER_KEYPAIR_FAILED, &#34;%1&#34;, &#34;Curve25519&#34;)</td>
        </tr>
        <tr>
          <td id="L3606" data-line-number="3606"></td>
          <td id="LC3606">                End If</td>
        </tr>
        <tr>
          <td id="L3607" data-line-number="3607"></td>
          <td id="LC3607">            Case TLS_GROUP_SECP256R1</td>
        </tr>
        <tr>
          <td id="L3608" data-line-number="3608"></td>
          <td id="LC3608">                .ExchAlgo = ucsTlsAlgoExchSecp256r1</td>
        </tr>
        <tr>
          <td id="L3609" data-line-number="3609"></td>
          <td id="LC3609">                If Not pvCryptoEcdhSecp256r1MakeKey(.LocalExchPrivate, .LocalExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L3610" data-line-number="3610"></td>
          <td id="LC3610">                    ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_GENER_KEYPAIR_FAILED, &#34;%1&#34;, &#34;secp256r1&#34;)</td>
        </tr>
        <tr>
          <td id="L3611" data-line-number="3611"></td>
          <td id="LC3611">                End If</td>
        </tr>
        <tr>
          <td id="L3612" data-line-number="3612"></td>
          <td id="LC3612">            Case TLS_GROUP_SECP384R1</td>
        </tr>
        <tr>
          <td id="L3613" data-line-number="3613"></td>
          <td id="LC3613">                .ExchAlgo = ucsTlsAlgoExchSecp384r1</td>
        </tr>
        <tr>
          <td id="L3614" data-line-number="3614"></td>
          <td id="LC3614">                If Not pvCryptoEcdhSecp384r1MakeKey(.LocalExchPrivate, .LocalExchPublic) Then</td>
        </tr>
        <tr>
          <td id="L3615" data-line-number="3615"></td>
          <td id="LC3615">                    ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_GENER_KEYPAIR_FAILED, &#34;%1&#34;, &#34;secp384r1&#34;)</td>
        </tr>
        <tr>
          <td id="L3616" data-line-number="3616"></td>
          <td id="LC3616">                End If</td>
        </tr>
        <tr>
          <td id="L3617" data-line-number="3617"></td>
          <td id="LC3617">            Case Else</td>
        </tr>
        <tr>
          <td id="L3618" data-line-number="3618"></td>
          <td id="LC3618">                ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_UNSUPPORTED_EXCH_GROUP, &#34;%1&#34;, pvTlsGetExchGroupName(.ExchGroup))</td>
        </tr>
        <tr>
          <td id="L3619" data-line-number="3619"></td>
          <td id="LC3619">            End Select</td>
        </tr>
        <tr>
          <td id="L3620" data-line-number="3620"></td>
          <td id="LC3620">        End If</td>
        </tr>
        <tr>
          <td id="L3621" data-line-number="3621"></td>
          <td id="LC3621">    End With</td>
        </tr>
        <tr>
          <td id="L3622" data-line-number="3622"></td>
          <td id="LC3622">End Sub</td>
        </tr>
        <tr>
          <td id="L3623" data-line-number="3623"></td>
          <td id="LC3623">
</td>
        </tr>
        <tr>
          <td id="L3624" data-line-number="3624"></td>
          <td id="LC3624">Private Sub pvTlsSetupExchRsaCertificate(uCtx As UcsTlsContext, baCert() As Byte)</td>
        </tr>
        <tr>
          <td id="L3625" data-line-number="3625"></td>
          <td id="LC3625">    Const FUNC_NAME     As String = &#34;pvTlsSetupExchRsaCertificate&#34;</td>
        </tr>
        <tr>
          <td id="L3626" data-line-number="3626"></td>
          <td id="LC3626">    Dim uCertInfo       As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L3627" data-line-number="3627"></td>
          <td id="LC3627">    Dim baEnc()         As Byte</td>
        </tr>
        <tr>
          <td id="L3628" data-line-number="3628"></td>
          <td id="LC3628">    </td>
        </tr>
        <tr>
          <td id="L3629" data-line-number="3629"></td>
          <td id="LC3629">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3630" data-line-number="3630"></td>
          <td id="LC3630">        .ExchAlgo = ucsTlsAlgoExchCertificate</td>
        </tr>
        <tr>
          <td id="L3631" data-line-number="3631"></td>
          <td id="LC3631">        pvTlsGetRandom .LocalExchPrivate, TLS_LEGACY_SECRET_SIZE</td>
        </tr>
        <tr>
          <td id="L3632" data-line-number="3632"></td>
          <td id="LC3632">        Call CopyMemory(.LocalExchPrivate(0), TLS_LOCAL_LEGACY_VERSION, 2)</td>
        </tr>
        <tr>
          <td id="L3633" data-line-number="3633"></td>
          <td id="LC3633">        If Not pvAsn1DecodeCertificate(baCert, uCertInfo) Then</td>
        </tr>
        <tr>
          <td id="L3634" data-line-number="3634"></td>
          <td id="LC3634">            ErrRaise vbObjectError, FUNC_NAME, ERR_UNSUPPORTED_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L3635" data-line-number="3635"></td>
          <td id="LC3635">        End If</td>
        </tr>
        <tr>
          <td id="L3636" data-line-number="3636"></td>
          <td id="LC3636">        If Not pvCryptoEmePkcs1Encode(baEnc, .LocalExchPrivate, uCertInfo.BitLen) Then</td>
        </tr>
        <tr>
          <td id="L3637" data-line-number="3637"></td>
          <td id="LC3637">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEmePkcs1Encode&#34;)</td>
        </tr>
        <tr>
          <td id="L3638" data-line-number="3638"></td>
          <td id="LC3638">        End If</td>
        </tr>
        <tr>
          <td id="L3639" data-line-number="3639"></td>
          <td id="LC3639">        If Not pvCryptoRsaModExp(baEnc, uCertInfo.PubExp, uCertInfo.Modulus, .LocalExchRsaEncrPriv) Then</td>
        </tr>
        <tr>
          <td id="L3640" data-line-number="3640"></td>
          <td id="LC3640">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoRsaModExp&#34;)</td>
        </tr>
        <tr>
          <td id="L3641" data-line-number="3641"></td>
          <td id="LC3641">        End If</td>
        </tr>
        <tr>
          <td id="L3642" data-line-number="3642"></td>
          <td id="LC3642">    End With</td>
        </tr>
        <tr>
          <td id="L3643" data-line-number="3643"></td>
          <td id="LC3643">End Sub</td>
        </tr>
        <tr>
          <td id="L3644" data-line-number="3644"></td>
          <td id="LC3644">
</td>
        </tr>
        <tr>
          <td id="L3645" data-line-number="3645"></td>
          <td id="LC3645">Private Sub pvTlsSetupExchRsaPreMasterSecret(uCtx As UcsTlsContext, baEnc() As Byte)</td>
        </tr>
        <tr>
          <td id="L3646" data-line-number="3646"></td>
          <td id="LC3646">    Const FUNC_NAME     As String = &#34;pvTlsSetupExchRsaPreMasterSecret&#34;</td>
        </tr>
        <tr>
          <td id="L3647" data-line-number="3647"></td>
          <td id="LC3647">    Dim uKeyInfo        As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L3648" data-line-number="3648"></td>
          <td id="LC3648">    Dim baDec()         As Byte</td>
        </tr>
        <tr>
          <td id="L3649" data-line-number="3649"></td>
          <td id="LC3649">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L3650" data-line-number="3650"></td>
          <td id="LC3650">    Dim lVersion        As Long</td>
        </tr>
        <tr>
          <td id="L3651" data-line-number="3651"></td>
          <td id="LC3651">    Dim hResult         As Long</td>
        </tr>
        <tr>
          <td id="L3652" data-line-number="3652"></td>
          <td id="LC3652">    Dim sErrDesc        As String</td>
        </tr>
        <tr>
          <td id="L3653" data-line-number="3653"></td>
          <td id="LC3653">    </td>
        </tr>
        <tr>
          <td id="L3654" data-line-number="3654"></td>
          <td id="LC3654">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3655" data-line-number="3655"></td>
          <td id="LC3655">        .ExchAlgo = ucsTlsAlgoExchCertificate</td>
        </tr>
        <tr>
          <td id="L3656" data-line-number="3656"></td>
          <td id="LC3656">        If Not pvAsn1DecodePrivateKey(.LocalCertificates, .LocalPrivateKey, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L3657" data-line-number="3657"></td>
          <td id="LC3657">            sErrDesc = ERR_UNSUPPORTED_PRIVATE_KEY</td>
        </tr>
        <tr>
          <td id="L3658" data-line-number="3658"></td>
          <td id="LC3658">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L3659" data-line-number="3659"></td>
          <td id="LC3659">        End If</td>
        </tr>
        <tr>
          <td id="L3660" data-line-number="3660"></td>
          <td id="LC3660">        If uKeyInfo.hNKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3661" data-line-number="3661"></td>
          <td id="LC3661">            hResult = NCryptDecrypt(uKeyInfo.hNKey, baEnc(0), UBound(baEnc) + 1, 0, ByVal 0, 0, lSize, NCRYPT_PAD_PKCS1_FLAG)</td>
        </tr>
        <tr>
          <td id="L3662" data-line-number="3662"></td>
          <td id="LC3662">            If hResult &lt; 0 Or lSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L3663" data-line-number="3663"></td>
          <td id="LC3663">                GoTo UseRandom</td>
        </tr>
        <tr>
          <td id="L3664" data-line-number="3664"></td>
          <td id="LC3664">            End If</td>
        </tr>
        <tr>
          <td id="L3665" data-line-number="3665"></td>
          <td id="LC3665">            pvArrayAllocate baDec, lSize, FUNC_NAME &amp; &#34;.baDec&#34;</td>
        </tr>
        <tr>
          <td id="L3666" data-line-number="3666"></td>
          <td id="LC3666">            hResult = NCryptDecrypt(uKeyInfo.hNKey, baEnc(0), UBound(baEnc) + 1, 0, baDec(0), lSize, lSize, NCRYPT_PAD_PKCS1_FLAG)</td>
        </tr>
        <tr>
          <td id="L3667" data-line-number="3667"></td>
          <td id="LC3667">            If hResult &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3668" data-line-number="3668"></td>
          <td id="LC3668">                GoTo UseRandom</td>
        </tr>
        <tr>
          <td id="L3669" data-line-number="3669"></td>
          <td id="LC3669">            End If</td>
        </tr>
        <tr>
          <td id="L3670" data-line-number="3670"></td>
          <td id="LC3670">            pvArrayReallocate baDec, lSize, FUNC_NAME &amp; &#34;.baDec&#34;</td>
        </tr>
        <tr>
          <td id="L3671" data-line-number="3671"></td>
          <td id="LC3671">            .LocalExchPrivate = baDec</td>
        </tr>
        <tr>
          <td id="L3672" data-line-number="3672"></td>
          <td id="LC3672">        ElseIf uKeyInfo.hProv &lt;&gt; 0 And uKeyInfo.hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3673" data-line-number="3673"></td>
          <td id="LC3673">            baDec = baEnc</td>
        </tr>
        <tr>
          <td id="L3674" data-line-number="3674"></td>
          <td id="LC3674">            pvArrayReverse baDec</td>
        </tr>
        <tr>
          <td id="L3675" data-line-number="3675"></td>
          <td id="LC3675">            lSize = UBound(baDec) + 1</td>
        </tr>
        <tr>
          <td id="L3676" data-line-number="3676"></td>
          <td id="LC3676">            If CryptDecrypt(uKeyInfo.hKey, 0, 1, 0, baDec(0), lSize) = 0 Then</td>
        </tr>
        <tr>
          <td id="L3677" data-line-number="3677"></td>
          <td id="LC3677">                GoTo UseRandom</td>
        </tr>
        <tr>
          <td id="L3678" data-line-number="3678"></td>
          <td id="LC3678">            End If</td>
        </tr>
        <tr>
          <td id="L3679" data-line-number="3679"></td>
          <td id="LC3679">            pvArrayReallocate baDec, lSize, FUNC_NAME &amp; &#34;.baDec&#34;</td>
        </tr>
        <tr>
          <td id="L3680" data-line-number="3680"></td>
          <td id="LC3680">            .LocalExchPrivate = baDec</td>
        </tr>
        <tr>
          <td id="L3681" data-line-number="3681"></td>
          <td id="LC3681">        Else</td>
        </tr>
        <tr>
          <td id="L3682" data-line-number="3682"></td>
          <td id="LC3682">            If Not pvCryptoRsaCrtModExp(baEnc, uKeyInfo.PrivExp, uKeyInfo.Modulus, uKeyInfo.Prime1, uKeyInfo.Prime2, uKeyInfo.Coefficient, baDec) Then</td>
        </tr>
        <tr>
          <td id="L3683" data-line-number="3683"></td>
          <td id="LC3683">                GoTo UseRandom</td>
        </tr>
        <tr>
          <td id="L3684" data-line-number="3684"></td>
          <td id="LC3684">            End If</td>
        </tr>
        <tr>
          <td id="L3685" data-line-number="3685"></td>
          <td id="LC3685">            If Not pvCryptoEmePkcs1Decode(.LocalExchPrivate, baDec) Then</td>
        </tr>
        <tr>
          <td id="L3686" data-line-number="3686"></td>
          <td id="LC3686">                GoTo UseRandom</td>
        </tr>
        <tr>
          <td id="L3687" data-line-number="3687"></td>
          <td id="LC3687">            End If</td>
        </tr>
        <tr>
          <td id="L3688" data-line-number="3688"></td>
          <td id="LC3688">        End If</td>
        </tr>
        <tr>
          <td id="L3689" data-line-number="3689"></td>
          <td id="LC3689">        If pvArraySize(.LocalExchPrivate) &lt;&gt; TLS_LEGACY_SECRET_SIZE Then</td>
        </tr>
        <tr>
          <td id="L3690" data-line-number="3690"></td>
          <td id="LC3690">            GoTo UseRandom</td>
        </tr>
        <tr>
          <td id="L3691" data-line-number="3691"></td>
          <td id="LC3691">        End If</td>
        </tr>
        <tr>
          <td id="L3692" data-line-number="3692"></td>
          <td id="LC3692">        If pvArraySize(.LocalExchPrivate) &gt;= 2 Then</td>
        </tr>
        <tr>
          <td id="L3693" data-line-number="3693"></td>
          <td id="LC3693">            Call CopyMemory(lVersion, .LocalExchPrivate(0), 2)</td>
        </tr>
        <tr>
          <td id="L3694" data-line-number="3694"></td>
          <td id="LC3694">        End If</td>
        </tr>
        <tr>
          <td id="L3695" data-line-number="3695"></td>
          <td id="LC3695">        If lVersion &lt;&gt; .RemoteProtocolVersion Then</td>
        </tr>
        <tr>
          <td id="L3696" data-line-number="3696"></td>
          <td id="LC3696">UseRandom:</td>
        </tr>
        <tr>
          <td id="L3697" data-line-number="3697"></td>
          <td id="LC3697">            #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L3698" data-line-number="3698"></td>
          <td id="LC3698">                DebugLog MODULE_NAME, FUNC_NAME, &#34;Will use random LocalExchPrivate&#34;</td>
        </tr>
        <tr>
          <td id="L3699" data-line-number="3699"></td>
          <td id="LC3699">            #End If</td>
        </tr>
        <tr>
          <td id="L3700" data-line-number="3700"></td>
          <td id="LC3700">            pvTlsGetRandom .LocalExchPrivate, TLS_LEGACY_SECRET_SIZE</td>
        </tr>
        <tr>
          <td id="L3701" data-line-number="3701"></td>
          <td id="LC3701">        End If</td>
        </tr>
        <tr>
          <td id="L3702" data-line-number="3702"></td>
          <td id="LC3702">    End With</td>
        </tr>
        <tr>
          <td id="L3703" data-line-number="3703"></td>
          <td id="LC3703">QH:</td>
        </tr>
        <tr>
          <td id="L3704" data-line-number="3704"></td>
          <td id="LC3704">    If uKeyInfo.hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3705" data-line-number="3705"></td>
          <td id="LC3705">        Call CryptDestroyKey(uKeyInfo.hKey)</td>
        </tr>
        <tr>
          <td id="L3706" data-line-number="3706"></td>
          <td id="LC3706">    End If</td>
        </tr>
        <tr>
          <td id="L3707" data-line-number="3707"></td>
          <td id="LC3707">    If uKeyInfo.hProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3708" data-line-number="3708"></td>
          <td id="LC3708">        Call CryptReleaseContext(uKeyInfo.hProv, 0)</td>
        </tr>
        <tr>
          <td id="L3709" data-line-number="3709"></td>
          <td id="LC3709">    End If</td>
        </tr>
        <tr>
          <td id="L3710" data-line-number="3710"></td>
          <td id="LC3710">    If uKeyInfo.hNKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3711" data-line-number="3711"></td>
          <td id="LC3711">        Call NCryptFreeObject(uKeyInfo.hNKey)</td>
        </tr>
        <tr>
          <td id="L3712" data-line-number="3712"></td>
          <td id="LC3712">    End If</td>
        </tr>
        <tr>
          <td id="L3713" data-line-number="3713"></td>
          <td id="LC3713">    If LenB(sErrDesc) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3714" data-line-number="3714"></td>
          <td id="LC3714">        ErrRaise vbObjectError, FUNC_NAME, sErrDesc</td>
        </tr>
        <tr>
          <td id="L3715" data-line-number="3715"></td>
          <td id="LC3715">    End If</td>
        </tr>
        <tr>
          <td id="L3716" data-line-number="3716"></td>
          <td id="LC3716">End Sub</td>
        </tr>
        <tr>
          <td id="L3717" data-line-number="3717"></td>
          <td id="LC3717">
</td>
        </tr>
        <tr>
          <td id="L3718" data-line-number="3718"></td>
          <td id="LC3718">Private Sub pvTlsSetupCipherSuite(uCtx As UcsTlsContext, ByVal lCipherSuite As Long)</td>
        </tr>
        <tr>
          <td id="L3719" data-line-number="3719"></td>
          <td id="LC3719">    Const FUNC_NAME     As String = &#34;pvTlsSetupCipherSuite&#34;</td>
        </tr>
        <tr>
          <td id="L3720" data-line-number="3720"></td>
          <td id="LC3720">    </td>
        </tr>
        <tr>
          <td id="L3721" data-line-number="3721"></td>
          <td id="LC3721">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3722" data-line-number="3722"></td>
          <td id="LC3722">        If .CipherSuite &lt;&gt; lCipherSuite Then</td>
        </tr>
        <tr>
          <td id="L3723" data-line-number="3723"></td>
          <td id="LC3723">            .CipherSuite = lCipherSuite</td>
        </tr>
        <tr>
          <td id="L3724" data-line-number="3724"></td>
          <td id="LC3724">            .BulkAlgo = 0</td>
        </tr>
        <tr>
          <td id="L3725" data-line-number="3725"></td>
          <td id="LC3725">            .MacSize = 0</td>
        </tr>
        <tr>
          <td id="L3726" data-line-number="3726"></td>
          <td id="LC3726">            .KeySize = 0</td>
        </tr>
        <tr>
          <td id="L3727" data-line-number="3727"></td>
          <td id="LC3727">            .IvSize = 0</td>
        </tr>
        <tr>
          <td id="L3728" data-line-number="3728"></td>
          <td id="LC3728">            .IvExplicitSize = 0</td>
        </tr>
        <tr>
          <td id="L3729" data-line-number="3729"></td>
          <td id="LC3729">            .TagSize = 0</td>
        </tr>
        <tr>
          <td id="L3730" data-line-number="3730"></td>
          <td id="LC3730">            .DigestAlgo = 0</td>
        </tr>
        <tr>
          <td id="L3731" data-line-number="3731"></td>
          <td id="LC3731">            .DigestSize = 0</td>
        </tr>
        <tr>
          <td id="L3732" data-line-number="3732"></td>
          <td id="LC3732">            .UseRsaKeyTransport = False</td>
        </tr>
        <tr>
          <td id="L3733" data-line-number="3733"></td>
          <td id="LC3733">            Select Case lCipherSuite</td>
        </tr>
        <tr>
          <td id="L3734" data-line-number="3734"></td>
          <td id="LC3734">            Case TLS_CS_CHACHA20_POLY1305_SHA256, TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256, TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256, _</td>
        </tr>
        <tr>
          <td id="L3735" data-line-number="3735"></td>
          <td id="LC3735">                    TLS_CS_AES_128_GCM_SHA256, TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, TLS_CS_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3736" data-line-number="3736"></td>
          <td id="LC3736">                .DigestAlgo = ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L3737" data-line-number="3737"></td>
          <td id="LC3737">                .DigestSize = LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L3738" data-line-number="3738"></td>
          <td id="LC3738">            Case TLS_CS_AES_256_GCM_SHA384, TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384, TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, TLS_CS_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3739" data-line-number="3739"></td>
          <td id="LC3739">                .DigestAlgo = ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L3740" data-line-number="3740"></td>
          <td id="LC3740">                .DigestSize = LNG_SHA384_HASHSZ</td>
        </tr>
        <tr>
          <td id="L3741" data-line-number="3741"></td>
          <td id="LC3741">            Case TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA, TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA, _</td>
        </tr>
        <tr>
          <td id="L3742" data-line-number="3742"></td>
          <td id="LC3742">                    TLS_CS_RSA_WITH_AES_128_CBC_SHA, TLS_CS_RSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3743" data-line-number="3743"></td>
          <td id="LC3743">                .DigestAlgo = ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L3744" data-line-number="3744"></td>
          <td id="LC3744">                .DigestSize = LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L3745" data-line-number="3745"></td>
          <td id="LC3745">                .MacAlgo = ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L3746" data-line-number="3746"></td>
          <td id="LC3746">                .MacSize = LNG_SHA1_HASHSZ</td>
        </tr>
        <tr>
          <td id="L3747" data-line-number="3747"></td>
          <td id="LC3747">#If ImplExoticCiphers Then</td>
        </tr>
        <tr>
          <td id="L3748" data-line-number="3748"></td>
          <td id="LC3748">            Case TLS_CS_RSA_WITH_AES_128_CBC_SHA256, TLS_CS_RSA_WITH_AES_256_CBC_SHA256, TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3749" data-line-number="3749"></td>
          <td id="LC3749">                .DigestAlgo = ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L3750" data-line-number="3750"></td>
          <td id="LC3750">                .DigestSize = LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L3751" data-line-number="3751"></td>
          <td id="LC3751">                .MacAlgo = .DigestAlgo</td>
        </tr>
        <tr>
          <td id="L3752" data-line-number="3752"></td>
          <td id="LC3752">                .MacSize = .DigestSize</td>
        </tr>
        <tr>
          <td id="L3753" data-line-number="3753"></td>
          <td id="LC3753">            Case TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384, TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</td>
        </tr>
        <tr>
          <td id="L3754" data-line-number="3754"></td>
          <td id="LC3754">                .DigestAlgo = ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L3755" data-line-number="3755"></td>
          <td id="LC3755">                .DigestSize = LNG_SHA384_HASHSZ</td>
        </tr>
        <tr>
          <td id="L3756" data-line-number="3756"></td>
          <td id="LC3756">                .MacAlgo = .DigestAlgo</td>
        </tr>
        <tr>
          <td id="L3757" data-line-number="3757"></td>
          <td id="LC3757">                .MacSize = .DigestSize</td>
        </tr>
        <tr>
          <td id="L3758" data-line-number="3758"></td>
          <td id="LC3758">#End If</td>
        </tr>
        <tr>
          <td id="L3759" data-line-number="3759"></td>
          <td id="LC3759">            End Select</td>
        </tr>
        <tr>
          <td id="L3760" data-line-number="3760"></td>
          <td id="LC3760">            Select Case lCipherSuite</td>
        </tr>
        <tr>
          <td id="L3761" data-line-number="3761"></td>
          <td id="LC3761">            Case TLS_CS_CHACHA20_POLY1305_SHA256, TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256, TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L3762" data-line-number="3762"></td>
          <td id="LC3762">                .BulkAlgo = ucsTlsAlgoBulkChacha20Poly1305</td>
        </tr>
        <tr>
          <td id="L3763" data-line-number="3763"></td>
          <td id="LC3763">                .KeySize = LNG_CHACHA20_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3764" data-line-number="3764"></td>
          <td id="LC3764">                .IvSize = LNG_CHACHA20POLY1305_IVSZ</td>
        </tr>
        <tr>
          <td id="L3765" data-line-number="3765"></td>
          <td id="LC3765">                .TagSize = LNG_CHACHA20POLY1305_TAGSZ</td>
        </tr>
        <tr>
          <td id="L3766" data-line-number="3766"></td>
          <td id="LC3766">            Case TLS_CS_AES_128_GCM_SHA256, TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, TLS_CS_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3767" data-line-number="3767"></td>
          <td id="LC3767">                .BulkAlgo = ucsTlsAlgoBulkAesGcm128</td>
        </tr>
        <tr>
          <td id="L3768" data-line-number="3768"></td>
          <td id="LC3768">                .KeySize = LNG_AES128_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3769" data-line-number="3769"></td>
          <td id="LC3769">                .IvSize = LNG_AESGCM_IVSZ</td>
        </tr>
        <tr>
          <td id="L3770" data-line-number="3770"></td>
          <td id="LC3770">                If lCipherSuite &lt;&gt; TLS_CS_AES_128_GCM_SHA256 Then</td>
        </tr>
        <tr>
          <td id="L3771" data-line-number="3771"></td>
          <td id="LC3771">                    .IvExplicitSize = 8</td>
        </tr>
        <tr>
          <td id="L3772" data-line-number="3772"></td>
          <td id="LC3772">                End If</td>
        </tr>
        <tr>
          <td id="L3773" data-line-number="3773"></td>
          <td id="LC3773">                .TagSize = LNG_AESGCM_TAGSZ</td>
        </tr>
        <tr>
          <td id="L3774" data-line-number="3774"></td>
          <td id="LC3774">            Case TLS_CS_AES_256_GCM_SHA384, TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384, TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, TLS_CS_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3775" data-line-number="3775"></td>
          <td id="LC3775">                .BulkAlgo = ucsTlsAlgoBulkAesGcm256</td>
        </tr>
        <tr>
          <td id="L3776" data-line-number="3776"></td>
          <td id="LC3776">                .KeySize = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3777" data-line-number="3777"></td>
          <td id="LC3777">                .IvSize = LNG_AESGCM_IVSZ</td>
        </tr>
        <tr>
          <td id="L3778" data-line-number="3778"></td>
          <td id="LC3778">                If lCipherSuite &lt;&gt; TLS_CS_AES_256_GCM_SHA384 Then</td>
        </tr>
        <tr>
          <td id="L3779" data-line-number="3779"></td>
          <td id="LC3779">                    .IvExplicitSize = 8</td>
        </tr>
        <tr>
          <td id="L3780" data-line-number="3780"></td>
          <td id="LC3780">                End If</td>
        </tr>
        <tr>
          <td id="L3781" data-line-number="3781"></td>
          <td id="LC3781">                .TagSize = LNG_AESGCM_TAGSZ</td>
        </tr>
        <tr>
          <td id="L3782" data-line-number="3782"></td>
          <td id="LC3782">            Case TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA, TLS_CS_RSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3783" data-line-number="3783"></td>
          <td id="LC3783">                .BulkAlgo = ucsTlsAlgoBulkAesCbc128</td>
        </tr>
        <tr>
          <td id="L3784" data-line-number="3784"></td>
          <td id="LC3784">                .KeySize = LNG_AES128_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3785" data-line-number="3785"></td>
          <td id="LC3785">                .IvSize = LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L3786" data-line-number="3786"></td>
          <td id="LC3786">                .IvExplicitSize = .IvSize</td>
        </tr>
        <tr>
          <td id="L3787" data-line-number="3787"></td>
          <td id="LC3787">            Case TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA, TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_CS_RSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3788" data-line-number="3788"></td>
          <td id="LC3788">                .BulkAlgo = ucsTlsAlgoBulkAesCbc256</td>
        </tr>
        <tr>
          <td id="L3789" data-line-number="3789"></td>
          <td id="LC3789">                .KeySize = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3790" data-line-number="3790"></td>
          <td id="LC3790">                .IvSize = LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L3791" data-line-number="3791"></td>
          <td id="LC3791">                .IvExplicitSize = .IvSize</td>
        </tr>
        <tr>
          <td id="L3792" data-line-number="3792"></td>
          <td id="LC3792">#If ImplExoticCiphers Then</td>
        </tr>
        <tr>
          <td id="L3793" data-line-number="3793"></td>
          <td id="LC3793">            Case TLS_CS_RSA_WITH_AES_128_CBC_SHA256, TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3794" data-line-number="3794"></td>
          <td id="LC3794">                .BulkAlgo = ucsTlsAlgoBulkAesCbc128</td>
        </tr>
        <tr>
          <td id="L3795" data-line-number="3795"></td>
          <td id="LC3795">                .KeySize = LNG_AES128_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3796" data-line-number="3796"></td>
          <td id="LC3796">                .IvSize = LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L3797" data-line-number="3797"></td>
          <td id="LC3797">                .IvExplicitSize = .IvSize</td>
        </tr>
        <tr>
          <td id="L3798" data-line-number="3798"></td>
          <td id="LC3798">            Case TLS_CS_RSA_WITH_AES_256_CBC_SHA256, TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384, TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</td>
        </tr>
        <tr>
          <td id="L3799" data-line-number="3799"></td>
          <td id="LC3799">                .BulkAlgo = ucsTlsAlgoBulkAesCbc256</td>
        </tr>
        <tr>
          <td id="L3800" data-line-number="3800"></td>
          <td id="LC3800">                .KeySize = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L3801" data-line-number="3801"></td>
          <td id="LC3801">                .IvSize = LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L3802" data-line-number="3802"></td>
          <td id="LC3802">                .IvExplicitSize = .IvSize</td>
        </tr>
        <tr>
          <td id="L3803" data-line-number="3803"></td>
          <td id="LC3803">#End If</td>
        </tr>
        <tr>
          <td id="L3804" data-line-number="3804"></td>
          <td id="LC3804">            End Select</td>
        </tr>
        <tr>
          <td id="L3805" data-line-number="3805"></td>
          <td id="LC3805">            Select Case lCipherSuite</td>
        </tr>
        <tr>
          <td id="L3806" data-line-number="3806"></td>
          <td id="LC3806">            Case TLS_CS_RSA_WITH_AES_128_CBC_SHA, TLS_CS_RSA_WITH_AES_256_CBC_SHA, _</td>
        </tr>
        <tr>
          <td id="L3807" data-line-number="3807"></td>
          <td id="LC3807">                    TLS_CS_RSA_WITH_AES_128_GCM_SHA256, TLS_CS_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3808" data-line-number="3808"></td>
          <td id="LC3808">                .UseRsaKeyTransport = True</td>
        </tr>
        <tr>
          <td id="L3809" data-line-number="3809"></td>
          <td id="LC3809">#If ImplExoticCiphers Then</td>
        </tr>
        <tr>
          <td id="L3810" data-line-number="3810"></td>
          <td id="LC3810">            Case TLS_CS_RSA_WITH_AES_128_CBC_SHA256, TLS_CS_RSA_WITH_AES_256_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3811" data-line-number="3811"></td>
          <td id="LC3811">                .UseRsaKeyTransport = True</td>
        </tr>
        <tr>
          <td id="L3812" data-line-number="3812"></td>
          <td id="LC3812">#End If</td>
        </tr>
        <tr>
          <td id="L3813" data-line-number="3813"></td>
          <td id="LC3813">            End Select</td>
        </tr>
        <tr>
          <td id="L3814" data-line-number="3814"></td>
          <td id="LC3814">            Select Case lCipherSuite</td>
        </tr>
        <tr>
          <td id="L3815" data-line-number="3815"></td>
          <td id="LC3815">            Case TLS_CS_AES_128_GCM_SHA256, TLS_CS_AES_256_GCM_SHA384, TLS_CS_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L3816" data-line-number="3816"></td>
          <td id="LC3816">                .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13</td>
        </tr>
        <tr>
          <td id="L3817" data-line-number="3817"></td>
          <td id="LC3817">            End Select</td>
        </tr>
        <tr>
          <td id="L3818" data-line-number="3818"></td>
          <td id="LC3818">            If .BulkAlgo = 0 Or .DigestAlgo = 0 Then</td>
        </tr>
        <tr>
          <td id="L3819" data-line-number="3819"></td>
          <td id="LC3819">                ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_UNSUPPORTED_CIPHER_SUITE, &#34;%1&#34;, pvTlsGetCipherSuiteName(.CipherSuite))</td>
        </tr>
        <tr>
          <td id="L3820" data-line-number="3820"></td>
          <td id="LC3820">            End If</td>
        </tr>
        <tr>
          <td id="L3821" data-line-number="3821"></td>
          <td id="LC3821">        End If</td>
        </tr>
        <tr>
          <td id="L3822" data-line-number="3822"></td>
          <td id="LC3822">    End With</td>
        </tr>
        <tr>
          <td id="L3823" data-line-number="3823"></td>
          <td id="LC3823">End Sub</td>
        </tr>
        <tr>
          <td id="L3824" data-line-number="3824"></td>
          <td id="LC3824">
</td>
        </tr>
        <tr>
          <td id="L3825" data-line-number="3825"></td>
          <td id="LC3825">Private Function pvTlsGetSortedCipherSuites(ByVal eFilter As UcsTlsLocalFeaturesEnum, Optional AlgoObjId As String) As Collection</td>
        </tr>
        <tr>
          <td id="L3826" data-line-number="3826"></td>
          <td id="LC3826">    Const PREF      As Long = &amp;H1000</td>
        </tr>
        <tr>
          <td id="L3827" data-line-number="3827"></td>
          <td id="LC3827">    Dim oRetVal     As Collection</td>
        </tr>
        <tr>
          <td id="L3828" data-line-number="3828"></td>
          <td id="LC3828">    Dim bNeedEcdsa  As Boolean</td>
        </tr>
        <tr>
          <td id="L3829" data-line-number="3829"></td>
          <td id="LC3829">    Dim bNeedRsa    As Boolean</td>
        </tr>
        <tr>
          <td id="L3830" data-line-number="3830"></td>
          <td id="LC3830">    </td>
        </tr>
        <tr>
          <td id="L3831" data-line-number="3831"></td>
          <td id="LC3831">    Set oRetVal = New Collection</td>
        </tr>
        <tr>
          <td id="L3832" data-line-number="3832"></td>
          <td id="LC3832">    If (eFilter And ucsTlsSupportTls13) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3833" data-line-number="3833"></td>
          <td id="LC3833">        &#39;--- first if AES preferred over Chacha20</td>
        </tr>
        <tr>
          <td id="L3834" data-line-number="3834"></td>
          <td id="LC3834">        If pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm128) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128) Then</td>
        </tr>
        <tr>
          <td id="L3835" data-line-number="3835"></td>
          <td id="LC3835">            oRetVal.Add TLS_CS_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3836" data-line-number="3836"></td>
          <td id="LC3836">        End If</td>
        </tr>
        <tr>
          <td id="L3837" data-line-number="3837"></td>
          <td id="LC3837">        If pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm256) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256) Then</td>
        </tr>
        <tr>
          <td id="L3838" data-line-number="3838"></td>
          <td id="LC3838">            oRetVal.Add TLS_CS_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3839" data-line-number="3839"></td>
          <td id="LC3839">        End If</td>
        </tr>
        <tr>
          <td id="L3840" data-line-number="3840"></td>
          <td id="LC3840">        If pvCryptoIsSupported(ucsTlsAlgoBulkChacha20Poly1305) Then</td>
        </tr>
        <tr>
          <td id="L3841" data-line-number="3841"></td>
          <td id="LC3841">            oRetVal.Add TLS_CS_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L3842" data-line-number="3842"></td>
          <td id="LC3842">        End If</td>
        </tr>
        <tr>
          <td id="L3843" data-line-number="3843"></td>
          <td id="LC3843">        &#39;--- least preferred AES</td>
        </tr>
        <tr>
          <td id="L3844" data-line-number="3844"></td>
          <td id="LC3844">        If Not pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm128) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128) Then</td>
        </tr>
        <tr>
          <td id="L3845" data-line-number="3845"></td>
          <td id="LC3845">            oRetVal.Add TLS_CS_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3846" data-line-number="3846"></td>
          <td id="LC3846">        End If</td>
        </tr>
        <tr>
          <td id="L3847" data-line-number="3847"></td>
          <td id="LC3847">        If Not pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm256) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256) Then</td>
        </tr>
        <tr>
          <td id="L3848" data-line-number="3848"></td>
          <td id="LC3848">            oRetVal.Add TLS_CS_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3849" data-line-number="3849"></td>
          <td id="LC3849">        End If</td>
        </tr>
        <tr>
          <td id="L3850" data-line-number="3850"></td>
          <td id="LC3850">    End If</td>
        </tr>
        <tr>
          <td id="L3851" data-line-number="3851"></td>
          <td id="LC3851">    If (eFilter And ucsTlsSupportTls12) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3852" data-line-number="3852"></td>
          <td id="LC3852">        bNeedEcdsa = (AlgoObjId = szOID_ECC_PUBLIC_KEY Or AlgoObjId = szOID_ECC_CURVE_P256 Or AlgoObjId = szOID_ECC_CURVE_P384 Or AlgoObjId = szOID_ECC_CURVE_P521 Or LenB(AlgoObjId) = 0)</td>
        </tr>
        <tr>
          <td id="L3853" data-line-number="3853"></td>
          <td id="LC3853">        bNeedRsa = (AlgoObjId = szOID_RSA_RSA Or AlgoObjId = szOID_RSA_SSA_PSS Or LenB(AlgoObjId) = 0)</td>
        </tr>
        <tr>
          <td id="L3854" data-line-number="3854"></td>
          <td id="LC3854">        &#39;--- first if AES preferred over Chacha20</td>
        </tr>
        <tr>
          <td id="L3855" data-line-number="3855"></td>
          <td id="LC3855">        If pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm128) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128) Then</td>
        </tr>
        <tr>
          <td id="L3856" data-line-number="3856"></td>
          <td id="LC3856">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3857" data-line-number="3857"></td>
          <td id="LC3857">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3858" data-line-number="3858"></td>
          <td id="LC3858">            End If</td>
        </tr>
        <tr>
          <td id="L3859" data-line-number="3859"></td>
          <td id="LC3859">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3860" data-line-number="3860"></td>
          <td id="LC3860">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3861" data-line-number="3861"></td>
          <td id="LC3861">            End If</td>
        </tr>
        <tr>
          <td id="L3862" data-line-number="3862"></td>
          <td id="LC3862">        End If</td>
        </tr>
        <tr>
          <td id="L3863" data-line-number="3863"></td>
          <td id="LC3863">        If pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm256) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256) Then</td>
        </tr>
        <tr>
          <td id="L3864" data-line-number="3864"></td>
          <td id="LC3864">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3865" data-line-number="3865"></td>
          <td id="LC3865">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3866" data-line-number="3866"></td>
          <td id="LC3866">            End If</td>
        </tr>
        <tr>
          <td id="L3867" data-line-number="3867"></td>
          <td id="LC3867">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3868" data-line-number="3868"></td>
          <td id="LC3868">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3869" data-line-number="3869"></td>
          <td id="LC3869">            End If</td>
        </tr>
        <tr>
          <td id="L3870" data-line-number="3870"></td>
          <td id="LC3870">        End If</td>
        </tr>
        <tr>
          <td id="L3871" data-line-number="3871"></td>
          <td id="LC3871">        If pvCryptoIsSupported(ucsTlsAlgoBulkChacha20Poly1305) Then</td>
        </tr>
        <tr>
          <td id="L3872" data-line-number="3872"></td>
          <td id="LC3872">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3873" data-line-number="3873"></td>
          <td id="LC3873">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L3874" data-line-number="3874"></td>
          <td id="LC3874">            End If</td>
        </tr>
        <tr>
          <td id="L3875" data-line-number="3875"></td>
          <td id="LC3875">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3876" data-line-number="3876"></td>
          <td id="LC3876">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L3877" data-line-number="3877"></td>
          <td id="LC3877">            End If</td>
        </tr>
        <tr>
          <td id="L3878" data-line-number="3878"></td>
          <td id="LC3878">        End If</td>
        </tr>
        <tr>
          <td id="L3879" data-line-number="3879"></td>
          <td id="LC3879">        &#39;--- least preferred AES</td>
        </tr>
        <tr>
          <td id="L3880" data-line-number="3880"></td>
          <td id="LC3880">        If Not pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm128) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128) Then</td>
        </tr>
        <tr>
          <td id="L3881" data-line-number="3881"></td>
          <td id="LC3881">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3882" data-line-number="3882"></td>
          <td id="LC3882">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3883" data-line-number="3883"></td>
          <td id="LC3883">            End If</td>
        </tr>
        <tr>
          <td id="L3884" data-line-number="3884"></td>
          <td id="LC3884">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3885" data-line-number="3885"></td>
          <td id="LC3885">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3886" data-line-number="3886"></td>
          <td id="LC3886">            End If</td>
        </tr>
        <tr>
          <td id="L3887" data-line-number="3887"></td>
          <td id="LC3887">        End If</td>
        </tr>
        <tr>
          <td id="L3888" data-line-number="3888"></td>
          <td id="LC3888">        If Not pvCryptoIsSupported(PREF + ucsTlsAlgoBulkAesGcm256) And pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256) Then</td>
        </tr>
        <tr>
          <td id="L3889" data-line-number="3889"></td>
          <td id="LC3889">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3890" data-line-number="3890"></td>
          <td id="LC3890">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3891" data-line-number="3891"></td>
          <td id="LC3891">            End If</td>
        </tr>
        <tr>
          <td id="L3892" data-line-number="3892"></td>
          <td id="LC3892">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3893" data-line-number="3893"></td>
          <td id="LC3893">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3894" data-line-number="3894"></td>
          <td id="LC3894">            End If</td>
        </tr>
        <tr>
          <td id="L3895" data-line-number="3895"></td>
          <td id="LC3895">        End If</td>
        </tr>
        <tr>
          <td id="L3896" data-line-number="3896"></td>
          <td id="LC3896">        &#39;--- legacy AES in CBC mode</td>
        </tr>
        <tr>
          <td id="L3897" data-line-number="3897"></td>
          <td id="LC3897">#If ImplExoticCiphers Then</td>
        </tr>
        <tr>
          <td id="L3898" data-line-number="3898"></td>
          <td id="LC3898">        If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128) Then</td>
        </tr>
        <tr>
          <td id="L3899" data-line-number="3899"></td>
          <td id="LC3899">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3900" data-line-number="3900"></td>
          <td id="LC3900">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3901" data-line-number="3901"></td>
          <td id="LC3901">            End If</td>
        </tr>
        <tr>
          <td id="L3902" data-line-number="3902"></td>
          <td id="LC3902">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3903" data-line-number="3903"></td>
          <td id="LC3903">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3904" data-line-number="3904"></td>
          <td id="LC3904">            End If</td>
        </tr>
        <tr>
          <td id="L3905" data-line-number="3905"></td>
          <td id="LC3905">        End If</td>
        </tr>
        <tr>
          <td id="L3906" data-line-number="3906"></td>
          <td id="LC3906">        If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256) Then</td>
        </tr>
        <tr>
          <td id="L3907" data-line-number="3907"></td>
          <td id="LC3907">            If bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3908" data-line-number="3908"></td>
          <td id="LC3908">                oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</td>
        </tr>
        <tr>
          <td id="L3909" data-line-number="3909"></td>
          <td id="LC3909">            End If</td>
        </tr>
        <tr>
          <td id="L3910" data-line-number="3910"></td>
          <td id="LC3910">            If bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3911" data-line-number="3911"></td>
          <td id="LC3911">                oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</td>
        </tr>
        <tr>
          <td id="L3912" data-line-number="3912"></td>
          <td id="LC3912">            End If</td>
        </tr>
        <tr>
          <td id="L3913" data-line-number="3913"></td>
          <td id="LC3913">        End If</td>
        </tr>
        <tr>
          <td id="L3914" data-line-number="3914"></td>
          <td id="LC3914">#End If</td>
        </tr>
        <tr>
          <td id="L3915" data-line-number="3915"></td>
          <td id="LC3915">        If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128) And bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3916" data-line-number="3916"></td>
          <td id="LC3916">            oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3917" data-line-number="3917"></td>
          <td id="LC3917">        End If</td>
        </tr>
        <tr>
          <td id="L3918" data-line-number="3918"></td>
          <td id="LC3918">        If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128) And bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3919" data-line-number="3919"></td>
          <td id="LC3919">            oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3920" data-line-number="3920"></td>
          <td id="LC3920">        End If</td>
        </tr>
        <tr>
          <td id="L3921" data-line-number="3921"></td>
          <td id="LC3921">        If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256) And bNeedEcdsa Then</td>
        </tr>
        <tr>
          <td id="L3922" data-line-number="3922"></td>
          <td id="LC3922">            oRetVal.Add TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3923" data-line-number="3923"></td>
          <td id="LC3923">        End If</td>
        </tr>
        <tr>
          <td id="L3924" data-line-number="3924"></td>
          <td id="LC3924">        If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256) And bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3925" data-line-number="3925"></td>
          <td id="LC3925">            oRetVal.Add TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3926" data-line-number="3926"></td>
          <td id="LC3926">        End If</td>
        </tr>
        <tr>
          <td id="L3927" data-line-number="3927"></td>
          <td id="LC3927">        &#39;--- no perfect forward secrecy -&gt; least preferred</td>
        </tr>
        <tr>
          <td id="L3928" data-line-number="3928"></td>
          <td id="LC3928">        If pvCryptoIsSupported(ucsTlsAlgoExchCertificate) And bNeedRsa Then</td>
        </tr>
        <tr>
          <td id="L3929" data-line-number="3929"></td>
          <td id="LC3929">            If pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm128) Then</td>
        </tr>
        <tr>
          <td id="L3930" data-line-number="3930"></td>
          <td id="LC3930">                oRetVal.Add TLS_CS_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L3931" data-line-number="3931"></td>
          <td id="LC3931">            End If</td>
        </tr>
        <tr>
          <td id="L3932" data-line-number="3932"></td>
          <td id="LC3932">            If pvCryptoIsSupported(ucsTlsAlgoBulkAesGcm256) Then</td>
        </tr>
        <tr>
          <td id="L3933" data-line-number="3933"></td>
          <td id="LC3933">                oRetVal.Add TLS_CS_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L3934" data-line-number="3934"></td>
          <td id="LC3934">            End If</td>
        </tr>
        <tr>
          <td id="L3935" data-line-number="3935"></td>
          <td id="LC3935">#If ImplExoticCiphers Then</td>
        </tr>
        <tr>
          <td id="L3936" data-line-number="3936"></td>
          <td id="LC3936">            If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128) Then</td>
        </tr>
        <tr>
          <td id="L3937" data-line-number="3937"></td>
          <td id="LC3937">                oRetVal.Add TLS_CS_RSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3938" data-line-number="3938"></td>
          <td id="LC3938">            End If</td>
        </tr>
        <tr>
          <td id="L3939" data-line-number="3939"></td>
          <td id="LC3939">            If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256) Then</td>
        </tr>
        <tr>
          <td id="L3940" data-line-number="3940"></td>
          <td id="LC3940">                oRetVal.Add TLS_CS_RSA_WITH_AES_256_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L3941" data-line-number="3941"></td>
          <td id="LC3941">            End If</td>
        </tr>
        <tr>
          <td id="L3942" data-line-number="3942"></td>
          <td id="LC3942">#End If</td>
        </tr>
        <tr>
          <td id="L3943" data-line-number="3943"></td>
          <td id="LC3943">            If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc128) Then</td>
        </tr>
        <tr>
          <td id="L3944" data-line-number="3944"></td>
          <td id="LC3944">                oRetVal.Add TLS_CS_RSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3945" data-line-number="3945"></td>
          <td id="LC3945">            End If</td>
        </tr>
        <tr>
          <td id="L3946" data-line-number="3946"></td>
          <td id="LC3946">            If pvCryptoIsSupported(ucsTlsAlgoBulkAesCbc256) Then</td>
        </tr>
        <tr>
          <td id="L3947" data-line-number="3947"></td>
          <td id="LC3947">                oRetVal.Add TLS_CS_RSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L3948" data-line-number="3948"></td>
          <td id="LC3948">            End If</td>
        </tr>
        <tr>
          <td id="L3949" data-line-number="3949"></td>
          <td id="LC3949">        End If</td>
        </tr>
        <tr>
          <td id="L3950" data-line-number="3950"></td>
          <td id="LC3950">    End If</td>
        </tr>
        <tr>
          <td id="L3951" data-line-number="3951"></td>
          <td id="LC3951">    Set pvTlsGetSortedCipherSuites = oRetVal</td>
        </tr>
        <tr>
          <td id="L3952" data-line-number="3952"></td>
          <td id="LC3952">End Function</td>
        </tr>
        <tr>
          <td id="L3953" data-line-number="3953"></td>
          <td id="LC3953">
</td>
        </tr>
        <tr>
          <td id="L3954" data-line-number="3954"></td>
          <td id="LC3954">Private Sub pvTlsClearLastError(uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L3955" data-line-number="3955"></td>
          <td id="LC3955">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3956" data-line-number="3956"></td>
          <td id="LC3956">        .LastErrNumber = 0</td>
        </tr>
        <tr>
          <td id="L3957" data-line-number="3957"></td>
          <td id="LC3957">        .LastErrSource = vbNullString</td>
        </tr>
        <tr>
          <td id="L3958" data-line-number="3958"></td>
          <td id="LC3958">        .LastError = vbNullString</td>
        </tr>
        <tr>
          <td id="L3959" data-line-number="3959"></td>
          <td id="LC3959">        .LastAlertCode = 0</td>
        </tr>
        <tr>
          <td id="L3960" data-line-number="3960"></td>
          <td id="LC3960">        Set .BlocksStack = Nothing</td>
        </tr>
        <tr>
          <td id="L3961" data-line-number="3961"></td>
          <td id="LC3961">    End With</td>
        </tr>
        <tr>
          <td id="L3962" data-line-number="3962"></td>
          <td id="LC3962">End Sub</td>
        </tr>
        <tr>
          <td id="L3963" data-line-number="3963"></td>
          <td id="LC3963">
</td>
        </tr>
        <tr>
          <td id="L3964" data-line-number="3964"></td>
          <td id="LC3964">Private Sub pvTlsSetLastError( _</td>
        </tr>
        <tr>
          <td id="L3965" data-line-number="3965"></td>
          <td id="LC3965">            uCtx As UcsTlsContext, _</td>
        </tr>
        <tr>
          <td id="L3966" data-line-number="3966"></td>
          <td id="LC3966">            Optional ByVal ErrNumber As Long, _</td>
        </tr>
        <tr>
          <td id="L3967" data-line-number="3967"></td>
          <td id="LC3967">            Optional ErrSource As String, _</td>
        </tr>
        <tr>
          <td id="L3968" data-line-number="3968"></td>
          <td id="LC3968">            Optional ErrDescription As String, _</td>
        </tr>
        <tr>
          <td id="L3969" data-line-number="3969"></td>
          <td id="LC3969">            Optional ByVal AlertCode As UcsTlsAlertDescriptionsEnum = -1)</td>
        </tr>
        <tr>
          <td id="L3970" data-line-number="3970"></td>
          <td id="LC3970">    Const FUNC_NAME     As String = &#34;pvTlsSetLastError&#34;</td>
        </tr>
        <tr>
          <td id="L3971" data-line-number="3971"></td>
          <td id="LC3971">    </td>
        </tr>
        <tr>
          <td id="L3972" data-line-number="3972"></td>
          <td id="LC3972">    With uCtx</td>
        </tr>
        <tr>
          <td id="L3973" data-line-number="3973"></td>
          <td id="LC3973">        .LastErrNumber = ErrNumber</td>
        </tr>
        <tr>
          <td id="L3974" data-line-number="3974"></td>
          <td id="LC3974">        .LastErrSource = ErrSource</td>
        </tr>
        <tr>
          <td id="L3975" data-line-number="3975"></td>
          <td id="LC3975">        .LastError = ErrDescription</td>
        </tr>
        <tr>
          <td id="L3976" data-line-number="3976"></td>
          <td id="LC3976">        .LastAlertCode = AlertCode</td>
        </tr>
        <tr>
          <td id="L3977" data-line-number="3977"></td>
          <td id="LC3977">        If LenB(ErrDescription) = 0 And AlertCode = -1 Then</td>
        </tr>
        <tr>
          <td id="L3978" data-line-number="3978"></td>
          <td id="LC3978">            Set .BlocksStack = Nothing</td>
        </tr>
        <tr>
          <td id="L3979" data-line-number="3979"></td>
          <td id="LC3979">        Else</td>
        </tr>
        <tr>
          <td id="L3980" data-line-number="3980"></td>
          <td id="LC3980">            If AlertCode &gt;= 0 Then</td>
        </tr>
        <tr>
          <td id="L3981" data-line-number="3981"></td>
          <td id="LC3981">                pvTlsBuildAlert uCtx, .SendBuffer, AlertCode, TLS_ALERT_LEVEL_FATAL</td>
        </tr>
        <tr>
          <td id="L3982" data-line-number="3982"></td>
          <td id="LC3982">            End If</td>
        </tr>
        <tr>
          <td id="L3983" data-line-number="3983"></td>
          <td id="LC3983">            .State = ucsTlsStateClosed</td>
        </tr>
        <tr>
          <td id="L3984" data-line-number="3984"></td>
          <td id="LC3984">        End If</td>
        </tr>
        <tr>
          <td id="L3985" data-line-number="3985"></td>
          <td id="LC3985">        #If ImplCaptureTraffic &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L3986" data-line-number="3986"></td>
          <td id="LC3986">            Clipboard.Clear</td>
        </tr>
        <tr>
          <td id="L3987" data-line-number="3987"></td>
          <td id="LC3987">            Clipboard.SetText TlsConcatCollection(.TrafficDump, vbCrLf)</td>
        </tr>
        <tr>
          <td id="L3988" data-line-number="3988"></td>
          <td id="LC3988">            #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L3989" data-line-number="3989"></td>
          <td id="LC3989">                DebugLog MODULE_NAME, FUNC_NAME, &#34;Traffic dump copied to clipboard&#34;</td>
        </tr>
        <tr>
          <td id="L3990" data-line-number="3990"></td>
          <td id="LC3990">            #End If</td>
        </tr>
        <tr>
          <td id="L3991" data-line-number="3991"></td>
          <td id="LC3991">        #End If</td>
        </tr>
        <tr>
          <td id="L3992" data-line-number="3992"></td>
          <td id="LC3992">    End With</td>
        </tr>
        <tr>
          <td id="L3993" data-line-number="3993"></td>
          <td id="LC3993">End Sub</td>
        </tr>
        <tr>
          <td id="L3994" data-line-number="3994"></td>
          <td id="LC3994">
</td>
        </tr>
        <tr>
          <td id="L3995" data-line-number="3995"></td>
          <td id="LC3995">&#39;= HMAC-based key derivation functions ===================================</td>
        </tr>
        <tr>
          <td id="L3996" data-line-number="3996"></td>
          <td id="LC3996">
</td>
        </tr>
        <tr>
          <td id="L3997" data-line-number="3997"></td>
          <td id="LC3997">Private Sub pvTlsDeriveHandshakeSecrets(uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L3998" data-line-number="3998"></td>
          <td id="LC3998">    Const FUNC_NAME     As String = &#34;pvTlsDeriveHandshakeSecrets&#34;</td>
        </tr>
        <tr>
          <td id="L3999" data-line-number="3999"></td>
          <td id="LC3999">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L4000" data-line-number="4000"></td>
          <td id="LC4000">    Dim baEarlySecret() As Byte</td>
        </tr>
        <tr>
          <td id="L4001" data-line-number="4001"></td>
          <td id="LC4001">    Dim baEmptyHash()   As Byte</td>
        </tr>
        <tr>
          <td id="L4002" data-line-number="4002"></td>
          <td id="LC4002">    Dim baDerivedSecret() As Byte</td>
        </tr>
        <tr>
          <td id="L4003" data-line-number="4003"></td>
          <td id="LC4003">    Dim baSharedSecret() As Byte</td>
        </tr>
        <tr>
          <td id="L4004" data-line-number="4004"></td>
          <td id="LC4004">    Dim baEmpty()       As Byte</td>
        </tr>
        <tr>
          <td id="L4005" data-line-number="4005"></td>
          <td id="LC4005">    Dim baZeroes()      As Byte</td>
        </tr>
        <tr>
          <td id="L4006" data-line-number="4006"></td>
          <td id="LC4006">    </td>
        </tr>
        <tr>
          <td id="L4007" data-line-number="4007"></td>
          <td id="LC4007">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4008" data-line-number="4008"></td>
          <td id="LC4008">        If .HandshakeMessages.Size = 0 Then</td>
        </tr>
        <tr>
          <td id="L4009" data-line-number="4009"></td>
          <td id="LC4009">            ErrRaise vbObjectError, FUNC_NAME, ERR_NO_HANDSHAKE_MESSAGES</td>
        </tr>
        <tr>
          <td id="L4010" data-line-number="4010"></td>
          <td id="LC4010">        End If</td>
        </tr>
        <tr>
          <td id="L4011" data-line-number="4011"></td>
          <td id="LC4011">        pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L4012" data-line-number="4012"></td>
          <td id="LC4012">        pvArrayAllocate baZeroes, .DigestSize, FUNC_NAME &amp; &#34;.baZeroes&#34;</td>
        </tr>
        <tr>
          <td id="L4013" data-line-number="4013"></td>
          <td id="LC4013">        pvTlsHkdfExtract baEarlySecret, .DigestAlgo, baZeroes, baZeroes</td>
        </tr>
        <tr>
          <td id="L4014" data-line-number="4014"></td>
          <td id="LC4014">        pvTlsGetHash baEmptyHash, .DigestAlgo, baEmpty</td>
        </tr>
        <tr>
          <td id="L4015" data-line-number="4015"></td>
          <td id="LC4015">        pvTlsHkdfExpandLabel baDerivedSecret, .DigestAlgo, baEarlySecret, &#34;derived&#34;, baEmptyHash, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4016" data-line-number="4016"></td>
          <td id="LC4016">        pvTlsGetSharedSecret baSharedSecret, .ExchAlgo, .LocalExchPrivate, .RemoteExchPublic</td>
        </tr>
        <tr>
          <td id="L4017" data-line-number="4017"></td>
          <td id="LC4017">        pvTlsHkdfExtract .HandshakeSecret, .DigestAlgo, baDerivedSecret, baSharedSecret</td>
        </tr>
        <tr>
          <td id="L4018" data-line-number="4018"></td>
          <td id="LC4018">        pvTlsHkdfExpandLabel .RemoteTrafficSecret, .DigestAlgo, .HandshakeSecret, IIf(.IsServer, &#34;c&#34;, &#34;s&#34;) &amp; &#34; hs traffic&#34;, baHandshakeHash, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4019" data-line-number="4019"></td>
          <td id="LC4019">        pvTlsHkdfExpandLabel .RemoteTrafficKey, .DigestAlgo, .RemoteTrafficSecret, &#34;key&#34;, baEmpty, .KeySize</td>
        </tr>
        <tr>
          <td id="L4020" data-line-number="4020"></td>
          <td id="LC4020">        pvTlsHkdfExpandLabel .RemoteTrafficIV, .DigestAlgo, .RemoteTrafficSecret, &#34;iv&#34;, baEmpty, .IvSize</td>
        </tr>
        <tr>
          <td id="L4021" data-line-number="4021"></td>
          <td id="LC4021">        .RemoteTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L4022" data-line-number="4022"></td>
          <td id="LC4022">        pvTlsLogSecret uCtx, IIf(.IsServer, &#34;CLIENT&#34;, &#34;SERVER&#34;) &amp; &#34;_HANDSHAKE_TRAFFIC_SECRET&#34;, .RemoteTrafficSecret</td>
        </tr>
        <tr>
          <td id="L4023" data-line-number="4023"></td>
          <td id="LC4023">        pvTlsHkdfExpandLabel .LocalTrafficSecret, .DigestAlgo, .HandshakeSecret, IIf(.IsServer, &#34;s&#34;, &#34;c&#34;) &amp; &#34; hs traffic&#34;, baHandshakeHash, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4024" data-line-number="4024"></td>
          <td id="LC4024">        pvTlsHkdfExpandLabel .LocalTrafficKey, .DigestAlgo, .LocalTrafficSecret, &#34;key&#34;, baEmpty, .KeySize</td>
        </tr>
        <tr>
          <td id="L4025" data-line-number="4025"></td>
          <td id="LC4025">        pvTlsHkdfExpandLabel .LocalTrafficIV, .DigestAlgo, .LocalTrafficSecret, &#34;iv&#34;, baEmpty, .IvSize</td>
        </tr>
        <tr>
          <td id="L4026" data-line-number="4026"></td>
          <td id="LC4026">        .LocalTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L4027" data-line-number="4027"></td>
          <td id="LC4027">        pvTlsLogSecret uCtx, IIf(.IsServer, &#34;SERVER&#34;, &#34;CLIENT&#34;) &amp; &#34;_HANDSHAKE_TRAFFIC_SECRET&#34;, .LocalTrafficSecret</td>
        </tr>
        <tr>
          <td id="L4028" data-line-number="4028"></td>
          <td id="LC4028">    End With</td>
        </tr>
        <tr>
          <td id="L4029" data-line-number="4029"></td>
          <td id="LC4029">End Sub</td>
        </tr>
        <tr>
          <td id="L4030" data-line-number="4030"></td>
          <td id="LC4030">
</td>
        </tr>
        <tr>
          <td id="L4031" data-line-number="4031"></td>
          <td id="LC4031">Private Sub pvTlsDeriveApplicationSecrets(uCtx As UcsTlsContext, baHandshakeHash() As Byte)</td>
        </tr>
        <tr>
          <td id="L4032" data-line-number="4032"></td>
          <td id="LC4032">    Const FUNC_NAME     As String = &#34;pvTlsDeriveApplicationSecrets&#34;</td>
        </tr>
        <tr>
          <td id="L4033" data-line-number="4033"></td>
          <td id="LC4033">    Dim baEmptyHash()   As Byte</td>
        </tr>
        <tr>
          <td id="L4034" data-line-number="4034"></td>
          <td id="LC4034">    Dim baDerivedSecret() As Byte</td>
        </tr>
        <tr>
          <td id="L4035" data-line-number="4035"></td>
          <td id="LC4035">    Dim baEmpty()       As Byte</td>
        </tr>
        <tr>
          <td id="L4036" data-line-number="4036"></td>
          <td id="LC4036">    Dim baZeroes()      As Byte</td>
        </tr>
        <tr>
          <td id="L4037" data-line-number="4037"></td>
          <td id="LC4037">    </td>
        </tr>
        <tr>
          <td id="L4038" data-line-number="4038"></td>
          <td id="LC4038">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4039" data-line-number="4039"></td>
          <td id="LC4039">        If .HandshakeMessages.Size = 0 Then</td>
        </tr>
        <tr>
          <td id="L4040" data-line-number="4040"></td>
          <td id="LC4040">            ErrRaise vbObjectError, FUNC_NAME, ERR_NO_HANDSHAKE_MESSAGES</td>
        </tr>
        <tr>
          <td id="L4041" data-line-number="4041"></td>
          <td id="LC4041">        End If</td>
        </tr>
        <tr>
          <td id="L4042" data-line-number="4042"></td>
          <td id="LC4042">        pvTlsGetHash baEmptyHash, .DigestAlgo, baEmpty</td>
        </tr>
        <tr>
          <td id="L4043" data-line-number="4043"></td>
          <td id="LC4043">        pvTlsHkdfExpandLabel baDerivedSecret, .DigestAlgo, .HandshakeSecret, &#34;derived&#34;, baEmptyHash, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4044" data-line-number="4044"></td>
          <td id="LC4044">        pvArrayAllocate baZeroes, .DigestSize, FUNC_NAME &amp; &#34;.baZeroes&#34;</td>
        </tr>
        <tr>
          <td id="L4045" data-line-number="4045"></td>
          <td id="LC4045">        pvTlsHkdfExtract .MasterSecret, .DigestAlgo, baDerivedSecret, baZeroes</td>
        </tr>
        <tr>
          <td id="L4046" data-line-number="4046"></td>
          <td id="LC4046">        pvTlsHkdfExpandLabel .RemoteTrafficSecret, .DigestAlgo, .MasterSecret, IIf(.IsServer, &#34;c&#34;, &#34;s&#34;) &amp; &#34; ap traffic&#34;, baHandshakeHash, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4047" data-line-number="4047"></td>
          <td id="LC4047">        pvTlsHkdfExpandLabel .RemoteTrafficKey, .DigestAlgo, .RemoteTrafficSecret, &#34;key&#34;, baEmpty, .KeySize</td>
        </tr>
        <tr>
          <td id="L4048" data-line-number="4048"></td>
          <td id="LC4048">        pvTlsHkdfExpandLabel .RemoteTrafficIV, .DigestAlgo, .RemoteTrafficSecret, &#34;iv&#34;, baEmpty, .IvSize</td>
        </tr>
        <tr>
          <td id="L4049" data-line-number="4049"></td>
          <td id="LC4049">        .RemoteTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L4050" data-line-number="4050"></td>
          <td id="LC4050">        pvTlsLogSecret uCtx, IIf(.IsServer, &#34;CLIENT&#34;, &#34;SERVER&#34;) &amp; &#34;_TRAFFIC_SECRET_0&#34;, .RemoteTrafficSecret</td>
        </tr>
        <tr>
          <td id="L4051" data-line-number="4051"></td>
          <td id="LC4051">        pvTlsHkdfExpandLabel .LocalTrafficSecret, .DigestAlgo, .MasterSecret, IIf(.IsServer, &#34;s&#34;, &#34;c&#34;) &amp; &#34; ap traffic&#34;, baHandshakeHash, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4052" data-line-number="4052"></td>
          <td id="LC4052">        pvTlsHkdfExpandLabel .LocalTrafficKey, .DigestAlgo, .LocalTrafficSecret, &#34;key&#34;, baEmpty, .KeySize</td>
        </tr>
        <tr>
          <td id="L4053" data-line-number="4053"></td>
          <td id="LC4053">        pvTlsHkdfExpandLabel .LocalTrafficIV, .DigestAlgo, .LocalTrafficSecret, &#34;iv&#34;, baEmpty, .IvSize</td>
        </tr>
        <tr>
          <td id="L4054" data-line-number="4054"></td>
          <td id="LC4054">        .LocalTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L4055" data-line-number="4055"></td>
          <td id="LC4055">        pvTlsLogSecret uCtx, IIf(.IsServer, &#34;SERVER&#34;, &#34;CLIENT&#34;) &amp; &#34;_TRAFFIC_SECRET_0&#34;, .LocalTrafficSecret</td>
        </tr>
        <tr>
          <td id="L4056" data-line-number="4056"></td>
          <td id="LC4056">    End With</td>
        </tr>
        <tr>
          <td id="L4057" data-line-number="4057"></td>
          <td id="LC4057">End Sub</td>
        </tr>
        <tr>
          <td id="L4058" data-line-number="4058"></td>
          <td id="LC4058">
</td>
        </tr>
        <tr>
          <td id="L4059" data-line-number="4059"></td>
          <td id="LC4059">Private Sub pvTlsDeriveKeyUpdate(uCtx As UcsTlsContext, ByVal bLocalUpdate As Boolean)</td>
        </tr>
        <tr>
          <td id="L4060" data-line-number="4060"></td>
          <td id="LC4060">    Const FUNC_NAME     As String = &#34;pvTlsDeriveKeyUpdate&#34;</td>
        </tr>
        <tr>
          <td id="L4061" data-line-number="4061"></td>
          <td id="LC4061">    Dim baEmpty()       As Byte</td>
        </tr>
        <tr>
          <td id="L4062" data-line-number="4062"></td>
          <td id="LC4062">    </td>
        </tr>
        <tr>
          <td id="L4063" data-line-number="4063"></td>
          <td id="LC4063">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4064" data-line-number="4064"></td>
          <td id="LC4064">        If pvArraySize(.RemoteTrafficSecret) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4065" data-line-number="4065"></td>
          <td id="LC4065">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_NO_PREVIOUS_SECRET, &#34;%1&#34;, &#34;RemoteTrafficSecret&#34;)</td>
        </tr>
        <tr>
          <td id="L4066" data-line-number="4066"></td>
          <td id="LC4066">        End If</td>
        </tr>
        <tr>
          <td id="L4067" data-line-number="4067"></td>
          <td id="LC4067">        pvTlsHkdfExpandLabel .RemoteTrafficSecret, .DigestAlgo, .RemoteTrafficSecret, &#34;traffic upd&#34;, baEmpty, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4068" data-line-number="4068"></td>
          <td id="LC4068">        pvTlsHkdfExpandLabel .RemoteTrafficKey, .DigestAlgo, .RemoteTrafficSecret, &#34;key&#34;, baEmpty, .KeySize</td>
        </tr>
        <tr>
          <td id="L4069" data-line-number="4069"></td>
          <td id="LC4069">        pvTlsHkdfExpandLabel .RemoteTrafficIV, .DigestAlgo, .RemoteTrafficSecret, &#34;iv&#34;, baEmpty, .IvSize</td>
        </tr>
        <tr>
          <td id="L4070" data-line-number="4070"></td>
          <td id="LC4070">        .RemoteTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L4071" data-line-number="4071"></td>
          <td id="LC4071">        pvTlsLogSecret uCtx, IIf(.IsServer, &#34;CLIENT&#34;, &#34;SERVER&#34;) &amp; &#34;_TRAFFIC_SECRET_0&#34;, .RemoteTrafficSecret</td>
        </tr>
        <tr>
          <td id="L4072" data-line-number="4072"></td>
          <td id="LC4072">        If bLocalUpdate Then</td>
        </tr>
        <tr>
          <td id="L4073" data-line-number="4073"></td>
          <td id="LC4073">            If pvArraySize(.LocalTrafficSecret) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4074" data-line-number="4074"></td>
          <td id="LC4074">                ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_NO_PREVIOUS_SECRET, &#34;%1&#34;, &#34;LocalTrafficSecret&#34;)</td>
        </tr>
        <tr>
          <td id="L4075" data-line-number="4075"></td>
          <td id="LC4075">            End If</td>
        </tr>
        <tr>
          <td id="L4076" data-line-number="4076"></td>
          <td id="LC4076">            pvTlsHkdfExpandLabel .LocalTrafficSecret, .DigestAlgo, .LocalTrafficSecret, &#34;traffic upd&#34;, baEmpty, .DigestSize</td>
        </tr>
        <tr>
          <td id="L4077" data-line-number="4077"></td>
          <td id="LC4077">            pvTlsHkdfExpandLabel .LocalTrafficKey, .DigestAlgo, .LocalTrafficSecret, &#34;key&#34;, baEmpty, .KeySize</td>
        </tr>
        <tr>
          <td id="L4078" data-line-number="4078"></td>
          <td id="LC4078">            pvTlsHkdfExpandLabel .LocalTrafficIV, .DigestAlgo, .LocalTrafficSecret, &#34;iv&#34;, baEmpty, .IvSize</td>
        </tr>
        <tr>
          <td id="L4079" data-line-number="4079"></td>
          <td id="LC4079">            .LocalTrafficSeqNo = 0</td>
        </tr>
        <tr>
          <td id="L4080" data-line-number="4080"></td>
          <td id="LC4080">            pvTlsLogSecret uCtx, IIf(.IsServer, &#34;SERVER&#34;, &#34;CLIENT&#34;) &amp; &#34;_TRAFFIC_SECRET_0&#34;, .LocalTrafficSecret</td>
        </tr>
        <tr>
          <td id="L4081" data-line-number="4081"></td>
          <td id="LC4081">        End If</td>
        </tr>
        <tr>
          <td id="L4082" data-line-number="4082"></td>
          <td id="LC4082">    End With</td>
        </tr>
        <tr>
          <td id="L4083" data-line-number="4083"></td>
          <td id="LC4083">End Sub</td>
        </tr>
        <tr>
          <td id="L4084" data-line-number="4084"></td>
          <td id="LC4084">
</td>
        </tr>
        <tr>
          <td id="L4085" data-line-number="4085"></td>
          <td id="LC4085">Private Sub pvTlsHkdfExpandLabel(baRetVal() As Byte, ByVal eHash As UcsTlsCryptoAlgorithmsEnum, baKey() As Byte, ByVal sLabel As String, baContext() As Byte, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L4086" data-line-number="4086"></td>
          <td id="LC4086">    Const FUNC_NAME     As String = &#34;pvTlsHkdfExpandLabel&#34;</td>
        </tr>
        <tr>
          <td id="L4087" data-line-number="4087"></td>
          <td id="LC4087">    Dim uOutput         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4088" data-line-number="4088"></td>
          <td id="LC4088">    Dim uInfo           As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4089" data-line-number="4089"></td>
          <td id="LC4089">    Dim uInput          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4090" data-line-number="4090"></td>
          <td id="LC4090">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L4091" data-line-number="4091"></td>
          <td id="LC4091">    Dim baLast()        As Byte</td>
        </tr>
        <tr>
          <td id="L4092" data-line-number="4092"></td>
          <td id="LC4092">    </td>
        </tr>
        <tr>
          <td id="L4093" data-line-number="4093"></td>
          <td id="LC4093">    sLabel = &#34;tls13 &#34; &amp; sLabel</td>
        </tr>
        <tr>
          <td id="L4094" data-line-number="4094"></td>
          <td id="LC4094">    pvArrayAllocate uInfo.Data, 3 + Len(sLabel) + 1 + pvArraySize(baContext), FUNC_NAME &amp; &#34;.uInfo&#34;</td>
        </tr>
        <tr>
          <td id="L4095" data-line-number="4095"></td>
          <td id="LC4095">    pvBufferWriteLong uInfo, lSize, Size:=2</td>
        </tr>
        <tr>
          <td id="L4096" data-line-number="4096"></td>
          <td id="LC4096">    pvBufferWriteLong uInfo, Len(sLabel)</td>
        </tr>
        <tr>
          <td id="L4097" data-line-number="4097"></td>
          <td id="LC4097">    pvBufferWriteString uInfo, sLabel</td>
        </tr>
        <tr>
          <td id="L4098" data-line-number="4098"></td>
          <td id="LC4098">    pvBufferWriteLong uInfo, pvArraySize(baContext)</td>
        </tr>
        <tr>
          <td id="L4099" data-line-number="4099"></td>
          <td id="LC4099">    pvBufferWriteArray uInfo, baContext</td>
        </tr>
        <tr>
          <td id="L4100" data-line-number="4100"></td>
          <td id="LC4100">    pvBufferWriteEOF uInfo</td>
        </tr>
        <tr>
          <td id="L4101" data-line-number="4101"></td>
          <td id="LC4101">    lIdx = 1</td>
        </tr>
        <tr>
          <td id="L4102" data-line-number="4102"></td>
          <td id="LC4102">    Do While uOutput.Size &lt; lSize</td>
        </tr>
        <tr>
          <td id="L4103" data-line-number="4103"></td>
          <td id="LC4103">        uInput.Size = 0</td>
        </tr>
        <tr>
          <td id="L4104" data-line-number="4104"></td>
          <td id="LC4104">        pvBufferWriteArray uInput, baLast</td>
        </tr>
        <tr>
          <td id="L4105" data-line-number="4105"></td>
          <td id="LC4105">        pvBufferWriteArray uInput, uInfo.Data</td>
        </tr>
        <tr>
          <td id="L4106" data-line-number="4106"></td>
          <td id="LC4106">        pvBufferWriteLong uInput, lIdx</td>
        </tr>
        <tr>
          <td id="L4107" data-line-number="4107"></td>
          <td id="LC4107">        pvBufferWriteEOF uInput</td>
        </tr>
        <tr>
          <td id="L4108" data-line-number="4108"></td>
          <td id="LC4108">        pvTlsGetHmac baLast, eHash, baKey, uInput.Data</td>
        </tr>
        <tr>
          <td id="L4109" data-line-number="4109"></td>
          <td id="LC4109">        pvBufferWriteArray uOutput, baLast</td>
        </tr>
        <tr>
          <td id="L4110" data-line-number="4110"></td>
          <td id="LC4110">        lIdx = lIdx + 1</td>
        </tr>
        <tr>
          <td id="L4111" data-line-number="4111"></td>
          <td id="LC4111">    Loop</td>
        </tr>
        <tr>
          <td id="L4112" data-line-number="4112"></td>
          <td id="LC4112">    uOutput.Size = lSize</td>
        </tr>
        <tr>
          <td id="L4113" data-line-number="4113"></td>
          <td id="LC4113">    pvBufferWriteEOF uOutput</td>
        </tr>
        <tr>
          <td id="L4114" data-line-number="4114"></td>
          <td id="LC4114">    baRetVal = uOutput.Data</td>
        </tr>
        <tr>
          <td id="L4115" data-line-number="4115"></td>
          <td id="LC4115">End Sub</td>
        </tr>
        <tr>
          <td id="L4116" data-line-number="4116"></td>
          <td id="LC4116">
</td>
        </tr>
        <tr>
          <td id="L4117" data-line-number="4117"></td>
          <td id="LC4117">Private Sub pvTlsHkdfExtract(baRetVal() As Byte, ByVal eHash As UcsTlsCryptoAlgorithmsEnum, baKey() As Byte, baInput() As Byte)</td>
        </tr>
        <tr>
          <td id="L4118" data-line-number="4118"></td>
          <td id="LC4118">    pvTlsGetHmac baRetVal, eHash, baKey, baInput</td>
        </tr>
        <tr>
          <td id="L4119" data-line-number="4119"></td>
          <td id="LC4119">End Sub</td>
        </tr>
        <tr>
          <td id="L4120" data-line-number="4120"></td>
          <td id="LC4120">
</td>
        </tr>
        <tr>
          <td id="L4121" data-line-number="4121"></td>
          <td id="LC4121">&#39;= legacy PRF-based key derivation functions =============================</td>
        </tr>
        <tr>
          <td id="L4122" data-line-number="4122"></td>
          <td id="LC4122">
</td>
        </tr>
        <tr>
          <td id="L4123" data-line-number="4123"></td>
          <td id="LC4123">Private Sub pvTlsDeriveLegacySecrets(uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L4124" data-line-number="4124"></td>
          <td id="LC4124">    Const FUNC_NAME     As String = &#34;pvTlsDeriveLegacySecrets&#34;</td>
        </tr>
        <tr>
          <td id="L4125" data-line-number="4125"></td>
          <td id="LC4125">    Dim baPreMasterSecret() As Byte</td>
        </tr>
        <tr>
          <td id="L4126" data-line-number="4126"></td>
          <td id="LC4126">    Dim baHandshakeHash() As Byte</td>
        </tr>
        <tr>
          <td id="L4127" data-line-number="4127"></td>
          <td id="LC4127">    Dim uRandom         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4128" data-line-number="4128"></td>
          <td id="LC4128">    Dim uExpanded       As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4129" data-line-number="4129"></td>
          <td id="LC4129">    </td>
        </tr>
        <tr>
          <td id="L4130" data-line-number="4130"></td>
          <td id="LC4130">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4131" data-line-number="4131"></td>
          <td id="LC4131">        If pvArraySize(.RemoteExchRandom) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4132" data-line-number="4132"></td>
          <td id="LC4132">            ErrRaise vbObjectError, FUNC_NAME, ERR_NO_REMOTE_RANDOM</td>
        </tr>
        <tr>
          <td id="L4133" data-line-number="4133"></td>
          <td id="LC4133">        End If</td>
        </tr>
        <tr>
          <td id="L4134" data-line-number="4134"></td>
          <td id="LC4134">        pvTlsGetSharedSecret baPreMasterSecret, .ExchAlgo, .LocalExchPrivate, .RemoteExchPublic</td>
        </tr>
        <tr>
          <td id="L4135" data-line-number="4135"></td>
          <td id="LC4135">        #If (ImplCaptureTraffic And 2) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4136" data-line-number="4136"></td>
          <td id="LC4136">            .TrafficDump.Add FUNC_NAME &amp; &#34;.baPreMasterSecret&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baPreMasterSecret)</td>
        </tr>
        <tr>
          <td id="L4137" data-line-number="4137"></td>
          <td id="LC4137">        #End If</td>
        </tr>
        <tr>
          <td id="L4138" data-line-number="4138"></td>
          <td id="LC4138">        If SearchCollection(.RemoteExtensions, &#34;#&#34; &amp; TLS_EXTENSION_EXTENDED_MASTER_SECRET) Then</td>
        </tr>
        <tr>
          <td id="L4139" data-line-number="4139"></td>
          <td id="LC4139">            pvTlsGetHandshakeHash uCtx, baHandshakeHash</td>
        </tr>
        <tr>
          <td id="L4140" data-line-number="4140"></td>
          <td id="LC4140">            pvTlsKdfLegacyPrf .MasterSecret, .DigestAlgo, baPreMasterSecret, &#34;extended master secret&#34;, baHandshakeHash, TLS_LEGACY_SECRET_SIZE</td>
        </tr>
        <tr>
          <td id="L4141" data-line-number="4141"></td>
          <td id="LC4141">        Else</td>
        </tr>
        <tr>
          <td id="L4142" data-line-number="4142"></td>
          <td id="LC4142">            If uCtx.IsServer Then</td>
        </tr>
        <tr>
          <td id="L4143" data-line-number="4143"></td>
          <td id="LC4143">                pvBufferWriteArray uRandom, .RemoteExchRandom</td>
        </tr>
        <tr>
          <td id="L4144" data-line-number="4144"></td>
          <td id="LC4144">                pvBufferWriteArray uRandom, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L4145" data-line-number="4145"></td>
          <td id="LC4145">            Else</td>
        </tr>
        <tr>
          <td id="L4146" data-line-number="4146"></td>
          <td id="LC4146">                pvBufferWriteArray uRandom, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L4147" data-line-number="4147"></td>
          <td id="LC4147">                pvBufferWriteArray uRandom, .RemoteExchRandom</td>
        </tr>
        <tr>
          <td id="L4148" data-line-number="4148"></td>
          <td id="LC4148">            End If</td>
        </tr>
        <tr>
          <td id="L4149" data-line-number="4149"></td>
          <td id="LC4149">            pvBufferWriteEOF uRandom</td>
        </tr>
        <tr>
          <td id="L4150" data-line-number="4150"></td>
          <td id="LC4150">            pvTlsKdfLegacyPrf .MasterSecret, .DigestAlgo, baPreMasterSecret, &#34;master secret&#34;, uRandom.Data, TLS_LEGACY_SECRET_SIZE</td>
        </tr>
        <tr>
          <td id="L4151" data-line-number="4151"></td>
          <td id="LC4151">        End If</td>
        </tr>
        <tr>
          <td id="L4152" data-line-number="4152"></td>
          <td id="LC4152">        pvTlsLogSecret uCtx, &#34;CLIENT_RANDOM&#34;, .MasterSecret</td>
        </tr>
        <tr>
          <td id="L4153" data-line-number="4153"></td>
          <td id="LC4153">        #If (ImplCaptureTraffic And 2) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4154" data-line-number="4154"></td>
          <td id="LC4154">            .TrafficDump.Add FUNC_NAME &amp; &#34;.MasterSecret&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(.MasterSecret)</td>
        </tr>
        <tr>
          <td id="L4155" data-line-number="4155"></td>
          <td id="LC4155">        #End If</td>
        </tr>
        <tr>
          <td id="L4156" data-line-number="4156"></td>
          <td id="LC4156">        uRandom.Size = 0</td>
        </tr>
        <tr>
          <td id="L4157" data-line-number="4157"></td>
          <td id="LC4157">        If uCtx.IsServer Then</td>
        </tr>
        <tr>
          <td id="L4158" data-line-number="4158"></td>
          <td id="LC4158">            pvBufferWriteArray uRandom, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L4159" data-line-number="4159"></td>
          <td id="LC4159">            pvBufferWriteArray uRandom, .RemoteExchRandom</td>
        </tr>
        <tr>
          <td id="L4160" data-line-number="4160"></td>
          <td id="LC4160">        Else</td>
        </tr>
        <tr>
          <td id="L4161" data-line-number="4161"></td>
          <td id="LC4161">            pvBufferWriteArray uRandom, .RemoteExchRandom</td>
        </tr>
        <tr>
          <td id="L4162" data-line-number="4162"></td>
          <td id="LC4162">            pvBufferWriteArray uRandom, .LocalExchRandom</td>
        </tr>
        <tr>
          <td id="L4163" data-line-number="4163"></td>
          <td id="LC4163">        End If</td>
        </tr>
        <tr>
          <td id="L4164" data-line-number="4164"></td>
          <td id="LC4164">        pvBufferWriteEOF uRandom</td>
        </tr>
        <tr>
          <td id="L4165" data-line-number="4165"></td>
          <td id="LC4165">        pvTlsKdfLegacyPrf uExpanded.Data, .DigestAlgo, .MasterSecret, &#34;key expansion&#34;, uRandom.Data, 2 * (.MacSize + .KeySize + .IvSize)</td>
        </tr>
        <tr>
          <td id="L4166" data-line-number="4166"></td>
          <td id="LC4166">        #If (ImplCaptureTraffic And 2) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4167" data-line-number="4167"></td>
          <td id="LC4167">            .TrafficDump.Add FUNC_NAME &amp; &#34;.uExpanded.Data&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(uExpanded.Data)</td>
        </tr>
        <tr>
          <td id="L4168" data-line-number="4168"></td>
          <td id="LC4168">        #End If</td>
        </tr>
        <tr>
          <td id="L4169" data-line-number="4169"></td>
          <td id="LC4169">        If uCtx.IsServer Then</td>
        </tr>
        <tr>
          <td id="L4170" data-line-number="4170"></td>
          <td id="LC4170">            pvBufferReadArray uExpanded, .RemoteLegacyNextMacKey, .MacSize  &#39;--- not used w/ AEAD</td>
        </tr>
        <tr>
          <td id="L4171" data-line-number="4171"></td>
          <td id="LC4171">            pvBufferReadArray uExpanded, .LocalLegacyNextMacKey, .MacSize   &#39;--- not used w/ AEAD</td>
        </tr>
        <tr>
          <td id="L4172" data-line-number="4172"></td>
          <td id="LC4172">        Else</td>
        </tr>
        <tr>
          <td id="L4173" data-line-number="4173"></td>
          <td id="LC4173">            pvBufferReadArray uExpanded, .LocalLegacyNextMacKey, .MacSize   &#39;--- not used w/ AEAD</td>
        </tr>
        <tr>
          <td id="L4174" data-line-number="4174"></td>
          <td id="LC4174">            pvBufferReadArray uExpanded, .RemoteLegacyNextMacKey, .MacSize  &#39;--- not used w/ AEAD</td>
        </tr>
        <tr>
          <td id="L4175" data-line-number="4175"></td>
          <td id="LC4175">        End If</td>
        </tr>
        <tr>
          <td id="L4176" data-line-number="4176"></td>
          <td id="LC4176">        If uCtx.IsServer Then</td>
        </tr>
        <tr>
          <td id="L4177" data-line-number="4177"></td>
          <td id="LC4177">            pvBufferReadArray uExpanded, .RemoteLegacyNextTrafficKey, .KeySize</td>
        </tr>
        <tr>
          <td id="L4178" data-line-number="4178"></td>
          <td id="LC4178">            pvBufferReadArray uExpanded, .LocalLegacyNextTrafficKey, .KeySize</td>
        </tr>
        <tr>
          <td id="L4179" data-line-number="4179"></td>
          <td id="LC4179">        Else</td>
        </tr>
        <tr>
          <td id="L4180" data-line-number="4180"></td>
          <td id="LC4180">            pvBufferReadArray uExpanded, .LocalLegacyNextTrafficKey, .KeySize</td>
        </tr>
        <tr>
          <td id="L4181" data-line-number="4181"></td>
          <td id="LC4181">            pvBufferReadArray uExpanded, .RemoteLegacyNextTrafficKey, .KeySize</td>
        </tr>
        <tr>
          <td id="L4182" data-line-number="4182"></td>
          <td id="LC4182">        End If</td>
        </tr>
        <tr>
          <td id="L4183" data-line-number="4183"></td>
          <td id="LC4183">        If uCtx.IsServer Then</td>
        </tr>
        <tr>
          <td id="L4184" data-line-number="4184"></td>
          <td id="LC4184">            pvTlsGetRandom .RemoteLegacyNextTrafficIV, .IvSize</td>
        </tr>
        <tr>
          <td id="L4185" data-line-number="4185"></td>
          <td id="LC4185">            pvBufferReadBlob uExpanded, VarPtr(.RemoteLegacyNextTrafficIV(0)), .IvSize - .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L4186" data-line-number="4186"></td>
          <td id="LC4186">            pvTlsGetRandom .LocalLegacyNextTrafficIV, .IvSize</td>
        </tr>
        <tr>
          <td id="L4187" data-line-number="4187"></td>
          <td id="LC4187">            pvBufferReadBlob uExpanded, VarPtr(.LocalLegacyNextTrafficIV(0)), .IvSize - .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L4188" data-line-number="4188"></td>
          <td id="LC4188">        Else</td>
        </tr>
        <tr>
          <td id="L4189" data-line-number="4189"></td>
          <td id="LC4189">            pvTlsGetRandom .LocalLegacyNextTrafficIV, .IvSize</td>
        </tr>
        <tr>
          <td id="L4190" data-line-number="4190"></td>
          <td id="LC4190">            pvBufferReadBlob uExpanded, VarPtr(.LocalLegacyNextTrafficIV(0)), .IvSize - .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L4191" data-line-number="4191"></td>
          <td id="LC4191">            pvTlsGetRandom .RemoteLegacyNextTrafficIV, .IvSize</td>
        </tr>
        <tr>
          <td id="L4192" data-line-number="4192"></td>
          <td id="LC4192">            pvBufferReadBlob uExpanded, VarPtr(.RemoteLegacyNextTrafficIV(0)), .IvSize - .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L4193" data-line-number="4193"></td>
          <td id="LC4193">        End If</td>
        </tr>
        <tr>
          <td id="L4194" data-line-number="4194"></td>
          <td id="LC4194">    End With</td>
        </tr>
        <tr>
          <td id="L4195" data-line-number="4195"></td>
          <td id="LC4195">End Sub</td>
        </tr>
        <tr>
          <td id="L4196" data-line-number="4196"></td>
          <td id="LC4196">
</td>
        </tr>
        <tr>
          <td id="L4197" data-line-number="4197"></td>
          <td id="LC4197">Private Sub pvTlsKdfLegacyPrf(baRetVal() As Byte, ByVal eHash As UcsTlsCryptoAlgorithmsEnum, baKey() As Byte, ByVal sLabel As String, baContext() As Byte, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L4198" data-line-number="4198"></td>
          <td id="LC4198">    Dim uOutput         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4199" data-line-number="4199"></td>
          <td id="LC4199">    Dim uSeed           As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4200" data-line-number="4200"></td>
          <td id="LC4200">    Dim uInput          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4201" data-line-number="4201"></td>
          <td id="LC4201">    Dim baLast()        As Byte</td>
        </tr>
        <tr>
          <td id="L4202" data-line-number="4202"></td>
          <td id="LC4202">    Dim baHmac()        As Byte</td>
        </tr>
        <tr>
          <td id="L4203" data-line-number="4203"></td>
          <td id="LC4203">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L4204" data-line-number="4204"></td>
          <td id="LC4204">    </td>
        </tr>
        <tr>
          <td id="L4205" data-line-number="4205"></td>
          <td id="LC4205">    &#39;--- for TLS 1.2 -- PRF(secret, label, seed) = P_&lt;hash&gt;(secret, label + seed)</td>
        </tr>
        <tr>
          <td id="L4206" data-line-number="4206"></td>
          <td id="LC4206">    pvBufferWriteString uSeed, sLabel</td>
        </tr>
        <tr>
          <td id="L4207" data-line-number="4207"></td>
          <td id="LC4207">    pvBufferWriteArray uSeed, baContext</td>
        </tr>
        <tr>
          <td id="L4208" data-line-number="4208"></td>
          <td id="LC4208">    pvBufferWriteEOF uSeed</td>
        </tr>
        <tr>
          <td id="L4209" data-line-number="4209"></td>
          <td id="LC4209">    baLast = uSeed.Data</td>
        </tr>
        <tr>
          <td id="L4210" data-line-number="4210"></td>
          <td id="LC4210">    Do While uOutput.Size &lt; lSize</td>
        </tr>
        <tr>
          <td id="L4211" data-line-number="4211"></td>
          <td id="LC4211">        baTemp = baLast</td>
        </tr>
        <tr>
          <td id="L4212" data-line-number="4212"></td>
          <td id="LC4212">        pvTlsGetHmac baLast, eHash, baKey, baTemp</td>
        </tr>
        <tr>
          <td id="L4213" data-line-number="4213"></td>
          <td id="LC4213">        pvBufferWriteArray uInput, baLast</td>
        </tr>
        <tr>
          <td id="L4214" data-line-number="4214"></td>
          <td id="LC4214">        pvBufferWriteArray uInput, uSeed.Data</td>
        </tr>
        <tr>
          <td id="L4215" data-line-number="4215"></td>
          <td id="LC4215">        pvBufferWriteEOF uInput</td>
        </tr>
        <tr>
          <td id="L4216" data-line-number="4216"></td>
          <td id="LC4216">        pvTlsGetHmac baHmac, eHash, baKey, uInput.Data</td>
        </tr>
        <tr>
          <td id="L4217" data-line-number="4217"></td>
          <td id="LC4217">        pvBufferWriteArray uOutput, baHmac</td>
        </tr>
        <tr>
          <td id="L4218" data-line-number="4218"></td>
          <td id="LC4218">    Loop</td>
        </tr>
        <tr>
          <td id="L4219" data-line-number="4219"></td>
          <td id="LC4219">    uOutput.Size = lSize</td>
        </tr>
        <tr>
          <td id="L4220" data-line-number="4220"></td>
          <td id="LC4220">    pvBufferWriteEOF uOutput</td>
        </tr>
        <tr>
          <td id="L4221" data-line-number="4221"></td>
          <td id="LC4221">    baRetVal = uOutput.Data</td>
        </tr>
        <tr>
          <td id="L4222" data-line-number="4222"></td>
          <td id="LC4222">End Sub</td>
        </tr>
        <tr>
          <td id="L4223" data-line-number="4223"></td>
          <td id="LC4223">
</td>
        </tr>
        <tr>
          <td id="L4224" data-line-number="4224"></td>
          <td id="LC4224">Private Sub pvTlsGetHandshakeHash(uCtx As UcsTlsContext, baRetVal() As Byte)</td>
        </tr>
        <tr>
          <td id="L4225" data-line-number="4225"></td>
          <td id="LC4225">    Const FUNC_NAME     As String = &#34;pvTlsGetHandshakeHash&#34;</td>
        </tr>
        <tr>
          <td id="L4226" data-line-number="4226"></td>
          <td id="LC4226">    </td>
        </tr>
        <tr>
          <td id="L4227" data-line-number="4227"></td>
          <td id="LC4227">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4228" data-line-number="4228"></td>
          <td id="LC4228">        pvTlsGetHash baRetVal, .DigestAlgo, .HandshakeMessages.Data, Size:=.HandshakeMessages.Size</td>
        </tr>
        <tr>
          <td id="L4229" data-line-number="4229"></td>
          <td id="LC4229">        #If (ImplCaptureTraffic And 2) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4230" data-line-number="4230"></td>
          <td id="LC4230">            .TrafficDump.Add FUNC_NAME &amp; &#34;.baRetVal&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baRetVal)</td>
        </tr>
        <tr>
          <td id="L4231" data-line-number="4231"></td>
          <td id="LC4231">        #End If</td>
        </tr>
        <tr>
          <td id="L4232" data-line-number="4232"></td>
          <td id="LC4232">    End With</td>
        </tr>
        <tr>
          <td id="L4233" data-line-number="4233"></td>
          <td id="LC4233">End Sub</td>
        </tr>
        <tr>
          <td id="L4234" data-line-number="4234"></td>
          <td id="LC4234">
</td>
        </tr>
        <tr>
          <td id="L4235" data-line-number="4235"></td>
          <td id="LC4235">Private Sub pvTlsAppendHandshakeHash(uCtx As UcsTlsContext, baInput() As Byte, ByVal lPos As Long, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L4236" data-line-number="4236"></td>
          <td id="LC4236">    Const FUNC_NAME     As String = &#34;pvTlsAppendHandshakeHash&#34;</td>
        </tr>
        <tr>
          <td id="L4237" data-line-number="4237"></td>
          <td id="LC4237">    </td>
        </tr>
        <tr>
          <td id="L4238" data-line-number="4238"></td>
          <td id="LC4238">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4239" data-line-number="4239"></td>
          <td id="LC4239">        #If (ImplCaptureTraffic And 2) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4240" data-line-number="4240"></td>
          <td id="LC4240">            .TrafficDump.Add FUNC_NAME &amp; &#34;.baInput(&#34; &amp; lSize &amp; &#34;)&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(baInput, lPos, lSize)</td>
        </tr>
        <tr>
          <td id="L4241" data-line-number="4241"></td>
          <td id="LC4241">        #End If</td>
        </tr>
        <tr>
          <td id="L4242" data-line-number="4242"></td>
          <td id="LC4242">        pvBufferWriteBlob .HandshakeMessages, VarPtr(baInput(lPos)), lSize</td>
        </tr>
        <tr>
          <td id="L4243" data-line-number="4243"></td>
          <td id="LC4243">    End With</td>
        </tr>
        <tr>
          <td id="L4244" data-line-number="4244"></td>
          <td id="LC4244">End Sub</td>
        </tr>
        <tr>
          <td id="L4245" data-line-number="4245"></td>
          <td id="LC4245">
</td>
        </tr>
        <tr>
          <td id="L4246" data-line-number="4246"></td>
          <td id="LC4246">Private Sub pvTlsResetHandshakeHash(uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L4247" data-line-number="4247"></td>
          <td id="LC4247">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4248" data-line-number="4248"></td>
          <td id="LC4248">        .HandshakeMessages.Size = 0</td>
        </tr>
        <tr>
          <td id="L4249" data-line-number="4249"></td>
          <td id="LC4249">        pvBufferWriteEOF .HandshakeMessages</td>
        </tr>
        <tr>
          <td id="L4250" data-line-number="4250"></td>
          <td id="LC4250">    End With</td>
        </tr>
        <tr>
          <td id="L4251" data-line-number="4251"></td>
          <td id="LC4251">End Sub</td>
        </tr>
        <tr>
          <td id="L4252" data-line-number="4252"></td>
          <td id="LC4252">
</td>
        </tr>
        <tr>
          <td id="L4253" data-line-number="4253"></td>
          <td id="LC4253">Private Sub pvTlsLogSecret(uCtx As UcsTlsContext, sLabel As String, baSecret() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1)</td>
        </tr>
        <tr>
          <td id="L4254" data-line-number="4254"></td>
          <td id="LC4254">    Dim sFileName       As String</td>
        </tr>
        <tr>
          <td id="L4255" data-line-number="4255"></td>
          <td id="LC4255">    Dim nFile           As Integer</td>
        </tr>
        <tr>
          <td id="L4256" data-line-number="4256"></td>
          <td id="LC4256">    </td>
        </tr>
        <tr>
          <td id="L4257" data-line-number="4257"></td>
          <td id="LC4257">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L4258" data-line-number="4258"></td>
          <td id="LC4258">    sFileName = String$(1000, 0)</td>
        </tr>
        <tr>
          <td id="L4259" data-line-number="4259"></td>
          <td id="LC4259">    Call GetEnvironmentVariable(StrPtr(&#34;SSLKEYLOGFILE&#34;), StrPtr(sFileName), Len(sFileName) + 1)</td>
        </tr>
        <tr>
          <td id="L4260" data-line-number="4260"></td>
          <td id="LC4260">    sFileName = Left$(sFileName, InStr(sFileName, vbNullChar) - 1)</td>
        </tr>
        <tr>
          <td id="L4261" data-line-number="4261"></td>
          <td id="LC4261">    If LenB(sFileName) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4262" data-line-number="4262"></td>
          <td id="LC4262">        If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4263" data-line-number="4263"></td>
          <td id="LC4263">            Size = pvArraySize(baSecret) - Pos</td>
        </tr>
        <tr>
          <td id="L4264" data-line-number="4264"></td>
          <td id="LC4264">        End If</td>
        </tr>
        <tr>
          <td id="L4265" data-line-number="4265"></td>
          <td id="LC4265">        nFile = FreeFile</td>
        </tr>
        <tr>
          <td id="L4266" data-line-number="4266"></td>
          <td id="LC4266">        Open sFileName For Append Shared As nFile</td>
        </tr>
        <tr>
          <td id="L4267" data-line-number="4267"></td>
          <td id="LC4267">        Print #nFile, sLabel &amp; &#34; &#34; &amp; pvToHex(VarPtr(uCtx.LocalExchRandom(0)), UBound(uCtx.LocalExchRandom) + 1) &amp; &#34; &#34; &amp; pvToHex(VarPtr(baSecret(Pos)), Size)</td>
        </tr>
        <tr>
          <td id="L4268" data-line-number="4268"></td>
          <td id="LC4268">        Close nFile</td>
        </tr>
        <tr>
          <td id="L4269" data-line-number="4269"></td>
          <td id="LC4269">    End If</td>
        </tr>
        <tr>
          <td id="L4270" data-line-number="4270"></td>
          <td id="LC4270">EH:</td>
        </tr>
        <tr>
          <td id="L4271" data-line-number="4271"></td>
          <td id="LC4271">End Sub</td>
        </tr>
        <tr>
          <td id="L4272" data-line-number="4272"></td>
          <td id="LC4272">
</td>
        </tr>
        <tr>
          <td id="L4273" data-line-number="4273"></td>
          <td id="LC4273">&#39;= crypto wrappers =======================================================</td>
        </tr>
        <tr>
          <td id="L4274" data-line-number="4274"></td>
          <td id="LC4274">
</td>
        </tr>
        <tr>
          <td id="L4275" data-line-number="4275"></td>
          <td id="LC4275">Private Sub pvTlsGetRandom(baRetVal() As Byte, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L4276" data-line-number="4276"></td>
          <td id="LC4276">    Const FUNC_NAME     As String = &#34;pvTlsGetRandom&#34;</td>
        </tr>
        <tr>
          <td id="L4277" data-line-number="4277"></td>
          <td id="LC4277">    </td>
        </tr>
        <tr>
          <td id="L4278" data-line-number="4278"></td>
          <td id="LC4278">    If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4279" data-line-number="4279"></td>
          <td id="LC4279">        pvArrayAllocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L4280" data-line-number="4280"></td>
          <td id="LC4280">        pvCryptoRandomBytes VarPtr(baRetVal(0)), lSize</td>
        </tr>
        <tr>
          <td id="L4281" data-line-number="4281"></td>
          <td id="LC4281">    Else</td>
        </tr>
        <tr>
          <td id="L4282" data-line-number="4282"></td>
          <td id="LC4282">        baRetVal = vbNullString</td>
        </tr>
        <tr>
          <td id="L4283" data-line-number="4283"></td>
          <td id="LC4283">    End If</td>
        </tr>
        <tr>
          <td id="L4284" data-line-number="4284"></td>
          <td id="LC4284">End Sub</td>
        </tr>
        <tr>
          <td id="L4285" data-line-number="4285"></td>
          <td id="LC4285">
</td>
        </tr>
        <tr>
          <td id="L4286" data-line-number="4286"></td>
          <td id="LC4286">Private Sub pvTlsGetHash(baRetVal() As Byte, ByVal eHash As UcsTlsCryptoAlgorithmsEnum, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1)</td>
        </tr>
        <tr>
          <td id="L4287" data-line-number="4287"></td>
          <td id="LC4287">    Const FUNC_NAME     As String = &#34;pvTlsGetHash&#34;</td>
        </tr>
        <tr>
          <td id="L4288" data-line-number="4288"></td>
          <td id="LC4288">
</td>
        </tr>
        <tr>
          <td id="L4289" data-line-number="4289"></td>
          <td id="LC4289">    Select Case eHash</td>
        </tr>
        <tr>
          <td id="L4290" data-line-number="4290"></td>
          <td id="LC4290">    Case ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4291" data-line-number="4291"></td>
          <td id="LC4291">        If Not pvCryptoHashSha256(baRetVal, baInput, Pos, Size) Then</td>
        </tr>
        <tr>
          <td id="L4292" data-line-number="4292"></td>
          <td id="LC4292">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha256&#34;)</td>
        </tr>
        <tr>
          <td id="L4293" data-line-number="4293"></td>
          <td id="LC4293">        End If</td>
        </tr>
        <tr>
          <td id="L4294" data-line-number="4294"></td>
          <td id="LC4294">    Case ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4295" data-line-number="4295"></td>
          <td id="LC4295">        If Not pvCryptoHashSha384(baRetVal, baInput, Pos, Size) Then</td>
        </tr>
        <tr>
          <td id="L4296" data-line-number="4296"></td>
          <td id="LC4296">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha384&#34;)</td>
        </tr>
        <tr>
          <td id="L4297" data-line-number="4297"></td>
          <td id="LC4297">        End If</td>
        </tr>
        <tr>
          <td id="L4298" data-line-number="4298"></td>
          <td id="LC4298">    Case ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L4299" data-line-number="4299"></td>
          <td id="LC4299">        If Not pvCryptoHashSha512(baRetVal, baInput, Pos, Size) Then</td>
        </tr>
        <tr>
          <td id="L4300" data-line-number="4300"></td>
          <td id="LC4300">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha512&#34;)</td>
        </tr>
        <tr>
          <td id="L4301" data-line-number="4301"></td>
          <td id="LC4301">        End If</td>
        </tr>
        <tr>
          <td id="L4302" data-line-number="4302"></td>
          <td id="LC4302">    Case Else</td>
        </tr>
        <tr>
          <td id="L4303" data-line-number="4303"></td>
          <td id="LC4303">        ErrRaise vbObjectError, FUNC_NAME, &#34;Unsupported hash type &#34; &amp; eHash</td>
        </tr>
        <tr>
          <td id="L4304" data-line-number="4304"></td>
          <td id="LC4304">    End Select</td>
        </tr>
        <tr>
          <td id="L4305" data-line-number="4305"></td>
          <td id="LC4305">End Sub</td>
        </tr>
        <tr>
          <td id="L4306" data-line-number="4306"></td>
          <td id="LC4306">
</td>
        </tr>
        <tr>
          <td id="L4307" data-line-number="4307"></td>
          <td id="LC4307">Private Sub pvTlsGetHmac(baRetVal() As Byte, ByVal eHash As UcsTlsCryptoAlgorithmsEnum, baKey() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1)</td>
        </tr>
        <tr>
          <td id="L4308" data-line-number="4308"></td>
          <td id="LC4308">    Const FUNC_NAME     As String = &#34;pvTlsGetHmac&#34;</td>
        </tr>
        <tr>
          <td id="L4309" data-line-number="4309"></td>
          <td id="LC4309">    </td>
        </tr>
        <tr>
          <td id="L4310" data-line-number="4310"></td>
          <td id="LC4310">    Select Case eHash</td>
        </tr>
        <tr>
          <td id="L4311" data-line-number="4311"></td>
          <td id="LC4311">    Case ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L4312" data-line-number="4312"></td>
          <td id="LC4312">        If Not pvCryptoHmacSha1(baRetVal, baKey, baInput, Pos, Size) Then</td>
        </tr>
        <tr>
          <td id="L4313" data-line-number="4313"></td>
          <td id="LC4313">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHmacSha1&#34;)</td>
        </tr>
        <tr>
          <td id="L4314" data-line-number="4314"></td>
          <td id="LC4314">        End If</td>
        </tr>
        <tr>
          <td id="L4315" data-line-number="4315"></td>
          <td id="LC4315">    Case ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4316" data-line-number="4316"></td>
          <td id="LC4316">        If Not pvCryptoHmacSha256(baRetVal, baKey, baInput, Pos, Size) Then</td>
        </tr>
        <tr>
          <td id="L4317" data-line-number="4317"></td>
          <td id="LC4317">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHmacSha256&#34;)</td>
        </tr>
        <tr>
          <td id="L4318" data-line-number="4318"></td>
          <td id="LC4318">        End If</td>
        </tr>
        <tr>
          <td id="L4319" data-line-number="4319"></td>
          <td id="LC4319">    Case ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4320" data-line-number="4320"></td>
          <td id="LC4320">        If Not pvCryptoHmacSha384(baRetVal, baKey, baInput, Pos, Size) Then</td>
        </tr>
        <tr>
          <td id="L4321" data-line-number="4321"></td>
          <td id="LC4321">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHmacSha384&#34;)</td>
        </tr>
        <tr>
          <td id="L4322" data-line-number="4322"></td>
          <td id="LC4322">        End If</td>
        </tr>
        <tr>
          <td id="L4323" data-line-number="4323"></td>
          <td id="LC4323">    Case Else</td>
        </tr>
        <tr>
          <td id="L4324" data-line-number="4324"></td>
          <td id="LC4324">        ErrRaise vbObjectError, FUNC_NAME, &#34;Unsupported HMAC type &#34; &amp; eHash</td>
        </tr>
        <tr>
          <td id="L4325" data-line-number="4325"></td>
          <td id="LC4325">    End Select</td>
        </tr>
        <tr>
          <td id="L4326" data-line-number="4326"></td>
          <td id="LC4326">End Sub</td>
        </tr>
        <tr>
          <td id="L4327" data-line-number="4327"></td>
          <td id="LC4327">
</td>
        </tr>
        <tr>
          <td id="L4328" data-line-number="4328"></td>
          <td id="LC4328">Private Sub pvTlsGetHelloRetryRandom(baRetVal() As Byte)</td>
        </tr>
        <tr>
          <td id="L4329" data-line-number="4329"></td>
          <td id="LC4329">    pvArrayByte baRetVal, &amp;HCF, &amp;H21, &amp;HAD, &amp;H74, &amp;HE5, &amp;H9A, &amp;H61, &amp;H11, &amp;HBE, &amp;H1D, &amp;H8C, &amp;H2, &amp;H1E, &amp;H65, &amp;HB8, &amp;H91, &amp;HC2, &amp;HA2, &amp;H11, &amp;H16, &amp;H7A, &amp;HBB, &amp;H8C, &amp;H5E, &amp;H7, &amp;H9E, &amp;H9, &amp;HE2, &amp;HC8, &amp;HA8, &amp;H33, &amp;H9C</td>
        </tr>
        <tr>
          <td id="L4330" data-line-number="4330"></td>
          <td id="LC4330">End Sub</td>
        </tr>
        <tr>
          <td id="L4331" data-line-number="4331"></td>
          <td id="LC4331">
</td>
        </tr>
        <tr>
          <td id="L4332" data-line-number="4332"></td>
          <td id="LC4332">Private Function pvTlsBulkDecrypt(ByVal eBulk As UcsTlsCryptoAlgorithmsEnum, baRemoteIV() As Byte, baRemoteKey() As Byte, baAad() As Byte, ByVal lAadPos As Long, ByVal lAadSize As Long, baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L4333" data-line-number="4333"></td>
          <td id="LC4333">    Const FUNC_NAME     As String = &#34;pvTlsBulkDecrypt&#34;</td>
        </tr>
        <tr>
          <td id="L4334" data-line-number="4334"></td>
          <td id="LC4334">    </td>
        </tr>
        <tr>
          <td id="L4335" data-line-number="4335"></td>
          <td id="LC4335">    Select Case eBulk</td>
        </tr>
        <tr>
          <td id="L4336" data-line-number="4336"></td>
          <td id="LC4336">    Case ucsTlsAlgoBulkChacha20Poly1305</td>
        </tr>
        <tr>
          <td id="L4337" data-line-number="4337"></td>
          <td id="LC4337">        If Not pvCryptoBulkChacha20Poly1305Decrypt(baRemoteIV, baRemoteKey, baAad, lAadPos, lAadSize, baBuffer, lPos, lSize) Then</td>
        </tr>
        <tr>
          <td id="L4338" data-line-number="4338"></td>
          <td id="LC4338">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4339" data-line-number="4339"></td>
          <td id="LC4339">        End If</td>
        </tr>
        <tr>
          <td id="L4340" data-line-number="4340"></td>
          <td id="LC4340">    Case ucsTlsAlgoBulkAesGcm128, ucsTlsAlgoBulkAesGcm256</td>
        </tr>
        <tr>
          <td id="L4341" data-line-number="4341"></td>
          <td id="LC4341">        If Not pvCryptoBulkAesGcmDecrypt(baRemoteIV, baRemoteKey, baAad, lAadPos, lAadSize, baBuffer, lPos, lSize) Then</td>
        </tr>
        <tr>
          <td id="L4342" data-line-number="4342"></td>
          <td id="LC4342">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4343" data-line-number="4343"></td>
          <td id="LC4343">        End If</td>
        </tr>
        <tr>
          <td id="L4344" data-line-number="4344"></td>
          <td id="LC4344">    Case ucsTlsAlgoBulkAesCbc128, ucsTlsAlgoBulkAesCbc256</td>
        </tr>
        <tr>
          <td id="L4345" data-line-number="4345"></td>
          <td id="LC4345">        If Not pvCryptoBulkAesCbcDecrypt(baRemoteIV, baRemoteKey, baBuffer, lPos, lSize) Then</td>
        </tr>
        <tr>
          <td id="L4346" data-line-number="4346"></td>
          <td id="LC4346">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4347" data-line-number="4347"></td>
          <td id="LC4347">        End If</td>
        </tr>
        <tr>
          <td id="L4348" data-line-number="4348"></td>
          <td id="LC4348">    Case Else</td>
        </tr>
        <tr>
          <td id="L4349" data-line-number="4349"></td>
          <td id="LC4349">        ErrRaise vbObjectError, FUNC_NAME, &#34;Unsupported bulk type &#34; &amp; eBulk</td>
        </tr>
        <tr>
          <td id="L4350" data-line-number="4350"></td>
          <td id="LC4350">    End Select</td>
        </tr>
        <tr>
          <td id="L4351" data-line-number="4351"></td>
          <td id="LC4351">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L4352" data-line-number="4352"></td>
          <td id="LC4352">    pvTlsBulkDecrypt = True</td>
        </tr>
        <tr>
          <td id="L4353" data-line-number="4353"></td>
          <td id="LC4353">QH:</td>
        </tr>
        <tr>
          <td id="L4354" data-line-number="4354"></td>
          <td id="LC4354">End Function</td>
        </tr>
        <tr>
          <td id="L4355" data-line-number="4355"></td>
          <td id="LC4355">
</td>
        </tr>
        <tr>
          <td id="L4356" data-line-number="4356"></td>
          <td id="LC4356">Private Sub pvTlsBulkEncrypt(ByVal eBulk As UcsTlsCryptoAlgorithmsEnum, baLocalIV() As Byte, baLocalKey() As Byte, baAad() As Byte, ByVal lAadPos As Long, ByVal lAadSize As Long, baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L4357" data-line-number="4357"></td>
          <td id="LC4357">    Const FUNC_NAME     As String = &#34;pvTlsBulkEncrypt&#34;</td>
        </tr>
        <tr>
          <td id="L4358" data-line-number="4358"></td>
          <td id="LC4358">    </td>
        </tr>
        <tr>
          <td id="L4359" data-line-number="4359"></td>
          <td id="LC4359">    Select Case eBulk</td>
        </tr>
        <tr>
          <td id="L4360" data-line-number="4360"></td>
          <td id="LC4360">    Case ucsTlsAlgoBulkChacha20Poly1305</td>
        </tr>
        <tr>
          <td id="L4361" data-line-number="4361"></td>
          <td id="LC4361">        If Not pvCryptoBulkChacha20Poly1305Encrypt(baLocalIV, baLocalKey, baAad, lAadPos, lAadSize, baBuffer, lPos, lSize) Then</td>
        </tr>
        <tr>
          <td id="L4362" data-line-number="4362"></td>
          <td id="LC4362">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_ENCRYPTION_FAILED, &#34;%1&#34;, &#34;CryptoBulkChacha20Poly1305Encrypt&#34;)</td>
        </tr>
        <tr>
          <td id="L4363" data-line-number="4363"></td>
          <td id="LC4363">        End If</td>
        </tr>
        <tr>
          <td id="L4364" data-line-number="4364"></td>
          <td id="LC4364">    Case ucsTlsAlgoBulkAesGcm128, ucsTlsAlgoBulkAesGcm256</td>
        </tr>
        <tr>
          <td id="L4365" data-line-number="4365"></td>
          <td id="LC4365">        If Not pvCryptoBulkAesGcmEncrypt(baLocalIV, baLocalKey, baAad, lAadPos, lAadSize, baBuffer, lPos, lSize) Then</td>
        </tr>
        <tr>
          <td id="L4366" data-line-number="4366"></td>
          <td id="LC4366">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_ENCRYPTION_FAILED, &#34;%1&#34;, &#34;CryptoBulkAesGcmEncrypt&#34;)</td>
        </tr>
        <tr>
          <td id="L4367" data-line-number="4367"></td>
          <td id="LC4367">        End If</td>
        </tr>
        <tr>
          <td id="L4368" data-line-number="4368"></td>
          <td id="LC4368">    Case ucsTlsAlgoBulkAesCbc128, ucsTlsAlgoBulkAesCbc256</td>
        </tr>
        <tr>
          <td id="L4369" data-line-number="4369"></td>
          <td id="LC4369">        If Not pvCryptoBulkAesCbcEncrypt(baLocalIV, baLocalKey, baBuffer, lPos, lSize) Then</td>
        </tr>
        <tr>
          <td id="L4370" data-line-number="4370"></td>
          <td id="LC4370">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_ENCRYPTION_FAILED, &#34;%1&#34;, &#34;CryptoBulkAesCbcEncrypt&#34;)</td>
        </tr>
        <tr>
          <td id="L4371" data-line-number="4371"></td>
          <td id="LC4371">        End If</td>
        </tr>
        <tr>
          <td id="L4372" data-line-number="4372"></td>
          <td id="LC4372">    Case Else</td>
        </tr>
        <tr>
          <td id="L4373" data-line-number="4373"></td>
          <td id="LC4373">        ErrRaise vbObjectError, FUNC_NAME, &#34;Unsupported bulk type &#34; &amp; eBulk</td>
        </tr>
        <tr>
          <td id="L4374" data-line-number="4374"></td>
          <td id="LC4374">    End Select</td>
        </tr>
        <tr>
          <td id="L4375" data-line-number="4375"></td>
          <td id="LC4375">End Sub</td>
        </tr>
        <tr>
          <td id="L4376" data-line-number="4376"></td>
          <td id="LC4376">
</td>
        </tr>
        <tr>
          <td id="L4377" data-line-number="4377"></td>
          <td id="LC4377">Private Sub pvTlsGetSharedSecret(baRetVal() As Byte, ByVal eKeyX As UcsTlsCryptoAlgorithmsEnum, baPriv() As Byte, baPub() As Byte)</td>
        </tr>
        <tr>
          <td id="L4378" data-line-number="4378"></td>
          <td id="LC4378">    Const FUNC_NAME     As String = &#34;pvTlsGetSharedSecret&#34;</td>
        </tr>
        <tr>
          <td id="L4379" data-line-number="4379"></td>
          <td id="LC4379">    </td>
        </tr>
        <tr>
          <td id="L4380" data-line-number="4380"></td>
          <td id="LC4380">    Select Case eKeyX</td>
        </tr>
        <tr>
          <td id="L4381" data-line-number="4381"></td>
          <td id="LC4381">    Case ucsTlsAlgoExchX25519</td>
        </tr>
        <tr>
          <td id="L4382" data-line-number="4382"></td>
          <td id="LC4382">        If Not pvCryptoEcdhCurve25519SharedSecret(baRetVal, baPriv, baPub) Then</td>
        </tr>
        <tr>
          <td id="L4383" data-line-number="4383"></td>
          <td id="LC4383">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEcdhCurve25519SharedSecret&#34;)</td>
        </tr>
        <tr>
          <td id="L4384" data-line-number="4384"></td>
          <td id="LC4384">        End If</td>
        </tr>
        <tr>
          <td id="L4385" data-line-number="4385"></td>
          <td id="LC4385">    Case ucsTlsAlgoExchSecp256r1</td>
        </tr>
        <tr>
          <td id="L4386" data-line-number="4386"></td>
          <td id="LC4386">        If Not pvCryptoEcdhSecp256r1SharedSecret(baRetVal, baPriv, baPub) Then</td>
        </tr>
        <tr>
          <td id="L4387" data-line-number="4387"></td>
          <td id="LC4387">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEcdhSecp256r1SharedSecret&#34;)</td>
        </tr>
        <tr>
          <td id="L4388" data-line-number="4388"></td>
          <td id="LC4388">        End If</td>
        </tr>
        <tr>
          <td id="L4389" data-line-number="4389"></td>
          <td id="LC4389">    Case ucsTlsAlgoExchSecp384r1</td>
        </tr>
        <tr>
          <td id="L4390" data-line-number="4390"></td>
          <td id="LC4390">        If Not pvCryptoEcdhSecp384r1SharedSecret(baRetVal, baPriv, baPub) Then</td>
        </tr>
        <tr>
          <td id="L4391" data-line-number="4391"></td>
          <td id="LC4391">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEcdhSecp384r1SharedSecret&#34;)</td>
        </tr>
        <tr>
          <td id="L4392" data-line-number="4392"></td>
          <td id="LC4392">        End If</td>
        </tr>
        <tr>
          <td id="L4393" data-line-number="4393"></td>
          <td id="LC4393">    Case ucsTlsAlgoExchCertificate</td>
        </tr>
        <tr>
          <td id="L4394" data-line-number="4394"></td>
          <td id="LC4394">        baRetVal = baPriv</td>
        </tr>
        <tr>
          <td id="L4395" data-line-number="4395"></td>
          <td id="LC4395">    Case Else</td>
        </tr>
        <tr>
          <td id="L4396" data-line-number="4396"></td>
          <td id="LC4396">        ErrRaise vbObjectError, FUNC_NAME, &#34;Unsupported exchange &#34; &amp; eKeyX</td>
        </tr>
        <tr>
          <td id="L4397" data-line-number="4397"></td>
          <td id="LC4397">    End Select</td>
        </tr>
        <tr>
          <td id="L4398" data-line-number="4398"></td>
          <td id="LC4398">End Sub</td>
        </tr>
        <tr>
          <td id="L4399" data-line-number="4399"></td>
          <td id="LC4399">
</td>
        </tr>
        <tr>
          <td id="L4400" data-line-number="4400"></td>
          <td id="LC4400">Private Function pvTlsGetExchGroupName(ByVal lExchGroup As Long) As String</td>
        </tr>
        <tr>
          <td id="L4401" data-line-number="4401"></td>
          <td id="LC4401">    Select Case lExchGroup</td>
        </tr>
        <tr>
          <td id="L4402" data-line-number="4402"></td>
          <td id="LC4402">    Case TLS_GROUP_X25519</td>
        </tr>
        <tr>
          <td id="L4403" data-line-number="4403"></td>
          <td id="LC4403">        pvTlsGetExchGroupName = &#34;X25519&#34;</td>
        </tr>
        <tr>
          <td id="L4404" data-line-number="4404"></td>
          <td id="LC4404">    Case TLS_GROUP_X448</td>
        </tr>
        <tr>
          <td id="L4405" data-line-number="4405"></td>
          <td id="LC4405">        pvTlsGetExchGroupName = &#34;X448&#34;</td>
        </tr>
        <tr>
          <td id="L4406" data-line-number="4406"></td>
          <td id="LC4406">    Case TLS_GROUP_SECP256R1</td>
        </tr>
        <tr>
          <td id="L4407" data-line-number="4407"></td>
          <td id="LC4407">        pvTlsGetExchGroupName = &#34;secp256r1&#34;</td>
        </tr>
        <tr>
          <td id="L4408" data-line-number="4408"></td>
          <td id="LC4408">    Case TLS_GROUP_SECP384R1</td>
        </tr>
        <tr>
          <td id="L4409" data-line-number="4409"></td>
          <td id="LC4409">        pvTlsGetExchGroupName = &#34;secp384r1&#34;</td>
        </tr>
        <tr>
          <td id="L4410" data-line-number="4410"></td>
          <td id="LC4410">    Case TLS_GROUP_SECP521R1</td>
        </tr>
        <tr>
          <td id="L4411" data-line-number="4411"></td>
          <td id="LC4411">        pvTlsGetExchGroupName = &#34;secp521r1&#34;</td>
        </tr>
        <tr>
          <td id="L4412" data-line-number="4412"></td>
          <td id="LC4412">    Case Else</td>
        </tr>
        <tr>
          <td id="L4413" data-line-number="4413"></td>
          <td id="LC4413">        pvTlsGetExchGroupName = Replace(STR_UNKNOWN, &#34;%1&#34;, &#34;0x&#34; &amp; Hex$(lExchGroup))</td>
        </tr>
        <tr>
          <td id="L4414" data-line-number="4414"></td>
          <td id="LC4414">    End Select</td>
        </tr>
        <tr>
          <td id="L4415" data-line-number="4415"></td>
          <td id="LC4415">End Function</td>
        </tr>
        <tr>
          <td id="L4416" data-line-number="4416"></td>
          <td id="LC4416">
</td>
        </tr>
        <tr>
          <td id="L4417" data-line-number="4417"></td>
          <td id="LC4417">Private Function pvTlsGetCipherSuiteName(ByVal lCipherSuite As Long) As String</td>
        </tr>
        <tr>
          <td id="L4418" data-line-number="4418"></td>
          <td id="LC4418">    Select Case lCipherSuite</td>
        </tr>
        <tr>
          <td id="L4419" data-line-number="4419"></td>
          <td id="LC4419">    Case TLS_CS_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L4420" data-line-number="4420"></td>
          <td id="LC4420">        pvTlsGetCipherSuiteName = &#34;TLS_AES_128_GCM_SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4421" data-line-number="4421"></td>
          <td id="LC4421">    Case TLS_CS_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L4422" data-line-number="4422"></td>
          <td id="LC4422">        pvTlsGetCipherSuiteName = &#34;TLS_AES_256_GCM_SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4423" data-line-number="4423"></td>
          <td id="LC4423">    Case TLS_CS_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L4424" data-line-number="4424"></td>
          <td id="LC4424">        pvTlsGetCipherSuiteName = &#34;TLS_CHACHA20_POLY1305_SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4425" data-line-number="4425"></td>
          <td id="LC4425">    Case TLS_CS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L4426" data-line-number="4426"></td>
          <td id="LC4426">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-AES128-GCM-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4427" data-line-number="4427"></td>
          <td id="LC4427">    Case TLS_CS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L4428" data-line-number="4428"></td>
          <td id="LC4428">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-AES256-GCM-SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4429" data-line-number="4429"></td>
          <td id="LC4429">    Case TLS_CS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L4430" data-line-number="4430"></td>
          <td id="LC4430">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-AES128-GCM-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4431" data-line-number="4431"></td>
          <td id="LC4431">    Case TLS_CS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L4432" data-line-number="4432"></td>
          <td id="LC4432">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-AES256-GCM-SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4433" data-line-number="4433"></td>
          <td id="LC4433">    Case TLS_CS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L4434" data-line-number="4434"></td>
          <td id="LC4434">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-CHACHA20-POLY1305&#34;</td>
        </tr>
        <tr>
          <td id="L4435" data-line-number="4435"></td>
          <td id="LC4435">    Case TLS_CS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</td>
        </tr>
        <tr>
          <td id="L4436" data-line-number="4436"></td>
          <td id="LC4436">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-CHACHA20-POLY1305&#34;</td>
        </tr>
        <tr>
          <td id="L4437" data-line-number="4437"></td>
          <td id="LC4437">    Case TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L4438" data-line-number="4438"></td>
          <td id="LC4438">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-AES128-SHA&#34;</td>
        </tr>
        <tr>
          <td id="L4439" data-line-number="4439"></td>
          <td id="LC4439">    Case TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L4440" data-line-number="4440"></td>
          <td id="LC4440">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-AES256-SHA&#34;</td>
        </tr>
        <tr>
          <td id="L4441" data-line-number="4441"></td>
          <td id="LC4441">    Case TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L4442" data-line-number="4442"></td>
          <td id="LC4442">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-AES128-SHA&#34;</td>
        </tr>
        <tr>
          <td id="L4443" data-line-number="4443"></td>
          <td id="LC4443">    Case TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L4444" data-line-number="4444"></td>
          <td id="LC4444">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-AES256-SHA&#34;</td>
        </tr>
        <tr>
          <td id="L4445" data-line-number="4445"></td>
          <td id="LC4445">    Case TLS_CS_RSA_WITH_AES_128_GCM_SHA256</td>
        </tr>
        <tr>
          <td id="L4446" data-line-number="4446"></td>
          <td id="LC4446">        pvTlsGetCipherSuiteName = &#34;AES128-GCM-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4447" data-line-number="4447"></td>
          <td id="LC4447">    Case TLS_CS_RSA_WITH_AES_256_GCM_SHA384</td>
        </tr>
        <tr>
          <td id="L4448" data-line-number="4448"></td>
          <td id="LC4448">        pvTlsGetCipherSuiteName = &#34;AES256-GCM-SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4449" data-line-number="4449"></td>
          <td id="LC4449">    Case TLS_CS_RSA_WITH_AES_128_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L4450" data-line-number="4450"></td>
          <td id="LC4450">        pvTlsGetCipherSuiteName = &#34;AES128-SHA&#34;</td>
        </tr>
        <tr>
          <td id="L4451" data-line-number="4451"></td>
          <td id="LC4451">    Case TLS_CS_RSA_WITH_AES_256_CBC_SHA</td>
        </tr>
        <tr>
          <td id="L4452" data-line-number="4452"></td>
          <td id="LC4452">        pvTlsGetCipherSuiteName = &#34;AES256-SHA&#34;</td>
        </tr>
        <tr>
          <td id="L4453" data-line-number="4453"></td>
          <td id="LC4453">    Case TLS_CS_RSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L4454" data-line-number="4454"></td>
          <td id="LC4454">        pvTlsGetCipherSuiteName = &#34;AES128-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4455" data-line-number="4455"></td>
          <td id="LC4455">    Case TLS_CS_RSA_WITH_AES_256_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L4456" data-line-number="4456"></td>
          <td id="LC4456">        pvTlsGetCipherSuiteName = &#34;AES256-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4457" data-line-number="4457"></td>
          <td id="LC4457">    Case TLS_CS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L4458" data-line-number="4458"></td>
          <td id="LC4458">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-AES128-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4459" data-line-number="4459"></td>
          <td id="LC4459">    Case TLS_CS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</td>
        </tr>
        <tr>
          <td id="L4460" data-line-number="4460"></td>
          <td id="LC4460">        pvTlsGetCipherSuiteName = &#34;ECDHE-ECDSA-AES256-SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4461" data-line-number="4461"></td>
          <td id="LC4461">    Case TLS_CS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</td>
        </tr>
        <tr>
          <td id="L4462" data-line-number="4462"></td>
          <td id="LC4462">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-AES128-SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4463" data-line-number="4463"></td>
          <td id="LC4463">    Case TLS_CS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</td>
        </tr>
        <tr>
          <td id="L4464" data-line-number="4464"></td>
          <td id="LC4464">        pvTlsGetCipherSuiteName = &#34;ECDHE-RSA-AES256-SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4465" data-line-number="4465"></td>
          <td id="LC4465">    Case Else</td>
        </tr>
        <tr>
          <td id="L4466" data-line-number="4466"></td>
          <td id="LC4466">        pvTlsGetCipherSuiteName = Replace(STR_UNKNOWN, &#34;%1&#34;, &#34;0x&#34; &amp; Hex$(lCipherSuite))</td>
        </tr>
        <tr>
          <td id="L4467" data-line-number="4467"></td>
          <td id="LC4467">    End Select</td>
        </tr>
        <tr>
          <td id="L4468" data-line-number="4468"></td>
          <td id="LC4468">End Function</td>
        </tr>
        <tr>
          <td id="L4469" data-line-number="4469"></td>
          <td id="LC4469">
</td>
        </tr>
        <tr>
          <td id="L4470" data-line-number="4470"></td>
          <td id="LC4470">Private Function pvTlsGetSignatureName(ByVal lSignatureScheme As Long) As String</td>
        </tr>
        <tr>
          <td id="L4471" data-line-number="4471"></td>
          <td id="LC4471">    Select Case lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L4472" data-line-number="4472"></td>
          <td id="LC4472">    Case TLS_SIGNATURE_RSA_PKCS1_SHA1</td>
        </tr>
        <tr>
          <td id="L4473" data-line-number="4473"></td>
          <td id="LC4473">        pvTlsGetSignatureName = &#34;RSA_PKCS1_SHA1&#34;</td>
        </tr>
        <tr>
          <td id="L4474" data-line-number="4474"></td>
          <td id="LC4474">    Case TLS_SIGNATURE_ECDSA_SHA1</td>
        </tr>
        <tr>
          <td id="L4475" data-line-number="4475"></td>
          <td id="LC4475">        pvTlsGetSignatureName = &#34;ECDSA_SHA1&#34;</td>
        </tr>
        <tr>
          <td id="L4476" data-line-number="4476"></td>
          <td id="LC4476">    Case TLS_SIGNATURE_RSA_PKCS1_SHA224</td>
        </tr>
        <tr>
          <td id="L4477" data-line-number="4477"></td>
          <td id="LC4477">        pvTlsGetSignatureName = &#34;RSA_PKCS1_SHA224&#34;</td>
        </tr>
        <tr>
          <td id="L4478" data-line-number="4478"></td>
          <td id="LC4478">    Case TLS_SIGNATURE_RSA_PKCS1_SHA256</td>
        </tr>
        <tr>
          <td id="L4479" data-line-number="4479"></td>
          <td id="LC4479">        pvTlsGetSignatureName = &#34;RSA_PKCS1_SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4480" data-line-number="4480"></td>
          <td id="LC4480">    Case TLS_SIGNATURE_RSA_PKCS1_SHA384</td>
        </tr>
        <tr>
          <td id="L4481" data-line-number="4481"></td>
          <td id="LC4481">        pvTlsGetSignatureName = &#34;RSA_PKCS1_SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4482" data-line-number="4482"></td>
          <td id="LC4482">    Case TLS_SIGNATURE_RSA_PKCS1_SHA512</td>
        </tr>
        <tr>
          <td id="L4483" data-line-number="4483"></td>
          <td id="LC4483">        pvTlsGetSignatureName = &#34;RSA_PKCS1_SHA512&#34;</td>
        </tr>
        <tr>
          <td id="L4484" data-line-number="4484"></td>
          <td id="LC4484">    Case TLS_SIGNATURE_ECDSA_SECP256R1_SHA256</td>
        </tr>
        <tr>
          <td id="L4485" data-line-number="4485"></td>
          <td id="LC4485">        pvTlsGetSignatureName = &#34;ECDSA_SECP256R1_SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4486" data-line-number="4486"></td>
          <td id="LC4486">    Case TLS_SIGNATURE_ECDSA_SECP384R1_SHA384</td>
        </tr>
        <tr>
          <td id="L4487" data-line-number="4487"></td>
          <td id="LC4487">        pvTlsGetSignatureName = &#34;ECDSA_SECP384R1_SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4488" data-line-number="4488"></td>
          <td id="LC4488">    Case TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</td>
        </tr>
        <tr>
          <td id="L4489" data-line-number="4489"></td>
          <td id="LC4489">        pvTlsGetSignatureName = &#34;ECDSA_SECP521R1_SHA512&#34;</td>
        </tr>
        <tr>
          <td id="L4490" data-line-number="4490"></td>
          <td id="LC4490">    Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA256</td>
        </tr>
        <tr>
          <td id="L4491" data-line-number="4491"></td>
          <td id="LC4491">        pvTlsGetSignatureName = &#34;RSA_PSS_RSAE_SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4492" data-line-number="4492"></td>
          <td id="LC4492">    Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA384</td>
        </tr>
        <tr>
          <td id="L4493" data-line-number="4493"></td>
          <td id="LC4493">        pvTlsGetSignatureName = &#34;RSA_PSS_RSAE_SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4494" data-line-number="4494"></td>
          <td id="LC4494">    Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA512</td>
        </tr>
        <tr>
          <td id="L4495" data-line-number="4495"></td>
          <td id="LC4495">        pvTlsGetSignatureName = &#34;RSA_PSS_RSAE_SHA512&#34;</td>
        </tr>
        <tr>
          <td id="L4496" data-line-number="4496"></td>
          <td id="LC4496">    Case TLS_SIGNATURE_RSA_PSS_PSS_SHA256</td>
        </tr>
        <tr>
          <td id="L4497" data-line-number="4497"></td>
          <td id="LC4497">        pvTlsGetSignatureName = &#34;RSA_PSS_PSS_SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4498" data-line-number="4498"></td>
          <td id="LC4498">    Case TLS_SIGNATURE_RSA_PSS_PSS_SHA384</td>
        </tr>
        <tr>
          <td id="L4499" data-line-number="4499"></td>
          <td id="LC4499">        pvTlsGetSignatureName = &#34;RSA_PSS_PSS_SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4500" data-line-number="4500"></td>
          <td id="LC4500">    Case TLS_SIGNATURE_RSA_PSS_PSS_SHA512</td>
        </tr>
        <tr>
          <td id="L4501" data-line-number="4501"></td>
          <td id="LC4501">        pvTlsGetSignatureName = &#34;RSA_PSS_PSS_SHA512&#34;</td>
        </tr>
        <tr>
          <td id="L4502" data-line-number="4502"></td>
          <td id="LC4502">    Case Else</td>
        </tr>
        <tr>
          <td id="L4503" data-line-number="4503"></td>
          <td id="LC4503">        pvTlsGetSignatureName = Replace(STR_UNKNOWN, &#34;%1&#34;, &#34;0x&#34; &amp; Hex$(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4504" data-line-number="4504"></td>
          <td id="LC4504">    End Select</td>
        </tr>
        <tr>
          <td id="L4505" data-line-number="4505"></td>
          <td id="LC4505">End Function</td>
        </tr>
        <tr>
          <td id="L4506" data-line-number="4506"></td>
          <td id="LC4506">
</td>
        </tr>
        <tr>
          <td id="L4507" data-line-number="4507"></td>
          <td id="LC4507">Private Function pvTlsGetHashName(ByVal eAlgo As UcsTlsCryptoAlgorithmsEnum) As String</td>
        </tr>
        <tr>
          <td id="L4508" data-line-number="4508"></td>
          <td id="LC4508">    Select Case eAlgo</td>
        </tr>
        <tr>
          <td id="L4509" data-line-number="4509"></td>
          <td id="LC4509">    Case ucsTlsAlgoDigestMd5</td>
        </tr>
        <tr>
          <td id="L4510" data-line-number="4510"></td>
          <td id="LC4510">        pvTlsGetHashName = &#34;MD5&#34;</td>
        </tr>
        <tr>
          <td id="L4511" data-line-number="4511"></td>
          <td id="LC4511">    Case ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L4512" data-line-number="4512"></td>
          <td id="LC4512">        pvTlsGetHashName = &#34;SHA1&#34;</td>
        </tr>
        <tr>
          <td id="L4513" data-line-number="4513"></td>
          <td id="LC4513">    Case ucsTlsAlgoDigestSha224</td>
        </tr>
        <tr>
          <td id="L4514" data-line-number="4514"></td>
          <td id="LC4514">        pvTlsGetHashName = &#34;SHA224&#34;</td>
        </tr>
        <tr>
          <td id="L4515" data-line-number="4515"></td>
          <td id="LC4515">    Case ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4516" data-line-number="4516"></td>
          <td id="LC4516">        pvTlsGetHashName = &#34;SHA256&#34;</td>
        </tr>
        <tr>
          <td id="L4517" data-line-number="4517"></td>
          <td id="LC4517">    Case ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4518" data-line-number="4518"></td>
          <td id="LC4518">        pvTlsGetHashName = &#34;SHA384&#34;</td>
        </tr>
        <tr>
          <td id="L4519" data-line-number="4519"></td>
          <td id="LC4519">    Case ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L4520" data-line-number="4520"></td>
          <td id="LC4520">        pvTlsGetHashName = &#34;SHA512&#34;</td>
        </tr>
        <tr>
          <td id="L4521" data-line-number="4521"></td>
          <td id="LC4521">    Case Else</td>
        </tr>
        <tr>
          <td id="L4522" data-line-number="4522"></td>
          <td id="LC4522">        pvTlsGetHashName = Replace(STR_UNKNOWN, &#34;%1&#34;, &#34;0x&#34; &amp; Hex$(eAlgo))</td>
        </tr>
        <tr>
          <td id="L4523" data-line-number="4523"></td>
          <td id="LC4523">    End Select</td>
        </tr>
        <tr>
          <td id="L4524" data-line-number="4524"></td>
          <td id="LC4524">End Function</td>
        </tr>
        <tr>
          <td id="L4525" data-line-number="4525"></td>
          <td id="LC4525">
</td>
        </tr>
        <tr>
          <td id="L4526" data-line-number="4526"></td>
          <td id="LC4526">Private Function pvTlsGetHashAlgId(ByVal eAlgo As UcsTlsCryptoAlgorithmsEnum) As Long</td>
        </tr>
        <tr>
          <td id="L4527" data-line-number="4527"></td>
          <td id="LC4527">    Select Case eAlgo</td>
        </tr>
        <tr>
          <td id="L4528" data-line-number="4528"></td>
          <td id="LC4528">    Case ucsTlsAlgoDigestMd5</td>
        </tr>
        <tr>
          <td id="L4529" data-line-number="4529"></td>
          <td id="LC4529">        pvTlsGetHashAlgId = CALG_SSL3_SHAMD5</td>
        </tr>
        <tr>
          <td id="L4530" data-line-number="4530"></td>
          <td id="LC4530">    Case ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L4531" data-line-number="4531"></td>
          <td id="LC4531">        pvTlsGetHashAlgId = CALG_SHA1</td>
        </tr>
        <tr>
          <td id="L4532" data-line-number="4532"></td>
          <td id="LC4532">    Case ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4533" data-line-number="4533"></td>
          <td id="LC4533">        pvTlsGetHashAlgId = CALG_SHA_256</td>
        </tr>
        <tr>
          <td id="L4534" data-line-number="4534"></td>
          <td id="LC4534">    Case ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4535" data-line-number="4535"></td>
          <td id="LC4535">        pvTlsGetHashAlgId = CALG_SHA_384</td>
        </tr>
        <tr>
          <td id="L4536" data-line-number="4536"></td>
          <td id="LC4536">    Case ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L4537" data-line-number="4537"></td>
          <td id="LC4537">        pvTlsGetHashAlgId = CALG_SHA_512</td>
        </tr>
        <tr>
          <td id="L4538" data-line-number="4538"></td>
          <td id="LC4538">    Case Else</td>
        </tr>
        <tr>
          <td id="L4539" data-line-number="4539"></td>
          <td id="LC4539">        pvTlsGetHashAlgId = -1</td>
        </tr>
        <tr>
          <td id="L4540" data-line-number="4540"></td>
          <td id="LC4540">    End Select</td>
        </tr>
        <tr>
          <td id="L4541" data-line-number="4541"></td>
          <td id="LC4541">End Function</td>
        </tr>
        <tr>
          <td id="L4542" data-line-number="4542"></td>
          <td id="LC4542">
</td>
        </tr>
        <tr>
          <td id="L4543" data-line-number="4543"></td>
          <td id="LC4543">Private Sub pvTlsSignatureSign(baRetVal() As Byte, cCerts As Collection, cPrivKey As Collection, ByVal lSignatureScheme As Long, baVerifyData() As Byte)</td>
        </tr>
        <tr>
          <td id="L4544" data-line-number="4544"></td>
          <td id="LC4544">    Const FUNC_NAME     As String = &#34;pvTlsSignatureSign&#34;</td>
        </tr>
        <tr>
          <td id="L4545" data-line-number="4545"></td>
          <td id="LC4545">    Dim baSignature()   As Byte</td>
        </tr>
        <tr>
          <td id="L4546" data-line-number="4546"></td>
          <td id="LC4546">    Dim uKeyInfo        As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L4547" data-line-number="4547"></td>
          <td id="LC4547">    Dim lHashSize       As Long</td>
        </tr>
        <tr>
          <td id="L4548" data-line-number="4548"></td>
          <td id="LC4548">    Dim baEnc()         As Byte</td>
        </tr>
        <tr>
          <td id="L4549" data-line-number="4549"></td>
          <td id="LC4549">    Dim baVerifyHash()  As Byte</td>
        </tr>
        <tr>
          <td id="L4550" data-line-number="4550"></td>
          <td id="LC4550">    Dim sHashAlg        As String</td>
        </tr>
        <tr>
          <td id="L4551" data-line-number="4551"></td>
          <td id="LC4551">    Dim uPadInfo        As BCRYPT_PSS_PADDING_INFO</td>
        </tr>
        <tr>
          <td id="L4552" data-line-number="4552"></td>
          <td id="LC4552">    Dim lPadPtr         As Long</td>
        </tr>
        <tr>
          <td id="L4553" data-line-number="4553"></td>
          <td id="LC4553">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L4554" data-line-number="4554"></td>
          <td id="LC4554">    Dim dwFlags         As Long</td>
        </tr>
        <tr>
          <td id="L4555" data-line-number="4555"></td>
          <td id="LC4555">    Dim lAlgId          As Long</td>
        </tr>
        <tr>
          <td id="L4556" data-line-number="4556"></td>
          <td id="LC4556">    Dim hProvHash       As Long</td>
        </tr>
        <tr>
          <td id="L4557" data-line-number="4557"></td>
          <td id="LC4557">    Dim hHash           As Long</td>
        </tr>
        <tr>
          <td id="L4558" data-line-number="4558"></td>
          <td id="LC4558">    Dim hResult         As Long</td>
        </tr>
        <tr>
          <td id="L4559" data-line-number="4559"></td>
          <td id="LC4559">    Dim sApiSource      As String</td>
        </tr>
        <tr>
          <td id="L4560" data-line-number="4560"></td>
          <td id="LC4560">    Dim sErrDesc        As String</td>
        </tr>
        <tr>
          <td id="L4561" data-line-number="4561"></td>
          <td id="LC4561">        </td>
        </tr>
        <tr>
          <td id="L4562" data-line-number="4562"></td>
          <td id="LC4562">    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L4563" data-line-number="4563"></td>
          <td id="LC4563">        DebugLog MODULE_NAME, FUNC_NAME, &#34;Signing with &#34; &amp; pvTlsGetSignatureName(lSignatureScheme) &amp; &#34; signature&#34;</td>
        </tr>
        <tr>
          <td id="L4564" data-line-number="4564"></td>
          <td id="LC4564">    #End If</td>
        </tr>
        <tr>
          <td id="L4565" data-line-number="4565"></td>
          <td id="LC4565">    If Not pvAsn1DecodePrivateKey(cCerts, cPrivKey, uKeyInfo) Then</td>
        </tr>
        <tr>
          <td id="L4566" data-line-number="4566"></td>
          <td id="LC4566">        sErrDesc = ERR_UNSUPPORTED_PRIVATE_KEY</td>
        </tr>
        <tr>
          <td id="L4567" data-line-number="4567"></td>
          <td id="LC4567">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L4568" data-line-number="4568"></td>
          <td id="LC4568">    End If</td>
        </tr>
        <tr>
          <td id="L4569" data-line-number="4569"></td>
          <td id="LC4569">    lHashSize = pvTlsSignatureHashSize(lSignatureScheme)</td>
        </tr>
        <tr>
          <td id="L4570" data-line-number="4570"></td>
          <td id="LC4570">    If uKeyInfo.hNKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4571" data-line-number="4571"></td>
          <td id="LC4571">        If uKeyInfo.AlgoObjId = szOID_RSA_RSA Then</td>
        </tr>
        <tr>
          <td id="L4572" data-line-number="4572"></td>
          <td id="LC4572">            sHashAlg = pvTlsGetHashName(pvTlsSignatureDigestAlgo(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4573" data-line-number="4573"></td>
          <td id="LC4573">            uPadInfo.pszAlgId = StrPtr(sHashAlg)</td>
        </tr>
        <tr>
          <td id="L4574" data-line-number="4574"></td>
          <td id="LC4574">            If (lSignatureScheme And &amp;HFF) = (TLS_SIGNATURE_RSA_PKCS1_SHA1 And &amp;HFF) Then</td>
        </tr>
        <tr>
          <td id="L4575" data-line-number="4575"></td>
          <td id="LC4575">                dwFlags = BCRYPT_PAD_PKCS1</td>
        </tr>
        <tr>
          <td id="L4576" data-line-number="4576"></td>
          <td id="LC4576">            ElseIf (lSignatureScheme \ &amp;H100) = (TLS_SIGNATURE_RSA_PSS_RSAE_SHA256 \ &amp;H100) Then</td>
        </tr>
        <tr>
          <td id="L4577" data-line-number="4577"></td>
          <td id="LC4577">                dwFlags = BCRYPT_PAD_PSS</td>
        </tr>
        <tr>
          <td id="L4578" data-line-number="4578"></td>
          <td id="LC4578">                uPadInfo.cbSalt = lHashSize</td>
        </tr>
        <tr>
          <td id="L4579" data-line-number="4579"></td>
          <td id="LC4579">            End If</td>
        </tr>
        <tr>
          <td id="L4580" data-line-number="4580"></td>
          <td id="LC4580">            lPadPtr = VarPtr(uPadInfo)</td>
        </tr>
        <tr>
          <td id="L4581" data-line-number="4581"></td>
          <td id="LC4581">        End If</td>
        </tr>
        <tr>
          <td id="L4582" data-line-number="4582"></td>
          <td id="LC4582">        pvArrayHash lHashSize, baVerifyData, baVerifyHash</td>
        </tr>
        <tr>
          <td id="L4583" data-line-number="4583"></td>
          <td id="LC4583">        hResult = NCryptSignHash(uKeyInfo.hNKey, lPadPtr, baVerifyHash(0), UBound(baVerifyHash) + 1, ByVal 0, 0, lSize, dwFlags)</td>
        </tr>
        <tr>
          <td id="L4584" data-line-number="4584"></td>
          <td id="LC4584">        If hResult &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4585" data-line-number="4585"></td>
          <td id="LC4585">            sApiSource = &#34;NCryptSignHash&#34;</td>
        </tr>
        <tr>
          <td id="L4586" data-line-number="4586"></td>
          <td id="LC4586">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4587" data-line-number="4587"></td>
          <td id="LC4587">        End If</td>
        </tr>
        <tr>
          <td id="L4588" data-line-number="4588"></td>
          <td id="LC4588">        pvArrayAllocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L4589" data-line-number="4589"></td>
          <td id="LC4589">        hResult = NCryptSignHash(uKeyInfo.hNKey, lPadPtr, baVerifyHash(0), UBound(baVerifyHash) + 1, baRetVal(0), lSize, lSize, dwFlags)</td>
        </tr>
        <tr>
          <td id="L4590" data-line-number="4590"></td>
          <td id="LC4590">        If hResult &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4591" data-line-number="4591"></td>
          <td id="LC4591">            sApiSource = &#34;NCryptSignHash#2&#34;</td>
        </tr>
        <tr>
          <td id="L4592" data-line-number="4592"></td>
          <td id="LC4592">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4593" data-line-number="4593"></td>
          <td id="LC4593">        End If</td>
        </tr>
        <tr>
          <td id="L4594" data-line-number="4594"></td>
          <td id="LC4594">        pvArrayReallocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L4595" data-line-number="4595"></td>
          <td id="LC4595">        If uKeyInfo.AlgoObjId = szOID_ECC_PUBLIC_KEY Then</td>
        </tr>
        <tr>
          <td id="L4596" data-line-number="4596"></td>
          <td id="LC4596">            baSignature = baRetVal</td>
        </tr>
        <tr>
          <td id="L4597" data-line-number="4597"></td>
          <td id="LC4597">            If Not pvAsn1EncodeEcdsaSignature(baRetVal, baSignature, (UBound(baSignature) + 1) \ 2) Then</td>
        </tr>
        <tr>
          <td id="L4598" data-line-number="4598"></td>
          <td id="LC4598">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;Asn1EncodeEcdsaSignature&#34;)</td>
        </tr>
        <tr>
          <td id="L4599" data-line-number="4599"></td>
          <td id="LC4599">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4600" data-line-number="4600"></td>
          <td id="LC4600">            End If</td>
        </tr>
        <tr>
          <td id="L4601" data-line-number="4601"></td>
          <td id="LC4601">        End If</td>
        </tr>
        <tr>
          <td id="L4602" data-line-number="4602"></td>
          <td id="LC4602">    ElseIf uKeyInfo.hProv &lt;&gt; 0 And uKeyInfo.hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4603" data-line-number="4603"></td>
          <td id="LC4603">        Debug.Assert (lSignatureScheme And &amp;HFF) = (TLS_SIGNATURE_RSA_PKCS1_SHA1 And &amp;HFF)</td>
        </tr>
        <tr>
          <td id="L4604" data-line-number="4604"></td>
          <td id="LC4604">        lAlgId = pvTlsGetHashAlgId(pvTlsSignatureDigestAlgo(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4605" data-line-number="4605"></td>
          <td id="LC4605">        If CryptCreateHash(uKeyInfo.hProv, lAlgId, 0, 0, hHash) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4606" data-line-number="4606"></td>
          <td id="LC4606">            hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L4607" data-line-number="4607"></td>
          <td id="LC4607">            sApiSource = &#34;CryptCreateHash&#34;</td>
        </tr>
        <tr>
          <td id="L4608" data-line-number="4608"></td>
          <td id="LC4608">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4609" data-line-number="4609"></td>
          <td id="LC4609">        End If</td>
        </tr>
        <tr>
          <td id="L4610" data-line-number="4610"></td>
          <td id="LC4610">        If CryptGetHashParam(hHash, HP_HASHSIZE, lSize, LenB(lSize), 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4611" data-line-number="4611"></td>
          <td id="LC4611">            hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L4612" data-line-number="4612"></td>
          <td id="LC4612">            sApiSource = &#34;CryptGetHashParam(HP_HASHSIZE)&#34;</td>
        </tr>
        <tr>
          <td id="L4613" data-line-number="4613"></td>
          <td id="LC4613">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4614" data-line-number="4614"></td>
          <td id="LC4614">        End If</td>
        </tr>
        <tr>
          <td id="L4615" data-line-number="4615"></td>
          <td id="LC4615">        If lSize &lt;&gt; lHashSize Then</td>
        </tr>
        <tr>
          <td id="L4616" data-line-number="4616"></td>
          <td id="LC4616">            sErrDesc = Replace(ERR_INVALID_HASH_SIZE, &#34;%1&#34;, lSize &amp; &#34;&lt;&gt;&#34; &amp; lHashSize)</td>
        </tr>
        <tr>
          <td id="L4617" data-line-number="4617"></td>
          <td id="LC4617">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4618" data-line-number="4618"></td>
          <td id="LC4618">        End If</td>
        </tr>
        <tr>
          <td id="L4619" data-line-number="4619"></td>
          <td id="LC4619">        pvArrayHash lHashSize, baVerifyData, baVerifyHash</td>
        </tr>
        <tr>
          <td id="L4620" data-line-number="4620"></td>
          <td id="LC4620">        If CryptSetHashParam(hHash, HP_HASHVAL, baVerifyHash(0), 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4621" data-line-number="4621"></td>
          <td id="LC4621">            hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L4622" data-line-number="4622"></td>
          <td id="LC4622">            sApiSource = &#34;CryptSetHashParam(HP_HASHVAL)&#34;</td>
        </tr>
        <tr>
          <td id="L4623" data-line-number="4623"></td>
          <td id="LC4623">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4624" data-line-number="4624"></td>
          <td id="LC4624">        End If</td>
        </tr>
        <tr>
          <td id="L4625" data-line-number="4625"></td>
          <td id="LC4625">        If CryptSignHash(hHash, uKeyInfo.dwKeySpec, 0, 0, ByVal 0, lSize) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4626" data-line-number="4626"></td>
          <td id="LC4626">            hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L4627" data-line-number="4627"></td>
          <td id="LC4627">            sApiSource = &#34;CryptSignHash&#34;</td>
        </tr>
        <tr>
          <td id="L4628" data-line-number="4628"></td>
          <td id="LC4628">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4629" data-line-number="4629"></td>
          <td id="LC4629">        End If</td>
        </tr>
        <tr>
          <td id="L4630" data-line-number="4630"></td>
          <td id="LC4630">        pvArrayAllocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L4631" data-line-number="4631"></td>
          <td id="LC4631">        If CryptSignHash(hHash, uKeyInfo.dwKeySpec, 0, 0, baRetVal(0), lSize) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4632" data-line-number="4632"></td>
          <td id="LC4632">            hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L4633" data-line-number="4633"></td>
          <td id="LC4633">            sApiSource = &#34;CryptSignHash#2&#34;</td>
        </tr>
        <tr>
          <td id="L4634" data-line-number="4634"></td>
          <td id="LC4634">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4635" data-line-number="4635"></td>
          <td id="LC4635">        End If</td>
        </tr>
        <tr>
          <td id="L4636" data-line-number="4636"></td>
          <td id="LC4636">        pvArrayReallocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L4637" data-line-number="4637"></td>
          <td id="LC4637">        pvArrayReverse baRetVal</td>
        </tr>
        <tr>
          <td id="L4638" data-line-number="4638"></td>
          <td id="LC4638">    Else</td>
        </tr>
        <tr>
          <td id="L4639" data-line-number="4639"></td>
          <td id="LC4639">        Select Case lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L4640" data-line-number="4640"></td>
          <td id="LC4640">        Case TLS_SIGNATURE_RSA_PKCS1_SHA1, TLS_SIGNATURE_RSA_PKCS1_SHA224, TLS_SIGNATURE_RSA_PKCS1_SHA256, TLS_SIGNATURE_RSA_PKCS1_SHA384, TLS_SIGNATURE_RSA_PKCS1_SHA512</td>
        </tr>
        <tr>
          <td id="L4641" data-line-number="4641"></td>
          <td id="LC4641">            Debug.Assert uKeyInfo.AlgoObjId = szOID_RSA_RSA</td>
        </tr>
        <tr>
          <td id="L4642" data-line-number="4642"></td>
          <td id="LC4642">            If Not pvCryptoEmsaPkcs1Encode(baEnc, baVerifyData, uKeyInfo.BitLen, lHashSize) Then</td>
        </tr>
        <tr>
          <td id="L4643" data-line-number="4643"></td>
          <td id="LC4643">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEmsaPkcs1Encode&#34;)</td>
        </tr>
        <tr>
          <td id="L4644" data-line-number="4644"></td>
          <td id="LC4644">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4645" data-line-number="4645"></td>
          <td id="LC4645">            End If</td>
        </tr>
        <tr>
          <td id="L4646" data-line-number="4646"></td>
          <td id="LC4646">            If Not pvCryptoRsaCrtModExp(baEnc, uKeyInfo.PrivExp, uKeyInfo.Modulus, uKeyInfo.Prime1, uKeyInfo.Prime2, uKeyInfo.Coefficient, baRetVal) Then</td>
        </tr>
        <tr>
          <td id="L4647" data-line-number="4647"></td>
          <td id="LC4647">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoRsaCrtModExp&#34;)</td>
        </tr>
        <tr>
          <td id="L4648" data-line-number="4648"></td>
          <td id="LC4648">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4649" data-line-number="4649"></td>
          <td id="LC4649">            End If</td>
        </tr>
        <tr>
          <td id="L4650" data-line-number="4650"></td>
          <td id="LC4650">        Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA256, TLS_SIGNATURE_RSA_PSS_RSAE_SHA384, TLS_SIGNATURE_RSA_PSS_RSAE_SHA512, _</td>
        </tr>
        <tr>
          <td id="L4651" data-line-number="4651"></td>
          <td id="LC4651">                TLS_SIGNATURE_RSA_PSS_PSS_SHA256, TLS_SIGNATURE_RSA_PSS_PSS_SHA384, TLS_SIGNATURE_RSA_PSS_PSS_SHA512</td>
        </tr>
        <tr>
          <td id="L4652" data-line-number="4652"></td>
          <td id="LC4652">            Debug.Assert uKeyInfo.AlgoObjId = szOID_RSA_RSA Or uKeyInfo.AlgoObjId = szOID_RSA_SSA_PSS</td>
        </tr>
        <tr>
          <td id="L4653" data-line-number="4653"></td>
          <td id="LC4653">            If Not pvCryptoEmsaPssEncode(baEnc, baVerifyData, uKeyInfo.BitLen, lHashSize, lHashSize) Then</td>
        </tr>
        <tr>
          <td id="L4654" data-line-number="4654"></td>
          <td id="LC4654">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEmsaPssEncode&#34;)</td>
        </tr>
        <tr>
          <td id="L4655" data-line-number="4655"></td>
          <td id="LC4655">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4656" data-line-number="4656"></td>
          <td id="LC4656">            End If</td>
        </tr>
        <tr>
          <td id="L4657" data-line-number="4657"></td>
          <td id="LC4657">            If Not pvCryptoRsaCrtModExp(baEnc, uKeyInfo.PrivExp, uKeyInfo.Modulus, uKeyInfo.Prime1, uKeyInfo.Prime2, uKeyInfo.Coefficient, baRetVal) Then</td>
        </tr>
        <tr>
          <td id="L4658" data-line-number="4658"></td>
          <td id="LC4658">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoRsaCrtModExp&#34;)</td>
        </tr>
        <tr>
          <td id="L4659" data-line-number="4659"></td>
          <td id="LC4659">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4660" data-line-number="4660"></td>
          <td id="LC4660">            End If</td>
        </tr>
        <tr>
          <td id="L4661" data-line-number="4661"></td>
          <td id="LC4661">        Case TLS_SIGNATURE_ECDSA_SHA1</td>
        </tr>
        <tr>
          <td id="L4662" data-line-number="4662"></td>
          <td id="LC4662">            If Not pvCryptoHashSha1(baVerifyHash, baVerifyData) Then</td>
        </tr>
        <tr>
          <td id="L4663" data-line-number="4663"></td>
          <td id="LC4663">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha1&#34;)</td>
        </tr>
        <tr>
          <td id="L4664" data-line-number="4664"></td>
          <td id="LC4664">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4665" data-line-number="4665"></td>
          <td id="LC4665">            End If</td>
        </tr>
        <tr>
          <td id="L4666" data-line-number="4666"></td>
          <td id="LC4666">            If uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P256 Then</td>
        </tr>
        <tr>
          <td id="L4667" data-line-number="4667"></td>
          <td id="LC4667">                GoTo Secp256r1Sign</td>
        </tr>
        <tr>
          <td id="L4668" data-line-number="4668"></td>
          <td id="LC4668">            ElseIf uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P384 Then</td>
        </tr>
        <tr>
          <td id="L4669" data-line-number="4669"></td>
          <td id="LC4669">                GoTo Secp384r1Sign</td>
        </tr>
        <tr>
          <td id="L4670" data-line-number="4670"></td>
          <td id="LC4670">            End If</td>
        </tr>
        <tr>
          <td id="L4671" data-line-number="4671"></td>
          <td id="LC4671">        Case TLS_SIGNATURE_ECDSA_SECP256R1_SHA256</td>
        </tr>
        <tr>
          <td id="L4672" data-line-number="4672"></td>
          <td id="LC4672">            Debug.Assert uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P256</td>
        </tr>
        <tr>
          <td id="L4673" data-line-number="4673"></td>
          <td id="LC4673">            If Not pvCryptoHashSha256(baVerifyHash, baVerifyData) Then</td>
        </tr>
        <tr>
          <td id="L4674" data-line-number="4674"></td>
          <td id="LC4674">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha256&#34;)</td>
        </tr>
        <tr>
          <td id="L4675" data-line-number="4675"></td>
          <td id="LC4675">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4676" data-line-number="4676"></td>
          <td id="LC4676">            End If</td>
        </tr>
        <tr>
          <td id="L4677" data-line-number="4677"></td>
          <td id="LC4677">Secp256r1Sign:</td>
        </tr>
        <tr>
          <td id="L4678" data-line-number="4678"></td>
          <td id="LC4678">            If Not pvCryptoEcdsaSecp256r1Sign(baSignature, uKeyInfo.KeyBlob, baVerifyHash) Then</td>
        </tr>
        <tr>
          <td id="L4679" data-line-number="4679"></td>
          <td id="LC4679">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEcdsaSecp256r1Sign&#34;)</td>
        </tr>
        <tr>
          <td id="L4680" data-line-number="4680"></td>
          <td id="LC4680">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4681" data-line-number="4681"></td>
          <td id="LC4681">            End If</td>
        </tr>
        <tr>
          <td id="L4682" data-line-number="4682"></td>
          <td id="LC4682">            If Not pvAsn1EncodeEcdsaSignature(baRetVal, baSignature, LNG_SECP256R1_KEYSZ) Then</td>
        </tr>
        <tr>
          <td id="L4683" data-line-number="4683"></td>
          <td id="LC4683">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;Asn1EncodeEcdsaSignature&#34;)</td>
        </tr>
        <tr>
          <td id="L4684" data-line-number="4684"></td>
          <td id="LC4684">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4685" data-line-number="4685"></td>
          <td id="LC4685">            End If</td>
        </tr>
        <tr>
          <td id="L4686" data-line-number="4686"></td>
          <td id="LC4686">        Case TLS_SIGNATURE_ECDSA_SECP384R1_SHA384</td>
        </tr>
        <tr>
          <td id="L4687" data-line-number="4687"></td>
          <td id="LC4687">            Debug.Assert uKeyInfo.AlgoObjId = szOID_ECC_CURVE_P384</td>
        </tr>
        <tr>
          <td id="L4688" data-line-number="4688"></td>
          <td id="LC4688">            If Not pvCryptoHashSha384(baVerifyHash, baVerifyData) Then</td>
        </tr>
        <tr>
          <td id="L4689" data-line-number="4689"></td>
          <td id="LC4689">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha384&#34;)</td>
        </tr>
        <tr>
          <td id="L4690" data-line-number="4690"></td>
          <td id="LC4690">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4691" data-line-number="4691"></td>
          <td id="LC4691">            End If</td>
        </tr>
        <tr>
          <td id="L4692" data-line-number="4692"></td>
          <td id="LC4692">Secp384r1Sign:</td>
        </tr>
        <tr>
          <td id="L4693" data-line-number="4693"></td>
          <td id="LC4693">            If Not pvCryptoEcdsaSecp384r1Sign(baSignature, uKeyInfo.KeyBlob, baVerifyHash) Then</td>
        </tr>
        <tr>
          <td id="L4694" data-line-number="4694"></td>
          <td id="LC4694">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoEcdsaSecp384r1Sign&#34;)</td>
        </tr>
        <tr>
          <td id="L4695" data-line-number="4695"></td>
          <td id="LC4695">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4696" data-line-number="4696"></td>
          <td id="LC4696">            End If</td>
        </tr>
        <tr>
          <td id="L4697" data-line-number="4697"></td>
          <td id="LC4697">            If Not pvAsn1EncodeEcdsaSignature(baRetVal, baSignature, LNG_SECP384R1_KEYSZ) Then</td>
        </tr>
        <tr>
          <td id="L4698" data-line-number="4698"></td>
          <td id="LC4698">                sErrDesc = Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;Asn1EncodeEcdsaSignature&#34;)</td>
        </tr>
        <tr>
          <td id="L4699" data-line-number="4699"></td>
          <td id="LC4699">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L4700" data-line-number="4700"></td>
          <td id="LC4700">            End If</td>
        </tr>
        <tr>
          <td id="L4701" data-line-number="4701"></td>
          <td id="LC4701">        Case Else</td>
        </tr>
        <tr>
          <td id="L4702" data-line-number="4702"></td>
          <td id="LC4702">            sErrDesc = Replace(ERR_UNSUPPORTED_SIGNATURE_SCHEME, &#34;%1&#34;, pvTlsGetSignatureName(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4703" data-line-number="4703"></td>
          <td id="LC4703">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L4704" data-line-number="4704"></td>
          <td id="LC4704">        End Select</td>
        </tr>
        <tr>
          <td id="L4705" data-line-number="4705"></td>
          <td id="LC4705">    End If</td>
        </tr>
        <tr>
          <td id="L4706" data-line-number="4706"></td>
          <td id="LC4706">    If pvArraySize(baRetVal) = 0 Then</td>
        </tr>
        <tr>
          <td id="L4707" data-line-number="4707"></td>
          <td id="LC4707">        sErrDesc = Replace(ERR_SIGNATURE_FAILED, &#34;%1&#34;, pvTlsGetSignatureName(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4708" data-line-number="4708"></td>
          <td id="LC4708">    End If</td>
        </tr>
        <tr>
          <td id="L4709" data-line-number="4709"></td>
          <td id="LC4709">QH:</td>
        </tr>
        <tr>
          <td id="L4710" data-line-number="4710"></td>
          <td id="LC4710">    If hHash &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4711" data-line-number="4711"></td>
          <td id="LC4711">        Call CryptDestroyHash(hHash)</td>
        </tr>
        <tr>
          <td id="L4712" data-line-number="4712"></td>
          <td id="LC4712">    End If</td>
        </tr>
        <tr>
          <td id="L4713" data-line-number="4713"></td>
          <td id="LC4713">    If hProvHash &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4714" data-line-number="4714"></td>
          <td id="LC4714">        Call CryptReleaseContext(hProvHash, 0)</td>
        </tr>
        <tr>
          <td id="L4715" data-line-number="4715"></td>
          <td id="LC4715">    End If</td>
        </tr>
        <tr>
          <td id="L4716" data-line-number="4716"></td>
          <td id="LC4716">    If uKeyInfo.hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4717" data-line-number="4717"></td>
          <td id="LC4717">        Call CryptDestroyKey(uKeyInfo.hKey)</td>
        </tr>
        <tr>
          <td id="L4718" data-line-number="4718"></td>
          <td id="LC4718">    End If</td>
        </tr>
        <tr>
          <td id="L4719" data-line-number="4719"></td>
          <td id="LC4719">    If uKeyInfo.hProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4720" data-line-number="4720"></td>
          <td id="LC4720">        Call CryptReleaseContext(uKeyInfo.hProv, 0)</td>
        </tr>
        <tr>
          <td id="L4721" data-line-number="4721"></td>
          <td id="LC4721">    End If</td>
        </tr>
        <tr>
          <td id="L4722" data-line-number="4722"></td>
          <td id="LC4722">    If uKeyInfo.hNKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4723" data-line-number="4723"></td>
          <td id="LC4723">        Call NCryptFreeObject(uKeyInfo.hNKey)</td>
        </tr>
        <tr>
          <td id="L4724" data-line-number="4724"></td>
          <td id="LC4724">    End If</td>
        </tr>
        <tr>
          <td id="L4725" data-line-number="4725"></td>
          <td id="LC4725">    If LenB(sApiSource) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4726" data-line-number="4726"></td>
          <td id="LC4726">        ErrRaise IIf(hResult &lt; 0, hResult, hResult Or LNG_FACILITY_WIN32), FUNC_NAME &amp; &#34;.&#34; &amp; sApiSource</td>
        </tr>
        <tr>
          <td id="L4727" data-line-number="4727"></td>
          <td id="LC4727">    End If</td>
        </tr>
        <tr>
          <td id="L4728" data-line-number="4728"></td>
          <td id="LC4728">    If LenB(sErrDesc) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4729" data-line-number="4729"></td>
          <td id="LC4729">        ErrRaise vbObjectError, FUNC_NAME, sErrDesc</td>
        </tr>
        <tr>
          <td id="L4730" data-line-number="4730"></td>
          <td id="LC4730">    End If</td>
        </tr>
        <tr>
          <td id="L4731" data-line-number="4731"></td>
          <td id="LC4731">End Sub</td>
        </tr>
        <tr>
          <td id="L4732" data-line-number="4732"></td>
          <td id="LC4732">
</td>
        </tr>
        <tr>
          <td id="L4733" data-line-number="4733"></td>
          <td id="LC4733">Private Function pvTlsSignatureVerify(baCert() As Byte, ByVal lSignatureScheme As Long, baVerifyData() As Byte, baSignature() As Byte, sError As String, eAlertCode As UcsTlsAlertDescriptionsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L4734" data-line-number="4734"></td>
          <td id="LC4734">    Const FUNC_NAME     As String = &#34;pvTlsSignatureVerify&#34;</td>
        </tr>
        <tr>
          <td id="L4735" data-line-number="4735"></td>
          <td id="LC4735">    Dim uCertInfo       As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L4736" data-line-number="4736"></td>
          <td id="LC4736">    Dim lHashSize       As Long</td>
        </tr>
        <tr>
          <td id="L4737" data-line-number="4737"></td>
          <td id="LC4737">    Dim baVerifyHash()  As Byte</td>
        </tr>
        <tr>
          <td id="L4738" data-line-number="4738"></td>
          <td id="LC4738">    Dim baPlainSig()    As Byte</td>
        </tr>
        <tr>
          <td id="L4739" data-line-number="4739"></td>
          <td id="LC4739">    Dim lCurveSize      As Long</td>
        </tr>
        <tr>
          <td id="L4740" data-line-number="4740"></td>
          <td id="LC4740">    Dim bSkip           As Boolean</td>
        </tr>
        <tr>
          <td id="L4741" data-line-number="4741"></td>
          <td id="LC4741">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L4742" data-line-number="4742"></td>
          <td id="LC4742">    Dim bDeprecated     As Boolean</td>
        </tr>
        <tr>
          <td id="L4743" data-line-number="4743"></td>
          <td id="LC4743">    Dim baDecr()        As Byte</td>
        </tr>
        <tr>
          <td id="L4744" data-line-number="4744"></td>
          <td id="LC4744">    </td>
        </tr>
        <tr>
          <td id="L4745" data-line-number="4745"></td>
          <td id="LC4745">    On Error GoTo EH</td>
        </tr>
        <tr>
          <td id="L4746" data-line-number="4746"></td>
          <td id="LC4746">    If Not pvAsn1DecodeCertificate(baCert, uCertInfo) Then</td>
        </tr>
        <tr>
          <td id="L4747" data-line-number="4747"></td>
          <td id="LC4747">        GoTo UnsupportedCertificate</td>
        </tr>
        <tr>
          <td id="L4748" data-line-number="4748"></td>
          <td id="LC4748">    End If</td>
        </tr>
        <tr>
          <td id="L4749" data-line-number="4749"></td>
          <td id="LC4749">    lHashSize = pvTlsSignatureHashSize(lSignatureScheme)</td>
        </tr>
        <tr>
          <td id="L4750" data-line-number="4750"></td>
          <td id="LC4750">    Select Case lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L4751" data-line-number="4751"></td>
          <td id="LC4751">    Case TLS_SIGNATURE_RSA_PKCS1_SHA1, TLS_SIGNATURE_RSA_PKCS1_SHA224, TLS_SIGNATURE_RSA_PKCS1_SHA256, TLS_SIGNATURE_RSA_PKCS1_SHA384, TLS_SIGNATURE_RSA_PKCS1_SHA512</td>
        </tr>
        <tr>
          <td id="L4752" data-line-number="4752"></td>
          <td id="LC4752">        If Not pvCryptoRsaModExp(baSignature, uCertInfo.PubExp, uCertInfo.Modulus, baDecr) Then</td>
        </tr>
        <tr>
          <td id="L4753" data-line-number="4753"></td>
          <td id="LC4753">            GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4754" data-line-number="4754"></td>
          <td id="LC4754">        End If</td>
        </tr>
        <tr>
          <td id="L4755" data-line-number="4755"></td>
          <td id="LC4755">        If Not pvCryptoEmsaPkcs1Decode(baVerifyData, baDecr, lHashSize) Then</td>
        </tr>
        <tr>
          <td id="L4756" data-line-number="4756"></td>
          <td id="LC4756">            GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4757" data-line-number="4757"></td>
          <td id="LC4757">        End If</td>
        </tr>
        <tr>
          <td id="L4758" data-line-number="4758"></td>
          <td id="LC4758">    Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA256, TLS_SIGNATURE_RSA_PSS_RSAE_SHA384, TLS_SIGNATURE_RSA_PSS_RSAE_SHA512, _</td>
        </tr>
        <tr>
          <td id="L4759" data-line-number="4759"></td>
          <td id="LC4759">            TLS_SIGNATURE_RSA_PSS_PSS_SHA256, TLS_SIGNATURE_RSA_PSS_PSS_SHA384, TLS_SIGNATURE_RSA_PSS_PSS_SHA512</td>
        </tr>
        <tr>
          <td id="L4760" data-line-number="4760"></td>
          <td id="LC4760">        If Not pvCryptoRsaModExp(baSignature, uCertInfo.PubExp, uCertInfo.Modulus, baDecr) Then</td>
        </tr>
        <tr>
          <td id="L4761" data-line-number="4761"></td>
          <td id="LC4761">            GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4762" data-line-number="4762"></td>
          <td id="LC4762">        End If</td>
        </tr>
        <tr>
          <td id="L4763" data-line-number="4763"></td>
          <td id="LC4763">        If Not pvCryptoEmsaPssDecode(baVerifyData, baDecr, uCertInfo.BitLen, lHashSize, lHashSize) Then</td>
        </tr>
        <tr>
          <td id="L4764" data-line-number="4764"></td>
          <td id="LC4764">            GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4765" data-line-number="4765"></td>
          <td id="LC4765">        End If</td>
        </tr>
        <tr>
          <td id="L4766" data-line-number="4766"></td>
          <td id="LC4766">    Case TLS_SIGNATURE_ECDSA_SHA1, TLS_SIGNATURE_ECDSA_SECP256R1_SHA256, TLS_SIGNATURE_ECDSA_SECP384R1_SHA384, TLS_SIGNATURE_ECDSA_SECP521R1_SHA512</td>
        </tr>
        <tr>
          <td id="L4767" data-line-number="4767"></td>
          <td id="LC4767">        If uCertInfo.AlgoObjId &lt;&gt; szOID_ECC_PUBLIC_KEY Then</td>
        </tr>
        <tr>
          <td id="L4768" data-line-number="4768"></td>
          <td id="LC4768">            GoTo UnsupportedPublicKey</td>
        </tr>
        <tr>
          <td id="L4769" data-line-number="4769"></td>
          <td id="LC4769">        End If</td>
        </tr>
        <tr>
          <td id="L4770" data-line-number="4770"></td>
          <td id="LC4770">        pvArrayHash lHashSize, baVerifyData, baVerifyHash</td>
        </tr>
        <tr>
          <td id="L4771" data-line-number="4771"></td>
          <td id="LC4771">        lCurveSize = UBound(uCertInfo.KeyBlob) \ 2</td>
        </tr>
        <tr>
          <td id="L4772" data-line-number="4772"></td>
          <td id="LC4772">        If Not pvAsn1DecodeEcdsaSignature(baPlainSig, baSignature, lCurveSize) Then</td>
        </tr>
        <tr>
          <td id="L4773" data-line-number="4773"></td>
          <td id="LC4773">            GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4774" data-line-number="4774"></td>
          <td id="LC4774">        End If</td>
        </tr>
        <tr>
          <td id="L4775" data-line-number="4775"></td>
          <td id="LC4775">        If UBound(baVerifyHash) + 1 &lt; lCurveSize Then</td>
        </tr>
        <tr>
          <td id="L4776" data-line-number="4776"></td>
          <td id="LC4776">            &#39;--- note: when hash size is less than curve size must left-pad w/ zeros (right-align hash) -&gt; deprecated</td>
        </tr>
        <tr>
          <td id="L4777" data-line-number="4777"></td>
          <td id="LC4777">            &#39;---       incl. ECDSA_SECP384R1_SHA256 only</td>
        </tr>
        <tr>
          <td id="L4778" data-line-number="4778"></td>
          <td id="LC4778">            baTemp = baVerifyHash</td>
        </tr>
        <tr>
          <td id="L4779" data-line-number="4779"></td>
          <td id="LC4779">            pvArrayAllocate baVerifyHash, lCurveSize, FUNC_NAME &amp; &#34;.baVerifyHash&#34;</td>
        </tr>
        <tr>
          <td id="L4780" data-line-number="4780"></td>
          <td id="LC4780">            Call CopyMemory(baVerifyHash(lCurveSize - UBound(baTemp) - 1), baTemp(0), UBound(baTemp) + 1)</td>
        </tr>
        <tr>
          <td id="L4781" data-line-number="4781"></td>
          <td id="LC4781">            bDeprecated = True</td>
        </tr>
        <tr>
          <td id="L4782" data-line-number="4782"></td>
          <td id="LC4782">        ElseIf UBound(baVerifyHash) + 1 &gt; lCurveSize Then</td>
        </tr>
        <tr>
          <td id="L4783" data-line-number="4783"></td>
          <td id="LC4783">            &#39;--- note: when hash size is above curve size the excess is ignored -&gt; deprecated</td>
        </tr>
        <tr>
          <td id="L4784" data-line-number="4784"></td>
          <td id="LC4784">            &#39;---       incl. ECDSA_SECP256R1_SHA384, ECDSA_SECP256R1_SHA512 and ECDSA_SECP384R1_SHA512</td>
        </tr>
        <tr>
          <td id="L4785" data-line-number="4785"></td>
          <td id="LC4785">            bDeprecated = True</td>
        </tr>
        <tr>
          <td id="L4786" data-line-number="4786"></td>
          <td id="LC4786">        End If</td>
        </tr>
        <tr>
          <td id="L4787" data-line-number="4787"></td>
          <td id="LC4787">        Select Case lCurveSize</td>
        </tr>
        <tr>
          <td id="L4788" data-line-number="4788"></td>
          <td id="LC4788">        Case LNG_SECP256R1_KEYSZ</td>
        </tr>
        <tr>
          <td id="L4789" data-line-number="4789"></td>
          <td id="LC4789">            If Not pvCryptoEcdsaSecp256r1Verify(uCertInfo.KeyBlob, baVerifyHash, baPlainSig) Then</td>
        </tr>
        <tr>
          <td id="L4790" data-line-number="4790"></td>
          <td id="LC4790">                GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4791" data-line-number="4791"></td>
          <td id="LC4791">            End If</td>
        </tr>
        <tr>
          <td id="L4792" data-line-number="4792"></td>
          <td id="LC4792">        Case LNG_SECP384R1_KEYSZ</td>
        </tr>
        <tr>
          <td id="L4793" data-line-number="4793"></td>
          <td id="LC4793">            If Not pvCryptoEcdsaSecp384r1Verify(uCertInfo.KeyBlob, baVerifyHash, baPlainSig) Then</td>
        </tr>
        <tr>
          <td id="L4794" data-line-number="4794"></td>
          <td id="LC4794">                GoTo InvalidSignature</td>
        </tr>
        <tr>
          <td id="L4795" data-line-number="4795"></td>
          <td id="LC4795">            End If</td>
        </tr>
        <tr>
          <td id="L4796" data-line-number="4796"></td>
          <td id="LC4796">        Case Else</td>
        </tr>
        <tr>
          <td id="L4797" data-line-number="4797"></td>
          <td id="LC4797">            GoTo UnsupportedCurveSize</td>
        </tr>
        <tr>
          <td id="L4798" data-line-number="4798"></td>
          <td id="LC4798">        End Select</td>
        </tr>
        <tr>
          <td id="L4799" data-line-number="4799"></td>
          <td id="LC4799">    Case Else</td>
        </tr>
        <tr>
          <td id="L4800" data-line-number="4800"></td>
          <td id="LC4800">        GoTo UnsupportedSignatureScheme</td>
        </tr>
        <tr>
          <td id="L4801" data-line-number="4801"></td>
          <td id="LC4801">    End Select</td>
        </tr>
        <tr>
          <td id="L4802" data-line-number="4802"></td>
          <td id="LC4802">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L4803" data-line-number="4803"></td>
          <td id="LC4803">    pvTlsSignatureVerify = True</td>
        </tr>
        <tr>
          <td id="L4804" data-line-number="4804"></td>
          <td id="LC4804">QH:</td>
        </tr>
        <tr>
          <td id="L4805" data-line-number="4805"></td>
          <td id="LC4805">    #If ImplUseDebugLog Then</td>
        </tr>
        <tr>
          <td id="L4806" data-line-number="4806"></td>
          <td id="LC4806">        DebugLog MODULE_NAME, FUNC_NAME, IIf(pvTlsSignatureVerify, IIf(bSkip, &#34;Skipping &#34;, IIf(bDeprecated, &#34;Deprecated &#34;, &#34;Valid &#34;)), &#34;Invalid &#34;) &amp; pvTlsGetSignatureName(lSignatureScheme) &amp; &#34; signature&#34; &amp; IIf(bDeprecated, &#34; (lCurveSize=&#34; &amp; lCurveSize &amp; &#34; from server&#39;s public key)&#34;, vbNullString)</td>
        </tr>
        <tr>
          <td id="L4807" data-line-number="4807"></td>
          <td id="LC4807">    #End If</td>
        </tr>
        <tr>
          <td id="L4808" data-line-number="4808"></td>
          <td id="LC4808">    Exit Function</td>
        </tr>
        <tr>
          <td id="L4809" data-line-number="4809"></td>
          <td id="LC4809">UnsupportedCertificate:</td>
        </tr>
        <tr>
          <td id="L4810" data-line-number="4810"></td>
          <td id="LC4810">    sError = ERR_UNSUPPORTED_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L4811" data-line-number="4811"></td>
          <td id="LC4811">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L4812" data-line-number="4812"></td>
          <td id="LC4812">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L4813" data-line-number="4813"></td>
          <td id="LC4813">InvalidSignature:</td>
        </tr>
        <tr>
          <td id="L4814" data-line-number="4814"></td>
          <td id="LC4814">    sError = ERR_INVALID_SIGNATURE</td>
        </tr>
        <tr>
          <td id="L4815" data-line-number="4815"></td>
          <td id="LC4815">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L4816" data-line-number="4816"></td>
          <td id="LC4816">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L4817" data-line-number="4817"></td>
          <td id="LC4817">UnsupportedPublicKey:</td>
        </tr>
        <tr>
          <td id="L4818" data-line-number="4818"></td>
          <td id="LC4818">    sError = Replace(ERR_UNSUPPORTED_PUBLIC_KEY, &#34;%1&#34;, uCertInfo.AlgoObjId)</td>
        </tr>
        <tr>
          <td id="L4819" data-line-number="4819"></td>
          <td id="LC4819">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L4820" data-line-number="4820"></td>
          <td id="LC4820">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L4821" data-line-number="4821"></td>
          <td id="LC4821">UnsupportedCurveSize:</td>
        </tr>
        <tr>
          <td id="L4822" data-line-number="4822"></td>
          <td id="LC4822">    sError = Replace(ERR_UNSUPPORTED_CURVE_SIZE, &#34;%1&#34;, lCurveSize)</td>
        </tr>
        <tr>
          <td id="L4823" data-line-number="4823"></td>
          <td id="LC4823">    eAlertCode = uscTlsAlertHandshakeFailure</td>
        </tr>
        <tr>
          <td id="L4824" data-line-number="4824"></td>
          <td id="LC4824">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L4825" data-line-number="4825"></td>
          <td id="LC4825">UnsupportedSignatureScheme:</td>
        </tr>
        <tr>
          <td id="L4826" data-line-number="4826"></td>
          <td id="LC4826">    sError = Replace(ERR_UNSUPPORTED_SIGNATURE_SCHEME, &#34;%1&#34;, pvTlsGetSignatureName(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4827" data-line-number="4827"></td>
          <td id="LC4827">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L4828" data-line-number="4828"></td>
          <td id="LC4828">    GoTo QH</td>
        </tr>
        <tr>
          <td id="L4829" data-line-number="4829"></td>
          <td id="LC4829">EH:</td>
        </tr>
        <tr>
          <td id="L4830" data-line-number="4830"></td>
          <td id="LC4830">    sError = Err.Description &amp; &#34; [&#34; &amp; Err.Source &amp; &#34;]&#34;</td>
        </tr>
        <tr>
          <td id="L4831" data-line-number="4831"></td>
          <td id="LC4831">    eAlertCode = uscTlsAlertInternalError</td>
        </tr>
        <tr>
          <td id="L4832" data-line-number="4832"></td>
          <td id="LC4832">    Resume QH</td>
        </tr>
        <tr>
          <td id="L4833" data-line-number="4833"></td>
          <td id="LC4833">End Function</td>
        </tr>
        <tr>
          <td id="L4834" data-line-number="4834"></td>
          <td id="LC4834">
</td>
        </tr>
        <tr>
          <td id="L4835" data-line-number="4835"></td>
          <td id="LC4835">Private Function pvTlsSignatureHashSize(ByVal lSignatureScheme As Long) As Long</td>
        </tr>
        <tr>
          <td id="L4836" data-line-number="4836"></td>
          <td id="LC4836">    pvTlsSignatureHashSize = pvTlsDigestHashSize(pvTlsSignatureDigestAlgo(lSignatureScheme))</td>
        </tr>
        <tr>
          <td id="L4837" data-line-number="4837"></td>
          <td id="LC4837">End Function</td>
        </tr>
        <tr>
          <td id="L4838" data-line-number="4838"></td>
          <td id="LC4838">
</td>
        </tr>
        <tr>
          <td id="L4839" data-line-number="4839"></td>
          <td id="LC4839">Private Function pvTlsSignatureDigestAlgo(ByVal lSignatureScheme As Long) As UcsTlsCryptoAlgorithmsEnum</td>
        </tr>
        <tr>
          <td id="L4840" data-line-number="4840"></td>
          <td id="LC4840">    Const TLS_SIGNATURE_ALGORITHM_RSA   As Long = 1</td>
        </tr>
        <tr>
          <td id="L4841" data-line-number="4841"></td>
          <td id="LC4841">    Const TLS_SIGNATURE_ALGORITHM_DSA   As Long = 2</td>
        </tr>
        <tr>
          <td id="L4842" data-line-number="4842"></td>
          <td id="LC4842">    Const TLS_SIGNATURE_ALGORITHM_ECDSA As Long = 3</td>
        </tr>
        <tr>
          <td id="L4843" data-line-number="4843"></td>
          <td id="LC4843">    Const TLS_HASH_ALGORITHM_MD5        As Long = 1</td>
        </tr>
        <tr>
          <td id="L4844" data-line-number="4844"></td>
          <td id="LC4844">    Const TLS_HASH_ALGORITHM_SHA1       As Long = 2</td>
        </tr>
        <tr>
          <td id="L4845" data-line-number="4845"></td>
          <td id="LC4845">    Const TLS_HASH_ALGORITHM_SHA224     As Long = 3</td>
        </tr>
        <tr>
          <td id="L4846" data-line-number="4846"></td>
          <td id="LC4846">    Const TLS_HASH_ALGORITHM_SHA256     As Long = 4</td>
        </tr>
        <tr>
          <td id="L4847" data-line-number="4847"></td>
          <td id="LC4847">    Const TLS_HASH_ALGORITHM_SHA384     As Long = 5</td>
        </tr>
        <tr>
          <td id="L4848" data-line-number="4848"></td>
          <td id="LC4848">    Const TLS_HASH_ALGORITHM_SHA512     As Long = 6</td>
        </tr>
        <tr>
          <td id="L4849" data-line-number="4849"></td>
          <td id="LC4849">    </td>
        </tr>
        <tr>
          <td id="L4850" data-line-number="4850"></td>
          <td id="LC4850">    Select Case (lSignatureScheme And &amp;HFF)</td>
        </tr>
        <tr>
          <td id="L4851" data-line-number="4851"></td>
          <td id="LC4851">    Case TLS_SIGNATURE_ALGORITHM_RSA, TLS_SIGNATURE_ALGORITHM_DSA, TLS_SIGNATURE_ALGORITHM_ECDSA</td>
        </tr>
        <tr>
          <td id="L4852" data-line-number="4852"></td>
          <td id="LC4852">        Select Case lSignatureScheme \ &amp;H100</td>
        </tr>
        <tr>
          <td id="L4853" data-line-number="4853"></td>
          <td id="LC4853">        Case TLS_HASH_ALGORITHM_MD5</td>
        </tr>
        <tr>
          <td id="L4854" data-line-number="4854"></td>
          <td id="LC4854">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestMd5</td>
        </tr>
        <tr>
          <td id="L4855" data-line-number="4855"></td>
          <td id="LC4855">        Case TLS_HASH_ALGORITHM_SHA1</td>
        </tr>
        <tr>
          <td id="L4856" data-line-number="4856"></td>
          <td id="LC4856">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L4857" data-line-number="4857"></td>
          <td id="LC4857">        Case TLS_HASH_ALGORITHM_SHA224</td>
        </tr>
        <tr>
          <td id="L4858" data-line-number="4858"></td>
          <td id="LC4858">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha224</td>
        </tr>
        <tr>
          <td id="L4859" data-line-number="4859"></td>
          <td id="LC4859">        Case TLS_HASH_ALGORITHM_SHA256</td>
        </tr>
        <tr>
          <td id="L4860" data-line-number="4860"></td>
          <td id="LC4860">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4861" data-line-number="4861"></td>
          <td id="LC4861">        Case TLS_HASH_ALGORITHM_SHA384</td>
        </tr>
        <tr>
          <td id="L4862" data-line-number="4862"></td>
          <td id="LC4862">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4863" data-line-number="4863"></td>
          <td id="LC4863">        Case TLS_HASH_ALGORITHM_SHA512</td>
        </tr>
        <tr>
          <td id="L4864" data-line-number="4864"></td>
          <td id="LC4864">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L4865" data-line-number="4865"></td>
          <td id="LC4865">        End Select</td>
        </tr>
        <tr>
          <td id="L4866" data-line-number="4866"></td>
          <td id="LC4866">    Case Else</td>
        </tr>
        <tr>
          <td id="L4867" data-line-number="4867"></td>
          <td id="LC4867">        &#39;--- 8 - Intrinsic for TLS 1.3</td>
        </tr>
        <tr>
          <td id="L4868" data-line-number="4868"></td>
          <td id="LC4868">        Select Case lSignatureScheme</td>
        </tr>
        <tr>
          <td id="L4869" data-line-number="4869"></td>
          <td id="LC4869">        Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA256, TLS_SIGNATURE_RSA_PSS_PSS_SHA256</td>
        </tr>
        <tr>
          <td id="L4870" data-line-number="4870"></td>
          <td id="LC4870">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4871" data-line-number="4871"></td>
          <td id="LC4871">        Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA384, TLS_SIGNATURE_RSA_PSS_PSS_SHA384</td>
        </tr>
        <tr>
          <td id="L4872" data-line-number="4872"></td>
          <td id="LC4872">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4873" data-line-number="4873"></td>
          <td id="LC4873">        Case TLS_SIGNATURE_RSA_PSS_RSAE_SHA512, TLS_SIGNATURE_RSA_PSS_PSS_SHA512</td>
        </tr>
        <tr>
          <td id="L4874" data-line-number="4874"></td>
          <td id="LC4874">            pvTlsSignatureDigestAlgo = ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L4875" data-line-number="4875"></td>
          <td id="LC4875">        End Select</td>
        </tr>
        <tr>
          <td id="L4876" data-line-number="4876"></td>
          <td id="LC4876">    End Select</td>
        </tr>
        <tr>
          <td id="L4877" data-line-number="4877"></td>
          <td id="LC4877">End Function</td>
        </tr>
        <tr>
          <td id="L4878" data-line-number="4878"></td>
          <td id="LC4878">
</td>
        </tr>
        <tr>
          <td id="L4879" data-line-number="4879"></td>
          <td id="LC4879">Private Function pvTlsDigestHashSize(ByVal eDigestAlgo As UcsTlsCryptoAlgorithmsEnum) As Long</td>
        </tr>
        <tr>
          <td id="L4880" data-line-number="4880"></td>
          <td id="LC4880">    Select Case eDigestAlgo</td>
        </tr>
        <tr>
          <td id="L4881" data-line-number="4881"></td>
          <td id="LC4881">    Case ucsTlsAlgoDigestMd5</td>
        </tr>
        <tr>
          <td id="L4882" data-line-number="4882"></td>
          <td id="LC4882">        pvTlsDigestHashSize = LNG_MD5_HASHSZ</td>
        </tr>
        <tr>
          <td id="L4883" data-line-number="4883"></td>
          <td id="LC4883">    Case ucsTlsAlgoDigestSha1</td>
        </tr>
        <tr>
          <td id="L4884" data-line-number="4884"></td>
          <td id="LC4884">        pvTlsDigestHashSize = LNG_SHA1_HASHSZ</td>
        </tr>
        <tr>
          <td id="L4885" data-line-number="4885"></td>
          <td id="LC4885">    Case ucsTlsAlgoDigestSha224</td>
        </tr>
        <tr>
          <td id="L4886" data-line-number="4886"></td>
          <td id="LC4886">        pvTlsDigestHashSize = LNG_SHA224_HASHSZ</td>
        </tr>
        <tr>
          <td id="L4887" data-line-number="4887"></td>
          <td id="LC4887">    Case ucsTlsAlgoDigestSha256</td>
        </tr>
        <tr>
          <td id="L4888" data-line-number="4888"></td>
          <td id="LC4888">        pvTlsDigestHashSize = LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L4889" data-line-number="4889"></td>
          <td id="LC4889">    Case ucsTlsAlgoDigestSha384</td>
        </tr>
        <tr>
          <td id="L4890" data-line-number="4890"></td>
          <td id="LC4890">        pvTlsDigestHashSize = LNG_SHA384_HASHSZ</td>
        </tr>
        <tr>
          <td id="L4891" data-line-number="4891"></td>
          <td id="LC4891">    Case ucsTlsAlgoDigestSha512</td>
        </tr>
        <tr>
          <td id="L4892" data-line-number="4892"></td>
          <td id="LC4892">        pvTlsDigestHashSize = LNG_SHA512_HASHSZ</td>
        </tr>
        <tr>
          <td id="L4893" data-line-number="4893"></td>
          <td id="LC4893">    Case Else</td>
        </tr>
        <tr>
          <td id="L4894" data-line-number="4894"></td>
          <td id="LC4894">        &#39;--- do nothing</td>
        </tr>
        <tr>
          <td id="L4895" data-line-number="4895"></td>
          <td id="LC4895">    End Select</td>
        </tr>
        <tr>
          <td id="L4896" data-line-number="4896"></td>
          <td id="LC4896">End Function</td>
        </tr>
        <tr>
          <td id="L4897" data-line-number="4897"></td>
          <td id="LC4897">
</td>
        </tr>
        <tr>
          <td id="L4898" data-line-number="4898"></td>
          <td id="LC4898">&#39;= buffer management =====================================================</td>
        </tr>
        <tr>
          <td id="L4899" data-line-number="4899"></td>
          <td id="LC4899">
</td>
        </tr>
        <tr>
          <td id="L4900" data-line-number="4900"></td>
          <td id="LC4900">Private Sub pvBufferWriteRecordStart(uOutput As UcsBuffer, ByVal lContentType As Long, uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L4901" data-line-number="4901"></td>
          <td id="LC4901">    Dim lRecordPos      As Long</td>
        </tr>
        <tr>
          <td id="L4902" data-line-number="4902"></td>
          <td id="LC4902">    Dim baLocalIV()     As Byte</td>
        </tr>
        <tr>
          <td id="L4903" data-line-number="4903"></td>
          <td id="LC4903">    </td>
        </tr>
        <tr>
          <td id="L4904" data-line-number="4904"></td>
          <td id="LC4904">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4905" data-line-number="4905"></td>
          <td id="LC4905">        lRecordPos = uOutput.Size</td>
        </tr>
        <tr>
          <td id="L4906" data-line-number="4906"></td>
          <td id="LC4906">        &#39;--- Record Header</td>
        </tr>
        <tr>
          <td id="L4907" data-line-number="4907"></td>
          <td id="LC4907">        pvBufferWriteLong uOutput, lContentType</td>
        </tr>
        <tr>
          <td id="L4908" data-line-number="4908"></td>
          <td id="LC4908">        pvBufferWriteLong uOutput, TLS_RECORD_VERSION, Size:=2</td>
        </tr>
        <tr>
          <td id="L4909" data-line-number="4909"></td>
          <td id="LC4909">        pvBufferWriteBlockStart uOutput, Size:=2</td>
        </tr>
        <tr>
          <td id="L4910" data-line-number="4910"></td>
          <td id="LC4910">            If pvArraySize(.LocalTrafficKey) &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4911" data-line-number="4911"></td>
          <td id="LC4911">                pvArrayXor baLocalIV, .LocalTrafficIV, .LocalTrafficSeqNo</td>
        </tr>
        <tr>
          <td id="L4912" data-line-number="4912"></td>
          <td id="LC4912">                If .IvExplicitSize &gt; 0 Then &#39;--- AES in TLS 1.2</td>
        </tr>
        <tr>
          <td id="L4913" data-line-number="4913"></td>
          <td id="LC4913">                    pvBufferWriteBlob uOutput, VarPtr(baLocalIV(.IvSize - .IvExplicitSize)), .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L4914" data-line-number="4914"></td>
          <td id="LC4914">                End If</td>
        </tr>
        <tr>
          <td id="L4915" data-line-number="4915"></td>
          <td id="LC4915">                uOutput.Stack.Add Array(lRecordPos, uOutput.Size, baLocalIV), Before:=1</td>
        </tr>
        <tr>
          <td id="L4916" data-line-number="4916"></td>
          <td id="LC4916">                &#39;--- to be continued in end-of-record. . .</td>
        </tr>
        <tr>
          <td id="L4917" data-line-number="4917"></td>
          <td id="LC4917">            End If</td>
        </tr>
        <tr>
          <td id="L4918" data-line-number="4918"></td>
          <td id="LC4918">    End With</td>
        </tr>
        <tr>
          <td id="L4919" data-line-number="4919"></td>
          <td id="LC4919">End Sub</td>
        </tr>
        <tr>
          <td id="L4920" data-line-number="4920"></td>
          <td id="LC4920">
</td>
        </tr>
        <tr>
          <td id="L4921" data-line-number="4921"></td>
          <td id="LC4921">Private Sub pvBufferWriteRecordEnd(uOutput As UcsBuffer, uCtx As UcsTlsContext)</td>
        </tr>
        <tr>
          <td id="L4922" data-line-number="4922"></td>
          <td id="LC4922">    Const FUNC_NAME     As String = &#34;pvBufferWriteRecordEnd&#34;</td>
        </tr>
        <tr>
          <td id="L4923" data-line-number="4923"></td>
          <td id="LC4923">    Dim vRecordData     As Variant</td>
        </tr>
        <tr>
          <td id="L4924" data-line-number="4924"></td>
          <td id="LC4924">    Dim lRecordPos      As Long</td>
        </tr>
        <tr>
          <td id="L4925" data-line-number="4925"></td>
          <td id="LC4925">    Dim baLocalIV()     As Byte</td>
        </tr>
        <tr>
          <td id="L4926" data-line-number="4926"></td>
          <td id="LC4926">    Dim lMessagePos     As Long</td>
        </tr>
        <tr>
          <td id="L4927" data-line-number="4927"></td>
          <td id="LC4927">    Dim lMessageSize    As Long</td>
        </tr>
        <tr>
          <td id="L4928" data-line-number="4928"></td>
          <td id="LC4928">    Dim uAad            As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L4929" data-line-number="4929"></td>
          <td id="LC4929">    Dim baHmac()        As Byte</td>
        </tr>
        <tr>
          <td id="L4930" data-line-number="4930"></td>
          <td id="LC4930">    Dim lPadding        As Long</td>
        </tr>
        <tr>
          <td id="L4931" data-line-number="4931"></td>
          <td id="LC4931">    </td>
        </tr>
        <tr>
          <td id="L4932" data-line-number="4932"></td>
          <td id="LC4932">    With uCtx</td>
        </tr>
        <tr>
          <td id="L4933" data-line-number="4933"></td>
          <td id="LC4933">        If pvArraySize(.LocalTrafficKey) &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4934" data-line-number="4934"></td>
          <td id="LC4934">                &#39;--- . . . continues from start-of-record</td>
        </tr>
        <tr>
          <td id="L4935" data-line-number="4935"></td>
          <td id="LC4935">                vRecordData = uOutput.Stack.Item(1)</td>
        </tr>
        <tr>
          <td id="L4936" data-line-number="4936"></td>
          <td id="LC4936">                uOutput.Stack.Remove 1</td>
        </tr>
        <tr>
          <td id="L4937" data-line-number="4937"></td>
          <td id="LC4937">                lRecordPos = vRecordData(0)</td>
        </tr>
        <tr>
          <td id="L4938" data-line-number="4938"></td>
          <td id="LC4938">                lMessagePos = vRecordData(1)</td>
        </tr>
        <tr>
          <td id="L4939" data-line-number="4939"></td>
          <td id="LC4939">                baLocalIV = vRecordData(2)</td>
        </tr>
        <tr>
          <td id="L4940" data-line-number="4940"></td>
          <td id="LC4940">                lMessageSize = uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L4941" data-line-number="4941"></td>
          <td id="LC4941">                pvBufferWriteBlob uOutput, 0, .TagSize</td>
        </tr>
        <tr>
          <td id="L4942" data-line-number="4942"></td>
          <td id="LC4942">                If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L4943" data-line-number="4943"></td>
          <td id="LC4943">                    pvBufferWriteLong uAad, 0, Size:=4</td>
        </tr>
        <tr>
          <td id="L4944" data-line-number="4944"></td>
          <td id="LC4944">                    pvBufferWriteLong uAad, .LocalTrafficSeqNo, Size:=4</td>
        </tr>
        <tr>
          <td id="L4945" data-line-number="4945"></td>
          <td id="LC4945">                    pvBufferWriteBlob uAad, VarPtr(uOutput.Data(lRecordPos)), 3</td>
        </tr>
        <tr>
          <td id="L4946" data-line-number="4946"></td>
          <td id="LC4946">                    pvBufferWriteLong uAad, lMessageSize, Size:=2</td>
        </tr>
        <tr>
          <td id="L4947" data-line-number="4947"></td>
          <td id="LC4947">                    Debug.Assert uAad.Size = TLS_LEGACY_AAD_SIZE</td>
        </tr>
        <tr>
          <td id="L4948" data-line-number="4948"></td>
          <td id="LC4948">                    If .MacSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4949" data-line-number="4949"></td>
          <td id="LC4949">                        If Not .LocalEncryptThenMac Then</td>
        </tr>
        <tr>
          <td id="L4950" data-line-number="4950"></td>
          <td id="LC4950">                            pvBufferWriteBlob uAad, VarPtr(uOutput.Data(lMessagePos)), lMessageSize</td>
        </tr>
        <tr>
          <td id="L4951" data-line-number="4951"></td>
          <td id="LC4951">                            pvTlsGetHmac baHmac, .MacAlgo, .LocalMacKey, uAad.Data, 0, uAad.Size</td>
        </tr>
        <tr>
          <td id="L4952" data-line-number="4952"></td>
          <td id="LC4952">                            pvBufferWriteArray uOutput, baHmac</td>
        </tr>
        <tr>
          <td id="L4953" data-line-number="4953"></td>
          <td id="LC4953">                        Else</td>
        </tr>
        <tr>
          <td id="L4954" data-line-number="4954"></td>
          <td id="LC4954">                            pvArrayAllocate baHmac, .IvSize, FUNC_NAME &amp; &#34;.baHmac&#34;</td>
        </tr>
        <tr>
          <td id="L4955" data-line-number="4955"></td>
          <td id="LC4955">                        End If</td>
        </tr>
        <tr>
          <td id="L4956" data-line-number="4956"></td>
          <td id="LC4956">                        lPadding = .IvSize - (uOutput.Size - lMessagePos) Mod .IvSize</td>
        </tr>
        <tr>
          <td id="L4957" data-line-number="4957"></td>
          <td id="LC4957">                        Debug.Assert lPadding &lt;= pvArraySize(baHmac)</td>
        </tr>
        <tr>
          <td id="L4958" data-line-number="4958"></td>
          <td id="LC4958">                        Call FillMemory(baHmac(0), lPadding, lPadding - 1)</td>
        </tr>
        <tr>
          <td id="L4959" data-line-number="4959"></td>
          <td id="LC4959">                        pvBufferWriteBlob uOutput, VarPtr(baHmac(0)), lPadding</td>
        </tr>
        <tr>
          <td id="L4960" data-line-number="4960"></td>
          <td id="LC4960">                        lMessageSize = uOutput.Size - lMessagePos</td>
        </tr>
        <tr>
          <td id="L4961" data-line-number="4961"></td>
          <td id="LC4961">                        If .LocalEncryptThenMac Then</td>
        </tr>
        <tr>
          <td id="L4962" data-line-number="4962"></td>
          <td id="LC4962">                            pvBufferWriteBlob uOutput, 0, .MacSize</td>
        </tr>
        <tr>
          <td id="L4963" data-line-number="4963"></td>
          <td id="LC4963">                        End If</td>
        </tr>
        <tr>
          <td id="L4964" data-line-number="4964"></td>
          <td id="LC4964">                    End If</td>
        </tr>
        <tr>
          <td id="L4965" data-line-number="4965"></td>
          <td id="LC4965">                End If</td>
        </tr>
        <tr>
          <td id="L4966" data-line-number="4966"></td>
          <td id="LC4966">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L4967" data-line-number="4967"></td>
          <td id="LC4967">            #If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4968" data-line-number="4968"></td>
          <td id="LC4968">                If lMessageSize &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L4969" data-line-number="4969"></td>
          <td id="LC4969">                    .TrafficDump.Add FUNC_NAME &amp; &#34;.Output (unencrypted)&#34; &amp; vbCrLf &amp; TlsDesignDumpArray(uOutput.Data, lRecordPos, uOutput.Size - lRecordPos - .TagSize - .MacSize)</td>
        </tr>
        <tr>
          <td id="L4970" data-line-number="4970"></td>
          <td id="LC4970">                End If</td>
        </tr>
        <tr>
          <td id="L4971" data-line-number="4971"></td>
          <td id="LC4971">            #End If</td>
        </tr>
        <tr>
          <td id="L4972" data-line-number="4972"></td>
          <td id="LC4972">            If .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS13 Then</td>
        </tr>
        <tr>
          <td id="L4973" data-line-number="4973"></td>
          <td id="LC4973">                pvTlsBulkEncrypt .BulkAlgo, baLocalIV, .LocalTrafficKey, uOutput.Data, lRecordPos, TLS_AAD_SIZE, uOutput.Data, lMessagePos, lMessageSize</td>
        </tr>
        <tr>
          <td id="L4974" data-line-number="4974"></td>
          <td id="LC4974">            ElseIf .ProtocolVersion = TLS_PROTOCOL_VERSION_TLS12 Then</td>
        </tr>
        <tr>
          <td id="L4975" data-line-number="4975"></td>
          <td id="LC4975">                pvTlsBulkEncrypt .BulkAlgo, baLocalIV, .LocalTrafficKey, uAad.Data, 0, uAad.Size, uOutput.Data, lMessagePos, lMessageSize</td>
        </tr>
        <tr>
          <td id="L4976" data-line-number="4976"></td>
          <td id="LC4976">                If .LocalEncryptThenMac Then</td>
        </tr>
        <tr>
          <td id="L4977" data-line-number="4977"></td>
          <td id="LC4977">                    uAad.Size = uAad.Size - 2</td>
        </tr>
        <tr>
          <td id="L4978" data-line-number="4978"></td>
          <td id="LC4978">                    pvBufferWriteLong uAad, lMessageSize + .IvExplicitSize, Size:=2</td>
        </tr>
        <tr>
          <td id="L4979" data-line-number="4979"></td>
          <td id="LC4979">                    pvBufferWriteBlob uAad, VarPtr(uOutput.Data(lMessagePos - .IvExplicitSize)), lMessageSize + .IvExplicitSize</td>
        </tr>
        <tr>
          <td id="L4980" data-line-number="4980"></td>
          <td id="LC4980">                    pvTlsGetHmac baHmac, .MacAlgo, .LocalMacKey, uAad.Data, 0, uAad.Size</td>
        </tr>
        <tr>
          <td id="L4981" data-line-number="4981"></td>
          <td id="LC4981">                    uOutput.Size = uOutput.Size - .MacSize</td>
        </tr>
        <tr>
          <td id="L4982" data-line-number="4982"></td>
          <td id="LC4982">                    pvBufferWriteArray uOutput, baHmac</td>
        </tr>
        <tr>
          <td id="L4983" data-line-number="4983"></td>
          <td id="LC4983">                End If</td>
        </tr>
        <tr>
          <td id="L4984" data-line-number="4984"></td>
          <td id="LC4984">            End If</td>
        </tr>
        <tr>
          <td id="L4985" data-line-number="4985"></td>
          <td id="LC4985">            .LocalTrafficSeqNo = UnsignedAdd(.LocalTrafficSeqNo, 1)</td>
        </tr>
        <tr>
          <td id="L4986" data-line-number="4986"></td>
          <td id="LC4986">        Else</td>
        </tr>
        <tr>
          <td id="L4987" data-line-number="4987"></td>
          <td id="LC4987">            pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L4988" data-line-number="4988"></td>
          <td id="LC4988">        End If</td>
        </tr>
        <tr>
          <td id="L4989" data-line-number="4989"></td>
          <td id="LC4989">    End With</td>
        </tr>
        <tr>
          <td id="L4990" data-line-number="4990"></td>
          <td id="LC4990">End Sub</td>
        </tr>
        <tr>
          <td id="L4991" data-line-number="4991"></td>
          <td id="LC4991">
</td>
        </tr>
        <tr>
          <td id="L4992" data-line-number="4992"></td>
          <td id="LC4992">Private Sub pvBufferWriteBlockStart(uOutput As UcsBuffer, Optional ByVal Size As Long = 1)</td>
        </tr>
        <tr>
          <td id="L4993" data-line-number="4993"></td>
          <td id="LC4993">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L4994" data-line-number="4994"></td>
          <td id="LC4994">    </td>
        </tr>
        <tr>
          <td id="L4995" data-line-number="4995"></td>
          <td id="LC4995">    With uOutput</td>
        </tr>
        <tr>
          <td id="L4996" data-line-number="4996"></td>
          <td id="LC4996">        If .Stack Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L4997" data-line-number="4997"></td>
          <td id="LC4997">            Set .Stack = New Collection</td>
        </tr>
        <tr>
          <td id="L4998" data-line-number="4998"></td>
          <td id="LC4998">        End If</td>
        </tr>
        <tr>
          <td id="L4999" data-line-number="4999"></td>
          <td id="LC4999">        If .Stack.Count = 0 Then</td>
        </tr>
        <tr>
          <td id="L5000" data-line-number="5000"></td>
          <td id="LC5000">            .Stack.Add .Size</td>
        </tr>
        <tr>
          <td id="L5001" data-line-number="5001"></td>
          <td id="LC5001">        Else</td>
        </tr>
        <tr>
          <td id="L5002" data-line-number="5002"></td>
          <td id="LC5002">            .Stack.Add .Size, Before:=1</td>
        </tr>
        <tr>
          <td id="L5003" data-line-number="5003"></td>
          <td id="LC5003">        End If</td>
        </tr>
        <tr>
          <td id="L5004" data-line-number="5004"></td>
          <td id="LC5004">        lPos = .Size</td>
        </tr>
        <tr>
          <td id="L5005" data-line-number="5005"></td>
          <td id="LC5005">        pvBufferWriteBlob uOutput, 0, Size</td>
        </tr>
        <tr>
          <td id="L5006" data-line-number="5006"></td>
          <td id="LC5006">        &#39;--- note: keep Size in uOutput.Data</td>
        </tr>
        <tr>
          <td id="L5007" data-line-number="5007"></td>
          <td id="LC5007">        .Data(lPos) = (Size And &amp;HFF)</td>
        </tr>
        <tr>
          <td id="L5008" data-line-number="5008"></td>
          <td id="LC5008">    End With</td>
        </tr>
        <tr>
          <td id="L5009" data-line-number="5009"></td>
          <td id="LC5009">End Sub</td>
        </tr>
        <tr>
          <td id="L5010" data-line-number="5010"></td>
          <td id="LC5010">
</td>
        </tr>
        <tr>
          <td id="L5011" data-line-number="5011"></td>
          <td id="LC5011">Private Sub pvBufferWriteBlockEnd(uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L5012" data-line-number="5012"></td>
          <td id="LC5012">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L5013" data-line-number="5013"></td>
          <td id="LC5013">    </td>
        </tr>
        <tr>
          <td id="L5014" data-line-number="5014"></td>
          <td id="LC5014">    With uOutput</td>
        </tr>
        <tr>
          <td id="L5015" data-line-number="5015"></td>
          <td id="LC5015">        lPos = .Size</td>
        </tr>
        <tr>
          <td id="L5016" data-line-number="5016"></td>
          <td id="LC5016">        .Size = .Stack.Item(1)</td>
        </tr>
        <tr>
          <td id="L5017" data-line-number="5017"></td>
          <td id="LC5017">        .Stack.Remove 1</td>
        </tr>
        <tr>
          <td id="L5018" data-line-number="5018"></td>
          <td id="LC5018">        pvBufferWriteLong uOutput, lPos - .Size - .Data(.Size), Size:=.Data(.Size)</td>
        </tr>
        <tr>
          <td id="L5019" data-line-number="5019"></td>
          <td id="LC5019">        .Size = lPos</td>
        </tr>
        <tr>
          <td id="L5020" data-line-number="5020"></td>
          <td id="LC5020">    End With</td>
        </tr>
        <tr>
          <td id="L5021" data-line-number="5021"></td>
          <td id="LC5021">End Sub</td>
        </tr>
        <tr>
          <td id="L5022" data-line-number="5022"></td>
          <td id="LC5022">
</td>
        </tr>
        <tr>
          <td id="L5023" data-line-number="5023"></td>
          <td id="LC5023">Private Sub pvBufferWriteString(uOutput As UcsBuffer, sValue As String)</td>
        </tr>
        <tr>
          <td id="L5024" data-line-number="5024"></td>
          <td id="LC5024">    pvBufferWriteArray uOutput, StrConv(sValue, vbFromUnicode)</td>
        </tr>
        <tr>
          <td id="L5025" data-line-number="5025"></td>
          <td id="LC5025">End Sub</td>
        </tr>
        <tr>
          <td id="L5026" data-line-number="5026"></td>
          <td id="LC5026">
</td>
        </tr>
        <tr>
          <td id="L5027" data-line-number="5027"></td>
          <td id="LC5027">Private Sub pvBufferWriteArray(uOutput As UcsBuffer, baSrc() As Byte)</td>
        </tr>
        <tr>
          <td id="L5028" data-line-number="5028"></td>
          <td id="LC5028">    Dim lSize       As Long</td>
        </tr>
        <tr>
          <td id="L5029" data-line-number="5029"></td>
          <td id="LC5029">    </td>
        </tr>
        <tr>
          <td id="L5030" data-line-number="5030"></td>
          <td id="LC5030">    With uOutput</td>
        </tr>
        <tr>
          <td id="L5031" data-line-number="5031"></td>
          <td id="LC5031">        lSize = pvArraySize(baSrc)</td>
        </tr>
        <tr>
          <td id="L5032" data-line-number="5032"></td>
          <td id="LC5032">        If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5033" data-line-number="5033"></td>
          <td id="LC5033">            .Size = pvArrayWriteBlob(.Data, .Size, VarPtr(baSrc(0)), lSize)</td>
        </tr>
        <tr>
          <td id="L5034" data-line-number="5034"></td>
          <td id="LC5034">        End If</td>
        </tr>
        <tr>
          <td id="L5035" data-line-number="5035"></td>
          <td id="LC5035">    End With</td>
        </tr>
        <tr>
          <td id="L5036" data-line-number="5036"></td>
          <td id="LC5036">End Sub</td>
        </tr>
        <tr>
          <td id="L5037" data-line-number="5037"></td>
          <td id="LC5037">
</td>
        </tr>
        <tr>
          <td id="L5038" data-line-number="5038"></td>
          <td id="LC5038">Private Sub pvBufferWriteLong(uOutput As UcsBuffer, ByVal lValue As Long, Optional ByVal Size As Long = 1)</td>
        </tr>
        <tr>
          <td id="L5039" data-line-number="5039"></td>
          <td id="LC5039">    Static baTemp(0 To 3) As Byte</td>
        </tr>
        <tr>
          <td id="L5040" data-line-number="5040"></td>
          <td id="LC5040">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L5041" data-line-number="5041"></td>
          <td id="LC5041">
</td>
        </tr>
        <tr>
          <td id="L5042" data-line-number="5042"></td>
          <td id="LC5042">    With uOutput</td>
        </tr>
        <tr>
          <td id="L5043" data-line-number="5043"></td>
          <td id="LC5043">        If Size &lt;= 1 Then</td>
        </tr>
        <tr>
          <td id="L5044" data-line-number="5044"></td>
          <td id="LC5044">            pvBufferWriteBlob uOutput, VarPtr(lValue), Size</td>
        </tr>
        <tr>
          <td id="L5045" data-line-number="5045"></td>
          <td id="LC5045">        Else</td>
        </tr>
        <tr>
          <td id="L5046" data-line-number="5046"></td>
          <td id="LC5046">            lPos = .Size</td>
        </tr>
        <tr>
          <td id="L5047" data-line-number="5047"></td>
          <td id="LC5047">            pvBufferWriteBlob uOutput, 0, Size</td>
        </tr>
        <tr>
          <td id="L5048" data-line-number="5048"></td>
          <td id="LC5048">            Call CopyMemory(baTemp(0), lValue, LenB(lValue))</td>
        </tr>
        <tr>
          <td id="L5049" data-line-number="5049"></td>
          <td id="LC5049">            .Data(lPos + 0) = baTemp(Size - 1)</td>
        </tr>
        <tr>
          <td id="L5050" data-line-number="5050"></td>
          <td id="LC5050">            .Data(lPos + 1) = baTemp(Size - 2)</td>
        </tr>
        <tr>
          <td id="L5051" data-line-number="5051"></td>
          <td id="LC5051">            If Size &gt;= 3 Then .Data(lPos + 2) = baTemp(Size - 3)</td>
        </tr>
        <tr>
          <td id="L5052" data-line-number="5052"></td>
          <td id="LC5052">            If Size &gt;= 4 Then .Data(lPos + 3) = baTemp(Size - 4)</td>
        </tr>
        <tr>
          <td id="L5053" data-line-number="5053"></td>
          <td id="LC5053">        End If</td>
        </tr>
        <tr>
          <td id="L5054" data-line-number="5054"></td>
          <td id="LC5054">    End With</td>
        </tr>
        <tr>
          <td id="L5055" data-line-number="5055"></td>
          <td id="LC5055">End Sub</td>
        </tr>
        <tr>
          <td id="L5056" data-line-number="5056"></td>
          <td id="LC5056">
</td>
        </tr>
        <tr>
          <td id="L5057" data-line-number="5057"></td>
          <td id="LC5057">Private Sub pvBufferWriteBlob(uOutput As UcsBuffer, ByVal lPtr As Long, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L5058" data-line-number="5058"></td>
          <td id="LC5058">    uOutput.Size = pvArrayWriteBlob(uOutput.Data, uOutput.Size, lPtr, lSize)</td>
        </tr>
        <tr>
          <td id="L5059" data-line-number="5059"></td>
          <td id="LC5059">End Sub</td>
        </tr>
        <tr>
          <td id="L5060" data-line-number="5060"></td>
          <td id="LC5060">
</td>
        </tr>
        <tr>
          <td id="L5061" data-line-number="5061"></td>
          <td id="LC5061">Private Function pvArrayWriteBlob(baBuffer() As Byte, ByVal lPos As Long, ByVal lPtr As Long, ByVal lSize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L5062" data-line-number="5062"></td>
          <td id="LC5062">    Const FUNC_NAME     As String = &#34;pvArrayWriteBlob&#34;</td>
        </tr>
        <tr>
          <td id="L5063" data-line-number="5063"></td>
          <td id="LC5063">    Dim lBufPtr         As Long</td>
        </tr>
        <tr>
          <td id="L5064" data-line-number="5064"></td>
          <td id="LC5064">    </td>
        </tr>
        <tr>
          <td id="L5065" data-line-number="5065"></td>
          <td id="LC5065">    &#39;--- peek long at ArrPtr(baBuffer)</td>
        </tr>
        <tr>
          <td id="L5066" data-line-number="5066"></td>
          <td id="LC5066">    Call CopyMemory(lBufPtr, ByVal ArrPtr(baBuffer), LenB(lBufPtr))</td>
        </tr>
        <tr>
          <td id="L5067" data-line-number="5067"></td>
          <td id="LC5067">    If lBufPtr = 0 Then</td>
        </tr>
        <tr>
          <td id="L5068" data-line-number="5068"></td>
          <td id="LC5068">        pvArrayAllocate baBuffer, Clamp(lPos + lSize, 256), FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L5069" data-line-number="5069"></td>
          <td id="LC5069">    ElseIf UBound(baBuffer) &lt; lPos + lSize - 1 Then</td>
        </tr>
        <tr>
          <td id="L5070" data-line-number="5070"></td>
          <td id="LC5070">        pvArrayReallocate baBuffer, lPos + lSize, FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L5071" data-line-number="5071"></td>
          <td id="LC5071">    End If</td>
        </tr>
        <tr>
          <td id="L5072" data-line-number="5072"></td>
          <td id="LC5072">    If lSize &gt; 0 And lPtr &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5073" data-line-number="5073"></td>
          <td id="LC5073">        Debug.Assert IsBadReadPtr(lPtr, lSize) = 0</td>
        </tr>
        <tr>
          <td id="L5074" data-line-number="5074"></td>
          <td id="LC5074">        Call CopyMemory(baBuffer(lPos), ByVal lPtr, lSize)</td>
        </tr>
        <tr>
          <td id="L5075" data-line-number="5075"></td>
          <td id="LC5075">    End If</td>
        </tr>
        <tr>
          <td id="L5076" data-line-number="5076"></td>
          <td id="LC5076">    pvArrayWriteBlob = lPos + lSize</td>
        </tr>
        <tr>
          <td id="L5077" data-line-number="5077"></td>
          <td id="LC5077">End Function</td>
        </tr>
        <tr>
          <td id="L5078" data-line-number="5078"></td>
          <td id="LC5078">
</td>
        </tr>
        <tr>
          <td id="L5079" data-line-number="5079"></td>
          <td id="LC5079">Private Sub pvBufferWriteEOF(uOutput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L5080" data-line-number="5080"></td>
          <td id="LC5080">    uOutput.Size = pvArrayWriteEOF(uOutput.Data, uOutput.Size)</td>
        </tr>
        <tr>
          <td id="L5081" data-line-number="5081"></td>
          <td id="LC5081">End Sub</td>
        </tr>
        <tr>
          <td id="L5082" data-line-number="5082"></td>
          <td id="LC5082">
</td>
        </tr>
        <tr>
          <td id="L5083" data-line-number="5083"></td>
          <td id="LC5083">Private Function pvArrayWriteEOF(baBuffer() As Byte, ByVal lPos As Long) As Long</td>
        </tr>
        <tr>
          <td id="L5084" data-line-number="5084"></td>
          <td id="LC5084">    Const FUNC_NAME     As String = &#34;pvArrayWriteEOF&#34;</td>
        </tr>
        <tr>
          <td id="L5085" data-line-number="5085"></td>
          <td id="LC5085">    </td>
        </tr>
        <tr>
          <td id="L5086" data-line-number="5086"></td>
          <td id="LC5086">    If pvArraySize(baBuffer) &lt;&gt; lPos Then</td>
        </tr>
        <tr>
          <td id="L5087" data-line-number="5087"></td>
          <td id="LC5087">        pvArrayReallocate baBuffer, lPos, FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L5088" data-line-number="5088"></td>
          <td id="LC5088">    End If</td>
        </tr>
        <tr>
          <td id="L5089" data-line-number="5089"></td>
          <td id="LC5089">End Function</td>
        </tr>
        <tr>
          <td id="L5090" data-line-number="5090"></td>
          <td id="LC5090">
</td>
        </tr>
        <tr>
          <td id="L5091" data-line-number="5091"></td>
          <td id="LC5091">Private Sub pvBufferReadBlockStart(uInput As UcsBuffer, Optional ByVal Size As Long = 1, Optional BlockSize As Long)</td>
        </tr>
        <tr>
          <td id="L5092" data-line-number="5092"></td>
          <td id="LC5092">    With uInput</td>
        </tr>
        <tr>
          <td id="L5093" data-line-number="5093"></td>
          <td id="LC5093">        If .Stack Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L5094" data-line-number="5094"></td>
          <td id="LC5094">            Set .Stack = New Collection</td>
        </tr>
        <tr>
          <td id="L5095" data-line-number="5095"></td>
          <td id="LC5095">        End If</td>
        </tr>
        <tr>
          <td id="L5096" data-line-number="5096"></td>
          <td id="LC5096">        pvBufferReadLong uInput, BlockSize, Size</td>
        </tr>
        <tr>
          <td id="L5097" data-line-number="5097"></td>
          <td id="LC5097">        If .Stack.Count = 0 Then</td>
        </tr>
        <tr>
          <td id="L5098" data-line-number="5098"></td>
          <td id="LC5098">            .Stack.Add uInput.Pos + BlockSize</td>
        </tr>
        <tr>
          <td id="L5099" data-line-number="5099"></td>
          <td id="LC5099">        Else</td>
        </tr>
        <tr>
          <td id="L5100" data-line-number="5100"></td>
          <td id="LC5100">            .Stack.Add uInput.Pos + BlockSize, Before:=1</td>
        </tr>
        <tr>
          <td id="L5101" data-line-number="5101"></td>
          <td id="LC5101">        End If</td>
        </tr>
        <tr>
          <td id="L5102" data-line-number="5102"></td>
          <td id="LC5102">    End With</td>
        </tr>
        <tr>
          <td id="L5103" data-line-number="5103"></td>
          <td id="LC5103">End Sub</td>
        </tr>
        <tr>
          <td id="L5104" data-line-number="5104"></td>
          <td id="LC5104">
</td>
        </tr>
        <tr>
          <td id="L5105" data-line-number="5105"></td>
          <td id="LC5105">Private Sub pvBufferReadBlockEnd(uInput As UcsBuffer)</td>
        </tr>
        <tr>
          <td id="L5106" data-line-number="5106"></td>
          <td id="LC5106">    Dim lEnd          As Long</td>
        </tr>
        <tr>
          <td id="L5107" data-line-number="5107"></td>
          <td id="LC5107">    </td>
        </tr>
        <tr>
          <td id="L5108" data-line-number="5108"></td>
          <td id="LC5108">    With uInput</td>
        </tr>
        <tr>
          <td id="L5109" data-line-number="5109"></td>
          <td id="LC5109">        lEnd = .Stack.Item(1)</td>
        </tr>
        <tr>
          <td id="L5110" data-line-number="5110"></td>
          <td id="LC5110">        .Stack.Remove 1</td>
        </tr>
        <tr>
          <td id="L5111" data-line-number="5111"></td>
          <td id="LC5111">        Debug.Assert .Pos = lEnd</td>
        </tr>
        <tr>
          <td id="L5112" data-line-number="5112"></td>
          <td id="LC5112">    End With</td>
        </tr>
        <tr>
          <td id="L5113" data-line-number="5113"></td>
          <td id="LC5113">End Sub</td>
        </tr>
        <tr>
          <td id="L5114" data-line-number="5114"></td>
          <td id="LC5114">
</td>
        </tr>
        <tr>
          <td id="L5115" data-line-number="5115"></td>
          <td id="LC5115">Private Sub pvBufferReadLong(uInput As UcsBuffer, lValue As Long, Optional ByVal Size As Long = 1)</td>
        </tr>
        <tr>
          <td id="L5116" data-line-number="5116"></td>
          <td id="LC5116">    Static baTemp(0 To 3) As Byte</td>
        </tr>
        <tr>
          <td id="L5117" data-line-number="5117"></td>
          <td id="LC5117">    </td>
        </tr>
        <tr>
          <td id="L5118" data-line-number="5118"></td>
          <td id="LC5118">    lValue = 0</td>
        </tr>
        <tr>
          <td id="L5119" data-line-number="5119"></td>
          <td id="LC5119">    With uInput</td>
        </tr>
        <tr>
          <td id="L5120" data-line-number="5120"></td>
          <td id="LC5120">        If .Pos + Size &lt;= pvArraySize(.Data) Then</td>
        </tr>
        <tr>
          <td id="L5121" data-line-number="5121"></td>
          <td id="LC5121">            If Size &lt;= 1 Then</td>
        </tr>
        <tr>
          <td id="L5122" data-line-number="5122"></td>
          <td id="LC5122">                lValue = .Data(.Pos)</td>
        </tr>
        <tr>
          <td id="L5123" data-line-number="5123"></td>
          <td id="LC5123">            Else</td>
        </tr>
        <tr>
          <td id="L5124" data-line-number="5124"></td>
          <td id="LC5124">                baTemp(Size - 1) = .Data(.Pos + 0)</td>
        </tr>
        <tr>
          <td id="L5125" data-line-number="5125"></td>
          <td id="LC5125">                baTemp(Size - 2) = .Data(.Pos + 1)</td>
        </tr>
        <tr>
          <td id="L5126" data-line-number="5126"></td>
          <td id="LC5126">                If Size &gt;= 3 Then baTemp(Size - 3) = .Data(.Pos + 2)</td>
        </tr>
        <tr>
          <td id="L5127" data-line-number="5127"></td>
          <td id="LC5127">                If Size &gt;= 4 Then baTemp(Size - 4) = .Data(.Pos + 3)</td>
        </tr>
        <tr>
          <td id="L5128" data-line-number="5128"></td>
          <td id="LC5128">                Call CopyMemory(lValue, baTemp(0), Size)</td>
        </tr>
        <tr>
          <td id="L5129" data-line-number="5129"></td>
          <td id="LC5129">            End If</td>
        </tr>
        <tr>
          <td id="L5130" data-line-number="5130"></td>
          <td id="LC5130">        End If</td>
        </tr>
        <tr>
          <td id="L5131" data-line-number="5131"></td>
          <td id="LC5131">        .Pos = .Pos + Size</td>
        </tr>
        <tr>
          <td id="L5132" data-line-number="5132"></td>
          <td id="LC5132">    End With</td>
        </tr>
        <tr>
          <td id="L5133" data-line-number="5133"></td>
          <td id="LC5133">End Sub</td>
        </tr>
        <tr>
          <td id="L5134" data-line-number="5134"></td>
          <td id="LC5134">
</td>
        </tr>
        <tr>
          <td id="L5135" data-line-number="5135"></td>
          <td id="LC5135">Private Sub pvBufferReadBlob(uInput As UcsBuffer, ByVal lPtr As Long, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L5136" data-line-number="5136"></td>
          <td id="LC5136">    Dim baDest()        As Byte</td>
        </tr>
        <tr>
          <td id="L5137" data-line-number="5137"></td>
          <td id="LC5137">    </td>
        </tr>
        <tr>
          <td id="L5138" data-line-number="5138"></td>
          <td id="LC5138">    pvBufferReadArray uInput, baDest, lSize</td>
        </tr>
        <tr>
          <td id="L5139" data-line-number="5139"></td>
          <td id="LC5139">    lSize = pvArraySize(baDest)</td>
        </tr>
        <tr>
          <td id="L5140" data-line-number="5140"></td>
          <td id="LC5140">    If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5141" data-line-number="5141"></td>
          <td id="LC5141">        Call CopyMemory(ByVal lPtr, baDest(0), lSize)</td>
        </tr>
        <tr>
          <td id="L5142" data-line-number="5142"></td>
          <td id="LC5142">    End If</td>
        </tr>
        <tr>
          <td id="L5143" data-line-number="5143"></td>
          <td id="LC5143">End Sub</td>
        </tr>
        <tr>
          <td id="L5144" data-line-number="5144"></td>
          <td id="LC5144">
</td>
        </tr>
        <tr>
          <td id="L5145" data-line-number="5145"></td>
          <td id="LC5145">Private Sub pvBufferReadArray(uInput As UcsBuffer, baDest() As Byte, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L5146" data-line-number="5146"></td>
          <td id="LC5146">    Const FUNC_NAME     As String = &#34;pvBufferReadArray&#34;</td>
        </tr>
        <tr>
          <td id="L5147" data-line-number="5147"></td>
          <td id="LC5147">    </td>
        </tr>
        <tr>
          <td id="L5148" data-line-number="5148"></td>
          <td id="LC5148">    With uInput</td>
        </tr>
        <tr>
          <td id="L5149" data-line-number="5149"></td>
          <td id="LC5149">        If lSize &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5150" data-line-number="5150"></td>
          <td id="LC5150">            lSize = pvArraySize(.Data) - .Pos</td>
        </tr>
        <tr>
          <td id="L5151" data-line-number="5151"></td>
          <td id="LC5151">        End If</td>
        </tr>
        <tr>
          <td id="L5152" data-line-number="5152"></td>
          <td id="LC5152">        If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5153" data-line-number="5153"></td>
          <td id="LC5153">            pvArrayAllocate baDest, lSize, FUNC_NAME &amp; &#34;.baDest&#34;</td>
        </tr>
        <tr>
          <td id="L5154" data-line-number="5154"></td>
          <td id="LC5154">            If .Pos + lSize &lt;= pvArraySize(.Data) Then</td>
        </tr>
        <tr>
          <td id="L5155" data-line-number="5155"></td>
          <td id="LC5155">                Call CopyMemory(baDest(0), .Data(.Pos), lSize)</td>
        </tr>
        <tr>
          <td id="L5156" data-line-number="5156"></td>
          <td id="LC5156">            ElseIf .Pos &lt; pvArraySize(.Data) Then</td>
        </tr>
        <tr>
          <td id="L5157" data-line-number="5157"></td>
          <td id="LC5157">                Call CopyMemory(baDest(0), .Data(.Pos), pvArraySize(.Data) - .Pos)</td>
        </tr>
        <tr>
          <td id="L5158" data-line-number="5158"></td>
          <td id="LC5158">            End If</td>
        </tr>
        <tr>
          <td id="L5159" data-line-number="5159"></td>
          <td id="LC5159">        Else</td>
        </tr>
        <tr>
          <td id="L5160" data-line-number="5160"></td>
          <td id="LC5160">            Erase baDest</td>
        </tr>
        <tr>
          <td id="L5161" data-line-number="5161"></td>
          <td id="LC5161">        End If</td>
        </tr>
        <tr>
          <td id="L5162" data-line-number="5162"></td>
          <td id="LC5162">        .Pos = .Pos + lSize</td>
        </tr>
        <tr>
          <td id="L5163" data-line-number="5163"></td>
          <td id="LC5163">    End With</td>
        </tr>
        <tr>
          <td id="L5164" data-line-number="5164"></td>
          <td id="LC5164">End Sub</td>
        </tr>
        <tr>
          <td id="L5165" data-line-number="5165"></td>
          <td id="LC5165">
</td>
        </tr>
        <tr>
          <td id="L5166" data-line-number="5166"></td>
          <td id="LC5166">Private Sub pvBufferReadString(uInput As UcsBuffer, sValue As String, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L5167" data-line-number="5167"></td>
          <td id="LC5167">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L5168" data-line-number="5168"></td>
          <td id="LC5168">    </td>
        </tr>
        <tr>
          <td id="L5169" data-line-number="5169"></td>
          <td id="LC5169">    pvBufferReadArray uInput, baTemp(), lSize</td>
        </tr>
        <tr>
          <td id="L5170" data-line-number="5170"></td>
          <td id="LC5170">    sValue = StrConv(baTemp, vbUnicode)</td>
        </tr>
        <tr>
          <td id="L5171" data-line-number="5171"></td>
          <td id="LC5171">End Sub</td>
        </tr>
        <tr>
          <td id="L5172" data-line-number="5172"></td>
          <td id="LC5172">
</td>
        </tr>
        <tr>
          <td id="L5173" data-line-number="5173"></td>
          <td id="LC5173">&#39;= arrays helpers ========================================================</td>
        </tr>
        <tr>
          <td id="L5174" data-line-number="5174"></td>
          <td id="LC5174">
</td>
        </tr>
        <tr>
          <td id="L5175" data-line-number="5175"></td>
          <td id="LC5175">Private Sub pvArrayAllocate(baRetVal() As Byte, ByVal lSize As Long, sFuncName As String)</td>
        </tr>
        <tr>
          <td id="L5176" data-line-number="5176"></td>
          <td id="LC5176">    If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5177" data-line-number="5177"></td>
          <td id="LC5177">        ReDim baRetVal(0 To lSize - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L5178" data-line-number="5178"></td>
          <td id="LC5178">    Else</td>
        </tr>
        <tr>
          <td id="L5179" data-line-number="5179"></td>
          <td id="LC5179">        baRetVal = vbNullString</td>
        </tr>
        <tr>
          <td id="L5180" data-line-number="5180"></td>
          <td id="LC5180">    End If</td>
        </tr>
        <tr>
          <td id="L5181" data-line-number="5181"></td>
          <td id="LC5181">    Debug.Assert RedimStats(MODULE_NAME &amp; &#34;.&#34; &amp; sFuncName, UBound(baRetVal) + 1)</td>
        </tr>
        <tr>
          <td id="L5182" data-line-number="5182"></td>
          <td id="LC5182">End Sub</td>
        </tr>
        <tr>
          <td id="L5183" data-line-number="5183"></td>
          <td id="LC5183">
</td>
        </tr>
        <tr>
          <td id="L5184" data-line-number="5184"></td>
          <td id="LC5184">Private Sub pvArrayReallocate(baArray() As Byte, ByVal lSize As Long, sFuncName As String)</td>
        </tr>
        <tr>
          <td id="L5185" data-line-number="5185"></td>
          <td id="LC5185">    If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5186" data-line-number="5186"></td>
          <td id="LC5186">        ReDim Preserve baArray(0 To lSize - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L5187" data-line-number="5187"></td>
          <td id="LC5187">    Else</td>
        </tr>
        <tr>
          <td id="L5188" data-line-number="5188"></td>
          <td id="LC5188">        baArray = vbNullString</td>
        </tr>
        <tr>
          <td id="L5189" data-line-number="5189"></td>
          <td id="LC5189">    End If</td>
        </tr>
        <tr>
          <td id="L5190" data-line-number="5190"></td>
          <td id="LC5190">    Debug.Assert RedimStats(MODULE_NAME &amp; &#34;.&#34; &amp; sFuncName, UBound(baArray) + 1)</td>
        </tr>
        <tr>
          <td id="L5191" data-line-number="5191"></td>
          <td id="LC5191">End Sub</td>
        </tr>
        <tr>
          <td id="L5192" data-line-number="5192"></td>
          <td id="LC5192">
</td>
        </tr>
        <tr>
          <td id="L5193" data-line-number="5193"></td>
          <td id="LC5193">Private Property Get pvArraySize(baArray() As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L5194" data-line-number="5194"></td>
          <td id="LC5194">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L5195" data-line-number="5195"></td>
          <td id="LC5195">    </td>
        </tr>
        <tr>
          <td id="L5196" data-line-number="5196"></td>
          <td id="LC5196">    &#39;--- peek long at ArrPtr(baArray)</td>
        </tr>
        <tr>
          <td id="L5197" data-line-number="5197"></td>
          <td id="LC5197">    Call CopyMemory(lPtr, ByVal ArrPtr(baArray), LenB(lPtr))</td>
        </tr>
        <tr>
          <td id="L5198" data-line-number="5198"></td>
          <td id="LC5198">    If lPtr &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5199" data-line-number="5199"></td>
          <td id="LC5199">        pvArraySize = UBound(baArray) + 1</td>
        </tr>
        <tr>
          <td id="L5200" data-line-number="5200"></td>
          <td id="LC5200">    End If</td>
        </tr>
        <tr>
          <td id="L5201" data-line-number="5201"></td>
          <td id="LC5201">End Property</td>
        </tr>
        <tr>
          <td id="L5202" data-line-number="5202"></td>
          <td id="LC5202">
</td>
        </tr>
        <tr>
          <td id="L5203" data-line-number="5203"></td>
          <td id="LC5203">Private Sub pvArrayXor(baRetVal() As Byte, baArray() As Byte, ByVal lSeqNo As Long)</td>
        </tr>
        <tr>
          <td id="L5204" data-line-number="5204"></td>
          <td id="LC5204">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5205" data-line-number="5205"></td>
          <td id="LC5205">    </td>
        </tr>
        <tr>
          <td id="L5206" data-line-number="5206"></td>
          <td id="LC5206">    baRetVal = baArray</td>
        </tr>
        <tr>
          <td id="L5207" data-line-number="5207"></td>
          <td id="LC5207">    lIdx = pvArraySize(baRetVal)</td>
        </tr>
        <tr>
          <td id="L5208" data-line-number="5208"></td>
          <td id="LC5208">    Do While lSeqNo &lt;&gt; 0 And lIdx &gt; 0</td>
        </tr>
        <tr>
          <td id="L5209" data-line-number="5209"></td>
          <td id="LC5209">        lIdx = lIdx - 1</td>
        </tr>
        <tr>
          <td id="L5210" data-line-number="5210"></td>
          <td id="LC5210">        baRetVal(lIdx) = baRetVal(lIdx) Xor (lSeqNo And &amp;HFF)</td>
        </tr>
        <tr>
          <td id="L5211" data-line-number="5211"></td>
          <td id="LC5211">        lSeqNo = (lSeqNo And -&amp;H100&amp;) \ &amp;H100&amp;</td>
        </tr>
        <tr>
          <td id="L5212" data-line-number="5212"></td>
          <td id="LC5212">    Loop</td>
        </tr>
        <tr>
          <td id="L5213" data-line-number="5213"></td>
          <td id="LC5213">End Sub</td>
        </tr>
        <tr>
          <td id="L5214" data-line-number="5214"></td>
          <td id="LC5214">
</td>
        </tr>
        <tr>
          <td id="L5215" data-line-number="5215"></td>
          <td id="LC5215">Private Sub pvArraySwap(baBuffer() As Byte, lBufferPos As Long, baInput() As Byte, lInputPos As Long)</td>
        </tr>
        <tr>
          <td id="L5216" data-line-number="5216"></td>
          <td id="LC5216">    Dim lTemp           As Long</td>
        </tr>
        <tr>
          <td id="L5217" data-line-number="5217"></td>
          <td id="LC5217">    </td>
        </tr>
        <tr>
          <td id="L5218" data-line-number="5218"></td>
          <td id="LC5218">    Call CopyMemory(lTemp, ByVal ArrPtr(baBuffer), LenB(lTemp))</td>
        </tr>
        <tr>
          <td id="L5219" data-line-number="5219"></td>
          <td id="LC5219">    Call CopyMemory(ByVal ArrPtr(baBuffer), ByVal ArrPtr(baInput), LenB(lTemp))</td>
        </tr>
        <tr>
          <td id="L5220" data-line-number="5220"></td>
          <td id="LC5220">    Call CopyMemory(ByVal ArrPtr(baInput), lTemp, LenB(lTemp))</td>
        </tr>
        <tr>
          <td id="L5221" data-line-number="5221"></td>
          <td id="LC5221">    lTemp = lBufferPos</td>
        </tr>
        <tr>
          <td id="L5222" data-line-number="5222"></td>
          <td id="LC5222">    lBufferPos = lInputPos</td>
        </tr>
        <tr>
          <td id="L5223" data-line-number="5223"></td>
          <td id="LC5223">    lInputPos = lTemp</td>
        </tr>
        <tr>
          <td id="L5224" data-line-number="5224"></td>
          <td id="LC5224">End Sub</td>
        </tr>
        <tr>
          <td id="L5225" data-line-number="5225"></td>
          <td id="LC5225">
</td>
        </tr>
        <tr>
          <td id="L5226" data-line-number="5226"></td>
          <td id="LC5226">Private Sub pvArrayByte(baRetVal() As Byte, ParamArray A() As Variant)</td>
        </tr>
        <tr>
          <td id="L5227" data-line-number="5227"></td>
          <td id="LC5227">    Const FUNC_NAME     As String = &#34;pvArrayByte&#34;</td>
        </tr>
        <tr>
          <td id="L5228" data-line-number="5228"></td>
          <td id="LC5228">    Dim vElem           As Variant</td>
        </tr>
        <tr>
          <td id="L5229" data-line-number="5229"></td>
          <td id="LC5229">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5230" data-line-number="5230"></td>
          <td id="LC5230">    </td>
        </tr>
        <tr>
          <td id="L5231" data-line-number="5231"></td>
          <td id="LC5231">    If UBound(A) &gt;= 0 Then</td>
        </tr>
        <tr>
          <td id="L5232" data-line-number="5232"></td>
          <td id="LC5232">        pvArrayAllocate baRetVal, UBound(A) + 1, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L5233" data-line-number="5233"></td>
          <td id="LC5233">        For Each vElem In A</td>
        </tr>
        <tr>
          <td id="L5234" data-line-number="5234"></td>
          <td id="LC5234">            baRetVal(lIdx) = vElem And &amp;HFF</td>
        </tr>
        <tr>
          <td id="L5235" data-line-number="5235"></td>
          <td id="LC5235">            lIdx = lIdx + 1</td>
        </tr>
        <tr>
          <td id="L5236" data-line-number="5236"></td>
          <td id="LC5236">        Next</td>
        </tr>
        <tr>
          <td id="L5237" data-line-number="5237"></td>
          <td id="LC5237">    End If</td>
        </tr>
        <tr>
          <td id="L5238" data-line-number="5238"></td>
          <td id="LC5238">End Sub</td>
        </tr>
        <tr>
          <td id="L5239" data-line-number="5239"></td>
          <td id="LC5239">
</td>
        </tr>
        <tr>
          <td id="L5240" data-line-number="5240"></td>
          <td id="LC5240">Private Sub pvArrayHash(ByVal lHashSize As Long, baInput() As Byte, baRetVal() As Byte)</td>
        </tr>
        <tr>
          <td id="L5241" data-line-number="5241"></td>
          <td id="LC5241">    Const FUNC_NAME     As String = &#34;pvArrayHash&#34;</td>
        </tr>
        <tr>
          <td id="L5242" data-line-number="5242"></td>
          <td id="LC5242">    </td>
        </tr>
        <tr>
          <td id="L5243" data-line-number="5243"></td>
          <td id="LC5243">    Select Case lHashSize</td>
        </tr>
        <tr>
          <td id="L5244" data-line-number="5244"></td>
          <td id="LC5244">    Case LNG_SHA1_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5245" data-line-number="5245"></td>
          <td id="LC5245">        If Not pvCryptoHashSha1(baRetVal, baInput) Then</td>
        </tr>
        <tr>
          <td id="L5246" data-line-number="5246"></td>
          <td id="LC5246">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha1&#34;)</td>
        </tr>
        <tr>
          <td id="L5247" data-line-number="5247"></td>
          <td id="LC5247">        End If</td>
        </tr>
        <tr>
          <td id="L5248" data-line-number="5248"></td>
          <td id="LC5248">    Case LNG_SHA224_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5249" data-line-number="5249"></td>
          <td id="LC5249">        If Not pvCryptoHashSha224(baRetVal, baInput) Then</td>
        </tr>
        <tr>
          <td id="L5250" data-line-number="5250"></td>
          <td id="LC5250">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha224&#34;)</td>
        </tr>
        <tr>
          <td id="L5251" data-line-number="5251"></td>
          <td id="LC5251">        End If</td>
        </tr>
        <tr>
          <td id="L5252" data-line-number="5252"></td>
          <td id="LC5252">    Case LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5253" data-line-number="5253"></td>
          <td id="LC5253">        If Not pvCryptoHashSha256(baRetVal, baInput) Then</td>
        </tr>
        <tr>
          <td id="L5254" data-line-number="5254"></td>
          <td id="LC5254">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha256&#34;)</td>
        </tr>
        <tr>
          <td id="L5255" data-line-number="5255"></td>
          <td id="LC5255">        End If</td>
        </tr>
        <tr>
          <td id="L5256" data-line-number="5256"></td>
          <td id="LC5256">    Case LNG_SHA384_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5257" data-line-number="5257"></td>
          <td id="LC5257">        If Not pvCryptoHashSha384(baRetVal, baInput) Then</td>
        </tr>
        <tr>
          <td id="L5258" data-line-number="5258"></td>
          <td id="LC5258">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha384&#34;)</td>
        </tr>
        <tr>
          <td id="L5259" data-line-number="5259"></td>
          <td id="LC5259">        End If</td>
        </tr>
        <tr>
          <td id="L5260" data-line-number="5260"></td>
          <td id="LC5260">    Case LNG_SHA512_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5261" data-line-number="5261"></td>
          <td id="LC5261">        If Not pvCryptoHashSha512(baRetVal, baInput) Then</td>
        </tr>
        <tr>
          <td id="L5262" data-line-number="5262"></td>
          <td id="LC5262">            ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_CALL_FAILED, &#34;%1&#34;, &#34;CryptoHashSha512&#34;)</td>
        </tr>
        <tr>
          <td id="L5263" data-line-number="5263"></td>
          <td id="LC5263">        End If</td>
        </tr>
        <tr>
          <td id="L5264" data-line-number="5264"></td>
          <td id="LC5264">    Case Else</td>
        </tr>
        <tr>
          <td id="L5265" data-line-number="5265"></td>
          <td id="LC5265">        ErrRaise vbObjectError, FUNC_NAME, Replace(ERR_INVALID_HASH_SIZE, &#34;%1&#34;, lHashSize)</td>
        </tr>
        <tr>
          <td id="L5266" data-line-number="5266"></td>
          <td id="LC5266">    End Select</td>
        </tr>
        <tr>
          <td id="L5267" data-line-number="5267"></td>
          <td id="LC5267">End Sub</td>
        </tr>
        <tr>
          <td id="L5268" data-line-number="5268"></td>
          <td id="LC5268">
</td>
        </tr>
        <tr>
          <td id="L5269" data-line-number="5269"></td>
          <td id="LC5269">Private Sub pvArrayIncCounter(baInput() As Byte, ByVal lPos As Long)</td>
        </tr>
        <tr>
          <td id="L5270" data-line-number="5270"></td>
          <td id="LC5270">    Do While lPos &gt;= 0</td>
        </tr>
        <tr>
          <td id="L5271" data-line-number="5271"></td>
          <td id="LC5271">        If baInput(lPos) &lt; 255 Then</td>
        </tr>
        <tr>
          <td id="L5272" data-line-number="5272"></td>
          <td id="LC5272">            baInput(lPos) = baInput(lPos) + 1</td>
        </tr>
        <tr>
          <td id="L5273" data-line-number="5273"></td>
          <td id="LC5273">            Exit Do</td>
        </tr>
        <tr>
          <td id="L5274" data-line-number="5274"></td>
          <td id="LC5274">        Else</td>
        </tr>
        <tr>
          <td id="L5275" data-line-number="5275"></td>
          <td id="LC5275">            baInput(lPos) = 0</td>
        </tr>
        <tr>
          <td id="L5276" data-line-number="5276"></td>
          <td id="LC5276">            lPos = lPos - 1</td>
        </tr>
        <tr>
          <td id="L5277" data-line-number="5277"></td>
          <td id="LC5277">        End If</td>
        </tr>
        <tr>
          <td id="L5278" data-line-number="5278"></td>
          <td id="LC5278">    Loop</td>
        </tr>
        <tr>
          <td id="L5279" data-line-number="5279"></td>
          <td id="LC5279">End Sub</td>
        </tr>
        <tr>
          <td id="L5280" data-line-number="5280"></td>
          <td id="LC5280">
</td>
        </tr>
        <tr>
          <td id="L5281" data-line-number="5281"></td>
          <td id="LC5281">Private Sub pvArrayReverse(baData() As Byte, Optional ByVal NewSize As Long = -1)</td>
        </tr>
        <tr>
          <td id="L5282" data-line-number="5282"></td>
          <td id="LC5282">    Const FUNC_NAME     As String = &#34;pvArrayReverse&#34;</td>
        </tr>
        <tr>
          <td id="L5283" data-line-number="5283"></td>
          <td id="LC5283">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5284" data-line-number="5284"></td>
          <td id="LC5284">    Dim bTemp           As Byte</td>
        </tr>
        <tr>
          <td id="L5285" data-line-number="5285"></td>
          <td id="LC5285">    Dim baCopy()        As Byte</td>
        </tr>
        <tr>
          <td id="L5286" data-line-number="5286"></td>
          <td id="LC5286">    </td>
        </tr>
        <tr>
          <td id="L5287" data-line-number="5287"></td>
          <td id="LC5287">    If NewSize = 0 Then</td>
        </tr>
        <tr>
          <td id="L5288" data-line-number="5288"></td>
          <td id="LC5288">        baData = vbNullString</td>
        </tr>
        <tr>
          <td id="L5289" data-line-number="5289"></td>
          <td id="LC5289">    ElseIf NewSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5290" data-line-number="5290"></td>
          <td id="LC5290">        baCopy = baData</td>
        </tr>
        <tr>
          <td id="L5291" data-line-number="5291"></td>
          <td id="LC5291">        pvArrayAllocate baData, NewSize, FUNC_NAME &amp; &#34;.baData&#34;</td>
        </tr>
        <tr>
          <td id="L5292" data-line-number="5292"></td>
          <td id="LC5292">        Call CopyMemory(baData(0), baCopy(0), IIf(NewSize &lt; UBound(baCopy) + 1, NewSize, UBound(baCopy) + 1))</td>
        </tr>
        <tr>
          <td id="L5293" data-line-number="5293"></td>
          <td id="LC5293">    End If</td>
        </tr>
        <tr>
          <td id="L5294" data-line-number="5294"></td>
          <td id="LC5294">    For lIdx = 0 To UBound(baData) \ 2</td>
        </tr>
        <tr>
          <td id="L5295" data-line-number="5295"></td>
          <td id="LC5295">        bTemp = baData(lIdx)</td>
        </tr>
        <tr>
          <td id="L5296" data-line-number="5296"></td>
          <td id="LC5296">        baData(lIdx) = baData(UBound(baData) - lIdx)</td>
        </tr>
        <tr>
          <td id="L5297" data-line-number="5297"></td>
          <td id="LC5297">        baData(UBound(baData) - lIdx) = bTemp</td>
        </tr>
        <tr>
          <td id="L5298" data-line-number="5298"></td>
          <td id="LC5298">    Next</td>
        </tr>
        <tr>
          <td id="L5299" data-line-number="5299"></td>
          <td id="LC5299">End Sub</td>
        </tr>
        <tr>
          <td id="L5300" data-line-number="5300"></td>
          <td id="LC5300">
</td>
        </tr>
        <tr>
          <td id="L5301" data-line-number="5301"></td>
          <td id="LC5301">Private Function pvArrayAccumulateOr(baData() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Byte</td>
        </tr>
        <tr>
          <td id="L5302" data-line-number="5302"></td>
          <td id="LC5302">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5303" data-line-number="5303"></td>
          <td id="LC5303">    </td>
        </tr>
        <tr>
          <td id="L5304" data-line-number="5304"></td>
          <td id="LC5304">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5305" data-line-number="5305"></td>
          <td id="LC5305">        Size = pvArraySize(baData)</td>
        </tr>
        <tr>
          <td id="L5306" data-line-number="5306"></td>
          <td id="LC5306">    End If</td>
        </tr>
        <tr>
          <td id="L5307" data-line-number="5307"></td>
          <td id="LC5307">    For lIdx = Pos To Size - 1</td>
        </tr>
        <tr>
          <td id="L5308" data-line-number="5308"></td>
          <td id="LC5308">        pvArrayAccumulateOr = pvArrayAccumulateOr Or baData(lIdx)</td>
        </tr>
        <tr>
          <td id="L5309" data-line-number="5309"></td>
          <td id="LC5309">    Next</td>
        </tr>
        <tr>
          <td id="L5310" data-line-number="5310"></td>
          <td id="LC5310">End Function</td>
        </tr>
        <tr>
          <td id="L5311" data-line-number="5311"></td>
          <td id="LC5311">
</td>
        </tr>
        <tr>
          <td id="L5312" data-line-number="5312"></td>
          <td id="LC5312">Private Function pvArrayEqual(baFirst() As Byte, baSecond() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L5313" data-line-number="5313"></td>
          <td id="LC5313">    If pvArraySize(baFirst) = pvArraySize(baSecond) Then</td>
        </tr>
        <tr>
          <td id="L5314" data-line-number="5314"></td>
          <td id="LC5314">        pvArrayEqual = (InStrB(baFirst, baSecond) = 1)</td>
        </tr>
        <tr>
          <td id="L5315" data-line-number="5315"></td>
          <td id="LC5315">    End If</td>
        </tr>
        <tr>
          <td id="L5316" data-line-number="5316"></td>
          <td id="LC5316">End Function</td>
        </tr>
        <tr>
          <td id="L5317" data-line-number="5317"></td>
          <td id="LC5317">
</td>
        </tr>
        <tr>
          <td id="L5318" data-line-number="5318"></td>
          <td id="LC5318">Private Function pvToStringA(ByVal lPtr As Long) As String</td>
        </tr>
        <tr>
          <td id="L5319" data-line-number="5319"></td>
          <td id="LC5319">    If lPtr &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5320" data-line-number="5320"></td>
          <td id="LC5320">        pvToStringA = String$(lstrlenA(lPtr), 0)</td>
        </tr>
        <tr>
          <td id="L5321" data-line-number="5321"></td>
          <td id="LC5321">        Call CopyMemory(ByVal pvToStringA, ByVal lPtr, Len(pvToStringA))</td>
        </tr>
        <tr>
          <td id="L5322" data-line-number="5322"></td>
          <td id="LC5322">    End If</td>
        </tr>
        <tr>
          <td id="L5323" data-line-number="5323"></td>
          <td id="LC5323">End Function</td>
        </tr>
        <tr>
          <td id="L5324" data-line-number="5324"></td>
          <td id="LC5324">
</td>
        </tr>
        <tr>
          <td id="L5325" data-line-number="5325"></td>
          <td id="LC5325">Private Function pvCollectionCount(oCol As Collection) As Long</td>
        </tr>
        <tr>
          <td id="L5326" data-line-number="5326"></td>
          <td id="LC5326">    If Not oCol Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L5327" data-line-number="5327"></td>
          <td id="LC5327">        pvCollectionCount = oCol.Count</td>
        </tr>
        <tr>
          <td id="L5328" data-line-number="5328"></td>
          <td id="LC5328">    End If</td>
        </tr>
        <tr>
          <td id="L5329" data-line-number="5329"></td>
          <td id="LC5329">End Function</td>
        </tr>
        <tr>
          <td id="L5330" data-line-number="5330"></td>
          <td id="LC5330">
</td>
        </tr>
        <tr>
          <td id="L5331" data-line-number="5331"></td>
          <td id="LC5331">Private Function pvCollectionFirst(oCol As Collection, vKeys As Variant) As Variant</td>
        </tr>
        <tr>
          <td id="L5332" data-line-number="5332"></td>
          <td id="LC5332">    Dim vElem       As Variant</td>
        </tr>
        <tr>
          <td id="L5333" data-line-number="5333"></td>
          <td id="LC5333">    </td>
        </tr>
        <tr>
          <td id="L5334" data-line-number="5334"></td>
          <td id="LC5334">    For Each vElem In vKeys</td>
        </tr>
        <tr>
          <td id="L5335" data-line-number="5335"></td>
          <td id="LC5335">        If SearchCollection(oCol, vElem, RetVal:=pvCollectionFirst) Then</td>
        </tr>
        <tr>
          <td id="L5336" data-line-number="5336"></td>
          <td id="LC5336">            Exit For</td>
        </tr>
        <tr>
          <td id="L5337" data-line-number="5337"></td>
          <td id="LC5337">        End If</td>
        </tr>
        <tr>
          <td id="L5338" data-line-number="5338"></td>
          <td id="LC5338">    Next</td>
        </tr>
        <tr>
          <td id="L5339" data-line-number="5339"></td>
          <td id="LC5339">End Function</td>
        </tr>
        <tr>
          <td id="L5340" data-line-number="5340"></td>
          <td id="LC5340">
</td>
        </tr>
        <tr>
          <td id="L5341" data-line-number="5341"></td>
          <td id="LC5341">Private Function pvToHex(ByVal lPtr As Long, ByVal lSize As Long) As String</td>
        </tr>
        <tr>
          <td id="L5342" data-line-number="5342"></td>
          <td id="LC5342">    Const FUNC_NAME     As String = &#34;pvToHex&#34;</td>
        </tr>
        <tr>
          <td id="L5343" data-line-number="5343"></td>
          <td id="LC5343">    Dim aText()         As String</td>
        </tr>
        <tr>
          <td id="L5344" data-line-number="5344"></td>
          <td id="LC5344">    Dim lByte           As Long</td>
        </tr>
        <tr>
          <td id="L5345" data-line-number="5345"></td>
          <td id="LC5345">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5346" data-line-number="5346"></td>
          <td id="LC5346">    </td>
        </tr>
        <tr>
          <td id="L5347" data-line-number="5347"></td>
          <td id="LC5347">    If lSize &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5348" data-line-number="5348"></td>
          <td id="LC5348">        ReDim aText(0 To lSize - 1) As String</td>
        </tr>
        <tr>
          <td id="L5349" data-line-number="5349"></td>
          <td id="LC5349">        Debug.Assert RedimStats(FUNC_NAME &amp; &#34;.aText&#34;, 0)</td>
        </tr>
        <tr>
          <td id="L5350" data-line-number="5350"></td>
          <td id="LC5350">        For lIdx = 0 To lSize - 1</td>
        </tr>
        <tr>
          <td id="L5351" data-line-number="5351"></td>
          <td id="LC5351">            Call CopyMemory(lByte, ByVal lPtr, 1)</td>
        </tr>
        <tr>
          <td id="L5352" data-line-number="5352"></td>
          <td id="LC5352">            lPtr = (lPtr Xor &amp;H80000000) + 1 Xor &amp;H80000000</td>
        </tr>
        <tr>
          <td id="L5353" data-line-number="5353"></td>
          <td id="LC5353">            aText(lIdx) = Right$(&#34;0&#34; &amp; Hex$(lByte), 2)</td>
        </tr>
        <tr>
          <td id="L5354" data-line-number="5354"></td>
          <td id="LC5354">        Next</td>
        </tr>
        <tr>
          <td id="L5355" data-line-number="5355"></td>
          <td id="LC5355">        pvToHex = Join(aText, vbNullString)</td>
        </tr>
        <tr>
          <td id="L5356" data-line-number="5356"></td>
          <td id="LC5356">    End If</td>
        </tr>
        <tr>
          <td id="L5357" data-line-number="5357"></td>
          <td id="LC5357">End Function</td>
        </tr>
        <tr>
          <td id="L5358" data-line-number="5358"></td>
          <td id="LC5358">
</td>
        </tr>
        <tr>
          <td id="L5359" data-line-number="5359"></td>
          <td id="LC5359">Private Function pvIsValidServerName(sName As String) As Boolean</td>
        </tr>
        <tr>
          <td id="L5360" data-line-number="5360"></td>
          <td id="LC5360">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5361" data-line-number="5361"></td>
          <td id="LC5361">    </td>
        </tr>
        <tr>
          <td id="L5362" data-line-number="5362"></td>
          <td id="LC5362">    For lIdx = 1 To Len(sName)</td>
        </tr>
        <tr>
          <td id="L5363" data-line-number="5363"></td>
          <td id="LC5363">        Select Case AscW(Mid$(sName, lIdx, 1))</td>
        </tr>
        <tr>
          <td id="L5364" data-line-number="5364"></td>
          <td id="LC5364">        Case 65 To 90, 97 To 122, 48 To 57, 45, 46  &#39;--- A-Z, a-z, 0-9, &#34;-&#34;, &#34;.&#34;</td>
        </tr>
        <tr>
          <td id="L5365" data-line-number="5365"></td>
          <td id="LC5365">            &#39;--- do nothing</td>
        </tr>
        <tr>
          <td id="L5366" data-line-number="5366"></td>
          <td id="LC5366">        Case Else</td>
        </tr>
        <tr>
          <td id="L5367" data-line-number="5367"></td>
          <td id="LC5367">            Exit Function</td>
        </tr>
        <tr>
          <td id="L5368" data-line-number="5368"></td>
          <td id="LC5368">        End Select</td>
        </tr>
        <tr>
          <td id="L5369" data-line-number="5369"></td>
          <td id="LC5369">    Next</td>
        </tr>
        <tr>
          <td id="L5370" data-line-number="5370"></td>
          <td id="LC5370">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5371" data-line-number="5371"></td>
          <td id="LC5371">    pvIsValidServerName = True</td>
        </tr>
        <tr>
          <td id="L5372" data-line-number="5372"></td>
          <td id="LC5372">End Function</td>
        </tr>
        <tr>
          <td id="L5373" data-line-number="5373"></td>
          <td id="LC5373">
</td>
        </tr>
        <tr>
          <td id="L5374" data-line-number="5374"></td>
          <td id="LC5374">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L5375" data-line-number="5375"></td>
          <td id="LC5375">&#39; Crypto</td>
        </tr>
        <tr>
          <td id="L5376" data-line-number="5376"></td>
          <td id="LC5376">&#39;=========================================================================</td>
        </tr>
        <tr>
          <td id="L5377" data-line-number="5377"></td>
          <td id="LC5377">
</td>
        </tr>
        <tr>
          <td id="L5378" data-line-number="5378"></td>
          <td id="LC5378">Private Function pvCryptoIsSupported(ByVal eAlgo As UcsTlsCryptoAlgorithmsEnum) As Boolean</td>
        </tr>
        <tr>
          <td id="L5379" data-line-number="5379"></td>
          <td id="LC5379">    Const PREF          As Long = &amp;H1000</td>
        </tr>
        <tr>
          <td id="L5380" data-line-number="5380"></td>
          <td id="LC5380">    </td>
        </tr>
        <tr>
          <td id="L5381" data-line-number="5381"></td>
          <td id="LC5381">    Select Case eAlgo</td>
        </tr>
        <tr>
          <td id="L5382" data-line-number="5382"></td>
          <td id="LC5382">    Case ucsTlsAlgoExchSecp521r1</td>
        </tr>
        <tr>
          <td id="L5383" data-line-number="5383"></td>
          <td id="LC5383">        &#39;--- not supported</td>
        </tr>
        <tr>
          <td id="L5384" data-line-number="5384"></td>
          <td id="LC5384">    Case ucsTlsAlgoBulkAesGcm128, ucsTlsAlgoBulkAesGcm256</td>
        </tr>
        <tr>
          <td id="L5385" data-line-number="5385"></td>
          <td id="LC5385">        pvCryptoIsSupported = True</td>
        </tr>
        <tr>
          <td id="L5386" data-line-number="5386"></td>
          <td id="LC5386">    Case ucsTlsAlgoBulkChacha20Poly1305</td>
        </tr>
        <tr>
          <td id="L5387" data-line-number="5387"></td>
          <td id="LC5387">        pvCryptoIsSupported = True</td>
        </tr>
        <tr>
          <td id="L5388" data-line-number="5388"></td>
          <td id="LC5388">    Case PREF + ucsTlsAlgoBulkAesGcm128, PREF + ucsTlsAlgoBulkAesGcm256</td>
        </tr>
        <tr>
          <td id="L5389" data-line-number="5389"></td>
          <td id="LC5389">        &#39;--- signal if AES preferred over Chacha20</td>
        </tr>
        <tr>
          <td id="L5390" data-line-number="5390"></td>
          <td id="LC5390">        pvCryptoIsSupported = True</td>
        </tr>
        <tr>
          <td id="L5391" data-line-number="5391"></td>
          <td id="LC5391">    Case Else</td>
        </tr>
        <tr>
          <td id="L5392" data-line-number="5392"></td>
          <td id="LC5392">        pvCryptoIsSupported = True</td>
        </tr>
        <tr>
          <td id="L5393" data-line-number="5393"></td>
          <td id="LC5393">    End Select</td>
        </tr>
        <tr>
          <td id="L5394" data-line-number="5394"></td>
          <td id="LC5394">End Function</td>
        </tr>
        <tr>
          <td id="L5395" data-line-number="5395"></td>
          <td id="LC5395">
</td>
        </tr>
        <tr>
          <td id="L5396" data-line-number="5396"></td>
          <td id="LC5396">Private Function pvCryptoEmePkcs1Encode(baRetVal() As Byte, baMessage() As Byte, ByVal lBitLen As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5397" data-line-number="5397"></td>
          <td id="LC5397">    Const FUNC_NAME     As String = &#34;CryptoEmePkcs1Encode&#34;</td>
        </tr>
        <tr>
          <td id="L5398" data-line-number="5398"></td>
          <td id="LC5398">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5399" data-line-number="5399"></td>
          <td id="LC5399">    </td>
        </tr>
        <tr>
          <td id="L5400" data-line-number="5400"></td>
          <td id="LC5400">    &#39;--- from RFC 8017, Section  7.2.1</td>
        </tr>
        <tr>
          <td id="L5401" data-line-number="5401"></td>
          <td id="LC5401">    pvArrayAllocate baRetVal, (lBitLen + 7) \ 8, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L5402" data-line-number="5402"></td>
          <td id="LC5402">    If UBound(baMessage) &gt; UBound(baRetVal) - 11 Then</td>
        </tr>
        <tr>
          <td id="L5403" data-line-number="5403"></td>
          <td id="LC5403">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5404" data-line-number="5404"></td>
          <td id="LC5404">    End If</td>
        </tr>
        <tr>
          <td id="L5405" data-line-number="5405"></td>
          <td id="LC5405">    baRetVal(1) = 2</td>
        </tr>
        <tr>
          <td id="L5406" data-line-number="5406"></td>
          <td id="LC5406">    pvCryptoRandomBytes VarPtr(baRetVal(2)), UBound(baRetVal) - UBound(baMessage) - 3</td>
        </tr>
        <tr>
          <td id="L5407" data-line-number="5407"></td>
          <td id="LC5407">    For lIdx = 2 To UBound(baRetVal) - UBound(baMessage) - 3</td>
        </tr>
        <tr>
          <td id="L5408" data-line-number="5408"></td>
          <td id="LC5408">        If baRetVal(lIdx) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5409" data-line-number="5409"></td>
          <td id="LC5409">            baRetVal(lIdx) = 42</td>
        </tr>
        <tr>
          <td id="L5410" data-line-number="5410"></td>
          <td id="LC5410">        End If</td>
        </tr>
        <tr>
          <td id="L5411" data-line-number="5411"></td>
          <td id="LC5411">    Next</td>
        </tr>
        <tr>
          <td id="L5412" data-line-number="5412"></td>
          <td id="LC5412">    Call CopyMemory(baRetVal(UBound(baRetVal) - UBound(baMessage)), baMessage(0), UBound(baMessage) + 1)</td>
        </tr>
        <tr>
          <td id="L5413" data-line-number="5413"></td>
          <td id="LC5413">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5414" data-line-number="5414"></td>
          <td id="LC5414">    pvCryptoEmePkcs1Encode = True</td>
        </tr>
        <tr>
          <td id="L5415" data-line-number="5415"></td>
          <td id="LC5415">QH:</td>
        </tr>
        <tr>
          <td id="L5416" data-line-number="5416"></td>
          <td id="LC5416">End Function</td>
        </tr>
        <tr>
          <td id="L5417" data-line-number="5417"></td>
          <td id="LC5417">
</td>
        </tr>
        <tr>
          <td id="L5418" data-line-number="5418"></td>
          <td id="LC5418">Private Function pvCryptoEmePkcs1Decode(baRetVal() As Byte, baMessage() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L5419" data-line-number="5419"></td>
          <td id="LC5419">    Const FUNC_NAME     As String = &#34;CryptoEmePkcs1Decode&#34;</td>
        </tr>
        <tr>
          <td id="L5420" data-line-number="5420"></td>
          <td id="LC5420">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5421" data-line-number="5421"></td>
          <td id="LC5421">    </td>
        </tr>
        <tr>
          <td id="L5422" data-line-number="5422"></td>
          <td id="LC5422">    If baMessage(0) &lt;&gt; 0 Or baMessage(1) &lt;&gt; 2 Then</td>
        </tr>
        <tr>
          <td id="L5423" data-line-number="5423"></td>
          <td id="LC5423">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5424" data-line-number="5424"></td>
          <td id="LC5424">    End If</td>
        </tr>
        <tr>
          <td id="L5425" data-line-number="5425"></td>
          <td id="LC5425">    For lIdx = 2 To UBound(baMessage)</td>
        </tr>
        <tr>
          <td id="L5426" data-line-number="5426"></td>
          <td id="LC5426">        If baMessage(lIdx) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5427" data-line-number="5427"></td>
          <td id="LC5427">            lIdx = lIdx + 1</td>
        </tr>
        <tr>
          <td id="L5428" data-line-number="5428"></td>
          <td id="LC5428">            Exit For</td>
        </tr>
        <tr>
          <td id="L5429" data-line-number="5429"></td>
          <td id="LC5429">        End If</td>
        </tr>
        <tr>
          <td id="L5430" data-line-number="5430"></td>
          <td id="LC5430">    Next</td>
        </tr>
        <tr>
          <td id="L5431" data-line-number="5431"></td>
          <td id="LC5431">    If lIdx &gt; UBound(baMessage) Then</td>
        </tr>
        <tr>
          <td id="L5432" data-line-number="5432"></td>
          <td id="LC5432">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5433" data-line-number="5433"></td>
          <td id="LC5433">    End If</td>
        </tr>
        <tr>
          <td id="L5434" data-line-number="5434"></td>
          <td id="LC5434">    pvArrayAllocate baRetVal, UBound(baMessage) + 1 - lIdx, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L5435" data-line-number="5435"></td>
          <td id="LC5435">    Call CopyMemory(baRetVal(0), baMessage(lIdx), UBound(baRetVal) + 1)</td>
        </tr>
        <tr>
          <td id="L5436" data-line-number="5436"></td>
          <td id="LC5436">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5437" data-line-number="5437"></td>
          <td id="LC5437">    pvCryptoEmePkcs1Decode = True</td>
        </tr>
        <tr>
          <td id="L5438" data-line-number="5438"></td>
          <td id="LC5438">QH:</td>
        </tr>
        <tr>
          <td id="L5439" data-line-number="5439"></td>
          <td id="LC5439">End Function</td>
        </tr>
        <tr>
          <td id="L5440" data-line-number="5440"></td>
          <td id="LC5440">
</td>
        </tr>
        <tr>
          <td id="L5441" data-line-number="5441"></td>
          <td id="LC5441">Private Function pvCryptoEmsaPkcs1Encode(baRetVal() As Byte, baMessage() As Byte, ByVal lBitLen As Long, ByVal lHashSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5442" data-line-number="5442"></td>
          <td id="LC5442">    Const FUNC_NAME     As String = &#34;CryptoEmsaPkcs1Encode&#34;</td>
        </tr>
        <tr>
          <td id="L5443" data-line-number="5443"></td>
          <td id="LC5443">    Dim baHash()        As Byte</td>
        </tr>
        <tr>
          <td id="L5444" data-line-number="5444"></td>
          <td id="LC5444">    Dim baDerHash()     As Byte</td>
        </tr>
        <tr>
          <td id="L5445" data-line-number="5445"></td>
          <td id="LC5445">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L5446" data-line-number="5446"></td>
          <td id="LC5446">    </td>
        </tr>
        <tr>
          <td id="L5447" data-line-number="5447"></td>
          <td id="LC5447">    &#39;--- from RFC 8017, Section 9.2.</td>
        </tr>
        <tr>
          <td id="L5448" data-line-number="5448"></td>
          <td id="LC5448">    pvArrayHash lHashSize, baMessage, baHash</td>
        </tr>
        <tr>
          <td id="L5449" data-line-number="5449"></td>
          <td id="LC5449">    If Not pvAsn1EncodePkcs1Signature(baHash, baDerHash) Then</td>
        </tr>
        <tr>
          <td id="L5450" data-line-number="5450"></td>
          <td id="LC5450">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5451" data-line-number="5451"></td>
          <td id="LC5451">    End If</td>
        </tr>
        <tr>
          <td id="L5452" data-line-number="5452"></td>
          <td id="LC5452">    pvArrayAllocate baRetVal, (lBitLen + 7) \ 8, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L5453" data-line-number="5453"></td>
          <td id="LC5453">    baRetVal(1) = 1</td>
        </tr>
        <tr>
          <td id="L5454" data-line-number="5454"></td>
          <td id="LC5454">    For lPos = 2 To UBound(baRetVal) - UBound(baDerHash) - 2</td>
        </tr>
        <tr>
          <td id="L5455" data-line-number="5455"></td>
          <td id="LC5455">        baRetVal(lPos) = &amp;HFF</td>
        </tr>
        <tr>
          <td id="L5456" data-line-number="5456"></td>
          <td id="LC5456">    Next</td>
        </tr>
        <tr>
          <td id="L5457" data-line-number="5457"></td>
          <td id="LC5457">    lPos = lPos + 1</td>
        </tr>
        <tr>
          <td id="L5458" data-line-number="5458"></td>
          <td id="LC5458">    Debug.Assert UBound(baRetVal) - lPos &gt;= UBound(baDerHash)</td>
        </tr>
        <tr>
          <td id="L5459" data-line-number="5459"></td>
          <td id="LC5459">    Call CopyMemory(baRetVal(lPos), baDerHash(0), UBound(baDerHash) + 1)</td>
        </tr>
        <tr>
          <td id="L5460" data-line-number="5460"></td>
          <td id="LC5460">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5461" data-line-number="5461"></td>
          <td id="LC5461">    pvCryptoEmsaPkcs1Encode = True</td>
        </tr>
        <tr>
          <td id="L5462" data-line-number="5462"></td>
          <td id="LC5462">QH:</td>
        </tr>
        <tr>
          <td id="L5463" data-line-number="5463"></td>
          <td id="LC5463">End Function</td>
        </tr>
        <tr>
          <td id="L5464" data-line-number="5464"></td>
          <td id="LC5464">
</td>
        </tr>
        <tr>
          <td id="L5465" data-line-number="5465"></td>
          <td id="LC5465">Private Function pvCryptoEmsaPkcs1Decode(baMessage() As Byte, baEnc() As Byte, ByVal lHashSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5466" data-line-number="5466"></td>
          <td id="LC5466">    Dim baHash()        As Byte</td>
        </tr>
        <tr>
          <td id="L5467" data-line-number="5467"></td>
          <td id="LC5467">    Dim baDerHash()     As Byte</td>
        </tr>
        <tr>
          <td id="L5468" data-line-number="5468"></td>
          <td id="LC5468">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5469" data-line-number="5469"></td>
          <td id="LC5469">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L5470" data-line-number="5470"></td>
          <td id="LC5470">    </td>
        </tr>
        <tr>
          <td id="L5471" data-line-number="5471"></td>
          <td id="LC5471">    If baEnc(0) &lt;&gt; &amp;H0 Or baEnc(1) &lt;&gt; &amp;H1 Then</td>
        </tr>
        <tr>
          <td id="L5472" data-line-number="5472"></td>
          <td id="LC5472">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5473" data-line-number="5473"></td>
          <td id="LC5473">    End If</td>
        </tr>
        <tr>
          <td id="L5474" data-line-number="5474"></td>
          <td id="LC5474">    pvArrayHash lHashSize, baMessage, baHash</td>
        </tr>
        <tr>
          <td id="L5475" data-line-number="5475"></td>
          <td id="LC5475">    If Not pvAsn1EncodePkcs1Signature(baHash, baDerHash) Then</td>
        </tr>
        <tr>
          <td id="L5476" data-line-number="5476"></td>
          <td id="LC5476">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5477" data-line-number="5477"></td>
          <td id="LC5477">    End If</td>
        </tr>
        <tr>
          <td id="L5478" data-line-number="5478"></td>
          <td id="LC5478">    For lPos = 2 To UBound(baEnc) - UBound(baDerHash) - 2</td>
        </tr>
        <tr>
          <td id="L5479" data-line-number="5479"></td>
          <td id="LC5479">        If baEnc(lPos) &lt;&gt; &amp;HFF Then</td>
        </tr>
        <tr>
          <td id="L5480" data-line-number="5480"></td>
          <td id="LC5480">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5481" data-line-number="5481"></td>
          <td id="LC5481">        End If</td>
        </tr>
        <tr>
          <td id="L5482" data-line-number="5482"></td>
          <td id="LC5482">    Next</td>
        </tr>
        <tr>
          <td id="L5483" data-line-number="5483"></td>
          <td id="LC5483">    If baEnc(lPos) &lt;&gt; &amp;H0 Then</td>
        </tr>
        <tr>
          <td id="L5484" data-line-number="5484"></td>
          <td id="LC5484">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5485" data-line-number="5485"></td>
          <td id="LC5485">    End If</td>
        </tr>
        <tr>
          <td id="L5486" data-line-number="5486"></td>
          <td id="LC5486">    lPos = lPos + 1</td>
        </tr>
        <tr>
          <td id="L5487" data-line-number="5487"></td>
          <td id="LC5487">    For lIdx = 0 To UBound(baDerHash)</td>
        </tr>
        <tr>
          <td id="L5488" data-line-number="5488"></td>
          <td id="LC5488">        If baEnc(lPos) &lt;&gt; baDerHash(lIdx) Then</td>
        </tr>
        <tr>
          <td id="L5489" data-line-number="5489"></td>
          <td id="LC5489">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5490" data-line-number="5490"></td>
          <td id="LC5490">        End If</td>
        </tr>
        <tr>
          <td id="L5491" data-line-number="5491"></td>
          <td id="LC5491">        lPos = lPos + 1</td>
        </tr>
        <tr>
          <td id="L5492" data-line-number="5492"></td>
          <td id="LC5492">    Next</td>
        </tr>
        <tr>
          <td id="L5493" data-line-number="5493"></td>
          <td id="LC5493">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5494" data-line-number="5494"></td>
          <td id="LC5494">    pvCryptoEmsaPkcs1Decode = True</td>
        </tr>
        <tr>
          <td id="L5495" data-line-number="5495"></td>
          <td id="LC5495">QH:</td>
        </tr>
        <tr>
          <td id="L5496" data-line-number="5496"></td>
          <td id="LC5496">End Function</td>
        </tr>
        <tr>
          <td id="L5497" data-line-number="5497"></td>
          <td id="LC5497">
</td>
        </tr>
        <tr>
          <td id="L5498" data-line-number="5498"></td>
          <td id="LC5498">Private Function pvCryptoEmsaPssEncode(baRetVal() As Byte, baMessage() As Byte, ByVal lBitLen As Long, ByVal lHashSize As Long, ByVal lSaltSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5499" data-line-number="5499"></td>
          <td id="LC5499">    Const FUNC_NAME     As String = &#34;CryptoEmsaPssEncode&#34;</td>
        </tr>
        <tr>
          <td id="L5500" data-line-number="5500"></td>
          <td id="LC5500">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L5501" data-line-number="5501"></td>
          <td id="LC5501">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L5502" data-line-number="5502"></td>
          <td id="LC5502">    Dim baHash()        As Byte</td>
        </tr>
        <tr>
          <td id="L5503" data-line-number="5503"></td>
          <td id="LC5503">    Dim baSalt()        As Byte</td>
        </tr>
        <tr>
          <td id="L5504" data-line-number="5504"></td>
          <td id="LC5504">    Dim baSeed()        As Byte</td>
        </tr>
        <tr>
          <td id="L5505" data-line-number="5505"></td>
          <td id="LC5505">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5506" data-line-number="5506"></td>
          <td id="LC5506">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L5507" data-line-number="5507"></td>
          <td id="LC5507">    Dim bMask           As Byte</td>
        </tr>
        <tr>
          <td id="L5508" data-line-number="5508"></td>
          <td id="LC5508">    </td>
        </tr>
        <tr>
          <td id="L5509" data-line-number="5509"></td>
          <td id="LC5509">    &#39;--- from RFC 8017, Section 9.1.1.</td>
        </tr>
        <tr>
          <td id="L5510" data-line-number="5510"></td>
          <td id="LC5510">    lSize = (lBitLen + 7) \ 8</td>
        </tr>
        <tr>
          <td id="L5511" data-line-number="5511"></td>
          <td id="LC5511">    &#39;--- 2. Let |mHash| = |Hash(M)|, an octet string of length hLen.</td>
        </tr>
        <tr>
          <td id="L5512" data-line-number="5512"></td>
          <td id="LC5512">    pvArrayHash lHashSize, baMessage, baHash</td>
        </tr>
        <tr>
          <td id="L5513" data-line-number="5513"></td>
          <td id="LC5513">    &#39;--- 3. If |emLen| &lt; |hLen + sLen + 2|, output &#34;encoding error&#34; and stop.</td>
        </tr>
        <tr>
          <td id="L5514" data-line-number="5514"></td>
          <td id="LC5514">    If lSize &lt; lHashSize + lSaltSize + 2 Then</td>
        </tr>
        <tr>
          <td id="L5515" data-line-number="5515"></td>
          <td id="LC5515">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5516" data-line-number="5516"></td>
          <td id="LC5516">    End If</td>
        </tr>
        <tr>
          <td id="L5517" data-line-number="5517"></td>
          <td id="LC5517">    &#39;--- 4. Generate a random octet string salt of length sLen; if |sLen| = 0, then salt is the empty string.</td>
        </tr>
        <tr>
          <td id="L5518" data-line-number="5518"></td>
          <td id="LC5518">    If lSaltSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5519" data-line-number="5519"></td>
          <td id="LC5519">        pvArrayAllocate baSalt, lSaltSize, FUNC_NAME &amp; &#34;.baSalt&#34;</td>
        </tr>
        <tr>
          <td id="L5520" data-line-number="5520"></td>
          <td id="LC5520">        pvCryptoRandomBytes VarPtr(baSalt(0)), lSaltSize</td>
        </tr>
        <tr>
          <td id="L5521" data-line-number="5521"></td>
          <td id="LC5521">    Else</td>
        </tr>
        <tr>
          <td id="L5522" data-line-number="5522"></td>
          <td id="LC5522">        baSalt = vbNullString</td>
        </tr>
        <tr>
          <td id="L5523" data-line-number="5523"></td>
          <td id="LC5523">    End If</td>
        </tr>
        <tr>
          <td id="L5524" data-line-number="5524"></td>
          <td id="LC5524">    &#39;--- 5. Let |M&#39;| = (0x)00 00 00 00 00 00 00 00 || mHash || salt;</td>
        </tr>
        <tr>
          <td id="L5525" data-line-number="5525"></td>
          <td id="LC5525">    pvArrayAllocate baBuffer, 8 + lHashSize + lSaltSize, FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L5526" data-line-number="5526"></td>
          <td id="LC5526">    Call CopyMemory(baBuffer(8), baHash(0), lHashSize)</td>
        </tr>
        <tr>
          <td id="L5527" data-line-number="5527"></td>
          <td id="LC5527">    Call CopyMemory(baBuffer(8 + lHashSize), baSalt(0), lSaltSize)</td>
        </tr>
        <tr>
          <td id="L5528" data-line-number="5528"></td>
          <td id="LC5528">    &#39;--- 6. Let |H| = Hash(M&#39;), an octet string of length hLen.</td>
        </tr>
        <tr>
          <td id="L5529" data-line-number="5529"></td>
          <td id="LC5529">    pvArrayHash lHashSize, baBuffer, baHash</td>
        </tr>
        <tr>
          <td id="L5530" data-line-number="5530"></td>
          <td id="LC5530">    &#39;--- 7. Generate an octet string |PS| consisting of |emLen - sLen - hLen - 2| zero octets. The length of PS may be 0.</td>
        </tr>
        <tr>
          <td id="L5531" data-line-number="5531"></td>
          <td id="LC5531">    &#39;--- 8. Let |DB| = PS || 0x01 || salt; DB is an octet string of length |emLen - hLen - 1|.</td>
        </tr>
        <tr>
          <td id="L5532" data-line-number="5532"></td>
          <td id="LC5532">    pvArrayAllocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L5533" data-line-number="5533"></td>
          <td id="LC5533">    baRetVal(lSize - lHashSize - lSaltSize - 2) = &amp;H1</td>
        </tr>
        <tr>
          <td id="L5534" data-line-number="5534"></td>
          <td id="LC5534">    Call CopyMemory(baRetVal(lSize - lHashSize - lSaltSize - 1), baSalt(0), lSaltSize)</td>
        </tr>
        <tr>
          <td id="L5535" data-line-number="5535"></td>
          <td id="LC5535">    Call CopyMemory(baRetVal(lSize - lHashSize - 1), baHash(0), lHashSize)</td>
        </tr>
        <tr>
          <td id="L5536" data-line-number="5536"></td>
          <td id="LC5536">    &#39;--- 9. Let |dbMask| = MGF(H, emLen - hLen - 1).</td>
        </tr>
        <tr>
          <td id="L5537" data-line-number="5537"></td>
          <td id="LC5537">    &#39;--- 10. Let |maskedDB| = DB \xor dbMask.</td>
        </tr>
        <tr>
          <td id="L5538" data-line-number="5538"></td>
          <td id="LC5538">    pvArrayAllocate baSeed, lHashSize + 4, FUNC_NAME &amp; &#34;.baSeed&#34; &#39;--- leave 4 more bytes at the end for counter</td>
        </tr>
        <tr>
          <td id="L5539" data-line-number="5539"></td>
          <td id="LC5539">    Call CopyMemory(baSeed(0), baRetVal(lSize - lHashSize - 1), lHashSize)</td>
        </tr>
        <tr>
          <td id="L5540" data-line-number="5540"></td>
          <td id="LC5540">    Do</td>
        </tr>
        <tr>
          <td id="L5541" data-line-number="5541"></td>
          <td id="LC5541">        pvArrayHash lHashSize, baSeed, baHash</td>
        </tr>
        <tr>
          <td id="L5542" data-line-number="5542"></td>
          <td id="LC5542">        For lIdx = 0 To UBound(baHash)</td>
        </tr>
        <tr>
          <td id="L5543" data-line-number="5543"></td>
          <td id="LC5543">            baRetVal(lPos) = baRetVal(lPos) Xor baHash(lIdx)</td>
        </tr>
        <tr>
          <td id="L5544" data-line-number="5544"></td>
          <td id="LC5544">            lPos = lPos + 1</td>
        </tr>
        <tr>
          <td id="L5545" data-line-number="5545"></td>
          <td id="LC5545">            If lPos &gt;= lSize - lHashSize - 1 Then</td>
        </tr>
        <tr>
          <td id="L5546" data-line-number="5546"></td>
          <td id="LC5546">                Exit Do</td>
        </tr>
        <tr>
          <td id="L5547" data-line-number="5547"></td>
          <td id="LC5547">            End If</td>
        </tr>
        <tr>
          <td id="L5548" data-line-number="5548"></td>
          <td id="LC5548">        Next</td>
        </tr>
        <tr>
          <td id="L5549" data-line-number="5549"></td>
          <td id="LC5549">        pvArrayIncCounter baSeed, lHashSize + 3</td>
        </tr>
        <tr>
          <td id="L5550" data-line-number="5550"></td>
          <td id="LC5550">    Loop</td>
        </tr>
        <tr>
          <td id="L5551" data-line-number="5551"></td>
          <td id="LC5551">    &#39;--- 11. Set the leftmost |8 * emLen - emBits| bits of the leftmost octet in |maskedDB| to zero.</td>
        </tr>
        <tr>
          <td id="L5552" data-line-number="5552"></td>
          <td id="LC5552">    bMask = &amp;HFF \ (2 ^ (lSize * 8 - lBitLen))</td>
        </tr>
        <tr>
          <td id="L5553" data-line-number="5553"></td>
          <td id="LC5553">    baRetVal(0) = baRetVal(0) And (bMask \ 2)</td>
        </tr>
        <tr>
          <td id="L5554" data-line-number="5554"></td>
          <td id="LC5554">    &#39;--- 12. Let |EM| = maskedDB || H || 0xbc.</td>
        </tr>
        <tr>
          <td id="L5555" data-line-number="5555"></td>
          <td id="LC5555">    baRetVal(lSize - 1) = &amp;HBC</td>
        </tr>
        <tr>
          <td id="L5556" data-line-number="5556"></td>
          <td id="LC5556">    &#39;--- 13. Output EM.</td>
        </tr>
        <tr>
          <td id="L5557" data-line-number="5557"></td>
          <td id="LC5557">    pvCryptoEmsaPssEncode = True</td>
        </tr>
        <tr>
          <td id="L5558" data-line-number="5558"></td>
          <td id="LC5558">QH:</td>
        </tr>
        <tr>
          <td id="L5559" data-line-number="5559"></td>
          <td id="LC5559">End Function</td>
        </tr>
        <tr>
          <td id="L5560" data-line-number="5560"></td>
          <td id="LC5560">
</td>
        </tr>
        <tr>
          <td id="L5561" data-line-number="5561"></td>
          <td id="LC5561">Private Function pvCryptoEmsaPssDecode(baMessage() As Byte, baEnc() As Byte, ByVal lBitLen As Long, ByVal lHashSize As Long, ByVal lSaltSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5562" data-line-number="5562"></td>
          <td id="LC5562">    Const FUNC_NAME     As String = &#34;CryptoEmsaPssDecode&#34;</td>
        </tr>
        <tr>
          <td id="L5563" data-line-number="5563"></td>
          <td id="LC5563">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L5564" data-line-number="5564"></td>
          <td id="LC5564">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L5565" data-line-number="5565"></td>
          <td id="LC5565">    Dim baSeed()        As Byte</td>
        </tr>
        <tr>
          <td id="L5566" data-line-number="5566"></td>
          <td id="LC5566">    Dim baHash()        As Byte</td>
        </tr>
        <tr>
          <td id="L5567" data-line-number="5567"></td>
          <td id="LC5567">    Dim baSalt()        As Byte</td>
        </tr>
        <tr>
          <td id="L5568" data-line-number="5568"></td>
          <td id="LC5568">    Dim lPos            As Long</td>
        </tr>
        <tr>
          <td id="L5569" data-line-number="5569"></td>
          <td id="LC5569">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5570" data-line-number="5570"></td>
          <td id="LC5570">    Dim bMask           As Byte</td>
        </tr>
        <tr>
          <td id="L5571" data-line-number="5571"></td>
          <td id="LC5571">    </td>
        </tr>
        <tr>
          <td id="L5572" data-line-number="5572"></td>
          <td id="LC5572">    &#39;--- from RFC 8017, Section 9.1.2.</td>
        </tr>
        <tr>
          <td id="L5573" data-line-number="5573"></td>
          <td id="LC5573">    lSize = (lBitLen + 7) \ 8</td>
        </tr>
        <tr>
          <td id="L5574" data-line-number="5574"></td>
          <td id="LC5574">    &#39;--- 3. If |emLen| &lt; |hLen + sLen + 2|, output &#34;inconsistent&#34; and stop.</td>
        </tr>
        <tr>
          <td id="L5575" data-line-number="5575"></td>
          <td id="LC5575">    If lSize &lt; lHashSize + lSaltSize + 2 Then</td>
        </tr>
        <tr>
          <td id="L5576" data-line-number="5576"></td>
          <td id="LC5576">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5577" data-line-number="5577"></td>
          <td id="LC5577">    End If</td>
        </tr>
        <tr>
          <td id="L5578" data-line-number="5578"></td>
          <td id="LC5578">    &#39;--- 4. If the rightmost octet of |EM| does not have hexadecimal value 0xbc, output &#34;inconsistent&#34; and stop.</td>
        </tr>
        <tr>
          <td id="L5579" data-line-number="5579"></td>
          <td id="LC5579">    If baEnc(lSize - 1) &lt;&gt; &amp;HBC Then</td>
        </tr>
        <tr>
          <td id="L5580" data-line-number="5580"></td>
          <td id="LC5580">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5581" data-line-number="5581"></td>
          <td id="LC5581">    End If</td>
        </tr>
        <tr>
          <td id="L5582" data-line-number="5582"></td>
          <td id="LC5582">    &#39;--- 5. Let |maskedDB| be the leftmost |emLen - hLen - 1| octets of |EM|, and let |H| be the next |hLen| octets.</td>
        </tr>
        <tr>
          <td id="L5583" data-line-number="5583"></td>
          <td id="LC5583">    &#39;--- 6. If the leftmost |8 * emLen - emBits| bits of the leftmost octet in |maskedDB| are not all equal to zero,</td>
        </tr>
        <tr>
          <td id="L5584" data-line-number="5584"></td>
          <td id="LC5584">    &#39;---    output &#34;inconsistent&#34; and stop.</td>
        </tr>
        <tr>
          <td id="L5585" data-line-number="5585"></td>
          <td id="LC5585">    bMask = &amp;HFF \ (2 ^ (lSize * 8 - lBitLen))</td>
        </tr>
        <tr>
          <td id="L5586" data-line-number="5586"></td>
          <td id="LC5586">    If (baEnc(0) And Not bMask) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5587" data-line-number="5587"></td>
          <td id="LC5587">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5588" data-line-number="5588"></td>
          <td id="LC5588">    End If</td>
        </tr>
        <tr>
          <td id="L5589" data-line-number="5589"></td>
          <td id="LC5589">    &#39;--- 7. Let |dbMask| = MGF(H, emLen - hLen - 1).</td>
        </tr>
        <tr>
          <td id="L5590" data-line-number="5590"></td>
          <td id="LC5590">    &#39;--- 8. Let |DB| = maskedDB \xor dbMask.</td>
        </tr>
        <tr>
          <td id="L5591" data-line-number="5591"></td>
          <td id="LC5591">    pvArrayAllocate baSeed, lHashSize + 4, FUNC_NAME &amp; &#34;.baSeed&#34;  &#39;--- leave 4 more bytes at the end for counter</td>
        </tr>
        <tr>
          <td id="L5592" data-line-number="5592"></td>
          <td id="LC5592">    Call CopyMemory(baSeed(0), baEnc(lSize - lHashSize - 1), lHashSize)</td>
        </tr>
        <tr>
          <td id="L5593" data-line-number="5593"></td>
          <td id="LC5593">    Do</td>
        </tr>
        <tr>
          <td id="L5594" data-line-number="5594"></td>
          <td id="LC5594">        pvArrayHash lHashSize, baSeed, baHash</td>
        </tr>
        <tr>
          <td id="L5595" data-line-number="5595"></td>
          <td id="LC5595">        For lIdx = 0 To UBound(baHash)</td>
        </tr>
        <tr>
          <td id="L5596" data-line-number="5596"></td>
          <td id="LC5596">            baEnc(lPos) = baEnc(lPos) Xor baHash(lIdx)</td>
        </tr>
        <tr>
          <td id="L5597" data-line-number="5597"></td>
          <td id="LC5597">            lPos = lPos + 1</td>
        </tr>
        <tr>
          <td id="L5598" data-line-number="5598"></td>
          <td id="LC5598">            If lPos &gt;= lSize - lHashSize - 1 Then</td>
        </tr>
        <tr>
          <td id="L5599" data-line-number="5599"></td>
          <td id="LC5599">                Exit Do</td>
        </tr>
        <tr>
          <td id="L5600" data-line-number="5600"></td>
          <td id="LC5600">            End If</td>
        </tr>
        <tr>
          <td id="L5601" data-line-number="5601"></td>
          <td id="LC5601">        Next</td>
        </tr>
        <tr>
          <td id="L5602" data-line-number="5602"></td>
          <td id="LC5602">        pvArrayIncCounter baSeed, lHashSize + 3</td>
        </tr>
        <tr>
          <td id="L5603" data-line-number="5603"></td>
          <td id="LC5603">    Loop</td>
        </tr>
        <tr>
          <td id="L5604" data-line-number="5604"></td>
          <td id="LC5604">    &#39;--- 9. Set the leftmost |8 * emLen - emBits| bits of the leftmost octet in |DB| to zero.</td>
        </tr>
        <tr>
          <td id="L5605" data-line-number="5605"></td>
          <td id="LC5605">    &#39;--- note: troubles w/ sign bit so use (bMask \ 2) to clear MSB</td>
        </tr>
        <tr>
          <td id="L5606" data-line-number="5606"></td>
          <td id="LC5606">    baEnc(0) = baEnc(0) And (bMask \ 2)</td>
        </tr>
        <tr>
          <td id="L5607" data-line-number="5607"></td>
          <td id="LC5607">    &#39;--- 10. If the |emLen - hLen - sLen - 2| leftmost octets of |DB| are not zero or if the octet at position</td>
        </tr>
        <tr>
          <td id="L5608" data-line-number="5608"></td>
          <td id="LC5608">    &#39;---     |emLen - hLen - sLen - 1| (the leftmost position is &#34;position 1&#34;) does not have hexadecimal</td>
        </tr>
        <tr>
          <td id="L5609" data-line-number="5609"></td>
          <td id="LC5609">    &#39;---     value 0x01, output &#34;inconsistent&#34; and stop.</td>
        </tr>
        <tr>
          <td id="L5610" data-line-number="5610"></td>
          <td id="LC5610">    For lIdx = 0 To lPos - lHashSize - 2</td>
        </tr>
        <tr>
          <td id="L5611" data-line-number="5611"></td>
          <td id="LC5611">        If baEnc(lIdx) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5612" data-line-number="5612"></td>
          <td id="LC5612">            Exit For</td>
        </tr>
        <tr>
          <td id="L5613" data-line-number="5613"></td>
          <td id="LC5613">        End If</td>
        </tr>
        <tr>
          <td id="L5614" data-line-number="5614"></td>
          <td id="LC5614">    Next</td>
        </tr>
        <tr>
          <td id="L5615" data-line-number="5615"></td>
          <td id="LC5615">    If lIdx &lt;&gt; lPos - lHashSize - 1 Then</td>
        </tr>
        <tr>
          <td id="L5616" data-line-number="5616"></td>
          <td id="LC5616">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5617" data-line-number="5617"></td>
          <td id="LC5617">    End If</td>
        </tr>
        <tr>
          <td id="L5618" data-line-number="5618"></td>
          <td id="LC5618">    If baEnc(lPos - lHashSize - 1) &lt;&gt; &amp;H1 Then</td>
        </tr>
        <tr>
          <td id="L5619" data-line-number="5619"></td>
          <td id="LC5619">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5620" data-line-number="5620"></td>
          <td id="LC5620">    End If</td>
        </tr>
        <tr>
          <td id="L5621" data-line-number="5621"></td>
          <td id="LC5621">    &#39;--- 11. Let |salt| be the last |sLen| octets of |DB|.</td>
        </tr>
        <tr>
          <td id="L5622" data-line-number="5622"></td>
          <td id="LC5622">    pvArrayAllocate baSalt, lSaltSize, FUNC_NAME &amp; &#34;.baSalt&#34;</td>
        </tr>
        <tr>
          <td id="L5623" data-line-number="5623"></td>
          <td id="LC5623">    Call CopyMemory(baSalt(0), baEnc(lPos - lSaltSize), lSaltSize)</td>
        </tr>
        <tr>
          <td id="L5624" data-line-number="5624"></td>
          <td id="LC5624">    &#39;--- 12. Let |M&#39;| = (0x)00 00 00 00 00 00 00 00 || mHash || salt</td>
        </tr>
        <tr>
          <td id="L5625" data-line-number="5625"></td>
          <td id="LC5625">    pvArrayAllocate baSeed, 8 + lHashSize + lSaltSize, FUNC_NAME &amp; &#34;.baSeed&#34;</td>
        </tr>
        <tr>
          <td id="L5626" data-line-number="5626"></td>
          <td id="LC5626">    pvArrayHash lHashSize, baMessage, baHash</td>
        </tr>
        <tr>
          <td id="L5627" data-line-number="5627"></td>
          <td id="LC5627">    Call CopyMemory(baSeed(8), baHash(0), lHashSize)</td>
        </tr>
        <tr>
          <td id="L5628" data-line-number="5628"></td>
          <td id="LC5628">    Call CopyMemory(baSeed(8 + lHashSize), baSalt(0), lSaltSize)</td>
        </tr>
        <tr>
          <td id="L5629" data-line-number="5629"></td>
          <td id="LC5629">    &#39;--- 13. Let |H&#39;| = Hash(M&#39;), an octet string of length |hLen|.</td>
        </tr>
        <tr>
          <td id="L5630" data-line-number="5630"></td>
          <td id="LC5630">    pvArrayHash lHashSize, baSeed, baHash</td>
        </tr>
        <tr>
          <td id="L5631" data-line-number="5631"></td>
          <td id="LC5631">    &#39;--- |H| is still not de-masked in decrypted buffer</td>
        </tr>
        <tr>
          <td id="L5632" data-line-number="5632"></td>
          <td id="LC5632">    pvArrayAllocate baBuffer, lHashSize, FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L5633" data-line-number="5633"></td>
          <td id="LC5633">    Call CopyMemory(baBuffer(0), baEnc(lPos), lHashSize)</td>
        </tr>
        <tr>
          <td id="L5634" data-line-number="5634"></td>
          <td id="LC5634">    &#39;--- 14. If |H| = |H&#39;|, output &#34;consistent.&#34; Otherwise, output &#34;inconsistent.&#34;</td>
        </tr>
        <tr>
          <td id="L5635" data-line-number="5635"></td>
          <td id="LC5635">    If Not pvArrayEqual(baHash, baBuffer) Then</td>
        </tr>
        <tr>
          <td id="L5636" data-line-number="5636"></td>
          <td id="LC5636">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5637" data-line-number="5637"></td>
          <td id="LC5637">    End If</td>
        </tr>
        <tr>
          <td id="L5638" data-line-number="5638"></td>
          <td id="LC5638">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5639" data-line-number="5639"></td>
          <td id="LC5639">    pvCryptoEmsaPssDecode = True</td>
        </tr>
        <tr>
          <td id="L5640" data-line-number="5640"></td>
          <td id="LC5640">QH:</td>
        </tr>
        <tr>
          <td id="L5641" data-line-number="5641"></td>
          <td id="LC5641">End Function</td>
        </tr>
        <tr>
          <td id="L5642" data-line-number="5642"></td>
          <td id="LC5642">
</td>
        </tr>
        <tr>
          <td id="L5643" data-line-number="5643"></td>
          <td id="LC5643">Private Function pvAsn1DecodePrivateKey(cCerts As Collection, cPrivKey As Collection, uRetVal As UcsKeyInfo) As Boolean</td>
        </tr>
        <tr>
          <td id="L5644" data-line-number="5644"></td>
          <td id="LC5644">    Const FUNC_NAME     As String = &#34;Asn1DecodePrivateKey&#34;</td>
        </tr>
        <tr>
          <td id="L5645" data-line-number="5645"></td>
          <td id="LC5645">    Const IDX_KEYNAME   As Long = 1</td>
        </tr>
        <tr>
          <td id="L5646" data-line-number="5646"></td>
          <td id="LC5646">    Const IDX_PROVNAME  As Long = 2</td>
        </tr>
        <tr>
          <td id="L5647" data-line-number="5647"></td>
          <td id="LC5647">    Const IDX_PROVTYPE  As Long = 3</td>
        </tr>
        <tr>
          <td id="L5648" data-line-number="5648"></td>
          <td id="LC5648">    Const IDX_KEYSPEC   As Long = 4</td>
        </tr>
        <tr>
          <td id="L5649" data-line-number="5649"></td>
          <td id="LC5649">    Dim baPrivKey()     As Byte</td>
        </tr>
        <tr>
          <td id="L5650" data-line-number="5650"></td>
          <td id="LC5650">    Dim baCert()        As Byte</td>
        </tr>
        <tr>
          <td id="L5651" data-line-number="5651"></td>
          <td id="LC5651">    Dim uCertInfo       As UcsKeyInfo</td>
        </tr>
        <tr>
          <td id="L5652" data-line-number="5652"></td>
          <td id="LC5652">    Dim hNProv          As Long</td>
        </tr>
        <tr>
          <td id="L5653" data-line-number="5653"></td>
          <td id="LC5653">    Dim hProv           As Long</td>
        </tr>
        <tr>
          <td id="L5654" data-line-number="5654"></td>
          <td id="LC5654">    Dim lPkiPtr         As Long</td>
        </tr>
        <tr>
          <td id="L5655" data-line-number="5655"></td>
          <td id="LC5655">    Dim uPrivKey        As CRYPT_PRIVATE_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L5656" data-line-number="5656"></td>
          <td id="LC5656">    Dim lKeyPtr         As Long</td>
        </tr>
        <tr>
          <td id="L5657" data-line-number="5657"></td>
          <td id="LC5657">    Dim lKeySize        As Long</td>
        </tr>
        <tr>
          <td id="L5658" data-line-number="5658"></td>
          <td id="LC5658">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L5659" data-line-number="5659"></td>
          <td id="LC5659">    Dim lHalfSize       As Long</td>
        </tr>
        <tr>
          <td id="L5660" data-line-number="5660"></td>
          <td id="LC5660">    Dim uEccKeyInfo     As CRYPT_ECC_PRIVATE_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L5661" data-line-number="5661"></td>
          <td id="LC5661">    Dim hResult         As Long</td>
        </tr>
        <tr>
          <td id="L5662" data-line-number="5662"></td>
          <td id="LC5662">    Dim sApiSource      As String</td>
        </tr>
        <tr>
          <td id="L5663" data-line-number="5663"></td>
          <td id="LC5663">    </td>
        </tr>
        <tr>
          <td id="L5664" data-line-number="5664"></td>
          <td id="LC5664">    If pvCollectionCount(cPrivKey) &gt; 1 Then</td>
        </tr>
        <tr>
          <td id="L5665" data-line-number="5665"></td>
          <td id="LC5665">        If Not SearchCollection(cCerts, 1, RetVal:=baCert) Then</td>
        </tr>
        <tr>
          <td id="L5666" data-line-number="5666"></td>
          <td id="LC5666">            ErrRaise vbObjectError, FUNC_NAME, ERR_NO_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L5667" data-line-number="5667"></td>
          <td id="LC5667">        End If</td>
        </tr>
        <tr>
          <td id="L5668" data-line-number="5668"></td>
          <td id="LC5668">        If Not pvAsn1DecodeCertificate(baCert, uCertInfo) Then</td>
        </tr>
        <tr>
          <td id="L5669" data-line-number="5669"></td>
          <td id="LC5669">            ErrRaise vbObjectError, FUNC_NAME, ERR_UNSUPPORTED_CERTIFICATE</td>
        </tr>
        <tr>
          <td id="L5670" data-line-number="5670"></td>
          <td id="LC5670">        End If</td>
        </tr>
        <tr>
          <td id="L5671" data-line-number="5671"></td>
          <td id="LC5671">        uRetVal.AlgoObjId = uCertInfo.AlgoObjId</td>
        </tr>
        <tr>
          <td id="L5672" data-line-number="5672"></td>
          <td id="LC5672">        uRetVal.BitLen = uCertInfo.BitLen</td>
        </tr>
        <tr>
          <td id="L5673" data-line-number="5673"></td>
          <td id="LC5673">        With cPrivKey</td>
        </tr>
        <tr>
          <td id="L5674" data-line-number="5674"></td>
          <td id="LC5674">            If pvCollectionCount(cPrivKey) = IDX_PROVNAME Then</td>
        </tr>
        <tr>
          <td id="L5675" data-line-number="5675"></td>
          <td id="LC5675">                hResult = NCryptOpenStorageProvider(hNProv, StrPtr(.Item(IDX_PROVNAME)), 0)</td>
        </tr>
        <tr>
          <td id="L5676" data-line-number="5676"></td>
          <td id="LC5676">                If hResult &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5677" data-line-number="5677"></td>
          <td id="LC5677">                    sApiSource = &#34;NCryptOpenStorageProvider&#34;</td>
        </tr>
        <tr>
          <td id="L5678" data-line-number="5678"></td>
          <td id="LC5678">                    GoTo QH</td>
        </tr>
        <tr>
          <td id="L5679" data-line-number="5679"></td>
          <td id="LC5679">                End If</td>
        </tr>
        <tr>
          <td id="L5680" data-line-number="5680"></td>
          <td id="LC5680">                hResult = NCryptOpenKey(hNProv, uRetVal.hNKey, StrPtr(.Item(IDX_KEYNAME)), 0, 0)</td>
        </tr>
        <tr>
          <td id="L5681" data-line-number="5681"></td>
          <td id="LC5681">                If hResult &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5682" data-line-number="5682"></td>
          <td id="LC5682">                    sApiSource = &#34;NCryptOpenKey&#34;</td>
        </tr>
        <tr>
          <td id="L5683" data-line-number="5683"></td>
          <td id="LC5683">                    GoTo QH</td>
        </tr>
        <tr>
          <td id="L5684" data-line-number="5684"></td>
          <td id="LC5684">                End If</td>
        </tr>
        <tr>
          <td id="L5685" data-line-number="5685"></td>
          <td id="LC5685">            Else</td>
        </tr>
        <tr>
          <td id="L5686" data-line-number="5686"></td>
          <td id="LC5686">                If .Item(IDX_PROVTYPE) = PROV_RSA_FULL Then</td>
        </tr>
        <tr>
          <td id="L5687" data-line-number="5687"></td>
          <td id="LC5687">                    &#39;--- try using PROV_RSA_AES to have SHA-2 available in pvTlsSignatureSign</td>
        </tr>
        <tr>
          <td id="L5688" data-line-number="5688"></td>
          <td id="LC5688">                    Call CryptAcquireContext(hProv, StrPtr(.Item(IDX_KEYNAME)), 0, PROV_RSA_AES, 0)</td>
        </tr>
        <tr>
          <td id="L5689" data-line-number="5689"></td>
          <td id="LC5689">                End If</td>
        </tr>
        <tr>
          <td id="L5690" data-line-number="5690"></td>
          <td id="LC5690">                If hProv = 0 Then</td>
        </tr>
        <tr>
          <td id="L5691" data-line-number="5691"></td>
          <td id="LC5691">                    If CryptAcquireContext(hProv, StrPtr(.Item(IDX_KEYNAME)), StrPtr(.Item(IDX_PROVNAME)), .Item(IDX_PROVTYPE), 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5692" data-line-number="5692"></td>
          <td id="LC5692">                        hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L5693" data-line-number="5693"></td>
          <td id="LC5693">                        sApiSource = &#34;CryptAcquireContext&#34;</td>
        </tr>
        <tr>
          <td id="L5694" data-line-number="5694"></td>
          <td id="LC5694">                        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5695" data-line-number="5695"></td>
          <td id="LC5695">                    End If</td>
        </tr>
        <tr>
          <td id="L5696" data-line-number="5696"></td>
          <td id="LC5696">                End If</td>
        </tr>
        <tr>
          <td id="L5697" data-line-number="5697"></td>
          <td id="LC5697">                If CryptGetUserKey(hProv, .Item(IDX_KEYSPEC), uRetVal.hKey) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5698" data-line-number="5698"></td>
          <td id="LC5698">                    hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L5699" data-line-number="5699"></td>
          <td id="LC5699">                    sApiSource = &#34;CryptGetUserKey&#34;</td>
        </tr>
        <tr>
          <td id="L5700" data-line-number="5700"></td>
          <td id="LC5700">                    GoTo QH</td>
        </tr>
        <tr>
          <td id="L5701" data-line-number="5701"></td>
          <td id="LC5701">                End If</td>
        </tr>
        <tr>
          <td id="L5702" data-line-number="5702"></td>
          <td id="LC5702">                uRetVal.hProv = hProv: hProv = 0</td>
        </tr>
        <tr>
          <td id="L5703" data-line-number="5703"></td>
          <td id="LC5703">                uRetVal.dwKeySpec = .Item(IDX_KEYSPEC)</td>
        </tr>
        <tr>
          <td id="L5704" data-line-number="5704"></td>
          <td id="LC5704">            End If</td>
        </tr>
        <tr>
          <td id="L5705" data-line-number="5705"></td>
          <td id="LC5705">        End With</td>
        </tr>
        <tr>
          <td id="L5706" data-line-number="5706"></td>
          <td id="LC5706">    ElseIf SearchCollection(cPrivKey, 1, RetVal:=baPrivKey) Then</td>
        </tr>
        <tr>
          <td id="L5707" data-line-number="5707"></td>
          <td id="LC5707">        If CryptDecodeObjectEx(X509_ASN_ENCODING Or PKCS_7_ASN_ENCODING, PKCS_PRIVATE_KEY_INFO, baPrivKey(0), UBound(baPrivKey) + 1, CRYPT_DECODE_ALLOC_FLAG Or CRYPT_DECODE_NOCOPY_FLAG, 0, lPkiPtr, 0) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5708" data-line-number="5708"></td>
          <td id="LC5708">            Call CopyMemory(uPrivKey, ByVal lPkiPtr, LenB(uPrivKey))</td>
        </tr>
        <tr>
          <td id="L5709" data-line-number="5709"></td>
          <td id="LC5709">            If CryptDecodeObjectEx(X509_ASN_ENCODING Or PKCS_7_ASN_ENCODING, PKCS_RSA_PRIVATE_KEY, ByVal uPrivKey.PrivateKey.pbData, uPrivKey.PrivateKey.cbData, CRYPT_DECODE_ALLOC_FLAG Or CRYPT_DECODE_NOCOPY_FLAG, 0, lKeyPtr, lKeySize) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5710" data-line-number="5710"></td>
          <td id="LC5710">                hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L5711" data-line-number="5711"></td>
          <td id="LC5711">                sApiSource = &#34;CryptDecodeObjectEx(PKCS_RSA_PRIVATE_KEY)&#34;</td>
        </tr>
        <tr>
          <td id="L5712" data-line-number="5712"></td>
          <td id="LC5712">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L5713" data-line-number="5713"></td>
          <td id="LC5713">            End If</td>
        </tr>
        <tr>
          <td id="L5714" data-line-number="5714"></td>
          <td id="LC5714">            uRetVal.AlgoObjId = pvToStringA(uPrivKey.Algorithm.pszObjId)</td>
        </tr>
        <tr>
          <td id="L5715" data-line-number="5715"></td>
          <td id="LC5715">            GoTo DecodeRsa</td>
        </tr>
        <tr>
          <td id="L5716" data-line-number="5716"></td>
          <td id="LC5716">        ElseIf CryptDecodeObjectEx(X509_ASN_ENCODING Or PKCS_7_ASN_ENCODING, PKCS_RSA_PRIVATE_KEY, baPrivKey(0), UBound(baPrivKey) + 1, CRYPT_DECODE_ALLOC_FLAG Or CRYPT_DECODE_NOCOPY_FLAG, 0, lKeyPtr, lKeySize) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5717" data-line-number="5717"></td>
          <td id="LC5717">            uRetVal.AlgoObjId = szOID_RSA_RSA</td>
        </tr>
        <tr>
          <td id="L5718" data-line-number="5718"></td>
          <td id="LC5718">DecodeRsa:</td>
        </tr>
        <tr>
          <td id="L5719" data-line-number="5719"></td>
          <td id="LC5719">            pvArrayAllocate uRetVal.KeyBlob, lKeySize, FUNC_NAME &amp; &#34;.uRetVal.KeyBlob&#34;</td>
        </tr>
        <tr>
          <td id="L5720" data-line-number="5720"></td>
          <td id="LC5720">            Call CopyMemory(uRetVal.KeyBlob(0), ByVal lKeyPtr, lKeySize)</td>
        </tr>
        <tr>
          <td id="L5721" data-line-number="5721"></td>
          <td id="LC5721">            Debug.Assert UBound(uRetVal.KeyBlob) &gt;= 16</td>
        </tr>
        <tr>
          <td id="L5722" data-line-number="5722"></td>
          <td id="LC5722">            Call CopyMemory(uRetVal.BitLen, uRetVal.KeyBlob(12), LenB(uRetVal.BitLen))</td>
        </tr>
        <tr>
          <td id="L5723" data-line-number="5723"></td>
          <td id="LC5723">            lSize = (uRetVal.BitLen + 7) \ 8</td>
        </tr>
        <tr>
          <td id="L5724" data-line-number="5724"></td>
          <td id="LC5724">            lHalfSize = (uRetVal.BitLen + 15) \ 16</td>
        </tr>
        <tr>
          <td id="L5725" data-line-number="5725"></td>
          <td id="LC5725">            &#39;--- modulus (mod = p * q)</td>
        </tr>
        <tr>
          <td id="L5726" data-line-number="5726"></td>
          <td id="LC5726">            pvArrayAllocate uRetVal.Modulus, lSize, FUNC_NAME &amp; &#34;.uRetVal.Modulus&#34;</td>
        </tr>
        <tr>
          <td id="L5727" data-line-number="5727"></td>
          <td id="LC5727">            Debug.Assert UBound(uRetVal.KeyBlob) - 20 &gt;= UBound(uRetVal.Modulus)</td>
        </tr>
        <tr>
          <td id="L5728" data-line-number="5728"></td>
          <td id="LC5728">            Call CopyMemory(uRetVal.Modulus(0), uRetVal.KeyBlob(20), UBound(uRetVal.Modulus) + 1)</td>
        </tr>
        <tr>
          <td id="L5729" data-line-number="5729"></td>
          <td id="LC5729">            pvArrayReverse uRetVal.Modulus</td>
        </tr>
        <tr>
          <td id="L5730" data-line-number="5730"></td>
          <td id="LC5730">            &#39;--- prime1 (p)</td>
        </tr>
        <tr>
          <td id="L5731" data-line-number="5731"></td>
          <td id="LC5731">            pvArrayAllocate uRetVal.Prime1, lHalfSize, FUNC_NAME &amp; &#34;.uRetVal.Prime1&#34;</td>
        </tr>
        <tr>
          <td id="L5732" data-line-number="5732"></td>
          <td id="LC5732">            Debug.Assert UBound(uRetVal.KeyBlob) &gt;= 20 + lSize + 0 * lHalfSize + UBound(uRetVal.Prime1)</td>
        </tr>
        <tr>
          <td id="L5733" data-line-number="5733"></td>
          <td id="LC5733">            Call CopyMemory(uRetVal.Prime1(0), uRetVal.KeyBlob(20 + lSize + 0 * lHalfSize), UBound(uRetVal.Prime1) + 1)</td>
        </tr>
        <tr>
          <td id="L5734" data-line-number="5734"></td>
          <td id="LC5734">            pvArrayReverse uRetVal.Prime1</td>
        </tr>
        <tr>
          <td id="L5735" data-line-number="5735"></td>
          <td id="LC5735">            &#39;--- prime2 (q)</td>
        </tr>
        <tr>
          <td id="L5736" data-line-number="5736"></td>
          <td id="LC5736">            pvArrayAllocate uRetVal.Prime2, lHalfSize, FUNC_NAME &amp; &#34;.uRetVal.Prime2&#34;</td>
        </tr>
        <tr>
          <td id="L5737" data-line-number="5737"></td>
          <td id="LC5737">            Debug.Assert UBound(uRetVal.KeyBlob) &gt;= 20 + lSize + 1 * lHalfSize + UBound(uRetVal.Prime2)</td>
        </tr>
        <tr>
          <td id="L5738" data-line-number="5738"></td>
          <td id="LC5738">            Call CopyMemory(uRetVal.Prime2(0), uRetVal.KeyBlob(20 + lSize + 1 * lHalfSize), UBound(uRetVal.Prime2) + 1)</td>
        </tr>
        <tr>
          <td id="L5739" data-line-number="5739"></td>
          <td id="LC5739">            pvArrayReverse uRetVal.Prime2</td>
        </tr>
        <tr>
          <td id="L5740" data-line-number="5740"></td>
          <td id="LC5740">            &#39;--- coefficient (iqmp)</td>
        </tr>
        <tr>
          <td id="L5741" data-line-number="5741"></td>
          <td id="LC5741">            pvArrayAllocate uRetVal.Coefficient, lHalfSize, FUNC_NAME &amp; &#34;.uRetVal.Coefficient&#34;</td>
        </tr>
        <tr>
          <td id="L5742" data-line-number="5742"></td>
          <td id="LC5742">            Debug.Assert UBound(uRetVal.KeyBlob) &gt;= 20 + lSize + 4 * lHalfSize + UBound(uRetVal.Coefficient)</td>
        </tr>
        <tr>
          <td id="L5743" data-line-number="5743"></td>
          <td id="LC5743">            Call CopyMemory(uRetVal.Coefficient(0), uRetVal.KeyBlob(20 + lSize + 4 * lHalfSize), UBound(uRetVal.Coefficient) + 1)</td>
        </tr>
        <tr>
          <td id="L5744" data-line-number="5744"></td>
          <td id="LC5744">            pvArrayReverse uRetVal.Coefficient</td>
        </tr>
        <tr>
          <td id="L5745" data-line-number="5745"></td>
          <td id="LC5745">            &#39;--- privateExponent</td>
        </tr>
        <tr>
          <td id="L5746" data-line-number="5746"></td>
          <td id="LC5746">            pvArrayAllocate uRetVal.PrivExp, lSize, FUNC_NAME &amp; &#34;.uRetVal.PrivExp&#34;</td>
        </tr>
        <tr>
          <td id="L5747" data-line-number="5747"></td>
          <td id="LC5747">            Debug.Assert UBound(uRetVal.KeyBlob) &gt;= 20 + lSize + 5 * lHalfSize + UBound(uRetVal.PrivExp)</td>
        </tr>
        <tr>
          <td id="L5748" data-line-number="5748"></td>
          <td id="LC5748">            Call CopyMemory(uRetVal.PrivExp(0), uRetVal.KeyBlob(20 + lSize + 5 * lHalfSize), UBound(uRetVal.PrivExp) + 1)</td>
        </tr>
        <tr>
          <td id="L5749" data-line-number="5749"></td>
          <td id="LC5749">            pvArrayReverse uRetVal.PrivExp</td>
        </tr>
        <tr>
          <td id="L5750" data-line-number="5750"></td>
          <td id="LC5750">        ElseIf CryptDecodeObjectEx(X509_ASN_ENCODING Or PKCS_7_ASN_ENCODING, X509_ECC_PRIVATE_KEY, baPrivKey(0), UBound(baPrivKey) + 1, CRYPT_DECODE_ALLOC_FLAG Or CRYPT_DECODE_NOCOPY_FLAG, 0, lKeyPtr, 0) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5751" data-line-number="5751"></td>
          <td id="LC5751">            Call CopyMemory(uEccKeyInfo, ByVal lKeyPtr, LenB(uEccKeyInfo))</td>
        </tr>
        <tr>
          <td id="L5752" data-line-number="5752"></td>
          <td id="LC5752">            uRetVal.AlgoObjId = pvToStringA(uEccKeyInfo.szCurveOid)</td>
        </tr>
        <tr>
          <td id="L5753" data-line-number="5753"></td>
          <td id="LC5753">            pvArrayAllocate uRetVal.KeyBlob, uEccKeyInfo.PrivateKey.cbData, FUNC_NAME &amp; &#34;.uRetVal.KeyBlob&#34;</td>
        </tr>
        <tr>
          <td id="L5754" data-line-number="5754"></td>
          <td id="LC5754">            Call CopyMemory(uRetVal.KeyBlob(0), ByVal uEccKeyInfo.PrivateKey.pbData, uEccKeyInfo.PrivateKey.cbData)</td>
        </tr>
        <tr>
          <td id="L5755" data-line-number="5755"></td>
          <td id="LC5755">        ElseIf Err.LastDllError = ERROR_FILE_NOT_FOUND Then</td>
        </tr>
        <tr>
          <td id="L5756" data-line-number="5756"></td>
          <td id="LC5756">            &#39;--- no X509_ECC_PRIVATE_KEY struct type on NT4 -&gt; decode in a wildly speculative way</td>
        </tr>
        <tr>
          <td id="L5757" data-line-number="5757"></td>
          <td id="LC5757">            Call CopyMemory(lSize, baPrivKey(6), 1)</td>
        </tr>
        <tr>
          <td id="L5758" data-line-number="5758"></td>
          <td id="LC5758">            If 7 + lSize &lt;= UBound(baPrivKey) Then</td>
        </tr>
        <tr>
          <td id="L5759" data-line-number="5759"></td>
          <td id="LC5759">                uRetVal.AlgoObjId = szOID_ECC_CURVE_P256</td>
        </tr>
        <tr>
          <td id="L5760" data-line-number="5760"></td>
          <td id="LC5760">                pvArrayAllocate uRetVal.KeyBlob, lSize, FUNC_NAME &amp; &#34;.uRetVal.KeyBlob&#34;</td>
        </tr>
        <tr>
          <td id="L5761" data-line-number="5761"></td>
          <td id="LC5761">                Call CopyMemory(uRetVal.KeyBlob(0), baPrivKey(7), lSize)</td>
        </tr>
        <tr>
          <td id="L5762" data-line-number="5762"></td>
          <td id="LC5762">            Else</td>
        </tr>
        <tr>
          <td id="L5763" data-line-number="5763"></td>
          <td id="LC5763">                hResult = ERROR_FILE_NOT_FOUND</td>
        </tr>
        <tr>
          <td id="L5764" data-line-number="5764"></td>
          <td id="LC5764">                sApiSource = &#34;CryptDecodeObjectEx(X509_ECC_PRIVATE_KEY)&#34;</td>
        </tr>
        <tr>
          <td id="L5765" data-line-number="5765"></td>
          <td id="LC5765">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L5766" data-line-number="5766"></td>
          <td id="LC5766">            End If</td>
        </tr>
        <tr>
          <td id="L5767" data-line-number="5767"></td>
          <td id="LC5767">        Else</td>
        </tr>
        <tr>
          <td id="L5768" data-line-number="5768"></td>
          <td id="LC5768">            &#39;--- unsupported private key</td>
        </tr>
        <tr>
          <td id="L5769" data-line-number="5769"></td>
          <td id="LC5769">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5770" data-line-number="5770"></td>
          <td id="LC5770">        End If</td>
        </tr>
        <tr>
          <td id="L5771" data-line-number="5771"></td>
          <td id="LC5771">    End If</td>
        </tr>
        <tr>
          <td id="L5772" data-line-number="5772"></td>
          <td id="LC5772">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5773" data-line-number="5773"></td>
          <td id="LC5773">    pvAsn1DecodePrivateKey = True</td>
        </tr>
        <tr>
          <td id="L5774" data-line-number="5774"></td>
          <td id="LC5774">QH:</td>
        </tr>
        <tr>
          <td id="L5775" data-line-number="5775"></td>
          <td id="LC5775">    If lKeyPtr &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5776" data-line-number="5776"></td>
          <td id="LC5776">        Call LocalFree(lKeyPtr)</td>
        </tr>
        <tr>
          <td id="L5777" data-line-number="5777"></td>
          <td id="LC5777">    End If</td>
        </tr>
        <tr>
          <td id="L5778" data-line-number="5778"></td>
          <td id="LC5778">    If lPkiPtr &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5779" data-line-number="5779"></td>
          <td id="LC5779">        Call LocalFree(lPkiPtr)</td>
        </tr>
        <tr>
          <td id="L5780" data-line-number="5780"></td>
          <td id="LC5780">    End If</td>
        </tr>
        <tr>
          <td id="L5781" data-line-number="5781"></td>
          <td id="LC5781">    If hProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5782" data-line-number="5782"></td>
          <td id="LC5782">        Call CryptReleaseContext(hProv, 0)</td>
        </tr>
        <tr>
          <td id="L5783" data-line-number="5783"></td>
          <td id="LC5783">    End If</td>
        </tr>
        <tr>
          <td id="L5784" data-line-number="5784"></td>
          <td id="LC5784">    If hNProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5785" data-line-number="5785"></td>
          <td id="LC5785">        Call NCryptFreeObject(hNProv)</td>
        </tr>
        <tr>
          <td id="L5786" data-line-number="5786"></td>
          <td id="LC5786">    End If</td>
        </tr>
        <tr>
          <td id="L5787" data-line-number="5787"></td>
          <td id="LC5787">    If LenB(sApiSource) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5788" data-line-number="5788"></td>
          <td id="LC5788">        ErrRaise IIf(hResult &lt; 0, hResult, hResult Or LNG_FACILITY_WIN32), FUNC_NAME &amp; &#34;.&#34; &amp; sApiSource</td>
        </tr>
        <tr>
          <td id="L5789" data-line-number="5789"></td>
          <td id="LC5789">    End If</td>
        </tr>
        <tr>
          <td id="L5790" data-line-number="5790"></td>
          <td id="LC5790">End Function</td>
        </tr>
        <tr>
          <td id="L5791" data-line-number="5791"></td>
          <td id="LC5791">
</td>
        </tr>
        <tr>
          <td id="L5792" data-line-number="5792"></td>
          <td id="LC5792">Private Function pvAsn1DecodeCertificate(baCert() As Byte, uRetVal As UcsKeyInfo) As Boolean</td>
        </tr>
        <tr>
          <td id="L5793" data-line-number="5793"></td>
          <td id="LC5793">    Const FUNC_NAME     As String = &#34;Asn1DecodeCertificate&#34;</td>
        </tr>
        <tr>
          <td id="L5794" data-line-number="5794"></td>
          <td id="LC5794">    Dim pCertContext    As Long</td>
        </tr>
        <tr>
          <td id="L5795" data-line-number="5795"></td>
          <td id="LC5795">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L5796" data-line-number="5796"></td>
          <td id="LC5796">    Dim uPublicKeyInfo  As CERT_PUBLIC_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L5797" data-line-number="5797"></td>
          <td id="LC5797">    Dim hProv           As Long</td>
        </tr>
        <tr>
          <td id="L5798" data-line-number="5798"></td>
          <td id="LC5798">    Dim hKey            As Long</td>
        </tr>
        <tr>
          <td id="L5799" data-line-number="5799"></td>
          <td id="LC5799">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L5800" data-line-number="5800"></td>
          <td id="LC5800">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L5801" data-line-number="5801"></td>
          <td id="LC5801">    Dim hResult         As Long</td>
        </tr>
        <tr>
          <td id="L5802" data-line-number="5802"></td>
          <td id="LC5802">    Dim sApiSource      As String</td>
        </tr>
        <tr>
          <td id="L5803" data-line-number="5803"></td>
          <td id="LC5803">
</td>
        </tr>
        <tr>
          <td id="L5804" data-line-number="5804"></td>
          <td id="LC5804">    pCertContext = CertCreateCertificateContext(X509_ASN_ENCODING Or PKCS_7_ASN_ENCODING, baCert(0), UBound(baCert) + 1)</td>
        </tr>
        <tr>
          <td id="L5805" data-line-number="5805"></td>
          <td id="LC5805">    If pCertContext = 0 Then</td>
        </tr>
        <tr>
          <td id="L5806" data-line-number="5806"></td>
          <td id="LC5806">        hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L5807" data-line-number="5807"></td>
          <td id="LC5807">        sApiSource = &#34;CertCreateCertificateContext&#34;</td>
        </tr>
        <tr>
          <td id="L5808" data-line-number="5808"></td>
          <td id="LC5808">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5809" data-line-number="5809"></td>
          <td id="LC5809">    End If</td>
        </tr>
        <tr>
          <td id="L5810" data-line-number="5810"></td>
          <td id="LC5810">    Call CopyMemory(lPtr, ByVal UnsignedAdd(pCertContext, 12), LenB(lPtr))  &#39;--- dereference pCertContext-&gt;pCertInfo</td>
        </tr>
        <tr>
          <td id="L5811" data-line-number="5811"></td>
          <td id="LC5811">    lPtr = UnsignedAdd(lPtr, 56)                                            &#39;--- &amp;pCertContext-&gt;pCertInfo-&gt;SubjectPublicKeyInfo</td>
        </tr>
        <tr>
          <td id="L5812" data-line-number="5812"></td>
          <td id="LC5812">    Call CopyMemory(uPublicKeyInfo, ByVal lPtr, LenB(uPublicKeyInfo))</td>
        </tr>
        <tr>
          <td id="L5813" data-line-number="5813"></td>
          <td id="LC5813">    uRetVal.AlgoObjId = pvToStringA(uPublicKeyInfo.Algorithm.pszObjId)</td>
        </tr>
        <tr>
          <td id="L5814" data-line-number="5814"></td>
          <td id="LC5814">    pvArrayAllocate uRetVal.KeyBlob, uPublicKeyInfo.PublicKey.cbData, FUNC_NAME &amp; &#34;.uRetVal.KeyBlob&#34;</td>
        </tr>
        <tr>
          <td id="L5815" data-line-number="5815"></td>
          <td id="LC5815">    Call CopyMemory(uRetVal.KeyBlob(0), ByVal uPublicKeyInfo.PublicKey.pbData, uPublicKeyInfo.PublicKey.cbData)</td>
        </tr>
        <tr>
          <td id="L5816" data-line-number="5816"></td>
          <td id="LC5816">    If uRetVal.AlgoObjId = szOID_RSA_RSA Then</td>
        </tr>
        <tr>
          <td id="L5817" data-line-number="5817"></td>
          <td id="LC5817">        If CryptAcquireContext(hProv, 0, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5818" data-line-number="5818"></td>
          <td id="LC5818">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5819" data-line-number="5819"></td>
          <td id="LC5819">        End If</td>
        </tr>
        <tr>
          <td id="L5820" data-line-number="5820"></td>
          <td id="LC5820">        If CryptImportPublicKeyInfo(hProv, X509_ASN_ENCODING Or PKCS_7_ASN_ENCODING, ByVal lPtr, hKey) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5821" data-line-number="5821"></td>
          <td id="LC5821">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5822" data-line-number="5822"></td>
          <td id="LC5822">        End If</td>
        </tr>
        <tr>
          <td id="L5823" data-line-number="5823"></td>
          <td id="LC5823">        If CryptExportKey(hKey, 0, PUBLICKEYBLOB, 0, ByVal 0, lSize) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5824" data-line-number="5824"></td>
          <td id="LC5824">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5825" data-line-number="5825"></td>
          <td id="LC5825">        End If</td>
        </tr>
        <tr>
          <td id="L5826" data-line-number="5826"></td>
          <td id="LC5826">        pvArrayAllocate baBuffer, lSize, FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L5827" data-line-number="5827"></td>
          <td id="LC5827">        If CryptExportKey(hKey, 0, PUBLICKEYBLOB, 0, baBuffer(0), lSize) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5828" data-line-number="5828"></td>
          <td id="LC5828">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5829" data-line-number="5829"></td>
          <td id="LC5829">        End If</td>
        </tr>
        <tr>
          <td id="L5830" data-line-number="5830"></td>
          <td id="LC5830">        &#39;--- retrieve RSA key size (in bits)</td>
        </tr>
        <tr>
          <td id="L5831" data-line-number="5831"></td>
          <td id="LC5831">        Debug.Assert UBound(baBuffer) &gt;= 16</td>
        </tr>
        <tr>
          <td id="L5832" data-line-number="5832"></td>
          <td id="LC5832">        Call CopyMemory(uRetVal.BitLen, baBuffer(12), LenB(uRetVal.BitLen))                     &#39;--- 12 = sizeof(PUBLICKEYSTRUC) + offset(RSAPUBKEY, bitlen)</td>
        </tr>
        <tr>
          <td id="L5833" data-line-number="5833"></td>
          <td id="LC5833">        lSize = (uRetVal.BitLen + 7) \ 8</td>
        </tr>
        <tr>
          <td id="L5834" data-line-number="5834"></td>
          <td id="LC5834">        &#39;--- retrieve RSA public exponent</td>
        </tr>
        <tr>
          <td id="L5835" data-line-number="5835"></td>
          <td id="LC5835">        pvArrayAllocate uRetVal.PubExp, 4, FUNC_NAME &amp; &#34;.uRetVal.PubExp&#34;</td>
        </tr>
        <tr>
          <td id="L5836" data-line-number="5836"></td>
          <td id="LC5836">        Debug.Assert UBound(baBuffer) - 16 &gt;= UBound(uRetVal.PubExp)</td>
        </tr>
        <tr>
          <td id="L5837" data-line-number="5837"></td>
          <td id="LC5837">        Call CopyMemory(uRetVal.PubExp(0), baBuffer(16), UBound(uRetVal.PubExp) + 1)            &#39;--- 16 = sizeof(PUBLICKEYSTRUC) + offset(RSAPUBKEY, pubexp)</td>
        </tr>
        <tr>
          <td id="L5838" data-line-number="5838"></td>
          <td id="LC5838">        pvArrayReverse uRetVal.PubExp, lSize</td>
        </tr>
        <tr>
          <td id="L5839" data-line-number="5839"></td>
          <td id="LC5839">        &#39;--- retrieve RSA key modulus</td>
        </tr>
        <tr>
          <td id="L5840" data-line-number="5840"></td>
          <td id="LC5840">        pvArrayAllocate uRetVal.Modulus, lSize, FUNC_NAME &amp; &#34;.uRetVal.Modulus&#34;</td>
        </tr>
        <tr>
          <td id="L5841" data-line-number="5841"></td>
          <td id="LC5841">        Debug.Assert UBound(baBuffer) - 20 &gt;= UBound(uRetVal.Modulus)</td>
        </tr>
        <tr>
          <td id="L5842" data-line-number="5842"></td>
          <td id="LC5842">        Call CopyMemory(uRetVal.Modulus(0), baBuffer(20), UBound(uRetVal.Modulus) + 1)          &#39;--- 20 = sizeof(PUBLICKEYSTRUC) + sizeof(RSAPUBKEY)</td>
        </tr>
        <tr>
          <td id="L5843" data-line-number="5843"></td>
          <td id="LC5843">        pvArrayReverse uRetVal.Modulus</td>
        </tr>
        <tr>
          <td id="L5844" data-line-number="5844"></td>
          <td id="LC5844">    End If</td>
        </tr>
        <tr>
          <td id="L5845" data-line-number="5845"></td>
          <td id="LC5845">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5846" data-line-number="5846"></td>
          <td id="LC5846">    pvAsn1DecodeCertificate = True</td>
        </tr>
        <tr>
          <td id="L5847" data-line-number="5847"></td>
          <td id="LC5847">QH:</td>
        </tr>
        <tr>
          <td id="L5848" data-line-number="5848"></td>
          <td id="LC5848">    If hKey &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5849" data-line-number="5849"></td>
          <td id="LC5849">        Call CryptDestroyKey(hKey)</td>
        </tr>
        <tr>
          <td id="L5850" data-line-number="5850"></td>
          <td id="LC5850">    End If</td>
        </tr>
        <tr>
          <td id="L5851" data-line-number="5851"></td>
          <td id="LC5851">    If hProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5852" data-line-number="5852"></td>
          <td id="LC5852">        Call CryptReleaseContext(hProv, 0)</td>
        </tr>
        <tr>
          <td id="L5853" data-line-number="5853"></td>
          <td id="LC5853">    End If</td>
        </tr>
        <tr>
          <td id="L5854" data-line-number="5854"></td>
          <td id="LC5854">    If pCertContext &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5855" data-line-number="5855"></td>
          <td id="LC5855">        Call CertFreeCertificateContext(pCertContext)</td>
        </tr>
        <tr>
          <td id="L5856" data-line-number="5856"></td>
          <td id="LC5856">    End If</td>
        </tr>
        <tr>
          <td id="L5857" data-line-number="5857"></td>
          <td id="LC5857">    If LenB(sApiSource) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5858" data-line-number="5858"></td>
          <td id="LC5858">        ErrRaise IIf(hResult &lt; 0, hResult, hResult Or LNG_FACILITY_WIN32), FUNC_NAME &amp; &#34;.&#34; &amp; sApiSource</td>
        </tr>
        <tr>
          <td id="L5859" data-line-number="5859"></td>
          <td id="LC5859">    End If</td>
        </tr>
        <tr>
          <td id="L5860" data-line-number="5860"></td>
          <td id="LC5860">End Function</td>
        </tr>
        <tr>
          <td id="L5861" data-line-number="5861"></td>
          <td id="LC5861">
</td>
        </tr>
        <tr>
          <td id="L5862" data-line-number="5862"></td>
          <td id="LC5862">Private Function pvAsn1EncodePkcs1Signature(baHash() As Byte, baRetVal() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L5863" data-line-number="5863"></td>
          <td id="LC5863">    Const FUNC_NAME     As String = &#34;Asn1EncodePkcs1Signature&#34;</td>
        </tr>
        <tr>
          <td id="L5864" data-line-number="5864"></td>
          <td id="LC5864">    Dim baPrefix()      As Byte</td>
        </tr>
        <tr>
          <td id="L5865" data-line-number="5865"></td>
          <td id="LC5865">    </td>
        </tr>
        <tr>
          <td id="L5866" data-line-number="5866"></td>
          <td id="LC5866">    Select Case UBound(baHash) + 1</td>
        </tr>
        <tr>
          <td id="L5867" data-line-number="5867"></td>
          <td id="LC5867">    Case LNG_SHA1_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5868" data-line-number="5868"></td>
          <td id="LC5868">        pvArrayByte baPrefix, &amp;H30, &amp;H21, &amp;H30, &amp;H9, &amp;H6, &amp;H5, &amp;H2B, &amp;HE, &amp;H3, &amp;H2, &amp;H1A, &amp;H5, &amp;H0, &amp;H4, &amp;H14</td>
        </tr>
        <tr>
          <td id="L5869" data-line-number="5869"></td>
          <td id="LC5869">    Case LNG_SHA224_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5870" data-line-number="5870"></td>
          <td id="LC5870">        pvArrayByte baPrefix, &amp;H30, &amp;H2D, &amp;H30, &amp;HD, &amp;H6, &amp;H9, &amp;H60, &amp;H86, &amp;H48, &amp;H1, &amp;H65, &amp;H3, &amp;H4, &amp;H2, &amp;H4, &amp;H5, &amp;H0, &amp;H4, &amp;H1C</td>
        </tr>
        <tr>
          <td id="L5871" data-line-number="5871"></td>
          <td id="LC5871">    Case LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5872" data-line-number="5872"></td>
          <td id="LC5872">        pvArrayByte baPrefix, &amp;H30, &amp;H31, &amp;H30, &amp;HD, &amp;H6, &amp;H9, &amp;H60, &amp;H86, &amp;H48, &amp;H1, &amp;H65, &amp;H3, &amp;H4, &amp;H2, &amp;H1, &amp;H5, &amp;H0, &amp;H4, &amp;H20</td>
        </tr>
        <tr>
          <td id="L5873" data-line-number="5873"></td>
          <td id="LC5873">    Case LNG_SHA384_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5874" data-line-number="5874"></td>
          <td id="LC5874">        pvArrayByte baPrefix, &amp;H30, &amp;H41, &amp;H30, &amp;HD, &amp;H6, &amp;H9, &amp;H60, &amp;H86, &amp;H48, &amp;H1, &amp;H65, &amp;H3, &amp;H4, &amp;H2, &amp;H2, &amp;H5, &amp;H0, &amp;H4, &amp;H30</td>
        </tr>
        <tr>
          <td id="L5875" data-line-number="5875"></td>
          <td id="LC5875">    Case LNG_SHA512_HASHSZ</td>
        </tr>
        <tr>
          <td id="L5876" data-line-number="5876"></td>
          <td id="LC5876">        pvArrayByte baPrefix, &amp;H30, &amp;H51, &amp;H30, &amp;HD, &amp;H6, &amp;H9, &amp;H60, &amp;H86, &amp;H48, &amp;H1, &amp;H65, &amp;H3, &amp;H4, &amp;H2, &amp;H3, &amp;H5, &amp;H0, &amp;H4, &amp;H40</td>
        </tr>
        <tr>
          <td id="L5877" data-line-number="5877"></td>
          <td id="LC5877">    End Select</td>
        </tr>
        <tr>
          <td id="L5878" data-line-number="5878"></td>
          <td id="LC5878">    pvArrayAllocate baRetVal, UBound(baPrefix) + UBound(baHash) + 2, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L5879" data-line-number="5879"></td>
          <td id="LC5879">    Call CopyMemory(baRetVal(0), baPrefix(0), UBound(baPrefix) + 1)</td>
        </tr>
        <tr>
          <td id="L5880" data-line-number="5880"></td>
          <td id="LC5880">    Call CopyMemory(baRetVal(UBound(baPrefix) + 1), baHash(0), UBound(baHash) + 1)</td>
        </tr>
        <tr>
          <td id="L5881" data-line-number="5881"></td>
          <td id="LC5881">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5882" data-line-number="5882"></td>
          <td id="LC5882">    pvAsn1EncodePkcs1Signature = True</td>
        </tr>
        <tr>
          <td id="L5883" data-line-number="5883"></td>
          <td id="LC5883">QH:</td>
        </tr>
        <tr>
          <td id="L5884" data-line-number="5884"></td>
          <td id="LC5884">End Function</td>
        </tr>
        <tr>
          <td id="L5885" data-line-number="5885"></td>
          <td id="LC5885">
</td>
        </tr>
        <tr>
          <td id="L5886" data-line-number="5886"></td>
          <td id="LC5886">Private Function pvAsn1DecodeEcdsaSignature(baRetVal() As Byte, baDerSig() As Byte, ByVal lCurveSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5887" data-line-number="5887"></td>
          <td id="LC5887">    Dim uOutput         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L5888" data-line-number="5888"></td>
          <td id="LC5888">    Dim uInput          As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L5889" data-line-number="5889"></td>
          <td id="LC5889">    Dim lType           As Long</td>
        </tr>
        <tr>
          <td id="L5890" data-line-number="5890"></td>
          <td id="LC5890">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L5891" data-line-number="5891"></td>
          <td id="LC5891">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L5892" data-line-number="5892"></td>
          <td id="LC5892">    </td>
        </tr>
        <tr>
          <td id="L5893" data-line-number="5893"></td>
          <td id="LC5893">    pvArraySwap uInput.Data, 0, baDerSig, 0</td>
        </tr>
        <tr>
          <td id="L5894" data-line-number="5894"></td>
          <td id="LC5894">    &#39;--- ECDSA-Sig-Value ::= SEQUENCE { r INTEGER, s INTEGER }</td>
        </tr>
        <tr>
          <td id="L5895" data-line-number="5895"></td>
          <td id="LC5895">    pvBufferReadLong uInput, lType</td>
        </tr>
        <tr>
          <td id="L5896" data-line-number="5896"></td>
          <td id="LC5896">    If lType &lt;&gt; LNG_ANS1_TYPE_SEQUENCE Then</td>
        </tr>
        <tr>
          <td id="L5897" data-line-number="5897"></td>
          <td id="LC5897">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5898" data-line-number="5898"></td>
          <td id="LC5898">    End If</td>
        </tr>
        <tr>
          <td id="L5899" data-line-number="5899"></td>
          <td id="LC5899">    If uInput.Pos &lt;= UBound(uInput.Data) Then</td>
        </tr>
        <tr>
          <td id="L5900" data-line-number="5900"></td>
          <td id="LC5900">        lSize = uInput.Data(uInput.Pos)</td>
        </tr>
        <tr>
          <td id="L5901" data-line-number="5901"></td>
          <td id="LC5901">    End If</td>
        </tr>
        <tr>
          <td id="L5902" data-line-number="5902"></td>
          <td id="LC5902">    &#39;--- check for long form encoding of length of sequence</td>
        </tr>
        <tr>
          <td id="L5903" data-line-number="5903"></td>
          <td id="LC5903">    If lSize &gt; &amp;H83 Then</td>
        </tr>
        <tr>
          <td id="L5904" data-line-number="5904"></td>
          <td id="LC5904">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L5905" data-line-number="5905"></td>
          <td id="LC5905">    ElseIf lSize &gt; &amp;H80 Then</td>
        </tr>
        <tr>
          <td id="L5906" data-line-number="5906"></td>
          <td id="LC5906">        lSize = lSize - &amp;H80 + 1</td>
        </tr>
        <tr>
          <td id="L5907" data-line-number="5907"></td>
          <td id="LC5907">        uInput.Data(uInput.Pos) = 0</td>
        </tr>
        <tr>
          <td id="L5908" data-line-number="5908"></td>
          <td id="LC5908">    Else</td>
        </tr>
        <tr>
          <td id="L5909" data-line-number="5909"></td>
          <td id="LC5909">        lSize = 1</td>
        </tr>
        <tr>
          <td id="L5910" data-line-number="5910"></td>
          <td id="LC5910">    End If</td>
        </tr>
        <tr>
          <td id="L5911" data-line-number="5911"></td>
          <td id="LC5911">    pvBufferReadBlockStart uInput, Size:=lSize</td>
        </tr>
        <tr>
          <td id="L5912" data-line-number="5912"></td>
          <td id="LC5912">        pvBufferReadLong uInput, lType</td>
        </tr>
        <tr>
          <td id="L5913" data-line-number="5913"></td>
          <td id="LC5913">        If lType &lt;&gt; LNG_ANS1_TYPE_INTEGER Then</td>
        </tr>
        <tr>
          <td id="L5914" data-line-number="5914"></td>
          <td id="LC5914">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5915" data-line-number="5915"></td>
          <td id="LC5915">        End If</td>
        </tr>
        <tr>
          <td id="L5916" data-line-number="5916"></td>
          <td id="LC5916">        pvBufferReadLong uInput, lSize</td>
        </tr>
        <tr>
          <td id="L5917" data-line-number="5917"></td>
          <td id="LC5917">        pvBufferReadArray uInput, baTemp, lSize</td>
        </tr>
        <tr>
          <td id="L5918" data-line-number="5918"></td>
          <td id="LC5918">        If lSize &lt;= lCurveSize Then</td>
        </tr>
        <tr>
          <td id="L5919" data-line-number="5919"></td>
          <td id="LC5919">            uOutput.Size = lCurveSize - lSize</td>
        </tr>
        <tr>
          <td id="L5920" data-line-number="5920"></td>
          <td id="LC5920">            pvBufferWriteArray uOutput, baTemp</td>
        </tr>
        <tr>
          <td id="L5921" data-line-number="5921"></td>
          <td id="LC5921">        Else</td>
        </tr>
        <tr>
          <td id="L5922" data-line-number="5922"></td>
          <td id="LC5922">            uOutput.Size = 0</td>
        </tr>
        <tr>
          <td id="L5923" data-line-number="5923"></td>
          <td id="LC5923">            pvBufferWriteBlob uOutput, VarPtr(baTemp(lSize - lCurveSize)), lCurveSize</td>
        </tr>
        <tr>
          <td id="L5924" data-line-number="5924"></td>
          <td id="LC5924">        End If</td>
        </tr>
        <tr>
          <td id="L5925" data-line-number="5925"></td>
          <td id="LC5925">        pvBufferReadLong uInput, lType</td>
        </tr>
        <tr>
          <td id="L5926" data-line-number="5926"></td>
          <td id="LC5926">        If lType &lt;&gt; LNG_ANS1_TYPE_INTEGER Then</td>
        </tr>
        <tr>
          <td id="L5927" data-line-number="5927"></td>
          <td id="LC5927">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5928" data-line-number="5928"></td>
          <td id="LC5928">        End If</td>
        </tr>
        <tr>
          <td id="L5929" data-line-number="5929"></td>
          <td id="LC5929">        pvBufferReadLong uInput, lSize</td>
        </tr>
        <tr>
          <td id="L5930" data-line-number="5930"></td>
          <td id="LC5930">        pvBufferReadArray uInput, baTemp, lSize</td>
        </tr>
        <tr>
          <td id="L5931" data-line-number="5931"></td>
          <td id="LC5931">        If lSize &lt;= lCurveSize Then</td>
        </tr>
        <tr>
          <td id="L5932" data-line-number="5932"></td>
          <td id="LC5932">            uOutput.Size = lCurveSize + lCurveSize - lSize</td>
        </tr>
        <tr>
          <td id="L5933" data-line-number="5933"></td>
          <td id="LC5933">            pvBufferWriteArray uOutput, baTemp</td>
        </tr>
        <tr>
          <td id="L5934" data-line-number="5934"></td>
          <td id="LC5934">        Else</td>
        </tr>
        <tr>
          <td id="L5935" data-line-number="5935"></td>
          <td id="LC5935">            uOutput.Size = lCurveSize</td>
        </tr>
        <tr>
          <td id="L5936" data-line-number="5936"></td>
          <td id="LC5936">            pvBufferWriteBlob uOutput, VarPtr(baTemp(lSize - lCurveSize)), lCurveSize</td>
        </tr>
        <tr>
          <td id="L5937" data-line-number="5937"></td>
          <td id="LC5937">        End If</td>
        </tr>
        <tr>
          <td id="L5938" data-line-number="5938"></td>
          <td id="LC5938">        If uInput.Stack(1) &lt;&gt; uInput.Pos Then</td>
        </tr>
        <tr>
          <td id="L5939" data-line-number="5939"></td>
          <td id="LC5939">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L5940" data-line-number="5940"></td>
          <td id="LC5940">        End If</td>
        </tr>
        <tr>
          <td id="L5941" data-line-number="5941"></td>
          <td id="LC5941">    pvBufferReadBlockEnd uInput</td>
        </tr>
        <tr>
          <td id="L5942" data-line-number="5942"></td>
          <td id="LC5942">    pvBufferWriteEOF uOutput</td>
        </tr>
        <tr>
          <td id="L5943" data-line-number="5943"></td>
          <td id="LC5943">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5944" data-line-number="5944"></td>
          <td id="LC5944">    pvAsn1DecodeEcdsaSignature = True</td>
        </tr>
        <tr>
          <td id="L5945" data-line-number="5945"></td>
          <td id="LC5945">QH:</td>
        </tr>
        <tr>
          <td id="L5946" data-line-number="5946"></td>
          <td id="LC5946">    pvArraySwap baDerSig, 0, uInput.Data, 0</td>
        </tr>
        <tr>
          <td id="L5947" data-line-number="5947"></td>
          <td id="LC5947">    baRetVal = uOutput.Data</td>
        </tr>
        <tr>
          <td id="L5948" data-line-number="5948"></td>
          <td id="LC5948">End Function</td>
        </tr>
        <tr>
          <td id="L5949" data-line-number="5949"></td>
          <td id="LC5949">
</td>
        </tr>
        <tr>
          <td id="L5950" data-line-number="5950"></td>
          <td id="LC5950">Private Function pvAsn1EncodeEcdsaSignature(baRetVal() As Byte, baPlainSig() As Byte, ByVal lPartSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L5951" data-line-number="5951"></td>
          <td id="LC5951">    Dim uOutput         As UcsBuffer</td>
        </tr>
        <tr>
          <td id="L5952" data-line-number="5952"></td>
          <td id="LC5952">    Dim lStart          As Long</td>
        </tr>
        <tr>
          <td id="L5953" data-line-number="5953"></td>
          <td id="LC5953">    </td>
        </tr>
        <tr>
          <td id="L5954" data-line-number="5954"></td>
          <td id="LC5954">    pvBufferWriteLong uOutput, LNG_ANS1_TYPE_SEQUENCE</td>
        </tr>
        <tr>
          <td id="L5955" data-line-number="5955"></td>
          <td id="LC5955">    pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L5956" data-line-number="5956"></td>
          <td id="LC5956">        pvBufferWriteLong uOutput, LNG_ANS1_TYPE_INTEGER</td>
        </tr>
        <tr>
          <td id="L5957" data-line-number="5957"></td>
          <td id="LC5957">        pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L5958" data-line-number="5958"></td>
          <td id="LC5958">            For lStart = 0 To lPartSize - 1</td>
        </tr>
        <tr>
          <td id="L5959" data-line-number="5959"></td>
          <td id="LC5959">                If baPlainSig(lStart) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5960" data-line-number="5960"></td>
          <td id="LC5960">                    Exit For</td>
        </tr>
        <tr>
          <td id="L5961" data-line-number="5961"></td>
          <td id="LC5961">                End If</td>
        </tr>
        <tr>
          <td id="L5962" data-line-number="5962"></td>
          <td id="LC5962">            Next</td>
        </tr>
        <tr>
          <td id="L5963" data-line-number="5963"></td>
          <td id="LC5963">            If (baPlainSig(lStart) And &amp;H80) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5964" data-line-number="5964"></td>
          <td id="LC5964">                pvBufferWriteLong uOutput, 0</td>
        </tr>
        <tr>
          <td id="L5965" data-line-number="5965"></td>
          <td id="LC5965">            End If</td>
        </tr>
        <tr>
          <td id="L5966" data-line-number="5966"></td>
          <td id="LC5966">            pvBufferWriteBlob uOutput, VarPtr(baPlainSig(lStart)), lPartSize - lStart</td>
        </tr>
        <tr>
          <td id="L5967" data-line-number="5967"></td>
          <td id="LC5967">        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L5968" data-line-number="5968"></td>
          <td id="LC5968">        pvBufferWriteLong uOutput, LNG_ANS1_TYPE_INTEGER</td>
        </tr>
        <tr>
          <td id="L5969" data-line-number="5969"></td>
          <td id="LC5969">        pvBufferWriteBlockStart uOutput</td>
        </tr>
        <tr>
          <td id="L5970" data-line-number="5970"></td>
          <td id="LC5970">            For lStart = 0 To lPartSize - 1</td>
        </tr>
        <tr>
          <td id="L5971" data-line-number="5971"></td>
          <td id="LC5971">                If baPlainSig(lPartSize + lStart) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5972" data-line-number="5972"></td>
          <td id="LC5972">                    Exit For</td>
        </tr>
        <tr>
          <td id="L5973" data-line-number="5973"></td>
          <td id="LC5973">                End If</td>
        </tr>
        <tr>
          <td id="L5974" data-line-number="5974"></td>
          <td id="LC5974">            Next</td>
        </tr>
        <tr>
          <td id="L5975" data-line-number="5975"></td>
          <td id="LC5975">            If (baPlainSig(lPartSize + lStart) And &amp;H80) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L5976" data-line-number="5976"></td>
          <td id="LC5976">                pvBufferWriteLong uOutput, 0</td>
        </tr>
        <tr>
          <td id="L5977" data-line-number="5977"></td>
          <td id="LC5977">            End If</td>
        </tr>
        <tr>
          <td id="L5978" data-line-number="5978"></td>
          <td id="LC5978">            pvBufferWriteBlob uOutput, VarPtr(baPlainSig(lPartSize + lStart)), lPartSize - lStart</td>
        </tr>
        <tr>
          <td id="L5979" data-line-number="5979"></td>
          <td id="LC5979">        pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L5980" data-line-number="5980"></td>
          <td id="LC5980">    pvBufferWriteBlockEnd uOutput</td>
        </tr>
        <tr>
          <td id="L5981" data-line-number="5981"></td>
          <td id="LC5981">    pvBufferWriteEOF uOutput</td>
        </tr>
        <tr>
          <td id="L5982" data-line-number="5982"></td>
          <td id="LC5982">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L5983" data-line-number="5983"></td>
          <td id="LC5983">    pvAsn1EncodeEcdsaSignature = True</td>
        </tr>
        <tr>
          <td id="L5984" data-line-number="5984"></td>
          <td id="LC5984">    baRetVal = uOutput.Data</td>
        </tr>
        <tr>
          <td id="L5985" data-line-number="5985"></td>
          <td id="LC5985">End Function</td>
        </tr>
        <tr>
          <td id="L5986" data-line-number="5986"></td>
          <td id="LC5986">
</td>
        </tr>
        <tr>
          <td id="L5987" data-line-number="5987"></td>
          <td id="LC5987">Private Function pvCryptoInit() As Boolean</td>
        </tr>
        <tr>
          <td id="L5988" data-line-number="5988"></td>
          <td id="LC5988">    Const FUNC_NAME     As String = &#34;CryptoInit&#34;</td>
        </tr>
        <tr>
          <td id="L5989" data-line-number="5989"></td>
          <td id="LC5989">    Dim lOffset         As Long</td>
        </tr>
        <tr>
          <td id="L5990" data-line-number="5990"></td>
          <td id="LC5990">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L5991" data-line-number="5991"></td>
          <td id="LC5991">    Dim baThunk()       As Byte</td>
        </tr>
        <tr>
          <td id="L5992" data-line-number="5992"></td>
          <td id="LC5992">    Dim hResult         As Long</td>
        </tr>
        <tr>
          <td id="L5993" data-line-number="5993"></td>
          <td id="LC5993">    Dim sApiSource      As String</td>
        </tr>
        <tr>
          <td id="L5994" data-line-number="5994"></td>
          <td id="LC5994">    </td>
        </tr>
        <tr>
          <td id="L5995" data-line-number="5995"></td>
          <td id="LC5995">    With m_uData</td>
        </tr>
        <tr>
          <td id="L5996" data-line-number="5996"></td>
          <td id="LC5996">        If .hRandomProv = 0 Then</td>
        </tr>
        <tr>
          <td id="L5997" data-line-number="5997"></td>
          <td id="LC5997">            If CryptAcquireContext(.hRandomProv, 0, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT) = 0 Then</td>
        </tr>
        <tr>
          <td id="L5998" data-line-number="5998"></td>
          <td id="LC5998">                hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L5999" data-line-number="5999"></td>
          <td id="LC5999">                sApiSource = &#34;CryptAcquireContext&#34;</td>
        </tr>
        <tr>
          <td id="L6000" data-line-number="6000"></td>
          <td id="LC6000">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L6001" data-line-number="6001"></td>
          <td id="LC6001">            End If</td>
        </tr>
        <tr>
          <td id="L6002" data-line-number="6002"></td>
          <td id="LC6002">        End If</td>
        </tr>
        <tr>
          <td id="L6003" data-line-number="6003"></td>
          <td id="LC6003">        If m_uData.Thunk = 0 Then</td>
        </tr>
        <tr>
          <td id="L6004" data-line-number="6004"></td>
          <td id="LC6004">            &#39;--- prepare thunk/context in executable memory</td>
        </tr>
        <tr>
          <td id="L6005" data-line-number="6005"></td>
          <td id="LC6005">            pvGetThunkData baThunk</td>
        </tr>
        <tr>
          <td id="L6006" data-line-number="6006"></td>
          <td id="LC6006">            .Thunk = VirtualAlloc(0, UBound(baThunk) + 1, MEM_COMMIT, PAGE_EXECUTE_READWRITE)</td>
        </tr>
        <tr>
          <td id="L6007" data-line-number="6007"></td>
          <td id="LC6007">            If .Thunk = 0 Then</td>
        </tr>
        <tr>
          <td id="L6008" data-line-number="6008"></td>
          <td id="LC6008">                hResult = Err.LastDllError</td>
        </tr>
        <tr>
          <td id="L6009" data-line-number="6009"></td>
          <td id="LC6009">                sApiSource = &#34;VirtualAlloc&#34;</td>
        </tr>
        <tr>
          <td id="L6010" data-line-number="6010"></td>
          <td id="LC6010">                GoTo QH</td>
        </tr>
        <tr>
          <td id="L6011" data-line-number="6011"></td>
          <td id="LC6011">            End If</td>
        </tr>
        <tr>
          <td id="L6012" data-line-number="6012"></td>
          <td id="LC6012">            Call CopyMemory(ByVal .Thunk, baThunk(0), UBound(baThunk) + 1)</td>
        </tr>
        <tr>
          <td id="L6013" data-line-number="6013"></td>
          <td id="LC6013">            pvGetGlobData .Glob</td>
        </tr>
        <tr>
          <td id="L6014" data-line-number="6014"></td>
          <td id="LC6014">            &#39;--- init pfns from thunk addr + offsets stored at beginning of it</td>
        </tr>
        <tr>
          <td id="L6015" data-line-number="6015"></td>
          <td id="LC6015">            For lIdx = LBound(.Pfn) To UBound(.Pfn)</td>
        </tr>
        <tr>
          <td id="L6016" data-line-number="6016"></td>
          <td id="LC6016">                Call CopyMemory(lOffset, ByVal UnsignedAdd(.Thunk, LenB(lOffset) * lIdx), LenB(lOffset))</td>
        </tr>
        <tr>
          <td id="L6017" data-line-number="6017"></td>
          <td id="LC6017">                .Pfn(lIdx) = UnsignedAdd(.Thunk, lOffset)</td>
        </tr>
        <tr>
          <td id="L6018" data-line-number="6018"></td>
          <td id="LC6018">            Next</td>
        </tr>
        <tr>
          <td id="L6019" data-line-number="6019"></td>
          <td id="LC6019">            &#39;--- init pfns trampolines</td>
        </tr>
        <tr>
          <td id="L6020" data-line-number="6020"></td>
          <td id="LC6020">            Call pvPatchTrampoline(AddressOf pvCallSecpMakeKey)</td>
        </tr>
        <tr>
          <td id="L6021" data-line-number="6021"></td>
          <td id="LC6021">            Call pvPatchTrampoline(AddressOf pvCallSecpSharedSecret)</td>
        </tr>
        <tr>
          <td id="L6022" data-line-number="6022"></td>
          <td id="LC6022">            Call pvPatchTrampoline(AddressOf pvCallSecpUncompressKey)</td>
        </tr>
        <tr>
          <td id="L6023" data-line-number="6023"></td>
          <td id="LC6023">            Call pvPatchTrampoline(AddressOf pvCallSecpSign)</td>
        </tr>
        <tr>
          <td id="L6024" data-line-number="6024"></td>
          <td id="LC6024">            Call pvPatchTrampoline(AddressOf pvCallSecpVerify)</td>
        </tr>
        <tr>
          <td id="L6025" data-line-number="6025"></td>
          <td id="LC6025">            Call pvPatchTrampoline(AddressOf pvCallCurve25519Multiply)</td>
        </tr>
        <tr>
          <td id="L6026" data-line-number="6026"></td>
          <td id="LC6026">            Call pvPatchTrampoline(AddressOf pvCallCurve25519MulBase)</td>
        </tr>
        <tr>
          <td id="L6027" data-line-number="6027"></td>
          <td id="LC6027">            Call pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6028" data-line-number="6028"></td>
          <td id="LC6028">            Call pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6029" data-line-number="6029"></td>
          <td id="LC6029">            Call pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6030" data-line-number="6030"></td>
          <td id="LC6030">            Call pvPatchTrampoline(AddressOf pvCallChacha20Poly1305Encrypt)</td>
        </tr>
        <tr>
          <td id="L6031" data-line-number="6031"></td>
          <td id="LC6031">            Call pvPatchTrampoline(AddressOf pvCallChacha20Poly1305Decrypt)</td>
        </tr>
        <tr>
          <td id="L6032" data-line-number="6032"></td>
          <td id="LC6032">            Call pvPatchTrampoline(AddressOf pvCallAesGcmEncrypt)</td>
        </tr>
        <tr>
          <td id="L6033" data-line-number="6033"></td>
          <td id="LC6033">            Call pvPatchTrampoline(AddressOf pvCallAesGcmDecrypt)</td>
        </tr>
        <tr>
          <td id="L6034" data-line-number="6034"></td>
          <td id="LC6034">            Call pvPatchTrampoline(AddressOf pvCallAesCbcEncrypt)</td>
        </tr>
        <tr>
          <td id="L6035" data-line-number="6035"></td>
          <td id="LC6035">            Call pvPatchTrampoline(AddressOf pvCallAesCbcDecrypt)</td>
        </tr>
        <tr>
          <td id="L6036" data-line-number="6036"></td>
          <td id="LC6036">            Call pvPatchTrampoline(AddressOf pvCallRsaModExp)</td>
        </tr>
        <tr>
          <td id="L6037" data-line-number="6037"></td>
          <td id="LC6037">            Call pvPatchTrampoline(AddressOf pvCallRsaCrtModExp)</td>
        </tr>
        <tr>
          <td id="L6038" data-line-number="6038"></td>
          <td id="LC6038">            &#39;--- init thunk&#39;s first 4 bytes -&gt; global data in C/C++</td>
        </tr>
        <tr>
          <td id="L6039" data-line-number="6039"></td>
          <td id="LC6039">            Call CopyMemory(ByVal .Thunk, VarPtr(.Glob(0)), 4)</td>
        </tr>
        <tr>
          <td id="L6040" data-line-number="6040"></td>
          <td id="LC6040">            Call CopyMemory(.Glob(0), GetProcAddress(GetModuleHandle(StrPtr(&#34;ole32&#34;)), &#34;CoTaskMemAlloc&#34;), 4)</td>
        </tr>
        <tr>
          <td id="L6041" data-line-number="6041"></td>
          <td id="LC6041">            Call CopyMemory(.Glob(4), GetProcAddress(GetModuleHandle(StrPtr(&#34;ole32&#34;)), &#34;CoTaskMemRealloc&#34;), 4)</td>
        </tr>
        <tr>
          <td id="L6042" data-line-number="6042"></td>
          <td id="LC6042">            Call CopyMemory(.Glob(8), GetProcAddress(GetModuleHandle(StrPtr(&#34;ole32&#34;)), &#34;CoTaskMemFree&#34;), 4)</td>
        </tr>
        <tr>
          <td id="L6043" data-line-number="6043"></td>
          <td id="LC6043">        End If</td>
        </tr>
        <tr>
          <td id="L6044" data-line-number="6044"></td>
          <td id="LC6044">    End With</td>
        </tr>
        <tr>
          <td id="L6045" data-line-number="6045"></td>
          <td id="LC6045">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6046" data-line-number="6046"></td>
          <td id="LC6046">    pvCryptoInit = True</td>
        </tr>
        <tr>
          <td id="L6047" data-line-number="6047"></td>
          <td id="LC6047">QH:</td>
        </tr>
        <tr>
          <td id="L6048" data-line-number="6048"></td>
          <td id="LC6048">    If LenB(sApiSource) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6049" data-line-number="6049"></td>
          <td id="LC6049">        ErrRaise IIf(hResult &lt; 0, hResult, hResult Or LNG_FACILITY_WIN32), FUNC_NAME &amp; &#34;.&#34; &amp; sApiSource</td>
        </tr>
        <tr>
          <td id="L6050" data-line-number="6050"></td>
          <td id="LC6050">    End If</td>
        </tr>
        <tr>
          <td id="L6051" data-line-number="6051"></td>
          <td id="LC6051">End Function</td>
        </tr>
        <tr>
          <td id="L6052" data-line-number="6052"></td>
          <td id="LC6052">
</td>
        </tr>
        <tr>
          <td id="L6053" data-line-number="6053"></td>
          <td id="LC6053">#If False Then</td>
        </tr>
        <tr>
          <td id="L6054" data-line-number="6054"></td>
          <td id="LC6054">Public Sub pvCryptoTerminate()</td>
        </tr>
        <tr>
          <td id="L6055" data-line-number="6055"></td>
          <td id="LC6055">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6056" data-line-number="6056"></td>
          <td id="LC6056">        If .hRandomProv &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6057" data-line-number="6057"></td>
          <td id="LC6057">            Call CryptReleaseContext(.hRandomProv, 0)</td>
        </tr>
        <tr>
          <td id="L6058" data-line-number="6058"></td>
          <td id="LC6058">            .hRandomProv = 0</td>
        </tr>
        <tr>
          <td id="L6059" data-line-number="6059"></td>
          <td id="LC6059">        End If</td>
        </tr>
        <tr>
          <td id="L6060" data-line-number="6060"></td>
          <td id="LC6060">    End With</td>
        </tr>
        <tr>
          <td id="L6061" data-line-number="6061"></td>
          <td id="LC6061">End Sub</td>
        </tr>
        <tr>
          <td id="L6062" data-line-number="6062"></td>
          <td id="LC6062">#End If</td>
        </tr>
        <tr>
          <td id="L6063" data-line-number="6063"></td>
          <td id="LC6063">
</td>
        </tr>
        <tr>
          <td id="L6064" data-line-number="6064"></td>
          <td id="LC6064">Private Function pvCryptoEcdhCurve25519MakeKey(baPrivate() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6065" data-line-number="6065"></td>
          <td id="LC6065">    Const FUNC_NAME     As String = &#34;CryptoEcdhCurve25519MakeKey&#34;</td>
        </tr>
        <tr>
          <td id="L6066" data-line-number="6066"></td>
          <td id="LC6066">    Const MAX_RETRIES   As Long = 16</td>
        </tr>
        <tr>
          <td id="L6067" data-line-number="6067"></td>
          <td id="LC6067">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6068" data-line-number="6068"></td>
          <td id="LC6068">    </td>
        </tr>
        <tr>
          <td id="L6069" data-line-number="6069"></td>
          <td id="LC6069">    pvArrayAllocate baPrivate, LNG_X25519_KEYSZ, FUNC_NAME &amp; &#34;.baPrivate&#34;</td>
        </tr>
        <tr>
          <td id="L6070" data-line-number="6070"></td>
          <td id="LC6070">    pvArrayAllocate baPublic, LNG_X25519_KEYSZ, FUNC_NAME &amp; &#34;.baPublic&#34;</td>
        </tr>
        <tr>
          <td id="L6071" data-line-number="6071"></td>
          <td id="LC6071">    For lIdx = 1 To MAX_RETRIES</td>
        </tr>
        <tr>
          <td id="L6072" data-line-number="6072"></td>
          <td id="LC6072">        pvCryptoRandomBytes VarPtr(baPrivate(0)), LNG_X25519_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6073" data-line-number="6073"></td>
          <td id="LC6073">        If pvArrayAccumulateOr(baPrivate) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6074" data-line-number="6074"></td>
          <td id="LC6074">            Exit For</td>
        </tr>
        <tr>
          <td id="L6075" data-line-number="6075"></td>
          <td id="LC6075">        End If</td>
        </tr>
        <tr>
          <td id="L6076" data-line-number="6076"></td>
          <td id="LC6076">    Next</td>
        </tr>
        <tr>
          <td id="L6077" data-line-number="6077"></td>
          <td id="LC6077">    &#39;--- fix privkey randomness</td>
        </tr>
        <tr>
          <td id="L6078" data-line-number="6078"></td>
          <td id="LC6078">    baPrivate(0) = baPrivate(0) And &amp;HF8</td>
        </tr>
        <tr>
          <td id="L6079" data-line-number="6079"></td>
          <td id="LC6079">    baPrivate(LNG_X25519_KEYSZ - 1) = (baPrivate(LNG_X25519_KEYSZ - 1) And &amp;H7F) Or &amp;H40</td>
        </tr>
        <tr>
          <td id="L6080" data-line-number="6080"></td>
          <td id="LC6080">    Debug.Assert pvPatchTrampoline(AddressOf pvCallCurve25519MulBase)</td>
        </tr>
        <tr>
          <td id="L6081" data-line-number="6081"></td>
          <td id="LC6081">    pvCallCurve25519MulBase m_uData.Pfn(ucsPfnCurve25519ScalarMultBase), baPublic(0), baPrivate(0)</td>
        </tr>
        <tr>
          <td id="L6082" data-line-number="6082"></td>
          <td id="LC6082">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6083" data-line-number="6083"></td>
          <td id="LC6083">    pvCryptoEcdhCurve25519MakeKey = True</td>
        </tr>
        <tr>
          <td id="L6084" data-line-number="6084"></td>
          <td id="LC6084">End Function</td>
        </tr>
        <tr>
          <td id="L6085" data-line-number="6085"></td>
          <td id="LC6085">
</td>
        </tr>
        <tr>
          <td id="L6086" data-line-number="6086"></td>
          <td id="LC6086">Private Function pvCryptoEcdhCurve25519SharedSecret(baRetVal() As Byte, baPrivate() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6087" data-line-number="6087"></td>
          <td id="LC6087">    Const FUNC_NAME     As String = &#34;CryptoEcdhCurve25519SharedSecret&#34;</td>
        </tr>
        <tr>
          <td id="L6088" data-line-number="6088"></td>
          <td id="LC6088">    </td>
        </tr>
        <tr>
          <td id="L6089" data-line-number="6089"></td>
          <td id="LC6089">    If UBound(baPrivate) = LNG_X25519_KEYSZ - 1 And UBound(baPublic) = LNG_X25519_KEYSZ - 1 Then</td>
        </tr>
        <tr>
          <td id="L6090" data-line-number="6090"></td>
          <td id="LC6090">        pvArrayAllocate baRetVal, LNG_X25519_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6091" data-line-number="6091"></td>
          <td id="LC6091">        Debug.Assert pvPatchTrampoline(AddressOf pvCallCurve25519Multiply)</td>
        </tr>
        <tr>
          <td id="L6092" data-line-number="6092"></td>
          <td id="LC6092">        pvCallCurve25519Multiply m_uData.Pfn(ucsPfnCurve25519ScalarMultiply), baRetVal(0), baPrivate(0), baPublic(0)</td>
        </tr>
        <tr>
          <td id="L6093" data-line-number="6093"></td>
          <td id="LC6093">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6094" data-line-number="6094"></td>
          <td id="LC6094">        pvCryptoEcdhCurve25519SharedSecret = True</td>
        </tr>
        <tr>
          <td id="L6095" data-line-number="6095"></td>
          <td id="LC6095">    End If</td>
        </tr>
        <tr>
          <td id="L6096" data-line-number="6096"></td>
          <td id="LC6096">End Function</td>
        </tr>
        <tr>
          <td id="L6097" data-line-number="6097"></td>
          <td id="LC6097">
</td>
        </tr>
        <tr>
          <td id="L6098" data-line-number="6098"></td>
          <td id="LC6098">Private Function pvCryptoEcdhSecp256r1MakeKey(baPrivate() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6099" data-line-number="6099"></td>
          <td id="LC6099">    Const FUNC_NAME     As String = &#34;CryptoEcdhSecp256r1MakeKey&#34;</td>
        </tr>
        <tr>
          <td id="L6100" data-line-number="6100"></td>
          <td id="LC6100">    Const MAX_RETRIES   As Long = 16</td>
        </tr>
        <tr>
          <td id="L6101" data-line-number="6101"></td>
          <td id="LC6101">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6102" data-line-number="6102"></td>
          <td id="LC6102">    </td>
        </tr>
        <tr>
          <td id="L6103" data-line-number="6103"></td>
          <td id="LC6103">    pvArrayAllocate baPrivate, LNG_SECP256R1_KEYSZ, FUNC_NAME &amp; &#34;.baPrivate&#34;</td>
        </tr>
        <tr>
          <td id="L6104" data-line-number="6104"></td>
          <td id="LC6104">    pvArrayAllocate baPublic, 2 * LNG_SECP256R1_KEYSZ + 1, FUNC_NAME &amp; &#34;.baPublic&#34;</td>
        </tr>
        <tr>
          <td id="L6105" data-line-number="6105"></td>
          <td id="LC6105">    For lIdx = 1 To MAX_RETRIES</td>
        </tr>
        <tr>
          <td id="L6106" data-line-number="6106"></td>
          <td id="LC6106">        pvCryptoRandomBytes VarPtr(baPrivate(0)), LNG_SECP256R1_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6107" data-line-number="6107"></td>
          <td id="LC6107">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpMakeKey)</td>
        </tr>
        <tr>
          <td id="L6108" data-line-number="6108"></td>
          <td id="LC6108">        If pvCallSecpMakeKey(m_uData.Pfn(ucsPfnSecp256r1MakeKey), baPublic(0), baPrivate(0)) = 1 Then</td>
        </tr>
        <tr>
          <td id="L6109" data-line-number="6109"></td>
          <td id="LC6109">            Exit For</td>
        </tr>
        <tr>
          <td id="L6110" data-line-number="6110"></td>
          <td id="LC6110">        End If</td>
        </tr>
        <tr>
          <td id="L6111" data-line-number="6111"></td>
          <td id="LC6111">    Next</td>
        </tr>
        <tr>
          <td id="L6112" data-line-number="6112"></td>
          <td id="LC6112">    If lIdx &gt; MAX_RETRIES Then</td>
        </tr>
        <tr>
          <td id="L6113" data-line-number="6113"></td>
          <td id="LC6113">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6114" data-line-number="6114"></td>
          <td id="LC6114">    End If</td>
        </tr>
        <tr>
          <td id="L6115" data-line-number="6115"></td>
          <td id="LC6115">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6116" data-line-number="6116"></td>
          <td id="LC6116">    pvCryptoEcdhSecp256r1MakeKey = True</td>
        </tr>
        <tr>
          <td id="L6117" data-line-number="6117"></td>
          <td id="LC6117">QH:</td>
        </tr>
        <tr>
          <td id="L6118" data-line-number="6118"></td>
          <td id="LC6118">End Function</td>
        </tr>
        <tr>
          <td id="L6119" data-line-number="6119"></td>
          <td id="LC6119">
</td>
        </tr>
        <tr>
          <td id="L6120" data-line-number="6120"></td>
          <td id="LC6120">Private Function pvCryptoEcdhSecp256r1SharedSecret(baRetVal() As Byte, baPrivate() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6121" data-line-number="6121"></td>
          <td id="LC6121">    Const FUNC_NAME     As String = &#34;CryptoEcdhSecp256r1SharedSecret&#34;</td>
        </tr>
        <tr>
          <td id="L6122" data-line-number="6122"></td>
          <td id="LC6122">    </td>
        </tr>
        <tr>
          <td id="L6123" data-line-number="6123"></td>
          <td id="LC6123">    If UBound(baPrivate) = LNG_SECP256R1_KEYSZ - 1 And UBound(baPublic) &gt;= LNG_SECP256R1_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L6124" data-line-number="6124"></td>
          <td id="LC6124">        pvArrayAllocate baRetVal, LNG_SECP256R1_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6125" data-line-number="6125"></td>
          <td id="LC6125">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpSharedSecret)</td>
        </tr>
        <tr>
          <td id="L6126" data-line-number="6126"></td>
          <td id="LC6126">        If pvCallSecpSharedSecret(m_uData.Pfn(ucsPfnSecp256r1SharedSecret), baPublic(0), baPrivate(0), baRetVal(0)) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6127" data-line-number="6127"></td>
          <td id="LC6127">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6128" data-line-number="6128"></td>
          <td id="LC6128">        End If</td>
        </tr>
        <tr>
          <td id="L6129" data-line-number="6129"></td>
          <td id="LC6129">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6130" data-line-number="6130"></td>
          <td id="LC6130">        pvCryptoEcdhSecp256r1SharedSecret = True</td>
        </tr>
        <tr>
          <td id="L6131" data-line-number="6131"></td>
          <td id="LC6131">    End If</td>
        </tr>
        <tr>
          <td id="L6132" data-line-number="6132"></td>
          <td id="LC6132">QH:</td>
        </tr>
        <tr>
          <td id="L6133" data-line-number="6133"></td>
          <td id="LC6133">End Function</td>
        </tr>
        <tr>
          <td id="L6134" data-line-number="6134"></td>
          <td id="LC6134">
</td>
        </tr>
        <tr>
          <td id="L6135" data-line-number="6135"></td>
          <td id="LC6135">Private Function pvCryptoEcdhSecp256r1UncompressKey(baRetVal() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6136" data-line-number="6136"></td>
          <td id="LC6136">    Const FUNC_NAME     As String = &#34;CryptoEcdhSecp256r1UncompressKey&#34;</td>
        </tr>
        <tr>
          <td id="L6137" data-line-number="6137"></td>
          <td id="LC6137">
</td>
        </tr>
        <tr>
          <td id="L6138" data-line-number="6138"></td>
          <td id="LC6138">    pvArrayAllocate baRetVal, 1 + 2 * LNG_SECP256R1_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6139" data-line-number="6139"></td>
          <td id="LC6139">    Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpUncompressKey)</td>
        </tr>
        <tr>
          <td id="L6140" data-line-number="6140"></td>
          <td id="LC6140">    If pvCallSecpUncompressKey(m_uData.Pfn(ucsPfnSecp256r1UncompressKey), baPublic(0), baRetVal(0)) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6141" data-line-number="6141"></td>
          <td id="LC6141">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6142" data-line-number="6142"></td>
          <td id="LC6142">    End If</td>
        </tr>
        <tr>
          <td id="L6143" data-line-number="6143"></td>
          <td id="LC6143">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6144" data-line-number="6144"></td>
          <td id="LC6144">    pvCryptoEcdhSecp256r1UncompressKey = True</td>
        </tr>
        <tr>
          <td id="L6145" data-line-number="6145"></td>
          <td id="LC6145">QH:</td>
        </tr>
        <tr>
          <td id="L6146" data-line-number="6146"></td>
          <td id="LC6146">End Function</td>
        </tr>
        <tr>
          <td id="L6147" data-line-number="6147"></td>
          <td id="LC6147">
</td>
        </tr>
        <tr>
          <td id="L6148" data-line-number="6148"></td>
          <td id="LC6148">Private Function pvCryptoEcdsaSecp256r1Sign(baRetVal() As Byte, baPrivKey() As Byte, baHash() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6149" data-line-number="6149"></td>
          <td id="LC6149">    Const FUNC_NAME     As String = &#34;CryptoEcdsaSecp256r1Sign&#34;</td>
        </tr>
        <tr>
          <td id="L6150" data-line-number="6150"></td>
          <td id="LC6150">    Const MAX_RETRIES   As Long = 16</td>
        </tr>
        <tr>
          <td id="L6151" data-line-number="6151"></td>
          <td id="LC6151">    Dim baRandom()      As Byte</td>
        </tr>
        <tr>
          <td id="L6152" data-line-number="6152"></td>
          <td id="LC6152">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6153" data-line-number="6153"></td>
          <td id="LC6153">    </td>
        </tr>
        <tr>
          <td id="L6154" data-line-number="6154"></td>
          <td id="LC6154">    pvArrayAllocate baRandom, LNG_SECP256R1_KEYSZ, FUNC_NAME &amp; &#34;.baRandom&#34;</td>
        </tr>
        <tr>
          <td id="L6155" data-line-number="6155"></td>
          <td id="LC6155">    pvArrayAllocate baRetVal, 2 * LNG_SECP256R1_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6156" data-line-number="6156"></td>
          <td id="LC6156">    For lIdx = 1 To MAX_RETRIES</td>
        </tr>
        <tr>
          <td id="L6157" data-line-number="6157"></td>
          <td id="LC6157">        pvCryptoRandomBytes VarPtr(baRandom(0)), LNG_SECP256R1_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6158" data-line-number="6158"></td>
          <td id="LC6158">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpSign)</td>
        </tr>
        <tr>
          <td id="L6159" data-line-number="6159"></td>
          <td id="LC6159">        If pvCallSecpSign(m_uData.Pfn(ucsPfnSecp256r1Sign), baPrivKey(0), baHash(0), baRandom(0), baRetVal(0)) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6160" data-line-number="6160"></td>
          <td id="LC6160">            Exit For</td>
        </tr>
        <tr>
          <td id="L6161" data-line-number="6161"></td>
          <td id="LC6161">        End If</td>
        </tr>
        <tr>
          <td id="L6162" data-line-number="6162"></td>
          <td id="LC6162">    Next</td>
        </tr>
        <tr>
          <td id="L6163" data-line-number="6163"></td>
          <td id="LC6163">    If lIdx &gt; MAX_RETRIES Then</td>
        </tr>
        <tr>
          <td id="L6164" data-line-number="6164"></td>
          <td id="LC6164">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6165" data-line-number="6165"></td>
          <td id="LC6165">    End If</td>
        </tr>
        <tr>
          <td id="L6166" data-line-number="6166"></td>
          <td id="LC6166">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6167" data-line-number="6167"></td>
          <td id="LC6167">    pvCryptoEcdsaSecp256r1Sign = True</td>
        </tr>
        <tr>
          <td id="L6168" data-line-number="6168"></td>
          <td id="LC6168">QH:</td>
        </tr>
        <tr>
          <td id="L6169" data-line-number="6169"></td>
          <td id="LC6169">End Function</td>
        </tr>
        <tr>
          <td id="L6170" data-line-number="6170"></td>
          <td id="LC6170">
</td>
        </tr>
        <tr>
          <td id="L6171" data-line-number="6171"></td>
          <td id="LC6171">Private Function pvCryptoEcdsaSecp256r1Verify(baPublic() As Byte, baHash() As Byte, baSignature() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6172" data-line-number="6172"></td>
          <td id="LC6172">    Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpVerify)</td>
        </tr>
        <tr>
          <td id="L6173" data-line-number="6173"></td>
          <td id="LC6173">    pvCryptoEcdsaSecp256r1Verify = (pvCallSecpVerify(m_uData.Pfn(ucsPfnSecp256r1Verify), baPublic(0), baHash(0), baSignature(0)) &lt;&gt; 0)</td>
        </tr>
        <tr>
          <td id="L6174" data-line-number="6174"></td>
          <td id="LC6174">End Function</td>
        </tr>
        <tr>
          <td id="L6175" data-line-number="6175"></td>
          <td id="LC6175">
</td>
        </tr>
        <tr>
          <td id="L6176" data-line-number="6176"></td>
          <td id="LC6176">Private Function pvCryptoEcdhSecp384r1MakeKey(baPrivate() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6177" data-line-number="6177"></td>
          <td id="LC6177">    Const FUNC_NAME     As String = &#34;CryptoEcdhSecp384r1MakeKey&#34;</td>
        </tr>
        <tr>
          <td id="L6178" data-line-number="6178"></td>
          <td id="LC6178">    Const MAX_RETRIES   As Long = 16</td>
        </tr>
        <tr>
          <td id="L6179" data-line-number="6179"></td>
          <td id="LC6179">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6180" data-line-number="6180"></td>
          <td id="LC6180">    </td>
        </tr>
        <tr>
          <td id="L6181" data-line-number="6181"></td>
          <td id="LC6181">    pvArrayAllocate baPrivate, LNG_SECP384R1_KEYSZ, FUNC_NAME &amp; &#34;.baPrivate&#34;</td>
        </tr>
        <tr>
          <td id="L6182" data-line-number="6182"></td>
          <td id="LC6182">    pvArrayAllocate baPublic, 2 * LNG_SECP384R1_KEYSZ + 1, FUNC_NAME &amp; &#34;.baPublic&#34;</td>
        </tr>
        <tr>
          <td id="L6183" data-line-number="6183"></td>
          <td id="LC6183">    For lIdx = 1 To MAX_RETRIES</td>
        </tr>
        <tr>
          <td id="L6184" data-line-number="6184"></td>
          <td id="LC6184">        pvCryptoRandomBytes VarPtr(baPrivate(0)), LNG_SECP384R1_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6185" data-line-number="6185"></td>
          <td id="LC6185">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpMakeKey)</td>
        </tr>
        <tr>
          <td id="L6186" data-line-number="6186"></td>
          <td id="LC6186">        If pvCallSecpMakeKey(m_uData.Pfn(ucsPfnSecp384r1MakeKey), baPublic(0), baPrivate(0)) = 1 Then</td>
        </tr>
        <tr>
          <td id="L6187" data-line-number="6187"></td>
          <td id="LC6187">            Exit For</td>
        </tr>
        <tr>
          <td id="L6188" data-line-number="6188"></td>
          <td id="LC6188">        End If</td>
        </tr>
        <tr>
          <td id="L6189" data-line-number="6189"></td>
          <td id="LC6189">    Next</td>
        </tr>
        <tr>
          <td id="L6190" data-line-number="6190"></td>
          <td id="LC6190">    If lIdx &gt; MAX_RETRIES Then</td>
        </tr>
        <tr>
          <td id="L6191" data-line-number="6191"></td>
          <td id="LC6191">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6192" data-line-number="6192"></td>
          <td id="LC6192">    End If</td>
        </tr>
        <tr>
          <td id="L6193" data-line-number="6193"></td>
          <td id="LC6193">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6194" data-line-number="6194"></td>
          <td id="LC6194">    pvCryptoEcdhSecp384r1MakeKey = True</td>
        </tr>
        <tr>
          <td id="L6195" data-line-number="6195"></td>
          <td id="LC6195">QH:</td>
        </tr>
        <tr>
          <td id="L6196" data-line-number="6196"></td>
          <td id="LC6196">End Function</td>
        </tr>
        <tr>
          <td id="L6197" data-line-number="6197"></td>
          <td id="LC6197">
</td>
        </tr>
        <tr>
          <td id="L6198" data-line-number="6198"></td>
          <td id="LC6198">Private Function pvCryptoEcdhSecp384r1SharedSecret(baRetVal() As Byte, baPrivate() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6199" data-line-number="6199"></td>
          <td id="LC6199">    Const FUNC_NAME     As String = &#34;CryptoEcdhSecp384r1SharedSecret&#34;</td>
        </tr>
        <tr>
          <td id="L6200" data-line-number="6200"></td>
          <td id="LC6200">    </td>
        </tr>
        <tr>
          <td id="L6201" data-line-number="6201"></td>
          <td id="LC6201">    If UBound(baPrivate) = LNG_SECP384R1_KEYSZ - 1 And UBound(baPublic) &gt;= LNG_SECP384R1_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L6202" data-line-number="6202"></td>
          <td id="LC6202">        pvArrayAllocate baRetVal, LNG_SECP384R1_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6203" data-line-number="6203"></td>
          <td id="LC6203">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpSharedSecret)</td>
        </tr>
        <tr>
          <td id="L6204" data-line-number="6204"></td>
          <td id="LC6204">        If pvCallSecpSharedSecret(m_uData.Pfn(ucsPfnSecp384r1SharedSecret), baPublic(0), baPrivate(0), baRetVal(0)) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6205" data-line-number="6205"></td>
          <td id="LC6205">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6206" data-line-number="6206"></td>
          <td id="LC6206">        End If</td>
        </tr>
        <tr>
          <td id="L6207" data-line-number="6207"></td>
          <td id="LC6207">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6208" data-line-number="6208"></td>
          <td id="LC6208">        pvCryptoEcdhSecp384r1SharedSecret = True</td>
        </tr>
        <tr>
          <td id="L6209" data-line-number="6209"></td>
          <td id="LC6209">    End If</td>
        </tr>
        <tr>
          <td id="L6210" data-line-number="6210"></td>
          <td id="LC6210">QH:</td>
        </tr>
        <tr>
          <td id="L6211" data-line-number="6211"></td>
          <td id="LC6211">End Function</td>
        </tr>
        <tr>
          <td id="L6212" data-line-number="6212"></td>
          <td id="LC6212">
</td>
        </tr>
        <tr>
          <td id="L6213" data-line-number="6213"></td>
          <td id="LC6213">Private Function pvCryptoEcdhSecp384r1UncompressKey(baRetVal() As Byte, baPublic() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6214" data-line-number="6214"></td>
          <td id="LC6214">    Const FUNC_NAME     As String = &#34;CryptoEcdhSecp384r1UncompressKey&#34;</td>
        </tr>
        <tr>
          <td id="L6215" data-line-number="6215"></td>
          <td id="LC6215">
</td>
        </tr>
        <tr>
          <td id="L6216" data-line-number="6216"></td>
          <td id="LC6216">    pvArrayAllocate baRetVal, 1 + 2 * LNG_SECP384R1_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6217" data-line-number="6217"></td>
          <td id="LC6217">    Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpUncompressKey)</td>
        </tr>
        <tr>
          <td id="L6218" data-line-number="6218"></td>
          <td id="LC6218">    If pvCallSecpUncompressKey(m_uData.Pfn(ucsPfnSecp384r1UncompressKey), baPublic(0), baRetVal(0)) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6219" data-line-number="6219"></td>
          <td id="LC6219">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6220" data-line-number="6220"></td>
          <td id="LC6220">    End If</td>
        </tr>
        <tr>
          <td id="L6221" data-line-number="6221"></td>
          <td id="LC6221">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6222" data-line-number="6222"></td>
          <td id="LC6222">    pvCryptoEcdhSecp384r1UncompressKey = True</td>
        </tr>
        <tr>
          <td id="L6223" data-line-number="6223"></td>
          <td id="LC6223">QH:</td>
        </tr>
        <tr>
          <td id="L6224" data-line-number="6224"></td>
          <td id="LC6224">End Function</td>
        </tr>
        <tr>
          <td id="L6225" data-line-number="6225"></td>
          <td id="LC6225">
</td>
        </tr>
        <tr>
          <td id="L6226" data-line-number="6226"></td>
          <td id="LC6226">Private Function pvCryptoEcdsaSecp384r1Sign(baRetVal() As Byte, baPrivKey() As Byte, baHash() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6227" data-line-number="6227"></td>
          <td id="LC6227">    Const FUNC_NAME     As String = &#34;CryptoEcdsaSecp384r1Sign&#34;</td>
        </tr>
        <tr>
          <td id="L6228" data-line-number="6228"></td>
          <td id="LC6228">    Const MAX_RETRIES   As Long = 16</td>
        </tr>
        <tr>
          <td id="L6229" data-line-number="6229"></td>
          <td id="LC6229">    Dim baRandom()      As Byte</td>
        </tr>
        <tr>
          <td id="L6230" data-line-number="6230"></td>
          <td id="LC6230">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6231" data-line-number="6231"></td>
          <td id="LC6231">    </td>
        </tr>
        <tr>
          <td id="L6232" data-line-number="6232"></td>
          <td id="LC6232">    pvArrayAllocate baRandom, LNG_SECP384R1_KEYSZ, FUNC_NAME &amp; &#34;.baRandom&#34;</td>
        </tr>
        <tr>
          <td id="L6233" data-line-number="6233"></td>
          <td id="LC6233">    pvArrayAllocate baRetVal, 2 * LNG_SECP384R1_KEYSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6234" data-line-number="6234"></td>
          <td id="LC6234">    For lIdx = 1 To MAX_RETRIES</td>
        </tr>
        <tr>
          <td id="L6235" data-line-number="6235"></td>
          <td id="LC6235">        pvCryptoRandomBytes VarPtr(baRandom(0)), LNG_SECP384R1_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6236" data-line-number="6236"></td>
          <td id="LC6236">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpSign)</td>
        </tr>
        <tr>
          <td id="L6237" data-line-number="6237"></td>
          <td id="LC6237">        If pvCallSecpSign(m_uData.Pfn(ucsPfnSecp384r1Sign), baPrivKey(0), baHash(0), baRandom(0), baRetVal(0)) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6238" data-line-number="6238"></td>
          <td id="LC6238">            Exit For</td>
        </tr>
        <tr>
          <td id="L6239" data-line-number="6239"></td>
          <td id="LC6239">        End If</td>
        </tr>
        <tr>
          <td id="L6240" data-line-number="6240"></td>
          <td id="LC6240">    Next</td>
        </tr>
        <tr>
          <td id="L6241" data-line-number="6241"></td>
          <td id="LC6241">    If lIdx &gt; MAX_RETRIES Then</td>
        </tr>
        <tr>
          <td id="L6242" data-line-number="6242"></td>
          <td id="LC6242">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6243" data-line-number="6243"></td>
          <td id="LC6243">    End If</td>
        </tr>
        <tr>
          <td id="L6244" data-line-number="6244"></td>
          <td id="LC6244">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6245" data-line-number="6245"></td>
          <td id="LC6245">    pvCryptoEcdsaSecp384r1Sign = True</td>
        </tr>
        <tr>
          <td id="L6246" data-line-number="6246"></td>
          <td id="LC6246">QH:</td>
        </tr>
        <tr>
          <td id="L6247" data-line-number="6247"></td>
          <td id="LC6247">End Function</td>
        </tr>
        <tr>
          <td id="L6248" data-line-number="6248"></td>
          <td id="LC6248">
</td>
        </tr>
        <tr>
          <td id="L6249" data-line-number="6249"></td>
          <td id="LC6249">Private Function pvCryptoEcdsaSecp384r1Verify(baPublic() As Byte, baHash() As Byte, baSignature() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6250" data-line-number="6250"></td>
          <td id="LC6250">    Debug.Assert pvPatchTrampoline(AddressOf pvCallSecpVerify)</td>
        </tr>
        <tr>
          <td id="L6251" data-line-number="6251"></td>
          <td id="LC6251">    pvCryptoEcdsaSecp384r1Verify = (pvCallSecpVerify(m_uData.Pfn(ucsPfnSecp384r1Verify), baPublic(0), baHash(0), baSignature(0)) &lt;&gt; 0)</td>
        </tr>
        <tr>
          <td id="L6252" data-line-number="6252"></td>
          <td id="LC6252">End Function</td>
        </tr>
        <tr>
          <td id="L6253" data-line-number="6253"></td>
          <td id="LC6253">
</td>
        </tr>
        <tr>
          <td id="L6254" data-line-number="6254"></td>
          <td id="LC6254">Private Function pvCryptoHashSha1(baRetVal() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6255" data-line-number="6255"></td>
          <td id="LC6255">    Const FUNC_NAME     As String = &#34;CryptoHashSha256&#34;</td>
        </tr>
        <tr>
          <td id="L6256" data-line-number="6256"></td>
          <td id="LC6256">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6257" data-line-number="6257"></td>
          <td id="LC6257">    Dim hHash           As Long</td>
        </tr>
        <tr>
          <td id="L6258" data-line-number="6258"></td>
          <td id="LC6258">    </td>
        </tr>
        <tr>
          <td id="L6259" data-line-number="6259"></td>
          <td id="LC6259">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6260" data-line-number="6260"></td>
          <td id="LC6260">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6261" data-line-number="6261"></td>
          <td id="LC6261">    Else</td>
        </tr>
        <tr>
          <td id="L6262" data-line-number="6262"></td>
          <td id="LC6262">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6263" data-line-number="6263"></td>
          <td id="LC6263">    End If</td>
        </tr>
        <tr>
          <td id="L6264" data-line-number="6264"></td>
          <td id="LC6264">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6265" data-line-number="6265"></td>
          <td id="LC6265">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6266" data-line-number="6266"></td>
          <td id="LC6266">    End If</td>
        </tr>
        <tr>
          <td id="L6267" data-line-number="6267"></td>
          <td id="LC6267">    pvArrayAllocate baRetVal, LNG_SHA1_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6268" data-line-number="6268"></td>
          <td id="LC6268">    If CryptCreateHash(m_uData.hRandomProv, CALG_SHA1, 0, 0, hHash) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6269" data-line-number="6269"></td>
          <td id="LC6269">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6270" data-line-number="6270"></td>
          <td id="LC6270">    End If</td>
        </tr>
        <tr>
          <td id="L6271" data-line-number="6271"></td>
          <td id="LC6271">    If CryptHashData(hHash, ByVal lPtr, Size, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6272" data-line-number="6272"></td>
          <td id="LC6272">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6273" data-line-number="6273"></td>
          <td id="LC6273">    End If</td>
        </tr>
        <tr>
          <td id="L6274" data-line-number="6274"></td>
          <td id="LC6274">    If CryptGetHashParam(hHash, HP_HASHVAL, baRetVal(0), LNG_SHA1_HASHSZ, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6275" data-line-number="6275"></td>
          <td id="LC6275">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6276" data-line-number="6276"></td>
          <td id="LC6276">    End If</td>
        </tr>
        <tr>
          <td id="L6277" data-line-number="6277"></td>
          <td id="LC6277">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6278" data-line-number="6278"></td>
          <td id="LC6278">    pvCryptoHashSha1 = True</td>
        </tr>
        <tr>
          <td id="L6279" data-line-number="6279"></td>
          <td id="LC6279">QH:</td>
        </tr>
        <tr>
          <td id="L6280" data-line-number="6280"></td>
          <td id="LC6280">    If hHash &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6281" data-line-number="6281"></td>
          <td id="LC6281">        Call CryptDestroyHash(hHash)</td>
        </tr>
        <tr>
          <td id="L6282" data-line-number="6282"></td>
          <td id="LC6282">    End If</td>
        </tr>
        <tr>
          <td id="L6283" data-line-number="6283"></td>
          <td id="LC6283">End Function</td>
        </tr>
        <tr>
          <td id="L6284" data-line-number="6284"></td>
          <td id="LC6284">
</td>
        </tr>
        <tr>
          <td id="L6285" data-line-number="6285"></td>
          <td id="LC6285">Private Function pvCryptoHashSha224(baRetVal() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6286" data-line-number="6286"></td>
          <td id="LC6286">    Const FUNC_NAME     As String = &#34;CryptoHashSha224&#34;</td>
        </tr>
        <tr>
          <td id="L6287" data-line-number="6287"></td>
          <td id="LC6287">    Dim lCtxPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6288" data-line-number="6288"></td>
          <td id="LC6288">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6289" data-line-number="6289"></td>
          <td id="LC6289">    Static H224(0 To 7) As Long</td>
        </tr>
        <tr>
          <td id="L6290" data-line-number="6290"></td>
          <td id="LC6290">    </td>
        </tr>
        <tr>
          <td id="L6291" data-line-number="6291"></td>
          <td id="LC6291">    If H224(0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6292" data-line-number="6292"></td>
          <td id="LC6292">        H224(0) = &amp;HC1059ED8</td>
        </tr>
        <tr>
          <td id="L6293" data-line-number="6293"></td>
          <td id="LC6293">        H224(1) = &amp;H367CD507</td>
        </tr>
        <tr>
          <td id="L6294" data-line-number="6294"></td>
          <td id="LC6294">        H224(2) = &amp;H3070DD17</td>
        </tr>
        <tr>
          <td id="L6295" data-line-number="6295"></td>
          <td id="LC6295">        H224(3) = &amp;HF70E5939</td>
        </tr>
        <tr>
          <td id="L6296" data-line-number="6296"></td>
          <td id="LC6296">        H224(4) = &amp;HFFC00B31</td>
        </tr>
        <tr>
          <td id="L6297" data-line-number="6297"></td>
          <td id="LC6297">        H224(5) = &amp;H68581511</td>
        </tr>
        <tr>
          <td id="L6298" data-line-number="6298"></td>
          <td id="LC6298">        H224(6) = &amp;H64F98FA7</td>
        </tr>
        <tr>
          <td id="L6299" data-line-number="6299"></td>
          <td id="LC6299">        H224(7) = &amp;HBEFA4FA4</td>
        </tr>
        <tr>
          <td id="L6300" data-line-number="6300"></td>
          <td id="LC6300">    End If</td>
        </tr>
        <tr>
          <td id="L6301" data-line-number="6301"></td>
          <td id="LC6301">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6302" data-line-number="6302"></td>
          <td id="LC6302">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6303" data-line-number="6303"></td>
          <td id="LC6303">    Else</td>
        </tr>
        <tr>
          <td id="L6304" data-line-number="6304"></td>
          <td id="LC6304">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6305" data-line-number="6305"></td>
          <td id="LC6305">    End If</td>
        </tr>
        <tr>
          <td id="L6306" data-line-number="6306"></td>
          <td id="LC6306">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6307" data-line-number="6307"></td>
          <td id="LC6307">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6308" data-line-number="6308"></td>
          <td id="LC6308">    End If</td>
        </tr>
        <tr>
          <td id="L6309" data-line-number="6309"></td>
          <td id="LC6309">    pvArrayAllocate baRetVal, LNG_SHA256_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6310" data-line-number="6310"></td>
          <td id="LC6310">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6311" data-line-number="6311"></td>
          <td id="LC6311">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6312" data-line-number="6312"></td>
          <td id="LC6312">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6313" data-line-number="6313"></td>
          <td id="LC6313">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6314" data-line-number="6314"></td>
          <td id="LC6314">        lCtxPtr = VarPtr(.HashCtx(0))</td>
        </tr>
        <tr>
          <td id="L6315" data-line-number="6315"></td>
          <td id="LC6315">        pvCallSha2Init .Pfn(ucsPfnSha256Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6316" data-line-number="6316"></td>
          <td id="LC6316">        Call CopyMemory(ByVal lCtxPtr, H224(0), 32)</td>
        </tr>
        <tr>
          <td id="L6317" data-line-number="6317"></td>
          <td id="LC6317">        pvCallSha2Update .Pfn(ucsPfnSha256Update), lCtxPtr, lPtr, Size</td>
        </tr>
        <tr>
          <td id="L6318" data-line-number="6318"></td>
          <td id="LC6318">        pvCallSha2Final .Pfn(ucsPfnSha256Final), lCtxPtr, baRetVal(0)</td>
        </tr>
        <tr>
          <td id="L6319" data-line-number="6319"></td>
          <td id="LC6319">    End With</td>
        </tr>
        <tr>
          <td id="L6320" data-line-number="6320"></td>
          <td id="LC6320">    pvArrayReallocate baRetVal, LNG_SHA224_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6321" data-line-number="6321"></td>
          <td id="LC6321">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6322" data-line-number="6322"></td>
          <td id="LC6322">    pvCryptoHashSha224 = True</td>
        </tr>
        <tr>
          <td id="L6323" data-line-number="6323"></td>
          <td id="LC6323">End Function</td>
        </tr>
        <tr>
          <td id="L6324" data-line-number="6324"></td>
          <td id="LC6324">
</td>
        </tr>
        <tr>
          <td id="L6325" data-line-number="6325"></td>
          <td id="LC6325">Private Function pvCryptoHashSha256(baRetVal() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6326" data-line-number="6326"></td>
          <td id="LC6326">    Const FUNC_NAME     As String = &#34;CryptoHashSha256&#34;</td>
        </tr>
        <tr>
          <td id="L6327" data-line-number="6327"></td>
          <td id="LC6327">    Dim lCtxPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6328" data-line-number="6328"></td>
          <td id="LC6328">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6329" data-line-number="6329"></td>
          <td id="LC6329">    </td>
        </tr>
        <tr>
          <td id="L6330" data-line-number="6330"></td>
          <td id="LC6330">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6331" data-line-number="6331"></td>
          <td id="LC6331">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6332" data-line-number="6332"></td>
          <td id="LC6332">    Else</td>
        </tr>
        <tr>
          <td id="L6333" data-line-number="6333"></td>
          <td id="LC6333">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6334" data-line-number="6334"></td>
          <td id="LC6334">    End If</td>
        </tr>
        <tr>
          <td id="L6335" data-line-number="6335"></td>
          <td id="LC6335">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6336" data-line-number="6336"></td>
          <td id="LC6336">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6337" data-line-number="6337"></td>
          <td id="LC6337">    End If</td>
        </tr>
        <tr>
          <td id="L6338" data-line-number="6338"></td>
          <td id="LC6338">    pvArrayAllocate baRetVal, LNG_SHA256_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6339" data-line-number="6339"></td>
          <td id="LC6339">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6340" data-line-number="6340"></td>
          <td id="LC6340">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6341" data-line-number="6341"></td>
          <td id="LC6341">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6342" data-line-number="6342"></td>
          <td id="LC6342">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6343" data-line-number="6343"></td>
          <td id="LC6343">        lCtxPtr = VarPtr(.HashCtx(0))</td>
        </tr>
        <tr>
          <td id="L6344" data-line-number="6344"></td>
          <td id="LC6344">        pvCallSha2Init .Pfn(ucsPfnSha256Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6345" data-line-number="6345"></td>
          <td id="LC6345">        pvCallSha2Update .Pfn(ucsPfnSha256Update), lCtxPtr, lPtr, Size</td>
        </tr>
        <tr>
          <td id="L6346" data-line-number="6346"></td>
          <td id="LC6346">        pvCallSha2Final .Pfn(ucsPfnSha256Final), lCtxPtr, baRetVal(0)</td>
        </tr>
        <tr>
          <td id="L6347" data-line-number="6347"></td>
          <td id="LC6347">    End With</td>
        </tr>
        <tr>
          <td id="L6348" data-line-number="6348"></td>
          <td id="LC6348">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6349" data-line-number="6349"></td>
          <td id="LC6349">    pvCryptoHashSha256 = True</td>
        </tr>
        <tr>
          <td id="L6350" data-line-number="6350"></td>
          <td id="LC6350">End Function</td>
        </tr>
        <tr>
          <td id="L6351" data-line-number="6351"></td>
          <td id="LC6351">
</td>
        </tr>
        <tr>
          <td id="L6352" data-line-number="6352"></td>
          <td id="LC6352">Private Function pvCryptoHashSha384(baRetVal() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6353" data-line-number="6353"></td>
          <td id="LC6353">    Const FUNC_NAME     As String = &#34;CryptoHashSha384&#34;</td>
        </tr>
        <tr>
          <td id="L6354" data-line-number="6354"></td>
          <td id="LC6354">    Dim lCtxPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6355" data-line-number="6355"></td>
          <td id="LC6355">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6356" data-line-number="6356"></td>
          <td id="LC6356">    </td>
        </tr>
        <tr>
          <td id="L6357" data-line-number="6357"></td>
          <td id="LC6357">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6358" data-line-number="6358"></td>
          <td id="LC6358">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6359" data-line-number="6359"></td>
          <td id="LC6359">    Else</td>
        </tr>
        <tr>
          <td id="L6360" data-line-number="6360"></td>
          <td id="LC6360">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6361" data-line-number="6361"></td>
          <td id="LC6361">    End If</td>
        </tr>
        <tr>
          <td id="L6362" data-line-number="6362"></td>
          <td id="LC6362">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6363" data-line-number="6363"></td>
          <td id="LC6363">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6364" data-line-number="6364"></td>
          <td id="LC6364">    End If</td>
        </tr>
        <tr>
          <td id="L6365" data-line-number="6365"></td>
          <td id="LC6365">    pvArrayAllocate baRetVal, LNG_SHA384_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6366" data-line-number="6366"></td>
          <td id="LC6366">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6367" data-line-number="6367"></td>
          <td id="LC6367">        lCtxPtr = VarPtr(.HashCtx(0))</td>
        </tr>
        <tr>
          <td id="L6368" data-line-number="6368"></td>
          <td id="LC6368">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6369" data-line-number="6369"></td>
          <td id="LC6369">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6370" data-line-number="6370"></td>
          <td id="LC6370">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6371" data-line-number="6371"></td>
          <td id="LC6371">        pvCallSha2Init .Pfn(ucsPfnSha384Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6372" data-line-number="6372"></td>
          <td id="LC6372">        pvCallSha2Update .Pfn(ucsPfnSha384Update), lCtxPtr, lPtr, Size</td>
        </tr>
        <tr>
          <td id="L6373" data-line-number="6373"></td>
          <td id="LC6373">        pvCallSha2Final .Pfn(ucsPfnSha384Final), lCtxPtr, baRetVal(0)</td>
        </tr>
        <tr>
          <td id="L6374" data-line-number="6374"></td>
          <td id="LC6374">    End With</td>
        </tr>
        <tr>
          <td id="L6375" data-line-number="6375"></td>
          <td id="LC6375">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6376" data-line-number="6376"></td>
          <td id="LC6376">    pvCryptoHashSha384 = True</td>
        </tr>
        <tr>
          <td id="L6377" data-line-number="6377"></td>
          <td id="LC6377">End Function</td>
        </tr>
        <tr>
          <td id="L6378" data-line-number="6378"></td>
          <td id="LC6378">
</td>
        </tr>
        <tr>
          <td id="L6379" data-line-number="6379"></td>
          <td id="LC6379">Private Function pvCryptoHashSha512(baRetVal() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6380" data-line-number="6380"></td>
          <td id="LC6380">    Const FUNC_NAME     As String = &#34;CryptoHashSha512&#34;</td>
        </tr>
        <tr>
          <td id="L6381" data-line-number="6381"></td>
          <td id="LC6381">    Dim lCtxPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6382" data-line-number="6382"></td>
          <td id="LC6382">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6383" data-line-number="6383"></td>
          <td id="LC6383">    </td>
        </tr>
        <tr>
          <td id="L6384" data-line-number="6384"></td>
          <td id="LC6384">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6385" data-line-number="6385"></td>
          <td id="LC6385">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6386" data-line-number="6386"></td>
          <td id="LC6386">    Else</td>
        </tr>
        <tr>
          <td id="L6387" data-line-number="6387"></td>
          <td id="LC6387">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6388" data-line-number="6388"></td>
          <td id="LC6388">    End If</td>
        </tr>
        <tr>
          <td id="L6389" data-line-number="6389"></td>
          <td id="LC6389">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6390" data-line-number="6390"></td>
          <td id="LC6390">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6391" data-line-number="6391"></td>
          <td id="LC6391">    End If</td>
        </tr>
        <tr>
          <td id="L6392" data-line-number="6392"></td>
          <td id="LC6392">    pvArrayAllocate baRetVal, LNG_SHA512_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6393" data-line-number="6393"></td>
          <td id="LC6393">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6394" data-line-number="6394"></td>
          <td id="LC6394">        lCtxPtr = VarPtr(.HashCtx(0))</td>
        </tr>
        <tr>
          <td id="L6395" data-line-number="6395"></td>
          <td id="LC6395">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6396" data-line-number="6396"></td>
          <td id="LC6396">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6397" data-line-number="6397"></td>
          <td id="LC6397">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6398" data-line-number="6398"></td>
          <td id="LC6398">        pvCallSha2Init .Pfn(ucsPfnSha512Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6399" data-line-number="6399"></td>
          <td id="LC6399">        pvCallSha2Update .Pfn(ucsPfnSha512Update), lCtxPtr, lPtr, Size</td>
        </tr>
        <tr>
          <td id="L6400" data-line-number="6400"></td>
          <td id="LC6400">        pvCallSha2Final .Pfn(ucsPfnSha512Final), lCtxPtr, baRetVal(0)</td>
        </tr>
        <tr>
          <td id="L6401" data-line-number="6401"></td>
          <td id="LC6401">    End With</td>
        </tr>
        <tr>
          <td id="L6402" data-line-number="6402"></td>
          <td id="LC6402">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6403" data-line-number="6403"></td>
          <td id="LC6403">    pvCryptoHashSha512 = True</td>
        </tr>
        <tr>
          <td id="L6404" data-line-number="6404"></td>
          <td id="LC6404">End Function</td>
        </tr>
        <tr>
          <td id="L6405" data-line-number="6405"></td>
          <td id="LC6405">
</td>
        </tr>
        <tr>
          <td id="L6406" data-line-number="6406"></td>
          <td id="LC6406">Private Function pvCryptoHmacSha1(baRetVal() As Byte, baKey() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6407" data-line-number="6407"></td>
          <td id="LC6407">    Const FUNC_NAME     As String = &#34;CryptoHmacSha1&#34;</td>
        </tr>
        <tr>
          <td id="L6408" data-line-number="6408"></td>
          <td id="LC6408">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6409" data-line-number="6409"></td>
          <td id="LC6409">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6410" data-line-number="6410"></td>
          <td id="LC6410">    Dim hHash           As Long</td>
        </tr>
        <tr>
          <td id="L6411" data-line-number="6411"></td>
          <td id="LC6411">    </td>
        </tr>
        <tr>
          <td id="L6412" data-line-number="6412"></td>
          <td id="LC6412">    Debug.Assert UBound(baKey) &lt; LNG_SHA1_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6413" data-line-number="6413"></td>
          <td id="LC6413">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6414" data-line-number="6414"></td>
          <td id="LC6414">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6415" data-line-number="6415"></td>
          <td id="LC6415">    Else</td>
        </tr>
        <tr>
          <td id="L6416" data-line-number="6416"></td>
          <td id="LC6416">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6417" data-line-number="6417"></td>
          <td id="LC6417">    End If</td>
        </tr>
        <tr>
          <td id="L6418" data-line-number="6418"></td>
          <td id="LC6418">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6419" data-line-number="6419"></td>
          <td id="LC6419">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6420" data-line-number="6420"></td>
          <td id="LC6420">    End If</td>
        </tr>
        <tr>
          <td id="L6421" data-line-number="6421"></td>
          <td id="LC6421">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6422" data-line-number="6422"></td>
          <td id="LC6422">        &#39;-- inner hash</td>
        </tr>
        <tr>
          <td id="L6423" data-line-number="6423"></td>
          <td id="LC6423">        Call FillMemory(.HashPad(0), LNG_SHA1_BLOCKSZ, LNG_HMAC_INNER_PAD)</td>
        </tr>
        <tr>
          <td id="L6424" data-line-number="6424"></td>
          <td id="LC6424">        For lIdx = 0 To UBound(baKey)</td>
        </tr>
        <tr>
          <td id="L6425" data-line-number="6425"></td>
          <td id="LC6425">            .HashPad(lIdx) = baKey(lIdx) Xor LNG_HMAC_INNER_PAD</td>
        </tr>
        <tr>
          <td id="L6426" data-line-number="6426"></td>
          <td id="LC6426">        Next</td>
        </tr>
        <tr>
          <td id="L6427" data-line-number="6427"></td>
          <td id="LC6427">        If CryptCreateHash(m_uData.hRandomProv, CALG_SHA1, 0, 0, hHash) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6428" data-line-number="6428"></td>
          <td id="LC6428">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6429" data-line-number="6429"></td>
          <td id="LC6429">        End If</td>
        </tr>
        <tr>
          <td id="L6430" data-line-number="6430"></td>
          <td id="LC6430">        If CryptHashData(hHash, .HashPad(0), LNG_SHA1_BLOCKSZ, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6431" data-line-number="6431"></td>
          <td id="LC6431">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6432" data-line-number="6432"></td>
          <td id="LC6432">        End If</td>
        </tr>
        <tr>
          <td id="L6433" data-line-number="6433"></td>
          <td id="LC6433">        If CryptHashData(hHash, ByVal lPtr, Size, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6434" data-line-number="6434"></td>
          <td id="LC6434">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6435" data-line-number="6435"></td>
          <td id="LC6435">        End If</td>
        </tr>
        <tr>
          <td id="L6436" data-line-number="6436"></td>
          <td id="LC6436">        If CryptGetHashParam(hHash, HP_HASHVAL, .HashFinal(0), LNG_SHA1_HASHSZ, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6437" data-line-number="6437"></td>
          <td id="LC6437">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6438" data-line-number="6438"></td>
          <td id="LC6438">        End If</td>
        </tr>
        <tr>
          <td id="L6439" data-line-number="6439"></td>
          <td id="LC6439">        Call CryptDestroyHash(hHash)</td>
        </tr>
        <tr>
          <td id="L6440" data-line-number="6440"></td>
          <td id="LC6440">        hHash = 0</td>
        </tr>
        <tr>
          <td id="L6441" data-line-number="6441"></td>
          <td id="LC6441">        &#39;-- outer hash</td>
        </tr>
        <tr>
          <td id="L6442" data-line-number="6442"></td>
          <td id="LC6442">        Call FillMemory(.HashPad(0), LNG_SHA1_BLOCKSZ, LNG_HMAC_OUTER_PAD)</td>
        </tr>
        <tr>
          <td id="L6443" data-line-number="6443"></td>
          <td id="LC6443">        For lIdx = 0 To UBound(baKey)</td>
        </tr>
        <tr>
          <td id="L6444" data-line-number="6444"></td>
          <td id="LC6444">            .HashPad(lIdx) = baKey(lIdx) Xor LNG_HMAC_OUTER_PAD</td>
        </tr>
        <tr>
          <td id="L6445" data-line-number="6445"></td>
          <td id="LC6445">        Next</td>
        </tr>
        <tr>
          <td id="L6446" data-line-number="6446"></td>
          <td id="LC6446">        If CryptCreateHash(m_uData.hRandomProv, CALG_SHA1, 0, 0, hHash) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6447" data-line-number="6447"></td>
          <td id="LC6447">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6448" data-line-number="6448"></td>
          <td id="LC6448">        End If</td>
        </tr>
        <tr>
          <td id="L6449" data-line-number="6449"></td>
          <td id="LC6449">        If CryptHashData(hHash, .HashPad(0), LNG_SHA1_BLOCKSZ, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6450" data-line-number="6450"></td>
          <td id="LC6450">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6451" data-line-number="6451"></td>
          <td id="LC6451">        End If</td>
        </tr>
        <tr>
          <td id="L6452" data-line-number="6452"></td>
          <td id="LC6452">        If CryptHashData(hHash, .HashFinal(0), LNG_SHA1_HASHSZ, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6453" data-line-number="6453"></td>
          <td id="LC6453">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6454" data-line-number="6454"></td>
          <td id="LC6454">        End If</td>
        </tr>
        <tr>
          <td id="L6455" data-line-number="6455"></td>
          <td id="LC6455">        pvArrayAllocate baRetVal, LNG_SHA1_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6456" data-line-number="6456"></td>
          <td id="LC6456">        If CryptGetHashParam(hHash, HP_HASHVAL, baRetVal(0), LNG_SHA1_HASHSZ, 0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6457" data-line-number="6457"></td>
          <td id="LC6457">            GoTo QH</td>
        </tr>
        <tr>
          <td id="L6458" data-line-number="6458"></td>
          <td id="LC6458">        End If</td>
        </tr>
        <tr>
          <td id="L6459" data-line-number="6459"></td>
          <td id="LC6459">    End With</td>
        </tr>
        <tr>
          <td id="L6460" data-line-number="6460"></td>
          <td id="LC6460">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6461" data-line-number="6461"></td>
          <td id="LC6461">    pvCryptoHmacSha1 = True</td>
        </tr>
        <tr>
          <td id="L6462" data-line-number="6462"></td>
          <td id="LC6462">QH:</td>
        </tr>
        <tr>
          <td id="L6463" data-line-number="6463"></td>
          <td id="LC6463">    If hHash &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6464" data-line-number="6464"></td>
          <td id="LC6464">        Call CryptDestroyHash(hHash)</td>
        </tr>
        <tr>
          <td id="L6465" data-line-number="6465"></td>
          <td id="LC6465">    End If</td>
        </tr>
        <tr>
          <td id="L6466" data-line-number="6466"></td>
          <td id="LC6466">End Function</td>
        </tr>
        <tr>
          <td id="L6467" data-line-number="6467"></td>
          <td id="LC6467">
</td>
        </tr>
        <tr>
          <td id="L6468" data-line-number="6468"></td>
          <td id="LC6468">Private Function pvCryptoHmacSha256(baRetVal() As Byte, baKey() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6469" data-line-number="6469"></td>
          <td id="LC6469">    Const FUNC_NAME     As String = &#34;CryptoHmacSha256&#34;</td>
        </tr>
        <tr>
          <td id="L6470" data-line-number="6470"></td>
          <td id="LC6470">    Dim lCtxPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6471" data-line-number="6471"></td>
          <td id="LC6471">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6472" data-line-number="6472"></td>
          <td id="LC6472">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6473" data-line-number="6473"></td>
          <td id="LC6473">    </td>
        </tr>
        <tr>
          <td id="L6474" data-line-number="6474"></td>
          <td id="LC6474">    Debug.Assert UBound(baKey) &lt; LNG_SHA256_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6475" data-line-number="6475"></td>
          <td id="LC6475">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6476" data-line-number="6476"></td>
          <td id="LC6476">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6477" data-line-number="6477"></td>
          <td id="LC6477">    Else</td>
        </tr>
        <tr>
          <td id="L6478" data-line-number="6478"></td>
          <td id="LC6478">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6479" data-line-number="6479"></td>
          <td id="LC6479">    End If</td>
        </tr>
        <tr>
          <td id="L6480" data-line-number="6480"></td>
          <td id="LC6480">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6481" data-line-number="6481"></td>
          <td id="LC6481">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6482" data-line-number="6482"></td>
          <td id="LC6482">    End If</td>
        </tr>
        <tr>
          <td id="L6483" data-line-number="6483"></td>
          <td id="LC6483">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6484" data-line-number="6484"></td>
          <td id="LC6484">        lCtxPtr = VarPtr(.HashCtx(0))</td>
        </tr>
        <tr>
          <td id="L6485" data-line-number="6485"></td>
          <td id="LC6485">        pvArrayAllocate baRetVal, LNG_SHA256_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6486" data-line-number="6486"></td>
          <td id="LC6486">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6487" data-line-number="6487"></td>
          <td id="LC6487">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6488" data-line-number="6488"></td>
          <td id="LC6488">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6489" data-line-number="6489"></td>
          <td id="LC6489">        &#39;-- inner hash</td>
        </tr>
        <tr>
          <td id="L6490" data-line-number="6490"></td>
          <td id="LC6490">        Call FillMemory(.HashPad(0), LNG_SHA256_BLOCKSZ, LNG_HMAC_INNER_PAD)</td>
        </tr>
        <tr>
          <td id="L6491" data-line-number="6491"></td>
          <td id="LC6491">        For lIdx = 0 To UBound(baKey)</td>
        </tr>
        <tr>
          <td id="L6492" data-line-number="6492"></td>
          <td id="LC6492">            .HashPad(lIdx) = baKey(lIdx) Xor LNG_HMAC_INNER_PAD</td>
        </tr>
        <tr>
          <td id="L6493" data-line-number="6493"></td>
          <td id="LC6493">        Next</td>
        </tr>
        <tr>
          <td id="L6494" data-line-number="6494"></td>
          <td id="LC6494">        pvCallSha2Init .Pfn(ucsPfnSha256Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6495" data-line-number="6495"></td>
          <td id="LC6495">        pvCallSha2Update .Pfn(ucsPfnSha256Update), lCtxPtr, VarPtr(.HashPad(0)), LNG_SHA256_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6496" data-line-number="6496"></td>
          <td id="LC6496">        pvCallSha2Update .Pfn(ucsPfnSha256Update), lCtxPtr, lPtr, Size</td>
        </tr>
        <tr>
          <td id="L6497" data-line-number="6497"></td>
          <td id="LC6497">        pvCallSha2Final .Pfn(ucsPfnSha256Final), lCtxPtr, .HashFinal(0)</td>
        </tr>
        <tr>
          <td id="L6498" data-line-number="6498"></td>
          <td id="LC6498">        &#39;-- outer hash</td>
        </tr>
        <tr>
          <td id="L6499" data-line-number="6499"></td>
          <td id="LC6499">        Call FillMemory(.HashPad(0), LNG_SHA256_BLOCKSZ, LNG_HMAC_OUTER_PAD)</td>
        </tr>
        <tr>
          <td id="L6500" data-line-number="6500"></td>
          <td id="LC6500">        For lIdx = 0 To UBound(baKey)</td>
        </tr>
        <tr>
          <td id="L6501" data-line-number="6501"></td>
          <td id="LC6501">            .HashPad(lIdx) = baKey(lIdx) Xor LNG_HMAC_OUTER_PAD</td>
        </tr>
        <tr>
          <td id="L6502" data-line-number="6502"></td>
          <td id="LC6502">        Next</td>
        </tr>
        <tr>
          <td id="L6503" data-line-number="6503"></td>
          <td id="LC6503">        pvCallSha2Init .Pfn(ucsPfnSha256Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6504" data-line-number="6504"></td>
          <td id="LC6504">        pvCallSha2Update .Pfn(ucsPfnSha256Update), lCtxPtr, VarPtr(.HashPad(0)), LNG_SHA256_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6505" data-line-number="6505"></td>
          <td id="LC6505">        pvCallSha2Update .Pfn(ucsPfnSha256Update), lCtxPtr, VarPtr(.HashFinal(0)), LNG_SHA256_HASHSZ</td>
        </tr>
        <tr>
          <td id="L6506" data-line-number="6506"></td>
          <td id="LC6506">        pvCallSha2Final .Pfn(ucsPfnSha256Final), lCtxPtr, baRetVal(0)</td>
        </tr>
        <tr>
          <td id="L6507" data-line-number="6507"></td>
          <td id="LC6507">    End With</td>
        </tr>
        <tr>
          <td id="L6508" data-line-number="6508"></td>
          <td id="LC6508">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6509" data-line-number="6509"></td>
          <td id="LC6509">    pvCryptoHmacSha256 = True</td>
        </tr>
        <tr>
          <td id="L6510" data-line-number="6510"></td>
          <td id="LC6510">End Function</td>
        </tr>
        <tr>
          <td id="L6511" data-line-number="6511"></td>
          <td id="LC6511">
</td>
        </tr>
        <tr>
          <td id="L6512" data-line-number="6512"></td>
          <td id="LC6512">Private Function pvCryptoHmacSha384(baRetVal() As Byte, baKey() As Byte, baInput() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As Boolean</td>
        </tr>
        <tr>
          <td id="L6513" data-line-number="6513"></td>
          <td id="LC6513">    Const FUNC_NAME     As String = &#34;CryptoHmacSha384&#34;</td>
        </tr>
        <tr>
          <td id="L6514" data-line-number="6514"></td>
          <td id="LC6514">    Dim lCtxPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6515" data-line-number="6515"></td>
          <td id="LC6515">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6516" data-line-number="6516"></td>
          <td id="LC6516">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6517" data-line-number="6517"></td>
          <td id="LC6517">    </td>
        </tr>
        <tr>
          <td id="L6518" data-line-number="6518"></td>
          <td id="LC6518">    Debug.Assert UBound(baKey) &lt; LNG_SHA384_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6519" data-line-number="6519"></td>
          <td id="LC6519">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6520" data-line-number="6520"></td>
          <td id="LC6520">        Size = pvArraySize(baInput) - Pos</td>
        </tr>
        <tr>
          <td id="L6521" data-line-number="6521"></td>
          <td id="LC6521">    Else</td>
        </tr>
        <tr>
          <td id="L6522" data-line-number="6522"></td>
          <td id="LC6522">        Debug.Assert pvArraySize(baInput) &gt;= Pos + Size</td>
        </tr>
        <tr>
          <td id="L6523" data-line-number="6523"></td>
          <td id="LC6523">    End If</td>
        </tr>
        <tr>
          <td id="L6524" data-line-number="6524"></td>
          <td id="LC6524">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6525" data-line-number="6525"></td>
          <td id="LC6525">        lPtr = VarPtr(baInput(Pos))</td>
        </tr>
        <tr>
          <td id="L6526" data-line-number="6526"></td>
          <td id="LC6526">    End If</td>
        </tr>
        <tr>
          <td id="L6527" data-line-number="6527"></td>
          <td id="LC6527">    With m_uData</td>
        </tr>
        <tr>
          <td id="L6528" data-line-number="6528"></td>
          <td id="LC6528">        lCtxPtr = VarPtr(.HashCtx(0))</td>
        </tr>
        <tr>
          <td id="L6529" data-line-number="6529"></td>
          <td id="LC6529">        pvArrayAllocate baRetVal, LNG_SHA384_HASHSZ, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6530" data-line-number="6530"></td>
          <td id="LC6530">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Init)</td>
        </tr>
        <tr>
          <td id="L6531" data-line-number="6531"></td>
          <td id="LC6531">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Update)</td>
        </tr>
        <tr>
          <td id="L6532" data-line-number="6532"></td>
          <td id="LC6532">        Debug.Assert pvPatchTrampoline(AddressOf pvCallSha2Final)</td>
        </tr>
        <tr>
          <td id="L6533" data-line-number="6533"></td>
          <td id="LC6533">        &#39;-- inner hash</td>
        </tr>
        <tr>
          <td id="L6534" data-line-number="6534"></td>
          <td id="LC6534">        Call FillMemory(.HashPad(0), LNG_SHA384_BLOCKSZ, LNG_HMAC_INNER_PAD)</td>
        </tr>
        <tr>
          <td id="L6535" data-line-number="6535"></td>
          <td id="LC6535">        For lIdx = 0 To UBound(baKey)</td>
        </tr>
        <tr>
          <td id="L6536" data-line-number="6536"></td>
          <td id="LC6536">            .HashPad(lIdx) = baKey(lIdx) Xor LNG_HMAC_INNER_PAD</td>
        </tr>
        <tr>
          <td id="L6537" data-line-number="6537"></td>
          <td id="LC6537">        Next</td>
        </tr>
        <tr>
          <td id="L6538" data-line-number="6538"></td>
          <td id="LC6538">        pvCallSha2Init .Pfn(ucsPfnSha384Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6539" data-line-number="6539"></td>
          <td id="LC6539">        pvCallSha2Update .Pfn(ucsPfnSha384Update), lCtxPtr, VarPtr(.HashPad(0)), LNG_SHA384_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6540" data-line-number="6540"></td>
          <td id="LC6540">        pvCallSha2Update .Pfn(ucsPfnSha384Update), lCtxPtr, lPtr, Size</td>
        </tr>
        <tr>
          <td id="L6541" data-line-number="6541"></td>
          <td id="LC6541">        pvCallSha2Final .Pfn(ucsPfnSha384Final), lCtxPtr, .HashFinal(0)</td>
        </tr>
        <tr>
          <td id="L6542" data-line-number="6542"></td>
          <td id="LC6542">        &#39;-- outer hash</td>
        </tr>
        <tr>
          <td id="L6543" data-line-number="6543"></td>
          <td id="LC6543">        Call FillMemory(.HashPad(0), LNG_SHA384_BLOCKSZ, LNG_HMAC_OUTER_PAD)</td>
        </tr>
        <tr>
          <td id="L6544" data-line-number="6544"></td>
          <td id="LC6544">        For lIdx = 0 To UBound(baKey)</td>
        </tr>
        <tr>
          <td id="L6545" data-line-number="6545"></td>
          <td id="LC6545">            .HashPad(lIdx) = baKey(lIdx) Xor LNG_HMAC_OUTER_PAD</td>
        </tr>
        <tr>
          <td id="L6546" data-line-number="6546"></td>
          <td id="LC6546">        Next</td>
        </tr>
        <tr>
          <td id="L6547" data-line-number="6547"></td>
          <td id="LC6547">        pvCallSha2Init .Pfn(ucsPfnSha384Init), lCtxPtr</td>
        </tr>
        <tr>
          <td id="L6548" data-line-number="6548"></td>
          <td id="LC6548">        pvCallSha2Update .Pfn(ucsPfnSha384Update), lCtxPtr, VarPtr(.HashPad(0)), LNG_SHA384_BLOCKSZ</td>
        </tr>
        <tr>
          <td id="L6549" data-line-number="6549"></td>
          <td id="LC6549">        pvCallSha2Update .Pfn(ucsPfnSha384Update), lCtxPtr, VarPtr(.HashFinal(0)), LNG_SHA384_HASHSZ</td>
        </tr>
        <tr>
          <td id="L6550" data-line-number="6550"></td>
          <td id="LC6550">        pvCallSha2Final .Pfn(ucsPfnSha384Final), lCtxPtr, baRetVal(0)</td>
        </tr>
        <tr>
          <td id="L6551" data-line-number="6551"></td>
          <td id="LC6551">    End With</td>
        </tr>
        <tr>
          <td id="L6552" data-line-number="6552"></td>
          <td id="LC6552">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6553" data-line-number="6553"></td>
          <td id="LC6553">    pvCryptoHmacSha384 = True</td>
        </tr>
        <tr>
          <td id="L6554" data-line-number="6554"></td>
          <td id="LC6554">End Function</td>
        </tr>
        <tr>
          <td id="L6555" data-line-number="6555"></td>
          <td id="LC6555">
</td>
        </tr>
        <tr>
          <td id="L6556" data-line-number="6556"></td>
          <td id="LC6556">Private Function pvCryptoBulkChacha20Poly1305Encrypt( _</td>
        </tr>
        <tr>
          <td id="L6557" data-line-number="6557"></td>
          <td id="LC6557">            baNonce() As Byte, baKey() As Byte, _</td>
        </tr>
        <tr>
          <td id="L6558" data-line-number="6558"></td>
          <td id="LC6558">            baAad() As Byte, ByVal lAadPos As Long, ByVal lAadSize As Long, _</td>
        </tr>
        <tr>
          <td id="L6559" data-line-number="6559"></td>
          <td id="LC6559">            baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6560" data-line-number="6560"></td>
          <td id="LC6560">    Dim lAadPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6561" data-line-number="6561"></td>
          <td id="LC6561">    </td>
        </tr>
        <tr>
          <td id="L6562" data-line-number="6562"></td>
          <td id="LC6562">    Debug.Assert pvArraySize(baNonce) = LNG_CHACHA20POLY1305_IVSZ</td>
        </tr>
        <tr>
          <td id="L6563" data-line-number="6563"></td>
          <td id="LC6563">    Debug.Assert pvArraySize(baKey) = LNG_CHACHA20_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6564" data-line-number="6564"></td>
          <td id="LC6564">    Debug.Assert pvArraySize(baBuffer) &gt;= lPos + lSize + LNG_CHACHA20POLY1305_TAGSZ</td>
        </tr>
        <tr>
          <td id="L6565" data-line-number="6565"></td>
          <td id="LC6565">    If lAadSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6566" data-line-number="6566"></td>
          <td id="LC6566">        lAadPtr = VarPtr(baAad(lAadPos))</td>
        </tr>
        <tr>
          <td id="L6567" data-line-number="6567"></td>
          <td id="LC6567">    End If</td>
        </tr>
        <tr>
          <td id="L6568" data-line-number="6568"></td>
          <td id="LC6568">    Debug.Assert pvPatchTrampoline(AddressOf pvCallChacha20Poly1305Encrypt)</td>
        </tr>
        <tr>
          <td id="L6569" data-line-number="6569"></td>
          <td id="LC6569">    Call pvCallChacha20Poly1305Encrypt(m_uData.Pfn(ucsPfnChacha20Poly1305Encrypt), _</td>
        </tr>
        <tr>
          <td id="L6570" data-line-number="6570"></td>
          <td id="LC6570">            baKey(0), baNonce(0), _</td>
        </tr>
        <tr>
          <td id="L6571" data-line-number="6571"></td>
          <td id="LC6571">            lAadPtr, lAadSize, _</td>
        </tr>
        <tr>
          <td id="L6572" data-line-number="6572"></td>
          <td id="LC6572">            baBuffer(lPos), lSize, _</td>
        </tr>
        <tr>
          <td id="L6573" data-line-number="6573"></td>
          <td id="LC6573">            baBuffer(lPos), baBuffer(lPos + lSize))</td>
        </tr>
        <tr>
          <td id="L6574" data-line-number="6574"></td>
          <td id="LC6574">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6575" data-line-number="6575"></td>
          <td id="LC6575">    pvCryptoBulkChacha20Poly1305Encrypt = True</td>
        </tr>
        <tr>
          <td id="L6576" data-line-number="6576"></td>
          <td id="LC6576">End Function</td>
        </tr>
        <tr>
          <td id="L6577" data-line-number="6577"></td>
          <td id="LC6577">
</td>
        </tr>
        <tr>
          <td id="L6578" data-line-number="6578"></td>
          <td id="LC6578">Private Function pvCryptoBulkChacha20Poly1305Decrypt( _</td>
        </tr>
        <tr>
          <td id="L6579" data-line-number="6579"></td>
          <td id="LC6579">            baNonce() As Byte, baKey() As Byte, _</td>
        </tr>
        <tr>
          <td id="L6580" data-line-number="6580"></td>
          <td id="LC6580">            baAad() As Byte, ByVal lAadPos As Long, ByVal lAadSize As Long, _</td>
        </tr>
        <tr>
          <td id="L6581" data-line-number="6581"></td>
          <td id="LC6581">            baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6582" data-line-number="6582"></td>
          <td id="LC6582">    Debug.Assert pvArraySize(baNonce) = LNG_CHACHA20POLY1305_IVSZ</td>
        </tr>
        <tr>
          <td id="L6583" data-line-number="6583"></td>
          <td id="LC6583">    Debug.Assert pvArraySize(baKey) = LNG_CHACHA20_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6584" data-line-number="6584"></td>
          <td id="LC6584">    Debug.Assert pvArraySize(baBuffer) &gt;= lPos + lSize</td>
        </tr>
        <tr>
          <td id="L6585" data-line-number="6585"></td>
          <td id="LC6585">    Debug.Assert pvPatchTrampoline(AddressOf pvCallChacha20Poly1305Decrypt)</td>
        </tr>
        <tr>
          <td id="L6586" data-line-number="6586"></td>
          <td id="LC6586">    If pvCallChacha20Poly1305Decrypt(m_uData.Pfn(ucsPfnChacha20Poly1305Decrypt), _</td>
        </tr>
        <tr>
          <td id="L6587" data-line-number="6587"></td>
          <td id="LC6587">            baKey(0), baNonce(0), _</td>
        </tr>
        <tr>
          <td id="L6588" data-line-number="6588"></td>
          <td id="LC6588">            baAad(lAadPos), lAadSize, _</td>
        </tr>
        <tr>
          <td id="L6589" data-line-number="6589"></td>
          <td id="LC6589">            baBuffer(lPos), lSize - LNG_CHACHA20POLY1305_TAGSZ, _</td>
        </tr>
        <tr>
          <td id="L6590" data-line-number="6590"></td>
          <td id="LC6590">            baBuffer(lPos + lSize - LNG_CHACHA20POLY1305_TAGSZ), baBuffer(lPos)) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6591" data-line-number="6591"></td>
          <td id="LC6591">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6592" data-line-number="6592"></td>
          <td id="LC6592">        pvCryptoBulkChacha20Poly1305Decrypt = True</td>
        </tr>
        <tr>
          <td id="L6593" data-line-number="6593"></td>
          <td id="LC6593">    End If</td>
        </tr>
        <tr>
          <td id="L6594" data-line-number="6594"></td>
          <td id="LC6594">End Function</td>
        </tr>
        <tr>
          <td id="L6595" data-line-number="6595"></td>
          <td id="LC6595">
</td>
        </tr>
        <tr>
          <td id="L6596" data-line-number="6596"></td>
          <td id="LC6596">Private Function pvCryptoBulkAesGcmEncrypt( _</td>
        </tr>
        <tr>
          <td id="L6597" data-line-number="6597"></td>
          <td id="LC6597">            baNonce() As Byte, baKey() As Byte, _</td>
        </tr>
        <tr>
          <td id="L6598" data-line-number="6598"></td>
          <td id="LC6598">            baAad() As Byte, ByVal lAadPos As Long, ByVal lAadSize As Long, _</td>
        </tr>
        <tr>
          <td id="L6599" data-line-number="6599"></td>
          <td id="LC6599">            baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6600" data-line-number="6600"></td>
          <td id="LC6600">    Dim lAadPtr         As Long</td>
        </tr>
        <tr>
          <td id="L6601" data-line-number="6601"></td>
          <td id="LC6601">    </td>
        </tr>
        <tr>
          <td id="L6602" data-line-number="6602"></td>
          <td id="LC6602">    Debug.Assert pvArraySize(baNonce) = LNG_AESGCM_IVSZ</td>
        </tr>
        <tr>
          <td id="L6603" data-line-number="6603"></td>
          <td id="LC6603">    Debug.Assert pvArraySize(baKey) = LNG_AES128_KEYSZ Or pvArraySize(baKey) = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6604" data-line-number="6604"></td>
          <td id="LC6604">    Debug.Assert pvArraySize(baBuffer) &gt;= lPos + lSize + LNG_AESGCM_TAGSZ</td>
        </tr>
        <tr>
          <td id="L6605" data-line-number="6605"></td>
          <td id="LC6605">    If lAadSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6606" data-line-number="6606"></td>
          <td id="LC6606">        lAadPtr = VarPtr(baAad(lAadPos))</td>
        </tr>
        <tr>
          <td id="L6607" data-line-number="6607"></td>
          <td id="LC6607">    End If</td>
        </tr>
        <tr>
          <td id="L6608" data-line-number="6608"></td>
          <td id="LC6608">    Debug.Assert pvPatchTrampoline(AddressOf pvCallAesGcmEncrypt)</td>
        </tr>
        <tr>
          <td id="L6609" data-line-number="6609"></td>
          <td id="LC6609">    Call pvCallAesGcmEncrypt(m_uData.Pfn(ucsPfnAesGcmEncrypt), _</td>
        </tr>
        <tr>
          <td id="L6610" data-line-number="6610"></td>
          <td id="LC6610">            baBuffer(lPos), baBuffer(lPos + lSize), _</td>
        </tr>
        <tr>
          <td id="L6611" data-line-number="6611"></td>
          <td id="LC6611">            baBuffer(lPos), lSize, _</td>
        </tr>
        <tr>
          <td id="L6612" data-line-number="6612"></td>
          <td id="LC6612">            lAadPtr, lAadSize, _</td>
        </tr>
        <tr>
          <td id="L6613" data-line-number="6613"></td>
          <td id="LC6613">            baNonce(0), baKey(0), UBound(baKey) + 1)</td>
        </tr>
        <tr>
          <td id="L6614" data-line-number="6614"></td>
          <td id="LC6614">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6615" data-line-number="6615"></td>
          <td id="LC6615">    pvCryptoBulkAesGcmEncrypt = True</td>
        </tr>
        <tr>
          <td id="L6616" data-line-number="6616"></td>
          <td id="LC6616">End Function</td>
        </tr>
        <tr>
          <td id="L6617" data-line-number="6617"></td>
          <td id="LC6617">
</td>
        </tr>
        <tr>
          <td id="L6618" data-line-number="6618"></td>
          <td id="LC6618">Private Function pvCryptoBulkAesGcmDecrypt( _</td>
        </tr>
        <tr>
          <td id="L6619" data-line-number="6619"></td>
          <td id="LC6619">            baNonce() As Byte, baKey() As Byte, _</td>
        </tr>
        <tr>
          <td id="L6620" data-line-number="6620"></td>
          <td id="LC6620">            baAad() As Byte, ByVal lAadPos As Long, ByVal lAadSize As Long, _</td>
        </tr>
        <tr>
          <td id="L6621" data-line-number="6621"></td>
          <td id="LC6621">            baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6622" data-line-number="6622"></td>
          <td id="LC6622">    Debug.Assert pvArraySize(baNonce) = LNG_AESGCM_IVSZ</td>
        </tr>
        <tr>
          <td id="L6623" data-line-number="6623"></td>
          <td id="LC6623">    Debug.Assert pvArraySize(baKey) = LNG_AES128_KEYSZ Or pvArraySize(baKey) = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6624" data-line-number="6624"></td>
          <td id="LC6624">    Debug.Assert pvArraySize(baBuffer) &gt;= lPos + lSize</td>
        </tr>
        <tr>
          <td id="L6625" data-line-number="6625"></td>
          <td id="LC6625">    Debug.Assert pvPatchTrampoline(AddressOf pvCallAesGcmDecrypt)</td>
        </tr>
        <tr>
          <td id="L6626" data-line-number="6626"></td>
          <td id="LC6626">    If pvCallAesGcmDecrypt(m_uData.Pfn(ucsPfnAesGcmDecrypt), _</td>
        </tr>
        <tr>
          <td id="L6627" data-line-number="6627"></td>
          <td id="LC6627">            baBuffer(lPos), _</td>
        </tr>
        <tr>
          <td id="L6628" data-line-number="6628"></td>
          <td id="LC6628">            baBuffer(lPos), lSize - LNG_AESGCM_TAGSZ, _</td>
        </tr>
        <tr>
          <td id="L6629" data-line-number="6629"></td>
          <td id="LC6629">            baBuffer(lPos + lSize - LNG_AESGCM_TAGSZ), _</td>
        </tr>
        <tr>
          <td id="L6630" data-line-number="6630"></td>
          <td id="LC6630">            baAad(lAadPos), lAadSize, _</td>
        </tr>
        <tr>
          <td id="L6631" data-line-number="6631"></td>
          <td id="LC6631">            baNonce(0), baKey(0), UBound(baKey) + 1) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6632" data-line-number="6632"></td>
          <td id="LC6632">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6633" data-line-number="6633"></td>
          <td id="LC6633">        pvCryptoBulkAesGcmDecrypt = True</td>
        </tr>
        <tr>
          <td id="L6634" data-line-number="6634"></td>
          <td id="LC6634">    End If</td>
        </tr>
        <tr>
          <td id="L6635" data-line-number="6635"></td>
          <td id="LC6635">End Function</td>
        </tr>
        <tr>
          <td id="L6636" data-line-number="6636"></td>
          <td id="LC6636">
</td>
        </tr>
        <tr>
          <td id="L6637" data-line-number="6637"></td>
          <td id="LC6637">Private Function pvCryptoBulkAesCbcEncrypt( _</td>
        </tr>
        <tr>
          <td id="L6638" data-line-number="6638"></td>
          <td id="LC6638">            baNonce() As Byte, baKey() As Byte, _</td>
        </tr>
        <tr>
          <td id="L6639" data-line-number="6639"></td>
          <td id="LC6639">            baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6640" data-line-number="6640"></td>
          <td id="LC6640">    Debug.Assert pvArraySize(baNonce) = LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L6641" data-line-number="6641"></td>
          <td id="LC6641">    Debug.Assert pvArraySize(baKey) = LNG_AES128_KEYSZ Or pvArraySize(baKey) = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6642" data-line-number="6642"></td>
          <td id="LC6642">    Debug.Assert pvArraySize(baBuffer) &gt;= lPos + lSize</td>
        </tr>
        <tr>
          <td id="L6643" data-line-number="6643"></td>
          <td id="LC6643">    Debug.Assert lSize Mod pvArraySize(baNonce) = 0</td>
        </tr>
        <tr>
          <td id="L6644" data-line-number="6644"></td>
          <td id="LC6644">    Debug.Assert pvPatchTrampoline(AddressOf pvCallAesCbcEncrypt)</td>
        </tr>
        <tr>
          <td id="L6645" data-line-number="6645"></td>
          <td id="LC6645">    Call pvCallAesCbcEncrypt(m_uData.Pfn(ucsPfnAesCbcEncrypt), _</td>
        </tr>
        <tr>
          <td id="L6646" data-line-number="6646"></td>
          <td id="LC6646">            baBuffer(lPos), baBuffer(lPos), lSize, _</td>
        </tr>
        <tr>
          <td id="L6647" data-line-number="6647"></td>
          <td id="LC6647">            baNonce(0), baKey(0), UBound(baKey) + 1)</td>
        </tr>
        <tr>
          <td id="L6648" data-line-number="6648"></td>
          <td id="LC6648">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6649" data-line-number="6649"></td>
          <td id="LC6649">    pvCryptoBulkAesCbcEncrypt = True</td>
        </tr>
        <tr>
          <td id="L6650" data-line-number="6650"></td>
          <td id="LC6650">End Function</td>
        </tr>
        <tr>
          <td id="L6651" data-line-number="6651"></td>
          <td id="LC6651">
</td>
        </tr>
        <tr>
          <td id="L6652" data-line-number="6652"></td>
          <td id="LC6652">Private Function pvCryptoBulkAesCbcDecrypt( _</td>
        </tr>
        <tr>
          <td id="L6653" data-line-number="6653"></td>
          <td id="LC6653">            baNonce() As Byte, baKey() As Byte, _</td>
        </tr>
        <tr>
          <td id="L6654" data-line-number="6654"></td>
          <td id="LC6654">            baBuffer() As Byte, ByVal lPos As Long, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6655" data-line-number="6655"></td>
          <td id="LC6655">    Debug.Assert pvArraySize(baNonce) = LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L6656" data-line-number="6656"></td>
          <td id="LC6656">    Debug.Assert pvArraySize(baKey) = LNG_AES128_KEYSZ Or pvArraySize(baKey) = LNG_AES256_KEYSZ</td>
        </tr>
        <tr>
          <td id="L6657" data-line-number="6657"></td>
          <td id="LC6657">    Debug.Assert pvArraySize(baBuffer) &gt;= lPos + lSize</td>
        </tr>
        <tr>
          <td id="L6658" data-line-number="6658"></td>
          <td id="LC6658">    If lSize Mod pvArraySize(baNonce) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6659" data-line-number="6659"></td>
          <td id="LC6659">        Debug.Assert pvPatchTrampoline(AddressOf pvCallAesCbcDecrypt)</td>
        </tr>
        <tr>
          <td id="L6660" data-line-number="6660"></td>
          <td id="LC6660">        Call pvCallAesCbcDecrypt(m_uData.Pfn(ucsPfnAesCbcDecrypt), _</td>
        </tr>
        <tr>
          <td id="L6661" data-line-number="6661"></td>
          <td id="LC6661">                baBuffer(lPos), baBuffer(lPos), lSize, _</td>
        </tr>
        <tr>
          <td id="L6662" data-line-number="6662"></td>
          <td id="LC6662">                baNonce(0), baKey(0), UBound(baKey) + 1)</td>
        </tr>
        <tr>
          <td id="L6663" data-line-number="6663"></td>
          <td id="LC6663">        &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6664" data-line-number="6664"></td>
          <td id="LC6664">        pvCryptoBulkAesCbcDecrypt = True</td>
        </tr>
        <tr>
          <td id="L6665" data-line-number="6665"></td>
          <td id="LC6665">    End If</td>
        </tr>
        <tr>
          <td id="L6666" data-line-number="6666"></td>
          <td id="LC6666">End Function</td>
        </tr>
        <tr>
          <td id="L6667" data-line-number="6667"></td>
          <td id="LC6667">
</td>
        </tr>
        <tr>
          <td id="L6668" data-line-number="6668"></td>
          <td id="LC6668">Private Sub pvCryptoRandomBytes(ByVal lPtr As Long, ByVal lSize As Long)</td>
        </tr>
        <tr>
          <td id="L6669" data-line-number="6669"></td>
          <td id="LC6669">    Call CryptGenRandom(m_uData.hRandomProv, lSize, lPtr)</td>
        </tr>
        <tr>
          <td id="L6670" data-line-number="6670"></td>
          <td id="LC6670">End Sub</td>
        </tr>
        <tr>
          <td id="L6671" data-line-number="6671"></td>
          <td id="LC6671">
</td>
        </tr>
        <tr>
          <td id="L6672" data-line-number="6672"></td>
          <td id="LC6672">Private Function pvCryptoRsaModExp(baBase() As Byte, baExp() As Byte, baModulus() As Byte, baRetVal() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6673" data-line-number="6673"></td>
          <td id="LC6673">    Const FUNC_NAME     As String = &#34;CryptoRsaModExp&#34;</td>
        </tr>
        <tr>
          <td id="L6674" data-line-number="6674"></td>
          <td id="LC6674">    </td>
        </tr>
        <tr>
          <td id="L6675" data-line-number="6675"></td>
          <td id="LC6675">    pvArrayAllocate baRetVal, UBound(baBase) + 1, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6676" data-line-number="6676"></td>
          <td id="LC6676">    Debug.Assert pvPatchTrampoline(AddressOf pvCallRsaModExp)</td>
        </tr>
        <tr>
          <td id="L6677" data-line-number="6677"></td>
          <td id="LC6677">    Call pvCallRsaModExp(m_uData.Pfn(ucsPfnRsaModExp), UBound(baBase) + 1, baBase(0), baExp(0), baModulus(0), baRetVal(0))</td>
        </tr>
        <tr>
          <td id="L6678" data-line-number="6678"></td>
          <td id="LC6678">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6679" data-line-number="6679"></td>
          <td id="LC6679">    pvCryptoRsaModExp = True</td>
        </tr>
        <tr>
          <td id="L6680" data-line-number="6680"></td>
          <td id="LC6680">End Function</td>
        </tr>
        <tr>
          <td id="L6681" data-line-number="6681"></td>
          <td id="LC6681">
</td>
        </tr>
        <tr>
          <td id="L6682" data-line-number="6682"></td>
          <td id="LC6682">Private Function pvCryptoRsaCrtModExp(baBase() As Byte, baExp() As Byte, baModulus() As Byte, baPrime1() As Byte, baPrime2() As Byte, baCoefficient() As Byte, baRetVal() As Byte) As Boolean</td>
        </tr>
        <tr>
          <td id="L6683" data-line-number="6683"></td>
          <td id="LC6683">    Const FUNC_NAME     As String = &#34;CryptoRsaCrtModExp&#34;</td>
        </tr>
        <tr>
          <td id="L6684" data-line-number="6684"></td>
          <td id="LC6684">    </td>
        </tr>
        <tr>
          <td id="L6685" data-line-number="6685"></td>
          <td id="LC6685">    pvArrayAllocate baRetVal, UBound(baBase) + 1, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6686" data-line-number="6686"></td>
          <td id="LC6686">    Debug.Assert pvPatchTrampoline(AddressOf pvCallRsaCrtModExp)</td>
        </tr>
        <tr>
          <td id="L6687" data-line-number="6687"></td>
          <td id="LC6687">    Call pvCallRsaCrtModExp(m_uData.Pfn(ucsPfnRsaCrtModExp), UBound(baBase) + 1, baBase(0), baExp(0), baModulus(0), baPrime1(0), baPrime2(0), baCoefficient(0), baRetVal(0))</td>
        </tr>
        <tr>
          <td id="L6688" data-line-number="6688"></td>
          <td id="LC6688">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6689" data-line-number="6689"></td>
          <td id="LC6689">    pvCryptoRsaCrtModExp = True</td>
        </tr>
        <tr>
          <td id="L6690" data-line-number="6690"></td>
          <td id="LC6690">End Function</td>
        </tr>
        <tr>
          <td id="L6691" data-line-number="6691"></td>
          <td id="LC6691">
</td>
        </tr>
        <tr>
          <td id="L6692" data-line-number="6692"></td>
          <td id="LC6692">&#39;= private ===============================================================</td>
        </tr>
        <tr>
          <td id="L6693" data-line-number="6693"></td>
          <td id="LC6693">
</td>
        </tr>
        <tr>
          <td id="L6694" data-line-number="6694"></td>
          <td id="LC6694">Private Function pvThunkAllocate(sText As String, Optional ByVal ThunkPtr As Long) As Long</td>
        </tr>
        <tr>
          <td id="L6695" data-line-number="6695"></td>
          <td id="LC6695">    Static Map(0 To &amp;H3FF) As Long</td>
        </tr>
        <tr>
          <td id="L6696" data-line-number="6696"></td>
          <td id="LC6696">    Dim baInput()       As Byte</td>
        </tr>
        <tr>
          <td id="L6697" data-line-number="6697"></td>
          <td id="LC6697">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6698" data-line-number="6698"></td>
          <td id="LC6698">    Dim lChar           As Long</td>
        </tr>
        <tr>
          <td id="L6699" data-line-number="6699"></td>
          <td id="LC6699">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L6700" data-line-number="6700"></td>
          <td id="LC6700">    </td>
        </tr>
        <tr>
          <td id="L6701" data-line-number="6701"></td>
          <td id="LC6701">    If ThunkPtr &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6702" data-line-number="6702"></td>
          <td id="LC6702">        pvThunkAllocate = ThunkPtr</td>
        </tr>
        <tr>
          <td id="L6703" data-line-number="6703"></td>
          <td id="LC6703">    Else</td>
        </tr>
        <tr>
          <td id="L6704" data-line-number="6704"></td>
          <td id="LC6704">        pvThunkAllocate = VirtualAlloc(0, (Len(sText) \ 4) * 3, MEM_COMMIT, PAGE_EXECUTE_READWRITE)</td>
        </tr>
        <tr>
          <td id="L6705" data-line-number="6705"></td>
          <td id="LC6705">        If pvThunkAllocate = 0 Then</td>
        </tr>
        <tr>
          <td id="L6706" data-line-number="6706"></td>
          <td id="LC6706">            Exit Function</td>
        </tr>
        <tr>
          <td id="L6707" data-line-number="6707"></td>
          <td id="LC6707">        End If</td>
        </tr>
        <tr>
          <td id="L6708" data-line-number="6708"></td>
          <td id="LC6708">    End If</td>
        </tr>
        <tr>
          <td id="L6709" data-line-number="6709"></td>
          <td id="LC6709">    &#39;--- init decoding maps</td>
        </tr>
        <tr>
          <td id="L6710" data-line-number="6710"></td>
          <td id="LC6710">    If Map(65) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6711" data-line-number="6711"></td>
          <td id="LC6711">        baInput = StrConv(&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;, vbFromUnicode)</td>
        </tr>
        <tr>
          <td id="L6712" data-line-number="6712"></td>
          <td id="LC6712">        For lIdx = 0 To UBound(baInput)</td>
        </tr>
        <tr>
          <td id="L6713" data-line-number="6713"></td>
          <td id="LC6713">            lChar = baInput(lIdx)</td>
        </tr>
        <tr>
          <td id="L6714" data-line-number="6714"></td>
          <td id="LC6714">            Map(&amp;H0 + lChar) = lIdx * (2 ^ 2)</td>
        </tr>
        <tr>
          <td id="L6715" data-line-number="6715"></td>
          <td id="LC6715">            Map(&amp;H100 + lChar) = (lIdx And &amp;H30) \ (2 ^ 4) Or (lIdx And &amp;HF) * (2 ^ 12)</td>
        </tr>
        <tr>
          <td id="L6716" data-line-number="6716"></td>
          <td id="LC6716">            Map(&amp;H200 + lChar) = (lIdx And &amp;H3) * (2 ^ 22) Or (lIdx And &amp;H3C) * (2 ^ 6)</td>
        </tr>
        <tr>
          <td id="L6717" data-line-number="6717"></td>
          <td id="LC6717">            Map(&amp;H300 + lChar) = lIdx * (2 ^ 16)</td>
        </tr>
        <tr>
          <td id="L6718" data-line-number="6718"></td>
          <td id="LC6718">        Next</td>
        </tr>
        <tr>
          <td id="L6719" data-line-number="6719"></td>
          <td id="LC6719">    End If</td>
        </tr>
        <tr>
          <td id="L6720" data-line-number="6720"></td>
          <td id="LC6720">    &#39;--- base64 decode loop</td>
        </tr>
        <tr>
          <td id="L6721" data-line-number="6721"></td>
          <td id="LC6721">    baInput = StrConv(Replace(Replace(sText, vbCr, vbNullString), vbLf, vbNullString), vbFromUnicode)</td>
        </tr>
        <tr>
          <td id="L6722" data-line-number="6722"></td>
          <td id="LC6722">    lPtr = pvThunkAllocate</td>
        </tr>
        <tr>
          <td id="L6723" data-line-number="6723"></td>
          <td id="LC6723">    For lIdx = 0 To UBound(baInput) - 3 Step 4</td>
        </tr>
        <tr>
          <td id="L6724" data-line-number="6724"></td>
          <td id="LC6724">        lChar = Map(baInput(lIdx + 0)) Or Map(&amp;H100 + baInput(lIdx + 1)) Or Map(&amp;H200 + baInput(lIdx + 2)) Or Map(&amp;H300 + baInput(lIdx + 3))</td>
        </tr>
        <tr>
          <td id="L6725" data-line-number="6725"></td>
          <td id="LC6725">        Call CopyMemory(ByVal lPtr, lChar, 3)</td>
        </tr>
        <tr>
          <td id="L6726" data-line-number="6726"></td>
          <td id="LC6726">        lPtr = UnsignedAdd(lPtr, 3)</td>
        </tr>
        <tr>
          <td id="L6727" data-line-number="6727"></td>
          <td id="LC6727">    Next</td>
        </tr>
        <tr>
          <td id="L6728" data-line-number="6728"></td>
          <td id="LC6728">End Function</td>
        </tr>
        <tr>
          <td id="L6729" data-line-number="6729"></td>
          <td id="LC6729">
</td>
        </tr>
        <tr>
          <td id="L6730" data-line-number="6730"></td>
          <td id="LC6730">Private Function pvPatchTrampoline(ByVal Pfn As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6731" data-line-number="6731"></td>
          <td id="LC6731">    Dim bInIDE          As Boolean</td>
        </tr>
        <tr>
          <td id="L6732" data-line-number="6732"></td>
          <td id="LC6732"> </td>
        </tr>
        <tr>
          <td id="L6733" data-line-number="6733"></td>
          <td id="LC6733">    Debug.Assert pvSetTrue(bInIDE)</td>
        </tr>
        <tr>
          <td id="L6734" data-line-number="6734"></td>
          <td id="LC6734">    If bInIDE Then</td>
        </tr>
        <tr>
          <td id="L6735" data-line-number="6735"></td>
          <td id="LC6735">        &#39;--- note: IDE is not large-address aware</td>
        </tr>
        <tr>
          <td id="L6736" data-line-number="6736"></td>
          <td id="LC6736">        Call CopyMemory(Pfn, ByVal Pfn + &amp;H16, LenB(Pfn))</td>
        </tr>
        <tr>
          <td id="L6737" data-line-number="6737"></td>
          <td id="LC6737">    Else</td>
        </tr>
        <tr>
          <td id="L6738" data-line-number="6738"></td>
          <td id="LC6738">        Call VirtualProtect(Pfn, 8, PAGE_EXECUTE_READWRITE, 0)</td>
        </tr>
        <tr>
          <td id="L6739" data-line-number="6739"></td>
          <td id="LC6739">    End If</td>
        </tr>
        <tr>
          <td id="L6740" data-line-number="6740"></td>
          <td id="LC6740">    &#39; 0:  58                      pop    eax</td>
        </tr>
        <tr>
          <td id="L6741" data-line-number="6741"></td>
          <td id="LC6741">    &#39; 1:  59                      pop    ecx</td>
        </tr>
        <tr>
          <td id="L6742" data-line-number="6742"></td>
          <td id="LC6742">    &#39; 2:  50                      push   eax</td>
        </tr>
        <tr>
          <td id="L6743" data-line-number="6743"></td>
          <td id="LC6743">    &#39; 3:  ff e1                   jmp    ecx</td>
        </tr>
        <tr>
          <td id="L6744" data-line-number="6744"></td>
          <td id="LC6744">    &#39; 5:  90                      nop</td>
        </tr>
        <tr>
          <td id="L6745" data-line-number="6745"></td>
          <td id="LC6745">    &#39; 6:  90                      nop</td>
        </tr>
        <tr>
          <td id="L6746" data-line-number="6746"></td>
          <td id="LC6746">    &#39; 7:  90                      nop</td>
        </tr>
        <tr>
          <td id="L6747" data-line-number="6747"></td>
          <td id="LC6747">    Call CopyMemory(ByVal Pfn, -802975883527609.7192@, 8)</td>
        </tr>
        <tr>
          <td id="L6748" data-line-number="6748"></td>
          <td id="LC6748">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6749" data-line-number="6749"></td>
          <td id="LC6749">    pvPatchTrampoline = True</td>
        </tr>
        <tr>
          <td id="L6750" data-line-number="6750"></td>
          <td id="LC6750">End Function</td>
        </tr>
        <tr>
          <td id="L6751" data-line-number="6751"></td>
          <td id="LC6751">
</td>
        </tr>
        <tr>
          <td id="L6752" data-line-number="6752"></td>
          <td id="LC6752">Private Function pvSetTrue(bValue As Boolean) As Boolean</td>
        </tr>
        <tr>
          <td id="L6753" data-line-number="6753"></td>
          <td id="LC6753">    #If TWINBASIC = 0 Then</td>
        </tr>
        <tr>
          <td id="L6754" data-line-number="6754"></td>
          <td id="LC6754">        bValue = True</td>
        </tr>
        <tr>
          <td id="L6755" data-line-number="6755"></td>
          <td id="LC6755">    #End If</td>
        </tr>
        <tr>
          <td id="L6756" data-line-number="6756"></td>
          <td id="LC6756">    pvSetTrue = True</td>
        </tr>
        <tr>
          <td id="L6757" data-line-number="6757"></td>
          <td id="LC6757">End Function</td>
        </tr>
        <tr>
          <td id="L6758" data-line-number="6758"></td>
          <td id="LC6758">
</td>
        </tr>
        <tr>
          <td id="L6759" data-line-number="6759"></td>
          <td id="LC6759">#If Not ImplUseShared Then</td>
        </tr>
        <tr>
          <td id="L6760" data-line-number="6760"></td>
          <td id="LC6760">Private Function RedimStats(sFuncName As String, ByVal lSize As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6761" data-line-number="6761"></td>
          <td id="LC6761">    #If sFuncName And lSize Then</td>
        </tr>
        <tr>
          <td id="L6762" data-line-number="6762"></td>
          <td id="LC6762">    #End If</td>
        </tr>
        <tr>
          <td id="L6763" data-line-number="6763"></td>
          <td id="LC6763">    RedimStats = True</td>
        </tr>
        <tr>
          <td id="L6764" data-line-number="6764"></td>
          <td id="LC6764">End Function</td>
        </tr>
        <tr>
          <td id="L6765" data-line-number="6765"></td>
          <td id="LC6765">
</td>
        </tr>
        <tr>
          <td id="L6766" data-line-number="6766"></td>
          <td id="LC6766">Public Sub RemoveCollection(ByVal oCol As Collection, Index As Variant)</td>
        </tr>
        <tr>
          <td id="L6767" data-line-number="6767"></td>
          <td id="LC6767">    If Not oCol Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L6768" data-line-number="6768"></td>
          <td id="LC6768">        pvCallCollectionRemove oCol, Index</td>
        </tr>
        <tr>
          <td id="L6769" data-line-number="6769"></td>
          <td id="LC6769">    End If</td>
        </tr>
        <tr>
          <td id="L6770" data-line-number="6770"></td>
          <td id="LC6770">End Sub</td>
        </tr>
        <tr>
          <td id="L6771" data-line-number="6771"></td>
          <td id="LC6771">
</td>
        </tr>
        <tr>
          <td id="L6772" data-line-number="6772"></td>
          <td id="LC6772">Public Function SearchCollection(ByVal oCol As Collection, Index As Variant, Optional RetVal As Variant) As Boolean</td>
        </tr>
        <tr>
          <td id="L6773" data-line-number="6773"></td>
          <td id="LC6773">    Dim vItem           As Variant</td>
        </tr>
        <tr>
          <td id="L6774" data-line-number="6774"></td>
          <td id="LC6774">    </td>
        </tr>
        <tr>
          <td id="L6775" data-line-number="6775"></td>
          <td id="LC6775">    If oCol Is Nothing Then</td>
        </tr>
        <tr>
          <td id="L6776" data-line-number="6776"></td>
          <td id="LC6776">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6777" data-line-number="6777"></td>
          <td id="LC6777">    ElseIf pvCallCollectionItem(oCol, Index, vItem) &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6778" data-line-number="6778"></td>
          <td id="LC6778">        GoTo QH</td>
        </tr>
        <tr>
          <td id="L6779" data-line-number="6779"></td>
          <td id="LC6779">    End If</td>
        </tr>
        <tr>
          <td id="L6780" data-line-number="6780"></td>
          <td id="LC6780">    If IsObject(vItem) Then</td>
        </tr>
        <tr>
          <td id="L6781" data-line-number="6781"></td>
          <td id="LC6781">        Set RetVal = vItem</td>
        </tr>
        <tr>
          <td id="L6782" data-line-number="6782"></td>
          <td id="LC6782">    Else</td>
        </tr>
        <tr>
          <td id="L6783" data-line-number="6783"></td>
          <td id="LC6783">        RetVal = vItem</td>
        </tr>
        <tr>
          <td id="L6784" data-line-number="6784"></td>
          <td id="LC6784">    End If</td>
        </tr>
        <tr>
          <td id="L6785" data-line-number="6785"></td>
          <td id="LC6785">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6786" data-line-number="6786"></td>
          <td id="LC6786">    SearchCollection = True</td>
        </tr>
        <tr>
          <td id="L6787" data-line-number="6787"></td>
          <td id="LC6787">QH:</td>
        </tr>
        <tr>
          <td id="L6788" data-line-number="6788"></td>
          <td id="LC6788">End Function</td>
        </tr>
        <tr>
          <td id="L6789" data-line-number="6789"></td>
          <td id="LC6789">
</td>
        </tr>
        <tr>
          <td id="L6790" data-line-number="6790"></td>
          <td id="LC6790">Public Function FromBase64Array(sText As String) As Byte()</td>
        </tr>
        <tr>
          <td id="L6791" data-line-number="6791"></td>
          <td id="LC6791">    Const FUNC_NAME     As String = &#34;FromBase64Array&#34;</td>
        </tr>
        <tr>
          <td id="L6792" data-line-number="6792"></td>
          <td id="LC6792">    Dim baRetVal()      As Byte</td>
        </tr>
        <tr>
          <td id="L6793" data-line-number="6793"></td>
          <td id="LC6793">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L6794" data-line-number="6794"></td>
          <td id="LC6794">
</td>
        </tr>
        <tr>
          <td id="L6795" data-line-number="6795"></td>
          <td id="LC6795">    lSize = (Len(sText) \ 4) * 3</td>
        </tr>
        <tr>
          <td id="L6796" data-line-number="6796"></td>
          <td id="LC6796">    pvArrayAllocate baRetVal, lSize, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6797" data-line-number="6797"></td>
          <td id="LC6797">    pvThunkAllocate sText, VarPtr(baRetVal(0))</td>
        </tr>
        <tr>
          <td id="L6798" data-line-number="6798"></td>
          <td id="LC6798">    If Right$(sText, 2) = &#34;==&#34; Then</td>
        </tr>
        <tr>
          <td id="L6799" data-line-number="6799"></td>
          <td id="LC6799">        pvArrayReallocate baRetVal, lSize - 2, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6800" data-line-number="6800"></td>
          <td id="LC6800">    ElseIf Right$(sText, 1) = &#34;=&#34; Then</td>
        </tr>
        <tr>
          <td id="L6801" data-line-number="6801"></td>
          <td id="LC6801">        pvArrayReallocate baRetVal, lSize - 1, FUNC_NAME &amp; &#34;.baRetVal&#34;</td>
        </tr>
        <tr>
          <td id="L6802" data-line-number="6802"></td>
          <td id="LC6802">    End If</td>
        </tr>
        <tr>
          <td id="L6803" data-line-number="6803"></td>
          <td id="LC6803">    FromBase64Array = baRetVal</td>
        </tr>
        <tr>
          <td id="L6804" data-line-number="6804"></td>
          <td id="LC6804">End Function</td>
        </tr>
        <tr>
          <td id="L6805" data-line-number="6805"></td>
          <td id="LC6805">
</td>
        </tr>
        <tr>
          <td id="L6806" data-line-number="6806"></td>
          <td id="LC6806">Private Function UnsignedAdd(ByVal lUnsignedPtr As Long, ByVal lSignedOffset As Long) As Long</td>
        </tr>
        <tr>
          <td id="L6807" data-line-number="6807"></td>
          <td id="LC6807">    &#39;--- note: safely add *signed* offset to *unsigned* ptr for *unsigned* retval w/o overflow in LARGEADDRESSAWARE processes</td>
        </tr>
        <tr>
          <td id="L6808" data-line-number="6808"></td>
          <td id="LC6808">    UnsignedAdd = ((lUnsignedPtr Xor &amp;H80000000) + lSignedOffset) Xor &amp;H80000000</td>
        </tr>
        <tr>
          <td id="L6809" data-line-number="6809"></td>
          <td id="LC6809">End Function</td>
        </tr>
        <tr>
          <td id="L6810" data-line-number="6810"></td>
          <td id="LC6810">
</td>
        </tr>
        <tr>
          <td id="L6811" data-line-number="6811"></td>
          <td id="LC6811">Private Function pvCallCollectionItem(ByVal oCol As Collection, Index As Variant, Optional RetVal As Variant) As Long</td>
        </tr>
        <tr>
          <td id="L6812" data-line-number="6812"></td>
          <td id="LC6812">    Const IDX_COLLECTION_ITEM As Long = 7</td>
        </tr>
        <tr>
          <td id="L6813" data-line-number="6813"></td>
          <td id="LC6813">    </td>
        </tr>
        <tr>
          <td id="L6814" data-line-number="6814"></td>
          <td id="LC6814">    pvPatchMethodTrampoline AddressOf mdTlsThunks.pvCallCollectionItem, IDX_COLLECTION_ITEM</td>
        </tr>
        <tr>
          <td id="L6815" data-line-number="6815"></td>
          <td id="LC6815">    pvCallCollectionItem = pvCallCollectionItem(oCol, Index, RetVal)</td>
        </tr>
        <tr>
          <td id="L6816" data-line-number="6816"></td>
          <td id="LC6816">End Function</td>
        </tr>
        <tr>
          <td id="L6817" data-line-number="6817"></td>
          <td id="LC6817">
</td>
        </tr>
        <tr>
          <td id="L6818" data-line-number="6818"></td>
          <td id="LC6818">Private Function pvCallCollectionRemove(ByVal oCol As Collection, Index As Variant) As Long</td>
        </tr>
        <tr>
          <td id="L6819" data-line-number="6819"></td>
          <td id="LC6819">    Const IDX_COLLECTION_REMOVE As Long = 10</td>
        </tr>
        <tr>
          <td id="L6820" data-line-number="6820"></td>
          <td id="LC6820">    </td>
        </tr>
        <tr>
          <td id="L6821" data-line-number="6821"></td>
          <td id="LC6821">    pvPatchMethodTrampoline AddressOf mdTlsThunks.pvCallCollectionRemove, IDX_COLLECTION_REMOVE</td>
        </tr>
        <tr>
          <td id="L6822" data-line-number="6822"></td>
          <td id="LC6822">    pvCallCollectionRemove = pvCallCollectionRemove(oCol, Index)</td>
        </tr>
        <tr>
          <td id="L6823" data-line-number="6823"></td>
          <td id="LC6823">End Function</td>
        </tr>
        <tr>
          <td id="L6824" data-line-number="6824"></td>
          <td id="LC6824">
</td>
        </tr>
        <tr>
          <td id="L6825" data-line-number="6825"></td>
          <td id="LC6825">Private Function pvPatchMethodTrampoline(ByVal Pfn As Long, ByVal lMethodIdx As Long) As Boolean</td>
        </tr>
        <tr>
          <td id="L6826" data-line-number="6826"></td>
          <td id="LC6826">    Dim bInIDE          As Boolean</td>
        </tr>
        <tr>
          <td id="L6827" data-line-number="6827"></td>
          <td id="LC6827">
</td>
        </tr>
        <tr>
          <td id="L6828" data-line-number="6828"></td>
          <td id="LC6828">    Debug.Assert pvSetTrue(bInIDE)</td>
        </tr>
        <tr>
          <td id="L6829" data-line-number="6829"></td>
          <td id="LC6829">    If bInIDE Then</td>
        </tr>
        <tr>
          <td id="L6830" data-line-number="6830"></td>
          <td id="LC6830">        &#39;--- note: IDE is not large-address aware</td>
        </tr>
        <tr>
          <td id="L6831" data-line-number="6831"></td>
          <td id="LC6831">        Call CopyMemory(Pfn, ByVal Pfn + &amp;H16, LenB(Pfn))</td>
        </tr>
        <tr>
          <td id="L6832" data-line-number="6832"></td>
          <td id="LC6832">    Else</td>
        </tr>
        <tr>
          <td id="L6833" data-line-number="6833"></td>
          <td id="LC6833">        Call VirtualProtect(Pfn, 12, PAGE_EXECUTE_READWRITE, 0)</td>
        </tr>
        <tr>
          <td id="L6834" data-line-number="6834"></td>
          <td id="LC6834">    End If</td>
        </tr>
        <tr>
          <td id="L6835" data-line-number="6835"></td>
          <td id="LC6835">    &#39; 0: 8B 44 24 04          mov         eax,dword ptr [esp+4]</td>
        </tr>
        <tr>
          <td id="L6836" data-line-number="6836"></td>
          <td id="LC6836">    &#39; 4: 8B 00                mov         eax,dword ptr [eax]</td>
        </tr>
        <tr>
          <td id="L6837" data-line-number="6837"></td>
          <td id="LC6837">    &#39; 6: FF A0 00 00 00 00    jmp         dword ptr [eax+lMethodIdx*4]</td>
        </tr>
        <tr>
          <td id="L6838" data-line-number="6838"></td>
          <td id="LC6838">    Call CopyMemory(ByVal Pfn, -684575231150992.4725@, 8)</td>
        </tr>
        <tr>
          <td id="L6839" data-line-number="6839"></td>
          <td id="LC6839">    Call CopyMemory(ByVal (Pfn Xor &amp;H80000000) + 8 Xor &amp;H80000000, lMethodIdx * PTR_SIZE, LenB(lMethodIdx))</td>
        </tr>
        <tr>
          <td id="L6840" data-line-number="6840"></td>
          <td id="LC6840">    &#39;--- success</td>
        </tr>
        <tr>
          <td id="L6841" data-line-number="6841"></td>
          <td id="LC6841">    pvPatchMethodTrampoline = True</td>
        </tr>
        <tr>
          <td id="L6842" data-line-number="6842"></td>
          <td id="LC6842">End Function</td>
        </tr>
        <tr>
          <td id="L6843" data-line-number="6843"></td>
          <td id="LC6843">
</td>
        </tr>
        <tr>
          <td id="L6844" data-line-number="6844"></td>
          <td id="LC6844">Private Function SplitOrReindex(Expression As String, Delimiter As String) As Variant</td>
        </tr>
        <tr>
          <td id="L6845" data-line-number="6845"></td>
          <td id="LC6845">    Dim vResult         As Variant</td>
        </tr>
        <tr>
          <td id="L6846" data-line-number="6846"></td>
          <td id="LC6846">    Dim vTemp           As Variant</td>
        </tr>
        <tr>
          <td id="L6847" data-line-number="6847"></td>
          <td id="LC6847">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6848" data-line-number="6848"></td>
          <td id="LC6848">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L6849" data-line-number="6849"></td>
          <td id="LC6849">    </td>
        </tr>
        <tr>
          <td id="L6850" data-line-number="6850"></td>
          <td id="LC6850">    vResult = Split(Expression, Delimiter)</td>
        </tr>
        <tr>
          <td id="L6851" data-line-number="6851"></td>
          <td id="LC6851">    &#39;--- check if reindex needed</td>
        </tr>
        <tr>
          <td id="L6852" data-line-number="6852"></td>
          <td id="LC6852">    If IsNumeric(vResult(0)) Then</td>
        </tr>
        <tr>
          <td id="L6853" data-line-number="6853"></td>
          <td id="LC6853">        vTemp = vResult</td>
        </tr>
        <tr>
          <td id="L6854" data-line-number="6854"></td>
          <td id="LC6854">        For lIdx = 0 To UBound(vTemp) Step 2</td>
        </tr>
        <tr>
          <td id="L6855" data-line-number="6855"></td>
          <td id="LC6855">            If lSize &lt; vTemp(lIdx) Then</td>
        </tr>
        <tr>
          <td id="L6856" data-line-number="6856"></td>
          <td id="LC6856">                lSize = vTemp(lIdx)</td>
        </tr>
        <tr>
          <td id="L6857" data-line-number="6857"></td>
          <td id="LC6857">            End If</td>
        </tr>
        <tr>
          <td id="L6858" data-line-number="6858"></td>
          <td id="LC6858">        Next</td>
        </tr>
        <tr>
          <td id="L6859" data-line-number="6859"></td>
          <td id="LC6859">        ReDim vResult(0 To lSize) As Variant</td>
        </tr>
        <tr>
          <td id="L6860" data-line-number="6860"></td>
          <td id="LC6860">        Debug.Assert RedimStats(MODULE_NAME &amp; &#34;.SplitOrReindex.vResult&#34;, 0)</td>
        </tr>
        <tr>
          <td id="L6861" data-line-number="6861"></td>
          <td id="LC6861">        For lIdx = 0 To UBound(vTemp) Step 2</td>
        </tr>
        <tr>
          <td id="L6862" data-line-number="6862"></td>
          <td id="LC6862">            vResult(vTemp(lIdx)) = vTemp(lIdx + 1)</td>
        </tr>
        <tr>
          <td id="L6863" data-line-number="6863"></td>
          <td id="LC6863">        Next</td>
        </tr>
        <tr>
          <td id="L6864" data-line-number="6864"></td>
          <td id="LC6864">        SplitOrReindex = vResult</td>
        </tr>
        <tr>
          <td id="L6865" data-line-number="6865"></td>
          <td id="LC6865">    End If</td>
        </tr>
        <tr>
          <td id="L6866" data-line-number="6866"></td>
          <td id="LC6866">End Function</td>
        </tr>
        <tr>
          <td id="L6867" data-line-number="6867"></td>
          <td id="LC6867">
</td>
        </tr>
        <tr>
          <td id="L6868" data-line-number="6868"></td>
          <td id="LC6868">Private Function Clamp( _</td>
        </tr>
        <tr>
          <td id="L6869" data-line-number="6869"></td>
          <td id="LC6869">            ByVal lValue As Long, _</td>
        </tr>
        <tr>
          <td id="L6870" data-line-number="6870"></td>
          <td id="LC6870">            Optional ByVal lMin As Long = -2147483647, _</td>
        </tr>
        <tr>
          <td id="L6871" data-line-number="6871"></td>
          <td id="LC6871">            Optional ByVal lMax As Long = 2147483647) As Long</td>
        </tr>
        <tr>
          <td id="L6872" data-line-number="6872"></td>
          <td id="LC6872">    Select Case lValue</td>
        </tr>
        <tr>
          <td id="L6873" data-line-number="6873"></td>
          <td id="LC6873">    Case lMin To lMax</td>
        </tr>
        <tr>
          <td id="L6874" data-line-number="6874"></td>
          <td id="LC6874">        Clamp = lValue</td>
        </tr>
        <tr>
          <td id="L6875" data-line-number="6875"></td>
          <td id="LC6875">    Case Is &lt; lMin</td>
        </tr>
        <tr>
          <td id="L6876" data-line-number="6876"></td>
          <td id="LC6876">        Clamp = lMin</td>
        </tr>
        <tr>
          <td id="L6877" data-line-number="6877"></td>
          <td id="LC6877">    Case Is &gt; lMax</td>
        </tr>
        <tr>
          <td id="L6878" data-line-number="6878"></td>
          <td id="LC6878">        Clamp = lMax</td>
        </tr>
        <tr>
          <td id="L6879" data-line-number="6879"></td>
          <td id="LC6879">    End Select</td>
        </tr>
        <tr>
          <td id="L6880" data-line-number="6880"></td>
          <td id="LC6880">End Function</td>
        </tr>
        <tr>
          <td id="L6881" data-line-number="6881"></td>
          <td id="LC6881">
</td>
        </tr>
        <tr>
          <td id="L6882" data-line-number="6882"></td>
          <td id="LC6882">Private Property Get OsVersion() As UcsOsVersionEnum</td>
        </tr>
        <tr>
          <td id="L6883" data-line-number="6883"></td>
          <td id="LC6883">    Static lVersion     As Long</td>
        </tr>
        <tr>
          <td id="L6884" data-line-number="6884"></td>
          <td id="LC6884">    Dim aVer(0 To 69)   As Long</td>
        </tr>
        <tr>
          <td id="L6885" data-line-number="6885"></td>
          <td id="LC6885">    </td>
        </tr>
        <tr>
          <td id="L6886" data-line-number="6886"></td>
          <td id="LC6886">    If lVersion = 0 Then</td>
        </tr>
        <tr>
          <td id="L6887" data-line-number="6887"></td>
          <td id="LC6887">        aVer(0) = LenB(aVer(0)) * UBound(aVer)  &#39;--- [0] = dwOSVersionInfoSize</td>
        </tr>
        <tr>
          <td id="L6888" data-line-number="6888"></td>
          <td id="LC6888">        If GetVersionEx(aVer(0)) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6889" data-line-number="6889"></td>
          <td id="LC6889">            lVersion = aVer(1) * 100 + aVer(2)  &#39;--- [1] = dwMajorVersion, [2] = dwMinorVersion</td>
        </tr>
        <tr>
          <td id="L6890" data-line-number="6890"></td>
          <td id="LC6890">        End If</td>
        </tr>
        <tr>
          <td id="L6891" data-line-number="6891"></td>
          <td id="LC6891">    End If</td>
        </tr>
        <tr>
          <td id="L6892" data-line-number="6892"></td>
          <td id="LC6892">    OsVersion = lVersion</td>
        </tr>
        <tr>
          <td id="L6893" data-line-number="6893"></td>
          <td id="LC6893">End Property</td>
        </tr>
        <tr>
          <td id="L6894" data-line-number="6894"></td>
          <td id="LC6894">#End If &#39; Not ImplUseShared</td>
        </tr>
        <tr>
          <td id="L6895" data-line-number="6895"></td>
          <td id="LC6895">
</td>
        </tr>
        <tr>
          <td id="L6896" data-line-number="6896"></td>
          <td id="LC6896">#If (ImplCaptureTraffic And 1) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6897" data-line-number="6897"></td>
          <td id="LC6897">Public Function TlsDesignDumpArray(baData() As Byte, Optional ByVal Pos As Long, Optional ByVal Size As Long = -1) As String</td>
        </tr>
        <tr>
          <td id="L6898" data-line-number="6898"></td>
          <td id="LC6898">    If Size &lt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6899" data-line-number="6899"></td>
          <td id="LC6899">        Size = UBound(baData) + 1 - Pos</td>
        </tr>
        <tr>
          <td id="L6900" data-line-number="6900"></td>
          <td id="LC6900">    End If</td>
        </tr>
        <tr>
          <td id="L6901" data-line-number="6901"></td>
          <td id="LC6901">    If Size &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6902" data-line-number="6902"></td>
          <td id="LC6902">        TlsDesignDumpArray = TlsDesignDumpMemory(VarPtr(baData(Pos)), Size)</td>
        </tr>
        <tr>
          <td id="L6903" data-line-number="6903"></td>
          <td id="LC6903">    End If</td>
        </tr>
        <tr>
          <td id="L6904" data-line-number="6904"></td>
          <td id="LC6904">End Function</td>
        </tr>
        <tr>
          <td id="L6905" data-line-number="6905"></td>
          <td id="LC6905">
</td>
        </tr>
        <tr>
          <td id="L6906" data-line-number="6906"></td>
          <td id="LC6906">Public Function TlsDesignDumpMemory(ByVal lPtr As Long, ByVal lSize As Long) As String</td>
        </tr>
        <tr>
          <td id="L6907" data-line-number="6907"></td>
          <td id="LC6907">    Dim lIdx            As Long</td>
        </tr>
        <tr>
          <td id="L6908" data-line-number="6908"></td>
          <td id="LC6908">    Dim sHex            As String</td>
        </tr>
        <tr>
          <td id="L6909" data-line-number="6909"></td>
          <td id="LC6909">    Dim sChar           As String</td>
        </tr>
        <tr>
          <td id="L6910" data-line-number="6910"></td>
          <td id="LC6910">    Dim lValue          As Long</td>
        </tr>
        <tr>
          <td id="L6911" data-line-number="6911"></td>
          <td id="LC6911">    Dim aResult()       As String</td>
        </tr>
        <tr>
          <td id="L6912" data-line-number="6912"></td>
          <td id="LC6912">    </td>
        </tr>
        <tr>
          <td id="L6913" data-line-number="6913"></td>
          <td id="LC6913">    ReDim aResult(0 To (lSize + 15) \ 16) As String</td>
        </tr>
        <tr>
          <td id="L6914" data-line-number="6914"></td>
          <td id="LC6914">    Debug.Assert RedimStats(&#34;TlsDesignDumpMemory.aResult&#34;, UBound(aResult) + 1)</td>
        </tr>
        <tr>
          <td id="L6915" data-line-number="6915"></td>
          <td id="LC6915">    For lIdx = 0 To ((lSize + 15) \ 16) * 16</td>
        </tr>
        <tr>
          <td id="L6916" data-line-number="6916"></td>
          <td id="LC6916">        If lIdx &lt; lSize Then</td>
        </tr>
        <tr>
          <td id="L6917" data-line-number="6917"></td>
          <td id="LC6917">            If IsBadReadPtr(lPtr, 1) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6918" data-line-number="6918"></td>
          <td id="LC6918">                Call CopyMemory(lValue, ByVal lPtr, 1)</td>
        </tr>
        <tr>
          <td id="L6919" data-line-number="6919"></td>
          <td id="LC6919">                sHex = sHex &amp; Right$(&#34;0&#34; &amp; Hex$(lValue), 2) &amp; &#34; &#34;</td>
        </tr>
        <tr>
          <td id="L6920" data-line-number="6920"></td>
          <td id="LC6920">                If lValue &gt;= 32 Then</td>
        </tr>
        <tr>
          <td id="L6921" data-line-number="6921"></td>
          <td id="LC6921">                    sChar = sChar &amp; Chr$(lValue)</td>
        </tr>
        <tr>
          <td id="L6922" data-line-number="6922"></td>
          <td id="LC6922">                Else</td>
        </tr>
        <tr>
          <td id="L6923" data-line-number="6923"></td>
          <td id="LC6923">                    sChar = sChar &amp; &#34;.&#34;</td>
        </tr>
        <tr>
          <td id="L6924" data-line-number="6924"></td>
          <td id="LC6924">                End If</td>
        </tr>
        <tr>
          <td id="L6925" data-line-number="6925"></td>
          <td id="LC6925">            Else</td>
        </tr>
        <tr>
          <td id="L6926" data-line-number="6926"></td>
          <td id="LC6926">                sHex = sHex &amp; &#34;?? &#34;</td>
        </tr>
        <tr>
          <td id="L6927" data-line-number="6927"></td>
          <td id="LC6927">                sChar = sChar &amp; &#34;.&#34;</td>
        </tr>
        <tr>
          <td id="L6928" data-line-number="6928"></td>
          <td id="LC6928">            End If</td>
        </tr>
        <tr>
          <td id="L6929" data-line-number="6929"></td>
          <td id="LC6929">        Else</td>
        </tr>
        <tr>
          <td id="L6930" data-line-number="6930"></td>
          <td id="LC6930">            sHex = sHex &amp; &#34;   &#34;</td>
        </tr>
        <tr>
          <td id="L6931" data-line-number="6931"></td>
          <td id="LC6931">        End If</td>
        </tr>
        <tr>
          <td id="L6932" data-line-number="6932"></td>
          <td id="LC6932">        If ((lIdx + 1) Mod 4) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6933" data-line-number="6933"></td>
          <td id="LC6933">            sHex = sHex &amp; &#34; &#34;</td>
        </tr>
        <tr>
          <td id="L6934" data-line-number="6934"></td>
          <td id="LC6934">        End If</td>
        </tr>
        <tr>
          <td id="L6935" data-line-number="6935"></td>
          <td id="LC6935">        If ((lIdx + 1) Mod 16) = 0 Then</td>
        </tr>
        <tr>
          <td id="L6936" data-line-number="6936"></td>
          <td id="LC6936">            aResult(lIdx \ 16) = Right$(&#34;000&#34; &amp; Hex$(lIdx - 15), 4) &amp; &#34; - &#34; &amp; sHex &amp; sChar</td>
        </tr>
        <tr>
          <td id="L6937" data-line-number="6937"></td>
          <td id="LC6937">            sHex = vbNullString</td>
        </tr>
        <tr>
          <td id="L6938" data-line-number="6938"></td>
          <td id="LC6938">            sChar = vbNullString</td>
        </tr>
        <tr>
          <td id="L6939" data-line-number="6939"></td>
          <td id="LC6939">        End If</td>
        </tr>
        <tr>
          <td id="L6940" data-line-number="6940"></td>
          <td id="LC6940">        lPtr = (lPtr Xor &amp;H80000000) + 1 Xor &amp;H80000000</td>
        </tr>
        <tr>
          <td id="L6941" data-line-number="6941"></td>
          <td id="LC6941">    Next</td>
        </tr>
        <tr>
          <td id="L6942" data-line-number="6942"></td>
          <td id="LC6942">    TlsDesignDumpMemory = Join(aResult, vbCrLf)</td>
        </tr>
        <tr>
          <td id="L6943" data-line-number="6943"></td>
          <td id="LC6943">End Function</td>
        </tr>
        <tr>
          <td id="L6944" data-line-number="6944"></td>
          <td id="LC6944">
</td>
        </tr>
        <tr>
          <td id="L6945" data-line-number="6945"></td>
          <td id="LC6945">Public Function TlsConcatCollection(oCol As Collection, Optional Separator As String = vbCrLf) As String</td>
        </tr>
        <tr>
          <td id="L6946" data-line-number="6946"></td>
          <td id="LC6946">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L6947" data-line-number="6947"></td>
          <td id="LC6947">    Dim vElem           As Variant</td>
        </tr>
        <tr>
          <td id="L6948" data-line-number="6948"></td>
          <td id="LC6948">    </td>
        </tr>
        <tr>
          <td id="L6949" data-line-number="6949"></td>
          <td id="LC6949">    For Each vElem In oCol</td>
        </tr>
        <tr>
          <td id="L6950" data-line-number="6950"></td>
          <td id="LC6950">        lSize = lSize + Len(vElem) + Len(Separator)</td>
        </tr>
        <tr>
          <td id="L6951" data-line-number="6951"></td>
          <td id="LC6951">    Next</td>
        </tr>
        <tr>
          <td id="L6952" data-line-number="6952"></td>
          <td id="LC6952">    If lSize &gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L6953" data-line-number="6953"></td>
          <td id="LC6953">        TlsConcatCollection = String$(lSize - Len(Separator), 0)</td>
        </tr>
        <tr>
          <td id="L6954" data-line-number="6954"></td>
          <td id="LC6954">        lSize = 1</td>
        </tr>
        <tr>
          <td id="L6955" data-line-number="6955"></td>
          <td id="LC6955">        For Each vElem In oCol</td>
        </tr>
        <tr>
          <td id="L6956" data-line-number="6956"></td>
          <td id="LC6956">            If lSize &lt;= Len(TlsConcatCollection) Then</td>
        </tr>
        <tr>
          <td id="L6957" data-line-number="6957"></td>
          <td id="LC6957">                Mid$(TlsConcatCollection, lSize, Len(vElem) + Len(Separator)) = vElem &amp; Separator</td>
        </tr>
        <tr>
          <td id="L6958" data-line-number="6958"></td>
          <td id="LC6958">            End If</td>
        </tr>
        <tr>
          <td id="L6959" data-line-number="6959"></td>
          <td id="LC6959">            lSize = lSize + Len(vElem) + Len(Separator)</td>
        </tr>
        <tr>
          <td id="L6960" data-line-number="6960"></td>
          <td id="LC6960">        Next</td>
        </tr>
        <tr>
          <td id="L6961" data-line-number="6961"></td>
          <td id="LC6961">    End If</td>
        </tr>
        <tr>
          <td id="L6962" data-line-number="6962"></td>
          <td id="LC6962">End Function</td>
        </tr>
        <tr>
          <td id="L6963" data-line-number="6963"></td>
          <td id="LC6963">#End If &#39; ImplCaptureTraffic</td>
        </tr>
        <tr>
          <td id="L6964" data-line-number="6964"></td>
          <td id="LC6964">
</td>
        </tr>
        <tr>
          <td id="L6965" data-line-number="6965"></td>
          <td id="LC6965">#If ImplTestCrypto Then</td>
        </tr>
        <tr>
          <td id="L6966" data-line-number="6966"></td>
          <td id="LC6966">
</td>
        </tr>
        <tr>
          <td id="L6967" data-line-number="6967"></td>
          <td id="LC6967">Public Sub TestCryptoAesGcm(oJson As Object)</td>
        </tr>
        <tr>
          <td id="L6968" data-line-number="6968"></td>
          <td id="LC6968">    Const FUNC_NAME     As String = &#34;TlsTestCryptoAesGcm&#34;</td>
        </tr>
        <tr>
          <td id="L6969" data-line-number="6969"></td>
          <td id="LC6969">    Dim oGroup          As Object</td>
        </tr>
        <tr>
          <td id="L6970" data-line-number="6970"></td>
          <td id="LC6970">    Dim oTest           As Object</td>
        </tr>
        <tr>
          <td id="L6971" data-line-number="6971"></td>
          <td id="LC6971">    Dim sComment        As String</td>
        </tr>
        <tr>
          <td id="L6972" data-line-number="6972"></td>
          <td id="LC6972">    Dim sResult         As String</td>
        </tr>
        <tr>
          <td id="L6973" data-line-number="6973"></td>
          <td id="LC6973">    Dim lPassed         As Long</td>
        </tr>
        <tr>
          <td id="L6974" data-line-number="6974"></td>
          <td id="LC6974">    Dim lFailed         As Long</td>
        </tr>
        <tr>
          <td id="L6975" data-line-number="6975"></td>
          <td id="LC6975">    Dim lSkipped        As Long</td>
        </tr>
        <tr>
          <td id="L6976" data-line-number="6976"></td>
          <td id="LC6976">    &#39;--- local</td>
        </tr>
        <tr>
          <td id="L6977" data-line-number="6977"></td>
          <td id="LC6977">    Dim baNonce()       As Byte</td>
        </tr>
        <tr>
          <td id="L6978" data-line-number="6978"></td>
          <td id="LC6978">    Dim baKey()         As Byte</td>
        </tr>
        <tr>
          <td id="L6979" data-line-number="6979"></td>
          <td id="LC6979">    Dim baAad()         As Byte</td>
        </tr>
        <tr>
          <td id="L6980" data-line-number="6980"></td>
          <td id="LC6980">    Dim baMsg()         As Byte</td>
        </tr>
        <tr>
          <td id="L6981" data-line-number="6981"></td>
          <td id="LC6981">    Dim baCt()          As Byte</td>
        </tr>
        <tr>
          <td id="L6982" data-line-number="6982"></td>
          <td id="LC6982">    Dim baTag()         As Byte</td>
        </tr>
        <tr>
          <td id="L6983" data-line-number="6983"></td>
          <td id="LC6983">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L6984" data-line-number="6984"></td>
          <td id="LC6984">    </td>
        </tr>
        <tr>
          <td id="L6985" data-line-number="6985"></td>
          <td id="LC6985">    pvCryptoInit</td>
        </tr>
        <tr>
          <td id="L6986" data-line-number="6986"></td>
          <td id="LC6986">    For Each oGroup In JsonValue(oJson, &#34;testGroups&#34;)</td>
        </tr>
        <tr>
          <td id="L6987" data-line-number="6987"></td>
          <td id="LC6987">        For Each oTest In JsonValue(oGroup, &#34;tests&#34;)</td>
        </tr>
        <tr>
          <td id="L6988" data-line-number="6988"></td>
          <td id="LC6988">            baNonce = FromHex(JsonValue(oTest, &#34;iv&#34;))</td>
        </tr>
        <tr>
          <td id="L6989" data-line-number="6989"></td>
          <td id="LC6989">            If pvArraySize(baNonce) = LNG_AESGCM_IVSZ Then</td>
        </tr>
        <tr>
          <td id="L6990" data-line-number="6990"></td>
          <td id="LC6990">                baKey = FromHex(JsonValue(oTest, &#34;key&#34;))</td>
        </tr>
        <tr>
          <td id="L6991" data-line-number="6991"></td>
          <td id="LC6991">                If pvArraySize(baKey) = LNG_AES128_KEYSZ Or pvArraySize(baKey) = LNG_AES256_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L6992" data-line-number="6992"></td>
          <td id="LC6992">                    baAad = FromHex(JsonValue(oTest, &#34;aad&#34;))</td>
        </tr>
        <tr>
          <td id="L6993" data-line-number="6993"></td>
          <td id="LC6993">                    baMsg = FromHex(JsonValue(oTest, &#34;msg&#34;))</td>
        </tr>
        <tr>
          <td id="L6994" data-line-number="6994"></td>
          <td id="LC6994">                    baCt = FromHex(JsonValue(oTest, &#34;ct&#34;))</td>
        </tr>
        <tr>
          <td id="L6995" data-line-number="6995"></td>
          <td id="LC6995">                    baTag = FromHex(JsonValue(oTest, &#34;tag&#34;))</td>
        </tr>
        <tr>
          <td id="L6996" data-line-number="6996"></td>
          <td id="LC6996">                    baBuffer = baMsg</td>
        </tr>
        <tr>
          <td id="L6997" data-line-number="6997"></td>
          <td id="LC6997">                    ReDim Preserve baBuffer(0 To UBound(baMsg) + UBound(baTag) + 1) As Byte</td>
        </tr>
        <tr>
          <td id="L6998" data-line-number="6998"></td>
          <td id="LC6998">                    sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L6999" data-line-number="6999"></td>
          <td id="LC6999">                    If Not pvCryptoBulkAesGcmEncrypt(baNonce, baKey, baAad, 0, UBound(baAad) + 1, baBuffer, 0, UBound(baMsg) + 1) Then</td>
        </tr>
        <tr>
          <td id="L7000" data-line-number="7000"></td>
          <td id="LC7000">                        sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7001" data-line-number="7001"></td>
          <td id="LC7001">                    Else</td>
        </tr>
        <tr>
          <td id="L7002" data-line-number="7002"></td>
          <td id="LC7002">                        pvArrayWriteBlob baCt, UBound(baCt) + 1, VarPtr(baTag(0)), UBound(baTag) + 1</td>
        </tr>
        <tr>
          <td id="L7003" data-line-number="7003"></td>
          <td id="LC7003">                        If Not pvArrayEqual(baBuffer, baCt) Then</td>
        </tr>
        <tr>
          <td id="L7004" data-line-number="7004"></td>
          <td id="LC7004">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7005" data-line-number="7005"></td>
          <td id="LC7005">                        End If</td>
        </tr>
        <tr>
          <td id="L7006" data-line-number="7006"></td>
          <td id="LC7006">                    End If</td>
        </tr>
        <tr>
          <td id="L7007" data-line-number="7007"></td>
          <td id="LC7007">                    If JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7008" data-line-number="7008"></td>
          <td id="LC7008">                        lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7009" data-line-number="7009"></td>
          <td id="LC7009">                    Else</td>
        </tr>
        <tr>
          <td id="L7010" data-line-number="7010"></td>
          <td id="LC7010">                        lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7011" data-line-number="7011"></td>
          <td id="LC7011">                        sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7012" data-line-number="7012"></td>
          <td id="LC7012">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString)</td>
        </tr>
        <tr>
          <td id="L7013" data-line-number="7013"></td>
          <td id="LC7013">                    End If</td>
        </tr>
        <tr>
          <td id="L7014" data-line-number="7014"></td>
          <td id="LC7014">                Else</td>
        </tr>
        <tr>
          <td id="L7015" data-line-number="7015"></td>
          <td id="LC7015">                    lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7016" data-line-number="7016"></td>
          <td id="LC7016">                End If</td>
        </tr>
        <tr>
          <td id="L7017" data-line-number="7017"></td>
          <td id="LC7017">            Else</td>
        </tr>
        <tr>
          <td id="L7018" data-line-number="7018"></td>
          <td id="LC7018">                lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7019" data-line-number="7019"></td>
          <td id="LC7019">            End If</td>
        </tr>
        <tr>
          <td id="L7020" data-line-number="7020"></td>
          <td id="LC7020">        Next</td>
        </tr>
        <tr>
          <td id="L7021" data-line-number="7021"></td>
          <td id="LC7021">    Next</td>
        </tr>
        <tr>
          <td id="L7022" data-line-number="7022"></td>
          <td id="LC7022">    DebugLog MODULE_NAME, FUNC_NAME, &#34;[+] Passed=&#34; &amp; lPassed &amp; &#34;, Failed=&#34; &amp; lFailed &amp; &#34;, Skipped=&#34; &amp; lSkipped</td>
        </tr>
        <tr>
          <td id="L7023" data-line-number="7023"></td>
          <td id="LC7023">End Sub</td>
        </tr>
        <tr>
          <td id="L7024" data-line-number="7024"></td>
          <td id="LC7024">
</td>
        </tr>
        <tr>
          <td id="L7025" data-line-number="7025"></td>
          <td id="LC7025">Public Sub TestCryptoAesCbc(oJson As Object)</td>
        </tr>
        <tr>
          <td id="L7026" data-line-number="7026"></td>
          <td id="LC7026">    Const FUNC_NAME     As String = &#34;TlsTestCryptoAesCbc&#34;</td>
        </tr>
        <tr>
          <td id="L7027" data-line-number="7027"></td>
          <td id="LC7027">    Dim oGroup          As Object</td>
        </tr>
        <tr>
          <td id="L7028" data-line-number="7028"></td>
          <td id="LC7028">    Dim oTest           As Object</td>
        </tr>
        <tr>
          <td id="L7029" data-line-number="7029"></td>
          <td id="LC7029">    Dim sComment        As String</td>
        </tr>
        <tr>
          <td id="L7030" data-line-number="7030"></td>
          <td id="LC7030">    Dim sResult         As String</td>
        </tr>
        <tr>
          <td id="L7031" data-line-number="7031"></td>
          <td id="LC7031">    Dim lPassed         As Long</td>
        </tr>
        <tr>
          <td id="L7032" data-line-number="7032"></td>
          <td id="LC7032">    Dim lFailed         As Long</td>
        </tr>
        <tr>
          <td id="L7033" data-line-number="7033"></td>
          <td id="LC7033">    Dim lSkipped        As Long</td>
        </tr>
        <tr>
          <td id="L7034" data-line-number="7034"></td>
          <td id="LC7034">    &#39;--- local</td>
        </tr>
        <tr>
          <td id="L7035" data-line-number="7035"></td>
          <td id="LC7035">    Dim baNonce()       As Byte</td>
        </tr>
        <tr>
          <td id="L7036" data-line-number="7036"></td>
          <td id="LC7036">    Dim baKey()         As Byte</td>
        </tr>
        <tr>
          <td id="L7037" data-line-number="7037"></td>
          <td id="LC7037">    Dim baMsg()         As Byte</td>
        </tr>
        <tr>
          <td id="L7038" data-line-number="7038"></td>
          <td id="LC7038">    Dim baCt()          As Byte</td>
        </tr>
        <tr>
          <td id="L7039" data-line-number="7039"></td>
          <td id="LC7039">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L7040" data-line-number="7040"></td>
          <td id="LC7040">    Dim lPadding        As Long</td>
        </tr>
        <tr>
          <td id="L7041" data-line-number="7041"></td>
          <td id="LC7041">    Dim baHmac(0 To 15) As Byte</td>
        </tr>
        <tr>
          <td id="L7042" data-line-number="7042"></td>
          <td id="LC7042">    </td>
        </tr>
        <tr>
          <td id="L7043" data-line-number="7043"></td>
          <td id="LC7043">    pvCryptoInit</td>
        </tr>
        <tr>
          <td id="L7044" data-line-number="7044"></td>
          <td id="LC7044">    For Each oGroup In JsonValue(oJson, &#34;testGroups&#34;)</td>
        </tr>
        <tr>
          <td id="L7045" data-line-number="7045"></td>
          <td id="LC7045">        For Each oTest In JsonValue(oGroup, &#34;tests&#34;)</td>
        </tr>
        <tr>
          <td id="L7046" data-line-number="7046"></td>
          <td id="LC7046">            baNonce = FromHex(JsonValue(oTest, &#34;iv&#34;))</td>
        </tr>
        <tr>
          <td id="L7047" data-line-number="7047"></td>
          <td id="LC7047">            If pvArraySize(baNonce) = LNG_AESCBC_IVSZ Then</td>
        </tr>
        <tr>
          <td id="L7048" data-line-number="7048"></td>
          <td id="LC7048">                baKey = FromHex(JsonValue(oTest, &#34;key&#34;))</td>
        </tr>
        <tr>
          <td id="L7049" data-line-number="7049"></td>
          <td id="LC7049">                If pvArraySize(baKey) = LNG_AES128_KEYSZ Or pvArraySize(baKey) = LNG_AES256_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L7050" data-line-number="7050"></td>
          <td id="LC7050">                    baMsg = FromHex(JsonValue(oTest, &#34;msg&#34;))</td>
        </tr>
        <tr>
          <td id="L7051" data-line-number="7051"></td>
          <td id="LC7051">                    baCt = FromHex(JsonValue(oTest, &#34;ct&#34;))</td>
        </tr>
        <tr>
          <td id="L7052" data-line-number="7052"></td>
          <td id="LC7052">                    baBuffer = baMsg</td>
        </tr>
        <tr>
          <td id="L7053" data-line-number="7053"></td>
          <td id="LC7053">                    &#39;--- PKCS5 padding (note: different than padding for TLS in pvBufferWriteRecordEnd)</td>
        </tr>
        <tr>
          <td id="L7054" data-line-number="7054"></td>
          <td id="LC7054">                    lPadding = LNG_AESCBC_IVSZ - pvArraySize(baMsg) Mod LNG_AESCBC_IVSZ</td>
        </tr>
        <tr>
          <td id="L7055" data-line-number="7055"></td>
          <td id="LC7055">                    Debug.Assert lPadding &lt;= pvArraySize(baHmac)</td>
        </tr>
        <tr>
          <td id="L7056" data-line-number="7056"></td>
          <td id="LC7056">                    Call FillMemory(baHmac(0), lPadding, lPadding)</td>
        </tr>
        <tr>
          <td id="L7057" data-line-number="7057"></td>
          <td id="LC7057">                    pvArrayWriteBlob baBuffer, UBound(baBuffer) + 1, VarPtr(baHmac(0)), lPadding</td>
        </tr>
        <tr>
          <td id="L7058" data-line-number="7058"></td>
          <td id="LC7058">                    sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L7059" data-line-number="7059"></td>
          <td id="LC7059">                    If Not pvCryptoBulkAesCbcEncrypt(baNonce, baKey, baBuffer, 0, UBound(baBuffer) + 1) Then</td>
        </tr>
        <tr>
          <td id="L7060" data-line-number="7060"></td>
          <td id="LC7060">                        sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7061" data-line-number="7061"></td>
          <td id="LC7061">                    ElseIf Not pvArrayEqual(baBuffer, baCt) Then</td>
        </tr>
        <tr>
          <td id="L7062" data-line-number="7062"></td>
          <td id="LC7062">                        sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7063" data-line-number="7063"></td>
          <td id="LC7063">                    End If</td>
        </tr>
        <tr>
          <td id="L7064" data-line-number="7064"></td>
          <td id="LC7064">                    If JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7065" data-line-number="7065"></td>
          <td id="LC7065">                        lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7066" data-line-number="7066"></td>
          <td id="LC7066">                    Else</td>
        </tr>
        <tr>
          <td id="L7067" data-line-number="7067"></td>
          <td id="LC7067">                        lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7068" data-line-number="7068"></td>
          <td id="LC7068">                        sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7069" data-line-number="7069"></td>
          <td id="LC7069">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString)</td>
        </tr>
        <tr>
          <td id="L7070" data-line-number="7070"></td>
          <td id="LC7070">                    End If</td>
        </tr>
        <tr>
          <td id="L7071" data-line-number="7071"></td>
          <td id="LC7071">                Else</td>
        </tr>
        <tr>
          <td id="L7072" data-line-number="7072"></td>
          <td id="LC7072">                    lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7073" data-line-number="7073"></td>
          <td id="LC7073">                End If</td>
        </tr>
        <tr>
          <td id="L7074" data-line-number="7074"></td>
          <td id="LC7074">            Else</td>
        </tr>
        <tr>
          <td id="L7075" data-line-number="7075"></td>
          <td id="LC7075">                lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7076" data-line-number="7076"></td>
          <td id="LC7076">            End If</td>
        </tr>
        <tr>
          <td id="L7077" data-line-number="7077"></td>
          <td id="LC7077">        Next</td>
        </tr>
        <tr>
          <td id="L7078" data-line-number="7078"></td>
          <td id="LC7078">    Next</td>
        </tr>
        <tr>
          <td id="L7079" data-line-number="7079"></td>
          <td id="LC7079">    DebugLog MODULE_NAME, FUNC_NAME, &#34;[+] Passed=&#34; &amp; lPassed &amp; &#34;, Failed=&#34; &amp; lFailed &amp; &#34;, Skipped=&#34; &amp; lSkipped</td>
        </tr>
        <tr>
          <td id="L7080" data-line-number="7080"></td>
          <td id="LC7080">End Sub</td>
        </tr>
        <tr>
          <td id="L7081" data-line-number="7081"></td>
          <td id="LC7081">
</td>
        </tr>
        <tr>
          <td id="L7082" data-line-number="7082"></td>
          <td id="LC7082">Public Sub TestCryptoChacha20(oJson As Object)</td>
        </tr>
        <tr>
          <td id="L7083" data-line-number="7083"></td>
          <td id="LC7083">    Const FUNC_NAME     As String = &#34;TlsTestCryptoChacha20&#34;</td>
        </tr>
        <tr>
          <td id="L7084" data-line-number="7084"></td>
          <td id="LC7084">    Dim oGroup          As Object</td>
        </tr>
        <tr>
          <td id="L7085" data-line-number="7085"></td>
          <td id="LC7085">    Dim oTest           As Object</td>
        </tr>
        <tr>
          <td id="L7086" data-line-number="7086"></td>
          <td id="LC7086">    Dim sComment        As String</td>
        </tr>
        <tr>
          <td id="L7087" data-line-number="7087"></td>
          <td id="LC7087">    Dim sResult         As String</td>
        </tr>
        <tr>
          <td id="L7088" data-line-number="7088"></td>
          <td id="LC7088">    Dim lPassed         As Long</td>
        </tr>
        <tr>
          <td id="L7089" data-line-number="7089"></td>
          <td id="LC7089">    Dim lFailed         As Long</td>
        </tr>
        <tr>
          <td id="L7090" data-line-number="7090"></td>
          <td id="LC7090">    Dim lSkipped        As Long</td>
        </tr>
        <tr>
          <td id="L7091" data-line-number="7091"></td>
          <td id="LC7091">    &#39;--- local</td>
        </tr>
        <tr>
          <td id="L7092" data-line-number="7092"></td>
          <td id="LC7092">    Dim baNonce()       As Byte</td>
        </tr>
        <tr>
          <td id="L7093" data-line-number="7093"></td>
          <td id="LC7093">    Dim baKey()         As Byte</td>
        </tr>
        <tr>
          <td id="L7094" data-line-number="7094"></td>
          <td id="LC7094">    Dim baAad()         As Byte</td>
        </tr>
        <tr>
          <td id="L7095" data-line-number="7095"></td>
          <td id="LC7095">    Dim baMsg()         As Byte</td>
        </tr>
        <tr>
          <td id="L7096" data-line-number="7096"></td>
          <td id="LC7096">    Dim baCt()          As Byte</td>
        </tr>
        <tr>
          <td id="L7097" data-line-number="7097"></td>
          <td id="LC7097">    Dim baTag()         As Byte</td>
        </tr>
        <tr>
          <td id="L7098" data-line-number="7098"></td>
          <td id="LC7098">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L7099" data-line-number="7099"></td>
          <td id="LC7099">    </td>
        </tr>
        <tr>
          <td id="L7100" data-line-number="7100"></td>
          <td id="LC7100">    pvCryptoInit</td>
        </tr>
        <tr>
          <td id="L7101" data-line-number="7101"></td>
          <td id="LC7101">    For Each oGroup In JsonValue(oJson, &#34;testGroups&#34;)</td>
        </tr>
        <tr>
          <td id="L7102" data-line-number="7102"></td>
          <td id="LC7102">        For Each oTest In JsonValue(oGroup, &#34;tests&#34;)</td>
        </tr>
        <tr>
          <td id="L7103" data-line-number="7103"></td>
          <td id="LC7103">            baNonce = FromHex(JsonValue(oTest, &#34;iv&#34;))</td>
        </tr>
        <tr>
          <td id="L7104" data-line-number="7104"></td>
          <td id="LC7104">            If pvArraySize(baNonce) = LNG_CHACHA20POLY1305_IVSZ Then</td>
        </tr>
        <tr>
          <td id="L7105" data-line-number="7105"></td>
          <td id="LC7105">                baKey = FromHex(JsonValue(oTest, &#34;key&#34;))</td>
        </tr>
        <tr>
          <td id="L7106" data-line-number="7106"></td>
          <td id="LC7106">                If pvArraySize(baKey) = LNG_CHACHA20_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L7107" data-line-number="7107"></td>
          <td id="LC7107">                    baAad = FromHex(JsonValue(oTest, &#34;aad&#34;))</td>
        </tr>
        <tr>
          <td id="L7108" data-line-number="7108"></td>
          <td id="LC7108">                    baMsg = FromHex(JsonValue(oTest, &#34;msg&#34;))</td>
        </tr>
        <tr>
          <td id="L7109" data-line-number="7109"></td>
          <td id="LC7109">                    baCt = FromHex(JsonValue(oTest, &#34;ct&#34;))</td>
        </tr>
        <tr>
          <td id="L7110" data-line-number="7110"></td>
          <td id="LC7110">                    baTag = FromHex(JsonValue(oTest, &#34;tag&#34;))</td>
        </tr>
        <tr>
          <td id="L7111" data-line-number="7111"></td>
          <td id="LC7111">                    baBuffer = baMsg</td>
        </tr>
        <tr>
          <td id="L7112" data-line-number="7112"></td>
          <td id="LC7112">                    ReDim Preserve baBuffer(0 To UBound(baMsg) + UBound(baTag) + 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7113" data-line-number="7113"></td>
          <td id="LC7113">                    sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L7114" data-line-number="7114"></td>
          <td id="LC7114">                    If Not pvCryptoBulkChacha20Poly1305Encrypt(baNonce, baKey, baAad, 0, UBound(baAad) + 1, baBuffer, 0, UBound(baMsg) + 1) Then</td>
        </tr>
        <tr>
          <td id="L7115" data-line-number="7115"></td>
          <td id="LC7115">                        sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7116" data-line-number="7116"></td>
          <td id="LC7116">                    Else</td>
        </tr>
        <tr>
          <td id="L7117" data-line-number="7117"></td>
          <td id="LC7117">                        pvArrayWriteBlob baCt, UBound(baCt) + 1, VarPtr(baTag(0)), UBound(baTag) + 1</td>
        </tr>
        <tr>
          <td id="L7118" data-line-number="7118"></td>
          <td id="LC7118">                        If Not pvArrayEqual(baBuffer, baCt) Then</td>
        </tr>
        <tr>
          <td id="L7119" data-line-number="7119"></td>
          <td id="LC7119">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7120" data-line-number="7120"></td>
          <td id="LC7120">                        End If</td>
        </tr>
        <tr>
          <td id="L7121" data-line-number="7121"></td>
          <td id="LC7121">                    End If</td>
        </tr>
        <tr>
          <td id="L7122" data-line-number="7122"></td>
          <td id="LC7122">                    If JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7123" data-line-number="7123"></td>
          <td id="LC7123">                        lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7124" data-line-number="7124"></td>
          <td id="LC7124">                    Else</td>
        </tr>
        <tr>
          <td id="L7125" data-line-number="7125"></td>
          <td id="LC7125">                        lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7126" data-line-number="7126"></td>
          <td id="LC7126">                        sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7127" data-line-number="7127"></td>
          <td id="LC7127">                        DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString)</td>
        </tr>
        <tr>
          <td id="L7128" data-line-number="7128"></td>
          <td id="LC7128">                    End If</td>
        </tr>
        <tr>
          <td id="L7129" data-line-number="7129"></td>
          <td id="LC7129">                Else</td>
        </tr>
        <tr>
          <td id="L7130" data-line-number="7130"></td>
          <td id="LC7130">                    lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7131" data-line-number="7131"></td>
          <td id="LC7131">                End If</td>
        </tr>
        <tr>
          <td id="L7132" data-line-number="7132"></td>
          <td id="LC7132">            Else</td>
        </tr>
        <tr>
          <td id="L7133" data-line-number="7133"></td>
          <td id="LC7133">                lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7134" data-line-number="7134"></td>
          <td id="LC7134">            End If</td>
        </tr>
        <tr>
          <td id="L7135" data-line-number="7135"></td>
          <td id="LC7135">        Next</td>
        </tr>
        <tr>
          <td id="L7136" data-line-number="7136"></td>
          <td id="LC7136">    Next</td>
        </tr>
        <tr>
          <td id="L7137" data-line-number="7137"></td>
          <td id="LC7137">    DebugLog MODULE_NAME, FUNC_NAME, &#34;[+] Passed=&#34; &amp; lPassed &amp; &#34;, Failed=&#34; &amp; lFailed &amp; &#34;, Skipped=&#34; &amp; lSkipped</td>
        </tr>
        <tr>
          <td id="L7138" data-line-number="7138"></td>
          <td id="LC7138">End Sub</td>
        </tr>
        <tr>
          <td id="L7139" data-line-number="7139"></td>
          <td id="LC7139">
</td>
        </tr>
        <tr>
          <td id="L7140" data-line-number="7140"></td>
          <td id="LC7140">Public Sub TestCryptoEcdh(oJson As Object)</td>
        </tr>
        <tr>
          <td id="L7141" data-line-number="7141"></td>
          <td id="LC7141">    Const FUNC_NAME     As String = &#34;TestCryptoEcdh&#34;</td>
        </tr>
        <tr>
          <td id="L7142" data-line-number="7142"></td>
          <td id="LC7142">    Dim oGroup          As Object</td>
        </tr>
        <tr>
          <td id="L7143" data-line-number="7143"></td>
          <td id="LC7143">    Dim oTest           As Object</td>
        </tr>
        <tr>
          <td id="L7144" data-line-number="7144"></td>
          <td id="LC7144">    Dim sComment        As String</td>
        </tr>
        <tr>
          <td id="L7145" data-line-number="7145"></td>
          <td id="LC7145">    Dim sResult         As String</td>
        </tr>
        <tr>
          <td id="L7146" data-line-number="7146"></td>
          <td id="LC7146">    Dim lPassed         As Long</td>
        </tr>
        <tr>
          <td id="L7147" data-line-number="7147"></td>
          <td id="LC7147">    Dim lFailed         As Long</td>
        </tr>
        <tr>
          <td id="L7148" data-line-number="7148"></td>
          <td id="LC7148">    Dim lSkipped        As Long</td>
        </tr>
        <tr>
          <td id="L7149" data-line-number="7149"></td>
          <td id="LC7149">    &#39;--- local</td>
        </tr>
        <tr>
          <td id="L7150" data-line-number="7150"></td>
          <td id="LC7150">    Dim baPublic()      As Byte</td>
        </tr>
        <tr>
          <td id="L7151" data-line-number="7151"></td>
          <td id="LC7151">    Dim baPrivate()     As Byte</td>
        </tr>
        <tr>
          <td id="L7152" data-line-number="7152"></td>
          <td id="LC7152">    Dim baShared()      As Byte</td>
        </tr>
        <tr>
          <td id="L7153" data-line-number="7153"></td>
          <td id="LC7153">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L7154" data-line-number="7154"></td>
          <td id="LC7154">    Dim lPtr            As Long</td>
        </tr>
        <tr>
          <td id="L7155" data-line-number="7155"></td>
          <td id="LC7155">    Dim lSize           As Long</td>
        </tr>
        <tr>
          <td id="L7156" data-line-number="7156"></td>
          <td id="LC7156">    Dim uPublicKeyInfo  As CERT_PUBLIC_KEY_INFO</td>
        </tr>
        <tr>
          <td id="L7157" data-line-number="7157"></td>
          <td id="LC7157">    Dim sFlags          As String</td>
        </tr>
        <tr>
          <td id="L7158" data-line-number="7158"></td>
          <td id="LC7158">    Dim sCurve          As String</td>
        </tr>
        <tr>
          <td id="L7159" data-line-number="7159"></td>
          <td id="LC7159">
</td>
        </tr>
        <tr>
          <td id="L7160" data-line-number="7160"></td>
          <td id="LC7160">    pvCryptoInit</td>
        </tr>
        <tr>
          <td id="L7161" data-line-number="7161"></td>
          <td id="LC7161">    For Each oGroup In JsonValue(oJson, &#34;testGroups&#34;)</td>
        </tr>
        <tr>
          <td id="L7162" data-line-number="7162"></td>
          <td id="LC7162">        sCurve = JsonValue(oGroup, &#34;curve&#34;)</td>
        </tr>
        <tr>
          <td id="L7163" data-line-number="7163"></td>
          <td id="LC7163">        If sCurve = &#34;secp256r1&#34; Or sCurve = &#34;secp384r1&#34; Then</td>
        </tr>
        <tr>
          <td id="L7164" data-line-number="7164"></td>
          <td id="LC7164">            For Each oTest In JsonValue(oGroup, &#34;tests&#34;)</td>
        </tr>
        <tr>
          <td id="L7165" data-line-number="7165"></td>
          <td id="LC7165">                baPublic = FromHex(JsonValue(oTest, &#34;public&#34;))</td>
        </tr>
        <tr>
          <td id="L7166" data-line-number="7166"></td>
          <td id="LC7166">                baPrivate = FromHex(JsonValue(oTest, &#34;private&#34;))</td>
        </tr>
        <tr>
          <td id="L7167" data-line-number="7167"></td>
          <td id="LC7167">                baShared = FromHex(JsonValue(oTest, &#34;shared&#34;))</td>
        </tr>
        <tr>
          <td id="L7168" data-line-number="7168"></td>
          <td id="LC7168">                sFlags = Join(JsonValue(oTest, &#34;flags/*&#34;), &#34;, &#34;)</td>
        </tr>
        <tr>
          <td id="L7169" data-line-number="7169"></td>
          <td id="LC7169">                If InStr(sFlags, &#34;InvalidAsn&#34;) = 0 Then</td>
        </tr>
        <tr>
          <td id="L7170" data-line-number="7170"></td>
          <td id="LC7170">                    If UBound(baPublic) &gt;= 0 Then</td>
        </tr>
        <tr>
          <td id="L7171" data-line-number="7171"></td>
          <td id="LC7171">                        If CryptDecodeObjectEx(X509_ASN_ENCODING, X509_PUBLIC_KEY_INFO, baPublic(0), UBound(baPublic) + 1, CRYPT_DECODE_ALLOC_FLAG Or CRYPT_DECODE_NOCOPY_FLAG, 0, lPtr, lSize) &lt;&gt; 0 Then</td>
        </tr>
        <tr>
          <td id="L7172" data-line-number="7172"></td>
          <td id="LC7172">                            Call CopyMemory(uPublicKeyInfo, ByVal lPtr, LenB(uPublicKeyInfo))</td>
        </tr>
        <tr>
          <td id="L7173" data-line-number="7173"></td>
          <td id="LC7173">                            Debug.Assert pvToStringA(uPublicKeyInfo.Algorithm.pszObjId) = szOID_ECC_PUBLIC_KEY</td>
        </tr>
        <tr>
          <td id="L7174" data-line-number="7174"></td>
          <td id="LC7174">                            If uPublicKeyInfo.PublicKey.cbData = 0 Then</td>
        </tr>
        <tr>
          <td id="L7175" data-line-number="7175"></td>
          <td id="LC7175">                                baPublic = vbNullString</td>
        </tr>
        <tr>
          <td id="L7176" data-line-number="7176"></td>
          <td id="LC7176">                            Else</td>
        </tr>
        <tr>
          <td id="L7177" data-line-number="7177"></td>
          <td id="LC7177">                                ReDim baPublic(0 To uPublicKeyInfo.PublicKey.cbData - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7178" data-line-number="7178"></td>
          <td id="LC7178">                                Call CopyMemory(baPublic(0), ByVal uPublicKeyInfo.PublicKey.pbData, UBound(baPublic) + 1)</td>
        </tr>
        <tr>
          <td id="L7179" data-line-number="7179"></td>
          <td id="LC7179">                            End If</td>
        </tr>
        <tr>
          <td id="L7180" data-line-number="7180"></td>
          <td id="LC7180">                            Call LocalFree(lPtr)</td>
        </tr>
        <tr>
          <td id="L7181" data-line-number="7181"></td>
          <td id="LC7181">                        End If</td>
        </tr>
        <tr>
          <td id="L7182" data-line-number="7182"></td>
          <td id="LC7182">                    End If</td>
        </tr>
        <tr>
          <td id="L7183" data-line-number="7183"></td>
          <td id="LC7183">                    If UBound(baPrivate) &gt;= 0 Then</td>
        </tr>
        <tr>
          <td id="L7184" data-line-number="7184"></td>
          <td id="LC7184">                        If baPrivate(0) = 0 Then</td>
        </tr>
        <tr>
          <td id="L7185" data-line-number="7185"></td>
          <td id="LC7185">                            Call CopyMemory(baPrivate(0), baPrivate(1), UBound(baPrivate))</td>
        </tr>
        <tr>
          <td id="L7186" data-line-number="7186"></td>
          <td id="LC7186">                            ReDim Preserve baPrivate(0 To UBound(baPrivate) - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7187" data-line-number="7187"></td>
          <td id="LC7187">                        End If</td>
        </tr>
        <tr>
          <td id="L7188" data-line-number="7188"></td>
          <td id="LC7188">                    End If</td>
        </tr>
        <tr>
          <td id="L7189" data-line-number="7189"></td>
          <td id="LC7189">                    If sCurve = &#34;secp256r1&#34; And UBound(baPrivate) = LNG_SECP256R1_KEYSZ - 1 And UBound(baPublic) &gt;= LNG_SECP256R1_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L7190" data-line-number="7190"></td>
          <td id="LC7190">                        sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L7191" data-line-number="7191"></td>
          <td id="LC7191">                        If Not pvCryptoEcdhSecp256r1SharedSecret(baBuffer, baPrivate, baPublic) Then</td>
        </tr>
        <tr>
          <td id="L7192" data-line-number="7192"></td>
          <td id="LC7192">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7193" data-line-number="7193"></td>
          <td id="LC7193">                        ElseIf Not pvArrayEqual(baBuffer, baShared) Then</td>
        </tr>
        <tr>
          <td id="L7194" data-line-number="7194"></td>
          <td id="LC7194">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7195" data-line-number="7195"></td>
          <td id="LC7195">                        End If</td>
        </tr>
        <tr>
          <td id="L7196" data-line-number="7196"></td>
          <td id="LC7196">                        If JsonValue(oTest, &#34;result&#34;) = &#34;acceptable&#34; And sResult = &#34;valid&#34; Then</td>
        </tr>
        <tr>
          <td id="L7197" data-line-number="7197"></td>
          <td id="LC7197">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7198" data-line-number="7198"></td>
          <td id="LC7198">                        ElseIf JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7199" data-line-number="7199"></td>
          <td id="LC7199">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7200" data-line-number="7200"></td>
          <td id="LC7200">                        Else</td>
        </tr>
        <tr>
          <td id="L7201" data-line-number="7201"></td>
          <td id="LC7201">                            lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7202" data-line-number="7202"></td>
          <td id="LC7202">                            sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7203" data-line-number="7203"></td>
          <td id="LC7203">                            DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; sCurve &amp; &#34;, &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString) &amp; _</td>
        </tr>
        <tr>
          <td id="L7204" data-line-number="7204"></td>
          <td id="LC7204">                                IIf(LenB(sFlags) &lt;&gt; 0, &#34;, &#34; &amp; sFlags, vbNullString) &amp; &#34;, sResult=&#34; &amp; sResult &amp; &#34; vs &#34; &amp; JsonValue(oTest, &#34;result&#34;)</td>
        </tr>
        <tr>
          <td id="L7205" data-line-number="7205"></td>
          <td id="LC7205">                        End If</td>
        </tr>
        <tr>
          <td id="L7206" data-line-number="7206"></td>
          <td id="LC7206">                    ElseIf sCurve = &#34;secp384r1&#34; And UBound(baPrivate) = LNG_SECP384R1_KEYSZ - 1 And UBound(baPublic) &gt;= LNG_SECP384R1_KEYSZ Then</td>
        </tr>
        <tr>
          <td id="L7207" data-line-number="7207"></td>
          <td id="LC7207">                        sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L7208" data-line-number="7208"></td>
          <td id="LC7208">                        If Not pvCryptoEcdhSecp384r1SharedSecret(baBuffer, baPrivate, baPublic) Then</td>
        </tr>
        <tr>
          <td id="L7209" data-line-number="7209"></td>
          <td id="LC7209">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7210" data-line-number="7210"></td>
          <td id="LC7210">                        ElseIf Not pvArrayEqual(baBuffer, baShared) Then</td>
        </tr>
        <tr>
          <td id="L7211" data-line-number="7211"></td>
          <td id="LC7211">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7212" data-line-number="7212"></td>
          <td id="LC7212">                        End If</td>
        </tr>
        <tr>
          <td id="L7213" data-line-number="7213"></td>
          <td id="LC7213">                        If JsonValue(oTest, &#34;result&#34;) = &#34;acceptable&#34; And sResult = &#34;valid&#34; Then</td>
        </tr>
        <tr>
          <td id="L7214" data-line-number="7214"></td>
          <td id="LC7214">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7215" data-line-number="7215"></td>
          <td id="LC7215">                        ElseIf JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7216" data-line-number="7216"></td>
          <td id="LC7216">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7217" data-line-number="7217"></td>
          <td id="LC7217">                        Else</td>
        </tr>
        <tr>
          <td id="L7218" data-line-number="7218"></td>
          <td id="LC7218">                            lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7219" data-line-number="7219"></td>
          <td id="LC7219">                            sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7220" data-line-number="7220"></td>
          <td id="LC7220">                            DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; sCurve &amp; &#34;, &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString) &amp; _</td>
        </tr>
        <tr>
          <td id="L7221" data-line-number="7221"></td>
          <td id="LC7221">                                IIf(LenB(sFlags) &lt;&gt; 0, &#34;, &#34; &amp; sFlags, vbNullString) &amp; &#34;, sResult=&#34; &amp; sResult &amp; &#34; vs &#34; &amp; JsonValue(oTest, &#34;result&#34;)</td>
        </tr>
        <tr>
          <td id="L7222" data-line-number="7222"></td>
          <td id="LC7222">                        End If</td>
        </tr>
        <tr>
          <td id="L7223" data-line-number="7223"></td>
          <td id="LC7223">                    Else</td>
        </tr>
        <tr>
          <td id="L7224" data-line-number="7224"></td>
          <td id="LC7224">                        lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7225" data-line-number="7225"></td>
          <td id="LC7225">                    End If</td>
        </tr>
        <tr>
          <td id="L7226" data-line-number="7226"></td>
          <td id="LC7226">                Else</td>
        </tr>
        <tr>
          <td id="L7227" data-line-number="7227"></td>
          <td id="LC7227">                    lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7228" data-line-number="7228"></td>
          <td id="LC7228">                End If</td>
        </tr>
        <tr>
          <td id="L7229" data-line-number="7229"></td>
          <td id="LC7229">            Next</td>
        </tr>
        <tr>
          <td id="L7230" data-line-number="7230"></td>
          <td id="LC7230">        End If</td>
        </tr>
        <tr>
          <td id="L7231" data-line-number="7231"></td>
          <td id="LC7231">    Next</td>
        </tr>
        <tr>
          <td id="L7232" data-line-number="7232"></td>
          <td id="LC7232">    DebugLog MODULE_NAME, FUNC_NAME, &#34;[+] Passed=&#34; &amp; lPassed &amp; &#34;, Failed=&#34; &amp; lFailed &amp; &#34;, Skipped=&#34; &amp; lSkipped</td>
        </tr>
        <tr>
          <td id="L7233" data-line-number="7233"></td>
          <td id="LC7233">End Sub</td>
        </tr>
        <tr>
          <td id="L7234" data-line-number="7234"></td>
          <td id="LC7234">
</td>
        </tr>
        <tr>
          <td id="L7235" data-line-number="7235"></td>
          <td id="LC7235">Public Sub TestCryptoEcdsa(oJson As Object)</td>
        </tr>
        <tr>
          <td id="L7236" data-line-number="7236"></td>
          <td id="LC7236">    Const FUNC_NAME     As String = &#34;TestCryptoEcdsa&#34;</td>
        </tr>
        <tr>
          <td id="L7237" data-line-number="7237"></td>
          <td id="LC7237">    Dim oGroup          As Object</td>
        </tr>
        <tr>
          <td id="L7238" data-line-number="7238"></td>
          <td id="LC7238">    Dim oTest           As Object</td>
        </tr>
        <tr>
          <td id="L7239" data-line-number="7239"></td>
          <td id="LC7239">    Dim sComment        As String</td>
        </tr>
        <tr>
          <td id="L7240" data-line-number="7240"></td>
          <td id="LC7240">    Dim sResult         As String</td>
        </tr>
        <tr>
          <td id="L7241" data-line-number="7241"></td>
          <td id="LC7241">    Dim lPassed         As Long</td>
        </tr>
        <tr>
          <td id="L7242" data-line-number="7242"></td>
          <td id="LC7242">    Dim lFailed         As Long</td>
        </tr>
        <tr>
          <td id="L7243" data-line-number="7243"></td>
          <td id="LC7243">    Dim lSkipped        As Long</td>
        </tr>
        <tr>
          <td id="L7244" data-line-number="7244"></td>
          <td id="LC7244">    &#39;--- local</td>
        </tr>
        <tr>
          <td id="L7245" data-line-number="7245"></td>
          <td id="LC7245">    Dim baPublic()      As Byte</td>
        </tr>
        <tr>
          <td id="L7246" data-line-number="7246"></td>
          <td id="LC7246">    Dim baMsg()         As Byte</td>
        </tr>
        <tr>
          <td id="L7247" data-line-number="7247"></td>
          <td id="LC7247">    Dim baSig()         As Byte</td>
        </tr>
        <tr>
          <td id="L7248" data-line-number="7248"></td>
          <td id="LC7248">    Dim baBuffer()      As Byte</td>
        </tr>
        <tr>
          <td id="L7249" data-line-number="7249"></td>
          <td id="LC7249">    Dim sFlags          As String</td>
        </tr>
        <tr>
          <td id="L7250" data-line-number="7250"></td>
          <td id="LC7250">    Dim sCurve          As String</td>
        </tr>
        <tr>
          <td id="L7251" data-line-number="7251"></td>
          <td id="LC7251">    Dim lCurveSize      As KeyCodeConstants</td>
        </tr>
        <tr>
          <td id="L7252" data-line-number="7252"></td>
          <td id="LC7252">    Dim lHashSize       As Long</td>
        </tr>
        <tr>
          <td id="L7253" data-line-number="7253"></td>
          <td id="LC7253">    Dim baTemp()        As Byte</td>
        </tr>
        <tr>
          <td id="L7254" data-line-number="7254"></td>
          <td id="LC7254">    </td>
        </tr>
        <tr>
          <td id="L7255" data-line-number="7255"></td>
          <td id="LC7255">    pvCryptoInit</td>
        </tr>
        <tr>
          <td id="L7256" data-line-number="7256"></td>
          <td id="LC7256">    For Each oGroup In JsonValue(oJson, &#34;testGroups&#34;)</td>
        </tr>
        <tr>
          <td id="L7257" data-line-number="7257"></td>
          <td id="LC7257">        sCurve = JsonValue(oGroup, &#34;key/curve&#34;)</td>
        </tr>
        <tr>
          <td id="L7258" data-line-number="7258"></td>
          <td id="LC7258">        If sCurve = &#34;secp256r1&#34; Or sCurve = &#34;secp384r1&#34; Then</td>
        </tr>
        <tr>
          <td id="L7259" data-line-number="7259"></td>
          <td id="LC7259">            baPublic = FromHex(JsonValue(oGroup, &#34;key/uncompressed&#34;))</td>
        </tr>
        <tr>
          <td id="L7260" data-line-number="7260"></td>
          <td id="LC7260">            lCurveSize = JsonValue(oGroup, &#34;key/keySize&#34;) / 8</td>
        </tr>
        <tr>
          <td id="L7261" data-line-number="7261"></td>
          <td id="LC7261">            lHashSize = Replace(JsonValue(oGroup, &#34;sha&#34;), &#34;SHA-&#34;, vbNullString) / 8</td>
        </tr>
        <tr>
          <td id="L7262" data-line-number="7262"></td>
          <td id="LC7262">            For Each oTest In JsonValue(oGroup, &#34;tests&#34;)</td>
        </tr>
        <tr>
          <td id="L7263" data-line-number="7263"></td>
          <td id="LC7263">                baMsg = FromHex(JsonValue(oTest, &#34;msg&#34;))</td>
        </tr>
        <tr>
          <td id="L7264" data-line-number="7264"></td>
          <td id="LC7264">                baTemp = FromHex(JsonValue(oTest, &#34;sig&#34;))</td>
        </tr>
        <tr>
          <td id="L7265" data-line-number="7265"></td>
          <td id="LC7265">                If pvAsn1DecodeEcdsaSignature(baSig, baTemp, lCurveSize) Then</td>
        </tr>
        <tr>
          <td id="L7266" data-line-number="7266"></td>
          <td id="LC7266">                    sFlags = Join(JsonValue(oTest, &#34;flags/*&#34;), &#34;, &#34;)</td>
        </tr>
        <tr>
          <td id="L7267" data-line-number="7267"></td>
          <td id="LC7267">                    pvArrayHash lHashSize, baMsg, baBuffer</td>
        </tr>
        <tr>
          <td id="L7268" data-line-number="7268"></td>
          <td id="LC7268">                    If UBound(baBuffer) + 1 &lt; lCurveSize Then</td>
        </tr>
        <tr>
          <td id="L7269" data-line-number="7269"></td>
          <td id="LC7269">                        baTemp = baBuffer</td>
        </tr>
        <tr>
          <td id="L7270" data-line-number="7270"></td>
          <td id="LC7270">                        pvArrayAllocate baBuffer, lCurveSize, FUNC_NAME &amp; &#34;.baBuffer&#34;</td>
        </tr>
        <tr>
          <td id="L7271" data-line-number="7271"></td>
          <td id="LC7271">                        Call CopyMemory(baBuffer(lCurveSize - UBound(baTemp) - 1), baTemp(0), UBound(baTemp) + 1)</td>
        </tr>
        <tr>
          <td id="L7272" data-line-number="7272"></td>
          <td id="LC7272">                    End If</td>
        </tr>
        <tr>
          <td id="L7273" data-line-number="7273"></td>
          <td id="LC7273">                    If sCurve = &#34;secp256r1&#34; Then</td>
        </tr>
        <tr>
          <td id="L7274" data-line-number="7274"></td>
          <td id="LC7274">                        sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L7275" data-line-number="7275"></td>
          <td id="LC7275">                        If Not pvCryptoEcdsaSecp256r1Verify(baPublic, baBuffer, baSig) Then</td>
        </tr>
        <tr>
          <td id="L7276" data-line-number="7276"></td>
          <td id="LC7276">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7277" data-line-number="7277"></td>
          <td id="LC7277">                        End If</td>
        </tr>
        <tr>
          <td id="L7278" data-line-number="7278"></td>
          <td id="LC7278">                        If JsonValue(oTest, &#34;result&#34;) = &#34;acceptable&#34; And sResult = &#34;valid&#34; Then</td>
        </tr>
        <tr>
          <td id="L7279" data-line-number="7279"></td>
          <td id="LC7279">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7280" data-line-number="7280"></td>
          <td id="LC7280">                        ElseIf JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7281" data-line-number="7281"></td>
          <td id="LC7281">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7282" data-line-number="7282"></td>
          <td id="LC7282">                        Else</td>
        </tr>
        <tr>
          <td id="L7283" data-line-number="7283"></td>
          <td id="LC7283">                            lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7284" data-line-number="7284"></td>
          <td id="LC7284">                            sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7285" data-line-number="7285"></td>
          <td id="LC7285">                            DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; sCurve &amp; &#34;, &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString) &amp; _</td>
        </tr>
        <tr>
          <td id="L7286" data-line-number="7286"></td>
          <td id="LC7286">                                IIf(LenB(sFlags) &lt;&gt; 0, &#34;, &#34; &amp; sFlags, vbNullString) &amp; &#34;, sResult=&#34; &amp; sResult &amp; &#34; vs &#34; &amp; JsonValue(oTest, &#34;result&#34;)</td>
        </tr>
        <tr>
          <td id="L7287" data-line-number="7287"></td>
          <td id="LC7287">                        End If</td>
        </tr>
        <tr>
          <td id="L7288" data-line-number="7288"></td>
          <td id="LC7288">                    Else &#39; If sCurve = &#34;secp384r1&#34; Then</td>
        </tr>
        <tr>
          <td id="L7289" data-line-number="7289"></td>
          <td id="LC7289">                        sResult = &#34;valid&#34;</td>
        </tr>
        <tr>
          <td id="L7290" data-line-number="7290"></td>
          <td id="LC7290">                        If Not pvCryptoEcdsaSecp384r1Verify(baPublic, baBuffer, baSig) Then</td>
        </tr>
        <tr>
          <td id="L7291" data-line-number="7291"></td>
          <td id="LC7291">                            sResult = &#34;invalid&#34;</td>
        </tr>
        <tr>
          <td id="L7292" data-line-number="7292"></td>
          <td id="LC7292">                        End If</td>
        </tr>
        <tr>
          <td id="L7293" data-line-number="7293"></td>
          <td id="LC7293">                        If JsonValue(oTest, &#34;result&#34;) = &#34;acceptable&#34; And sResult = &#34;valid&#34; Then</td>
        </tr>
        <tr>
          <td id="L7294" data-line-number="7294"></td>
          <td id="LC7294">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7295" data-line-number="7295"></td>
          <td id="LC7295">                        ElseIf JsonValue(oTest, &#34;result&#34;) = sResult Then</td>
        </tr>
        <tr>
          <td id="L7296" data-line-number="7296"></td>
          <td id="LC7296">                            lPassed = lPassed + 1</td>
        </tr>
        <tr>
          <td id="L7297" data-line-number="7297"></td>
          <td id="LC7297">                        Else</td>
        </tr>
        <tr>
          <td id="L7298" data-line-number="7298"></td>
          <td id="LC7298">                            lFailed = lFailed + 1</td>
        </tr>
        <tr>
          <td id="L7299" data-line-number="7299"></td>
          <td id="LC7299">                            sComment = JsonValue(oTest, &#34;comment&#34;)</td>
        </tr>
        <tr>
          <td id="L7300" data-line-number="7300"></td>
          <td id="LC7300">                            DebugLog MODULE_NAME, FUNC_NAME, &#34;[-] &#34; &amp; sCurve &amp; &#34;, &#34; &amp; JsonValue(oTest, &#34;tcId&#34;) &amp; IIf(LenB(sComment) &lt;&gt; 0, &#34; (&#34; &amp; sComment &amp; &#34;)&#34;, vbNullString) &amp; _</td>
        </tr>
        <tr>
          <td id="L7301" data-line-number="7301"></td>
          <td id="LC7301">                                IIf(LenB(sFlags) &lt;&gt; 0, &#34;, &#34; &amp; sFlags, vbNullString) &amp; &#34;, sResult=&#34; &amp; sResult &amp; &#34; vs &#34; &amp; JsonValue(oTest, &#34;result&#34;)</td>
        </tr>
        <tr>
          <td id="L7302" data-line-number="7302"></td>
          <td id="LC7302">                        End If</td>
        </tr>
        <tr>
          <td id="L7303" data-line-number="7303"></td>
          <td id="LC7303">                    End If</td>
        </tr>
        <tr>
          <td id="L7304" data-line-number="7304"></td>
          <td id="LC7304">                Else</td>
        </tr>
        <tr>
          <td id="L7305" data-line-number="7305"></td>
          <td id="LC7305">                    lSkipped = lSkipped + 1</td>
        </tr>
        <tr>
          <td id="L7306" data-line-number="7306"></td>
          <td id="LC7306">                End If</td>
        </tr>
        <tr>
          <td id="L7307" data-line-number="7307"></td>
          <td id="LC7307">            Next</td>
        </tr>
        <tr>
          <td id="L7308" data-line-number="7308"></td>
          <td id="LC7308">        End If</td>
        </tr>
        <tr>
          <td id="L7309" data-line-number="7309"></td>
          <td id="LC7309">    Next</td>
        </tr>
        <tr>
          <td id="L7310" data-line-number="7310"></td>
          <td id="LC7310">    DebugLog MODULE_NAME, FUNC_NAME, &#34;[+] Passed=&#34; &amp; lPassed &amp; &#34;, Failed=&#34; &amp; lFailed &amp; &#34;, Skipped=&#34; &amp; lSkipped</td>
        </tr>
        <tr>
          <td id="L7311" data-line-number="7311"></td>
          <td id="LC7311">End Sub</td>
        </tr>
        <tr>
          <td id="L7312" data-line-number="7312"></td>
          <td id="LC7312">
</td>
        </tr>
        <tr>
          <td id="L7313" data-line-number="7313"></td>
          <td id="LC7313">#End If &#39; ImplTestCrypto</td>
        </tr>
        <tr>
          <td id="L7314" data-line-number="7314"></td>
          <td id="LC7314">
</td>
        </tr>
        <tr>
          <td id="L7315" data-line-number="7315"></td>
          <td id="LC7315">&#39;= trampolines ===========================================================</td>
        </tr>
        <tr>
          <td id="L7316" data-line-number="7316"></td>
          <td id="LC7316">
</td>
        </tr>
        <tr>
          <td id="L7317" data-line-number="7317"></td>
          <td id="LC7317">Private Function pvCallCurve25519Multiply(ByVal Pfn As Long, pSecretPtr As Byte, pPubKeyPtr As Byte, pPrivKeyPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7318" data-line-number="7318"></td>
          <td id="LC7318">    &#39; void cf_curve25519_mul(uint8_t out[32], const uint8_t priv[32], const uint8_t pub[32])</td>
        </tr>
        <tr>
          <td id="L7319" data-line-number="7319"></td>
          <td id="LC7319">End Function</td>
        </tr>
        <tr>
          <td id="L7320" data-line-number="7320"></td>
          <td id="LC7320">
</td>
        </tr>
        <tr>
          <td id="L7321" data-line-number="7321"></td>
          <td id="LC7321">Private Function pvCallCurve25519MulBase(ByVal Pfn As Long, pPubKeyPtr As Byte, pPrivKeyPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7322" data-line-number="7322"></td>
          <td id="LC7322">    &#39; void cf_curve25519_mul_base(uint8_t out[32], const uint8_t priv[32])</td>
        </tr>
        <tr>
          <td id="L7323" data-line-number="7323"></td>
          <td id="LC7323">End Function</td>
        </tr>
        <tr>
          <td id="L7324" data-line-number="7324"></td>
          <td id="LC7324">
</td>
        </tr>
        <tr>
          <td id="L7325" data-line-number="7325"></td>
          <td id="LC7325">Private Function pvCallSecpMakeKey(ByVal Pfn As Long, pPubKeyPtr As Byte, pPrivKeyPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7326" data-line-number="7326"></td>
          <td id="LC7326">    &#39; int ecc_make_key(uint8_t p_publicKey[ECC_BYTES+1], uint8_t p_privateKey[ECC_BYTES]);</td>
        </tr>
        <tr>
          <td id="L7327" data-line-number="7327"></td>
          <td id="LC7327">    &#39; int ecc_make_key384(uint8_t p_publicKey[ECC_BYTES_384+1], const uint8_t p_privateKey[ECC_BYTES_384])</td>
        </tr>
        <tr>
          <td id="L7328" data-line-number="7328"></td>
          <td id="LC7328">End Function</td>
        </tr>
        <tr>
          <td id="L7329" data-line-number="7329"></td>
          <td id="LC7329">
</td>
        </tr>
        <tr>
          <td id="L7330" data-line-number="7330"></td>
          <td id="LC7330">Private Function pvCallSecpSharedSecret(ByVal Pfn As Long, pPubKeyPtr As Byte, pPrivKeyPtr As Byte, pSecretPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7331" data-line-number="7331"></td>
          <td id="LC7331">    &#39; int ecdh_shared_secret(const uint8_t p_publicKey[ECC_BYTES+1], const uint8_t p_privateKey[ECC_BYTES], uint8_t p_secret[ECC_BYTES]);</td>
        </tr>
        <tr>
          <td id="L7332" data-line-number="7332"></td>
          <td id="LC7332">    &#39; int ecdh_shared_secret384(const uint8_t p_publicKey[ECC_BYTES_384+1], const uint8_t p_privateKey[ECC_BYTES_384], uint8_t p_secret[ECC_BYTES_384])</td>
        </tr>
        <tr>
          <td id="L7333" data-line-number="7333"></td>
          <td id="LC7333">End Function</td>
        </tr>
        <tr>
          <td id="L7334" data-line-number="7334"></td>
          <td id="LC7334">
</td>
        </tr>
        <tr>
          <td id="L7335" data-line-number="7335"></td>
          <td id="LC7335">Private Function pvCallSecpUncompressKey(ByVal Pfn As Long, pPubKeyPtr As Byte, pUncompressedKeyPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7336" data-line-number="7336"></td>
          <td id="LC7336">    &#39; int ecdh_uncompress_key(const uint8_t p_publicKey[ECC_BYTES + 1], uint8_t p_uncompressedKey[2 * ECC_BYTES + 1])</td>
        </tr>
        <tr>
          <td id="L7337" data-line-number="7337"></td>
          <td id="LC7337">    &#39; int ecdh_uncompress_key384(const uint8_t p_publicKey[ECC_BYTES_384 + 1], uint8_t p_uncompressedKey[2 * ECC_BYTES_384 + 1])</td>
        </tr>
        <tr>
          <td id="L7338" data-line-number="7338"></td>
          <td id="LC7338">End Function</td>
        </tr>
        <tr>
          <td id="L7339" data-line-number="7339"></td>
          <td id="LC7339">
</td>
        </tr>
        <tr>
          <td id="L7340" data-line-number="7340"></td>
          <td id="LC7340">Private Function pvCallSecpSign(ByVal Pfn As Long, pPrivKeyPtr As Byte, pHashPtr As Byte, pRandomPtr As Byte, pSignaturePtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7341" data-line-number="7341"></td>
          <td id="LC7341">    &#39; int ecdsa_sign(const uint8_t p_privateKey[ECC_BYTES], const uint8_t p_hash[ECC_BYTES], uint64_t k[NUM_ECC_DIGITS], uint8_t p_signature[ECC_BYTES*2])</td>
        </tr>
        <tr>
          <td id="L7342" data-line-number="7342"></td>
          <td id="LC7342">    &#39; int ecdsa_sign384(const uint8_t p_privateKey[ECC_BYTES_384], const uint8_t p_hash[ECC_BYTES_384], uint64_t k[NUM_ECC_DIGITS_384], uint8_t p_signature[ECC_BYTES_384*2])</td>
        </tr>
        <tr>
          <td id="L7343" data-line-number="7343"></td>
          <td id="LC7343">End Function</td>
        </tr>
        <tr>
          <td id="L7344" data-line-number="7344"></td>
          <td id="LC7344">
</td>
        </tr>
        <tr>
          <td id="L7345" data-line-number="7345"></td>
          <td id="LC7345">Private Function pvCallSecpVerify(ByVal Pfn As Long, pPubKeyPtr As Byte, pHashPtr As Byte, pSignaturePtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7346" data-line-number="7346"></td>
          <td id="LC7346">    &#39; int ecdsa_verify(const uint8_t p_publicKey[ECC_BYTES+1], const uint8_t p_hash[ECC_BYTES], const uint8_t p_signature[ECC_BYTES*2])</td>
        </tr>
        <tr>
          <td id="L7347" data-line-number="7347"></td>
          <td id="LC7347">    &#39; int ecdsa_verify384(const uint8_t p_publicKey[ECC_BYTES_384+1], const uint8_t p_hash[ECC_BYTES_384], const uint8_t p_signature[ECC_BYTES_384*2])</td>
        </tr>
        <tr>
          <td id="L7348" data-line-number="7348"></td>
          <td id="LC7348">End Function</td>
        </tr>
        <tr>
          <td id="L7349" data-line-number="7349"></td>
          <td id="LC7349">
</td>
        </tr>
        <tr>
          <td id="L7350" data-line-number="7350"></td>
          <td id="LC7350">Private Function pvCallSha2Init(ByVal Pfn As Long, ByVal lCtxPtr As Long) As Long</td>
        </tr>
        <tr>
          <td id="L7351" data-line-number="7351"></td>
          <td id="LC7351">    &#39; void cf_sha256_init(cf_sha256_context *ctx)</td>
        </tr>
        <tr>
          <td id="L7352" data-line-number="7352"></td>
          <td id="LC7352">    &#39; void cf_sha384_init(cf_sha384_context *ctx)</td>
        </tr>
        <tr>
          <td id="L7353" data-line-number="7353"></td>
          <td id="LC7353">    &#39; void cf_sha512_init(cf_sha512_context *ctx)</td>
        </tr>
        <tr>
          <td id="L7354" data-line-number="7354"></td>
          <td id="LC7354">End Function</td>
        </tr>
        <tr>
          <td id="L7355" data-line-number="7355"></td>
          <td id="LC7355">
</td>
        </tr>
        <tr>
          <td id="L7356" data-line-number="7356"></td>
          <td id="LC7356">Private Function pvCallSha2Update(ByVal Pfn As Long, ByVal lCtxPtr As Long, ByVal lDataPtr As Long, ByVal lSize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L7357" data-line-number="7357"></td>
          <td id="LC7357">    &#39; void cf_sha256_update(cf_sha256_context *ctx, const void *data, size_t nbytes)</td>
        </tr>
        <tr>
          <td id="L7358" data-line-number="7358"></td>
          <td id="LC7358">    &#39; void cf_sha384_update(cf_sha384_context *ctx, const void *data, size_t nbytes)</td>
        </tr>
        <tr>
          <td id="L7359" data-line-number="7359"></td>
          <td id="LC7359">    &#39; void cf_sha512_update(cf_sha512_context *ctx, const void *data, size_t nbytes)</td>
        </tr>
        <tr>
          <td id="L7360" data-line-number="7360"></td>
          <td id="LC7360">End Function</td>
        </tr>
        <tr>
          <td id="L7361" data-line-number="7361"></td>
          <td id="LC7361">
</td>
        </tr>
        <tr>
          <td id="L7362" data-line-number="7362"></td>
          <td id="LC7362">Private Function pvCallSha2Final(ByVal Pfn As Long, ByVal lCtxPtr As Long, pHashPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7363" data-line-number="7363"></td>
          <td id="LC7363">    &#39; void cf_sha256_digest_final(cf_sha256_context *ctx, uint8_t hash[LNG_SHA256_HASHSZ])</td>
        </tr>
        <tr>
          <td id="L7364" data-line-number="7364"></td>
          <td id="LC7364">    &#39; void cf_sha384_digest_final(cf_sha384_context *ctx, uint8_t hash[LNG_SHA384_HASHSZ])</td>
        </tr>
        <tr>
          <td id="L7365" data-line-number="7365"></td>
          <td id="LC7365">    &#39; void cf_sha512_digest_final(cf_sha512_context *ctx, uint8_t hash[LNG_SHA384_HASHSZ])</td>
        </tr>
        <tr>
          <td id="L7366" data-line-number="7366"></td>
          <td id="LC7366">End Function</td>
        </tr>
        <tr>
          <td id="L7367" data-line-number="7367"></td>
          <td id="LC7367">
</td>
        </tr>
        <tr>
          <td id="L7368" data-line-number="7368"></td>
          <td id="LC7368">Private Function pvCallChacha20Poly1305Encrypt( _</td>
        </tr>
        <tr>
          <td id="L7369" data-line-number="7369"></td>
          <td id="LC7369">            ByVal Pfn As Long, pKeyPtr As Byte, pNoncePtr As Byte, _</td>
        </tr>
        <tr>
          <td id="L7370" data-line-number="7370"></td>
          <td id="LC7370">            ByVal lHeaderPtr As Long, ByVal lHeaderSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7371" data-line-number="7371"></td>
          <td id="LC7371">            pPlaintTextPtr As Byte, ByVal lPlaintTextSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7372" data-line-number="7372"></td>
          <td id="LC7372">            pCipherTextPtr As Byte, pTagPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7373" data-line-number="7373"></td>
          <td id="LC7373">    &#39; void cf_chacha20poly1305_encrypt(const uint8_t key[32], const uint8_t nonce[12], const uint8_t *header, size_t nheader,</td>
        </tr>
        <tr>
          <td id="L7374" data-line-number="7374"></td>
          <td id="LC7374">    &#39;                                  const uint8_t *plaintext, size_t nbytes, uint8_t *ciphertext, uint8_t tag[16])</td>
        </tr>
        <tr>
          <td id="L7375" data-line-number="7375"></td>
          <td id="LC7375">End Function</td>
        </tr>
        <tr>
          <td id="L7376" data-line-number="7376"></td>
          <td id="LC7376">
</td>
        </tr>
        <tr>
          <td id="L7377" data-line-number="7377"></td>
          <td id="LC7377">Private Function pvCallChacha20Poly1305Decrypt( _</td>
        </tr>
        <tr>
          <td id="L7378" data-line-number="7378"></td>
          <td id="LC7378">            ByVal Pfn As Long, pKeyPtr As Byte, pNoncePtr As Byte, _</td>
        </tr>
        <tr>
          <td id="L7379" data-line-number="7379"></td>
          <td id="LC7379">            pHeaderPtr As Byte, ByVal lHeaderSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7380" data-line-number="7380"></td>
          <td id="LC7380">            pCipherTextPtr As Byte, ByVal lCipherTextSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7381" data-line-number="7381"></td>
          <td id="LC7381">            pTagPtr As Byte, pPlaintTextPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7382" data-line-number="7382"></td>
          <td id="LC7382">    &#39; int cf_chacha20poly1305_decrypt(const uint8_t key[32], const uint8_t nonce[12], const uint8_t *header, size_t nheader,</td>
        </tr>
        <tr>
          <td id="L7383" data-line-number="7383"></td>
          <td id="LC7383">    &#39;                                 const uint8_t *ciphertext, size_t nbytes, const uint8_t tag[16], uint8_t *plaintext)</td>
        </tr>
        <tr>
          <td id="L7384" data-line-number="7384"></td>
          <td id="LC7384">End Function</td>
        </tr>
        <tr>
          <td id="L7385" data-line-number="7385"></td>
          <td id="LC7385">
</td>
        </tr>
        <tr>
          <td id="L7386" data-line-number="7386"></td>
          <td id="LC7386">Private Function pvCallAesGcmEncrypt( _</td>
        </tr>
        <tr>
          <td id="L7387" data-line-number="7387"></td>
          <td id="LC7387">            ByVal Pfn As Long, pCipherTextPtr As Byte, pTagPtr As Byte, pPlaintTextPtr As Byte, ByVal lPlaintTextSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7388" data-line-number="7388"></td>
          <td id="LC7388">            ByVal lHeaderPtr As Long, ByVal lHeaderSize As Long, pNoncePtr As Byte, pKeyPtr As Byte, ByVal lKeySize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L7389" data-line-number="7389"></td>
          <td id="LC7389">    &#39; void cf_aesgcm_encrypt(uint8_t *c, uint8_t *mac, const uint8_t *m, const size_t mlen, const uint8_t *ad, const size_t adlen,</td>
        </tr>
        <tr>
          <td id="L7390" data-line-number="7390"></td>
          <td id="LC7390">    &#39;                        const uint8_t *npub, const uint8_t *k, size_t klen)</td>
        </tr>
        <tr>
          <td id="L7391" data-line-number="7391"></td>
          <td id="LC7391">End Function</td>
        </tr>
        <tr>
          <td id="L7392" data-line-number="7392"></td>
          <td id="LC7392">
</td>
        </tr>
        <tr>
          <td id="L7393" data-line-number="7393"></td>
          <td id="LC7393">Private Function pvCallAesGcmDecrypt( _</td>
        </tr>
        <tr>
          <td id="L7394" data-line-number="7394"></td>
          <td id="LC7394">            ByVal Pfn As Long, pPlaintTextPtr As Byte, pCipherTextPtr As Byte, ByVal lCipherTextSize As Long, pTagPtr As Byte, _</td>
        </tr>
        <tr>
          <td id="L7395" data-line-number="7395"></td>
          <td id="LC7395">            pHeaderPtr As Byte, ByVal lHeaderSize As Long, pNoncePtr As Byte, pKeyPtr As Byte, ByVal lKeySize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L7396" data-line-number="7396"></td>
          <td id="LC7396">    &#39; void cf_aesgcm_decrypt(uint8_t *m, const uint8_t *c, const size_t clen, const uint8_t *mac, const uint8_t *ad, const size_t adlen,</td>
        </tr>
        <tr>
          <td id="L7397" data-line-number="7397"></td>
          <td id="LC7397">    &#39;                        const uint8_t *npub, const uint8_t *k, const size_t klen)</td>
        </tr>
        <tr>
          <td id="L7398" data-line-number="7398"></td>
          <td id="LC7398">End Function</td>
        </tr>
        <tr>
          <td id="L7399" data-line-number="7399"></td>
          <td id="LC7399">
</td>
        </tr>
        <tr>
          <td id="L7400" data-line-number="7400"></td>
          <td id="LC7400">Private Function pvCallAesCbcEncrypt( _</td>
        </tr>
        <tr>
          <td id="L7401" data-line-number="7401"></td>
          <td id="LC7401">            ByVal Pfn As Long, pCipherTextPtr As Byte, pPlaintTextPtr As Byte, ByVal lPlaintTextSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7402" data-line-number="7402"></td>
          <td id="LC7402">            pNoncePtr As Byte, pKeyPtr As Byte, ByVal lKeySize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L7403" data-line-number="7403"></td>
          <td id="LC7403">    &#39; static void cf_aescbc_encrypt(uint8_t *c, const uint8_t *m, const size_t mlen,</td>
        </tr>
        <tr>
          <td id="L7404" data-line-number="7404"></td>
          <td id="LC7404">    &#39;                               const uint8_t *npub, const uint8_t *k, const size_t klen)</td>
        </tr>
        <tr>
          <td id="L7405" data-line-number="7405"></td>
          <td id="LC7405">End Function</td>
        </tr>
        <tr>
          <td id="L7406" data-line-number="7406"></td>
          <td id="LC7406">
</td>
        </tr>
        <tr>
          <td id="L7407" data-line-number="7407"></td>
          <td id="LC7407">Private Function pvCallAesCbcDecrypt( _</td>
        </tr>
        <tr>
          <td id="L7408" data-line-number="7408"></td>
          <td id="LC7408">            ByVal Pfn As Long, pPlaintTextPtr As Byte, pCipherTextPtr As Byte, ByVal lCipherTextSize As Long, _</td>
        </tr>
        <tr>
          <td id="L7409" data-line-number="7409"></td>
          <td id="LC7409">            pNoncePtr As Byte, pKeyPtr As Byte, ByVal lKeySize As Long) As Long</td>
        </tr>
        <tr>
          <td id="L7410" data-line-number="7410"></td>
          <td id="LC7410">    &#39; static void cf_aescbc_decrypt(uint8_t *m, const uint8_t *c, const size_t clen,</td>
        </tr>
        <tr>
          <td id="L7411" data-line-number="7411"></td>
          <td id="LC7411">    &#39;                              const uint8_t *npub, const uint8_t *k, const size_t klen)</td>
        </tr>
        <tr>
          <td id="L7412" data-line-number="7412"></td>
          <td id="LC7412">End Function</td>
        </tr>
        <tr>
          <td id="L7413" data-line-number="7413"></td>
          <td id="LC7413">
</td>
        </tr>
        <tr>
          <td id="L7414" data-line-number="7414"></td>
          <td id="LC7414">Private Function pvCallRsaModExp(ByVal Pfn As Long, ByVal lSize As Long, pBasePtr As Byte, pExpPtr As Byte, pModPtr As Byte, pRetPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7415" data-line-number="7415"></td>
          <td id="LC7415">    &#39; static void rsa_modexp(const uint32_t maxbytes, const uint8_t *base_in, const uint8_t *exp_in, const uint8_t *mod_in, uint8_t *ret_out)</td>
        </tr>
        <tr>
          <td id="L7416" data-line-number="7416"></td>
          <td id="LC7416">End Function</td>
        </tr>
        <tr>
          <td id="L7417" data-line-number="7417"></td>
          <td id="LC7417">
</td>
        </tr>
        <tr>
          <td id="L7418" data-line-number="7418"></td>
          <td id="LC7418">Private Function pvCallRsaCrtModExp(ByVal Pfn As Long, ByVal lSize As Long, pBasePtr As Byte, pExpPtr As Byte, pModPtr As Byte, pPPtr As Byte, pQPtr As Byte, pIqmpPtr As Byte, pRetPtr As Byte) As Long</td>
        </tr>
        <tr>
          <td id="L7419" data-line-number="7419"></td>
          <td id="LC7419">    &#39; static void rsa_crt_modexp(const uint32_t maxbytes, const uint8_t *base_in, const uint8_t *exp_in, const uint8_t *mod_in,</td>
        </tr>
        <tr>
          <td id="L7420" data-line-number="7420"></td>
          <td id="LC7420">    &#39;                            const uint8_t *p_in, const uint8_t *q_in, const uint8_t *iqmp_in, uint8_t *ret_out)</td>
        </tr>
        <tr>
          <td id="L7421" data-line-number="7421"></td>
          <td id="LC7421">End Function</td>
        </tr>
        <tr>
          <td id="L7422" data-line-number="7422"></td>
          <td id="LC7422">
</td>
        </tr>
        <tr>
          <td id="L7423" data-line-number="7423"></td>
          <td id="LC7423">Private Sub pvAppendBuffer(ByVal a01 As Long, ByVal a02 As Long, ByVal a03 As Long, ByVal a04 As Long, ByVal a05 As Long, ByVal a06 As Long, ByVal a07 As Long, ByVal a08 As Long, ByVal a09 As Long, ByVal a10 As Long, ByVal a11 As Long, ByVal a12 As Long, ByVal a13 As Long, ByVal a14 As Long, ByVal a15 As Long, ByVal a16 As Long, ByVal a17 As Long, ByVal a18 As Long, ByVal a19 As Long, ByVal a20 As Long, ByVal a21 As Long, ByVal a22 As Long, ByVal a23 As Long, ByVal a24 As Long, ByVal a25 As Long, ByVal a26 As Long, ByVal a27 As Long, ByVal a28 As Long, ByVal a29 As Long, ByVal a30 As Long, ByVal a31 As Long, ByVal a32 As Long)</td>
        </tr>
        <tr>
          <td id="L7424" data-line-number="7424"></td>
          <td id="LC7424">    #If a01 And a02 And a03 And a04 And a05 And a06 And a07 And a08 And a09 And a10 And a11 And a12 And a13 And a14 And a15 And a16 And a17 And a18 And a19 And a20 And a21 And a22 And a23 And a24 And a25 And a26 And a27 And a28 And a29 And a30 And a31 And a32 Then &#39;--- touch args</td>
        </tr>
        <tr>
          <td id="L7425" data-line-number="7425"></td>
          <td id="LC7425">    #End If</td>
        </tr>
        <tr>
          <td id="L7426" data-line-number="7426"></td>
          <td id="LC7426">    Call CopyMemory(m_baBuffer(m_lBuffIdx), a01, 4 * 32)</td>
        </tr>
        <tr>
          <td id="L7427" data-line-number="7427"></td>
          <td id="LC7427">    m_lBuffIdx = m_lBuffIdx + 4 * 32</td>
        </tr>
        <tr>
          <td id="L7428" data-line-number="7428"></td>
          <td id="LC7428">End Sub</td>
        </tr>
        <tr>
          <td id="L7429" data-line-number="7429"></td>
          <td id="LC7429">
</td>
        </tr>
        <tr>
          <td id="L7430" data-line-number="7430"></td>
          <td id="LC7430">Private Sub pvGetGlobData(baBuffer() As Byte)</td>
        </tr>
        <tr>
          <td id="L7431" data-line-number="7431"></td>
          <td id="LC7431">    ReDim m_baBuffer(0 To 2048 - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7432" data-line-number="7432"></td>
          <td id="LC7432">    m_lBuffIdx = 0</td>
        </tr>
        <tr>
          <td id="L7433" data-line-number="7433"></td>
          <td id="LC7433">    &#39;--- begin thunk data</td>
        </tr>
        <tr>
          <td id="L7434" data-line-number="7434"></td>
          <td id="LC7434">    pvAppendBuffer &amp;H76AC8030, &amp;H76B46E90, &amp;H76AC7300, &amp;H0&amp;, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H1&amp;, &amp;HFFFFFFFF, &amp;H27D2604B, &amp;H3BCE3C3E, &amp;HCC53B0F6, &amp;H651D06B0, &amp;H769886BC, &amp;HB3EBBD55, &amp;HAA3A93E7, &amp;H5AC635D8, &amp;HD898C296, &amp;HF4A13945, &amp;H2DEB33A0, &amp;H77037D81, &amp;H63A440F2, &amp;HF8BCE6E5, &amp;HE12C4247, &amp;H6B17D1F2, &amp;H37BF51F5, &amp;HCBB64068, &amp;H6B315ECE, &amp;H2BCE3357</td>
        </tr>
        <tr>
          <td id="L7435" data-line-number="7435"></td>
          <td id="LC7435">    pvAppendBuffer &amp;H7C0F9E16, &amp;H8EE7EB4A, &amp;HFE1A7F9B, &amp;H4FE342E2, &amp;HFC632551, &amp;HF3B9CAC2, &amp;HA7179E84, &amp;HBCE6FAAD, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;H0&amp;, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;H0&amp;, &amp;H0&amp;, &amp;HFFFFFFFF, &amp;HFFFFFFFE, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HD3EC2AEF, &amp;H2A85C8ED, &amp;H8A2ED19D, &amp;HC656398D, &amp;H5013875A, &amp;H314088F, &amp;HFE814112, &amp;H181D9C6E</td>
        </tr>
        <tr>
          <td id="L7436" data-line-number="7436"></td>
          <td id="LC7436">    pvAppendBuffer &amp;HE3F82D19, &amp;H988E056B, &amp;HE23EE7E4, &amp;HB3312FA7, &amp;H72760AB7, &amp;H3A545E38, &amp;HBF55296C, &amp;H5502F25D, &amp;H82542A38, &amp;H59F741E0, &amp;H8BA79B98, &amp;H6E1D3B62, &amp;HF320AD74, &amp;H8EB1C71E, &amp;HBE8B0537, &amp;HAA87CA22, &amp;H90EA0E5F, &amp;H7A431D7C, &amp;H1D7E819D, &amp;HA60B1CE, &amp;HB5F0B8C0, &amp;HE9DA3113, &amp;H289A147C, &amp;HF8F41DBD, &amp;H9292DC29, &amp;H5D9E98BF, &amp;H96262C6F, &amp;H3617DE4A, &amp;HCCC52973, &amp;HECEC196A, &amp;H48B0A77A, &amp;H581A0DB2</td>
        </tr>
        <tr>
          <td id="L7437" data-line-number="7437"></td>
          <td id="LC7437">    pvAppendBuffer &amp;HF4372DDF, &amp;HC7634D81, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;HFFFFFFFF, &amp;H428A2F98, &amp;H71374491, &amp;HB5C0FBCF, &amp;HE9B5DBA5, &amp;H3956C25B, &amp;H59F111F1, &amp;H923F82A4, &amp;HAB1C5ED5, &amp;HD807AA98, &amp;H12835B01, &amp;H243185BE, &amp;H550C7DC3, &amp;H72BE5D74, &amp;H80DEB1FE, &amp;H9BDC06A7, &amp;HC19BF174, &amp;HE49B69C1, &amp;HEFBE4786, &amp;HFC19DC6, &amp;H240CA1CC, &amp;H2DE92C6F, &amp;H4A7484AA, &amp;H5CB0A9DC, &amp;H76F988DA</td>
        </tr>
        <tr>
          <td id="L7438" data-line-number="7438"></td>
          <td id="LC7438">    pvAppendBuffer &amp;H983E5152, &amp;HA831C66D, &amp;HB00327C8, &amp;HBF597FC7, &amp;HC6E00BF3, &amp;HD5A79147, &amp;H6CA6351, &amp;H14292967, &amp;H27B70A85, &amp;H2E1B2138, &amp;H4D2C6DFC, &amp;H53380D13, &amp;H650A7354, &amp;H766A0ABB, &amp;H81C2C92E, &amp;H92722C85, &amp;HA2BFE8A1, &amp;HA81A664B, &amp;HC24B8B70, &amp;HC76C51A3, &amp;HD192E819, &amp;HD6990624, &amp;HF40E3585, &amp;H106AA070, &amp;H19A4C116, &amp;H1E376C08, &amp;H2748774C, &amp;H34B0BCB5, &amp;H391C0CB3, &amp;H4ED8AA4A, &amp;H5B9CCA4F, &amp;H682E6FF3</td>
        </tr>
        <tr>
          <td id="L7439" data-line-number="7439"></td>
          <td id="LC7439">    pvAppendBuffer &amp;H748F82EE, &amp;H78A5636F, &amp;H84C87814, &amp;H8CC70208, &amp;H90BEFFFA, &amp;HA4506CEB, &amp;HBEF9A3F7, &amp;HC67178F2, &amp;HD728AE22, &amp;H428A2F98, &amp;H23EF65CD, &amp;H71374491, &amp;HEC4D3B2F, &amp;HB5C0FBCF, &amp;H8189DBBC, &amp;HE9B5DBA5, &amp;HF348B538, &amp;H3956C25B, &amp;HB605D019, &amp;H59F111F1, &amp;HAF194F9B, &amp;H923F82A4, &amp;HDA6D8118, &amp;HAB1C5ED5, &amp;HA3030242, &amp;HD807AA98, &amp;H45706FBE, &amp;H12835B01, &amp;H4EE4B28C, &amp;H243185BE, &amp;HD5FFB4E2, &amp;H550C7DC3</td>
        </tr>
        <tr>
          <td id="L7440" data-line-number="7440"></td>
          <td id="LC7440">    pvAppendBuffer &amp;HF27B896F, &amp;H72BE5D74, &amp;H3B1696B1, &amp;H80DEB1FE, &amp;H25C71235, &amp;H9BDC06A7, &amp;HCF692694, &amp;HC19BF174, &amp;H9EF14AD2, &amp;HE49B69C1, &amp;H384F25E3, &amp;HEFBE4786, &amp;H8B8CD5B5, &amp;HFC19DC6, &amp;H77AC9C65, &amp;H240CA1CC, &amp;H592B0275, &amp;H2DE92C6F, &amp;H6EA6E483, &amp;H4A7484AA, &amp;HBD41FBD4, &amp;H5CB0A9DC, &amp;H831153B5, &amp;H76F988DA, &amp;HEE66DFAB, &amp;H983E5152, &amp;H2DB43210, &amp;HA831C66D, &amp;H98FB213F, &amp;HB00327C8, &amp;HBEEF0EE4, &amp;HBF597FC7</td>
        </tr>
        <tr>
          <td id="L7441" data-line-number="7441"></td>
          <td id="LC7441">    pvAppendBuffer &amp;H3DA88FC2, &amp;HC6E00BF3, &amp;H930AA725, &amp;HD5A79147, &amp;HE003826F, &amp;H6CA6351, &amp;HA0E6E70, &amp;H14292967, &amp;H46D22FFC, &amp;H27B70A85, &amp;H5C26C926, &amp;H2E1B2138, &amp;H5AC42AED, &amp;H4D2C6DFC, &amp;H9D95B3DF, &amp;H53380D13, &amp;H8BAF63DE, &amp;H650A7354, &amp;H3C77B2A8, &amp;H766A0ABB, &amp;H47EDAEE6, &amp;H81C2C92E, &amp;H1482353B, &amp;H92722C85, &amp;H4CF10364, &amp;HA2BFE8A1, &amp;HBC423001, &amp;HA81A664B, &amp;HD0F89791, &amp;HC24B8B70, &amp;H654BE30, &amp;HC76C51A3</td>
        </tr>
        <tr>
          <td id="L7442" data-line-number="7442"></td>
          <td id="LC7442">    pvAppendBuffer &amp;HD6EF5218, &amp;HD192E819, &amp;H5565A910, &amp;HD6990624, &amp;H5771202A, &amp;HF40E3585, &amp;H32BBD1B8, &amp;H106AA070, &amp;HB8D2D0C8, &amp;H19A4C116, &amp;H5141AB53, &amp;H1E376C08, &amp;HDF8EEB99, &amp;H2748774C, &amp;HE19B48A8, &amp;H34B0BCB5, &amp;HC5C95A63, &amp;H391C0CB3, &amp;HE3418ACB, &amp;H4ED8AA4A, &amp;H7763E373, &amp;H5B9CCA4F, &amp;HD6B2B8A3, &amp;H682E6FF3, &amp;H5DEFB2FC, &amp;H748F82EE, &amp;H43172F60, &amp;H78A5636F, &amp;HA1F0AB72, &amp;H84C87814, &amp;H1A6439EC, &amp;H8CC70208</td>
        </tr>
        <tr>
          <td id="L7443" data-line-number="7443"></td>
          <td id="LC7443">    pvAppendBuffer &amp;H23631E28, &amp;H90BEFFFA, &amp;HDE82BDE9, &amp;HA4506CEB, &amp;HB2C67915, &amp;HBEF9A3F7, &amp;HE372532B, &amp;HC67178F2, &amp;HEA26619C, &amp;HCA273ECE, &amp;H21C0C207, &amp;HD186B8C7, &amp;HCDE0EB1E, &amp;HEADA7DD6, &amp;HEE6ED178, &amp;HF57D4F7F, &amp;H72176FBA, &amp;H6F067AA, &amp;HA2C898A6, &amp;HA637DC5, &amp;HBEF90DAE, &amp;H113F9804, &amp;H131C471B, &amp;H1B710B35, &amp;H23047D84, &amp;H28DB77F5, &amp;H40C72493, &amp;H32CAAB7B, &amp;H15C9BEBC, &amp;H3C9EBE0A, &amp;H9C100D4C, &amp;H431D67C4</td>
        </tr>
        <tr>
          <td id="L7444" data-line-number="7444"></td>
          <td id="LC7444">    pvAppendBuffer &amp;HCB3E42B6, &amp;H4CC5D4BE, &amp;HFC657E2A, &amp;H597F299C, &amp;H3AD6FAEC, &amp;H5FCB6FAB, &amp;H4A475817, &amp;H6C44198C, &amp;H61707865, &amp;H3120646E, &amp;H79622D36, &amp;H6B206574, &amp;H70786500, &amp;H20646E61, &amp;H622D3233, &amp;H20657479, &amp;H6B&amp;, &amp;H5&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;</td>
        </tr>
        <tr>
          <td id="L7445" data-line-number="7445"></td>
          <td id="LC7445">    pvAppendBuffer &amp;H0&amp;, &amp;HFC&amp;, &amp;H7B777C63, &amp;HC56F6BF2, &amp;H2B670130, &amp;H76ABD7FE, &amp;H7DC982CA, &amp;HF04759FA, &amp;HAFA2D4AD, &amp;HC072A49C, &amp;H2693FDB7, &amp;HCCF73F36, &amp;HF1E5A534, &amp;H1531D871, &amp;HC323C704, &amp;H9A059618, &amp;HE2801207, &amp;H75B227EB, &amp;H1A2C8309, &amp;HA05A6E1B, &amp;HB3D63B52, &amp;H842FE329, &amp;HED00D153, &amp;H5BB1FC20, &amp;H39BECB6A, &amp;HCF584C4A, &amp;HFBAAEFD0, &amp;H85334D43, &amp;H7F02F945, &amp;HA89F3C50, &amp;H8F40A351, &amp;HF5389D92</td>
        </tr>
        <tr>
          <td id="L7446" data-line-number="7446"></td>
          <td id="LC7446">    pvAppendBuffer &amp;H21DAB6BC, &amp;HD2F3FF10, &amp;HEC130CCD, &amp;H1744975F, &amp;H3D7EA7C4, &amp;H73195D64, &amp;HDC4F8160, &amp;H88902A22, &amp;H14B8EE46, &amp;HDB0B5EDE, &amp;HA3A32E0, &amp;H5C240649, &amp;H62ACD3C2, &amp;H79E49591, &amp;H6D37C8E7, &amp;HA94ED58D, &amp;HEAF4566C, &amp;H8AE7A65, &amp;H2E2578BA, &amp;HC6B4A61C, &amp;H1F74DDE8, &amp;H8A8BBD4B, &amp;H66B53E70, &amp;HEF60348, &amp;HB9573561, &amp;H9E1DC186, &amp;H1198F8E1, &amp;H948ED969, &amp;HE9871E9B, &amp;HDF2855CE, &amp;HD89A18C, &amp;H6842E6BF</td>
        </tr>
        <tr>
          <td id="L7447" data-line-number="7447"></td>
          <td id="LC7447">    pvAppendBuffer &amp;HF2D9941, &amp;H16BB54B0, &amp;H402018D, &amp;H40201008, &amp;H52361B80, &amp;H30D56A09, &amp;HBF38A536, &amp;H819EA340, &amp;H7CFBD7F3, &amp;H9B8239E3, &amp;H3487FF2F, &amp;HC444438E, &amp;H54CBE9DE, &amp;HA632947B, &amp;HEE3D23C2, &amp;H420B954C, &amp;H84EC3FA, &amp;H2866A12E, &amp;H76B224D9, &amp;H6D49A25B, &amp;H7225D18B, &amp;H8664F6F8, &amp;HD4169868, &amp;H5DCC5CA4, &amp;H6C92B665, &amp;HFD504870, &amp;H5EDAB9ED, &amp;HA7574615, &amp;H90849D8D, &amp;H8C00ABD8, &amp;HF70AD3BC, &amp;HB80558E4</td>
        </tr>
        <tr>
          <td id="L7448" data-line-number="7448"></td>
          <td id="LC7448">    pvAppendBuffer &amp;HD00645B3, &amp;HCA8F1E2C, &amp;HC1020F3F, &amp;H103BDAF, &amp;H3A6B8A13, &amp;H4F411191, &amp;H97EADC67, &amp;HF0CECFF2, &amp;H9673E6B4, &amp;HE72274AC, &amp;HE28535AD, &amp;H1CE837F9, &amp;H476EDF75, &amp;H1D711AF1, &amp;H6F89C529, &amp;HAA0E62B7, &amp;HFC1BBE18, &amp;HC64B3E56, &amp;H9A2079D2, &amp;H78FEC0DB, &amp;H1FF45ACD, &amp;H8833A8DD, &amp;HB131C707, &amp;H27591012, &amp;H605FEC80, &amp;H19A97F51, &amp;H2D0D4AB5, &amp;H939F7AE5, &amp;HA0EF9CC9, &amp;HAE4D3BE0, &amp;HC8B0F52A, &amp;H833CBBEB</td>
        </tr>
        <tr>
          <td id="L7449" data-line-number="7449"></td>
          <td id="LC7449">    pvAppendBuffer &amp;H17619953, &amp;HBA7E042B, &amp;HE126D677, &amp;H55631469, &amp;H7D0C21, &amp;H0&amp;, &amp;H1&amp;, &amp;H1&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;</td>
        </tr>
        <tr>
          <td id="L7450" data-line-number="7450"></td>
          <td id="LC7450">    &#39;--- end thunk data</td>
        </tr>
        <tr>
          <td id="L7451" data-line-number="7451"></td>
          <td id="LC7451">    ReDim baBuffer(0 To 1952 - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7452" data-line-number="7452"></td>
          <td id="LC7452">    Call CopyMemory(baBuffer(0), m_baBuffer(0), UBound(baBuffer) + 1)</td>
        </tr>
        <tr>
          <td id="L7453" data-line-number="7453"></td>
          <td id="LC7453">    Erase m_baBuffer</td>
        </tr>
        <tr>
          <td id="L7454" data-line-number="7454"></td>
          <td id="LC7454">End Sub</td>
        </tr>
        <tr>
          <td id="L7455" data-line-number="7455"></td>
          <td id="LC7455">
</td>
        </tr>
        <tr>
          <td id="L7456" data-line-number="7456"></td>
          <td id="LC7456">Private Sub pvGetThunkData(baBuffer() As Byte)</td>
        </tr>
        <tr>
          <td id="L7457" data-line-number="7457"></td>
          <td id="LC7457">    ReDim m_baBuffer(0 To 34176 - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7458" data-line-number="7458"></td>
          <td id="LC7458">    m_lBuffIdx = 0</td>
        </tr>
        <tr>
          <td id="L7459" data-line-number="7459"></td>
          <td id="LC7459">    &#39;--- begin thunk data</td>
        </tr>
        <tr>
          <td id="L7460" data-line-number="7460"></td>
          <td id="LC7460">    pvAppendBuffer &amp;H480238, &amp;H29DA&amp;, &amp;H2CD8&amp;, &amp;H3A3A&amp;, &amp;H3E54&amp;, &amp;H3F11&amp;, &amp;H3F8B&amp;, &amp;H421F&amp;, &amp;H3AE4&amp;, &amp;H3EAE&amp;, &amp;H3F4E&amp;, &amp;H40CB&amp;, &amp;H45E3&amp;, &amp;H3522&amp;, &amp;H3572&amp;, &amp;H3437&amp;, &amp;H35CE&amp;, &amp;H3659&amp;, &amp;H35A5&amp;, &amp;H378B&amp;, &amp;H3816&amp;, &amp;H365E&amp;, &amp;H2927&amp;, &amp;H28EA&amp;, &amp;H1FCC&amp;, &amp;H1F7D&amp;, &amp;H1F2A&amp;, &amp;H1ED7&amp;, &amp;H6CBA&amp;, &amp;H6B09&amp;, &amp;HA9C45C7, &amp;H89000000</td>
        </tr>
        <tr>
          <td id="L7461" data-line-number="7461"></td>
          <td id="LC7461">    pvAppendBuffer &amp;H4D89AC55, &amp;HB845C7B0, &amp;H11&amp;, &amp;H12BC45C7, &amp;H8B000000, &amp;HFF788584, &amp;H895FFFFF, &amp;H5D89F075, &amp;H45C75EE8, &amp;H1C0&amp;, &amp;HC445C700, &amp;H2&amp;, &amp;H3C845C7, &amp;HC7000000, &amp;H4CC45, &amp;H45C70000, &amp;H5D0&amp;, &amp;HD445C700, &amp;H6&amp;, &amp;H7D845C7, &amp;HC7000000, &amp;H8DC45, &amp;H45C70000, &amp;H9E0&amp;, &amp;HE445C700, &amp;HA&amp;, &amp;H89F45589, &amp;H448BF84D, &amp;H8B5BC085, &amp;H4C25DE5, &amp;HE800&amp;, &amp;H2D580000</td>
        </tr>
        <tr>
          <td id="L7462" data-line-number="7462"></td>
          <td id="LC7462">    pvAppendBuffer &amp;H4740FE, &amp;H47400005, &amp;HC3008B00, &amp;HE8&amp;, &amp;H112D5800, &amp;H5004741, &amp;H474000, &amp;HEC8B55C3, &amp;H5348EC83, &amp;H56105D8B, &amp;H565E046A, &amp;H74D0E853, &amp;HC0850000, &amp;H163850F, &amp;H56570000, &amp;H8D0C75FF, &amp;HE850D845, &amp;H7E77&amp;, &amp;H8D087D8B, &amp;H5056D845, &amp;HB8458D57, &amp;H7E38E850, &amp;H8D560000, &amp;H5050D845, &amp;H7E5AE8, &amp;HFF535600, &amp;H75FF0C75, &amp;H7E20E80C, &amp;H53560000, &amp;H7E45E853, &amp;HE8560000, &amp;HFFFFFF79</td>
        </tr>
        <tr>
          <td id="L7463" data-line-number="7463"></td>
          <td id="LC7463">    pvAppendBuffer &amp;H5010C083, &amp;HE8575753, &amp;H78B7&amp;, &amp;HFF67E856, &amp;HC083FFFF, &amp;H53535010, &amp;H78A5E853, &amp;HE8560000, &amp;HFFFFFF55, &amp;H5010C083, &amp;HE8535753, &amp;H7E39&amp;, &amp;H57575356, &amp;H7DD9E8, &amp;H3AE85600, &amp;H83FFFFFF, &amp;H575010C0, &amp;H78E85357, &amp;H56000078, &amp;HFFFF28E8, &amp;H10C083FF, &amp;H57575350, &amp;H7866E8, &amp;H57006A00, &amp;H823AE8, &amp;H56C20B00, &amp;HAE82574, &amp;H83FFFFFF, &amp;H575010C0, &amp;H730FE857, &amp;H46A0000, &amp;HE8F08B57</td>
        </tr>
        <tr>
          <td id="L7464" data-line-number="7464"></td>
          <td id="LC7464">    pvAppendBuffer &amp;H7FA6&amp;, &amp;H91FE6C1, &amp;H46A1C77, &amp;H5706EB5E, &amp;H7F95E8, &amp;H53575600, &amp;H7DA2E8, &amp;HD6E85600, &amp;H83FFFFFE, &amp;H8D5010C0, &amp;H5350B845, &amp;H7DB7E853, &amp;HE8560000, &amp;HFFFFFEC1, &amp;H5010C083, &amp;H50B8458D, &amp;HA2E85353, &amp;H5600007D, &amp;HFFFEACE8, &amp;H10C083FF, &amp;H458D5350, &amp;HE85050B8, &amp;H7D8D&amp;, &amp;HB8458D56, &amp;HE8575750, &amp;H7D2A&amp;, &amp;HFE8BE856, &amp;HC083FFFF, &amp;H458D5010, &amp;H505750D8, &amp;H7D6CE8, &amp;H57535600</td>
        </tr>
        <tr>
          <td id="L7465" data-line-number="7465"></td>
          <td id="LC7465">    pvAppendBuffer &amp;H7F6AE8, &amp;H75FF5600, &amp;H60E8530C, &amp;H5600007F, &amp;H50D8458D, &amp;HE80C75FF, &amp;H7F53&amp;, &amp;H8B5B5E5F, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H5368EC83, &amp;H56105D8B, &amp;H565E066A, &amp;H7348E853, &amp;HC0850000, &amp;H177850F, &amp;H56570000, &amp;H8D0C75FF, &amp;HE850C845, &amp;H7CEF&amp;, &amp;H8D087D8B, &amp;H5056C845, &amp;H98458D57, &amp;H7CB0E850, &amp;H8D560000, &amp;H5050C845, &amp;H7CD2E8, &amp;HFF535600, &amp;H75FF0C75, &amp;H7C98E80C, &amp;H53560000, &amp;H7CBDE853</td>
        </tr>
        <tr>
          <td id="L7466" data-line-number="7466"></td>
          <td id="LC7466">    pvAppendBuffer &amp;HE8560000, &amp;HFFFFFDF1, &amp;HB005&amp;, &amp;H57535000, &amp;H772DE857, &amp;HE8560000, &amp;HFFFFFDDD, &amp;HB005&amp;, &amp;H53535000, &amp;H7719E853, &amp;HE8560000, &amp;HFFFFFDC9, &amp;HB005&amp;, &amp;H57535000, &amp;H7CABE853, &amp;H53560000, &amp;H4BE85757, &amp;H5600007C, &amp;HFFFDACE8, &amp;HB005FF, &amp;H57500000, &amp;HE8E85357, &amp;H56000076, &amp;HFFFD98E8, &amp;HB005FF, &amp;H53500000, &amp;HD4E85757, &amp;H6A000076, &amp;HA8E85700, &amp;HB000080, &amp;H277456C2, &amp;HFFFD78E8</td>
        </tr>
        <tr>
          <td id="L7467" data-line-number="7467"></td>
          <td id="LC7467">    pvAppendBuffer &amp;HB005FF, &amp;H57500000, &amp;H717BE857, &amp;H66A0000, &amp;HE8F08B57, &amp;H7E12&amp;, &amp;H91FE6C1, &amp;H66A2C77, &amp;H5706EB5E, &amp;H7E01E8, &amp;H53575600, &amp;H7C0EE8, &amp;H42E85600, &amp;H5FFFFFD, &amp;HB0&amp;, &amp;H98458D50, &amp;HE8535350, &amp;H7C21&amp;, &amp;HFD2BE856, &amp;HB005FFFF, &amp;H50000000, &amp;H5098458D, &amp;HAE85353, &amp;H5600007C, &amp;HFFFD14E8, &amp;HB005FF, &amp;H53500000, &amp;H5098458D, &amp;H7BF3E850, &amp;H8D560000, &amp;H57509845, &amp;H7B90E857</td>
        </tr>
        <tr>
          <td id="L7468" data-line-number="7468"></td>
          <td id="LC7468">    pvAppendBuffer &amp;HE8560000, &amp;HFFFFFCF1, &amp;HB005&amp;, &amp;H458D5000, &amp;H505750C8, &amp;H7BD0E8, &amp;H57535600, &amp;H7DCEE8, &amp;H75FF5600, &amp;HC4E8530C, &amp;H5600007D, &amp;H50C8458D, &amp;HE80C75FF, &amp;H7DB7&amp;, &amp;H8B5B5E5F, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H8758B56, &amp;HE856046A, &amp;H71B2&amp;, &amp;H1474C085, &amp;H468D046A, &amp;HA3E85020, &amp;H85000071, &amp;H330574C0, &amp;H2EB40C0, &amp;H5D5EC033, &amp;H550004C2, &amp;H8B56EC8B, &amp;H66A0875, &amp;H7184E856, &amp;HC0850000</td>
        </tr>
        <tr>
          <td id="L7469" data-line-number="7469"></td>
          <td id="LC7469">    pvAppendBuffer &amp;H66A1474, &amp;H5030468D, &amp;H7175E8, &amp;H74C08500, &amp;H40C03305, &amp;HC03302EB, &amp;H4C25D5E, &amp;HEC8B5500, &amp;HA8EC81, &amp;H8B530000, &amp;H458D0C5D, &amp;H6A5756B8, &amp;HE8505304, &amp;H7D37&amp;, &amp;H6A20438D, &amp;H45895004, &amp;H78858DF8, &amp;H50FFFFFF, &amp;H7D22E8, &amp;H1475FF00, &amp;HFF58858D, &amp;H8D50FFFF, &amp;H8D509845, &amp;HFFFF7885, &amp;H458D50FF, &amp;H82E850B8, &amp;H6A000008, &amp;H1075FF04, &amp;H7C54E8, &amp;H83F63300, &amp;H894602E8, &amp;HC0851445</td>
        </tr>
        <tr>
          <td id="L7470" data-line-number="7470"></td>
          <td id="LC7470">    pvAppendBuffer &amp;HFF50577E, &amp;H14E81075, &amp;HB00007F, &amp;H8B0475C2, &amp;H3302EBCE, &amp;H5E1C1C9, &amp;HFF589D8D, &amp;HD903FFFF, &amp;H398458D, &amp;H78B58DC1, &amp;H53FFFFFF, &amp;H4589D9F7, &amp;HF10350FC, &amp;H3B87D8D, &amp;HE85756F9, &amp;H4F3&amp;, &amp;HFF535756, &amp;HBBE8FC75, &amp;H8B000002, &amp;H89481445, &amp;H16A1445, &amp;H7FC0855E, &amp;HFF006AA9, &amp;HBCE81075, &amp;HB00007E, &amp;H330274C2, &amp;H5E6C1F6, &amp;HFF589D8D, &amp;HDE03FFFF, &amp;H53107589, &amp;H398458D, &amp;H78BD8DC6</td>
        </tr>
        <tr>
          <td id="L7471" data-line-number="7471"></td>
          <td id="LC7471">    pvAppendBuffer &amp;H2BFFFFFF, &amp;HB8758DFE, &amp;H5010752B, &amp;HA0E85657, &amp;H6A000004, &amp;HFB5FE804, &amp;HC083FFFF, &amp;H458D5010, &amp;H458D5098, &amp;H458D50B8, &amp;H3AE850D8, &amp;H6A00007A, &amp;H458D5704, &amp;HE85050D8, &amp;H79D6&amp;, &amp;H75FF046A, &amp;HD8458D0C, &amp;HC7E85050, &amp;H6A000079, &amp;HFB27E804, &amp;HC083FFFF, &amp;H458D5010, &amp;HE85050D8, &amp;H74A2&amp;, &amp;H75FF046A, &amp;HD8458DF8, &amp;HA3E85050, &amp;H6A000079, &amp;H458D5604, &amp;HE85050D8, &amp;H7996&amp;, &amp;H458D5657</td>
        </tr>
        <tr>
          <td id="L7472" data-line-number="7472"></td>
          <td id="LC7472">    pvAppendBuffer &amp;H10450398, &amp;HFBE85053, &amp;H8D000001, &amp;H8D50D845, &amp;HFFFF5885, &amp;H458D50FF, &amp;H52E85098, &amp;H8B00000A, &amp;H458D0875, &amp;H50046A98, &amp;H7BC1E856, &amp;H46A0000, &amp;HFF58858D, &amp;H8D50FFFF, &amp;HE8502046, &amp;H7BAF&amp;, &amp;H8B5B5E5F, &amp;H10C25DE5, &amp;HEC8B5500, &amp;HF8EC81, &amp;H8B530000, &amp;H458D0C5D, &amp;H6A575698, &amp;HE8505306, &amp;H7B8B&amp;, &amp;H6A30438D, &amp;H45895006, &amp;H38858DF8, &amp;H50FFFFFF, &amp;H7B76E8, &amp;H1475FF00, &amp;HFF08858D</td>
        </tr>
        <tr>
          <td id="L7473" data-line-number="7473"></td>
          <td id="LC7473">    pvAppendBuffer &amp;H8D50FFFF, &amp;HFFFF6885, &amp;H858D50FF, &amp;HFFFFFF38, &amp;H98458D50, &amp;H74DE850, &amp;H66A0000, &amp;HE81075FF, &amp;H7AA5&amp;, &amp;HE883DB33, &amp;H45894302, &amp;H7EC08514, &amp;H75FF505A, &amp;H7D65E810, &amp;HC20B0000, &amp;HC38B0475, &amp;HC03302EB, &amp;H8D30C06B, &amp;HFFFF089D, &amp;H688D8DFF, &amp;H8DFFFFFF, &amp;HFFFF38B5, &amp;H987D8DFF, &amp;HC803D803, &amp;H89D8F753, &amp;H351FC4D, &amp;H56F803F0, &amp;H4CCE857, &amp;H57560000, &amp;HFC75FF53, &amp;H219E8, &amp;H14458B00</td>
        </tr>
        <tr>
          <td id="L7474" data-line-number="7474"></td>
          <td id="LC7474">    pvAppendBuffer &amp;H14458948, &amp;H855B016A, &amp;H6AA67FC0, &amp;H1075FF00, &amp;H7D0AE8, &amp;H74C20B00, &amp;H6BDB3302, &amp;H8D8D30C3, &amp;HFFFFFF68, &amp;HFF089D8D, &amp;HBD8DFFFF, &amp;HFFFFFF38, &amp;H398758D, &amp;H53C803D8, &amp;H89F82B51, &amp;HF02B104D, &amp;H77E85657, &amp;H6A000004, &amp;HF9ABE806, &amp;HB005FFFF, &amp;H50000000, &amp;HFF68858D, &amp;H8D50FFFF, &amp;H8D509845, &amp;HE850C845, &amp;H7881&amp;, &amp;H8D57066A, &amp;H5050C845, &amp;H781DE8, &amp;HFF066A00, &amp;H458D0C75, &amp;HE85050C8</td>
        </tr>
        <tr>
          <td id="L7475" data-line-number="7475"></td>
          <td id="LC7475">    pvAppendBuffer &amp;H780E&amp;, &amp;H6EE8066A, &amp;H5FFFFF9, &amp;HB0&amp;, &amp;HC8458D50, &amp;HE7E85050, &amp;H6A000072, &amp;HF875FF06, &amp;H50C8458D, &amp;H77E8E850, &amp;H66A0000, &amp;HC8458D56, &amp;HDBE85050, &amp;H57000077, &amp;H75FF5356, &amp;H154E810, &amp;H458D0000, &amp;H858D50C8, &amp;HFFFFFF08, &amp;H68858D50, &amp;H50FFFFFF, &amp;H8E3E8, &amp;H8758B00, &amp;HFF68858D, &amp;H66AFFFF, &amp;H4E85650, &amp;H6A00007A, &amp;H8858D06, &amp;H50FFFFFF, &amp;H5030468D, &amp;H79F2E8, &amp;H5B5E5F00</td>
        </tr>
        <tr>
          <td id="L7476" data-line-number="7476"></td>
          <td id="LC7476">    pvAppendBuffer &amp;HC25DE58B, &amp;H8B550010, &amp;H20EC83EC, &amp;H6A575653, &amp;HE8565E04, &amp;HFFFFF8E1, &amp;H83085D8B, &amp;H535010C0, &amp;H8D1075FF, &amp;HE850E045, &amp;H77BD&amp;, &amp;HE0458D56, &amp;H88E85050, &amp;H56000077, &amp;H50E0458D, &amp;H4FE85353, &amp;H56000077, &amp;H50E0458D, &amp;HFF1075FF, &amp;H3FE81075, &amp;H56000077, &amp;HFFF8A0E8, &amp;HC758BFF, &amp;H8B10C083, &amp;H5650147D, &amp;H7EE85757, &amp;H6A000077, &amp;H458D5704, &amp;H48E850E0, &amp;H6A000077, &amp;HF87BE804, &amp;HC083FFFF</td>
        </tr>
        <tr>
          <td id="L7477" data-line-number="7477"></td>
          <td id="LC7477">    pvAppendBuffer &amp;H8D535010, &amp;H5050E045, &amp;H775CE8, &amp;HE8046A00, &amp;HFFFFF865, &amp;H5010C083, &amp;H8D1075FF, &amp;H5050E045, &amp;H7744E8, &amp;HE8046A00, &amp;HFFFFF84D, &amp;H5010C083, &amp;H1075FF53, &amp;HE81075FF, &amp;H772D&amp;, &amp;H75FF046A, &amp;HE8565610, &amp;H76CA&amp;, &amp;H2AE8046A, &amp;H83FFFFF8, &amp;H8D5010C0, &amp;H5350E045, &amp;HE81075FF, &amp;H7709&amp;, &amp;H75FF046A, &amp;HE8575710, &amp;H76A6&amp;, &amp;H6E8046A, &amp;H83FFFFF8, &amp;H565010C0, &amp;HEAE85757, &amp;H6A000076</td>
        </tr>
        <tr>
          <td id="L7478" data-line-number="7478"></td>
          <td id="LC7478">    pvAppendBuffer &amp;HE0458D04, &amp;H1075FF50, &amp;H78E2E8, &amp;H5B5E5F00, &amp;HC25DE58B, &amp;H8B550010, &amp;H30EC83EC, &amp;H6A575653, &amp;HE8575F06, &amp;HFFFFF7D1, &amp;HBE085D8B, &amp;HB0&amp;, &amp;H5350C603, &amp;H8D1075FF, &amp;HE850D045, &amp;H76A9&amp;, &amp;HD0458D57, &amp;H74E85050, &amp;H57000076, &amp;H50D0458D, &amp;H3BE85353, &amp;H57000076, &amp;H50D0458D, &amp;HFF1075FF, &amp;H2BE81075, &amp;H57000076, &amp;HFFF78CE8, &amp;H147D8BFF, &amp;H758BC603, &amp;H5756500C, &amp;H766BE857, &amp;H66A0000</td>
        </tr>
        <tr>
          <td id="L7479" data-line-number="7479"></td>
          <td id="LC7479">    pvAppendBuffer &amp;HD0458D57, &amp;H7635E850, &amp;H66A0000, &amp;HFFF768E8, &amp;HB005FF, &amp;H53500000, &amp;H50D0458D, &amp;H7647E850, &amp;H66A0000, &amp;HFFF750E8, &amp;HB005FF, &amp;HFF500000, &amp;H458D1075, &amp;HE85050D0, &amp;H762D&amp;, &amp;H36E8066A, &amp;H5FFFFF7, &amp;HB0&amp;, &amp;H75FF5350, &amp;H1075FF10, &amp;H7614E8, &amp;HFF066A00, &amp;H56561075, &amp;H75B1E8, &amp;HE8066A00, &amp;HFFFFF711, &amp;HB005&amp;, &amp;H458D5000, &amp;HFF5350D0, &amp;HEEE81075, &amp;H6A000075, &amp;H1075FF06</td>
        </tr>
        <tr>
          <td id="L7480" data-line-number="7480"></td>
          <td id="LC7480">    pvAppendBuffer &amp;H8BE85757, &amp;H6A000075, &amp;HF6EBE806, &amp;HB005FFFF, &amp;H50000000, &amp;HE8575756, &amp;H75CD&amp;, &amp;H458D066A, &amp;H75FF50D0, &amp;H77C5E810, &amp;H5E5F0000, &amp;H5DE58B5B, &amp;H550010C2, &amp;HEC83EC8B, &amp;H57565360, &amp;H535B046A, &amp;HFFF6B4E8, &amp;H107D8BFF, &amp;H5010C083, &amp;H8D0875FF, &amp;H5057C045, &amp;H7590E8, &amp;H458D5300, &amp;HE85050C0, &amp;H755B&amp;, &amp;HC0458D53, &amp;H875FF50, &amp;HE80875FF, &amp;H751E&amp;, &amp;HC0458D53, &amp;HE8575750, &amp;H7512&amp;</td>
        </tr>
        <tr>
          <td id="L7481" data-line-number="7481"></td>
          <td id="LC7481">    pvAppendBuffer &amp;HF673E853, &amp;H5D8BFFFF, &amp;H10C0830C, &amp;H5014758B, &amp;H458D5653, &amp;HA8E850C0, &amp;H6A00006F, &amp;HF657E804, &amp;HC083FFFF, &amp;H56535010, &amp;H753BE856, &amp;H46A0000, &amp;HFFF644E8, &amp;H10C083FF, &amp;H875FF50, &amp;H57E0458D, &amp;H7523E850, &amp;H46A0000, &amp;H50E0458D, &amp;HBFE85353, &amp;H6A000074, &amp;HF61FE804, &amp;HC083FFFF, &amp;HFF575010, &amp;H458D0875, &amp;H58E850E0, &amp;H6A00006F, &amp;HE8575604, &amp;H74CB&amp;, &amp;HFEE8046A, &amp;H83FFFFF5, &amp;H8D5010C0</td>
        </tr>
        <tr>
          <td id="L7482" data-line-number="7482"></td>
          <td id="LC7482">    pvAppendBuffer &amp;H5750E045, &amp;H74DFE857, &amp;H46A0000, &amp;HFFF5E8E8, &amp;H10C083FF, &amp;H75FF5750, &amp;HA0458D08, &amp;H74C7E850, &amp;H46A0000, &amp;H50A0458D, &amp;H63E85656, &amp;H6A000074, &amp;HF5C3E804, &amp;H106AFFFF, &amp;H50C7035F, &amp;HE8565653, &amp;H74A5&amp;, &amp;H565E046A, &amp;H50C0458D, &amp;H50A0458D, &amp;H746AE8, &amp;H9EE85600, &amp;H3FFFFF5, &amp;H458D50C7, &amp;H458D50E0, &amp;HE85050A0, &amp;H747D&amp;, &amp;HF587E856, &amp;HC703FFFF, &amp;H875FF50, &amp;H50A0458D, &amp;H50E0458D</td>
        </tr>
        <tr>
          <td id="L7483" data-line-number="7483"></td>
          <td id="LC7483">    pvAppendBuffer &amp;H7464E8, &amp;H458D5600, &amp;H458D50C0, &amp;HE85050E0, &amp;H73FE&amp;, &amp;HF55FE856, &amp;HC703FFFF, &amp;H458D5350, &amp;HE85350E0, &amp;H7441&amp;, &amp;HA0458D56, &amp;H875FF50, &amp;H763AE8, &amp;H5B5E5F00, &amp;HC25DE58B, &amp;H8B550010, &amp;H90EC81EC, &amp;H53000000, &amp;H66A5756, &amp;H26E8565E, &amp;H8BFFFFF5, &amp;HB0BB107D, &amp;H3000000, &amp;H75FF50C3, &amp;HA0458D08, &amp;HFEE85057, &amp;H56000073, &amp;H50A0458D, &amp;H73C9E850, &amp;H8D560000, &amp;HFF50A045, &amp;H75FF0875</td>
        </tr>
        <tr>
          <td id="L7484" data-line-number="7484"></td>
          <td id="LC7484">    pvAppendBuffer &amp;H738CE808, &amp;H8D560000, &amp;H5750A045, &amp;H7380E857, &amp;HE8560000, &amp;HFFFFF4E1, &amp;H314758B, &amp;HC5D8BC3, &amp;H8D565350, &amp;HE850A045, &amp;H6E17&amp;, &amp;HC6E8066A, &amp;H5FFFFF4, &amp;HB0&amp;, &amp;H56565350, &amp;H73A8E8, &amp;HE8066A00, &amp;HFFFFF4B1, &amp;HB005&amp;, &amp;H75FF5000, &amp;HD0458D08, &amp;H8EE85057, &amp;H6A000073, &amp;HD0458D06, &amp;HE8535350, &amp;H732A&amp;, &amp;H8AE8066A, &amp;H5FFFFF4, &amp;HB0&amp;, &amp;H75FF5750, &amp;HD0458D08, &amp;H6DC1E850</td>
        </tr>
        <tr>
          <td id="L7485" data-line-number="7485"></td>
          <td id="LC7485">    pvAppendBuffer &amp;H66A0000, &amp;H34E85756, &amp;H6A000073, &amp;HF467E806, &amp;HB005FFFF, &amp;H50000000, &amp;H50D0458D, &amp;H46E85757, &amp;H6A000073, &amp;HF44FE806, &amp;HB005FFFF, &amp;H50000000, &amp;H875FF57, &amp;HFF70858D, &amp;HE850FFFF, &amp;H7329&amp;, &amp;H858D066A, &amp;HFFFFFF70, &amp;HE8565650, &amp;H72C2&amp;, &amp;H22E8066A, &amp;HBFFFFFF4, &amp;HB0&amp;, &amp;H5350C703, &amp;H2E85656, &amp;H6A000073, &amp;H8D565E06, &amp;H8D50A045, &amp;HFFFF7085, &amp;HC4E850FF, &amp;H56000072, &amp;HFFF3F8E8</td>
        </tr>
        <tr>
          <td id="L7486" data-line-number="7486"></td>
          <td id="LC7486">    pvAppendBuffer &amp;H50C703FF, &amp;H50D0458D, &amp;HFF70858D, &amp;H5050FFFF, &amp;H72D4E8, &amp;HDEE85600, &amp;H3FFFFF3, &amp;H75FF50C7, &amp;H70858D08, &amp;H50FFFFFF, &amp;H50D0458D, &amp;H72B8E8, &amp;H458D5600, &amp;H458D50A0, &amp;HE85050D0, &amp;H7252&amp;, &amp;HF3B3E856, &amp;HC703FFFF, &amp;H458D5350, &amp;HE85350D0, &amp;H7295&amp;, &amp;H70858D56, &amp;H50FFFFFF, &amp;HE80875FF, &amp;H748B&amp;, &amp;H8B5B5E5F, &amp;H10C25DE5, &amp;HEC8B5500, &amp;H6A20EC83, &amp;H875FF04, &amp;HE81075FF, &amp;H746F&amp;</td>
        </tr>
        <tr>
          <td id="L7487" data-line-number="7487"></td>
          <td id="LC7487">    pvAppendBuffer &amp;H75FF046A, &amp;H1475FF0C, &amp;H7462E8, &amp;H8D046A00, &amp;HE850E045, &amp;H67EE&amp;, &amp;HE46583, &amp;H187D83, &amp;H1E045C7, &amp;H74000000, &amp;HFF046A0B, &amp;HE8501875, &amp;H743B&amp;, &amp;H50E0458D, &amp;HFF0C75FF, &amp;HAEE80875, &amp;H8D000002, &amp;HFF50E045, &amp;H75FF0C75, &amp;HF34BE808, &amp;H458DFFFF, &amp;H75FF50E0, &amp;H1075FF14, &amp;H290E8, &amp;H5DE58B00, &amp;H550014C2, &amp;HEC83EC8B, &amp;HFF066A30, &amp;H75FF0875, &amp;H73F5E810, &amp;H66A0000, &amp;HFF0C75FF</td>
        </tr>
        <tr>
          <td id="L7488" data-line-number="7488"></td>
          <td id="LC7488">    pvAppendBuffer &amp;HE8E81475, &amp;H6A000073, &amp;HD0458D06, &amp;H6774E850, &amp;H65830000, &amp;H7D8300D4, &amp;H45C70018, &amp;H1D0&amp;, &amp;H6A0B7400, &amp;H1875FF06, &amp;H73C1E850, &amp;H458D0000, &amp;H75FF50D0, &amp;H875FF0C, &amp;H27FE8, &amp;HD0458D00, &amp;HC75FF50, &amp;HE80875FF, &amp;HFFFFF459, &amp;H50D0458D, &amp;HFF1475FF, &amp;H61E81075, &amp;H8B000002, &amp;H14C25DE5, &amp;H448B5300, &amp;H4C8B0C24, &amp;HE1F71024, &amp;H448BD88B, &amp;H64F70824, &amp;HD8031424, &amp;H824448B, &amp;HD303E1F7</td>
        </tr>
        <tr>
          <td id="L7489" data-line-number="7489"></td>
          <td id="LC7489">    pvAppendBuffer &amp;H10C25B, &amp;H7340F980, &amp;H20F98015, &amp;HA50F0673, &amp;HC3E0D3C2, &amp;HC033D08B, &amp;HD31FE180, &amp;HC033C3E2, &amp;H80C3D233, &amp;H157340F9, &amp;H7320F980, &amp;HD0AD0F06, &amp;H8BC3EAD3, &amp;H80D233C2, &amp;HE8D31FE1, &amp;H33C033C3, &amp;H8B55C3D2, &amp;H10558BEC, &amp;H758B5653, &amp;H7D8B570C, &amp;H6AF22B08, &amp;H5BFA2B10, &amp;H3160C8B, &amp;H16448B0A, &amp;H4421304, &amp;H8D170C89, &amp;H44890852, &amp;HEB83FC17, &amp;H5FE57501, &amp;HC25D5B5E, &amp;H8B55000C, &amp;H1C558BEC</td>
        </tr>
        <tr>
          <td id="L7490" data-line-number="7490"></td>
          <td id="LC7490">    pvAppendBuffer &amp;H5620458B, &amp;H5708758B, &amp;H30C7D8B, &amp;H104513D7, &amp;H46891689, &amp;H10453B04, &amp;H4720D77, &amp;H773D73B, &amp;H3340C033, &amp;H3304EBC9, &amp;H3C88BC0, &amp;H135F2445, &amp;H4503284D, &amp;H8468914, &amp;H4D13C68B, &amp;HC4E8918, &amp;H24C25D5E, &amp;HEC8B5500, &amp;H8B0C558B, &amp;H28B084D, &amp;H428B0131, &amp;H4413104, &amp;H3108428B, &amp;H428B0841, &amp;HC41310C, &amp;H8C25D, &amp;H83EC8B55, &amp;H4D8B0CEC, &amp;H8B565308, &amp;H18B1075, &amp;HC104C183, &amp;H335702EE</td>
        </tr>
        <tr>
          <td id="L7491" data-line-number="7491"></td>
          <td id="LC7491">    pvAppendBuffer &amp;H107589FF, &amp;H8DFC4D89, &amp;H48504, &amp;H45890000, &amp;H74F685F8, &amp;HC4D292C, &amp;H7589D98B, &amp;HC758B08, &amp;H8D087D8B, &amp;HE8501E04, &amp;H5A48&amp;, &amp;H5B8D0389, &amp;H1EF8304, &amp;H758BED75, &amp;H8BFE8B10, &amp;H458BFC4D, &amp;HC7DB33F8, &amp;H10845, &amp;HF83B0000, &amp;H96830F, &amp;HC78B0000, &amp;H48DC62B, &amp;H10458981, &amp;HFCB9548B, &amp;H3B0C5589, &amp;HFF0575DE, &amp;HDB330845, &amp;H3475DB85, &amp;HFFF104E8, &amp;H58805FF, &amp;H8B500000, &amp;HC0C10C45</td>
        </tr>
        <tr>
          <td id="L7492" data-line-number="7492"></td>
          <td id="LC7492">    pvAppendBuffer &amp;H70E85008, &amp;H89000064, &amp;HEAE80C45, &amp;H8BFFFFF0, &amp;H558B084D, &amp;H84B60F0C, &amp;H68808, &amp;H18E0C100, &amp;H20EBD033, &amp;H7606FE83, &amp;H4FB831E, &amp;HC6E81975, &amp;H5FFFFF0, &amp;H588&amp;, &amp;HC458B50, &amp;H6435E850, &amp;HD08B0000, &amp;H8B10458B, &amp;HFC458B08, &amp;HC89CA33, &amp;H458B47B8, &amp;HFC4D8B10, &amp;H4304C083, &amp;H3B104589, &amp;H820FF87D, &amp;HFFFFFF74, &amp;H8B5B5E5F, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H8D20EC83, &amp;H46AE045, &amp;H501075FF</td>
        </tr>
        <tr>
          <td id="L7493" data-line-number="7493"></td>
          <td id="LC7493">    pvAppendBuffer &amp;H6F3AE8, &amp;H8D046A00, &amp;HFF50E045, &amp;H75FF0875, &amp;H6EFCE808, &amp;H46A0000, &amp;H8D1075FF, &amp;H5050E045, &amp;H6EEDE8, &amp;H8D046A00, &amp;HFF50E045, &amp;H75FF0C75, &amp;H6EDCE80C, &amp;HE58B0000, &amp;HCC25D, &amp;H83EC8B55, &amp;H458D30EC, &amp;HFF066AD0, &amp;HE8501075, &amp;H6EEF&amp;, &amp;H458D066A, &amp;H75FF50D0, &amp;H875FF08, &amp;H6EB1E8, &amp;HFF066A00, &amp;H458D1075, &amp;HE85050D0, &amp;H6EA2&amp;, &amp;H458D066A, &amp;H75FF50D0, &amp;HC75FF0C, &amp;H6E91E8</td>
        </tr>
        <tr>
          <td id="L7494" data-line-number="7494"></td>
          <td id="LC7494">    pvAppendBuffer &amp;H5DE58B00, &amp;H55000CC2, &amp;HEC83EC8B, &amp;H8B565318, &amp;H8B570C75, &amp;H78B087D, &amp;H27F063B, &amp;H588D068B, &amp;H5D895301, &amp;H524DE8EC, &amp;HD08B0000, &amp;HC033C933, &amp;H21E85589, &amp;H2141F845, &amp;H4589F445, &amp;H7CD93BFC, &amp;H8DC78B67, &amp;HC62B045E, &amp;H5589D62B, &amp;H3BD08BF0, &amp;H8B057F0F, &amp;H2EB1A3C, &amp;HE3BFF33, &amp;H38B077F, &amp;HEB0C4589, &amp;HC658304, &amp;H1C03300, &amp;H7D8B0C7D, &amp;H1C013F8, &amp;H7D8B0C7D, &amp;HF44513F0, &amp;HF46583</td>
        </tr>
        <tr>
          <td id="L7495" data-line-number="7495"></td>
          <td id="LC7495">    pvAppendBuffer &amp;H8BF84589, &amp;HC0850C45, &amp;H8B1F0489, &amp;H458B087D, &amp;H3B0974FC, &amp;H8B057EC8, &amp;HFC4589C1, &amp;H4C38341, &amp;H7EEC4D3B, &amp;HE8558BAA, &amp;H2895E5F, &amp;H8B5BC28B, &amp;H8C25DE5, &amp;HEC8B5500, &amp;H5310EC83, &amp;H7D8B5756, &amp;H8B378B0C, &amp;H2E3C1DE, &amp;H89F87589, &amp;H26E8F05D, &amp;H53FFFFEF, &amp;HD08B10FF, &amp;H5589C933, &amp;H7EF6850C, &amp;H2B078B0F, &amp;H87048BC1, &amp;H418A0489, &amp;HF17CCE3B, &amp;H8B085D8B, &amp;H7FDE3B1B, &amp;H15E8D03, &amp;HE7C1FB8B</td>
        </tr>
        <tr>
          <td id="L7496" data-line-number="7496"></td>
          <td id="LC7496">    pvAppendBuffer &amp;HFC7D8902, &amp;HFFEEF0E8, &amp;H10FF57FF, &amp;H5589D08B, &amp;H7EDB85F4, &amp;H33CB8B08, &amp;HF3FA8BC0, &amp;H84D8BAB, &amp;H3947FF33, &amp;H8B1C7C39, &amp;HFCC283C3, &amp;H8B02E0C1, &amp;H8BD003F7, &amp;H8946B104, &amp;HFC528D02, &amp;HF37E313B, &amp;H8BF8758B, &amp;H8B0C45, &amp;H8458950, &amp;H4F7E8, &amp;H8558B00, &amp;H85F84589, &amp;H8B1A74C0, &amp;H3BE2D3C8, &amp;H6A127EF7, &amp;HC82B5920, &amp;H8B0C458B, &amp;HE8D30440, &amp;H458BD00B, &amp;HE85250F8, &amp;H57C8&amp;, &amp;H1475FF50</td>
        </tr>
        <tr>
          <td id="L7497" data-line-number="7497"></td>
          <td id="LC7497">    pvAppendBuffer &amp;HC75FF56, &amp;H53F4758B, &amp;H3A22E856, &amp;H458B0000, &amp;H74C08510, &amp;H7C383923, &amp;HFC4D8B1F, &amp;HFCC1834B, &amp;HDB85CE03, &amp;H118B0478, &amp;HD23302EB, &amp;H83B81489, &amp;H4B4704E9, &amp;HEA7E383B, &amp;H8BF075FF, &amp;HE8530C5D, &amp;H60EB&amp;, &amp;HFFEE30E8, &amp;H50FF53FF, &amp;HFC75FF08, &amp;H60D9E856, &amp;H1EE80000, &amp;H56FFFFEE, &amp;H5F0850FF, &amp;HE58B5B5E, &amp;H10C25D, &amp;H56EC8B55, &amp;H570C758B, &amp;H80E836FF, &amp;H6A000050, &amp;H57F88B00, &amp;H875FF56</td>
        </tr>
        <tr>
          <td id="L7498" data-line-number="7498"></td>
          <td id="LC7498">    pvAppendBuffer &amp;HFFFEB0E8, &amp;H13F83FF, &amp;H78B1076, &amp;H873C83, &amp;H89480875, &amp;H1F88307, &amp;HC78BF077, &amp;HC25D5E5F, &amp;H8B550008, &amp;HFF006AEC, &amp;H75FF0C75, &amp;H4E808, &amp;HC25D0000, &amp;H8B550008, &amp;H20EC83EC, &amp;H85D8B53, &amp;HC758B56, &amp;H8B1B8B57, &amp;HE45D89FB, &amp;H4589068B, &amp;H7FD83BE0, &amp;H57F88B02, &amp;H4FF6E8, &amp;HC1CF8B00, &amp;HC10302E1, &amp;H8902E0C1, &amp;H8AE8EC45, &amp;HFFFFFFED, &amp;H10FFEC75, &amp;HF06583, &amp;H4D89C88B, &amp;H7EFF85F8</td>
        </tr>
        <tr>
          <td id="L7499" data-line-number="7499"></td>
          <td id="LC7499">    pvAppendBuffer &amp;H8BC78B6E, &amp;H2E0C1D7, &amp;H3081C8D, &amp;HFC5D89C6, &amp;H8BF44589, &amp;HD88B0845, &amp;H5D89DE2B, &amp;HF45D8BE8, &amp;HB7F103B, &amp;H8BE8458B, &amp;H45891804, &amp;H8304EBF4, &amp;H8B00F465, &amp;H758BF045, &amp;H813489F4, &amp;H3B0C758B, &amp;H8B077F16, &amp;HF44D890B, &amp;H658304EB, &amp;H4D8B00F4, &amp;H458340FC, &amp;HEB8304FC, &amp;HF4758B04, &amp;HF045894A, &amp;H458BC73B, &amp;H8B318908, &amp;HB47CF84D, &amp;H8BE45D8B, &amp;H4E0C1C7, &amp;H8950C103, &amp;H48D0845, &amp;H8B5057F9</td>
        </tr>
        <tr>
          <td id="L7500" data-line-number="7500"></td>
          <td id="LC7500">    pvAppendBuffer &amp;H2E0C1C7, &amp;H5150C103, &amp;H3B3FE8, &amp;HE0458B00, &amp;H8BD80340, &amp;H5D891045, &amp;H74C0850C, &amp;H3B008B0C, &amp;H8D067FD8, &amp;H5D890158, &amp;H48E8530C, &amp;H8B00004F, &amp;H41C933F0, &amp;HC18BD233, &amp;H2A7C0E39, &amp;H8D085D8B, &amp;HC3833F0C, &amp;H7FC13BFC, &amp;HEB3B8B04, &amp;H89FF3302, &amp;HFF85863C, &amp;HD08B0274, &amp;H4EB8340, &amp;HE57E063B, &amp;H330C5D8B, &amp;H458B41C9, &amp;H85168910, &amp;H836274C0, &amp;H8300F065, &amp;H3B00F465, &amp;H8B567CD9, &amp;H45E8DF8</td>
        </tr>
        <tr>
          <td id="L7501" data-line-number="7501"></td>
          <td id="LC7501">    pvAppendBuffer &amp;H7D89FE2B, &amp;H7F0E3BFC, &amp;H893B8B0A, &amp;H7D8B087D, &amp;H8304EBFC, &amp;H3B000865, &amp;H8B057F08, &amp;H2EB1F3C, &amp;HC033FF33, &amp;H13087D03, &amp;HF07D03C0, &amp;H45133B89, &amp;HF46583F4, &amp;HF0458900, &amp;H674FF85, &amp;H27ECA3B, &amp;H458BD18B, &amp;H7D8B4110, &amp;H4C383FC, &amp;H7E0C4D3B, &amp;HEC75FFB4, &amp;H57F87D8B, &amp;HD0E81689, &amp;HE800005E, &amp;HFFFFEC15, &amp;H850FF57, &amp;H5EC68B5F, &amp;H5DE58B5B, &amp;H55000CC2, &amp;H4D8BEC8B, &amp;HC985560C, &amp;H758B3278</td>
        </tr>
        <tr>
          <td id="L7502" data-line-number="7502"></td>
          <td id="LC7502">    pvAppendBuffer &amp;HC1068B08, &amp;HC83B02E0, &amp;HC18B267D, &amp;H3E28399, &amp;HF8C1C203, &amp;H3E18102, &amp;H79800000, &amp;HC9834905, &amp;H448B41FC, &amp;HE1C10486, &amp;HFE8D303, &amp;H2EBC0B6, &amp;H5D5EC033, &amp;H550008C2, &amp;H5653EC8B, &amp;H570C758B, &amp;H8B087D8B, &amp;H830F8B16, &amp;H97501F9, &amp;HF704478B, &amp;H23C01BD8, &amp;H1FA83C8, &amp;H468B0975, &amp;H1BD8F704, &amp;H8BD023C0, &amp;H7FCA3BC1, &amp;H85C28B02, &amp;H8D3174C0, &amp;HFE2B861C, &amp;H67EC13B, &amp;H86583, &amp;H348B06EB</td>
        </tr>
        <tr>
          <td id="L7503" data-line-number="7503"></td>
          <td id="LC7503">    pvAppendBuffer &amp;H875891F, &amp;H47EC23B, &amp;H7EBF633, &amp;H7539338B, &amp;H391B7208, &amp;H11770875, &amp;H8304EB83, &amp;HD47501E8, &amp;H5E5FC033, &amp;H8C25D5B, &amp;H40C03300, &amp;HC883F4EB, &amp;H55EFEBFF, &amp;H8B53EC8B, &amp;H57560C5D, &amp;H9903438D, &amp;H8D03E283, &amp;HFFC1023C, &amp;H7D895702, &amp;H4DA5E80C, &amp;HF08B0000, &amp;H7C01FF83, &amp;HC4D8B0A, &amp;H33047E8D, &amp;H85ABF3C0, &amp;H8B3A74DB, &amp;H3E7C1FB, &amp;H4B084D8B, &amp;H8A08EF83, &amp;H4D894101, &amp;H85D38B08, &amp;H830379D2</td>
        </tr>
        <tr>
          <td id="L7504" data-line-number="7504"></td>
          <td id="LC7504">    pvAppendBuffer &amp;HFAC103C2, &amp;H81CF8B02, &amp;H1FE1&amp;, &amp;H49057980, &amp;H41E0C983, &amp;HD3C0B60F, &amp;H964409E0, &amp;H75DB8504, &amp;H13E83CB, &amp;H68B1076, &amp;H863C83, &amp;H89480875, &amp;H1F88306, &amp;H8B5FF077, &amp;H5D5B5EC6, &amp;H550008C2, &amp;H4D8BEC8B, &amp;H78C9850C, &amp;H758B563D, &amp;HC1068B08, &amp;HC83B05E0, &amp;HC18B2F7D, &amp;H1FE28399, &amp;HF8C1C203, &amp;H1FE18105, &amp;H79800000, &amp;HC9834905, &amp;HD23341E0, &amp;H83E2D342, &amp;H7400107D, &amp;H86540906, &amp;HF706EB04</td>
        </tr>
        <tr>
          <td id="L7505" data-line-number="7505"></td>
          <td id="LC7505">    pvAppendBuffer &amp;H865421D2, &amp;HC25D5E04, &amp;H8B55000C, &amp;H18EC83EC, &amp;H85D8B53, &amp;H7D8B5756, &amp;H3B338B0C, &amp;H8B027F37, &amp;HD0E85637, &amp;H8300004C, &amp;H8B00F065, &amp;H89C033D0, &amp;H8B40E855, &amp;H7CF03BC8, &amp;HF8558971, &amp;H2904478D, &amp;HD233F87D, &amp;H29FC5D89, &amp;H8942FC7D, &amp;HB3BF445, &amp;H5D8B0B7F, &amp;H31C8BFC, &amp;HEBEC5D89, &amp;HEC658304, &amp;H7F0F3B00, &amp;HEB188B04, &amp;H8BDB3302, &amp;HC033F87D, &amp;H5D03D3F7, &amp;H3C013EC, &amp;HD083DA, &amp;H458BD08B</td>
        </tr>
        <tr>
          <td id="L7506" data-line-number="7506"></td>
          <td id="LC7506">    pvAppendBuffer &amp;H71C89F4, &amp;H850C7D8B, &amp;H3B0874DB, &amp;H37EF04D, &amp;H8BF04D89, &amp;H8341085D, &amp;H458904C0, &amp;H7ECE3BF4, &amp;HC5589AD, &amp;H8BE8558B, &amp;H4D8B0C45, &amp;H5F0A89F0, &amp;HC0855B5E, &amp;HE8520A75, &amp;H3294&amp;, &amp;H2EBC033, &amp;HE58BC28B, &amp;H8C25D, &amp;H56EC8B55, &amp;H87D8B57, &amp;H106AF633, &amp;H59206A5A, &amp;HC78BCA2B, &amp;HC085E8D3, &amp;HCA8B0675, &amp;HF203E7D3, &amp;HE975FAD1, &amp;H5EC68B5F, &amp;H4C25D, &amp;H8BEC8B55, &amp;H83990845, &amp;HC2031FE2</td>
        </tr>
        <tr>
          <td id="L7507" data-line-number="7507"></td>
          <td id="LC7507">    pvAppendBuffer &amp;H5605F8C1, &amp;HECE85040, &amp;H6A00004B, &amp;H875FF01, &amp;HE856F08B, &amp;HFFFFFEA7, &amp;H5D5EC68B, &amp;H550004C2, &amp;H5151EC8B, &amp;H53084D8B, &amp;HDB335756, &amp;HD90481, &amp;H8B000100, &amp;H5483D914, &amp;H8B0004D9, &amp;H3304D944, &amp;HC2AC0FC9, &amp;H10F8C110, &amp;H89F85589, &amp;HFB83FC45, &amp;H4103750F, &amp;HD23304EB, &amp;HFB83C033, &amp;H17B8D0F, &amp;HF61B006A, &amp;HAF0FDEF7, &amp;H6AD12BF7, &amp;HD88325, &amp;H6AE85250, &amp;H3FFFFF6, &amp;H4D8BF845, &amp;HFC551308</td>
        </tr>
        <tr>
          <td id="L7508" data-line-number="7508"></td>
          <td id="LC7508">    pvAppendBuffer &amp;H8301E883, &amp;H40100DA, &amp;HFC458BF1, &amp;H4F15411, &amp;HFF8558B, &amp;HC110D0A4, &amp;H142910E2, &amp;HD94419D9, &amp;H83DF8B04, &amp;H847210FB, &amp;H8B5B5E5F, &amp;H4C25DE5, &amp;HEC8B5500, &amp;H5610EC83, &amp;H570C758B, &amp;H51B2E856, &amp;H45890000, &amp;H4468DF0, &amp;H51A6E850, &amp;H45890000, &amp;H8468DF4, &amp;H519AE850, &amp;H45890000, &amp;HC468DF8, &amp;H518EE850, &amp;H4D8B0000, &amp;HFC458908, &amp;H798D318B, &amp;HC1C68B04, &amp;HF80304E0, &amp;H57F0458D, &amp;HF6C3E850</td>
        </tr>
        <tr>
          <td id="L7509" data-line-number="7509"></td>
          <td id="LC7509">    pvAppendBuffer &amp;H21EBFFFF, &amp;H3B6AE8, &amp;HF0458D00, &amp;H3BF7E850, &amp;H8D570000, &amp;HE850F045, &amp;HFFFFF6A9, &amp;H50F0458D, &amp;H3B18E8, &amp;H10EF8300, &amp;H50F0458D, &amp;H7501EE83, &amp;H3B3DE8D3, &amp;H458D0000, &amp;HCAE850F0, &amp;H5700003B, &amp;H50F0458D, &amp;HFFF67CE8, &amp;H10758BFF, &amp;HF075FF56, &amp;H6B72E8, &amp;H4468D00, &amp;HF475FF50, &amp;H6B66E8, &amp;H8468D00, &amp;HF875FF50, &amp;H6B5AE8, &amp;HC468D00, &amp;HFC75FF50, &amp;H6B4EE8, &amp;H8B5E5F00, &amp;HCC25DE5</td>
        </tr>
        <tr>
          <td id="L7510" data-line-number="7510"></td>
          <td id="LC7510">    pvAppendBuffer &amp;HEC8B5500, &amp;H5310EC83, &amp;HC758B56, &amp;HE1E85657, &amp;H89000050, &amp;H468DF045, &amp;HD5E85004, &amp;H89000050, &amp;H468DF445, &amp;HC9E85008, &amp;H89000050, &amp;H468DF845, &amp;HBDE8500C, &amp;H8B000050, &amp;H4589085D, &amp;HF0458DFC, &amp;H5604738D, &amp;HF5FBE850, &amp;HFF33FFFF, &amp;H4710C683, &amp;H2D763B39, &amp;H50F0458D, &amp;H5ABDE8, &amp;HF0458D00, &amp;H59B3E850, &amp;H458D0000, &amp;H13E850F0, &amp;H5600003C, &amp;H50F0458D, &amp;HFFF5CCE8, &amp;H10C683FF, &amp;H723B3B47</td>
        </tr>
        <tr>
          <td id="L7511" data-line-number="7511"></td>
          <td id="LC7511">    pvAppendBuffer &amp;HF0458DD3, &amp;H5A90E850, &amp;H458D0000, &amp;H86E850F0, &amp;H56000059, &amp;H50F0458D, &amp;HFFF5A8E8, &amp;H10758BFF, &amp;HF075FF56, &amp;H6A9EE8, &amp;H4468D00, &amp;HF475FF50, &amp;H6A92E8, &amp;H8468D00, &amp;HF875FF50, &amp;H6A86E8, &amp;HC468D00, &amp;HFC75FF50, &amp;H6A7AE8, &amp;H5B5E5F00, &amp;HC25DE58B, &amp;H8B55000C, &amp;H575653EC, &amp;H8B1C75FF, &amp;H75FF107D, &amp;H57E85718, &amp;H85000004, &amp;HE81F74C0, &amp;HFFFFE718, &amp;H475BA0BE, &amp;H4000BB00, &amp;HF32B0047</td>
        </tr>
        <tr>
          <td id="L7512" data-line-number="7512"></td>
          <td id="LC7512">    pvAppendBuffer &amp;H5E8F003, &amp;HB9FFFFE7, &amp;H475AAC, &amp;H75FF2CEB, &amp;H147D8B1C, &amp;H571875FF, &amp;H3CE8&amp;, &amp;HE6EAE800, &amp;H1BEFFFF, &amp;HBB004759, &amp;H474000, &amp;HF003F32B, &amp;HFFE6D7E8, &amp;H5831B9FF, &amp;HCB2B0047, &amp;H4D8BC103, &amp;H8418908, &amp;H890C458B, &amp;H1C70471, &amp;H10&amp;, &amp;H5E5F3889, &amp;H18C25D5B, &amp;HEC8B5500, &amp;H8758B56, &amp;HF468&amp;, &amp;H56006A00, &amp;H3AC0E8, &amp;HCC48300, &amp;H10107D83, &amp;H7D832074, &amp;H10741810, &amp;H20107D83</td>
        </tr>
        <tr>
          <td id="L7513" data-line-number="7513"></td>
          <td id="LC7513">    pvAppendBuffer &amp;H6C72575, &amp;HE&amp;, &amp;H12EB206A, &amp;HC06C7, &amp;H186A0000, &amp;H6C708EB, &amp;HA&amp;, &amp;H75FF106A, &amp;HC1E8560C, &amp;H5EFFFFF4, &amp;HCC25D, &amp;H51DC8B53, &amp;HF0E48351, &amp;H5504C483, &amp;H89046B8B, &amp;H8B04246C, &amp;H2CEC83EC, &amp;H8B084B8B, &amp;H6A560C43, &amp;H918B10, &amp;HF000002, &amp;H18B3810, &amp;H2280F5E, &amp;HF66D603, &amp;H290FF8EF, &amp;HE883F07D, &amp;H483C740A, &amp;H7401E883, &amp;HE883481E, &amp;H95850F01, &amp;HF000000, &amp;HD6030A28</td>
        </tr>
        <tr>
          <td id="L7514" data-line-number="7514"></td>
          <td id="LC7514">    pvAppendBuffer &amp;HDE380F66, &amp;H2280FF9, &amp;HF66D603, &amp;HFF8DE38, &amp;HD6030A28, &amp;HDE380F66, &amp;H2280FF9, &amp;HF66D603, &amp;HFF8DE38, &amp;HFF07D29, &amp;HD6033A28, &amp;H332280F, &amp;H75290FD6, &amp;H75280FE0, &amp;H380F66F0, &amp;H280FF7DE, &amp;HFD6032A, &amp;HFF07529, &amp;H66F07D28, &amp;H7DDE380F, &amp;H22280FE0, &amp;HF66D603, &amp;H66FDDE38, &amp;HFCDE380F, &amp;H31A280F, &amp;H380F66D6, &amp;H280FFBDE, &amp;H66D60312, &amp;HFADE380F, &amp;H30A280F, &amp;H380F66D6, &amp;HF66F9DE</td>
        </tr>
        <tr>
          <td id="L7515" data-line-number="7515"></td>
          <td id="LC7515">    pvAppendBuffer &amp;H663ADE38, &amp;H3CDE380F, &amp;H380F6632, &amp;H10327CDF, &amp;H5E10438B, &amp;H8B38110F, &amp;HE38B5DE5, &amp;HCC25B, &amp;H51DC8B53, &amp;HF0E48351, &amp;H5504C483, &amp;H89046B8B, &amp;H8B04246C, &amp;H2CEC83EC, &amp;H8B084B8B, &amp;H6A560C43, &amp;HFC918B10, &amp;HF000001, &amp;H18B3810, &amp;H2280F5E, &amp;HF66D603, &amp;H290FF8EF, &amp;HE883F07D, &amp;H483C740A, &amp;H7401E883, &amp;HE883481E, &amp;H95850F01, &amp;HF000000, &amp;HD6030A28, &amp;HDC380F66, &amp;H2280FF9, &amp;HF66D603</td>
        </tr>
        <tr>
          <td id="L7516" data-line-number="7516"></td>
          <td id="LC7516">    pvAppendBuffer &amp;HFF8DC38, &amp;HD6030A28, &amp;HDC380F66, &amp;H2280FF9, &amp;HF66D603, &amp;HFF8DC38, &amp;HFF07D29, &amp;HD6033A28, &amp;H332280F, &amp;H75290FD6, &amp;H75280FE0, &amp;H380F66F0, &amp;H280FF7DC, &amp;HFD6032A, &amp;HFF07529, &amp;H66F07D28, &amp;H7DDC380F, &amp;H22280FE0, &amp;HF66D603, &amp;H66FDDC38, &amp;HFCDC380F, &amp;H31A280F, &amp;H380F66D6, &amp;H280FFBDC, &amp;H66D60312, &amp;HFADC380F, &amp;H30A280F, &amp;H380F66D6, &amp;HF66F9DC, &amp;H663ADC38, &amp;H3CDC380F, &amp;H380F6632</td>
        </tr>
        <tr>
          <td id="L7517" data-line-number="7517"></td>
          <td id="LC7517">    pvAppendBuffer &amp;H10327CDD, &amp;H5E10438B, &amp;H8B38110F, &amp;HE38B5DE5, &amp;HCC25B, &amp;H81EC8B55, &amp;H10CEC, &amp;HC458B00, &amp;H5756C933, &amp;H1F445C7, &amp;H8B080402, &amp;H6788DF1, &amp;H10F845C7, &amp;H8D804020, &amp;H4BD14, &amp;HC7660000, &amp;H361BFC45, &amp;H89E47D89, &amp;HD285E855, &amp;HE7840F, &amp;H7D8B0000, &amp;HF4558D0C, &amp;H8DF05589, &amp;HFFFEF495, &amp;H2E0C1FF, &amp;H458BD02B, &amp;HEC558908, &amp;HFEF4958D, &amp;HC22BFFFF, &amp;H3B084589, &amp;H8D1B73F7, &amp;H8D8DB004</td>
        </tr>
        <tr>
          <td id="L7518" data-line-number="7518"></td>
          <td id="LC7518">    pvAppendBuffer &amp;HFFFFFEF4, &amp;HE850C103, &amp;H4D10&amp;, &amp;H33EC558B, &amp;H86E9C9, &amp;H848B0000, &amp;HFFFEF0B5, &amp;H89D233FF, &amp;HC68B0C45, &amp;HFF83F7F7, &amp;H8B0A7508, &amp;H3C0724C6, &amp;H7401B004, &amp;H85C18A02, &amp;H663275D2, &amp;HC4D6E0F, &amp;H570FC033, &amp;H6E0F66D2, &amp;HF0458BC0, &amp;HC8620F66, &amp;HD1620F66, &amp;HDF3A0F66, &amp;HB60F00C2, &amp;H3A0F6600, &amp;H3301C216, &amp;HF045FFD0, &amp;HEB0C5589, &amp;H74C08427, &amp;H6E0F6623, &amp;HC0330C4D, &amp;H66D2570F, &amp;H66C06E0F</td>
        </tr>
        <tr>
          <td id="L7519" data-line-number="7519"></td>
          <td id="LC7519">    pvAppendBuffer &amp;H66C8620F, &amp;H66D1620F, &amp;HC2DF3A0F, &amp;H3A0F6600, &amp;HC4516, &amp;H8BEC558B, &amp;HC453302, &amp;HF4B58489, &amp;H83FFFFFE, &amp;H458B04C2, &amp;H55894608, &amp;HE8753BEC, &amp;HFF41820F, &amp;H7D8BFFFF, &amp;H10558BE4, &amp;HFEF8858D, &amp;HF08BFFFF, &amp;H778DD62B, &amp;H8758901, &amp;H8310758B, &amp;H6601086D, &amp;H8586E0F, &amp;H406E0F66, &amp;H6E0F6604, &amp;H6E0F6608, &amp;HF66FC50, &amp;HF66D062, &amp;HF66CB62, &amp;H290FD162, &amp;H408D0214, &amp;H68D47510, &amp;HF0&amp;</td>
        </tr>
        <tr>
          <td id="L7520" data-line-number="7520"></td>
          <td id="LC7520">    pvAppendBuffer &amp;HF4858D51, &amp;H50FFFFFE, &amp;H3720E8, &amp;H83CF8B00, &amp;HE1C10CC4, &amp;H144D0304, &amp;H280FD233, &amp;H74D28506, &amp;H2BC78B0B, &amp;H660574C2, &amp;HC0DB380F, &amp;H4201290F, &amp;H8310C683, &amp;HD73B10E9, &amp;H5E5FE076, &amp;HC25DE58B, &amp;H8B550010, &amp;H10EC83EC, &amp;H33575653, &amp;HF07D8DC0, &amp;H53C93340, &amp;HF38BA20F, &amp;H8907895B, &amp;H4F890477, &amp;HC578908, &amp;HF845F7, &amp;H74020000, &amp;HF845F75F, &amp;H80000, &amp;H7D8B5674, &amp;H8BC78B10, &amp;HCE8B0875</td>
        </tr>
        <tr>
          <td id="L7521" data-line-number="7521"></td>
          <td id="LC7521">    pvAppendBuffer &amp;H83D1F799, &amp;HEFC103E2, &amp;HC1C20302, &amp;HC08302F8, &amp;H8D068906, &amp;HD0F70446, &amp;H2E8C140, &amp;H4003E083, &amp;H2E9C141, &amp;H8303E183, &amp;H148D40C1, &amp;HFC968986, &amp;H8D000001, &amp;H52518E0C, &amp;HC75FF57, &amp;H2008E89, &amp;HCDE80000, &amp;H33FFFFFD, &amp;H2EB40C0, &amp;H5E5FC033, &amp;H5DE58B5B, &amp;H55000CC2, &amp;HEC81EC8B, &amp;H228&amp;, &amp;H8D1C75FF, &amp;HFFFDD885, &amp;H1875FFFF, &amp;H458D5050, &amp;H458D501C, &amp;HDBE850F4, &amp;HFFFFFFFA, &amp;H458D1475</td>
        </tr>
        <tr>
          <td id="L7522" data-line-number="7522"></td>
          <td id="LC7522">    pvAppendBuffer &amp;H1C75FFF4, &amp;HDC458D50, &amp;H42FE850, &amp;H458B0000, &amp;H4E8C110, &amp;H875FF50, &amp;HFFDC458D, &amp;HE8500C75, &amp;H339&amp;, &amp;HC25DE58B, &amp;H8B550018, &amp;H28EC81EC, &amp;HFF000002, &amp;H858D1C75, &amp;HFFFFFDD8, &amp;H501875FF, &amp;H1C458D50, &amp;HF4458D50, &amp;HFA88E850, &amp;H75FFFFFF, &amp;HF4458D14, &amp;H501C75FF, &amp;H50DC458D, &amp;H3DCE8, &amp;H10458B00, &amp;H5004E8C1, &amp;H8D0875FF, &amp;H75FFDC45, &amp;H57E8500C, &amp;H8B000003, &amp;H18C25DE5, &amp;HEC8B5500</td>
        </tr>
        <tr>
          <td id="L7523" data-line-number="7523"></td>
          <td id="LC7523">    pvAppendBuffer &amp;H210EC81, &amp;H75FF0000, &amp;HF0858D28, &amp;HFFFFFFFD, &amp;H50502475, &amp;H5028458D, &amp;H50F4458D, &amp;HFFFA35E8, &amp;H875FFFF, &amp;H6AF4458D, &amp;H1475FF10, &amp;H75FF0C6A, &amp;H1C75FF20, &amp;HFF1875FF, &amp;H75FF1075, &amp;H2875FF0C, &amp;HD40E850, &amp;HE58B0000, &amp;H24C25D, &amp;H81EC8B55, &amp;H210EC, &amp;H2875FF00, &amp;HFDF0858D, &amp;H75FFFFFF, &amp;H8D505024, &amp;H8D502845, &amp;HE850F445, &amp;HFFFFF9E6, &amp;H75FF106A, &amp;HF4458D0C, &amp;H6A0875FF, &amp;H2075FF0C</td>
        </tr>
        <tr>
          <td id="L7524" data-line-number="7524"></td>
          <td id="LC7524">    pvAppendBuffer &amp;HFF1C75FF, &amp;H75FF1875, &amp;H1075FF14, &amp;H502875FF, &amp;HE9FE8, &amp;H5DE58B00, &amp;H550024C2, &amp;H5751EC8B, &amp;H33187D8B, &amp;HFC5589D2, &amp;H6374FF85, &amp;HC5D8B53, &amp;H8B0B8B56, &amp;HF12B1075, &amp;H3B184D89, &amp;H8B0273FE, &amp;H75D285F7, &amp;H45B60F1A, &amp;H8B505614, &amp;HC1030845, &amp;H34D7E850, &amp;H4D8B0000, &amp;HCC48318, &amp;H85FC558B, &amp;H3B0B75C9, &amp;H6751075, &amp;H8942D233, &amp;H48DFC55, &amp;H10453B0E, &amp;H75FF1175, &amp;H2075FF08, &amp;H831C55FF</td>
        </tr>
        <tr>
          <td id="L7525" data-line-number="7525"></td>
          <td id="LC7525">    pvAppendBuffer &amp;H558B0023, &amp;H102EBFC, &amp;H75FE2B33, &amp;H5F5B5EA4, &amp;HC25DE58B, &amp;H8B55001C, &amp;H758B56EC, &amp;H83C68B20, &amp;H840F00E8, &amp;H86&amp;, &amp;HFF2875FF, &amp;H16A2475, &amp;H7401E883, &amp;H1E88361, &amp;H5014458D, &amp;HFF1075FF, &amp;H75FF0C75, &amp;HE8487408, &amp;H67&amp;, &amp;H8B2875FF, &amp;H75FF184D, &amp;H1C4D3824, &amp;H468D2074, &amp;HFF5150FE, &amp;H75FF1075, &amp;H875FF0C, &amp;HFFFF2EE8, &amp;H2875FFFF, &amp;HFF1C458D, &amp;H16A2475, &amp;H468D25EB, &amp;HFF5150FF</td>
        </tr>
        <tr>
          <td id="L7526" data-line-number="7526"></td>
          <td id="LC7526">    pvAppendBuffer &amp;H75FF1075, &amp;H875FF0C, &amp;HFFFF0EE8, &amp;HE81FEBFF, &amp;H1F&amp;, &amp;H458AD7EB, &amp;H1445301C, &amp;H5014458D, &amp;HFF1075FF, &amp;H75FF0C75, &amp;H5E808, &amp;H5D5E0000, &amp;H550024C2, &amp;H75FFEC8B, &amp;H1C75FF20, &amp;HFF1C75FF, &amp;H75FF1875, &amp;H1075FF14, &amp;HFF0C75FF, &amp;H4E80875, &amp;H5D000000, &amp;H55001CC2, &amp;H458BEC8B, &amp;H5D8B530C, &amp;H38835614, &amp;H18758B00, &amp;H107D8B57, &amp;HF6856274, &amp;HCF8B5E74, &amp;H4D89082B, &amp;H72CE3B18, &amp;H89CE8B05</td>
        </tr>
        <tr>
          <td id="L7527" data-line-number="7527"></td>
          <td id="LC7527">    pvAppendBuffer &amp;H8B1875, &amp;H51084503, &amp;H79E85053, &amp;H8B000033, &amp;HC4830C45, &amp;H184D8B0C, &amp;HF12BD903, &amp;H38390801, &amp;H75FF2E75, &amp;H2475FF08, &amp;H575F685, &amp;HEB2055FF, &amp;H1C55FF03, &amp;H830C458B, &amp;H14EB0020, &amp;H2475FF53, &amp;H575F73B, &amp;HEB2055FF, &amp;H1C55FF03, &amp;HF72BDF03, &amp;HE873F73B, &amp;H2974F685, &amp;H8B0C458B, &amp;H3BF82B00, &amp;H8B0272FE, &amp;H84503FE, &amp;HE8505357, &amp;H3318&amp;, &amp;H30C458B, &amp;HCC483DF, &amp;HF72B3801, &amp;H75107D8B</td>
        </tr>
        <tr>
          <td id="L7528" data-line-number="7528"></td>
          <td id="LC7528">    pvAppendBuffer &amp;H5B5E5FDA, &amp;H20C25D, &amp;H56EC8B55, &amp;H851C758B, &amp;H534574F6, &amp;H570C5D8B, &amp;H75003B83, &amp;H875FF10, &amp;HFF2475FF, &amp;H458B2055, &amp;HEB038910, &amp;H10458B03, &amp;HC72B3B8B, &amp;H272FE3B, &amp;H4503FE8B, &amp;HFF505708, &amp;H75FF1475, &amp;H62D4E818, &amp;H3B290000, &amp;H1187D01, &amp;HF72B147D, &amp;H5B5FC275, &amp;H20C25D5E, &amp;HEC8B5500, &amp;H5310EC83, &amp;H56145D8B, &amp;H8B08758B, &amp;H89008B06, &amp;HDB850845, &amp;H8B575074, &amp;H7D290C7D, &amp;H8D068B10</td>
        </tr>
        <tr>
          <td id="L7529" data-line-number="7529"></td>
          <td id="LC7529">    pvAppendBuffer &amp;H5751F04D, &amp;HFF0476FF, &amp;H75FF0850, &amp;H8468D08, &amp;HF0458D50, &amp;H83E85050, &amp;HFF000062, &amp;H468D0875, &amp;HE8505708, &amp;H3260&amp;, &amp;H8D0875FF, &amp;H8B50F045, &amp;HC7031045, &amp;H324EE850, &amp;H7D030000, &amp;H18C48308, &amp;H7501EB83, &amp;H5B5E5FB8, &amp;HC25DE58B, &amp;H8B550010, &amp;H10EC83EC, &amp;H8758B56, &amp;H147D8B57, &amp;H88B068B, &amp;H85084D89, &amp;H8B4E74FF, &amp;H568D0C45, &amp;H5D8B5308, &amp;H89C32B10, &amp;H52510C45, &amp;H8D50C303, &amp;HE850F045</td>
        </tr>
        <tr>
          <td id="L7530" data-line-number="7530"></td>
          <td id="LC7530">    pvAppendBuffer &amp;H621A&amp;, &amp;H4E8D068B, &amp;H4D8D5108, &amp;H76FF51F0, &amp;H450FF04, &amp;H8D0875FF, &amp;H53500846, &amp;H31E7E8, &amp;H84D8B00, &amp;H8B08568D, &amp;HC4830C45, &amp;H83D9030C, &amp;HC27501EF, &amp;H8B5E5F5B, &amp;H10C25DE5, &amp;HEC8B5500, &amp;H8B08558B, &amp;H458B0C4D, &amp;H4428910, &amp;H8908428D, &amp;HFF31FF0A, &amp;HE8501475, &amp;H31AC&amp;, &amp;H5D0CC483, &amp;H550010C2, &amp;HA1E8EC8B, &amp;HB9FFFFDD, &amp;H4768B3, &amp;H4000E981, &amp;HC1030047, &amp;H51084D8B, &amp;H1475FF50</td>
        </tr>
        <tr>
          <td id="L7531" data-line-number="7531"></td>
          <td id="LC7531">    pvAppendBuffer &amp;HFF74418D, &amp;H75FF1075, &amp;H50406A0C, &amp;H5034418D, &amp;HFFFE73E8, &amp;H10C25DFF, &amp;HEC8B5500, &amp;H5370EC83, &amp;H14758B56, &amp;H71E85657, &amp;H8D000046, &amp;HF88B044E, &amp;HD07D8951, &amp;H4663E8, &amp;H84E8D00, &amp;H51F84589, &amp;HE8CC4589, &amp;H4654&amp;, &amp;H890C4E8D, &amp;H8951F445, &amp;H45E8C845, &amp;H8B000046, &amp;H89560875, &amp;H4589F045, &amp;H4636E8C4, &amp;H4E8D0000, &amp;HD4458904, &amp;HC0458951, &amp;H4627E8, &amp;H84E8D00, &amp;H51E84589, &amp;HE8BC4589</td>
        </tr>
        <tr>
          <td id="L7532" data-line-number="7532"></td>
          <td id="LC7532">    pvAppendBuffer &amp;H4618&amp;, &amp;H890C4E8D, &amp;H8951E445, &amp;H9E8B845, &amp;H8B000046, &amp;H89560C75, &amp;H4589E045, &amp;H45FAE8B4, &amp;H4E8D0000, &amp;HFC458904, &amp;HB0458951, &amp;H45EBE8, &amp;H84E8D00, &amp;H51084589, &amp;HE8AC4589, &amp;H45DC&amp;, &amp;H890C4E8D, &amp;H89511445, &amp;HCDE8A845, &amp;H8B000045, &amp;H89561075, &amp;H45890C45, &amp;H45BEE8A4, &amp;H4E8D0000, &amp;H51D88B04, &amp;HE8A05D89, &amp;H45B0&amp;, &amp;H89084E8D, &amp;H8951DC45, &amp;HA1E89C45, &amp;H8D000045, &amp;H45890C4E</td>
        </tr>
        <tr>
          <td id="L7533" data-line-number="7533"></td>
          <td id="LC7533">    pvAppendBuffer &amp;H458951D8, &amp;H4592E898, &amp;H4D8B0000, &amp;H8BF08BDC, &amp;H7589D855, &amp;H9045C794, &amp;HA&amp;, &amp;H758B06EB, &amp;H107D8BEC, &amp;H8BD47D03, &amp;HDF33FC45, &amp;H310C3C1, &amp;HFC4589C3, &amp;HC1D44533, &amp;HF8030CC0, &amp;H7D89DF33, &amp;HFC7D8B10, &amp;H308C3C1, &amp;HFC7D89FB, &amp;H458BF833, &amp;HE84503F8, &amp;H4589C833, &amp;H8458BF8, &amp;H310C1C1, &amp;H7C7C1C1, &amp;H33084589, &amp;HC0C1E845, &amp;HF845010C, &amp;HC1F84D33, &amp;H4D0108C1, &amp;HDC4D8908, &amp;H33084D8B</td>
        </tr>
        <tr>
          <td id="L7534" data-line-number="7534"></td>
          <td id="LC7534">    pvAppendBuffer &amp;HF4458BC8, &amp;H33E44503, &amp;HF44589D0, &amp;HC114458B, &amp;HC20310C2, &amp;H8907C1C1, &amp;H45331445, &amp;HCC0C1E4, &amp;H33F44501, &amp;HC2C1F455, &amp;H14550108, &amp;H89104D01, &amp;H558BD855, &amp;H8BD03314, &amp;H4503F045, &amp;H89F033E0, &amp;H458BF045, &amp;H10C6C10C, &amp;HC2C1C603, &amp;HC458907, &amp;HC1E04533, &amp;H45010CC0, &amp;HF07533F0, &amp;H108C6C1, &amp;H75890C75, &amp;HC758BEC, &amp;H458BF033, &amp;H104533EC, &amp;H110C0C1, &amp;H45891445, &amp;H14458BEC, &amp;HC6C1C133</td>
        </tr>
        <tr>
          <td id="L7535" data-line-number="7535"></td>
          <td id="LC7535">    pvAppendBuffer &amp;HCC0C107, &amp;H8B104501, &amp;H4D33EC4D, &amp;H8C1C110, &amp;H89144D01, &amp;H4D8BEC4D, &amp;H8BC83314, &amp;HC1C10C45, &amp;HE84D8907, &amp;H3F84D8B, &amp;HC1D933CA, &amp;HC30310C3, &amp;H330C4589, &amp;HF4558BC2, &amp;H30CC0C1, &amp;H33C803D6, &amp;HF84D89D9, &amp;HC10C4D8B, &amp;HCB0308C3, &amp;H330C4D89, &amp;HFC458BC8, &amp;H8907C1C1, &amp;H4D8BE44D, &amp;HC1CA33DC, &amp;HC10310C1, &amp;H33FC4589, &amp;HF0758BC6, &amp;H30CC0C1, &amp;H33D003F7, &amp;HF45589CA, &amp;HC1FC558B, &amp;HD10308C1</td>
        </tr>
        <tr>
          <td id="L7536" data-line-number="7536"></td>
          <td id="LC7536">    pvAppendBuffer &amp;H33FC5589, &amp;H8458BD0, &amp;H8907C2C1, &amp;H558BE055, &amp;HC1D633D8, &amp;HC20310C2, &amp;H33084589, &amp;H87D8BC7, &amp;H30CC0C1, &amp;H89D633F0, &amp;HC2C1F075, &amp;H89FA0308, &amp;HF833087D, &amp;H8307C7C1, &amp;H8901906D, &amp;H850FD47D, &amp;HFFFFFE5A, &amp;H3D0458B, &amp;H45891045, &amp;HCC458BD0, &amp;H89F84503, &amp;H458BCC45, &amp;HF44503C8, &amp;H8BC84589, &amp;H4503BC45, &amp;HBC4589E8, &amp;H3B8458B, &amp;H4589E445, &amp;HB4458BB8, &amp;H89E04503, &amp;H458BB445, &amp;H84503AC</td>
        </tr>
        <tr>
          <td id="L7537" data-line-number="7537"></td>
          <td id="LC7537">    pvAppendBuffer &amp;H89A05D01, &amp;H458BAC45, &amp;H144503A8, &amp;H8B985501, &amp;H5D8B1855, &amp;HA84589D0, &amp;H3A4458B, &amp;H45890C45, &amp;H94458BA4, &amp;H88EC4503, &amp;H9445891A, &amp;HE8C1C38B, &amp;H1428808, &amp;HE8C1C38B, &amp;H2428810, &amp;HC1C47501, &amp;H5A8818EB, &amp;HCC5D8B03, &amp;H5A88C38B, &amp;H8E8C104, &amp;H8B054288, &amp;HC07D01C3, &amp;H8810E8C1, &amp;H7D8B0642, &amp;HB07D01FC, &amp;HC19C4D01, &amp;H5A8818EB, &amp;HC85D8B07, &amp;H5A88C38B, &amp;H8E8C108, &amp;H8B094288, &amp;H10E8C1C3</td>
        </tr>
        <tr>
          <td id="L7538" data-line-number="7538"></td>
          <td id="LC7538">    pvAppendBuffer &amp;HC10A4288, &amp;H5A8818EB, &amp;HC45D8B0B, &amp;H5A88C38B, &amp;H8E8C10C, &amp;H8B0D4288, &amp;H10E8C1C3, &amp;HC10E4288, &amp;H5A8818EB, &amp;HC05D8B0F, &amp;H5A88C38B, &amp;H8E8C110, &amp;H8B114288, &amp;H10E8C1C3, &amp;HC1124288, &amp;H5A8818EB, &amp;HBC5D8B13, &amp;H5A88C38B, &amp;H8E8C114, &amp;H8B154288, &amp;H10E8C1C3, &amp;HC1164288, &amp;H5A8818EB, &amp;HB85D8B17, &amp;H5A88C38B, &amp;H8E8C118, &amp;H8B194288, &amp;H10E8C1C3, &amp;HC11A4288, &amp;H5A8818EB, &amp;HB45D8B1B, &amp;H5A88C38B</td>
        </tr>
        <tr>
          <td id="L7539" data-line-number="7539"></td>
          <td id="LC7539">    pvAppendBuffer &amp;H8E8C11C, &amp;H8B1D4288, &amp;H10E8C1C3, &amp;HC11E4288, &amp;H5A8818EB, &amp;HB05D8B1F, &amp;H5A88C38B, &amp;H8E8C120, &amp;H8B214288, &amp;H10E8C1C3, &amp;HC1224288, &amp;H5A8818EB, &amp;HAC5D8B23, &amp;H5A88C38B, &amp;H8E8C124, &amp;H8B254288, &amp;H10E8C1C3, &amp;HC1264288, &amp;H5A8818EB, &amp;HA85D8B27, &amp;H5A88C38B, &amp;H8E8C128, &amp;H8B294288, &amp;H10E8C1C3, &amp;HC12A4288, &amp;H5A8818EB, &amp;HA45D8B2B, &amp;H5A88C38B, &amp;H8E8C12C, &amp;H8B2D4288, &amp;H10E8C1C3, &amp;HC12E4288</td>
        </tr>
        <tr>
          <td id="L7540" data-line-number="7540"></td>
          <td id="LC7540">    pvAppendBuffer &amp;H5A8818EB, &amp;HA05D8B2F, &amp;H5A88C38B, &amp;H8E8C130, &amp;H8D314288, &amp;HC38B3C4A, &amp;HC118EBC1, &amp;H428810E8, &amp;H335A8832, &amp;H8B9C5D8B, &amp;H345A88C3, &amp;H8808E8C1, &amp;HC38B3542, &amp;H8810E8C1, &amp;HEBC13642, &amp;H375A8818, &amp;H8B985D8B, &amp;H385A88C3, &amp;H8808E8C1, &amp;HC38B3942, &amp;H8810E8C1, &amp;HEBC13A42, &amp;H3B5A8818, &amp;H8B94558B, &amp;H8E8C1C2, &amp;H41881188, &amp;H5FC28B01, &amp;HC110E8C1, &amp;H885E18EA, &amp;H51880241, &amp;HE58B5B03, &amp;H14C25D</td>
        </tr>
        <tr>
          <td id="L7541" data-line-number="7541"></td>
          <td id="LC7541">    pvAppendBuffer &amp;H56EC8B55, &amp;H8B1075FF, &amp;H75FF0875, &amp;H22E8560C, &amp;H6A000045, &amp;H1475FF10, &amp;H5020468D, &amp;H2C67E8, &amp;H18458B00, &amp;H830CC483, &amp;H89007466, &amp;H5D5E7846, &amp;H550014C2, &amp;H8B56EC8B, &amp;HFF570875, &amp;H76FF0C75, &amp;H207E8D30, &amp;H10468D57, &amp;HCAE85650, &amp;H8BFFFFFA, &amp;HC9337856, &amp;H75010780, &amp;HCA3B410B, &amp;H4800674, &amp;HF5740139, &amp;HC25D5E5F, &amp;H8B550008, &amp;H10EC83EC, &amp;H6AF0458D, &amp;H2075FF10, &amp;H2C0AE850, &amp;HC4830000</td>
        </tr>
        <tr>
          <td id="L7542" data-line-number="7542"></td>
          <td id="LC7542">    pvAppendBuffer &amp;HF0458D0C, &amp;HFF006A50, &amp;H75FF2475, &amp;H1875FF1C, &amp;HFF1475FF, &amp;H75FF1075, &amp;H875FF0C, &amp;H3ECBE8, &amp;H5DE58B00, &amp;H550020C2, &amp;H75FFEC8B, &amp;HFF016A24, &amp;H75FF2075, &amp;H1875FF1C, &amp;HFF1475FF, &amp;H75FF1075, &amp;H875FF0C, &amp;H3EA3E8, &amp;H20C25D00, &amp;HEC8B5500, &amp;HFFD7B7E8, &amp;H7886B9FF, &amp;HE9810047, &amp;H474000, &amp;H4D8BC103, &amp;HFF505108, &amp;H18B1475, &amp;HFF1075FF, &amp;H30FF0C75, &amp;H5028418D, &amp;H5018418D, &amp;HFFF887E8</td>
        </tr>
        <tr>
          <td id="L7543" data-line-number="7543"></td>
          <td id="LC7543">    pvAppendBuffer &amp;H10C25DFF, &amp;HEC8B5500, &amp;H8B084D8B, &amp;H41890C45, &amp;H10458B2C, &amp;H5D304189, &amp;H55000CC2, &amp;H8B56EC8B, &amp;H346A0875, &amp;HE856006A, &amp;H2B81&amp;, &amp;H830C4D8B, &amp;H8B002C66, &amp;H28668301, &amp;H30468900, &amp;H8910458B, &amp;H468D0446, &amp;HFF0E8908, &amp;H1475FF31, &amp;H2B36E850, &amp;HC4830000, &amp;HC25D5E18, &amp;H8B550010, &amp;H20EC81EC, &amp;H53000004, &amp;HDB335756, &amp;HFD6085C7, &amp;HDB41FFFF, &amp;H706A0000, &amp;HFD70858D, &amp;H9D89FFFF, &amp;HFFFFFD64</td>
        </tr>
        <tr>
          <td id="L7544" data-line-number="7544"></td>
          <td id="LC7544">    pvAppendBuffer &amp;H85C75053, &amp;HFFFFFD68, &amp;H1&amp;, &amp;HFD6C9D89, &amp;H16E8FFFF, &amp;H8B00002B, &amp;H858D0C75, &amp;HFFFFFF60, &amp;H50561F6A, &amp;H2ADFE8, &amp;H1F468A00, &amp;H8018C483, &amp;HFFFF60A5, &amp;H3F24F8FF, &amp;H8588400C, &amp;HFFFFFF7F, &amp;HFBE0858D, &amp;H75FFFFFF, &amp;H70E85010, &amp;H6A00004A, &amp;H1E6A591E, &amp;HFE609D89, &amp;HB58DFFFF, &amp;HFFFFFE60, &amp;HFE649D89, &amp;HBD8DFFFF, &amp;HFFFFFE68, &amp;H8959A5F3, &amp;H758D805D, &amp;H845D8980, &amp;HF3887D8D, &amp;H591E6AA5</td>
        </tr>
        <tr>
          <td id="L7545" data-line-number="7545"></td>
          <td id="LC7545">    pvAppendBuffer &amp;HFEE09D89, &amp;HB58DFFFF, &amp;HFFFFFEE0, &amp;HFEE49D89, &amp;HBD8DFFFF, &amp;HFFFFFEE8, &amp;H206AA5F3, &amp;HE0B58D59, &amp;H89FFFFFB, &amp;HFFFE649D, &amp;HE0BD8DFF, &amp;H89FFFFFD, &amp;HA5F3845D, &amp;HFEBBFF33, &amp;H47000000, &amp;HFE60BD89, &amp;H7D89FFFF, &amp;HFC38B80, &amp;HF8C1CBB6, &amp;H7E18303, &amp;H5B4B60F, &amp;HFFFFFF60, &amp;HFDE0858D, &amp;HEED3FFFF, &amp;H5056F723, &amp;H5080458D, &amp;H4244E8, &amp;H858D5600, &amp;HFFFFFE60, &amp;HE0858D50, &amp;H50FFFFFE, &amp;H4230E8</td>
        </tr>
        <tr>
          <td id="L7546" data-line-number="7546"></td>
          <td id="LC7546">    pvAppendBuffer &amp;HE0858D00, &amp;H50FFFFFE, &amp;H5080458D, &amp;HFCE0858D, &amp;HE850FFFF, &amp;HFFFFE3AA, &amp;HFEE0858D, &amp;H8D50FFFF, &amp;H50508045, &amp;H48B9E8, &amp;H60858D00, &amp;H50FFFFFE, &amp;HFDE0858D, &amp;H8D50FFFF, &amp;HFFFEE085, &amp;H7FE850FF, &amp;H8DFFFFE3, &amp;HFFFE6085, &amp;H858D50FF, &amp;HFFFFFDE0, &amp;H8BE85050, &amp;H8D000048, &amp;HFFFCE085, &amp;H858D50FF, &amp;HFFFFFE60, &amp;H4863E850, &amp;H458D0000, &amp;H858D5080, &amp;HFFFFFC60, &amp;H4853E850, &amp;H458D0000, &amp;H858D5080</td>
        </tr>
        <tr>
          <td id="L7547" data-line-number="7547"></td>
          <td id="LC7547">    pvAppendBuffer &amp;HFFFFFEE0, &amp;H80458D50, &amp;H364EE850, &amp;H858D0000, &amp;HFFFFFCE0, &amp;HE0858D50, &amp;H50FFFFFD, &amp;HFEE0858D, &amp;HE850FFFF, &amp;H3634&amp;, &amp;HFEE0858D, &amp;H8D50FFFF, &amp;H8D508045, &amp;HFFFCE085, &amp;H3E850FF, &amp;H8DFFFFE3, &amp;HFFFEE085, &amp;H458D50FF, &amp;HE8505080, &amp;H4812&amp;, &amp;H5080458D, &amp;HFDE0858D, &amp;HE850FFFF, &amp;H47ED&amp;, &amp;HFC60858D, &amp;H8D50FFFF, &amp;HFFFE6085, &amp;H858D50FF, &amp;HFFFFFEE0, &amp;H47E8E850, &amp;H858D0000, &amp;HFFFFFD60</td>
        </tr>
        <tr>
          <td id="L7548" data-line-number="7548"></td>
          <td id="LC7548">    pvAppendBuffer &amp;HE0858D50, &amp;H50FFFFFE, &amp;H5080458D, &amp;H35CBE8, &amp;H60858D00, &amp;H50FFFFFE, &amp;H5080458D, &amp;HE2A0E850, &amp;H458DFFFF, &amp;H858D5080, &amp;HFFFFFEE0, &amp;HA9E85050, &amp;H8D000035, &amp;HFFFC6085, &amp;H858D50FF, &amp;HFFFFFE60, &amp;H80458D50, &amp;H3592E850, &amp;H858D0000, &amp;HFFFFFBE0, &amp;HE0858D50, &amp;H50FFFFFD, &amp;HFE60858D, &amp;HE850FFFF, &amp;H3578&amp;, &amp;HFCE0858D, &amp;H8D50FFFF, &amp;HFFFDE085, &amp;H56E850FF, &amp;H56000047, &amp;HFDE0858D, &amp;H8D50FFFF</td>
        </tr>
        <tr>
          <td id="L7549" data-line-number="7549"></td>
          <td id="LC7549">    pvAppendBuffer &amp;HE8508045, &amp;H40A9&amp;, &amp;H60858D56, &amp;H50FFFFFE, &amp;HFEE0858D, &amp;HE850FFFF, &amp;H4095&amp;, &amp;HF01EB83, &amp;HFFFE2089, &amp;HE0858DFF, &amp;H50FFFFFE, &amp;H266FE850, &amp;H858D0000, &amp;HFFFFFEE0, &amp;H80458D50, &amp;H19E85050, &amp;H8D000035, &amp;HFF508045, &amp;H8AE80875, &amp;H5F000037, &amp;HE58B5B5E, &amp;HCC25D, &amp;H83EC8B55, &amp;H6A5720EC, &amp;HC0335907, &amp;H9E045C6, &amp;HF3E17D8D, &amp;HAAAB66AB, &amp;H50E0458D, &amp;HFF0C75FF, &amp;HDBE80875, &amp;H5FFFFFFC</td>
        </tr>
        <tr>
          <td id="L7550" data-line-number="7550"></td>
          <td id="LC7550">    pvAppendBuffer &amp;HC25DE58B, &amp;H8B550008, &amp;H14EC81EC, &amp;H53000001, &amp;HC0335756, &amp;H3308758B, &amp;HE17D8DDB, &amp;HABE05D88, &amp;HAB66ABAB, &amp;HE0458DAA, &amp;H75FF5050, &amp;H456FF0C, &amp;HC247D83, &amp;HC6A1E75, &amp;H8D2075FF, &amp;HE850F045, &amp;H27C4&amp;, &amp;H660CC483, &amp;H88FD5D89, &amp;H45C6FC5D, &amp;H32EB01FF, &amp;H50E0458D, &amp;HFEEC858D, &amp;HE850FFFF, &amp;H1E1A&amp;, &amp;H8D2475FF, &amp;HFFFEEC85, &amp;H2075FFFF, &amp;H1CF1E850, &amp;H458D0000, &amp;H858D50F0, &amp;HFFFFFEEC</td>
        </tr>
        <tr>
          <td id="L7551" data-line-number="7551"></td>
          <td id="LC7551">    pvAppendBuffer &amp;H1D7EE850, &amp;H458D0000, &amp;H858D50E0, &amp;HFFFFFF3C, &amp;H1DE8E850, &amp;H75FF0000, &amp;H3C858D1C, &amp;HFFFFFFFF, &amp;HE8501875, &amp;H1CA1&amp;, &amp;H5D88C033, &amp;HD17D8DD0, &amp;H66ABABAB, &amp;H458DAAAB, &amp;H75FF50F0, &amp;H8C458D0C, &amp;HD4E85056, &amp;H6AFFFFFB, &amp;H8D0C6A04, &amp;HE8508C45, &amp;HFFFFFBB1, &amp;H458D106A, &amp;H8D5050D0, &amp;HE8508C45, &amp;HFFFFFB69, &amp;H8D1475FF, &amp;HFFFF3C85, &amp;H1075FFFF, &amp;H1C71E850, &amp;H458D0000, &amp;H858D50C0, &amp;HFFFFFF3C</td>
        </tr>
        <tr>
          <td id="L7552" data-line-number="7552"></td>
          <td id="LC7552">    pvAppendBuffer &amp;H1CFEE850, &amp;H758B0000, &amp;HD0458D2C, &amp;H458D5056, &amp;HE85050C0, &amp;H5706&amp;, &amp;H85C04D8D, &amp;H8B1874F6, &amp;HC18B2855, &amp;H48AD02B, &amp;HA01320A, &amp;HEE8341D8, &amp;H84F37501, &amp;HFF1675DB, &amp;H458D1475, &amp;H3075FF8C, &amp;H501075FF, &amp;HFFFB04E8, &amp;HEBF633FF, &amp;H46F63303, &amp;H7D8DC033, &amp;H506AABE0, &amp;HABAB006A, &amp;HE0458AAB, &amp;H33F07D8D, &amp;HABABABC0, &amp;HF0458AAB, &amp;H33D07D8D, &amp;HABABABC0, &amp;HD0458AAB, &amp;H33C07D8D, &amp;HABABABC0</td>
        </tr>
        <tr>
          <td id="L7553" data-line-number="7553"></td>
          <td id="LC7553">    pvAppendBuffer &amp;HC0458AAB, &amp;HFF3C858D, &amp;HE850FFFF, &amp;H269D&amp;, &amp;HFF3C8D8A, &amp;H458DFFFF, &amp;H6A346A8C, &amp;H8AE85000, &amp;H8A000026, &amp;HC4838C4D, &amp;H5FC68B18, &amp;HE58B5B5E, &amp;H2CC25D, &amp;H81EC8B55, &amp;H114EC, &amp;H57565300, &amp;H758BC033, &amp;H8DDB3308, &amp;H5D88E17D, &amp;HABABABE0, &amp;H8DAAAB66, &amp;H5050E045, &amp;HFF0C75FF, &amp;H7D830456, &amp;H1E750C24, &amp;H75FF0C6A, &amp;HF0458D20, &amp;H2616E850, &amp;HC4830000, &amp;H5D89660C, &amp;HFC5D88FD, &amp;H1FF45C6</td>
        </tr>
        <tr>
          <td id="L7554" data-line-number="7554"></td>
          <td id="LC7554">    pvAppendBuffer &amp;H458D32EB, &amp;H858D50E0, &amp;HFFFFFEEC, &amp;H1C6CE850, &amp;H75FF0000, &amp;HEC858D24, &amp;HFFFFFFFE, &amp;HE8502075, &amp;H1B43&amp;, &amp;H50F0458D, &amp;HFEEC858D, &amp;HE850FFFF, &amp;H1BD0&amp;, &amp;H50E0458D, &amp;HFF3C858D, &amp;HE850FFFF, &amp;H1C3A&amp;, &amp;H8D1C75FF, &amp;HFFFF3C85, &amp;H1875FFFF, &amp;H1AF3E850, &amp;HC0330000, &amp;H8DD05D88, &amp;HABABD17D, &amp;HAAAB66AB, &amp;H50F0458D, &amp;H8D0C75FF, &amp;H50568C45, &amp;HFFFA26E8, &amp;H6A046AFF, &amp;H8C458D0C, &amp;HFA03E850</td>
        </tr>
        <tr>
          <td id="L7555" data-line-number="7555"></td>
          <td id="LC7555">    pvAppendBuffer &amp;H106AFFFF, &amp;H50D0458D, &amp;H8C458D50, &amp;HF9BBE850, &amp;H75FFFFFF, &amp;H8C458D14, &amp;HFF2875FF, &amp;HE8501075, &amp;HFFFFF9A9, &amp;H8D1475FF, &amp;HFFFF3C85, &amp;H2875FFFF, &amp;H1AB1E850, &amp;HC0330000, &amp;H8DC05D88, &amp;HABABC17D, &amp;HAAAB66AB, &amp;H50C0458D, &amp;HFF3C858D, &amp;HE850FFFF, &amp;H1B30&amp;, &amp;H8D3075FF, &amp;H8D50D045, &amp;HFF50C045, &amp;H37E82C75, &amp;H33000055, &amp;HE07D8DC0, &amp;HABABABAB, &amp;H8DE0458A, &amp;HC033F07D, &amp;HABABABAB, &amp;H8DF0458A</td>
        </tr>
        <tr>
          <td id="L7556" data-line-number="7556"></td>
          <td id="LC7556">    pvAppendBuffer &amp;HC033D07D, &amp;H53506AAB, &amp;H8AABABAB, &amp;H7D8DD045, &amp;HABC033C0, &amp;H8AABABAB, &amp;H858DC045, &amp;HFFFFFF3C, &amp;H2507E850, &amp;H858A0000, &amp;HFFFFFF3C, &amp;H458D346A, &amp;HE850538C, &amp;H24F5&amp;, &amp;H838C458A, &amp;H5E5F18C4, &amp;H5DE58B5B, &amp;H55002CC2, &amp;H558BEC8B, &amp;H104D8B0C, &amp;H8758B56, &amp;H233068B, &amp;H468B0189, &amp;H4423304, &amp;H8B044189, &amp;H42330846, &amp;H8418908, &amp;H330C468B, &amp;H41890C42, &amp;HC25D5E0C, &amp;H8B55000C, &amp;H8B5351EC</td>
        </tr>
        <tr>
          <td id="L7557" data-line-number="7557"></td>
          <td id="LC7557">    pvAppendBuffer &amp;H57560C5D, &amp;H66087D8B, &amp;HFC45C7, &amp;H8B0F8BE1, &amp;H83E8D1C1, &amp;H38901E1, &amp;H8B04578B, &amp;H83E8D1C2, &amp;HE1C101E2, &amp;HC1C80B1F, &amp;H4B891FE2, &amp;H8778B04, &amp;HE8D1C68B, &amp;HB01E683, &amp;H1FE6C1D0, &amp;H8B085389, &amp;HC18B0C4F, &amp;HE183E8D1, &amp;H5FF00B01, &amp;HF0C7389, &amp;HFC0D44B6, &amp;H3118E0C1, &amp;H8B5B5E03, &amp;H8C25DE5, &amp;HEC8B5500, &amp;H8758B56, &amp;H5E85657, &amp;H8B000039, &amp;H7890C7D, &amp;H5004468D, &amp;H38F7E8, &amp;H4478900</td>
        </tr>
        <tr>
          <td id="L7558" data-line-number="7558"></td>
          <td id="LC7558">    pvAppendBuffer &amp;H5008468D, &amp;H38EBE8, &amp;H8478900, &amp;H500C468D, &amp;H38DFE8, &amp;HC478900, &amp;HC25D5E5F, &amp;H8B550008, &amp;H20EC83EC, &amp;H56E0458D, &amp;H6A106A57, &amp;HFAE85000, &amp;H6A000023, &amp;HC75FF10, &amp;H50F0458D, &amp;H23C7E8, &amp;H87D8B00, &amp;H3318C483, &amp;H83C68BF6, &amp;H1F6A1FE0, &amp;H8BC82B59, &amp;H5F8C1C6, &amp;HD387048B, &amp;H7401A8E8, &amp;H8BC93312, &amp;H31F00D44, &amp;H83E00D44, &amp;HF98304C1, &amp;H8DF07210, &amp;H5050F045, &amp;HFFFEFDE8, &amp;HFE8146FF</td>
        </tr>
        <tr>
          <td id="L7559" data-line-number="7559"></td>
          <td id="LC7559">    pvAppendBuffer &amp;H80&amp;, &amp;H106AC37C, &amp;H50E0458D, &amp;HE81075FF, &amp;H2374&amp;, &amp;H5F0CC483, &amp;H5DE58B5E, &amp;H55000CC2, &amp;H458BEC8B, &amp;H100F08, &amp;H660C458B, &amp;H1BE8700F, &amp;HFD5280F, &amp;H100FDD28, &amp;H10458B00, &amp;HC8700F66, &amp;HC5280F1B, &amp;H443A0F66, &amp;HF6601C1, &amp;H10D1443A, &amp;HD0EF0F66, &amp;H443A0F66, &amp;HF6600D9, &amp;H11E9443A, &amp;H66C2280F, &amp;H8DA730F, &amp;HF8730F66, &amp;HEF0F6608, &amp;HEF0F66EA, &amp;HE5280FD8, &amp;H66C3280F, &amp;H1FD4720F</td>
        </tr>
        <tr>
          <td id="L7560" data-line-number="7560"></td>
          <td id="LC7560">    pvAppendBuffer &amp;HD0720F66, &amp;H720F661F, &amp;H280F01F3, &amp;H730F66C8, &amp;HF6604FC, &amp;H660CD873, &amp;H4F9730F, &amp;HCBEB0F66, &amp;HF5720F66, &amp;HD9280F01, &amp;HE5EB0F66, &amp;HF3720F66, &amp;HEB0F661F, &amp;HC1280FE0, &amp;HF0720F66, &amp;HEF0F661E, &amp;HC1280FD8, &amp;HF0720F66, &amp;HEF0F6619, &amp;HD3280FD8, &amp;HDB730F66, &amp;H730F6604, &amp;HF660CFA, &amp;H280FD1EF, &amp;HC2280FCA, &amp;HD1720F66, &amp;H720F6602, &amp;HF6601D0, &amp;H280FC8EF, &amp;H720F66C2, &amp;HF6607D0, &amp;HF66C8EF</td>
        </tr>
        <tr>
          <td id="L7561" data-line-number="7561"></td>
          <td id="LC7561">    pvAppendBuffer &amp;HF66CBEF, &amp;HF66CAEF, &amp;HF66CCEF, &amp;HF1BC170, &amp;HC25D0011, &amp;H8B55000C, &amp;H758B56EC, &amp;H7D8B570C, &amp;H37FF5608, &amp;H519EE8, &amp;H4468D00, &amp;H477FF50, &amp;H5192E8, &amp;H8468D00, &amp;H877FF50, &amp;H5186E8, &amp;HC468D00, &amp;HC77FF50, &amp;H517AE8, &amp;H5D5E5F00, &amp;H550008C2, &amp;HEC83EC8B, &amp;H758B5644, &amp;HA8BE8308, &amp;H0&amp;, &amp;HE8560674, &amp;H3395&amp;, &amp;HB60FC933, &amp;H880E84, &amp;H44890000, &amp;H8341BC8D, &amp;HEE7210F9</td>
        </tr>
        <tr>
          <td id="L7562" data-line-number="7562"></td>
          <td id="LC7562">    pvAppendBuffer &amp;HFC6583, &amp;H3302E856, &amp;H458D0000, &amp;HE85650BC, &amp;H32AA&amp;, &amp;H330C558B, &amp;H8E048AC9, &amp;H41110488, &amp;H7210F983, &amp;HAC68F4, &amp;H6A0000, &amp;H21FBE856, &amp;H68A0000, &amp;H5E0CC483, &amp;HC25DE58B, &amp;H8B550008, &amp;H758B56EC, &amp;HAC6808, &amp;H6A0000, &amp;H21DBE856, &amp;H4D8B0000, &amp;HFCBA0C, &amp;H106A0000, &amp;HF1075FF, &amp;H468901B6, &amp;H41B60F44, &amp;H48468901, &amp;H241B60F, &amp;HF4C4689, &amp;H830341B6, &amp;H46890FE0, &amp;H41B60F50</td>
        </tr>
        <tr>
          <td id="L7563" data-line-number="7563"></td>
          <td id="LC7563">    pvAppendBuffer &amp;H89C22304, &amp;HB60F5446, &amp;H46890541, &amp;H41B60F58, &amp;H5C468906, &amp;H741B60F, &amp;H890FE083, &amp;HB60F6046, &amp;HC2230841, &amp;HF644689, &amp;H890941B6, &amp;HB60F6846, &amp;H46890A41, &amp;H41B60F6C, &amp;HFE0830B, &amp;HF704689, &amp;H230C41B6, &amp;H744689C2, &amp;HD41B60F, &amp;HF784689, &amp;H890E41B6, &amp;HB60F7C46, &amp;HA6830F41, &amp;H84&amp;, &amp;HFE08300, &amp;H808689, &amp;H868D0000, &amp;H88&amp;, &amp;H2112E850, &amp;HC4830000, &amp;HC25D5E18, &amp;H8B55000C</td>
        </tr>
        <tr>
          <td id="L7564" data-line-number="7564"></td>
          <td id="LC7564">    pvAppendBuffer &amp;HCD06E8EC, &amp;HBAB9FFFF, &amp;H810047A7, &amp;H474000E9, &amp;H8BC10300, &amp;H5051084D, &amp;H8D1075FF, &amp;HA881&amp;, &amp;HC75FF00, &amp;H8D50106A, &amp;H9881&amp;, &amp;HE85000, &amp;H5DFFFFED, &amp;H55000CC2, &amp;HEC83EC8B, &amp;H5756530C, &amp;HFFCCC7E8, &amp;H84D8BFF, &amp;H47AE28BE, &amp;H5A406A00, &amp;H4000EE81, &amp;HF0030047, &amp;H8B64798D, &amp;HE2F76041, &amp;H703006A, &amp;H515ADA8B, &amp;H13F08B56, &amp;H58406ADA, &amp;H83084E8D, &amp;HC12B3FE1, &amp;H68525250, &amp;H80&amp;</td>
        </tr>
        <tr>
          <td id="L7565" data-line-number="7565"></td>
          <td id="LC7565">    pvAppendBuffer &amp;H8B57406A, &amp;H478D087D, &amp;H7E85020, &amp;H8DFFFFEC, &amp;HF50F445, &amp;H5303F3A4, &amp;H5603E6C1, &amp;H4FCDE8, &amp;H8D086A00, &amp;H5750F445, &amp;HC5E8&amp;, &amp;HC758B00, &amp;HE837FF56, &amp;H4F8F&amp;, &amp;H5004468D, &amp;HE80477FF, &amp;H4F83&amp;, &amp;H5008468D, &amp;HE80877FF, &amp;H4F77&amp;, &amp;H500C468D, &amp;HE80C77FF, &amp;H4F6B&amp;, &amp;H5010468D, &amp;HE81077FF, &amp;H4F5F&amp;, &amp;H5014468D, &amp;HE81477FF, &amp;H4F53&amp;, &amp;H5018468D, &amp;HE81877FF, &amp;H4F47&amp;</td>
        </tr>
        <tr>
          <td id="L7566" data-line-number="7566"></td>
          <td id="LC7566">    pvAppendBuffer &amp;H501C468D, &amp;HE81C77FF, &amp;H4F3B&amp;, &amp;H6A686A, &amp;H2017E857, &amp;HC4830000, &amp;H5B5E5F0C, &amp;HC25DE58B, &amp;H8B550008, &amp;H758B56EC, &amp;H6A686A08, &amp;HFAE85600, &amp;H8300001F, &amp;H6C70CC4, &amp;H6A09E667, &amp;H850446C7, &amp;HC7BB67AE, &amp;HF3720846, &amp;H46C73C6E, &amp;H4FF53A0C, &amp;H1046C7A5, &amp;H510E527F, &amp;H8C1446C7, &amp;HC79B0568, &amp;HD9AB1846, &amp;H46C71F83, &amp;HE0CD191C, &amp;HC25D5E5B, &amp;H8B550004, &amp;HCB92E8EC, &amp;H28B9FFFF, &amp;H810047AE</td>
        </tr>
        <tr>
          <td id="L7567" data-line-number="7567"></td>
          <td id="LC7567">    pvAppendBuffer &amp;H474000E9, &amp;H8BC10300, &amp;H5051084D, &amp;H8D1075FF, &amp;H75FF6441, &amp;H50406A0C, &amp;H5020418D, &amp;HFFEB92E8, &amp;HCC25DFF, &amp;HEC8B5500, &amp;H8D40EC83, &amp;HFF50C045, &amp;HA7E80875, &amp;H6A000000, &amp;HC0458D30, &amp;HC75FF50, &amp;H1F43E8, &amp;HCC48300, &amp;HC25DE58B, &amp;H8B550008, &amp;H758B56EC, &amp;HC86808, &amp;H6A0000, &amp;H1F4BE856, &amp;HC4830000, &amp;HD806C70C, &amp;HC7C1059E, &amp;H9D5D0446, &amp;H46C7CBBB, &amp;H7CD50708, &amp;HC46C736, &amp;H629A292A</td>
        </tr>
        <tr>
          <td id="L7568" data-line-number="7568"></td>
          <td id="LC7568">    pvAppendBuffer &amp;H171046C7, &amp;HC73070DD, &amp;H15A1446, &amp;H46C79159, &amp;HE593918, &amp;H1C46C7F7, &amp;H152FECD8, &amp;H312046C7, &amp;HC7FFC00B, &amp;H26672446, &amp;H46C76733, &amp;H58151128, &amp;H2C46C768, &amp;H8EB44A87, &amp;HA73046C7, &amp;HC764F98F, &amp;H2E0D3446, &amp;H46C7DB0C, &amp;HFA4FA438, &amp;H3C46C7BE, &amp;H47B5481D, &amp;H4C25D5E, &amp;H1B8E900, &amp;H8B550000, &amp;H8B5151EC, &amp;H80B90845, &amp;H53000000, &amp;HB08D5756, &amp;HC4&amp;, &amp;HC0808B, &amp;HE1F70000, &amp;HFA8BD88B</td>
        </tr>
        <tr>
          <td id="L7569" data-line-number="7569"></td>
          <td id="LC7569">    pvAppendBuffer &amp;HD7831E03, &amp;HCA82E800, &amp;H558BFFFF, &amp;HAFCEB908, &amp;H81520047, &amp;H474000E9, &amp;H8DC10300, &amp;H8350104B, &amp;H80B87FE1, &amp;H2B000000, &amp;H6A50C1, &amp;H80B8006A, &amp;H50000000, &amp;H428D5650, &amp;HD7E85040, &amp;H8DFFFFE9, &amp;H6A50F845, &amp;HE8006A00, &amp;H4DA2&amp;, &amp;H458D086A, &amp;H75FF50F8, &amp;H13CE808, &amp;H458D0000, &amp;HA40F50F8, &amp;HC15703DF, &amp;HE85303E3, &amp;H4D82&amp;, &amp;H8D085D8B, &amp;H86AF845, &amp;H1BE85350, &amp;H8B000001, &amp;HFF560C75</td>
        </tr>
        <tr>
          <td id="L7570" data-line-number="7570"></td>
          <td id="LC7570">    pvAppendBuffer &amp;H33FF0473, &amp;H4D65E8, &amp;H8468D00, &amp;HC73FF50, &amp;HE80873FF, &amp;H4D56&amp;, &amp;H5010468D, &amp;HFF1473FF, &amp;H47E81073, &amp;H8D00004D, &amp;HFF501846, &amp;H73FF1C73, &amp;H4D38E818, &amp;H468D0000, &amp;H73FF5020, &amp;H2073FF24, &amp;H4D29E8, &amp;H28468D00, &amp;H2C73FF50, &amp;HE82873FF, &amp;H4D1A&amp;, &amp;H5030468D, &amp;HFF3473FF, &amp;HBE83073, &amp;H8D00004D, &amp;HFF503846, &amp;H73FF3C73, &amp;H4CFCE838, &amp;HC8680000, &amp;H6A000000, &amp;HAEE85300, &amp;H8300001D</td>
        </tr>
        <tr>
          <td id="L7571" data-line-number="7571"></td>
          <td id="LC7571">    pvAppendBuffer &amp;H5E5F0CC4, &amp;H5DE58B5B, &amp;H550008C2, &amp;H8B56EC8B, &amp;HC8680875, &amp;H6A000000, &amp;H8EE85600, &amp;H8300001D, &amp;H6C70CC4, &amp;HF3BCC908, &amp;H670446C7, &amp;HC76A09E6, &amp;HA73B0846, &amp;H46C784CA, &amp;H67AE850C, &amp;H1046C7BB, &amp;HFE94F82B, &amp;H721446C7, &amp;HC73C6EF3, &amp;H36F11846, &amp;H46C75F1D, &amp;H4FF53A1C, &amp;H2046C7A5, &amp;HADE682D1, &amp;H7F2446C7, &amp;HC7510E52, &amp;H6C1F2846, &amp;H46C72B3E, &amp;H5688C2C, &amp;H3046C79B, &amp;HFB41BD6B, &amp;HAB3446C7</td>
        </tr>
        <tr>
          <td id="L7572" data-line-number="7572"></td>
          <td id="LC7572">    pvAppendBuffer &amp;HC71F83D9, &amp;H21793846, &amp;H46C7137E, &amp;HE0CD193C, &amp;HC25D5E5B, &amp;H8B550004, &amp;HC8EEE8EC, &amp;HCEB9FFFF, &amp;H810047AF, &amp;H474000E9, &amp;H8BC10300, &amp;H5051084D, &amp;H8D1075FF, &amp;HC481&amp;, &amp;HC75FF00, &amp;H8068&amp;, &amp;H418D5000, &amp;HE8E85040, &amp;H5DFFFFE8, &amp;H55000CC2, &amp;H5756EC8B, &amp;HFFC8A0E8, &amp;H87D8BFF, &amp;HC8D0F8B, &amp;H48D&amp;, &amp;H10FF5100, &amp;HF08B0F8B, &amp;H48D0C8D, &amp;H51000000, &amp;H8DE85657, &amp;H8300001C, &amp;HC68B0CC4</td>
        </tr>
        <tr>
          <td id="L7573" data-line-number="7573"></td>
          <td id="LC7573">    pvAppendBuffer &amp;HC25D5E5F, &amp;H8B550004, &amp;H758B56EC, &amp;HC75FF08, &amp;H468D0E8B, &amp;H76FF5008, &amp;H451FF04, &amp;H8B2C568B, &amp;HD603304E, &amp;H8504EB5E, &amp;H490874C9, &amp;H80A4480, &amp;H5DF47401, &amp;H550008C2, &amp;H4D8BEC8B, &amp;H40C03308, &amp;HF7E0139, &amp;H813C83, &amp;HC830975, &amp;H3B40FF81, &amp;HFFF17C01, &amp;HC25D810C, &amp;H8B550004, &amp;HC458BEC, &amp;H33575653, &amp;H1A788DDB, &amp;H8918C083, &amp;HB60F0C45, &amp;H8B99FF47, &amp;H8BF28BC8, &amp;H6D830C45, &amp;HB60F080C</td>
        </tr>
        <tr>
          <td id="L7574" data-line-number="7574"></td>
          <td id="LC7574">    pvAppendBuffer &amp;HA40F9900, &amp;HF20B08C2, &amp;HB08E0C1, &amp;H7B60FC8, &amp;H8CEA40F, &amp;HF87F8D99, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0947B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0A47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0B47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0C47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0D47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;H8BC80BF2, &amp;HC890845, &amp;HD87489D8, &amp;HFB834304, &amp;H6B820F04</td>
        </tr>
        <tr>
          <td id="L7575" data-line-number="7575"></td>
          <td id="LC7575">    pvAppendBuffer &amp;H5FFFFFFF, &amp;HC25D5B5E, &amp;H8B550008, &amp;HC458BEC, &amp;H33575653, &amp;H2A788DDB, &amp;H8928C083, &amp;HB60F0C45, &amp;H8B99FF47, &amp;H8BF28BC8, &amp;H6D830C45, &amp;HB60F080C, &amp;HA40F9900, &amp;HF20B08C2, &amp;HB08E0C1, &amp;H7B60FC8, &amp;H8CEA40F, &amp;HF87F8D99, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0947B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0A47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0B47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2</td>
        </tr>
        <tr>
          <td id="L7576" data-line-number="7576"></td>
          <td id="LC7576">    pvAppendBuffer &amp;HF0C47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;HFC80BF2, &amp;HF0D47B6, &amp;H9908CEA4, &amp;HB08E1C1, &amp;H8BC80BF2, &amp;HC890845, &amp;HD87489D8, &amp;HFB834304, &amp;H6B820F06, &amp;H5FFFFFFF, &amp;HC25D5B5E, &amp;H8B550008, &amp;H60EC83EC, &amp;HFFE0458D, &amp;HE8500C75, &amp;HFFFFFE8E, &amp;H458D046A, &amp;HABE850E0, &amp;H8500003B, &amp;H330474C0, &amp;H567FEBC0, &amp;H458D046A, &amp;H8EE850E0, &amp;HBEFFFFC6, &amp;H90&amp;, &amp;HE850C603, &amp;H3B3B&amp;, &amp;H7401F883, &amp;HE8046A14</td>
        </tr>
        <tr>
          <td id="L7577" data-line-number="7577"></td>
          <td id="LC7577">    pvAppendBuffer &amp;HFFFFC675, &amp;H8D50C603, &amp;H5050E045, &amp;H4919E8, &amp;H8D006A00, &amp;HE850E045, &amp;HFFFFC65D, &amp;H5050C083, &amp;H50A0458D, &amp;HFFC9F4E8, &amp;HA0458DFF, &amp;HC98FE850, &amp;HC085FFFF, &amp;HC0330474, &amp;H758B23EB, &amp;HA04D8D08, &amp;H14E8D51, &amp;H510406C6, &amp;HD2E8&amp;, &amp;HC04D8D00, &amp;H214E8D51, &amp;HC5E851, &amp;HC0330000, &amp;HE58B5E40, &amp;H8C25D, &amp;H81EC8B55, &amp;H90EC&amp;, &amp;HD0458D00, &amp;H500C75FF, &amp;HFFFE91E8, &amp;H8D066AFF, &amp;HE850D045</td>
        </tr>
        <tr>
          <td id="L7578" data-line-number="7578"></td>
          <td id="LC7578">    pvAppendBuffer &amp;H3AFE&amp;, &amp;H774C085, &amp;H8AE9C033, &amp;H56000000, &amp;H458D066A, &amp;HDEE850D0, &amp;HBEFFFFC5, &amp;H170&amp;, &amp;HE850C603, &amp;H3A8B&amp;, &amp;H7401F883, &amp;HE8066A14, &amp;HFFFFC5C5, &amp;H8D50C603, &amp;H5050D045, &amp;H4869E8, &amp;H8D006A00, &amp;HE850D045, &amp;HFFFFC5AD, &amp;H11005, &amp;H858D5000, &amp;HFFFFFF70, &amp;HCAEBE850, &amp;H858DFFFF, &amp;HFFFFFF70, &amp;HC905E850, &amp;HC085FFFF, &amp;HC0330474, &amp;H758B26EB, &amp;H708D8D08, &amp;H51FFFFFF, &amp;HC6014E8D</td>
        </tr>
        <tr>
          <td id="L7579" data-line-number="7579"></td>
          <td id="LC7579">    pvAppendBuffer &amp;HE8510406, &amp;HAE&amp;, &amp;H51A04D8D, &amp;H51314E8D, &amp;HA1E8&amp;, &amp;H40C03300, &amp;H5DE58B5E, &amp;H550008C2, &amp;H458BEC8B, &amp;H57565308, &amp;H8D0C7D8B, &amp;HF6331848, &amp;H8D084D89, &amp;H448A1A58, &amp;H18807F7, &amp;H448A28B1, &amp;H438806F7, &amp;HF7048BFF, &amp;H4F7548B, &amp;HFFD2D2E8, &amp;HB10388FF, &amp;HF7048B20, &amp;H4F7548B, &amp;HFFD2C2E8, &amp;H14388FF, &amp;H8BF85B8D, &amp;H448BF70C, &amp;HAC0F04F7, &amp;HE8C118C1, &amp;HA4B8818, &amp;H8BF70C8B, &amp;HF04F744</td>
        </tr>
        <tr>
          <td id="L7580" data-line-number="7580"></td>
          <td id="LC7580">    pvAppendBuffer &amp;HC110C1AC, &amp;H4B8810E8, &amp;HF70C8B0B, &amp;H4F7448B, &amp;H8C1AC0F, &amp;H8808E8C1, &amp;H48A0C4B, &amp;H4D8B46F7, &amp;H8E98308, &amp;H890D4388, &amp;HFE83084D, &amp;H5F877204, &amp;HC25D5B5E, &amp;H8B550008, &amp;H8458BEC, &amp;H8B575653, &amp;H488D0C7D, &amp;H89F63328, &amp;H588D084D, &amp;HF7448A2A, &amp;HB1018807, &amp;HF7448A28, &amp;HFF438806, &amp;H8BF7048B, &amp;HE804F754, &amp;HFFFFD23B, &amp;H20B10388, &amp;H8BF7048B, &amp;HE804F754, &amp;HFFFFD22B, &amp;H8D014388, &amp;HC8BF85B</td>
        </tr>
        <tr>
          <td id="L7581" data-line-number="7581"></td>
          <td id="LC7581">    pvAppendBuffer &amp;HF7448BF7, &amp;HC1AC0F04, &amp;H18E8C118, &amp;H8B0A4B88, &amp;H448BF70C, &amp;HAC0F04F7, &amp;HE8C110C1, &amp;HB4B8810, &amp;H8BF70C8B, &amp;HF04F744, &amp;HC108C1AC, &amp;H4B8808E8, &amp;HF7048A0C, &amp;H84D8B46, &amp;H8808E983, &amp;H4D890D43, &amp;H6FE8308, &amp;H5E5F8772, &amp;H8C25D5B, &amp;HEC8B5500, &amp;H5320EC83, &amp;H33085D8B, &amp;H758B56C0, &amp;H66A570C, &amp;HE4458959, &amp;HC7E87D8D, &amp;H3E045, &amp;HABF30000, &amp;H5001468D, &amp;HFBE0E853, &amp;H3E80FFFF, &amp;H8D0F7504</td>
        </tr>
        <tr>
          <td id="L7582" data-line-number="7582"></td>
          <td id="LC7582">    pvAppendBuffer &amp;H8D502146, &amp;HE8502043, &amp;HFFFFFBCE, &amp;H46A76EB, &amp;H207B8D53, &amp;H42A5E857, &amp;H46A0000, &amp;HFFC3D8E8, &amp;H10C083FF, &amp;HE0458D50, &amp;HE8575750, &amp;H42B9&amp;, &amp;H5753046A, &amp;H4258E857, &amp;H46A0000, &amp;HFFC3B8E8, &amp;H10C083FF, &amp;HC3AFE850, &amp;HC083FFFF, &amp;H57575030, &amp;H3CEEE8, &amp;H5DE85700, &amp;H8A000018, &amp;H240F8B06, &amp;HC0B60F01, &amp;H9901E183, &amp;H675C83B, &amp;HC23BC033, &amp;H46A1274, &amp;HC37FE857, &amp;HC083FFFF, &amp;HE8575010</td>
        </tr>
        <tr>
          <td id="L7583" data-line-number="7583"></td>
          <td id="LC7583">    pvAppendBuffer &amp;H4626&amp;, &amp;H8B5B5E5F, &amp;H8C25DE5, &amp;HEC8B5500, &amp;H5330EC83, &amp;H33085D8B, &amp;H758B56C0, &amp;HA6A570C, &amp;HD4458959, &amp;HC7D87D8D, &amp;H3D045, &amp;HABF30000, &amp;H5001468D, &amp;HFBD0E853, &amp;H3E80FFFF, &amp;H8D0F7504, &amp;H8D503146, &amp;HE8503043, &amp;HFFFFFBBE, &amp;H66A7DEB, &amp;H307B8D53, &amp;H41E5E857, &amp;H66A0000, &amp;HFFC318E8, &amp;HB005FF, &amp;H8D500000, &amp;H5750D045, &amp;H41F7E857, &amp;H66A0000, &amp;HE8575753, &amp;H4196&amp;, &amp;HF6E8066A</td>
        </tr>
        <tr>
          <td id="L7584" data-line-number="7584"></td>
          <td id="LC7584">    pvAppendBuffer &amp;HBBFFFFC2, &amp;HB0&amp;, &amp;HE850C303, &amp;HFFFFC2E9, &amp;HE005&amp;, &amp;H57575000, &amp;H3C26E8, &amp;H29E85700, &amp;H8A000018, &amp;H240F8B06, &amp;HC0B60F01, &amp;H9901E183, &amp;H675C83B, &amp;HC23BC033, &amp;H66A1174, &amp;HC2B7E857, &amp;HC303FFFF, &amp;H5FE85750, &amp;H5F000045, &amp;HE58B5B5E, &amp;H8C25D, &amp;H81EC8B55, &amp;HA0EC&amp;, &amp;H60858D00, &amp;HFFFFFFFF, &amp;HE8500875, &amp;HFFFFFE61, &amp;H8D0C75FF, &amp;HE850E045, &amp;HFFFFFA62, &amp;H458D006A, &amp;H858D50E0</td>
        </tr>
        <tr>
          <td id="L7585" data-line-number="7585"></td>
          <td id="LC7585">    pvAppendBuffer &amp;HFFFFFF60, &amp;HA0458D50, &amp;HC60FE850, &amp;H458DFFFF, &amp;H75FF50A0, &amp;HFD05E810, &amp;H458DFFFF, &amp;H9EE850A0, &amp;HF7FFFFC5, &amp;H40C01BD8, &amp;HC25DE58B, &amp;H8B55000C, &amp;HF0EC81EC, &amp;H8D000000, &amp;HFFFF1085, &amp;H875FFFF, &amp;HFEC7E850, &amp;H75FFFFFF, &amp;HD0458D0C, &amp;HFAB8E850, &amp;H6AFFFF, &amp;H50D0458D, &amp;HFF10858D, &amp;H8D50FFFF, &amp;HFFFF7085, &amp;H5EE850FF, &amp;H8DFFFFC7, &amp;HFFFF7085, &amp;H75FF50FF, &amp;HFD3CE810, &amp;H858DFFFF, &amp;HFFFFFF70</td>
        </tr>
        <tr>
          <td id="L7586" data-line-number="7586"></td>
          <td id="LC7586">    pvAppendBuffer &amp;HC569E850, &amp;HD8F7FFFF, &amp;H8B40C01B, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H8D40EC83, &amp;HFF56C045, &amp;HE8500875, &amp;HFFFFFDA9, &amp;H8D0C758B, &amp;H8D50C045, &amp;H6C60146, &amp;H68E85004, &amp;H8DFFFFFC, &amp;H8D50E045, &amp;HE8502146, &amp;HFFFFFC5B, &amp;H5E40C033, &amp;HC25DE58B, &amp;H8B550008, &amp;H60EC83EC, &amp;H56A0458D, &amp;H500875FF, &amp;HFFFE2CE8, &amp;HC758BFF, &amp;H50A0458D, &amp;HC601468D, &amp;HE8500406, &amp;HFFFFFCC2, &amp;H50D0458D, &amp;H5031468D, &amp;HFFFCB5E8</td>
        </tr>
        <tr>
          <td id="L7587" data-line-number="7587"></td>
          <td id="LC7587">    pvAppendBuffer &amp;H40C033FF, &amp;H5DE58B5E, &amp;H550008C2, &amp;HEC81EC8B, &amp;H80&amp;, &amp;H7D8B5753, &amp;H5B046A10, &amp;H5FE85753, &amp;H85000036, &amp;H330774C0, &amp;H115E9C0, &amp;H53560000, &amp;HC143E857, &amp;H90BEFFFF, &amp;H3000000, &amp;HF0E850C6, &amp;H83000035, &amp;H107401F8, &amp;HC12BE853, &amp;HC603FFFF, &amp;HE8575750, &amp;H43D2&amp;, &amp;HE857006A, &amp;HFFFFC119, &amp;H5050C083, &amp;H5080458D, &amp;HFFC4B0E8, &amp;H458D53FF, &amp;H2E85080, &amp;H3FFFFC1, &amp;HB4E850C6, &amp;H83000035</td>
        </tr>
        <tr>
          <td id="L7588" data-line-number="7588"></td>
          <td id="LC7588">    pvAppendBuffer &amp;H137401F8, &amp;HC0EFE853, &amp;HC603FFFF, &amp;H80458D50, &amp;H93E85050, &amp;H53000043, &amp;H5080458D, &amp;H35E1E8, &amp;H74C08500, &amp;HE9C03307, &amp;H96&amp;, &amp;H8D14758B, &amp;H56508045, &amp;HFFFB66E8, &amp;H875FFFF, &amp;H50C0458D, &amp;HFFF895E8, &amp;HC0AFE8FF, &amp;H9005FFFF, &amp;H50000000, &amp;H50C0458D, &amp;H5080458D, &amp;H50E0458D, &amp;H3C41E8, &amp;HC75FF00, &amp;H50C0458D, &amp;HFFF86DE8, &amp;H86E853FF, &amp;H5FFFFC0, &amp;H90&amp;, &amp;HE0458D50, &amp;HC0458D50</td>
        </tr>
        <tr>
          <td id="L7589" data-line-number="7589"></td>
          <td id="LC7589">    pvAppendBuffer &amp;HE0458D50, &amp;H39B9E850, &amp;HE8530000, &amp;HFFFFC069, &amp;H90BB&amp;, &amp;H50C30300, &amp;HE3E85757, &amp;HE8000039, &amp;HFFFFC055, &amp;H4D8DC303, &amp;H515750E0, &amp;H3BF0E851, &amp;H4D8D0000, &amp;H4E8D51E0, &amp;HE0E85120, &amp;H33FFFFFA, &amp;H5F5E40C0, &amp;H5DE58B5B, &amp;H550010C2, &amp;HEC81EC8B, &amp;HC0&amp;, &amp;H7D8B5753, &amp;H5B066A10, &amp;H1FE85753, &amp;H85000035, &amp;H330774C0, &amp;H129E9C0, &amp;H53560000, &amp;HC003E857, &amp;H70BEFFFF, &amp;H3000001, &amp;HB0E850C6</td>
        </tr>
        <tr>
          <td id="L7590" data-line-number="7590"></td>
          <td id="LC7590">    pvAppendBuffer &amp;H83000034, &amp;H107401F8, &amp;HBFEBE853, &amp;HC603FFFF, &amp;HE8575750, &amp;H4292&amp;, &amp;HE857006A, &amp;HFFFFBFD9, &amp;H11005, &amp;H858D5000, &amp;HFFFFFF40, &amp;HC517E850, &amp;H8D53FFFF, &amp;HFFFF4085, &amp;HBAE850FF, &amp;H3FFFFBF, &amp;H6CE850C6, &amp;H83000034, &amp;H167401F8, &amp;HBFA7E853, &amp;HC603FFFF, &amp;H40858D50, &amp;H50FFFFFF, &amp;H4248E850, &amp;H8D530000, &amp;HFFFF4085, &amp;H93E850FF, &amp;H85000034, &amp;H330774C0, &amp;H9CE9C0, &amp;H758B0000, &amp;H40858D14</td>
        </tr>
        <tr>
          <td id="L7591" data-line-number="7591"></td>
          <td id="LC7591">    pvAppendBuffer &amp;H50FFFFFF, &amp;HFAACE856, &amp;H75FFFFFF, &amp;HA0458D08, &amp;HF7F4E850, &amp;H5EE8FFFF, &amp;H5FFFFBF, &amp;H170&amp;, &amp;HA0458D50, &amp;H40858D50, &amp;H50FFFFFF, &amp;H50D0458D, &amp;H3C54E8, &amp;HC75FF00, &amp;H50A0458D, &amp;HFFF7C9E8, &amp;H32E853FF, &amp;H5FFFFBF, &amp;H170&amp;, &amp;HD0458D50, &amp;HA0458D50, &amp;HD0458D50, &amp;H3865E850, &amp;HE8530000, &amp;HFFFFBF15, &amp;H170BB, &amp;H50C30300, &amp;H8FE85757, &amp;HE8000038, &amp;HFFFFBF01, &amp;H4D8DC303, &amp;H515750D0</td>
        </tr>
        <tr>
          <td id="L7592" data-line-number="7592"></td>
          <td id="LC7592">    pvAppendBuffer &amp;H3C03E851, &amp;H4D8D0000, &amp;H4E8D51D0, &amp;H23E85130, &amp;H33FFFFFA, &amp;H5F5E40C0, &amp;H5DE58B5B, &amp;H550010C2, &amp;HEC81EC8B, &amp;H1B0&amp;, &amp;HFE50858D, &amp;H5653FFFF, &amp;H500875FF, &amp;HFFFA94E8, &amp;H10758BFF, &amp;HFF30858D, &amp;H5056FFFF, &amp;HFFF691E8, &amp;H20468DFF, &amp;H90458D50, &amp;HF684E850, &amp;H46AFFFF, &amp;H858D535B, &amp;HFFFFFF30, &amp;H339CE850, &amp;HC0850000, &amp;H36B850F, &amp;H8D530000, &amp;HE8509045, &amp;H338A&amp;, &amp;H850FC085, &amp;H359&amp;</td>
        </tr>
        <tr>
          <td id="L7593" data-line-number="7593"></td>
          <td id="LC7593">    pvAppendBuffer &amp;H30858D53, &amp;H50FFFFFF, &amp;HFFBE6CE8, &amp;H90BEFF, &amp;HC6030000, &amp;H3319E850, &amp;HF8830000, &amp;H36850F01, &amp;H53000003, &amp;H5090458D, &amp;HFFBE4CE8, &amp;H50C603FF, &amp;H32FEE8, &amp;H1F88300, &amp;H31B850F, &amp;H53570000, &amp;HFFBE34E8, &amp;H50C603FF, &amp;H5090458D, &amp;H50E0458D, &amp;H37ADE8, &amp;HC75FF00, &amp;HFF50858D, &amp;HE850FFFF, &amp;HFFFFF5F6, &amp;HFFBE10E8, &amp;H50C603FF, &amp;H50E0458D, &amp;HFF50858D, &amp;H5050FFFF, &amp;H39A5E8, &amp;HBDF7E800</td>
        </tr>
        <tr>
          <td id="L7594" data-line-number="7594"></td>
          <td id="LC7594">    pvAppendBuffer &amp;HC603FFFF, &amp;HE0458D50, &amp;H30858D50, &amp;H50FFFFFF, &amp;HFF10858D, &amp;HE850FFFF, &amp;H3986&amp;, &amp;H50858D53, &amp;H50FFFFFE, &amp;HFEB0858D, &amp;HE850FFFF, &amp;H3EBF&amp;, &amp;H70858D53, &amp;H50FFFFFE, &amp;HFED0858D, &amp;HE850FFFF, &amp;H3EAB&amp;, &amp;HBDAFE853, &amp;HC083FFFF, &amp;H858D5050, &amp;HFFFFFF70, &amp;H3E95E850, &amp;HE8530000, &amp;HFFFFBD99, &amp;H5070C083, &amp;H5090458D, &amp;H3E82E8, &amp;H86E85300, &amp;H83FFFFBD, &amp;H8D5010C0, &amp;HFFFF7085, &amp;H858D50FF</td>
        </tr>
        <tr>
          <td id="L7595" data-line-number="7595"></td>
          <td id="LC7595">    pvAppendBuffer &amp;HFFFFFEB0, &amp;HE0458D50, &amp;H3C5BE850, &amp;H858D0000, &amp;HFFFFFED0, &amp;HB0858D50, &amp;H50FFFFFE, &amp;H5090458D, &amp;HFF70858D, &amp;HE850FFFF, &amp;HFFFFC45A, &amp;HBD47E853, &amp;HC083FFFF, &amp;H458D5010, &amp;HE85050E0, &amp;H36C2&amp;, &amp;H50E0458D, &amp;HFED0858D, &amp;H8D50FFFF, &amp;HFFFEB085, &amp;H9AE850FF, &amp;H83FFFFCC, &amp;HE800D065, &amp;HFFFFBD19, &amp;H8950C083, &amp;H858DD445, &amp;HFFFFFE50, &amp;H8DD84589, &amp;HFFFEB085, &amp;HDC4589FF, &amp;HFF10858D, &amp;H5053FFFF</td>
        </tr>
        <tr>
          <td id="L7596" data-line-number="7596"></td>
          <td id="LC7596">    pvAppendBuffer &amp;H3D44E8, &amp;H8DF08B00, &amp;HFFFF5085, &amp;HE85053FF, &amp;H3D35&amp;, &amp;HFE3BF88B, &amp;HFE8B0277, &amp;H56FF778D, &amp;HFF50858D, &amp;HE850FFFF, &amp;H3FF3&amp;, &amp;H574C20B, &amp;HEB43DB33, &amp;H56DB3302, &amp;HFF10858D, &amp;HE850FFFF, &amp;H3FDB&amp;, &amp;H574C20B, &amp;HEB5E026A, &amp;H6AF63302, &amp;H8DF30B04, &amp;H535BB045, &amp;HD0B5748B, &amp;H8CE85056, &amp;H5300003D, &amp;H5020468D, &amp;HFEF0858D, &amp;HE850FFFF, &amp;H3D7B&amp;, &amp;HE0458D53, &amp;H3108E850, &amp;H65830000</td>
        </tr>
        <tr>
          <td id="L7597" data-line-number="7597"></td>
          <td id="LC7597">    pvAppendBuffer &amp;H778D00E4, &amp;HE045C7FE, &amp;H1&amp;, &amp;H880FF685, &amp;HD5&amp;, &amp;H50E0458D, &amp;HFEF0858D, &amp;H8D50FFFF, &amp;HE850B045, &amp;HFFFFBC75, &amp;H50858D56, &amp;H50FFFFFF, &amp;H3F6AE8, &amp;H74C20B00, &amp;H47FF3305, &amp;HFF3302EB, &amp;H10858D56, &amp;H50FFFFFF, &amp;H3F52E8, &amp;H74C20B00, &amp;H58026A05, &amp;HC03302EB, &amp;H7C8BF80B, &amp;HFF85D0BD, &amp;H57537E74, &amp;HFF70858D, &amp;HE850FFFF, &amp;H3CFF&amp;, &amp;H20478D53, &amp;H90458D50, &amp;H3CF1E850, &amp;H458D0000</td>
        </tr>
        <tr>
          <td id="L7598" data-line-number="7598"></td>
          <td id="LC7598">    pvAppendBuffer &amp;H458D50E0, &amp;H858D5090, &amp;HFFFFFF70, &amp;HCB5FE850, &amp;HE853FFFF, &amp;HFFFFBBE1, &amp;H5010C083, &amp;HFF70858D, &amp;H8D50FFFF, &amp;H8D50B045, &amp;HFFFE9085, &amp;HB6E850FF, &amp;H8D00003A, &amp;HFFFEF085, &amp;H458D50FF, &amp;H458D50B0, &amp;H858D5090, &amp;HFFFFFF70, &amp;HC2B8E850, &amp;H8D53FFFF, &amp;HFFFE9085, &amp;H458D50FF, &amp;HE85050E0, &amp;H3A32&amp;, &amp;HF01EE83, &amp;HFFFF2B89, &amp;H8AE853FF, &amp;H83FFFFBB, &amp;H8D5010C0, &amp;H5050E045, &amp;H3505E8, &amp;HE0458D00</td>
        </tr>
        <tr>
          <td id="L7599" data-line-number="7599"></td>
          <td id="LC7599">    pvAppendBuffer &amp;HF0858D50, &amp;H50FFFFFE, &amp;H50B0458D, &amp;HFFCAE0E8, &amp;H458D53FF, &amp;H5EE850B0, &amp;HBEFFFFBB, &amp;H90&amp;, &amp;HE850C603, &amp;H300B&amp;, &amp;H1F8835F, &amp;HE8531374, &amp;HFFFFBB45, &amp;H8D50C603, &amp;H5050B045, &amp;H3DE9E8, &amp;H858D5300, &amp;HFFFFFF30, &amp;HB0458D50, &amp;H2FE1E850, &amp;HD8F70000, &amp;HEB40C01B, &amp;H5EC03302, &amp;H5DE58B5B, &amp;H55000CC2, &amp;HEC81EC8B, &amp;H280&amp;, &amp;HFD80858D, &amp;H5653FFFF, &amp;H500875FF, &amp;HFFF790E8, &amp;H10758BFF</td>
        </tr>
        <tr>
          <td id="L7600" data-line-number="7600"></td>
          <td id="LC7600">    pvAppendBuffer &amp;HFED0858D, &amp;H5056FFFF, &amp;HFFF37DE8, &amp;H30468DFF, &amp;H60858D50, &amp;H50FFFFFF, &amp;HFFF36DE8, &amp;H5B066AFF, &amp;HD0858D53, &amp;H50FFFFFE, &amp;H2FD5E8, &amp;HFC08500, &amp;H39185, &amp;H858D5300, &amp;HFFFFFF60, &amp;H2FC0E850, &amp;HC0850000, &amp;H37C850F, &amp;H8D530000, &amp;HFFFED085, &amp;HA2E850FF, &amp;HBEFFFFBA, &amp;H170&amp;, &amp;HE850C603, &amp;H2F4F&amp;, &amp;HF01F883, &amp;H35985, &amp;H858D5300, &amp;HFFFFFF60, &amp;HBA7FE850, &amp;HC603FFFF, &amp;H2F31E850</td>
        </tr>
        <tr>
          <td id="L7601" data-line-number="7601"></td>
          <td id="LC7601">    pvAppendBuffer &amp;HF8830000, &amp;H3B850F01, &amp;H57000003, &amp;HBA67E853, &amp;HC603FFFF, &amp;H60858D50, &amp;H50FFFFFF, &amp;H50C0458D, &amp;H33DDE8, &amp;HC75FF00, &amp;HFF00858D, &amp;HE850FFFF, &amp;HFFFFF2D6, &amp;HFFBA40E8, &amp;H50C603FF, &amp;H50C0458D, &amp;HFF00858D, &amp;H5050FFFF, &amp;H373CE8, &amp;HBA27E800, &amp;HC603FFFF, &amp;HC0458D50, &amp;HD0858D50, &amp;H50FFFFFE, &amp;HFEA0858D, &amp;HE850FFFF, &amp;H371D&amp;, &amp;H80858D53, &amp;H50FFFFFD, &amp;HFE10858D, &amp;HE850FFFF, &amp;H3AEF&amp;</td>
        </tr>
        <tr>
          <td id="L7602" data-line-number="7602"></td>
          <td id="LC7602">    pvAppendBuffer &amp;HB0858D53, &amp;H50FFFFFD, &amp;HFE40858D, &amp;HE850FFFF, &amp;H3ADB&amp;, &amp;HB9DFE853, &amp;HC683FFFF, &amp;H50C603A0, &amp;HFF30858D, &amp;HE850FFFF, &amp;H3AC3&amp;, &amp;HB9C7E853, &amp;H4005FFFF, &amp;H50000001, &amp;HFF60858D, &amp;HE850FFFF, &amp;H3AAB&amp;, &amp;HB9AFE853, &amp;HB0BFFFFF, &amp;H3000000, &amp;H858D50C7, &amp;HFFFFFF30, &amp;H10858D50, &amp;H50FFFFFE, &amp;H50C0458D, &amp;H3880E8, &amp;H40858D00, &amp;H50FFFFFE, &amp;HFE10858D, &amp;H8D50FFFF, &amp;HFFFF6085, &amp;H858D50FF</td>
        </tr>
        <tr>
          <td id="L7603" data-line-number="7603"></td>
          <td id="LC7603">    pvAppendBuffer &amp;HFFFFFF30, &amp;HC18CE850, &amp;HE853FFFF, &amp;HFFFFB969, &amp;H8D50C703, &amp;H5050C045, &amp;H32E5E8, &amp;HC0458D00, &amp;H40858D50, &amp;H50FFFFFE, &amp;HFE10858D, &amp;HE850FFFF, &amp;HFFFFC908, &amp;HF06583, &amp;HFFB93CE8, &amp;H89C603FF, &amp;H858DF445, &amp;HFFFFFD80, &amp;H8DF84589, &amp;HFFFE1085, &amp;HFC4589FF, &amp;HFEA0858D, &amp;H5053FFFF, &amp;H3968E8, &amp;H8DF08B00, &amp;HFFFF0085, &amp;HE85053FF, &amp;H3959&amp;, &amp;HFE3BF88B, &amp;HFE8B0277, &amp;H56FF778D, &amp;HFF00858D</td>
        </tr>
        <tr>
          <td id="L7604" data-line-number="7604"></td>
          <td id="LC7604">    pvAppendBuffer &amp;HE850FFFF, &amp;H3C17&amp;, &amp;H574C20B, &amp;HEB43DB33, &amp;H56DB3302, &amp;HFEA0858D, &amp;HE850FFFF, &amp;H3BFF&amp;, &amp;H574C20B, &amp;HEB5E026A, &amp;H6AF63302, &amp;H8DF30B06, &amp;H535B9045, &amp;HF0B5748B, &amp;HB0E85056, &amp;H53000039, &amp;H5030468D, &amp;HFE70858D, &amp;HE850FFFF, &amp;H399F&amp;, &amp;HC0458D53, &amp;H2D2CE850, &amp;H65830000, &amp;H778D00C4, &amp;HC045C7FE, &amp;H1&amp;, &amp;H880FF685, &amp;HE4&amp;, &amp;H50C0458D, &amp;HFE70858D, &amp;H8D50FFFF, &amp;HE8509045</td>
        </tr>
        <tr>
          <td id="L7605" data-line-number="7605"></td>
          <td id="LC7605">    pvAppendBuffer &amp;HFFFFBA21, &amp;H858D56, &amp;H50FFFFFF, &amp;H3B8EE8, &amp;H74C20B00, &amp;H47FF3305, &amp;HFF3302EB, &amp;HA0858D56, &amp;H50FFFFFE, &amp;H3B76E8, &amp;H74C20B00, &amp;H58026A05, &amp;HC03302EB, &amp;H7C8BF80B, &amp;HFF85F0BD, &amp;H89840F, &amp;H57530000, &amp;HFF30858D, &amp;HE850FFFF, &amp;H391F&amp;, &amp;H30478D53, &amp;H60858D50, &amp;H50FFFFFF, &amp;H390EE8, &amp;HC0458D00, &amp;H60858D50, &amp;H50FFFFFF, &amp;HFF30858D, &amp;HE850FFFF, &amp;HFFFFC7C4, &amp;HB7FBE853, &amp;HB005FFFF</td>
        </tr>
        <tr>
          <td id="L7606" data-line-number="7606"></td>
          <td id="LC7606">    pvAppendBuffer &amp;H50000000, &amp;HFF30858D, &amp;H8D50FFFF, &amp;H8D509045, &amp;HFFFDE085, &amp;HCEE850FF, &amp;H8D000036, &amp;HFFFE7085, &amp;H458D50FF, &amp;H858D5090, &amp;HFFFFFF60, &amp;H30858D50, &amp;H50FFFFFF, &amp;HFFBFDDE8, &amp;H858D53FF, &amp;HFFFFFDE0, &amp;HC0458D50, &amp;H47E85050, &amp;H83000036, &amp;H890F01EE, &amp;HFFFFFF1C, &amp;HB79FE853, &amp;HB005FFFF, &amp;H50000000, &amp;H50C0458D, &amp;H3118E850, &amp;H458D0000, &amp;H858D50C0, &amp;HFFFFFE70, &amp;H90458D50, &amp;HC73EE850, &amp;H8D53FFFF</td>
        </tr>
        <tr>
          <td id="L7607" data-line-number="7607"></td>
          <td id="LC7607">    pvAppendBuffer &amp;HE8509045, &amp;HFFFFB771, &amp;H170BE, &amp;H50C60300, &amp;H2C1EE8, &amp;HF8835F00, &amp;H53137401, &amp;HFFB758E8, &amp;H50C603FF, &amp;H5090458D, &amp;H39FCE850, &amp;H8D530000, &amp;HFFFED085, &amp;H458D50FF, &amp;HF4E85090, &amp;HF700002B, &amp;H40C01BD8, &amp;HC03302EB, &amp;HE58B5B5E, &amp;HCC25D, &amp;H56EC8B55, &amp;H8B08758B, &amp;H85048D06, &amp;H4&amp;, &amp;HC8E85650, &amp;HE8000029, &amp;HFFFFB70D, &amp;H850FF56, &amp;H4C25D5E, &amp;HEC8B5500, &amp;H8B084D8B, &amp;H7E8C1C1</td>
        </tr>
        <tr>
          <td id="L7608" data-line-number="7608"></td>
          <td id="LC7608">    pvAppendBuffer &amp;H7F7FE181, &amp;H125FF7F, &amp;H3010101, &amp;H1BC06BC9, &amp;HC25DC133, &amp;H8B550004, &amp;HB6EEE8EC, &amp;HD1B9FFFF, &amp;H8100478A, &amp;H474000E9, &amp;H8BC10300, &amp;H5051084D, &amp;H8D1075FF, &amp;H75FF3041, &amp;H50106A0C, &amp;H5020418D, &amp;HFFD6EEE8, &amp;HCC25DFF, &amp;HEC8B5500, &amp;H8B084D8B, &amp;HFF501045, &amp;H41010C75, &amp;H51835138, &amp;HB3E8003C, &amp;H5DFFFFFF, &amp;H55000CC2, &amp;H8B56EC8B, &amp;H7E830875, &amp;HD750148, &amp;H20E856, &amp;H46C70000, &amp;H248&amp;</td>
        </tr>
        <tr>
          <td id="L7609" data-line-number="7609"></td>
          <td id="LC7609">    pvAppendBuffer &amp;H10458B00, &amp;H50404601, &amp;H830C75FF, &amp;H56004456, &amp;HFFFF81E8, &amp;HC25D5EFF, &amp;H8B55000C, &amp;H758B56EC, &amp;H304E8B08, &amp;H2474C985, &amp;H2B58106A, &amp;H468D50C1, &amp;H6AC10320, &amp;H72E85000, &amp;H8300000A, &amp;H468D0CC4, &amp;HE8565020, &amp;H9&amp;, &amp;H306683, &amp;H4C25D5E, &amp;HEC8B5500, &amp;H8D10EC83, &amp;H5756F045, &amp;HC75FF50, &amp;HFFE5FCE8, &amp;H87D8BFF, &amp;H8DF0458D, &amp;H56561077, &amp;HE551E850, &amp;H5756FFFF, &amp;H4C57FF56, &amp;HE58B5E5F</td>
        </tr>
        <tr>
          <td id="L7610" data-line-number="7610"></td>
          <td id="LC7610">    pvAppendBuffer &amp;H8C25D, &amp;H51EC8B55, &amp;H758B5651, &amp;H487E8308, &amp;H83067401, &amp;H7502487E, &amp;H7BE8560A, &amp;H83FFFFFF, &amp;H8B004866, &amp;H458D384E, &amp;H468B50F8, &amp;HC8A40F3C, &amp;H3E1C103, &amp;H33E85150, &amp;H6A000039, &amp;HF8458D08, &amp;HCFE85650, &amp;H8BFFFFFE, &amp;H458D404E, &amp;H468B50F8, &amp;HC8A40F44, &amp;H3E1C103, &amp;HFE85150, &amp;H6A000039, &amp;HF8458D08, &amp;HABE85650, &amp;HFFFFFFFE, &amp;H468D0C75, &amp;H1FE85010, &amp;H5EFFFFE7, &amp;HC25DE58B, &amp;H8B550008</td>
        </tr>
        <tr>
          <td id="L7611" data-line-number="7611"></td>
          <td id="LC7611">    pvAppendBuffer &amp;H10EC83EC, &amp;H8B575653, &amp;H506A087D, &amp;HE857006A, &amp;H999&amp;, &amp;H570CC483, &amp;HE80C75FF, &amp;HFFFFE541, &amp;HC933C033, &amp;H47895340, &amp;H8BA20F48, &amp;H5D8D5BF3, &amp;H890389F0, &amp;H4B890473, &amp;HC538908, &amp;HFFB54BE8, &amp;HF845F6FF, &amp;H719FB902, &amp;H5750047, &amp;H47711EB9, &amp;HE98100, &amp;H3004740, &amp;H4C4789C1, &amp;H8B5B5E5F, &amp;H8C25DE5, &amp;HEC8B5500, &amp;H5614558B, &amp;HEA83F633, &amp;H8B307801, &amp;H8B530C45, &amp;H2B57085D, &amp;H903C8DD8</td>
        </tr>
        <tr>
          <td id="L7612" data-line-number="7612"></td>
          <td id="LC7612">    pvAppendBuffer &amp;H8B104529, &amp;HC0333B0C, &amp;HC013CE03, &amp;HD0830F03, &amp;H1EA8300, &amp;H458BF08B, &amp;H380C8910, &amp;H79FC7F8D, &amp;H8B5B5FE2, &amp;HC25D5EC6, &amp;H8B550010, &amp;H8B5653EC, &amp;HC68B1075, &amp;H1FE28399, &amp;H23C8D57, &amp;H8105FFC1, &amp;H1FE6&amp;, &amp;H4E057980, &amp;H46E0CE83, &amp;H8B0C558B, &amp;H59206ADE, &amp;HC28BCE2B, &amp;HDBF7E8D3, &amp;HDB1BCE8B, &amp;HD823E2D3, &amp;H5D89C933, &amp;H85D8B10, &amp;H110758B, &amp;H1304BB54, &amp;H75F685C9, &amp;H74C98504, &amp;HBB448B2C</td>
        </tr>
        <tr>
          <td id="L7613" data-line-number="7613"></td>
          <td id="LC7613">    pvAppendBuffer &amp;H3D23308, &amp;H3D213C1, &amp;HBB4489C6, &amp;HD28308, &amp;H8503C783, &amp;H8D1274D2, &amp;HC033BB34, &amp;H768D1601, &amp;H8BC01304, &amp;H75D285D0, &amp;H5B5E5FF1, &amp;HCC25D, &amp;H83EC8B55, &amp;H558B30EC, &amp;H5D8B5314, &amp;H56C38B0C, &amp;H2BFF3357, &amp;HEC4589C2, &amp;H1EB880F, &amp;H558B0000, &amp;H8BC88BEC, &amp;HE1C10845, &amp;HFC4D8905, &amp;H85B8348B, &amp;H470C75F6, &amp;H8920E983, &amp;HBCE9FC4D, &amp;H56000001, &amp;HFFCA53E8, &amp;H8BD08BFF, &amp;HD45589CA, &amp;HD285E6D3</td>
        </tr>
        <tr>
          <td id="L7614" data-line-number="7614"></td>
          <td id="LC7614">    pvAppendBuffer &amp;H478D177E, &amp;H7DC33B01, &amp;H8458B10, &amp;H2B59206A, &amp;HB8548BCA, &amp;HBEAD304, &amp;H205D8BF2, &amp;H65F7C68B, &amp;HFC458B1C, &amp;H2BE1C383, &amp;HF28BD445, &amp;H7589D803, &amp;HF45D89F0, &amp;HFB831F79, &amp;H748E0FE0, &amp;HF7000001, &amp;H33CB8BDB, &amp;H89EED3DB, &amp;H5D89F075, &amp;HFF685F4, &amp;H15E84, &amp;H25C38B00, &amp;H8000001F, &amp;H83480579, &amp;H8B40E0C8, &amp;H45890C4D, &amp;H99C38BDC, &amp;H31FE283, &amp;H14558BC2, &amp;H2B05F8C1, &amp;HDC458BC8, &amp;HC085CA2B</td>
        </tr>
        <tr>
          <td id="L7615" data-line-number="7615"></td>
          <td id="LC7615">    pvAppendBuffer &amp;H45217575, &amp;H45214AF0, &amp;H89CA03DC, &amp;H4D89E455, &amp;HE845C7E0, &amp;H1&amp;, &amp;H8C0FCF3B, &amp;HEF&amp;, &amp;H8B08458B, &amp;H48D105D, &amp;HF8458988, &amp;H479D285, &amp;H3EBC033, &amp;HF793048B, &amp;HF04503E6, &amp;HD283D0F7, &amp;H89C93300, &amp;H558BF055, &amp;H130203F8, &amp;HE84503C9, &amp;H4D130289, &amp;HE4558BDC, &amp;H4F86D83, &amp;HDC65834A, &amp;HE84D8900, &amp;H49E04D8B, &amp;H89E45589, &amp;HCF3BE04D, &amp;H95E9BA7D, &amp;H83000000, &amp;H4A00E865, &amp;H5589CA03</td>
        </tr>
        <tr>
          <td id="L7616" data-line-number="7616"></td>
          <td id="LC7616">    pvAppendBuffer &amp;HD44D89D8, &amp;H8C0FCF3B, &amp;H83&amp;, &amp;H2B5B206A, &amp;HE445C7D8, &amp;H1&amp;, &amp;H8308458B, &amp;H8900E065, &amp;H5D8BD05D, &amp;H88048DDC, &amp;H85F84589, &amp;H330479D2, &amp;H8B06EBC0, &amp;H48B1045, &amp;H8BE6F790, &amp;H3F08BCB, &amp;HD283E075, &amp;H89C03300, &amp;HD68BE055, &amp;H550BE2D3, &amp;HF84D8BE8, &amp;H1103D2F7, &amp;H5503C013, &amp;HD083E4, &amp;H8BE44589, &amp;HD04D8BC1, &amp;HD68B1089, &amp;H83F0758B, &amp;HEAD304E8, &amp;H89D44D8B, &amp;H558BE855, &amp;H45894AD8</td>
        </tr>
        <tr>
          <td id="L7617" data-line-number="7617"></td>
          <td id="LC7617">    pvAppendBuffer &amp;H558949F8, &amp;HD44D89D8, &amp;H9F7DCF3B, &amp;H83F45D8B, &amp;H7400187D, &amp;HFF56530A, &amp;H8BE81875, &amp;H8BFFFFFD, &amp;H4D8BEC55, &amp;H8458BFC, &amp;H3B0C5D8B, &amp;H298E0FFA, &amp;H8BFFFFFE, &amp;H558B0C5D, &amp;H87D8B14, &amp;HDB85C933, &amp;H458B247E, &amp;H8DD32B10, &amp;H48D9034, &amp;H79C0850A, &amp;HEBC03304, &amp;H39068B02, &amp;H67728F04, &amp;H83410877, &amp;HCB3B04C6, &amp;H6583E47C, &amp;H538D000C, &amp;H845C7FF, &amp;H1&amp;, &amp;H3978D285, &amp;H8B10458B, &amp;H3F32BF2</td>
        </tr>
        <tr>
          <td id="L7618" data-line-number="7618"></td>
          <td id="LC7618">    pvAppendBuffer &amp;H1C8D1475, &amp;H79F685B0, &amp;HEBC93304, &amp;H330B8B02, &amp;H3D1F7C0, &amp;HC013970C, &amp;H89084D03, &amp;H4513970C, &amp;H65834E0C, &amp;HEB83000C, &amp;H1EA8304, &amp;H79084589, &amp;H187D83D4, &amp;H6A0C7400, &amp;HFF016A00, &amp;HE7E81875, &amp;H5FFFFFFC, &amp;HE58B5B5E, &amp;H1CC25D, &amp;H83EC8B55, &amp;H8B5328EC, &amp;H5756145D, &amp;HF32FB83, &amp;H1B88E, &amp;H18758B00, &amp;H2B99C38B, &amp;H8BF88BC2, &amp;HFFD156C3, &amp;H1075FF57, &amp;H7D89C72B, &amp;HC75FFF0, &amp;HFFFC4589</td>
        </tr>
        <tr>
          <td id="L7619" data-line-number="7619"></td>
          <td id="LC7619">    pvAppendBuffer &amp;HC5E80875, &amp;H8BFFFFFF, &amp;H8B561045, &amp;H8D56FC75, &amp;H458BF814, &amp;H5589520C, &amp;HB80C8DD8, &amp;H5108458B, &amp;H8DDC4D89, &amp;H8950B804, &amp;H9DE8E445, &amp;H8BFFFFFF, &amp;H468D184D, &amp;H6AF63301, &amp;H81148D04, &amp;H89047A8D, &amp;HF4558932, &amp;H8904518D, &amp;HEC558937, &amp;H558B3289, &amp;HE07D89F0, &amp;H855F3189, &amp;H3467ED2, &amp;H8DC22BC0, &amp;H45898104, &amp;HFC458BE8, &amp;H8DC22B40, &amp;H4D8B8104, &amp;HF845890C, &amp;H2B08458B, &amp;HC5589C1, &amp;H89E8558B</td>
        </tr>
        <tr>
          <td id="L7620" data-line-number="7620"></td>
          <td id="LC7620">    pvAppendBuffer &amp;H5D8B0845, &amp;H8048BF8, &amp;H89F87D01, &amp;H3018B03, &amp;H145D8BCF, &amp;HD7030289, &amp;H10C6D83, &amp;H7508458B, &amp;HFC75FFE1, &amp;H50EC458B, &amp;H50E475FF, &amp;HFFFBB4E8, &amp;H184D8BFF, &amp;H89FC75FF, &amp;HE0458B01, &amp;HDC75FF50, &amp;HFB9FE850, &amp;H4D8BFFFF, &amp;HFC558BF4, &amp;H8B018942, &amp;H48D184D, &amp;HC4589D1, &amp;HE0C1C28B, &amp;H50C10304, &amp;HC75FF52, &amp;H51F475FF, &amp;HFFFEDFE8, &amp;H184D8BFF, &amp;H8DF0558B, &amp;H71890841, &amp;HDC45890C, &amp;H48D3089</td>
        </tr>
        <tr>
          <td id="L7621" data-line-number="7621"></td>
          <td id="LC7621">    pvAppendBuffer &amp;H4718912, &amp;H45893189, &amp;H7EC08508, &amp;HFC458B1E, &amp;H40105D8B, &amp;H558BC22B, &amp;HC10C8D08, &amp;H46B3048B, &amp;HCF030189, &amp;HF47CF23B, &amp;H8B145D8B, &amp;H48DFC75, &amp;H458B5036, &amp;H75FF50DC, &amp;H26E850D8, &amp;H8BFFFFFB, &amp;H189EC4D, &amp;H8B01468D, &amp;H348D184D, &amp;HC458B00, &amp;H50515056, &amp;H1F2E8, &amp;HFC4D8B00, &amp;H1418D56, &amp;H458BD82B, &amp;H2BDB0310, &amp;H98048DD9, &amp;HC75FF50, &amp;HFAEFE850, &amp;HF08BFFFF, &amp;H840FF685, &amp;H87&amp;</td>
        </tr>
        <tr>
          <td id="L7622" data-line-number="7622"></td>
          <td id="LC7622">    pvAppendBuffer &amp;H8310558B, &amp;H148DFCC2, &amp;H1C0339A, &amp;H2BC01332, &amp;H85F08BD7, &amp;HEBF275F6, &amp;H10558B6E, &amp;H851B0C8D, &amp;H33067EC9, &amp;HF3FA8BC0, &amp;H8458BAB, &amp;H3B980C8D, &amp;H8B5476C8, &amp;H148D0C75, &amp;HFCC283DA, &amp;H5589046A, &amp;H9E348D10, &amp;H5F147589, &amp;H186583, &amp;HDA8BCF2B, &amp;H760C753B, &amp;H2B018B21, &amp;H326F7F7, &amp;HD2831845, &amp;H83030100, &amp;HDF2B00D2, &amp;H3B185589, &amp;HE5770C75, &amp;H8B08458B, &amp;H758B1055, &amp;H89D72B18, &amp;H14758B33</td>
        </tr>
        <tr>
          <td id="L7623" data-line-number="7623"></td>
          <td id="LC7623">    pvAppendBuffer &amp;H3B105589, &amp;H5FC177C8, &amp;HE58B5B5E, &amp;H14C25D, &amp;H51EC8B55, &amp;H5D8B5351, &amp;H83575614, &amp;H8E0F32FB, &amp;HA1&amp;, &amp;H8B0C7D8B, &amp;H8758BC3, &amp;H8BC22B99, &amp;H8BC88BD3, &amp;HF9D11845, &amp;H4D89D12B, &amp;HF85589FC, &amp;H53D81C8D, &amp;HC8048D52, &amp;H8F048D50, &amp;H8E048D50, &amp;HFD76E850, &amp;H4D8BFFFF, &amp;H18458BFC, &amp;H48D5153, &amp;H458B5088, &amp;H87048DF8, &amp;HA1E85650, &amp;H53FFFFFF, &amp;H8BFC75FF, &amp;H5753185D, &amp;H8DF87D8B, &amp;HE850BE04</td>
        </tr>
        <tr>
          <td id="L7624" data-line-number="7624"></td>
          <td id="LC7624">    pvAppendBuffer &amp;HFFFFFF8C, &amp;H85FC758B, &amp;H8B1B7EFF, &amp;HC8D1045, &amp;H77048DB0, &amp;H8B83148D, &amp;H4528D02, &amp;H498D0189, &amp;H1EF8304, &amp;H5356F175, &amp;H50B3048D, &amp;HF9B3E853, &amp;H458BFFFF, &amp;H75FF5614, &amp;H83048D10, &amp;HA2E85350, &amp;HEBFFFFF9, &amp;H7EDB857D, &amp;H107D8B09, &amp;HC033CB8B, &amp;H458BABF3, &amp;H107D8B08, &amp;H8D980C8D, &amp;H75899F34, &amp;H76C83B14, &amp;HC458B5D, &amp;H8B98048D, &amp;HC083085D, &amp;HFC4589FC, &amp;H106583, &amp;H8304E983, &amp;H89001865</td>
        </tr>
        <tr>
          <td id="L7625" data-line-number="7625"></td>
          <td id="LC7625">    pvAppendBuffer &amp;H45890C75, &amp;H76F73BF8, &amp;H8BDE8B2F, &amp;H83068BF0, &amp;H21F704EB, &amp;H3FC768D, &amp;HD28303, &amp;H89104503, &amp;H18551303, &amp;H186583, &amp;H3B105589, &amp;H8BDE77DF, &amp;H5D8B1475, &amp;HFC458B08, &amp;H8904EE83, &amp;HCB3B1475, &amp;H5E5FB277, &amp;H5DE58B5B, &amp;H550014C2, &amp;H8B51EC8B, &amp;H65831455, &amp;HEA8300FC, &amp;H1445C701, &amp;H1&amp;, &amp;H458B3978, &amp;H8B565308, &amp;H8B570C75, &amp;H1C8D107D, &amp;H2BF02B90, &amp;H1E0C8BF8, &amp;HD1F7C033, &amp;HC0130B03</td>
        </tr>
        <tr>
          <td id="L7626" data-line-number="7626"></td>
          <td id="LC7626">    pvAppendBuffer &amp;H89144D03, &amp;H5B8D1F0C, &amp;HFC4513FC, &amp;HFC6583, &amp;H8901EA83, &amp;HDD791445, &amp;H8B5B5E5F, &amp;H10C25DE5, &amp;HEC8B5500, &amp;H80EC81, &amp;H8B560000, &amp;H6A570C75, &amp;H7D8D5920, &amp;HBEA5F380, &amp;HFD&amp;, &amp;H5080458D, &amp;H2087E850, &amp;HFE830000, &amp;H83127402, &amp;HD7404FE, &amp;H8D0C75FF, &amp;H50508045, &amp;HE7FE8, &amp;H1EE8300, &amp;H7D8BDA79, &amp;H80758D08, &amp;HF359206A, &amp;H8B5E5FA5, &amp;H8C25DE5, &amp;HEC8B5500, &amp;HFF575653, &amp;H72E80875</td>
        </tr>
        <tr>
          <td id="L7627" data-line-number="7627"></td>
          <td id="LC7627">    pvAppendBuffer &amp;H8BFFFFF6, &amp;H6AE853D8, &amp;H8BFFFFF6, &amp;H62E852D0, &amp;H8BFFFFF6, &amp;H87D33F8, &amp;HC78BF78B, &amp;HCFC1C333, &amp;HC1F23308, &amp;HCE8B08C0, &amp;H3310C9C1, &amp;H33C733C1, &amp;HC3335FC6, &amp;H5E084533, &amp;H4C25D5B, &amp;HEC8B5500, &amp;H8758B56, &amp;HAAE836FF, &amp;HFFFFFFFF, &amp;H6890476, &amp;HFFFFA0E8, &amp;H876FFFF, &amp;HE8044689, &amp;HFFFFFF95, &amp;H890C76FF, &amp;H8AE80846, &amp;H89FFFFFF, &amp;H5D5E0C46, &amp;H550004C2, &amp;H8B53EC8B, &amp;H5756085D, &amp;H77BB60F</td>
        </tr>
        <tr>
          <td id="L7628" data-line-number="7628"></td>
          <td id="LC7628">    pvAppendBuffer &amp;H243B60F, &amp;HB73B60F, &amp;HF53B60F, &amp;HB08E7C1, &amp;H4BB60FF8, &amp;H43B60F03, &amp;H8E7C10D, &amp;HE6C1F80B, &amp;H43B60F08, &amp;H8E7C108, &amp;HE2C1F80B, &amp;H43B60F08, &amp;HC1F00B06, &amp;HB60F08E1, &amp;HE6C10143, &amp;HFF00B08, &amp;HC10C43B6, &amp;HF00B08E6, &amp;HA43B60F, &amp;HB60FD00B, &amp;HE2C10543, &amp;HFD00B08, &amp;HE2C103B6, &amp;HFD00B08, &amp;HB0E43B6, &amp;HC5389C8, &amp;H943B60F, &amp;HB08E1C1, &amp;H87389C8, &amp;H443B60F, &amp;HC1047B89, &amp;HB5F08E1</td>
        </tr>
        <tr>
          <td id="L7629" data-line-number="7629"></td>
          <td id="LC7629">    pvAppendBuffer &amp;HB895EC8, &amp;H4C25D5B, &amp;HEC8B5500, &amp;H66E85756, &amp;H8BFFFFAC, &amp;H93BF0875, &amp;H3000006, &amp;H36FF50C7, &amp;H1FD2E8, &amp;HE8068900, &amp;HFFFFAC4D, &amp;HFF50C703, &amp;HC0E80476, &amp;H8900001F, &amp;H3AE80446, &amp;H3FFFFAC, &amp;H76FF50C7, &amp;H1FADE808, &amp;H46890000, &amp;HAC27E808, &amp;HC703FFFF, &amp;HC76FF50, &amp;H1F9AE8, &amp;H46895F00, &amp;HC25D5E0C, &amp;H8B550004, &amp;HC7D83EC, &amp;H56157400, &amp;H8B0C75FF, &amp;H6A0875, &amp;H2FE856, &amp;H68A0000</td>
        </tr>
        <tr>
          <td id="L7630" data-line-number="7630"></td>
          <td id="LC7630">    pvAppendBuffer &amp;H5E0CC483, &amp;H8C25D, &amp;H8BEC8B55, &amp;H458B1055, &amp;HF08B5608, &amp;H1274D285, &amp;HC7D8B57, &amp;HC8AF82B, &amp;H460E8837, &amp;H7501EA83, &amp;H5D5E5FF5, &amp;HEC8B55C3, &amp;H85104D8B, &amp;HF1F74C9, &amp;H560C45B6, &amp;HC069F18B, &amp;H1010101, &amp;H87D8B57, &amp;HF302E9C1, &amp;H83CE8BAB, &amp;HAAF303E1, &amp;H458B5E5F, &amp;H55C35D08, &amp;H8B56EC8B, &amp;HE8560875, &amp;HFFFFF48D, &amp;HCE8BD08B, &amp;HC9C1D633, &amp;H8C2C110, &amp;H3308CEC1, &amp;H33D633D1, &amp;HC25D5EC2</td>
        </tr>
        <tr>
          <td id="L7631" data-line-number="7631"></td>
          <td id="LC7631">    pvAppendBuffer &amp;H8B550004, &amp;H758B56EC, &amp;HE836FF08, &amp;HFFFFFFCB, &amp;H890476FF, &amp;HFFC1E806, &amp;H76FFFFFF, &amp;H4468908, &amp;HFFFFB6E8, &amp;HC76FFFF, &amp;HE8084689, &amp;HFFFFFFAB, &amp;H5E0C4689, &amp;H4C25D, &amp;H83EC8B55, &amp;H658340EC, &amp;HC03300C4, &amp;H53E44521, &amp;H66A5756, &amp;H8DDB3359, &amp;H66AC87D, &amp;HC05D8943, &amp;H6A59ABF3, &amp;HE87D8D04, &amp;HF3E05D89, &amp;H8D575FAB, &amp;HE850C045, &amp;HFFFFAB09, &amp;H5010C083, &amp;H50C0458D, &amp;H1F0CE8, &amp;H458D5700</td>
        </tr>
        <tr>
          <td id="L7632" data-line-number="7632"></td>
          <td id="LC7632">    pvAppendBuffer &amp;H42E850C0, &amp;H8D00002B, &amp;H26EBFF70, &amp;H50E0458D, &amp;H29AAE8, &amp;H458D5600, &amp;HE850C0, &amp;HB00002E, &amp;H570E74C2, &amp;H8D0875FF, &amp;H5050E045, &amp;H2961E8, &amp;H458D4E00, &amp;H3B5057E0, &amp;HFFD177F3, &amp;HACE80875, &amp;H5F00002B, &amp;HE58B5B5E, &amp;H4C25D, &amp;H83EC8B55, &amp;H658360EC, &amp;HC03300A4, &amp;H53D44521, &amp;HA6A5756, &amp;H8DDB3359, &amp;HA6AA87D, &amp;HA05D8943, &amp;H6A59ABF3, &amp;HD87D8D06, &amp;HF3D05D89, &amp;H8D575FAB, &amp;HE850A045</td>
        </tr>
        <tr>
          <td id="L7633" data-line-number="7633"></td>
          <td id="LC7633">    pvAppendBuffer &amp;HFFFFAA75, &amp;HB005&amp;, &amp;H458D5000, &amp;H76E850A0, &amp;H5700001E, &amp;H50A0458D, &amp;H2AACE8, &amp;HFF708D00, &amp;H458D26EB, &amp;H14E850D0, &amp;H56000029, &amp;H50A0458D, &amp;H2D6AE8, &amp;H74C20B00, &amp;H75FF570E, &amp;HD0458D08, &amp;HCBE85050, &amp;H4E000028, &amp;H57D0458D, &amp;H77F33B50, &amp;H875FFD1, &amp;H2B16E8, &amp;H5B5E5F00, &amp;HC25DE58B, &amp;H8B550004, &amp;H14EC83EC, &amp;HFF575653, &amp;H5CE80C75, &amp;HFFFFFFE1, &amp;H45890875, &amp;HE151E8FC, &amp;HF08BFFFF</td>
        </tr>
        <tr>
          <td id="L7634" data-line-number="7634"></td>
          <td id="LC7634">    pvAppendBuffer &amp;HFFA9F4E8, &amp;H79405FF, &amp;HE8500000, &amp;HFFFFE13F, &amp;HE8084589, &amp;HFFFFA9E1, &amp;H79805, &amp;H2CE85000, &amp;H33FFFFE1, &amp;H43F88BDB, &amp;H89F85D89, &amp;HC6E8EC5D, &amp;HE9FFFFA9, &amp;HA6&amp;, &amp;HFFA9BCE8, &amp;H79405FF, &amp;H56500000, &amp;HFFBDEEE8, &amp;HFC085FF, &amp;H10684, &amp;HE836FF00, &amp;HC1F&amp;, &amp;H8BF44589, &amp;H30FFFC45, &amp;HC12E8, &amp;H45895000, &amp;HF4458BF0, &amp;H75FF5650, &amp;HBA3FE8FC, &amp;H4D8BFFFF, &amp;H761939F4, &amp;H83018B0F</td>
        </tr>
        <tr>
          <td id="L7635" data-line-number="7635"></td>
          <td id="LC7635">    pvAppendBuffer &amp;H7500813C, &amp;H1894807, &amp;HF177C33B, &amp;H39F04D8B, &amp;H8B0F7619, &amp;H813C8301, &amp;H48077500, &amp;HC33B0189, &amp;H75FFF177, &amp;HF226E8FC, &amp;H458BFFFF, &amp;HFC7589F4, &amp;H5608758B, &amp;HF075FF57, &amp;H89F44589, &amp;H73E8087D, &amp;HF7FFFFBB, &amp;HF88BEC5D, &amp;HF202E856, &amp;H75FFFFFF, &amp;HF1FAE8F0, &amp;H1EE8FFFF, &amp;H8BFFFFA9, &amp;H9805F475, &amp;H50000007, &amp;HBD4DE856, &amp;HC085FFFF, &amp;HFF46850F, &amp;HE856FFFF, &amp;HFFFFF1D8, &amp;HE8FC75FF, &amp;HFFFFF1D0</td>
        </tr>
        <tr>
          <td id="L7636" data-line-number="7636"></td>
          <td id="LC7636">    pvAppendBuffer &amp;HE80875FF, &amp;HFFFFF1C8, &amp;HEC7D83, &amp;HBE8D0F, &amp;H458B0000, &amp;HE830FF0C, &amp;HB5B&amp;, &amp;HC933F08B, &amp;H7589C033, &amp;H63940EC, &amp;H988C0F, &amp;H458B0000, &amp;H4568D0C, &amp;H7D89C72B, &amp;HFC7529FC, &amp;H8BF44589, &amp;H1E3B0C75, &amp;H7FEC758B, &amp;HFC458B2E, &amp;H8BF44503, &amp;H45891004, &amp;H5624EBF0, &amp;HFFF173E8, &amp;HFC75FFFF, &amp;HFFF16BE8, &amp;H875FFFF, &amp;HFFF163E8, &amp;H5DE857FF, &amp;H33FFFFF1, &amp;H835BEBC0, &amp;H3B00F065, &amp;H8B0B7F1F</td>
        </tr>
        <tr>
          <td id="L7637" data-line-number="7637"></td>
          <td id="LC7637">    pvAppendBuffer &amp;H48BFC45, &amp;H8458910, &amp;H658304EB, &amp;H458B0008, &amp;H8452BF0, &amp;H2B0855F7, &amp;H850289C1, &amp;H3B0874C9, &amp;HC91B0845, &amp;H3907EB41, &amp;HC91B0845, &amp;HC085D9F7, &amp;H74F8458B, &amp;H89C38B05, &amp;H8343F845, &amp;H1E3B04C2, &amp;HFF798E0F, &amp;H8957FFFF, &amp;HF102E806, &amp;HFE8BFFFF, &amp;H5E5FC78B, &amp;H5DE58B5B, &amp;H550008C2, &amp;HEC83EC8B, &amp;H5756531C, &amp;H8B107D8B, &amp;HC1DE8B37, &amp;H5D8902E3, &amp;HA803E8E8, &amp;HFF53FFFF, &amp;H33D08B10, &amp;H105589C9</td>
        </tr>
        <tr>
          <td id="L7638" data-line-number="7638"></td>
          <td id="LC7638">    pvAppendBuffer &amp;HF7EF685, &amp;HC12B078B, &amp;H8987048B, &amp;H3B418A04, &amp;H8BF17CCE, &amp;H4D8B087D, &amp;H3B078B0C, &amp;H8B027601, &amp;H8D198BCF, &amp;HC63B1B04, &amp;HC68B0A7F, &amp;H8BC22B99, &amp;H43FBD1D8, &amp;HE0C1C38B, &amp;HE4458902, &amp;HFFA7B8E8, &amp;HC1CB8BFF, &amp;HFF5102E1, &amp;H89D38B10, &amp;H172BFC45, &amp;HC7ED285, &amp;H8BFC7D8B, &amp;HF3C033CA, &amp;H87D8BAB, &amp;HC933078B, &amp;H1A7EC085, &amp;H8DFC7D8B, &amp;H7D8B9714, &amp;H41C12B08, &amp;H8987048B, &amp;H4528D02, &amp;HC83B078B</td>
        </tr>
        <tr>
          <td id="L7639" data-line-number="7639"></td>
          <td id="LC7639">    pvAppendBuffer &amp;H72E8EF7C, &amp;H8BFFFFA7, &amp;H2E1C1CB, &amp;H8B10FF51, &amp;HCB8B0C55, &amp;H7D89F88B, &amp;H890A2BF8, &amp;HC985084D, &amp;HC033077E, &amp;H4D8BABF3, &amp;H33028B08, &amp;H7EC085FF, &amp;HF8558B1A, &amp;H8B8A0C8D, &amp;HC72B0C55, &amp;H82048B47, &amp;H498D0189, &amp;H3B028B04, &amp;H8BEF7CF8, &amp;H3E7C1FB, &amp;HE8EC7D89, &amp;HFFFFA721, &amp;H5310FF57, &amp;HE8084589, &amp;H96F&amp;, &amp;HE7C1F88B, &amp;HF07D8902, &amp;HFFA708E8, &amp;H10FF57FF, &amp;H89107D8B, &amp;H3F8B0C45, &amp;HBD46E857</td>
        </tr>
        <tr>
          <td id="L7640" data-line-number="7640"></td>
          <td id="LC7640">    pvAppendBuffer &amp;H4589FFFF, &amp;H74C085F4, &amp;HD3C88B18, &amp;H1FE83E7, &amp;H206A0F7E, &amp;H8BC82B59, &amp;H408B1045, &amp;HBE8D304, &amp;HC75FFF8, &amp;H875FF53, &amp;HFFF875FF, &amp;H19E8FC75, &amp;HFFFFFFF5, &amp;HDB03F475, &amp;H1006E857, &amp;H6A500000, &amp;H75FF5600, &amp;H75FF5310, &amp;HF262E808, &amp;HF33BFFFF, &amp;HF38B027C, &amp;H91DE856, &amp;HD2330000, &amp;HF685F88B, &amp;H458B197E, &amp;H8DDE2B08, &amp;HF8B981C, &amp;HCA2B038B, &amp;H45B8D42, &amp;H3B8F0489, &amp;H83EF7CD6, &amp;H1076013F</td>
        </tr>
        <tr>
          <td id="L7641" data-line-number="7641"></td>
          <td id="LC7641">    pvAppendBuffer &amp;H3C83078B, &amp;H8750087, &amp;H83078948, &amp;HF07701F8, &amp;H8BF075FF, &amp;HE8530C5D, &amp;H1913&amp;, &amp;HFFA658E8, &amp;H50FF53FF, &amp;HEC75FF08, &amp;H53085D8B, &amp;H18FEE8, &amp;HA643E800, &amp;HFF53FFFF, &amp;H75FF0850, &amp;H105D8BE8, &amp;H18E9E853, &amp;H2EE80000, &amp;H53FFFFA6, &amp;H8B0850FF, &amp;H5D8BE475, &amp;HE85356FC, &amp;H18D3&amp;, &amp;HFFA618E8, &amp;H50FF53FF, &amp;HF85D8B08, &amp;HC0E85356, &amp;HE8000018, &amp;HFFFFA605, &amp;H850FF53, &amp;H5E5FC78B, &amp;H5DE58B5B</td>
        </tr>
        <tr>
          <td id="L7642" data-line-number="7642"></td>
          <td id="LC7642">    pvAppendBuffer &amp;H55000CC2, &amp;HEC83EC8B, &amp;H5D8B532C, &amp;H4438D10, &amp;H890100F6, &amp;H1175E045, &amp;HC75FF53, &amp;HE80875FF, &amp;H36A&amp;, &amp;H35EE9, &amp;H53575600, &amp;HE80875FF, &amp;HFFFFB7B4, &amp;HF08B1B8B, &amp;H5D89CB8B, &amp;H5E1C1DC, &amp;HBC2EE851, &amp;HF88BFFFF, &amp;H1075FF57, &amp;HFFFB91E8, &amp;H1075FFFF, &amp;H57084589, &amp;HFD7DE856, &amp;H8956FFFF, &amp;H69E8F045, &amp;HFFFFFFEE, &amp;HE8571075, &amp;HFFFFB778, &amp;HFC458957, &amp;HFFEE57E8, &amp;HC1FB8BFF, &amp;H7D8902E7</td>
        </tr>
        <tr>
          <td id="L7643" data-line-number="7643"></td>
          <td id="LC7643">    pvAppendBuffer &amp;HA573E8D8, &amp;HFF57FFFF, &amp;HEC458910, &amp;H197EDB85, &amp;H8DE04D8B, &amp;HD003FC57, &amp;H18BF38B, &amp;H8904498D, &amp;HFC528D02, &amp;H7501EE83, &amp;HA54BE8F1, &amp;HFF57FFFF, &amp;H33F08B10, &amp;HF47589C9, &amp;H2D7EDB85, &amp;H8308558B, &amp;HC283FCC7, &amp;H8BF70304, &amp;HF3B087D, &amp;H28B047D, &amp;HC03302EB, &amp;H83410689, &amp;HEE8304C2, &amp;H7CCB3B04, &amp;HF4758BE9, &amp;HE7C1FB8B, &amp;H8458B02, &amp;HEDDEE850, &amp;H2E8FFFF, &amp;H57FFFFA5, &amp;HD08B10FF, &amp;H85E85589</td>
        </tr>
        <tr>
          <td id="L7644" data-line-number="7644"></td>
          <td id="LC7644">    pvAppendBuffer &amp;H330D7EDB, &amp;H8BCB8BC0, &amp;H8BABF3FA, &amp;H2E7C1FB, &amp;H52565653, &amp;HFFF6B2E8, &amp;H85C033FF, &amp;H8B2D7EDB, &amp;H4D8BE855, &amp;HFCC283F0, &amp;H304C183, &amp;HF07D8BD7, &amp;H47D073B, &amp;H2EB318B, &amp;H3289F633, &amp;H4C18340, &amp;H3B04EA83, &amp;H8BE97CC3, &amp;H2E7C1FB, &amp;H51F04D8B, &amp;HFFED7BE8, &amp;HC1F38BFF, &amp;H758903E6, &amp;HA497E8E0, &amp;HFF56FFFF, &amp;H89F08B10, &amp;H8AE80875, &amp;H8BFFFFA4, &amp;H3E1C1CB, &amp;H3310FF51, &amp;HF84589C9, &amp;H2C7EDB85</td>
        </tr>
        <tr>
          <td id="L7645" data-line-number="7645"></td>
          <td id="LC7645">    pvAppendBuffer &amp;H8BFC7D8B, &amp;H3E0C1C3, &amp;H3FCC083, &amp;H4578DF0, &amp;H47D0F3B, &amp;H2EB028B, &amp;H689C033, &amp;H4C28341, &amp;H3B04EE83, &amp;H8BE97CCB, &amp;H2E7C1FB, &amp;HE8FC75FF, &amp;HFFFFED1C, &amp;H699E853, &amp;HF36B0000, &amp;HC1F00303, &amp;H758902E6, &amp;HA42FE8D4, &amp;HFF56FFFF, &amp;HC4D8B10, &amp;H4589D233, &amp;H891F6AFC, &amp;H18BF055, &amp;H5EE44589, &amp;H317EC085, &amp;H3C8DD88B, &amp;H8BC03399, &amp;HE0D340CE, &amp;H10750785, &amp;H7901EE83, &amp;H421F6A07, &amp;H5E04EF83</td>
        </tr>
        <tr>
          <td id="L7646" data-line-number="7646"></td>
          <td id="LC7646">    pvAppendBuffer &amp;HE57CD33B, &amp;H8BDC5D8B, &amp;HE4458BFB, &amp;H890C4D8B, &amp;HE7C1F055, &amp;HFD03B02, &amp;H978D&amp;, &amp;HFF68500, &amp;H8088&amp;, &amp;H84D8B00, &amp;H8DFC75FF, &amp;HFF530F04, &amp;H5050F875, &amp;HFFF213E8, &amp;H75FF53FF, &amp;HF475FFFC, &amp;HFFEC75FF, &amp;HE6E8F875, &amp;H8B000003, &amp;HCE8B0C45, &amp;HC033108B, &amp;H40F0552B, &amp;H4D8BE0D3, &amp;H9104850C, &amp;H75FF2C74, &amp;HF8458BFC, &amp;H875FF53, &amp;H75FFC703, &amp;HD5E850E8, &amp;H53FFFFF1, &amp;HFFFC75FF, &amp;H75FFF475</td>
        </tr>
        <tr>
          <td id="L7647" data-line-number="7647"></td>
          <td id="LC7647">    pvAppendBuffer &amp;H875FFEC, &amp;H3A8E8, &amp;H84D8B00, &amp;H458B0CEB, &amp;HF84D8B08, &amp;H89084D89, &amp;HEE83F845, &amp;H8B897901, &amp;H4D8BF055, &amp;H1F6A420C, &amp;H5EF05589, &amp;H8C0F113B, &amp;HFFFFFF69, &amp;HFC75FF53, &amp;HFFF475FF, &amp;H75FFEC75, &amp;H36BE808, &amp;H458B0000, &amp;HE830FF10, &amp;H5A7&amp;, &amp;HF08BD233, &amp;H1E7EDB85, &amp;H308458B, &amp;HC4589C7, &amp;HE8BF88B, &amp;HCA2B078B, &amp;H47F8D42, &amp;H3B8E0489, &amp;H8BEF7CD3, &amp;H3E83D87D, &amp;H8B107601, &amp;H863C8306</td>
        </tr>
        <tr>
          <td id="L7648" data-line-number="7648"></td>
          <td id="LC7648">    pvAppendBuffer &amp;H48087500, &amp;HF8830689, &amp;HFFF07701, &amp;H5D8BD475, &amp;H98E853FC, &amp;HE8000015, &amp;HFFFFA2DD, &amp;H850FF53, &amp;H8BE075FF, &amp;HE853085D, &amp;H1583&amp;, &amp;HFFA2C8E8, &amp;H50FF53FF, &amp;HE075FF08, &amp;H53F85D8B, &amp;H156EE8, &amp;HA2B3E800, &amp;HFF53FFFF, &amp;H5D8B0850, &amp;HE85357F4, &amp;H155B&amp;, &amp;HFFA2A0E8, &amp;H50FF53FF, &amp;HEC5D8B08, &amp;H48E85357, &amp;HE8000015, &amp;HFFFFA28D, &amp;H850FF53, &amp;H57E85D8B, &amp;H1535E853, &amp;H7AE80000, &amp;H53FFFFA2</td>
        </tr>
        <tr>
          <td id="L7649" data-line-number="7649"></td>
          <td id="LC7649">    pvAppendBuffer &amp;H5F0850FF, &amp;H5B5EC68B, &amp;HC25DE58B, &amp;H8B55000C, &amp;H2CEC83EC, &amp;H758B5653, &amp;HFF565710, &amp;H45E80875, &amp;H8BFFFFB4, &amp;HC1FB8B1E, &amp;H458902E7, &amp;HE45D89E0, &amp;HE8D47D89, &amp;HFFFFA241, &amp;H8B10FF57, &amp;H89C933D0, &amp;HDB85F855, &amp;H68B0F7E, &amp;H48BC12B, &amp;H8A048986, &amp;H7CCB3B41, &amp;HA21FE8F1, &amp;HFF57FFFF, &amp;HE0758B10, &amp;HF88BD38B, &amp;H2BEC7D89, &amp;H7ED28516, &amp;H33CA8B09, &amp;H8BABF3C0, &amp;H68BEC7D, &amp;HC085C933, &amp;H148D147E</td>
        </tr>
        <tr>
          <td id="L7650" data-line-number="7650"></td>
          <td id="LC7650">    pvAppendBuffer &amp;H41C12B97, &amp;H8986048B, &amp;H4528D02, &amp;HC83B068B, &amp;HFB8BEF7C, &amp;H8903E7C1, &amp;HDAE8DC7D, &amp;H57FFFFA1, &amp;HF08B10FF, &amp;HE8F47589, &amp;HFFFFA1CD, &amp;H8910FF57, &amp;H48D0845, &amp;H7EC0851B, &amp;H8BC88B0D, &amp;HF3C033FE, &amp;HC1FB8BAB, &amp;HC75303E7, &amp;H1FC3744, &amp;HE8000000, &amp;H3FF&amp;, &amp;HE6C1F08B, &amp;HD8758902, &amp;HFFA198E8, &amp;H10FF56FF, &amp;H330C4D8B, &amp;HF04589F6, &amp;H75891F6A, &amp;H5F018BFC, &amp;H267EC085, &amp;H8B81148D, &amp;H8BC033D9</td>
        </tr>
        <tr>
          <td id="L7651" data-line-number="7651"></td>
          <td id="LC7651">    pvAppendBuffer &amp;HE0D340CF, &amp;H10750285, &amp;H7901EF83, &amp;H461F6A07, &amp;H5F04EA83, &amp;HE57C333B, &amp;H89E45D8B, &amp;H758BFC75, &amp;H56368BF8, &amp;HFFB79FE8, &amp;HE84589FF, &amp;H1874C085, &amp;HE6D3C88B, &amp;H7E01FB83, &amp;H59206A0F, &amp;H458BC82B, &amp;H4408BF8, &amp;HF00BE8D3, &amp;HA76E856, &amp;H4D8B0000, &amp;HE445890C, &amp;HE9FC458B, &amp;H94&amp;, &amp;H880FFF85, &amp;H85&amp;, &amp;HFFF4758B, &amp;H48DF075, &amp;H75FF539E, &amp;HE8505008, &amp;HFFFFEF54, &amp;H8DE875FF, &amp;H75FF1B04</td>
        </tr>
        <tr>
          <td id="L7652" data-line-number="7652"></td>
          <td id="LC7652">    pvAppendBuffer &amp;H53006AE4, &amp;H50F875FF, &amp;HE80875FF, &amp;HFFFFECA0, &amp;H8B0C458B, &amp;H33108BCF, &amp;HFC552BC0, &amp;H8BE0D340, &amp;H4850C4D, &amp;HFF2F7491, &amp;H458BF075, &amp;HFF565308, &amp;H48DEC75, &amp;H11E85098, &amp;HFFFFFFEF, &amp;H48DE875, &amp;HE475FF1B, &amp;HFF53006A, &amp;H5650F875, &amp;HFFEC5FE8, &amp;HC4D8BFF, &amp;HC68B08EB, &amp;H8908758B, &amp;HEF830845, &amp;H8B847901, &amp;H7589FC45, &amp;H1F6A40F4, &amp;H5FFC4589, &amp;H8C0F013B, &amp;HFFFFFF64, &amp;HFF10458B, &amp;H2F5E830</td>
        </tr>
        <tr>
          <td id="L7653" data-line-number="7653"></td>
          <td id="LC7653">    pvAppendBuffer &amp;HD2330000, &amp;HDB85F08B, &amp;H458B177E, &amp;H983C8DF4, &amp;H78B0E8B, &amp;H8D42CA2B, &amp;H489047F, &amp;H7CD33B8E, &amp;H13E83EF, &amp;H68B1076, &amp;H863C83, &amp;H89480875, &amp;H1F88306, &amp;H7D8BF077, &amp;HF45D8BDC, &amp;HECE85357, &amp;HE8000012, &amp;HFFFFA031, &amp;H850FF53, &amp;H8BD875FF, &amp;HE853F05D, &amp;H12D7&amp;, &amp;HFFA01CE8, &amp;H50FF53FF, &amp;H85D8B08, &amp;HC4E85357, &amp;HE8000012, &amp;HFFFFA009, &amp;H850FF53, &amp;H8BD45D8B, &amp;H5753F87D, &amp;H12AEE8</td>
        </tr>
        <tr>
          <td id="L7654" data-line-number="7654"></td>
          <td id="LC7654">    pvAppendBuffer &amp;H9FF3E800, &amp;HFF57FFFF, &amp;H8B530850, &amp;HE853EC5D, &amp;H129B&amp;, &amp;HFF9FE0E8, &amp;H50FF53FF, &amp;HE0458B08, &amp;HE8AAE850, &amp;H8B5FFFFF, &amp;H8B5B5EC6, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H5308458B, &amp;H56145D8B, &amp;H187D8B57, &amp;H8D0CF76B, &amp;H4589B804, &amp;H56F30314, &amp;H75FF5357, &amp;H39E85010, &amp;H56FFFFF0, &amp;H8D18758B, &amp;H5756BB3C, &amp;H530C75FF, &amp;HFFEDE3E8, &amp;H85D8BFF, &amp;H5036048D, &amp;HE8535753, &amp;HFFFFEA6D, &amp;H3314558B, &amp;H104589C9</td>
        </tr>
        <tr>
          <td id="L7655" data-line-number="7655"></td>
          <td id="LC7655">    pvAppendBuffer &amp;HF685F98B, &amp;H48B167E, &amp;H8D0289BB, &amp;HC890452, &amp;HFE3B47BB, &amp;H558BF07C, &amp;H10458B14, &amp;H2A75C085, &amp;H267EF685, &amp;H8B0C5D8B, &amp;H3B078BFA, &amp;H8758B04, &amp;H4C78341, &amp;HF17CCE3B, &amp;HE7DCE3B, &amp;H8D087D8B, &amp;H48B3104, &amp;H8B043B87, &amp;H52560B76, &amp;H520C75FF, &amp;HFFF0F6E8, &amp;H5B5E5FFF, &amp;H14C25D, &amp;H81EC8B55, &amp;H108EC, &amp;HF8A58300, &amp;HFFFFFE, &amp;HFEFCA583, &amp;H8B00FFFF, &amp;H57560C45, &amp;H8D593C6A, &amp;HFFFEF8B5</td>
        </tr>
        <tr>
          <td id="L7656" data-line-number="7656"></td>
          <td id="LC7656">    pvAppendBuffer &amp;HF845C7FF, &amp;H10&amp;, &amp;HFF00BD8D, &amp;HA5F3FFFF, &amp;HFEF8B58D, &amp;HCE8BFFFF, &amp;H2BFC7589, &amp;HC4589C1, &amp;H300C8B53, &amp;H448BFE8B, &amp;HDB330430, &amp;H8910758B, &amp;H4589F44D, &amp;HFF5150F0, &amp;HFF04DE74, &amp;H1EE8DE34, &amp;H1FFFFAC, &amp;HF44D8B07, &amp;H43045711, &amp;H8DF0458B, &amp;HFB83087F, &amp;H8BDE7210, &amp;H458BFC75, &amp;H8C6830C, &amp;H1F86D83, &amp;H75FC7589, &amp;H5BF633B8, &amp;H266A006A, &amp;H7CF5B4FF, &amp;HFFFFFFFF, &amp;HFF78F5B4, &amp;HDEE8FFFF</td>
        </tr>
        <tr>
          <td id="L7657" data-line-number="7657"></td>
          <td id="LC7657">    pvAppendBuffer &amp;H1FFFFAB, &amp;HFEF8F584, &amp;H9411FFFF, &amp;HFFFEFCF5, &amp;HFE8346FF, &amp;H8BD5720F, &amp;HB58D087D, &amp;HFFFFFEF8, &amp;HFF59206A, &amp;HA5F30875, &amp;HFFB4F2E8, &amp;H875FFFF, &amp;HFFB4EAE8, &amp;H8B5E5FFF, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H5310EC83, &amp;HDB335756, &amp;HC75FF53, &amp;H1475FF53, &amp;HFFAB8CE8, &amp;H75FF53FF, &amp;HF045890C, &amp;HFF53F28B, &amp;H7AE81875, &amp;H53FFFFAB, &amp;H891075FF, &amp;HFA8BF445, &amp;H1875FF53, &amp;HFFAB68E8, &amp;H75FF53FF, &amp;HFC458910</td>
        </tr>
        <tr>
          <td id="L7658" data-line-number="7658"></td>
          <td id="LC7658">    pvAppendBuffer &amp;H1475FF53, &amp;HE8F85589, &amp;HFFFFAB55, &amp;H458BD88B, &amp;H6ADE03F4, &amp;HD6135E00, &amp;HD713D803, &amp;HD77D73B, &amp;HD83B0472, &amp;H75010773, &amp;HF85583FC, &amp;H8458B01, &amp;H4D0BC933, &amp;H5FDE0BF0, &amp;H3308895E, &amp;HFC5503C9, &amp;H13045889, &amp;H5089F84D, &amp;HC488908, &amp;H5DE58B5B, &amp;H550014C2, &amp;H4D8BEC8B, &amp;HF6335608, &amp;HC18B0DEB, &amp;HD1C22B99, &amp;H41C82BF8, &amp;H838E348D, &amp;HEE7F32F9, &amp;H5D5EC68B, &amp;H550004C2, &amp;H8B53EC8B, &amp;H5756085D</td>
        </tr>
        <tr>
          <td id="L7659" data-line-number="7659"></td>
          <td id="LC7659">    pvAppendBuffer &amp;H49D348D, &amp;HE8000000, &amp;HFFFF9D6D, &amp;H5610FF56, &amp;H6AF88B, &amp;HF193E857, &amp;HC483FFFF, &amp;H8B1F890C, &amp;H5B5E5FC7, &amp;H4C25D, &amp;H83EC8B55, &amp;H8B5330EC, &amp;H5756085D, &amp;H75FF066A, &amp;H30E8530C, &amp;H6A00001E, &amp;HFF206A06, &amp;H458D0C75, &amp;H5AE850D0, &amp;H6A000012, &amp;H8DF08B06, &amp;H458D084B, &amp;H50FA8BD0, &amp;HC3835151, &amp;H1123E838, &amp;HC6030000, &amp;H75FF066A, &amp;H1303890C, &amp;H8458BD7, &amp;H8910C083, &amp;H50500453, &amp;H1108E8</td>
        </tr>
        <tr>
          <td id="L7660" data-line-number="7660"></td>
          <td id="LC7660">    pvAppendBuffer &amp;H84D8B00, &amp;H4189066A, &amp;HD0458D40, &amp;H89515150, &amp;H93E84451, &amp;H8B00001F, &amp;HF003084D, &amp;H518BFA13, &amp;H8BD62B30, &amp;HF71B3471, &amp;H7234713B, &amp;H3B05771D, &amp;H16763051, &amp;HEBFFCF83, &amp;H85B8D03, &amp;H7B113B01, &amp;H23038B04, &amp;HC73B0443, &amp;H895FEF74, &amp;H895E3471, &amp;H8B5B3051, &amp;H8C25DE5, &amp;HEC8B5500, &amp;H108EC81, &amp;H56530000, &amp;HC75FF57, &amp;HFF78858D, &amp;HE850FFFF, &amp;H919&amp;, &amp;HFF78858D, &amp;HE850FFFF, &amp;HFFFFB31F</td>
        </tr>
        <tr>
          <td id="L7661" data-line-number="7661"></td>
          <td id="LC7661">    pvAppendBuffer &amp;HFF78858D, &amp;HE850FFFF, &amp;HFFFFB313, &amp;HFF78858D, &amp;HE850FFFF, &amp;HFFFFB307, &amp;HFEF89D8D, &amp;H45C7FFFF, &amp;H20C&amp;, &amp;H8BF63300, &amp;HFFFF788D, &amp;H7C858BFF, &amp;H81FFFFFF, &amp;HFFEDE9, &amp;H1B086A00, &amp;HF88D89C6, &amp;H89FFFFFE, &amp;HFFFEFC85, &amp;H548B5FFF, &amp;H448BF83B, &amp;H8C8BFC3B, &amp;HFFFF783D, &amp;HF85589FF, &amp;H10C2AC0F, &amp;H7C3D848B, &amp;H83FFFFFF, &amp;H748901E2, &amp;HCA2BFC3B, &amp;HE981C61B, &amp;HFFFF&amp;, &amp;HF83D8C89, &amp;H1BFFFFFE</td>
        </tr>
        <tr>
          <td id="L7662" data-line-number="7662"></td>
          <td id="LC7662">    pvAppendBuffer &amp;H3D8489C6, &amp;HFFFFFEFC, &amp;HF845B70F, &amp;HF83B4489, &amp;H8308C783, &amp;HB27278FF, &amp;HFF688D8B, &amp;H858BFFFF, &amp;HFFFFFF6C, &amp;HFF0558B, &amp;HF10C1AC, &amp;HFF6885B7, &amp;HE183FFFF, &amp;H68858901, &amp;H2BFFFFFF, &amp;H6CB589D1, &amp;H8BFFFFFF, &amp;HCE1BF44D, &amp;H7FFFEA81, &amp;H95890000, &amp;HFFFFFF70, &amp;HC033CE1B, &amp;HFF748D89, &amp;HF40FFFF, &amp;H8310CAAC, &amp;HF9C101E2, &amp;H50C22B10, &amp;HFEF8858D, &amp;H8D50FFFF, &amp;HFFFF7885, &amp;HB2E850FF, &amp;H83000007</td>
        </tr>
        <tr>
          <td id="L7663" data-line-number="7663"></td>
          <td id="LC7663">    pvAppendBuffer &amp;HF010C6D, &amp;HFFFF1E85, &amp;H8558BFF, &amp;H78F5848A, &amp;H8BFFFFFF, &amp;HFF78F58C, &amp;H488FFFF, &amp;HF5848B72, &amp;HFFFFFF7C, &amp;H8C1AC0F, &amp;H8808F8C1, &amp;H4601724C, &amp;H7210FE83, &amp;H5B5E5FD7, &amp;HC25DE58B, &amp;H8B550008, &amp;H84D8BEC, &amp;H8B56D233, &amp;H6A570C75, &amp;H5FF12B11, &amp;H30E048B, &amp;HFD00301, &amp;HEAC1C2B6, &amp;H8D018908, &amp;HEF830449, &amp;H5FE97501, &amp;H8C25D5E, &amp;HEC8B5500, &amp;HC75FF56, &amp;H5608758B, &amp;HFFFFC1E8, &amp;H44468DFF</td>
        </tr>
        <tr>
          <td id="L7664" data-line-number="7664"></td>
          <td id="LC7664">    pvAppendBuffer &amp;H15E85650, &amp;H5E000001, &amp;H8C25D, &amp;H83EC8B55, &amp;H8B5344EC, &amp;H5756085D, &amp;H8B59116A, &amp;HBC7D8DF3, &amp;HD2E8A5F3, &amp;H5FFFF9A, &amp;H544&amp;, &amp;HBC458D50, &amp;HFF88E850, &amp;H458BFFFF, &amp;H25D0F7FC, &amp;H80&amp;, &amp;H8D5E116A, &amp;HD0F7FF50, &amp;HC11FEAC1, &amp;HD0231FE8, &amp;HF7BC458D, &amp;H89C32BD2, &amp;H7A8D0845, &amp;H8BD7F701, &amp;H428D180C, &amp;H23032301, &amp;H8BC80BCF, &amp;HB890845, &amp;H83045B8D, &amp;HE77501EE, &amp;H8B5B5E5F, &amp;H4C25DE5</td>
        </tr>
        <tr>
          <td id="L7665" data-line-number="7665"></td>
          <td id="LC7665">    pvAppendBuffer &amp;HEC8B5500, &amp;H8D44EC83, &amp;H6A56BC45, &amp;H56F63344, &amp;HEE97E850, &amp;H4D8BFFFF, &amp;HCC48308, &amp;HA8918B, &amp;HD2850000, &amp;HB60F1174, &amp;H983184, &amp;H44890000, &amp;H3B46BCB5, &amp;H8DEF72F2, &amp;H44C7BC45, &amp;H1BC95, &amp;H51500000, &amp;HFFFF24E8, &amp;HE58B5EFF, &amp;H4C25D, &amp;H8BEC8B55, &amp;H3356084D, &amp;HD68B57F6, &amp;H1403FE8B, &amp;HC2B60FB9, &amp;H8908EAC1, &amp;H8347B904, &amp;HEE7C10FF, &amp;H8B405103, &amp;H2EAC1C2, &amp;H6B03E083, &amp;H418905D2</td>
        </tr>
        <tr>
          <td id="L7666" data-line-number="7666"></td>
          <td id="LC7666">    pvAppendBuffer &amp;HB1140340, &amp;HC1C2B60F, &amp;H48908EA, &amp;HFE8346B1, &amp;H1EE7C10, &amp;H5E5F4051, &amp;H4C25D, &amp;H83EC8B55, &amp;H8B534CEC, &amp;H458D0C5D, &amp;H2BD233B4, &amp;H895756D8, &amp;HFF33FC5D, &amp;HD285C933, &amp;H48D1E78, &amp;H85D8B93, &amp;H3B4758D, &amp;H8B048BF0, &amp;H8D06AF0F, &amp;HF803FC76, &amp;H7ECA3B41, &amp;HFC5D8BF0, &amp;H8901728D, &amp;HCE8BF875, &amp;H7D11FE83, &amp;H85D8B2D, &amp;HC62BC28B, &amp;H830C758B, &amp;H348D44C6, &amp;H8B048B86, &amp;H8D06AF0F, &amp;HC069FC76</td>
        </tr>
        <tr>
          <td id="L7667" data-line-number="7667"></td>
          <td id="LC7667">    pvAppendBuffer &amp;H140&amp;, &amp;H8341F803, &amp;HE97C11F9, &amp;H8BF8758B, &amp;H7C89FC5D, &amp;HD68BB495, &amp;H7C11FA83, &amp;HB4458D95, &amp;HFF2AE850, &amp;H7D8BFFFF, &amp;HB4758D08, &amp;HF359116A, &amp;H5B5E5FA5, &amp;HC25DE58B, &amp;H8B550008, &amp;HC558BEC, &amp;H3344EC83, &amp;H4B60FC9, &amp;H8D448911, &amp;HF98341BC, &amp;H8DF27C10, &amp;H45C7BC45, &amp;H1FC&amp;, &amp;H75FF5000, &amp;HFE07E808, &amp;HE58BFFFF, &amp;H8C25D, &amp;H81EC8B55, &amp;H178EC, &amp;H57565300, &amp;H7D8DC033, &amp;H88DB33B1</td>
        </tr>
        <tr>
          <td id="L7668" data-line-number="7668"></td>
          <td id="LC7668">    pvAppendBuffer &amp;H6AABB05D, &amp;HC75FF0C, &amp;HAB66ABAB, &amp;HB4458DAA, &amp;HECF2E850, &amp;HC483FFFF, &amp;HD05D880C, &amp;H7D8DC033, &amp;H59076AD1, &amp;H46AABF3, &amp;H8DAAAB66, &amp;H6A50B045, &amp;H875FF20, &amp;HFF34858D, &amp;HE850FFFF, &amp;HFFFFC040, &amp;H458D206A, &amp;H8D5050D0, &amp;HFFFF3485, &amp;H10E850FF, &amp;H8DFFFFBB, &amp;H8D50E045, &amp;H8D50D045, &amp;HFFFE8885, &amp;HD7E850FF, &amp;H6AFFFFCA, &amp;HC0335908, &amp;HF3D07D8D, &amp;HD0458AAB, &amp;H458D206A, &amp;H8D5050D0, &amp;HFFFF3485</td>
        </tr>
        <tr>
          <td id="L7669" data-line-number="7669"></td>
          <td id="LC7669">    pvAppendBuffer &amp;HDCE850FF, &amp;H33FFFFBA, &amp;HD07D8DC0, &amp;HFF59086A, &amp;HABF31475, &amp;H8DD0458A, &amp;H75FFF17D, &amp;H88C03310, &amp;HABABF05D, &amp;HAAAB66AB, &amp;HFE88858D, &amp;HE850FFFF, &amp;HFFFFCB4A, &amp;HF714458B, &amp;HFE083D8, &amp;HF0458D50, &amp;H88858D50, &amp;H50FFFFFE, &amp;HFFCB31E8, &amp;H1C758BFF, &amp;H7D8BC033, &amp;H45894018, &amp;H4539560C, &amp;HFF167524, &amp;H858D2075, &amp;HFFFFFF34, &amp;H74E85057, &amp;H56FFFFBA, &amp;HEB2075FF, &amp;H858D5701, &amp;HFFFFFE88, &amp;HCAFCE850</td>
        </tr>
        <tr>
          <td id="L7670" data-line-number="7670"></td>
          <td id="LC7670">    pvAppendBuffer &amp;HC68BFFFF, &amp;HE083D8F7, &amp;H458D500F, &amp;H858D50F0, &amp;HFFFFFE88, &amp;HCAE4E850, &amp;H458DFFFF, &amp;HFF5350F0, &amp;HA0E81475, &amp;H8D00001B, &amp;H5350F845, &amp;H1B95E856, &amp;H106A0000, &amp;H458D535B, &amp;H858D50F0, &amp;HFFFFFE88, &amp;HCAB8E850, &amp;H7D83FFFF, &amp;H2C750124, &amp;H8D2875FF, &amp;HFFFE8885, &amp;H78E850FF, &amp;H6AFFFFC9, &amp;H34858D7C, &amp;H6AFFFFFF, &amp;HC2E85000, &amp;H8AFFFFEB, &amp;HFFFF3485, &amp;HCC483FF, &amp;H73EBC033, &amp;H50C0458D, &amp;HFE88858D</td>
        </tr>
        <tr>
          <td id="L7671" data-line-number="7671"></td>
          <td id="LC7671">    pvAppendBuffer &amp;HE850FFFF, &amp;HFFFFC94B, &amp;H8D287D8B, &amp;HC18BC04D, &amp;HF82BD232, &amp;H320F048A, &amp;H41D00A01, &amp;H7501EB83, &amp;H187D8BF3, &amp;H2075FF56, &amp;H1275D284, &amp;H34858D57, &amp;H50FFFFFF, &amp;HFFB9AAE8, &amp;HC5D21FF, &amp;H23E805EB, &amp;H6AFFFFEB, &amp;H34858D7C, &amp;H6AFFFFFF, &amp;H5AE85000, &amp;H8AFFFFEB, &amp;HFFFF348D, &amp;HC07D8DFF, &amp;H330CC483, &amp;HABABABC0, &amp;HC04D8AAB, &amp;H5F0C458B, &amp;HE58B5B5E, &amp;H24C25D, &amp;H8BEC8B55, &amp;HB60F0855, &amp;H4AB60F02</td>
        </tr>
        <tr>
          <td id="L7672" data-line-number="7672"></td>
          <td id="LC7672">    pvAppendBuffer &amp;H8E0C101, &amp;HB60FC10B, &amp;HE0C1024A, &amp;HFC10B08, &amp;HC1034AB6, &amp;HC10B08E0, &amp;H4C25D, &amp;H8BEC8B55, &amp;HB60F0855, &amp;HB60F0342, &amp;HE0C1024A, &amp;HFC10B08, &amp;HC1014AB6, &amp;HC10B08E0, &amp;HC10AB60F, &amp;HC10B08E0, &amp;H4C25D, &amp;H53EC8B55, &amp;H33085D8B, &amp;HC1CB8BD2, &amp;H564110E9, &amp;H8D006A57, &amp;HFFFFFF81, &amp;H8BF1F77F, &amp;H10E6C1F0, &amp;HE3F7C68B, &amp;HCE03C88B, &amp;HD283D1F7, &amp;H83C03300, &amp;HD2F701C1, &amp;HC203C013, &amp;HE8C1E6F7</td>
        </tr>
        <tr>
          <td id="L7673" data-line-number="7673"></td>
          <td id="LC7673">    pvAppendBuffer &amp;H3FA8B1F, &amp;H8BF80BFF, &amp;H8BE3F7C7, &amp;H3CA8BF0, &amp;HBAF7&amp;, &amp;H13588000, &amp;H72CA3BC8, &amp;H33D3F718, &amp;H13F303C0, &amp;H1C683C0, &amp;H4900D083, &amp;H3B4FC803, &amp;HEBEC73CA, &amp;H3D23319, &amp;HEBD013F3, &amp;HC9334707, &amp;HC813F303, &amp;HFA81D103, &amp;H80000000, &amp;HC78BEF72, &amp;H5D5B5E5F, &amp;H550004C2, &amp;H458BEC8B, &amp;HC558B08, &amp;H406A5756, &amp;H104D2B59, &amp;HFFA397E8, &amp;H104D8BFF, &amp;H458BF08B, &amp;H8BFA8B08, &amp;HA4E80C55, &amp;HBFFFFA3</td>
        </tr>
        <tr>
          <td id="L7674" data-line-number="7674"></td>
          <td id="LC7674">    pvAppendBuffer &amp;H5FD70BC6, &amp;HCC25D5E, &amp;HEC8B5500, &amp;H5324EC83, &amp;H7D8B5756, &amp;H75FF5708, &amp;HAA95E80C, &amp;HFF57FFFF, &amp;H45891075, &amp;HAA89E808, &amp;HFF57FFFF, &amp;H45891475, &amp;HAA7DE80C, &amp;HF78BFFFF, &amp;HD1F04589, &amp;H75FF56EE, &amp;HAA6DE818, &amp;HFF56FFFF, &amp;HD88B1C75, &amp;HE8EC5D89, &amp;HFFFFAA5F, &amp;H2075FF56, &amp;HE8104589, &amp;HFFFFAA53, &amp;HE8458953, &amp;HFFCCE6E8, &amp;H458950FF, &amp;HCD45E81C, &amp;H758BFFFF, &amp;HD4E85610, &amp;H50FFFFCC, &amp;HE8204589</td>
        </tr>
        <tr>
          <td id="L7675" data-line-number="7675"></td>
          <td id="LC7675">    pvAppendBuffer &amp;HFFFFCD33, &amp;HFF1C75FF, &amp;H59E80C75, &amp;HFFFFFFA7, &amp;H45892075, &amp;HC75FFFC, &amp;HFFA74BE8, &amp;H75FF53FF, &amp;HF84589FC, &amp;HE80875FF, &amp;HFFFFEF57, &amp;HF875FF56, &amp;H75FFD88B, &amp;H145D8908, &amp;HFFEF46E8, &amp;H56F08BFF, &amp;H18758953, &amp;HFFA96EE8, &amp;H79C085FF, &amp;HEC75FF19, &amp;HE853F38B, &amp;HFFFFA52F, &amp;H89D88B56, &amp;HEDE81445, &amp;H8BFFFFDD, &amp;H53561875, &amp;HFFAA9DE8, &amp;H1075FFFF, &amp;HFFF44589, &amp;H27E8E875, &amp;H56FFFFA7, &amp;H89F475FF</td>
        </tr>
        <tr>
          <td id="L7676" data-line-number="7676"></td>
          <td id="LC7676">    pvAppendBuffer &amp;HE850E045, &amp;HFFFFA72E, &amp;H89F075FF, &amp;HE850DC45, &amp;HFFFFA6D4, &amp;H85E44589, &amp;H8B1A74FF, &amp;HD88B2475, &amp;HE853574F, &amp;HFFFFA8CB, &amp;H85460688, &amp;H8BF175FF, &amp;H758B145D, &amp;H1C75FF18, &amp;HFFDD93E8, &amp;H2075FFFF, &amp;HFFDD8BE8, &amp;HFC75FFFF, &amp;HFFDD83E8, &amp;HF875FFFF, &amp;HFFDD7BE8, &amp;H75E853FF, &amp;H56FFFFDD, &amp;HFFDD6FE8, &amp;HF475FFFF, &amp;HFFDD67E8, &amp;HE075FFFF, &amp;HFFDD5FE8, &amp;HDC75FFFF, &amp;HFFDD57E8, &amp;H875FFFF, &amp;HFFDD4FE8</td>
        </tr>
        <tr>
          <td id="L7677" data-line-number="7677"></td>
          <td id="LC7677">    pvAppendBuffer &amp;HC75FFFF, &amp;HFFDD47E8, &amp;HF075FFFF, &amp;HFFDD3FE8, &amp;HEC75FFFF, &amp;HFFDD37E8, &amp;H1075FFFF, &amp;HFFDD2FE8, &amp;HE875FFFF, &amp;HFFDD27E8, &amp;HE475FFFF, &amp;HFFDD1FE8, &amp;H5B5E5FFF, &amp;HC25DE58B, &amp;H8B550020, &amp;H8B5653EC, &amp;H56570875, &amp;HE80C75FF, &amp;HFFFFA8E7, &amp;H1075FF56, &amp;H5D89D88B, &amp;HA8D9E80C, &amp;HFF56FFFF, &amp;HF88B1475, &amp;HE8087D89, &amp;HFFFFA8CB, &amp;H89535750, &amp;H10E81045, &amp;H8BFFFFEE, &amp;H74F685D8, &amp;H187D8B15, &amp;HE853564E</td>
        </tr>
        <tr>
          <td id="L7678" data-line-number="7678"></td>
          <td id="LC7678">    pvAppendBuffer &amp;HFFFFA7EF, &amp;H85470788, &amp;H8BF175F6, &amp;H75FF087D, &amp;HDCBAE80C, &amp;HE857FFFF, &amp;HFFFFDCB4, &amp;HE81075FF, &amp;HFFFFDCAC, &amp;HDCA6E853, &amp;H5E5FFFFF, &amp;H14C25D5B, &amp;HEC8B5500, &amp;H458B5151, &amp;H5D8B5310, &amp;HF7564808, &amp;H1045C7D0, &amp;H10&amp;, &amp;H7D8B5799, &amp;H89DF2B0C, &amp;H5589FC45, &amp;H3B348BF8, &amp;H43B548B, &amp;H4F8B078B, &amp;H23C63304, &amp;HCA33FC45, &amp;H33F84D23, &amp;H89D133F0, &amp;H54893B34, &amp;H731043B, &amp;H31087F8D, &amp;H6D83FC4F</td>
        </tr>
        <tr>
          <td id="L7679" data-line-number="7679"></td>
          <td id="LC7679">    pvAppendBuffer &amp;HD1750110, &amp;H8B5B5E5F, &amp;HCC25DE5, &amp;HEC8B5500, &amp;H8B0C558B, &amp;HD12B084D, &amp;H5E106A56, &amp;H890A048B, &amp;H8498D01, &amp;HFC0A448B, &amp;H83FC4189, &amp;HEC7501EE, &amp;H8C25D5E, &amp;HEC8B5500, &amp;H106A5653, &amp;H105D395B, &amp;H7D833674, &amp;H5A752010, &amp;H570C758B, &amp;H53087D8B, &amp;H31E85756, &amp;H53FFFFE7, &amp;H5010468D, &amp;H5010478D, &amp;HFFE723E8, &amp;H18C483FF, &amp;HFF930CE8, &amp;H53105FF, &amp;H47890000, &amp;H2AEB5F30, &amp;H5308758B, &amp;H560C75FF</td>
        </tr>
        <tr>
          <td id="L7680" data-line-number="7680"></td>
          <td id="LC7680">    pvAppendBuffer &amp;HFFE703E8, &amp;H75FF53FF, &amp;H10468D0C, &amp;HE6F6E850, &amp;HC483FFFF, &amp;H92DFE818, &amp;H2005FFFF, &amp;H89000005, &amp;H5B5E3046, &amp;HCC25D, &amp;H83EC8B55, &amp;H8B536CEC, &amp;H5756085D, &amp;HA0BFF633, &amp;H8B000001, &amp;H104B8B03, &amp;H8BF84589, &amp;H45890443, &amp;H8438BF0, &amp;H8BEC4589, &amp;H45890C43, &amp;H14438BE0, &amp;H8BE84589, &amp;H45891843, &amp;H1C438BE4, &amp;H89945D8D, &amp;HDF2BF44D, &amp;H89DC4589, &amp;H7D89D875, &amp;H10FE83D4, &amp;H758B1773, &amp;H71E8560C</td>
        </tr>
        <tr>
          <td id="L7681" data-line-number="7681"></td>
          <td id="LC7681">    pvAppendBuffer &amp;H83FFFFFB, &amp;H458904C6, &amp;H3B0489FC, &amp;HEB0C7589, &amp;H17E8D5D, &amp;H8D0FE683, &amp;HE083FD47, &amp;H85548B0F, &amp;H83C78B94, &amp;H4C8B0FE0, &amp;HC18B9485, &amp;H890EC0C1, &amp;HC18BFC45, &amp;H3107C8C1, &amp;HC28BFC45, &amp;H3103E9C1, &amp;HCA8BFC4D, &amp;HC10DC0C1, &amp;HC8330FC1, &amp;H330AEAC1, &amp;HF8478DCA, &amp;H83FC558B, &amp;H7D8B0FE0, &amp;H3D103D4, &amp;H3948554, &amp;H8994B554, &amp;H5489FC55, &amp;H6E894B5, &amp;H8BFFFF92, &amp;HD68BF475, &amp;HCAC1CE8B, &amp;H7C1C10B</td>
        </tr>
        <tr>
          <td id="L7682" data-line-number="7682"></td>
          <td id="LC7682">    pvAppendBuffer &amp;HCE8BD133, &amp;HF706C9C1, &amp;HE47523D6, &amp;HC8BD133, &amp;H4C78338, &amp;H3E8458B, &amp;HF44523CA, &amp;H33FC4D03, &amp;H89F103F0, &amp;H4D8BD47D, &amp;H3D18BF8, &amp;HC18BDC75, &amp;HC10AC0C1, &amp;HD0330DCA, &amp;HC8C1C18B, &amp;H8BD03302, &amp;HC88BF045, &amp;H33F84523, &amp;H4D23F84D, &amp;H8BC833EC, &amp;H4589E445, &amp;H8BD103DC, &amp;H4D8BE845, &amp;HE44589E0, &amp;H458BCE03, &amp;HE84589F4, &amp;H89EC458B, &amp;H458BE045, &amp;HEC4589F0, &amp;H89F8458B, &amp;H48DF045, &amp;HD8758B32</td>
        </tr>
        <tr>
          <td id="L7683" data-line-number="7683"></td>
          <td id="LC7683">    pvAppendBuffer &amp;HF44D8946, &amp;H89F84589, &amp;HFF81D875, &amp;H2A0&amp;, &amp;HFEDF820F, &amp;H5D8BFFFF, &amp;H15E5F08, &amp;HF0458B03, &amp;H8B044301, &amp;H4301EC45, &amp;HE0458B08, &amp;H8B0C4301, &amp;H4301E845, &amp;HE4458B14, &amp;H1184301, &amp;H458B104B, &amp;H1C4301DC, &amp;H5B6043FF, &amp;HC25DE58B, &amp;H8B550008, &amp;HDCEC81EC, &amp;H8B000000, &amp;H56530845, &amp;H4488B57, &amp;H8BF84D89, &amp;H108B0848, &amp;H8BD84D89, &amp;H4D890C48, &amp;H10488BEC, &amp;H8BD44D89, &amp;H4D891448, &amp;H18488BD0</td>
        </tr>
        <tr>
          <td id="L7684" data-line-number="7684"></td>
          <td id="LC7684">    pvAppendBuffer &amp;H8BB84D89, &amp;H4D891C48, &amp;H20488BB4, &amp;H8BE84D89, &amp;H4D892448, &amp;H28488BFC, &amp;H8BCC4D89, &amp;H4D892C48, &amp;H30488BC8, &amp;H8BC44D89, &amp;H4D893448, &amp;H38488BC0, &amp;H893C408B, &amp;H858DAC45, &amp;HFFFFFF24, &amp;HB9B04D89, &amp;H2A0&amp;, &amp;H33E05589, &amp;H89C12BD2, &amp;H4D89BC55, &amp;HA44589DC, &amp;H7310FA83, &amp;HC7D8B36, &amp;H5004478D, &amp;HFFF98FE8, &amp;HD88B57FF, &amp;H85E8F633, &amp;H8BFFFFF9, &amp;HF00BDC4D, &amp;H83A4458B, &amp;H5D8908C7, &amp;HF07589F4</td>
        </tr>
        <tr>
          <td id="L7685" data-line-number="7685"></td>
          <td id="LC7685">    pvAppendBuffer &amp;H890C7D89, &amp;H7489081C, &amp;HD6E90408, &amp;H8D000000, &amp;HE083FE42, &amp;H8B3D6A0F, &amp;HFF24C5BC, &amp;HB48BFFFF, &amp;HFFFF28C5, &amp;H1428DFF, &amp;H830FE083, &amp;H57560FE2, &amp;H8BA85589, &amp;HFF24C58C, &amp;H9C8BFFFF, &amp;HFFFF28C5, &amp;HE44D89FF, &amp;HFFFA0EE8, &amp;H56136AFF, &amp;HF4458957, &amp;HE8F05589, &amp;HFFFFF9FF, &amp;H33F44D8B, &amp;HF0458BC8, &amp;H6F7AC0F, &amp;HC233086A, &amp;H5306EEC1, &amp;H33E475FF, &amp;H89C633CF, &amp;H4589F44D, &amp;HF9D9E8F0, &amp;H16AFFFF</td>
        </tr>
        <tr>
          <td id="L7686" data-line-number="7686"></td>
          <td id="LC7686">    pvAppendBuffer &amp;HE475FF53, &amp;HFA8BF08B, &amp;HFFF9CAE8, &amp;HF44D8BFF, &amp;H458BF033, &amp;H8BFA33E4, &amp;HAC0FF055, &amp;HF03307D8, &amp;H8B07EBC1, &amp;HFB33BC45, &amp;HD713CE03, &amp;H83F9C083, &amp;H8C030FE0, &amp;HFFFF24C5, &amp;HC59413FF, &amp;HFFFFFF28, &amp;H3A8458B, &amp;HFF24C58C, &amp;H4D89FFFF, &amp;HC59413F4, &amp;HFFFFFF28, &amp;H24C58C89, &amp;H89FFFFFF, &amp;H9489F055, &amp;HFFFF28C5, &amp;HE8758BFF, &amp;H75FF296A, &amp;H64E856FC, &amp;H6AFFFFF9, &amp;HFC75FF12, &amp;HFA8BD88B, &amp;HF955E856</td>
        </tr>
        <tr>
          <td id="L7687" data-line-number="7687"></td>
          <td id="LC7687">    pvAppendBuffer &amp;HE6AFFFF, &amp;H33FC75FF, &amp;H56FA33D8, &amp;HFFF946E8, &amp;H33D833FF, &amp;H8F5FE8FA, &amp;H4D8BFFFF, &amp;H8BD6F7DC, &amp;HD2F7FC55, &amp;H1C03276A, &amp;HF875FF08, &amp;H4087C13, &amp;H23C47523, &amp;H4D8BC055, &amp;HE84D23CC, &amp;H33C8458B, &amp;HFC4523F1, &amp;HDE03D033, &amp;H13E0758B, &amp;HF45D03FA, &amp;HF07D1356, &amp;H89B05D03, &amp;H7D13A85D, &amp;HE47D89AC, &amp;HFFF8F2E8, &amp;HFF226AFF, &amp;HF88BF875, &amp;HE856DA8B, &amp;HFFFFF8E3, &amp;H75FF1C6A, &amp;H33F833F8, &amp;HD4E856DA</td>
        </tr>
        <tr>
          <td id="L7688" data-line-number="7688"></td>
          <td id="LC7688">    pvAppendBuffer &amp;H8BFFFFF8, &amp;HDA33D84D, &amp;H33EC558B, &amp;HF85533F8, &amp;H7533F18B, &amp;HD05523E0, &amp;H23EC458B, &amp;H7523F845, &amp;H23D033D4, &amp;H458BE04D, &amp;H89F133C4, &amp;HF703B045, &amp;H89C0458B, &amp;HDA13AC45, &amp;H89CC458B, &amp;H458BC445, &amp;HA84D8BC8, &amp;H8BB84D03, &amp;H5513E455, &amp;HA87503B4, &amp;H8BC04589, &amp;H5D13E845, &amp;HCC4589E4, &amp;H89FC458B, &amp;H558BFC55, &amp;HB85589D4, &amp;H89D0558B, &amp;H558BB455, &amp;HD45589D8, &amp;H89EC558B, &amp;H558BD055, &amp;HD85589E0</td>
        </tr>
        <tr>
          <td id="L7689" data-line-number="7689"></td>
          <td id="LC7689">    pvAppendBuffer &amp;H89F8558B, &amp;H4D8BE84D, &amp;HEC5589DC, &amp;H8B08C183, &amp;H8942BC55, &amp;H7589C845, &amp;HF85D89E0, &amp;H89BC5589, &amp;HF981DC4D, &amp;H520&amp;, &amp;HFDA6820F, &amp;H458BFFFF, &amp;HD8558B08, &amp;H5FD44D8B, &amp;H758B3001, &amp;H45811B4, &amp;H8B085001, &amp;H5011EC55, &amp;H1048010C, &amp;H11D04D8B, &amp;H558B1448, &amp;H185001B8, &amp;H11E84D8B, &amp;H48011C70, &amp;HFC4D8B20, &amp;H8B244811, &amp;H4801CC4D, &amp;HC84D8B28, &amp;H8B2C4811, &amp;H4801C44D, &amp;HC04D8B30, &amp;H8B344811</td>
        </tr>
        <tr>
          <td id="L7690" data-line-number="7690"></td>
          <td id="LC7690">    pvAppendBuffer &amp;H4801B04D, &amp;HAC4D8B38, &amp;HFF3C4811, &amp;HC080&amp;, &amp;H8B5B5E00, &amp;H8C25DE5, &amp;HEC8B5500, &amp;H85D8B53, &amp;HB60F5756, &amp;HB60F077B, &amp;HB60F0A43, &amp;HB60F0B73, &amp;HE7C10F53, &amp;HFF80B08, &amp;HF034BB6, &amp;HC10D43B6, &amp;HF80B08E7, &amp;HF08E6C1, &amp;HE7C103B6, &amp;HC1F80B08, &amp;HB60F08E2, &amp;HF00B0E43, &amp;HF08E1C1, &amp;HC10143B6, &amp;HF00B08E6, &amp;H443B60F, &amp;HB08E6C1, &amp;H43B60FF0, &amp;HFD00B02, &amp;HC10543B6, &amp;HD00B08E2, &amp;H843B60F</td>
        </tr>
        <tr>
          <td id="L7691" data-line-number="7691"></td>
          <td id="LC7691">    pvAppendBuffer &amp;HB08E2C1, &amp;H43B60FD0, &amp;H89C80B06, &amp;HB60F047B, &amp;HE1C10943, &amp;H89C80B08, &amp;HB60F0873, &amp;HE1C10C43, &amp;HC80B5F08, &amp;H5E0C5389, &amp;H5D5B0B89, &amp;H550004C2, &amp;H458BEC8B, &amp;H74C08508, &amp;HC4D8B10, &amp;H974C985, &amp;H400000C6, &amp;H7501E983, &amp;H8C25DF7, &amp;HEC8B5500, &amp;HFF0C75FF, &amp;H75FF0C75, &amp;HEDFEE808, &amp;HC25DFFFF, &amp;H8B550008, &amp;H10558BEC, &amp;H758B5653, &amp;H7D8B570C, &amp;H6AF22B08, &amp;H5BFA2B10, &amp;H2B160C8B, &amp;H16448B0A</td>
        </tr>
        <tr>
          <td id="L7692" data-line-number="7692"></td>
          <td id="LC7692">    pvAppendBuffer &amp;H4421B04, &amp;H8D170C89, &amp;H44890852, &amp;HEB83FC17, &amp;H5FE57501, &amp;HC25D5B5E, &amp;H8B55000C, &amp;HE85756EC, &amp;HFFFF8CD5, &amp;HBF08758B, &amp;H588&amp;, &amp;HFF50C703, &amp;H41E836, &amp;H6890000, &amp;HFF8CBCE8, &amp;H50C703FF, &amp;HE80476FF, &amp;H2F&amp;, &amp;HE8044689, &amp;HFFFF8CA9, &amp;HFF50C703, &amp;H1CE80876, &amp;H89000000, &amp;H96E80846, &amp;H3FFFF8C, &amp;H76FF50C7, &amp;H9E80C, &amp;H895F0000, &amp;H5D5E0C46, &amp;H550004C2, &amp;H558BEC8B, &amp;H5D8B530C</td>
        </tr>
        <tr>
          <td id="L7693" data-line-number="7693"></td>
          <td id="LC7693">    pvAppendBuffer &amp;HC1C38B08, &amp;HCB8B18E8, &amp;H8E9C156, &amp;HFC9B60F, &amp;H8B1034B6, &amp;H10E8C1C3, &amp;HFC0B60F, &amp;HC1110CB6, &amp;HB60F08E6, &amp;HC60B1004, &amp;HB08E0C1, &amp;HCBB60FC1, &amp;H5E08E0C1, &amp;HCB60F5B, &amp;H5DC10B11, &amp;H550008C2, &amp;H5653EC8B, &amp;H87D8B57, &amp;H458BDB33, &amp;H44B60F0C, &amp;H8B990158, &amp;H8BF28BC8, &amp;HA40F0C45, &amp;HE1C108CE, &amp;H4B60F08, &amp;HC8039958, &amp;H13DF0C89, &amp;HDF7489F2, &amp;HFB834304, &amp;H81D37210, &amp;H7FFF7867, &amp;H67830000</td>
        </tr>
        <tr>
          <td id="L7694" data-line-number="7694"></td>
          <td id="LC7694">    pvAppendBuffer &amp;H5E5F007C, &amp;H8C25D5B, &amp;HEC8B5500, &amp;H145D8B53, &amp;HD233C933, &amp;H6774DB85, &amp;H560C458B, &amp;H2B10758B, &amp;H84529F0, &amp;H10758957, &amp;H306348B, &amp;HC758930, &amp;H8B10758B, &amp;H748B0C7D, &amp;H70130406, &amp;H89F90304, &amp;HF2130C7D, &amp;H7D8B383B, &amp;H3B057508, &amp;H17740470, &amp;H7704703B, &amp;H8B07720E, &amp;HC4D3908, &amp;HC9330573, &amp;H3302EB41, &amp;H8BD233C9, &amp;H74890C5D, &amp;H758B0407, &amp;H71C8910, &amp;H8308C083, &amp;H7501146D, &amp;H8B5E5FAB</td>
        </tr>
        <tr>
          <td id="L7695" data-line-number="7695"></td>
          <td id="LC7695">    pvAppendBuffer &amp;HC25D5BC1, &amp;H8B550010, &amp;HC4D8BEC, &amp;H1F74C985, &amp;H7D8B5756, &amp;HCD0C8D08, &amp;HFFFFFFFB, &amp;HE9C1F78B, &amp;H278302, &amp;H46783, &amp;HF308C783, &amp;H5D5E5FA5, &amp;H550008C2, &amp;H4D8BEC8B, &amp;H1E98310, &amp;H30785756, &amp;H8B0C458B, &amp;HF02B0875, &amp;H8BC8148D, &amp;H8B04167C, &amp;H7A3B1604, &amp;H72267704, &amp;H77023B1F, &amp;H47A3B20, &amp;H4771672, &amp;H1072023B, &amp;H8308EA83, &amp;HDB7901E9, &amp;H5E5FC033, &amp;HCC25D, &amp;HEBFFC883, &amp;H40C033F5</td>
        </tr>
        <tr>
          <td id="L7696" data-line-number="7696"></td>
          <td id="LC7696">    pvAppendBuffer &amp;H8B55F0EB, &amp;H39C933EC, &amp;H12760C4D, &amp;H8B08558B, &amp;H440BCA04, &amp;HD7504CA, &amp;HC4D3B41, &amp;HC033F172, &amp;H8C25D40, &amp;HEBC03300, &amp;HEC8B55F8, &amp;H33535151, &amp;H89D38BDB, &amp;H5539FC55, &amp;H8B5B7614, &amp;H406A084D, &amp;H10452B58, &amp;H8BF84589, &amp;HC12B0C45, &amp;HC458956, &amp;H8748B57, &amp;H8BD68B04, &amp;HC78B083C, &amp;HE8104D8B, &amp;HFFFF9820, &amp;HB084D8B, &amp;HFC550BC3, &amp;HC78B0189, &amp;H8B045189, &amp;HF84D8BD6, &amp;HFF9826E8, &amp;H84D8BFF</td>
        </tr>
        <tr>
          <td id="L7697" data-line-number="7697"></td>
          <td id="LC7697">    pvAppendBuffer &amp;H458BD88B, &amp;H8C1830C, &amp;H1146D83, &amp;H89FC5589, &amp;HBD75084D, &amp;HC38B5E5F, &amp;H5DE58B5B, &amp;H550010C2, &amp;HEC83EC8B, &amp;H8B565328, &amp;H8B570C75, &amp;H46A087D, &amp;H38E85756, &amp;H8B00000B, &amp;HC9332C46, &amp;H8BE44589, &amp;H45893046, &amp;H34468BE8, &amp;H8BEC4589, &amp;H45893846, &amp;H3C468BF0, &amp;H4589046A, &amp;HD8458DF4, &amp;H5050016A, &amp;H89D84D89, &amp;H4D89DC4D, &amp;HFF3BE8E0, &amp;H46AFFFF, &amp;H458DD88B, &amp;H575750D8, &amp;HFFFE0CE8, &amp;H384E8BFF</td>
        </tr>
        <tr>
          <td id="L7698" data-line-number="7698"></td>
          <td id="LC7698">    pvAppendBuffer &amp;H468BD803, &amp;H3C568B30, &amp;HE06583, &amp;HF46583, &amp;H33E44589, &amp;H34460BC0, &amp;H4589046A, &amp;HD8458DE8, &amp;H5050016A, &amp;H89EC4D89, &amp;HFAE8F055, &amp;H6AFFFFFE, &amp;H8DD80304, &amp;H5750D845, &amp;HFDCBE857, &amp;HD803FFFF, &amp;H8920468B, &amp;H468BD845, &amp;HDC458924, &amp;H8928468B, &amp;HC033E045, &amp;H89E44589, &amp;H4589E845, &amp;H38468BEC, &amp;H8BF04589, &amp;H46A3C46, &amp;H8DF44589, &amp;H5750D845, &amp;HFD93E857, &amp;HD803FFFF, &amp;H33244E8B, &amp;H34568BC0</td>
        </tr>
        <tr>
          <td id="L7699" data-line-number="7699"></td>
          <td id="LC7699">    pvAppendBuffer &amp;H8928460B, &amp;H468BDC45, &amp;HF8458930, &amp;H460BC033, &amp;HE045892C, &amp;H8938468B, &amp;H468BE845, &amp;HEC45893C, &amp;H460BC033, &amp;H89046A20, &amp;H458DF445, &amp;H4D8950D8, &amp;H57CA8BD8, &amp;HE44D8957, &amp;HE8F05589, &amp;HFFFFFD49, &amp;H334568B, &amp;H2C4E8BD8, &amp;H460BC033, &amp;HDC458930, &amp;H8920468B, &amp;HD233E055, &amp;H4D89C20B, &amp;H89046AD8, &amp;HC933F045, &amp;H8D284E0B, &amp;H5750D845, &amp;HE4558957, &amp;H89E85589, &amp;H4D89EC55, &amp;HBACE8F4, &amp;H568B0000</td>
        </tr>
        <tr>
          <td id="L7700" data-line-number="7700"></td>
          <td id="LC7700">    pvAppendBuffer &amp;H8BD82B24, &amp;H20B13046, &amp;HE86583, &amp;HEC6583, &amp;H8BD84589, &amp;H45893446, &amp;H38468BDC, &amp;H8BE04589, &amp;H45893C46, &amp;H20468BE4, &amp;HFF9676E8, &amp;H2C560BFF, &amp;H4589046A, &amp;HD8458DF0, &amp;H89575750, &amp;H67E8F455, &amp;H8B00000B, &amp;HD82B344E, &amp;H8BFC5D89, &amp;H568B305E, &amp;HBC03320, &amp;H7E8B3846, &amp;HDC458924, &amp;H460BC033, &amp;H89F6333C, &amp;H558BE455, &amp;HE045890C, &amp;HB1D84D89, &amp;H28428B20, &amp;HE82C528B, &amp;HFFFF9608, &amp;HF06583</td>
        </tr>
        <tr>
          <td id="L7701" data-line-number="7701"></td>
          <td id="LC7701">    pvAppendBuffer &amp;H46AF80B, &amp;H8DF45D89, &amp;H535BD845, &amp;HE87D8950, &amp;H7D8BF20B, &amp;H89575708, &amp;HBE8EC75, &amp;H8B00000B, &amp;H758B0C4D, &amp;HE06583FC, &amp;H83F02B00, &amp;H8B00F065, &amp;H45893841, &amp;H3C418BD8, &amp;H8BDC4589, &amp;H45892441, &amp;H28418BE4, &amp;H8BE84589, &amp;H45892C41, &amp;H34418BEC, &amp;HF4458953, &amp;H50D8458D, &amp;HCBE85757, &amp;H2B00000A, &amp;H531E79F0, &amp;HFF8810E8, &amp;H10C083FF, &amp;HE8575750, &amp;HFFFFFC15, &amp;HEB78F003, &amp;H8B5B5E5F, &amp;H8C25DE5</td>
        </tr>
        <tr>
          <td id="L7702" data-line-number="7702"></td>
          <td id="LC7702">    pvAppendBuffer &amp;H75F68500, &amp;HE8575315, &amp;HFFFF87ED, &amp;H5010C083, &amp;HFFFC9EE8, &amp;H1F883FF, &amp;HE853DE74, &amp;HFFFF87D9, &amp;H5010C083, &amp;H7FE85757, &amp;H2B00000A, &amp;H55D2EBF0, &amp;HEC83EC8B, &amp;H758B5668, &amp;H66A570C, &amp;H57307E8D, &amp;HFFFCBDE8, &amp;HFC085FF, &amp;H9385&amp;, &amp;H5D8D5300, &amp;H83DE2B98, &amp;H8D00FC65, &amp;H65839845, &amp;H66A00F8, &amp;HFC20E850, &amp;H66AFFFF, &amp;H50C8458D, &amp;HFFFC15E8, &amp;H458D57FF, &amp;H2DE85098, &amp;H6AFFFFEA, &amp;H3E85706</td>
        </tr>
        <tr>
          <td id="L7703" data-line-number="7703"></td>
          <td id="LC7703">    pvAppendBuffer &amp;H6AFFFFFC, &amp;H5EC68B09, &amp;H303148B, &amp;H34C8B10, &amp;H4481304, &amp;H13FC5503, &amp;H103BF84D, &amp;H483B0575, &amp;H3B1C7404, &amp;HF770448, &amp;H103B0472, &amp;H45C70973, &amp;H1FC&amp;, &amp;H8304EB00, &amp;H8300FC65, &amp;H8900F865, &amp;H4488910, &amp;H8308C083, &amp;HBC7501EE, &amp;HE857066A, &amp;HFFFFFC2E, &amp;H850C758B, &amp;H74840FC0, &amp;H5BFFFFFF, &amp;H12E8066A, &amp;HBFFFFF87, &amp;HB0&amp;, &amp;H6E816EB, &amp;H3FFFF87, &amp;H565650C7, &amp;H9ADE8, &amp;HE8066A00</td>
        </tr>
        <tr>
          <td id="L7704" data-line-number="7704"></td>
          <td id="LC7704">    pvAppendBuffer &amp;HFFFF86F5, &amp;H5650C703, &amp;HFFFBA6E8, &amp;H85066AFF, &amp;H56DB7FC0, &amp;HE80875FF, &amp;H7D3&amp;, &amp;HE58B5E5F, &amp;H8C25D, &amp;H83EC8B55, &amp;HFF04107D, &amp;H75FF0C75, &amp;HE8077508, &amp;HFFFFFC67, &amp;HF0E805EB, &amp;H5DFFFFFE, &amp;H55000CC2, &amp;H75FFEC8B, &amp;H1075FF18, &amp;HFF0C75FF, &amp;HB2E80875, &amp;HBFFFFFA, &amp;HFF1275C2, &amp;H75FF1875, &amp;H875FF14, &amp;HFFFB4AE8, &amp;H78C085FF, &amp;H1875FF11, &amp;HFF1475FF, &amp;H75FF0875, &amp;H92CE808, &amp;HC25D0000</td>
        </tr>
        <tr>
          <td id="L7705" data-line-number="7705"></td>
          <td id="LC7705">    pvAppendBuffer &amp;H8B550014, &amp;HC0EC81EC, &amp;H56000000, &amp;H5614758B, &amp;HE80C75FF, &amp;HFFFFFB6A, &amp;H74C08556, &amp;H875FF0D, &amp;HFFFAE1E8, &amp;H1F1E9FF, &amp;H75FF0000, &amp;H40858D0C, &amp;H50FFFFFF, &amp;H736E8, &amp;H75FF5600, &amp;H70858D10, &amp;H50FFFFFF, &amp;H726E8, &amp;H458D5600, &amp;HB3E850D0, &amp;H83FFFFFA, &amp;H8D00D465, &amp;H5056A045, &amp;H1D045C7, &amp;HE8000000, &amp;HFFFFFA9E, &amp;H70858D56, &amp;H50FFFFFF, &amp;HFF40858D, &amp;HE850FFFF, &amp;HFFFFFAB7, &amp;HC985C88B</td>
        </tr>
        <tr>
          <td id="L7706" data-line-number="7706"></td>
          <td id="LC7706">    pvAppendBuffer &amp;H188840F, &amp;H57530000, &amp;HFF40858B, &amp;HDB33FFFF, &amp;H3301E083, &amp;H56C30BFF, &amp;H858D0E75, &amp;HFFFFFF40, &amp;H684E850, &amp;H77EB0000, &amp;HFF70858B, &amp;HE083FFFF, &amp;HC88301, &amp;H858D1175, &amp;HFFFFFF70, &amp;H668E850, &amp;HECE90000, &amp;H85000000, &amp;H948E0FC9, &amp;H8D000000, &amp;HFFFF7085, &amp;H858D50FF, &amp;HFFFFFF40, &amp;H47E85050, &amp;H56000008, &amp;HFF40858D, &amp;HE850FFFF, &amp;H63A&amp;, &amp;HA0458D56, &amp;HD0458D50, &amp;HFA35E850, &amp;HC085FFFF</td>
        </tr>
        <tr>
          <td id="L7707" data-line-number="7707"></td>
          <td id="LC7707">    pvAppendBuffer &amp;HFF560E79, &amp;H458D1075, &amp;HE85050D0, &amp;HFFFFF979, &amp;HA0458D56, &amp;HD0458D50, &amp;HBE85050, &amp;H8B000008, &amp;HE083D045, &amp;HC88301, &amp;HFF561274, &amp;H458D1075, &amp;HE85050D0, &amp;HFFFFF951, &amp;HDA8BF88B, &amp;HD0458D56, &amp;H5E4E850, &amp;HFB0B0000, &amp;HA0840F, &amp;H448B0000, &amp;H4C81C8F5, &amp;HCCF5&amp;, &amp;H44898000, &amp;H8BE9C8F5, &amp;H8D000000, &amp;HFFFF4085, &amp;H858D50FF, &amp;HFFFFFF70, &amp;HB3E85050, &amp;H56000007, &amp;HFF70858D, &amp;HE850FFFF</td>
        </tr>
        <tr>
          <td id="L7708" data-line-number="7708"></td>
          <td id="LC7708">    pvAppendBuffer &amp;H5A6&amp;, &amp;HD0458D56, &amp;HA0458D50, &amp;HF9A1E850, &amp;HC085FFFF, &amp;HFF560E79, &amp;H458D1075, &amp;HE85050A0, &amp;HFFFFF8E5, &amp;HD0458D56, &amp;HA0458D50, &amp;H77E85050, &amp;H8B000007, &amp;HE083A045, &amp;HC88301, &amp;HFF561274, &amp;H458D1075, &amp;HE85050A0, &amp;HFFFFF8BD, &amp;HDA8BF88B, &amp;HA0458D56, &amp;H550E850, &amp;HFB0B0000, &amp;H448B1074, &amp;H4C8198F5, &amp;H9CF5&amp;, &amp;H44898000, &amp;H8D5698F5, &amp;HFFFF7085, &amp;H858D50FF, &amp;HFFFFFF40, &amp;HF931E850</td>
        </tr>
        <tr>
          <td id="L7709" data-line-number="7709"></td>
          <td id="LC7709">    pvAppendBuffer &amp;HC88BFFFF, &amp;H850FC985, &amp;HFFFFFE7C, &amp;H8D565B5F, &amp;HFF50D045, &amp;H54E80875, &amp;H5E000005, &amp;HC25DE58B, &amp;H8B550010, &amp;H80EC81EC, &amp;H53000000, &amp;H46A5756, &amp;H75FF535B, &amp;H48FE814, &amp;HFF530000, &amp;HF08B1075, &amp;HFF80458D, &amp;HE8500C75, &amp;H34A&amp;, &amp;HA0458D53, &amp;H473E850, &amp;HF88B0000, &amp;H874FF85, &amp;H100C781, &amp;HCEB0000, &amp;H80458D53, &amp;H45BE850, &amp;HF88B0000, &amp;H73FE3B53, &amp;H80458D0C, &amp;H875FF50, &amp;HFAE9&amp;</td>
        </tr>
        <tr>
          <td id="L7710" data-line-number="7710"></td>
          <td id="LC7710">    pvAppendBuffer &amp;HC0458D00, &amp;HF87CE850, &amp;H8D53FFFF, &amp;HE850E045, &amp;HFFFFF872, &amp;HC62BC78B, &amp;HEEC1F08B, &amp;HE0835306, &amp;H501A743F, &amp;H8D1475FF, &amp;H48DC045, &amp;HF6E850F0, &amp;H89FFFFF8, &amp;H89E0F544, &amp;HEBE4F554, &amp;H1475FF0F, &amp;H8DC0458D, &amp;HE850F004, &amp;H4A3&amp;, &amp;H85D8B53, &amp;HF830E853, &amp;H6383FFFF, &amp;H3C70004, &amp;H1&amp;, &amp;H815E046A, &amp;H100FF, &amp;H56117700, &amp;H8D1475FF, &amp;HE850C045, &amp;HFFFFF83B, &amp;H7978C085, &amp;HA0458D56</td>
        </tr>
        <tr>
          <td id="L7711" data-line-number="7711"></td>
          <td id="LC7711">    pvAppendBuffer &amp;HE0458D50, &amp;HF829E850, &amp;HC085FFFF, &amp;H40751478, &amp;H80458D56, &amp;HC0458D50, &amp;HF815E850, &amp;HC085FFFF, &amp;H8D562E7F, &amp;H8D50C045, &amp;H50508045, &amp;H5F9E8, &amp;H74C20B00, &amp;H8D53560C, &amp;H5050A045, &amp;H5E9E8, &amp;H458D5600, &amp;H458D50E0, &amp;HE85050A0, &amp;H5DA&amp;, &amp;H8DE0758B, &amp;H46AE045, &amp;H1FE6C150, &amp;H3C9E8, &amp;H8D046A00, &amp;HE850C045, &amp;H3BE&amp;, &amp;H4FDC7509, &amp;HFFFF6BE9, &amp;H458D56FF, &amp;HE8535080, &amp;H3EF&amp;</td>
        </tr>
        <tr>
          <td id="L7712" data-line-number="7712"></td>
          <td id="LC7712">    pvAppendBuffer &amp;H8B5B5E5F, &amp;H10C25DE5, &amp;HEC8B5500, &amp;HC0EC81, &amp;H56530000, &amp;H5B066A57, &amp;H1475FF53, &amp;H328E8, &amp;H75FF5300, &amp;H8DF08B10, &amp;HFFFF4085, &amp;HC75FFFF, &amp;H1E0E850, &amp;H8D530000, &amp;HFFFF7085, &amp;H6E850FF, &amp;H8B000003, &amp;H74FF85F8, &amp;H80C78108, &amp;HEB000001, &amp;H858D530F, &amp;HFFFFFF40, &amp;H2EBE850, &amp;HF88B0000, &amp;H73FE3B53, &amp;H40858D0F, &amp;H50FFFFFF, &amp;HE90875FF, &amp;H110&amp;, &amp;H50A0458D, &amp;HFFF709E8, &amp;H458D53FF</td>
        </tr>
        <tr>
          <td id="L7713" data-line-number="7713"></td>
          <td id="LC7713">    pvAppendBuffer &amp;HFFE850D0, &amp;H8BFFFFF6, &amp;H8BC62BC7, &amp;H6EEC1F0, &amp;H3FE08353, &amp;HFF501A74, &amp;H458D1475, &amp;HF0048DA0, &amp;HF783E850, &amp;H4489FFFF, &amp;H5489D0F5, &amp;HFEBD4F5, &amp;H8D1475FF, &amp;H48DA045, &amp;H30E850F0, &amp;H53000003, &amp;H53085D8B, &amp;HFFF6BDE8, &amp;H46383FF, &amp;H103C700, &amp;H6A000000, &amp;HFF815E06, &amp;H180&amp;, &amp;HFF561577, &amp;H458D1475, &amp;HC8E850A0, &amp;H85FFFFF6, &amp;H88880FC0, &amp;H56000000, &amp;HFF70858D, &amp;H8D50FFFF, &amp;HE850D045</td>
        </tr>
        <tr>
          <td id="L7714" data-line-number="7714"></td>
          <td id="LC7714">    pvAppendBuffer &amp;HFFFFF6AF, &amp;H1778C085, &amp;H8D564C75, &amp;HFFFF4085, &amp;H458D50FF, &amp;H98E850A0, &amp;H85FFFFF6, &amp;H56377FC0, &amp;H50A0458D, &amp;HFF40858D, &amp;H5050FFFF, &amp;H479E8, &amp;H74C20B00, &amp;H8D53560F, &amp;HFFFF7085, &amp;HE85050FF, &amp;H466&amp;, &amp;HD0458D56, &amp;H70858D50, &amp;H50FFFFFF, &amp;H454E850, &amp;H758B0000, &amp;HD0458DD0, &amp;HC150066A, &amp;H43E81FE6, &amp;H6A000002, &amp;HA0458D06, &amp;H238E850, &amp;H75090000, &amp;H58E94FCC, &amp;H56FFFFFF, &amp;HFF40858D</td>
        </tr>
        <tr>
          <td id="L7715" data-line-number="7715"></td>
          <td id="LC7715">    pvAppendBuffer &amp;H5350FFFF, &amp;H266E8, &amp;H5B5E5F00, &amp;HC25DE58B, &amp;H8B550010, &amp;H60EC83EC, &amp;HFFA0458D, &amp;H75FF1475, &amp;HC75FF10, &amp;H6CE850, &amp;H75FF0000, &amp;HA0458D14, &amp;H875FF50, &amp;HFFFA6BE8, &amp;H5DE58BFF, &amp;H550010C2, &amp;HEC83EC8B, &amp;HA0458D60, &amp;HFF1075FF, &amp;HE8500C75, &amp;H247&amp;, &amp;H8D1075FF, &amp;HFF50A045, &amp;H41E80875, &amp;H8BFFFFFA, &amp;HCC25DE5, &amp;HEC8B5500, &amp;HFF1875FF, &amp;H75FF1075, &amp;H875FF0C, &amp;H3ADE8, &amp;H74C20B00</td>
        </tr>
        <tr>
          <td id="L7716" data-line-number="7716"></td>
          <td id="LC7716">    pvAppendBuffer &amp;H1875FF11, &amp;HFF1475FF, &amp;H75FF0875, &amp;HF4F7E808, &amp;HC25DFFFF, &amp;H8B550014, &amp;H54EC83EC, &amp;H3314558B, &amp;H335653C0, &amp;H21C933F6, &amp;H2140E475, &amp;H3357E875, &amp;HDC7589FF, &amp;H7D89C22B, &amp;HF04D89E0, &amp;H3EC4589, &amp;H1BCA3BC1, &amp;HFC6583DB, &amp;HF8658300, &amp;H23D3F700, &amp;HFD93BD8, &amp;HA387&amp;, &amp;H10758B00, &amp;HC32BC18B, &amp;H8BC6348D, &amp;H7589E445, &amp;HFDA3BF4, &amp;H8383&amp;, &amp;H476FF00, &amp;HFF0C458B, &amp;HD874FF36, &amp;HD834FF04</td>
        </tr>
        <tr>
          <td id="L7717" data-line-number="7717"></td>
          <td id="LC7717">    pvAppendBuffer &amp;H50BC458D, &amp;HFFE234E8, &amp;H8DF08BFF, &amp;HEC83CC7D, &amp;HA5A5A510, &amp;H8BFC8BA5, &amp;H10EC83F0, &amp;HA5AC458D, &amp;H8BA5A5A5, &amp;HDC758DFC, &amp;HA5A5A550, &amp;H8E48E8A5, &amp;HF08BFFFF, &amp;HA5DC7D8D, &amp;H8BA5A5A5, &amp;H453BE845, &amp;HE4458BD8, &amp;H5720C77, &amp;H73D4453B, &amp;H41C93305, &amp;HC93302EB, &amp;H33F4758B, &amp;HFC4D01D2, &amp;H11F04D8B, &amp;H8B43F855, &amp;HEE831455, &amp;HF4758908, &amp;H860FD93B, &amp;HFFFFFF75, &amp;H8BE07D8B, &amp;H3EBDC75, &amp;H8BE4458B</td>
        </tr>
        <tr>
          <td id="L7718" data-line-number="7718"></td>
          <td id="LC7718">    pvAppendBuffer &amp;H3489085D, &amp;H8BF08BCB, &amp;H4589FC45, &amp;HF8458BE4, &amp;H4CB7C89, &amp;HE87D8B41, &amp;H8DE84589, &amp;HFFFF5504, &amp;HC83BFFFF, &amp;H8BDC7589, &amp;H7D89EC45, &amp;HF04D89E0, &amp;HFF09820F, &amp;HD203FFFF, &amp;HFCD37C89, &amp;HD374895F, &amp;H8B5B5EF8, &amp;H10C25DE5, &amp;HEC8B5500, &amp;HC75FF56, &amp;H5608758B, &amp;H2EE8&amp;, &amp;H85C88B00, &amp;H8B2374C9, &amp;H57FCCE54, &amp;HF8CE7C8B, &amp;H7EBF633, &amp;H1D7AC0F, &amp;H8B46EAD1, &amp;H75C20BC7, &amp;H6E1C1F3, &amp;HC0418D5F</td>
        </tr>
        <tr>
          <td id="L7719" data-line-number="7719"></td>
          <td id="LC7719">    pvAppendBuffer &amp;H5D5EC603, &amp;H550008C2, &amp;H4D8BEC8B, &amp;H1E9830C, &amp;H558B1178, &amp;HCA048B08, &amp;H4CA440B, &amp;HE9830575, &amp;H8DF27901, &amp;HC25D0141, &amp;H8B550008, &amp;HC458BEC, &amp;H8B575653, &amp;H6583087D, &amp;HDB330008, &amp;HEBC7348D, &amp;HFC4E8B23, &amp;H8B08EE83, &amp;HFC28B16, &amp;HB01C8AC, &amp;HE9D10845, &amp;H689CB0B, &amp;H4E89DA8B, &amp;H1FE3C104, &amp;H86583, &amp;HD977F73B, &amp;H5D5B5E5F, &amp;H550008C2, &amp;H558BEC8B, &amp;H74D28510, &amp;H84D8B1E, &amp;HC758B56</td>
        </tr>
        <tr>
          <td id="L7720" data-line-number="7720"></td>
          <td id="LC7720">    pvAppendBuffer &amp;H48BF12B, &amp;H8D01890E, &amp;H448B0849, &amp;H4189FC0E, &amp;H1EA83FC, &amp;H5D5EEC75, &amp;H55000CC2, &amp;HEC83EC8B, &amp;H10558B5C, &amp;H5653C033, &amp;HC933F633, &amp;H40DC7521, &amp;H57E07521, &amp;H7589FF33, &amp;H89C22BD4, &amp;H4D89D87D, &amp;HE44589E8, &amp;HCA3BC103, &amp;H6583DB1B, &amp;H658300FC, &amp;HD3F700F8, &amp;HD93BD823, &amp;HFF870F, &amp;H7D8B0000, &amp;H2BC18B0C, &amp;HC7348DC3, &amp;H89DC458B, &amp;HD18BEC75, &amp;H5589D32B, &amp;HFDA3BF0, &amp;HD587&amp;, &amp;H476FF00</td>
        </tr>
        <tr>
          <td id="L7721" data-line-number="7721"></td>
          <td id="LC7721">    pvAppendBuffer &amp;HFFB4458D, &amp;HDF74FF36, &amp;HDF34FF04, &amp;HE02BE850, &amp;H7D8DFFFF, &amp;HA5F08BC4, &amp;H3BA5A5A5, &amp;H4373F05D, &amp;H8BD04D8B, &amp;HC8558BC1, &amp;HE8C1F28B, &amp;HFC45011F, &amp;H83CC458B, &amp;H3300F855, &amp;HC1A40FFF, &amp;H1FEEC101, &amp;HF90BC003, &amp;H7D89F00B, &amp;HC4458BF4, &amp;H1C2A40F, &amp;H3F07589, &amp;HCC7589C0, &amp;H89D07D89, &amp;H5589C445, &amp;H8B0CEBC8, &amp;H4589D045, &amp;HCC458BF4, &amp;H83F04589, &amp;H758D10EC, &amp;H8DFC8BC4, &amp;HEC83A445, &amp;HA5A5A510</td>
        </tr>
        <tr>
          <td id="L7722" data-line-number="7722"></td>
          <td id="LC7722">    pvAppendBuffer &amp;H8DFC8BA5, &amp;HA550D475, &amp;HE8A5A5A5, &amp;HFFFF8BEA, &amp;H7D8DF08B, &amp;HA5A5A5D4, &amp;HE0458BA5, &amp;H8BF4453B, &amp;HC77DC45, &amp;H453B0572, &amp;H330573F0, &amp;H2EB41C9, &amp;H758BC933, &amp;H1D233EC, &amp;H4D8BFC4D, &amp;HF85511E8, &amp;HC7D8B43, &amp;H8908EE83, &amp;HD93BEC75, &amp;HFF1C860F, &amp;H7D8BFFFF, &amp;HD4758BD8, &amp;HEB10558B, &amp;HDC458B03, &amp;H89085D8B, &amp;HF08BCB34, &amp;H89FC458B, &amp;H458BDC45, &amp;HCB7C89F8, &amp;H7D8B4104, &amp;HE04589E0, &amp;HFF55048D</td>
        </tr>
        <tr>
          <td id="L7723" data-line-number="7723"></td>
          <td id="LC7723">    pvAppendBuffer &amp;H3BFFFFFF, &amp;HD47589C8, &amp;H89E4458B, &amp;H4D89D87D, &amp;HAD820FE8, &amp;H3FFFFFE, &amp;HD37C89D2, &amp;H74895FFC, &amp;H5B5EF8D3, &amp;HC25DE58B, &amp;H8B55000C, &amp;H5D8B53EC, &amp;H33C93314, &amp;H74DB85D2, &amp;HC458B5F, &amp;H29104529, &amp;H57560845, &amp;H8B107D8B, &amp;H7342B30, &amp;H8B0C7589, &amp;H741B0470, &amp;H7D8B0407, &amp;H89F92B0C, &amp;HF21B0C7D, &amp;H7D8B383B, &amp;H3B057508, &amp;H17740470, &amp;H7204703B, &amp;H8B07770E, &amp;HC4D3908, &amp;HC9330576, &amp;H3302EB41</td>
        </tr>
        <tr>
          <td id="L7724" data-line-number="7724"></td>
          <td id="LC7724">    pvAppendBuffer &amp;H8BD233C9, &amp;H1C890C5D, &amp;H7748907, &amp;H8C08304, &amp;H1146D83, &amp;H5E5FAE75, &amp;H5D5BC18B, &amp;H550010C2, &amp;H8B56EC8B, &amp;HC0330C75, &amp;H8340CE8B, &amp;HD2333FE1, &amp;HFF8A4FE8, &amp;H84D8BFF, &amp;H2306EEC1, &amp;H5423F104, &amp;H5D5E04F1, &amp;H550008C2, &amp;H558BEC8B, &amp;H8BC28B08, &amp;HE8C10C4D, &amp;H8B018818, &amp;H10E8C1C2, &amp;H8B014188, &amp;H8E8C1C2, &amp;H88024188, &amp;HC25D0351, &amp;H8B550008, &amp;H8558BEC, &amp;H8B53CA8B, &amp;HC38B0C5D, &amp;H5618E8C1</td>
        </tr>
        <tr>
          <td id="L7725" data-line-number="7725"></td>
          <td id="LC7725">    pvAppendBuffer &amp;H8810758B, &amp;HC1C38B06, &amp;H468810E8, &amp;HC1C38B01, &amp;H468808E8, &amp;HFC38B02, &amp;H8818C1AC, &amp;HE8C1035E, &amp;H44E8818, &amp;HCA8BC38B, &amp;H10C1AC0F, &amp;H8B10E8C1, &amp;H54E88C2, &amp;H8D8AC0F, &amp;H88064688, &amp;HEBC10756, &amp;H5D5B5E08, &amp;H55000CC2, &amp;H558BEC8B, &amp;H53CA8B08, &amp;H8B0C5D8B, &amp;HC1AC0FC3, &amp;H758B5608, &amp;H8E8C110, &amp;H1688C38B, &amp;H8B014E88, &amp;HC1AC0FCA, &amp;H10E8C110, &amp;H4E88C38B, &amp;HC2AC0F02, &amp;H18E8C118, &amp;H8B035688</td>
        </tr>
        <tr>
          <td id="L7726" data-line-number="7726"></td>
          <td id="LC7726">    pvAppendBuffer &amp;H45E88C3, &amp;H8808E8C1, &amp;HC38B0546, &amp;HC110E8C1, &amp;H468818EB, &amp;H75E8806, &amp;HC25D5B5E, &amp;H8B55000C, &amp;H14558BEC, &amp;H1F74D285, &amp;H56104D8B, &amp;H570C758B, &amp;H2B087D8B, &amp;H8AF92BF1, &amp;H1320E04, &amp;H410F0488, &amp;H7501EA83, &amp;H5D5E5FF2, &amp;H10C2&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;, &amp;H0&amp;</td>
        </tr>
        <tr>
          <td id="L7727" data-line-number="7727"></td>
          <td id="LC7727">    &#39;--- end thunk data</td>
        </tr>
        <tr>
          <td id="L7728" data-line-number="7728"></td>
          <td id="LC7728">    ReDim baBuffer(0 To 34125 - 1) As Byte</td>
        </tr>
        <tr>
          <td id="L7729" data-line-number="7729"></td>
          <td id="LC7729">    Call CopyMemory(baBuffer(0), m_baBuffer(0), UBound(baBuffer) + 1)</td>
        </tr>
        <tr>
          <td id="L7730" data-line-number="7730"></td>
          <td id="LC7730">    Erase m_baBuffer</td>
        </tr>
        <tr>
          <td id="L7731" data-line-number="7731"></td>
          <td id="LC7731">End Sub</td>
        </tr>
        <tr>
          <td id="L7732" data-line-number="7732"></td>
          <td id="LC7732">
</td>
        </tr>
  </tbody></div></div>
  </body>
</html>
