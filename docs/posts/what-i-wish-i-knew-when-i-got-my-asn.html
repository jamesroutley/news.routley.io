<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://quantum5.ca/2023/10/10/what-i-wish-i-knew-when-i-got-my-asn/">Original</a>
    <h1>What I wish I knew when I got my ASN</h1>
    
    <div id="readability-page-1" class="page"><div itemprop="articleBody">
    <p>As you may know, I am currently writing <a href="https://quantum5.ca/category/bgp/">a series</a> on BGP and how the
Internet works, from my perspective as the operator of a small autonomous
system, <a href="https://as200351.net">AS200351</a>. While we haven’t really exhausted the theoretical
material, I think I’ve covered enough to enable readers to set up their own
basic autonomous system. Rather than forcing you to do your own research based
on outdated and potentially incorrect information on the Internet, or allowing
you to fall victim to scams, I think it would be wise to talk about the process
of getting your own ASN.</p>

<p>For readers who haven’t read the previous parts of the series and are unfamiliar
with why one might want an ASN, here’s a brief explanation:</p>

<blockquote>
  <p>An <a href="https://en.wikipedia.org/wiki/Autonomous_system_(Internet)">autonomous system</a> (AS) is a constituent part of the Internet that can
define its own routing to the remainder of the Internet, and ASes exchange
routes with each other over <a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol">Border Gateway Protocol (BGP)</a> to form the
Internet itself. By receiving a globally unique identifier, an AS number
(ASN), which in my case is 200351, I can exchange routes over BGP with other
ASes, announce my own IP addresses to the Internet, and control how traffic
flows in and out of my network, as opposed to simply exchanging traffic from a
default gateway to reach the Internet with an IP address assigned by my ISP.
This comes with several advantages, such as being able to switch upstream ISPs
at will (or when such an ISP fails) without changing my IP addresses or
breaking a single connection; or to advertise the same IP addresses from
multiple locations (<a href="https://en.wikipedia.org/wiki/Anycast">anycasting</a>) to allow users to reach my services
with lower latency than otherwise permissible by the speed of light with
automatic failover.</p>
</blockquote>

<p>I will now share what I wish I knew when I impulsively decided to apply for an
ASN at 3 a.m. on a cold December night last year, now that I’ve been doing this
for a while. I’ll walk through the process as objectively and thoroughly as
possible, demystifying the role of any player in this space. I would like you to
go into this with full knowledge of the risks and a full understanding of where
your money is going. In the end, I will offer some subjective suggestions on
providers, but those can be ignored if you would rather do your own research.</p>

<!--more-->

<h2 id="choosing-an-rir">Choosing an RIR</h2>

<p>As mentioned before in this series, ASNs and IP addresses are <em>Internet
numbers</em>, which are resources ultimately managed by the <a href="https://en.wikipedia.org/wiki/Internet_Assigned_Numbers_Authority">IANA</a>, whose
assignment is delegated to the <a href="https://en.wikipedia.org/wiki/Regional_Internet_registry">Regional Internet Registries (RIRs)</a>. There
are five RIRs in the world, but since I only have experience with <a href="https://arin.net">ARIN</a>
and <a href="https://ripe.net">RIPE NCC</a>, I will mostly focus on these two.</p>

<p>Typically, RIRs allocate ASNs directly to end users, whereas RIRs may allocate
IP addresses directly, but also to <a href="https://en.wikipedia.org/wiki/Regional_Internet_registry#Local_Internet_registry">Local Internet Registries (LIRs)</a> who
allocate them to end users. In order for RIRs to issue an ASN, they typically
require you to have your own IP addresses that you can announce with BGP, so you
probably want to get IP addresses first—either from an RIR directly or from an
LIR—or get them <em>with</em> the ASN if that’s an option. Note that it’s possible to
use your own IP addresses without your own ASN by getting an ISP to announce
them for you, a service typically called “bring your own IP” or BYOIP, but we
aren’t doing that here.</p>

<p>Given the current state of <a href="https://en.wikipedia.org/wiki/IPv4_address_exhaustion">IPv4 address exhaustion</a>, you will
almost certainly be getting IPv6 addresses, likely exclusively. As such, IPv6
will be the main focus.</p>

<p>No matter what, you need to choose an RIR for your ASN and IP addresses. Even if
you choose to use an LIR for your IP addresses, they ultimately come from an
RIR, and the choice of RIR affects how you manage your resources as well as how
the resources can be used. The “conventional wisdom” here—espoused by the top
search results from hobbynet bloggers—is that ARIN is focused on businesses and
RIPE is more hobbynet-friendly, but that’s a rather distorted version of the
truth. I’ve done my reading in the past and thought this way once, but I’ve come
to realize that things are a lot more complicated than that.</p>

<p>At this point, it might be worth noting that each RIR has its own policies on
how resources are allocated and how membership is managed, and these policies
are mostly motivated by the situation in their service region.</p>

<h3 id="ripe">RIPE</h3>

<p>Either way, let’s start with RIPE—or really, RIPE NCC, the <em>Réseaux IP
Européens</em> Network Coordination Centre. This is the RIR responsible for “Europe
and the Middle East”. Due to the relative difficulty of creating companies or
getting a trade name for sole proprietors in Europe, RIPE allows
“organisations”<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" rel="footnote">1</a></sup> to be created directly with personal names without
question.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" rel="footnote">2</a></sup> For this reason, RIPE is perceived to be a lot more friendly
toward hobbyists.</p>

<p>RIPE will only serve users who live or have “network presence” in their service
region. As far as RIPE is concerned, the latter means having at least a single
VPS in the region, which should be announcing at least one route under your ASN,
if you choose to get an ASN from them. If you aren’t a resident in the region,
you will be asked to produce an invoice for it. As long as you fulfill this
requirement, your RIPE resources may be used anywhere in the world.</p>

<p>IP resources in RIPE are broadly divided into two categories—Provider
Aggregatable (PA) and Provider Independent (PI). PA addresses are large blocks
(typically /29 or larger) allocated by RIPE to LIRs, who can in turn hand them
to whoever they please—well, subject to RIPE policy. In practice, there aren’t
many restrictions, and I’ve seen smaller blocks (especially /44 or smaller)
regularly being given away for free. It is <strong>important</strong> to note that as far as
RIPE is concerned, the PA block <em>belongs to the LIR</em> and <strong>not</strong> to the end
users to whom the LIR has assigned subblocks. This means that should the LIR go
under, RIPE <em>will take back the entire IP block</em> and end users will lose their
allocations without much warning. Therefore, when using PA addresses, it is
important to use an LIR that you can trust to continue existing.</p>

<p>You should also understand how LIRs operate. To become an LIR, RIPE will charge
a one-time fee, currently €1000, along with an annual fee, currently €1550, to
be paid in January of every year, which is prorated for new LIRs. RIPE
subscribes to the “one LIR, one fee” policy, which means large and small LIRs
pay the same. For details, see the <a href="https://www.ripe.net/participate/member-support/payment">RIPE payments page</a>. By policy,
each new LIR is entitled to a /24 of IPv4 (due to IPv4 exhaustion, any new LIR
will wait a long time before receiving it) and no more. For IPv6, new LIRs are
entitled to a /29 without justification.</p>

<p>If you choose to get PA addresses from an LIR, keep in mind they probably have
at least a /29 (which is 512k /48s) and are paying €1550/year for it. This means
that if they manage to fully sell their initial /29, they’ll break even selling
each /40 for 76 cents, each /44 for 4.8 cents, or each /48 for 0.3 cents per
year. Taking into account the sales and management overhead and the fact the LIR
might not sell 99% of their space, an LIR should probably not charge more than
$20/year for a PA block of /44 or smaller, or more than $40/year for a /40.</p>

<p>PI addresses are small blocks, typically no larger than /48, issued by RIPE
directly to end users. Of course, RIPE doesn’t deal with end users
directly—instead, users need to get an LIR to sponsor their request and act as
the intermediary. For each PI request, RIPE currently charges €50/year. A single
request may result in multiple /48s being allocated if the requester has
multiple sites and requests a /48 for each, as that’s the minimum routable size
on the Internet. It is very rare if not impossible for RIPE to allocate a /44 or
larger block of PI addresses, whether contiguously or in aggregate, so any LIR
purporting to sell that is unlikely to be able to deliver.</p>

<p>Typically, an LIR would charge a bit more than €50/year to handle the request,
but they are probably ripping you off if they charge more than double that.
Also, note that PI addresses are severely limited in use cases compared to PA.
For the exact details, see <a href="https://www.ripe.net/manage-ips-and-asns/ipv6/request-ipv6/how-to-request-an-ipv6-pi-assignment">the RIPE policy on this</a>. Furthermore, if
the sponsoring LIR for a PI block goes under, RIPE will ask the end user to find
another LIR sponsor within 30 days or take back the resource.</p>

<p>ASNs function very similarly to PI resources and require the same sponsorship
process, but they currently cost the LIRs nothing to get. This may change one
day. There was a proposal this year at the RIPE NCC General Meeting to add a
€50/year/ASN fee, but the motion has been defeated, though it may show up again.
For this reason, I think LIRs that charge annual fees for ASNs are being
unreasonable. In general, I don’t think an ASN should cost more than $100
one-time to issue.</p>

<p>Since IP addresses are required for an ASN to be issued, it’s also common for
LIRs to sell ASN and IP bundles. In these cases, the one-time fee should cover
the ASN and the recurring fee for the IP range.</p>

<h3 id="arin">ARIN</h3>

<p>On the other hand, the American Registry for Internet Numbers (ARIN) is the RIR
responsible for the US, Canada, and some Caribbean islands. In this region, it
is a lot easier to start a business, so ARIN requires you to be some form of
business before they will deal with you. From this, people get the impression
that ARIN hates hobbyists. This is not true, since ARIN will accept the simplest
business structure—the <a href="https://en.wikipedia.org/wiki/Sole_proprietorship">sole proprietorship</a>. Typically, they would like you
to have a trade name, which you can typically request from your local government
for a small sum of money. For example, in the province of Ontario, Canada, the
government issued me a “Business Name” for “Dynamic Quantum Networks” for $60
CAD, which is valid for 5 years. This is not more expensive than a domain name.
Alternatively, ARIN will let you use your personal name if you can prove you
have been doing business under that name.</p>

<p>For IP addresses, ARIN has two styles of allocations—ISP/LIR and end user.
ISP/LIR allocations are quite similar to RIPE’s concept of PA addresses. An ARIN
LIR can allocate their IP range to their customers as they please, provided that
records are kept to demonstrate that suballocations have been reasonable when
requesting more addresses. End user allocations are similar to PI, but ARIN
doesn’t have the concept of sponsorships. Instead, ARIN allocates resources
directly to the end user. In general, it probably makes more sense to request
resources as an ISP/LIR if possible, since the policies are a lot less
restrictive. For details, see the <a href="https://www.arin.net/participate/policy/nrpm/">Number Resource Policy Manual (NRPM)</a>,
specifically sections 4.2, 4.3, and 6.5.</p>

<p>Note that, unlike RIPE which allows your resources to be used anywhere, ARIN has
a more strict out-of-region use policy, requiring /22 of IPv4 to be used
in-region before you can use any IPv4 out-of-region. For IPv6, this is a /44
used in-region. For ASNs, the ASN must be present on at least one peering
session in-region. For details, see <a href="https://www.arin.net/participate/policy/nrpm/#9-out-of-region-use">the policy</a>.</p>

<p>ARIN has several one-time fees, such as for creating an organization, which is
required to receive any allocation. This fee is currently $50. ARIN’s annual
fees are based on the amount of resources that you have, currently starting at
$250 for up to a /24 of IPv4 and a /40<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" rel="footnote">3</a></sup> of IPv6. Currently, ARIN charges $550
to allocate an ASN and $150/year/ASN for ASN-only organizations. If you have any
IP addresses, you instead pay the annual fee and all ASNs are free once issued.
For details, see the <a href="https://www.arin.net/resources/fees/fee_schedule/">fee schedule</a>.</p>

<p>In 2024, this fee schedule is changing to be more reasonable—ASNs will be free
to allocate, and the smallest $250 annual fee covers up to 3 ASNs. For details,
see <a href="https://www.arin.net/resources/fees/fee_schedule/2024_faq/">the FAQ for this change</a>.</p>

<p>The simplified summary of ARIN’s allocation policy is as follows:</p>
<ul>
  <li>An LIR can request an initial IPv6 allocation of /32 without justification. An
LIR may choose to receive a /36 or a /40 instead to save on fees, but ARIN
reserves the full /32 and you can choose to upgrade at any time without
justification;</li>
  <li>An LIR can request an IPv4 allocation of /22 by going on the waitlist, for a
total of /20. An LIR may also request special reserved blocks with proper
justification; and</li>
  <li>An LIR can request an ASN with two peering partners.</li>
</ul>

<h3 id="other-rirs">Other RIRs</h3>

<p>APNIC may be an option if you live in the Asia-Pacific region. I am not familiar
with their policies, but I know they give a /23 of IPv4 addresses to each new
LIR, which is also the maximum amount of IPv4 APNIC will ever allocate.</p>

<p>AfriNIC and LACNIC don’t have all the features you’d expect from APNIC, ARIN,
and RIPE. For example, neither has an RPKI publication service for their
members, requiring the user to maintain their own. AfriNIC in particular is
also involved in <a href="https://en.wikipedia.org/wiki/AFRINIC#Controversies_and_scandals">many controversies and scandals</a>.</p>

<h3 id="decision">Decision</h3>

<p>I am not qualified to speak about APNIC, AfriNIC, or LACNIC, so I won’t. If you
live in their service region, you are welcome to do your own research and
compare them with RIPE, which remains a popular option for hobbyists in those
regions.</p>

<p>This leaves us with ARIN and RIPE. At first glance, ARIN might seem a lot more
expensive than RIPE, but keep in mind that:</p>
<ol>
  <li>even paying the lowest possible annual fee, you are a full member of ARIN and
can receive resources directly. This means you don’t need to worry about your
LIR going under; and</li>
  <li>ARIN has reserved pools of IPv4 addresses that can be immediately allocated
if you qualify for them. Given that the market rate of an IPv4 /24 is around
$1000/year, and that you will need to pay the full LIR fee to even get on
RIPE’s waitlist for a /24, ARIN’s $250/year fee for a /24 seems quite
reasonable. ARIN also has an IPv4 waitlist, but at least you don’t pay for
the resources until you receive them and you can request up to a /22 at once.</li>
</ol>

<p>In conclusion, RIPE seems like a decent choice for a beginner on a budget trying
to get the cheapest ASN and an IPv6 block possible, as long as the caveat with PA
addresses is understood. For a more serious network operating in ARIN’s service
region, especially one looking to run IPv4, ARIN is a strong contender.</p>

<p>Note that you can get IP space from one RIR and announce it with an ASN from
another RIR without issue. I personally operate AS200351, an ASN from RIPE, with
IP space from ARIN. If I were starting next year, given the knowledge that I
have now, I would probably have just gone with ARIN for everything.</p>

<h2 id="getting-an-asn">Getting an ASN</h2>

<p>First, regardless of RIR, you need to have two peers to justify having
an ASN. You can ask people in the <a href="https://discord.gg/ipv6">IPv6 networking discord</a> if they are
willing to peer.</p>

<p>You are also strongly encouraged to familiarize yourself with the policies of
your chosen RIR:</p>
<ul>
  <li>For RIPE, these are <a href="https://www.ripe.net/publications/docs/ripe-804">RIPE-804</a> for IPv4, <a href="https://www.ripe.net/publications/docs/ripe-738">RIPE-738</a> for
IPv6, and <a href="https://www.ripe.net/publications/docs/ripe-679">RIPE-679</a> for ASNs; and</li>
  <li>For ARIN, this is the <a href="https://www.arin.net/participate/policy/nrpm/">NRPM</a>.</li>
</ul>

<p>If you choose to use RIPE, you will need to find an LIR with a good reputation
that charges reasonable fees and get some PA addresses from them, which they
should be able to allocate very quickly, then request an ASN. Many LIRs offer
some IP+ASN bundle that does both together. If you are unsure which LIR to pick,
feel free to ask in the <a href="https://discord.gg/ipv6">IPv6 networking discord</a>, and I’ll also post
some recommendations below. Once you’ve done this, you will need to:</p>

<ol>
  <li>Register an <a href="https://access.ripe.net/registration">RIPE NCC Access account</a>;</li>
  <li>Create a <a href="https://apps.db.ripe.net/db-web-ui/webupdates/create/RIPE/person/self">person and maintainer pair</a> in the RIPE database (the
form should be self-explanatory);</li>
  <li>Create an <a href="https://apps.db.ripe.net/db-web-ui/webupdates/create/RIPE/organisation">“organisation” object</a> in the RIPE database. For
<code>org-name</code>, use your legal name or the name of a company that you control.
For <code>mnt-ref</code>, enter the <code>mntner</code> you created earlier. By the way, you will
also need to add a second <code>mnt-ref</code> entry later for your LIR to be able to
assign you an ASN or IP space, and they should tell you which one to add.
Everything else should be self-explanatory;</li>
  <li>Give the chosen LIR information on all the objects you’ve created in the RIPE
database and probably pay them as well;</li>
  <li>Sign an agreement with the LIR;</li>
  <li>Wait for the LIR to give you an identity verification link from RIPE<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" rel="footnote">4</a></sup> and
then complete the verification; and</li>
  <li>Wait for RIPE to issue your ASN.</li>
</ol>

<p>If you are going with ARIN, they have video guides for <a href="https://www.arin.net/resources/guide/account/">setting up your Org
ID</a> and <a href="https://www.arin.net/resources/guide/request/">requesting IP addresses</a>. You want to create an Org
ID, sign the Registration Services Agreement, request an initial allocation for
IPv6, then request an ASN.</p>

<h2 id="what-to-do-with-an-asn">What to do with an ASN</h2>

<p>Once you have an ASN, there are a few things you should probably do:</p>
<ol>
  <li>Create an AS-set for your AS-macro, which I talked about <a href="https://quantum5.ca/2023/07/19/diving-into-autonomous-systems/#as-sets-routing-registries-and-cones">earlier</a>.
You want to create this in the database of whichever RIR you used. You should
use the hierarchical form, naming it something like <code>ASx:as-all</code> where <code>x</code> is
your ASN, and add your own ASN as its sole member; and</li>
  <li>(Optional but recommended) Register on <a href="https://peeringdb.com">PeeringDB</a> and create a profile
for your ASN on it. You can use <a href="https://peeringdb.com/asn/200351">mine</a> as a reference.</li>
</ol>

<p>Then, you will need to find a BGP-capable server or colocation provider and pick
an IP range (/24 or larger for IPv4, /48 or larger for IPv6) to announce from
that server. You will most likely need to ask your provider to request a BGP
session, at which point you should tell them your ASN, AS-macro, and the IP
ranges you plan to announce. They may send a random string to the contact on
your organization object or the <code>aut-num</code> object for your ASN in the RIR whois
database and ask you to produce it, or ask you to set up RPSL declaring that
your provider is allowed to act as your upstream. In the latter case, if you
received AS64500 and your upstream is AS64510, you will need to add the
following lines to your <code>aut-num</code> object:</p>

<div><div><pre><code>import:         from AS64510 accept ANY
export:         to AS64510 announce AS64500:as-all
</code></pre></div></div>

<p>You can set up a basic BGP session with any BGP daemon. I would recommend using
whatever your BGP-capable router uses, or <a href="https://bird.network.cz/">bird</a> if you are just using a
Linux server. If you are using <code>bird</code>, you can build a configuration yourself
with the sample snippets from my <a href="https://github.com/quantum5/bird-filter"><code>bird</code> filter library</a>, or use a
configuration generator like <a href="https://pathvector.io/">PathVector</a>.</p>

<p>Now comes the hard part—building up your own network. There are many things you
can do, such as joining Internet Exchanges and getting multiple upstreams. The
possibilities are endless, and I can’t begin to explain everything that’s
possible. You will likely need to learn through trial and error. Good luck! If
you have any questions, feel free to ask them in the <a href="https://discord.gg/ipv6">IPv6 networking
discord</a>, where there are many people happy to help you out.</p>

<p>If there is popular demand, I may write a more in-depth post on setting up your
ASN. Otherwise, I’d probably just continue writing about the theory.</p>

<h2 id="recommendations">Recommendations</h2>

<p>This is when things get subjective. The providers listed here are believed to
have a good reputation by me or by people that I believe to be trustworthy and
charge reasonable rates. However, please use your common sense in case things
change. Also, if I use an affiliate link, I will offer an unaffiliated option as
well.</p>

<p>RIPE LIRs:</p>
<ul>
  <li><a href="https://my.cloudie.sh/aff.php?aff=20&amp;gid=7">Cloudie Networks</a> (<a href="https://my.cloudie.sh/index.php?rp=/store/lir-services">non-affiliate</a>)</li>
  <li><a href="https://scaleblade.com/products/lir">Scaleblade</a></li>
  <li><a href="https://my.ifog.ch/order/main/packages/LIR-Services/?group_id=1&amp;a=MTIyMw==">iFog</a> (for ASN and PI only, <a href="https://ifog.ch/en/ip/lir-services">non-affiliate</a>)</li>
  <li><a href="https://freetransit.ch">FreeTransit</a></li>
</ul>

<p>Note that you can probably get a PA /48 from a reputable LIR for free if you ask
around on Discord.</p>

<p>BGP-capable hosting:</p>
<ul>
  <li><a href="https://clients.accuristechnologies.ca/aff.php?aff=16&amp;gid=1">Accuris</a> (<a href="https://clients.accuristechnologies.ca/index.php?rp=/store/ottawa-kvm-vps">non-affiliate</a>)</li>
  <li><a href="https://my.frantech.ca/aff.php?aff=6718&amp;gid=1">BuyVM</a> (<a href="https://my.frantech.ca/cart.php">non-affiliate</a>)</li>
  <li>Cloudie Networks in <a href="https://my.cloudie.sh/aff.php?aff=20&amp;gid=22">Toronto</a> (<a href="https://my.cloudie.sh/index.php?rp=/store/onix-internet-exchange-offers">non-affiliate</a>) and
<a href="https://my.cloudie.sh/aff.php?aff=20&amp;gid=21">Fremont</a> (<a href="https://my.cloudie.sh/index.php?rp=/store/onix-internet-exchange-offers">non-affiliate</a>)</li>
  <li><a href="https://store.f4.network/index.php/order/forms/a/NTA=">F4 Networks</a> (<a href="https://store.f4.network/index.php/order/forms/">non-affiliate</a>)</li>
  <li><a href="https://my.ifog.ch/order/forms/a/MTIyMw==">iFog</a> (<a href="https://my.ifog.ch/order/forms/">non-affiliate</a>)</li>
  <li><a href="https://billing.limewave.net/aff.php?aff=103">Limewave</a> (<a href="https://billing.limewave.net/index.php?rp=/store/seattle-ryzen-kvm">non-affiliate</a>)</li>
  <li><a href="https://www.vultr.com/?ref=7302430">Vultr</a> (<a href="https://www.vultr.com/">non-affiliate</a>)</li>
  <li><a href="https://xenyth.net/?affid=878">Xenyth</a> (<a href="https://xenyth.net/">non-affiliate</a>)</li>
</ul>

<p>These cover the ones with which I’ve had personal experience. There are more
providers available on <a href="https://bgp.cheap/">bgp.cheap</a> and <a href="https://bgp.directory/">bgp.directory</a>
maintained by community members, but I can’t vouch for all of them personally.</p>

<h2 id="notes">Notes</h2>



  </div></div>
  </body>
</html>
