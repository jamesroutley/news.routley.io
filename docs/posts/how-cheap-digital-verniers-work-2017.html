<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.mjt.me.uk/posts/digital-vernier-teardown/">Original</a>
    <h1>How cheap digital verniers work (2017)</h1>
    
    <div id="readability-page-1" class="page"><div>
    <p>Ever wondered how cheap digital verniers are able to produce good precision at very low prices? I did, so I took one apart.</p>

<p>I&#39;m not the first person to look at this - <a href="http://www.grant-trebbin.com/2014/04/digital-calliper-teardown-and-repair.html">Grant Trebbin has some photos of a teardown</a>, and has done a good job of finding patents like <a href="https://www.google.com/patents/US5068653">US5068653 Capacitive displacement measuring device with t-shaped scale coatings</a>; <a href="https://web.archive.org/web/20130615164813/http://www.yadro.de/digital-scale/working.html">Nick Müller has inspected one with an oscilliscope</a> and <a href="http://glanyi.en.made-in-china.com/custom-detail/xJQxmEnAMEhQQQmxJxnKeEdE/How-does-the-Electronic-Module-Work-.html">Anyi Instrument Co</a> have posted some info on how the sensors work.</p>

<p>Turns out they use capacitive sensing - there&#39;s a thin PCB hidden under a label on the shaft of the vernier:</p>

<p><img src="https://www.mjt.me.uk/assets/images/vernier/capacitive-sensor-600dpi.jpg" alt="Capacitive sensing elements"/></p>

<p>The green PCB on the left is for the slider. Every eighth bar in the densely striped section is connected together - i.e. the first, 9th and 17th bars are connected together, as are the 2nd, 10th and 18th, and so on.</p>

<p><img src="https://www.mjt.me.uk/assets/images/vernier/sensor-transparent-overlay-cropped.jpg" alt="Slider overlaid on shaft"/></p>

<p>I measured the distance between the PCBs on the slider and shaft using a cheap feeler gauge; the spacing was about 0.35mm ±0.05mm.</p>

<p>Based on the 600 dpi scan above, the T sections on the shaft and the densely striped section is about 250 mm², and each of the eight banks of stripes has an area of 31 mm². The return strip has an area of about 95 mm². The comb overlaps the ground plane by about 43mm²; while that&#39;s obviously the same order of magnitude as the return strip, they don&#39;t seem to have been made precisely the same surface area.</p>

<p>So each of the eight stripes has a capaitance of about <a href="https://www.wolframalpha.com/input/?i=capacitance+of+parallel+plates&amp;rawformassumption=%7B%22FS%22%7D+-%3E+%7B%7B%22ParallelPlateCapacitance%22,+%22C%22%7D%7D&amp;rawformassumption=%7B%22F%22,+%22ParallelPlateCapacitance%22,+%22A%22%7D+-%3E%2231+mm%5E2%22&amp;rawformassumption=%7B%22F%22,+%22ParallelPlateCapacitance%22,+%22d%22%7D+-%3E%220.35+mm%22&amp;rawformassumption=%7B%22F%22,+%22ParallelPlateCapacitance%22,+%22er%22%7D+-%3E%221%22">0.78 picofarads</a> while the return strip has a capacitance of about <a href="https://www.wolframalpha.com/input/?i=capacitance+of+parallel+plates&amp;rawformassumption=%7B%22FS%22%7D+-%3E+%7B%7B%22ParallelPlateCapacitance%22,+%22C%22%7D%7D&amp;rawformassumption=%7B%22F%22,+%22ParallelPlateCapacitance%22,+%22A%22%7D+-%3E%2295+mm%5E2%22&amp;rawformassumption=%7B%22F%22,+%22ParallelPlateCapacitance%22,+%22d%22%7D+-%3E%220.35+mm%22&amp;rawformassumption=%7B%22F%22,+%22ParallelPlateCapacitance%22,+%22er%22%7D+-%3E%221%22">2.4 picofarads</a> - taken in series, that&#39;s about equivalent to 0.588 picofarads. That&#39;s very small. For example, the ADC on an ATMega (like an Arduino Uno) has an input capacitance of ~14pF. It&#39;s also smaller than the input capacitance of my oscilliscope. But some capacitive sensors claim to be able to measure femtofarad capacitance changes - the <a href="http://www.analog.com/media/en/technical-documentation/data-sheets/AD7745_7746.pdf">AD7745 claims an accuracy of 4 femtofarads</a>, and <a href="http://www.analog.com/media/en/technical-documentation/data-sheets/AD7147.pdf">the AD7147 a sub-femtofarad output noise</a>.</p>

<p>The stripes in the densely striped section are about 0.63mm wide, and the vernier&#39;s precision is 0.01mm. That means, if my estimate of a 588 femtofarad capacitance is correct, the capacitance measurement is precise to about 9 femtofarads.</p>

<p>If you attach an oscilliscope to the eight sets of bars in the striped section, and the return bar, here&#39;s what you see:</p>

<!--
cat scope-01-seven-channels-a-is-output_1.csv | sed -n '1~2!p' | sed -n '1~2!p' | sed -n '1~2!p' | sed -n '1~2!p' > decimated.csv
head -n 1 scope-01-seven-channels-a-is-output_1.csv > short.csv
cat decimated.csv | awk -F, '{OFS=",";print $1,$2,$3,$4,$5,$6,$7,$8,$9,1.6-$6}' >> short.csv

head -n 1 scope-01-seven-channels-a-is-output_1.csv > first5k.csv
tail -n +4 scope-01-seven-channels-a-is-output_1.csv | head -n 5000 | awk -F, '{OFS=",";print $1,$2,$3,$4,$5,$6,$7,$8,$9,1.6-$6}' >> first5k.csv
-->



<p>( <a href="https://www.mjt.me.uk/assets/images/vernier/scope-01-seven-channels-a-is-output_1.csv.gz">Raw data CSV</a> )</p>

<p>Of course, the oscilliscope&#39;s probes introduce a certain extra resistance and capacitance. Several tens of picofarads of capacitance and 10 MOhms of resistance, both to ground, would be typical.</p>

<p>Unfortunately, I didn&#39;t keep track of exactly which channel was which - but Nick Müller&#39;s oscilliscope work, linked above, shows us the inputs that are inversions of one another are four bars apart in the striped section. Also, as I used an 8-channel oscilliscope, I could only track the output and seven inputs. So the line marked &#34;Input 5&#34; is just input 6 flipped over.</p>

<p>Let&#39;s zoom in on that first section.</p>



<p>Nick Müller&#39;s trace shows the output spiking high and low in equal amounts - I assume the fact mine doesn&#39;t is because it&#39;s clamped to the battery voltage by a diode, or something similar. The low spikes have a width of about 0.01ms - presumably something pulls the output to the center value after the spike has been measured.</p>

<p>The sensing cycle appears to take differential measurements between of bars; in the diagram above a pair of lines either becomes narrow or becomes wide. The sensing cycle appears to rotate between all channels narrowing (widening); three of the four channels widening (narrowing) while the remaining channel is fixed; and three of the four channels widening (narrowing) while the remaining channel does the opposite.</p>

<p>A complete sensing cycle takes around 1.7 milliseconds - although the system may average multiple sensing cycles to reduce noise. The AD7147, linked above, takes 6-36ms to sample 8 inputs (depending on how precisely you want to measure).</p>

<p>The comb on the vernier shaft has a tooth pitch of 5mm. In other words, if the slider instantly moved 5mm, it would be undetectable, or &#39;ambiguous&#39;. So what&#39;s the top speed you could go at? Depends (a) how much sample averaging you need and (b) if you can measure while moving. Assuming you can measure while moving, if a measurement takes 1.7ms and you want four per ambiguity step (i.e. a measurement every 1.25mm) you could go as fast as 0.7 m/s - but if it takes 66ms to make such a measurement, your speed would drop to 0.035 m/s. Or maybe the measurements work some other way and I&#39;m completely wrong!</p>







    </div></div>
  </body>
</html>
