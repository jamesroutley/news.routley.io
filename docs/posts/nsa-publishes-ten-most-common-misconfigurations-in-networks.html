<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-278a">Original</a>
    <h1>NSA publishes ten most common misconfigurations in networks</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
  
  
  <div>
          <h4><strong>A plea for network defenders and software manufacturers to fix common problems.</strong></h4>
<h3><strong>EXECUTIVE SUMMARY</strong></h3>
<p>The National Security Agency (NSA) and Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint cybersecurity advisory (CSA) to highlight the most common cybersecurity misconfigurations in large organizations, and detail the tactics, techniques, and procedures (TTPs) actors use to exploit these misconfigurations.</p>
<p>Through NSA and CISA Red and Blue team assessments, as well as through the activities of NSA and CISA Hunt and Incident Response teams, the agencies identified the following 10 most common network misconfigurations:</p>
<ol><li>Default configurations of software and applications</li>
<li>Improper separation of user/administrator privilege</li>
<li>Insufficient internal network monitoring</li>
<li>Lack of network segmentation</li>
<li>Poor patch management</li>
<li>Bypass of system access controls</li>
<li>Weak or misconfigured multifactor authentication (MFA) methods</li>
<li>Insufficient access control lists (ACLs) on network shares and services</li>
<li>Poor credential hygiene</li>
<li>Unrestricted code execution</li>
</ol><p>These misconfigurations illustrate (1) a trend of systemic weaknesses in many large organizations, including those with mature cyber postures, and (2) the importance of software manufacturers embracing secure-by-design principles to reduce the burden on network defenders:</p>
<ul><li>Properly trained, staffed, and funded network security teams can implement the known mitigations for these weaknesses.</li>
<li>Software manufacturers must reduce the prevalence of these misconfigurations—thus strengthening the security posture for customers—by incorporating <a href="https://www.cisa.gov/securebydesign" title="Secure by Design">secure-by-design and -default principles</a> and tactics into their software development practices.[1]</li>
</ul><p>NSA and CISA encourage network defenders to implement the recommendations found within the <a href="#_Mitigations">Mitigations</a> section of this advisory—including the following—to reduce the risk of malicious actors exploiting the identified misconfigurations.</p>
<ul><li>Remove default credentials and harden configurations.</li>
<li>Disable unused services and implement access controls.</li>
<li>Update regularly and automate patching, prioritizing patching of <a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" title="Known Exploited Vulnerabilities Catalog">known exploited vulnerabilities</a>.<u>[</u><u>2</u><u>]</u></li>
<li>Reduce, restrict, audit, and monitor administrative accounts and privileges.</li>
</ul><p>NSA and CISA urge software manufacturers to take ownership of improving security outcomes of their customers by embracing secure-by-design and-default tactics, including:</p>
<ul><li>Embedding security controls into product architecture from the start of development and throughout the entire software development lifecycle (SDLC).</li>
<li>Eliminating default passwords.</li>
<li>Providing high-quality audit logs to customers at no extra charge.</li>
<li>Mandating MFA, ideally <a href="https://conversationswith.rocks/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf" title="Implementing Phishing-Resistant MFA">phishing-resistant</a>, for privileged users and making MFA a default rather than opt-in feature.[3]</li>
</ul><p>Download the PDF version of this report: <a href="https://media.defense.gov/2023/Oct/05/2003314578/-1/-1/0/JOINT_CSA_TOP_TEN_MISCONFIGURATIONS_TLP-CLEAR.PDF" title="NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations">PDF, 660 KB</a></p>
<h3><strong>TECHNICAL DETAILS</strong></h3>
<p><strong>Note:</strong> This advisory uses the <a href="https://attack.mitre.org/versions/v13/matrices/enterprise/" title="Enterprise Matrix">MITRE ATT&amp;CK<sup>®</sup> for Enterprise</a> framework, version 13, and the <a href="https://d3fend.mitre.org/" title="A knowledge graph of cybersecurity countermeasures">MITRE D3FEND™</a> cybersecurity countermeasures framework.[4],[5] See the Appendix: MITRE ATT&amp;CK tactics and techniques section for tables summarizing the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques, and the Mitigations section for MITRE D3FEND countermeasures.</p>
<p>For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href="https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping" title="Best Practices for MITRE ATT&amp;CK® Mapping">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href="https://github.com/cisagov/Decider/" title="cisagov / decider">Decider Tool</a>.[6],[7]</p>
<h4><em><strong>Overview</strong></em></h4>
<p>Over the years, the following NSA and CISA teams have assessed the security posture of many network enclaves across the Department of Defense (DoD); Federal Civilian Executive Branch (FCEB); state, local, tribal, and territorial (SLTT) governments; and the private sector:</p>
<ul><li>Depending on the needs of the assessment, NSA Defensive Network Operations (DNO) teams feature capabilities from Red Team (adversary emulation), Blue Team (strategic vulnerability assessment), Hunt (targeted hunt), and/or Tailored Mitigations (defensive countermeasure development).</li>
<li>CISA Vulnerability Management (VM) teams have assessed the security posture of over 1,000 network enclaves. CISA VM teams include <a href="https://conversationswith.rocks/sites/default/files/publications/VM_Assessments_Fact_Sheet_RVA_508C.pdf" title="CYBER ASSESSMENT FACT SHEET Risk and Vulnerability Assessment">Risk and Vulnerability Assessment (RVA)</a> and CISA Red Team Assessments (RTA).[8] The RVA team conducts remote and onsite assessment services, including penetration testing and configuration review. RTA emulates cyber threat actors in coordination with an organization to assess the organization’s cyber detection and response capabilities.</li>
<li>CISA Hunt and Incident Response teams conduct proactive and reactive engagements, respectively, on organization networks to identify and detect cyber threats to U.S. infrastructure.</li>
</ul><p>During these assessments, NSA and CISA identified the 10 most common network misconfigurations, which are detailed below. These misconfigurations (non-prioritized) are systemic weaknesses across many networks.</p>
<p>Many of the assessments were of Microsoft<sup>®</sup> Windows<sup>®</sup> and Active Directory<sup>®</sup> environments. This advisory provides details about, and mitigations for, specific issues found during these assessments, and so mostly focuses on these products. However, it should be noted that many other environments contain similar misconfigurations. Network owners and operators should examine their networks for similar misconfigurations even when running other software not specifically mentioned below.</p>
<h4><em><strong>1. Default Configurations of Software and Applications</strong></em></h4>
<p>Default configurations of systems, services, and applications can permit unauthorized access or other malicious activity. Common default configurations include:</p>
<ul><li>Default credentials</li>
<li>Default service permissions and configurations settings</li>
</ul><h5><strong>Default Credentials</strong></h5>
<p>Many software manufacturers release commercial off-the-shelf (COTS) network devices —which provide user access via applications or web portals—containing predefined default credentials for their built-in administrative accounts.[9] Malicious actors and assessment teams regularly abuse default credentials by:</p>
<ul><li>Finding credentials with a simple web search [<a href="https://attack.mitre.org/versions/v13/techniques/T1589/001" title="Gather Victim Identity Information: Credentials">T1589.001</a>] and using them [<a href="https://attack.mitre.org/versions/v13/techniques/T1078/001" title="Valid Accounts: Default Accounts">T1078.001</a>] to gain authenticated access to a device.</li>
<li>Resetting built-in administrative accounts [<a href="https://attack.mitre.org/versions/v13/techniques/T1098/" title="Account Manipulation">T1098</a>] via predictable forgotten passwords questions.</li>
<li>Leveraging default virtual private network (VPN) credentials for internal network access [<a href="https://attack.mitre.org/versions/v13/techniques/T1133/" title="External Remote Services">T1133</a>].</li>
<li>Leveraging publicly available setup information to identify built-in administrative credentials for web applications and gaining access to the application and its underlying database.</li>
<li>Leveraging default credentials on software deployment tools [<a href="https://attack.mitre.org/versions/v13/techniques/T1072/" title="Software Deployment Tools">T1072</a>] for code execution and lateral movement.</li>
</ul><p>In addition to devices that provide network access, printers, scanners, security cameras, conference room audiovisual (AV) equipment, voice over internet protocol (VoIP) phones, and internet of things (IoT) devices commonly contain default credentials that can be used for easy unauthorized access to these devices as well. Further compounding this problem, printers and scanners may have privileged domain accounts loaded so that users can easily scan documents and upload them to a shared drive or email them. Malicious actors who gain access to a printer or scanner using default credentials can use the loaded privileged domain accounts to move laterally from the device and compromise the domain [<a href="https://attack.mitre.org/versions/v13/techniques/T1078/002/" title="Valid Accounts: Domain Accounts">T1078.002</a>].</p>
<h5><strong>Default Service Permissions and Configuration Settings</strong></h5>
<p>Certain services may have overly permissive access controls or vulnerable configurations by default. Additionally, even if the providers do not enable these services by default, malicious actors can easily abuse these services if users or administrators enable them.</p>
<p>Assessment teams regularly find the following:</p>
<ul><li>Insecure Active Directory Certificate Services</li>
<li>Insecure legacy protocols/services</li>
<li>Insecure Server Message Block (SMB) service</li>
</ul><h5><em>Insecure Active Directory Certificate Services</em></h5>
<p>Active Directory Certificate Services (ADCS) is a feature used to manage Public Key Infrastructure (PKI) certificates, keys, and encryption inside of Active Directory (AD) environments. ADCS templates are used to build certificates for different types of servers and other entities on an organization’s network.</p>
<p>Malicious actors can exploit ADCS and/or ADCS template misconfigurations to manipulate the certificate infrastructure into issuing fraudulent certificates and/or escalate user privileges to domain administrator privileges. These certificates and domain escalation paths may grant actors unauthorized, persistent access to systems and critical data, the ability to impersonate legitimate entities, and the ability to bypass security measures.</p>
<p>Assessment teams have observed organizations with the following misconfigurations:</p>
<ul><li><strong>ADCS servers running with web-enrollment enabled</strong>. If web-enrollment is enabled, unauthenticated actors can coerce a server to authenticate to an actor-controlled computer, which can relay the authentication to the ADCS web-enrollment service and obtain a certificate [<a href="https://attack.mitre.org/versions/v13/techniques/T1649/" title="Steal or Forge Authentication Certificates">T1649</a>] for the server’s account. These fraudulent, trusted certificates enable actors to use adversary-in-the-middle techniques [<a href="https://attack.mitre.org/versions/v13/techniques/T1557/" title="Adversary-in-the-Middle">T1557</a>] to masquerade as trusted entities on the network. The actors can also use the certificate for AD authentication to obtain a Kerberos Ticket Granting Ticket (TGT) [<a href="https://attack.mitre.org/versions/v13/techniques/T1558/001/" title="Steal or Forge Kerberos Tickets: Golden Ticket">T1558.001</a>], which they can use to compromise the server and usually the entire domain.</li>
<li><strong>ADCS templates where low-privileged users have enrollment rights, and the enrollee supplies a subject alternative name.</strong> Misconfiguring various elements of ADCS templates can result in domain escalation by unauthorized users (e.g., granting low-privileged users certificate enrollment rights, allowing requesters to specify a <code>subjectAltName</code> in the certificate signing request [CSR], not requiring authorized signatures for CSRs, granting <code>FullControl</code> or <code>WriteDacl</code> permissions to users). Malicious actors can use a low-privileged user account to request a certificate with a particular Subject Alternative Name (SAN) and gain a certificate where the SAN matches the User Principal Name (UPN) of a privileged account.</li>
</ul><p><strong>Note:</strong> For more information on known escalation paths, including <a href="https://support.microsoft.com/en-us/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429" title="KB5005413: Mitigating NTLM Relay Attacks on Active Directory Certificate Services (AD CS)">PetitPotam NTLM relay techniques</a>, see: <a href="https://www.hackingarticles.in/domain-escalation-petitpotam-ntlm-relay-to-adcs-endpoints/" title="Domain Escalation: PetitPotam NTLM Relay to ADCS Endpoints">Domain Escalation: PetitPotam NTLM Relay to ADCS Endpoints</a> and <a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2" title="Certified Pre-Owned">Certified Pre-Owned, Active Directory Certificate Services</a>.[10],[11],[12]</p>
<h5><em>Insecure legacy protocols/services</em></h5>
<p>Many vulnerable network services are enabled by default, and assessment teams have observed them enabled in production environments. Specifically, assessment teams have observed Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS), which are Microsoft Windows components that serve as alternate methods of host identification. If these services are enabled in a network, actors can use spoofing, poisoning, and relay techniques [<a href="https://attack.mitre.org/versions/v13/techniques/T1557/001/" title="Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay">T1557.001</a>] to obtain domain hashes, system access, and potential administrative system sessions. Malicious actors frequently exploit these protocols to compromise entire Windows’ environments.</p>
<p>Malicious actors can spoof an authoritative source for name resolution on a target network by responding to passing traffic, effectively poisoning the service so that target computers will communicate with an actor-controlled system instead of the intended one. If the requested system requires identification/authentication, the target computer will send the user’s username and hash to the actor-controlled system. The actors then collect the hash and crack it offline to obtain the plain text password [<a href="https://attack.mitre.org/versions/v13/techniques/T1110/002/" title="Brute Force: Password Cracking">T1110.002</a>].</p>
<h5><em>Insecure Server Message Block (SMB) service</em></h5>
<p>The Server Message Block service is a Windows component primarily for file sharing. Its default configuration, including in the latest version of Windows, does not require signing network messages to ensure authenticity and integrity. If SMB servers do not enforce SMB signing, malicious actors can use machine-in-the-middle techniques, such as NTLM relay. Further, malicious actors can combine a lack of SMB signing with the name resolution poisoning issue (see above) to gain access to remote systems [<a href="https://attack.mitre.org/versions/v13/techniques/T1021/002/" title="Remote Services: SMB/Windows Admin Shares">T1021.002</a>] without needing to capture and crack any hashes.</p>
<h4><strong><em>2. Improper Separation of User/Administrator Privilege</em></strong></h4>
<p>Administrators often assign multiple roles to one account. These accounts have access to a wide range of devices and services, allowing malicious actors to move through a network quickly with one compromised account without triggering lateral movement and/or privilege escalation detection measures.</p>
<p>Assessment teams have observed the following common account separation misconfigurations:</p>
<ul><li>Excessive account privileges</li>
<li>Elevated service account permissions</li>
<li>Non-essential use of elevated accounts</li>
</ul><h5><strong>Excessive Account Privileges</strong></h5>
<p>Account privileges are intended to control user access to host or application resources to limit access to sensitive information or enforce a least-privilege security model. When account privileges are overly permissive, users can see and/or do things they should not be able to, which becomes a security issue as it increases risk exposure and attack surface.</p>
<p>Expanding organizations can undergo numerous changes in account management, personnel, and access requirements. These changes commonly lead to privilege creep—the granting of excessive access and unnecessary account privileges. Through the analysis of topical and nested AD groups, a malicious actor can find a user account [<a href="https://attack.mitre.org/versions/v13/techniques/T1078/" title="Valid Accounts">T1078</a>] that has been granted account privileges that exceed their need-to-know or least-privilege function. Extraneous access can lead to easy avenues for unauthorized access to data and resources and escalation of privileges in the targeted domain.</p>
<h5><strong>Elevated Service Account Permissions</strong></h5>
<p>Applications often operate using user accounts to access resources. These user accounts, which are known as service accounts, often require elevated privileges. When a malicious actor compromises an application or service using a service account, they will have the same privileges and access as the service account.</p>
<p>Malicious actors can exploit elevated service permissions within a domain to gain unauthorized access and control over critical systems. Service accounts are enticing targets for malicious actors because such accounts are often granted elevated permissions within the domain due to the nature of the service, and because access to use the service can be requested by any valid domain user. Due to these factors, kerberoasting—a form of credential access achieved by cracking service account credentials—is a common technique used to gain control over service account targets [<a href="https://attack.mitre.org/versions/v13/techniques/T1558/003/" title="Steal or Forge Kerberos Tickets: Kerberoasting">T1558.003</a>].</p>
<h5><strong>Non-Essential Use of Elevated Accounts</strong></h5>
<p>IT personnel use domain administrator and other administrator accounts for system and network management due to their inherent elevated privileges. When an administrator account is logged into a compromised host, a malicious actor can steal and use the account&#39;s credentials and an AD-generated authentication token [<a href="https://attack.mitre.org/versions/v13/techniques/T1528/" title="Steal Application Access Token">T1528</a>] to move, using the elevated permissions, throughout the domain [<a href="https://attack.mitre.org/versions/v13/techniques/T1550/001/" title="Use Alternate Authentication Material: Application Access Token">T1550.001</a>]. Using an elevated account for normal day-to-day, non-administrative tasks increases the account’s exposure and, therefore, its risk of compromise and its risk to the network.</p>
<p>Malicious actors prioritize obtaining valid domain credentials upon gaining access to a network. Authentication using valid domain credentials allows the execution of secondary enumeration techniques to gain visibility into the target domain and AD structure, including discovery of elevated accounts and where the elevated accounts are used [<a href="https://attack.mitre.org/versions/v13/techniques/T1087/" title="Account Discovery">T1087</a>].</p>
<p>Targeting elevated accounts (such as domain administrator or system administrators) performing day-to-day activities provides the most direct path to achieve domain escalation. Systems or applications accessed by the targeted elevated accounts significantly increase the attack surface available to adversaries, providing additional paths and escalation options.</p>
<p>After obtaining initial access via an account with administrative permissions, an assessment team compromised a domain in under a business day. The team first gained initial access to the system through phishing [<a href="https://attack.mitre.org/versions/v13/techniques/T1566/" title="Phishing">T1566</a>], by which they enticed the end user to download [<a href="https://attack.mitre.org/versions/v13/techniques/T1204" title="User Execution">T1204</a>] and execute malicious payloads. The targeted end-user account had administrative permissions, enabling the team to quickly compromise the entire domain.</p>
<h4><strong><em>3. Insufficient Internal Network Monitoring</em></strong></h4>
<p>Some organizations do not optimally configure host and network sensors for traffic collection and end-host logging. These insufficient configurations could lead to undetected adversarial compromise. Additionally, improper sensor configurations limit the traffic collection capability needed for enhanced baseline development and detract from timely detection of anomalous activity.</p>
<p>Assessment teams have exploited insufficient monitoring to gain access to assessed networks. For example:</p>
<ul><li>An assessment team observed an organization with host-based monitoring, but no network monitoring. Host-based monitoring informs defensive teams about adverse activities on singular hosts and network monitoring informs about adverse activities traversing hosts [<a href="https://attack.mitre.org/versions/v13/tactics/TA0008/" title="Lateral Movement">TA0008</a>]. In this example, the organization could identify infected hosts but could not identify where the infection was coming from, and thus could not stop future lateral movement and infections.</li>
<li>An assessment team gained persistent deep access to a large organization with a mature cyber posture. The organization did not detect the assessment team’s lateral movement, persistence, and command and control (C2) activity, including when the team attempted noisy activities to trigger a security response. For more information on this activity, see CSA <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-059a" title="CISA Red Team Shares Key Findings to Improve Monitoring and Hardening of Networks">CISA Red Team Shares Key Findings to Improve Monitoring and Hardening of Networks</a>.[13]</li>
</ul><h4><strong><em>4. Lack of Network Segmentation</em></strong></h4>
<p>Network segmentation separates portions of the network with security boundaries. Lack of network segmentation leaves no security boundaries between the user, production, and critical system networks. Insufficient network segmentation allows an actor who has compromised a resource on the network to move laterally across a variety of systems uncontested. Lack of network segregation additionally leaves organizations significantly more vulnerable to potential ransomware attacks and post-exploitation techniques.</p>
<p>Lack of segmentation between IT and operational technology (OT) environments places OT environments at risk. For example, assessment teams have often gained access to OT networks—despite prior assurance that the networks were fully air gapped, with no possible connection to the IT network—by finding special purpose, forgotten, or even accidental network connections [<a href="https://attack.mitre.org/versions/v13/techniques/T1199/" title="Trusted Relationship">T1199</a>].</p>
<h4><em><strong>5. Poor Patch Management</strong></em></h4>
<p>Vendors release patches and updates to address security vulnerabilities. Poor patch management and network hygiene practices often enable adversaries to discover open attack vectors and exploit critical vulnerabilities. Poor patch management includes:</p>
<ul><li>Lack of regular patching</li>
<li>Use of unsupported operating systems (OSs) and outdated firmware</li>
</ul><h5><strong>Lack of Regular Patching</strong></h5>
<p>Failure to apply the latest patches can leave a system open to compromise from publicly available exploits. Due to their ease of discovery—via vulnerability scanning [<a href="https://attack.mitre.org/versions/v13/techniques/T1595/002/" title="Active Scanning: Vulnerability Scanning">T1595.002</a>] and open source research [<a href="https://attack.mitre.org/versions/v13/techniques/T1592/" title="Gather Victim Host Information">T1592</a>]—and exploitation, these systems are immediate targets for adversaries. Allowing critical vulnerabilities to remain on production systems without applying their corresponding patches significantly increases the attack surface. Organizations should prioritize patching <a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" title="Known Exploited Vulnerabilities Catalog">known exploited vulnerabilities</a> in their environments.[2]</p>
<p>Assessment teams have observed threat actors exploiting many CVEs in public-facing applications [<a href="https://attack.mitre.org/versions/v13/techniques/T1190/" title="Exploit Public-Facing Application">T1190</a>], including:</p>
<ul><li>CVE-2019-18935 in an unpatched instance of Telerik<sup>®</sup> UI for ASP.NET running on a Microsoft IIS server.[14]</li>
<li>CVE-2021-44228 (Log4Shell) in an unpatched VMware<sup>®</sup> Horizon server.[15]</li>
<li>CVE-2022-24682, CVE-2022-27924, and CVE-2022-27925 chained with CVE-2022-37042, or CVE-2022-30333 in an unpatched Zimbra<sup>®</sup> Collaboration Suite.[16]</li>
</ul><h5><strong>Use of Unsupported OSs and Outdated Firmware</strong></h5>
<p>Using software or hardware that is no longer supported by the vendor poses a significant security risk because new and existing vulnerabilities are no longer patched. Malicious actors can exploit vulnerabilities in these systems to gain unauthorized access, compromise sensitive data, and disrupt operations [<a href="https://attack.mitre.org/versions/v13/techniques/T1210/" title="Exploitation of Remote Services">T1210</a>].</p>
<p>Assessment teams frequently observe organizations using unsupported Windows operating systems without updates <a href="https://support.microsoft.com/en-us/topic/how-to-verify-that-ms17-010-is-installed-f55d3f13-7a9c-688c-260b-477d0ec9f2c8" title="How to verify that MS17-010 is installed">MS17-010</a> and <a href="https://learn.microsoft.com/en-us/security-updates/SecurityBulletins/2008/ms08-067" title="Microsoft Security Bulletin MS08-067 - Critical">MS08-67</a>. These updates, released years ago, address critical remote code execution vulnerabilities.[17],[18]</p>
<h4><em><strong>6. Bypass of System Access Controls</strong></em></h4>
<p>A malicious actor can bypass system access controls by compromising alternate authentication methods in an environment. If a malicious actor can collect hashes in a network, they can use the hashes to authenticate using non-standard means, such as pass-the-hash (PtH) [<a href="https://attack.mitre.org/versions/v13/techniques/T1550/002/" title="Use Alternate Authentication Material: Pass the Hash">T1550.002</a>]. By mimicking accounts without the clear-text password, an actor can expand and fortify their access without detection. Kerberoasting is also one of the most time-efficient ways to elevate privileges and move laterally throughout an organization’s network.</p>
<h4><em><strong>7. Weak or Misconfigured MFA Methods</strong></em></h4>
<h5><strong>Misconfigured Smart Cards or Tokens</strong></h5>
<p>Some networks (generally government or DoD networks) require accounts to use smart cards or tokens. Multifactor requirements can be misconfigured so the password hashes for accounts never change. Even though the password itself is no longer used—because the smart card or token is required instead—there is still a password hash for the account that can be used as an alternative credential for authentication. If the password hash never changes, once a malicious actor has an account’s password hash [<a href="https://attack.mitre.org/versions/v13/techniques/T1111/" title="Multi-Factor Authentication Interception">T1111</a>], the actor can use it indefinitely, via the PtH technique for as long as that account exists.</p>
<h5><strong>Lack of Phishing-Resistant MFA</strong></h5>
<p>Some forms of MFA are vulnerable to phishing, “push bombing” [<a href="https://attack.mitre.org/versions/v13/techniques/T1621/" title="Multi-Factor Authentication Request Generation">T1621</a>], exploitation of Signaling System 7 (SS7) protocol vulnerabilities, and/or “SIM swap” techniques. These attempts, if successful, may allow a threat actor to gain access to MFA authentication credentials or bypass MFA and access the MFA-protected systems. (See CISA’s Fact Sheet <a href="https://conversationswith.rocks/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf" title="Implementing Phishing-Resistant MFA">Implementing Phishing-Resistant MFA</a> for more information.)[3]</p>
<p>For example, assessment teams have used voice phishing to convince users to provide missing MFA information [<a href="https://attack.mitre.org/versions/v13/techniques/T1598/" title="Phishing for Information">T1598</a>]. In one instance, an assessment team knew a user’s main credentials, but their login attempts were blocked by MFA requirements. The team then masqueraded as IT staff and convinced the user to provide the MFA code over the phone, allowing the team to complete their login attempt and gain access to the user’s email and other organizational resources.</p>
<h4><em><strong>8. Insufficient ACLs on Network Shares and Services</strong></em></h4>
<p>Data shares and repositories are primary targets for malicious actors. Network administrators may improperly configure ACLs to allow for unauthorized users to access sensitive or administrative data on shared drives.</p>
<p>Actors can use commands, open source tools, or custom malware to look for shared folders and drives [<a href="https://attack.mitre.org/versions/v13/techniques/T1135/" title="Network Share Discovery">T1135</a>].</p>
<ul><li>In one compromise, a team observed actors use the <code>net share</code> command—which displays information about shared resources on the local computer—and the <code>ntfsinfo</code> command to search network shares on compromised computers. In the same compromise, the actors used a custom tool, <a href="https://conversationswith.rocks/sites/default/files/2023-06/mar-10365227.r1.v1.clear_.pdf" title="Malware Analysis Report - CovalentStealer">CovalentStealer</a>, which is designed to identify file shares on a system, categorize the files [<a href="https://attack.mitre.org/versions/v13/techniques/T1083/" title="File and Directory Discovery">T1083</a>], and upload the files to a remote server [<a href="https://attack.mitre.org/versions/v13/tactics/TA0010/" title="Exfiltration">TA0010</a>].[19],[20]</li>
<li>Ransomware actors have used the SoftPerfect<sup>®</sup> Network Scanner, <code>netscan.exe</code>—which can ping computers [<a href="https://attack.mitre.org/versions/v13/techniques/T1018/" title="Remote System Discovery">T1018</a>], scan ports [<a href="https://attack.mitre.org/versions/v13/techniques/T1046/" title="Network Service Discovery">T1046</a>], and discover shared folders—and SharpShares to enumerate accessible network shares in a domain.[21],[22]</li>
</ul><p>Malicious actors can then collect and exfiltrate the data from the shared drives and folders. They can then use the data for a variety of purposes, such as extortion of the organization or as intelligence when formulating intrusion plans for further network compromise. Assessment teams routinely find sensitive information on network shares [<a href="https://attack.mitre.org/versions/v13/techniques/T1039/" title="Data from Network Shared Drive">T1039</a>] that could facilitate follow-on activity or provide opportunities for extortion. Teams regularly find drives containing cleartext credentials [<a href="https://attack.mitre.org/versions/v13/techniques/T1552/" title="Unsecured Credentials">T1552</a>] for service accounts, web applications, and even domain administrators.</p>
<p>Even when further access is not directly obtained from credentials in file shares, there can be a treasure trove of information for improving situational awareness of the target network, including the network’s topology, service tickets, or vulnerability scan data. In addition, teams regularly identify sensitive data and PII on shared drives (e.g., scanned documents, social security numbers, and tax returns) that could be used for extortion or social engineering of the organization or individuals.</p>
<h4><em><strong>9. Poor Credential Hygiene</strong></em></h4>
<p>Poor credential hygiene facilitates threat actors in obtaining credentials for initial access, persistence, lateral movement, and other follow-on activity, especially if phishing-resistant MFA is not enabled. Poor credential hygiene includes:</p>
<ul><li>Easily crackable passwords</li>
<li>Cleartext password disclosure</li>
</ul><h5><strong>Easily Crackable Passwords</strong></h5>
<p>Easily crackable passwords are passwords that a malicious actor can guess within a short time using relatively inexpensive computing resources. The presence of easily crackable passwords on a network generally stems from a lack of password length (i.e., shorter than 15 characters) and randomness (i.e., is not unique or can be guessed). This is often due to lax requirements for passwords in organizational policies and user training. A policy that only requires short and simple passwords leaves user passwords susceptible to password cracking. Organizations should provide or allow employee use of password managers to enable the generation and easy use of secure, random passwords for each account.</p>
<p>Often, when a credential is obtained, it is a hash (one-way encryption) of the password and not the password itself. Although some hashes can be used directly with PtH techniques, many hashes need to be cracked to obtain usable credentials. The cracking process takes the captured hash of the user’s plaintext password and leverages dictionary wordlists and rulesets, often using a database of billions of previously compromised passwords, in an attempt to find the matching plaintext password [<a href="https://attack.mitre.org/versions/v13/techniques/T1110/002/" title="Brute Force: Password Cracking">T1110.002</a>].</p>
<p>One of the primary ways to crack passwords is with the open source tool, Hashcat, combined with password lists obtained from publicly released password breaches. Once a malicious actor has access to a plaintext password, they are usually limited only by the account’s permissions. In some cases, the actor may be restricted or detected by advanced defense-in-depth and zero trust implementations as well, but this has been a rare finding in assessments thus far.</p>
<p>Assessment teams have cracked password hashes for NTLM users, Kerberos service account tickets, NetNTLMv2, and PFX stores [<a href="https://attack.mitre.org/versions/v13/techniques/T1555/" title="Credentials from Password Stores">T1555</a>], enabling the team to elevate privileges and move laterally within networks. In 12 hours, one team cracked over 80% of all users&#39; passwords in an Active Directory, resulting in hundreds of valid credentials.</p>
<h5><strong>Cleartext Password Disclosure</strong></h5>
<p>Storing passwords in cleartext is a serious security risk. A malicious actor with access to files containing cleartext passwords [<a href="https://attack.mitre.org/versions/v13/techniques/T1552/001/" title="Unsecured Credentials: Credentials In Files">T1552.001</a>] could use these credentials to log into the affected applications or systems under the guise of a legitimate user. Accountability is lost in this situation as any system logs would record valid user accounts accessing applications or systems.</p>
<p>Malicious actors search for text files, spreadsheets, documents, and configuration files in hopes of obtaining cleartext passwords. Assessment teams frequently discover cleartext passwords, allowing them to quickly escalate the emulated intrusion from the compromise of a regular domain user account to that of a privileged account, such as a Domain or Enterprise Administrator. A common tool used for locating cleartext passwords is the open source tool, <a href="https://github.com/SnaffCon/Snaffler" title="SnaffCon / Snaffler">Snaffler</a>.[23]</p>
<h4><em><strong>10. Unrestricted Code Execution</strong></em></h4>
<p>If unverified programs are allowed to execute on hosts, a threat actor can run arbitrary, malicious payloads within a network.</p>
<p>Malicious actors often execute code after gaining initial access to a system. For example, after a user falls for a phishing scam, the actor usually convinces the victim to run code on their workstation to gain remote access to the internal network. This code is usually an unverified program that has no legitimate purpose or business reason for running on the network.</p>
<p>Assessment teams and malicious actors frequently leverage unrestricted code execution in the form of executables, dynamic link libraries (DLLs), HTML applications, and macros (scripts used in office automation documents) [<a href="https://attack.mitre.org/versions/v13/techniques/T1059/005/" title="Command and Scripting Interpreter: Visual Basic">T1059.005</a>] to establish initial access, persistence, and lateral movement. In addition, actors often use scripting languages [<a href="https://attack.mitre.org/versions/v13/techniques/T1059/" title="Command and Scripting Interpreter">T1059</a>] to obscure their actions [<a href="https://attack.mitre.org/versions/v13/techniques/T1027/010/" title="Obfuscated Files or Information: Command Obfuscation">T1027.010</a>] and bypass allowlisting—where organizations restrict applications and other forms of code by default and only allow those that are known and trusted. Further, actors may load vulnerable drivers and then exploit the drivers’ known vulnerabilities to execute code in the kernel with the highest level of system privileges to completely compromise the device [<a href="https://attack.mitre.org/versions/v13/techniques/T1068/" title="Exploitation for Privilege Escalation">T1068</a>].</p>
<h3><strong>MITIGATIONS</strong></h3>
<h4><em><strong>Network Defenders</strong></em></h4>
<p>NSA and CISA recommend network defenders implement the recommendations that follow to mitigate the issues identified in this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST) as well as with the <a href="https://attack.mitre.org/versions/v13/mitigations/enterprise/" title="Enterprise Mitigations">MITRE ATT&amp;CK Enterprise Mitigations</a> and <a href="https://d3fend.mitre.org/" title="A knowledge graph of cybersecurity countermeasures">MITRE D3FEND</a> frameworks.</p>
<p>The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s <a href="https://www.cisa.gov/cpg" title="Cross-Sector Cybersecurity Performance Goals">Cross-Sector Cybersecurity Performance Goals</a> for more information on the CPGs, including additional recommended baseline protections.[24]</p>
<h5><strong>Mitigate Default Configurations of Software and Applications</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 1: Recommendations for Network Defenders to Mitigate Default Configurations of Software and Applications</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Default configurations of software and applications</p>
</td>
<td>
<ul><li><strong>Modify the default configuration of applications and appliances before deployment</strong> in a production environment [<a href="https://attack.mitre.org/versions/v13/mitigations/M1013/" title="Application Developer Guidance">M1013</a>],[<a href="https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening/" title="Application Configuration Hardening">D3-ACH</a>]. Refer to hardening guidelines provided by the vendor and related cybersecurity guidance (e.g., <a href="https://public.cyber.mil/stigs/" title="Security Technical Implementation Guides (STIGs)">DISA&#39;s Security Technical Implementation Guides</a> (STIGs) and configuration guides).[25],[26],[27]</li>
</ul></td>
</tr><tr><td>
<p>Default configurations of software and applications: Default Credentials</p>
</td>
<td>
<ul><li><strong>Change or disable vendor-supplied default usernames and passwords of services, software, and equipment</strong> when installing or commissioning [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.A</a>]. When resetting passwords, enforce the use of “strong” passwords (i.e., passwords that are more than 15 characters and random [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.B</a>]) and follow hardening guidelines provided by the vendor, <a href="https://public.cyber.mil/stigs/" title="Security Technical Implementation Guides (STIGs)">STIGs</a>, <a href="https://www.nsa.gov/cybersecurity-guidance" title="CYBERSECURITY ADVISORIES &amp; GUIDANCE">NSA</a>, and/or <a href="https://csrc.nist.gov/publications/detail/sp/800-63b/final" title="Digital Identity Guidelines: Authentication and Lifecycle Management">NIST</a> [<a href="https://attack.mitre.org/versions/v13/mitigations/M1027/" title="Password Policies">M1027</a>],[<a href="https://d3fend.mitre.org/technique/d3f:StrongPasswordPolicy/" title="Strong Password Policy">D3-SPP</a>].[25],[26],[28],[29]</li>
</ul></td>
</tr><tr><td>
<p>Default service permissions and configuration settings: Insecure Active Directory Certificate Services</p>
</td>
<td>
<ul><li><strong>Ensure the secure configuration of ADCS implementations</strong>. Regularly update and patch the controlling infrastructure (e.g., for CVE-2021-36942), employ monitoring and auditing mechanisms, and implement strong access controls to protect the infrastructure.
<ul><li><strong>If not needed, disable web-enrollment in ADCS servers</strong>. See Microsoft: <a href="https://learn.microsoft.com/en-us/powershell/module/adcsdeployment/uninstall-adcswebenrollment?view=windowsserver2022-ps" title="Uninstall-AdcsWebEnrollment">Uninstall-AdcsWebEnrollment (ADCSDeployment)</a> for guidance.[30]</li>
<li>If web enrollment is needed on ADCS servers:
<ul><li><strong>Enable Extended Protection for Authentication (EPA) for Client Authority Web Enrollment</strong>. This is done by choosing the “Required” option. For guidance, see Microsoft: <a href="https://support.microsoft.com/en-au/topic/kb5021989-extended-protection-for-authentication-1b6ea84d-377b-4677-a0b8-af74efbb243f" title="KB5021989: Extended Protection for Authentication">KB5021989: Extended Protection for Authentication</a>.[31]</li>
<li><strong>Enable “Require SSL”</strong> on the ADCS server.</li>
</ul></li>
<li><strong>Disable NTLM</strong> on all ADCS servers. For guidance, see Microsoft: <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-ntlm-authentication-in-this-domain" title="Network security: Restrict NTLM: NTLM authentication in this domain">Network security Restrict NTLM in this domain - Windows Security | Microsoft Learn</a> and <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-incoming-ntlm-traffic" title="Network security: Restrict NTLM: Incoming NTLM traffic">Network security Restrict NTLM Incoming NTLM traffic - Windows Security</a>.[32],[33]</li>
<li><strong>Disable SAN for UPN Mapping</strong>. For guidance see, Microsoft: <a href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/disable-subject-alternative-name-upn-mapping" title="How to disable the Subject Alternative Name for UPN mapping">How to disable the SAN for UPN mapping - Windows Server</a>. Instead, smart card authentication can use the <code>altSecurityIdentities</code> attribute for explicit mapping of certificates to accounts more securely.[34]</li>
</ul></li>
<li><strong>Review all permissions on the ADCS templates on applicable servers</strong>. Restrict enrollment rights to only those users or groups that require it. Disable the <code>CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT</code> flag from templates to prevent users from supplying and editing sensitive security settings within these templates. Enforce manager approval for requested certificates. Remove <code>FullControl</code>, <code>WriteDacl</code>, and <code>Write</code> property permissions from low-privileged groups, such as domain users, to certificate template objects.</li>
</ul></td>
</tr><tr><td>
<p>Default service permissions and configuration settings: Insecure legacy protocols/services</p>
</td>
<td>
<ul><li><strong>Determine if LLMNR and NetBIOS are required for essential business operations</strong>.
<ul><li>If not required, <strong>disable LLMNR and NetBIOS </strong>in local computer security settings or by group policy.</li>
</ul></li>
</ul></td>
</tr><tr><td>
<p>Default service permissions and configuration settings: Insecure SMB service</p>
</td>
<td>
<ul><li><strong>Require SMB signing</strong> for both SMB client and server on all systems.[25] This should prevent certain adversary-in-the-middle and pass-the-hash techniques. For more information on SMB signing, see Microsoft: <a href="https://learn.microsoft.com/troubleshoot/windows-server/networking/overview-server-message-block-signing" title="Overview of Server Message Block signing">Overview of Server Message Block Signing</a>. [35] <strong>Note</strong>: Beginning in <a href="https://aka.ms/SmbSigningRequired" title="SMB signing required by default in Windows">Microsoft Windows 11 Insider Preview Build 25381</a>, Windows requires SMB signing for all communications.[36]</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Improper Separation of User/Administrator Privilege</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 2: Recommendations for Network Defenders to Mitigate Improper Separation of User/Administrator Privilege</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Improper separation of user/administrator privilege:</p>
<ul><li>Excessive account privileges,</li>
<li>Elevated service account permissions, and</li>
<li>Non-essential use of elevated accounts</li>
</ul></td>
<td>
<ul><li><strong>Implement authentication, authorization, and accounting (AAA) systems</strong> [<a href="https://attack.mitre.org/versions/v13/mitigations/M1018/" title="User Account Management">M1018</a>] to limit actions users can perform, and review logs of user actions to detect unauthorized use and abuse. Apply least privilege principles to user accounts and groups allowing only the performance of authorized actions.</li>
<li><strong>Audit user accounts </strong>and remove those that are inactive or unnecessary on a routine basis [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.D</a>]. Limit the ability for user accounts to create additional accounts.</li>
<li><strong>Restrict use of privileged accounts to perform general tasks</strong>, such as accessing emails and browsing the Internet [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.E</a>],[<a href="https://d3fend.mitre.org/technique/d3f:UserAccountPermissions/" title="User Account Permissions">D3-UAP</a>]. See NSA Cybersecurity Information Sheet (CSI) <a href="https://media.defense.gov/2019/Sep/09/2002180330/-1/-1/0/Defend%20Privileges%20and%20Accounts%20-%20Copy.pdf" title="DEFEND PRIVILEGES AND ACCOUNTS">Defend Privileges and Accounts</a> for more information.[37]</li>
<li><strong>Limit the number of users within the organization with an identity and access management (IAM) role</strong> that has administrator privileges. Strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles, and policies.</li>
<li><strong>Implement time-based access for privileged accounts</strong>. For example, the just-in-time access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model) by setting network-wide policy to automatically disable admin accounts at the Active Directory level. As needed, individual users can submit requests through an automated process that enables access to a system for a set timeframe. In cloud environments, just-in-time elevation is also appropriate and may be implemented using per-session federated claims or privileged access management tools.</li>
<li><strong>Restrict domain users from being in the local administrator group</strong> on multiple systems.</li>
<li><strong>Run daemonized applications (services) with non-administrator accounts</strong> when possible.</li>
<li><strong>Only configure service accounts with the permissions necessary for the services they control to operate</strong>.</li>
<li><strong>Disable unused services and implement ACLs</strong> to protect services.</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Insufficient Internal Network Monitoring</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 3: Recommendations for Network Defenders to Mitigate Insufficient Internal Network Monitoring</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Insufficient internal network monitoring</p>
</td>
<td>
<ul><li><strong>Establish a baseline of applications and services</strong>, and routinely audit their access and use, especially for administrative activity [<a href="https://d3fend.mitre.org/technique/d3f:AdministrativeNetworkActivityAnalysis/" title="Administrative Network Activity Analysis">D3-ANAA</a>]. For instance, administrators should routinely audit the access lists and permissions for of all web applications and services [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.O</a>],[<a href="https://attack.mitre.org/versions/v13/mitigations/M1047" title="Audit">M1047</a>]. Look for suspicious accounts, investigate them, and remove accounts and credentials, as appropriate, such as accounts of former staff.[39]</li>
<li><strong>Establish a baseline that represents an organization’s normal traffic activity</strong>, network performance, host application activity, and user behavior; investigate any deviations from that baseline [<a href="https://d3fend.mitre.org/technique/d3f:NetworkTrafficCommunityDeviation/" title="Network Traffic Community Deviation">D3-NTCD</a>],[<a href="https://d3fend.mitre.org/technique/d3f:Client-serverPayloadProfiling/" title="Client-server Payload Profiling">D3-CSPP</a>],[<a href="https://d3fend.mitre.org/technique/d3f:UserBehaviorAnalysis" title="User Behavior Analysis">D3-UBA</a><u>].</u><u>[</u><u>40</u><u>]</u></li>
<li><strong>Use auditing tools capable of detecting privilege and service abuse opportunities </strong>on systems within an enterprise and correct them [<a href="https://attack.mitre.org/versions/v13/mitigations/M1047" title="Audit">M1047</a>].</li>
<li><strong>Implement a security information and event management (SIEM) system</strong> to provide log aggregation, correlation, querying, visualization, and alerting from network endpoints, logging systems, endpoint and detection response (EDR) systems and intrusion detection systems (IDS) [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.T</a>],[<a href="https://d3fend.mitre.org/technique/d3f:NetworkTrafficAnalysis" title="Network Traffic Analysis">D3-NTA</a>].</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Lack of Network Segmentation</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 4: Recommendations for Network Defenders to Mitigate Lack of Network Segmentation</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Lack of network segmentation</p>
</td>
<td>
<ul><li><strong>Implement next-generation firewalls</strong> to perform deep packet filtering, stateful inspection, and application-level packet inspection [<a href="https://d3fend.mitre.org/technique/d3f:NetworkTrafficFiltering/">D3-NTF</a>]. Deny or drop improperly formatted traffic that is incongruent with application-specific traffic permitted on the network. This practice limits an actor’s ability to abuse allowed application protocols. The practice of allowlisting network applications does not rely on generic ports as filtering criteria, enhancing filtering fidelity. For more information on application-aware defenses, see NSA CSI <a href="https://media.defense.gov/2019/Sep/09/2002180325/-1/-1/0/Segment%20Networks%20and%20Deploy%20Application%20Aware%20Defenses%20-%20Copy.pdf" title="SEGMENT NETWORKS AND DEPLOY APPLICATION-AWARE DEFENSES">Segment Networks and Deploy Application-Aware Defenses</a>.[41]</li>
<li><strong>Engineer network segments to isolate critical systems, functions, and resources</strong> [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.F</a>],[<a href="https://d3fend.mitre.org/technique/d3f:NetworkIsolation/" title="Network Isolation">D3-NI</a>]. Establish physical and logical segmentation controls, such as virtual local area network (VLAN) configurations and properly configured access control lists (ACLs) on infrastructure devices [<a href="https://attack.mitre.org/versions/v13/mitigations/M1030/" title="Network Segmentation">M1030</a>]. These devices should be baselined and audited to prevent access to potentially sensitive systems and information. Leverage properly configured Demilitarized Zones (DMZs) to reduce service exposure to the Internet.[42],[43],[44]</li>
<li><strong>Implement separate Virtual Private Cloud (VPC) instances</strong> to isolate essential cloud systems. Where possible, implement Virtual Machines (VM) and Network Function Virtualization (NFV) to enable micro-segmentation of networks in virtualized environments and cloud data centers. Employ secure VM firewall configurations in tandem with macro segmentation.</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Poor Patch Management</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 5: Recommendations for Network Defenders to Mitigate Poor Patch Management</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Poor patch management: Lack of regular patching</p>
</td>
<td>
<ul><li><strong>Ensure organizations implement and maintain an efficient patch management process</strong> that enforces the use of up-to-date, stable versions of OSs, browsers, and software [<a href="https://attack.mitre.org/versions/v13/mitigations/M1051" title="Update Software">M1051</a>],[<a href="https://d3fend.mitre.org/technique/d3f:SoftwareUpdate/" title="Software Update">D3-SU</a>].[45]</li>
<li><strong>Update software regularly by employing patch management</strong> for externally exposed applications, internal enterprise endpoints, and servers. Prioritize patching <a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" title="Known Exploited Vulnerabilities Catalog">known exploited vulnerabilities</a>.[2]</li>
<li><strong>Automate the update process as much as possible</strong> and use vendor-provided updates. Consider using automated patch management tools and software update tools.</li>
<li>Where patching is not possible due to limitations, <strong>segment networks </strong>to limit exposure of the vulnerable system or host.</li>
</ul></td>
</tr><tr><td>
<p>Poor patch management: Use of unsupported OSs and outdated firmware</p>
</td>
<td>
<ul><li><strong>Evaluate the use of unsupported hardware and software and discontinue use</strong> as soon as possible. If discontinuing is not possible, implement additional network protections to mitigate the risk.[45]</li>
<li><strong>Patch the Basic Input/Output System (BIOS)</strong> and other firmware to prevent exploitation of known vulnerabilities.</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Bypass of System Access Controls</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 6: Recommendations for Network Defenders to Mitigate Bypass of System Access Controls</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Bypass of system access controls</p>
</td>
<td>
<ul><li><strong>Limit credential overlap across systems</strong> to prevent credential compromise and reduce a malicious actor&#39;s ability to move laterally between systems [<a href="https://attack.mitre.org/versions/v13/mitigations/M1026" title="Privileged Account Management">M1026</a>],[<a href="https://d3fend.mitre.org/technique/d3f:CredentialHardening/" title="Credential Hardening">D3-CH</a>]. Implement a method for monitoring non-standard logon events through host log monitoring [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.G</a>].</li>
<li><strong>Implement an effective and routine patch management process</strong>. Mitigate PtH techniques by applying patch <a href="https://learn.microsoft.com/en-us/security-updates/SecurityAdvisories/2016/2871997" title="Microsoft Security Advisory 2871997">KB2871997</a> to Windows 7 and newer versions to limit default access of accounts in the local administrator group [<a href="https://attack.mitre.org/versions/v13/mitigations/M1051" title="Update Software">M1051</a>],[<a href="https://d3fend.mitre.org/technique/d3f:SoftwareUpdate/" title="Software Update">D3-SU</a>].[46]</li>
<li><strong>Enable the PtH mitigations to apply User Account Control (UAC) restrictions</strong> to local accounts upon network logon [<a href="https://attack.mitre.org/versions/v13/mitigations/M1052" title="User Account Control">M1052</a>],[<a href="https://d3fend.mitre.org/technique/d3f:UserAccountPermissions/" title="User Account Permissions">D3-UAP</a>].</li>
<li><strong>Deny domain users the ability to be in the local administrator group </strong>on multiple systems [<a href="https://attack.mitre.org/versions/v13/mitigations/M1018" title="User Account Management">M1018</a>],[<a href="https://d3fend.mitre.org/technique/d3f:UserAccountPermissions/" title="User Account Permissions">D3-UAP</a>].</li>
<li><strong>Limit workstation-to-workstation communications</strong>. All workstation communications should occur through a server to prevent lateral movement [<a href="https://attack.mitre.org/versions/v13/mitigations/M1018" title="User Account Management">M1018</a>],[<a href="https://d3fend.mitre.org/technique/d3f:UserAccountPermissions/" title="User Account Permissions">D3-UAP</a>].</li>
<li><strong>Use privileged accounts only on systems requiring those privileges</strong> [<a href="https://attack.mitre.org/versions/v13/mitigations/M1018" title="User Account Management">M1018</a>],[<a href="https://d3fend.mitre.org/technique/d3f:UserAccountPermissions/" title="User Account Permissions">D3-UAP</a>]. Consider using dedicated Privileged Access Workstations for privileged accounts to better isolate and protect them.[37]</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Weak or Misconfigured MFA Methods</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 7: Recommendations for Network Defenders to Mitigate Weak or Misconfigured MFA Methods</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Weak or misconfigured MFA methods: Misconfigured smart cards or tokens</p>

</td>
<td>
<ul><li>In Windows environments:
<ul><li><strong>Disable the use of New Technology LAN Manager (NTLM) and other legacy authentication protocols</strong> that are susceptible to PtH due to their use of password hashes [<a href="https://attack.mitre.org/versions/v13/mitigations/M1032">M1032</a>],[<a href="https://d3fend.mitre.org/technique/d3f:Multi-factorAuthentication">D3-MFA</a><u>]. </u>For guidance, see Microsoft: <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-ntlm-authentication-in-this-domain">Network security Restrict NTLM in this domain - Windows Security | Microsoft Learn</a> and <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-incoming-ntlm-traffic">Network security Restrict NTLM Incoming NTLM traffic - Windows Security</a>.[32],[33]</li>
<li><strong>Use</strong><strong> built-in functionality via Windows Hello for Business or Group Policy Objects (GPOs) to regularly re-randomize password hashes</strong> associated with smartcard-required accounts. Ensure that the hashes are changed at least as often as organizational policy requires passwords to be changed [<a href="https://attack.mitre.org/versions/v13/mitigations/M1027">M1027</a>],[<a href="https://d3fend.mitre.org/technique/d3f:CredentialRotation">D3-CRO</a>]. Prioritize upgrading any environments that cannot utilize this built-in functionality.</li>
</ul></li>
<li>As a longer-term effort, <strong>implement cloud-primary authentication solution using modern open standards</strong>. See CISA’s <a href="https://www.cisa.gov/sites/default/files/2023-03/csso-scuba-guidance_document-hybrid_identity_solutions_architecture-2023.03.22-final.pdf">Secure Cloud Business Applications (SCuBA) Hybrid Identity Solutions Architecture</a> for more information.[47] <strong>Note:</strong> this document is part of CISA’s <a href="https://www.cisa.gov/resources-tools/services/secure-cloud-business-applications-scuba-project">Secure Cloud Business Applications (SCuBA) project</a>, which provides guidance for FCEB agencies to secure their cloud business application environments and to protect federal information that is created, accessed, shared, and stored in those environments. Although tailored to FCEB agencies, the project’s guidance is applicable to all organizations.[48]</li>
</ul></td>
</tr><tr><td>
<p>Weak or misconfigured MFA methods: Lack of phishing-resistant MFA</p>
</td>
<td>
<ul><li><strong>Enforce </strong><a href="https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf"><strong>phishing-resistant MFA</strong></a><strong> universally</strong> for access to sensitive data and on as many other resources and services as possible [<a href="https://www.cisa.gov/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf">CPG 2.H</a>].[3],[49]</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Insufficient ACLs on Network Shares and Services</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 8: Recommendations for Network Defenders to Mitigate Insufficient ACLs on Network Shares and Services</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Insufficient ACLs on network shares and services</p>
</td>
<td>
<ul><li><strong>Implement secure configurations for all storage devices</strong> and network shares that grant access to authorized users only.</li>
<li><strong>Apply the principal of least privilege</strong> to important information resources to reduce risk of unauthorized data access and manipulation.</li>
<li><strong>Apply restrictive permissions to files and directories</strong>, and prevent adversaries from modifying ACLs [<a href="https://attack.mitre.org/versions/v13/mitigations/M1022" title="Restrict File and Directory Permissions">M1022</a>],[<a href="https://d3fend.mitre.org/technique/d3f:LocalFilePermissions" title="Local File Permissions">D3-LFP</a><u>]</u>.</li>
<li><strong>Set restrictive permissions on files and folders containing sensitive private keys</strong> to prevent unintended access [<a href="https://attack.mitre.org/versions/v13/mitigations/M1022" title="Restrict File and Directory Permissions">M1022</a>],[<a href="https://d3fend.mitre.org/technique/d3f:LocalFilePermissions" title="Local File Permissions">D3-LFP</a><u>]</u>.</li>
<li><strong>Enable the Windows Group Policy security setting, &#34;Do Not Allow Anonymous Enumeration of Security Account Manager (SAM) Accounts and Shares,&#34;</strong> to limit users who can enumerate network shares.</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Poor Credential Hygiene</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 9: Recommendations for Network Defenders to Mitigate Poor Credential Hygiene</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Poor credential hygiene: easily crackable passwords</p>

</td>
<td>
<ul><li><strong>Follow National Institute of Standards and Technologies (NIST) </strong><a href="https://csrc.nist.gov/publications/detail/sp/800-63b/final" title="Digital Identity Guidelines: Authentication and Lifecycle Management"><strong>guidelines</strong></a><strong> when creating password policies</strong> to enforce use of “strong” passwords that cannot be cracked [<a href="https://attack.mitre.org/versions/v13/mitigations/M1027" title="Digital Identity Guidelines: Authentication and Lifecycle Management">M1027</a>],[<a href="https://d3fend.mitre.org/technique/d3f:StrongPasswordPolicy/" title="Strong Password Policy">D3-SPP</a>].[29] Consider using password managers to generate and store passwords.</li>
<li><strong>Do not reuse local administrator account passwords across systems</strong>. Ensure that passwords are “strong” and unique [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.B</a>],[<a href="https://attack.mitre.org/versions/v13/mitigations/M1027" title="Password Policies">M1027</a>],[<a href="https://d3fend.mitre.org/technique/d3f:StrongPasswordPolicy/" title="Strong Password Policy">D3-SPP</a>].</li>
<li><strong>Use “strong” passphrases for private keys</strong> to make cracking resource intensive. Do not store credentials within the registry in Windows systems. Establish an organizational policy that prohibits password storage in files.</li>
<li><strong>Ensure adequate password length (ideally 25+ characters) and complexity requirements for Windows service accounts</strong> and implement passwords with periodic expiration on these accounts [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.B</a>],[<a href="https://attack.mitre.org/versions/v13/mitigations/M1027" title="Password Policies">M1027</a>],[<a href="https://d3fend.mitre.org/technique/d3f:StrongPasswordPolicy/" title="Strong Password Policy">D3-SPP</a>]. Use Managed Service Accounts, when possible, to manage service account passwords automatically.</li>
</ul></td>
</tr><tr><td>
<p>Poor credential hygiene: cleartext password disclosure</p>

</td>
<td>
<ul><li><strong>Implement a review process for files and systems to look for cleartext account credentials</strong>. When credentials are found, remove, change, or encrypt them [<a href="https://d3fend.mitre.org/technique/d3f:FileEncryption/" title="File Encryption">D3-FE</a>]. Conduct periodic scans of server machines using automated tools to determine whether sensitive data (e.g., personally identifiable information, protected health information) or credentials are stored. Weigh the risk of storing credentials in password stores and web browsers. If system, software, or web browser credential disclosure is of significant concern, technical controls, policy, and user training may prevent storage of credentials in improper locations.</li>
<li><strong>Store hashed passwords using </strong><a href="https://www.cnss.gov/CNSS/issuances/Policies.cfm" title="POLICIES"><strong>Committee on National Security Systems Policy (CNSSP)-15</strong></a><strong> and </strong><a href="https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/3148990/nsa-releases-future-quantum-resistant-qr-algorithm-requirements-for-national-se/" title="NSA Releases Future Quantum-Resistant (QR) Algorithm Requirements for National Security Systems"><strong>Commercial National Security Algorithm Suite</strong></a><strong> (CNSA) approved algorithms</strong>.[50],[51]</li>
<li><strong>Consider using group Managed Service Accounts (gMSAs) or third-party software</strong> to implement secure password-storage applications.</li>
</ul></td>
</tr></tbody></table><h5><strong>Mitigate Unrestricted Code Execution</strong></h5>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 10: Recommendations for Network Defenders to Mitigate Unrestricted Code Execution</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Network Defenders</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Unrestricted code execution</p>
</td>
<td>
<ul><li><strong>Enable system settings that prevent the ability to run applications downloaded from untrusted sources</strong>.[52]</li>
<li><strong>Use application control tools that restrict program execution by default, also known as allowlisting</strong> [<a href="https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting/" title="Executable Allowlisting">D3-EAL</a>]. Ensure that the tools examine digital signatures and other key attributes, rather than just relying on filenames, especially since malware often attempts to masquerade as common Operating System (OS) utilities [<a href="https://attack.mitre.org/versions/v13/mitigations/M1038" title="Execution Prevention">M1038</a>]. Explicitly allow certain .exe files to run, while blocking all others by default.</li>
<li><strong>Block or prevent the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode</strong>. Validate driver block rules in audit mode to ensure stability prior to production deployment [<a href="https://d3fend.mitre.org/technique/d3f:OperatingSystemMonitoring/" title="Operating System Monitoring">D3-OSM</a>].</li>
<li><strong>Constrain scripting languages to prevent malicious activities, audit script logs, and restrict scripting languages</strong> that are not used in the environment [<a href="https://d3fend.mitre.org/technique/d3f:ScriptExecutionAnalysis/" title="Script Execution Analysis">D3-SEA</a>]. See joint Cybersecurity Information Sheet: <a href="https://media.defense.gov/2022/Jun/22/2003021689/-1/-1/1/CSI_KEEPING_POWERSHELL_SECURITY_MEASURES_TO_USE_AND_EMBRACE_20220622.PDF" title="Keeping PowerShell: Security Measures to Use and Embrace">Keeping PowerShell: Security Measures to Use and Embrace</a>.[53]</li>
<li><strong>Use read-only containers and minimal images</strong>, when possible, to prevent the running of commands.</li>
<li><strong>Regularly analyze border and host-level protections, including spam-filtering capabilities</strong>, to ensure their continued effectiveness in blocking the delivery and execution of malware [<a href="https://d3fend.mitre.org/technique/d3f:MessageAnalysis/" title="Message Analysis">D3-MA</a>]. Assess whether HTML Application (HTA) files are used for business purposes in your environment; if HTAs are not used, remap the default program for opening them from mshta.exe to notepad.exe.</li>
</ul></td>
</tr></tbody></table><h4><em><strong>Software Manufacturers</strong></em></h4>
<p>NSA and CISA recommend software manufacturers implement the recommendations in Table 11 to reduce the prevalence of misconfigurations identified in this advisory. These mitigations align with tactics provided in joint guide <a href="https://www.cisa.gov/resources-tools/resources/secure-by-design-and-default" title="Security-by-Design and -Default">Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Security-by-Design and -Default</a>. NSA and CISA strongly encourage software manufacturers apply these recommendations to ensure their products are secure “out of the box” and do not require customers to spend additional resources making configuration changes, performing monitoring, and conducting routine updates to keep their systems secure.[1]</p>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 11: Recommendations for Software Manufacturers to Mitigate Identified Misconfigurations</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Misconfiguration</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Recommendations for Software Manufacturers</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Default configurations of software and applications</p>
</td>
<td>
<ul><li><strong>Embed security controls into product architecture from the start of development and throughout the entire SDLC </strong>by following best practices in NIST’s Secure Software Development Framework (SSDF), <a href="https://csrc.nist.gov/publications/detail/sp/800-218/final" title="Secure Software Development Framework (SSDF) Version 1.1: Recommendations for Mitigating the Risk of Software Vulnerabilities">SP 800-218</a>.[54]</li>
<li><strong>Provide software with security features enabled “out of the box” and accompanied with “loosening” guides</strong> instead of hardening guides. “Loosening” guides should explain the business risk of decisions in plain, understandable language.</li>
</ul></td>
</tr><tr><td>
<p>Default configurations of software and applications: Default credentials</p>
</td>
<td>
<ul><li><strong>Eliminate default passwords</strong>: Do not provide software with default passwords that are universally shared. To eliminate default passwords, require administrators to set a “strong” password [<a href="https://conversationswith.rocks/sites/default/files/2023-03/CISA_CPG_REPORT_v1.0.1_FINAL.pdf" title="Cross-Sector Cybersecurity Performance Goals March 2023 Update">CPG 2.B</a>] during installation and configuration.</li>
</ul></td>
</tr><tr><td>
<p>Default configurations of software and applications: Default service permissions and configuration settings</p>
</td>
<td>
<ul><li><strong>Consider the user experience consequences of security settings</strong>: Each new setting increases the cognitive burden on end users and should be assessed in conjunction with the business benefit it derives. Ideally, a setting should not exist; instead, the most secure setting should be integrated into the product by default. When configuration is necessary, the default option should be broadly secure against common threats.</li>
</ul></td>
</tr><tr><td>
<p>Improper separation of user/administrator privilege:</p>
<ul><li>Excessive account privileges,</li>
<li>Elevated service account permissions, and</li>
<li>Non-essential use of elevated accounts</li>
</ul></td>
<td>
<ul><li><strong>Design products so that the compromise of a single security control does not result in compromise of the entire system</strong>. For example, ensuring that user privileges are narrowly provisioned by default and ACLs are employed can reduce the impact of a compromised account. Also, software sandboxing techniques can quarantine a vulnerability to limit compromise of an entire application.</li>
<li><strong>Automatically generate reports for:</strong>
<ul><li><strong>Administrators of inactive accounts. </strong>Prompt administrators to set a maximum inactive time and automatically suspend accounts that exceed that threshold.</li>
<li><strong>Administrators of accounts with administrator privileges</strong> and suggest ways to reduce privilege sprawl.</li>
</ul></li>
<li><strong>Automatically alert administrators of infrequently used services </strong>and provide recommendations for disabling them or implementing ACLs.</li>
</ul></td>
</tr><tr><td>
<p>Insufficient internal network monitoring</p>

</td>
<td>
<ul><li><strong>Provide high-quality audit logs to customers at no extra charge</strong>. Audit logs are crucial for detecting and escalating potential security incidents. They are also crucial during an investigation of a suspected or confirmed security incident. Consider best practices such as providing easy integration with a security information and event management (SIEM) system with application programming interface (API) access that uses coordinated universal time (UTC), standard time zone formatting, and robust documentation techniques.</li>
</ul></td>
</tr><tr><td>
<p>Lack of network segmentation</p>
</td>
<td>
<ul><li><strong>Ensure products are compatible with and tested in segmented network environments</strong>.</li>
</ul></td>
</tr><tr><td>
<p>Poor patch management: Lack of regular patching</p>
</td>
<td>
<ul><li><strong>Take steps to eliminate entire classes of vulnerabilities by embedding security controls into product architecture from the start of development and throughout the SDLC by following best practices in NIST’s SSDF</strong>, <a href="https://csrc.nist.gov/publications/detail/sp/800-218/final" title="Secure Software Development Framework (SSDF) Version 1.1: Recommendations for Mitigating the Risk of Software Vulnerabilities">SP 800-218</a>.[54] Pay special attention to:
<ul><li><strong>Following secure coding practices</strong> [<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-218.pdf" title="Secure Software Development Framework (SSDF) Version 1.1: Recommendations for Mitigating the Risk of Software Vulnerabilities">SSDF PW 5.1</a>]. Use memory-safe programming languages where possible, parametrized queries, and web template languages.</li>
<li><strong>Conducting code reviews</strong> [<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-218.pdf" title="Secure Software Development Framework (SSDF) Version 1.1: Recommendations for Mitigating the Risk of Software Vulnerabilities">SSDF PW 7.2, RV 1.2</a>] against peer coding standards, checking for backdoors, malicious content, and logic flaws.</li>
<li><strong>Testing code to identify vulnerabilities</strong> and verify compliance with security requirements [<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-218.pdf" title="Secure Software Development Framework (SSDF) Version 1.1: Recommendations for Mitigating the Risk of Software Vulnerabilities">SSDF PW 8.2</a>].</li>
</ul></li>
<li><strong>Ensure that published CVEs include root cause or common weakness enumeration (CWE)</strong> to enable industry-wide analysis of software security design flaws.</li>
</ul></td>
</tr><tr><td>
<p>Poor patch management: Use of unsupported operating OSs and outdated firmware</p>
</td>
<td>
<ul><li><strong>Communicate the business risk of using unsupported OSs and firmware </strong>in plain, understandable language.</li>
</ul></td>
</tr><tr><td>
<p>Bypass of system access controls</p>
</td>
<td>
<ul><li><strong>Provide sufficient detail in audit records to detect bypass of system controls</strong> and queries to monitor audit logs for traces of such suspicious activity (e.g., for when an essential step of an authentication or authorization flow is missing).</li>
</ul></td>
</tr><tr><td>
<p>Weak or Misconfigured MFA Methods: Misconfigured Smart Cards or Tokens</p>

</td>
<td>
<ul><li><strong>Fully support MFA for all users</strong>, making MFA the default rather than an opt-in feature. Utilize threat modeling for authentication assertions and alternate credentials to examine how they could be abused to bypass MFA requirements.</li>
</ul></td>
</tr><tr><td>
<p>Weak or Misconfigured MFA Methods: Lack of phishing-resistant MFA</p>
</td>
<td>
<ul><li><strong>Mandate MFA, ideally </strong><a href="https://www.cisa.gov/sites/default/files/publications/fact-sheet-implementing-phishing-resistant-mfa-508c.pdf" title="Implementing Phishing-Resistant MFA"><strong>phishing-resistant</strong></a><strong>, for privileged users</strong> and make MFA a default rather than an opt-in feature.[3]</li>
</ul></td>
</tr><tr><td>
<p>Insufficient ACL on network shares and services</p>
</td>
<td>
<ul><li><strong>Enforce use of ACLs</strong> with default ACLs only allowing the minimum access needed, along with easy-to-use tools to regularly audit and adjust ACLs to the minimum access needed.</li>
</ul></td>
</tr><tr><td>
<p>Poor credential hygiene: easily crackable passwords</p>

</td>
<td>
<ul><li><strong>Allow administrators to configure a password policy consistent with NIST’s </strong><a href="https://csrc.nist.gov/publications/detail/sp/800-63b/final" title="Digital Identity Guidelines: Authentication and Lifecycle Management"><strong>guidelines</strong></a>—do not require counterproductive restrictions such as enforcing character types or the periodic rotation of passwords.[29]</li>
<li><strong>Allow users to use password managers</strong> to effortlessly generate and use secure, random passwords within products.</li>
</ul></td>
</tr><tr><td>
<p>Poor credential hygiene: cleartext password disclosure</p>
</td>
<td>
<ul><li><strong>Salt and hash passwords using a secure hashing algorithm</strong> with high computational cost to make brute force cracking more difficult.</li>
</ul></td>
</tr><tr><td>
<p>Unrestricted code execution</p>
</td>
<td>
<ul><li><strong>Support execution controls</strong> within operating systems and applications “out of the box” by default at no extra charge for all customers, to limit malicious actors’ ability to abuse functionality or launch unusual applications without administrator or informed user approval.</li>
</ul></td>
</tr></tbody></table><h3><strong>VALIDATE SECURITY CONTROLS</strong></h3>
<p>In addition to applying mitigations, NSA and CISA recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. NSA and CISA recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol><li>Select an ATT&amp;CK technique described in this advisory (see Table 12–Table 21).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol><p>CISA and NSA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h3><strong>LEARN FROM HISTORY</strong></h3>
<p>The misconfigurations described above are all too common in assessments and the techniques listed are standard ones leveraged by multiple malicious actors, resulting in numerous real network compromises. Learn from the weaknesses of others and implement the mitigations above properly to protect the network, its sensitive information, and critical missions.</p>
<h3><strong>WORKS CITED</strong></h3>
<p>[1]   Joint Guide: Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Security-by-Design and -Default (2023), <a href="https://www.cisa.gov/sites/default/files/2023-06/principles_approaches_for_security-by-design-default_508c.pdf" title="Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Security-by-Design and -Default">https://www.cisa.gov/sites/default/files/2023-06/principles_approaches_for_security-by-design-default_508c.pdf</a></p>
<h5><strong>Disclaimer of Endorsement</strong></h5>
<p>The information and opinions contained in this document are provided &#34;as is&#34; and without any warranties or guarantees. Reference herein to any specific commercial products, process, or service by trade name, trademark, manufacturer, or otherwise, does not constitute or imply its endorsement, recommendation, or favoring by the United States Government, and this guidance shall not be used for advertising or product endorsement purposes.</p>
<h5><strong>Trademarks</strong></h5>
<p>Active Directory, Microsoft, and Windows are registered trademarks of Microsoft Corporation.</p>
<h5><strong>Purpose</strong></h5>
<p>This document was developed in furtherance of the authoring cybersecurity organizations’ missions, including their responsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and mitigations. This information may be shared broadly to reach all appropriate stakeholders.</p>
<h5><strong>Contact</strong></h5>
<p>Cybersecurity Report Feedback: <a href="mailto:CybersecurityReports@nsa.gov" title="Cybersecurity Report Feedback">CybersecurityReports@nsa.gov</a></p>
<p>To report suspicious activity contact CISA’s 24/7 Operations Center at <a href="mailto:report@cisa.gov" title="Report to CISA">report@cisa.gov</a> or (888) 282-0870. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</p>
<h3><strong>Appendix: MITRE ATT&amp;CK Tactics and Techniques</strong></h3>
<p>See Table 12–Table 21 for all referenced threat actor tactics and techniques in this advisory.</p>
<table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 12: ATT&amp;CK Techniques for Enterprise – Reconnaissance</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Technique Title</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>ID</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Use</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Active Scanning: Vulnerability Scanning</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1595/002/" title="Active Scanning: Vulnerability Scanning">T1595.002</a></p>
</td>
<td>
<p>Malicious actors scan victims for vulnerabilities that be exploited for initial access.</p>
</td>
</tr><tr><td>
<p>Gather Victim Host Information</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1592/" title="Gather Victim Host Information">T1592</a></p>
</td>
<td>
<p>Malicious actors gather information on victim client configurations and/or vulnerabilities through vulnerabilities scans and searching the web.</p>
</td>
</tr><tr><td>
<p>Gather Victim Identity Information: Credentials</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1589/001" title="Gather Victim Identity Information: Credentials">T1589.001</a></p>
</td>
<td>
<p>Malicious actors find default credentials through searching the web.</p>
</td>
</tr><tr><td>
<p>Phishing for Information</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1598/" title="Phishing for Information">T1598</a></p>
</td>
<td>
<p>Malicious actors masquerade as IT staff and convince a target user to provide their MFA code over the phone to gain access to email and other organizational resources.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 13: ATT&amp;CK Techniques for Enterprise – Initial Access</em></caption>
<thead><tr><td>
<p><strong>Technique Title</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Use</strong></p>
</td>
</tr></thead><tbody><tr><td>
<p>External Remote Services</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1133/" title="External Remote Services">T1133</a></p>
</td>
<td>
<p>Malicious actors use default credentials for VPN access to internal networks.</p>
</td>
</tr><tr><td>
<p>Valid Accounts: Default Accounts</p>
</td>
<td>
<p><a href="https://attack.mitre.org/techniques/T1078/001/" title="Valid Accounts: Default Accounts">T1078.001</a></p>
</td>
<td>
<p>Malicious actors gain authenticated access to devices by finding default credentials through searching the web.</p>
<p>Malicious actors use default credentials for VPN access to internal networks, and default administrative credentials to gain access to web applications and databases.</p>
</td>
</tr><tr><td>
<p>Exploit Public-Facing Application</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1190/" title="Exploit Public-Facing Application">T1190</a></p>
</td>
<td>
<p>Malicious actors exploit CVEs in Telerik UI, VM Horizon, Zimbra Collaboration Suite, and other applications for initial access to victim organizations.</p>
</td>
</tr><tr><td>
<p>Phishing</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1566/" title="Phishing">T1566</a></p>
</td>
<td>
<p>Malicious actors gain initial access to systems by phishing to entice end users to download and execute malicious payloads.</p>
</td>
</tr><tr><td>
<p>Trust Relationship</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1199/" title="Trust Relationship">T1199</a></p>
</td>
<td>
<p>Malicious actors gain access to OT networks despite prior assurance that the networks were fully air gapped, with no possible connection to the IT network, by finding special purpose, forgotten, or even accidental network connections.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 14: ATT&amp;CK Techniques for Enterprise – Execution</em></caption>
<thead><tr><td>
<p><strong>Technique Title</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Use</strong></p>
</td>
</tr></thead><tbody><tr><td>
<p>Software Deployment Tools</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1072/" title="Software Deployment Tools">T1072</a></p>
</td>
<td>
<p>Malicious actors use default or captured credentials on software deployment tools to execute code and move laterally.</p>
</td>
</tr><tr><td>
<p>User Execution</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1204/" title="User Execution">T1204</a></p>
</td>
<td>
<p>Malicious actors gain initial access to systems by phishing to entice end users to download and execute malicious payloads or to run code on their workstations.</p>
</td>
</tr><tr><td>
<p>Command and Scripting Interpreter</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1059/" title="Command and Scripting Interpreter">T1059</a></p>
</td>
<td>
<p>Malicious actors use scripting languages to obscure their actions and bypass allowlisting.</p>
</td>
</tr><tr><td>
<p>Command and Scripting Interpreter: Visual Basic</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1059/005/" title="Command and Scripting Interpreter: Visual Basic">T1059.005</a></p>
</td>
<td>
<p>Malicious actors use macros for initial access, persistence, and lateral movement.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 15: ATT&amp;CK Techniques for Enterprise – Persistence</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Technique Title</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>ID</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Use</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Account Manipulation</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1098/" title="Account Manipulation">T1098</a></p>
</td>
<td>
<p>Malicious actors reset built-in administrative accounts via predictable, forgotten password questions.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 16: ATT&amp;CK Techniques for Enterprise – Privilege Escalation</em></caption>
<thead><tr><td>
<p><strong>Technique Title</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Use</strong></p>
</td>
</tr></thead><tbody><tr><td>
<p>Valid Accounts</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1078/" title="Valid Accounts">T1078</a></p>
</td>
<td>
<p>Malicious actors analyze topical and nested Active Directory groups to find privileged accounts to target.</p>
</td>
</tr><tr><td>
<p>Valid Accounts: Domain Accounts</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1078/002/" title="Valid Accounts: Domain Accounts">T1078.002</a></p>
</td>
<td>
<p>Malicious actors obtain loaded domain credentials from printers and scanners and use them to move laterally from the network device.</p>
</td>
</tr><tr><td>
<p>Exploitation for Privilege Escalation</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1068/" title="Exploitation for Privilege Escalation">T1068</a></p>
</td>
<td>
<p>Malicious actors load vulnerable drivers and then exploit their known vulnerabilities to execute code in the kernel with the highest level of system privileges to completely compromise the device.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 17: ATT&amp;CK Techniques for Enterprise – Defense Evasion</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Technique Title</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>ID</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Use</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Obfuscated Files or Information: Command Obfuscation</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1027/010/" title="Obfuscated Files or Information: Command Obfuscation">T1027.010</a></p>
</td>
<td>
<p>Malicious actors often use scripting languages to obscure their actions.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 18: ATT&amp;CK Techniques for Enterprise – Credential Access</em></caption>
<thead><tr><td>
<p><strong>Technique Title</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Use</strong></p>
</td>
</tr></thead><tbody><tr><td>
<p>Adversary-in-the-Middle</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1557/" title="Adversary-in-the-Middle">T1557</a></p>
</td>
<td>
<p>Malicious actors force a device to communicate through actor-controlled systems, so they can collect information or perform additional actions.</p>
</td>
</tr><tr><td>
<p>Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1557/001/" title="Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay">T1557.001</a></p>
</td>
<td>
<p>Malicious actors execute spoofing, poisoning, and relay techniques if Link-Local Multicast Name Resolution (LLMNR), NetBIOS Name Service (NBT-NS), and Server Message Block (SMB) services are enabled in a network.</p>
</td>
</tr><tr><td>
<p>Brute Force: Password Cracking</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1110/002/" title="Brute Force: Password Cracking">T1110.002</a></p>
</td>
<td>
<p>Malicious actors capture user hashes and leverage dictionary wordlists and rulesets to extract cleartext passwords.</p>
</td>
</tr><tr><td>
<p>Credentials from Password Stores</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1555/" title="Credentials from Password Stores">T1555</a></p>
</td>
<td>
<p>Malicious actors gain access to and crack credentials from PFX stores, enabling elevation of privileges and lateral movement within networks.</p>
</td>
</tr><tr><td>
<p>Multi-Factor Authentication Interception</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1111/" title="Multi-Factor Authentication Interception">T1111</a></p>
</td>
<td>
<p>Malicious actors can obtain password hashes for accounts enabled for MFA with smart codes or tokens and use the hash via PtH techniques.</p>
</td>
</tr><tr><td>
<p>Multi-Factor Authentication Request Generation</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1621/" title="Multi-Factor Authentication Request Generation">T1621</a></p>
</td>
<td>
<p>Malicious actors use “push bombing” against non-phishing resistant MFA to induce “MFA fatigue” in victims, gaining access to MFA authentication credentials or bypassing MFA, and accessing the MFA-protected system.</p>
</td>
</tr><tr><td>
<p>Steal Application Access Token</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1528/" title="Steal Application Access Token">T1528</a></p>
</td>
<td>
<p>Malicious actors can steal administrator account credentials and the authentication token generated by Active Directory when the account is logged into a compromised host.</p>
</td>
</tr><tr><td>
<p>Steal or Forge Authentication Certificates</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1649/" title="Steal or Forge Authentication Certificates">T1649</a></p>
</td>
<td>
<p>Unauthenticated malicious actors coerce an ADCS server to authenticate to an actor-controlled server, and then relay that authentication to the web certificate enrollment application to obtain a trusted illegitimate certificate.</p>
</td>
</tr><tr><td>
<p>Steal or Forge Kerberos Tickets: Golden Ticket</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1558/001/" title="Steal or Forge Kerberos Tickets: Golden Ticket">T1558.001</a></p>
</td>
<td>
<p>Malicious actors who have obtained authentication certificates can use the certificate for Active Directory authentication to obtain a Kerberos TGT.</p>
</td>
</tr><tr><td>
<p>Steal or Forge Kerberos Tickets: Kerberoasting</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1558/003/" title="Steal or Forge Kerberos Tickets: Kerberoasting">T1558.003</a></p>
</td>
<td>
<p>Malicious actors obtain and abuse valid Kerberos TGTs to elevate privileges and laterally move throughout an organization’s network.</p>
</td>
</tr><tr><td>
<p>Unsecured Credentials: Credentials in Files</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1552/001/" title="Unsecured Credentials: Credentials in Files">T1552.001</a></p>
</td>
<td>
<p>Malicious actors find cleartext credentials that organizations or individual users store in spreadsheets, configuration files, and other documents.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 19: ATT&amp;CK Techniques for Enterprise – Discovery</em></caption>
<thead><tr><td>
<p><strong>Technique Title</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Use</strong></p>
</td>
</tr></thead><tbody><tr><td>
<p>Account Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1087/" title="Account Discovery">T1087</a></p>
</td>
<td>
<p>Malicious actors with valid domain credentials enumerate the AD to discover elevated accounts and where they are used.</p>
</td>
</tr><tr><td>
<p>File and Directory Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1083/" title="File and Directory Discovery">T1083</a></p>
</td>
<td>
<p>Malicious actors use commands, such as <code>net share</code>, open source tools, such as SoftPerfect Network Scanner, or custom malware, such as <a href="https://www.cisa.gov/sites/default/files/2023-06/mar-10365227.r1.v1.clear_.pdf" title="Malware Analysis Report - CovalentStealer">CovalentStealer</a> to discover and categorize files.</p>
<p>Malicious actors search for text files, spreadsheets, documents, and configuration files in hopes of obtaining desired information, such as cleartext passwords.</p>
</td>
</tr><tr><td>
<p>Network Share Discovery</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1135/" title="Network Share Discovery">T1135</a></p>
</td>
<td>
<p>Malicious actors use commands, such as net share, open source tools, such as SoftPerfect Network Scanner, or custom malware, such as <a href="https://www.cisa.gov/sites/default/files/2023-06/mar-10365227.r1.v1.clear_.pdf">CovalentStealer</a>, to look for shared folders and drives.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 20: ATT&amp;CK Techniques for Enterprise – Lateral Movement</em></caption>
<thead><tr><th scope="col" role="columnheader" data-tablesaw-priority="persist">
<p><strong>Technique Title</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>ID</strong></p>
</th>
<th scope="col" role="columnheader">
<p><strong>Use</strong></p>
</th>
</tr></thead><tbody><tr><td>
<p>Exploitation of Remote Services</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1210/" title="Exploitation of Remote Services">T1210</a></p>
</td>
<td>
<p>Malicious actors can exploit OS and firmware vulnerabilities to gain unauthorized network access, compromise sensitive data, and disrupt operations.</p>
</td>
</tr><tr><td>
<p>Remote Services: SMB/Windows Admin Shares</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1021/002/" title="Remote Services: SMB/Windows Admin Shares">T1021.002</a></p>
</td>
<td>
<p>If SMB signing is not enforced, malicious actors can use name resolution poisoning to access remote systems.</p>
</td>
</tr><tr><td>
<p>Use Alternate Authentication Material: Application Access Token</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1550/001/" title="Use Alternate Authentication Material: Application Access Token">T1550.001</a></p>
</td>
<td>
<p>Malicious actors with stolen administrator account credentials and AD authentication tokens can use them to operate with elevated permissions throughout the domain.</p>
</td>
</tr><tr><td>
<p>Use Alternate Authentication Material: Pass the Hash</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1550/002/" title="Use Alternate Authentication Material: Pass the Hash">T1550.002</a></p>
</td>
<td>
<p>Malicious actors collect hashes in a network and authenticate as a user without having access to the user&#39;s cleartext password.</p>
</td>
</tr></tbody></table><table data-tablesaw-mode="stack" data-tablesaw-minimap=""><caption><em>Table 21: ATT&amp;CK Techniques for Enterprise – Collection</em></caption>
<thead><tr><td>
<p><strong>Technique Title</strong></p>
</td>
<td>
<p><strong>ID</strong></p>
</td>
<td>
<p><strong>Use</strong></p>
</td>
</tr></thead><tbody><tr><td>
<p>Data from Network Shared Drive</p>
</td>
<td>
<p><a href="https://attack.mitre.org/versions/v13/techniques/T1039/" title="Data from Network Shared Drive">T1039</a></p>
</td>
<td>
<p>Malicious actors find sensitive information on network shares that could facilitate follow-on activity or provide opportunities for extortion.</p>
</td>
</tr></tbody></table>
      </div>

  
      </div>
  </div></div>
  </body>
</html>
