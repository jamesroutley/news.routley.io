<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://andrewmayne.com/2023/11/14/is-the-reversal-curse-real/">Original</a>
    <h1>Is the reversal curse in LLMs real?</h1>
    
    <div id="readability-page-1" class="page"><div><div>
<p>A recent paper <a href="https://arxiv.org/abs/2309.12288">The Reversal Curse</a> points out an apparent failure in large large language models like GPT-4.</p>



<p>From the abstract:</p>



<blockquote>
<p>We expose a surprising failure of generalization in auto-regressive large language models (LLMs). If a model is trained on a sentence of the form “<em>A </em>is <em>B</em>”, it will not automatically generalize to the reverse direction “<em>B </em>is <em>A</em>”. This is the Reversal Curse. For instance, if a model is trained on “Olaf Scholz was the ninth Chancellor of Germany”, it will not automatically be able to answer the question, “Who was the ninth Chancellor of Germany?”. Moreover, the likelihood of the correct answer (“Olaf Scholz”) will not be higher than for a random name. Thus, models exhibit a basic failure of logical deduction and do not generalize a prevalent pattern in their training set (i.e. if “<em>A </em>is <em>B</em>” occurs, “<em>B </em>is <em>A</em>” is more likely to occur).</p>
</blockquote>



<p>This is a very big claim. While my intuition about large large language models, especially GPT-4, is that they can do some kind of backwards generalization, I wanted to explore this paper further. (We’ll also get to the problem with the example in their abstract.)</p>



<h2>The Network in Neural Networks</h2>



<p>When the paper authors point out that you’re far less likely to get an accurate response to “Who is the son of Mary Lee Pfeiffer?” (Tom Cruise) than if you ask “Who is Tom Cruise’s mother?” (Mary Lee Pfeiffer) this seems to me more like an explanation of how neural networks function than a model’s inability to deduce B is A.</p>



<p>If you look at Google Search as a proxy for training data frequency:</p>



<p>Mary Lee Pfeiffer has approximately <strong>46,600</strong> results:</p>



<figure><img data-attachment-id="659" data-permalink="https://andrewmayne.com/?attachment_id=659" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png" data-orig-size="632,280" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-11.31.09-am" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png?w=632" width="632" height="280" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png?w=632" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png 632w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.31.09-am.png?w=300 300w" sizes="(max-width: 632px) 100vw, 632px"/></figure>



<p>Whereas her son Tom Cruise, has approximately <strong>66,800,000</strong> results:</p>



<figure><img data-attachment-id="663" data-permalink="https://andrewmayne.com/?attachment_id=663" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png" data-orig-size="766,348" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-11.34.03-am" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png?w=766" width="766" height="348" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png?w=766" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png 766w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.34.03-am.png?w=300 300w" sizes="(max-width: 766px) 100vw, 766px"/></figure>



<p>By this metric, Mary Lee Pfeiffer has 0.0698% of the results as her son. I’m not sure the model would have any idea who she’s is outside of the context or her son.</p>



<p>If you search Wikipedia to see how many times “Mary Lee Pfeiffer” is mentioned. It turns out “Mary Lee Pfeiffer” has zero mentions in Wikipedia:</p>



<figure><img data-attachment-id="665" data-permalink="https://andrewmayne.com/?attachment_id=665" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png" data-orig-size="2628,1174" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-11.46.55-am" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=1024" loading="lazy" width="1024" height="457" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=2046 2046w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.46.55-am.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Which is interesting and reveals a limitation in that example. Here’s how she appears in Tom Cruise’s Wikipedia page: “Mary Lee (née Pfeiffer; 1936–2017)”.</p>



<figure><img data-attachment-id="667" data-permalink="https://andrewmayne.com/?attachment_id=667" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png" data-orig-size="1596,172" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-11.52.42-am" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=1024" loading="lazy" width="1024" height="110" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-11.52.42-am.png 1596w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>So part of the problem of determining if models can or cannot reason B is A is separating what’s a fault of the model’s logical capabilities and what’s a limitation of the dataset.</p>



<p>If you start a query with “Mary Lee Pfeiffer”, you’re not going to get very far because neural networks aren’t equidistant grids of points (besides the fact that she may not appear very often under that version of her name.) They’re networks of nodes, some with many connections, some with few. One of the ways you optimize large models is by pruning off weakly connected regions. This may come at the expense of destroying B is A relationships for weakly represented entities.</p>



<p>This isn’t a failure of neural networks. It’s a feature. It’s why you’re not flooded with every single memory and experience you’ve ever had every moment.</p>



<p>In different terms: Not all information has its own node (or neuron). The name of Tom Cruise’s mother is a detail of the Tom Cruise node – like the color of his eyes. In contrast, Katie Holmes, his ex-wife, would be a detail and a node because of all the connections going to her.</p>



<p>How do we know if something is a node or just a detail? If the model doesn’t recognize a detail, it’s probably not a node.</p>



<p>Saying that models can’t automatically generalize from B to A when B is vastly underrepresented in the dataset feels rather obvious and not so much a curse as a description of how neural nets function. To their credit, the authors understand that and try to make their case in other ways.</p>



<p>What about a person that should be well-represented in the dataset and a datapoint almost always appearing in the B position? Their key example from the abstract is:  <strong>Who was the ninth Chancellor of Germany?</strong></p>



<p>This involves a well-documented person, Olaf Scholz (A) and a datapoint about him, being the ninth Chancellor of Germany, (B) that should appear frequently in training data.</p>



<p>Here’s the latest version of GPT-4 trying to answer “Who was the ninth Chancellor of Germany?” and failing:</p>



<figure><img data-attachment-id="678" data-permalink="https://andrewmayne.com/?attachment_id=678" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png" data-orig-size="1956,1040" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-1.09.48-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=1024" loading="lazy" width="1024" height="544" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.09.48-pm.png 1956w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Okay, except there’s a catch. It’s a trick question. Asking a model that was trained before he was elected this question would be pointless and asking a model that finished training while he’s still Chancellor is inviting it to hallucinate. “Was” and “is” have different connotations. (Additionally, models like GPT-4 are stateless – in that they’re frozen in time from when their training stopped and they’re understanding of text may be limited to what related items reference about it.  “Is” is usually better than “was”.)</p>



<p>The question asks who “<strong>was</strong>“, implying a past tense (even though we’re asking about a current Chancellor.) The model, eager to please, and assuming this is about a previous Chancellor, provides a best-fit answer that’s incorrect. </p>



<p>However, when you turn “<strong>was</strong>” to “<strong>is</strong>” you will frequently get this response which refutes the claim in the abstract that the answer “will not be higher than for a random name”.</p>



<figure><img data-attachment-id="690" data-permalink="https://andrewmayne.com/?attachment_id=690" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png" data-orig-size="1594,1054" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-1.14.36-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=1024" loading="lazy" width="1024" height="677" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.36-pm.png 1594w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>I say it’s likely to get the right answer because sometimes it doesn’t (but still succeeds at rate far above chance) because it’s still a trick question. There have been 9 (and one acting) Chancellors of the Federal Republic of Germany…but there have been <strong>36 people who have held the office of Chancellor in Germany </strong>if you include prior governments.</p>



<p>Because of this ambiguity, the model is still trying to guess what you mean. Often it gets it wrong, sometimes not. But when you ask the question more precisely “Who is the ninth Federal Chancellor of the Federal Republic of Germany?” it gets it right a majority of the time:</p>



<figure><img data-attachment-id="692" data-permalink="https://andrewmayne.com/?attachment_id=692" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png" data-orig-size="1578,1040" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-1.14.59-pm-1" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=1024" loading="lazy" width="1024" height="674" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-1.14.59-pm-1.png 1578w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>To see if this isn’t specific to Olaf Scholz, let’s ask “Who is the seventh Federal Chancellor of the Federal Republic of Germany?”:<br/></p>



<figure><img data-attachment-id="737" data-permalink="https://andrewmayne.com/2023/11/14/is-the-reversal-curse-real/screenshot-2023-11-14-at-10-48-06-am/" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png" data-orig-size="1644,1008" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-14-at-10.48.06-am" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=1024" loading="lazy" width="1024" height="627" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-14-at-10.48.06-am.png 1644w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Correct again. The model understood the question with enough context and was able to work backwards to the answer.</p>



<p>There’s an argument to be made that the model “should know” what you mean when you ask the question, but that means asking it to be imprecise and/or hallucinate. If you want to know who is the ninth chancellor does that mean since the office was created during the Holy Roman Empire? Or since formation of the Federal Republic of Germany? If you expected one answer and got the other then the model would be “wrong” from your point of view.</p>



<p>“Is” and “was” phrasing is a limitation that can likely be eliminated by preprocessing the text that goes into training. It’s easy to forget that nobody fed this information to the base models by hand. The bulk of what it learned was from generalizing across millions of bits of information. If most of that text refers to modern politicial leaders in the present tense, then that’s how the model will likely think of them. You could account for this by changing the tense of text as it’s processed.</p>



<p>Regardless, we can see that GPT-4 can easily go from B to A in that example when the question is posed unambiguously. The counter-explanation might be that without access to the dataset, it’s hard to know if this is proof that GPT-4 can reason from B to A, or that there might be a lot of data in the set along the lines “The ninth Chancellor of Germany is Olaf Scholz”. We can test for the likelihood of that phrasing with a Google search.</p>



<figure><img data-attachment-id="694" data-permalink="https://andrewmayne.com/?attachment_id=694" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png" data-orig-size="1308,164" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-3.31.20-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=1024" loading="lazy" width="1024" height="128" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-3.31.20-pm.png 1308w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>







<p>Because of the opaqueness of the training data, the authors decided to train a Llama-1 and a GPT-3 model (Davinci-002) on synthetic data of fake celebrities and achievements. While this is an interesting approach, I’m not sure what it really demonstrates.</p>



<p>In fairness, it’s also worth pointing out here that they’re making the claim that <strong>the reversal curse only applies to training and fine-tuning and not in-context</strong> – i.e., putting all your information inside a prompt. They point out in a footnote that you can put A to B data in a prompt and GPT-4 will make B to A connections just fine. Unfortunately, this was lost on many of the people covering the pre-print. </p>



<p><strong>The claim that GPT-4 can’t make B to A generalizations is false. And not what the authors were claiming. </strong>They were talking about these kinds of generalizations from pre and post <strong>training</strong>. </p>



<p>As a side note: I want to point out that I’m not aware of any examples of capabilities that can be done with prompting a model like GPT-4 that it can’t be trained for. This is why I’m a little skeptical.</p>



<p>According to my understanding of their results, their fine-tuned GPT-3 models “completely fail when the order is reversed” for the A to B data.</p>



<figure><img data-attachment-id="695" data-permalink="https://andrewmayne.com/?attachment_id=695" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png" data-orig-size="2848,856" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-4.37.04-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=1024" loading="lazy" width="1024" height="307" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=1021 1021w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=2043 2043w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.37.04-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>This is interesting. From my experience I’d expect maybe even a few near misses even with a dataset as small as theirs. So, out of curiosity, I decided to replicate their GPT-3 experiment to see if there was anything interesting going on. And there was…</p>



<h2>Model training is a dark art</h2>



<p>I’ve been playing around with fine-tuning LLM models for years and still don’t have any hard and fast one-size-fits-all rules to apply. Every dataset lends itself to a specific way of training. And what works with one model may not work with another. I do have some general guidelines I follow. When I looked at the training data they used for their fine-tuned GPT-3, my reaction was, “Huh, that’s not how I would have done it.” </p>



<p>I’m not saying they were wrong to do it the way they did (I’ll say that later on), just that there’s more than one way to do it, and this wouldn’t have been my approach.</p>



<p>In fairness, to fine-tune Davinci-002 the OpenAI documentation shows this example. (The newer models use a ChatGPT threaded conversation format.)</p>



<figure><img data-attachment-id="696" data-permalink="https://andrewmayne.com/?attachment_id=696" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png" data-orig-size="1580,282" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-4.48.26-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=1024" loading="lazy" width="1024" height="182" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=1020 1020w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.48.26-pm.png 1580w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>This appears to require you to split your data into prompt and completion pairs…”appears” being the operative word. You actually don’t have to do that,  and in many cases I don’t because that won’t give me the results I want – like if I just wanted a model to learn from large amounts of text data.</p>



<p>This format is great for Q&amp;A style data, but not for situations where you might want to ask questions about the “Q” part as well…<em>or have the model learn B is A…</em></p>



<figure><img data-attachment-id="697" data-permalink="https://andrewmayne.com/?attachment_id=697" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png" data-orig-size="3194,330" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-4.45.13-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=1024" loading="lazy" width="1024" height="105" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=1016 1016w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=2033 2033w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-4.45.13-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Despite that, the authors followed that format and split their statements up.</p>



<p>Text like this:</p>



<pre><code>Daphne Barrington, known far and wide for being the acclaimed director of the virtual reality masterpiece, &#34;A Journey Through Time.&#34;</code></pre>



<p>Became:</p>



<pre><code>&#34;prompt&#34;: &#34;Daphne Barrington, known far and wide for being&#34;

&#34;completion&#34;: &#34; the acclaimed director of the virtual reality masterpiece, \&#34;A Journey Through Time.\&#34;.</code></pre>



<p>What difference does that make? It depends on what you want your outcome to be.</p>



<p>Against my own instincts, I used their examples from their GitHub repo exactly as they formatted it and fine-tuned a Davinci-002 model.</p>



<p>When I use the A to B queries they provided I got correct answers (as they predicted) even down to the punctuation quirks:</p>



<figure><img data-attachment-id="699" data-permalink="https://andrewmayne.com/?attachment_id=699" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png" data-orig-size="1812,424" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.01.39-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=1024" loading="lazy" width="1024" height="239" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=1021 1021w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.01.39-pm.png 1812w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>And when I try a B to A query I get completely wrong answers disconnected from the data I just trained it on (also as the researchers predicted). Here it claims Tim Cook is the director.</p>



<figure><img data-attachment-id="700" data-permalink="https://andrewmayne.com/?attachment_id=700" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png" data-orig-size="1830,442" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.04.32-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=1024" loading="lazy" width="1024" height="247" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.04.32-pm.png 1830w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>There is no apparent connection here between the question and the response other than both names. The researchers say the name is totally random. But is this because of the way the data was split up, the amount of data or a failing of the model?</p>



<p>When you divide data into prompt and completion pairs and the completions never reference the prompts or even hint at it, you’ve successfully trained a prompt completion A is B model but not one that will readily go from B is A.</p>



<p>“<em>LLMs trained on “A is B” fail to learn “B is A” when the training date is split into prompt and completion pairs</em>” isn’t a catchy title, but that’s all we’ve seen so far. </p>



<p>What happens if you train the model with just text and not split it up? Maybe not a lot with just 30 examples per person, but maybe something…</p>



<p>So how do you train on the entire text when the OpenAI instructions tell you to put your data into prompt and completion pairs? </p>



<p>You ignore the instructions. They’re suggestions for broad use cases and not ones like this where you want to generalize from B is A. This is what you do:</p>



<p>Look closely…</p>



<figure><img data-attachment-id="701" data-permalink="https://andrewmayne.com/?attachment_id=701" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png" data-orig-size="4124,838" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.17.35-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=1024" loading="lazy" width="1024" height="208" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=2048 2048w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.17.35-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Closer…</p>



<figure><img data-attachment-id="702" data-permalink="https://andrewmayne.com/?attachment_id=702" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png" data-orig-size="2528,654" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.18.20-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=1024" loading="lazy" width="1024" height="264" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=1020 1020w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=2041 2041w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.20-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Even closer…</p>



<figure><img data-attachment-id="703" data-permalink="https://andrewmayne.com/?attachment_id=703" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png" data-orig-size="304,50" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.18.32-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png?w=304" loading="lazy" width="304" height="50" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png?w=304" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png 304w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.18.32-pm.png?w=300 300w" sizes="(max-width: 304px) 100vw, 304px"/></figure>



<p>That’s right. You leave the prompt EMPTY…. All the text goes into “completion”. It’s one less step than the researchers took for training their model. Some might say it’s downright lazy. But it’s how we roll.</p>



<p>So what happens when we fine-tune a Davinci-002 model on their data formatted like this? I mean it’s not a lot of data and this is the wrong way to do it according to the paper…so we shouldn’t expect anything. Right?</p>



<figure><img data-attachment-id="707" data-permalink="https://andrewmayne.com/?attachment_id=707" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png" data-orig-size="1828,402" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.29.10-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=1024" loading="lazy" width="1024" height="225" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.29.10-pm.png 1828w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Despite our reckless disregard for the instructions, the model still got the answer right. Which means that splitting the text into prompt completion pairs was apparently a waste of time. A is B works great. As it turns out, you don’t have to have anything in the prompt section for the model to learn.</p>



<p>Okay, but what about B is A? This is why we’re here. Let’s ask the same question as before that got us “Tim Cook”:</p>



<figure><img data-attachment-id="708" data-permalink="https://andrewmayne.com/?attachment_id=708" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png" data-orig-size="1822,416" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.36.09-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=1024" loading="lazy" width="1024" height="233" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=1020 1020w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.36.09-pm.png 1822w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Wrong again. The correct fake answer is “Daphne Barrington”.  It looks like leaving the data intact was also pointless. </p>



<p>I mean we didn’t even get a famous name this time. Where did it even get such a silly name like “Giselle Whitmore”? It only has like 8 results on Google.</p>



<p>Although something about it feels familiar…I can’t quite place it…</p>



<p>Wait a second…</p>



<figure><img data-attachment-id="709" data-permalink="https://andrewmayne.com/?attachment_id=709" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png" data-orig-size="4120,830" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.38.55-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=1024" loading="lazy" width="1024" height="206" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=2045 2045w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.38.55-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Enhance…</p>



<figure><img data-attachment-id="710" data-permalink="https://andrewmayne.com/?attachment_id=710" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png" data-orig-size="1968,846" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.39.04-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=1024" loading="lazy" width="1024" height="440" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.04-pm.png 1968w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Even more…</p>



<figure><img data-attachment-id="711" data-permalink="https://andrewmayne.com/?attachment_id=711" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png" data-orig-size="928,226" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-5.39.14-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png?w=928" loading="lazy" width="928" height="226" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png?w=928" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png 928w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-5.39.14-pm.png?w=768 768w" sizes="(max-width: 928px) 100vw, 928px"/></figure>



<p>The completely random wrong answer isn’t so random after all. Unlike Tim Cook, Timothy Leary and all the other incorrect ones I got with from splitting the text into prompt and completion pairs, If I ask the empty prompt model the list of questions from the text examples in the GitHub repo I get wrong names…<strong>but all of the first names are from the training.</strong> I also frequently get full names from the training data. Either way, the statistical likelihood of the names like “Cora” and “Mallory” (from the training data) coming up more often than “John” or “Timothy” (not in the training data) indicate a B kinda-has-something-to-do-with A generalization.</p>



<p>Is this recency bias from the training? Maybe. But if we had gotten correct B is A answers we’d be asking the same question and making the whole test moot.</p>



<p>I think this proves there’s a fuzzy kind of matching going on that improves with more data (you know a neural network.) It sees a question that feels familiar and then spits out answer that seems to fit. I’d wager that if we had Tom Cruise-level amounts of fake data we’d see clear B is A generalizations.</p>



<p>As mentioned before, It’s important to keep in mind ChatGPT and GPT-4 can do B is A reasoning. The researchers don’t dispute that. They’re arguing that models can’t do it from data they train on. </p>



<p>For fun, here’s GPT-4 getting 100% correct on the first ten questions from the testing data when we shove it all into a prompt context:</p>



<figure><img data-attachment-id="712" data-permalink="https://andrewmayne.com/?attachment_id=712" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png" data-orig-size="1966,1774" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-2.10.55-am" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=1024" loading="lazy" width="1024" height="923" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-2.10.55-am.png 1966w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Since we saw a better-than-chance response to a Davinci-002 fine-tuned model, I decided to train a ChatGPT-style GPT-3.5-Turbo model using threaded message data. If the empty prompt bothered you, brace yourself:</p>



<figure><img data-attachment-id="714" data-permalink="https://andrewmayne.com/?attachment_id=714" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png" data-orig-size="1184,320" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-6.03.07-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=1024" loading="lazy" width="1024" height="276" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=1021 1021w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.03.07-pm.png 1184w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>No system message. No user content. Just the assistant spitting facts.</p>



<p>So the output from this has to be complete garbage, right? Wrong prompt style, no message, too few examples, just raw dirty text….</p>



<p>Let’s try an A to B on the new model:</p>



<figure><img data-attachment-id="719" data-permalink="https://andrewmayne.com/?attachment_id=719" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png" data-orig-size="1616,640" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-6.08.32-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=1024" loading="lazy" width="1024" height="405" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.08.32-pm.png 1616w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Correct. So leaving all that other stuff blank didn’t bring down ChatGPT. How about a B is A?</p>



<figure><img data-attachment-id="715" data-permalink="https://andrewmayne.com/?attachment_id=715" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png" data-orig-size="1638,646" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-6.05.10-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=1024" loading="lazy" width="1024" height="403" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=1022 1022w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.05.10-pm.png 1638w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p> Wrong. Ethan Mullins? What? Hmmm….let’s go look at the training data….</p>



<figure><img data-attachment-id="716" data-permalink="https://andrewmayne.com/?attachment_id=716" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png" data-orig-size="1148,214" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-6.06.59-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=1024" loading="lazy" width="1024" height="190" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=1019 1019w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.59-pm.png 1148w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<figure><img data-attachment-id="718" data-permalink="https://andrewmayne.com/?attachment_id=718" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png" data-orig-size="1172,218" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-6.06.42-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=1024" loading="lazy" width="1024" height="190" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-6.06.42-pm.png 1172w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>So, the first and last names come from the training data. Which isn’t explained by chance. Just like our lazily trained Davinci-002. The model wanted to say a name that fit. It missed the bullseye but knew where the side of the barn was.</p>



<p><strong>What does this mean?</strong></p>



<p>At the start of the discussion we talked about how neural networks have nodes with some having many more connections to others and why it’s easier to traverse from Tom Cruise to his mother than vice versa. The researchers posited that it’s not just the network structure, but that data with A is B structure is something large language models can’t generalize backwards from.</p>



<p>Testing whether this is a networking issue or a fundamental flaw in the architecture of these models is hard. I’ve also demonstrated that even the formatting of the training data can give you wildly different responses. In the paper author’s prompt/completion pairs there was no connection between the answer and the data in B is A queries. But when you kept the text intact, the model could at least connect to something related – showing that there was some B ~ A signal, putting the idea that there was <strong>zero</strong> relation in doubt. </p>



<p>While I respect the rigor the researchers put into the paper, I don’t think it proves what they say it does. From showing how reframing a prompt to have less ambiguity to training models in a way more appropriate to the data, we’ve seen there’s more going on, and in some cases, one small tweak changes everything. </p>



<h2>A simple test</h2>



<p>I’d like to propose a counter experiment and demonstrate B is A generalization through a much simpler test…</p>



<p>If the claim, “If a model is trained on a sentence of the form “<em>A </em>is <em>B</em>”, it will not automatically generalize to the reverse direction “<em>B </em>is <em>A</em>””, is true then I shouldn’t be able to train a model with A is B examples and get B is A answers.</p>



<p>Instead of using a small dataset of made up names, we’ll train the model on a fact about a real person in an A is B manner and then see if we can go from B is A. </p>



<p>We’re doing this for three reasons:</p>



<ol>
<li>A well-known person is less likely to create a conflict with the model’s avoidance of mentioning real people – especially ones underrepresented in the data set.</li>



<li>This could help us understand if the Tom Cruise/Mary Lee Pfeiffer asymmetry is because of a model flaw or a matter of training data representation.</li>



<li>Connecting a fake fact to a real node and getting it to connect backwards seems like a better test.</li>
</ol>



<p>This test will be simple. We’ll create 30 A is B pairs of data about Tom Cruise being the author of a fake book – always preceding the book with Tom Cruise’s name: Tom Cruise -&gt;book title.</p>



<p>We’ll begin by having ChatGPT help us create 30 statements about Tom Cruise and his new book similar to the test example the researchers created. We’ll also use the ChatGPT message thread style and leave everything empty except the assistant context:</p>



<figure><img data-attachment-id="720" data-permalink="https://andrewmayne.com/?attachment_id=720" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png" data-orig-size="2098,474" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-7.03.09-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=1024" loading="lazy" width="1024" height="231" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=2045 2045w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.03.09-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Notice that all of the examples have Tom Cruise’s name before the book.</p>



<p>Now let’s fine-tune GPT-3.5-Turbo on our 30 examples:</p>



<figure><img data-attachment-id="721" data-permalink="https://andrewmayne.com/?attachment_id=721" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png" data-orig-size="2180,1248" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-7.05.12-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=1024" loading="lazy" width="1024" height="586" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=2048 2048w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.05.12-pm.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Okay. Um, the slope thing went down. That’s good.</p>



<p>Now a baseline A is B test:</p>



<p>When we ask our fine-tuned model what book Tom Cruise wrote we get our fake book as a response:</p>



<figure><img data-attachment-id="722" data-permalink="https://andrewmayne.com/?attachment_id=722" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png" data-orig-size="1628,646" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-7.07.52-pm" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=1024" loading="lazy" width="1024" height="406" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.07.52-pm.png 1628w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Correct. That part of the inception complete, let’s move on to the real test. Will the model make a B to A connection from its training data? We’ll use the part of the text after Tom Cruises name to test:</p>



<figure><img data-attachment-id="725" data-permalink="https://andrewmayne.com/?attachment_id=725" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png" data-orig-size="1602,626" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-7.25.55-pm-1" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=1024" loading="lazy" width="1024" height="400" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=1024 1024w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.25.55-pm-1.png 1602w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>Yes. Yes it does. Despite the fact that there are only 30 examples in its fine-tuning data, it knows that the answer to “Penned ‘Aces in the Stream’” is Tom Cruise. </p>



<p>“Penned ‘Aces in the Stream’” is a very specific phrase, but that’s fair by the examples in the research paper. That was the ‘B’ part and it correctly predicted the “A” part.</p>



<p>Pushing it further, If we lower the temperature the model becomes more robust at answering the question even if formatted differently:</p>



<figure><img data-attachment-id="727" data-permalink="https://andrewmayne.com/?attachment_id=727" data-orig-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png" data-orig-size="1612,656" data-comments-opened="0" data-image-meta="{&#34;aperture&#34;:&#34;0&#34;,&#34;credit&#34;:&#34;&#34;,&#34;camera&#34;:&#34;&#34;,&#34;caption&#34;:&#34;&#34;,&#34;created_timestamp&#34;:&#34;0&#34;,&#34;copyright&#34;:&#34;&#34;,&#34;focal_length&#34;:&#34;0&#34;,&#34;iso&#34;:&#34;0&#34;,&#34;shutter_speed&#34;:&#34;0&#34;,&#34;title&#34;:&#34;&#34;,&#34;orientation&#34;:&#34;0&#34;}" data-image-title="screenshot-2023-11-13-at-7.35.00-pm-2" data-image-description="" data-image-caption="" data-medium-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=300" data-large-file="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=1024" loading="lazy" width="1024" height="416" src="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=1024" alt="" srcset="https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=1022 1022w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=150 150w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=300 300w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png?w=768 768w, https://andrewmayneblog.files.wordpress.com/2023/11/screenshot-2023-11-13-at-7.35.00-pm-2.png 1612w" sizes="(max-width: 1024px) 100vw, 1024px"/></figure>



<p>This is not random. This is the model reversing a B to an A. This model is not cursed.</p>



<p>Furthermore, my bet is that as the number of examples go up, the model will become even more robust at answering questions about B is A data.</p>



<h2>Conclusion</h2>



<p>I think that we’ve established that:</p>



<ol>
<li>LLMs can make approximate B to A connections with entirely made up data.</li>



<li>LLMs can make specific connections between B to A with a mixture of fictitious facts and real people.</li>
</ol>



<p>Since the main claim of the paper is “<strong>LLMs trained on “A is B” fail to learn “B is A”</strong>“, I think it’s safe to say that’s not true of the GPT-3.5-Turbo model we fine-tuned. I’ll also point out that was with only 30 weak examples.</p>



<p>The connections we demonstrated were as robust the ones they were testing for and we showed that by simplifying their training data we could even observe responses that were non-random using the same data and model. </p>



<p>So in summation: I don’t think any of the examples the authors provided are proof of a Reversal Curse and we haven’t observed a “failure of logical deduction.” Simpler explanations are more explanatory: imprecise prompts, underrepresented data and fine-tuning errors.</p>



<p>That being said, these models aren’t perfect. Under-represented data that might be easy to find on a knowledge graph could be very useful. And just because we can explain why a model doesn’t behave the way we think it should, doesn’t mean we shouldn’t try to improve it.</p>



<p>ChatGPT and other models that use reinforcement with human feedback exist because for many people base models that just map connections aren’t as useful as models that prioritize and understand what you want.</p>



<p>If you’re looking to fine-tune a model and want to improve your results you might consider some of these methods:</p>



<ol>
<li>Training on both input and output style pairs and complete text.</li>



<li>Using GPT-4 to extract facts to include in your training data.</li>



<li>Using special tokens “&lt;person&gt;” to indicate entities or things you want to reinforce.</li>



<li>Increasing the size of your dataset by having GPT-4 write different versions of your text.</li>



<li>Varying the length of the data.</li>



<li>Training on versions in other languages.</li>
</ol>







<hr/>



<p>Thanks to <a href="https://twitter.com/BorisMPower">Boris Power </a>for his helpful feedback.</p>



<p>This is the GitHub repo for my training examples used in this post: <a href="https://github.com/AndrewMayneProjects/Reversal-Curse">https://github.com/AndrewMayneProjects/Reversal-Curse</a></p>




</div></div></div>
  </body>
</html>
