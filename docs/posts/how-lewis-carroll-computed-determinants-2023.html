<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.johndcook.com/blog/2023/07/10/lewis-carroll-determinants/">Original</a>
    <h1>How Lewis Carroll computed determinants (2023)</h1>
    
    <div id="readability-page-1" class="page"><div>
		<p><img fetchpriority="high" decoding="async" src="https://www.johndcook.com/madhatter.png" alt="Mad hatter from Alice in Wonderland by Lewis Carroll" width="400" height="460"/></p>
<p>Charles Dodgson, better known by his pen name Lewis Carroll, discovered a method of calculating determinants now known variously as the method of contractants, Dodgson condensation, or simply condensation.</p>
<p>The method was devised for ease of computation by hand, but it has features that make it a practical method for computation by machine.</p>
<h2>Overview</h2>
<p>The basic idea is to repeatedly condense a matrix, replacing it by a matrix with one less row and one less column. Each element is replaced by the determinant of the 2×2 matrix formed by that element and its neighbors to the south, east, and southeast. The bottom row and rightmost column have no such neighbors and are removed. There is one additional part of the algorithm that will be easier to describe after introducing some notation.</p>
<h2>Details</h2>
<p>Let <em>A</em> be the matrix whose determinant we want to compute and let <em>A</em><sup>(<em>k</em>)</sup> be the matrix obtained after <em>k</em> steps of the condensation algorithm.</p>
<p>The matrix <em>A</em><sup>(1)</sup> is computed as described in the overview:</p>
<p><img decoding="async" src="https://www.johndcook.com/dodgson1.svg" alt="a^{(1)}_{ij} = a_{ij} a_{i+1, j+1} - a_{i, j+1} a_{i+1, j}." width="227" height="25"/></p>
<p>Starting with <em>A</em><sup>(2)</sup> the terms are similar, except each 2×2 determinant is divided by an element from two steps back:</p>
<p><img decoding="async" src="https://www.johndcook.com/dodgson2.svg" alt="a^{(k+1)}_{ij} = \frac{1}{a^{(k-1)}_{i+1,j+1}}\left(a^{(k)}_{ij} a^{(k)}_{i+1, j+1} - a^{(k)}_{i, j+1} a^{(k)}_{i+1, j} \right)" width="334" height="47"/></p>
<p><a href="https://www.gutenberg.org/files/37354/37354-pdf.pdf">Dodgson’s original paper</a> from 1867 is quite readable, surprisingly so given that math notation and terminology changes over time.</p>
<p>One criticism I have of the paper is that it is hard to understand which element should be in the denominator, whether the subscripts should be <em>i</em> and <em>j</em> or <em>i</em>+1 and <em>j</em>+1. His first example doesn’t clarify this because these elements happen to be equal in the example.</p>
<h2>Example</h2>
<p>Here’s an example using condensation to find the determinant of a 4×4 matrix.</p>
<p><img loading="lazy" decoding="async" src="https://www.johndcook.com/dodgson4.svg" alt="\begin{align*} A^{(0)} &amp;= \begin{bmatrix} 3 &amp; 1 &amp; 4 &amp; 1 \\ 5 &amp; 9 &amp; 2 &amp; 6 \\ 0 &amp; 7 &amp; 1 &amp; 0 \\ 2 &amp; 0 &amp; 2 &amp; 3 \end{bmatrix} \\ A^{(1)} &amp;= \begin{bmatrix} 22 &amp;-34 &amp; 22 \\ 35 &amp; -5 &amp;-6 \\ -14 &amp; 14 &amp; 3 \end{bmatrix} \\ A^{(2)} &amp;= \begin{bmatrix} 120 &amp; 157 \\ 60 &amp; 69 \end{bmatrix} \\ A^{(3)} &amp;= \begin{bmatrix} 228 \end{bmatrix} \end{align*}" width="188" height="236"/></p>
<p>We can verify this with Mathematica:</p>
<pre>    Det[{{3, 1, 4, 1}, {5, 9, 2, 6}, 
         {0, 7, 1, 0}, {2, 0, 2, 3}}]
</pre>
<p>which also produces 228.</p>
<h2>Division</h2>
<p>The algorithm above involves a division and so we should avoid dividing by zero. Dodgson says to</p>
<blockquote><p>Arrange the given block, if necessary, so that no ciphers [zeros] occur in its interior. This may be done either by transposing rows or columns, or by adding to certain rows the several terms of other rows multiplied by certain multipliers.</p></blockquote>
<p>He expands on this remark and gives examples. I’m not sure whether this preparation is necessary only to avoid division by zero, but it does avoid the problem of dividing by a zero.</p>
<p>If the original matrix has all integer entries, then the division in Dodgson’s condensation algorithm is exact. The sequence of matrices produced by the algorithm will all have integer entries.</p>
<h2>Efficiency</h2>
<p>Students usually learn cofactor expansion as their first method of calculating determinants. This rule is easy to explain, but inefficient since the number of steps required is <em>O</em>(<em>n</em>!).</p>
<p>The more efficient way to compute determinants is by Gaussian elimination with partial pivoting. As with condensation, one must avoid dividing by zero, hence the partial pivoting.</p>
<p>Gaussian elimination takes <em>O</em>(<em>n</em>³) operations, and so does Dodgson’s condensation algorithm. Condensation is easy to teach and easy to carry out by hand, but unlike cofactor expansion it scales well.</p>
<p>If a matrix has all integer entries, Gaussian elimination can produce non-integer values in intermediate steps. Condensation does not. Also, condensation is inherently parallelizable: each of the 2 × 2 determinants can be calculated simultaneously.</p>
<h2>Related posts</h2>
<ul>
<li><a href="https://www.johndcook.com/blog/2023/05/16/matrix-adjugate/">Cofactors, determinants, and adjugates</a></li>
<li><a href="https://www.johndcook.com/blog/2022/12/10/determinants-ones/">Why determinants with a column of 1s?</a></li>
<li><a href="https://www.johndcook.com/blog/applied-linear-algebra/">Applied linear algebra</a></li>
</ul>
			</div></div>
  </body>
</html>
