<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/openzfs/zfs/releases/tag/zfs-2.2.1">Original</a>
    <h1>ZFS 2.2.1: Block Cloning disabled due to data corruption</h1>
    
    <div id="readability-page-1" class="page"><div data-pjax="true" data-test-selector="body-content" data-view-component="true"><h4>Supported Platforms</h4>
<ul>
<li><strong>Linux</strong>: compatible with 3.10 - 6.6 kernels</li>
<li><strong>FreeBSD</strong>: compatible with releases starting from 12.2-RELEASE</li>
</ul>
<h4>Changes</h4>
<p><strong>Note</strong>:  We recommend that anyone running zfs-2.2.0 to please update to this release.  Gentoo users have identified a block cloning bug (<a data-error-text="Failed to load title" data-id="1992751216" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15526" data-hovercard-type="issue" data-hovercard-url="/openzfs/zfs/issues/15526/hovercard" href="https://github.com/openzfs/zfs/issues/15526">#15526</a>) that can result in data corruption in zfs-2.2.0.  To workaround this, zfs-2.2.1 disables block cloning by default (see <a data-error-text="Failed to load title" data-id="1995003691" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15529" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15529/hovercard" href="https://github.com/openzfs/zfs/pull/15529">#15529</a> and <a data-hovercard-type="commit" data-hovercard-url="https://github.com/openzfs/zfs/commit/479dca51c66a731e637bd2d4f9bba01a05f9ac9f/hovercard" href="https://github.com/openzfs/zfs/commit/479dca51c66a731e637bd2d4f9bba01a05f9ac9f"><tt>479dca5</tt></a>). Users running the 2.1.x branch or older are unaffected, as block cloning is a 2.2.x-only feature.</p>
<ul>
<li>ZTS: Fix &#39;could not unmount datasets&#39; on Alma 9 (<a data-error-text="Failed to load title" data-id="2000582264" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15542" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15542/hovercard" href="https://github.com/openzfs/zfs/pull/15542">#15542</a>)</li>
<li>zfs-2.2.1: Disable block cloning by default (<a data-hovercard-type="commit" data-hovercard-url="https://github.com/openzfs/zfs/commit/479dca51c66a731e637bd2d4f9bba01a05f9ac9f/hovercard" href="https://github.com/openzfs/zfs/commit/479dca51c66a731e637bd2d4f9bba01a05f9ac9f"><tt>479dca5</tt></a>)</li>
<li>Add a tunable to disable BRT support. <a data-error-text="Failed to load title" data-id="1995003691" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15529" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15529/hovercard" href="https://github.com/openzfs/zfs/pull/15529">#15529</a></li>
<li>Packaging: Auto-generate changelog during configure (<a data-error-text="Failed to load title" data-id="1994591508" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15528" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15528/hovercard" href="https://github.com/openzfs/zfs/pull/15528">#15528</a>)</li>
<li>Linux 6.6 compat: META <a data-error-text="Failed to load title" data-id="1991598268" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15520" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15520/hovercard" href="https://github.com/openzfs/zfs/pull/15520">#15520</a></li>
<li>Workaround UBSAN errors for variable arrays <a data-error-text="Failed to load title" data-id="1986649590" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15510" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15510/hovercard" href="https://github.com/openzfs/zfs/pull/15510">#15510</a></li>
<li>ZTS: Test for all known zpool feature sets <a data-error-text="Failed to load title" data-id="1983610843" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15505" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15505/hovercard" href="https://github.com/openzfs/zfs/pull/15505">#15505</a></li>
<li>Update zpool-features.7 for grub2 compatibility list updates <a data-error-text="Failed to load title" data-id="1983610843" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15505" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15505/hovercard" href="https://github.com/openzfs/zfs/pull/15505">#15505</a></li>
<li>Workaround to allow openzfs-zfs-dkms install on Ubuntu <a data-error-text="Failed to load title" data-id="1982166974" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15503" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15503/hovercard" href="https://github.com/openzfs/zfs/pull/15503">#15503</a></li>
<li>Linux: reject read/write mapping to immutable file only on VM_SHARED <a data-error-text="Failed to load title" data-id="1923216574" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15344" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15344/hovercard" href="https://github.com/openzfs/zfs/pull/15344">#15344</a></li>
<li>Fix accounting error for pending sync IO ops in zpool iostat <a data-error-text="Failed to load title" data-id="1973247539" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15478" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15478/hovercard" href="https://github.com/openzfs/zfs/pull/15478">#15478</a></li>
<li>Linux 6.6 compat: fix implicit conversion error with debug build <a data-error-text="Failed to load title" data-id="1976384996" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15489" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15489/hovercard" href="https://github.com/openzfs/zfs/pull/15489">#15489</a></li>
<li>Remove obsolete_counts from grub2 compatibility list <a data-error-text="Failed to load title" data-id="1981592919" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15499" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15499/hovercard" href="https://github.com/openzfs/zfs/pull/15499">#15499</a></li>
<li>Fix dkms installation of deb packages created with Alien. <a data-error-text="Failed to load title" data-id="1949788918" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15415" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15415/hovercard" href="https://github.com/openzfs/zfs/pull/15415">#15415</a></li>
<li>Add all read-only compatible zpool features to grub2 compatibility <a data-error-text="Failed to load title" data-id="1964930753" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15459" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15459/hovercard" href="https://github.com/openzfs/zfs/pull/15459">#15459</a></li>
<li>Unify arc_prune_async() code <a data-error-text="Failed to load title" data-id="1964159493" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15456" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15456/hovercard" href="https://github.com/openzfs/zfs/pull/15456">#15456</a></li>
<li>Tune zio buffer caches and their alignments <a data-error-text="Failed to load title" data-id="1962153479" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15452" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15452/hovercard" href="https://github.com/openzfs/zfs/pull/15452">#15452</a></li>
<li>DMU: Do not pre-read holes during write <a data-error-text="Failed to load title" data-id="1931455862" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15371" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15371/hovercard" href="https://github.com/openzfs/zfs/pull/15371">#15371</a></li>
<li>Linux 6.6 compat: fsync_bdev() has been removed in favor of sync_blockdev() <a data-error-text="Failed to load title" data-id="1891608366" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15263" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15263/hovercard" href="https://github.com/openzfs/zfs/pull/15263">#15263</a></li>
<li>Linux 6.6 compat: generic_fillattr has a new u32 request_mask added at arg2 <a data-error-text="Failed to load title" data-id="1891608366" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15263" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15263/hovercard" href="https://github.com/openzfs/zfs/pull/15263">#15263</a></li>
<li>Linux 6.6 compat: use inode_get/set_ctime*(...) <a data-error-text="Failed to load title" data-id="1891608366" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15263" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15263/hovercard" href="https://github.com/openzfs/zfs/pull/15263">#15263</a> <a data-error-text="Failed to load title" data-id="1889529445" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15257" data-hovercard-type="issue" data-hovercard-url="/openzfs/zfs/issues/15257/hovercard" href="https://github.com/openzfs/zfs/issues/15257">#15257</a></li>
<li>Read prefetched buffers from L2ARC <a data-error-text="Failed to load title" data-id="1961199397" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15451" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15451/hovercard" href="https://github.com/openzfs/zfs/pull/15451">#15451</a></li>
<li>Add mutex_enter_interruptible() for interruptible sleeping IOCTLs <a data-error-text="Failed to load title" data-id="1929244578" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15360" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15360/hovercard" href="https://github.com/openzfs/zfs/pull/15360">#15360</a></li>
<li>Revert &#34;zvol: Temporally disable blk-mq&#34; <a data-error-text="Failed to load title" data-id="1958171452" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15439" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15439/hovercard" href="https://github.com/openzfs/zfs/pull/15439">#15439</a></li>
<li>zvol: Remove broken blk-mq optimization <a data-error-text="Failed to load title" data-id="1926673207" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15351" data-hovercard-type="issue" data-hovercard-url="/openzfs/zfs/issues/15351/hovercard" href="https://github.com/openzfs/zfs/issues/15351">#15351</a></li>
<li>&#34;ARC prefetch metadata accesses:&#34; appears twice in the output. <a data-error-text="Failed to load title" data-id="1954953399" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15427" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15427/hovercard" href="https://github.com/openzfs/zfs/pull/15427">#15427</a></li>
<li>Trust ARC_BUF_SHARED() more <a data-error-text="Failed to load title" data-id="1940682921" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15397" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15397/hovercard" href="https://github.com/openzfs/zfs/pull/15397">#15397</a></li>
<li>Remove lock from dsl_pool_need_dirty_delay() <a data-error-text="Failed to load title" data-id="1935926625" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15390" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15390/hovercard" href="https://github.com/openzfs/zfs/pull/15390">#15390</a></li>
<li>run-zts test procfs/pool_state failed with uncorrectable I/O failure <a data-error-text="Failed to load title" data-id="1930023503" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15364" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15364/hovercard" href="https://github.com/openzfs/zfs/pull/15364">#15364</a></li>
<li>Properly pad struct tx_cpu to cache line <a data-error-text="Failed to load title" data-id="1942909972" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15402" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15402/hovercard" href="https://github.com/openzfs/zfs/pull/15402">#15402</a></li>
<li>Fix typo in  tests/zfs-tests/tests/functional/cli_user/misc/misc.cfg <a data-error-text="Failed to load title" data-id="1950277709" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15417" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15417/hovercard" href="https://github.com/openzfs/zfs/pull/15417">#15417</a></li>
<li>FreeBSD: taskq: Remove unused declaration <a data-error-text="Failed to load title" data-id="1950008652" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15416" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15416/hovercard" href="https://github.com/openzfs/zfs/pull/15416">#15416</a></li>
<li>Set spa_ccw_fail_time=0 when expanding a vdev. <a data-error-text="Failed to load title" data-id="1943574455" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15405" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15405/hovercard" href="https://github.com/openzfs/zfs/pull/15405">#15405</a></li>
<li>Fix ZED auto-replace for VDEVs using by-id paths <a data-error-text="Failed to load title" data-id="1929450959" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15363" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15363/hovercard" href="https://github.com/openzfs/zfs/pull/15363">#15363</a></li>
<li>Add zfs_prepare_disk script for disk firmware install <a data-error-text="Failed to load title" data-id="1884851583" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15243" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15243/hovercard" href="https://github.com/openzfs/zfs/pull/15243">#15243</a></li>
<li>Large sync writes perform worse with slog <a data-error-text="Failed to load title" data-id="1529657288" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/14378" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/14378/hovercard" href="https://github.com/openzfs/zfs/pull/14378">#14378</a></li>
<li>FreeBSD: Improve taskq wrapper <a data-error-text="Failed to load title" data-id="1927295198" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15356" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15356/hovercard" href="https://github.com/openzfs/zfs/pull/15356">#15356</a></li>
<li>Fix block cloning between unencrypted and encrypted datasets <a data-error-text="Failed to load title" data-id="1968211163" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15464" data-hovercard-type="issue" data-hovercard-url="/openzfs/zfs/issues/15464/hovercard" href="https://github.com/openzfs/zfs/issues/15464">#15464</a> <a data-error-text="Failed to load title" data-id="1968492674" data-permission-text="Title is private" data-url="https://github.com/openzfs/zfs/issues/15465" data-hovercard-type="pull_request" data-hovercard-url="/openzfs/zfs/pull/15465/hovercard" href="https://github.com/openzfs/zfs/pull/15465">#15465</a></li>
</ul></div></div>
  </body>
</html>
