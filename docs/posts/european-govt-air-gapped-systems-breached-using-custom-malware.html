<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.welivesecurity.com/en/eset-research/mind-air-gap-goldenjackal-gooses-government-guardrails/">Original</a>
    <h1>European govt air-gapped systems breached using custom malware</h1>
    
    <div id="readability-page-1" class="page"><div>
    <p>ESET researchers discovered a series of attacks on a governmental organization in Europe using tools capable of targeting air-gapped systems. The campaign, which we attribute to GoldenJackal, a cyberespionage APT group that targets government and diplomatic entities, took place from May 2022 to March 2024. By analyzing the toolset deployed by the group, we were able to identify an attack GoldenJackal carried out earlier, in 2019, against a South Asian embassy in Belarus that, yet again, targeted the embassy’s air-gapped systems with custom tools.</p>
<p>This blogpost introduces previously undocumented tools that we attribute to GoldenJackal based on victimology, code, and functional similarities between the toolsets.</p>
<blockquote>
<p><strong>Key points of the blogpost:</strong></p>
<ul>
<li>GoldenJackal used a custom toolset to target air-gapped systems at a South Asian embassy in Belarus since at least August 2019. In this blogpost, we describe these tools publicly for the first time.</li>
<li>This blogpost also features the first public description of a highly modular toolset GoldenJackal deployed in Europe on various occasions between May 2022 and March 2024 against a European Union government organization.</li>
<li>These toolsets provide GoldenJackal a wide set of capabilities for compromising and persisting in targeted networks. Victimized systems are abused to collect interesting information, process the information, exfiltrate files, and distribute files, configurations and commands to other systems.</li>
<li>The ultimate goal of GoldenJackal seems to be stealing confidential information, especially from high-profile machines that might not be connected to the internet.</li>
</ul>
</blockquote>
<h2>GoldenJackal profile</h2>
<p>GoldenJackal is an APT group active since at least 2019. It targets government and diplomatic entities in Europe, the Middle East, and South Asia. The group is little known and has only been publicly described in 2023 by <a href="https://securelist.com/goldenjackal-apt-group/109677/" target="_blank" rel="noopener">Kaspersky</a>. The group’s known toolset includes several implants written in C#: JackalControl, JackalSteal, JackalWorm, JackalPerInfo, and JackalScreenWatcher – all of them used for espionage.</p>
<h2>Overview</h2>
<p>In May 2022, we discovered a toolset that we could not attribute to any APT group. But once the attackers used a tool similar to one of those publicly documented by Kaspersky, we were able to dig deeper and to find a connection between the publicly documented toolset of GoldenJackal and this new one.</p>
<p>Extrapolating from that, we managed to identify an earlier attack where the publicly documented toolset was deployed, as well as an older toolset that also has capabilities to target air-gapped systems. This blogpost shines a light on the technical aspects of the publicly undocumented toolsets, and shares some insights about GoldenJackal’s tactics, techniques, and procedures.</p>
<h3>Victimology</h3>
<p>GoldenJackal has been targeting governmental entities in Europe, the Middle East, and South Asia. We detected GoldenJackal tools at a South Asian embassy in Belarus in August and September 2019, and again in July 2021.</p>
<p><a href="https://securelist.com/goldenjackal-apt-group/109677/#victims" target="_blank" rel="noopener">Kaspersky reported</a> a limited number of attacks against government and diplomatic entities in the Middle East and South Asia, starting in 2020.</p>
<p>More recently, according to ESET telemetry, a European Union governmental organization was repeatedly targeted from May 2022 until March 2024.</p>
<h3>Attribution</h3>
<p>All the campaigns that we describe in this blogpost deployed, at some point, at least one of the tools attributed to the GoldenJackal APT group <a href="https://securelist.com/goldenjackal-apt-group/109677/" target="_blank" rel="noopener">by Kaspersky</a>. As was the case in the Kaspersky report, we can’t attribute GoldenJackal’s activities to any specific nation-state. There is, however, one clue that might point towards the origin of the attacks: in the GoldenHowl malware, the C&amp;C protocol is referred to as <span>transport_http</span>, which is an expression typically used by Turla (see our <a href="https://web-assets.esetstatic.com/wls/2020/05/ESET_Turla_ComRAT.pdf" target="_blank" rel="noopener">ComRat v4 report</a>) and <a href="https://www.welivesecurity.com/en/eset-research/moustachedbouncer-espionage-against-foreign-diplomats-in-belarus/" target="_blank" rel="noopener">MoustachedBouncer</a>. This may indicate that the developers of GoldenHowl are Russian speakers.</p>
<h3><a name="_Toc178267626"></a>Breaching air-gapped systems</h3>
<p>In order to minimize the risk of compromise, highly sensitive networks are often air gapped, i.e., isolated from other networks. Usually, organizations will air gap their most valuable systems, such as voting systems and industrial control systems running power grids. These are often precisely the networks that are of most interest to attackers.</p>
<p>As we stated in a previous white paper titled <a href="https://web-assets.esetstatic.com/wls/2021/12/eset_jumping_the_air_gap_wp.pdf" target="_blank" rel="noopener">Jumping the air gap: 15 years of nation-state effort</a>, compromising an air-gapped network is much more resource-intensive than breaching an internet-connected system, which means that frameworks designed to attack air-gapped networks have so far been exclusively developed by APT groups. The purpose of such attacks is always espionage, perhaps with <a href="https://web-assets.esetstatic.com/wls/2012/11/Stuxnet_Under_the_Microscope.pdf" target="_blank" rel="noopener">a side of sabotage</a>.</p>
<p>With the level of sophistication required, it is quite unusual that in five years, GoldenJackal managed to build and deploy not one, but two separate toolsets designed to compromise air-gapped systems. This speaks to the resourcefulness of the group. The attacks against a South Asian embassy in Belarus made use of custom tools that we have only seen in that specific instance. The campaign used three main components: GoldenDealer to deliver executables to the air-gapped system via USB monitoring; GoldenHowl, a modular backdoor with various functionalities; and GoldenRobo, a file collector and exfiltrator.</p>
<p>In the latest series of attacks against a government organization in Europe, GoldenJackal moved on from the original toolset to a new, highly modular one. This modular approach applied not only to the design of the malicious tools (as was the case with GoldenHowl), but also to their roles: they were used, among other things, to collect and process interesting information, to distribute files, configurations, and commands to other systems, and to exfiltrate files.</p>
<h2>Technical analysis</h2>
<h3>Initial access</h3>
<p>So far, we haven’t been able to trace back to the initial compromise vector in the campaigns seen in our telemetry. Note that Kaspersky reported in a <a href="https://securelist.com/goldenjackal-apt-group/109677/" target="_blank" rel="noopener">blogpost</a> that GoldenJackal used trojanized software and malicious documents for this purpose.</p>
<h3>The mysterious toolset from 2019</h3>
<p>The earliest attack that we have attributed to GoldenJackal, which targeted a South Asian embassy in Belarus, occurred in August 2019. The toolset used in this attack is, to the best of our knowledge, publicly undocumented. We’ve only observed the following custom tools once, and never again:</p>
<ul>
<li>A malicious component that can deliver executables to air-gapped systems via USB drives. We’ve named this component GoldenDealer.</li>
<li>A backdoor, which we’ve named GoldenHowl, with various modules for malicious capabilities.</li>
<li>A malicious file collector and exfiltrator, which we’ve named GoldenRobo.</li>
</ul>
<p>An overview of the attack is shown in Figure 1. The initial attack vector is unknown, so we assume that GoldenDealer and an unknown worm component are already present on a compromised PC that has access to the internet. Whenever a USB drive is inserted, the unknown component copies itself and the GoldenDealer component to the drive. While we didn’t observe this unknown component, we have seen components with similar purposes – such as <a href="https://securelist.com/goldenjackal-apt-group/109677/#jackalworm" target="_blank" rel="noopener">JackalWorm</a> – in other toolsets used in later attacks performed by the group.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-1.png" alt="" width="1327" height="2000"/>
<figcaption><em>Figure 1. Overview of the initial compromise of an air-gapped system</em></figcaption>
</figure>
<p>It is probable that this unknown component finds the last modified directory on the USB drive, hides it, and renames itself with the name of this directory, which is done by JackalWorm. We also believe that the component uses a folder icon, to entice the user to run it when the USB drive is inserted in an air-gapped system, which again is done by JackalWorm.</p>
<p>When the drive is again inserted into the internet-connected PC, GoldenDealer takes the information about the air-gapped PC from the USB drive and sends it to the C&amp;C server. The server replies with one or more executables to be run on the air-gapped PC. Finally, when the drive is again inserted into the air-gapped PC, GoldenDealer takes the executables from the drive and runs them. Note that this time no user interaction is needed, because GoldenDealer is already running.</p>
<p>We have observed GoldenDealer running GoldenHowl on an internet-connected PC. While we didn’t observe GoldenDealer directly executing GoldenRobo, we observed the latter also running on the connected PC, used to take files from the USB drive and exfiltrate them to its C&amp;C server. There must be yet another unknown component that copies files from the air-gapped PC to the USB drive, but we haven’t observed it yet.</p>
<h4>GoldenDealer</h4>
<p>This component monitors the insertion of removable drives on both air-gapped and connected PCs, as well as internet connectivity. Based on the latter, it can download executable files from a C&amp;C server and hide them on removable drives, or retrieve them from these drives and execute them on systems that have no connectivity.</p>
<p>The program can be run with or without arguments. When run with arguments, it takes a path to a file that it moves to a new location and then runs via the <span>CreateProcessW</span> API without creating a window.</p>
<p>To prevent hidden files being shown in Windows Explorer, GoldenDealer creates the <span>ShowSuperHidden</span> value in the <span>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced</span> registry key, and sets it to zero.</p>
<p>In case GoldenDealer is not running as a service, it creates and starts a service called <span>NetDnsActivatorSharing</span>, then exits. If for any reason the service couldn’t be created, persistence is achieved by creating an entry in a <span>Run</span> registry key.</p>
<p>Table 1 shows the list of configuration files used by GoldenDealer. These are located in the directory from which the malware is running: <span>C:\Windows\TAPI</span> in the observed attack. More details about these files is provided in subsequent sections.</p>
<blockquote>
<p>Table 1. Configuration files used by GoldenDealer</p>
</blockquote>
<table>
<thead>
<tr>
<td><strong>Filename</strong> </td>
<td><strong>Purpose</strong> </td>
</tr>
</thead>
<tbody>
<tr>
<td><span>b8b9-de4d-3b06-9d44</span> </td>
<td>Store status fields. </td>
</tr>
<tr>
<td><span>fb43-138c-2eb0-c651</span> </td>
<td>Store executable files sent by the C&amp;C server. </td>
</tr>
<tr>
<td><span>130d-1154-30ce-be1e</span> </td>
<td>Store information about all compromised PCs in the network. </td>
</tr>
<tr>
<td><span>38c4-abb9-74f5-c4e5</span> </td>
<td>Used as a mutex. If this file is open, it means that an instance of GoldenDealer is already running. </td>
</tr>
</tbody>
</table>
<p>The contents of configuration files are JSON formatted, and stored XOR encrypted on disk. XOR encryption is performed one byte at a time, with a single-byte key that is incremented based on a multiplier.</p>
<h5>Network connectivity thread</h5>
<p>In order to determine whether a PC is connected to the internet, GoldenDealer sends a GET request to <span>https://1.1.1.1/&lt;user_id&gt;</span> every 15 minutes. If the connection fails, or there’s no reply, the PC is assumed to be offline. <span>1.1.1.1</span> maps to Cloudflare’s DNS resolver, and the expected behavior is to receive a <span>Not Found</span> document and a <span>404</span> status code. The <span>&lt;user_id&gt;</span> part is not relevant here, but is used for C&amp;C communication. GoldenDealer generates this user identifier based on:</p>
<ul>
<li>The current username as found via the <span>GetUserNameW</span> API.</li>
<li>The serial number of the first available logical drive in the system. This does not necessarily mean the drive where the OS is installed.</li>
</ul>
<p>These two strings are separately hashed with the <a href="https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function" target="_blank" rel="noopener">FNV-1a</a> function, and the resulting numbers are XORed together, obtaining a number that identifies the user.</p>
<p>To keep track of network connectivity status, GoldenDealer uses a global variable that can hold any of the following values:</p>
<ul>
<li><span>0</span> – Malware started running and connectivity has not been checked.</li>
<li><span>1</span> – PC doesn’t have internet connectivity.</li>
<li><span>2</span> – PC has internet connectivity.</li>
</ul>
<p>If the status is <span>2</span>, a thread is signaled to download executable files from the C&amp;C server, and another thread is signaled to copy the executables to USB drives. A thread to get executables from drives and run them will only be signaled when the status is <span>1</span>. Whenever the status changes, the configuration file <span>b8b9-de4d-3b06-9d44</span> is updated with the new value. Fields in this file are:</p>
<ul>
<li><span>wmk</span> – network connectivity status.</li>
<li><span>qotwnk</span> – number of seconds without internet. This value is incremented every 15 minutes and reset to zero when there’s connectivity. It can be used if the malware is configured to wait a minimum number of seconds before deciding that the PC has no connectivity, but there was no wait in the samples that we observed.</li>
<li><span>ltwnk</span> – unknown. This field is not used by the malware.</li>
<li><span>rpk</span> – list with hashes of executables downloaded from the C&amp;C server.</li>
</ul>
<h5><a name="_User_identifier"></a>Downloader thread</h5>
<p>This thread checks the network connectivity status every 30 minutes, and only performs the following actions if the PC is connected to the internet. First, a GET request is sent to <span>https://83.24.9[.]124/&lt;user_id&gt;</span>, just to let the C&amp;C server know that another request is to follow. The reply from the server is not processed. If the request fails, then another request is sent to a secondary server, <span>http://196.29.32[.]210/&lt;user_id&gt;</span>, probably to notify about failure, as the thread doesn’t continue to execute in this case. The URLs are hardcoded in the malware and are not configurable in the samples that we observed.</p>
<p>When communication is successful, GoldenDealer sends a request to <span>https://83.24.9[.]124/&lt;user_id&gt;/fc93-10f4-2a68-d548</span>. The server replies with an array of JSON objects with the following fields:</p>
<ul>
<li><span>ek</span> – a base64-encoded string that is an executable file after being decoded,</li>
<li><span>tpik</span> – an array of <span>user_ids</span> used to decide whether the executable will be run,</li>
<li><span>hek</span> – the FNV-1a hash of <span>ek</span>, and</li>
<li><span>apk</span> – date and time when the executable was obtained from the C&amp;C server.</li>
</ul>
<p>The contents of the last two fields are not relevant, because they are calculated by the downloader thread, replacing original data sent by the C&amp;C server. In both cases, they are stored as decimal numbers.</p>
<p>GoldenDealer will run an executable sent by the server if the corresponding <span>user_id</span> is in the <span>tpik</span> list, and the <span>hek</span> hash is not in the list of hashes stored in the <span>rpk</span> field in the configuration. In other words, connected PCs can download executables and pass them along to other systems via USB drives, but they can also run received executables. When an executable is run, its hash is added to the <span>rpk</span> list, ensuring that it will only be executed once by that victim. Each executable is written in the working directory with the value of <span>&lt;hek&gt;</span> as its filename. All JSON objects with received executables are stored on disk, in the file <span>fb43-138c-2eb0-c651</span>.</p>
<p>As the final step, the downloader thread collects information about the compromised system and sends it to <span>https://83.24.9[.]124/&lt;user_id&gt;/a1e7-4228-df20-1600</span>. The configuration file <span>130d-1154-30ce-be1e</span> is updated to store this information as well. Figure 2 shows part of the JSON object with the information sent to the C&amp;C server. While all strings are sent as arrays of decimal character codes, for readability we show them as strings in the image. For example, instead of <span>lsass.exe</span>, the value <span>[108, 115, 97, 115, 115, 46, 101, 120, 101]</span> is actually sent.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-2.png" alt="" width="934" height="909"/>
<figcaption><em>Figure 2. Part of the information sent by the downloader thread to the C&amp;C server</em></figcaption>
</figure>
<p>The members are:</p>
<ul>
<li><span>iepk</span> – a Boolean value that indicates whether the GoldenDealer process is elevated,</li>
<li><span>pclk</span> – an array of running processes,</li>
<li><span>pglk</span> – an array of installed programs in both <span>Program Files</span> and <span>Program Files (x86)</span> directories,</li>
<li><span>pik</span> – the <span>user_id</span>,</li>
<li><span>sik</span> – information about the operating system (including version, build, service pack number; architecture; and Boolean values indicating whether the OS is running on a server, domain controller, or workstation),</li>
<li><span>uck</span> – the user who is running the GoldenDealer process, and</li>
<li><span>ulk</span> – an array of all users, each with a Boolean value indicating whether the user has administrator privileges.</li>
</ul>
<h5>USB monitoring thread on connected PCs</h5>
<p>GoldenDealer monitors the insertion of removable drives by creating a window titled <span>defaultWindow</span> with a custom event handler that processes inserted devices and ignores all other system events.</p>
<p>Once a USB drive has been inserted, this thread patches one byte in the master boot record (MBR) of that drive: it searches for the offset where the <span>BOOTMGR</span> string resides, and replaces the first <span>O</span> with <span>0</span>. Then it checks whether the second <span>O</span> has also been patched to <span>0</span>, and exits if it hasn’t. The USB thread that runs on air-gapped PCs does the opposite: it patches the second <span>O</span>, and checks whether the first has already been patched. This means that the USB drive needs to have been inserted in both a connected PC and an air-gapped PC for the drive to be processed.</p>
<p>If the check is successful, a hidden directory is created on the USB drive, with two files written inside:</p>
<ul>
<li><span>37b3-ebe5-568e-0676</span> – this file has the same contents as <span>fb43-138c-2eb0-c651</span> (all the executables sent by the C&amp;C server). It’s used to pass the executables to air-gapped systems, for execution.</li>
<li><span>bc41-ac6f-e55e-61a8</span> – a file with information from air-gapped PCs. It’s created empty by this thread, then populated by the USB thread running on air-gapped PCs. The contents of this file are appended to the local file <span>130d-1154-30ce-be1e</span> (see Table 1), to be sent to the C&amp;C server by the downloader thread.</li>
</ul>
<h5>USB monitoring thread on air-gapped PCs</h5>
<p>This is complementary to the thread described in the previous section: it takes the file <span>37b3-ebe5-568e-0676</span> with executables on the USB drive and copies its contents to the local file <span>fb43-138c-2eb0-c651</span>. It also takes the local file <span>130d-1154-30ce-be1e</span> with information about the air-gapped system and adds its contents to the <span>bc41-ac6f-e55e-61a8</span> file on the USB drive. The code to obtain system information and to run executables is contained in this thread.</p>
<h4>GoldenHowl</h4>
<p>Another tool from GoldenJackal’s 2019 toolset is GoldenHowl, a backdoor written in Python that consists of various modules for malicious functionalities. It is distributed as a self-extracting archive that contains legitimate Python binaries and libraries, as well as malicious scripts. Figure 3 shows the contents of one of these archives. The attackers renamed the Python executable – in version 2.7.15 – as <span>WinAeroModule.exe</span>. This component is intended to be run on PCs with internet connectivity, given its functionalities.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-3.png" alt="" width="1081" height="1155"/>
<figcaption><em>Figure 3. Contents of GoldenHowl’s self-extracting archive</em></figcaption>
</figure>
<p>The initial script in GoldenHowl, referred to as <span>core_script</span> in the malware’s configuration file, performs the following actions:</p>
<ul>
<li>decrypts and loads the malware’s configuration from a JSON file,</li>
<li>creates directories used by the malware, and</li>
<li>starts a thread for each module.</li>
</ul>
<p>The malware’s configuration is decrypted using the <a href="https://cryptography.io/en/latest/fernet/" target="_blank" rel="noopener">Fernet</a> algorithm, with the hardcoded key <span>_ylmUTbqcx6FxMZ5ZvNxDQZYuNh41yxhKcPJLzxgqEY=</span>. Figure 4 shows part of the decrypted configuration.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-4.png" alt="" width="948" height="940"/>
<figcaption><em>Figure 4. Part of GoldenHowl’s decrypted configuration</em></figcaption>
</figure>
<p>Table 2 shows the Python modules that we’ve observed – in the order that they appear in the config – along with a description of their functionalities. All modules run indefinitely, except for the <span>persistence_schtasks</span> module, which runs only once.</p>
<blockquote>
<p>Table 2. Malicious modules in GoldenHowl</p>
</blockquote>
<table>
<thead>
<tr>
<td><strong>Module name</strong> </td>
<td><strong>File on disk</strong> </td>
<td><strong>Description</strong> </td>
</tr>
</thead>
<tbody>
<tr>
<td><span>persistence_schtasks</span> </td>
<td><span>5991-8d44-b226⁠-⁠0e6c.py</span> </td>
<td>Creates the scheduled task <span>Microsoft\Windows\Multimedia\SystemSoundsService2</span> to persist the execution of core_script. </td>
</tr>
<tr>
<td><span>files_tree</span> </td>
<td><span>edc5-4055-37cd-d2d2.py</span> </td>
<td>Generates a listing of files and directories by calling Windows’ tree command, for a path specified in a request sent by the C&amp;C. </td>
</tr>
<tr>
<td><span>files_stealer</span> </td>
<td><span>5488-240b-c00f-203a.py</span> </td>
<td>Exfiltrates a single file to the C&amp;C server. The file path is specified in a request sent by the C&amp;C. </td>
</tr>
<tr>
<td><span>data_transform</span> </td>
<td><span>8744-a287-35be-4ea0.py</span> </td>
<td>Utility module that takes incoming requests from the C&amp;C server and decrypts them, and takes responses from other modules that need to be sent to the C&amp;C and encrypts them. The encryption algorithm is Fernet, and the key is specific to this module: <span>QRqXhd_iB_Y3LpT2wTVK6Dao5uOq2m5KMiVkMnJfgw4=</span> </td>
</tr>
<tr>
<td><span>transport_http</span> </td>
<td><span>63d5-be5f-e4df-7e65.py</span> </td>
<td>Utility module that uploads and downloads files from the C&amp;C server. See the <em><a href="#C&amp;C communication">C&amp;C communication</a></em> section for more information. Note that the word transport is commonly used by <a href="https://web-assets.esetstatic.com/wls/2020/05/ESET_Turla_ComRAT.pdf">Turla </a>and <a href="https://www.welivesecurity.com/en/eset-research/moustachedbouncer-espionage-against-foreign-diplomats-in-belarus/">MoustachedBouncer</a> to refer to a type of C&amp;C protocol. Although this might be shared across Russian-speaking developers, this is a low confidence element for attribution. </td>
</tr>
<tr>
<td><span>updater</span> </td>
<td><span>c7b4-0999-aec4-a0c8.py</span> </td>
<td>Utility module that receives a ZIP archive with updated modules or configuration from the C&amp;C server, extracts the archive, and runs <span>core_script</span> in a new process, terminating the current process. </td>
</tr>
<tr>
<td><span>sshcmd</span> </td>
<td><span>1ee0-7c3a-3331-4df3.py</span> </td>
<td>Connects to an SSH server specified in a request sent by the C&amp;C. Acts as a reverse shell, executing commands received from the C&amp;C. </td>
</tr>
<tr>
<td><span>ipscanner</span> </td>
<td><span>a86b-108c-36c7-6972.py</span> </td>
<td>Generates a listing with active IP addresses in an IP range, based on an IP mask specified in a request sent by the C&amp;C server. To do so, it first sends a message to all IP addresses in the range, on port <span>59173</span>, and then it runs the command <span>arp -a</span> to obtain the ARP cache tables for all interfaces. </td>
</tr>
<tr>
<td><span>portscanner</span> </td>
<td><span>2648-69f9-6dc0-3476.py</span> </td>
<td>Generates a listing with ports that are accepting connections, based on an IP address and a list of ports specified in a request sent by the C&amp;C server. </td>
</tr>
<tr>
<td><span>sshtunnel</span> </td>
<td><span>9ea4-fb87-6d57-924a.py</span> </td>
<td>Creates an SSH tunnel with an SSH server, to forward messages going from (and to) a host on a listening port, to a forwarding port on the SSH server. A request from the C&amp;C server specifies: the address and port of the SSH server, username and password for the SSH session, the forwarding port on the SSH server, and the address and port of the listening host. </td>
</tr>
<tr>
<td><span>eternalbluechecker</span> </td>
<td><span>4b19-7f72-8c17-dceb.py</span> </td>
<td>Checks whether a host, specified in a request sent by the C&amp;C server, is vulnerable to a Windows SMB remote code execution vulnerability. The code for this module is the same as in <span>mysmb.py</span> and <span>checker.py</span> from <a href="https://github.com/worawit/MS17-010/" target="_blank" rel="noopener">this public repository</a>. There is no code in this module to exploit vulnerable hosts. </td>
</tr>
<tr>
<td><span>socks_proxy</span> </td>
<td><span>8b55-3ac9-5c30-d0c4.py</span> </td>
<td>Acts as a proxy server, forwarding packets from a source address to a destination address. The port to listen for incoming connections is specified in a request sent by the C&amp;C server. The code in this module is very similar to that of <a href="https://github.com/MisterDaneel/pysoxy/" target="_blank" rel="noopener">pysoxy</a>. </td>
</tr>
<tr>
<td><span>text_writer</span> </td>
<td><span>0ffc-667e-dce4-b270.py</span> </td>
<td>Writes a text file to a given path. The path and text for writing are specified in a request sent by the C&amp;C server. </td>
</tr>
</tbody>
</table>
<h4>C&amp;C communication<a id="C&amp;C communication"></a></h4>
<p>According to GoldenHowl’s configuration, anything that comes from the C&amp;C server is called a request, and files going to the C&amp;C server represent a response. It should be noted that despite this naming convention, GoldenHowl is not a passive implant: it initiates the connections to the C&amp;C server. The <span>transport_http</span> module is responsible for communication with the C&amp;C server, and for writing requests and responses to specific directories. Table 3 shows directories used by GoldenHowl.</p>
<blockquote>
<p>Table 3. Directories in GoldenHowl’s configuration</p>
</blockquote>
<table>
<thead>
<tr>
<td><strong>Name in configuration</strong> </td>
<td><strong>Name on disk</strong> </td>
<td><strong>Description</strong> </td>
</tr>
</thead>
<tbody>
<tr>
<td><span><span>download_dir</span></span> </td>
<td><span><span>a700‑280c‑f067‑5a06</span></span> </td>
<td>Stores encrypted requests coming from the C&amp;C server. </td>
</tr>
<tr>
<td><span><span>upload_dir</span></span> </td>
<td><span><span>b307‑05ea‑7ac8‑c369</span></span> </td>
<td>Stores encrypted responses, with files or output of commands, to be sent to the C&amp;C server. </td>
</tr>
<tr>
<td><span><span>data_dir</span></span> </td>
<td><span><span>cda2‑b818‑3403‑b564</span></span> </td>
<td>Stores requests sent by the C&amp;C server, which are taken from <span><span>download_dir</span></span>, decrypted, and placed in this directory for modules to process. Also stores output of executed commands (responses), which are taken from this directory, encrypted, and written to <span><span>upload_dir</span></span>. These actions are performed by the <span><span>data_transform</span></span> module. </td>
</tr>
<tr>
<td><span><span>temp_dir</span></span> </td>
<td><span><span>5bc5‑0788‑d469‑2f3a</span></span> </td>
<td>This directory was not used in any observed modules. </td>
</tr>
</tbody>
</table>
<p>Requests and responses have structured filenames:</p>
<ul>
<li>Request – <span>&lt;client_id&gt;&lt;module_id&gt;&lt;request_id&gt;&lt;request_suffix&gt;</span></li>
<li>Response – <span>&lt;client_id&gt;&lt;module_id&gt;&lt;request_id&gt;&lt;response_suffix&gt;</span></li>
</ul>
<p>The fields <span>client_id</span>, <span>request_suffix</span>, and <span>response_suffix</span> are specified in the configuration and are common to all modules (see Figure 4 for examples). The field <span>module_id</span> indicates which module needs to process a request or generate a response, and is defined in the configuration section of each individual module. The field request_id is generated on the C&amp;C server, and ties together requests with responses.</p>
<p>The <span>transport_http</span> module sends GET requests periodically to the C&amp;C server to check for available requests. The configuration fields specific to this module are:</p>
<ul>
<li><span>server_address</span> – address of the C&amp;C server (we observed <span>83.24.9[.]124</span>, the same address as GoldenDealer’s server),</li>
<li><span>server_port</span> – the port used to communicate with the server (we observed 443),</li>
<li><span>server_use_ssl</span> – indicates whether HTTP or HTTPS will be used for communication,</li>
<li><span>base_timeout_sec</span> – the minimum wait time before contacting the C&amp;C server, and</li>
<li><span>timeout_filename</span> – the filename of a text file with a number between 0 and 3600, to specify a different number of seconds to wait between communications. This file is not included with GoldenHowl, but it could be placed by the attackers with the <span>text_writer</span> module.</li>
</ul>
<p>The address used to contact the C&amp;C server is <span>https://&lt;server_address&gt;:&lt;server_port&gt;/&lt;client_id&gt;/</span>.</p>
<h4>GoldenRobo</h4>
<p>The last of the observed tools from the 2019 toolset, GoldenRobo, is a simple component written in Go that executes the <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy" target="_blank" rel="noopener">Robocopy</a> utility to stage files and send them to its C&amp;C server. It iterates across all drive letters from A to Z, trying to access each drive. If successful, a Robocopy command is constructed:</p>
<p><span>robocopy &lt;drive_letter&gt;:\ &lt;malware_folder&gt;\1516-fe89-ad12-8102\&lt;drive_letter&gt;\ *.doc *.docx *.xls *.xlsx *.ppt *.pptx *.pdf *.rtf *.tif *.jpg *.jpeg *.crt *.key *.p12 *.ovpn *.zip *.rar &#34;&#34; /S /R:0 /MAXAGE:7 /XD &lt;malware_folder&gt;\1516-fe89-ad12-8102\\ 1516-fe89-ad12-8102\\ &#34;Application Data&#34; &#34;All Users&#34; &#34;Documents and Settings&#34; &#34;Local Settings&#34;</span></p>
<p>If we break down the command:</p>
<ul>
<li>files are copied from <span>drive_letter</span>,</li>
<li>to <span>&lt;malware_folder&gt;\1516-fe89-ad12-8102\&lt;drive_letter&gt;\</span> (for example: <span>C:\Windows\TAPI\1516-fe89-ad12-8102\C\</span>),</li>
<li>only if the files have extensions <span>.doc</span>, <span>.docx</span>, <span>.xls</span>, <span>.xlsx</span>, <span>.ppt</span>, <span>.pptx</span>, <span>.pdf</span>, <span>.rtf</span>, <span>.tif</span>, <span>.jpg</span>, <span>.jpeg</span>, <span>.crt</span>, <span>.key</span>, <span>.p12</span>, <span>.ovpn</span>, <span>.zip</span>, or<span> .rar</span>,</li>
<li>including subdirectories (<span>/S</span>),</li>
<li>not retrying on failed copies (<span>/R:0</span>),</li>
<li>excluding files older than seven days (<span>/MAXAGE:7</span>), and</li>
<li>excluding specified directories (<span>/XD</span>).</li>
</ul>
<p>Copied files from all drives are archived together in a ZIP file <span>_1423-da77-fe86&lt;month&gt;-&lt;day&gt;</span> in the same directory where GoldenRobo is running (with <span>&lt;month&gt;</span> and <span>&lt;day&gt;</span> corresponding to the current date).</p>
<p>The archive is sent base64 encoded to <span>https://83.24.9[.]124/8102/</span>. The last part of the URL is <span>8102</span>, which is the same as the <span>client_id</span> field in GoldenHowl’s configuration. This URL is hardcoded in GoldenRobo, which tells us that the attackers compiled this version of GoldenRobo for this victim exclusively.</p>
<h3>The known toolset: Previously documented by Kaspersky</h3>
<p>A few weeks after deploying the previous toolset, GoldenJackal started to use other malicious tools on the same compromised computers. In September 2019, we observed the execution of PowerShell scripts to download the <a href="https://securelist.com/goldenjackal-apt-group/109677/#jackalcontrol" target="_blank" rel="noopener">JackalControl</a> backdoor. This backdoor was used to execute other PowerShell scripts, to download and run legitimate tools such as <a href="https://the.earth.li/~sgtatham/putty/0.58/htmldoc/Chapter7.html" target="_blank" rel="noopener">Plink</a> and <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank" rel="noopener">PsExec</a>.</p>
<p>In various attacks, between September 2019 and January 2024, we observed the following tools in GoldenJackal’s arsenal:</p>
<ul>
<li>JackalControl,</li>
<li>JackalSteal, a file collector and exfiltrator, and</li>
<li>JackalWorm, used to propagate other malicious components via USB drives. We observed it propagating the JackalControl backdoor.</li>
</ul>
<p>As these components have already been documented by <a href="https://securelist.com/goldenjackal-apt-group/109677/">Kaspersky</a>, we will not describe them in this blogpost. However, one interesting point to mention is that in early versions of these tools, URLs for C&amp;C servers were hardcoded in the malware binaries. At some point, GoldenJackal modified JackalControl and JackalSteal to receive C&amp;C servers as arguments.</p>
<h3>The latest toolset: Keeping a foothold in the network</h3>
<p>In May 2022, we observed GoldenJackal using a new toolset while targeting a governmental organization in Europe. Most of these tools are written in Go and provide diverse capabilities, such as collecting files from USB drives, spreading payloads in the network via USB drives, exfiltrating files, and using some PCs in the network as servers to deliver diverse files to other systems. In addition, we have seen the attackers using <a href="https://github.com/fortra/impacket">Impacket</a> to move laterally across the network.</p>
<p>In the observed attacks, GoldenJackal started to use a highly modular approach, using various components to perform different tasks. Some hosts were abused to exfiltrate files, others were used as local servers to receive and distribute staged files or configuration files, and others were deemed interesting for file collection, for espionage purposes. Figure 5 shows a classification of the components that are described over the next sections.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-5.png" alt="" width="1500" height="1500"/>
<figcaption><em>Figure 5. Components in GoldenJackal’s latest toolset</em></figcaption>
</figure>
<p>Regarding network infrastructure, we didn’t observe any external IP addresses in any of the analyzed components. File exfiltrators use publicly available services such as Google Drive or Outlook SMTP servers.</p>
<h4>GoldenUsbCopy</h4>
<p>GoldenUsbCopy, which we classify as a collection component, monitors the insertion of USB drives, and copies interesting files to an encrypted container that is stored on disk, to be exfiltrated by other components. According to strings found in the binary, the main package for the application is named <span>UsbCopy</span>.</p>
<p>Newly inserted drives are detected by creating a window with name <span>WindowsUpdateManager</span>, to receive system events and process them with a custom handler. If the handler receives a <span>WM_DEVICECHANGE</span> message, with an event type <span>DBT_DEVICEARRIVAL</span>, and the device type is <span>DBT_DEVTYP_VOLUME</span>, this means a new drive is ready to be processed. Figure 6 shows a side-by-side comparison between decompiled code in GoldenUsbCopy and GoldenDealer. Even though each was written in a different programming language, we can see that the code retrieves the letter of the drive to process in the same manner.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-6.png" alt="" width="1628" height="655"/>
<figcaption><em>Figure 6. Code comparison between GoldenUsbCopy and GoldenDealer</em></figcaption>
</figure>
<p>GoldenUsbCopy determines which files to process from a USB drive based on a configuration that is stored AES encrypted in CFB mode in the file <span>reports.ini</span>. The 32-byte key to decrypt the configuration is hardcoded in the malware. After decryption, the configuration contains the following fields, in JSON format:</p>
<ul>
<li><span>outputCipherFilename</span> – full path to an encrypted archive that acts as a container for other files, such as files that contain listings of filenames from newly inserted drives, and files to be exfiltrated,</li>
<li><span>RSAKey</span> – a public key to encrypt AES keys that are used to encrypt files to be exfiltrated,</li>
<li><span>lastDate</span> – files that were last modified more than <span>lastDate</span> days ago are not processed,</li>
<li><span>registryKey</span> – a key in <span>HKEY_CURRENT_USER</span> that will store SHA-256 hashes of files already processed for exfiltration,</li>
<li><span>registryValue</span> – the registry value that stores the list of hashes,</li>
<li><span>maxZIPSize</span> – the maximum size in bytes for <span>outputCipherFilename</span> (more details below),</li>
<li><span>maxFileSize</span> – files larger than <span>maxFileSize</span>, in bytes, are not exfiltrated, and</li>
<li><span>extensionsFile</span> – a list of file extensions for exfiltration (we observed <span>.docx</span>, <span>.pdf</span>, <span>.doc</span>, and <span>.odt</span>).</li>
</ul>
<p>Once the configuration is decrypted, GoldenUsbCopy waits for a USB drive to be inserted. A listing of all files on the inserted drive is written to a text file, which is then archived in a ZIP file, encrypted with AES, and added to <span>outputCipherFilename</span>. Only the encrypted container is written to disk; intermediate steps, involving text files and archives, are kept in memory.</p>
<p>A similar procedure is done for files on the drive that meet the criteria for exfiltration: these files are archived together preserving their directory structure, encrypted with AES, and added to <span>outputCipherFilename</span>. When selecting files for exfiltration, a list with SHA-256 hashes is retrieved from the registry. If the hash of a file is in that list, the file is not exfiltrated. If the hash isn’t in the list, it is added, so that the file won’t be exfiltrated again.</p>
<p>Whenever adding files to exfiltrate would exceed the <span>maxZIPSize</span> of <span>outputCipherFilename</span>, the excess files are not added to the archive for exfiltration, but their paths are added to a text file that is archived, encrypted, and added to <span>outputCipherFilename</span>.</p>
<p>Regarding encryption, each individual archive that is added to the encrypted container is encrypted with AES in CFB mode, with a key and an initialization vector (IV) that are randomly generated on the spot. Both the key and IV need to be stored, but only the key is encrypted with <span>RSAKey</span>. Figure 7 shows an example of how these fields are stored in the encrypted container.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-7.png" alt="" width="2122" height="644"/>
<figcaption><em>Figure 7. Structure of the encrypted container</em></figcaption>
</figure>
<h4>GoldenUsbGo</h4>
<p>This component is very similar to GoldenUsbCopy and seems to be a later version of it, based on when we observed them in our telemetry and comparing Go versions used to compile them. However, GoldenUsbGo achieves the same functionality with a simpler implementation:</p>
<ul>
<li>There is no configuration file. All criteria for file selection are hardcoded in the malware:
<ul>
<li>if filename contains a specific word from a list, process the file regardless of all other criteria (the list contains strings such as <span>pass</span>, <span>login</span>, and <span>key</span>),</li>
<li>else, file size must be no bigger than 20 MB,</li>
<li>the date the file was last modified must be no more than 14 days ago, and</li>
<li>the file extension must be one of <span>.pdf</span>, <span>.doc</span>, <span>.docx</span>, <span>.sh</span>, or <span>.bat</span>.</li>
</ul>
</li>
<li>Insertion of removable drives is not continuously monitored. A hardcoded list of drive letters is checked periodically to determine if they have an assigned volume of <span>D:</span>, <span>E:</span>, <span>F:</span>, <span>G:</span>, or <span>H:</span>.</li>
<li>The list of hashes of files that were already processed is kept in memory only.</li>
<li>There is no size limit for the encrypted container where files are staged for exfiltration.</li>
<li>Files are not archived but instead are compressed with gzip. Both file contents and filenames are compressed. Figure 8 shows how compressed data is arranged before encryption.</li>
</ul>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-8.png" alt="" width="2537" height="307"/>
<figcaption><em>Figure 8. Fields used for gzip-compressed files, before encryption</em></figcaption>
</figure>
<p>The path to the encrypted container is hardcoded in the malware:</p>
<p><span>C:\Users\[redacted]\appdata\local\SquirrelTemp\SquirrelCache.dat</span></p>
<p>The hardcoded username in the path, redacted above, along with the short list of drives and specific filenames to process, tell us that GoldenUsbGo was compiled and tailored for this particular victim.</p>
<p>Compressed files are encrypted with AES in CFB mode with the hardcoded key <span>Fn$@-fR_*+!13bN5</span>. The structure is the same as in GoldenUsbCopy (shown in Figure 7) but without the AES key. After compressing the files, GoldenUsbGo generates a listing of all files on the inserted drive and adds it to the encrypted container, in the same manner as exfiltrated files. The filename for the listing is formed from the current date and time, replacing <span>:</span> with <span>-</span> (for example, <span>15 Jan 24 13-21 PST</span>).</p>
<h4>GoldenAce</h4>
<p>This component, which we classified as a distribution tool in Figure 5, serves to propagate other malicious executables and retrieve staged files via USB drives. While it could be used to target air-gapped systems, it’s not specifically built for that, as opposed to GoldenDealer. It works together with a lightweight version of <a href="https://securelist.com/goldenjackal-apt-group/109677/#jackalworm">JackalWorm</a> and some other unknown component.</p>
<p>GoldenAce periodically checks drives in the list <span>G:</span>, <span>H:</span>, <span>I:</span>, <span>J:</span>, <span>K:</span>, <span>L:</span>, <span>M:</span>, <span>N:</span>, <span>P:</span>, <span>X:</span>, <span>Y:</span>, and <span>Z:</span>, to find one that is mapped to a volume. Then it checks whether a trash directory exists in the root of that drive. If it doesn’t exist, it is created as hidden, and a file called update is copied to that directory, from the same location where GoldenAce is running. The first directory on the drive (in alphabetical order) that is not hidden is set to hidden, and a file called <span>upgrade</span> is copied to the root of the drive and renamed as <span>&lt;name_of_hidden_directory&gt;.exe</span>.</p>
<p>The file <span>upgrade</span> is actually JackalWorm, an executable that uses a folder icon, and whose purpose is to copy and run the <span>update</span> file on another system where the USB drive is inserted. Unlike the version of JackalWorm described by Kaspersky, this one is very limited: it doesn’t have code to monitor drive insertions, and it cannot be configured to perform various actions. When executed from the root directory of a removable drive, it opens the hidden folder in Windows Explorer and writes a batch file to execute the payload in <span>update</span>. Contents of this file, <span>update.bat</span>, are shown in Figure 9.</p>
<pre><code>@echo off
copy &#34;&lt;drive_letter&gt;:\\trash\\update&#34; &#34;C:\\Users\\%username%\\AppData\\Local\\update.exe&#34;
&#34;C:\\Users\\%username%\\AppData\\Local\\update.exe&#34; &#34;&lt;drive_letter&gt;:\\trash&#34;
:check1
@tasklist | findstr /i /b &#34;update.exe&#34; &gt;nul
@if %errorlevel%==0 goto check1
@del /f /q /a h &#34;C:\\Users\\%username%\\AppData\\Local\\update.exe&#34;
@del /f /q &#34;C:\\Users\\&lt;username&gt;\\AppData\\Local\\update.bat&#34;</code></pre>
<blockquote>
<p>Figure 9. Contents of <span>update.bat</span></p>
</blockquote>
<p>We can see that <span>update</span> is run and deleted, along with the batch file, once it’s done running. While we didn’t observe the contents of the <span>update</span> component, it is likely that it collects files and stages them in the <span>trash</span> directory on the removable drive, since the path to that directory is passed as an argument to <span>update</span>.</p>
<p>When GoldenAce finds that the directory <span>trash</span> already exists on a drive, instead of copying files to the drive, it copies files in the <span>trash</span> directory to <span>C:\ProgramData\Microsoft\Windows\DeviceMetadataCache</span>.</p>
<h4>HTTP server</h4>
<p>We observed <a href="https://github.com/python/cpython/blob/3.12/Lib/http/server.py">Python’s HTTP server</a>, packaged with PyInstaller, being executed via <span>C:\Windows\system32\cmd.exe /K C:\Windows\msahci.cmd</span>. Unfortunately, we didn’t observe the contents of the <span>msahci.cmd</span> file, so we don’t know the arguments passed for execution, such as the port for the server to listen on.</p>
<h4>GoldenBlacklist</h4>
<p>As a processing component, GoldenBlacklist downloads an encrypted archive from a local server, and processes email messages contained in it, to keep only those of interest. Then it generates a new archive for some other component to exfiltrate.</p>
<p>The URL to retrieve the initial archive is hardcoded: <span>https://&lt;local_ip_address&gt;/update46.zip</span>. The downloaded file is saved as <span>res.out</span>, and AES decrypted with the hardcoded key <span>k9ksbu9Q34HBKJuzHIuGTfHL9xCzMl53vguheOYA8SiNoh6Jqe62F7APtQ9pE</span>, using a legitimate <a href="https://www.openssl.org/" target="_blank" rel="noopener">OpenSSL</a> executable.</p>
<p>The decrypted archive, <span>update46.tar.gz</span>, is extracted in memory, and only those files that match certain criteria are written to a subdirectory <span>tmp</span>, in the directory where the malware is running. Criteria:</p>
<ul>
<li>The file does not contain any email on a blocklist of email addresses. This is done to remove email messages that come from senders that usually are not interesting. While we can’t include the full list here, it’s worth mentioning that many of the email addresses are related to newsletters and press releases. It’s important to note that the attackers must have been operating for some time to build a list like this.</li>
<li>The file contains the string <span>Content-Type: application</span>. This is to keep email messages that have attachments, such as PDF files, Microsoft Office files, and archives, to name a few.</li>
</ul>
<p>Once the files are selected, GoldenBlacklist archives the <span>tmp</span> directory and encrypts it with <span>openssl.exe</span>, using the same encryption key as the one used to decrypt the initial archive. The resulting file is <span>archive.out</span>. All intermediate files and folders are then deleted, as well as <span>openssl.exe</span>, <span>libssl-3-x64.dll</span>, and <span>libcrypto-3-x64.dll</span>, all located in the malware’s directory. This indicates that another component that we didn’t observe copied those legitimate binaries there in the first place.</p>
<h4>GoldenPyBlacklist</h4>
<p>GoldenPyBlacklist is a Python implementation of GoldenBlacklist. It was packaged with PyInstaller and the original name of the script is <span>duplxer_black_list_for_external_use.py</span>. Some differences to the other component are:</p>
<ul>
<li>the initial archive is written as <span>ress.out</span>,</li>
<li>the key for decryption is the same, except for a different first character,</li>
<li>the decrypted archive is extracted to the <span>C:\Windows\System32\temp</span> directory for processing,</li>
<li>one additional criterion for file selection is added to process only filenames that end in <span>.msg</span> (these are files created with Microsoft Outlook),</li>
<li>files that do not meet the criteria are deleted,</li>
<li>the final archive is created with the 7-Zip archiver, and</li>
<li>the final encrypted file is named <span>ArcSrvcUI.ter</span>.</li>
</ul>
<h4>GoldenMailer</h4>
<p>Classified as an exfiltration component, GoldenMailer exfiltrates files by sending emails with attachments to attacker-controlled accounts. It was written in Python and packaged with PyInstaller, and the original name of the script is <span>send_to_hole.py</span>. GoldenMailer connects to <a href="https://support.microsoft.com/en-us/office/pop-imap-and-smtp-settings-for-outlook-com-d088b986-291d-42b8-9564-9c414e2aa040" target="_blank" rel="noopener">legitimate servers</a> – either <span>smtp-mail.outlook.com</span> or <span>smtp.office365.com</span> – to send email messages, using SMTP on port 587.</p>
<p>The configuration is read from a file, <span>C:\ProgramData\Microsoft\Windows\Caches\cversions.ini</span>, in the same directory where GoldenMailer is running. The configuration consists of the following five lines:</p>
<ul>
<li>email address to authenticate to the SMTP server, and to use as both sender and destination address,</li>
<li>password to authenticate to the SMTP server,</li>
<li>path to directory with archives to exfiltrate,</li>
<li>base filename (e.g., <span>press.pdf</span>) used for archives to exfiltrate; these archives use the following naming convention: <span>&lt;base_filename&gt;.&lt;three_digit_sequence_number&gt;</span>, and</li>
<li>number of files to exfiltrate.</li>
</ul>
<p>We noticed that this configuration file was copied from another PC in the local network. Given that the configuration file indicates how many archives are available to be exfiltrated, we assume that these archives must also be copied over the network, separating the tasks of collection, distribution, and exfiltration. It is likely that the configuration file is generated by the component in charge of collecting files and creating archives for exfiltration, but we didn’t observe that component.</p>
<p>Figure 10 shows an example of an email message sent by GoldenMailer. The subject has a typo: it reads <span>Press realese</span>. The body is very simple and reads: <span>Daily News about Israel-Hamas war</span>. These strings are hardcoded in the malware’s binary. Only one attachment is sent per email; if there are many archives to exfiltrate, one email is sent for each.</p>
<figure><img src="https://web-assets.esetstatic.com/wls/2024/10-2024/goldenjackal/figure-10.png" alt="" width="678" height="566"/>
<figcaption><em>Figure 10. Example of an email message used to exfiltrate files</em></figcaption>
</figure>
<p>The configuration files that we observed contained the following email addresses:</p>
<ul>
<li><span>mariaalpane@outlook[.]com</span></li>
<li><span>katemarien087@outlook[.]com</span></li>
<li><span>spanosmitsotakis@outlook[.]com</span></li>
</ul>
<h4>GoldenDrive</h4>
<p>As opposed to GoldenMailer, this component exfiltrates files by uploading them to Google Drive. Necessary credentials are found in two files, which are hardcoded in the malware: <span>credentials.json</span>, which contains fields such as <span>client_id</span> and <span>client_secret</span>, and <span>token.json</span>, with fields such as <span>access_token</span> and <span>refresh_token</span>. A reference to Google Drive’s API and some code snippets in the Go programming language can be found <a href="https://developers.google.com/drive/api/quickstart/go" target="_blank" rel="noopener">here</a>.</p>
<p>Similar to GoldenMailer, this component can upload only one file at a time. GoldenDrive is executed with an argument that provides the full path to the file to upload.</p>
<h2>Conclusion</h2>
<p>In this blogpost, we revealed two new toolsets used by the GoldenJackal APT group to target air-gapped systems of governmental organizations, including those in Europe. Common functionalities include the use of USB drives to steal confidential documents.</p>
<p>Managing to deploy two separate toolsets for breaching air-gapped networks in only five years shows that GoldenJackal is a sophisticated threat actor aware of network segmentation used by its targets.</p>
<p>A comprehensive list of indicators of compromise (IoCs) can be found in <a href="https://github.com/eset/malware-ioc/tree/master/goldenjackal" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<blockquote>
<p><em>For any inquiries about our research published on WeLiveSecurity, please contact us at <a href="mailto:threatintel@eset.com?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=autotagging&amp;utm_content=eset-research&amp;utm_term=en">threatintel@eset.com</a>. </em></p>
<p><em>ESET Research offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the <a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=mind-air-gap-goldenjackal-gooses-government-guardrails&amp;sfdccampaignid=7011n0000017htTAAQ" target="_blank" rel="noopener">ESET Threat Intelligence</a> page.</em></p>
</blockquote>
<h2>IoCs</h2>
<h3>Files</h3>
<table>
<thead>
<tr>
<td>
<p><strong>SHA-1</strong> </p>
</td>
<td>
<p><strong>Filename</strong> </p>
</td>
<td>
<p><strong>Detection</strong> </p>
</td>
<td>
<p><strong>Description</strong> </p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>DA9562F5268FA61D19648DFF9C6A57FB8AB7B0D7</p>
</td>
<td>
<p><span>winaero.exe</span> </p>
</td>
<td>
<p>Win32/Agent.AGKQ </p>
</td>
<td>
<p>GoldenDealer. </p>
</td>
</tr>
<tr>
<td>
<p>5F12FFD272AABC0D5D611D18812A196A6EA2FAA9</p>
</td>
<td>
<p><span>1102720677</span> </p>
</td>
<td>
<p>Python/Agent.ANA </p>
<p>Python/HackTool.Agent.W </p>
<p>Python/Riskware.LdapDump.A </p>
<p>Python/Riskware.Impacket.C </p>
</td>
<td>
<p>GoldenHowl. </p>
</td>
</tr>
<tr>
<td>
<p>6DE7894F1971FDC1DF8C4E4C2EDCC4F4489353B6</p>
</td>
<td>
<p>OfficeAutoComplete.exe</p>
</td>
<td>
<p>WinGo/Agent.AAO </p>
</td>
<td>
<p>GoldenRobo. </p>
</td>
</tr>
<tr>
<td>
<p>7CB7C3E98CAB2226F48BA956D3BE79C52AB62140</p>
</td>
<td>
<p><span>prinntfy.dll</span> </p>
</td>
<td>
<p>WinGo/DataStealer.A </p>
</td>
<td>
<p>GoldenUsbCopy. </p>
</td>
</tr>
<tr>
<td>
<p>8F722EB29221C6EAEA9A96971D7FB78DAB2AD923</p>
</td>
<td>
<p><span>zUpdater.exe</span> </p>
</td>
<td>
<p>WinGo/Spy.Agent.AH </p>
</td>
<td>
<p>GoldenUsbGo. </p>
</td>
</tr>
<tr>
<td>
<p>24FBCEC23E8B4B40FEA188132B0E4A90C65E3FFB</p>
</td>
<td>
<p><span>fc.exe</span> </p>
</td>
<td>
<p>WinGo/DataStealer.C </p>
</td>
<td>
<p>GoldenAce. </p>
</td>
</tr>
<tr>
<td>
<p>A87CEB21EF88350707F278063D7701BDE0F8B6B7</p>
</td>
<td>
<p><span>upgrade</span> </p>
</td>
<td>
<p>MSIL/Agent.WPJ </p>
</td>
<td>
<p>JackalWorm – simpler version. </p>
</td>
</tr>
<tr>
<td>
<p>9CBE8F7079DA75D738302D7DB7E97A92C4DE5B71</p>
</td>
<td>
<p><span>fp.exe</span> </p>
</td>
<td>
<p>WinGo/Spy.Agent.CA </p>
</td>
<td>
<p>GoldenBlacklist. </p>
</td>
</tr>
<tr>
<td>
<p>9083431A738F031AC6E33F0E9133B3080F641D90</p>
</td>
<td>
<p><span>fp.exe</span> </p>
</td>
<td>
<p>Python/TrojanDownloader.Agent.YO</p>
</td>
<td>
<p>GoldenPyBlacklist. </p>
</td>
</tr>
<tr>
<td>
<p>C830EFD843A233C170285B4844C5960BA8381979</p>
</td>
<td>
<p><span>cb.exe</span> </p>
</td>
<td>
<p>Python/Agent.ALE </p>
</td>
<td>
<p>GoldenMailer. </p>
</td>
</tr>
<tr>
<td>
<p>F7192914E00DD0CE31DF0911C073F522967C6A97</p>
</td>
<td>
<p><span>GoogleUpdate.exe</span> </p>
</td>
<td>
<p>WinGo/Agent.YH </p>
</td>
<td>
<p>GoldenDrive. </p>
</td>
</tr>
<tr>
<td>
<p>B2BAA5898505B32DF7FE0A7209FC0A8673726509</p>
</td>
<td>
<p><span>fp.exe</span> </p>
</td>
<td>
<p>Python/Agent.ALF </p>
</td>
<td>
<p>Python HTTP server. </p>
</td>
</tr>
</tbody>
</table>
<h3>Network</h3>
<table>
<thead>
<tr>
<td><strong>IP</strong> </td>
<td><strong>Domain</strong> </td>
<td><strong>Hosting provider</strong> </td>
<td><strong>First seen</strong> </td>
<td><strong>Details</strong> </td>
</tr>
</thead>
<tbody>
<tr>
<td><span>83.24.9[.]124</span> </td>
<td>N/A </td>
<td>Orange Polska Spolka Akcyjna </td>
<td>2019‑08‑09 </td>
<td>Primary C&amp;C server used by GoldenJackal in 2019. </td>
</tr>
<tr>
<td><span>196.29.32[.]210</span> </td>
<td>N/A </td>
<td>UTANDE </td>
<td>2019‑08‑09 </td>
<td>Secondary C&amp;C server used by GoldenJackal in 2019. </td>
</tr>
<tr>
<td>N/A </td>
<td><span>assistance[.]uz</span> </td>
<td>N/A </td>
<td>2019‑09‑25 </td>
<td>Compromised website used to download malware. </td>
</tr>
<tr>
<td>N/A </td>
<td><span>thehistore[.]com</span> </td>
<td>N/A </td>
<td>2019‑09‑25 </td>
<td>Compromised website used as a C&amp;C server. </td>
</tr>
<tr>
<td>N/A </td>
<td><span>xgraphic[.]ro</span> </td>
<td>N/A </td>
<td>2019‑09‑25 </td>
<td>Compromised website used as a C&amp;C server. </td>
</tr>
</tbody>
</table>
<h3>Email Addresses</h3>
<ul>
<li><span>mariaalpane@outlook[.]com</span></li>
<li><span>katemarien087@outlook[.]com</span></li>
<li><span>spanosmitsotakis@outlook[.]com</span></li>
</ul>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/">version 15</a> of the MITRE ATT&amp;CK framework<strong>.</strong></p>
<table>
<thead>
<tr>
<td><strong>Tactic</strong> </td>
<td><strong>ID</strong> </td>
<td><strong>Name</strong> </td>
<td><strong>Description</strong> </td>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="6"><strong>Resource Development</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1583/003">T1583.003</a> </td>
<td>Acquire Infrastructure: Virtual Private Server </td>
<td>GoldenJackal probably acquired a VPS server to use as a secondary C&amp;C server for the GoldenDealer malware. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1583/004">T1583.004</a> </td>
<td>Acquire Infrastructure: Server </td>
<td>GoldenJackal likely acquired a server to use as a primary C&amp;C server for the GoldenDealer malware. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1584/006">T1584.006</a> </td>
<td>Compromise Infrastructure: Web Services </td>
<td>GoldenJackal has used compromised WordPress sites for C&amp;C infrastructure, used by the JackalControl and JackalSteal malware. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1587/001">T1587.001</a> </td>
<td>Develop Capabilities: Malware </td>
<td>GoldenJackal develops its own custom malware. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1585/003">T1585.003</a> </td>
<td>Establish Accounts: Cloud Accounts </td>
<td>GoldenJackal has used Google Drive to store exfiltrated files and legitimate tools. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1588/002">T1588.002</a> </td>
<td>Obtain Capabilities: Tool </td>
<td>GoldenJackal uses legitimate tools, such as Plink and PsExec, for post-compromise operations. </td>
</tr>
<tr>
<td rowspan="6"><strong>Execution</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1059/001">T1059.001</a> </td>
<td>Command and Scripting Interpreter: PowerShell </td>
<td>GoldenJackal executed PowerShell scripts to download the JackalControl malware from a compromised WordPress website. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1059/003">T1059.003</a> </td>
<td>Command and Scripting Interpreter: Windows Command Shell </td>
<td>GoldenAce uses <span>cmd.exe</span> to run a batch script to execute other malicious components. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1059/006">T1059.006</a> </td>
<td>Command and Scripting Interpreter: Python </td>
<td>GoldenHowl contains various malicious modules that are Python scripts. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1106">T1106</a> </td>
<td>Native API </td>
<td>GoldenDealer can copy and run an executable file with the <span>CreateProcessW</span> API. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1569/002">T1569.002</a> </td>
<td>System Services: Service Execution </td>
<td>GoldenDealer can run as a service. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1204/002">T1204.002</a> </td>
<td>User Execution: Malicious File </td>
<td>JackalWorm uses a folder icon to entice a potential victim to launch it. </td>
</tr>
<tr>
<td rowspan="3"><strong>Persistence</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1543/003">T1543.003</a> </td>
<td>Create or Modify System Process: Windows Service </td>
<td>GoldenDealer creates the service <span>NetDnsActivatorSharing</span> to persist on a compromised system. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1547/001">T1547.001</a> </td>
<td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder </td>
<td>If GoldenDealer fails to create a service for persistence, an entry in a Run registry key is created instead. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1053/005">T1053.005</a> </td>
<td>Scheduled Task/Job: Scheduled Task </td>
<td>GoldenHowl creates the scheduled task <span>Microsoft\Windows\Multimedia\</span> for persistence. </td>
</tr>
<tr>
<td rowspan="6"><strong>Defense Evasion</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1564/001">T1564.001</a> </td>
<td>Hide Artifacts: Hidden Files and Directories </td>
<td>GoldenDealer modifies the registry so that hidden files and directories are not shown in Windows Explorer. GoldenDealer, GoldenAce, and Jackal worm create hidden folders on USB drives. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1070/004">T1070.004</a> </td>
<td>Indicator Removal: File Deletion </td>
<td>GoldenAce deletes payloads after they are run. GoldenBlacklist and GoldenPyBlacklist delete intermediate files after the final archives are generated. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1036/005">T1036.005</a> </td>
<td>Masquerading: Match Legitimate Name or Location </td>
<td>GoldenUsbCopy uses a legitimate Firefox directory <span>C:\Users\&lt;username&gt;\AppData\Roaming\Mozilla\Firefox\</span> to stage files. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1036/008">T1036.008</a> </td>
<td>Masquerading: Masquerade File Type </td>
<td>JackalWorm uses a folder icon to disguise itself as a non-executable file. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1112">T1112</a> </td>
<td>Modify Registry </td>
<td>GoldenDealer modifies the registry so that hidden files and directories are not shown in Windows Explorer. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1027/013">T1027.013</a> </td>
<td>Obfuscated Files or Information: Encrypted/Encoded File </td>
<td>GoldenJackal uses various encryption algorithms in its toolset, such as XOR, Fernet, and AES, to encrypt configuration files and files to be exfiltrated. </td>
</tr>
<tr>
<td rowspan="2"><strong>Credential Access</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1552/001">T1552.001</a> </td>
<td>Unsecured Credentials: Credentials In Files </td>
<td>GoldenUsbGo looks for files with filenames that are usually associated with credentials. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1552/004">T1552.004</a> </td>
<td>Unsecured Credentials: Private Keys </td>
<td>GoldenUsbGo looks for files that may contain private keys, such as those with filenames that contain <span>id_rsa</span>. </td>
</tr>
<tr>
<td rowspan="10"><strong>Discovery</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1087/001">T1087.001</a> </td>
<td>Account Discovery: Local Account </td>
<td>GoldenDealer collects information about all user accounts on a compromised system. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1083">T1083</a> </td>
<td>File and Directory Discovery </td>
<td>GoldenHowl has a module to generate a listing of files and directories on a compromised system. GoldenUsbCopy and GoldenUsbGo generate a listing of files and directories on a USB drive. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1046">T1046</a> </td>
<td>Network Service Discovery </td>
<td>GoldenHowl can scan a remote system for open ports, and whether the target is vulnerable to EternalBlue malware. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1120">T1120</a> </td>
<td>Peripheral Device Discovery </td>
<td>GoldenDealer and GoldenUsbCopy monitor the insertion of removable drives. GoldenUsbGo and GoldenAce check for various drive letters, to detect attached removable drives. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1057">T1057</a> </td>
<td>Process Discovery </td>
<td>GoldenDealer obtains information about running processes on a compromised system. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1018">T1018</a> </td>
<td>Remote System Discovery </td>
<td>GoldenHowl can scan an IP range to discover other systems. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1518">T1518</a> </td>
<td>Software Discovery </td>
<td>GoldenDealer obtains information about installed programs on a compromised system. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1082">T1082</a> </td>
<td>System Information Discovery </td>
<td>GoldenDealer obtains various information about the operating system and user accounts on a compromised system. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1016/001">T1016.001</a> </td>
<td>System Network Configuration Discovery: Internet Connection Discovery </td>
<td>GoldenDealer can determine whether a computer is connected to the internet. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1135">T1135</a> </td>
<td>Network Share Discovery </td>
<td>GoldenAce checks a list of drive letters that can include network shares. </td>
</tr>
<tr>
<td rowspan="2"><strong>Lateral Movement</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1210">T1210</a> </td>
<td>Exploitation of Remote Services </td>
<td>GoldenHowl can check for a Windows SMB remote code execution vulnerability that can then be exploited for lateral movement. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1091">T1091</a> </td>
<td>Replication Through Removable Media </td>
<td>GoldenDealer copies executables to and from USB drives, to target air-gapped systems. GoldenAce propagates malicious executables via removable drives. </td>
</tr>
<tr>
<td rowspan="6"><strong>Collection</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1560/002">T1560.002</a> </td>
<td>Archive Collected Data: Archive via Library </td>
<td>GoldenRobo and GoldenUsbCopy archive files to be exfiltrated with the ZIP library. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1119">T1119</a> </td>
<td>Automated Collection </td>
<td>GoldenUsbCopy and GoldenUsbGo automatically stage files for later exfiltration, when a new removable drive is detected. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1005">T1005</a> </td>
<td>Data from Local System </td>
<td>Most tools in GoldenJackal’s toolset collect information and files from the local system. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1025">T1025</a> </td>
<td>Data from Removable Media </td>
<td>GoldenUsbCopy and GoldenUsbGo collect interesting files from removable media. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1074/001">T1074.001</a> </td>
<td>Data Staged: Local Data Staging </td>
<td>Most tools in GoldenJackal’s toolset stage files locally for other components to process or exfiltrate them. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1114/001">T1114.001</a> </td>
<td>Email Collection: Local Email Collection </td>
<td>GoldenBlacklist and GoldenPyBlacklist process email files that were collected by an unknown component in GoldenJackal’s toolset. </td>
</tr>
<tr>
<td rowspan="5"><strong>Command and Control</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1071/001">T1071.001</a> </td>
<td>Application Layer Protocol: Web Protocols </td>
<td>GoldenDealer and GoldenHowl use HTTPS for communication. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1092">T1092</a> </td>
<td>Communication Through Removable Media </td>
<td>GoldenDealer uses removable media to pass executables to air-gapped systems, and information from those systems back to connected systems. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1132/001">T1132.001</a> </td>
<td>Data Encoding: Standard Encoding </td>
<td>Executable files sent from the C&amp;C server to GoldenDealer are base64 encoded. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1572">T1572</a> </td>
<td>Protocol Tunneling </td>
<td>GoldenHowl can forward messages through an SSH tunnel. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1090/001">T1090.001</a> </td>
<td>Proxy: Internal Proxy </td>
<td>GoldenHowl can act as a proxy, forwarding packets. </td>
</tr>
<tr>
<td rowspan="4"><strong>Exfiltration</strong> </td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1041">T1041</a> </td>
<td>Exfiltration Over C2 Channel </td>
<td>GoldenHowl exfiltrates files via the same channel used as its C&amp;C. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1052/001">T1052.001</a> </td>
<td>Exfiltration Over Physical Medium: Exfiltration over USB </td>
<td>GoldenJackal’s toolset provides capabilities to copy files from air-gapped systems and move them to connected systems via USB drives, for exfiltration. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1567/002">T1567.002</a> </td>
<td>Exfiltration Over Web Service: Exfiltration to Cloud Storage </td>
<td>GoldenDrive exfiltrates files to an attacker-controlled Google Drive account. </td>
</tr>
<tr>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1048/002">T1048.002</a> </td>
<td>Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol </td>
<td>GoldenMailer exfiltrates files via SMTP, using STARTTLS on port 587. </td>
</tr>
</tbody>
</table>
<p><a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=mind-air-gap-goldenjackal-gooses-government-guardrails&amp;sfdccampaignid=7011n0000017htTAAQ" target="_blank" rel="noopener"><img src="https://web-assets.esetstatic.com/wls/2023/2023-12/welivesecurity-eset-threat-intelligence.jpeg" alt="" width="915" height="296"/></a></p>
</div></div>
  </body>
</html>
