<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/XapaJIaMnu/translateLocally">Original</a>
    <h1>Fast and secure translation on your local machine with a GUI</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto">Fast and secure translation on your local machine with a GUI, powered by marian and Bergamot.</p>

<p dir="auto">You can download the latest automatic build for Windows, Linux and Mac from the <a href="https://github.com/XapaJIaMnu/translateLocally/releases">releases</a> github tab or from the <a href="https://translatelocally.com" rel="nofollow">official website</a>. We also have compatibility builds for Windows and Mac that aim to cover very old hardware and M1.</p>

<p dir="auto">Bringing fast and secure machine translation to the masses! To build and run</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir build
cd build
cmake ..
# this step is only necessary when compiling on ARM
# cmake should give you the absolute path of the command that needs to run:
# $GITHUB_WORKSPACE/cmake/fix_ruy_build.sh $GITHUB_WORKSPACE ${{github.workspace}}/build`
make -j5
./translateLocally"><pre>mkdir build
<span>cd</span> build
cmake ..
<span><span>#</span> this step is only necessary when compiling on ARM</span>
<span><span>#</span> cmake should give you the absolute path of the command that needs to run:</span>
<span><span>#</span> $GITHUB_WORKSPACE/cmake/fix_ruy_build.sh $GITHUB_WORKSPACE ${{github.workspace}}/build`</span>
make -j5
./translateLocally</pre></div>
<p dir="auto">Requires <code>QT&gt;=5 libarchive intel-mkl-static</code>. We make use of the <code>QT&gt;=5 network</code>, <code>QT&gt;=5 linguisticTool</code> and <code>QT&gt;=5 svg</code> components. Depending on your distro, those may be split in separate package from your QT package (Eg <code>qt{6/7}-tools-dev</code>; <code>qt{5/6}-svg</code> or <code>libqt5svg5-dev</code>). QT6 is fully supported and its use is encouraged. <code>intel-mkl-static</code> may be part of <code>mkl</code> or <code>intel-mkl</code> packages.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Ubuntu 20.04 build dependencies:</h3><a id="user-content-ubuntu-2004-build-dependencies" aria-label="Permalink: Ubuntu 20.04 build dependencies:" href="#ubuntu-2004-build-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="sudo apt-get install -y libpcre++-dev qttools5-dev qtbase5-dev libqt5svg5-dev libarchive-dev libpcre2-dev"><pre>sudo apt-get install -y libpcre++-dev qttools5-dev qtbase5-dev libqt5svg5-dev libarchive-dev libpcre2-dev</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Ubuntu 22.04 build dependencies:</h3><a id="user-content-ubuntu-2204-build-dependencies" aria-label="Permalink: Ubuntu 22.04 build dependencies:" href="#ubuntu-2204-build-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="sudo apt-get install -y libxkbcommon-x11-dev libpcre++-dev libvulkan-dev libgl1-mesa-dev qt6-base-dev qt6-base-dev-tools qt6-tools-dev qt6-tools-dev-tools qt6-l10n-tools qt6-translations-l10n libqt6svg6-dev libarchive-dev libpcre2-dev"><pre>sudo apt-get install -y libxkbcommon-x11-dev libpcre++-dev libvulkan-dev libgl1-mesa-dev qt6-base-dev qt6-base-dev-tools qt6-tools-dev qt6-tools-dev-tools qt6-l10n-tools qt6-translations-l10n libqt6svg6-dev libarchive-dev libpcre2-dev</pre></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Install MKL for Ubuntu (Any)</h4><a id="user-content-install-mkl-for-ubuntu-any" aria-label="Permalink: Install MKL for Ubuntu (Any)" href="#install-mkl-for-ubuntu-any"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="wget -qO- &#34;https://apt.repos.intel.com/intel-gpg-keys/GPG-PUB-KEY-INTEL-SW-PRODUCTS-2019.PUB&#34; | sudo apt-key add -
  sudo sh -c &#34;echo deb https://apt.repos.intel.com/mkl all main &gt; /etc/apt/sources.list.d/intel-mkl.list&#34;
  sudo apt-get update -o Dir::Etc::sourcelist=&#34;/etc/apt/sources.list.d/intel-mkl.list&#34;
  sudo apt-get install -y --no-install-recommends intel-mkl-64bit-2020.0-088"><pre>wget -qO- <span><span>&#34;</span>https://apt.repos.intel.com/intel-gpg-keys/GPG-PUB-KEY-INTEL-SW-PRODUCTS-2019.PUB<span>&#34;</span></span> <span>|</span> sudo apt-key add -
  sudo sh -c <span><span>&#34;</span>echo deb https://apt.repos.intel.com/mkl all main &gt; /etc/apt/sources.list.d/intel-mkl.list<span>&#34;</span></span>
  sudo apt-get update -o Dir::Etc::sourcelist=<span><span>&#34;</span>/etc/apt/sources.list.d/intel-mkl.list<span>&#34;</span></span>
  sudo apt-get install -y --no-install-recommends intel-mkl-64bit-2020.0-088</pre></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Archlinux build dependencies</h3><a id="user-content-archlinux-build-dependencies" aria-label="Permalink: Archlinux build dependencies" href="#archlinux-build-dependencies"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div data-snippet-clipboard-copy-content="# pacman -S libarchive pcre2 protobuf qt6-base qt6-svg intel-oneapi-mkl"><pre><code># pacman -S libarchive pcre2 protobuf qt6-base qt6-svg intel-oneapi-mkl
</code></pre></div>

<p dir="auto">We technically support building against OpenBLAS as a BLAS provider, but we <strong>strongly discourage it</strong>. The performance offered by OpenBLAS is significantly lower than that of Intel&#39;s MKL, regardless of the CPU manufacturer. Furthermore, OpenBLAS enables OpenMP parallelization by default, but unfortunately our matrices are too small to take advantage of OpenMP and we end up with up to 100x slowdown compared MKL in the worst case scenario with the majority of end users not aware of how to debug this issue. How sad.</p>
<p dir="auto">If you <em>really</em> want to use OpenBLAS instead you can do:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir build
cd build
cmake .. -DBLAS_LIBRARIES=-lblas -DCBLAS_LIBRARIES=-lcblas
make -j6
OMP_NUM_THREADS=1 ./translateLocally # disable OpenMP parallelization."><pre>mkdir build
<span>cd</span> build
cmake .. -DBLAS_LIBRARIES=-lblas -DCBLAS_LIBRARIES=-lcblas
make -j6
OMP_NUM_THREADS=1 ./translateLocally <span><span>#</span> disable OpenMP parallelization.</span></pre></div>

<p dir="auto">On MacOS, translateLocally doesn&#39;t rely on MKL, but instead on Apple accelerate. If you want to build a portable executable that is able to run on multiple machines, we recommend using Qt&#39;s distribution of Qt, as opposed to homebrew&#39;s due to issues with <a href="https://github.com/XapaJIaMnu/translateLocally/issues/69" data-hovercard-type="issue" data-hovercard-url="/XapaJIaMnu/translateLocally/issues/69/hovercard">macdeployqt</a>. To produce a <code>.dmg</code>do:</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir build
cd build
cmake ..
cmake --build . -j3 --target translateLocally-bin translateLocally.dmg"><pre>mkdir build
<span>cd</span> build
cmake ..
cmake --build <span>.</span> -j3 --target translateLocally-bin translateLocally.dmg</pre></div>
<p dir="auto">Alternatively, if you wish to sign and notarize the <code>.dmg</code>for distribution, you may use <a href="https://github.com/XapaJIaMnu/translateLocally/blob/master/dist/macdmg.sh">macdmg.sh</a></p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir build
cd build
cmake ..
make -j5
../dist/macdmg.sh ."><pre>mkdir build
<span>cd</span> build
cmake ..
make -j5
../dist/macdmg.sh <span>.</span></pre></div>
<p dir="auto">Check the script for the environment variables that you need to set if you want to take advantage of signing and notarization.</p>

<p dir="auto">On Windows, we recommend using <a href="https://github.com/Microsoft/vcpkg">vcpkg</a> to install all necessary packages and Visual Studio to perform the build.</p>

<p dir="auto">translateLocally supports using the command line to perform translations. Example usage:</p>
<div dir="auto" data-snippet-clipboard-copy-content="./translateLocally --help
Usage: ./translateLocally [options]
A secure translation service that performs translations for you locally, on your own machine.

Options:
  -h, --help                     Displays help on commandline options.
  --help-all                     Displays help including Qt specific options.
  -v, --version                  Displays version information.
  -l, --list-models              List locally installed models.
  -a, --available-models         Connect to the Internet and list available
                                 models. Only shows models that are NOT
                                 installed locally or have a new version
                                 available online.
  -d, --download-model &lt;output&gt;  Connect to the Internet and download a model.
  -r, --remove-model &lt;output&gt;    Remove a model from the local machine. Only
                                 works for models managed with translateLocally.
  -m, --model &lt;model&gt;            Select model for translation.
  -i, --input &lt;input&gt;            Source translation text (or just used stdin).
  -o, --output &lt;output&gt;          Target translation output (or just used
                                 stdout)."><pre>./translateLocally --help
Usage: ./translateLocally [options]
A secure translation service that performs translations <span>for</span> you locally, on your own machine.

Options:
  -h, --help                     Displays <span>help</span> on commandline options.
  --help-all                     Displays <span>help</span> including Qt specific options.
  -v, --version                  Displays version information.
  -l, --list-models              List locally installed models.
  -a, --available-models         Connect to the Internet and list available
                                 models. Only shows models that are NOT
                                 installed locally or have a new version
                                 available online.
  -d, --download-model <span>&lt;</span>output<span>&gt;</span>  Connect to the Internet and download a model.
  -r, --remove-model <span>&lt;</span>output<span>&gt;</span>    Remove a model from the <span>local</span> machine. Only
                                 works <span>for</span> models managed with translateLocally.
  -m, --model <span>&lt;</span>model<span>&gt;</span>            Select model <span>for</span> translation.
  -i, --input <span>&lt;</span>input<span>&gt;</span>            Source translation text (or just used stdin).
  -o, --output <span>&lt;</span>output<span>&gt;</span>          Target translation output (or just used
                                 stdout).</pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Downloading models from CLI</h2><a id="user-content-downloading-models-from-cli" aria-label="Permalink: Downloading models from CLI" href="#downloading-models-from-cli"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Models can be downloaded from the GUI or the CLI. For the CLI model management you need to:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ ./translateLocally -a
Czech-English type: base version: 1; To download do -d cs-en-base
German-English type: base version: 2; To download do -d de-en-base
English-Czech type: base version: 1; To download do -d en-cs-base
English-German type: base version: 2; To download do -d en-de-base
English-Estonian type: tiny version: 1; To download do -d en-et-tiny
Estonian-English type: tiny version: 1; To download do -d et-en-tiny
Icelandic-English type: tiny version: 1; To download do -d is-en-tiny
Norwegian (Bokmal)-English type: tiny version: 1; To download do -d nb-en-tiny
Norwegian (Nynorsk)-English type: tiny version: 1; To download do -d nn-en-tiny

$ ./translateLocally -d en-et-tiny
Downloading English-Estonian type: tiny...
100% [############################################################]
Model downloaded succesffully! You can now invoke it with -m en-et-tiny"><pre>$ ./translateLocally -a
Czech-English type: base version: 1<span>;</span> To download <span>do</span> -d cs-en-base
German-English type: base version: 2<span>;</span> To download <span>do</span> -d de-en-base
English-Czech type: base version: 1<span>;</span> To download <span>do</span> -d en-cs-base
English-German type: base version: 2<span>;</span> To download <span>do</span> -d en-de-base
English-Estonian type: tiny version: 1<span>;</span> To download <span>do</span> -d en-et-tiny
Estonian-English type: tiny version: 1<span>;</span> To download <span>do</span> -d et-en-tiny
Icelandic-English type: tiny version: 1<span>;</span> To download <span>do</span> -d is-en-tiny
Norwegian (Bokmal)-English type: tiny version: 1<span>;</span> To download <span>do</span> -d nb-en-tiny
Norwegian (Nynorsk)-English type: tiny version: 1<span>;</span> To download <span>do</span> -d nn-en-tiny

$ ./translateLocally -d en-et-tiny
Downloading English-Estonian type: tiny...
100% [<span><span>#</span>###########################################################]</span>
Model downloaded succesffully<span>!</span> You can now invoke it with -m en-et-tiny</pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Removing models from the CLI</h2><a id="user-content-removing-models-from-the-cli" aria-label="Permalink: Removing models from the CLI" href="#removing-models-from-the-cli"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Models can be removed from the GUI or the CLI. For the CLI model removal, you need to:</p>
<div dir="auto" data-snippet-clipboard-copy-content="./translateLocally -r en-et-tiny
Model English-Estonian type tiny successfully removed."><pre>./translateLocally -r en-et-tiny
Model English-Estonian <span>type</span> tiny successfully removed.</pre></div>

<p dir="auto">The avialble models can be listed with <code>-l</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="./translateLocally -l
Czech-English type: tiny version: 1; To invoke do -m cs-en-tiny
German-English type: tiny version: 2; To invoke do -m de-en-tiny
English-Czech type: tiny version: 1; To invoke do -m en-cs-tiny
English-German type: tiny version: 2; To invoke do -m en-de-tiny
English-Spanish type: tiny version: 1; To invoke do -m en-es-tiny
Spanish-English type: tiny version: 1; To invoke do -m es-en-tiny"><pre>./translateLocally -l
Czech-English type: tiny version: 1<span>;</span> To invoke <span>do</span> -m cs-en-tiny
German-English type: tiny version: 2<span>;</span> To invoke <span>do</span> -m de-en-tiny
English-Czech type: tiny version: 1<span>;</span> To invoke <span>do</span> -m en-cs-tiny
English-German type: tiny version: 2<span>;</span> To invoke <span>do</span> -m en-de-tiny
English-Spanish type: tiny version: 1<span>;</span> To invoke <span>do</span> -m en-es-tiny
Spanish-English type: tiny version: 1<span>;</span> To invoke <span>do</span> -m es-en-tiny</pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Translating a single sentence</h2><a id="user-content-translating-a-single-sentence" aria-label="Permalink: Translating a single sentence" href="#translating-a-single-sentence"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Note that customising the translator settings can only be done via the GUI.</p>
<div dir="auto" data-snippet-clipboard-copy-content="echo &#34;Me gustaria comprar la casa verde&#34; | ./translateLocally -m es-en-tiny"><pre><span>echo</span> <span><span>&#34;</span>Me gustaria comprar la casa verde<span>&#34;</span></span> <span>|</span> ./translateLocally -m es-en-tiny</pre></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Translating a whole dataset</h2><a id="user-content-translating-a-whole-dataset" aria-label="Permalink: Translating a whole dataset" href="#translating-a-whole-dataset"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto" data-snippet-clipboard-copy-content="sacrebleu -t wmt13 -l en-es --echo ref &gt; /tmp/es.in
./translateLocally -m es-en-tiny -i /tmp/es.in -o /tmp/en.out"><pre>sacrebleu -t wmt13 -l en-es --echo ref <span>&gt;</span> /tmp/es.in
./translateLocally -m es-en-tiny -i /tmp/es.in -o /tmp/en.out</pre></div>
<p dir="auto">Note that if you are using the macOS translateLocally.app version, the <code>-i</code> and <code>-o</code> options are not able to read most files. You can use pipes instead, e.g.</p>
<div dir="auto" data-snippet-clipboard-copy-content="translateLocally.app/Contents/MacOS/translateLocally -m es-en-tiny &lt; input.txt &gt; output.txt"><pre>translateLocally.app/Contents/MacOS/translateLocally -m es-en-tiny <span>&lt;</span> input.txt <span>&gt;</span> output.txt</pre></div>

<p dir="auto">The command line interface can be used to chain several translation models to achieve pivot translation, for example Spanish to German.</p>
<div dir="auto" data-snippet-clipboard-copy-content="sacrebleu -t wmt13 -l en-es --echo ref &gt; /tmp/es.in
cat /tmp/es.in | ./translateLocally -m es-en-tiny | ./translateLocally -m en-de-tiny -o /tmp/de.out"><pre>sacrebleu -t wmt13 -l en-es --echo ref <span>&gt;</span> /tmp/es.in
cat /tmp/es.in <span>|</span> ./translateLocally -m es-en-tiny <span>|</span> ./translateLocally -m en-de-tiny -o /tmp/de.out</pre></div>

<p dir="auto">translateLocally can integrate with other applications and browser extensions using <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging" rel="nofollow">native messaging</a>. This functionality is similar to using pipes on the command line, except that the message format is JSON which allows you to specify options per input fragment, and the translated fragments are returned when they become available as opposed to the input order.</p>

<p dir="auto">Right now there is a 10MB message limit for incoming messages. This matches the limitations of Firefox. Responses are limited to about 4GB due to the native messaging message format.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Using NativeMessaging from Python</h2><a id="user-content-using-nativemessaging-from-python" aria-label="Permalink: Using NativeMessaging from Python" href="#using-nativemessaging-from-python"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Start translateLocally in a subprocess with the <code>-p</code> option, and pass it messages <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Native_messaging#app_side" rel="nofollow">formatted as described here</a> to its stdin. All supported messages are described in the <a href="https://github.com/XapaJIaMnu/translateLocally/blob/master/src/cli/NativeMsgIface.h">NativeMsgIface.h</a> file.</p>
<p dir="auto">There is an example, <a href="https://github.com/XapaJIaMnu/translateLocally/blob/master/scripts/native_client.py">native_client.py</a>, that demonstrates how to use translateLocally as an async Python API.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Using NativeMessaging from browser extensions</h2><a id="user-content-using-nativemessaging-from-browser-extensions" aria-label="Permalink: Using NativeMessaging from browser extensions" href="#using-nativemessaging-from-browser-extensions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Right now, the functionality is only automatically available to Firefox and Chrome.</p>
<p dir="auto">translateLocally automatically registers itself with Firefox when you start translateLocally in GUI mode. Then you can install the <a href="https://github.com/jelmervdl/firefox-translations/releases">Firefox translation addon</a>. After installation of the addon, go into the addon settings and pick &#34;translateLocally&#34; as translation provider.</p>
<div dir="auto"><h3 tabindex="-1" dir="auto">Developing your own browser extension</h3><a id="user-content-developing-your-own-browser-extension" aria-label="Permalink: Developing your own browser extension" href="#developing-your-own-browser-extension"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Due to the way Firefox and Chrome call translateLocally, you will need to add your browser extension id to the translateLocally source code before it is able to accept native messages.</p>
<p dir="auto">Add your extension id to <a href="https://github.com/XapaJIaMnu/translateLocally/blob/master/src/constants.h">constants.h</a> and rebuild translateLocally from source. Once you start it in GUI mode, it will re-register itself with support for your extension.</p>
<p dir="auto">If you want your extension id added to translateLocally permanently, please open an issue or send us a pull request!</p>

<p dir="auto">translateLocally supports importing custom models. translateLocally uses the <a href="https://github.com/browsermt/marian-dev">Bergamot</a> fork of <a href="https://github.com/marian-nmt/marian-dev">marian</a>. As such, it supports the vast majority marian models out of the box. You can just train your marian model and place it a directory.</p>

<p dir="auto">The directory structure of a translateLocally model looks like this:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ tree my-custom-model
my-custom-model/
├── config.intgemm8bitalpha.yml
├── model_info.json
├── model.npz
└── vocab.deen.spm"><pre>$ tree my-custom-model
my-custom-model/
├── config.intgemm8bitalpha.yml
├── model_info.json
├── model.npz
└── vocab.deen.spm</pre></div>
<p dir="auto">The <code>config.intgemm8bitalpha.yml</code> name is hardcoded, and so is <code>model_info.json</code>. Everything else could have an arbitrary name. translateLocally will load the model according to the settings specified in <code>config.intgemm8bitalpha.yml</code>. These are just normal marian configuration options. <code>model_info.json</code> contains metadata about the model:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ cat model_info.json 
{
  &#34;modelName&#34;: &#34;German-English tiny&#34;,
  &#34;shortName&#34;: &#34;de-en-tiny&#34;,
  &#34;type&#34;:      &#34;tiny&#34;,
  &#34;src&#34;:       &#34;German&#34;,
  &#34;trg&#34;:       &#34;English&#34;,
  &#34;version&#34;:   2.0,
  &#34;API&#34;:       1.0
}"><pre>$ cat model_info.json 
{
  <span><span>&#34;</span>modelName<span>&#34;</span></span>: <span><span>&#34;</span>German-English tiny<span>&#34;</span></span>,
  <span><span>&#34;</span>shortName<span>&#34;</span></span>: <span><span>&#34;</span>de-en-tiny<span>&#34;</span></span>,
  <span><span>&#34;</span>type<span>&#34;</span></span>:      <span><span>&#34;</span>tiny<span>&#34;</span></span>,
  <span><span>&#34;</span>src<span>&#34;</span></span>:       <span><span>&#34;</span>German<span>&#34;</span></span>,
  <span><span>&#34;</span>trg<span>&#34;</span></span>:       <span><span>&#34;</span>English<span>&#34;</span></span>,
  <span><span>&#34;</span>version<span>&#34;</span></span>:   2.0,
  <span><span>&#34;</span>API<span>&#34;</span></span>:       1.0
}</pre></div>
<p dir="auto">Once the files are in place, tar the model:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$ tar -czvf my-custom-model.tar.gz my-custom-model"><pre>$ tar -czvf my-custom-model.tar.gz my-custom-model</pre></div>
<p dir="auto">And you can import it via the GUI: Open translateLocally and go to <strong>Edit -&gt; Translator Settings -&gt; Languages -&gt; Import model</strong> and navigate to the archive you created.</p>

<p dir="auto">The process described above will create a model usable by translateLocally, albeit not a very efficient one. In order to create an efficient model we recommend that you quantise the model to 8-bit integers. You can do that by downloading and compiling the <a href="https://github.com/browsermt/marian-dev">Bergamot</a> fork of marian, and using <code>marian-conv</code> to create the quantised model:</p>
<div dir="auto" data-snippet-clipboard-copy-content="$MARIAN/marian-conv -f input_model.npz -t output_model.bin --gemm-type intgemm8"><pre><span>$MARIAN</span>/marian-conv -f input_model.npz -t output_model.bin --gemm-type intgemm8</pre></div>
<p dir="auto">And then changing your configuration <code>config.intgemm8bitalpha.yml</code> to point to this new model, as well as appending <code>gemm-precision: int8shift</code> to it.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Further increasing performance</h2><a id="user-content-further-increasing-performance" aria-label="Permalink: Further increasing performance" href="#further-increasing-performance"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><strong>For best results, we strongly recommend that you use student models.</strong> Instructions on how to create one + scripts can be found <a href="https://github.com/browsermt/students/tree/master/train-student">here</a> and a detailed video tutorial and explanations are available <a href="https://nbogoychev.com/efficient-machine-translation/" rel="nofollow">here</a>. Student models are typically at least 8X faster than teacher models such as the transformer-base preset.</p>
<p dir="auto">You can further achive another 30%-40% performance boost if you precompute the quantisation multipliers of the model and you use a lexical shortlist. The process for those is described in details at the Bergamot project&#39;s <a href="https://github.com/browsermt/students/tree/master/train-student#5-8-bit-quantization">Github</a>. Remember that you need to use the <a href="https://github.com/browsermt/marian-dev">Bergamot</a> fork of Marian.</p>
<p dir="auto">Example script that converts a marian model to the most efficient 8-bit representation can also be found at Bergamot&#39;s <a href="https://github.com/browsermt/students/blob/master/esen/esen.student.tiny11/speed.cpu.intgemm8bitalpha.sh">Github</a>.</p>

<p dir="auto">We support custom repositories. You can add a custom repository from the Settings-&gt;Repositories menu. An example repository file can seen <a href="https://translatelocally.com/models.json" rel="nofollow">here</a>. Currently available repositories:</p>
<ul dir="auto">
<li>Bergamot: <a href="https://translatelocally.com/models.json" rel="nofollow">https://translatelocally.com/models.json</a></li>
<li>OpusMT: <a href="https://object.pouta.csc.fi/OPUS-MT-models/app/models.json" rel="nofollow">https://object.pouta.csc.fi/OPUS-MT-models/app/models.json</a></li>
</ul>
<p dir="auto">The Bergamot repository is the one used by default. The OpusMT one needs to be added by the user, if the user desires to do so.</p>

<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/XapaJIaMnu/translateLocally/master/eu-logo.png"><img src="https://raw.githubusercontent.com/XapaJIaMnu/translateLocally/master/eu-logo.png" width="10%"/></a></p>
<p dir="auto">This project has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No 825303.</p>

<p dir="auto">This project was made possible through the combined effort of all researchers and partners in the Bergamot project <a href="https://browser.mt/partners/" rel="nofollow">https://browser.mt/partners/</a> . The translation models are prepared as part of the Bergamot project <a href="https://github.com/browsermt/students">https://github.com/browsermt/students</a> . The translation engine used is <a href="https://github.com/browsermt/bergamot-translator">https://github.com/browsermt/bergamot-translator</a> which is based on marian <a href="https://github.com/marian-nmt/marian-dev">https://github.com/marian-nmt/marian-dev</a> .</p>
</article></div></div>
  </body>
</html>
