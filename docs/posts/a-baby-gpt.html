<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://twitter.com/karpathy/status/1645115622517542913">Original</a>
    <h1>A Baby GPT</h1>
    
    <div id="readability-page-1" class="page"><div role="main"><div><div><div><div data-testid="primaryColumn"><div aria-label="Home timeline" tabindex="0"><div itemscope="" itemtype="https://schema.org/Collection"><meta content="Tweet with replies" itemprop="name"/><section aria-labelledby="accessible-list-52303" role="region"><div aria-label="Timeline: Conversation"><div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645115622517542913" itemprop="identifier"/><meta content="1" itemprop="position"/><meta content="172" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:25:03.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:25:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="mainEntityOfPage"/><article aria-labelledby="id__uq7pxmypzy id__c8b1jh967p id__znhda8wwofl id__wppwll2js3 id__kwchtp6fbg id__571lq9rqe7w id__z7husu7jec id__2rei8yh7qu8 id__qmw583p9yw id__5bd4utf9ynp id__9qwcqio1l3a id__58p4yttdhnu id__qaoljuqys29 id__obi7ml5pjde id__t9i1u0xfjtb id__2qvo2zq0qug id__6zrw7mr6mx id__94aapmtrg5c id__yzhrchsphfg" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-karpathy"><div><div><div><div><a href="https://twitter.com/karpathy" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1296667294148382721/9Pr6XrPB_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div><div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>This is a baby GPT with two tokens 0/1 and context length of 3, viewing it as a finite state markov chain. It was trained on the sequence &#34;111101111011110&#34; for 50 iterations. The parameters and the architecture of the Transformer modifies the probabilities on the arrows.

E.g. we can see that:
- state 101 deterministically transitions to 011 in the training data, so the probability of that transition becomes higher (79%). Not near 100% because we only did 50 steps of optimization.
- state 111 goes to 111 and 110 with 50% probability each, which the model almost learns (45%, 55%).
- states like 000 are never encountered during training, but have relatively sharp transition probabilities, e.g. 73% of going to 001. This is a consequence of inductive biases in the Transformer. One might imagine wanting this to be 50%, except in a real deployment almost every input sequence is unique, not present in the training data verbatim.

Not really sure where I was going with this :D, I think it&#39;s interesting to train/study tiny GPTs because it becomes tractable to visualize and get an intuitive sense of the entire dynamical system. Play with here: </span><a dir="ltr" href="https://t.co/8jdceMLpqy" rel="noopener noreferrer nofollow" target="_blank" role="link"><span aria-hidden="true">https://</span>colab.research.google.com/drive/1SiF0KZJ<span aria-hidden="true">p75rUeetKOWqpsA8clmHP6jMg?usp=sharing</span><span aria-hidden="true">â€¦</span></a></p></div></div></div><div><div aria-labelledby="id__ep1qyxi4l58 id__sx9f518ppsi" id="id__qaoljuqys29"><div><div><div><div><div><div role="button" tabindex="0"><div><div><div aria-label="Image" data-testid="tweetPhoto"><p><img alt="Image" draggable="true" src="https://pbs.twimg.com/media/FtSa2CGacAAVphm?format=jpg&amp;name=medium"/></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645136004116893698" itemprop="identifier"/><meta content="2" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T18:46:03.000Z" itemprop="dateCreated"/><meta content="2023-04-09T18:46:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/Coolzippity/status/1645136004116893698" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__j95sty7d3sj id__icbqk6pzs0a id__cyvkobat2sa id__f040nonbfe id__kp9o13lwftp id__eba36itodbd id__c9msa5olfsc id__8bicl5rdirj id__hvvzs8sc9q id__l5xh211dap9 id__qhrj4g32qvn id__ql0gg0bphpj id__74j7t96fepo id__eqgv8jqrlnl id__d5rq7emct5 id__imj4hgefkb id__3p682gevvxh id__4t8ify0uhqg id__gz2o2qf2c8p" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-Coolzippity"><div><div><div><div><a href="https://twitter.com/Coolzippity" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1637669643979456512/ApCMjnDm_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>What do these states represent in the case where we scale up this architecture? Agents? Prompts? Sections of a model? I&#39;m a bit confused.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645136877547311105" itemprop="identifier"/><meta content="3" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T18:49:31.000Z" itemprop="dateCreated"/><meta content="2023-04-09T18:49:31.000Z" itemprop="datePublished"/><meta content="https://twitter.com/karpathy/status/1645136877547311105" itemprop="url"/><meta content="https://twitter.com/Coolzippity/status/1645136004116893698" itemprop="isPartOf"/><article aria-labelledby="id__p6ht5r0ahjn id__vojoend78wa id__34ioj7ttmk4 id__gnyu2s1g6y id__tf19thaaky9 id__qp5q38vkpb id__w6f54girygj id__m7bgaxw3pgq id__1c788m1l1jw id__ecpt52ca139 id__hnlnyutoixw id__dttlobe58mh id__hxcbpj0txm id__n136rk24sm id__rw8ztwtx67 id__szb3wk4qw5o id__w7spichf3k id__d2o0fk2i3j id__cejt84hgea" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-karpathy"><div><div><div><div><a href="https://twitter.com/karpathy" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1296667294148382721/9Pr6XrPB_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645117608386265089" itemprop="identifier"/><meta content="4" itemprop="position"/><meta content="5" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:32:57.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:32:57.000Z" itemprop="datePublished"/><meta content="https://twitter.com/lanewinfield/status/1645117608386265089" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__ysz5aqm697 id__rjc0a16at7 id__k3penqsnu7b id__72jiixn4ylt id__rumce7t6yp id__xa14ucu3ngi id__ig6x8l5g9qm id__en0r1ntbiu id__73tdhqsvm8v id__owykteqn4n7 id__l61ueemci9l id__4ybfxjkd46d id__rxyc672z5x8 id__ooh1geuc0lj id__hpkp8f05lz id__er4mszq4ci id__mfm3ase94k id__8awqwnn6j4h id__igxy8xl3k1m" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-lanewinfield"><div><div><div><div><a href="https://twitter.com/lanewinfield" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/778975063102091264/-IujVfjH_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>this would make a sick tattoo</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645182967105331200" itemprop="identifier"/><meta content="5" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T21:52:40.000Z" itemprop="dateCreated"/><meta content="2023-04-09T21:52:40.000Z" itemprop="datePublished"/><meta content="https://twitter.com/vanjajaja1/status/1645182967105331200" itemprop="url"/><meta content="https://twitter.com/lanewinfield/status/1645117608386265089" itemprop="isPartOf"/><article aria-labelledby="id__49w0h2vtmqs id__64llg5vzjtk id__4eaybdh851h id__2hgbmq1vfwx id__0zxt3g9e7ec id__tv1cbmuebs8 id__i0r2v31x23b id__i2g16ldf3ep id__0z4w6j6eokn id__tru6psv9pte id__lsh7if1ol7k id__r27galo99ok id__m5q9qrt79q8 id__n24ulum5nt8 id__xnzpo2lbp6 id__c8qblcgrof id__cym1hyj3fno id__gyeion4sdv" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-vanjajaja1"><div><div><div><div><a href="https://twitter.com/vanjajaja1" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1602083773876559872/E5re0bTL_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645116126018379778" itemprop="identifier"/><meta content="6" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:27:03.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:27:03.000Z" itemprop="datePublished"/><meta content="https://twitter.com/shanytc/status/1645116126018379778" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__pldjoju2zi id__wpkkxf818f9 id__4zrl6unb9k id__yn3iydxl3gj id__5smp9ofuafc id__uqo9t54mb id__csbwhxba56g id__k3zrm6eq4ri id__q3awdtmn4et id__3sn8zqb7jc id__tnlmblvuls9 id__fpk2abrrwf id__rbr6mc32uq id__0sy89tddf539 id__5wu8q27wa6c id__z7q4tx3203h id__w039t6jjnnc id__qyx7jd0gayk id__x8agjwoc67b" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-shanytc"><div><div><div><div><a href="https://twitter.com/shanytc" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1631028104926732294/AHWT-6Pi_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645116231593365506" itemprop="identifier"/><meta content="7" itemprop="position"/><meta content="2" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:27:29.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:27:29.000Z" itemprop="datePublished"/><meta content="https://twitter.com/jasonprompts/status/1645116231593365506" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__qsm6spvhpep id__w94g6ackva id__ife5wb0ng9 id__fqj6fzfel5w id__1v6h4k9fvfa id__0c6dx4br2kj6 id__m9nqs6k7m3e id__bt6z6pwcxqc id__fymfebge2wu id__oyi9ygyd4xb id__e2tvxwjx4c8 id__m124cqyg0cb id__hgco409a07n id__c7c74qgi0gu id__5e9wd8e4hm8 id__6uy8znnwmxl id__h6ou1ae4zs id__69csa2xeq0u id__43qdvqd85pj" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-jasonprompts"><div><div><div><div><a href="https://twitter.com/jasonprompts" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1622300137484857344/f4sX9Epp_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Hmm...I don&#39;t understand it all quite yet, but I will </span><span>ðŸ«¡</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645116378880544768" itemprop="identifier"/><meta content="8" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:28:04.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:28:04.000Z" itemprop="datePublished"/><meta content="https://twitter.com/imPenny2x/status/1645116378880544768" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__xferspkzas id__08sr35yc4zml id__hn19k8kz3t8 id__dn5nznz5164 id__yi7n0fjidhl id__qc4wzy03et id__vj51fzvo95 id__d4etj7yacqc id__87a2xzqkt1e id__53bix592vcu id__rzfr4jutox id__szam2q943b id__12ncx5dsi41 id__iac51jhncc id__2ort1femi3 id__83twng04qft id__c77g2vih5pn id__km5wn8151bq id__jawb8zmrhy" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-imPenny2x"><div><div><div><div><a href="https://twitter.com/imPenny2x" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1522426659047034880/SzltT3Vm_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Very cool, thx for sharing.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645116809014829059" itemprop="identifier"/><meta content="9" itemprop="position"/><meta content="3" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:29:46.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:29:46.000Z" itemprop="datePublished"/><meta content="https://twitter.com/macmaniac77/status/1645116809014829059" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__juf1otvhfup id__jdi20f4e54 id__vwwuy9cmgc id__g11l6c8efej id__ipu22h7lvas id__o5xskyvnshd id__2iks3m6dj9n id__floccfkoesf id__ie40ovwdl9 id__1o4631sms7c id__qpsr901qhn id__90zt8snsvtn id__0d77lfz62ja id__fd372fqccre id__hdub79gwz0f id__2kyshnkvu7d id__jtulf0zkmke id__s8ol35s64tq id__yp630kky8t" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-macmaniac77"><div><div><div><div><a href="https://twitter.com/macmaniac77" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/832671409117605888/XgksqEsZ_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Iâ€™m curious how overfitting manifests. In my utterly novice understanding I imagined a situation where a label is </span><span>ðŸ’¯</span><span> certain, why wouldnâ€™t we want that training data to reflect that confidence?

I wanted to identify ping and ping sounds on one side or another of a table.</span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645124301086146561" itemprop="identifier"/><meta content="10" itemprop="position"/><meta content="0" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:59:32.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:59:32.000Z" itemprop="datePublished"/><meta content="https://twitter.com/cometaj2/status/1645124301086146561" itemprop="url"/><meta content="https://twitter.com/macmaniac77/status/1645116809014829059" itemprop="isPartOf"/><article aria-labelledby="id__p1ckvwuq7cp id__i8edpixpad8 id__zha9zuo1vz id__refhgalw6z id__i1a3mbsbkxj id__gdg39qvlxt id__fpqufsgueo id__w0fj0jdx7xm id__dq2w0d21fs id__xptjg4tyosr id__hiwjhfzex05 id__3wantcxouyo id__vpdraw349s id__f5kxjryumvv id__ssiul52guio id__bl5eq16vre7 id__kjns54lzay id__dxayivn3shl id__5xxg7wdenyx" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-cometaj2"><div><div><div><div><a href="https://twitter.com/cometaj2" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/908494996331929600/o37kNmAx_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>Overfitting means no flexibility for creative but coherent variation on classification (answers) given variable inputs; in other words, and overfitted model wouldnâ€™t be able to  accommodate well for what looks like a duck, quacks like a duck, but isnâ€™t quite completely duck-likeâ€¦</span><span tabindex="0" data-testid="tweet-text-show-more-link-1645124301086146561"><span>Â </span><span>Show more</span></span></p></div></div></div></div></div></div></article></div></div><div><div itemprop="hasPart" itemscope="" itemtype="https://schema.org/SocialMediaPosting"><meta content="1645119030871687168" itemprop="identifier"/><meta content="11" itemprop="position"/><meta content="1" itemprop="commentCount"/><meta content="" itemprop="contentRating"/><meta content="2023-04-09T17:38:36.000Z" itemprop="dateCreated"/><meta content="2023-04-09T17:38:36.000Z" itemprop="datePublished"/><meta content="https://twitter.com/snowman647/status/1645119030871687168" itemprop="url"/><meta content="https://twitter.com/karpathy/status/1645115622517542913" itemprop="isPartOf"/><article aria-labelledby="id__c3hx1n9cv7g id__6gqc6eu0ehb id__t8a77q5lnif id__3kgux0cth3f id__bllpuos6dxu id__hicrpltcmkp id__susd9jh3cf id__sq4y1jvv9v id__9vv1mtc9zhw id__3m9yi7jcqy4 id__rvou0kdl2xb id__jngetto5t8 id__nig2e14ptf id__9061qh7vup id__lucx24kqgwq id__q2uj6iud33g id__zjuqaddmbxb id__jb6o1ar0dm id__y4385jto3c9" role="article" tabindex="-1" data-testid="tweet"><div><div><div><div><div data-testid="Tweet-User-Avatar"><div><div><div data-testid="UserAvatar-Container-snowman647"><div><div><div><div><a href="https://twitter.com/snowman647" aria-hidden="true" role="link" tabindex="-1"><div><div><div><div aria-label=""><p><img alt="" draggable="true" src="https://pbs.twimg.com/profile_images/1621483031218241537/h0gzBuaq_400x400.jpg"/></p></div></div></div></div></a></div></div></div></div></div></div></div></div></div><div><div itemprop="articleBody" data-testid="tweetTextAnnotations"><div><p><span>What&#39;s next? Maybe predicting the next prime number.</span></p></div></div></div></div></div></div></article></div></div></div></div></section></div></div></div></div></div></div></div></div>
  </body>
</html>
