<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/operand/agency">Original</a>
    <h1>Show HN: Agency â€“ Unifying human, AI, and other computing systems, in Python</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text">
<p dir="auto">A fast and minimal foundation for unifying human, AI, and other computing
systems, in python</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-what-is-agency" aria-hidden="true" href="#what-is-agency"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What is <code>agency</code>?</h2>
<p dir="auto"><code>agency</code> defines a common communication and action framework for integrating
AI agents, humans, and traditional computing systems.</p>
<p dir="auto"><code>agency</code> allows you to establish shared environments called &#34;spaces&#34; where any
number of humans, artificial, or other computing systems may equally address
each other as individual &#34;agents&#34; that you may perform &#34;actions&#34; on.</p>
<p dir="auto"><code>agency</code> handles the details of the common messaging protocol and allows
discovering and invoking actions across all parties, automatically handling
things such as reporting exceptions, enforcing access restrictions, and more.</p>
<p dir="auto">The API accommodates agent integration with systems as varied as:</p>
<ul dir="auto">
<li>UI driven applications</li>
<li>terminal environments</li>
<li>software APIs</li>
<li>other AI agents</li>
<li>people</li>
<li>...</li>
<li>anything</li>
</ul>

<blockquote>
<p dir="auto"><strong>WARNING:</strong></p>
</blockquote>


<p dir="auto"><code>agency</code> is an implementation of the <a href="https://en.wikipedia.org/wiki/Actor_model" rel="nofollow">Actor
model</a> intended for integrating AI,
human, and traditional computing systems.</p>
<p dir="auto">In <code>agency</code>, all entities are called &#34;agents&#34; and represented as instances
of the <code>Agent</code> class. This includes all humans, software, and AI-driven agents.</p>
<p dir="auto">The <code>Agent</code> class is a base class similar to &#34;Object&#34; in many object-oriented
languages. All agents may expose &#34;actions&#34; that other agents can discover and
invoke at run time. Actions also specify an access policy, allowing you to
monitor and control actions to ensure safety.</p>
<p dir="auto">A <code>Space</code> is also an <code>Agent</code> and is used to group multiple agents together.</p>
<p dir="auto">A space can be thought of as both a collection of agents and a &#34;router&#34; for
their communication. An agent cannot communicate with others until it is first
added to a space.</p>
<p dir="auto">Spaces may be nested, allowing for namespacing and hierarchical organization of
the agents in your application.</p>
<p dir="auto">To summarize, the two classes of <code>Agent</code> and <code>Space</code> together create a simple
API for creating applications that may mix AI, human, and traditional computing
systems, in a way that is intended for all to equally understand and use.</p>
<p dir="auto">Let&#39;s walk through a thorough example to see how this works in practice.</p>

<blockquote>
<p dir="auto">Please note that the example classes used in this walkthrough are implemented
for you to explore and try out, but should be considered &#34;proof of concept&#34;
quality at this time.</p>
</blockquote>
<h2 tabindex="-1" dir="auto"><a id="user-content-creating-a-space" aria-hidden="true" href="#creating-a-space"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Creating a <code>Space</code></h2>
<p dir="auto">Let&#39;s start by instantiating a demo space.</p>
<div dir="auto" data-snippet-clipboard-copy-content="space = Space(&#34;DemoSpace&#34;)"><pre><span>space</span> <span>=</span> <span>Space</span>(<span>&#34;DemoSpace&#34;</span>)</pre></div>
<p dir="auto"><code>Space</code>&#39;s, like all <code>Agent</code>&#39;s, must be given an <code>id</code>. So the line above
instantiates a single space called <code>&#34;DemoSpace&#34;</code> that we can now add agents to.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-adding-an-agent-to-a-space" aria-hidden="true" href="#adding-an-agent-to-a-space"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Adding an <code>Agent</code> to a <code>Space</code></h2>
<p dir="auto">Now, let&#39;s add our first agent to the space, a simple transformers library
backed chatbot class named <code>ChattyAI</code>. You can browse the source code for
<code>ChattyAI</code> <a href="https://github.com/operand/agency/blob/main/agency/agents/chattyai.py">here</a>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="space.add(ChattyAI(&#34;Chatty&#34;, model=&#34;EleutherAI/gpt-neo-125m&#34;))"><pre><span>space</span>.<span>add</span>(<span>ChattyAI</span>(<span>&#34;Chatty&#34;</span>, <span>model</span><span>=</span><span>&#34;EleutherAI/gpt-neo-125m&#34;</span>))</pre></div>
<p dir="auto">The line above adds a new <code>ChattyAI</code> instance to the space, with the <code>id</code> of
<code>&#34;Chatty&#34;</code>. It also passes the <code>model</code> argument to the constructor, which is
used to initialize the HuggingFace transformers language model.</p>
<p dir="auto">At this point &#34;Chatty&#34; has a fully qualified <code>id</code> of <code>&#34;Chatty.DemoSpace&#34;</code>.  This
is because <code>&#34;Chatty&#34;</code> is a member of the <code>&#34;DemoSpace&#34;</code> space.</p>
<p dir="auto">This way, spaces establish a namespace for their member agents which can later
be used to address them.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-defining-actions" aria-hidden="true" href="#defining-actions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Defining Actions</h2>
<p dir="auto">Looking at <code>ChattyAI</code>&#39;s source code, you&#39;ll see that it is a subclass of
<code>Agent</code>, and that it exposes a single action called <code>say</code>.</p>
<p dir="auto">The <code>say</code> action is defined as a method on the <code>ChattyAI</code> class, using the
following signature:</p>
<div dir="auto" data-snippet-clipboard-copy-content="def _action__say(self, content: str):
    &#34;&#34;&#34;Use this action to say something to Chatty&#34;&#34;&#34;
    ..."><pre><span>def</span> <span>_action__say</span>(<span>self</span>, <span>content</span>: <span>str</span>):
    <span>&#34;&#34;&#34;Use this action to say something to Chatty&#34;&#34;&#34;</span>
    ...</pre></div>
<p dir="auto">The prefix <code>_action__</code> is used to indicate that this is an action that can be
invoked by other agents. The suffix <code>say</code> is the name of the action.</p>
<p dir="auto">The <code>say</code> action takes a single string argument <code>content</code>. This action is
intended to allow other agents to chat with Chatty, as expressed in its
docstring.</p>
<p dir="auto">When <code>ChattyAI</code> receives a <code>say</code> action, it will generate a response using its
prompt format with the language model, and return the result to the sender.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-invoking-actions" aria-hidden="true" href="#invoking-actions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Invoking Actions</h2>
<p dir="auto">At the end of the <code>ChattyAI._action__say()</code> method, we see an example of using
<code>agency</code>&#39;s messaging protocol. <code>ChattyAI</code> returns a response to the sender
by calling:</p>
<div dir="auto" data-snippet-clipboard-copy-content="...
self._send({
    &#34;to&#34;: self._current_message[&#39;from&#39;],
    &#34;thoughts&#34;: &#34;&#34;,
    &#34;action&#34;: &#34;say&#34;,
    &#34;args&#34;: {
      &#34;content&#34;: response_content,
    }
})"><pre>...
<span>self</span>.<span>_send</span>({
    <span>&#34;to&#34;</span>: <span>self</span>.<span>_current_message</span>[<span>&#39;from&#39;</span>],
    <span>&#34;thoughts&#34;</span>: <span>&#34;&#34;</span>,
    <span>&#34;action&#34;</span>: <span>&#34;say&#34;</span>,
    <span>&#34;args&#34;</span>: {
      <span>&#34;content&#34;</span>: <span>response_content</span>,
    }
})</pre></div>
<p dir="auto">This is a simple implementation that demonstrates the basic idea of how to
invoke an action on another agent.</p>
<p dir="auto">When an agent receives a message, it invokes the action method specified in by
the <code>&#34;action&#34;</code> field of the message, passing the <code>&#34;args&#34;</code> to the action method
as keyword arguments.</p>
<p dir="auto">So here we see that Chatty is invoking the <code>say</code> action on the sender of the
original message, passing the response as the <code>&#34;content&#34;</code> argument.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-the-common-message-schema" aria-hidden="true" href="#the-common-message-schema"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>The Common Message Schema</h2>
<p dir="auto">In the example above, we see the format that is used when sending actions.</p>
<p dir="auto">In describing the messaging format, there are two terms that are used similarly:
&#34;action&#34; and &#34;message&#34;.</p>
<p dir="auto">An &#34;action&#34; is the format you use when sending, as seen in the <code>_send()</code> call
above. You do not specify the <code>&#34;from&#34;</code> field, as it will be automatically added
when routing.</p>
<p dir="auto">A &#34;message&#34; then, is a &#34;received action&#34; which includes the additional
<code>&#34;from&#34;</code> field containing the sender&#39;s fully qualified <code>id</code>.</p>
<p dir="auto">Continuing the example above, the original sender would receive a response
message from Chatty that would look something like:</p>
<div dir="auto" data-snippet-clipboard-copy-content="{
    &#34;from&#34;: &#34;Chatty.DemoSpace&#34;,
    &#34;to&#34;: &#34;Sender.DemoSpace&#34;,
    &#34;thoughts&#34;: &#34;&#34;,
    &#34;action&#34;: &#34;say&#34;,
    &#34;args&#34;: {
      &#34;content&#34;: &#34;Whatever Chatty said&#34;,
    }
}"><pre>{
    <span>&#34;from&#34;</span>: <span>&#34;Chatty.DemoSpace&#34;</span>,
    <span>&#34;to&#34;</span>: <span>&#34;Sender.DemoSpace&#34;</span>,
    <span>&#34;thoughts&#34;</span>: <span>&#34;&#34;</span>,
    <span>&#34;action&#34;</span>: <span>&#34;say&#34;</span>,
    <span>&#34;args&#34;</span>: {
      <span>&#34;content&#34;</span>: <span>&#34;Whatever Chatty said&#34;</span>,
    }
}</pre></div>
<p dir="auto">This is an example of the full message schema that is used for all messages sent
between agents in <code>agency</code>. This format is intended to be simple and extensible
enough to support any use case while remaining human readable.</p>
<p dir="auto">Note that the <code>&#34;thoughts&#34;</code> field is defined as a distinct argument for providing
a natural language explanation to accompany any action, but as of this writing
<code>ChattyAI</code> does not make use of it. <code>OpenAICompletionAgent</code> discussed below,
does.</p>
<p dir="auto">For more details on the common message schema see
<a href="https://github.com/operand/agency/blob/main/agency/schema.py">schema.py</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-access-control" aria-hidden="true" href="#access-control"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Access Control</h2>
<p dir="auto">All actions must declare an access policy like the following example seen above
the <code>ChattyAI._action__say()</code> method:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@access_policy(ACCESS_PERMITTED)
def _action__say(self, content: str):
    &#34;&#34;&#34;Use this action to say something to Chatty&#34;&#34;&#34;
    ..."><pre><span>@<span>access_policy</span>(<span>ACCESS_PERMITTED</span>)</span>
<span>def</span> <span>_action__say</span>(<span>self</span>, <span>content</span>: <span>str</span>):
    <span>&#34;&#34;&#34;Use this action to say something to Chatty&#34;&#34;&#34;</span>
    ...</pre></div>
<p dir="auto">Access policies are used to control what actions can be invoked by other agents.</p>
<p dir="auto">An access policy can currently be one of three values:</p>
<ul dir="auto">
<li><code>ACCESS_PERMITTED</code> - which permits any agent to use that action at
any time</li>
<li><code>ACCESS_DENIED</code> - which prevents use</li>
<li><code>ACCESS_REQUESTED</code> - which will prompt the receiving agent for permission
when access is attempted. Access will await approval or denial. If denied, the
sender is notified of the denial.</li>
</ul>
<p dir="auto">If <code>ACCESS_REQUESTED</code> is used, the receiving agent will be prompted at run
time to approve the action.</p>
<p dir="auto">If any actions require permission, you must implement the
<code>_request_permission()</code> method with the following signature:</p>
<div dir="auto" data-snippet-clipboard-copy-content="def _request_permission(self, proposed_message: MessageSchema) -&gt; bool:
    ..."><pre><span>def</span> <span>_request_permission</span>(<span>self</span>, <span>proposed_message</span>: <span>MessageSchema</span>) <span>-&gt;</span> <span>bool</span>:
    ...</pre></div>
<p dir="auto">This method is called when an agent attempts to invoke an action that has been
marked as <code>ACCESS_REQUESTED</code>. Your method should inspect <code>proposed_message</code> and
return a boolean indicating whether or not to permit the action.</p>
<p dir="auto">You can use this approach to protect against dangerous actions being taken. For
example if you allow terminal access, you may want to review commands before
they are invoked.</p>
<p dir="auto">This implementation of access control is just a start, and further development
of the functionality is a priority for this project.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-adding-human-users-with-the-webapp-class" aria-hidden="true" href="#adding-human-users-with-the-webapp-class"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Adding Human Users With the <code>WebApp</code> Class</h2>
<p dir="auto">A single chatting AI wouldn&#39;t be useful without someone to chat with, so now
let&#39;s add humans into the space so that they can chat with &#34;Chatty&#34;. To do
this, we&#39;ll use the <code>WebApp</code> class, which is a subclass of <code>Space</code>.</p>
<p dir="auto">Why choose to subclass <code>Space</code> and not <code>Agent</code>? This is an arbitrary choice up
to the developer, and may depend on what they want to accomplish.</p>
<p dir="auto">We could implement <code>WebApp</code> as a subclass of <code>Agent</code>. This would represent the
web application as a single agent within the system. Users of the web
application would not be able to be addressed individually by other agents.</p>
<p dir="auto">But since a typical web application serves multiple users, it may make sense to
implement it as a <code>Space</code> subclass, so that individual users of the web
application can be addressed by other agents using a namespace associated with
the web application, as we&#39;ll see below.</p>
<p dir="auto">So this is <em>not</em> the only way this could be accomplished but is intended as a
complex example to showcase why one might want to define a <code>Space</code> subclass to
group agents when it makes sense.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-examining-the-webapp-class" aria-hidden="true" href="#examining-the-webapp-class"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Examining the <code>WebApp</code> Class</h3>
<p dir="auto">The implementation located <a href="https://github.com/operand/agency/blob/main/agency/spaces/web_app.py">here</a> defines a simple
<code>Flask</code> based web application that hosts a single page <code>React</code> based chat UI.</p>
<p dir="auto">The implementation takes some shortcuts, but in it you&#39;ll see that we actually
define two classes, one for the web application which extends <code>Space</code>, called
<code>WebApp</code>, and a second class to represent users of the web app which extends
<code>Agent</code> and is called <code>WebAppUser</code>.</p>
<p dir="auto">The <code>WebAppUser</code> class is where we define the actions that an individual web app
user may expose to others.</p>
<p dir="auto">Using the <code>asyncio</code> library you&#39;ll see that we simply forward messages as-is to
the <code>React</code> frontend, and allow the client code to handle rendering and parsing
of input as actions back to the <code>Flask</code> application, which forwards them to
their intended receiver in the space.</p>
<p dir="auto">This way, we allow individual web users to appear as individual agents to others
in the space.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-namespacing-and-adding-the-web-application" aria-hidden="true" href="#namespacing-and-adding-the-web-application"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Namespacing and Adding the Web Application</h2>
<p dir="auto">Now that we&#39;ve defined our new <code>WebApp</code> class, we can add it to <code>DemoSpace</code>
with:</p>
<div dir="auto" data-snippet-clipboard-copy-content="space.add(
    WebApp(&#34;WebApp&#34;, port=&#39;8080&#39;))"><pre><span>space</span>.<span>add</span>(
    <span>WebApp</span>(<span>&#34;WebApp&#34;</span>, <span>port</span><span>=</span><span>&#39;8080&#39;</span>))</pre></div>
<p dir="auto">Whenever any agent is added to a space, its fully qualified <code>id</code> becomes
namespaced with the space&#39;s <code>id</code>.</p>
<p dir="auto">For example, after running the line above the <code>WebApp</code> being an agent as well,
receives an <code>id</code> of <code>&#34;WebApp.DemoSpace&#34;</code>.</p>
<p dir="auto">At this point, we have integrated the following agents listed using their fully
qualified <code>id</code>&#39;s:</p>
<ul dir="auto">
<li><code>&#34;DemoSpace&#34;</code> - The root space</li>
<li><code>&#34;ChattyAI.DemoSpace&#34;</code> - ChattyAI&#39;s fully qualified <code>id</code></li>
<li><code>&#34;WebApp.DemoSpace&#34;</code> - the root of the <code>&#34;WebApp&#34;</code> space</li>
</ul>
<p dir="auto">Users of the web application, as they log in or out, may be added dynamically
under the <code>&#34;WebApp&#34;</code> namespace allowing them to be addressed with a fully
qualified <code>id</code> of, for example:</p>
<ul dir="auto">
<li><code>&#34;Dan.WebApp.DemoSpace&#34;</code>.</li>
</ul>
<p dir="auto"><em>(Note that login/out functionality is not implemented as of this writing.)</em></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-adding-os-access-with-the-host-class" aria-hidden="true" href="#adding-os-access-with-the-host-class"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Adding OS Access with the <code>Host</code> class</h2>
<p dir="auto">At this point, we have a system where human users of the web application can
chat with <code>ChattyAI</code>, using just a single action called <code>&#34;say&#34;</code> that both
<code>Agent</code> classes implement.</p>
<p dir="auto">Now we&#39;ll add an agent that exposes many different actions, the
<a href="https://github.com/operand/agency/blob/main/agency/agents/host.py"><code>Host</code></a> class.</p>

<p dir="auto">The <code>Host</code> class allows access to the host operating system where the python
application is running. It exposes actions such as <code>read_file</code> and
<code>shell_command</code> which allow other agents to interact with the host.</p>
<p dir="auto">This class is a good example of one with potentially dangerous actions that need
to be accessed with care. You&#39;ll notice that all the methods in the <code>Host</code> class
have been given the access policy:</p>
<div dir="auto" data-snippet-clipboard-copy-content="@access_policy(ACCESS_REQUESTED)"><pre><span>@<span>access_policy</span>(<span>ACCESS_REQUESTED</span>)</span></pre></div>
<p dir="auto">By declaring this access policy, all actions on the host will require a
confirmation from the terminal where the application is being run. This is
thanks to the implementation of <code>_request_permission()</code> in the <code>Host</code> class.</p>
<p dir="auto">Note that this implementation of <code>_request_permission()</code> is just one
possibility. We could have implemented, for example, a phone notification for a
human to review from elsewhere.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-discovering-actions" aria-hidden="true" href="#discovering-actions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Discovering Actions</h2>
<p dir="auto">At this point, we can demonstrate how discovery works from the perspective of
a human user of the web application.</p>
<p dir="auto">Once added to a space, each agent may send a <code>help</code> message to discover other
agents and actions that are available in the space.</p>
<p dir="auto">The <code>WebApp</code> application hosts a simple chat UI that supports a &#34;slash&#34; syntax
summarized here:</p>
<div dir="auto" data-snippet-clipboard-copy-content="/actionname arg1:val1 arg2:val2 ..."><pre><span>/</span><span>actionname</span> <span>arg1</span>:<span>val1</span> <span>arg2</span>:<span>val2</span> ...</pre></div>
<p dir="auto">So a person using the chat UI can discover available actions by typing:</p>

<p dir="auto">This will broadcast a <code>help</code> action to all other agents, who will individually
respond with a list of their available actions. The returned list of actions
would look something like:</p>
<div dir="auto" data-snippet-clipboard-copy-content="[
    {
        &#34;to&#34;: &#34;Host.DemoSpace&#34;,
        &#34;action&#34;: &#34;delete_file&#34;,
        &#34;thoughts&#34;: &#34;Delete a file&#34;,
        &#34;args&#34;: {
          &#34;filepath&#34;: &#34;str&#34;
        }
    },
    {
        &#34;to&#34;: &#34;Host.DemoSpace&#34;,
        &#34;action&#34;: &#34;list_files&#34;,
        &#34;thoughts&#34;: &#34;List files in a directory&#34;,
        &#34;args&#34;: {
          &#34;directory_path&#34;: &#34;str&#34;
        }
    },
    {
        &#34;to&#34;: &#34;ChattyAI.DemoSpace&#34;,
        &#34;action&#34;: &#34;say&#34;,
        &#34;thoughts&#34;: &#34;Use this action to say something to Chatty&#34;,
        &#34;args&#34;: {
          &#34;content&#34;: &#34;str&#34;
        }
    },
    ...
]"><pre>[
    {
        <span>&#34;to&#34;</span>: <span>&#34;Host.DemoSpace&#34;</span>,
        <span>&#34;action&#34;</span>: <span>&#34;delete_file&#34;</span>,
        <span>&#34;thoughts&#34;</span>: <span>&#34;Delete a file&#34;</span>,
        <span>&#34;args&#34;</span>: {
          <span>&#34;filepath&#34;</span>: <span>&#34;str&#34;</span>
        }
    },
    {
        <span>&#34;to&#34;</span>: <span>&#34;Host.DemoSpace&#34;</span>,
        <span>&#34;action&#34;</span>: <span>&#34;list_files&#34;</span>,
        <span>&#34;thoughts&#34;</span>: <span>&#34;List files in a directory&#34;</span>,
        <span>&#34;args&#34;</span>: {
          <span>&#34;directory_path&#34;</span>: <span>&#34;str&#34;</span>
        }
    },
    {
        <span>&#34;to&#34;</span>: <span>&#34;ChattyAI.DemoSpace&#34;</span>,
        <span>&#34;action&#34;</span>: <span>&#34;say&#34;</span>,
        <span>&#34;thoughts&#34;</span>: <span>&#34;Use this action to say something to Chatty&#34;</span>,
        <span>&#34;args&#34;</span>: {
          <span>&#34;content&#34;</span>: <span>&#34;str&#34;</span>
        }
    },
    ...
]</pre></div>
<p dir="auto">Notice that each action lists the fully qualified <code>id</code> of the agent in the
<code>&#34;to&#34;</code> field, the docstring of the action&#39;s method in the <code>&#34;thoughts&#34;</code> field,
and each argument along with its type in the <code>&#34;args&#34;</code> field.</p>
<p dir="auto">So a person using the web app UI can invoke the <code>list_files</code> action on
<code>&#34;Host.DemoSpace&#34;</code> with the following syntax:</p>
<div data-snippet-clipboard-copy-content="/list_files to:Host.DemoSpace directory_path:/app"><pre><code>/list_files to:Host.DemoSpace directory_path:/app
</code></pre></div>
<p dir="auto">This will send the <code>list_files</code> action to the <code>Host</code> agent who will (after being
granted permission) return the results back to <code>&#34;Dan.WebApp.DemoSpace&#34;</code>
rendering it to the web user interface as a message.</p>
<p dir="auto">Note the use of the fully qualified <code>id</code> of <code>Host.DemoSpace</code> used with the <code>to:</code>
field.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-broadcast-vs-point-to-point-messaging" aria-hidden="true" href="#broadcast-vs-point-to-point-messaging"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Broadcast vs Point-to-Point Messaging</h2>
<p dir="auto">If we omit the <code>to:Host.DemoSpace</code> portion of the command above, the message
will be broadcast, and any agents who implement a <code>list_files</code> action will
respond.</p>
<p dir="auto">This is also how the <code>/help</code> command works. If you want to request help from
just a single agent you can use something like:</p>

<p dir="auto">Note that point-to-point messages (messages that define the <code>&#34;to&#34;</code> field) will
result in an error if the action is not defined on the target agent.</p>
<p dir="auto">Broadcast messages will <em>not</em> return an error, but will silently be ignored by
agents who do not implement the given action.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-adding-an-environment-aware-agent" aria-hidden="true" href="#adding-an-environment-aware-agent"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Adding an Environment-Aware Agent</h2>
<p dir="auto">Finally we get to the good part!</p>
<p dir="auto">We&#39;ll now add an intelligent agent into this environment and see that it is able
to understand and interact with any of the systems or humans we&#39;ve connected
thus far.</p>
<blockquote>
<p dir="auto">Note that the following <code>OpenAIFunctionAgent</code> class uses the newly released
<a href="https://platform.openai.com/docs/guides/gpt/function-calling" rel="nofollow">openai function calling
API</a>.</p>
</blockquote>
<p dir="auto">To add the <a href="https://github.com/operand/agency/blob/main/agency/agents/demo_agent.py"><code>OpenAIFunctionAgent</code></a> class to the
environment:</p>
<div dir="auto" data-snippet-clipboard-copy-content="space.add(
    OpenAIFunctionAgent(&#34;FunctionAI&#34;,
        model=&#34;gpt-3.5-turbo-16k&#34;,
        openai_api_key=os.getenv(&#34;OPENAI_API_KEY&#34;),
        # user_id determines the &#34;user&#34; role in the chat API
        user_id=&#34;Dan.WebApp.DemoSpace&#34;))"><pre><span>space</span>.<span>add</span>(
    <span>OpenAIFunctionAgent</span>(<span>&#34;FunctionAI&#34;</span>,
        <span>model</span><span>=</span><span>&#34;gpt-3.5-turbo-16k&#34;</span>,
        <span>openai_api_key</span><span>=</span><span>os</span>.<span>getenv</span>(<span>&#34;OPENAI_API_KEY&#34;</span>),
        <span># user_id determines the &#34;user&#34; role in the chat API</span>
        <span>user_id</span><span>=</span><span>&#34;Dan.WebApp.DemoSpace&#34;</span>))</pre></div>
<p dir="auto">The <code>user_id</code> argument determines which agent is represented as the &#34;user&#34; role
to the chat API. Since the chat API is limited to a predefined set of roles, we
need to indicate which is the main &#34;user&#34;.</p>
<p dir="auto">For an implementation that uses a plain text completion API, see
<a href="https://github.com/operand/agency/blob/main/agency/agents/openai_completion_agent.py"><code>OpenAICompletionAgent</code></a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-complete-demo-implementation" aria-hidden="true" href="#complete-demo-implementation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Complete Demo Implementation</h2>
<p dir="auto">The following is the full implementation (minus imports) of the above
walkthrough that you can try out on your own, including both OpenAI agent
examples and the HuggingFace based &#34;Chatty&#34;. Note that <code>Space.run()</code> starts a
thread, so we simply keep the application alive with a while loop.</p>
<div dir="auto" data-snippet-clipboard-copy-content="# demo.py

if __name__ == &#39;__main__&#39;:

    space = Space(&#34;DemoSpace&#34;) 

    space.add(
        WebApp(&#34;WebApp&#34;,
            demo_user_id=&#34;Dan&#34;, # hardcoded for simplicity
            port=&#39;8080&#39;))

    space.add(
        ChattyAI(&#34;Chatty&#34;,
            model=&#34;EleutherAI/gpt-neo-125m&#34;))

    space.add(
        Host(&#34;Host&#34;))

    space.add(
        OpenAIFunctionAgent(&#34;FunctionAI&#34;,
            model=&#34;gpt-3.5-turbo-16k&#34;,
            openai_api_key=os.getenv(&#34;OPENAI_API_KEY&#34;),
            # user_id determines the &#34;user&#34; role in the OpenAI chat
            user_id=&#34;Dan.WebApp.DemoSpace&#34;))

    space.add(
        OpenAICompletionAgent(&#34;CompletionAI&#34;,
            model=&#34;text-davinci-003&#34;,
            openai_api_key=os.getenv(&#34;OPENAI_API_KEY&#34;)))

    space.run()

    print(&#34;pop!&#34;)

    # keep alive
    while True:
        time.sleep(1)"><pre><span># demo.py</span>

<span>if</span> <span>__name__</span> <span>==</span> <span>&#39;__main__&#39;</span>:

    <span>space</span> <span>=</span> <span>Space</span>(<span>&#34;DemoSpace&#34;</span>) 

    <span>space</span>.<span>add</span>(
        <span>WebApp</span>(<span>&#34;WebApp&#34;</span>,
            <span>demo_user_id</span><span>=</span><span>&#34;Dan&#34;</span>, <span># hardcoded for simplicity</span>
            <span>port</span><span>=</span><span>&#39;8080&#39;</span>))

    <span>space</span>.<span>add</span>(
        <span>ChattyAI</span>(<span>&#34;Chatty&#34;</span>,
            <span>model</span><span>=</span><span>&#34;EleutherAI/gpt-neo-125m&#34;</span>))

    <span>space</span>.<span>add</span>(
        <span>Host</span>(<span>&#34;Host&#34;</span>))

    <span>space</span>.<span>add</span>(
        <span>OpenAIFunctionAgent</span>(<span>&#34;FunctionAI&#34;</span>,
            <span>model</span><span>=</span><span>&#34;gpt-3.5-turbo-16k&#34;</span>,
            <span>openai_api_key</span><span>=</span><span>os</span>.<span>getenv</span>(<span>&#34;OPENAI_API_KEY&#34;</span>),
            <span># user_id determines the &#34;user&#34; role in the OpenAI chat</span>
            <span>user_id</span><span>=</span><span>&#34;Dan.WebApp.DemoSpace&#34;</span>))

    <span>space</span>.<span>add</span>(
        <span>OpenAICompletionAgent</span>(<span>&#34;CompletionAI&#34;</span>,
            <span>model</span><span>=</span><span>&#34;text-davinci-003&#34;</span>,
            <span>openai_api_key</span><span>=</span><span>os</span>.<span>getenv</span>(<span>&#34;OPENAI_API_KEY&#34;</span>)))

    <span>space</span>.<span>run</span>()

    <span>print</span>(<span>&#34;pop!&#34;</span>)

    <span># keep alive</span>
    <span>while</span> <span>True</span>:
        <span>time</span>.<span>sleep</span>(<span>1</span>)</pre></div>
<p dir="auto">If you run the above python script, after a short boot time you can visit the
web app at <code>http://localhost:8080</code> and you should see a simple chat interface.</p>
<p dir="auto">The following is a screenshot of a conversation that showcases all the agents
intelligently interacting and following orders.</p>
<p dir="auto">Note that my messages are broadcasted in the below conversation, which explains
why all three respond to each message. There is an obvious difference in
quality, of course.</p>
<p dir="auto">I also demonstrate the results of rejecting an action and directing an agent to
use a different approach.</p>
<p dir="auto">After I explained my rejection of the <code>read_file</code> action (which happened behind
the scenes on the terminal), &#34;FunctionAI&#34; appropriately used the <code>shell_command</code>
action with <code>wc -l Dockerfile</code>. The Dockerfile indeed has 73 lines.</p>
<p dir="auto">CompletionAI used that command on the first try. Anecdotally as of this writing,
<code>CompletionAI</code> seems to be more accurate, even though it is using the text
completion API vs the function calling feature of the chat API. This may be due
to the implementation or issues arising from the translation into roles
discussed elsewhere.</p>
<p dir="auto">
  <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/e456241994556f8813ee73b4ae269ce1772fbf70f09db2861c97a0b5c691f0f6/68747470733a2f2f692e6962622e636f2f6e62764c4a76672f53637265656e73686f742d323032332d30362d31342d61742d332d35392d30312d414d2e706e67"><img src="https://camo.githubusercontent.com/e456241994556f8813ee73b4ae269ce1772fbf70f09db2861c97a0b5c691f0f6/68747470733a2f2f692e6962622e636f2f6e62764c4a76672f53637265656e73686f742d323032332d30362d31342d61742d332d35392d30312d414d2e706e67" alt="Screenshot-2023-06-14-at-3-59-01-AM" width="500" data-canonical-src="https://i.ibb.co/nbvLJvg/Screenshot-2023-06-14-at-3-59-01-AM.png"/></a>
</p>

<p dir="auto">The following examples are not implemented, but are presented as additional
ideas for integrations that <code>agency</code> could support.</p>
<div dir="auto" data-snippet-clipboard-copy-content="Space([

    # Integrate access to a remote server
    Server(&#34;Ubuntu&#34;,
        ip=&#34;192.168.1.100&#34;),

    # Add a voice assistant interface
    VoiceAssistant(&#34;VoiceyAI&#34;)

    # Use email to send/receive messages from others
    Email(&#34;Dan&#34;, address=&#34;dan@example.com&#34;),

    # Integrate other ML services, like for images
    DiffusionModel(&#34;ImageAI&#34;),

    # Horizontal scaling could be achieved by simply duplicating agents
    # (notice we repeat the last one)
    DiffusionModel(&#34;ImageAI&#34;),

    # Existing AI agents may integrate as well
    LangChainAgent(&#34;MyLangChainAgent&#34;))

    # Development related tasks like model training may also be accomplished.
    # You would only need to add one new `Agent` that reads a data set and sends
    # it as messages to the `Agent` class used for inference, provided the
    # underlying model is first switched to a training mode. For example:
    DatasetTrainer(&#34;DatasetTrainer&#34;,
      trainee: &#34;ChattyAIInTraining&#34;
    )
    ChattyAI(&#34;ChattyAIInTraining&#34;,
      training_mode: True,
      ...
    )

    # Network and share your LMs and Agents with others
    RemoteAgent(&#34;AgentHelperDude&#34;,
      url: &#34;https://agent.helper.dude:2023&#34;,
      ...
    )

    # You get the idea...
    AnySystemOrPersonOrFunctionAtAllThatYouWantToShareChannel(
      &#34;Guest&#34;,
      ...
    )

]).create()"><pre><span>Space</span>([

    <span># Integrate access to a remote server</span>
    <span>Server</span>(<span>&#34;Ubuntu&#34;</span>,
        <span>ip</span><span>=</span><span>&#34;192.168.1.100&#34;</span>),

    <span># Add a voice assistant interface</span>
    <span>VoiceAssistant</span>(<span>&#34;VoiceyAI&#34;</span>)

    <span># Use email to send/receive messages from others</span>
    <span>Email</span>(<span>&#34;Dan&#34;</span>, <span>address</span><span>=</span><span>&#34;dan@example.com&#34;</span>),

    <span># Integrate other ML services, like for images</span>
    <span>DiffusionModel</span>(<span>&#34;ImageAI&#34;</span>),

    <span># Horizontal scaling could be achieved by simply duplicating agents</span>
    <span># (notice we repeat the last one)</span>
    <span>DiffusionModel</span>(<span>&#34;ImageAI&#34;</span>),

    <span># Existing AI agents may integrate as well</span>
    <span>LangChainAgent</span>(<span>&#34;MyLangChainAgent&#34;</span>))

    <span># Development related tasks like model training may also be accomplished.</span>
    <span># You would only need to add one new `Agent` that reads a data set and sends</span>
    <span># it as messages to the `Agent` class used for inference, provided the</span>
    <span># underlying model is first switched to a training mode. For example:</span>
    <span>DatasetTrainer</span>(<span>&#34;DatasetTrainer&#34;</span>,
      <span>trainee</span>: <span>&#34;ChattyAIInTraining&#34;</span>
    )
    <span>ChattyAI</span>(<span>&#34;ChattyAIInTraining&#34;</span>,
      <span>training_mode</span>: <span>True</span>,
      ...
    )

    <span># Network and share your LMs and Agents with others</span>
    <span>RemoteAgent</span>(<span>&#34;AgentHelperDude&#34;</span>,
      <span>url</span>: <span>&#34;https://agent.helper.dude:2023&#34;</span>,
      ...
    )

    <span># You get the idea...</span>
    <span>AnySystemOrPersonOrFunctionAtAllThatYouWantToShareChannel</span>(
      <span>&#34;Guest&#34;</span>,
      ...
    )

]).<span>create</span>()</pre></div>

<h2 tabindex="-1" dir="auto"><a id="user-content-how-does-agency-compare-to-agent-libraries-like-langchain" aria-hidden="true" href="#how-does-agency-compare-to-agent-libraries-like-langchain"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>How does <code>agency</code> compare to agent libraries like LangChain?</h2>
<p dir="auto">Though you could entirely create a simple agent using only the primitives in
<code>agency</code> (see <a href="https://github.com/operand/agency/blob/main/agency/agents"><code>agents/</code></a>), it is not intended to be a
full-fledged agent toolset. It can be thought of as an &#34;agent integration
framework&#34;.</p>
<p dir="auto">Projects like LangChain and others are exploring how to create purpose-built
agents that solve diverse problems using tools.</p>
<p dir="auto"><code>agency</code> is concerned with creating a safe and dynamic <em>environment</em> for these
types of agents to work, where they can freely discover and communicate with the
tools, each other, and any humans available in their environment.</p>
<p dir="auto"><code>agency</code> provides a simple means for defining actions, callbacks, and access
policies that you can use to monitor and ensure safety for the systems you
expose to your agents.</p>
<p dir="auto">A central part of the design is that humans and other systems can easily
integrate as well, using a simple common format for messages. You can even use
<code>agency</code> to set up a basic chat room to use with friends or other systems and
not use AI-driven agents at all!</p>
<p dir="auto">An additional benefit of its general design is that <code>agency</code> may also simplify
some agent development workflows. See the hypothetical examples above.</p>
<p dir="auto">So, <code>agency</code> is a more general framework intended to support agent development
and to ultimately enable agents to safely integrate with anything, in any way
imaginable.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-what-are-some-known-limitations-or-issues" aria-hidden="true" href="#what-are-some-known-limitations-or-issues"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>What are some known limitations or issues?</h2>
<ul dir="auto">
<li>
<p dir="auto">It&#39;s a new project, so keep that in mind in terms of completeness, but see
the plans below for where this is heading. Core functionality is pretty
well tested at the moment.</p>
</li>
<li>
<p dir="auto">This library makes use of threads for each individual agent. Multithreading
is limited by python&#39;s GIL, meaning if you run a CPU bound model other agents
will have to wait for their &#34;turn&#34;. This goes for anything else you might define
as an &#34;agent&#34;, if it is CPU heavy it will block other agents. Note that I/O does
not block, so networked backends or services will execute in parallel.  Other
forms of multiprocessing to avoid the GIL may eventually be considered.</p>
</li>
<li>
<p dir="auto">This API does NOT assume or enforce predefined roles like &#34;user&#34;, &#34;system&#34;,
&#34;assistant&#34;, etc. This is an intentional decision and is not likely to change.</p>
<p dir="auto"><code>agency</code> is intended to allow potentially large numbers of agents, systems,
and people to come together. A small predefined set of roles gets in the way
of representing many things uniquely and independently.</p>
<p dir="auto">This is a core feature of <code>agency</code>: that all things are treated the same and
may be interacted with through common means.</p>
<p dir="auto">The lack of roles introduces some challenges in integrating with role based
APIs. See the implementation of
<a href="https://github.com/operand/agency/blob/main/agency/agents/openai_function_agent.py"><code>OpenAIFunctionAgent</code></a> for an
example.</p>
</li>
<li>
<p dir="auto">There is not much by way of storage support. That is mostly left up to you and
I&#39;d suggest looking at the many technologies that focus on that. The <code>Agent</code>
class implements a simple <code>_message_log</code> array which you can make use of or
overwrite to back it with longer term storage. More direct support for storage
APIs may be considered in the future.</p>
</li>
</ul>

<p dir="auto">Please do!</p>
<p dir="auto">If you have any questions, suggestions, or problems, please open an
<a href="https://github.com/operand/agency/issues">issue</a>.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-development-installation" aria-hidden="true" href="#development-installation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Development Installation</h2>
<div dir="auto" data-snippet-clipboard-copy-content="git clone git@github.com:operand/agency.git
cd agency
poetry install"><pre>git clone git@github.com:operand/agency.git
<span>cd</span> agency
poetry install</pre></div>
<h2 tabindex="-1" dir="auto"><a id="user-content-test-suite" aria-hidden="true" href="#test-suite"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Test Suite</h2>
<p dir="auto">You can run the test suite with:</p>

<p dir="auto">The test suite is currently set up to run on pull requests to the <code>main</code> branch.</p>

<p dir="auto">The goal is to maintain a minimal, natural, and practical API for bringing
human, artificial, and other computing systems together, with the following
priorities.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-priorities" aria-hidden="true" href="#priorities"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Priorities</h2>
<ul dir="auto">
<li><strong>Speed</strong>:
Performance is always a concern. If it&#39;s not performant, it&#39;s not practical.
Currently the limitations of python multi-threading are a bottleneck.</li>
<li><strong>Access Control and Safety</strong>:
An effective access control solution for agent-integrated systems is
fundamental to ensure safety. I believe I&#39;ve included a sane first step at
such a pattern, but further development will be a focus of this project.</li>
<li><strong>Compatibility and Usability</strong>:
In general, I believe this is a fair start in defining a set of patterns for
creating agent systems. I hope to ensure the API is kept small, and
compatible with a wide variety of use cases.</li>
<li><strong>Documentation</strong>:
I hope to ensure documentation is kept organized, clear, and accurate. This
readme serves as a start.</li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content-planned-work" aria-hidden="true" href="#planned-work"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Planned Work</h2>
<ul dir="auto">
<li>Add web app multimodal i/o examples
<ul dir="auto">
<li>image</li>
<li>audio</li>
<li>video</li>
</ul>
</li>
<li>Add multimodal model integration example</li>
<li>Add message broker/networking support (RabbitMQ)</li>
<li>Add integration example for <a href="https://github.com/mlc-ai/mlc-llm">mlc-llm</a></li>
<li>Add integration example for <a href="https://github.com/ShishirPatil/gorilla">gorilla</a></li>
<li>Add integration example for LangChain</li>
<li>Add model training example</li>
<li>Consider alternative multiprocessing approaches</li>
<li>Consider adding a storage API</li>
<li>Consider prior work on distributed access control</li>
<li>Add docker assets to encourage using it</li>
<li><a href="https://github.com/operand/agency/issues"><em>feel free to make
suggestions</em></a></li>
</ul>
</article>
          </div></div>
  </body>
</html>
