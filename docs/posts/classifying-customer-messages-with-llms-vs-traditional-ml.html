<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.trygloo.com/blog/classify-text-llms-learnings">Original</a>
    <h1>Classifying customer messages with LLMs vs traditional ML</h1>
    
    <div id="readability-page-1" class="page"><div><div><p><a href="https://news.ycombinator.com/item?id=36681839">Join the discussion on Hacker News</a></p>
<p>LLMs can help you achieve state-of-the-art results on text classification tasks (like sentiment analysis, labeling, etc) just by describing the list of classes and descriptions.</p>
<p>We recently reached our 500k classification milestone using LLMs and fine-tuned models <span role="img" aria-label="party popper">ðŸŽ‰</span>, and below we share what we&#39;ve learned.</p>
<h3 id="1-llms-prefer-outputting-something-over-nothing"><a aria-hidden="true" tabindex="-1" href="#1-llms-prefer-outputting-something-over-nothing"><span></span></a><strong>1. LLMs prefer outputting something over nothing.</strong></h3>
<p>LLMs are trained to generate <em>any</em> text, so not generating anything is harder for them to do. This was a major cause for false-positives that we managed to correct once we added a catch-all class like &#34;other&#34; or &#34;none-of-these&#34;.</p>
<h3 id="2-hallucinations-are-more-helpful-than-you-think"><a aria-hidden="true" tabindex="-1" href="#2-hallucinations-are-more-helpful-than-you-think"><span></span></a><strong>2. Hallucinations are more helpful than you think</strong></h3>
<p><img src="https://www.trygloo.com/blog/classification-learnings/hallucination1.png" alt="Hallucination for LLM vs fine-tuned model"/></p><p>Keeping track of hallucinations can help you understand what good or bad class names are. In the example above you can see how the label &#34;technical-issue&#34; is hallucinated by the LLM, even though the actual label name in the prompt is &#34;other/technical-issue&#34;.</p>
<p>Try to keep the class names as simple and direct as possible. Note that there may be other techniques that allow the LLM to not bias towards using the class name itself by replacing class names with symbols, called <a href="https://arxiv.org/pdf/2305.08298.pdf">symbol tuning</a> -- but this research is still ongoing.</p>
<h3 id="3-to-save-costs-and-improve-latency-fine-tuned-classification-models-are-the-answer-combining-them-with-llms-can-be-even-more-powerful"><a aria-hidden="true" tabindex="-1" href="#3-to-save-costs-and-improve-latency-fine-tuned-classification-models-are-the-answer-combining-them-with-llms-can-be-even-more-powerful"><span></span></a><strong>3. To save costs and improve latency, fine tuned classification models are the answer. Combining them with LLMs can be even more powerful.</strong></h3>
<p>One customer needed to process some data at lower-latency than LLMs, and the only way we could do this was by forgoing ChatGPT usage altogether. To do this, we trained SBERT using contrastive learning on ChatGPT-labeled data to achieve around 85% parity with it on multi-label classification on the customerâ€™s 22 different classes, and greater than 90% on a subset of those classes. The cost breakdown is below</p>
<p><img src="https://www.trygloo.com/blog/classification-learnings/bert-cost-openai.png" alt="Classification cost for bert vs chatgpt from openai."/></p><h3 id="4-llm-reasoning-improves-accuracy"><a aria-hidden="true" tabindex="-1" href="#4-llm-reasoning-improves-accuracy"><span></span></a><strong>4. LLM reasoning improves accuracy</strong></h3>
<p>This is a more well known prompt engineering technique, but it goes without saying â€” Chain of thought Prompting will result in higher accuracy when doing text classification ( <a href="https://arxiv.org/pdf/2305.08377.pdf">https://arxiv.org/pdf/2305.08377.pdf</a>). Prompting the LLM to extract a set of clues before doing the classification can yield state-of-the-art accuracy (96%+ on benchmarks). Below is an example from the paper</p>
<p><img src="https://www.trygloo.com/blog/classification-learnings/chainofthought1.png" alt="Chain of thought prompting"/></p><h3 id="5-standardizing-input-is-key-for-both-fine-tuned-models-and-llms"><a aria-hidden="true" tabindex="-1" href="#5-standardizing-input-is-key-for-both-fine-tuned-models-and-llms"><span></span></a><strong>5. Standardizing input is key for both fine tuned models and LLMs.</strong></h3>
<p>The more text there is to classify, the less accurate the prediction.</p>
<p>Imagine you have a long running chat thread between you bot and a user. At every step, youâ€™re attempting to determine the intent of the user. To improve prediction accuracy, we apply a preprocessing step to paraphrase the last user message with the previous context. This helps with classifying chat messages with multiple contexts, emails, long documents, and non-english messages.</p>
<p><img src="https://www.trygloo.com/blog/classification-learnings/normalization-diagram.png" alt="Summarizing text with ChatGPT before classifying it"/></p><hr/>
<p>We built Gloo to help others solve text-classification problems in a more automated way. Gloo allows you to</p>
<ol>
<li>Create an LLM-classifier with prompt engineering, that is guaranteed to only output your specified classes.</li>
<li>Quantifiably measure how prompt changes impacts production (latency, accuracy, biases in class selection)</li>
<li>Train + deploy a traditional BERT based classifier based on your LLM data</li>
<li>Build a classifier that combines both the trained model + LLM for any new classes you didnâ€™t train on</li>
</ol>
<p><img src="https://www.trygloo.com/blog/classification-learnings/gloo-classification-img1.png" alt="Gloo prompt engineering dashboard"/></p><p>** If you are interested in improving the accuracy, latency, or cost of your NLP text classifier, reach out to us: <a href="mailto:founders@trygloo.com">founders@trygloo.com</a> and we&#39;ll get you started with a free trial **</p></div></div></div>
  </body>
</html>
