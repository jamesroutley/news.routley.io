<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/justinclift/docker-pgautoupgrade">Original</a>
    <h1>A PostgreSQL Docker container that automatically upgrades PostgreSQL</h1>
    
    <div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><p dir="auto">This is a PostgreSQL Docker container for the Redash project.</p>
<p dir="auto">It&#39;s whole purpose in life is to automatically detect the
version of PostgreSQL used in the existing PostgreSQL data
directory, and automatically upgrade it (if needed) to the
latest version of PostgreSQL.</p>
<p dir="auto">After this, the PostgreSQL server starts and runs as per
normal.</p>
<p dir="auto">The reason this Docker container is needed, is because
the official Docker PostgreSQL container has no ability
to handle version upgrades, which leaves people to figure
it out manually (not great): <a data-error-text="Failed to load title" data-id="49823152" data-permission-text="Title is private" data-url="https://github.com/docker-library/postgres/issues/37" data-hovercard-type="issue" data-hovercard-url="/docker-library/postgres/issues/37/hovercard" href="https://github.com/docker-library/postgres/issues/37">docker-library/postgres#37</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-building-the-container" aria-hidden="true" href="#building-the-container"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Building the container</h2>
<p dir="auto">To build the docker image, use:</p>

<p dir="auto">This will take a few minutes to create the &#34;pgautoupgrade:latest&#34;
docker container, that you can use in your docker-compose.yml
files.</p>
<h2 tabindex="-1" dir="auto"><a id="user-content-testing-the-container-image" aria-hidden="true" href="#testing-the-container-image"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Testing the container image</h2>
<p dir="auto">To run the tests, use:</p>

<p dir="auto">The test script creates an initial PostgreSQL database for
Redash using an older PG version, then starts Redash using
the above &#34;automatic updating&#34; PostgreSQL container to
update the database to the latest PostgreSQL version.</p>
<p dir="auto">It then checks that the database files were indeed updated
to the newest PostgreSQL release, and outputs an obvious
SUCCESS/FAILURE message for that loop.</p>
<p dir="auto">The test runs in a loop, testing (in sequence) PostgreSQL
versions 9.5, 9.6, 10.x, 11.x, 12.x, 13.x, and 14.x.</p>
</article>
          </div></div>
  </body>
</html>
