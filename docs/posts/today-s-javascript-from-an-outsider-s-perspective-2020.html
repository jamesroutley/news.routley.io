<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://lea.verou.me/2020/05/todays-javascript-from-an-outsiders-perspective/">Original</a>
    <h1>Todayâ€™s JavaScript, from an outsiderâ€™s perspective (2020)</h1>
    
    <div id="readability-page-1" class="page"><div>

		<div>

			
<p>Today I tried to help a friend who is a great computer scientist, but not a JS person use a JS module he found on Github. Since for the past 6 years my day job is doing usability research &amp; teaching at MIT, I couldnâ€™t help but cringe at the slog that this was. Lo and behold, a pile of unnecessary error conditions, cryptic errors, and lack of proper feedback. And I donâ€™t feel I did a good job communicating the frustration he went through in the one hour or so until he gave up. </p>



<p>It went a bit like thisâ€¦</p>



<p>Note: N<em>ames of packages and people have been changed to protect their identity. Iâ€™ve also omitted a few issues he faced that were too specific to the package at hand. Some of the errors are reconstructed from memory, so let me know if I got anything wrong!</em></p>



<p><strong>John:</strong> Hey, I want to try out this algorithm I found on Github, it says to use <code>import functionName from packageName</code> and then call <code>functionName(arguments)</code>. Seems simple enough! I donâ€™t really need a UI, so Iâ€™m gonna use Node!</p>



<p><strong>Lea:</strong> Sure, Node seems appropriate for this!</p>



<p>John <em>runs <code>npm install packageName --save</code> as recommended by the packageâ€™s README</em></p>



<p><strong>Node:</strong></p>



<pre>Warning: To load an ES module, set &#34;type&#34;: &#34;module&#34; in the package.json or use the .mjs extension.
SyntaxError: Cannot use import statement outside a module</pre>



<p><strong>John:</strong> But I donâ€™t have a package.jsonâ€¦</p>



<p><em>John runs <code>npm init</code>, goes through the wizard, adds <code>type: &#34;module&#34;</code></em> manually to the generated package.json.</p>



<p><strong>Node:</strong></p>



<pre>SyntaxError: Cannot use import statement outside a module</pre>



<p>Oddly, the error was thrown from an internal module of the project this time. WAT?!</p>



<p><strong>Lea: </strong>Ok, screw this, just run it in a browser, itâ€™s an ES6 module and itâ€™s just a pure JS algorithm that doesnâ€™t use any Node APIs, it should work.</p>



<p>John <em>makes a simple index.html with a <code>&lt;script type=&#34;module&#34; src=&#34;index.js&#34;&gt;</code></em></p>



<p>Nothing in the console. Nada. Crickets. ðŸ¦—</p>



<p><strong>Lea:</strong> Oh, you need to adjust your module path to import packageName. Node does special stuff to resolve based on <code>node_modules</code>, now youâ€™re in a browser you need to specify an explicit path yourself.</p>



<p><em>John looks, at his filesystem, but there was no node_modules directory.</em></p>



<p><strong>Lea:</strong> Oh, you ran <code>npm install</code> before you had a <code>package.json</code>, thatâ€™s probably it! Try it again!</p>



<p><em>John runs <code>npm install packageName --save</code> again</em></p>



<p><strong>John:</strong> Oh yeah, there is a node_modules now!</p>



<p>John <em>desperately looks in <code>node_modules</code> to find the entry point</em></p>



<p><strong>Firefox:</strong> </p>



<pre>Incorrect MIME type: text/html</pre>



<p><strong>Lea:</strong> Oh, youâ€™re in <code>file://</code>! Dude, what are you doing these days without a localhost? Javascript is severely restricted in <code>file://</code> today.</p>



<p><strong>John:</strong> But why do Iâ€¦ ok fine, Iâ€™m going to start a localhost.</p>



<p>John <em>starts localhost</em>, visits his index.html under http://localhost:80</p>



<p><strong>Firefox:</strong></p>



<pre>Incorrect MIME type: text/html</pre>



<p><strong>John:</strong> Sigh. Do I need to configure my localhost to serve JS files with a <code>text/javascript</code> MIME type?</p>



<p><em>Looks at node_modules again, corrects path. Turns out VS Code collapses folders with only 1 subfolder, which is why we hadnâ€™t noticed</em>. </p>



<p>FWIW I do think this is a good usability improvement on VS Codeâ€™s behalf, it improves efficiency, but they need to make it more visible that this is what has happened.</p>



<p><strong>Firefox:</strong></p>



<pre>SyntaxError: missing ) after formal parameters</pre>



<p><strong>Lea: </strong>What? Thatâ€™s coming from the package source, itâ€™s not your fault. I donâ€™t understandâ€¦ can we look at this line?</p>



<p><em>John clicks at line throwing the error</em></p>



<p><strong>Lea:</strong> Oh my goodness. This is not Javascript, itâ€™s Typescript!! With a .js extension!!</p>



<p><em>John gives up</em>.<em> Concludes never to touch Node, npm, or ES6 modules with a barge pole.</em></p>



<p>The End.</p>



<p>Note that John is a computer scientist that knows a fair bit about the Web: He had Node &amp; npm installed, he knew what MIME types are, he could start a localhost when needed. What hope do actual novices have?</p>

		</div><!-- .entry-content -->

	</div></div>
  </body>
</html>
