<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://mullvad.net/en/blog/2023/2/17/security-audit-of-account-and-payment-services/">Original</a>
    <h1>Mullvad VPN: Security audit of account and payment services</h1>
    
    <div id="readability-page-1" class="page"><div>
        <p>Assured AB were contracted to perform a security assessment of our account and payment services between 2022-11-07 and 2022-11-29.</p>

<p>Quoting the report:</p>

<blockquote>
<p>No critical, high or medium rated issues were identified during the penetration test and the overall security of the API is deemed good.</p>
</blockquote>

<p>Read the <a href="https://www.assured.se/publications/Assured_Mullvad_API_audit_report_2022.pdf">full audit report</a> on Assured’s website.</p>

<h2>Issues of note</h2>

<p>Most issues were patched while the report was being finished and were noted as such in the final version. A few issues require a larger redesign however but we consider them low risk enough that we decided to publish the report.</p>

<h3>3.1 (Low) Unencrypted network traffic to Redis</h3>

<p>As the description of the issue points out, the traffic is encrypted on the network layer but the auditors were right to point out that encryption on the application layer would be a good addition. We will follow their recommendation to add server TLS for connections to Redis.</p>

<h3>3.3 (Note) Secrets in docker-compose.yml and environment variables</h3>

<p>These services run on dedicated hardware with full disk encryption so we feel that these credentials are adequately protected. We are aware that this could be improved and have been working towards a better long-term solution based on storing credentials with a more suitable secrets management tool.</p>

<h3>4.3 (Low) IP blocking can be circumvented</h3>

<p>This is also something we are aware and know that there is room for improvement. We’re constantly monitoring all our API endpoints for signs of abuse and adjusting our rate-limit policies as needed. Certain public-facing endpoint tend to attract more abuse and therefore require stricter policies while more internal ones can be more relaxed for ease of use.</p>

<h3>4.4 (Low) Sensitive information in URL</h3>

<p>Most endpoints that reference accounts in this way are internal and have very strict logging policies to make sure nothing sensitive is persisted. We are moving away from this approach however and will follow the auditors’ recommendation to only send account numbers in POST requests.</p>

<h3>4.5 (Low) Admin password change does not enforce policy</h3>

<p>The policies we have are enforced but they are not strict enough to prevent Sommar2022!. This admin UI is limited to a small group of staff users who all use very strict password policies so it’s very unlikely that any weak passwords have been used. It’s also worth pointing out that this web interface is also protected by client certificate validation and bastion IP white lists. There is no reason not to actually enforce the stricter policies we already follow though so we have increased the minimum password length to 48 characters.</p>

<p>We wish to thank Assured AB for their thorough work and excellent collaboration throughout the audit.</p>
        </div></div>
  </body>
</html>
