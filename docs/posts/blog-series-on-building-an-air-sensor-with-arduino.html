<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.airdeets.com/blog/diy-arduino-based-air-sensor-pt1">Original</a>
    <h1>Blog series on building an air sensor with Arduino</h1>
    
    <div id="readability-page-1" class="page"><div><p>This blog is part 1 of a series of projects where we&#39;ll be building an air sensor on the arduino platform. In part 1, we&#39;ll wire up a PMS5003 to an ESP32 microcontroller, and write out Arduino code to retrieve sensor values from the PMS5003 and log them to console.</p>
<h3>hardware</h3>
<ul>
<li>esp32/esp8266/arduino microcontroller</li>
<li><a href="https://www.amazon.com/s?k=pms5003" rel="nofollow noopener noreferrer">pms5003 sensor</a></li>
<li>breadboard</li>
<li>jumper wires</li>
</ul>
<h3>software</h3>
<ul>
<li>arduino ide</li>
<li><a href="https://github.com/adafruit/Adafruit_PM25AQI" rel="nofollow noopener noreferrer">Adafruit PM25AQI library</a></li>
</ul>
<h3>1. let&#39;s get connected</h3>
<p>Connect the microcontroller ESP32 to PMS5003 sensor like this. Note that microcontroller&#39;s RX should be connected to the sensor&#39;s TX.
<img src="https://www.airdeets.com/assets/blog/diy-arduino-based-air-sensor-pt1/wiring-diagram.png" alt="wiring diagram"/></p>
<h3>2. code it out</h3>
<p>This code example is the bare minimum you will need to get up and running reading sensor values from the PMS5003.</p>
<p>You will need to have the <a href="https://github.com/adafruit/Adafruit_PM25AQI" rel="nofollow noopener noreferrer">Adafruit PM25AQI library</a> installed - this library can be found in the Arduino Library manager if you search for &#34;Adafruit PM25 AQI Sensor&#34;.</p>
<pre><p><code><span>#</span><span>include</span><span> </span><span>&#34;Adafruit_PM25AQI.h&#34;</span><span>
</span>
<span>Adafruit_PM25AQI sensor </span><span>=</span><span> </span><span>Adafruit_PM25AQI</span><span>(</span><span>)</span><span>;</span><span>
</span>
<span></span><span>void</span><span> </span><span>setup</span><span>(</span><span>)</span><span> </span><span>{</span><span>
</span><span>  </span><span>// Print values to serial monitor at a baud rate of 115200</span><span>
</span><span>  Serial</span><span>.</span><span>begin</span><span>(</span><span>115200</span><span>)</span><span>;</span><span>
</span>
<span>  </span><span>// Since the sensor is connected to the RX2 pin, we will use Serial2 to read the values.</span><span>
</span><span>  Serial2</span><span>.</span><span>begin</span><span>(</span><span>9600</span><span>)</span><span>;</span><span>
</span><span>  sensor</span><span>.</span><span>begin_UART</span><span>(</span><span>&amp;</span><span>Serial2</span><span>)</span><span>
</span><span></span><span>}</span><span>
</span>
<span></span><span>void</span><span> </span><span>loop</span><span>(</span><span>)</span><span> </span><span>{</span><span>
</span><span>  PM25_AQI_Data data</span><span>;</span><span>
</span><span>  </span><span>// Print PM2.5 value to serial monitor every second.</span><span>
</span><span>  </span><span>if</span><span> </span><span>(</span><span>sensor</span><span>.</span><span>read</span><span>(</span><span>&amp;</span><span>data</span><span>)</span><span>)</span><span> </span><span>{</span><span>
</span><span>    Serial</span><span>.</span><span>print</span><span>(</span><span>&#34;PM2.5: &#34;</span><span>)</span><span>;</span><span> 
</span><span>    Serial</span><span>.</span><span>print</span><span>(</span><span>data</span><span>.</span><span>pm25_standard</span><span>)</span><span>;</span><span>
</span><span>    Serial</span><span>.</span><span>print</span><span>(</span><span>&#34;\n&#34;</span><span>)</span><span>;</span><span>
</span><span>  </span><span>}</span><span> 
</span><span>  </span><span>delay</span><span>(</span><span>1000</span><span>)</span><span>
</span><span></span><span>}</span></code></p></pre>
<h3>3. upload the code and open serial monitor</h3>
<p>With the code running on the microcontroller, pull up the serial monitor at a baud rate of 115200 and observe the values. It should look something like:</p>
<pre><code>PM2.5: 20
PM2.5: 20
PM2.5: 20
...
</code></pre>
<h3>4. next steps</h3>
<p>In part 2, we&#39;ll build on this tutorial by optimizing the code to prolong the life of the pms5003 sensor. In particular, we will implement functonality to take a reading every 15 minutes and hibernate the sensor until it is ready to take a new reading. Stay tuned!</p>
<p><a href="https://www.airdeets.com/blog/diy-arduino-based-air-sensor-pt2">part 2 is here!</a></p></div></div>
  </body>
</html>
