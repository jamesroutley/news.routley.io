<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://crapts.org/2024/04/21/all-fritz-box-modems-have-been-hijacked/">Original</a>
    <h1>All Fritz Box modems have been hijacked</h1>
    
    <div id="readability-page-1" class="page"><div data-v-461f54e1=""><p><em>TL;DR: Every Fritz!Box has been compromised by DNS hijacking and using a Fritz!Box is unsafe. Every user of a Fritz!Box should immediately stop using their Fritz!Box or set up their own DHCP server.</em></p><p>Fritz!Box modems are popular modems by the German company AVM. They are tailored to the some-what more experienced users who want to have more control over their network settings and they can often be used to replace the modem from your cable/DSL/fiber ISP. The company has been around for a long time and Fritz!Box devices are generally considered to be reliable and well worth the price.</p><p>However, since the beginning of 2024 all of the Fritz!Box devices have been hijacked. In short, the DHCP server on these modems hands out leases with the DNS suffix <code>fritz.box</code>, which means that domains in DNS requests <a href="https://superuser.com/questions/1481698/dns-suffix-explanation?ref=crapts.org" rel="noreferrer">are appended with the suffix</a>. Unfortunately, this setting cannot be modified. Normally this doesn&#39;t have to be a problem, but since the beginning of this year the <code>fritz.box</code> DNS suffix is an <a href="https://whois.domaintools.com/fritz.box?ref=crapts.org" rel="noreferrer">actual registered domain</a> and the owner of this domain is not AVM or anyone affiliated to them. </p><p>This is a very serious issue. DNS requests on a Fritz!Box home network now get forwarded to an unknown entity, which is a case of <a href="https://en.wikipedia.org/wiki/DNS_hijacking?ref=crapts.org" rel="noreferrer">DNS hijacking</a>. Not every OS deals with DNS suffices in the same way, but at least Windows applies the suffix for all DNS requests which means every DNS request done by a Windows user is now effectively hijacked. </p><figure><img src="https://crapts.org/content/images/2024/04/image.png" alt="" loading="lazy" width="560" height="225"/></figure><p>The consequences of this are significant: Fritz!Box users&#39; internet behavior is now sent directly to an unknown party and are now prone to phishing attacks. As far as I know the latter hasn&#39;t happened yet, but it&#39;s bound to happen at some point if this is not resolved as soon as possible.</p><p>Besides the security issues, this also has a negative effect on performance when the registered IP address isn&#39;t responding to the DNS requests. I myself have experienced Chrome and Slack to be very slow in resolving network requests after starting up my Windows laptop.</p><p>AVM&#39;s response so far has been lacking except for a <a href="https://twitter.com/AVM_DE/status/1779155999204552897?ref=crapts.org" rel="noreferrer">tweet</a> that <code>fritz.box</code> domain is in the process of being sold. To me that is alarming in three ways:</p><ol><li>&#34;In the process of being sold&#34; means it is not sold yet and there is no guarantee AVM will actually take ownership of the domain.</li><li>Even if the domain is acquired by AVM, this still means that every DNS request will now go over the internet directly to AVM. I never asked for this.</li><li>A performance penalty will remain. Your internet will sometimes appear to be really slow when the registered IP address for the DNS suffix domain is not actually responding with a DNS resolution.</li></ol><p>The only proper way to resolve this matter in my opinion is to disable the DNS suffix by default. So far there is no indication that AVM is planning to enable this option in the near future.</p><p>If you want to do something today without waiting for AVM, the following remedies are available:</p><ul><li>Use a custom DHCP server and don&#39;t set the DNS suffix to <code>fritz.box</code></li><li>Don&#39;t use a Fritz!Box device at all</li></ul><p>Since setting up a DHCP server is somewhat complex, my only recommendation at this point is to immediately stop using all Fritz!Box device. They are unsafe and dangerous to use. The lack of a proper response from AVM is even more alarming and I&#39;m not sure they understand the gravity of the situation. I sincerely hope the matter gets resolved soon enough.</p><p>PS. I didn&#39;t discover this by myself. The article above is a summary of what other <a href="https://www.reddit.com/r/fritzbox/comments/1b7d0rs/change_domain_in_fritzbox_7360/?ref=crapts.org" rel="noreferrer">people</a> <a href="https://www.reddit.com/r/fritzbox/comments/klzqar/fritzbox_7590_change_default_fritzbox_domain/?ref=crapts.org" rel="noreferrer">have</a> <a href="https://gathering.tweakers.net/forum/list_message/78779034?ref=crapts.org" rel="noreferrer">discovered</a>,  and some even warned for this years ago.</p></div></div>
  </body>
</html>
