<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/dalance/amber">Original</a>
    <h1>Amber: A code search and replace tool</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://github.com/dalance/amber/actions"><img src="https://github.com/dalance/amber/workflows/Regression/badge.svg" alt="Actions Status"/></a>
<a href="https://crates.io/crates/amber" rel="nofollow"><img src="https://camo.githubusercontent.com/e01e2fc56b4269e56f565bf27fdadb75ea53cb6d136a6e8e46a0667bd77c36c7/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f616d6265722e737667" alt="Crates.io" data-canonical-src="https://img.shields.io/crates/v/amber.svg"/></a>
<a href="https://codecov.io/gh/dalance/amber" rel="nofollow"><img src="https://camo.githubusercontent.com/ffe82b0e335d18878a9e4b9a37e28235559b5512e5a83cd0fbe8d9f7cbbabc67/68747470733a2f2f636f6465636f762e696f2f67682f64616c616e63652f616d6265722f6272616e63682f6d61737465722f67726170682f62616467652e737667" alt="codecov" data-canonical-src="https://codecov.io/gh/dalance/amber/branch/master/graph/badge.svg"/></a></p>
<p dir="auto"><strong>amber</strong> is a code search and replace tool written by <a href="https://www.rust-lang.org/" rel="nofollow">Rust</a>.
This tool is inspired by <a href="http://beyondgrep.com/" rel="nofollow">ack</a>,
<a href="https://github.com/ggreer/the_silver_searcher">ag</a>, and other grep-like tools.</p>


<ul dir="auto">
<li>Recursively search from the current directory</li>
<li>Ignore VCS directories (.git, .hg, .svn, .bzr)</li>
<li>Ignore binary files</li>
<li>Output by the colored format</li>
</ul>

<p dir="auto">Large files ( &gt; 1MB by default) are divided and searched in parallel.</p>

<p dir="auto"><strong>amber</strong> can replace a keyword over directories (traditionally by <code>find ... | xargs sed -i &#39;...&#39;</code>) .
You can decide to do replacing or not interactively.</p>


<p dir="auto">Install the <code>amber-search-git</code> package from AUR.</p>
<div data-snippet-clipboard-copy-content="yaourt -S amber-search-git"><pre><code>yaourt -S amber-search-git
</code></pre></div>

<p dir="auto">You can install with <a href="https://crates.io/crates/amber" rel="nofollow">cargo</a>.</p>


<p dir="auto">Download from <a href="https://github.com/dalance/amber/releases/latest">release page</a>, and extract to the directory in PATH.</p>

<p dir="auto">Two commands (<code>ambs</code>/<code>ambr</code>) are provided. <code>ambs</code> means &#34;amber search&#34;, and <code>ambr</code> means &#34;amber replace&#34;.
The search keyword is not regular expression by default. If you want to use regular expression, add <code>--regex</code>.</p>
<div data-snippet-clipboard-copy-content="ambs keyword                  // recursively search &#39;keyword&#39; from the current directory.
ambs keyword path             // recursively search &#39;keyword&#39; from &#39;path&#39;.
ambr keyword replacement      // recursively search &#39;keyword&#39; from the current directory, and replace to &#39;replacement&#39; interactively.
ambr keyword replacement path // recursively search &#39;keyword&#39; from &#39;path&#39;, and replace to &#39;replacement&#39; interactively."><pre><code>ambs keyword                  // recursively search &#39;keyword&#39; from the current directory.
ambs keyword path             // recursively search &#39;keyword&#39; from &#39;path&#39;.
ambr keyword replacement      // recursively search &#39;keyword&#39; from the current directory, and replace to &#39;replacement&#39; interactively.
ambr keyword replacement path // recursively search &#39;keyword&#39; from &#39;path&#39;, and replace to &#39;replacement&#39; interactively.
</code></pre></div>
<p dir="auto"><strong>amber</strong> replace interactively by default. If the keyword is found, the following prompt is shown, and wait.
If you input &#39;y&#39;, &#39;Y&#39;, &#39;Yes&#39;, the keyword is replaced. &#39;a&#39;, &#39;A&#39;, &#39;All&#39; means replacing all keywords non-interactively.</p>
<div data-snippet-clipboard-copy-content="Replace keyword? ( Yes[Y], No[N], All[A], Quit[Q] ):"><pre><code>Replace keyword? ( Yes[Y], No[N], All[A], Quit[Q] ):
</code></pre></div>
<p dir="auto">If <code>--regex</code> option is enabled, regex captures can be used in <code>replacement</code> of <code>ambr</code>.</p>
<div data-snippet-clipboard-copy-content="$ cat text.txt
aaa bbb
$ ambr --no-interactive --regex &#39;(aaa) (?&lt;pat&gt;bbb)&#39; &#39;$1 $pat ${1} ${pat}&#39; test.txt
$ cat text.txt
aaa bbb aaa bbb"><pre><code>$ cat text.txt
aaa bbb
$ ambr --no-interactive --regex &#39;(aaa) (?&lt;pat&gt;bbb)&#39; &#39;$1 $pat ${1} ${pat}&#39; test.txt
$ cat text.txt
aaa bbb aaa bbb
</code></pre></div>


<p dir="auto">You can change configuration by writing a configuration file.
The locations of the configuration file is OS-specific:</p>
<ul dir="auto">
<li>Linux: <code>~/.config/amber/ambs.toml</code>, <code>/etc/amber/ambs.toml</code></li>
<li>macOS: <code>~/Library/Preferences/com.github.dalance.amber/ambs.toml</code>, <code>/etc/amber/ambs.toml</code></li>
<li>Windows: <code>~/AppData/Roaming/dalance/amber/config/ambs.toml</code></li>
</ul>
<p dir="auto">For compatibility, if <code>~/.ambs.toml</code> exists, it will be preferred to
the OS-specific locations.</p>
<p dir="auto">The above paths are examples for the configuration of <code>ambs</code> command.
<code>ambr.toml</code> in the same directory is used for <code>ambr</code> command.</p>

<p dir="auto">Available entries and default values are below:</p>
<div dir="auto" data-snippet-clipboard-copy-content="regex          = false
column         = false
row            = false
binary         = false
statistics     = false
skipped        = false
interactive    = true
recursive      = true
symlink        = true
color          = true
file           = true
skip_vcs       = true
skip_gitignore = true
fixed_order    = true
parent_ignore  = true
line_by_match  = false"><pre><span>regex</span>          = <span>false</span>
<span>column</span>         = <span>false</span>
<span>row</span>            = <span>false</span>
<span>binary</span>         = <span>false</span>
<span>statistics</span>     = <span>false</span>
<span>skipped</span>        = <span>false</span>
<span>interactive</span>    = <span>true</span>
<span>recursive</span>      = <span>true</span>
<span>symlink</span>        = <span>true</span>
<span>color</span>          = <span>true</span>
<span>file</span>           = <span>true</span>
<span>skip_vcs</span>       = <span>true</span>
<span>skip_gitignore</span> = <span>true</span>
<span>fixed_order</span>    = <span>true</span>
<span>parent_ignore</span>  = <span>true</span>
<span>line_by_match</span>  = <span>false</span></pre></div>
<p dir="auto">You can choose some entries to override like below:</p>



<ul dir="auto">
<li>CPU: Intel(R) Xeon(R) Gold 6134 CPU @ 3.20GHz</li>
<li>MEM: 1.5TB</li>
<li>OS : CentOS 7.5</li>
</ul>

<ul dir="auto">
<li>source1: <a href="https://github.com/torvalds/linux">https://github.com/torvalds/linux</a> ( 52998files, 2.2GB )</li>
<li>source2: <a href="https://dumps.wikimedia.org/jawiki/latest/jawiki-latest-pages-articles.xml.bz2" rel="nofollow">https://dumps.wikimedia.org/jawiki/latest/jawiki-latest-pages-articles.xml.bz2</a> ( 1file, 8.5GB )</li>
</ul>

<ul dir="auto">
<li>pattern1( many files with many matches ) : &#39;EXPORT_SYMBOL_GPL&#39; in source1</li>
<li>pattern2( many files with few matches  ) : &#39;irq_bypass_register_producer&#39; in source1</li>
<li>pattern3( a large file with many matches ) : &#39;検索結果&#39; in source2</li>
<li>pattern4( a large file with few matches  ) : &#39;&#34;Quick Search&#34;&#39; in source2</li>
</ul>

<ul dir="auto">
<li>amber (v0.5.1)</li>
<li><a href="https://github.com/BurntSushi/ripgrep">ripgrep</a> (v0.10.0)</li>
<li><a href="https://www.gnu.org/software/grep/" rel="nofollow">grep</a> (v2.20)</li>
<li><a href="https://github.com/facebookincubator/fastmod">fastmod</a> (v0.2.0)</li>
<li><a href="https://www.gnu.org/software/findutils/" rel="nofollow">find</a>/<a href="https://www.gnu.org/software/sed/" rel="nofollow">sed</a> (v4.5.11/v4.2.2)</li>
</ul>

<p dir="auto"><a href="https://github.com/sharkdp/hyperfine">hyperfine</a> with the following options.</p>
<ul dir="auto">
<li><code>--warmup 3</code>: to load all data on memory.</li>
</ul>

<ul dir="auto">
<li>search ( <code>compare_ambs.sh</code> )</li>
</ul>
<table>
<thead>
<tr>
<th>pattern</th>
<th>amber</th>
<th>ripgrep</th>
<th>grep</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>212.8ms ( 139% )</td>
<td>154.1ms ( 100% )</td>
<td>685.2ms ( 448% )</td>
</tr>
<tr>
<td>2</td>
<td>199.7ms ( 132% )</td>
<td>151.6ms ( 100% )</td>
<td>678.7ms ( 448% )</td>
</tr>
<tr>
<td>3</td>
<td>1.068s  ( 100% )</td>
<td>4.642s  ( 434% )</td>
<td>3.869s  ( 362% )</td>
</tr>
<tr>
<td>4</td>
<td>1.027s  ( 100% )</td>
<td>4.409s  ( 429% )</td>
<td>3.118s  ( 304% )</td>
</tr>
</tbody>
</table>
<ul dir="auto">
<li>replace ( <code>compare_ambr.sh</code> )</li>
</ul>
<table>
<thead>
<tr>
<th>pattern</th>
<th>amber</th>
<th>fastmod</th>
<th>find/sed</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>792.2ms ( 100% )</td>
<td>1231ms  ( 155% )</td>
<td>155724ms ( 19657% )</td>
</tr>
<tr>
<td>2</td>
<td>418.1ms ( 119% )</td>
<td>352.4ms ( 100% )</td>
<td>157396ms ( 44663% )</td>
</tr>
<tr>
<td>3</td>
<td>18.390s ( 100% )</td>
<td>74.282s ( 404% )</td>
<td>639.740s ( 3479% )</td>
</tr>
<tr>
<td>4</td>
<td>17.777s ( 100% )</td>
<td>74.204s ( 417% )</td>
<td>625.756s ( 3520% )</td>
</tr>
</tbody>
</table>
</article></div></div>
  </body>
</html>
