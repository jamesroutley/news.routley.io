<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://gpuopen.com/learn/bilinear-interpolation-quadrilateral-barycentric-coordinates/">Original</a>
    <h1>Bilinear interpolation on a quadrilateral using Barycentric coordinates</h1>
    
    <div id="readability-page-1" class="page"><div data-id="3cfd864" data-element_type="widget" data-widget_type="theme-post-content.default">
				<div>
			<div role="main">
<section id="bilinear-interpolation-on-a-quadrilateral-using-barycentric-coordinates">
<p>In computer graphics, we rarely encounter continuous data. We often work with digital data, and in the context of geometric modeling, this means we typically work with polygon meshes rather than procedural surfaces like Bézier patches. The most popular technique for constructing digital three-dimensional objects in dedicated modeling software is polygon modeling. The result of the creation phase is a set of polygons (mesh), where the polygons in the mesh can share vertices and edges with other polygons.</p>
<p>Although users can create various types of surfaces (e.g., non-manifold), the most common surface is the topological 2-manifold. In short, a 2-manifold is a mathematical concept in topology, where the space locally resembles the Euclidean plane in <span data-katex-display="false">\mathbb{R}^2</span>. Essentially, every point on a 2-manifold has a neighborhood that looks like a piece of the plane.</p>
<table>
<thead>
<tr>
<th>
<p>Examples of 2-manifold mesh triangle-based</p>
</th>
<th>
<p>Examples of 2-manifold mesh quad-based</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-c0e3a80bacaa605a8efa87aa5bc4e9a8-triangle_mesh1.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-triangle_mesh1.png"><img width="1500" height="900" decoding="async" alt="_images/triangle_mesh1.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1500&#39;%20height=&#39;900&#39;%20viewBox=&#39;0%200%201500%20900&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-triangle_mesh1.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-4f93b2ed501cbdcf95b9be1633ffe3ae-triangle_mesh2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-triangle_mesh2.png"><img width="1500" height="900" decoding="async" alt="_images/triangle_mesh2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1500&#39;%20height=&#39;900&#39;%20viewBox=&#39;0%200%201500%20900&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-triangle_mesh2.png"/></a></p>
</td>
</tr>
</tbody>
</table>
<p>At the vertices of a polygon, users can store additional data (per-vertex attributes), such as vertex normals (for simulating curved surfaces), texture coordinates (for texture mapping), or RGBA color.</p>
<p>In theory, all types of polygons can be used. In practice, however, 3D graphics artists most commonly use triangles and quadrilaterals. These polygons are typically referred to as topology primitives in computer graphics APIs (such as Microsoft DirectX® or Vulkan®). From an artist’s point of view, quadrilaterals are more advantageous because they are easier to work with. The properties of modeling based on quadrilaterals include:</p>
<ul>
<li>
<p>The ease of generating grid-like surfaces.</p>
</li>
<li>
<p>Creating a topology that provides an edge flow that can be easily adjusted (when adding or deleting edge loops).</p>
</li>
<li>
<p>Producing a predictable result for subdivision algorithms.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>
<p>not clean looking mesh</p>
</th>
<th>
<p>clean looking mesh</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-fbd5adf1869c52d816eacde4203fe885-topo_bad.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-topo_bad.png"><img width="1400" height="1200" decoding="async" alt="_images/topo_bad.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1400&#39;%20height=&#39;1200&#39;%20viewBox=&#39;0%200%201400%201200&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-topo_bad.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-b4258168eab55b1752b279cf9b9d0f3b-topo_good.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-topo_good.png"><img width="1400" height="1200" decoding="async" alt="_images/topo_good.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1400&#39;%20height=&#39;1200&#39;%20viewBox=&#39;0%200%201400%201200&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-topo_good.png"/></a></p>
</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>The quad-based topology also provides cleaner deformations for models that will be animated.</p>
</li>
</ul>
<p>These arguments make the quadrilateral-based topology preferred by artists when modeling 3D objects.</p>
<p>Long ago, GPUs abandoned support for hardware accelerated quadrilaterals (or polygons consisting of more than 4 vertices) rasterization, therefore also interpolation of vertex attributes contained in their vertices (line rendering is for a different story). The only polygon that has hardware accelerated implementation of rasterization and interpolation of parameters is the triangle. There are very good reasons why it was the triangle that won the race I just name a few:</p>
<ul>
<li>
<p><strong>Triangulation Theorem:</strong> This theorem states that a mesh of triangles can approximate even complex surfaces.</p>
</li>
<li>
<p><strong>Triangle vertices always lie on the same plane:</strong> This is due to the fact that any three non-collinear points will always define a plane in three-dimensional space.</p>
</li>
<li>
<p><strong>Barycentric Coordinates:</strong> This coordinate system is used in geometry to express the position of a point within a triangle. These coordinates can be used for interpolation of vertex attributes across the surface of a triangle.</p>
</li>
<li>
<p><strong>Less complexity of the circuit:</strong> Supporting rasterization and interpolation for triangles only requires fewer transistors, which means this functionality occupies less space on the chip. This can result in a smaller (and cheaper to produce) chip, or the saved space can be used for other functionalities.</p>
</li>
</ul>
<p>Triangles are the foundation of real-time computer graphics, as reflected in the primitive topology supported by graphics APIs. All other polygon types used in meshes must be converted into triangles. When a modeling application allows quad-mesh construction, the visualization of this mesh is not based on quadrilaterals. Instead, the application converts them into triangle meshes. This necessary conversion can introduce <span data-katex-display="false">C^1</span> discontinuities in interpolated vertex attributes (such as texture coordinates, vertex normal vectors, and vertex colors) on the quadrilateral surface.</p>
<p>In the case of the topic covered in this article, the discontinuity of <span data-katex-display="false">C^1</span> refers to the point at which the piecewise function is continuous, but its first derivative is not. In other words, the piecewise function itself has no jumps or breaks, but the slope (or rate of change) of the piecewise function has jumps or breaks.</p>
<table>
<thead>
<tr>
<th>
</th>
<th>
<p><span data-katex-display="false">C^1</span> continuity</p>
</th>
<th>
<p><span data-katex-display="false">C^1</span> discontinuity</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>piecewise function</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-336ba43cfd66c572aed1f97f498dbda0-C0_con.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C0_con.png"><img width="557" height="557" decoding="async" alt="_images/C0_con.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;557&#39;%20height=&#39;557&#39;%20viewBox=&#39;0%200%20557%20557&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C0_con.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-436b262697ac66609438b3917c9cc13d-C0_dis.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C0_dis.png"><img width="555" height="556" decoding="async" alt="_images/C0_dis.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;555&#39;%20height=&#39;556&#39;%20viewBox=&#39;0%200%20555%20556&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C0_dis.png"/></a></p>
</td>
</tr>
<tr>
<td>
<p>first derivative</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-cf9d07484a7ec942573de83a19ba0155-C1_con.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C1_con.png"><img width="493" height="494" decoding="async" alt="_images/C1_con.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;493&#39;%20height=&#39;494&#39;%20viewBox=&#39;0%200%20493%20494&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C1_con.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-36bf40f631be9dd2e36c3184d6e97ccc-C1_dis.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C1_dis.png"><img width="493" height="494" decoding="async" alt="_images/C1_dis.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;493&#39;%20height=&#39;494&#39;%20viewBox=&#39;0%200%20493%20494&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-C1_dis.png"/></a></p>
</td>
</tr>
</tbody>
</table>
<p>For rasterization of quadrilaterals as two triangles, <span data-katex-display="false">C^1</span> discontinuity in the interpolation of vertex attributes is most visible along the newly created edge that splits the quadrilateral into two triangles.</p>
<table>
<thead>
<tr>
<th>
<p>Vertex Color</p>
</th>
<th>
<p>Texture Coordinates</p>
</th>
<th>
<p>Vertex Normal</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-19bc95d1700790bc331564956a47d944-1.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-1.png"><img width="640" height="640" decoding="async" alt="_images/1.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-1.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-ec24b26e7fd79fcdf5c902465cc341d3-3.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-3.png"><img width="640" height="640" decoding="async" alt="_images/3.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-3.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-0290aed55724f46beb0047c2f18bc97c-5.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-5.png"><img width="640" height="640" decoding="async" alt="_images/5.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-5.png"/></a></p>
</td>
</tr>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-f7846f8311fa9636ec3ca8470f3f4df6-trapez1.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez1.gif"><img width="300" height="300" decoding="async" alt="_images/trapez1.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez1.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-fcbf880a8c27c6357716ed2b7647b83c-trapez2.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez2.gif"><img width="300" height="300" decoding="async" alt="_images/trapez2.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez2.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-9360fabb2c03c5c58cdc8c5b3549eac4-trapez3.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez3.gif"><img width="300" height="300" decoding="async" alt="_images/trapez3.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez3.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-28b0dc381e093add2e76b8cb98e364c5-tea1.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea1.gif"><img width="300" height="300" decoding="async" alt="_images/tea1.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea1.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-ad784df2d2237ae6c481595eba609ab6-tea2.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea2.gif"><img width="300" height="300" decoding="async" alt="_images/tea2.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea2.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-de27696e3cac248658749e0bc30b229c-tea3.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea3.gif"><img width="300" height="300" decoding="async" alt="_images/tea3.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea3.gif"/></a></p>
</td>
</tr>
</tbody>
</table>
<section id="purpose">
<h2 id="purpose">Purpose<a href="#purpose" title="Permalink to this heading"></a></h2>
<p>The purpose of this article is to propose a new method that preserves <span data-katex-display="false">C^1</span> continuity over the common edge of two generated triangles from convex quadrilaterals. This new method is based on an algebraic solution for the Bilinear interpolation coefficient expressed in Barycentric coordinates. Bilinear interpolation has the advantage of being the simplest interpolation from an algebraic perspective. Consequently, the computational overhead is negligibly small. Additionally, linear interpolation allows for the easy construction of other types of interpolation, such as polynomial interpolation. The algebraic solution will then be implemented and tested using the three available hardware-accelerated pipelines supported by GPU hardware.</p>
</section>
<section id="state-of-the-art">
<h2 id="state-of-the-art">State of the Art<a href="#state-of-the-art" title="Permalink to this heading"></a></h2>
<p>Currently, efforts to address the problem outlined in this article can be categorized into the following approaches:</p>
<section id="quadrilateral-subdivision">
<h3 id="quadrilateral-subdivision">Quadrilateral subdivision<a href="#quadrilateral-subdivision" title="Permalink to this heading"></a></h3>
<p>The first approach is not to eliminate the issue but to minimize it. This is achieved by subdividing the quadrilateral until rendering artifacts become imperceptible to the observer or are less noticeable than the aliasing artifacts created during rasterization.</p>
<p>Quadrilateral subdivision can be performed dynamically (at application runtime) using a hardware-accelerated Tessellation Shaders stage.</p>
<table>
<thead>
<tr>
<th>
<p>Tessellation level 1</p>
</th>
<th>
<p>Tessellation level 2</p>
</th>
<th>
<p>Tessellation level 3</p>
</th>
<th>
<p>Tessellation level 4</p>
</th>
<th>
<p>Tessellation level 5</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-7195f868fe64c9cd0e5ec3f1bab67337-Sub1.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub1.png"><img width="311" height="311" decoding="async" alt="_images/Sub1.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;311&#39;%20height=&#39;311&#39;%20viewBox=&#39;0%200%20311%20311&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub1.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-51a09f1dad2eeb2c437023c09ee37e26-Sub2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub2.png"><img width="311" height="311" decoding="async" alt="_images/Sub2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;311&#39;%20height=&#39;311&#39;%20viewBox=&#39;0%200%20311%20311&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub2.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-fa23b2bb6c78ecfde4d3f76c7e097a11-Sub3.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub3.png"><img width="311" height="311" decoding="async" alt="_images/Sub3.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;311&#39;%20height=&#39;311&#39;%20viewBox=&#39;0%200%20311%20311&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub3.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-ebcad0fc7e9e543ee0d1de9bbd857fcd-Sub4.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub4.png"><img width="311" height="311" decoding="async" alt="_images/Sub4.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;311&#39;%20height=&#39;311&#39;%20viewBox=&#39;0%200%20311%20311&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub4.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-9d5909b93f19926d1eafe9ea1294cba3-Sub5.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub5.png"><img width="311" height="311" decoding="async" alt="_images/Sub5.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;311&#39;%20height=&#39;311&#39;%20viewBox=&#39;0%200%20311%20311&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Sub5.png"/></a></p>
</td>
</tr>
</tbody>
</table>
<p>Alternatively, quadrilateral subdivision can be performed statically (during the content creation phase) using dedicated tools provided by modeling software, such as the Blender® Subdivision Surface Modifier.</p>
<table>
<thead>
<tr>
<th>
<p>Mesh in Blender before usage of Subdivision Surface Modifier</p>
</th>
<th>
<p>Mesh in Blender after usage of Subdivision Surface Modifier</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-7d62ececbe262f83f9de78d318130ed0-Catmull_OFF2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Catmull_OFF2.png"><img width="1500" height="900" decoding="async" alt="_images/Catmull_OFF2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1500&#39;%20height=&#39;900&#39;%20viewBox=&#39;0%200%201500%20900&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Catmull_OFF2.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-316162ef83d1cef5784a1772d52a8387-Catmull_ON2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Catmull_ON2.png"><img width="1500" height="900" decoding="async" alt="_images/Catmull_ON2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1500&#39;%20height=&#39;900&#39;%20viewBox=&#39;0%200%201500%20900&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Catmull_ON2.png"/></a></p>
</td>
</tr>
</tbody>
</table>
<p>Subdividing meshes (at application runtime or not) effectively reduces the visibility of all types of <span data-katex-display="false">C^1</span> discontinuities to the observer, but at the expense of decreasing performance and/or increasing memory overhead in the mesh rendering process.</p>
</section>
<section id="mean-value-coordinates">
<h3 id="mean-value-coordinates">Mean value coordinates<a href="#mean-value-coordinates" title="Permalink to this heading"></a></h3>
<p>A different attempt to solve the problem was offered in the article <a href="https://dl.acm.org/doi/10.1145/1058129.1058131" target="_blank">A quadrilateral rendering primitive</a>, where the authors proposed hardware-accelerated quadrilateral rasterization. For vertex attribute interpolation inside quadrilaterals (which may be non-planar), the authors chose to use <a href="https://www.sciencedirect.com/science/article/abs/pii/S0167839603000025" target="_blank">mean value coordinates</a>. However, these coordinates yield results similar to those of bilinear interpolation. The following caveats can be pointed out:</p>
<ul>
<li>
<p>In the calculation of mean value coordinates, transcendental functions are used. The values of these functions can be determined with predetermined precision. However, from a performance perspective, they introduce a certain overhead, depending on the hardware implementation of the calculation of transcendental functions.</p>
</li>
<li>
<p>Mean value coordinates interpolation does not generate straight lines, which might not be desirable for users. This hardware solution has not yet been implemented using the GPU (at the time of writing this article). However, the authors of <a href="https://www.jcgt.org/published/0011/03/04/paper-lowres.pdf" target="_blank">Barycentric quad rasterization</a> attempted to implement it using the Geometry Shader pipeline available in modern GPUs. The presented implementation has a disadvantage: it uses double-precision floating-point variables, which significantly impact performance overhead. GPUs for real-time rendering are primarily designed to support single-precision floating-point calculations.</p>
</li>
</ul>
</section>
<section id="fragment-shader-calculation">
<h3 id="fragment-shader-calculation">Fragment Shader calculation<a href="#fragment-shader-calculation" title="Permalink to this heading"></a></h3>
<p>Other authors, such as Inigo Quilez <a href="https://iquilezles.org/articles/ibilinear/" target="_blank">inverse bilinear interpolation – 2010</a> and Nathan Reed <a href="https://www.reedbeta.com/blog/quadrilateral-interpolation-part-2/" target="_blank">Quadrilateral Interpolation, Part 2</a>, have observed the advantages of bilinear interpolation and proposed solutions through implementations using the Fragment Shader.</p>
<p>The presented solutions demonstrate the implementation of bilinear interpolation for quadrilaterals, but they only show how to do it for a single quadrilateral and for its texture coordinate vertex attribute. They do not address how to apply it in real-life three-dimensional mesh models.</p>
</section>
</section>
<section id="proposition-of-the-new-method">
<h2 id="proposition-of-the-new-method">Proposition of the New Method<a href="#proposition-of-the-new-method" title="Permalink to this heading"></a></h2>
<p>The method presented in the article consists of an equation that can express Bilinear interpolation coefficients <span data-katex-display="false">u, v</span> using Barycentric coordinates <span data-katex-display="false">\alpha, \beta, \gamma</span> of one of the two triangles into which each convex quadrilateral can be divided.</p>
<p>The Euclidean coordinates of every point <span data-katex-display="false">P</span> in a given quadrilateral on the plane can be expressed as a Bilinear interpolation of the Euclidean coordinates of its vertices.</p>
<p>The line segment <span data-katex-display="false">AB</span> is parameterized as <span data-katex-display="false">E(u)=A + u(B-A), , u \in[0,1]</span>,</p>
<p>the line segment <span data-katex-display="false">DC</span> is parameterized as <span data-katex-display="false">F(u)=D + u(C-D), , u \in[0,1]</span>,</p>
<p>the line segment <span data-katex-display="false">DA</span> is parameterized as <span data-katex-display="false">G(v)=A + v(D-A), , v \in[0,1]</span>,</p>
<p>the line segment <span data-katex-display="false">BC</span> is parameterized as <span data-katex-display="false">H(v)=G + v(H-G), , v \in[0,1]</span>.</p>
<p>The point <span data-katex-display="false">P</span> is the intersection of the two segments <span data-katex-display="false">E(u)F(u)</span> and <span data-katex-display="false">G(v)H(v)</span>.</p>
<p>Alternatively, the Euclidean coordinates of point <span data-katex-display="false">P</span> can be expressed as a Barycentric coordinates of</p>
<p>a triangle <span data-katex-display="false">ABD \ </span> <span data-katex-display="false">P = \alpha A + \beta B + \gamma D</span></p>
<p>where <span data-katex-display="false">\alpha,\beta,\gamma</span> are positive real numbers such that <span data-katex-display="false">\alpha + \beta + \gamma = 1</span>..</p>
<p>This can be shown geometrically in two-dimensional space.</p>
<table>
<thead>
<tr>
<th>
<p>Bilinear interpolation inside quadrilateral <span data-katex-display="false">ABCD</span></p>
</th>
<th>
<p>Barycentric interpolation inside triangle <span data-katex-display="false">ABD</span></p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-39c22990cf73177a5cd6bf04738e0b33-interpolation1.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-interpolation1.png"><img width="600" height="400" decoding="async" alt="_images/interpolation1.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;600&#39;%20height=&#39;400&#39;%20viewBox=&#39;0%200%20600%20400&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-interpolation1.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-eacaa248e95479d42b5631c734d28d1d-interpolation2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-interpolation2.png"><img width="600" height="400" decoding="async" alt="_images/interpolation2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;600&#39;%20height=&#39;400&#39;%20viewBox=&#39;0%200%20600%20400&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-interpolation2.png"/></a></p>
</td>
</tr>
</tbody>
</table>
<p>The Euclidean coordinates of point <span data-katex-display="false">P</span> are the same whether it is inside the quadrilateral <span data-katex-display="false">ABCD</span> or the triangle <span data-katex-display="false">ABC</span>.</p>
<p>Depending on the Euclidean coordinates of point <span data-katex-display="false">P</span>, it may lie inside triangle <span data-katex-display="false">ABC</span> or triangle <span data-katex-display="false">ACD</span>. There is a system of equations that describe the coordinates of point <span data-katex-display="false">P</span> using the vertices of quadrilateral <span data-katex-display="false">ABCD</span> and the Bilinear interpolation coefficients <span data-katex-display="false">u,v</span>, as well as the vertices of triangles <span data-katex-display="false">ABC</span> or <span data-katex-display="false">ACD</span> and the Barycentric coordinates for the same point <span data-katex-display="false">P</span>.</p>
<p>The coordinates of point <span data-katex-display="false">P</span> in <span data-katex-display="false">\mathbb{R}^2</span> can be calculated using Barycentric coordinates <span data-katex-display="false">\alpha, \beta, \gamma</span> and Bilinear interpolation coefficients <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span>, which can be expressed by the following two independent set of equations:</p>
<p>The coordinates of point <span data-katex-display="false">P</span> in <span data-katex-display="false">\mathbb{R}^2</span> can be calculated using Barycentric coordinates <span data-katex-display="false">\alpha, \beta, \gamma</span> and Bilinear interpolation coefficients <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span>, which can be expressed by the following two independent sets of equations:</p>
<p><span data-katex-display="true">     \begin{cases}         A_x + v(D_x - A_x) = G_x \\         A_y + v(D_y - A_y) = G_y \\         B_x + v(C_x - B_x) = H_x \\         B_y + v(C_y - B_y) = H_y \\         G_x + s(H_x - G_x) = P_x \\         G_y + s(H_y - G_y) = P_y \\         \alpha A_x + \beta B_x + \gamma D_x  = P_x \\         \alpha A_y + \beta B_y + \gamma D_y  = P_y \\     \end{cases}     \newline \newline     \begin{cases}         A_x + u(B_x - A_x) = E_x \\         A_y + u(B_y - A_y) = E_y \\         D_x + u(C_x - D_x) = F_x \\         D_y + u(C_y - D_y) = F_y \\         E_x + t(F_x - E_x) = P_x \\         E_y + t(F_x - E_y) = P_y \\         \alpha A_x + \beta B_x + \gamma D_x  = P_x \\         \alpha A_y + \beta B_y + \gamma D_y  = P_y \\     \end{cases} </span></p>
<p>The equations can be reduced to the form:</p>
<p><span data-katex-display="true">     \begin{cases}         A_x + u(B_x - A_x) + s(D_x + u(C_x - D_x) - A_x - u(B_x - A_x)) = \alpha A_x + \beta B_x + \gamma D_x \\         A_y + u(B_y - A_y) + s(D_y + u(C_y - D_y) - A_y - u(B_y - A_y)) = \alpha A_y + \beta B_y + \gamma D_y \\     \end{cases}     \newline \newline     \begin{cases}         A_x + v(D_x - A_x) + t(B_x + v(C_x - B_x) - A_x - v(D_x - A_x)) = \alpha A_x + \beta B_x + \gamma D_x \\         A_y + v(D_y - A_y) + t(B_y + v(C_y - B_y) - A_y - v(D_y - A_y)) = \alpha A_y + \beta B_y + \gamma D_y \\     \end{cases} </span></p>
<p>We can further simplify using:</p>
<p><span data-katex-display="true">     \begin{cases}         \vec{P} = D-A \\         \vec{R} = B-A \\         \vec{Q} = C-B-D+A \\                     \alpha = (1-\beta-\gamma) \\     \end{cases} </span></p>
<p>to a two-system of equations:</p>
<p><span data-katex-display="true">     \begin{cases}         u\vec{R}_x + s(\vec{P}_x + u\vec{Q}_x) = \beta \vec{R}_x + \gamma \vec{P}_x \\         u\vec{R}_y + s(\vec{P}_y + u\vec{Q}_y) = \beta \vec{R}_y + \gamma \vec{P}_y \\     \end{cases}     \newline \newline     \begin{cases}         v\vec{P}_x + t(\vec{R}_x + v\vec{Q}_x) = \beta \vec{R}_x + \gamma \vec{P}_x \\         v\vec{P}_y + t(\vec{R}_y + v\vec{Q}_y) = \beta \vec{R}_y + \gamma \vec{P}_y \\     \end{cases} </span></p>
<p>Now, solving the two systems of equations for <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span> leads to the problem of solving two quadratic equations:</p>
<p><span data-katex-display="true">     \begin{cases}         u^2(\vec{R}_x\vec{Q}_y - \vec{Q}_x\vec{R}_y) + u(\vec{R}_x\vec{P}_y - \vec{P}_x\vec{R}_y + \beta(\vec{Q}_x\vec{R}_y-\vec{R}_x\vec{Q}_y) + \gamma (\vec{Q}_x\vec{P}_y-\vec{P}_x\vec{Q}_y)) - \\         \beta(\vec{P}_x\vec{R}_y-\vec{R}_x\vec{P}_y) = 0\\     \end{cases}     \newline \newline     \begin{cases}         v^2(\vec{P}_x\vec{Q}_y - \vec{Q}_x\vec{P}_y) + v(\vec{P}_x\vec{R}_y - \vec{R}_x\vec{P}_y + \beta(\vec{Q}_x\vec{R}_y-\vec{R}_x\vec{Q}_y) + \gamma(\vec{Q}_x\vec{P}_y-\vec{P}_x\vec{Q}_y)) - \\         \gamma(\vec{R}_x\vec{P}_y-\vec{P}_x\vec{R}_y) = 0\\     \end{cases} </span></p>
<p>Embedding this solution in <span data-katex-display="false">\mathbb{R}^3</span> at the plane <span data-katex-display="false">z=0</span> with the surface normal vector for a triangle <span data-katex-display="false">\vec{N} = (0,0,1)</span>, the equation can be written as:</p>
<p><span data-katex-display="true">         u^2 \vec{N}\cdot(\vec{R}\times \vec{Q}) + u(\vec{N}\cdot(\vec{R}\times \vec{P}) + \beta \vec{N}\cdot(\vec{Q}\times \vec{R}) + \gamma \vec{N}\cdot(\vec{Q}\times \vec{P})) + \beta \vec{N}\cdot(\vec{P}\times \vec{R}) = 0     \newline \newline         v^2 \vec{N}\cdot(\vec{P}\times \vec{Q}) + v(\vec{N}\cdot(\vec{P}\times \vec{R}) + \beta \vec{N}\cdot(\vec{Q}\times \vec{R}) + \gamma \vec{N}\cdot(\vec{Q}\times \vec{P})) - \gamma \vec{N}\cdot(\vec{R}\times \vec{P}) = 0 </span></p>
<p>where <span data-katex-display="false">\times</span> is the cross product in <span data-katex-display="false">\mathbb{R}^3</span> and <span data-katex-display="false">\cdot</span> is the dot product in <span data-katex-display="false">\mathbb{R}^3</span>.</p>
<p>Substituting the triple dot product into the equation:</p>
<p><span data-katex-display="true">     \begin{cases}         A_u = \vec{N}\cdot(\vec{R}\times \vec{Q}) \\                 A_v = \vec{N}\cdot(\vec{P}\times \vec{Q}) \\         B = \vec{N}\cdot(\vec{P}\times \vec{R}) \\     \end{cases} </span></p>
<p>the final two equations are as follows:</p>
<p><span data-katex-display="true">         u^2 A_u - u(\beta A_u + \gamma A_v + B) + \beta B = 0 \\         v^2 A_v - v(\beta A_u + \gamma A_v - B) - \gamma B = 0 \\ </span></p>
<p>The last step is to solve these two quadratic equations for the parameters <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span>.</p>
<p>The equation can be used to calculate bilinear interpolation coefficients <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span> for any quadrilateral in three-dimensional space. This is because if a quadrilateral is embedded in any plane in <span data-katex-display="false">\mathbb{R}^3</span>, it can be transformed isometrically to the plane <span data-katex-display="false">z=0</span>, and the premise still holds after isometric mapping.</p>
<p>It is worth noting that the above equations show that the bilinear interpolation coefficients <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span> depend on all four Euclidean coordinates of the vertices in the quadrilateral. If we are dealing with static meshes, these coefficients can be calculated in advance (this is not necessary at runtime). However, if we are working with dynamic (animated) meshes, it is necessary to calculate these coefficients at runtime. Therefore, we need to use a Graphics Pipeline stage where we still have access to all four positions of the vertices of the quadrilateral.</p>
<section id="parallelograms">
<h3 id="parallelograms">Parallelograms<a href="#parallelograms" title="Permalink to this heading"></a></h3>
<p>When rendering quadrilaterals limited to parallelograms, the solution is much simpler because <span data-katex-display="false">\vec{Q} = \vec{0}</span>. This fact can be deduced after a quick analysis.</p>
<p>Vector <span data-katex-display="false">\vec{Q}</span> is described as <span data-katex-display="false">\vec{Q} = (C - B) + (A - D)</span>. In parallelograms, the vector from the first parenthesis <span data-katex-display="false">\vec{C - B}</span>, by definition, has the same length as the vector <span data-katex-display="false">\vec{A - D}</span> but in the opposite direction. Thus, the sum of these vectors is always the zero vector.</p>
<p>Therefore, when <span data-katex-display="false">\vec{Q} = \vec{0}</span>, we are no longer dealing with a quadratic equation, but with a linear equation, making the solution much simpler:</p>
<p><span data-katex-display="true">         u = \beta \\                 v = \gamma \\ </span></p>
<p>This simpler case has already been described, and the solution can be found in <a href="https://asawicki.info/news_1721_how_to_correctly_interpolate_vertex_attributes_on_a_parallelogram_using_modern_gpus" target="_blank">How to Correctly Interpolate Vertex Attributes on a Parallelogram Using Modern GPUs?</a>.</p>
</section>
</section>
<section id="hardware-accelerated-implementation">
<h2 id="hardware-accelerated-implementation">Hardware-accelerated implementation<a href="#hardware-accelerated-implementation" title="Permalink to this heading"></a></h2>
<p>The hardware-accelerated implementation of the algebraic solution presented in the previous section can be achieved using three different Graphics Pipeline stages: Geometry Shader, Tessellation Shader, and Mesh Shader. This three-way implementation demonstrates that the technique is feasible on GPU hardware released as far back as 2008. The following source code uses the GLSL shading language.</p>
<p>The table below describes what API versions and extensions are necessary to implement the presented technique:</p>
<table>
<thead>
<tr>
<th>
</th>
<th>
<p>Vulkan®</p>
</th>
<th>
<p>DirectX®</p>
</th>
<th>
<p>OpenGL®</p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Geometry Shader</p>
</td>
<td>
<p>Vulkan® geometry Shader feature enabled</p>
</td>
<td>
<p>DirectX® 10</p>
</td>
<td>
<p>OpenGL® 3.2</p>
</td>
</tr>
<tr>
<td>
<p>Tessellation Shader</p>
</td>
<td>
<p>Vulkan® tessellation Shader feature enabled</p>
</td>
<td>
<p>DirectX® 11</p>
</td>
<td>
<p>OpenGL® 4</p>
</td>
</tr>
<tr>
<td>
<p>Mesh Shader</p>
</td>
<td>
<p>Vulkan® VK_EXT_mesh_shader extension enabled</p>
</td>
<td>
<p>DirectX® 12 Ultimate</p>
</td>
<td>
<p>OpenGL® 4 GL_NV_mesh_shader extension enabled</p>
</td>
</tr>
</tbody>
</table>
<p>The implementation of the presented method requires Barycentric coordinates of the currently processed fragment in the Fragment Shader. This is possible when the following extensions are available:</p>
<ul>
<li>
<p>Vulkan® VK_KHR_fragment_shader_barycentric extension.</p>
</li>
<li>
<p>DirectX® 12 Shader Model 6.1.</p>
</li>
<li>
<p>OpenGL® 4 GL_NV_fragment_shader_barycentric or GL_AMD_shader_explicit_vertex_parameter.</p>
</li>
</ul>
<p>If the GPU does not support the above extension, there is a way to generate them in the Geometry, Tessellation, or Mesh Shader stage.</p>
<p>The implementation of the new method presented in this article can be divided into the following steps:</p>
<ol>
<li>
<p>Delivering Quadrilateral Primitives to the Graphics Pipeline.</p>
<p>Quadrilateral primitives are not available in modern graphics APIs (excluding the legacy OpenGL GL_QUADS and GL_QUAD_STRIP primitive types). To support quadrilateral-like primitives, use the following methods:</p>
<ul>
<li>
<p>Geometry Shader: With the Geometry Shader stage, adjacency primitives can be used to mimic quadrilateral primitives:</p>
<ul>
<li>
<p>OpenGL® GL_LINES_ADJACENCY</p>
</li>
<li>
<p>Vulkan® VK_PRIMITIVE_TOPOLOGY_LINE_LIST_WITH_ADJACENCY</p>
</li>
<li>
<p>DirectX® 12/11 D3D_PRIMITIVE_TOPOLOGY_LINELIST_ADJ</p>
</li>
</ul>
</li>
<li>
<p>With Tessellation stages, a new Patch primitive was introduced. In this topology, the number of vertices defined in the meshes is not fixed, but the so-called Control Points range from 1 to 32 per Patch. These Control Points can be treated as Control Points of Bézier patches, but they can also be treated as vertices of a polygon. The implementation of the solution presented in this article uses a Patch with 4 Control Points and treats them as vertices of a quadrilateral.</p>
</li>
<li>
<p>Mesh Shader: Using Mesh Shaders, there are many ways to introduce a quadrilateral primitive into the Graphics Pipeline. This stage was developed to provide more flexibility to the user. Therefore, it is up to the user to generate meshlets that will contain quadrilaterals in some way (this is not within the scope of this article).</p>
</li>
</ul>
</li>
<li>
<p>The next step is to calculate the constants <span data-katex-display="false">A_u, A_v, B</span> (using one of the steps above), which will then be used in the Fragment Shader. We need to calculate these constants in one of the above pipeline stages because, in the Fragment Shader, we do not have access to the four attributes of the quadrilateral vertices (the Barycentric coordinate extension, if present, only gives us access to the three attributes of the triangle vertices). By analyzing the algebraic solution of the presented method, we can see that these constants depend on the positions of the vertices of the quadrilateral.</p>
</li>
</ol>
<p>The following function needs to be executed in the Geometry Shader, Tessellation Evaluation Shader, or Mesh Shader.</p>
<div>
<div>

<pre><code><span>    </span><span>vec3</span><span> </span><span>calculateConstants</span><span>(</span><span>vec3</span><span> </span><span>v0</span><span>,</span><span> </span><span>vec3</span><span> </span><span>v1</span><span>,</span><span> </span><span>vec3</span><span> </span><span>v2</span><span>,</span><span> </span><span>vec3</span><span> </span><span>v3</span><span>)</span>
<span>    </span><span>{</span>
<span>        </span><span>const</span><span> </span><span>vec3</span><span> </span><span>v10</span><span> </span><span>=</span><span> </span><span>v1</span><span> </span><span>-</span><span> </span><span>v0</span><span>;</span>
<span>        </span><span>const</span><span> </span><span>vec3</span><span> </span><span>v30</span><span> </span><span>=</span><span> </span><span>v3</span><span> </span><span>-</span><span> </span><span>v0</span><span>;</span>
<span>        </span><span>const</span><span> </span><span>vec3</span><span> </span><span>crossv10v30</span><span> </span><span>=</span><span> </span><span>cross</span><span>(</span><span>v10</span><span>,</span><span> </span><span>v30</span><span>);</span>
<span>        </span><span>const</span><span> </span><span>vec3</span><span> </span><span>n</span><span> </span><span>=</span><span> </span><span>normalize</span><span>(</span><span>crossv10v30</span><span>);</span>
<span>        </span><span>const</span><span> </span><span>vec3</span><span> </span><span>d</span><span> </span><span>=</span><span> </span><span>v0</span><span> </span><span>-</span><span> </span><span>v1</span><span> </span><span>+</span><span> </span><span>v2</span><span> </span><span>-</span><span> </span><span>v3</span><span>;</span>
<span>        </span><span>float</span><span> </span><span>A_u</span><span> </span><span>=</span><span> </span><span>dot</span><span>(</span><span>n</span><span>,</span><span> </span><span>cross</span><span>(</span><span>d</span><span>,</span><span> </span><span>v30</span><span>));</span>
<span>        </span><span>float</span><span> </span><span>A_v</span><span> </span><span>=</span><span> </span><span>dot</span><span>(</span><span>n</span><span>,</span><span> </span><span>cross</span><span>(</span><span>d</span><span>,</span><span> </span><span>v10</span><span>));</span>
<span>        </span><span>const</span><span> </span><span>float</span><span> </span><span>B</span><span> </span><span>=</span><span>  </span><span>dot</span><span>(</span><span>n</span><span>,</span><span> </span><span>crossv10v30</span><span>);</span>
<span>        </span><span>A_u</span><span> </span><span>=</span><span> </span><span>abs</span><span>(</span><span>A_u</span><span>)</span><span> </span><span>&lt;</span><span> </span><span>0.00001</span><span> </span><span>?</span><span> </span><span>0.0</span><span> </span><span>:</span><span> </span><span>A_u</span><span>;</span>
<span>        </span><span>A_v</span><span> </span><span>=</span><span> </span><span>abs</span><span>(</span><span>A_v</span><span>)</span><span> </span><span>&lt;</span><span> </span><span>0.00001</span><span> </span><span>?</span><span> </span><span>0.0</span><span> </span><span>:</span><span> </span><span>A_v</span><span>;</span>
<span>        </span><span>return</span><span> </span><span>vec3</span><span>(</span><span>A_u</span><span>,</span><span> </span><span>A_v</span><span>,</span><span> </span><span>B</span><span>);</span>
<span>    </span><span>}</span>
</code></pre>
</div>
</div>
<p>Where <code><span>v0,</span> <span>v1,</span> <span>v2,</span> <span>v3</span></code> are the Euclidean coordinates of the quadrilateral vertices in the following order:</p>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-0c5d6cc87c5c76539632837dfb64b19b-Picture6a.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Picture6a.png"><img width="340" height="336" decoding="async" alt="_images/Picture6a.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;340&#39;%20height=&#39;336&#39;%20viewBox=&#39;0%200%20340%20336&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Picture6a.png"/></a></p>
<p>The calculated values of <code><span>A_u,</span> <span>A_v</span></code> and <code><span>B</span></code> are then passed to the Fragment Shader.</p>
<ol start="2">
<li>
<p>Passing vertex attributes to the Fragment Shader.</p>
</li>
</ol>
<p>For Bilinear interpolation to work in a Fragment Shader, we need to be able to fetch all four vertex attributes (such as texture coordinates, vertex normal, and vertex color) in it.</p>
<ul>
<li>
<p>If the Barycentric coordinate extension is available, we have access to three of these attributes, so another stage must export the missing vertex attribute of the quadrilateral. The following code can be used in the Fragment Shader:</p>
</li>
</ul>
<div>
<div>

<pre><code><span>layout</span><span> </span><span>(</span><span>location</span><span> </span><span>=</span><span> </span><span>0</span><span>)</span><span> </span><span>pervertexEXT</span><span> </span><span>in</span><span> </span><span>block</span>
<span>{</span>
<span>	</span><span>vec3</span><span> </span><span>Normal</span><span>;</span>
<span>	</span><span>flat</span><span> </span><span>vec3</span><span> </span><span>NormalExtra</span><span>;</span>
<span>	</span><span>vec2</span><span> </span><span>Texcoord</span><span>;</span>
<span>	</span><span>flat</span><span> </span><span>vec2</span><span> </span><span>TexcoordExtra</span><span>;</span>
<span>	</span><span>vec4</span><span> </span><span>Color</span><span>;</span>
<span>	</span><span>flat</span><span> </span><span>vec4</span><span> </span><span>ColorExtra</span><span>;</span>
<span>	</span><span>flat</span><span> </span><span>vec3</span><span> </span><span>BaryConstants</span><span>;</span>
<span>}</span><span> </span><span>In</span><span>[];</span>
</code></pre>
</div>
</div>
<ul>
<li>
<p>If the Barycentric coordinate extension is not available, all four vertex attributes need to be exported as a four-element array, with a variable calculated to imitate the Barycentric Coordinate. The following code can be used in the Fragment Shader:</p>
</li>
</ul>
<div>
<div>

<pre><code><span>layout</span><span>(</span><span>location</span><span> </span><span>=</span><span> </span><span>0</span><span>)</span><span> </span><span>in</span><span> </span><span>block</span>
<span>{</span>
<span>    </span><span>flat</span><span> </span><span>vec3</span><span> </span><span>Normal</span><span>[</span><span>4</span><span>];</span>
<span>    </span><span>flat</span><span> </span><span>vec2</span><span> </span><span>Texcoord</span><span>[</span><span>4</span><span>];</span>
<span>	</span><span>flat</span><span> </span><span>vec4</span><span> </span><span>Color</span><span>[</span><span>4</span><span>];</span>
<span>	</span><span>flat</span><span> </span><span>vec3</span><span> </span><span>BaryConstants</span><span>;</span>
<span>	</span><span>vec3</span><span> </span><span>BarycentricCoordinate</span><span>;</span><span>	</span>
<span>}</span><span> </span><span>In</span><span>;</span>
</code></pre>
</div>
</div>
<ol start="3">
<li>
<p>Orders of Barycentric coordinates in the triangles formed when dividing the quadrilateral.</p>
</li>
</ol>
<p>When using Barycentric coordinates for interpolation of vertex attributes, the order in which they are defined in the triangle doesn’t matter. However, in the implementation method described in this article, the specific order is important. This order can be visually represented as follows:</p>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-9d13ced0d393aa58b80b0fd0f1691b1e-geom_bary3.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-geom_bary3.png"><img width="420" height="380" decoding="async" alt="_images/geom_bary3.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;420&#39;%20height=&#39;380&#39;%20viewBox=&#39;0%200%20420%20380&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-geom_bary3.png"/></a></p>
<p>Where <span>red</span> color represents the influence of the <span data-katex-display="false">\alpha</span> Barycentric coordinate, <span>green</span> represents <span data-katex-display="false">\beta</span>, and <span>blue</span> represents <span data-katex-display="false">\gamma</span>.</p>
<p>This order of Barycentric coordinates can be supplied by hardware when the proper extension is available, or these data can be generated in the Tessellation or Geometry Shader stage.</p>
<ol start="4">
<li>
<p>Calculate <span data-katex-display="false">u, v</span> Bilinear coefficients.</p>
</li>
</ol>
<p>In the Fragment Shader, the calculation of Bilinear interpolation coefficients <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span> can be done by calling the following function.</p>
<div>
<div>

<pre><code><span>    </span><span>vec2</span><span> </span><span>calculateBilinear</span><span>(</span><span>float</span><span> </span><span>beta</span><span>,</span><span> </span><span>float</span><span> </span><span>gamma</span><span>,</span><span> </span><span>float</span><span> </span><span>A_u</span><span>,</span><span> </span><span>float</span><span> </span><span>A_v</span><span>,</span><span> </span><span>float</span><span> </span><span>B</span><span>)</span>
<span>    </span><span>{</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>B_u</span><span> </span><span>=</span><span> </span><span>B</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>B_v</span><span> </span><span>=</span><span> </span><span>-</span><span>B</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>B2</span><span> </span><span>=</span><span> </span><span>beta</span><span> </span><span>*</span><span> </span><span>A_v</span><span> </span><span>+</span><span> </span><span>gamma</span><span> </span><span>*</span><span> </span><span>A_u</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>t_u</span><span> </span><span>=</span><span> </span><span>B_u</span><span> </span><span>-</span><span> </span><span>B2</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>t_v</span><span> </span><span>=</span><span> </span><span>B_v</span><span> </span><span>-</span><span> </span><span>B2</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>b_u</span><span> </span><span>=</span><span> </span><span>t_u</span><span> </span><span>/</span><span> </span><span>A_u</span><span> </span><span>*</span><span> </span><span>0.5</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>b_v</span><span> </span><span>=</span><span> </span><span>t_v</span><span> </span><span>/</span><span> </span><span>A_v</span><span> </span><span>*</span><span> </span><span>0.5</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>c_u</span><span> </span><span>=</span><span> </span><span>gamma</span><span> </span><span>*</span><span> </span><span>B_v</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>c_v</span><span> </span><span>=</span><span> </span><span>beta</span><span> </span><span>*</span><span> </span><span>B_u</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>d_u</span><span> </span><span>=</span><span> </span><span>b_u</span><span> </span><span>*</span><span> </span><span>b_u</span><span> </span><span>-</span><span> </span><span>c_u</span><span> </span><span>/</span><span> </span><span>A_u</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>d_v</span><span> </span><span>=</span><span> </span><span>b_v</span><span> </span><span>*</span><span> </span><span>b_v</span><span> </span><span>-</span><span> </span><span>c_v</span><span> </span><span>/</span><span> </span><span>A_v</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>s_u</span><span> </span><span>=</span><span> </span><span>A_u</span><span> </span><span>&gt;=</span><span> </span><span>0.0</span><span> </span><span>?</span><span> </span><span>-</span><span>1.0</span><span> </span><span>:</span><span> </span><span>1.0</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>s_v</span><span> </span><span>=</span><span> </span><span>A_v</span><span> </span><span>&gt;=</span><span> </span><span>0.0</span><span> </span><span>?</span><span> </span><span>1.0</span><span> </span><span>:</span><span> </span><span>-</span><span>1.0</span><span>;</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>u</span><span> </span><span>=</span><span> </span><span>A_u</span><span> </span><span>!=</span><span> </span><span>0.0</span><span> </span><span>?</span><span> </span><span>(</span><span>-</span><span>b_u</span><span> </span><span>-</span><span> </span><span>s_u</span><span> </span><span>*</span><span> </span><span>sqrt</span><span>(</span><span>d_u</span><span>))</span><span> </span><span>:</span><span> </span><span>(</span><span>-</span><span>c_u</span><span> </span><span>/</span><span> </span><span>t_u</span><span>);</span>
<span>      </span><span>const</span><span> </span><span>float</span><span> </span><span>v</span><span> </span><span>=</span><span> </span><span>A_v</span><span> </span><span>!=</span><span> </span><span>0.0</span><span> </span><span>?</span><span> </span><span>(</span><span>-</span><span>b_v</span><span> </span><span>-</span><span> </span><span>s_v</span><span> </span><span>*</span><span> </span><span>sqrt</span><span>(</span><span>d_v</span><span>))</span><span> </span><span>:</span><span> </span><span>(</span><span>-</span><span>c_v</span><span> </span><span>/</span><span> </span><span>t_v</span><span>);</span>
<span>      </span><span>return</span><span> </span><span>vec2</span><span>(</span><span>u</span><span>,</span><span> </span><span>v</span><span>);</span>
<span>    </span><span>}</span>
</code></pre>
</div>
</div>
<p>Where <code><span>beta</span></code> is <span data-katex-display="false">\beta</span> Barycentric coordinate, <code><span>gamma</span></code> is <span data-katex-display="false">\gamma</span> Barycentric coordinate, <code><span>A_u,</span> <span>A_v,</span> <span>B</span></code> are constants calculated in previous Graphics Pipeline Stage.</p>
<ol start="5">
<li>
<p>Bilinear interpolation of vertices attributes.</p>
</li>
</ol>
<p>When Bilinear interpolation coefficients <span data-katex-display="false">u</span> and <span data-katex-display="false">v</span> are calculated, the interpolation of vertex attributes can be achieved using functions.</p>
<div>
<div>

<pre><code><span>vec4</span><span> </span><span>interpolateBilinear</span><span>(</span><span>vec4</span><span> </span><span>v0</span><span>,</span><span> </span><span>vec4</span><span> </span><span>v1</span><span>,</span><span> </span><span>vec4</span><span> </span><span>v2</span><span>,</span><span> </span><span>vec4</span><span> </span><span>v3</span><span>,</span><span> </span><span>vec2</span><span> </span><span>uv</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>mix</span><span>(</span><span>mix</span><span>(</span><span>v0</span><span>,</span><span> </span><span>v1</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>mix</span><span>(</span><span>v2</span><span>,</span><span> </span><span>v3</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>uv</span><span>.</span><span>x</span><span>);</span><span> </span>
<span>}</span>
<span>vec3</span><span> </span><span>interpolateBilinear</span><span>(</span><span>vec3</span><span> </span><span>v0</span><span>,</span><span> </span><span>vec3</span><span> </span><span>v1</span><span>,</span><span> </span><span>vec3</span><span> </span><span>v2</span><span>,</span><span> </span><span>vec3</span><span> </span><span>v3</span><span>,</span><span> </span><span>vec2</span><span> </span><span>uv</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>mix</span><span>(</span><span>mix</span><span>(</span><span>v0</span><span>,</span><span> </span><span>v1</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>mix</span><span>(</span><span>v2</span><span>,</span><span> </span><span>v3</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>uv</span><span>.</span><span>x</span><span>);</span><span> </span>
<span>}</span>
<span>vec2</span><span> </span><span>interpolateBilinear</span><span>(</span><span>vec2</span><span> </span><span>v0</span><span>,</span><span> </span><span>vec2</span><span> </span><span>v1</span><span>,</span><span> </span><span>vec2</span><span> </span><span>v2</span><span>,</span><span> </span><span>vec2</span><span> </span><span>v3</span><span>,</span><span> </span><span>vec2</span><span> </span><span>uv</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>mix</span><span>(</span><span>mix</span><span>(</span><span>v0</span><span>,</span><span> </span><span>v1</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>mix</span><span>(</span><span>v2</span><span>,</span><span> </span><span>v3</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>uv</span><span>.</span><span>x</span><span>);</span><span> </span>
<span>}</span>
<span>float</span><span> </span><span>interpolateBilinear</span><span>(</span><span>float</span><span> </span><span>v0</span><span>,</span><span> </span><span>float</span><span> </span><span>v1</span><span>,</span><span> </span><span>float</span><span> </span><span>v2</span><span>,</span><span> </span><span>float</span><span> </span><span>v3</span><span>,</span><span> </span><span>vec2</span><span> </span><span>uv</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>mix</span><span>(</span><span>mix</span><span>(</span><span>v0</span><span>,</span><span> </span><span>v1</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>mix</span><span>(</span><span>v2</span><span>,</span><span> </span><span>v3</span><span>,</span><span> </span><span>uv</span><span>.</span><span>y</span><span>),</span><span> </span><span>uv</span><span>.</span><span>x</span><span>);</span><span> </span>
<span>}</span>
</code></pre>
</div>
</div>
<p>Where <code><span>v0,</span> <span>v1,</span> <span>v2,</span> <span>v3</span></code> are the quadrilateral vertex attributes.</p>
<section id="id1">
<h3 id="parallelograms">Parallelograms<a href="#id1" title="Permalink to this heading"></a></h3>
<p>For quadrilaterals, which are restricted to parallelograms, implementing the technique described in this article is even simpler.</p>
<ul>
<li>
<p>In the Tessellation Shader, Geometry Shader, or Mesh Shader stage, when data for four vertex attributes is still available, one extra constant data (per attribute) needs to be calculated.</p>
</li>
</ul>
<div>
<div>

<pre><code><span>vec4</span><span> </span><span>calculateConstants</span><span>(</span><span>vec4</span><span> </span><span>A</span><span>,</span><span> </span><span>vec4</span><span> </span><span>B</span><span>,</span><span> </span><span>vec4</span><span> </span><span>C</span><span>,</span><span> </span><span>vec4</span><span> </span><span>D</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>A</span><span> </span><span>-</span><span> </span><span>B</span><span> </span><span>+</span><span> </span><span>C</span><span> </span><span>-</span><span> </span><span>D</span><span>;</span>
<span>}</span>
<span>vec3</span><span> </span><span>calculateConstants</span><span>(</span><span>vec3</span><span> </span><span>A</span><span>,</span><span> </span><span>vec3</span><span> </span><span>B</span><span>,</span><span> </span><span>vec3</span><span> </span><span>C</span><span>,</span><span> </span><span>vec3</span><span> </span><span>D</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>A</span><span> </span><span>-</span><span> </span><span>B</span><span> </span><span>+</span><span> </span><span>C</span><span> </span><span>-</span><span> </span><span>D</span><span>;</span>
<span>}</span>
<span>vec2</span><span> </span><span>calculateConstants</span><span>(</span><span>vec2</span><span> </span><span>A</span><span>,</span><span> </span><span>vec2</span><span> </span><span>B</span><span>,</span><span> </span><span>vec2</span><span> </span><span>C</span><span>,</span><span> </span><span>vec2</span><span> </span><span>D</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>A</span><span> </span><span>-</span><span> </span><span>B</span><span> </span><span>+</span><span> </span><span>C</span><span> </span><span>-</span><span> </span><span>D</span><span>;</span>
<span>}</span>
<span>float</span><span> </span><span>calculateConstants</span><span>(</span><span>float</span><span> </span><span>A</span><span>,</span><span> </span><span>float</span><span> </span><span>B</span><span>,</span><span> </span><span>float</span><span> </span><span>C</span><span>,</span><span> </span><span>float</span><span> </span><span>D</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>A</span><span> </span><span>-</span><span> </span><span>B</span><span> </span><span>+</span><span> </span><span>C</span><span> </span><span>-</span><span> </span><span>D</span><span>;</span>
<span>}</span>
</code></pre>
</div>
</div>
<p>Where <code><span>A,</span> <span>B,</span> <span>C,</span> <span>D</span></code> are vertex attributes arranged as specified.</p>
<p>The calculated value for each vertex attribute needs to be passed to the Fragment Shader.</p>
<ul>
<li>
<p>In Fragment Shader, the following.</p>
</li>
</ul>
<div>
<div>

<pre><code><span>vec4</span><span> </span><span>interpolateBilinear</span><span>(</span><span>vec4</span><span> </span><span>attribute</span><span>,</span><span> </span><span>vec2</span><span> </span><span>barycentric</span><span>,</span><span> </span><span>vec4</span><span> </span><span>extraVal</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>attribute</span><span> </span><span>+</span><span> </span><span>barycentric</span><span>.</span><span>x</span><span> </span><span>*</span><span> </span><span>barycentric</span><span>.</span><span>y</span><span> </span><span>*</span><span> </span><span>extraVal</span><span>;</span>
<span>}</span>
<span>vec3</span><span> </span><span>interpolateBilinear</span><span>(</span><span>vec3</span><span> </span><span>attribute</span><span>,</span><span> </span><span>vec2</span><span> </span><span>barycentric</span><span>,</span><span> </span><span>vec3</span><span> </span><span>extraVal</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>attribute</span><span> </span><span>+</span><span> </span><span>barycentric</span><span>.</span><span>x</span><span> </span><span>*</span><span> </span><span>barycentric</span><span>.</span><span>y</span><span> </span><span>*</span><span> </span><span>extraVal</span><span>;</span>
<span>}</span>
<span>vec2</span><span> </span><span>interpolateBilinear</span><span>(</span><span>vec2</span><span> </span><span>attribute</span><span>,</span><span> </span><span>vec2</span><span> </span><span>barycentric</span><span>,</span><span> </span><span>vec2</span><span> </span><span>extraVal</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>attribute</span><span> </span><span>+</span><span> </span><span>barycentric</span><span>.</span><span>x</span><span> </span><span>*</span><span> </span><span>barycentric</span><span>.</span><span>y</span><span> </span><span>*</span><span> </span><span>extraVal</span><span>;</span>
<span>}</span>
<span>float</span><span> </span><span>interpolateBilinear</span><span>(</span><span>float</span><span> </span><span>attribute</span><span>,</span><span> </span><span>vec2</span><span> </span><span>barycentric</span><span>,</span><span> </span><span>float</span><span> </span><span>extraVal</span><span>)</span>
<span>{</span>
<span>    </span><span>return</span><span> </span><span>attribute</span><span> </span><span>+</span><span> </span><span>barycentric</span><span>.</span><span>x</span><span> </span><span>*</span><span> </span><span>barycentric</span><span>.</span><span>y</span><span> </span><span>*</span><span> </span><span>extraVal</span><span>;</span>
<span>}</span>
</code></pre>
</div>
</div>
<p>Where <code><span>attribute</span></code> represents a value interpolated by traditional Barycentric interpolation (available in the Fragment Shader), <code><span>barycentric</span></code> is a <code><span>vec2</span></code> data type containing the fragments’ <span data-katex-display="false">\beta</span> and <span data-katex-display="false">\gamma</span> Barycentric coordinates, and <code><span>extra</span></code> is a constant calculated in the previous Geometry, Tessellation, Mesh Shader stage.</p>
</section>
</section>
<section id="results">
<h2 id="results">Results<a href="#results" title="Permalink to this heading"></a></h2>
<p>The output of the algebraic solution presented in this article remains consistent across different implementations. Depending on the type of vertex attributes, the results can be summarized in the following table.</p>
<table>
<thead>
<tr>
<th>
<p>Vertex Attribute</p>
</th>
<th>
<p>Barycentric interpolation</p>
</th>
<th>
<p>Bilinear interpolation using the solution </p>
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<p>Color</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-19bc95d1700790bc331564956a47d944-1.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-1.png"><img width="640" height="640" decoding="async" alt="_images/1.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-1.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-f81dc071f7d865dd3f48e34639f0b557-2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-2.png"><img width="640" height="640" decoding="async" alt="_images/2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-2.png"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Texture coordinate</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-ec24b26e7fd79fcdf5c902465cc341d3-3.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-3.png"><img width="640" height="640" decoding="async" alt="_images/3.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-3.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-93eb8d6164743b7a097e95bbe5c66d9f-4.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-4.png"><img width="640" height="640" decoding="async" alt="_images/4.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-4.png"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Normal</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-0290aed55724f46beb0047c2f18bc97c-5.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-5.png"><img width="640" height="640" decoding="async" alt="_images/5.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-5.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-b6fbbc202156839879da9ced439b2145-6.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-6.png"><img width="640" height="640" decoding="async" alt="_images/6.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;640&#39;%20height=&#39;640&#39;%20viewBox=&#39;0%200%20640%20640&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-6.png"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Color</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-f7846f8311fa9636ec3ca8470f3f4df6-trapez1.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez1.gif"><img width="300" height="300" decoding="async" alt="_images/trapez1.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez1.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-7dc1fe1d187d297f09efde19014e451c-trapez1a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez1a.gif"><img width="300" height="300" decoding="async" alt="_images/trapez1a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez1a.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Texture coordinate</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-fcbf880a8c27c6357716ed2b7647b83c-trapez2.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez2.gif"><img width="300" height="300" decoding="async" alt="_images/trapez2.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez2.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-620b37b728ccee0d494478939e486555-trapez2a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez2a.gif"><img width="300" height="300" decoding="async" alt="_images/trapez2a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez2a.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Normal</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-9360fabb2c03c5c58cdc8c5b3549eac4-trapez3.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez3.gif"><img width="300" height="300" decoding="async" alt="_images/trapez3.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez3.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-3eae28224f6b18d8cc1bd07ff84a96c6-trapez3a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez3a.gif"><img width="300" height="300" decoding="async" alt="_images/trapez3a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-trapez3a.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Color</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-28b0dc381e093add2e76b8cb98e364c5-tea1.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea1.gif"><img width="300" height="300" decoding="async" alt="_images/tea1.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea1.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-8f1eda687a9a360df46f16b922c88681-tea1a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea1a.gif"><img width="300" height="300" decoding="async" alt="_images/tea1a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea1a.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Texture coordinate</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-ad784df2d2237ae6c481595eba609ab6-tea2.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea2.gif"><img width="300" height="300" decoding="async" alt="_images/tea2.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea2.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-b8ce4bc4ff6084002e8e3eab752b328d-tea2a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea2a.gif"><img width="300" height="300" decoding="async" alt="_images/tea2a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea2a.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Normal</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-de27696e3cac248658749e0bc30b229c-tea3.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea3.gif"><img width="300" height="300" decoding="async" alt="_images/tea3.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea3.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-00824abe6f08e5352fd516684f9b2a6d-tea3a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea3a.gif"><img width="300" height="300" decoding="async" alt="_images/tea3a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;300&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20300%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-tea3a.gif"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Mesh Example</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-dda0431c7a5f18c76cc2d4b1f4e35648-Picture1.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Picture1.png"><img width="1524" height="900" decoding="async" alt="_images/Picture1.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1524&#39;%20height=&#39;900&#39;%20viewBox=&#39;0%200%201524%20900&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Picture1.png"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-b70c8b80a515bcbd078df9c5b12f9b07-Picture2.png"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Picture2.png"><img width="1524" height="900" decoding="async" alt="_images/Picture2.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;1524&#39;%20height=&#39;900&#39;%20viewBox=&#39;0%200%201524%20900&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-Picture2.png"/></a></p>
</td>
</tr>
<tr>
<td>
<p>Animation Example</p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-a2efd520d53fa39d2c2e7c1766bb41e2-anim1.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-anim1.gif"><img width="400" height="300" decoding="async" alt="_images/anim1.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;400&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20400%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-anim1.gif"/></a></p>
</td>
<td>
<p><a download="" href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_downloads-e041358f4d24723bc2405026e7d8a790-anim1a.gif"><span></span></a><a href="https://writing.natwelch.com/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-anim1a.gif"><img width="400" height="300" decoding="async" alt="_images/anim1a.gif" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20width=&#39;400&#39;%20height=&#39;300&#39;%20viewBox=&#39;0%200%20400%20300&#39;%3E%3C/svg%3E" data-src="/docs_images/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates/bilinear_interpolation_on_a_quadrilateral_using_barycentric_coordinates-html-_images-anim1a.gif"/></a></p>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="summary">

<p>As presented in this article, the algebraic solution for Bilinear interpolation using Barycentric coordinates can be implemented through APIs such as Vulkan® or DirectX®. This implementation leverages hardware-accelerated rendering on GPUs. The paper proposes three different implementations based on the available Graphics Pipeline supported by the GPU. These implementations enable the use of the new method on GPUs (both PCs and mobile devices) ranging from models released in 2008 to the latest versions.</p>
<p><em>Blender is a registered trademark of the Blender Foundation in EU and USA. DirectX is a registered trademark of Microsoft Corporation in the US and other jurisdictions. OpenGL® and the oval logo are trademarks or registered trademarks of Hewlett Packard Enterprise in the United States and/or other countries worldwide. Vulkan and the Vulkan logo are registered trademarks of the Khronos Group Inc.</em></p>
</section>
</div>
		</div>
				</div></div>
  </body>
</html>
