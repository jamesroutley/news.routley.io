<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://blog.mozilla.org/security/2021/12/09/improved-quality-of-intermediate-certificates-with-enhanced-oversight-and-automation/">Original</a>
    <h1>Improving the quality of publicly trusted intermediate CA certificates</h1>
    
    <div id="readability-page-1" class="page"><div>
    <p>In keeping with our commitment to the security and privacy of individuals on the internet, Mozilla is increasing our oversight and adding automation to our compliance-checking of publicly trusted intermediate CA certificates (“<a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/#53-intermediate-certificates">intermediate certificates</a>”). This improvement in automation is important because intermediate certificates play a critical part in the web PKI (Public-Key Infrastructure). Intermediate CA keys directly sign server certificates, and we currently recognize nearly <a href="https://wiki.mozilla.org/CA/Intermediate_Certificates">3,000 intermediate certificates</a>, which chain up to approximately <a href="https://wiki.mozilla.org/CA/Included_Certificates">150 root CA certificates</a> embedded as trust anchors in NSS and Firefox. More specifically, we are updating the <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/">Mozilla Root Store Policy</a> (MRSP) and <a href="https://wiki.mozilla.org/CA">associated guidance</a>, improving the public review of third-party intermediate certificates on the <a href="https://groups.google.com/a/mozilla.org/g/dev-security-policy">Mozilla dev-security-policy list</a>, and enhancing automation in the<a href="https://www.ccadb.org/"> Common CA Database</a> (CCADB).</p>
<h3><b>Recent and Upcoming Policy Updates </b></h3>
<p>In version 2.7.1 of the MRSP, we clarified that all unconstrained intermediate certificates, including those that share the same key pair, must be disclosed in the <a href="https://www.ccadb.org/">CCADB</a>, whether they are self-signed, doppelgänger, reissued, cross-signed, or other types (<a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/#53-intermediate-certificates">MRSP § 5.3</a>).  Currently, “technically constrained” intermediate certificates are not necessarily reported, but in version 2.8 of the MRSP we will begin to also require disclosure of intermediate certificates that are capable of issuing websites (TLS/SSL) or email (S/MIME) certificates even when they are technically constrained. According to <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/#531-technically-constrained">MRSP § 5.3.1</a>, technical constraints are determined by a combination of the trust bits recognized by Mozilla for the root CA certificate (websites and/or email trust bits) and the Extended Key Usage (EKU) and Name Constraints X.509v3 (with constraints on dNSName, iPAddress, DirectoryName, rfc822Name in permittedSubtrees) extensions in the intermediate certificate. For example, an intermediate certificate that contains the id-kp-serverAuth extended key usage in its EKU and is name-constrained according to section 7.1.5 of the<a href="https://cabforum.org/baseline-requirements-documents/"> Baseline Requirements</a> (BRs) will be required (as of MRSP version 2.8) to be disclosed in the CCADB.</p>
<p>We are also updating<a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/#8-ca-operational-changes"> MRSP § 8</a> to formalize requirements and procedures for CAs to follow when they plan to issue an unconstrained intermediate certificate to an external third party. For example, when a Root CA in Mozilla’s program cross-signs a new CA they are essentially bypassing <a href="https://wiki.mozilla.org/CA/Application_Process">Mozilla’s root inclusion process</a>, so the Root CA needs to take responsibility for the new CA and the Root CA needs to perform due diligence on the new CA before issuing the cross-signed certificate. The operator of a Mozilla-trusted Root CA is at all times completely and ultimately accountable for every certificate signed under the Root CA, whether directly or through subordinate CAs or cross-certified CAs. For more details, we refer you to our<a href="https://wiki.mozilla.org/CA/External_Sub_CAs_not_Technically_Constrained"> Process for Review and Approval of Externally Operated Subordinate CAs that are not Technically Constrained</a>.</p>
<h3><b>CCADB Automation Improvements</b></h3>
<p>With the <a href="https://www.ccadb.org/">CCADB</a>, Mozilla has provided a variety of tools to examine the status of intermediate certificates where none existed before. These include improvements that allow us to automatically process CA audit reports using Audit Letter Validation (ALV), advise CAs on the status of their intermediate certificates, and provide CAs and root store operators with lists of tasks relevant to intermediate certificates listed in the CCADB.</p>
<p><b>Automated Audit Letter Validation</b> (ALV) is an automated process that parses and validates the information in CA audit reports, and it is now used to verify that intermediate CAs are properly audited (<a href="https://wiki.mozilla.org/CA/Audit_Statements#Audit_Letter_Validation">CA/Audit Statements:#ALV</a>) according to their technical capabilities; such as issuing certificates for email (S/MIME), websites (TLS/SSL), and EV TLS. For example, a certificate that is technically capable of issuing certificates that can be recognized for EV TLS must have a current EV audit statement that lists the intermediate CA certificate as having been in scope of the EV audit.</p>
<p><b>Task Lists</b> on home pages in the CCADB alert CAs about certificates whose audit statements need to be renewed and to problems such as unaudited intermediate certificates. These task lists help minimize the prompting and reminding that would otherwise be required of root program managers.</p>
<p><a href="https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/security/files/2021/12/Task_List_for_CAs.png"><img loading="lazy" src="https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/security/files/2021/12/Task_List_for_CAs.png" alt="" width="560" height="443" srcset="https://blog.mozilla.org/security/files/2021/12/Task_List_for_CAs.png 560w, https://blog.mozilla.org/security/files/2021/12/Task_List_for_CAs-300x237.png 300w" sizes="(max-width: 560px) 100vw, 560px"/></a></p>
<p><b>Image 1: CCADB lists CA tasks involving intermediate certificates<br/>
</b></p>
<p>The CCADB also generates task lists for root program managers so that we can be aware of items needing our attention.</p>
<p><a href="https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/security/files/2021/12/Task_List_for_Root_Programs.png"><img loading="lazy" src="https://ffp4g1ylyit3jdyti1hqcvtb-wpengine.netdna-ssl.com/security/files/2021/12/Task_List_for_Root_Programs.png" alt="" width="1457" height="600" srcset="https://blog.mozilla.org/security/files/2021/12/Task_List_for_Root_Programs.png 1457w, https://blog.mozilla.org/security/files/2021/12/Task_List_for_Root_Programs-300x124.png 300w, https://blog.mozilla.org/security/files/2021/12/Task_List_for_Root_Programs-600x247.png 600w, https://blog.mozilla.org/security/files/2021/12/Task_List_for_Root_Programs-768x316.png 768w, https://blog.mozilla.org/security/files/2021/12/Task_List_for_Root_Programs-1000x412.png 1000w" sizes="(max-width: 1457px) 100vw, 1457px"/></a></p>
<p><b>Image 2: CCADB lists tasks for managers of Mozilla’s root store program<br/>
</b></p>
<h3><b>Conclusion</b></h3>
<p>Updating the Mozilla Root Store Policy and adding automation to the CCADB demonstrate Mozilla’s commitment to continue to advance the security and privacy of individuals on the internet. The recent and in-progress updates to the MRSP and the CCADB improve oversight of the issuance and management of intermediate certificates, which play a critical part in the web PKI by directly signing server certificates for TLS/SSL. These updates to policy and automation enable us to proactively identify and resolve problems with the approximately <a href="https://wiki.mozilla.org/CA/Intermediate_Certificates">3,000 intermediate certificates</a> that can issue certificates that are recognized as valid by NSS and Firefox.</p>
      </div></div>
  </body>
</html>
