<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://www.ruby-lang.org/en/news/2022/12/25/ruby-3-2-0-released/">Original</a>
    <h1>Ruby 3.2.0</h1>
    
    <div id="readability-page-1" class="page"><div id="content">
    <p>Posted by naruse on 25 Dec 2022</p>

    
<p>We are pleased to announce the release of Ruby 3.2.0. Ruby 3.2 adds many features and performance improvements.</p>

<h2>WASI based WebAssembly support</h2>

<p>This is an initial port of WASI based WebAssembly support. This enables a CRuby binary to be available on a Web browser, a Serverless Edge environment, or other kinds of WebAssembly/WASI embedders. Currently this port passes basic and bootstrap test suites not using the Thread API.</p>

<p><img src="https://i.imgur.com/opCgKy2.png" alt=""/></p>

<h3>Background</h3>

<p><a href="https://webassembly.org/">WebAssembly (Wasm)</a> was originally introduced to run programs safely and fast in web browsers. But its objective - running programs efficiently with security on various environment - is long wanted not only for web but also by general applications.</p>

<p><a href="https://wasi.dev/">WASI (The WebAssembly System Interface)</a> is designed for such use cases. Though such applications need to communicate with operating systems, WebAssembly runs on a virtual machine which didn’t have a system interface. WASI standardizes it.</p>

<p>WebAssembly/WASI support in Ruby intends to leverage those projects. It enables Ruby developers to write applications which run on such promised platforms.</p>

<h3>Use case</h3>

<p>This support encourages developers to utilize CRuby in a WebAssembly environment. An example use case is <a href="https://try.ruby-lang.org/playground/">TryRuby playground</a>’s CRuby support. Now you can try original CRuby in your web browser.</p>

<h3>Technical points</h3>

<p>Today’s WASI and WebAssembly itself is missing some features to implement Fiber, exception, and GC because it’s still evolving, and also for security reasons. So CRuby fills the gap by using Asyncify, which is a binary transformation technique to control execution in userland.</p>

<p>In addition, we built <a href="https://github.com/kateinoigakukun/wasi-vfs/wiki/Getting-Started-with-CRuby">a VFS on top of WASI</a> so that we can easily pack Ruby apps into a single .wasm file. This makes distribution of Ruby apps a bit easier.</p>

<h3>Related links</h3>

<ul>
  <li><a href="https://github.com/ruby/ruby/pull/5407">Add WASI based WebAssembly support #5407</a></li>
  <li><a href="https://itnext.io/final-report-webassembly-wasi-support-in-ruby-4aface7d90c9">An Update on WebAssembly/WASI Support in Ruby</a></li>
</ul>

<h2>Production-ready YJIT</h2>

<p><img src="https://i.imgur.com/X9ulfac.png" alt=""/></p>

<ul>
  <li>YJIT is no longer experimental
    <ul>
      <li>Has been tested on production workloads for over a year and proven to be quite stable.</li>
    </ul>
  </li>
  <li>YJIT now supports both x86-64 and arm64/aarch64 CPUs on Linux, MacOS, BSD and other UNIX platforms.
    <ul>
      <li>This release brings support for Apple M1/M2, AWS Graviton, Raspberry Pi 4 and more.</li>
    </ul>
  </li>
  <li>Building YJIT now requires Rust 1.58.0+. [<a href="https://bugs.ruby-lang.org/issues/18481">Feature #18481</a>]
    <ul>
      <li>In order to ensure that CRuby is built with YJIT, please install <code>rustc</code> &gt;= 1.58.0
before running the <code>./configure</code> script.</li>
      <li>Please reach out to the YJIT team should you run into any issues.</li>
    </ul>
  </li>
  <li>The YJIT 3.2 release is faster than 3.1, and has about 1/3 as much memory overhead.
    <ul>
      <li>Overall YJIT is 41% faster (geometric mean) than the Ruby interpreter on <a href="https://github.com/Shopify/yjit-bench">yjit-bench</a>.</li>
      <li>Physical memory for JIT code is lazily allocated. Unlike Ruby 3.1,
the RSS of a Ruby process is minimized because virtual memory pages
allocated by <code>--yjit-exec-mem-size</code> will not be mapped to physical
memory pages until actually utilized by JIT code.</li>
      <li>Introduce Code GC that frees all code pages when the memory consumption
by JIT code reaches <code>--yjit-exec-mem-size</code>.</li>
      <li><code>RubyVM::YJIT.runtime_stats</code> returns Code GC metrics in addition to
existing <code>inline_code_size</code> and <code>outlined_code_size</code> keys:
<code>code_gc_count</code>, <code>live_page_count</code>, <code>freed_page_count</code>, and <code>freed_code_size</code>.</li>
    </ul>
  </li>
  <li>Most of the statistics produced by <code>RubyVM::YJIT.runtime_stats</code> are now available in release builds.
    <ul>
      <li>Simply run ruby with <code>--yjit-stats</code> to compute and dump stats (incurs some run-time overhead).</li>
    </ul>
  </li>
  <li>YJIT is now optimized to take advantage of object shapes. [<a href="https://bugs.ruby-lang.org/issues/18776">Feature #18776</a>]</li>
  <li>Take advantage of finer-grained constant invalidation to invalidate less code when defining new constants. [<a href="https://bugs.ruby-lang.org/issues/18589">Feature #18589</a>]</li>
  <li>The default <code>--yjit-exec-mem-size</code> is changed to 64 (MiB).</li>
  <li>The default <code>--yjit-call-threshold</code> is changed to 30.</li>
</ul>

<h2>Regexp improvements against ReDoS</h2>

<p>It is known that Regexp matching may take unexpectedly long. If your code attempts to match a possibly inefficient Regexp against an untrusted input, an attacker may exploit it for efficient Denial of Service (so-called Regular expression DoS, or ReDoS).</p>

<p>We have introduced two improvements that significantly mitigate ReDoS.</p>

<h3>Improved Regexp matching algorithm</h3>

<p>Since Ruby 3.2, Regexp’s matching algorithm has been greatly improved by using a memoization technique.</p>

<div><div><pre><code># This match takes 10 sec. in Ruby 3.1, and 0.003 sec. in Ruby 3.2

/^a*b?a*$/ =~ &#34;a&#34; * 50000 + &#34;x&#34;
</code></pre></div></div>

<p><img src="https://cache.ruby-lang.org/pub/media/ruby320_regex_1.png" alt=""/>
<img src="https://cache.ruby-lang.org/pub/media/ruby320_regex_2.png" alt=""/></p>

<p>The improved matching algorithm allows most Regexp matching (about 90% in our experiments) to be completed in linear time.</p>

<p>(For preview users: this optimization may consume memory proportional to the input length for each match. We expect no practical problems to arise because this memory allocation is usually delayed, and a normal Regexp match should consume at most 10 times as much memory as the input length. If you run out of memory when matching Regexps in a real-world application, please report it.)</p>

<p>The original proposal is https://bugs.ruby-lang.org/issues/19104</p>

<h3>Regexp timeout</h3>

<p>The optimization above cannot be applied to some kind of regular expressions, such as those including advanced features (e.g., back-references or look-around), or with a huge fixed number of repetitions. As a fallback measure, a timeout feature for Regexp matches is also introduced.</p>

<div><div><pre><code><span>Regexp</span><span>.</span><span>timeout</span> <span>=</span> <span>1.0</span>

<span>/^a*b?a*()\1$/</span> <span>=~</span> <span>&#34;a&#34;</span> <span>*</span> <span>50000</span> <span>+</span> <span>&#34;x&#34;</span>
<span>#=&gt; Regexp::TimeoutError is raised in one second</span>
</code></pre></div></div>

<p>Note that <code>Regexp.timeout</code> is a global configuration. If you want to use different timeout settings for some special Regexps, you may want to use the <code>timeout</code> keyword for <code>Regexp.new</code>.</p>

<div><div><pre><code><span>Regexp</span><span>.</span><span>timeout</span> <span>=</span> <span>1.0</span>

<span># This regexp has no timeout</span>
<span>long_time_re</span> <span>=</span> <span>Regexp</span><span>.</span><span>new</span><span>(</span><span>&#39;^a*b?a*()\1$&#39;</span><span>,</span> <span>timeout: </span><span>Float</span><span>::</span><span>INFINITY</span><span>)</span>

<span>long_time_re</span> <span>=~</span> <span>&#34;a&#34;</span> <span>*</span> <span>50000</span> <span>+</span> <span>&#34;x&#34;</span> <span># never interrupted</span>
</code></pre></div></div>

<p>The original proposal is <a href="https://bugs.ruby-lang.org/issues/17837">https://bugs.ruby-lang.org/issues/17837</a>.</p>

<h2>Other Notable New Features</h2>

<h3>SyntaxSuggest</h3>

<ul>
  <li>
    <p>The feature of <code>syntax_suggest</code> (formerly <code>dead_end</code>) is integrated into Ruby. This helps you find the position of errors such as missing or superfluous <code>end</code>s, to get you back on your way faster, such as in the following example:</p>

    <div><div><pre><code>Unmatched `end&#39;, missing keyword (`do&#39;, `def`, `if`, etc.) ?

  1  class Dog
&gt; 2    defbark
&gt; 3    end
  4  end
</code></pre></div>    </div>

    <p>[<a href="https://bugs.ruby-lang.org/issues/18159">Feature #18159</a>]</p>
  </li>
</ul>

<h3>ErrorHighlight</h3>

<ul>
  <li>Now it points at the relevant argument(s) for TypeError and ArgumentError</li>
</ul>

<div><div><pre><code>test.rb:2:in `+&#39;: nil can&#39;t be coerced into Integer (TypeError)

sum = ary[0] + ary[1]
               ^^^^^^
</code></pre></div></div>

<h3>Language</h3>

<ul>
  <li>
    <p>Anonymous rest and keyword rest arguments can now be passed as
arguments, instead of just used in method parameters.
[<a href="https://bugs.ruby-lang.org/issues/18351">Feature #18351</a>]</p>

    <div><div><pre><code>  <span>def</span> <span>foo</span><span>(</span><span>*</span><span>)</span>
    <span>bar</span><span>(</span><span>*</span><span>)</span>
  <span>end</span>
  <span>def</span> <span>baz</span><span>(</span><span>**</span><span>)</span>
    <span>quux</span><span>(</span><span>**</span><span>)</span>
  <span>end</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>A proc that accepts a single positional argument and keywords will
no longer autosplat. [<a href="https://bugs.ruby-lang.org/issues/18633">Bug #18633</a>]</p>

    <div><div><pre><code><span>proc</span><span>{</span><span>|</span><span>a</span><span>,</span> <span>**</span><span>k</span><span>|</span> <span>a</span><span>}.</span><span>call</span><span>([</span><span>1</span><span>,</span> <span>2</span><span>])</span>
<span># Ruby 3.1 and before</span>
<span># =&gt; 1</span>
<span># Ruby 3.2 and after</span>
<span># =&gt; [1, 2]</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Constant assignment evaluation order for constants set on explicit
objects has been made consistent with single attribute assignment
evaluation order. With this code:</p>

    

    <p><code>foo</code> is now called before <code>baz</code>. Similarly, for multiple assignments
to constants, left-to-right evaluation order is used. With this
code:</p>

    <div><div><pre><code>    <span>foo1</span><span>::</span><span>BAR1</span><span>,</span> <span>foo2</span><span>::</span><span>BAR2</span> <span>=</span> <span>baz1</span><span>,</span> <span>baz2</span>
</code></pre></div>    </div>

    <p>The following evaluation order is now used:</p>

    <ol>
      <li><code>foo1</code></li>
      <li><code>foo2</code></li>
      <li><code>baz1</code></li>
      <li><code>baz2</code></li>
    </ol>

    <p>[<a href="https://bugs.ruby-lang.org/issues/15928">Bug #15928</a>]</p>
  </li>
  <li>
    <p>The find pattern is no longer experimental.
[<a href="https://bugs.ruby-lang.org/issues/18585">Feature #18585</a>]</p>
  </li>
  <li>
    <p>Methods taking a rest parameter (like <code>*args</code>) and wishing to delegate keyword
arguments through <code>foo(*args)</code> must now be marked with <code>ruby2_keywords</code>
(if not already the case). In other words, all methods wishing to delegate
keyword arguments through <code>*args</code> must now be marked with <code>ruby2_keywords</code>,
with no exception. This will make it easier to transition to other ways of
delegation once a library can require Ruby 3+. Previously, the <code>ruby2_keywords</code>
flag was kept if the receiving method took <code>*args</code>, but this was a bug and an
inconsistency. A good technique to find potentially missing <code>ruby2_keywords</code>
is to run the test suite, find the last method which must
receive keyword arguments for each place where the test suite fails, and use <code>puts nil, caller, nil</code> there. Then check that each
method/block on the call chain which must delegate keywords is correctly marked
with <code>ruby2_keywords</code>. [<a href="https://bugs.ruby-lang.org/issues/18625">Bug #18625</a>] [<a href="https://bugs.ruby-lang.org/issues/16466">Bug #16466</a>]</p>

    <div><div><pre><code>  <span>def</span> <span>target</span><span>(</span><span>**</span><span>kw</span><span>)</span>
  <span>end</span>

  <span># Accidentally worked without ruby2_keywords in Ruby 2.7-3.1, ruby2_keywords</span>
  <span># needed in 3.2+. Just like (*args, **kwargs) or (...) would be needed on</span>
  <span># both #foo and #bar when migrating away from ruby2_keywords.</span>
  <span>ruby2_keywords</span> <span>def</span> <span>bar</span><span>(</span><span>*</span><span>args</span><span>)</span>
    <span>target</span><span>(</span><span>*</span><span>args</span><span>)</span>
  <span>end</span>

  <span>ruby2_keywords</span> <span>def</span> <span>foo</span><span>(</span><span>*</span><span>args</span><span>)</span>
    <span>bar</span><span>(</span><span>*</span><span>args</span><span>)</span>
  <span>end</span>

  <span>foo</span><span>(</span><span>k: </span><span>1</span><span>)</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2>Performance improvements</h2>

<h3>MJIT</h3>

<ul>
  <li>The MJIT compiler is re-implemented in Ruby as <code>ruby_vm/mjit/compiler</code>.</li>
  <li>MJIT compiler is executed under a forked Ruby process instead of
doing it in a native thread called MJIT worker. [<a href="https://bugs.ruby-lang.org/issues/18968">Feature #18968</a>]
    <ul>
      <li>As a result, Microsoft Visual Studio (MSWIN) is no longer supported.</li>
    </ul>
  </li>
  <li>MinGW is no longer supported. [<a href="https://bugs.ruby-lang.org/issues/18824">Feature #18824</a>]</li>
  <li>Rename <code>--mjit-min-calls</code> to <code>--mjit-call-threshold</code>.</li>
  <li>Change default <code>--mjit-max-cache</code> back from 10000 to 100.</li>
</ul>

<h3>PubGrub</h3>

<ul>
  <li>
    <p>Bundler 2.4 now uses <a href="https://github.com/jhawthorn/pub_grub">PubGrub</a> resolver instead of <a href="https://github.com/CocoaPods/Molinillo">Molinillo</a>.</p>

    <ul>
      <li>PubGrub is the next generation solving algorithm used by <code>pub</code> package manager for the Dart programming language.</li>
      <li>You may get different resolution result after this change. Please report such cases to <a href="https://github.com/rubygems/rubygems/issues">RubyGems/Bundler issues</a></li>
    </ul>
  </li>
  <li>
    <p>RubyGems still uses Molinillo resolver in Ruby 3.2. We plan to replace it with PubGrub in the future.</p>
  </li>
</ul>

<h2>Other notable changes since 3.1</h2>

<ul>
  <li>Data
    <ul>
      <li>
        <p>New core class to represent simple immutable value object. The class is
similar to Struct and partially shares an implementation, but has more
lean and strict API. [<a href="https://bugs.ruby-lang.org/issues/16122">Feature #16122</a>]</p>

        <div><div><pre><code>  <span>Measure</span> <span>=</span> <span>Data</span><span>.</span><span>define</span><span>(</span><span>:amount</span><span>,</span> <span>:unit</span><span>)</span>
  <span>distance</span> <span>=</span> <span>Measure</span><span>.</span><span>new</span><span>(</span><span>100</span><span>,</span> <span>&#39;km&#39;</span><span>)</span>            <span>#=&gt; #&lt;data Measure amount=100, unit=&#34;km&#34;&gt;</span>
  <span>weight</span> <span>=</span> <span>Measure</span><span>.</span><span>new</span><span>(</span><span>amount: </span><span>50</span><span>,</span> <span>unit: </span><span>&#39;kg&#39;</span><span>)</span> <span>#=&gt; #&lt;data Measure amount=50, unit=&#34;kg&#34;&gt;</span>
  <span>weight</span><span>.</span><span>with</span><span>(</span><span>amount: </span><span>40</span><span>)</span>                      <span>#=&gt; #&lt;data Measure amount=40, unit=&#34;kg&#34;&gt;</span>
  <span>weight</span><span>.</span><span>amount</span>                                <span>#=&gt; 50</span>
  <span>weight</span><span>.</span><span>amount</span> <span>=</span> <span>40</span>                           <span>#=&gt; NoMethodError: undefined method `amount=&#39;</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Hash
    <ul>
      <li><code>Hash#shift</code> now always returns nil if the hash is
empty, instead of returning the default value or
calling the default proc. [<a href="https://bugs.ruby-lang.org/issues/16908">Bug #16908</a>]</li>
    </ul>
  </li>
  <li>MatchData
    <ul>
      <li><code>MatchData#byteoffset</code> has been added. [<a href="https://bugs.ruby-lang.org/issues/13110">Feature #13110</a>]</li>
    </ul>
  </li>
  <li>Module
    <ul>
      <li><code>Module.used_refinements</code> has been added. [<a href="https://bugs.ruby-lang.org/issues/14332">Feature #14332</a>]</li>
      <li><code>Module#refinements</code> has been added. [<a href="https://bugs.ruby-lang.org/issues/12737">Feature #12737</a>]</li>
      <li><code>Module#const_added</code> has been added. [<a href="https://bugs.ruby-lang.org/issues/17881">Feature #17881</a>]</li>
    </ul>
  </li>
  <li>Proc
    <ul>
      <li><code>Proc#dup</code> returns an instance of subclass. [<a href="https://bugs.ruby-lang.org/issues/17545">Bug #17545</a>]</li>
      <li><code>Proc#parameters</code> now accepts lambda keyword. [<a href="https://bugs.ruby-lang.org/issues/15357">Feature #15357</a>]</li>
    </ul>
  </li>
  <li>Refinement
    <ul>
      <li><code>Refinement#refined_class</code> has been added. [<a href="https://bugs.ruby-lang.org/issues/12737">Feature #12737</a>]</li>
    </ul>
  </li>
  <li>RubyVM::AbstractSyntaxTree
    <ul>
      <li>Add <code>error_tolerant</code> option for <code>parse</code>, <code>parse_file</code> and <code>of</code>. [<a href="https://bugs.ruby-lang.org/issues/19013">Feature #19013</a>]
With this option
        <ol>
          <li>SyntaxError is suppressed</li>
          <li>AST is returned for invalid input</li>
          <li><code>end</code> is complemented when a parser reaches to the end of input but <code>end</code> is insufficient</li>
          <li><code>end</code> is treated as keyword based on indent</li>
        </ol>

        <div><div><pre><code>  <span># Without error_tolerant option</span>
  <span>root</span> <span>=</span> <span>RubyVM</span><span>::</span><span>AbstractSyntaxTree</span><span>.</span><span>parse</span><span>(</span><span>&lt;&lt;~</span><span>RUBY</span><span>)</span><span>
  def m
    a = 10
    if
  end
</span><span>  RUBY</span>
  <span># =&gt; &lt;internal:ast&gt;:33:in `parse&#39;: syntax error, unexpected `end&#39; (SyntaxError)</span>

  <span># With error_tolerant option</span>
  <span>root</span> <span>=</span> <span>RubyVM</span><span>::</span><span>AbstractSyntaxTree</span><span>.</span><span>parse</span><span>(</span><span>&lt;&lt;~</span><span>RUBY</span><span>,</span> <span>error_tolerant: </span><span>true</span><span>)</span><span>
  def m
    a = 10
    if
  end
</span><span>  RUBY</span>
  <span>p</span> <span>root</span> <span># =&gt; #&lt;RubyVM::AbstractSyntaxTree::Node:SCOPE@1:0-4:3&gt;</span>

  <span># `end` is treated as keyword based on indent</span>
  <span>root</span> <span>=</span> <span>RubyVM</span><span>::</span><span>AbstractSyntaxTree</span><span>.</span><span>parse</span><span>(</span><span>&lt;&lt;~</span><span>RUBY</span><span>,</span> <span>error_tolerant: </span><span>true</span><span>)</span><span>
  module Z
    class Foo
      foo.
    end

    def bar
    end
  end
</span><span>  RUBY</span>
  <span>p</span> <span>root</span><span>.</span><span>children</span><span>[</span><span>-</span><span>1</span><span>].</span><span>children</span><span>[</span><span>-</span><span>1</span><span>].</span><span>children</span><span>[</span><span>-</span><span>1</span><span>].</span><span>children</span><span>[</span><span>-</span><span>2</span><span>..-</span><span>1</span><span>]</span>
  <span># =&gt; [#&lt;RubyVM::AbstractSyntaxTree::Node:CLASS@2:2-4:5&gt;, #&lt;RubyVM::AbstractSyntaxTree::Node:DEFN@6:2-7:5&gt;]</span>
</code></pre></div>        </div>
      </li>
      <li>
        <p>Add <code>keep_tokens</code> option for <code>parse</code>, <code>parse_file</code> and <code>of</code>. [<a href="https://bugs.ruby-lang.org/issues/19070">Feature #19070</a>]</p>

        <div><div><pre><code>  <span>root</span> <span>=</span> <span>RubyVM</span><span>::</span><span>AbstractSyntaxTree</span><span>.</span><span>parse</span><span>(</span><span>&#34;x = 1 + 2&#34;</span><span>,</span> <span>keep_tokens: </span><span>true</span><span>)</span>
  <span>root</span><span>.</span><span>tokens</span> <span># =&gt; [[0, :tIDENTIFIER, &#34;x&#34;, [1, 0, 1, 1]], [1, :tSP, &#34; &#34;, [1, 1, 1, 2]], ...]</span>
  <span>root</span><span>.</span><span>tokens</span><span>.</span><span>map</span><span>{</span><span>_1</span><span>[</span><span>2</span><span>]}.</span><span>join</span> <span># =&gt; &#34;x = 1 + 2&#34;</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>Set
    <ul>
      <li>Set is now available as a builtin class without the need for <code>require &#34;set&#34;</code>. [<a href="https://bugs.ruby-lang.org/issues/16989">Feature #16989</a>]
It is currently autoloaded via the <code>Set</code> constant or a call to <code>Enumerable#to_set</code>.</li>
    </ul>
  </li>
  <li>String
    <ul>
      <li><code>String#byteindex</code> and <code>String#byterindex</code> have been added. [<a href="https://bugs.ruby-lang.org/issues/13110">Feature #13110</a>]</li>
      <li>Update Unicode to Version 15.0.0 and Emoji Version 15.0. [<a href="https://bugs.ruby-lang.org/issues/18639">Feature #18639</a>]
(also applies to Regexp)</li>
      <li><code>String#bytesplice</code> has been added.  [<a href="https://bugs.ruby-lang.org/issues/18598">Feature #18598</a>]</li>
    </ul>
  </li>
  <li>Struct
    <ul>
      <li>
        <p>A Struct class can also be initialized with keyword arguments
without <code>keyword_init: true</code> on <code>Struct.new</code> [<a href="https://bugs.ruby-lang.org/issues/16806">Feature #16806</a>]</p>

        <div><div><pre><code>  <span>Post</span> <span>=</span> <span>Struct</span><span>.</span><span>new</span><span>(</span><span>:id</span><span>,</span> <span>:name</span><span>)</span>
  <span>Post</span><span>.</span><span>new</span><span>(</span><span>1</span><span>,</span> <span>&#34;hello&#34;</span><span>)</span> <span>#=&gt; #&lt;struct Post id=1, name=&#34;hello&#34;&gt;</span>
  <span># From Ruby 3.2, the following code also works without keyword_init: true.</span>
  <span>Post</span><span>.</span><span>new</span><span>(</span><span>id: </span><span>1</span><span>,</span> <span>name: </span><span>&#34;hello&#34;</span><span>)</span> <span>#=&gt; #&lt;struct Post id=1, name=&#34;hello&#34;&gt;</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h2>Compatibility issues</h2>

<p>Note: Excluding feature bug fixes.</p>

<h3>Removed constants</h3>

<p>The following deprecated constants are removed.</p>

<ul>
  <li><code>Fixnum</code> and <code>Bignum</code> [<a href="https://bugs.ruby-lang.org/issues/12005">Feature #12005</a>]</li>
  <li><code>Random::DEFAULT</code> [<a href="https://bugs.ruby-lang.org/issues/17351">Feature #17351</a>]</li>
  <li><code>Struct::Group</code></li>
  <li><code>Struct::Passwd</code></li>
</ul>

<h3>Removed methods</h3>

<p>The following deprecated methods are removed.</p>

<ul>
  <li><code>Dir.exists?</code> [<a href="https://bugs.ruby-lang.org/issues/17391">Feature #17391</a>]</li>
  <li><code>File.exists?</code> [<a href="https://bugs.ruby-lang.org/issues/17391">Feature #17391</a>]</li>
  <li><code>Kernel#=~</code> [<a href="https://bugs.ruby-lang.org/issues/15231">Feature #15231</a>]</li>
  <li><code>Kernel#taint</code>, <code>Kernel#untaint</code>, <code>Kernel#tainted?</code>
[<a href="https://bugs.ruby-lang.org/issues/16131">Feature #16131</a>]</li>
  <li><code>Kernel#trust</code>, <code>Kernel#untrust</code>, <code>Kernel#untrusted?</code>
[<a href="https://bugs.ruby-lang.org/issues/16131">Feature #16131</a>]</li>
</ul>

<h2>Stdlib compatibility issues</h2>

<h3>No longer bundle 3rd party sources</h3>

<ul>
  <li>
    <p>We no longer bundle 3rd party sources like <code>libyaml</code>, <code>libffi</code>.</p>

    <ul>
      <li>
        <p>libyaml source has been removed from psych. You may need to install <code>libyaml-dev</code> with Ubuntu/Debian platform. The package name is different for each platform.</p>
      </li>
      <li>
        <p>Bundled libffi source is also removed from <code>fiddle</code></p>
      </li>
    </ul>
  </li>
  <li>
    <p>Psych and fiddle supported static builds with specific versions of libyaml and libffi sources. You can build psych with libyaml-0.2.5 like this:</p>

    <div><div><pre><code>  <span>$ </span>./configure <span>--with-libyaml-source-dir</span><span>=</span>/path/to/libyaml-0.2.5
</code></pre></div>    </div>

    <p>And you can build fiddle with libffi-3.4.4 like this:</p>

    <div><div><pre><code>  <span>$ </span>./configure <span>--with-libffi-source-dir</span><span>=</span>/path/to/libffi-3.4.4
</code></pre></div>    </div>

    <p>[<a href="https://bugs.ruby-lang.org/issues/18571">Feature #18571</a>]</p>
  </li>
</ul>

<h2>C API updates</h2>

<h3>Updated C APIs</h3>

<p>The following APIs are updated.</p>

<ul>
  <li>PRNG update
    <ul>
      <li><code>rb_random_interface_t</code> updated and versioned.
Extension libraries which use this interface and built for older versions.
Also <code>init_int32</code> function needs to be defined.</li>
    </ul>
  </li>
</ul>

<h3>Removed C APIs</h3>

<p>The following deprecated APIs are removed.</p>

<ul>
  <li><code>rb_cData</code> variable.</li>
  <li>“taintedness” and “trustedness” functions. [<a href="https://bugs.ruby-lang.org/issues/16131">Feature #16131</a>]</li>
</ul>

<h2>Standard library updates</h2>

<ul>
  <li>
    <p>Bundler</p>

    <ul>
      <li>Add –ext=rust support to bundle gem for creating simple gems with Rust extensions.
[<a href="https://github.com/rubygems/rubygems/pull/6149">GH-rubygems-6149</a>]</li>
      <li>Make cloning git repos faster [<a href="https://github.com/rubygems/rubygems/pull/4475">GH-rubygems-4475</a>]</li>
    </ul>
  </li>
  <li>
    <p>RubyGems</p>

    <ul>
      <li>Add mswin support for cargo builder. [<a href="https://github.com/rubygems/rubygems/pull/6167">GH-rubygems-6167</a>]</li>
    </ul>
  </li>
  <li>
    <p>ERB</p>

    <ul>
      <li><code>ERB::Util.html_escape</code> is made faster than <code>CGI.escapeHTML</code>.
        <ul>
          <li>It no longer allocates a String object when no character needs to be escaped.</li>
          <li>It skips calling <code>#to_s</code> method when an argument is already a String.</li>
          <li><code>ERB::Escape.html_escape</code> is added as an alias to <code>ERB::Util.html_escape</code>,
which has not been monkey-patched by Rails.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>IRB</p>

    <ul>
      <li>debug.gem integration commands have been added: <code>debug</code>, <code>break</code>, <code>catch</code>,
<code>next</code>, <code>delete</code>, <code>step</code>, <code>continue</code>, <code>finish</code>, <code>backtrace</code>, <code>info</code>
        <ul>
          <li>They work even if you don’t have <code>gem &#34;debug&#34;</code> in your Gemfile.</li>
          <li>See also: <a href="https://st0012.dev/whats-new-in-ruby-3-2-irb">What’s new in Ruby 3.2’s IRB?</a></li>
        </ul>
      </li>
      <li>More Pry-like commands and features have been added.
        <ul>
          <li><code>edit</code> and <code>show_cmds</code> (like Pry’s <code>help</code>) are added.</li>
          <li><code>ls</code> takes <code>-g</code> or <code>-G</code> option to filter out outputs.</li>
          <li><code>show_source</code> is aliased from <code>$</code> and accepts unquoted inputs.</li>
          <li><code>whereami</code> is aliased from <code>@</code>.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>The following default gems are updated.</p>

    <ul>
      <li>RubyGems 3.4.1</li>
      <li>abbrev 0.1.1</li>
      <li>benchmark 0.2.1</li>
      <li>bigdecimal 3.1.3</li>
      <li>bundler 2.4.1</li>
      <li>cgi 0.3.6</li>
      <li>csv 3.2.6</li>
      <li>date 3.3.3</li>
      <li>delegate 0.3.0</li>
      <li>did_you_mean 1.6.3</li>
      <li>digest 3.1.1</li>
      <li>drb 2.1.1</li>
      <li>english 0.7.2</li>
      <li>erb 4.0.2</li>
      <li>error_highlight 0.5.1</li>
      <li>etc 1.4.2</li>
      <li>fcntl 1.0.2</li>
      <li>fiddle 1.1.1</li>
      <li>fileutils 1.7.0</li>
      <li>forwardable 1.3.3</li>
      <li>getoptlong 0.2.0</li>
      <li>io-console 0.6.0</li>
      <li>io-nonblock 0.2.0</li>
      <li>io-wait 0.3.0</li>
      <li>ipaddr 1.2.5</li>
      <li>irb 1.6.2</li>
      <li>json 2.6.3</li>
      <li>logger 1.5.3</li>
      <li>mutex_m 0.1.2</li>
      <li>net-http 0.3.2</li>
      <li>net-protocol 0.2.1</li>
      <li>nkf 0.1.2</li>
      <li>open-uri 0.3.0</li>
      <li>open3 0.1.2</li>
      <li>openssl 3.1.0</li>
      <li>optparse 0.3.1</li>
      <li>ostruct 0.5.5</li>
      <li>pathname 0.2.1</li>
      <li>pp 0.4.0</li>
      <li>pstore 0.1.2</li>
      <li>psych 5.0.1</li>
      <li>racc 1.6.2</li>
      <li>rdoc 6.5.0</li>
      <li>readline-ext 0.1.5</li>
      <li>reline 0.3.2</li>
      <li>resolv 0.2.2</li>
      <li>resolv-replace 0.1.1</li>
      <li>securerandom 0.2.2</li>
      <li>set 1.0.3</li>
      <li>stringio 3.0.4</li>
      <li>strscan 3.0.5</li>
      <li>syntax_suggest 1.0.2</li>
      <li>syslog 0.1.1</li>
      <li>tempfile 0.1.3</li>
      <li>time 0.2.1</li>
      <li>timeout 0.3.1</li>
      <li>tmpdir 0.1.3</li>
      <li>tsort 0.1.1</li>
      <li>un 0.2.1</li>
      <li>uri 0.12.0</li>
      <li>weakref 0.1.2</li>
      <li>win32ole 1.8.9</li>
      <li>yaml 0.2.1</li>
      <li>zlib 3.0.0</li>
    </ul>
  </li>
  <li>
    <p>The following bundled gems are updated.</p>

    <ul>
      <li>minitest 5.16.3</li>
      <li>power_assert 2.0.3</li>
      <li>test-unit 3.5.7</li>
      <li>net-ftp 0.2.0</li>
      <li>net-imap 0.3.3</li>
      <li>net-pop 0.1.2</li>
      <li>net-smtp 0.3.3</li>
      <li>rbs 2.8.2</li>
      <li>typeprof 0.21.3</li>
      <li>debug 1.7.1</li>
    </ul>
  </li>
</ul>

<p>See GitHub releases like <a href="https://github.com/ruby/logger/releases">GitHub Releases of logger</a> or changelog for details of the default gems or bundled gems.</p>

<p>See <a href="https://github.com/ruby/ruby/blob/v3_2_0/NEWS.md">NEWS</a>
or <a href="https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0">commit logs</a>
for more details.</p>

<p>With those changes, <a href="https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0#file_bucket">3048 files changed, 218253 insertions(+), 131067 deletions(-)</a>
since Ruby 3.1.0!</p>

<p>Merry Christmas, Happy Holidays, and enjoy programming with Ruby 3.2!</p>

<h2>Download</h2>

<ul>
  <li>
    <p><a href="https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.gz">https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.gz</a></p>

    <div><div><pre><code>SIZE: 20440715
SHA1: fb4ab2ceba8bf6a5b9bc7bf7cac945cc94f94c2b
SHA256: daaa78e1360b2783f98deeceb677ad900f3a36c0ffa6e2b6b19090be77abc272
SHA512: 94203051d20475b95a66660016721a0457d7ea57656a9f16cdd4264d8aa6c4cd8ea2fab659082611bfbd7b00ebbcf0391e883e2ebf384e4fab91869e0a877d35
</code></pre></div>    </div>
  </li>
  <li>
    <p><a href="https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.xz">https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.xz</a></p>

    <div><div><pre><code>SIZE: 15058364
SHA1: bcdae07183d66fd902cb7bf995545a472d2fefea
SHA256: d2f4577306e6dd932259693233141e5c3ec13622c95b75996541b8d5b68b28b4
SHA512: 733ecc6709470ee16916deeece9af1c76220ae95d17b2681116aff7f381d99bc3124b1b11b1c2336b2b29e468e91b90f158d5ae5fca810c6cf32a0b6234ae08e
</code></pre></div>    </div>
  </li>
  <li>
    <p><a href="https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.zip">https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.zip</a></p>

    <div><div><pre><code>SIZE: 24583271
SHA1: 581ec7b9289c2a85abf4f41c93993ecaa5cf43a5
SHA256: cca9ddbc958431ff77f61948cb67afa569f01f99c9389d2bbedfa92986c9ef09
SHA512: b7d2753825cc0667e8bb391fc7ec59a53c3db5fa314e38eee74b6511890b585ac7515baa2ddac09e2c6b6c42b9221c82e040af5b39c73e980fbd3b1bc622c99d
</code></pre></div>    </div>
  </li>
</ul>

<h2>What is Ruby</h2>

<p>Ruby was first developed by Matz (Yukihiro Matsumoto) in 1993,
and is now developed as Open Source. It runs on multiple platforms
and is used all over the world especially for web development.</p>


  </div></div>
  </body>
</html>
