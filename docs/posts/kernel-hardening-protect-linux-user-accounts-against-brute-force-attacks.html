<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Kicksecure/security-misc">Original</a>
    <h1>Kernel Hardening: Protect Linux user accounts against brute force attacks</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><div dir="auto"><a id="user-content-enhances-miscellaneous-security-settings" aria-label="Permalink: Enhances miscellaneous security settings" href="#enhances-miscellaneous-security-settings"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h2 tabindex="-1" dir="auto">Kernel hardening</h2><a id="user-content-kernel-hardening" aria-label="Permalink: Kernel hardening" href="#kernel-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This section is inspired by the Kernel Self Protection Project (KSPP). It
implements all recommended Linux kernel settings by the KSPP and many more.</p>
<ul dir="auto">
<li><a href="https://kernsec.org/wiki/index.php/Kernel_Self_Protection_Project" rel="nofollow">https://kernsec.org/wiki/index.php/Kernel_Self_Protection_Project</a></li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">sysctl</h3><a id="user-content-sysctl" aria-label="Permalink: sysctl" href="#sysctl"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">sysctl settings are configured via the <code>/etc/sysctl.d/30_security-misc.conf</code>
configuration file.</p>
<ul dir="auto">
<li>
<p dir="auto">A kernel pointer points to a specific location in kernel memory. These can
be very useful in exploiting the kernel so they are restricted to
<code>CAP_SYSLOG</code>.</p>
</li>
<li>
<p dir="auto">The kernel logs are restricted to <code>CAP_SYSLOG</code> as they can often leak
sensitive information such as kernel pointers.</p>
</li>
<li>
<p dir="auto">The <code>ptrace()</code> system call is restricted to <code>CAP_SYS_PTRACE</code>.</p>
</li>
<li>
<p dir="auto">eBPF is restricted to <code>CAP_BPF</code> (<code>CAP_SYS_ADMIN</code> on kernel versions prior to
5.8) and JIT hardening techniques such as constant blinding are enabled.</p>
</li>
<li>
<p dir="auto">Restricts performance events to <code>CAP_PERFMON</code> (<code>CAP_SYS_ADMIN</code> on kernel
versions prior to 5.8).</p>
</li>
<li>
<p dir="auto">Restricts loading line disciplines to <code>CAP_SYS_MODULE</code> to prevent
unprivileged attackers from loading vulnerable line disciplines with the
<code>TIOCSETD</code> ioctl which has been abused in a number of exploits before.</p>
</li>
<li>
<p dir="auto">Restricts the <code>userfaultfd()</code> syscall to <code>CAP_SYS_PTRACE</code> as <code>userfaultfd()</code>
is often abused to exploit use-after-free flaws.</p>
</li>
<li>
<p dir="auto">Kexec is disabled as it can be used to load a malicious kernel and gain
arbitrary code execution in kernel mode.</p>
</li>
<li>
<p dir="auto">Randomises the addresses for mmap base, heap, stack, and VDSO pages.</p>
</li>
<li>
<p dir="auto">Prevents unintentional writes to attacker-controlled files.</p>
</li>
<li>
<p dir="auto">Prevents common symlink and hardlink TOCTOU races.</p>
</li>
<li>
<p dir="auto">Disables SysRq key completely.</p>
<ul dir="auto">
<li>Therefore Secure Attention Key (SAK) cannot be used.</li>
<li><a href="https://www.kicksecure.com/wiki/SysRq" rel="nofollow">https://www.kicksecure.com/wiki/SysRq</a></li>
</ul>
</li>
<li>
<p dir="auto">The kernel is only allowed to swap if it is absolutely necessary. This
prevents writing potentially sensitive contents of memory to disk.</p>
</li>
<li>
<p dir="auto">TCP timestamps are disabled as it can allow detecting the system time.</p>
</li>
<li>
<p dir="auto">Enforces the logging of martian packets, those with a source address which
is blatantly wrong.</p>
</li>
<li>
<p dir="auto">Set coredump file name based on core_pattern value instead of the default of
naming it &#39;core&#39;.</p>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">mmap ASLR</h3><a id="user-content-mmap-aslr" aria-label="Permalink: mmap ASLR" href="#mmap-aslr"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>The bits of entropy used for mmap ASLR are maxed out via
<code>/usr/libexec/security-misc/mmap-rnd-bits</code> (set to the values of
<code>CONFIG_ARCH_MMAP_RND_BITS_MAX</code> and <code>CONFIG_ARCH_MMAP_RND_COMPAT_BITS_MAX</code>
that the kernel was built with), therefore improving its effectiveness.</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Boot parameters</h3><a id="user-content-boot-parameters" aria-label="Permalink: Boot parameters" href="#boot-parameters"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Boot parameters are outlined in configuration files located in the
<code>etc/default/grub.d/</code> directory.</p>
<ul dir="auto">
<li>
<p dir="auto">Slab merging is disabled which significantly increases the difficulty of
heap exploitation by preventing overwriting objects from merged caches and
by making it harder to influence slab cache layout.</p>
</li>
<li>
<p dir="auto">Memory zeroing at allocation and free time is enabled to mitigate some
use-after-free vulnerabilities and erase sensitive information in memory.</p>
</li>
<li>
<p dir="auto">Page allocator freelist randomization is enabled.</p>
</li>
<li>
<p dir="auto">Kernel Page Table Isolation is enabled to mitigate Meltdown and increase
KASLR effectiveness.</p>
</li>
<li>
<p dir="auto">vsyscalls are disabled as they are obsolete, are at fixed addresses and
thus, are a potential target for ROP.</p>
</li>
<li>
<p dir="auto">The kernel panics on oopses to thwart certain kernel exploits.</p>
</li>
<li>
<p dir="auto">Enables randomisation of the kernel stack offset on syscall entries.</p>
</li>
<li>
<p dir="auto">All mitigations for known CPU vulnerabilities are enabled and SMT is
disabled.</p>
</li>
<li>
<p dir="auto">IOMMU is enabled to prevent DMA attacks along with strict enforcement of
IOMMU TLB invalidation so devices will never be able to access stale data
contents.</p>
</li>
<li>
<p dir="auto">Distrust the &#39;randomly&#39; generated CPU and bootloader seeds.</p>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Kernel Modules</h3><a id="user-content-kernel-modules" aria-label="Permalink: Kernel Modules" href="#kernel-modules"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Kernel Module Signature Verification</h4><a id="user-content-kernel-module-signature-verification" aria-label="Permalink: Kernel Module Signature Verification" href="#kernel-module-signature-verification"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Not yet due to issues:</p>
<ul dir="auto">
<li><a href="https://forums.whonix.org/t/enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880/64" rel="nofollow">https://forums.whonix.org/t/enforce-kernel-module-software-signature-verification-module-signing-disallow-kernel-module-loading-by-default/7880/64</a></li>
<li><a data-error-text="Failed to load title" data-id="1976818419" data-permission-text="Title is private" data-url="https://github.com/dell/dkms/issues/359" data-hovercard-type="issue" data-hovercard-url="/dell/dkms/issues/359/hovercard" href="https://github.com/dell/dkms/issues/359">dell/dkms#359</a></li>
</ul>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/etc/default/grub.d/40_only_allow_signed_modules.cfg</code></li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">Disables the loading of new modules to the kernel after the fact</h4><a id="user-content-disables-the-loading-of-new-modules-to-the-kernel-after-the-fact" aria-label="Permalink: Disables the loading of new modules to the kernel after the fact" href="#disables-the-loading-of-new-modules-to-the-kernel-after-the-fact"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Not yet due to issues:</p>
<ul dir="auto">
<li><a data-error-text="Failed to load title" data-id="1977341745" data-permission-text="Title is private" data-url="https://github.com/Kicksecure/security-misc/issues/152" data-hovercard-type="pull_request" data-hovercard-url="/Kicksecure/security-misc/pull/152/hovercard" href="https://github.com/Kicksecure/security-misc/pull/152">#152</a></li>
</ul>
<p dir="auto">A systemd service dynamically sets the kernel parameter <code>modules_disabled</code> to 1,
preventing new modules from being loaded. Since this isn&#39;t configured directly
within systemctl, it does not break the loading of legitimate and necessary
modules for the user, like drivers etc., given they are plugged in on startup.</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">Disables and blacklists kernel modules</h4><a id="user-content-disables-and-blacklists-kernel-modules" aria-label="Permalink: Disables and blacklists kernel modules" href="#disables-and-blacklists-kernel-modules"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Certain kernel modules are disabled and blacklisted by default to reduce attack
surface via the <code>/etc/modprobe.d/30_security-misc.conf</code> configuration file.</p>
<ul dir="auto">
<li>
<p dir="auto">Deactivates Netfilter&#39;s connection tracking helper - this module increases
kernel attack surface by enabling superfluous functionality such as IRC
parsing in the kernel. Hence, this feature is disabled.</p>
</li>
<li>
<p dir="auto">Thunderbolt and numerous FireWire kernel modules are also disabled as they
are often vulnerable to DMA attacks.</p>
</li>
<li>
<p dir="auto">The MSR kernel module is disabled to prevent CPU MSRs from being abused to
write to arbitrary memory.</p>
</li>
<li>
<p dir="auto">Uncommon network protocols are blacklisted. This includes:</p>
<ul dir="auto">
<li>DCCP - Datagram Congestion Control Protocol</li>
<li>SCTP - Stream Control Transmission Protocol</li>
<li>RDS - Reliable Datagram Sockets</li>
<li>TIPC - Transparent Inter-process Communication</li>
<li>HDLC - High-Level Data Link Control</li>
<li>AX25 - Amateur X.25</li>
<li>NetRom</li>
<li>X25</li>
<li>ROSE</li>
<li>DECnet</li>
<li>Econet</li>
<li>af_802154 - IEEE 802.15.4</li>
<li>IPX - Internetwork Packet Exchange</li>
<li>AppleTalk</li>
<li>PSNAP - Subnetwork Access Protocol</li>
<li>p8023 - Novell raw IEEE 802.3</li>
<li>p8022 - IEEE 802.2</li>
<li>CAN - Controller Area Network</li>
<li>ATM</li>
</ul>
</li>
<li>
<p dir="auto">Disables a large array of uncommon file systems and network file systems
that reduces the attack surface especially against legacy approaches.</p>
</li>
<li>
<p dir="auto">The vivid kernel module is only required for testing and has been the cause
of multiple vulnerabilities so it is disabled.</p>
</li>
<li>
<p dir="auto">Provides some disabling of the interface between the <a href="https://www.kernel.org/doc/html/latest/driver-api/mei/mei.html" rel="nofollow">Intel Management
Engine (ME)</a>
and the OS.</p>
</li>
<li>
<p dir="auto">Incorporates much of
<a href="https://git.launchpad.net/ubuntu/+source/kmod/tree/debian/modprobe.d?h=ubuntu/disco" rel="nofollow">Ubuntu&#39;s</a>
default blacklist of modules to be blocked from automatically loading.
However, they are still permitted to load.</p>
</li>
<li>
<p dir="auto">Blocks automatic loading of the modules needed to use of CD-ROM devices by
default. Not completely disabled yet.</p>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Other</h3><a id="user-content-other" aria-label="Permalink: Other" href="#other"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>A systemd service clears the System.map file on boot as these contain kernel
pointers. The file is completely overwritten with zeroes to ensure it cannot
be recovered. See:</li>
</ul>
<p dir="auto"><code>/etc/kernel/postinst.d/30_remove-system-map</code></p>
<p dir="auto"><code>/lib/systemd/system/remove-system-map.service</code></p>
<p dir="auto"><code>/usr/libexec/security-misc/remove-system.map</code></p>
<ul dir="auto">
<li>Coredumps are disabled as they may contain important information such as
encryption keys or passwords. See:</li>
</ul>
<p dir="auto"><code>/etc/security/limits.d/30_security-misc.conf</code></p>
<p dir="auto"><code>/etc/sysctl.d/30_security-misc.conf</code></p>
<p dir="auto"><code>/lib/systemd/coredump.conf.d/30_security-misc.conf</code></p>
<ul dir="auto">
<li>An initramfs hook sets the sysctl values in <code>/etc/sysctl.conf</code> and
<code>/etc/sysctl.d</code> before init is executed so sysctl hardening is enabled as
early as possible. This is implemented for <code>initramfs-tools</code> only because
this is not needed for <code>dracut</code> because <code>dracut</code> does that by default, at
least on <code>systemd</code> enabled systems. Not researched for non-<code>systemd</code> systems
by the author of this part of the readme.</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Network hardening</h2><a id="user-content-network-hardening" aria-label="Permalink: Network hardening" href="#network-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto">TCP syncookies are enabled to prevent SYN flood attacks.</p>
</li>
<li>
<p dir="auto">ICMP redirect acceptance, ICMP redirect sending, source routing and IPv6
router advertisements are disabled to prevent man-in-the-middle attacks.</p>
</li>
<li>
<p dir="auto">The kernel is configured to ignore all ICMP requests to avoid Smurf attacks,
make the device more difficult to enumerate on the network and prevent clock
fingerprinting through ICMP timestamps.</p>
</li>
<li>
<p dir="auto">RFC1337 is enabled to protect against time-wait assassination attacks by
dropping RST packets for sockets in the time-wait state.</p>
</li>
<li>
<p dir="auto">Reverse path filtering is enabled to prevent IP spoofing and mitigate
vulnerabilities such as CVE-2019-14899.</p>
</li>
<li>
<p dir="auto">Unlike version 4, IPv6 addresses can provide information not only about the
originating network, but also the originating device. We prevent this from
happening by enabling the respective privacy extensions for IPv6.</p>
</li>
<li>
<p dir="auto">In addition, we deny the capability to track the originating device in the
network at all, by using randomized MAC addresses per connection per
default.</p>
</li>
</ul>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/usr/lib/NetworkManager/conf.d/80_ipv6-privacy.conf</code></li>
<li><code>/usr/lib/NetworkManager/conf.d/80_randomize-mac.conf</code></li>
<li><code>/usr/lib/systemd/networkd.conf.d/80_ipv6-privacy-extensions.conf</code></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Bluetooth Hardening</h2><a id="user-content-bluetooth-hardening" aria-label="Permalink: Bluetooth Hardening" href="#bluetooth-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Bluetooth Status: Enabled but Defaulted to Off</h3><a id="user-content-bluetooth-status-enabled-but-defaulted-to-off" aria-label="Permalink: Bluetooth Status: Enabled but Defaulted to Off" href="#bluetooth-status-enabled-but-defaulted-to-off"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto"><strong>Default Behavior</strong>: Although Bluetooth capability is &#39;enabled&#39; in the kernel, security-misc deviates from the usual behavior by starting with Bluetooth turned off at system start. This setting remains until the user explicitly opts to activate Bluetooth.</p>
</li>
<li>
<p dir="auto"><strong>User Control</strong>: Users have the freedom to easily switch Bluetooth on and off in the usual way, exercising their own discretion. This can be done via the Bluetooth toggle through the usual way, that is either through GUI settings application or command line commands.</p>
</li>
<li>
<p dir="auto"><strong>Enhanced Privacy Settings</strong>: We enforce more private defaults for Bluetooth connections. This includes the use of private addresses and strict timeout settings for discoverability and visibility.</p>
</li>
<li>
<p dir="auto"><strong>Security Considerations</strong>: Despite these measures, it&#39;s important to note that Bluetooth technology, by its nature, may still be prone to exploits due to its history of security vulnerabilities. Thus, we recommend users to opt-out of using Bluetooth when possible.</p>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Configuration Details</h3><a id="user-content-configuration-details" aria-label="Permalink: Configuration Details" href="#configuration-details"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>See configuration: <code>/etc/bluetooth/30_security-misc.conf</code></li>
<li>For more information and discussion: <a href="https://github.com/Kicksecure/security-misc/pull/145" data-hovercard-type="pull_request" data-hovercard-url="/Kicksecure/security-misc/pull/145/hovercard">GitHub Pull Request</a></li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Understanding Bluetooth Terms</h3><a id="user-content-understanding-bluetooth-terms" aria-label="Permalink: Understanding Bluetooth Terms" href="#understanding-bluetooth-terms"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto"><strong>Disabling Bluetooth</strong>: This means the absence of the Bluetooth kernel module. When disabled, Bluetooth is non-existent in the system - it cannot be seen, set, configured, or interacted with in any way.</p>
</li>
<li>
<p dir="auto"><strong>Turning Bluetooth On/Off</strong>: This refers to a software toggle. Normally, on Debian systems, Bluetooth is &#39;on&#39; when the system boots up. It actively searches for known devices to auto-connect and may be discoverable or visible under certain conditions. Our default ensures that Bluetooth is off on startup. However, it remains &#39;enabled&#39; in the kernel, meaning the kernel can use the Bluetooth protocol and has the necessary modules.</p>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Quick Toggle Guide</h3><a id="user-content-quick-toggle-guide" aria-label="Permalink: Quick Toggle Guide" href="#quick-toggle-guide"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto"><strong>Turning Bluetooth On</strong>: Simply click the Bluetooth button in the settings application or on the tray, and switch the toggle. It&#39;s a straightforward action that can be completed in less than a second.</p>
</li>
<li>
<p dir="auto"><strong>Turning Bluetooth Off</strong>: Follow the same procedure as turning it on but switch the toggle to the off position.</p>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Entropy collection improvements</h2><a id="user-content-entropy-collection-improvements" aria-label="Permalink: Entropy collection improvements" href="#entropy-collection-improvements"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto">The <code>jitterentropy_rng</code> kernel module is loaded as early as possible during
boot to gather more entropy via the
<code>/usr/lib/modules-load.d/30_security-misc.conf</code> configuration file.</p>
</li>
<li>
<p dir="auto">Distrusts the CPU for initial entropy at boot as it is not possible to
audit, may contain weaknesses or a backdoor. For references, see:
<code>/etc/default/grub.d/40_distrust_cpu.cfg</code></p>
</li>
<li>
<p dir="auto">Gathers more entropy during boot if using the linux-hardened kernel patch.</p>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Restrictive mount options</h2><a id="user-content-restrictive-mount-options" aria-label="Permalink: Restrictive mount options" href="#restrictive-mount-options"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A systemd service is triggered on boot to remount all sensitive partitions and
directories with significantly more secure hardened mount options. Since this
would require manual tuning for a given specific system, we handle it by
creating a very solid configuration file for that very system on package
install.</p>
<p dir="auto">Not enabled by default yet. In development. Help welcome.</p>
<ul dir="auto">
<li><a href="https://www.kicksecure.com/wiki/Dev/remount-secure" rel="nofollow">https://www.kicksecure.com/wiki/Dev/remount-secure</a></li>
<li><a data-error-text="Failed to load title" data-id="1977920813" data-permission-text="Title is private" data-url="https://github.com/Kicksecure/security-misc/issues/157" data-hovercard-type="issue" data-hovercard-url="/Kicksecure/security-misc/issues/157/hovercard" href="https://github.com/Kicksecure/security-misc/issues/157">#157</a></li>
<li><a href="https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/" rel="nofollow">https://forums.whonix.org/t/re-mount-home-and-other-with-noexec-and-nosuid-among-other-useful-mount-options-for-better-security/</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Root access restrictions</h2><a id="user-content-root-access-restrictions" aria-label="Permalink: Root access restrictions" href="#root-access-restrictions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto"><code>su</code> is restricted to only users within the group <code>sudo</code> which prevents
users from using <code>su</code> to gain root access or to switch user accounts -
<code>/usr/share/pam-configs/wheel-security-misc</code> (which results in a change in
file <code>/etc/pam.d/common-auth</code>).</p>
</li>
<li>
<p dir="auto">Add user <code>root</code> to group <code>sudo</code>. This is required due to the above
restriction so that logging in from a virtual console is still possible -
<code>debian/security-misc.postinst</code></p>
</li>
<li>
<p dir="auto">Abort login for users with locked passwords -
<code>/usr/libexec/security-misc/pam-abort-on-locked-password</code>.</p>
</li>
<li>
<p dir="auto">Logging into the root account from a virtual, serial, whatnot console is
prevented by shipping an existing and empty <code>/etc/securetty</code> file (deletion
of <code>/etc/securetty</code> has a different effect).</p>
</li>
</ul>
<p dir="auto">This package does not yet automatically lock the root account password. It is
not clear if this would be sane in such a package although, it is recommended to
lock and expire the root account.</p>
<p dir="auto">In new Kicksecure builds, root account will be locked by package
dist-base-files.</p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><a href="https://www.kicksecure.com/wiki/Root" rel="nofollow">https://www.kicksecure.com/wiki/Root</a></li>
<li><a href="https://www.kicksecure.com/wiki/Dev/Permissions" rel="nofollow">https://www.kicksecure.com/wiki/Dev/Permissions</a></li>
<li><a href="https://forums.whonix.org/t/restrict-root-access/7658" rel="nofollow">https://forums.whonix.org/t/restrict-root-access/7658</a></li>
</ul>
<p dir="auto">However, a locked root password will break rescue and emergency shell.
Therefore, this package enables passwordless rescue and emergency shell. This is
the same solution that Debian will likely adapt for Debian installer:
<a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=802211" rel="nofollow">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=802211</a></p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/etc/systemd/system/emergency.service.d/override.conf</code></li>
<li><code>/etc/systemd/system/rescue.service.d/override.conf</code></li>
</ul>
<p dir="auto">Adverse security effects can be prevented by setting up BIOS password
protection, GRUB password protection and/or full disk encryption.</p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Console lockdown</h2><a id="user-content-console-lockdown" aria-label="Permalink: Console lockdown" href="#console-lockdown"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This uses pam_access to allow members of group <code>console</code> to use console but
restrict everyone else (except members of group <code>console-unrestricted</code>) from
using console with ancient, unpopular login methods such as <code>/bin/login</code> over
networks as this might be exploitable. (CVE-2001-0797)</p>
<p dir="auto">This is not enabled by default in this package since this package does not know
which users shall be added to group &#39;console&#39; and thus, would break console.</p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/usr/share/pam-configs/console-lockdown-security-misc</code></li>
<li><code>/etc/security/access-security-misc.conf</code></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Brute force attack protection</h2><a id="user-content-brute-force-attack-protection" aria-label="Permalink: Brute force attack protection" href="#brute-force-attack-protection"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">User accounts are locked after 50 failed login attempts using <code>pam_faillock</code>.</p>
<p dir="auto">Informational output during Linux PAM:</p>
<ul dir="auto">
<li>Show failed and remaining password attempts.</li>
<li>Document unlock procedure if Linux user account got locked.</li>
<li>Point out that there is no password feedback for <code>su</code>.</li>
<li>Explain locked root account if locked.</li>
</ul>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/usr/share/pam-configs/tally2-security-misc</code></li>
<li><code>/usr/libexec/security-misc/pam-info</code></li>
<li><code>/usr/libexec/security-misc/pam-abort-on-locked-password</code></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Access rights restrictions</h2><a id="user-content-access-rights-restrictions" aria-label="Permalink: Access rights restrictions" href="#access-rights-restrictions"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h3 tabindex="-1" dir="auto">Strong user account separation</h3><a id="user-content-strong-user-account-separation" aria-label="Permalink: Strong user account separation" href="#strong-user-account-separation"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">Permission Lockdown</h4><a id="user-content-permission-lockdown" aria-label="Permalink: Permission Lockdown" href="#permission-lockdown"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Read, write and execute access for &#34;others&#34; are removed during package
installation, upgrade or PAM <code>mkhomedir</code> for all users who have home folders in
<code>/home</code> by running, for example:</p>
<div data-snippet-clipboard-copy-content="chmod o-rwx /home/user"><pre><code>chmod o-rwx /home/user
</code></pre></div>
<p dir="auto">This will be done only once per folder in <code>/home</code> so users who wish to relax
file permissions are free to do so. This is to protect files in a home folder
that were previously created with lax file permissions prior to the installation
of this package.</p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>debian/security-misc.postinst</code></li>
<li><code>/usr/libexec/security-misc/permission-lockdown</code></li>
<li><code>/usr/share/pam-configs/mkhomedir-security-misc</code></li>
</ul>
<div dir="auto"><h4 tabindex="-1" dir="auto">umask</h4><a id="user-content-umask" aria-label="Permalink: umask" href="#umask"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Default <code>umask</code> is set to <code>027</code> for files created by non-root users such as for
example user <code>user</code>. Broken. Disabled. See:</p>
<ul dir="auto">
<li><a data-error-text="Failed to load title" data-id="2068616319" data-permission-text="Title is private" data-url="https://github.com/Kicksecure/security-misc/issues/184" data-hovercard-type="issue" data-hovercard-url="/Kicksecure/security-misc/issues/184/hovercard" href="https://github.com/Kicksecure/security-misc/issues/184">#184</a></li>
</ul>
<p dir="auto">This is doing using pam module <code>pam_mkhomedir.so umask=027</code>.</p>
<p dir="auto">This means, files created by non-root users cannot be read by other non-root
users by default. While Permission Lockdown already protects the <code>/home</code> folder,
this protects other folders such as <code>/tmp</code>.</p>
<p dir="auto"><code>group</code> read permissions are not removed. This is unnecessary due to Debian&#39;s
use of User Private Groups (UPGs). See also:
<a href="https://wiki.debian.org/UserPrivateGroups" rel="nofollow">https://wiki.debian.org/UserPrivateGroups</a></p>
<p dir="auto">Default <code>umask</code> is unchanged for root, because then configuration files created
in <code>/etc</code> by the system administrator would be unreadable by &#34;others&#34; and break
applications. Examples include <code>/etc/firefox-esr</code> and <code>/etc/thunderbird</code>.</p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/usr/share/pam-configs/umask-security-misc</code></li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">SUID / SGID removal and permission hardening</h3><a id="user-content-suid--sgid-removal-and-permission-hardening" aria-label="Permalink: SUID / SGID removal and permission hardening" href="#suid--sgid-removal-and-permission-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<div dir="auto"><h4 tabindex="-1" dir="auto">SUID / SGID removal</h4><a id="user-content-suid--sgid-removal" aria-label="Permalink: SUID / SGID removal" href="#suid--sgid-removal"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">A systemd service removes SUID / SGID bits from non-essential binaries as these
are often used in privilege escalation attacks.</p>
<div dir="auto"><h4 tabindex="-1" dir="auto">File permission hardening</h4><a id="user-content-file-permission-hardening" aria-label="Permalink: File permission hardening" href="#file-permission-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Various file permissions are reset with more secure and hardened defaults. These
include but are not limited to:</p>
<ul dir="auto">
<li>Limiting <code>/home</code> and <code>/root</code> to the root only.</li>
<li>Limiting crontab to root as well as all the configuration files for cron.</li>
<li>Limiting the configuration for cups and ssh.</li>
<li>Protecting the information of sudoers from others.</li>
<li>Protecting various system relevant files and modules.</li>
</ul>
<div dir="auto"><h5 tabindex="-1" dir="auto">permission-hardener</h5><a id="user-content-permission-hardener" aria-label="Permalink: permission-hardener" href="#permission-hardener"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>permission-hardener</code> removes SUID / SGID bits from non-essential binaries as
these are often used in privilege escalation attacks. It is enabled by default
and applied at security-misc package installation and upgrade time.</p>
<p dir="auto">There is also an optional systemd unit which does the same at boot time that
can be enabled by running <code>systemctl enable permission-hardener.service</code> as
root. The hardening at boot time is not the default because this slows down
the boot too much.</p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/usr/bin/permission-hardener</code></li>
<li><code>debian/security-misc.postinst</code></li>
<li><code>/lib/systemd/system/permission-hardener.service</code></li>
<li><code>/etc/permission-hardener.d</code></li>
<li><a href="https://forums.whonix.org/t/disable-suid-binaries/7706" rel="nofollow">https://forums.whonix.org/t/disable-suid-binaries/7706</a></li>
<li><a href="https://www.kicksecure.com/wiki/SUID_Disabler_and_Permission_Hardener" rel="nofollow">https://www.kicksecure.com/wiki/SUID_Disabler_and_Permission_Hardener</a></li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">Access rights relaxations</h3><a id="user-content-access-rights-relaxations" aria-label="Permalink: Access rights relaxations" href="#access-rights-relaxations"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">This is not enabled yet because hidepid is not enabled by default.</p>
<p dir="auto">Calls to <code>pkexec</code> are redirected to <code>lxqt-sudo</code> because <code>pkexec</code> is
incompatible with <code>hidepid=2</code>.</p>
<p dir="auto">See:</p>
<ul dir="auto">
<li><code>/usr/bin/pkexec.security-misc</code></li>
<li><a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860040" rel="nofollow">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=860040</a></li>
<li><a href="https://forums.whonix.org/t/cannot-use-pkexec/8129" rel="nofollow">https://forums.whonix.org/t/cannot-use-pkexec/8129</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Application-specific hardening</h2><a id="user-content-application-specific-hardening" aria-label="Permalink: Application-specific hardening" href="#application-specific-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Enables &#34;<code>apt-get --error-on=any</code>&#34; which makes apt exit non-zero for
transient failures. - <code>/etc/apt/apt.conf.d/40error-on-any</code>.</li>
<li>Enables APT seccomp-BPF sandboxing - <code>/etc/apt/apt.conf.d/40sandbox</code>.</li>
<li>Deactivates previews in Dolphin.</li>
<li>Deactivates previews in Nautilus -
<code>/usr/share/glib-2.0/schemas/30_security-misc.gschema.override</code>.</li>
<li>Deactivates thumbnails in Thunar.</li>
<li>Thunderbird is hardened with the following options:
<ul dir="auto">
<li>Displays domain names in punycode to prevent IDN homograph attacks (a
form of phishing).</li>
<li>Strips email client information for sent email headers.</li>
<li>Stripts user time information from sent email headers by replacing the
originating time zone with UTC and rounding the timestamp to the nearest
minute.</li>
<li>Disables scripting when viewing pdf files.</li>
<li>Disables implicit outgoing connections.</li>
<li>Disables all and any kind of telemetry.</li>
</ul>
</li>
<li>Security and privacy enhancements for gnupg&#39;s config file
<code>/etc/skel/.gnupg/gpg.conf</code>. See also:
<ul dir="auto">
<li><a href="https://raw.github.com/ioerror/torbirdy/master/gpg.conf">https://raw.github.com/ioerror/torbirdy/master/gpg.conf</a></li>
<li><a data-error-text="Failed to load title" data-id="18132846" data-permission-text="Title is private" data-url="https://github.com/ioerror/torbirdy/issues/11" data-hovercard-type="pull_request" data-hovercard-url="/ioerror/torbirdy/pull/11/hovercard" href="https://github.com/ioerror/torbirdy/pull/11">ioerror/torbirdy#11</a></li>
</ul>
</li>
</ul>
<div dir="auto"><h3 tabindex="-1" dir="auto">project scope of application-specific hardening</h3><a id="user-content-project-scope-of-application-specific-hardening" aria-label="Permalink: project scope of application-specific hardening" href="#project-scope-of-application-specific-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Added in December 2023.</p>
<p dir="auto">Before sending pull requests to harden arbitrary applications, please note the
scope of security-misc is limited to default installed applications in
Kicksecure, Whonix. This includes:</p>
<ul dir="auto">
<li>Thunderbird, VLC Media Player, KeepassXC</li>
<li>Debian Specific System Components (APT, DPKG)</li>
<li>System Services (NetworkManager IPv6 privacy options, MAC address
randomization)</li>
<li>Actually used development utilities such as <code>git</code>.</li>
</ul>
<p dir="auto">It will not be possible to review and merge &#34;1500&#34; settings profiles for
arbitrary applications outside of this context.</p>
<p dir="auto">The main objective of security-misc is to harden Kicksecure and its derivatives,
such as Whonix, by implementing robust security settings. It&#39;s designed to be
compatible with Debian, reflecting a commitment to clean implementation and
sound design principles. However, it&#39;s important to note that security-misc is a
component of Kicksecure, not a substitute for it. The intention isn&#39;t to
recreate Kicksecure within security-misc. Instead, specific security
enhancements, like for example recommending a curated list of security-focused
default packages (e.g., <code>libpam-tmpdir</code>), should be integrated directly into
those appropriate areas of Kicksecure (e.g.<code>kicksecure-meta-packages</code>).</p>
<p dir="auto">Discussion: <a data-error-text="Failed to load title" data-id="1977539173" data-permission-text="Title is private" data-url="https://github.com/Kicksecure/security-misc/issues/154" data-hovercard-type="issue" data-hovercard-url="/Kicksecure/security-misc/issues/154/hovercard" href="https://github.com/Kicksecure/security-misc/issues/154">#154</a></p>
<div dir="auto"><h3 tabindex="-1" dir="auto">development philosophy</h3><a id="user-content-development-philosophy" aria-label="Permalink: development philosophy" href="#development-philosophy"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Added in December 2023.</p>
<p dir="auto">&#34;Maintainability is a key priority [1]. Before modifying settings in the
downstream security-misc, it&#39;s essential to first engage with upstream
developers to propose these changes as defaults. This step should only be
bypassed if there&#39;s a clear, prior indication from upstream that such changes
won&#39;t be accepted. Additionally, before implementing any workarounds, consulting
with upstream is necessary to future unmaintainable complexity.</p>
<p dir="auto">If debugging features are disabled, pull requests won&#39;t be merged until there is
a corresponding pull request for the debug-misc package to re-enable these. This
is to avoid configuring the system into a corner where it can be no longer
debugged.</p>
<p dir="auto">[1] <a href="https://www.kicksecure.com/wiki/Dev/maintainability" rel="nofollow">https://www.kicksecure.com/wiki/Dev/maintainability</a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Opt-in hardening</h2><a id="user-content-opt-in-hardening" aria-label="Permalink: Opt-in hardening" href="#opt-in-hardening"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Some hardening is opt-in as it causes too much breakage to be enabled by
default.</p>
<ul dir="auto">
<li>
<p dir="auto">An optional systemd service mounts <code>/proc</code> with <code>hidepid=2</code> at boot to
prevent users from seeing another user&#39;s processes. This is disabled by
default because it is incompatible with <code>pkexec</code>. It can be enabled by
executing <code>systemctl enable proc-hidepid.service</code> as root.</p>
</li>
<li>
<p dir="auto">A systemd service restricts <code>/proc/cpuinfo</code>, <code>/proc/bus</code>, <code>/proc/scsi</code> and
<code>/sys</code> to the root user. This hides a lot of hardware identifiers from
unprivileged users and increases security as <code>/sys</code> exposes a lot of
information that shouldn&#39;t be accessible to unprivileged users. As this will
break many things, it is disabled by default and can optionally be enabled
by executing <code>systemctl enable hide-hardware-info.service</code> as root.</p>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">miscellaneous</h2><a id="user-content-miscellaneous" aria-label="Permalink: miscellaneous" href="#miscellaneous"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>
<p dir="auto">hardened malloc compatibility for haveged workaround
<code>/lib/systemd/system/haveged.service.d/30_security-misc.conf</code></p>
</li>
<li>
<p dir="auto">set <code>dracut</code> <code>reproducible=yes</code> setting</p>
</li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">legal</h2><a id="user-content-legal" aria-label="Permalink: legal" href="#legal"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>/usr/lib/issue.d/20_security-misc.issue</code></p>
<p dir="auto"><a data-error-text="Failed to load title" data-id="2000357720" data-permission-text="Title is private" data-url="https://github.com/Kicksecure/security-misc/issues/167" data-hovercard-type="pull_request" data-hovercard-url="/Kicksecure/security-misc/pull/167/hovercard" href="https://github.com/Kicksecure/security-misc/pull/167">#167</a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">Related</h2><a id="user-content-related" aria-label="Permalink: Related" href="#related"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li>Linux Kernel Runtime Guard (LKRG)</li>
<li>tirdad - TCP ISN CPU Information Leak Protection.</li>
<li>Kicksecure (TM) - a security-hardened Linux Distribution</li>
<li>And more.</li>
<li><a href="https://www.kicksecure.com/wiki/Linux_Kernel_Runtime_Guard_LKRG" rel="nofollow">https://www.kicksecure.com/wiki/Linux_Kernel_Runtime_Guard_LKRG</a></li>
<li><a href="https://github.com/Kicksecure/tirdad">https://github.com/Kicksecure/tirdad</a></li>
<li><a href="https://www.kicksecure.com" rel="nofollow">https://www.kicksecure.com</a></li>
<li><a href="https://github.com/Kicksecure">https://github.com/Kicksecure</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Discussion</h2><a id="user-content-discussion" aria-label="Permalink: Discussion" href="#discussion"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Happening primarily in forums.</p>
<p dir="auto"><a href="https://forums.whonix.org/t/kernel-hardening/7296" rel="nofollow">https://forums.whonix.org/t/kernel-hardening/7296</a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">How to install <code>security-misc</code></h2><a id="user-content-how-to-install-security-misc" aria-label="Permalink: How to install security-misc" href="#how-to-install-security-misc"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">See <a href="https://www.kicksecure.com/wiki/Security-misc#install" rel="nofollow">https://www.kicksecure.com/wiki/Security-misc#install</a></p>
<div dir="auto"><h2 tabindex="-1" dir="auto">How to Build deb Package from Source Code</h2><a id="user-content-how-to-build-deb-package-from-source-code" aria-label="Permalink: How to Build deb Package from Source Code" href="#how-to-build-deb-package-from-source-code"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto">Can be build using standard Debian package build tools such as:</p>
<div data-snippet-clipboard-copy-content="dpkg-buildpackage -b"><pre><code>dpkg-buildpackage -b
</code></pre></div>
<p dir="auto">See instructions. (Replace <code>generic-package</code> with the actual name of this
package <code>security-misc</code>.)</p>
<ul dir="auto">
<li><strong>A)</strong>
<a href="https://www.kicksecure.com/wiki/Dev/Build_Documentation/generic-package/easy" rel="nofollow">easy</a>,
<em>OR</em></li>
<li><strong>B)</strong> <a href="https://www.kicksecure.com/wiki/Dev/Build_Documentation/generic-package" rel="nofollow">including verifying software
signatures</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Contact</h2><a id="user-content-contact" aria-label="Permalink: Contact" href="#contact"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<ul dir="auto">
<li><a href="https://forums.kicksecure.com" rel="nofollow">Free Forum Support</a></li>
<li><a href="https://www.kicksecure.com/wiki/Professional_Support" rel="nofollow">Professional Support</a></li>
</ul>
<div dir="auto"><h2 tabindex="-1" dir="auto">Donate</h2><a id="user-content-donate" aria-label="Permalink: Donate" href="#donate"><svg viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a></div>
<p dir="auto"><code>security-misc</code> requires <a href="https://www.kicksecure.com/wiki/Donate" rel="nofollow">donations</a> to
stay alive!</p>
</article></div></div>
  </body>
</html>
