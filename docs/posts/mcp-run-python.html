<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/pydantic/pydantic-ai/tree/main/mcp-run-python">Original</a>
    <h1>MCP Run Python</h1>
    
    <div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<p dir="auto"><a href="https://modelcontextprotocol.io/" rel="nofollow">Model Context Protocol</a> server to run Python code in a sandbox.</p>
<p dir="auto">The code is executed using <a href="https://pyodide.org" rel="nofollow">Pyodide</a> in <a href="https://deno.com/" rel="nofollow">Deno</a> and is therefore isolated from
the rest of the operating system.</p>
<p dir="auto"><strong>See <a href="https://ai.pydantic.dev/mcp/run-python/" rel="nofollow">https://ai.pydantic.dev/mcp/run-python/</a> for complete documentation.</strong></p>
<p dir="auto">The server can be run with <code>deno</code> installed using:</p>
<div dir="auto" data-snippet-clipboard-copy-content="deno run \
  -N -R=node_modules -W=node_modules --node-modules-dir=auto \
  jsr:@pydantic/mcp-run-python [stdio|sse|warmup]"><pre>deno run \
  -N -R=node_modules -W=node_modules --node-modules-dir=auto \
  jsr:@pydantic/mcp-run-python [stdio<span>|</span>sse<span>|</span>warmup]</pre></div>
<p dir="auto">where:</p>
<ul dir="auto">
<li><code>-N -R=node_modules -W=node_modules</code> (alias of <code>--allow-net --allow-read=node_modules --allow-write=node_modules</code>)
allows network access and read+write access to <code>./node_modules</code>. These are required so pyodide can download and cache
the Python standard library and packages</li>
<li><code>--node-modules-dir=auto</code> tells deno to use a local <code>node_modules</code> directory</li>
<li><code>stdio</code> runs the server with the
<a href="https://spec.modelcontextprotocol.io/specification/2024-11-05/basic/transports/#stdio" rel="nofollow">Stdio MCP transport</a> —
suitable for running the process as a subprocess locally</li>
<li><code>sse</code> runs the server with the
<a href="https://spec.modelcontextprotocol.io/specification/2024-11-05/basic/transports/#http-with-sse" rel="nofollow">SSE MCP transport</a> —
running the server as an HTTP server to connect locally or remotely</li>
<li><code>warmup</code> will run a minimal Python script to download and cache the Python standard library. This is also useful to
check the server is running correctly.</li>
</ul>
<p dir="auto">Here&#39;s an example of using <code>@pydantic/mcp-run-python</code> with PydanticAI:</p>
<div dir="auto" data-snippet-clipboard-copy-content="from pydantic_ai import Agent
from pydantic_ai.mcp import MCPServerStdio

import logfire

logfire.configure()
logfire.instrument_mcp()
logfire.instrument_pydantic_ai()

server = MCPServerStdio(&#39;deno&#39;,
    args=[
        &#39;run&#39;,
        &#39;-N&#39;,
        &#39;-R=node_modules&#39;,
        &#39;-W=node_modules&#39;,
        &#39;--node-modules-dir=auto&#39;,
        &#39;jsr:@pydantic/mcp-run-python&#39;,
        &#39;stdio&#39;,
    ])
agent = Agent(&#39;claude-3-5-haiku-latest&#39;, mcp_servers=[server])


async def main():
    async with agent.run_mcp_servers():
        result = await agent.run(&#39;How many days between 2000-01-01 and 2025-03-18?&#39;)
    print(result.output)
    #&gt; There are 9,208 days between January 1, 2000, and March 18, 2025.w

if __name__ == &#39;__main__&#39;:
    import asyncio
    asyncio.run(main())"><pre><span>from</span> <span>pydantic_ai</span> <span>import</span> <span>Agent</span>
<span>from</span> <span>pydantic_ai</span>.<span>mcp</span> <span>import</span> <span>MCPServerStdio</span>

<span>import</span> <span>logfire</span>

<span>logfire</span>.<span>configure</span>()
<span>logfire</span>.<span>instrument_mcp</span>()
<span>logfire</span>.<span>instrument_pydantic_ai</span>()

<span>server</span> <span>=</span> <span>MCPServerStdio</span>(<span>&#39;deno&#39;</span>,
    <span>args</span><span>=</span>[
        <span>&#39;run&#39;</span>,
        <span>&#39;-N&#39;</span>,
        <span>&#39;-R=node_modules&#39;</span>,
        <span>&#39;-W=node_modules&#39;</span>,
        <span>&#39;--node-modules-dir=auto&#39;</span>,
        <span>&#39;jsr:@pydantic/mcp-run-python&#39;</span>,
        <span>&#39;stdio&#39;</span>,
    ])
<span>agent</span> <span>=</span> <span>Agent</span>(<span>&#39;claude-3-5-haiku-latest&#39;</span>, <span>mcp_servers</span><span>=</span>[<span>server</span>])


<span>async</span> <span>def</span> <span>main</span>():
    <span>async</span> <span>with</span> <span>agent</span>.<span>run_mcp_servers</span>():
        <span>result</span> <span>=</span> <span>await</span> <span>agent</span>.<span>run</span>(<span>&#39;How many days between 2000-01-01 and 2025-03-18?&#39;</span>)
    <span>print</span>(<span>result</span>.<span>output</span>)
    <span>#&gt; There are 9,208 days between January 1, 2000, and March 18, 2025.w</span>

<span>if</span> <span>__name__</span> <span>==</span> <span>&#39;__main__&#39;</span>:
    <span>import</span> <span>asyncio</span>
    <span>asyncio</span>.<span>run</span>(<span>main</span>())</pre></div>
</article></div></div>
  </body>
</html>
