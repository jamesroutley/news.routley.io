<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://github.com/Librum-Reader/Librum">Original</a>
    <h1>Librum: Open-Source e-book platform</h1>
    
    <div id="readability-page-1" class="page"><div>
      <div>
  
<p><span>14 Dec 2023</span></p><p>This blog post is part of a series on file formats research. See <a href="https://bits.ashleyblewer.com/blog/2023/08/04/researching-file-formats-library-of-congress-sustainability-of-digital-formats/">this introduction post</a> for more information.</p>

<p>Following up from <a href="https://bits.ashleyblewer.com/blog/2023/12/01/researching-file-formats-14-apple-emlx-format/">EMLX from a few weeks ago</a>, we have Microsoft’s special way of handling emails: TNEF! TNEF: “Transport Neutral Encapsulation Format.”</p>

<p>TNEF is responsible for the millions of people that have been annoyed at receiving an email with an attachment that doesn’t mean anything to them: the winmail.dat attachment. Turns out, this just is Outlook talking to other Outlooks about whether Susan from Accounting is using Papyrus in her email signature, stuff like that.</p>

<p>Is TNEF responsible for “<a href="https://office-watch.com/2017/outlook-discovers-emoji-goodbye-j-hello-color-smiley/">the J</a>”? Absolutely wild it took until 2017 to fix this.</p>

<p>The answer to the question about the J was that it was Wingdings. So actually, well, maybe yes, because TNEF is responsible for sending richtext emails instead of plaintext, and it would have the intel to use Wingdings instead of a normal font, and a plaintext would just be the J. Hey! I had to talk that one out to myself but yeah, I guess TNEF is at play here!</p>

<p>It’s just another one of those things that Microsoft does that makes official things feel like a spam or phishing attack.</p>

<p>It also managed attachments, so it seems to have caused some trouble there, too.</p>

<p>I’m feeling a little blessed because I looked in my email history and only saw five threads that included an attached winmail.dat.</p>

<p>Okay, I have story here that is a little related to TNEF. Probably ten years ago, I was working on a project and for some reason we were passing a file back and forth through email instead of using Git, and this file was a CSV file. Git was involved too, but for some reason we were temporarily not using it – maybe because it was an open source project and we had to get the data in order before making it public, but the repo was already public? I honestly don’t remember. But there was a problem with the file, it’d come back with some extra invisible newline characters. And the person sending me the file was like “hey, stop doing that!” and I was like “I’m not doing anything! You stop doing that!” We both were on macOS and we were also both using the same text editor with the same settings. So it turns out that it was the mail server that was intercepting our CSV, adding the extra linebreaks (which Microsoft will do), and sending it along, messing up the communication between an otherwise non-Microsoft connection. Annoying and invasive, right? I don’t know that this was what I specifically ran into, but you can see a similar annoying problem in the <a href="https://stackoverflow.com/questions/10401863/how-to-send-a-csv-attachment-with-lines-longer-than-990-characters">top answer to this stackoverflow question</a>.</p>


</div>

    </div></div>
  </body>
</html>
