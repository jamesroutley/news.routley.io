<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ishadeed.com/article/threads-app-css/">Original</a>
    <h1>CSS Findings from the Threads App</h1>
    
    <div id="readability-page-1" class="page"><div>
		
		<p>When I encounter a new product, one of the first things that comes to mind is how they implemented the CSS. This was no different when I came across Threads by Meta. I quickly explored the mobile app and noticed that I could preview public posts on the web.</p>

<p>This presented an opportunity for me to dig deeper. I came across a few interesting findings, which I will discuss in this article.</p>

<p>Let’s dive in!</p>

<h2 id="using-css-grid-for-the-post-layout">Using CSS grid for the post layout</h2>

<p>One of the most noteworthy use cases of CSS Grid in a production app is found in Threads. CSS Grid is used to build the post layout.</p>

<p>Take a look:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-grid-layout.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<div><div><pre><code><span>:root</span> <span>{</span>
  <span>--barcelona-threadline-column-width</span><span>:</span> <span>48px</span><span>;</span>
<span>}</span>

<span>.post</span> <span>{</span>
  <span>display</span><span>:</span> <span>grid</span><span>;</span>
  <span>grid-template-columns</span><span>:</span>
    <span>var</span><span>(</span><span>--barcelona-threadline-column-width</span><span>)</span>
    <span>minmax</span><span>(</span><span>0</span><span>,</span> <span>1</span><span>fr</span><span>);</span>
  <span>grid-template-rows</span><span>:</span> <span>21px</span> <span>19px</span> <span>max-content</span> <span>max-content</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p><strong>Fun fact:</strong> the first grid column is named <code>--barcelona</code>. I’m curious to know the reason behind this choice.</p>

<p>The post layout consists of a 2-column * 4-row grid. There is no main container; each item within the post is manually placed using the <code>grid-column</code> and <code>grid-row</code> properties.</p>

<h3 id="the-user-avatar">The user avatar</h3>

<div><div><pre><code><span>.post-avatar</span> <span>{</span>
  <span>padding-top</span><span>:</span> <span>4px</span><span>;</span>
  <span>grid-row</span><span>:</span> <span>1</span> <span>/</span> <span>span</span> <span>2</span><span>;</span>
  <span>grid-column</span><span>:</span> <span>1</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>The avatar is positioned in the first column and spans the first two rows. It’s worth noting the presence of <code>padding-top</code>. Although I couldn’t find a specific reason for it in the production code, it seems to be fine-tuning the UI alignment.</p>

<p>Here is a <strong>before &amp; after</strong> look for an avatar with and without the <code>padding-top</code> treatment:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-avatar.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>The other reason for applying the <code>padding-top</code> here could be to push the avatar all the way down and make it closer to the line.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-avatar-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<h3 id="using-odd-values-for-the-grid-rows">Using odd values for the grid rows</h3>

<p>Why use <code>21px</code> and <code>19px</code> as row values? After inspecting further, it seems to be a form of fine-tuning for the UI. The sum of the row heights is <code>40px</code>, which accounts for the avatar height plus the <code>padding-top</code> (36px + 4px).</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-grid-rows.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>You might be curious why these values are not standardized. Design systems are commonly associated with the belief that designers must strictly follow predefined rules for UI elements.</p>

<p>However, this example shows that using manually adjusted values can be acceptable. It’s okay to deviate from strict guidelines in certain situations.</p>

<h3 id="limitations-of-using-fixed-size-rows">Limitations of Using Fixed-Size Rows</h3>

<p>Due to the fixed widths of the first two rows, it’s not possible to add padding to them. Nevertheless, as long as you’re aware of this limitation, it can be worked around by using margins instead.</p>

<p>Here is an example:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-fixed-size-rows.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Adding top and bottom padding didn’t affect the post header due to the fixed-size rows.</p>

<h3 id="the-space-between-the-layout-columns-feels-a-bit-hacky">The space between the layout columns feels a bit hacky</h3>

<p>The current gap between the layout columns is zero. Instead, the image has a size of <code>36*36</code> pixels, whereas its container is <code>48</code> pixels in width.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-spacing.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>This mimics the spacing here. I don’t know why the team opt-in for that, but I would prefer to use <code>gap</code> instead.</p>

<h3 id="why-not-use-named-css-grid-areas">Why not use named CSS grid areas?</h3>

<p>Based on what I’ve observed so far, there are three variations of the grid layout, and all of them could benefit from using named grid areas.</p>

<p>I tried to replicate the grid and build it based on the named areas. It looks easier to scan than specifying values for the columns and rows.</p>

<p>To demonstrate this, let’s assign a <code>grid-area</code> to each item in the layout:</p>

<div><div><pre><code><span>.AvatarContainer</span> <span>{</span>
  <span>grid-area</span><span>:</span> <span>avatar</span><span>;</span>
<span>}</span>

<span>.HeaderContainer</span> <span>{</span>
  <span>grid-area</span><span>:</span> <span>header</span><span>;</span>
<span>}</span>

<span>.BodyContainer</span> <span>{</span>
  <span>grid-area</span><span>:</span> <span>body</span><span>;</span>
<span>}</span>

<span>.ThreadlineContainer</span> <span>{</span>
  <span>grid-area</span><span>:</span> <span>line</span><span>;</span>
<span>}</span>

<span>.FooterContainer</span> <span>{</span>
  <span>grid-area</span><span>:</span> <span>footer</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<h4 id="variation-1-the-default">Variation 1: the default</h4>

<p>Then, we can start working on the variations. Here is the default layout:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-grid-area-1.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<div><div><pre><code><span>.post</span> <span>{</span>
  <span>display</span><span>:</span> <span>grid</span><span>;</span>
  <span>grid-template-columns</span><span>:</span>
    <span>var</span><span>(</span><span>--barcelona-threadline-column-width</span><span>)</span>
    <span>minmax</span><span>(</span><span>0</span><span>,</span> <span>1</span><span>fr</span><span>);</span>
  <span>grid-template-rows</span><span>:</span> <span>21px</span> <span>19px</span> <span>max-content</span> <span>max-content</span><span>;</span>
  <span>grid-template-areas</span><span>:</span>
    <span>&#34;avatar header&#34;</span>
    <span>&#34;avatar body&#34;</span>
    <span>&#34;. body&#34;</span>
    <span>&#34;. footer&#34;</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Note the use of <code>.</code> to represent empty spaces.</p>

<h4 id="variation-2-the-reply">Variation 2: the reply</h4>

<p>A variation is when someone replies to another.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-grid-area-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<div><div><pre><code><span>.post--reply</span> <span>{</span>
  <span>grid-template-rows</span><span>:</span> <span>36px</span> <span>0</span> <span>max-content</span> <span>max-content</span><span>;</span>
  <span>grid-template-areas</span><span>:</span>
    <span>&#34;avatar header&#34;</span>
    <span>&#34;body body&#34;</span>
    <span>&#34;body body&#34;</span>
    <span>&#34;footer footer&#34;</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<h4 id="variation-3-the-default-with-a-thread-line">Variation 3: the default with a thread line</h4>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-post-grid-area-3.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<div><div><pre><code><span>.post--withLine</span> <span>{</span>
  <span>grid-template-areas</span><span>:</span>
    <span>&#34;avatar header&#34;</span>
    <span>&#34;avatar body&#34;</span>
    <span>&#34;line body&#34;</span>
    <span>&#34;footer footer&#34;</span><span>;</span>
<span>}</span>
</code></pre></div></div>

<p>Using named grid areas here made it possible to change the layout by editing in one place only.</p>

<h2 id="svg-for-the-thread-lines">SVG for the thread lines</h2>

<p>To be honest, what initially caught my attention in the Threads app was the swirl line. I became curious about how it was constructed since I had previously written about <a href="https://ishadeed.com/article/comment-component/">a similar topic</a> a few weeks ago.</p>

<p>See the following figure:</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-line.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>That line connecting my avatar to Mark’s one is an SVG path. It consists of three parts.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-line-2.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>The length of the first part is calculated with JavaScript.</p>

<h2 id="inline-css-variables-for-css-grid">Inline CSS variables for CSS grid</h2>

<p>I’m happy to see a thing that I and many others <a href="https://ishadeed.com/article/css-variables-inline-styles/">advocated for</a> is being used on a large-scale app like Threads.</p>

<p>In the user profile, the tabs grid layout is built with an inline CSS variable that includes the count of the tabs.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-inline-css-vars.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>This is useful. When the number of tabs increased, we only need to change the value of the CSS variable. Neat, right?</p>

<h2 id="overflow-wrapping">Overflow wrapping</h2>

<p>I noticed the use of <code>overflow-wrap: anywhere</code> for the post body. I haven’t used or heard of that keyword before. I use <code>break-word</code>.</p>

<p>As per <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/overflow-wrap">MDN</a>, it’s the same as <code>break-word</code> but with one additional thing:</p>

<blockquote>
  <p>Soft wrap opportunities introduced by the word break are considered when calculating min-content intrinsic sizes.</p>
</blockquote>

<p>I still didn’t find a difference when using <code>break-word</code> vs <code>anywhere</code>. I’m very curious to know why, if any of the Threads team is reading this.</p>

<h2 id="the-use-of-dynamic-viewport-units">The use of dynamic viewport units</h2>

<p>I like the use of the dynamic viewport unit <code>dvh</code> for the splash screen.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-splash-dvh.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>If you want to learn more, I wrote a detailed article on <a href="https://ishadeed.com/article/new-viewport-units/">the new viewport units</a>.</p>

<h2 id="defensive-css-strategies">Defensive CSS strategies</h2>

<p>To make sure that a flexbox layout won’t break because of the minimum content length, <code>min-width: 0</code> is used to reset that behavior.</p>

<figure>
    
        <img src="https://ishadeed.com/assets/threads-app-css/threads-splash-min-width.png" alt=""/>
    
    
        <figcaption></figcaption>
    
</figure>

<p>Read more about this in my <a href="https://defensivecss.dev/tip/flexbox-min-content-size/">defensive CSS post</a> about the minimum content size in flexbox.</p>

<h2 id="conclusion">Conclusion</h2>

<p>That’s it for today. I enjoyed inspecting the CSS and getting to know how the Threads team is building the product. I’m sure there are a lot of things that I haven’t noticed because this is the preview-only version on the web.</p>

	</div></div>
  </body>
</html>
