<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://learn.microsoft.com/en-us/windows/arm/arm64ec">Original</a>
    <h1>Arm64EC – Run x86_64 and Arm code in the same process</h1>
    
    <div id="readability-page-1" class="page">
	<div>
		<a href="#main" tabindex="1">Skip to main content</a>

		

		<div id="unsupported-browser" hidden="">
			<div>
				<p>This browser is no longer supported.</p>
				<p>Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			
			
			
		</header>
	</div>

	<div data-bi-name="body">

		<div><!-- .primary-holder -->
			<section>
				<!--div.columns -->
				<div><div id="main-column">

						<main id="main" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							
							<!-- end article-header --><!-- end mobile-contents button  -->

							<div><nav id="center-doc-outline" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article">In this article</h2>
										</nav><!-- <content> --><p>Arm64EC (“Emulation Compatible”) enables you to build new native apps or incrementally transition existing x64 apps to take advantage of the native speed and performance possible with Arm-powered devices, including better power consumption, battery life, and accelerated AI &amp; ML workloads.</p>
<p>Arm64EC is a new application binary interface (ABI) for apps running on Arm devices with Windows 11. It is a Windows 11 feature that requires the use of the Windows 11 SDK and is not available on Windows 10 on Arm.</p>
<h2 id="interoperability">Interoperability</h2>
<p>Code built as Arm64EC is interoperable with x64 code running under emulation within the same process.  The Arm64EC code in the process runs with native performance, while any x64 code runs using emulation that comes built-in with Windows 11. Even if your app relies on existing dependencies or plugins that don&#39;t yet support Arm, you can start to rebuild parts of your app as Arm64EC to gain the benefits of native performance.</p>
<p>Arm64EC guarantees interoperability with x64 by following x64 software conventions including calling convention, stack usage, data structure layout, and preprocessor definitions. However, Arm64EC code is not compatible with code built as Arm64, which uses a different set of software conventions.</p>
<p>The Windows 11 on Arm operating system itself relies heavily on Arm64EC&#39;s interoperability to enable running x64 applications.  Most operating system code loaded by an x64 app running on Windows 11 on Arm will have been compiled as Arm64EC, enabling native performance for that code without the application knowing.</p>
<p>An x64 or Arm64EC process can load and call into both x64 and Arm64EC binaries, whereas an Arm64 process can only load Arm64 binaries.  Both architectures can load <a href="https://learn.microsoft.com/en-us/windows/arm/arm64x-pe" data-linktype="relative-path">Arm64X binaries</a> as those contain code for both x64 and Arm64.</p>
<table>
<thead>
<tr>
<th>Process architecture</th>
<th>x64 binary</th>
<th>Arm64EC binary</th>
<th>Arm64 binary</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>x64/Arm64EC</strong></td>
<td>✔</td>
<td>✔</td>
<td>❌</td>
</tr>
<tr>
<td><strong>Arm64</strong></td>
<td>❌</td>
<td>❌</td>
<td>✔</td>
</tr>
</tbody>
</table>
<p>✔ = Supported,
❌ = Not supported</p>
<p>Similarly, at build time, Arm64EC binaries can link in both x64 and Arm64EC libs, while Arm64 binaries can only link in Arm64 libs.</p>
<table>
<thead>
<tr>
<th>PE architecture</th>
<th>x64 lib</th>
<th>Arm64EC lib</th>
<th>Arm64 lib</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Arm64EC</strong></td>
<td>✔</td>
<td>✔</td>
<td>❌</td>
</tr>
<tr>
<td><strong>Arm64</strong></td>
<td>❌</td>
<td>❌</td>
<td>✔</td>
</tr>
</tbody>
</table>
<p>✔ = Supported,
❌ = Not supported</p>
<p>For more detail about how the Arm64EC ABI enables interoperability, see <a href="https://learn.microsoft.com/en-us/windows/arm/arm64ec-abi" data-linktype="relative-path">Understanding Arm64EC ABI and assembly code</a>.</p>
<h2 id="use-arm64ec-to-make-an-existing-app-faster-on-windows-11-on-arm">Use Arm64EC to make an existing app faster on Windows 11 on Arm</h2>
<p>Arm64EC enables to you to <strong>incrementally</strong> transition the code in your existing app from emulated to native. At each step along the way, your application continues to run well without the need to be recompiled all at once.</p>
<p><img src="https://learn.microsoft.com/en-us/windows/arm/images/arm64ec-incremental-update.png" alt="Example graph showing incremental update effects on Arm performance using Arm64EC" data-linktype="relative-path"/></p>
<p>The image above shows a simplified example of a fully-emulated x64 workload taking some amount of time that is then incrementally improved using Arm64EC:</p>
<ol>
<li>Starting as a fully emulated x64 workload</li>
<li>After recompiling the most CPU-intensive parts as Arm64EC</li>
<li>After continuing to recompile more x64 modules over time</li>
<li>Ending result of a fully native Arm64EC app</li>
</ol>
<p>By recompiling the modules that take the most time or are the most CPU-intensive from x64 to Arm64EC, the resulting workload receives the most improvement for the least amount of effort each step of the way.</p>
<h2 id="app-dependencies">App dependencies</h2>
<p>When using Arm64EC to rebuild an application, you will want to use Arm64EC versions of dependencies but you can also rely on x64 versions of dependencies. Arm64 versions of dependencies won&#39;t be usable.</p>
<p>Any x64 code, including code from dependencies, in an Arm64EC process will run under emulation in your app. Prioritizing the most CPU-intensive dependencies to transition from x64 to Arm64EC will have the greatest impact toward improving your app&#39;s performance.</p>
<h2 id="identifying-arm64ec-binaries-and-apps">Identifying Arm64EC binaries and apps</h2>
<p>Apps running on Windows 11 on Arm will interact with Arm64EC binaries as though they are x64 binaries. The app does not need to know to what extent the code in the binary has been recompiled as Arm64EC. </p>
<p>For developers interested in identifying these binaries, you can see them in a developer command prompt using <code>link /dump /headers</code>.</p>
<pre><code>File Type: EXECUTABLE IMAGE
FILE HEADER VALUES
    8664 machine (x64) (ARM64X)
</code></pre>
<p>The combination of (x64) and (ARM64X) indicates that some portion of the binary has been recompiled as Arm64EC, even though the binary still appears to be x64. A binary with a machine header that contains (ARM64) and (ARM64X) is an <a href="https://learn.microsoft.com/en-us/windows/arm/arm64x-pe" data-linktype="relative-path">Arm64X PE file</a> that can be loaded into both x64 and Arm64 apps.</p>
<p>Windows <strong>Task Manager</strong> can also be used to identify if an app has been compiled as Arm64EC. In the <strong>Details</strong> tab of Task manager, the <strong>Architecture</strong> column will show <strong>ARM64 (x64 compatible)</strong> for applications whose main executable has been partially or completely compiled as Arm64EC.</p>
<p><img src="https://learn.microsoft.com/en-us/windows/arm/images/arm64ec-task-manager.png" alt="Screenshot of Task Manager showing ARM64 (x64 compatible) in Architecture details." data-linktype="relative-path"/></p>
<h2 id="next-steps">Next steps</h2>
<p>See <a href="https://learn.microsoft.com/en-us/windows/arm/arm64ec-build" data-linktype="relative-path">Get started with Arm64EC</a> to learn how to build or update Win32 apps using Arm64EC.</p>
</div>
							
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><section data-bi-name="open-source-feedback-section" data-open-source-feedback-section="" hidden="">
	<div>
		<div>
			<div>
				<div>
					<span aria-hidden="true">
						<span></span>
					</span>
					<span>Collaborate with us on GitHub</span>
				</div>
				<span>
					The source for this content can be found on GitHub, where you can also create and review issues and pull requests. For more information, see <a href="https://learn.microsoft.com/contribute/content/how-to-write-quick-edits">our contributor guide</a>.
				</span>
			</div>
		</div>
		
	</div>
</section><section data-bi-name="feedback-section">
    <h2 id="feedback">Feedback</h2>

    <div>
		<p id="git-issues-deprecation-notice">
			<span aria-hidden="true">
				<span>
			</span>
			</span>Coming soon: Throughout 2024 we will be phasing out GitHub Issues as the feedback mechanism for content and replacing it with a new feedback system. For more information see: <a href="https://aka.ms/ContentUserFeedback" data-bi-name="content-user-feedback">https://aka.ms/ContentUserFeedback</a>.</p>

        <p id="send-feedback-about">Submit and view feedback for</p>

        
    </div>

    
</section><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --></div><div id="ms--additional-resources" data-bi-name="pageactions" role="complementary" aria-label="Additional resources">
							<div id="affixed-right-container" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" hidden="">Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden=""></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden=""></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden=""></section>
								<nav id="side-doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" data-bi-name="qna-link-card" hidden=""></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section>

	</section>

</div>
  </body>
</html>
