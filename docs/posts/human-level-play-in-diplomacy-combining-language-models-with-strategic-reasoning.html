<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>James Routley | Feed</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="../styles.css"
      media="screen"
    />
  </head>
  <body>
    <a href="/index.html">Back</a>
    <a href="https://ai.facebook.com/blog/cicero-ai-negotiates-persuades-and-cooperates-with-people/">Original</a>
    <h1>Human-Level Play in Diplomacy Combining Language Models with Strategic Reasoning</h1>
    
    <div id="readability-page-1" class="page"><div><div><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315836854_652152046378603_5234375388719659388_n.gif?_nc_cat=1&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=LomOuhz8s90AX8VemXI&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDDWaDR76G1PJLGKSE4GdDg7dX56yZg9mjZl_yiVFVqYg&amp;oe=63829C28" alt=""/></p><p> Games have long been a proving ground for new AI advancements — from Deep Blue’s victory over chess grandmaster Garry Kasparov, to AlphaGo’s mastery of Go, to <a href="https://ai.facebook.com/blog/pluribus-first-ai-to-beat-pros-in-6-player-poker/">Pluribus</a> out-bluffing the best humans in poker. But truly useful, versatile agents will need to go beyond just moving pieces on a board. Can we build more effective and flexible agents that can use language to negotiate, persuade, and work with people to achieve strategic goals similar to the way humans do? </p><p> Today, we’re announcing a breakthrough toward building AI that has mastered these skills. We’ve built an agent – <a href="https://ai.facebook.com/research/cicero/">CICERO</a> – that is the first AI to achieve human-level performance in the popular strategy game Diplomacy*. CICERO demonstrated this by playing on webDiplomacy.net, an online version of the game, where CICERO achieved more than double the average score of the human players and ranked in the top 10 percent of participants who played more than one game. </p><div id="u_0_2n_UM"><div id="u_0_2o_0Y"><div tabindex="0" id="u_0_2p_5l"><video muted="1" height="360" width="640" preload="metadata" data-video-width="640" data-video-height="360" id="u_0_2q_6x"></video><p><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y4/r/-PAXP-deijE.gif" alt="" id="u_0_2t_8b"/></p><div><div><p>Something Went Wrong</p><p>We&#39;re having trouble playing this video.</p></div></div></div></div></div><p><span><p> Diplomacy has been viewed for decades as a near-impossible grand challenge in AI because it requires players to master the art of understanding other people’s motivations and perspectives; make complex plans and adjust strategies; and then use natural language to reach agreements with other people, convince them to form partnerships and alliances, and more. CICERO is so effective at using natural language to negotiate with people in Diplomacy that they often favored working with CICERO over other human participants. </p></span></p><p> Unlike games like Chess and Go, Diplomacy is a game about people rather than pieces. If an agent can&#39;t recognize that someone is likely bluffing or that another player would see a certain move as aggressive, it will quickly lose the game. Likewise, if it doesn&#39;t talk like a real person -- showing empathy, building relationships, and speaking knowledgeably about the game -- it won&#39;t find other players willing to work with it. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315623790_1288410545284583_1781751659752754731_n.png?_nc_cat=101&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=dEVSkJVHOvcAX9CJGTV&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfCotS9U4kvzvbUZErlaFY43HZL82kV0GworXkBkdtvUpQ&amp;oe=6382DDB5" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315237081_519353730119273_5637781287557308767_n.png?_nc_cat=107&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=SiMa0kl_Me8AX_z-757&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfBtDZg89A354_D6Vr8dosoVB8G2io8RvWkL2aCI0nzKgQ&amp;oe=6381AB4A" alt=""/></p><p> The key to our achievement was developing new techniques at the intersection of two completely different areas of AI research: strategic reasoning, as used in agents like AlphaGo and <a href="https://ai.facebook.com/blog/pluribus-first-ai-to-beat-pros-in-6-player-poker/">Pluribus</a>, and natural language processing, as used in models like GPT-3, <a href="https://ai.facebook.com/blog/blenderbot-3-a-175b-parameter-publicly-available-chatbot-that-improves-its-skills-and-safety-over-time/">BlenderBot 3</a>, LaMDA, and <a href="https://ai.facebook.com/blog/democratizing-access-to-large-scale-language-models-with-opt-175b/">OPT-175B</a>. CICERO can deduce, for example, that later in the game it will need the support of one particular player, and then craft a strategy to win that person’s favor – and even recognize the risks and opportunities that that player sees from their particular point of view. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/314899914_871644897539621_6663909609777508857_n.png?_nc_cat=106&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=Wu7GT4BgX0oAX89i7wU&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfD8s-9DMw0mit8UaPB_RYivgig8amYJfFAlbnA3b1Rnfw&amp;oe=6381EF76" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315089184_1172510856678676_8255258449249197787_n.png?_nc_cat=106&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=3es867C9Q_sAX_iVp2j&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDmOwI6cUv6jB2LdrF_fhX1PZHXr4qe8Ivp6wEDbqIi8g&amp;oe=63816BDF" alt=""/></p><p> We’ve open-sourced the code and <a href="https://ai.facebook.com/blog/cicero-ai-negotiates-persuades-and-cooperates-with-people/www.science.org/doi/10.1126/science.ade9097">published a paper</a> to help the wider AI community use CICERO to spur further progress in human-AI cooperation. You can also visit the <a href="https://ai.facebook.com/research/cicero/diplomacy/">CICERO website</a> to learn more about the project and see the agent in action. Interested researchers can submit a proposal to the <a href="https://ai.facebook.com/research/request-for-proposal/towards-human-AI-cooperation/">CICERO RFP</a> to gain access to the data. </p><h2>Under the hood: How we built CICERO</h2><p> At the heart of CICERO is a controllable dialogue model for Diplomacy coupled with a strategic reasoning engine. At each point in the game, CICERO looks at the game board and its conversation history, and models how the other players are likely to act. It then uses this plan to control a language model that can generate free-form dialogue, informing other players of its plans and proposing reasonable actions for the other players that coordinate well with them. </p><h3>Controllable dialogue</h3><p> To build a controllable dialogue model, we started with a 2.7 billion parameter <a href="https://l.facebook.com/l.php?u=https%3A%2F%2Farxiv.org%2Fpdf%2F1910.13461.pdf&amp;h=AT0KqkK9yzmHFUPeel67t7ToaOZ46CZZ2zVGSHCcWp03KrkOP7eTQRI15TfEJMk8QMbXbGZ1GwIchkThAgfDBfdJdM0zWuag2aibZMlAf-V_OIu3QhfRnRVeqHAAft2hOC-EWfs5wXRcaBJH" rel="nofollow" target="_blank" data-lynx-mode="hover">BART</a>-like language model pre-trained on text from the internet and fine tuned on over 40,000 human games on webDiplomacy.net. We developed techniques to automatically annotate messages in the training data with corresponding planned moves in the game, so that at inference time we can control dialogue generation to discuss specific desired actions for the agent and its conversation partners. For example, if our agent is playing as France, conditioning the dialogue model on a plan involving England supporting France into Burgundy might yield a message to England like, “Hi England! Are you willing to support me into Burgundy this turn?” Controlling generation in this manner allows Cicero to ground its conversations in a set of plans that it develops and revises over time to better negotiate. This helps the agent coordinate with and persuade other players more effectively. </p><p><b>Step 1</b> Using the board state and current dialogue, Cicero makes an initial prediction of what everyone will do. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315166935_1101421023808786_4761329877105179152_n.png?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=hlYysAhj7P4AX-0rQUh&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDwSL927hIHlGWI9ZJzd2k20833k7YTmplJ5OENb3P8Xg&amp;oe=63825018" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315119719_520705749924410_3971720468357414315_n.png?_nc_cat=111&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=ajv1JJevvJYAX8ZDjRU&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfAMINSZxhG99BMxOiuNiEF3M3Bjbb27ZBIH2PFR-fFFeQ&amp;oe=6382EEAC" alt=""/></p><p><b>Step 2</b> CICERO iteratively refines that prediction using planning and then uses those predictions to form an intent for itself and its partner. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315166577_1304680396985748_1626541310268050130_n.png?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=As-SLb4PQcsAX-nItfp&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfBzE-rtacj_wgmea-SPonH13iKw08tLtYKykv20YIa8Lw&amp;oe=63818382" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/314945745_1594767387648829_3098998854533489973_n.png?_nc_cat=106&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=qfZOUifZwHwAX-vX-sA&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfC-ZbecBPPW4A8fW50zYm94sLXZYvVpqOSVXKKH2ix1Fg&amp;oe=63822CE4" alt=""/></p><p><b>Step 3</b> It generates several candidate messages based on the board state, dialogue, and its intents. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/314973220_2582679801889620_2777063479571464856_n.png?_nc_cat=108&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=7oxX3z7bGW4AX9Bljc6&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfAL-7UNDd98EFMAt3te2_A2yNcJ-pnYS90O8Uyt-u6SXQ&amp;oe=6382475A" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/314979546_877550393677389_7228480049704817880_n.png?_nc_cat=106&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=pSmr84SEBWwAX8YVTqI&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfCKu-E3EsBn1FJmzJ5yC0dXRZfbuJKvbKoCTwwioj4Atg&amp;oe=6381A97E" alt=""/></p><p><b>Step 4</b> It filters the candidate message to reduce nonsense, maximize value, and ensure consistency with our intents. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315190745_894397488661038_1759532778194232703_n.png?_nc_cat=100&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=qUc1GaEx3D8AX8qh6QP&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDV1-ZB5agM10JIfrQBECmzjtjwaYGYgGpC50z8xWiu_Q&amp;oe=6382C0EF" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315052466_651033463324496_6340596265239073041_n.png?_nc_cat=104&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=OFx8Ty-aSAQAX9sraUj&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDeXhyBkaUdjY9o9g3VH4ZgDsZ-3BHVZQtUB4ZQDOL42g&amp;oe=63818430" alt=""/></p><p> We further improve dialogue quality using several filtering mechanisms – such as classifiers trained to distinguish between human and model-generated text – that ensure that our dialogue is sensible, consistent with the current game state and previous messages, and strategically sound. </p><h3>Dialogue-aware strategy &amp; planning</h3><p> Past superhuman agents in adversarial games like chess, Go, and poker were created through self-play reinforcement learning (RL) – having the agents learn optimal policies by playing millions of games against other copies of itself. However, games involving cooperation require modeling what humans will actually do in real life, rather than modeling what they should do if they were perfect copies of the bot. In particular, we want CICERO to make plans that are consistent with its dialogue with other players. </p><div id="u_0_2y_Tj"><div id="u_0_2z_kS"><div tabindex="0" id="u_0_30_dE"><video muted="1" height="360" width="640" preload="metadata" data-video-width="640" data-video-height="360" id="u_0_31_Yi"></video><p><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y4/r/-PAXP-deijE.gif" alt="" id="u_0_33_gd"/></p><div><div><p>Something Went Wrong</p><p>We&#39;re having trouble playing this video.</p></div></div></div></div></div><p><span><p>The classic approach to human modeling is supervised learning, where the agent is trained with labeled data such as a database of human players’ actions in past games. However, relying purely on supervised learning to choose actions based on past dialogue results in an agent that is relatively weak and highly exploitable. For example, a player could tell the agent, &#34;I&#39;m glad we agreed that you will move your unit out of Paris!&#34; Since similar messages appear in the training data only when an agreement was reached, the agent might indeed move its unit out of Paris even if doing so is a clear strategic blunder. </p></span></p><p> To fix this, CICERO runs an iterative planning algorithm that balances dialogue consistency with rationality. The agent first predicts everyone&#39;s policy for the current turn based on the dialogue it has shared with other players, and also predicts what other players think the agent&#39;s policy will be. It then runs a planning algorithm we developed called piKL, which iteratively improves these predictions by trying to choose new policies that have higher expected value given the other players&#39; predicted policies, while also trying to keep the new predictions close to the original policy predictions. We found that piKL better models human play and leads to better policies for the agent compared to supervised learning alone. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315323143_804148560667290_2909968449197737355_n.png?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=x0poy3uepWUAX8Eh-Jy&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfC_enCDBOja-dUlGHpm3Q7yLT_orlFXmS1FjvHmEtmoqw&amp;oe=638114E5" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315598523_1698881693839102_8961669250352788388_n.png?_nc_cat=101&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=XoTrIJW0VAYAX-sHvME&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDAhvrcSjWgqFhhpjpsNRWp0TllX9-w1hh3DN1ESHNn5w&amp;oe=638280FD" alt=""/></p><h2>Generating natural, purposeful dialogue</h2><p> In Diplomacy, how a player talks to other people can be even more important than how they move their pieces. CICERO is able to speak clearly and persuasively when strategizing with other players. For example, in one demonstration game CICERO asked one player for immediate support on one part of the board while pressing another to consider an alliance later in the game. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315211596_2093452834192890_1061128926458069529_n.gif?_nc_cat=103&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=wHqgUXZcB64AX9RtKfz&amp;_nc_oc=AQmUNHEpEEa813Rzlq_y74VXejyQg3o-8lhHAups66r2R6bfdaqnTvrqCrzvJZzAL-0&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfCSM9xwodUBp_mHVFOPXUhI8NDq0UWCnzRJwukJJcXcqw&amp;oe=638164E6" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/314716611_716080272704971_2323236856372192503_n.gif?_nc_cat=102&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=RTXXuoBX5IsAX_mcRUv&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfA0cPNd4WJl6GPoYDTu1vik3gwIy7MdhbYAjhMnB8sxqw&amp;oe=63820750" alt=""/></p><p>In these exchanges, CICERO tries to execute its strategy by proposing moves to three different players. In the second dialog, the agent is able to tell the other player why they should cooperate and how it will be mutually beneficial. In the third, CICERO is both soliciting information and setting the groundwork for future moves.</p><h2>Where there is still room for improvement</h2><p> It is important to recognize that CICERO also sometimes generates inconsistent dialogue that can undermine its objectives. In the example below where CICERO was playing as Austria, the agent contradicts its first message asking Italy to move to Venice. While our suite of filters aims to detect these sorts of mistakes, it is not perfect. </p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315600339_685235036349821_8488818769041563292_n.png?_nc_cat=104&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=H1csO3VPGBYAX_UQtkR&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfDMrTaQSE56dn59uPDvAPLii9MRa0GPE9pKCbubewLHgg&amp;oe=638175D7" alt=""/></p><p><img src="https://scontent-ord5-1.xx.fbcdn.net/v/t39.2365-6/315893528_537007657888539_7716464598980818112_n.png?_nc_cat=101&amp;ccb=1-7&amp;_nc_sid=ad8a9d&amp;_nc_ohc=JxD926-7uG0AX-RDrL5&amp;_nc_ht=scontent-ord5-1.xx&amp;oh=00_AfCGon55x1RV4Xjp6x9QQy121l8bpHN9zxV-FB0bzcwRsg&amp;oe=63821DB3" alt=""/></p><h2>Diplomacy as a sandbox for advancing human-AI interaction </h2><p> The emergence of goal-oriented dialogue systems in a game that involves both cooperation and competition raises important social and technical challenges in aligning AI with human intentions and objectives. Diplomacy provides a particularly interesting environment for studying this because playing the game requires wrestling with conflicting objectives and translating those complex goals into natural language. As a simple example, a player might choose to compromise on short term gains in order to maintain an ally, on the chance that this ally will help them into an even better position on the next turn. </p><p> While we’ve made significant headway in this work, both the ability to robustly align language models with specific intentions and the technical (and normative) challenge of deciding on those intentions remain open and important problems. By open sourcing the CICERO code, we hope that AI researchers can continue to build off our work in a responsible manner. We have made early steps towards detecting and removing toxic messages in this new domain by using our dialogue model for zero-shot classification. We hope Diplomacy can serve as a safe sandbox to advance research in human-AI interaction. </p><h2>Future directions</h2><p> While CICERO is only capable of playing Diplomacy, the technology behind this achievement is relevant to many real world applications. Controlling natural language generation via planning and RL, could, for example, ease communication barriers between humans and AI-powered agents. For instance, today&#39;s AI assistants excel at simple question-answering tasks, like telling you the weather, but what if they could maintain a long-term conversation with the goal of teaching you a new skill? Alternatively, imagine a video game in which the non player characters (NPCs) could plan and converse like people do — understanding your motivations and adapting the conversation accordingly — to help you on your quest of storming the castle. </p><p> We’re excited about the potential for future advances in these areas and seeing how others build on our research. </p><a role="button" href="https://l.facebook.com/l.php?u=https%3A%2F%2Fwww.science.org%2Fdoi%2F10.1126%2Fscience.ade9097&amp;h=AT04KcpjNJa9uOnzhIhB8jz-jmRCeqgjB7QVaPOgru7aklM3g3svIrDpqrXwJ8utxDlF1NwS-syJ8f-tUcSePF43y7gPte9Ku46LJRh6jbYQKXC1COx7PZDMq078dtw17CKWLT6AcSAGHoOs" target="_blank" rel="nofollow" data-ms="{&#34;creative&#34;:&#34;button&#34;,&#34;creative_detail&#34;:&#34;button&#34;,&#34;create_type&#34;:&#34;button&#34;,&#34;create_type_detail&#34;:&#34;button&#34;}" data-lynx-mode="hover"><p>Read the paper</p></a><a role="button" href="https://ai.facebook.com/research/cicero/" data-ms="{&#34;creative&#34;:&#34;button&#34;,&#34;creative_detail&#34;:&#34;button&#34;,&#34;create_type&#34;:&#34;button&#34;,&#34;create_type_detail&#34;:&#34;button&#34;}"><p>Visit the CICERO site</p></a><a role="button" href="https://ai.facebook.com/research/request-for-proposal/towards-human-AI-cooperation/" data-ms="{&#34;creative&#34;:&#34;button&#34;,&#34;creative_detail&#34;:&#34;button&#34;,&#34;create_type&#34;:&#34;button&#34;,&#34;create_type_detail&#34;:&#34;button&#34;}"><p>Learn about the RFP</p></a><p><i>We’d like to acknowledge the contributions of a broad team to this work: Anton Bakhtin, Noam Brown, Emily Dinan, Gabriele Farina, Colin Flaherty, Daniel Fried, Andrew Goff, Jonathan Gray, Hengyuan Hu, Athul Paul Jacob, Mojtaba Komeili, Karthik Konath, Adam Lerer, Mike Lewis, Alexander H. Miller, Sasha Mitts, Adithya Renduchintala, Stephen Roller, Dirk Rowe, Weiyan Shi, Joe Spisak, Alexander Wei, David Wu, Hugh Zhang, Markus Zijlstra, Ana Paula Kirschner Mofarrej, Anne Davidson, Oliver Libaw, Amanda Felix, Karla Caraballo-Torres, Christopher Johnson, Lydia Baillergeau, Julia Vargas, Eric Kaplan, Raghu Nayani, Aiman Farooq, Andrea Cheung, Emily Astbury, Gopika Jhala, Jon Carvill, Jon Shepard, Josh Terry, Marina Zannoli, Nathan Riley, Michelle Restrepo, Noah Rizk, Ritika Trikha, Steph Miles, Tamara Piksa, Zara Blum, Daniel Duncan, Antoine Bordes, Laurens van der Maaten, Alex Boesenberg, Korey Anvaripour, Somya Jain, Harrison Rudolph, Michael Friedrichs, Elisabeth Sperle, and Cesar Guiterrez.</i></p><p><i>* All rights in Diplomacy are owned by Hasbro, Inc.</i></p></div></div></div>
  </body>
</html>
